{"version":3,"file":"cb-lcars.js","mappings":"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","sources":["webpack://cb-lcars/./node_modules/@formatjs/intl-utils/lib/src/diff.js","webpack://cb-lcars/./node_modules/custom-card-helpers/dist/index.m.js","webpack://cb-lcars/./node_modules/ha-editor-formbuilder-yaml/dist/controls.js","webpack://cb-lcars/./node_modules/ha-editor-formbuilder-yaml/dist/index.js","webpack://cb-lcars/./node_modules/ha-editor-formbuilder-yaml/dist/interfaces.js","webpack://cb-lcars/./src/cb-lcars-vars.js","webpack://cb-lcars/./src/msd/renderer/DataSourceMixin.js","webpack://cb-lcars/./src/msd/renderer/PositionResolver.js","webpack://cb-lcars/./src/msd/renderer/RendererUtils.js","webpack://cb-lcars/./src/msd/renderer/StatusGridRenderer.js","webpack://cb-lcars/./src/msd/renderer/TextOverlayRenderer.js","webpack://cb-lcars/./src/msd/tests/arcsRoutingScenarios.js","webpack://cb-lcars/./src/msd/tests/channelsRoutingScenarios.js","webpack://cb-lcars/./src/msd/tests/routingScenarios.js","webpack://cb-lcars/./src/msd/tests/smartRoutingScenarios.js","webpack://cb-lcars/./src/msd/tests/smoothingRoutingScenarios.js","webpack://cb-lcars/./src/utils/cb-lcars-anim-helpers.js","webpack://cb-lcars/./src/utils/cb-lcars-anim-presets.js","webpack://cb-lcars/./src/utils/cb-lcars-logging.js","webpack://cb-lcars/./src/utils/cb-lcars-svg-helpers.js","webpack://cb-lcars/./node_modules/lit-html/lit-html.js","webpack://cb-lcars/./node_modules/lit-html/directive.js","webpack://cb-lcars/./node_modules/lit-html/directives/unsafe-html.js","webpack://cb-lcars/./node_modules/@lit/reactive-element/css-tag.js","webpack://cb-lcars/./node_modules/@lit/reactive-element/reactive-element.js","webpack://cb-lcars/./node_modules/lit-element/lit-element.js","webpack://cb-lcars/./node_modules/lit-html/is-server.js","webpack://cb-lcars/webpack/bootstrap","webpack://cb-lcars/webpack/runtime/define property getters","webpack://cb-lcars/webpack/runtime/global","webpack://cb-lcars/webpack/runtime/hasOwnProperty shorthand","webpack://cb-lcars/webpack/runtime/make namespace object","webpack://cb-lcars/./node_modules/animejs/lib/anime.esm.js","webpack://cb-lcars/./node_modules/js-yaml/dist/js-yaml.mjs","webpack://cb-lcars/./src/utils/cb-lcars-fileutils.js","webpack://cb-lcars/./src/editor/cb-lcars-editor.js","webpack://cb-lcars/./src/utils/cb-lcars-theme.js","webpack://cb-lcars/./src/cblcars-button-card.js","webpack://cb-lcars/./src/utils/cb-lcars-anchor-helpers.js","webpack://cb-lcars/./src/msd/util/checksum.js","webpack://cb-lcars/./src/msd/util/performance.js","webpack://cb-lcars/./src/msd/packs/mergePacks.js","webpack://cb-lcars/./src/msd/validation/validateMerged.js","webpack://cb-lcars/./src/msd/renderer/SparklineRenderer.js","webpack://cb-lcars/./src/msd/renderer/LineOverlayRenderer.js","webpack://cb-lcars/./src/msd/renderer/AdvancedRenderer.js","webpack://cb-lcars/./src/msd/debug/MsdDebugRenderer.js","webpack://cb-lcars/./src/msd/controls/MsdControlsRenderer.js","webpack://cb-lcars/./src/msd/hud/panels/PerformancePanel.js","webpack://cb-lcars/./src/msd/hud/panels/ValidationPanel.js","webpack://cb-lcars/./src/msd/hud/panels/DataSourcePanel.js","webpack://cb-lcars/./src/msd/hud/panels/RoutingPanel.js","webpack://cb-lcars/./src/msd/hud/panels/ChannelTrendPanel.js","webpack://cb-lcars/./src/msd/hud/panels/FlagsPanel.js","webpack://cb-lcars/./src/msd/hud/panels/IssuesPanel.js","webpack://cb-lcars/./src/msd/hud/panels/PacksPanel.js","webpack://cb-lcars/./src/msd/hud/panels/RulesPanel.js","webpack://cb-lcars/./src/msd/hud/panels/ExportPanel.js","webpack://cb-lcars/./src/msd/hud/hudService.js","webpack://cb-lcars/./src/msd/hud/panels/OverlaysPanel.js","webpack://cb-lcars/./src/msd/hud/MsdHudManager.js","webpack://cb-lcars/./src/msd/data/RollingBuffer.js","webpack://cb-lcars/./src/msd/data/transformations/TransformationProcessor.js","webpack://cb-lcars/./src/msd/data/aggregations/AggregationProcessor.js","webpack://cb-lcars/./src/msd/data/MsdDataSource.js","webpack://cb-lcars/./src/msd/data/DataSourceManager.js","webpack://cb-lcars/./src/msd/perf/PerfCounters.js","webpack://cb-lcars/./src/msd/routing/RouterCore.js","webpack://cb-lcars/./src/msd/util/hashing.js","webpack://cb-lcars/./src/msd/animation/AnimationRegistry.js","webpack://cb-lcars/./src/msd/rules/RuleTraceBuffer.js","webpack://cb-lcars/./src/msd/rules/RulesEngine.js","webpack://cb-lcars/./src/msd/debug/DebugManager.js","webpack://cb-lcars/./src/msd/renderer/BaseOverlayUpdater.js","webpack://cb-lcars/./src/msd/pipeline/SystemsManager.js","webpack://cb-lcars/./src/msd/profile/ProfileResolver.js","webpack://cb-lcars/./src/msd/util/deepMerge.js","webpack://cb-lcars/./src/msd/pipeline/ModelBuilder.js","webpack://cb-lcars/./src/msd/valueMap/resolveValueMaps.js","webpack://cb-lcars/./src/msd/util/linearMap.js","webpack://cb-lcars/./src/msd/animation/resolveAnimations.js","webpack://cb-lcars/./src/msd/animation/resolveTimelines.js","webpack://cb-lcars/./src/msd/introspection/MsdIntrospection.js","webpack://cb-lcars/./src/msd/model/CardModel.js","webpack://cb-lcars/./src/msd/api/MsdApi.js","webpack://cb-lcars/./src/msd/export/exportCollapsed.js","webpack://cb-lcars/./src/msd/export/exportFullSnapshot.js","webpack://cb-lcars/./src/msd/export/diffItem.js","webpack://cb-lcars/./src/msd/util/stableStringify.js","webpack://cb-lcars/./src/msd/pipeline/PipelineCore.js","webpack://cb-lcars/./src/msd/pipeline/ConfigProcessor.js","webpack://cb-lcars/./src/msd/debug/DebugInterface.js","webpack://cb-lcars/./src/cb-lcars.js","webpack://cb-lcars/./src/msd/index.js","webpack://cb-lcars/./src/utils/cb-helpers.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar MS_PER_SECOND = 1e3;\nvar SECS_PER_MIN = 60;\nvar SECS_PER_HOUR = SECS_PER_MIN * 60;\nvar SECS_PER_DAY = SECS_PER_HOUR * 24;\nvar SECS_PER_WEEK = SECS_PER_DAY * 7;\nexport function selectUnit(from, to, thresholds) {\n    if (to === void 0) { to = Date.now(); }\n    if (thresholds === void 0) { thresholds = {}; }\n    var resolvedThresholds = __assign(__assign({}, DEFAULT_THRESHOLDS), (thresholds || {}));\n    var secs = (+from - +to) / MS_PER_SECOND;\n    if (Math.abs(secs) < resolvedThresholds.second) {\n        return {\n            value: Math.round(secs),\n            unit: 'second',\n        };\n    }\n    var mins = secs / SECS_PER_MIN;\n    if (Math.abs(mins) < resolvedThresholds.minute) {\n        return {\n            value: Math.round(mins),\n            unit: 'minute',\n        };\n    }\n    var hours = secs / SECS_PER_HOUR;\n    if (Math.abs(hours) < resolvedThresholds.hour) {\n        return {\n            value: Math.round(hours),\n            unit: 'hour',\n        };\n    }\n    var days = secs / SECS_PER_DAY;\n    if (Math.abs(days) < resolvedThresholds.day) {\n        return {\n            value: Math.round(days),\n            unit: 'day',\n        };\n    }\n    var fromDate = new Date(from);\n    var toDate = new Date(to);\n    var years = fromDate.getFullYear() - toDate.getFullYear();\n    if (Math.round(Math.abs(years)) > 0) {\n        return {\n            value: Math.round(years),\n            unit: 'year',\n        };\n    }\n    var months = years * 12 + fromDate.getMonth() - toDate.getMonth();\n    if (Math.round(Math.abs(months)) > 0) {\n        return {\n            value: Math.round(months),\n            unit: 'month',\n        };\n    }\n    var weeks = secs / SECS_PER_WEEK;\n    return {\n        value: Math.round(weeks),\n        unit: 'week',\n    };\n}\nexport var DEFAULT_THRESHOLDS = {\n    second: 45,\n    minute: 45,\n    hour: 22,\n    day: 5,\n};\n","import{selectUnit as e}from\"@formatjs/intl-utils\";var t,r,n=function(e,t){return i(t).format(e)},i=function(e){return new Intl.DateTimeFormat(e.language,{weekday:\"long\",month:\"long\",day:\"numeric\"})},a=function(e,t){return o(t).format(e)},o=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"long\",day:\"numeric\"})},u=function(e,t){return c(t).format(e)},c=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"numeric\",day:\"numeric\"})},m=function(e,t){return s(t).format(e)},s=function(e){return new Intl.DateTimeFormat(e.language,{day:\"numeric\",month:\"short\"})},l=function(e,t){return d(t).format(e)},d=function(e){return new Intl.DateTimeFormat(e.language,{month:\"long\",year:\"numeric\"})},f=function(e,t){return g(t).format(e)},g=function(e){return new Intl.DateTimeFormat(e.language,{month:\"long\"})},p=function(e,t){return h(t).format(e)},h=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\"})};!function(e){e.language=\"language\",e.system=\"system\",e.comma_decimal=\"comma_decimal\",e.decimal_comma=\"decimal_comma\",e.space_comma=\"space_comma\",e.none=\"none\"}(t||(t={})),function(e){e.language=\"language\",e.system=\"system\",e.am_pm=\"12\",e.twenty_four=\"24\"}(r||(r={}));var b=function(e){if(e.time_format===r.language||e.time_format===r.system){var t=e.time_format===r.language?e.language:void 0,n=(new Date).toLocaleString(t);return n.includes(\"AM\")||n.includes(\"PM\")}return e.time_format===r.am_pm},v=function(e,t){return _(t).format(e)},_=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"long\",day:\"numeric\",hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:b(e)})},y=function(e,t){return w(t).format(e)},w=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"long\",day:\"numeric\",hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:b(e)})},k=function(e,t){return x(t).format(e)},x=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"numeric\",day:\"numeric\",hour:\"numeric\",minute:\"2-digit\",hour12:b(e)})},D=function(e,t){return S(t).format(e)},S=function(e){return new Intl.DateTimeFormat(e.language,{hour:\"numeric\",minute:\"2-digit\",hour12:b(e)})},F=function(e,t){return T(t).format(e)},T=function(e){return new Intl.DateTimeFormat(e.language,{hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:b(e)})},I=function(e,t){return N(t).format(e)},N=function(e){return new Intl.DateTimeFormat(e.language,{hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:b(e)})},M=function(t,r,n,i){void 0===i&&(i=!0);var a=e(t,n);return i?function(e){return new Intl.RelativeTimeFormat(e.language,{numeric:\"auto\"})}(r).format(a.value,a.unit):Intl.NumberFormat(r.language,{style:\"unit\",unit:a.unit,unitDisplay:\"long\"}).format(Math.abs(a.value))};function C(e){var t,r=3600*(t=e.attributes.remaining.split(\":\").map(Number))[0]+60*t[1]+t[2];if(\"active\"===e.state){var n=(new Date).getTime(),i=new Date(e.last_changed).getTime();r=Math.max(r-(n-i)/1e3,0)}return r}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var q=function(e,t,r,n){void 0===n&&(n=!1),e._themes||(e._themes={});var i=t.default_theme;(\"default\"===r||r&&t.themes[r])&&(i=r);var a=O({},e._themes);if(\"default\"!==i){var o=t.themes[i];Object.keys(o).forEach(function(t){var r=\"--\"+t;e._themes[r]=\"\",a[r]=o[t]})}if(e.updateStyles?e.updateStyles(a):window.ShadyCSS&&window.ShadyCSS.styleSubtree(e,a),n){var u=document.querySelector(\"meta[name=theme-color]\");if(u){u.hasAttribute(\"default-content\")||u.setAttribute(\"default-content\",u.getAttribute(\"content\"));var c=a[\"--primary-color\"]||u.getAttribute(\"default-content\");u.setAttribute(\"content\",c)}}},A=function(e){return\"function\"==typeof e.getCardSize?e.getCardSize():4};function E(e){return e.substr(0,e.indexOf(\".\"))}function j(e){return e.substr(e.indexOf(\".\")+1)}function R(e){var t,r=(null==e||null==(t=e.locale)?void 0:t.language)||\"en\";return e.translationMetadata.translations[r]&&e.translationMetadata.translations[r].isRTL||!1}function z(e){return R(e)?\"rtl\":\"ltr\"}function L(e){return E(e.entity_id)}var P=function(e){return!!e.attributes.unit_of_measurement||!!e.attributes.state_class},U=function(e){switch(e.number_format){case t.comma_decimal:return[\"en-US\",\"en\"];case t.decimal_comma:return[\"de\",\"es\",\"it\"];case t.space_comma:return[\"fr\",\"sv\",\"cs\"];case t.system:return;default:return e.language}},B=function(e,t){return void 0===t&&(t=2),Math.round(e*Math.pow(10,t))/Math.pow(10,t)},H=function(e,r,n){var i=r?U(r):void 0;if(Number.isNaN=Number.isNaN||function e(t){return\"number\"==typeof t&&e(t)},(null==r?void 0:r.number_format)!==t.none&&!Number.isNaN(Number(e))&&Intl)try{return new Intl.NumberFormat(i,V(e,n)).format(Number(e))}catch(t){return console.error(t),new Intl.NumberFormat(void 0,V(e,n)).format(Number(e))}return\"string\"==typeof e?e:B(e,null==n?void 0:n.maximumFractionDigits).toString()+(\"currency\"===(null==n?void 0:n.style)?\" \"+n.currency:\"\")},V=function(e,t){var r=O({maximumFractionDigits:2},t);if(\"string\"!=typeof e)return r;if(!t||!t.minimumFractionDigits&&!t.maximumFractionDigits){var n=e.indexOf(\".\")>-1?e.split(\".\")[1].length:0;r.minimumFractionDigits=n,r.maximumFractionDigits=n}return r},W=function(e,t,r,n){var i=void 0!==n?n:t.state;if(\"unknown\"===i||\"unavailable\"===i)return e(\"state.default.\"+i);if(P(t)){if(\"monetary\"===t.attributes.device_class)try{return H(i,r,{style:\"currency\",currency:t.attributes.unit_of_measurement})}catch(e){}return H(i,r)+(t.attributes.unit_of_measurement?\" \"+t.attributes.unit_of_measurement:\"\")}var o=L(t);if(\"input_datetime\"===o){var u;if(void 0===n)return t.attributes.has_date&&t.attributes.has_time?(u=new Date(t.attributes.year,t.attributes.month-1,t.attributes.day,t.attributes.hour,t.attributes.minute),v(u,r)):t.attributes.has_date?(u=new Date(t.attributes.year,t.attributes.month-1,t.attributes.day),a(u,r)):t.attributes.has_time?((u=new Date).setHours(t.attributes.hour,t.attributes.minute),D(u,r)):t.state;try{var c=n.split(\" \");if(2===c.length)return v(new Date(c.join(\"T\")),r);if(1===c.length){if(n.includes(\"-\"))return a(new Date(n+\"T00:00\"),r);if(n.includes(\":\")){var m=new Date;return D(new Date(m.toISOString().split(\"T\")[0]+\"T\"+n),r)}}return n}catch(e){return n}}return\"humidifier\"===o&&\"on\"===i&&t.attributes.humidity?t.attributes.humidity+\" %\":\"counter\"===o||\"number\"===o||\"input_number\"===o?H(i,r):t.attributes.device_class&&e(\"component.\"+o+\".state.\"+t.attributes.device_class+\".\"+i)||e(\"component.\"+o+\".state._.\"+i)||i},G=\"mdi:bookmark\",J=\"lovelace\",K=[\"climate\",\"cover\",\"configurator\",\"input_select\",\"input_number\",\"input_text\",\"lock\",\"media_player\",\"scene\",\"script\",\"timer\",\"vacuum\",\"water_heater\",\"weblink\"],Q=[\"alarm_control_panel\",\"automation\",\"camera\",\"climate\",\"configurator\",\"cover\",\"fan\",\"group\",\"history_graph\",\"input_datetime\",\"light\",\"lock\",\"media_player\",\"script\",\"sun\",\"updater\",\"vacuum\",\"water_heater\",\"weather\"],X=[\"input_number\",\"input_select\",\"input_text\",\"scene\",\"weblink\"],Y=[\"camera\",\"configurator\",\"history_graph\",\"scene\"],Z=[\"closed\",\"locked\",\"off\"],$=new Set([\"fan\",\"input_boolean\",\"light\",\"switch\",\"group\",\"automation\"]),ee=\"°C\",te=\"°F\",re=\"group.default_view\",ne=function(e,t,r,n){n=n||{},r=null==r?{}:r;var i=new Event(t,{bubbles:void 0===n.bubbles||n.bubbles,cancelable:Boolean(n.cancelable),composed:void 0===n.composed||n.composed});return i.detail=r,e.dispatchEvent(i),i},ie=new Set([\"call-service\",\"divider\",\"section\",\"weblink\",\"cast\",\"select\"]),ae={alert:\"toggle\",automation:\"toggle\",climate:\"climate\",cover:\"cover\",fan:\"toggle\",group:\"group\",input_boolean:\"toggle\",input_number:\"input-number\",input_select:\"input-select\",input_text:\"input-text\",light:\"toggle\",lock:\"lock\",media_player:\"media-player\",remote:\"toggle\",scene:\"scene\",script:\"script\",sensor:\"sensor\",timer:\"timer\",switch:\"toggle\",vacuum:\"toggle\",water_heater:\"climate\",input_datetime:\"input-datetime\"},oe=function(e,t){void 0===t&&(t=!1);var r=function(e,t){return n(\"hui-error-card\",{type:\"error\",error:e,config:t})},n=function(e,t){var n=window.document.createElement(e);try{if(!n.setConfig)return;n.setConfig(t)}catch(n){return console.error(e,n),r(n.message,t)}return n};if(!e||\"object\"!=typeof e||!t&&!e.type)return r(\"No type defined\",e);var i=e.type;if(i&&i.startsWith(\"custom:\"))i=i.substr(\"custom:\".length);else if(t)if(ie.has(i))i=\"hui-\"+i+\"-row\";else{if(!e.entity)return r(\"Invalid config given.\",e);var a=e.entity.split(\".\",1)[0];i=\"hui-\"+(ae[a]||\"text\")+\"-entity-row\"}else i=\"hui-\"+i+\"-card\";if(customElements.get(i))return n(i,e);var o=r(\"Custom element doesn't exist: \"+e.type+\".\",e);o.style.display=\"None\";var u=setTimeout(function(){o.style.display=\"\"},2e3);return customElements.whenDefined(e.type).then(function(){clearTimeout(u),ne(o,\"ll-rebuild\",{},o)}),o},ue=function(e,t,r){var n;return void 0===r&&(r=!1),function(){var i=[].slice.call(arguments),a=this,o=function(){n=null,r||e.apply(a,i)},u=r&&!n;clearTimeout(n),n=setTimeout(o,t),u&&e.apply(a,i)}},ce={alert:\"mdi:alert\",automation:\"mdi:playlist-play\",calendar:\"mdi:calendar\",camera:\"mdi:video\",climate:\"mdi:thermostat\",configurator:\"mdi:settings\",conversation:\"mdi:text-to-speech\",device_tracker:\"mdi:account\",fan:\"mdi:fan\",group:\"mdi:google-circles-communities\",history_graph:\"mdi:chart-line\",homeassistant:\"mdi:home-assistant\",homekit:\"mdi:home-automation\",image_processing:\"mdi:image-filter-frames\",input_boolean:\"mdi:drawing\",input_datetime:\"mdi:calendar-clock\",input_number:\"mdi:ray-vertex\",input_select:\"mdi:format-list-bulleted\",input_text:\"mdi:textbox\",light:\"mdi:lightbulb\",mailbox:\"mdi:mailbox\",notify:\"mdi:comment-alert\",person:\"mdi:account\",plant:\"mdi:flower\",proximity:\"mdi:apple-safari\",remote:\"mdi:remote\",scene:\"mdi:google-pages\",script:\"mdi:file-document\",sensor:\"mdi:eye\",simple_alarm:\"mdi:bell\",sun:\"mdi:white-balance-sunny\",switch:\"mdi:flash\",timer:\"mdi:timer\",updater:\"mdi:cloud-upload\",vacuum:\"mdi:robot-vacuum\",water_heater:\"mdi:thermometer\",weblink:\"mdi:open-in-new\"};function me(e,t){if(e in ce)return ce[e];switch(e){case\"alarm_control_panel\":switch(t){case\"armed_home\":return\"mdi:bell-plus\";case\"armed_night\":return\"mdi:bell-sleep\";case\"disarmed\":return\"mdi:bell-outline\";case\"triggered\":return\"mdi:bell-ring\";default:return\"mdi:bell\"}case\"binary_sensor\":return t&&\"off\"===t?\"mdi:radiobox-blank\":\"mdi:checkbox-marked-circle\";case\"cover\":return\"closed\"===t?\"mdi:window-closed\":\"mdi:window-open\";case\"lock\":return t&&\"unlocked\"===t?\"mdi:lock-open\":\"mdi:lock\";case\"media_player\":return t&&\"off\"!==t&&\"idle\"!==t?\"mdi:cast-connected\":\"mdi:cast\";case\"zwave\":switch(t){case\"dead\":return\"mdi:emoticon-dead\";case\"sleeping\":return\"mdi:sleep\";case\"initializing\":return\"mdi:timer-sand\";default:return\"mdi:z-wave\"}default:return console.warn(\"Unable to find icon for domain \"+e+\" (\"+t+\")\"),\"mdi:bookmark\"}}var se=function(e,t){var r=t.value||t,n=t.attribute?e.attributes[t.attribute]:e.state;switch(t.operator||\"==\"){case\"==\":return n===r;case\"<=\":return n<=r;case\"<\":return n<r;case\">=\":return n>=r;case\">\":return n>r;case\"!=\":return n!==r;case\"regex\":return n.match(r);default:return!1}},le=function(e){ne(window,\"haptic\",e)},de=function(e,t,r){void 0===r&&(r=!1),r?history.replaceState(null,\"\",t):history.pushState(null,\"\",t),ne(window,\"location-changed\",{replace:r})},fe=function(e,t,r){void 0===r&&(r=!0);var n,i=E(t),a=\"group\"===i?\"homeassistant\":i;switch(i){case\"lock\":n=r?\"unlock\":\"lock\";break;case\"cover\":n=r?\"open_cover\":\"close_cover\";break;default:n=r?\"turn_on\":\"turn_off\"}return e.callService(a,n,{entity_id:t})},ge=function(e,t){var r=Z.includes(e.states[t].state);return fe(e,t,r)},pe=function(e,t,r,n){if(n||(n={action:\"more-info\"}),!n.confirmation||n.confirmation.exemptions&&n.confirmation.exemptions.some(function(e){return e.user===t.user.id})||(le(\"warning\"),confirm(n.confirmation.text||\"Are you sure you want to \"+n.action+\"?\")))switch(n.action){case\"more-info\":(r.entity||r.camera_image)&&ne(e,\"hass-more-info\",{entityId:r.entity?r.entity:r.camera_image});break;case\"navigate\":n.navigation_path&&de(0,n.navigation_path);break;case\"url\":n.url_path&&window.open(n.url_path);break;case\"toggle\":r.entity&&(ge(t,r.entity),le(\"success\"));break;case\"call-service\":if(!n.service)return void le(\"failure\");var i=n.service.split(\".\",2);t.callService(i[0],i[1],n.service_data,n.target),le(\"success\");break;case\"fire-dom-event\":ne(e,\"ll-custom\",n)}},he=function(e,t,r,n){var i;\"double_tap\"===n&&r.double_tap_action?i=r.double_tap_action:\"hold\"===n&&r.hold_action?i=r.hold_action:\"tap\"===n&&r.tap_action&&(i=r.tap_action),pe(e,t,r,i)},be=function(e,t,r,n,i){var a;if(i&&r.double_tap_action?a=r.double_tap_action:n&&r.hold_action?a=r.hold_action:!n&&r.tap_action&&(a=r.tap_action),a||(a={action:\"more-info\"}),!a.confirmation||a.confirmation.exemptions&&a.confirmation.exemptions.some(function(e){return e.user===t.user.id})||confirm(a.confirmation.text||\"Are you sure you want to \"+a.action+\"?\"))switch(a.action){case\"more-info\":(a.entity||r.entity||r.camera_image)&&(ne(e,\"hass-more-info\",{entityId:a.entity?a.entity:r.entity?r.entity:r.camera_image}),a.haptic&&le(a.haptic));break;case\"navigate\":a.navigation_path&&(de(0,a.navigation_path),a.haptic&&le(a.haptic));break;case\"url\":a.url_path&&window.open(a.url_path),a.haptic&&le(a.haptic);break;case\"toggle\":r.entity&&(ge(t,r.entity),a.haptic&&le(a.haptic));break;case\"call-service\":if(!a.service)return;var o=a.service.split(\".\",2),u=o[0],c=o[1],m=O({},a.service_data);\"entity\"===m.entity_id&&(m.entity_id=r.entity),t.callService(u,c,m,a.target),a.haptic&&le(a.haptic);break;case\"fire-dom-event\":ne(e,\"ll-custom\",a),a.haptic&&le(a.haptic)}};function ve(e){return void 0!==e&&\"none\"!==e.action}function _e(e,t,r){if(t.has(\"config\")||r)return!0;if(e.config.entity){var n=t.get(\"hass\");return!n||n.states[e.config.entity]!==e.hass.states[e.config.entity]}return!1}function ye(e){return void 0!==e&&\"none\"!==e.action}var we=function(e,t,r){void 0===r&&(r=!0);var n={};t.forEach(function(t){if(Z.includes(e.states[t].state)===r){var i=E(t),a=[\"cover\",\"lock\"].includes(i)?i:\"homeassistant\";a in n||(n[a]=[]),n[a].push(t)}}),Object.keys(n).forEach(function(t){var i;switch(t){case\"lock\":i=r?\"unlock\":\"lock\";break;case\"cover\":i=r?\"open_cover\":\"close_cover\";break;default:i=r?\"turn_on\":\"turn_off\"}e.callService(t,i,{entity_id:n[t]})})},ke=function(){var e=document.querySelector(\"home-assistant\");if(e=(e=(e=(e=(e=(e=(e=(e=e&&e.shadowRoot)&&e.querySelector(\"home-assistant-main\"))&&e.shadowRoot)&&e.querySelector(\"app-drawer-layout partial-panel-resolver\"))&&e.shadowRoot||e)&&e.querySelector(\"ha-panel-lovelace\"))&&e.shadowRoot)&&e.querySelector(\"hui-root\")){var t=e.lovelace;return t.current_view=e.___curView,t}return null},xe={humidity:\"mdi:water-percent\",illuminance:\"mdi:brightness-5\",temperature:\"mdi:thermometer\",pressure:\"mdi:gauge\",power:\"mdi:flash\",signal_strength:\"mdi:wifi\"},De={binary_sensor:function(e,t){var r=\"off\"===e;switch(null==t?void 0:t.attributes.device_class){case\"battery\":return r?\"mdi:battery\":\"mdi:battery-outline\";case\"battery_charging\":return r?\"mdi:battery\":\"mdi:battery-charging\";case\"cold\":return r?\"mdi:thermometer\":\"mdi:snowflake\";case\"connectivity\":return r?\"mdi:server-network-off\":\"mdi:server-network\";case\"door\":return r?\"mdi:door-closed\":\"mdi:door-open\";case\"garage_door\":return r?\"mdi:garage\":\"mdi:garage-open\";case\"power\":return r?\"mdi:power-plug-off\":\"mdi:power-plug\";case\"gas\":case\"problem\":case\"safety\":case\"tamper\":return r?\"mdi:check-circle\":\"mdi:alert-circle\";case\"smoke\":return r?\"mdi:check-circle\":\"mdi:smoke\";case\"heat\":return r?\"mdi:thermometer\":\"mdi:fire\";case\"light\":return r?\"mdi:brightness-5\":\"mdi:brightness-7\";case\"lock\":return r?\"mdi:lock\":\"mdi:lock-open\";case\"moisture\":return r?\"mdi:water-off\":\"mdi:water\";case\"motion\":return r?\"mdi:walk\":\"mdi:run\";case\"occupancy\":return r?\"mdi:home-outline\":\"mdi:home\";case\"opening\":return r?\"mdi:square\":\"mdi:square-outline\";case\"plug\":return r?\"mdi:power-plug-off\":\"mdi:power-plug\";case\"presence\":return r?\"mdi:home-outline\":\"mdi:home\";case\"running\":return r?\"mdi:stop\":\"mdi:play\";case\"sound\":return r?\"mdi:music-note-off\":\"mdi:music-note\";case\"update\":return r?\"mdi:package\":\"mdi:package-up\";case\"vibration\":return r?\"mdi:crop-portrait\":\"mdi:vibrate\";case\"window\":return r?\"mdi:window-closed\":\"mdi:window-open\";default:return r?\"mdi:radiobox-blank\":\"mdi:checkbox-marked-circle\"}},cover:function(e){var t=\"closed\"!==e.state;switch(e.attributes.device_class){case\"garage\":return t?\"mdi:garage-open\":\"mdi:garage\";case\"door\":return t?\"mdi:door-open\":\"mdi:door-closed\";case\"shutter\":return t?\"mdi:window-shutter-open\":\"mdi:window-shutter\";case\"blind\":return t?\"mdi:blinds-open\":\"mdi:blinds\";case\"window\":return t?\"mdi:window-open\":\"mdi:window-closed\";default:return me(\"cover\",e.state)}},sensor:function(e){var t=e.attributes.device_class;if(t&&t in xe)return xe[t];if(\"battery\"===t){var r=Number(e.state);if(isNaN(r))return\"mdi:battery-unknown\";var n=10*Math.round(r/10);return n>=100?\"mdi:battery\":n<=0?\"mdi:battery-alert\":\"hass:battery-\"+n}var i=e.attributes.unit_of_measurement;return\"°C\"===i||\"°F\"===i?\"mdi:thermometer\":me(\"sensor\")},input_datetime:function(e){return e.attributes.has_date?e.attributes.has_time?me(\"input_datetime\"):\"mdi:calendar\":\"mdi:clock\"}},Se=function(e){if(!e)return\"mdi:bookmark\";if(e.attributes.icon)return e.attributes.icon;var t=E(e.entity_id);return t in De?De[t](e):me(t,e.state)};export{G as DEFAULT_DOMAIN_ICON,J as DEFAULT_PANEL,re as DEFAULT_VIEW_ENTITY_ID,X as DOMAINS_HIDE_MORE_INFO,Y as DOMAINS_MORE_INFO_NO_HISTORY,$ as DOMAINS_TOGGLE,K as DOMAINS_WITH_CARD,Q as DOMAINS_WITH_MORE_INFO,t as NumberFormat,Z as STATES_OFF,r as TimeFormat,ee as UNIT_C,te as UNIT_F,q as applyThemesOnElement,A as computeCardSize,E as computeDomain,j as computeEntity,R as computeRTL,z as computeRTLDirection,W as computeStateDisplay,L as computeStateDomain,oe as createThing,ue as debounce,me as domainIcon,se as evaluateFilter,ne as fireEvent,ce as fixedIcons,a as formatDate,f as formatDateMonth,l as formatDateMonthYear,u as formatDateNumeric,m as formatDateShort,v as formatDateTime,k as formatDateTimeNumeric,y as formatDateTimeWithSeconds,n as formatDateWeekday,p as formatDateYear,H as formatNumber,D as formatTime,I as formatTimeWeekday,F as formatTimeWithSeconds,le as forwardHaptic,ke as getLovelace,he as handleAction,pe as handleActionConfig,be as handleClick,ve as hasAction,_e as hasConfigOrEntityChanged,ye as hasDoubleClick,P as isNumericState,de as navigate,U as numberFormatToLocale,M as relativeTime,B as round,Se as stateIcon,C as timerTimeRemaining,ge as toggleEntity,we as turnOnOffEntities,fe as turnOnOffEntity};\n//# sourceMappingURL=index.m.js.map\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getNestedProperty = void 0;\nexports.deepMerge = deepMerge;\nexports.isObject = isObject;\nexports.generateControl = generateControl;\nconst lit_1 = require(\"lit\");\nconst unsafe_html_js_1 = require(\"lit/directives/unsafe-html.js\");\nconst getNestedProperty = (obj, path) => {\n    return path.split(\".\").reduce((acc, part) => acc && acc[part], obj);\n};\nexports.getNestedProperty = getNestedProperty;\nfunction deepMerge(target, source) {\n    const output = { ...target };\n    for (const key of Object.keys(source)) {\n        const targetValue = output[key];\n        const sourceValue = source[key];\n        if (key === \"type\") {\n            // Preserve the type property\n            output[key] = sourceValue;\n        }\n        else if (Array.isArray(targetValue) && Array.isArray(sourceValue)) {\n            // Replace arrays entirely\n            output[key] = sourceValue;\n        }\n        else if (isObject(targetValue) && isObject(sourceValue)) {\n            output[key] = deepMerge({ ...targetValue }, sourceValue);\n        }\n        else {\n            output[key] = sourceValue;\n        }\n    }\n    return output;\n}\n/*\nexport function deepMerge2<T>(target: T, source: T): T {\n    const output = { ...target } as any;\n\n    for (const key of Object.keys(source)) {\n        const targetValue = output[key];\n        const sourceValue = (source as any)[key];\n\n        if (key === \"type\") {\n            // Preserve the type property\n            output[key] = sourceValue;\n        } else if (Array.isArray(targetValue) && Array.isArray(sourceValue)) {\n            output[key] = [...new Set([...targetValue, ...sourceValue])]; // Merge arrays while removing duplicates\n        } else if (isObject(targetValue) && isObject(sourceValue)) {\n            output[key] = deepMerge({ ...targetValue }, sourceValue);\n        } else {\n            output[key] = sourceValue;\n        }\n    }\n\n    return output;\n}\n*/\nfunction isObject(obj) {\n    return obj !== null && typeof obj === \"object\";\n}\nfunction generateControl(control, card) {\n    /////put in the conditions for the new controls\n    ///// todo:  ?default val based on condition.. should only be set if set value doesn't exist. think about it..   const defaultValue = control.defaultValueCondition ? this._evaluateCondition(control.defaultValueCondition) : '';\n    //console.debug('generateControl:', control);\n    //pass in context to have access to the card's properties and window object\n    const context = { ...card, hass: card._hass, window };\n    // Evaluate visibility, disabled, and required conditions\n    // eg yaml:  isVisible: 'this._config.cblcars_card_config.show_icon === true'\n    //visible default is true\n    //disabled default is false\n    //required default is false\n    const isVisible = control.visibilityCondition ? card._evaluateCondition(control.visibilityCondition, context) : true;\n    const isDisabled = control.disabledCondition ? card._evaluateCondition(control.disabledCondition, context) : false;\n    const isRequired = control.requiredCondition ? card._evaluateCondition(control.requiredCondition, context) : false;\n    if (!isVisible) {\n        return null;\n    }\n    // Handle dynamic list creation for 'select' selector type\n    /*\n      eg yaml will pull in all css variables starting with '--picard-'\n  \n       - controls:\n          - label: \"options from vars\"\n            configValue: \"variables.card.color.background.inactive\"\n            type: Selector\n            selector:\n              select:\n                optionsCondition: |\n                    (() => {\n                      const styles = document.documentElement.style;\n                      const options = [];\n                      for (let i = 0; i < styles.length; i++) {\n                        const name = styles[i];\n                        if (name.startsWith('--picard-')) {\n                          const value = styles.getPropertyValue(name).trim();\n                          options.push({ value, label: name.replace('--', '') });\n                        }\n                      }\n                      return options;\n                    })()\n  \n    */\n    if ('selector' in control && control.selector && control.selector.select && control.selector.select.optionsCondition) {\n        const options = card._evaluateCondition(control.selector.select.optionsCondition, context);\n        control.selector.select.options = options;\n    }\n    switch (control.type) {\n        case 'Selector':\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                <ha-selector\n                    .hass=${card._hass}\n                    .selector=${control.selector}\n                    .configValue=${control.configValue}\n                    .value=${(0, exports.getNestedProperty)(card._config, control.configValue)}\n                    .label=${control.label}\n                    .helper=${control.helper}\n                    .disabled=${isDisabled}\n                    .required=${isRequired}\n                    @value-changed=${card._valueChanged}\n                ></ha-selector>\n                </div>\n                `;\n        case 'Filler':\n            return (0, lit_1.html) `<div class=\"form-control\"></div>`;\n        case 'Divider':\n            return (0, lit_1.html) `<hr>`;\n        case 'Message':\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    <ha-alert alert-type=${control.alertType || \"info\"} title=${control.title || \"\"}>\n                        ${control.message || \"\"}\n                    </ha-alert>\n                </div>\n            `;\n        case 'RawHTML':\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    ${(0, unsafe_html_js_1.unsafeHTML)(control.html || \"\")}\n                </div>\n            `;\n        case 'ColorPreview':\n            let colorValue = (0, exports.getNestedProperty)(card._config, control.configValue);\n            //console.log('colorValue:', colorValue);\n            // Provide a default color value if colorValue is not set\n            let displayText;\n            if (!colorValue) {\n                colorValue = '#1B1B249A';\n                displayText = 'Color Not Set';\n            }\n            else {\n                displayText = colorValue;\n            }\n            // Check if colorValue is a CSS variable or a hex color\n            const isCssVariable = colorValue.startsWith('var(');\n            let computedColorValue = colorValue;\n            if (isCssVariable) {\n                // Extract the CSS variable name from colorValue\n                const cssVariableNameMatch = colorValue.match(/var\\((--[^,)]+)\\)/);\n                const cssVariableName = cssVariableNameMatch ? cssVariableNameMatch[1] : colorValue;\n                //console.log('cssVariableName:', cssVariableName);\n                // Get the computed color value directly\n                computedColorValue = getComputedStyle(document.documentElement).getPropertyValue(cssVariableName).trim();\n                //console.log('computedColorValue:', computedColorValue);\n                // Check if computedColorValue is empty and provide a fallback\n                if (!computedColorValue) {\n                    console.warn(`CSS variable ${cssVariableName} is not defined. Using fallback color.`);\n                    computedColorValue = '#0000ff'; // Fallback to a nice blue color\n                }\n            }\n            else if (colorValue !== '#1B1B249A') {\n                displayText = 'User Defined Color';\n            }\n            // Function to convert hex color to RGB\n            const hexToRgb = (hex) => {\n                // Remove the hash at the start if it's there\n                hex = hex.replace(/^#/, '');\n                // Check if the hex includes an alpha channel\n                let bigint;\n                let r, g, b, a;\n                if (hex.length === 8) {\n                    // Parse the r, g, b, a values\n                    bigint = parseInt(hex, 16);\n                    r = (bigint >> 24) & 255;\n                    g = (bigint >> 16) & 255;\n                    b = (bigint >> 8) & 255;\n                    a = bigint & 255;\n                    return [r, g, b, a / 255]; // Return alpha as a normalized value (0 to 1)\n                }\n                else {\n                    // Parse the r, g, b values\n                    bigint = parseInt(hex, 16);\n                    r = (bigint >> 16) & 255;\n                    g = (bigint >> 8) & 255;\n                    b = bigint & 255;\n                    return [r, g, b];\n                }\n            };\n            // Function to convert RGB string to luminance\n            const getLuminance = (hex) => {\n                //console.log('Hex input to getLuminance:', hex);\n                const [r, g, b] = hexToRgb(hex);\n                //console.log('Parsed RGB values:', [r, g, b]);\n                const [nr, ng, nb] = [r, g, b].map(value => value / 255).map(value => {\n                    return value <= 0.03928 ? value / 12.92 : Math.pow((value + 0.055) / 1.055, 2.4);\n                });\n                //console.log('Normalized RGB values:', [nr, ng, nb]);\n                return 0.2126 * nr + 0.7152 * ng + 0.0722 * nb;\n            };\n            // Determine text color based on luminance\n            const luminance = getLuminance(computedColorValue);\n            //console.log('Luminance:', luminance);\n            const textColor = luminance > 0.5 ? '#000' : '#fff';\n            //console.log('textColor:', textColor);\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    <div style=\"-webkit-fill-available; height: 50px; background-color: ${colorValue}; border-radius: 25px; border: 1px solid #000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: ${textColor};\">\n                        <div>${displayText}</div>\n                        <div>${computedColorValue}</div>\n                    </div>\n                </div>\n            `;\n        default:\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    <ha-alert alert-type=\"error\" title=\"Unsupported Control Type\">\n                    The control type \"${control.type}\" is not supported.\n                </ha-alert>\n                </div>\n                `;\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst custom_card_helpers_1 = require(\"custom-card-helpers\");\nconst lit_1 = require(\"lit\");\nconst unsafe_html_js_1 = require(\"lit/directives/unsafe-html.js\");\nconst interfaces_1 = require(\"./interfaces\");\nconst controls_1 = require(\"./controls\");\nclass EditorForm extends lit_1.LitElement {\n    constructor() {\n        super(...arguments);\n        this._selectedTab = \"panel-0\"; // Default to first tab\n        this._userStyles = (0, lit_1.css) ``;\n        this._mergeUserStyles = true;\n    }\n    setConfig(config) {\n        this._config = config;\n        this.requestUpdate(\"_config\");\n    }\n    set hass(hass) {\n        this._hass = hass;\n    }\n    generateForm(cardConfigData) {\n        if (!cardConfigData) {\n            return (0, lit_1.html) ``;\n        }\n        if (cardConfigData.tabs) {\n            return this.generateTabs(cardConfigData.tabs);\n        }\n        else {\n            const formControls = cardConfigData.render_form.map((row) => {\n                if ((0, interfaces_1.isSection)(row)) {\n                    return this.generateSection(row);\n                }\n                else {\n                    return this.generateRow(row);\n                }\n            });\n            return (0, lit_1.html) `\n            <div class=\"card-form\">\n                ${formControls}\n            </div>\n        `;\n        }\n    }\n    _handleTabActivated(event) {\n        this._selectedTab = event.detail.name;\n        this.requestUpdate();\n    }\n    generateTabs(tabs) {\n        const visibleTabs = tabs.filter(tab => this._evaluateCondition(tab.visibilityCondition || \"true\"));\n        return (0, lit_1.html) `\n            <sl-tab-group @sl-tab-show=${this._handleTabActivated}>\n                ${visibleTabs.map((tab, index) => (0, lit_1.html) `\n                    <sl-tab slot=\"nav\" panel=\"panel-${index}\" ?active=${this._selectedTab === `panel-${index}`}>\n                        ${tab.label}\n                    </sl-tab>\n                `)}\n            </sl-tab-group>\n            <div class=\"tab-content\">\n                ${visibleTabs.map((tab, index) => (0, lit_1.html) `\n                    <sl-tab-panel name=\"panel-${index}\" ?hidden=${this._selectedTab !== `panel-${index}`}>\n                        ${tab.content.map(item => {\n            if (item.type === \"Section\") {\n                return this.generateSection(item);\n            }\n            else {\n                return this.generateRow(item);\n            }\n        })}\n                    </sl-tab-panel>\n                `)}\n            </div>\n        `;\n    }\n    generateSection(section) {\n        var _a;\n        if (section.visibilityCondition && !this._evaluateCondition(section.visibilityCondition)) {\n            return (0, lit_1.html) ``;\n        }\n        const cssClass = section.cssClass ? `form-row ${section.cssClass}` : \"form-row\";\n        // Create the header element programmatically\n        const headerLevel = section.headerLevel || 4;\n        const headerTag = `h${headerLevel}`;\n        const headerContent = `\n            <${headerTag} slot=\"header\">\n                ${section.icon ? `<ha-icon icon=\"${section.icon}\"></ha-icon>` : ''}\n                ${section.label}\n                ${section.secondary ? `<div slot=\"secondary\">${section.secondary}</div>` : ''}\n            </${headerTag}>\n        `;\n        return (0, lit_1.html) `\n            <div class=\"${cssClass}\">\n                <ha-expansion-panel\n                    .expanded=${section.expanded || false}\n                    .noCollapse=${section.noCollapse || false}\n                    .outlined=${section.outlined || true}\n                    .leftChevron=${section.leftChevron || false}\n                    .secondary=${section.secondary || ''}\n                >\n                    ${(0, unsafe_html_js_1.unsafeHTML)(headerContent)}\n                    <div>\n                        ${(_a = section.rows) === null || _a === void 0 ? void 0 : _a.map(row => (0, interfaces_1.isSection)(row) ? this.generateSection(row) : this.generateRow(row))}\n                    </div>\n                </ha-expansion-panel>\n            </div>\n        `;\n    }\n    generateRow(row) {\n        if (row.visibilityCondition && !this._evaluateCondition(row.visibilityCondition)) {\n            return (0, lit_1.html) ``;\n        }\n        const cssClass = row.cssClass ? `form-row ${row.cssClass}` : \"form-row\";\n        return (0, lit_1.html) `\n            <div class=\"${cssClass}\">\n                ${row.label ? (0, lit_1.html) `<label>${row.label}</label>` : ''}\n                ${row.controls.map(control => {\n            if (control.visibilityCondition && !this._evaluateCondition(control.visibilityCondition)) {\n                return (0, lit_1.html) ``;\n            }\n            return (0, controls_1.generateControl)(control, this);\n        })}\n            </div>\n        `;\n    }\n    _evaluateCondition(condition, context = {}) {\n        try {\n            return new Function('context', 'with(context) { return ' + condition + '; }').call(this, context);\n        }\n        catch (e) {\n            console.error('Error evaluating condition:', condition, e);\n            return false;\n        }\n    }\n    _valueChanged(ev) {\n        var _a, _b;\n        if (!this._config || !this._hass) {\n            return;\n        }\n        const target = ev.target; // Cast to a more specific type\n        //console.debug(\"target\", target);\n        //console.debug(\"ev.detail\", ev.detail);\n        // Extract the config path from the control\n        const configPath = (_b = (_a = target.configValue) === null || _a === void 0 ? void 0 : _a.split(\".\")) !== null && _b !== void 0 ? _b : [];\n        //console.debug(\"configPath: \", configPath);\n        // Get the new value based on the control type and event details\n        const newValue = this._getNewValue(target, ev.detail);\n        //console.debug(\"newValue: \", newValue);\n        // Determine if the control is a checkbox\n        // const isCheckbox = target.tagName === \"HA-CHECKBOX\";\n        // Determine if the control is handling an array\n        const isArray = target.tagName === \"HA-SELECTOR\" && Array.isArray(ev.detail.value);\n        // Update the config using a helper function\n        this._updateConfig(configPath, newValue, isArray);\n        // Fire the \"config-changed\" event\n        (0, custom_card_helpers_1.fireEvent)(this, \"config-changed\", { config: this._config }, { bubbles: true, composed: true });\n        // Request an update to reflect changes\n        this.requestUpdate();\n    }\n    // Helper function to extract the new value based on control type\n    _getNewValue(target, detail) {\n        var _a, _b, _c;\n        switch (target.tagName) {\n            case \"HA-SELECTOR\":\n                return detail === null || detail === void 0 ? void 0 : detail.value;\n            case \"HA-SWITCH\":\n                return (_a = target.checked) !== null && _a !== void 0 ? _a : target.__checked;\n            case \"HA-CHECKBOX\":\n                return target.value;\n            case \"HA-FORM\":\n                return Object.values((_b = detail === null || detail === void 0 ? void 0 : detail.value) !== null && _b !== void 0 ? _b : {})[0];\n            default:\n                return (_c = detail === null || detail === void 0 ? void 0 : detail.value) !== null && _c !== void 0 ? _c : target.value;\n        }\n    }\n    _updateConfig(configPath, newValue, isArray = false) {\n        if (!configPath.length) {\n            return;\n        }\n        const configPathString = configPath.join(\".\");\n        let config = { ...this._config };\n        let nestedConfig = config;\n        for (let i = 0; i < configPath.length - 1; i++) {\n            nestedConfig[configPath[i]] = nestedConfig[configPath[i]] || {};\n            nestedConfig = nestedConfig[configPath[i]];\n        }\n        const lastKey = configPath[configPath.length - 1];\n        // Handle single value or array case\n        if (newValue === \"\" || newValue === null || newValue === undefined) {\n            delete nestedConfig[lastKey];\n        }\n        else {\n            nestedConfig[lastKey] = newValue;\n        }\n        this._config = (0, controls_1.deepMerge)(this._config, config);\n    }\n    updated(changedProperties) {\n        super.updated(changedProperties);\n        const constructor = this.constructor;\n        //this.shadowRoot.adoptedStyleSheets = [constructor.styles.styleSheet, this._userStyles.styleSheet];\n        if (this._mergeUserStyles) {\n            this.shadowRoot.adoptedStyleSheets = [constructor.styles.styleSheet, this._userStyles.styleSheet];\n        }\n        else {\n            this.shadowRoot.adoptedStyleSheets = [this._userStyles.styleSheet];\n        }\n    }\n    static get styles() {\n        const baseStyles = (0, lit_1.css) `\n            /* Base styles for the form container */\n            .card-form {\n                display: grid;\n                grid-gap: 8px;\n            }\n\n             /* Styles for tabs */\n            mwc-tab-bar {\n                border-bottom: 1px solid var(--divider-color);\n            }\n            .tab-content {\n                padding: 10px;\n            }\n            .tab-panel {\n                display: none;\n            }\n            .tab-panel:not([hidden]) {\n                display: block;\n            }\n            /* Base styles for form rows */\n            .form-row {\n                display: grid;\n                grid-template-columns: 1fr;\n                grid-gap: 8px;\n                /* margin-bottom: 10px; */\n                border-radius: 10px;\n            }\n\n            /* Styles for form rows with two controls */\n            .form-row.two-controls {\n                grid-template-columns: 1fr 1fr;\n            }\n            /* Labels in form rows with two controls */\n            .form-row.two-controls label {\n                grid-column: span 2; /* Make the label span across both columns */\n                justify-self: start; /* Left-justify the label */\n                font-weight: bold;\n                height: auto;\n                margin-bottom: 5px; /* Add some space below the label */\n                padding-left: 8px;\n            }\n\n            /* ensure full width for form controls not in two-controls class */\n\n            .form-row:not(.two-controls) .form-control > * {\n                width: -webkit-fill-available;\n            }\n\n            /* Base styles for form controls */\n            .form-control {\n                display: flex; /* Use flexbox for internal alignment */\n                align-items: center;\n                padding: 8px;\n                border-radius: 10px;\n            }\n\n            /* Label styles within form controls */\n            .form-control label {\n                font-weight: bold;\n                padding-left: 8px;\n            }\n\n            /* Styles for expandable sections */\n            ha-expansion-panel {\n                margin-bottom: 10px;\n                border-radius: var(--ha-card-border-radius, 34px);\n            }\n            ha-expansion-panel[outlined] {\n                border: 2px solid var(--chip-background-color);\n            }\n            ha-expansion-panel[expanded] {\n                background-color: var(--chip-background-color);\n            }\n            h1 > ha-icon,\n            h2 > ha-icon,\n            h3 > ha-icon,\n            h4 > ha-icon,\n            h5 > ha-icon,\n            h6 > ha-icon {\n                margin: 0 8px;\n            }\n\n            hr {\n                width: 95%;\n                border: 1px solid var(--chip-background-color);\n            }\n\n            /* Styles for form errors */\n            .form-error {\n                color: var(--error-color); /* Home Assistant theme color */\n                font-size: 0.875em;\n                margin-top: 5px;\n            }\n        `;\n        return baseStyles;\n    }\n}\nexports.default = EditorForm;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isSection = isSection;\nexports.isControlRow = isControlRow;\nfunction isSection(row) {\n    return row.type === 'Section';\n}\nfunction isControlRow(row) {\n    return row.type === 'ControlRow';\n}\n","//CB-LCARS main verson from package.json\nconst packageJson = require('../package.json');\nexport const CBLCARS_VERSION = packageJson.version;\nexport const project_url = \"https://cb-lcars.unimatrix01.ca\";\n\n\nexport const core_fonts = [\n        'https://fonts.googleapis.com/css2?family=Antonio:wght@100;700&display=swap',\n        'cb-lcars_jeffries',\n        'cb-lcars_microgramma'\n    ];\n\n\n//CB-LARS yaml configuration files (templates, strategies, editor forms, etc.)\nexport const templates_uri = '/hacsfiles/cb-lcars/cb-lcars-lovelace.yaml';\nexport const stub_config_uri = '/hacsfiles/cb-lcars/cb-lcars-stub-config.yaml';\nexport const theme_colors_uri = '/hacsfiles/cb-lcars/cb-lcars-themes.yaml';\nexport const airlock_uri = '/hacsfiles/cb-lcars/cb-lcars-airlock.yaml';\nexport const gallery_uri = '/hacsfiles/cb-lcars/cb-lcars-gallery.yaml';\n//export const card_editor_uri = '/hacsfiles/cb-lcars/cb-lcars-card-editor-forms.yaml'\nexport const card_editor_uri = '/hacsfiles/cb-lcars/editor'\nexport const gallery_views_uris = [\n        '/hacsfiles/cb-lcars/cb-lcars-gallery.yaml',\n        '/hacsfiles/cb-lcars/cb-lcars-gallery-buttons.yaml',\n        '/hacsfiles/cb-lcars/cb-lcars-gallery-elbows.yaml',\n        '/hacsfiles/cb-lcars/cb-lcars-gallery-multimeter.yaml'\n    ]\n\nexport const builtin_svg_keys = [\n    'ncc-1701-a',\n    'ncc-1701-a-blue',\n    'enterprise-d-shuttlecraft15-anomaly',\n    // Add more built-in SVG keys here (without .svg extension)\n    ];\nexport const builtin_svg_basepath = '/hacsfiles/cb-lcars/msd/';\n","/**\n * DataSource Integration Mixin - Reusable DataSource integration methods\n * Provides consistent DataSource access, template processing, and value formatting\n * across all overlay renderers.\n */\n\nexport class DataSourceMixin {\n  /**\n   * Resolve content from various sources including DataSource integration\n   * @param {Object} source - Source object (overlay, cell, etc.)\n   * @param {Object} style - Style configuration\n   * @param {string} rendererName - Name of the renderer for logging\n   * @returns {string} Resolved content\n   */\n  static resolveContent(source, style, rendererName = 'Renderer') {\n    let content = style.value || source.text || source.content || source.label || '';\n\n    // Check raw configuration if content not found in standard properties\n    if (!content && source._raw?.content) {\n      content = source._raw.content;\n    }\n    if (!content && source._raw?.text) {\n      content = source._raw.text;\n    }\n    if (!content && source._raw?.label) {\n      content = source._raw.label;\n    }\n\n    // Check for data_source reference in raw if not found in main source\n    if (!source.data_source && source._raw?.data_source) {\n      source.data_source = source._raw.data_source;\n    }\n\n    // Enhanced template string processing for DataSource references (only if content has templates)\n    if (content && typeof content === 'string' && content.includes('{')) {\n      content = this.processEnhancedTemplateStrings(content, rendererName);\n      return content;\n    }\n\n    // If we have basic content, return it\n    if (content) {\n      return content;\n    }\n\n    // Direct DataSource integration for dynamic content (only as fallback when no basic content)\n    if (source.data_source || style.data_source) {\n      const dataSourceContent = this.resolveDataSourceContent(source.data_source || style.data_source, style, rendererName);\n      if (dataSourceContent !== null) {\n        return dataSourceContent;\n      }\n    }\n\n    return content; // Return whatever we found (might be empty string)\n  }\n\n  /**\n   * Resolve content directly from DataSource references\n   * @param {string} dataSourceRef - DataSource reference string\n   * @param {Object} style - Style configuration for formatting\n   * @param {string} rendererName - Name of the renderer for logging\n   * @returns {string|null} Resolved content or null if unavailable\n   */\n  static resolveDataSourceContent(dataSourceRef, style, rendererName = 'Renderer') {\n    try {\n      const dataSourceManager = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n      if (!dataSourceManager) {\n        // DataSourceManager not available - this is normal during initial rendering\n        return null;\n      }\n\n      // Parse DataSource reference (support dot notation)\n      const { sourceName, dataKey, isTransformation, isAggregation } = this.parseDataSourceReference(dataSourceRef);\n      const dataSource = dataSourceManager.getSource(sourceName);\n\n      if (!dataSource) {\n        console.warn(`[${rendererName}] DataSource '${sourceName}' not found`);\n        return `[Source: ${sourceName} not found]`;\n      }\n\n      const currentData = dataSource.getCurrentData();\n      let value = currentData?.v;\n\n      // Access enhanced data if specified\n      if (dataKey && isTransformation && currentData?.transformations) {\n        value = currentData.transformations[dataKey];\n      } else if (dataKey && isAggregation && currentData?.aggregations) {\n        const aggData = currentData.aggregations[dataKey];\n        // Handle complex aggregation objects\n        if (typeof aggData === 'object' && aggData !== null) {\n          if (aggData.avg !== undefined) value = aggData.avg;\n          else if (aggData.value !== undefined) value = aggData.value;\n          else if (aggData.last !== undefined) value = aggData.last;\n          else value = JSON.stringify(aggData);\n        } else {\n          value = aggData;\n        }\n      }\n\n      // Format the value\n      if (value !== null && value !== undefined) {\n        return this.formatDataSourceValue(value, style, currentData);\n      }\n\n      return `[${dataSourceRef}: no data]`;\n\n    } catch (error) {\n      console.error(`[${rendererName}] Error resolving DataSource content:`, error);\n      return `[DataSource Error: ${error.message}]`;\n    }\n  }\n\n  /**\n   * Parse DataSource reference to support dot notation\n   * @param {string} dataSourceRef - Reference like 'source_name' or 'source_name.transformations.key'\n   * @returns {Object} Parsed reference details\n   */\n  static parseDataSourceReference(dataSourceRef) {\n    const parts = dataSourceRef.split('.');\n    const sourceName = parts[0];\n\n    if (parts.length === 1) {\n      return { sourceName, dataKey: null, isTransformation: false, isAggregation: false };\n    }\n\n    if (parts.length >= 3) {\n      const dataType = parts[1];\n      const dataKey = parts.slice(2).join('.');\n      return {\n        sourceName,\n        dataKey,\n        isTransformation: dataType === 'transformations',\n        isAggregation: dataType === 'aggregations'\n      };\n    }\n\n    return { sourceName, dataKey: null, isTransformation: false, isAggregation: false };\n  }\n\n  /**\n   * Format DataSource values with optional formatting\n   * @param {any} value - Value to format\n   * @param {Object} style - Style configuration containing format options\n   * @param {Object} [dataSourceData] - Full DataSource data for unit context\n   * @returns {string} Formatted value\n   */\n  static formatDataSourceValue(value, style, dataSourceData = null) {\n    const format = style.value_format || style.format;\n\n    if (typeof format === 'function') {\n      return format(value);\n    }\n\n    if (typeof format === 'string') {\n      if (format.includes('{value')) {\n        return format.replace(/\\{value(?::([^}]+))?\\}/g, (match, formatSpec) => {\n          if (formatSpec) {\n            return this.applyNumberFormat(value, formatSpec, dataSourceData?.unit_of_measurement);\n          }\n          return String(value);\n        });\n      }\n      return format.replace('{value}', String(value));\n    }\n\n    // Default formatting based on value type\n    if (typeof value === 'number') {\n      if (Number.isInteger(value)) {\n        return String(value);\n      } else {\n        return value.toFixed(1);\n      }\n    }\n\n    return String(value);\n  }\n\n  /**\n   * Apply number formatting specifications with unit-aware intelligence\n   * @param {number} value - Numeric value to format\n   * @param {string} formatSpec - Format specification like \".1f\", \".2%\", \"d\"\n   * @param {string} [unitOfMeasurement] - Original entity's unit_of_measurement for intelligent formatting\n   * @returns {string} Formatted value\n   */\n  static applyNumberFormat(value, formatSpec, unitOfMeasurement) {\n    if (typeof value !== 'number') return String(value);\n\n    // Parse format specifications like \".1f\", \".2%\", \"d\", etc.\n    if (formatSpec.endsWith('%')) {\n      const precision = parseInt(formatSpec.slice(1, -1)) || 0;\n\n      // UNIT-AWARE: Check if the source entity already has % units\n      if (unitOfMeasurement === '%') {\n        // Already a percentage (0-100), don't multiply by 100\n        console.log(`[DataSourceMixin] Unit-aware formatting: ${value} with unit=\"${unitOfMeasurement}\" → ${value.toFixed(precision)}% (no conversion)`);\n        return `${value.toFixed(precision)}%`;\n      } else {\n        // Decimal value (0.0-1.0) or other unit, multiply by 100\n        console.log(`[DataSourceMixin] Unit-aware formatting: ${value} with unit=\"${unitOfMeasurement || 'none'}\" → ${(value * 100).toFixed(precision)}% (×100 conversion)`);\n        return `${(value * 100).toFixed(precision)}%`;\n      }\n    }\n\n    if (formatSpec.endsWith('f')) {\n      const precision = parseInt(formatSpec.slice(1, -1)) || 1;\n      return value.toFixed(precision);\n    }\n\n    if (formatSpec === 'd') {\n      return Math.round(value).toString();\n    }\n\n    // Fallback\n    return String(value);\n  }\n\n  /**\n   * Enhanced template string processing with DataSource support\n   * @param {string} content - Template string with {references}\n   * @param {string} rendererName - Name of the renderer for logging\n   * @returns {string} Processed content with resolved references\n   */\n  static processEnhancedTemplateStrings(content, rendererName = 'Renderer') {\n    // Use the new unified method with fallback to original content for backwards compatibility\n    return this.processEnhancedTemplateStringsWithFallback(content, rendererName, true);\n  }\n\n  /**\n   * Process template for initial render with unified strategy\n   * @param {string} content - Template string with {references}\n   * @param {string} rendererName - Name of the renderer for logging\n   * @returns {string} Processed content, gracefully handling unavailable DataSources\n   */\n  static processTemplateForInitialRender(content, rendererName = 'Renderer') {\n    if (!content || typeof content !== 'string' || !content.includes('{')) {\n      return content;\n    }\n\n    console.log(`[${rendererName}] Processing template for initial render: \"${content}\"`);\n\n    // Try to process templates, but gracefully fall back to original content\n    const processed = this.processEnhancedTemplateStringsWithFallback(content, rendererName, true);\n\n    // If processing didn't change the content, DataSources might not be ready\n    if (processed === content) {\n      console.log(`[${rendererName}] Templates not resolved during initial render, will update when DataSources become available`);\n    }\n\n    return processed;\n  }\n\n  /**\n   * Enhanced template string processing with better fallback handling\n   * @param {string} content - Template string with {references}\n   * @param {string} rendererName - Name of the renderer for logging\n   * @param {boolean} fallbackToOriginal - Whether to return original content if DataSources unavailable\n   * @returns {string} Processed content with resolved references\n   */\n  static processEnhancedTemplateStringsWithFallback(content, rendererName = 'Renderer', fallbackToOriginal = true) {\n    try {\n      const dataSourceManager = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n      if (!dataSourceManager) {\n        // DataSourceManager not available - this is normal during initial rendering\n        console.log(`[${rendererName}] DataSourceManager not available, ${fallbackToOriginal ? 'returning original content' : 'returning null'}`);\n        return fallbackToOriginal ? content : null;\n      }\n\n      // Enhanced template pattern to capture DataSource references and formatting\n      let hasUnresolvedTemplates = false;\n      const processedContent = content.replace(/\\{([^}]+)\\}/g, (match, reference) => {\n        try {\n          // Parse reference and optional formatting: {source.transformations.key:.2f}\n          const [dataSourceRef, formatSpec] = reference.split(':');\n          const cleanRef = dataSourceRef.trim();\n\n          const { sourceName, dataKey, isTransformation, isAggregation } = this.parseDataSourceReference(cleanRef);\n          const dataSource = dataSourceManager.getSource(sourceName);\n\n          if (!dataSource) {\n            console.warn(`[${rendererName}] DataSource '${sourceName}' not found`);\n            hasUnresolvedTemplates = true;\n            return fallbackToOriginal ? match : `[Source: ${sourceName} not found]`;\n          }\n\n          const currentData = dataSource.getCurrentData();\n          let value = currentData?.v;\n\n          // Access enhanced data\n          if (dataKey && isTransformation && currentData?.transformations) {\n            value = currentData.transformations[dataKey];\n          } else if (dataKey && isAggregation && currentData?.aggregations) {\n            const aggData = currentData.aggregations[dataKey];\n            if (typeof aggData === 'object' && aggData !== null) {\n              // Handle nested object access\n              const nestedKeys = dataKey.split('.');\n              if (nestedKeys.length > 1) {\n                const baseKey = nestedKeys[0];\n                const nestedKey = nestedKeys.slice(1).join('.');\n                const baseData = currentData.aggregations[baseKey];\n                if (baseData && typeof baseData === 'object') {\n                  value = this.getNestedValue(baseData, nestedKey);\n                }\n              } else {\n                // Standard aggregation object handling\n                if (aggData.avg !== undefined) value = aggData.avg;\n                else if (aggData.value !== undefined) value = aggData.value;\n                else if (aggData.last !== undefined) value = aggData.last;\n                else if (aggData.direction !== undefined) value = aggData.direction;\n                else value = JSON.stringify(aggData);\n              }\n            } else {\n              value = aggData;\n            }\n          }\n\n          if (value === null || value === undefined) {\n            console.warn(`[${rendererName}] No value found for reference '${reference}'`);\n            hasUnresolvedTemplates = true;\n            return fallbackToOriginal ? match : `[No data: ${reference}]`;\n          }\n\n          // Apply formatting if specified\n          if (formatSpec) {\n            return this.applyNumberFormat(value, formatSpec.trim(), currentData?.unit_of_measurement);\n          }\n\n          return String(value);\n\n        } catch (error) {\n          console.error(`[${rendererName}] Template processing error for '${reference}':`, error);\n          hasUnresolvedTemplates = true;\n          return fallbackToOriginal ? match : `[Error: ${reference}]`;\n        }\n      });\n\n      // Log whether templates were successfully resolved\n      if (!hasUnresolvedTemplates && processedContent !== content) {\n        console.log(`[${rendererName}] Successfully resolved all templates in: \"${content}\" → \"${processedContent}\"`);\n      }\n\n      return processedContent;\n\n    } catch (error) {\n      console.error(`[${rendererName}] Enhanced template processing failed:`, error);\n      return fallbackToOriginal ? content : null;\n    }\n  }\n\n  /**\n   * Get nested value from object using dot notation\n   * @param {Object} obj - Object to traverse\n   * @param {string} path - Dot-separated path\n   * @returns {any} Nested value or undefined\n   */\n  static getNestedValue(obj, path) {\n    return path.split('.').reduce((current, key) => {\n      return current && current[key] !== undefined ? current[key] : undefined;\n    }, obj);\n  }\n\n  /**\n   * Check if DataSourceManager is available\n   * @returns {Object|null} DataSourceManager instance or null\n   */\n  static getDataSourceManager() {\n    return window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager || null;\n  }\n\n  /**\n   * Get available DataSource names\n   * @returns {Array<string>} Array of DataSource names\n   */\n  static getAvailableDataSources() {\n    const dsm = this.getDataSourceManager();\n    return dsm ? Array.from(dsm.sources.keys()) : [];\n  }\n}\n\n// Export for use in renderers\nexport default DataSourceMixin;","/**\n * Position Resolver - Utility for resolving positions and anchor points\n */\n\nexport class PositionResolver {\n  static resolvePosition(position, anchors) {\n    if (Array.isArray(position) && position.length >= 2) {\n      return [Number(position[0]), Number(position[1])];\n    }\n\n    if (typeof position === 'string' && anchors[position]) {\n      const anchorPos = anchors[position];\n      if (Array.isArray(anchorPos) && anchorPos.length >= 2) {\n        return [Number(anchorPos[0]), Number(anchorPos[1])];\n      }\n    }\n\n    console.warn('[PositionResolver] Could not resolve position:', position);\n    return null;\n  }\n}\n","/**\n * Shared Renderer Utilities - Common functionality for all renderers\n * Provides reusable components for gradients, patterns, filters, and effects\n */\n\nexport class RendererUtils {\n\n\n  /**\n   * Text measurement utilities using HTML Canvas\n   * Static methods for precise text dimension calculations\n   */\n\n  /**\n   * Get or create cached canvas context for text measurements\n   * @private\n   * @returns {CanvasRenderingContext2D}\n   */\n  static _getTextMeasureContext() {\n    if (!window.cblcars) window.cblcars = {};\n\n    if (!window.cblcars._textMeasureCanvas) {\n      window.cblcars._textMeasureCanvas = document.createElement(\"canvas\");\n      window.cblcars._textMeasureContext = window.cblcars._textMeasureCanvas.getContext(\"2d\");\n      window.cblcars._textMeasureCache = new Map();\n    }\n\n    return window.cblcars._textMeasureContext;\n  }\n\n  /**\n   * Get the SVG container and its current transformation matrix\n   * @param {Element} containerElement - The SVG container element\n   * @returns {Object|null} Object with svg element and transformation info\n   */\n  static _getSvgTransformInfo(containerElement) {\n    try {\n      const svg = containerElement?.querySelector('svg');\n      if (!svg) return null;\n\n      // Get the viewBox and current dimensions\n      const viewBox = svg.viewBox.baseVal;\n      const rect = svg.getBoundingClientRect();\n\n      // Calculate scale factors\n      const scaleX = viewBox.width / rect.width;\n      const scaleY = viewBox.height / rect.height;\n\n      return {\n        svg,\n        viewBox: [viewBox.x, viewBox.y, viewBox.width, viewBox.height],\n        screenRect: { width: rect.width, height: rect.height },\n        scaleX,\n        scaleY,\n        // For pixel-to-viewbox conversion\n        pixelToViewBox: (pixelSize) => pixelSize * Math.max(scaleX, scaleY)\n      };\n    } catch (error) {\n      console.warn('[RendererUtils] Failed to get SVG transform info:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Measure text dimensions using canvas context\n   * @param {string} text - Text to measure\n   * @param {string} font - CSS font string (e.g., \"bold 16px Arial\")\n   * @param {boolean} useCache - Whether to use cached measurements\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {{width: number, height: number, ascent: number, descent: number}}\n   */\n  static measureText(text, font = \"16px Arial\", useCache = true, containerElement = null) {\n    if (!text) return { width: 0, height: 0, ascent: 0, descent: 0 };\n\n    const cacheKey = `${text}::${font}`;\n    const cache = window.cblcars?._textMeasureCache;\n\n    if (useCache && cache && cache.has(cacheKey)) {\n      const cached = cache.get(cacheKey);\n\n      // Apply coordinate transformation if container provided\n      if (containerElement) {\n        return this._transformTextMetrics(cached, containerElement);\n      }\n\n      return cached;\n    }\n\n    const ctx = this._getTextMeasureContext();\n    ctx.font = font;\n    const metrics = ctx.measureText(text);\n\n    const result = {\n      width: metrics.width,\n      height: metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent,\n      ascent: metrics.actualBoundingBoxAscent,\n      descent: metrics.actualBoundingBoxDescent,\n      actualLeft: metrics.actualBoundingBoxLeft || 0,\n      actualRight: metrics.actualBoundingBoxRight || metrics.width,\n      // Store original pixel values for transformation\n      _pixelWidth: metrics.width,\n      _pixelHeight: metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent,\n      _pixelAscent: metrics.actualBoundingBoxAscent,\n      _pixelDescent: metrics.actualBoundingBoxDescent\n    };\n\n    if (useCache && cache) {\n      cache.set(cacheKey, result);\n    }\n\n    // Apply coordinate transformation if container provided\n    if (containerElement) {\n      return this._transformTextMetrics(result, containerElement);\n    }\n\n    return result;\n  }\n\n  /**\n   * Transform text metrics from pixel space to viewBox coordinate space\n   * @private\n   * @param {Object} metrics - Original pixel-based metrics\n   * @param {Element} containerElement - SVG container for transformation\n   * @returns {Object} Transformed metrics in viewBox coordinates\n   */\n  static _transformTextMetrics(metrics, containerElement) {\n    const transformInfo = this._getSvgTransformInfo(containerElement);\n    if (!transformInfo) {\n      // No transformation available - return original metrics\n      console.warn('[RendererUtils] No transform info available, using pixel metrics');\n      return metrics;\n    }\n\n    const { pixelToViewBox } = transformInfo;\n\n    const transformed = {\n      ...metrics,\n      width: pixelToViewBox(metrics._pixelWidth || metrics.width),\n      height: pixelToViewBox(metrics._pixelHeight || metrics.height),\n      ascent: pixelToViewBox(metrics._pixelAscent || metrics.ascent),\n      descent: pixelToViewBox(metrics._pixelDescent || metrics.descent),\n      actualLeft: pixelToViewBox(metrics.actualLeft),\n      actualRight: pixelToViewBox(metrics.actualRight)\n    };\n\n    console.log('[RendererUtils] Transformed text metrics:', {\n      original: {\n        width: metrics.width,\n        height: metrics.height\n      },\n      transformed: {\n        width: transformed.width,\n        height: transformed.height\n      },\n      scaleInfo: {\n        scaleX: transformInfo.scaleX,\n        scaleY: transformInfo.scaleY\n      }\n    });\n\n    return transformed;\n  }\n\n  /**\n   * Measure multiline text with proper line spacing and coordinate transformation\n   * @param {string} text - Multiline text (with \\n separators)\n   * @param {string} font - CSS font string\n   * @param {number} lineHeight - Line height multiplier (default 1.2)\n   * @param {boolean} useCache - Whether to use cached measurements\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {{width: number, height: number, lines: Array, lineMetrics: Array}}\n   */\n  static measureMultilineText(text, font = \"16px Arial\", lineHeight = 1.2, useCache = true, containerElement = null) {\n    if (!text) return { width: 0, height: 0, lines: [], lineMetrics: [] };\n\n    const lines = text.split('\\n');\n    const lineMetrics = lines.map(line => this.measureText(line, font, useCache, containerElement));\n\n    const maxWidth = Math.max(...lineMetrics.map(m => m.width));\n    const fontSize = this._parseFontSize(font);\n\n    // Apply transformation to fontSize if container provided\n    let adjustedFontSize = fontSize;\n    let adjustedLineHeight = lineHeight;\n\n    if (containerElement) {\n      const transformInfo = this._getSvgTransformInfo(containerElement);\n      if (transformInfo) {\n        adjustedFontSize = transformInfo.pixelToViewBox(fontSize);\n        // Line height is a multiplier, so we need to apply it to the transformed font size\n        adjustedLineHeight = lineHeight;\n      }\n    }\n\n    const totalHeight = lines.length > 1\n      ? lineMetrics[0].ascent + ((lines.length - 1) * adjustedFontSize * adjustedLineHeight) + lineMetrics[lineMetrics.length - 1].descent\n      : lineMetrics[0]?.height || 0;\n\n    return {\n      width: maxWidth,\n      height: totalHeight,\n      lines,\n      lineMetrics,\n      // Store transform info for debugging\n      _transformApplied: !!containerElement,\n      _adjustedFontSize: adjustedFontSize\n    };\n  }\n\n  /**\n   * Calculate text bounding box at specific position with proper coordinate transformation\n   * @param {string} text - Text content\n   * @param {number} x - X position in viewBox coordinates\n   * @param {number} y - Y position in viewBox coordinates\n   * @param {string} font - CSS font string\n   * @param {string} textAnchor - SVG text-anchor value ('start', 'middle', 'end')\n   * @param {string} dominantBaseline - SVG dominant-baseline value\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {{left: number, right: number, top: number, bottom: number, width: number, height: number}}\n   */\n  static getTextBoundingBox(text, x, y, font = \"16px Arial\", textAnchor = 'start', dominantBaseline = 'auto', containerElement = null) {\n    const metrics = this.measureText(text, font, true, containerElement);\n\n    // Adjust for text anchor (x, y are already in viewBox coordinates)\n    let left = x;\n    if (textAnchor === 'middle') {\n      left = x - metrics.width / 2;\n    } else if (textAnchor === 'end') {\n      left = x - metrics.width;\n    }\n\n    // Adjust for baseline (y is already in viewBox coordinates)\n    let top = y - metrics.ascent;\n    if (dominantBaseline === 'middle') {\n      top = y - metrics.height / 2;\n    } else if (dominantBaseline === 'hanging') {\n      top = y;\n    }\n\n    const bbox = {\n      left,\n      right: left + metrics.width,\n      top,\n      bottom: top + metrics.height,\n      width: metrics.width,\n      height: metrics.height,\n      centerX: left + metrics.width / 2,\n      centerY: top + metrics.height / 2\n    };\n\n    console.log('[RendererUtils] Text bounding box calculation:', {\n      text: text.substring(0, 20) + (text.length > 20 ? '...' : ''),\n      inputPosition: { x, y },\n      textAnchor,\n      dominantBaseline,\n      metrics: {\n        width: metrics.width,\n        height: metrics.height,\n        ascent: metrics.ascent,\n        descent: metrics.descent\n      },\n      bbox,\n      hasContainer: !!containerElement\n    });\n\n    return bbox;\n  }\n\n  /**\n   * Get attachment points for connecting lines to text with proper coordinate transformation\n   * @param {string} text - Text content\n   * @param {number} x - X position\n   * @param {number} y - Y position\n   * @param {string} font - CSS font string\n   * @param {string} textAnchor - SVG text-anchor value\n   * @param {string} dominantBaseline - SVG dominant-baseline value\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {Object} Object with attachment points (top, bottom, left, right, etc.)\n   */\n  static getTextAttachmentPoints(text, x, y, font = \"16px Arial\", textAnchor = 'start', dominantBaseline = 'auto', containerElement = null) {\n    const bbox = this.getTextBoundingBox(text, x, y, font, textAnchor, dominantBaseline, containerElement);\n\n    // Calculate padding in viewBox coordinates - don't double-transform\n    const transformInfo = this._getSvgTransformInfo(containerElement);\n    const basePadding = 4; // Base padding value\n    const padding = transformInfo ? transformInfo.pixelToViewBox(basePadding) : basePadding;\n\n    return {\n      // Cardinal directions\n      top: [bbox.centerX, bbox.top],\n      bottom: [bbox.centerX, bbox.bottom],\n      left: [bbox.left, bbox.centerY],\n      right: [bbox.right, bbox.centerY],\n      center: [bbox.centerX, bbox.centerY],\n\n      // Corners\n      topLeft: [bbox.left, bbox.top],\n      topRight: [bbox.right, bbox.top],\n      bottomLeft: [bbox.left, bbox.bottom],\n      bottomRight: [bbox.right, bbox.bottom],\n\n      // With padding for visual clearance (properly scaled)\n      topPadded: [bbox.centerX, bbox.top - padding],\n      bottomPadded: [bbox.centerX, bbox.bottom + padding],\n      leftPadded: [bbox.left - padding, bbox.centerY],\n      rightPadded: [bbox.right + padding, bbox.centerY]\n    };\n  }\n\n  /**\n   * Parse font size from CSS font string\n   * @private\n   * @param {string} font - CSS font string\n   * @returns {number} Font size in pixels\n   */\n  static _parseFontSize(font) {\n    const match = font.match(/(\\d+(?:\\.\\d+)?)px/);\n    return match ? parseFloat(match[1]) : 16;\n  }\n\n  /**\n   * Build CSS font string from text style object\n   * @param {Object} textStyle - Text style configuration\n   * @returns {string} CSS font string\n   */\n  static buildFontString(textStyle) {\n    const parts = [];\n\n    if (textStyle.fontStyle && textStyle.fontStyle !== 'normal') {\n      parts.push(textStyle.fontStyle);\n    }\n    if (textStyle.fontWeight && textStyle.fontWeight !== 'normal') {\n      parts.push(textStyle.fontWeight);\n    }\n\n    parts.push(`${textStyle.fontSize}px`);\n\n    if (textStyle.fontFamily && textStyle.fontFamily !== 'inherit') {\n      parts.push(textStyle.fontFamily);\n    } else {\n      parts.push('Arial, sans-serif');\n    }\n\n    return parts.join(' ');\n  }\n\n  /**\n   * Resolve effective font-family when textStyle uses 'inherit'.\n   * Tries: svg element -> container element -> documentElement -> fallback.\n   */\n  static resolveFontFamily(textStyle, containerElement) {\n    if (textStyle.fontFamily && textStyle.fontFamily !== 'inherit') {\n      return textStyle.fontFamily;\n    }\n    try {\n      const svg = containerElement?.querySelector?.('svg');\n      const target = svg || containerElement || document.documentElement;\n      const computed = window.getComputedStyle(target).fontFamily;\n      if (computed && computed !== 'inherit') return computed;\n    } catch (e) {\n      console.warn('[RendererUtils] resolveFontFamily failed:', e);\n    }\n    return 'Arial, sans-serif';\n  }\n\n  /**\n   * Build a font string adjusted for measurement so canvas uses the ACTUAL on-screen pixel size.\n   * Without this, we measure at raw user-unit size (too large when viewBox scales down),\n   * leading to overestimated widths and misplaced decorations (e.g., status indicator).\n   */\n  static buildMeasurementFontString(textStyle, containerElement) {\n    // Resolve actual inherited font-family instead of fallback\n    const fontFamily = this.resolveFontFamily(textStyle, containerElement);\n    const fontStyle = (textStyle.fontStyle && textStyle.fontStyle !== 'normal') ? `${textStyle.fontStyle} ` : '';\n    const fontWeight = (textStyle.fontWeight && textStyle.fontWeight !== 'normal') ? `${textStyle.fontWeight} ` : '';\n\n    let adjustedPx = textStyle.fontSize;\n    if (containerElement) {\n      const transformInfo = this._getSvgTransformInfo(containerElement);\n      if (transformInfo) {\n        const screenPxPerViewBoxUnit = transformInfo.screenRect.width / transformInfo.viewBox[2];\n        adjustedPx = textStyle.fontSize * screenPxPerViewBoxUnit;\n      }\n    }\n\n    return `${fontStyle}${fontWeight}${adjustedPx}px ${fontFamily}`;\n  }\n\n  /**\n   * Clear text measurement cache\n   */\n  static clearTextMeasureCache() {\n    if (window.cblcars?._textMeasureCache) {\n      window.cblcars._textMeasureCache.clear();\n    }\n  }\n\n  /**\n   * Get text measurement cache statistics\n   */\n  static getTextMeasureCacheStats() {\n    const cache = window.cblcars?._textMeasureCache;\n    return {\n      size: cache?.size || 0,\n      keys: cache ? Array.from(cache.keys()) : []\n    };\n  }\n\n  /**\n   * Parse gradient configuration from various formats\n   * @param {string|object} gradientConfig - Gradient configuration\n   * @returns {object|null} Parsed gradient configuration\n   */\n  static parseGradientConfig(gradientConfig) {\n    if (!gradientConfig) return null;\n\n    if (typeof gradientConfig === 'string') {\n      // Handle simple formats: \"red,blue\" or \"red-to-blue\"\n      if (gradientConfig.includes(',')) {\n        const colors = gradientConfig.split(',').map(c => c.trim());\n        return {\n          type: 'linear',\n          direction: 'horizontal',\n          stops: colors.map((color, index) => ({\n            offset: `${(index / (colors.length - 1)) * 100}%`,\n            color: color\n          }))\n        };\n      } else if (gradientConfig.includes('-to-')) {\n        const [color1, color2] = gradientConfig.split('-to-').map(c => c.trim());\n        return {\n          type: 'linear',\n          direction: 'horizontal',\n          stops: [\n            { offset: '0%', color: color1 },\n            { offset: '100%', color: color2 }\n          ]\n        };\n      }\n      return null;\n    }\n\n    if (typeof gradientConfig === 'object') {\n      return {\n        type: gradientConfig.type || 'linear',\n        direction: gradientConfig.direction || 'horizontal',\n        x1: gradientConfig.x1 || '0%',\n        y1: gradientConfig.y1 || '0%',\n        x2: gradientConfig.x2 || '100%',\n        y2: gradientConfig.y2 || '0%',\n        cx: gradientConfig.cx || '50%',\n        cy: gradientConfig.cy || '50%',\n        r: gradientConfig.r || '50%',\n        stops: gradientConfig.stops || [\n          { offset: '0%', color: gradientConfig.from || 'var(--lcars-orange)' },\n          { offset: '100%', color: gradientConfig.to || 'var(--lcars-red)' }\n        ]\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse pattern configuration from various formats\n   * @param {string|object} patternConfig - Pattern configuration\n   * @returns {object|null} Parsed pattern configuration\n   */\n  static parsePatternConfig(patternConfig) {\n    if (!patternConfig) return null;\n\n    if (typeof patternConfig === 'string') {\n      // Predefined patterns\n      const presets = {\n        dots: { type: 'dots', size: 8, color: 'currentColor', opacity: 0.5 },\n        lines: { type: 'lines', size: 4, color: 'currentColor', opacity: 0.5 },\n        diagonal: { type: 'diagonal', size: 8, color: 'currentColor', opacity: 0.5 },\n        grid: { type: 'grid', size: 10, color: 'currentColor', opacity: 0.3 }\n      };\n      return presets[patternConfig] || null;\n    }\n\n    if (typeof patternConfig === 'object') {\n      return {\n        type: patternConfig.type || 'dots',\n        size: Number(patternConfig.size || 8),\n        color: patternConfig.color || 'currentColor',\n        opacity: Number(patternConfig.opacity || 0.5),\n        content: patternConfig.content || null\n      };\n    }\n\n    return null;\n  }\n\n    /**\n   * Parse glow effect configuration\n   * @param {Object} glowConfig - Glow configuration object\n   * @returns {Object|null} Normalized glow configuration\n   */\n  static parseGlowConfig(glowConfig) {\n    if (!glowConfig) return null;\n\n    return {\n      color: glowConfig.color || 'var(--lcars-blue)',\n      blur: Number(glowConfig.blur || 3),\n      intensity: Number(glowConfig.intensity || 0.8)\n    };\n  }\n\n  // ========================\n  // UNIFIED STYLING SYSTEM\n  // ========================\n\n  /**\n   * Parse standardized text styling properties\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Normalized text style configuration\n   */\n  static parseStandardTextStyles(style) {\n    return {\n      // Core text properties\n      fontSize: Number(style.font_size || style.fontSize || 12),\n      fontFamily: style.font_family || style.fontFamily || 'monospace',\n      fontWeight: style.font_weight || style.fontWeight || 'normal',\n      fontStyle: style.font_style || style.fontStyle || 'normal',\n\n      // Text colors (with fallback chain)\n      textColor: style.text_color || style.textColor || style.color || 'var(--lcars-white)',\n      labelColor: style.label_color || style.labelColor || style.text_color || style.textColor || 'var(--lcars-white)',\n      valueColor: style.value_color || style.valueColor || style.text_color || style.textColor || 'var(--lcars-white)',\n\n      // Text alignment and positioning\n      textAlign: style.text_align || style.textAlign || 'left',\n      verticalAlign: style.vertical_align || style.verticalAlign || 'middle',\n\n      // Text effects\n      textShadow: this.parseTextShadowConfig(style.text_shadow || style.textShadow),\n      textStroke: this.parseTextStrokeConfig(style.text_stroke || style.textStroke),\n\n      // Line height and spacing\n      lineHeight: Number(style.line_height || style.lineHeight || 1.2),\n      letterSpacing: style.letter_spacing || style.letterSpacing || 'normal'\n    };\n  }\n\n  /**\n   * Parse standardized color properties\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Normalized color configuration\n   */\n  static parseStandardColorStyles(style) {\n    return {\n      // Primary colors\n      primaryColor: style.color || style.primary_color || style.primaryColor || 'var(--lcars-blue)',\n      backgroundColor: style.background_color || style.backgroundColor || 'transparent',\n      borderColor: style.border_color || style.borderColor || 'var(--lcars-gray)',\n\n      // Interactive states\n      hoverColor: style.hover_color || style.hoverColor || 'var(--lcars-yellow)',\n      activeColor: style.active_color || style.activeColor || 'var(--lcars-cyan)',\n      focusColor: style.focus_color || style.focusColor || 'var(--lcars-white)',\n      disabledColor: style.disabled_color || style.disabledColor || 'var(--lcars-gray)',\n\n      // Status colors\n      successColor: style.success_color || style.successColor || 'var(--lcars-green)',\n      warningColor: style.warning_color || style.warningColor || 'var(--lcars-yellow)',\n      errorColor: style.error_color || style.errorColor || 'var(--lcars-red)',\n      infoColor: style.info_color || style.infoColor || 'var(--lcars-cyan)'\n    };\n  }\n\n  /**\n   * Parse standardized layout and spacing properties\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Normalized layout configuration\n   */\n  static parseStandardLayoutStyles(style) {\n    return {\n      // Border properties\n      borderWidth: Number(style.border_width || style.borderWidth || 1),\n      borderRadius: Number(style.border_radius || style.borderRadius || 0),\n      borderStyle: style.border_style || style.borderStyle || 'solid',\n\n      // Spacing (supports both number and object formats)\n      padding: this.parsePaddingConfig(style.padding),\n      margin: this.parseMarginConfig(style.margin),\n\n      // Opacity and visibility\n      opacity: Number(style.opacity || 1),\n      visible: style.visible !== false,\n\n      // Size constraints\n      minWidth: style.min_width || style.minWidth || null,\n      maxWidth: style.max_width || style.maxWidth || null,\n      minHeight: style.min_height || style.minHeight || null,\n      maxHeight: style.max_height || style.maxHeight || null\n    };\n  }\n\n  /**\n   * Parse standardized interaction properties\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Normalized interaction configuration\n   */\n  static parseStandardInteractionStyles(style) {\n    return {\n      // Hover effects\n      hoverEnabled: style.hover_enabled !== false,\n      hoverScale: Number(style.hover_scale || style.hoverScale || 1.05),\n      hoverOpacity: Number(style.hover_opacity || style.hoverOpacity || 1),\n      hoverTransition: style.hover_transition || style.hoverTransition || 'all 0.2s ease',\n\n      // Click/touch effects\n      clickable: style.clickable !== false,\n      activeScale: Number(style.active_scale || style.activeScale || 0.95),\n\n      // Focus styles\n      focusEnabled: style.focus_enabled !== false,\n      focusOutline: style.focus_outline || style.focusOutline || true,\n\n      // Cursor\n      cursor: style.cursor || 'default'\n    };\n  }\n\n  /**\n   * Parse standardized animation properties\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Normalized animation configuration\n   */\n  static parseStandardAnimationStyles(style) {\n    return {\n      // Animation enablement\n      animatable: style.animatable !== false,\n\n      // Transition properties\n      transition: style.transition || 'all 0.3s ease',\n      transitionDelay: style.transition_delay || style.transitionDelay || '0s',\n      transitionDuration: style.transition_duration || style.transitionDuration || '0.3s',\n      transitionTimingFunction: style.transition_timing_function || style.transitionTimingFunction || 'ease',\n\n      // Animation properties\n      animationDuration: style.animation_duration || style.animationDuration || '1s',\n      animationTimingFunction: style.animation_timing_function || style.animationTimingFunction || 'ease',\n      animationDelay: style.animation_delay || style.animationDelay || '0s',\n      animationIterationCount: style.animation_iteration_count || style.animationIterationCount || '1',\n      animationDirection: style.animation_direction || style.animationDirection || 'normal',\n      animationFillMode: style.animation_fill_mode || style.animationFillMode || 'both',\n\n      // Custom animation properties\n      cascadeSpeed: Number(style.cascade_speed || style.cascadeSpeed || 0),\n      cascadeDirection: style.cascade_direction || style.cascadeDirection || 'row',\n      revealAnimation: style.reveal_animation || style.revealAnimation || false,\n      pulseOnChange: style.pulse_on_change || style.pulseOnChange || false\n    };\n  }\n\n  /**\n   * Parse all standard styles in one call\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Complete normalized style configuration\n   */\n  static parseAllStandardStyles(style) {\n    return {\n      text: this.parseStandardTextStyles(style),\n      colors: this.parseStandardColorStyles(style),\n      layout: this.parseStandardLayoutStyles(style),\n      interaction: this.parseStandardInteractionStyles(style),\n      animation: this.parseStandardAnimationStyles(style),\n\n      // Effects (existing methods)\n      gradient: this.parseGradientConfig(style.gradient),\n      pattern: this.parsePatternConfig(style.pattern),\n      glow: this.parseGlowConfig(style.glow),\n      shadow: this.parseShadowConfig(style.shadow),\n      blur: this.parseBlurConfig(style.blur)\n    };\n  }\n\n  // ========================\n  // HELPER PARSING METHODS\n  // ========================\n\n  /**\n   * Parse text shadow configuration\n   * @param {Object} shadowConfig - Text shadow configuration\n   * @returns {Object|null} Normalized text shadow configuration\n   */\n  static parseTextShadowConfig(shadowConfig) {\n    if (!shadowConfig) return null;\n\n    return {\n      offsetX: Number(shadowConfig.offset_x || shadowConfig.offsetX || 1),\n      offsetY: Number(shadowConfig.offset_y || shadowConfig.offsetY || 1),\n      blur: Number(shadowConfig.blur || 2),\n      color: shadowConfig.color || 'rgba(0,0,0,0.5)'\n    };\n  }\n\n  /**\n   * Parse text stroke configuration\n   * @param {Object} strokeConfig - Text stroke configuration\n   * @returns {Object|null} Normalized text stroke configuration\n   */\n  static parseTextStrokeConfig(strokeConfig) {\n    if (!strokeConfig) return null;\n\n    return {\n      width: Number(strokeConfig.width || 1),\n      color: strokeConfig.color || 'var(--lcars-gray)',\n      opacity: Number(strokeConfig.opacity || 1)\n    };\n  }\n\n  /**\n   * Parse padding configuration (supports number or object)\n   * @param {number|Object} padding - Padding configuration\n   * @returns {Object} Normalized padding configuration\n   */\n  static parsePaddingConfig(padding) {\n    if (typeof padding === 'number') {\n      return { top: padding, right: padding, bottom: padding, left: padding };\n    }\n\n    if (typeof padding === 'object' && padding !== null) {\n      return {\n        top: Number(padding.top || padding.vertical || 0),\n        right: Number(padding.right || padding.horizontal || 0),\n        bottom: Number(padding.bottom || padding.vertical || 0),\n        left: Number(padding.left || padding.horizontal || 0)\n      };\n    }\n\n    return { top: 0, right: 0, bottom: 0, left: 0 };\n  }\n\n  /**\n   * Parse margin configuration (supports number or object)\n   * @param {number|Object} margin - Margin configuration\n   * @returns {Object} Normalized margin configuration\n   */\n  static parseMarginConfig(margin) {\n    if (typeof margin === 'number') {\n      return { top: margin, right: margin, bottom: margin, left: margin };\n    }\n\n    if (typeof margin === 'object' && margin !== null) {\n      return {\n        top: Number(margin.top || margin.vertical || 0),\n        right: Number(margin.right || margin.horizontal || 0),\n        bottom: Number(margin.bottom || margin.vertical || 0),\n        left: Number(margin.left || margin.horizontal || 0)\n      };\n    }\n\n    return { top: 0, right: 0, bottom: 0, left: 0 };\n  }\n\n  // ========================\n  // STYLE APPLICATION HELPERS\n  // ========================\n\n  /**\n   * Apply standard text styles to an SVG text element\n   * @param {Object} textStyles - Parsed text styles\n   * @returns {string} SVG text attributes string\n   */\n  static applyStandardTextStyles(textStyles) {\n    const attributes = [];\n\n    attributes.push(`font-family=\"${textStyles.fontFamily}\"`);\n    attributes.push(`font-size=\"${textStyles.fontSize}\"`);\n    attributes.push(`font-weight=\"${textStyles.fontWeight}\"`);\n    attributes.push(`font-style=\"${textStyles.fontStyle}\"`);\n    attributes.push(`fill=\"${textStyles.textColor}\"`);\n    attributes.push(`text-anchor=\"${textStyles.textAlign}\"`);\n    attributes.push(`dominant-baseline=\"${textStyles.verticalAlign}\"`);\n    attributes.push(`letter-spacing=\"${textStyles.letterSpacing}\"`);\n\n    if (textStyles.textStroke) {\n      attributes.push(`stroke=\"${textStyles.textStroke.color}\"`);\n      attributes.push(`stroke-width=\"${textStyles.textStroke.width}\"`);\n      attributes.push(`stroke-opacity=\"${textStyles.textStroke.opacity}\"`);\n    }\n\n    return attributes.join(' ');\n  }\n\n  /**\n   * Apply standard layout styles to an SVG element\n   * @param {Object} layoutStyles - Parsed layout styles\n   * @returns {string} SVG element attributes string\n   */\n  static applyStandardLayoutStyles(layoutStyles) {\n    const attributes = [];\n\n    if (layoutStyles.borderWidth > 0) {\n      attributes.push(`stroke-width=\"${layoutStyles.borderWidth}\"`);\n    }\n\n    if (layoutStyles.borderRadius > 0) {\n      attributes.push(`rx=\"${layoutStyles.borderRadius}\"`);\n      attributes.push(`ry=\"${layoutStyles.borderRadius}\"`);\n    }\n\n    attributes.push(`opacity=\"${layoutStyles.opacity}\"`);\n\n    if (!layoutStyles.visible) {\n      attributes.push(`style=\"display: none\"`);\n    }\n\n    return attributes.join(' ');\n  }\n\n  /**\n   * Create CSS text-shadow value from parsed config\n   * @param {Object} textShadow - Parsed text shadow configuration\n   * @returns {string} CSS text-shadow value\n   */\n  static createTextShadowCSS(textShadow) {\n    if (!textShadow) return '';\n    return `${textShadow.offsetX}px ${textShadow.offsetY}px ${textShadow.blur}px ${textShadow.color}`;\n  }\n\n  /**\n   * Generate data attributes for animation integration\n   * @param {Object} animationStyles - Parsed animation styles\n   * @returns {string} Data attributes string\n   */\n  static createAnimationDataAttributes(animationStyles) {\n    const attributes = [];\n\n    if (animationStyles.animatable) {\n      attributes.push(`data-animatable=\"true\"`);\n    }\n\n    if (animationStyles.cascadeSpeed > 0) {\n      attributes.push(`data-cascade-speed=\"${animationStyles.cascadeSpeed}\"`);\n      attributes.push(`data-cascade-direction=\"${animationStyles.cascadeDirection}\"`);\n    }\n\n    if (animationStyles.revealAnimation) {\n      attributes.push(`data-reveal-animation=\"true\"`);\n    }\n\n    if (animationStyles.pulseOnChange) {\n      attributes.push(`data-pulse-on-change=\"true\"`);\n    }\n\n    return attributes.join(' ');\n  }\n\n  /**\n   * Parse shadow effect configuration\n   * @param {string|object|boolean} shadowConfig - Shadow configuration\n   * @returns {object|null} Parsed shadow configuration\n   */\n  static parseShadowConfig(shadowConfig) {\n    if (!shadowConfig) return null;\n\n    if (shadowConfig === true) {\n      return { color: 'rgba(0,0,0,0.3)', offsetX: 2, offsetY: 2, blur: 3 };\n    }\n\n    if (typeof shadowConfig === 'string') {\n      // Parse \"2 2 3 rgba(0,0,0,0.3)\" format\n      const parts = shadowConfig.split(' ');\n      return {\n        offsetX: Number(parts[0]) || 2,\n        offsetY: Number(parts[1]) || 2,\n        blur: Number(parts[2]) || 3,\n        color: parts[3] || 'rgba(0,0,0,0.3)'\n      };\n    }\n\n    if (typeof shadowConfig === 'object') {\n      return {\n        color: shadowConfig.color || 'rgba(0,0,0,0.3)',\n        offsetX: Number(shadowConfig.offsetX || shadowConfig.offset?.[0] || 2),\n        offsetY: Number(shadowConfig.offsetY || shadowConfig.offset?.[1] || 2),\n        blur: Number(shadowConfig.blur || 3)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse blur effect configuration\n   * @param {number|string|object} blurConfig - Blur configuration\n   * @returns {object|null} Parsed blur configuration\n   */\n  static parseBlurConfig(blurConfig) {\n    if (!blurConfig) return null;\n\n    if (typeof blurConfig === 'number') {\n      return { amount: blurConfig };\n    }\n\n    if (typeof blurConfig === 'string') {\n      return { amount: Number(blurConfig) || 1 };\n    }\n\n    if (typeof blurConfig === 'object') {\n      return { amount: Number(blurConfig.amount || blurConfig.blur || 1) };\n    }\n\n    return null;\n  }\n\n  /**\n   * Create gradient definition SVG\n   * @param {object} gradient - Parsed gradient configuration\n   * @param {string} id - Unique ID for the gradient\n   * @returns {string} SVG gradient definition\n   */\n  static createGradientDefinition(gradient, id) {\n    if (gradient.type === 'radial') {\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<radialGradient id=\"${id}\" cx=\"${gradient.cx}\" cy=\"${gradient.cy}\" r=\"${gradient.r}\">\n                ${stops}\n              </radialGradient>`;\n    } else {\n      // Linear gradient\n      const coords = this.getLinearGradientCoords(gradient.direction, gradient);\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<linearGradient id=\"${id}\" ${coords}>\n                ${stops}\n              </linearGradient>`;\n    }\n  }\n\n  /**\n   * Get linear gradient coordinates based on direction\n   * @param {string} direction - Gradient direction\n   * @param {object} gradient - Gradient configuration (for custom coordinates)\n   * @returns {string} SVG coordinate attributes\n   */\n  static getLinearGradientCoords(direction, gradient = {}) {\n    // Use custom coordinates if provided\n    if (gradient.x1 !== undefined) {\n      return `x1=\"${gradient.x1}\" y1=\"${gradient.y1}\" x2=\"${gradient.x2}\" y2=\"${gradient.y2}\"`;\n    }\n\n    // Predefined directions\n    const directions = {\n      horizontal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"',\n      vertical: 'x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      diagonal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"',\n      'diagonal-reverse': 'x1=\"100%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      'to-right': 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"',\n      'to-left': 'x1=\"100%\" y1=\"0%\" x2=\"0%\" y2=\"0%\"',\n      'to-bottom': 'x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      'to-top': 'x1=\"0%\" y1=\"100%\" x2=\"0%\" y2=\"0%\"'\n    };\n\n    return directions[direction] || directions.horizontal;\n  }\n\n  /**\n   * Create pattern definition SVG\n   * @param {object} pattern - Parsed pattern configuration\n   * @param {string} id - Unique ID for the pattern\n   * @returns {string} SVG pattern definition\n   */\n  static createPatternDefinition(pattern, id) {\n    const size = pattern.size;\n    const color = pattern.color;\n    const opacity = pattern.opacity;\n\n    let patternContent = '';\n\n    switch (pattern.type) {\n      case 'dots':\n        patternContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"1\"\n                                  fill=\"${color}\" opacity=\"${opacity}\"/>`;\n        break;\n\n      case 'lines':\n        patternContent = `<path d=\"M 0,${size} l ${size},-${size} M -1,1 l 2,-2 M ${size-1},${size+1} l 2,-2\"\n                                stroke=\"${color}\" stroke-width=\"1\" opacity=\"${opacity}\"/>`;\n        break;\n\n      case 'diagonal':\n        patternContent = `<path d=\"M0,${size} L${size},0\"\n                                stroke=\"${color}\" stroke-width=\"1\" opacity=\"${opacity}\"/>`;\n        break;\n\n      case 'grid':\n        patternContent = `\n          <path d=\"M0,0 L0,${size}\" stroke=\"${color}\" stroke-width=\"0.5\" opacity=\"${opacity}\"/>\n          <path d=\"M0,0 L${size},0\" stroke=\"${color}\" stroke-width=\"0.5\" opacity=\"${opacity}\"/>\n        `;\n        break;\n\n      case 'custom':\n        patternContent = pattern.content || '';\n        break;\n\n      default:\n        // Default to dots\n        patternContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"1\"\n                                  fill=\"${color}\" opacity=\"${opacity}\"/>`;\n    }\n\n    return `<pattern id=\"${id}\" x=\"0\" y=\"0\" width=\"${size}\" height=\"${size}\"\n                     patternUnits=\"userSpaceOnUse\">\n              ${patternContent}\n            </pattern>`;\n  }\n\n  /**\n   * Create glow filter SVG\n   * @param {object} glow - Parsed glow configuration\n   * @param {string} id - Unique ID for the filter\n   * @returns {string} SVG filter definition\n   */\n  static createGlowFilter(glow, id) {\n    const size = glow.size || 4;\n    const color = glow.color || 'currentColor';\n    const intensity = glow.intensity || 1;\n\n    // Enhanced filter for better glow effect\n    return `<filter id=\"${id}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feGaussianBlur stdDeviation=\"${size}\" result=\"coloredBlur\"/>\n              <feFlood flood-color=\"${color}\" flood-opacity=\"${intensity}\"/>\n              <feComposite in=\"flood\" in2=\"coloredBlur\" operator=\"in\" result=\"glowColor\"/>\n              <feMerge>\n                <feMergeNode in=\"glowColor\"/>\n                <feMergeNode in=\"SourceGraphic\"/>\n              </feMerge>\n            </filter>`;\n  }\n\n  /**\n   * Create shadow filter SVG\n   * @param {object} shadow - Parsed shadow configuration\n   * @param {string} id - Unique ID for the filter\n   * @returns {string} SVG filter definition\n   */\n  static createShadowFilter(shadow, id) {\n    const offsetX = shadow.offsetX || 2;\n    const offsetY = shadow.offsetY || 2;\n    const blur = shadow.blur || 3;\n    const color = shadow.color || 'rgba(0,0,0,0.3)';\n\n    return `<filter id=\"${id}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feDropShadow dx=\"${offsetX}\" dy=\"${offsetY}\"\n                           stdDeviation=\"${blur}\"\n                           flood-color=\"${color}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Create blur filter SVG\n   * @param {object} blur - Parsed blur configuration\n   * @param {string} id - Unique ID for the filter\n   * @returns {string} SVG filter definition\n   */\n  static createBlurFilter(blur, id) {\n    const amount = blur.amount || 1;\n\n    return `<filter id=\"${id}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feGaussianBlur stdDeviation=\"${amount}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Create LCARS-style bracket path\n   * @param {number} width - Bracket width\n   * @param {number} height - Bracket height\n   * @param {string} side - 'left' or 'right'\n   * @param {object} options - Styling options\n   * @returns {string} SVG path for bracket\n   */\n  static createLcarsBracket(width, height, side = 'left', options = {}) {\n    const bracketWidth = options.bracketWidth || 8;\n    const cornerRadius = options.cornerRadius || 2;\n    const strokeWidth = options.strokeWidth || 2;\n    const color = options.color || 'var(--lcars-orange)';\n\n    let pathData = '';\n\n    if (side === 'left') {\n      pathData = `M ${width} 0 L ${cornerRadius} 0\n                  Q 0 0 0 ${cornerRadius}\n                  L 0 ${height - cornerRadius}\n                  Q 0 ${height} ${cornerRadius} ${height}\n                  L ${width} ${height}`;\n    } else {\n      pathData = `M 0 0 L ${width - cornerRadius} 0\n                  Q ${width} 0 ${width} ${cornerRadius}\n                  L ${width} ${height - cornerRadius}\n                  Q ${width} ${height} ${width - cornerRadius} ${height}\n                  L 0 ${height}`;\n    }\n\n    return `<path d=\"${pathData}\"\n                  stroke=\"${color}\"\n                  stroke-width=\"${strokeWidth}\"\n                  fill=\"none\"/>`;\n  }\n\n  /**\n   * Create marker definition for arrows, dots, etc.\n   * @param {object} marker - Marker configuration\n   * @param {string} id - Unique ID for the marker\n   * @returns {string} SVG marker definition\n   */\n  static createMarkerDefinition(marker, id) {\n    const size = this.getMarkerSize(marker.size || 'medium');\n    const color = marker.color === 'inherit' ? 'currentColor' : marker.color;\n\n    let markerContent = '';\n    let viewBox = `0 0 ${size} ${size}`;\n    let refX = size / 2;\n    let refY = size / 2;\n\n    switch (marker.type) {\n      case 'arrow':\n        viewBox = '0 0 10 10';\n        refX = 8;\n        refY = 5;\n        markerContent = `<path d=\"M2,2 L8,5 L2,8 z\" fill=\"${color}\"/>`;\n        break;\n\n      case 'dot':\n      case 'circle':\n        markerContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/4}\" fill=\"${color}\"/>`;\n        break;\n\n      case 'diamond':\n        markerContent = `<path d=\"M${size/2},2 L${size-2},${size/2} L${size/2},${size-2} L2,${size/2} z\" fill=\"${color}\"/>`;\n        break;\n\n      case 'square':\n        markerContent = `<rect x=\"2\" y=\"2\" width=\"${size-4}\" height=\"${size-4}\" fill=\"${color}\"/>`;\n        break;\n\n      case 'triangle':\n        markerContent = `<path d=\"M${size/2},2 L${size-2},${size-2} L2,${size-2} z\" fill=\"${color}\"/>`;\n        break;\n\n      default:\n        markerContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/4}\" fill=\"${color}\"/>`;\n    }\n\n    return `<marker id=\"${id}\"\n                    viewBox=\"${viewBox}\"\n                    refX=\"${refX}\" refY=\"${refY}\"\n                    markerWidth=\"${size}\" markerHeight=\"${size}\"\n                    markerUnits=\"strokeWidth\"\n                    orient=\"${marker.rotate !== false ? 'auto' : '0'}\">\n              ${markerContent}\n            </marker>`;\n  }\n\n  /**\n   * Get numeric marker size from size descriptor\n   * @param {string|number} size - Size descriptor\n   * @returns {number} Numeric size\n   */\n  static getMarkerSize(size) {\n    if (typeof size === 'number') return size;\n\n    const sizes = {\n      small: 6,\n      medium: 8,\n      large: 12,\n      xlarge: 16\n    };\n\n    return sizes[size] || 8;\n  }\n\n  /**\n   * Escape XML special characters\n   * @param {string} text - Text to escape\n   * @returns {string} Escaped text\n   */\n  static escapeXml(text) {\n    return String(text)\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n\n  /**\n   * Generate unique ID for elements\n   * @param {string} prefix - Prefix for the ID\n   * @param {string} suffix - Suffix for the ID\n   * @returns {string} Unique ID\n   */\n  static generateId(prefix = 'element', suffix = '') {\n    const timestamp = Date.now().toString(36);\n    const random = Math.random().toString(36).substr(2, 5);\n    return `${prefix}-${timestamp}-${random}${suffix ? '-' + suffix : ''}`;\n  }\n\n  /**\n   * Parse CSS color values and convert to various formats\n   * @param {string} color - CSS color value\n   * @returns {object} Color information\n   */\n  static parseColor(color) {\n    // Create a temporary element to leverage browser's color parsing\n    const tempElement = document.createElement('div');\n    tempElement.style.color = color;\n    document.body.appendChild(tempElement);\n\n    const computedColor = getComputedStyle(tempElement).color;\n    document.body.removeChild(tempElement);\n\n    // Parse RGB values\n    const rgbMatch = computedColor.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\n    if (rgbMatch) {\n      const r = parseInt(rgbMatch[1]);\n      const g = parseInt(rgbMatch[2]);\n      const b = parseInt(rgbMatch[3]);\n\n      return {\n        rgb: [r, g, b],\n        hex: this.rgbToHex(r, g, b),\n        hsl: this.rgbToHsl(r, g, b),\n        original: color,\n        computed: computedColor\n      };\n    }\n\n    return {\n      original: color,\n      computed: computedColor\n    };\n  }\n\n  /**\n   * Convert RGB to HEX\n   * @private\n   */\n  static rgbToHex(r, g, b) {\n    return \"#\" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\n  }\n\n  /**\n   * Convert RGB to HSL\n   * @private\n   */\n  static rgbToHsl(r, g, b) {\n    r /= 255;\n    g /= 255;\n    b /= 255;\n\n    const max = Math.max(r, g, b);\n    const min = Math.min(r, g, b);\n    let h, s, l = (max + min) / 2;\n\n    if (max === min) {\n      h = s = 0;\n    } else {\n      const d = max - min;\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n      switch (max) {\n        case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n        case g: h = (b - r) / d + 2; break;\n        case b: h = (r - g) / d + 4; break;\n      }\n      h /= 6;\n    }\n\n    return [Math.round(h * 360), Math.round(s * 100), Math.round(l * 100)];\n  }\n\n  /**\n   * Calculate optimal text contrast color\n   * @param {string} backgroundColor - Background color\n   * @returns {string} Optimal text color (black or white)\n   */\n  static getContrastColor(backgroundColor) {\n    const color = this.parseColor(backgroundColor);\n    if (!color.rgb) return '#ffffff';\n\n    const [r, g, b] = color.rgb;\n    const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;\n\n    return luminance > 0.5 ? '#000000' : '#ffffff';\n  }\n\n  /**\n   * Interpolate between two colors\n   * @param {string} color1 - Start color\n   * @param {string} color2 - End color\n   * @param {number} factor - Interpolation factor (0-1)\n   * @returns {string} Interpolated color\n   */\n  static interpolateColor(color1, color2, factor) {\n    const c1 = this.parseColor(color1);\n    const c2 = this.parseColor(color2);\n\n    if (!c1.rgb || !c2.rgb) return color1;\n\n    const r = Math.round(c1.rgb[0] + (c2.rgb[0] - c1.rgb[0]) * factor);\n    const g = Math.round(c1.rgb[1] + (c2.rgb[1] - c1.rgb[1]) * factor);\n    const b = Math.round(c1.rgb[2] + (c2.rgb[2] - c1.rgb[2]) * factor);\n\n    return `rgb(${r}, ${g}, ${b})`;\n  }\n\n  /**\n   * Create animation-ready attributes for future anime.js integration\n   * @param {object} animationConfig - Animation configuration\n   * @returns {array} Array of attribute strings\n   */\n  static createAnimationAttributes(animationConfig = {}) {\n    const attributes = [];\n\n    if (animationConfig.animatable !== false) {\n      attributes.push('data-animatable=\"true\"');\n    }\n\n    Object.keys(animationConfig).forEach(key => {\n      if (key.endsWith('_speed') || key.endsWith('Speed')) {\n        const value = animationConfig[key];\n        if (value > 0) {\n          const dataKey = key.replace(/([A-Z])/g, '-$1').toLowerCase().replace('_', '-');\n          attributes.push(`data-${dataKey}=\"${value}\"`);\n        }\n      }\n    });\n\n    if (animationConfig.animation_ref || animationConfig.animationRef) {\n      const ref = animationConfig.animation_ref || animationConfig.animationRef;\n      attributes.push(`data-animation-ref=\"${ref}\"`);\n    }\n\n    return attributes;\n  }\n\n  /**\n   * Validate and sanitize style values\n   * @param {object} styles - Style object to validate\n   * @returns {object} Sanitized styles\n   */\n  static sanitizeStyles(styles) {\n    const sanitized = {};\n\n    // Define allowed properties and their validation functions\n    const validators = {\n      color: (value) => this.isValidColor(value),\n      opacity: (value) => this.isValidOpacity(value),\n      width: (value) => this.isValidNumber(value),\n      height: (value) => this.isValidNumber(value),\n      stroke: (value) => this.isValidColor(value),\n      fill: (value) => this.isValidColor(value) || value === 'none',\n      fontSize: (value) => this.isValidNumber(value),\n      fontFamily: (value) => this.isValidString(value)\n    };\n\n    Object.keys(styles).forEach(key => {\n      const validator = validators[key] || validators[this.camelToKebab(key)];\n      if (validator && validator(styles[key])) {\n        sanitized[key] = styles[key];\n      }\n    });\n\n    return sanitized;\n  }\n\n  /**\n   * Check if value is a valid color\n   * @private\n   */\n  static isValidColor(value) {\n    if (typeof value !== 'string') return false;\n    return /^(#[0-9a-f]{3,8}|rgb\\(|rgba\\(|hsl\\(|hsla\\(|var\\(--|\\w+)/.test(value.toLowerCase());\n  }\n\n  /**\n   * Check if value is a valid opacity\n   * @private\n   */\n  static isValidOpacity(value) {\n    const num = Number(value);\n    return !isNaN(num) && num >= 0 && num <= 1;\n  }\n\n  /**\n   * Check if value is a valid number\n   * @private\n   */\n  static isValidNumber(value) {\n    return !isNaN(Number(value)) && isFinite(Number(value));\n  }\n\n  /**\n   * Check if value is a valid string\n   * @private\n   */\n  static isValidString(value) {\n    return typeof value === 'string' && value.length > 0;\n  }\n\n  /**\n   * Convert camelCase to kebab-case\n   * @private\n   */\n  static camelToKebab(str) {\n    return str.replace(/([A-Z])/g, '-$1').toLowerCase();\n  }\n\n  /**\n   * Get DOM text bounding box for glyphs (after font load)\n   * @param {Element} groupEl - SVG group element containing the text\n   * @returns {Object|null} Bounding box object with width, height, and position\n   */\n  static getDomTextBBox(groupEl) {\n    try {\n      if (!groupEl) return null;\n      const textEl = groupEl.querySelector('text');\n      if (!textEl) return null;\n      const bb = textEl.getBBox();\n      return {\n        width: bb.width,\n        height: bb.height,\n        left: bb.x,\n        top: bb.y,\n        right: bb.x + bb.width,\n        bottom: bb.y + bb.height,\n        centerX: bb.x + bb.width / 2,\n        centerY: bb.y + bb.height / 2\n      };\n    } catch(_) {\n      return null;\n    }\n  }\n}","/**\n * Status Grid Renderer - Grid-based multi-entity status visualization with LCARS theming\n * Provides compact status displays perfect for cascade animations and multi-sensor monitoring\n */\n\nimport { PositionResolver } from './PositionResolver.js';\nimport { RendererUtils } from './RendererUtils.js';\nimport { DataSourceMixin } from './DataSourceMixin.js';\n\nexport class StatusGridRenderer {\n  constructor() {\n    // Pre-defined caches for performance optimization\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n    this.filterCache = new Map();\n  }\n\n  /**\n   * Render a status grid overlay with comprehensive styling support\n   * @param {Object} overlay - Status grid overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled status grid\n   */\n  static render(overlay, anchors, viewBox) {\n    // Create instance for non-static methods\n    const instance = new StatusGridRenderer();\n    return instance.renderStatusGrid(overlay, anchors, viewBox);\n  }\n\n  /**\n   * Instance method for comprehensive status grid rendering\n   * @param {Object} overlay - Status grid overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled status grid\n   */\n  renderStatusGrid(overlay, anchors, viewBox) {\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) {\n      console.warn('[StatusGridRenderer] Status grid overlay position could not be resolved:', overlay.id);\n      return '';\n    }\n\n    const [x, y] = position;\n    const size = overlay.size || [200, 150];\n    const [width, height] = size;\n\n    try {\n      // Extract comprehensive styling\n      const style = overlay.finalStyle || overlay.style || {};\n      const gridStyle = this._resolveStatusGridStyles(style, overlay.id, overlay);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      // Get cell configurations\n      const cells = this._resolveCellConfigurations(overlay, gridStyle);\n      console.log(`[StatusGridRenderer] Rendering ${cells.length} cells for grid ${overlay.id}`);\n\n      // Render enhanced status grid\n      return this._renderEnhancedStatusGrid(\n        overlay, x, y, width, height, cells,\n        gridStyle, animationAttributes\n      );\n\n    } catch (error) {\n      console.error(`[StatusGridRenderer] Enhanced rendering failed for status grid ${overlay.id}:`, error);\n      return this._renderFallbackStatusGrid(overlay, x, y, width, height);\n    }\n  }\n\n  /**\n   * Resolve comprehensive status grid styling from configuration\n   * @private\n   */\n  _resolveStatusGridStyles(style, overlayId, overlay = null) {\n    // Parse all standard styles using unified system\n    const standardStyles = RendererUtils.parseAllStandardStyles(style);\n\n    const gridStyle = {\n      // Grid layout - Following documentation schema: rows/columns are in style\n      rows: Number(style.rows || 3),\n      columns: Number(style.columns || 4),\n      cell_width: Number(style.cell_width || style.cellWidth || 0), // 0 = auto\n      cell_height: Number(style.cell_height || style.cellHeight || 0), // 0 = auto\n      cell_gap: Number(style.cell_gap || style.cellGap || 2),\n\n      // Cell appearance (using standardized colors)\n      cell_color: standardStyles.colors.primaryColor,\n      cell_opacity: standardStyles.layout.opacity,\n      cell_radius: standardStyles.layout.borderRadius || 2,\n\n      // Border (using standardized layout)\n      cell_border: style.cell_border || style.cellBorder !== false,\n      border_color: standardStyles.colors.borderColor,\n      border_width: standardStyles.layout.borderWidth,\n\n      // Text (using standardized text styles)\n      show_labels: style.show_labels !== false,\n      show_values: style.show_values || false,\n      label_color: standardStyles.text.labelColor,\n      value_color: standardStyles.text.valueColor,\n      font_size: standardStyles.text.fontSize,\n      font_family: standardStyles.text.fontFamily,\n      font_weight: standardStyles.text.fontWeight,\n\n      // Status coloring\n      status_mode: (style.status_mode || style.statusMode || 'auto').toLowerCase(),\n      status_ranges: this._parseStatusRanges(style.status_ranges || style.statusRanges),\n      unknown_color: standardStyles.colors.disabledColor,\n\n      // Grid features\n      show_grid_lines: style.show_grid_lines || style.showGridLines || false,\n      grid_line_color: style.grid_line_color || style.gridLineColor || standardStyles.colors.borderColor,\n      grid_line_opacity: Number(style.grid_line_opacity || style.gridLineOpacity || 0.3),\n\n      // Effects (using standardized effect parsing)\n      gradient: standardStyles.gradient,\n      pattern: standardStyles.pattern,\n      glow: standardStyles.glow,\n      shadow: standardStyles.shadow,\n      blur: standardStyles.blur,\n\n      // LCARS-specific features\n      bracket_style: style.bracket_style || style.bracketStyle || false,\n      bracket_color: style.bracket_color || style.bracketColor || standardStyles.colors.primaryColor,\n      status_indicator: style.status_indicator || style.statusIndicator || false,\n      lcars_corners: style.lcars_corners || style.lcarsCorners || false,\n\n      // Interaction (using standardized interaction styles)\n      hover_enabled: standardStyles.interaction.hoverEnabled,\n      hover_color: standardStyles.colors.hoverColor,\n      hover_scale: standardStyles.interaction.hoverScale,\n\n      // Animation (using standardized animation styles)\n      animatable: standardStyles.animation.animatable,\n      cascade_speed: standardStyles.animation.cascadeSpeed,\n      cascade_direction: standardStyles.animation.cascadeDirection,\n      reveal_animation: standardStyles.animation.revealAnimation,\n      pulse_on_change: standardStyles.animation.pulseOnChange,\n\n      // Performance options\n      update_throttle: Number(style.update_throttle || style.updateThrottle || 100),\n\n      // Track enabled features for optimization\n      features: [],\n\n      // Store parsed standard styles for reference\n      standardStyles\n    };\n\n    // Build feature list for conditional rendering\n    if (gridStyle.gradient) gridStyle.features.push('gradient');\n    if (gridStyle.pattern) gridStyle.features.push('pattern');\n    if (gridStyle.status_ranges && gridStyle.status_ranges.length > 0) gridStyle.features.push('status-ranges');\n    if (gridStyle.glow) gridStyle.features.push('glow');\n    if (gridStyle.shadow) gridStyle.features.push('shadow');\n    if (gridStyle.blur) gridStyle.features.push('blur');\n    if (gridStyle.show_grid_lines) gridStyle.features.push('grid-lines');\n    if (gridStyle.show_labels) gridStyle.features.push('labels');\n    if (gridStyle.show_values) gridStyle.features.push('values');\n    if (gridStyle.bracket_style) gridStyle.features.push('brackets');\n    if (gridStyle.status_indicator) gridStyle.features.push('status');\n    if (gridStyle.lcars_corners) gridStyle.features.push('lcars-corners');\n    if (gridStyle.hover_enabled) gridStyle.features.push('hover');\n    if (gridStyle.cascade_speed > 0) gridStyle.features.push('cascade');\n    if (gridStyle.reveal_animation) gridStyle.features.push('reveal');\n    if (gridStyle.pulse_on_change) gridStyle.features.push('pulse');\n\n    return gridStyle;\n  }  /**\n   * Parse status ranges configuration\n   * @private\n   */\n  _parseStatusRanges(statusRanges) {\n    if (!statusRanges || !Array.isArray(statusRanges)) return [];\n\n    return statusRanges.map(range => ({\n      min: Number(range.min ?? -Infinity),\n      max: Number(range.max ?? Infinity),\n      color: range.color || 'var(--lcars-blue)',\n      label: range.label || null,\n      // Support string matching too\n      value: range.value || null,\n      state: range.state || null\n    }));\n  }\n\n  /**\n   * Prepare animation attributes for anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    const animationStyles = RendererUtils.parseStandardAnimationStyles(style);\n\n    const animationAttributes = {\n      gridAttributes: [],\n      cellAttributes: [],\n      hasAnimations: false\n    };\n\n    // Use standardized animation data attributes\n    const animationDataAttrs = RendererUtils.createAnimationDataAttributes(animationStyles);\n    if (animationDataAttrs) {\n      animationAttributes.gridAttributes.push(animationDataAttrs);\n      animationAttributes.hasAnimations = true;\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Enhanced rendering method with complete Status Grid implementation\n   * @private\n   */\n  _renderEnhancedStatusGrid(overlay, x, y, width, height, cells, gridStyle, animationAttributes) {\n    // Calculate cell dimensions\n    const cellWidth = gridStyle.cell_width || (width / gridStyle.columns);\n    const cellHeight = gridStyle.cell_height || (height / gridStyle.rows);\n    const gap = gridStyle.cell_gap;\n\n    // Start building the grid SVG\n    let gridMarkup = `<g data-overlay-id=\"${overlay.id}\"\n                data-overlay-type=\"status_grid\"\n                data-grid-rows=\"${gridStyle.rows}\"\n                data-grid-columns=\"${gridStyle.columns}\"\n                data-grid-features=\"${gridStyle.features.join(',')}\"\n                data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                data-cascade-direction=\"${gridStyle.cascade_direction}\"\n                transform=\"translate(${x}, ${y})\">`;\n\n    // Render grid background if enabled\n    if (gridStyle.show_grid_lines) {\n      gridMarkup += `<rect width=\"${width}\" height=\"${height}\"\n                     fill=\"none\" stroke=\"${gridStyle.grid_line_color}\"\n                     stroke-width=\"1\" opacity=\"${gridStyle.grid_line_opacity}\"/>`;\n    }\n\n    // Render each cell\n    cells.forEach(cell => {\n      const cellX = cell.col * (cellWidth + gap);\n      const cellY = cell.row * (cellHeight + gap);\n\n      // Determine cell color based on status\n      const cellColor = this._determineCellColor(cell, gridStyle);\n\n      // Render cell rectangle\n      gridMarkup += `<rect x=\"${cellX}\" y=\"${cellY}\"\n                     width=\"${cellWidth - gap}\" height=\"${cellHeight - gap}\"\n                     fill=\"${cellColor}\"\n                     stroke=\"${gridStyle.border_color}\"\n                     stroke-width=\"${gridStyle.border_width}\"\n                     rx=\"${gridStyle.cell_radius}\"\n                     data-cell-id=\"${cell.id}\"\n                     data-cell-row=\"${cell.row}\"\n                     data-cell-col=\"${cell.col}\"/>`;\n\n      // Render cell label if enabled\n      if (gridStyle.show_labels && cell.label) {\n        const labelX = cellX + (cellWidth - gap) / 2;\n        const labelY = cellY + (cellHeight - gap) / 2 - (gridStyle.font_size / 4);\n\n        gridMarkup += `<text x=\"${labelX}\" y=\"${labelY}\"\n                       text-anchor=\"middle\" dominant-baseline=\"middle\"\n                       fill=\"${gridStyle.label_color}\"\n                       font-size=\"${gridStyle.font_size * 0.7}\"\n                       font-family=\"${gridStyle.font_family}\"\n                       data-cell-label=\"${cell.id}\">\n                       ${this._escapeXml(cell.label)}\n                     </text>`;\n      }\n\n      // Render cell content/value if enabled\n      if (gridStyle.show_values && cell.content) {\n        const valueX = cellX + (cellWidth - gap) / 2;\n        const valueY = cellY + (cellHeight - gap) / 2 + (gridStyle.font_size / 4);\n\n        gridMarkup += `<text x=\"${valueX}\" y=\"${valueY}\"\n                       text-anchor=\"middle\" dominant-baseline=\"middle\"\n                       fill=\"${gridStyle.value_color}\"\n                       font-size=\"${gridStyle.font_size * 0.6}\"\n                       font-family=\"${gridStyle.font_family}\"\n                       data-cell-content=\"${cell.id}\">\n                       ${this._escapeXml(cell.content || String(cell.data.value))}\n                     </text>`;\n      }\n    });\n\n    gridMarkup += '</g>';\n    return gridMarkup;\n  }\n\n  /**\n   * Determine cell color based on status and configuration\n   * @private\n   */\n  _determineCellColor(cell, gridStyle) {\n    // Check status ranges first\n    if (gridStyle.status_ranges && gridStyle.status_ranges.length > 0) {\n      const value = typeof cell.data.value === 'number' ? cell.data.value : parseFloat(cell.data.value);\n\n      if (!isNaN(value)) {\n        for (const range of gridStyle.status_ranges) {\n          if (value >= range.min && value <= range.max) {\n            return range.color;\n          }\n        }\n      }\n\n      // Check string/state matching\n      for (const range of gridStyle.status_ranges) {\n        if (range.value && cell.data.value === range.value) {\n          return range.color;\n        }\n        if (range.state && cell.data.state === range.state) {\n          return range.color;\n        }\n      }\n    }\n\n    // Fallback to default cell color\n    return gridStyle.cell_color;\n  }\n\n  /**\n   * Escape XML special characters\n   * @private\n   */\n  _escapeXml(text) {\n    if (typeof text !== 'string') return String(text);\n    return text\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n\n  _renderFallbackStatusGrid(overlay, x, y, width, height) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const color = style.cell_color || style.color || 'var(--lcars-gray)';\n\n    console.warn(`[StatusGridRenderer] Using fallback rendering for status grid ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"status_grid\" data-fallback=\"true\">\n              <g transform=\"translate(${x}, ${y})\">\n                <rect width=\"${width}\" height=\"${height}\"\n                      fill=\"none\" stroke=\"${color}\" stroke-width=\"2\"/>\n                <text x=\"${width / 2}\" y=\"${height / 2}\" text-anchor=\"middle\"\n                      fill=\"${color}\" font-size=\"12\" dominant-baseline=\"middle\">\n                  Status Grid Error\n                </text>\n              </g>\n            </g>`;\n  }\n\n  /**\n   * Resolve cell content from various sources including DataSource integration\n   * @private\n   */\n  _resolveCellContent(cell, style) {\n    // Get cell content from various sources\n    const cellContent = cell.content || cell._raw?.content || cell.label || '';\n\n    console.log(`[StatusGridRenderer] Resolving content for cell:`, {\n      cellId: cell.id || 'unknown',\n      hasContent: !!cell.content,\n      hasRawContent: !!cell._raw?.content,\n      hasLabel: !!cell.label,\n      content: cellContent,\n      rawContent: cell._raw?.content,\n      label: cell.label\n    });\n\n    // For conditional expressions, return as-is for later processing\n    if (cellContent && typeof cellContent === 'string' && cellContent.includes('?') && cellContent.includes(':')) {\n      console.log(`[StatusGridRenderer] Detected conditional expression, returning for later processing: \"${cellContent}\"`);\n      return cellContent;\n    }\n\n    // Use DataSourceMixin's unified content resolution for simple templates\n    const resolvedContent = DataSourceMixin.resolveContent(cell, style, 'StatusGridRenderer');\n\n    console.log(`[StatusGridRenderer] Resolved content: \"${resolvedContent}\" for cell ${cell.id || 'unknown'}`);\n\n    return resolvedContent;\n  }\n\n  // Cell configuration resolution with DataSource integration\n  _resolveCellConfigurations(overlay, gridStyle) {\n    const cells = [];\n\n    // ENHANCED: Check multiple sources for cells configuration\n    const cellsConfig = overlay.cells || overlay._raw?.cells || overlay.raw?.cells;\n\n    console.log(`[StatusGridRenderer] Resolving cells for ${overlay.id}:`, {\n      hasCells: !!(cellsConfig && Array.isArray(cellsConfig)),\n      cellCount: cellsConfig?.length || 0,\n      cellsData: cellsConfig,\n      checkedSources: {\n        'overlay.cells': !!overlay.cells,\n        'overlay._raw?.cells': !!(overlay._raw?.cells),\n        'overlay.raw?.cells': !!(overlay.raw?.cells)\n      }\n    });\n\n    // Use explicit cell definitions if provided\n    if (cellsConfig && Array.isArray(cellsConfig)) {\n      cellsConfig.forEach((cellConfig, index) => {\n        console.log(`[StatusGridRenderer] Processing cell ${index}:`, cellConfig);\n\n        // UNIFIED: Use standardized content resolution following Text Overlay pattern\n        const cellContent = this._resolveCellContent(cellConfig, gridStyle);\n\n        const cell = {\n          id: cellConfig.id || `cell-${index}`,\n          row: cellConfig.position ? cellConfig.position[0] : Math.floor(index / gridStyle.columns),\n          col: cellConfig.position ? cellConfig.position[1] : index % gridStyle.columns,\n          index,\n          source: cellConfig.source || cellConfig.data_source,\n          label: cellConfig.label || `Cell ${index + 1}`,\n          content: cellContent, // Use unified content resolution\n          data: {\n            value: cellConfig.value || cellContent || null,\n            state: cellConfig.state || 'unknown',\n            timestamp: Date.now()\n          },\n          lastUpdate: Date.now(),\n          animationDelay: index * (gridStyle.cascade_speed || 50),\n          _raw: cellConfig._raw || cellConfig\n        };\n\n        // ENHANCED: Apply template processing for initial render if needed\n        const processedCell = this._resolveCellContentForInitialRender(cell, gridStyle);\n\n        console.log(`[StatusGridRenderer] Created cell:`, processedCell);\n        cells.push(processedCell);\n      });\n    } else {\n      console.log(`[StatusGridRenderer] No explicit cells found, generating ${gridStyle.rows}x${gridStyle.columns} grid`);\n\n      // Generate grid cells based on rows/columns\n      const totalCells = gridStyle.rows * gridStyle.columns;\n      for (let i = 0; i < totalCells; i++) {\n        const row = Math.floor(i / gridStyle.columns);\n        const col = i % gridStyle.columns;\n\n        cells.push({\n          id: `cell-${row}-${col}`,\n          row,\n          col,\n          index: i,\n          source: null,\n          label: `${String.fromCharCode(65 + row)}${col + 1}`,\n          content: null,\n          data: {\n            value: Math.random() > 0.5 ? 'ONLINE' : 'OFFLINE',\n            state: Math.random() > 0.5 ? 'good' : 'bad',\n            timestamp: Date.now()\n          },\n          lastUpdate: Date.now(),\n          animationDelay: i * (gridStyle.cascade_speed || 50)\n        });\n      }\n    }\n\n    console.log(`[StatusGridRenderer] Final cells array:`, cells);\n    return cells;\n  }\n\n  /**\n   * Resolve cell content with updated DataSource data (for dynamic updates)\n   * @public - Used by BaseOverlayUpdater for real-time status grid updates\n   * @param {Object} overlay - Overlay configuration\n   * @param {Object} style - Style configuration\n   * @param {Object} newDataSourceData - Updated DataSource data\n   * @returns {Array} Updated cell configurations with new data\n   */\n  updateCellsWithData(overlay, style, newDataSourceData) {\n    console.log(`[StatusGridRenderer] Updating cells with new DataSource data for ${overlay.id}`);\n\n    const gridStyle = this._resolveStatusGridStyles(style, overlay.id, overlay);\n    const cells = this._resolveCellConfigurations(overlay, gridStyle);\n\n    // Update cells that have template content\n    const updatedCells = cells.map(cell => {\n      // Use original template content if available, otherwise use current content\n      const cellContent = cell._originalContent || cell._raw?.content || cell._raw?.label || cell.label || '';\n\n      if (cellContent && typeof cellContent === 'string' && cellContent.includes('{')) {\n        console.log(`[StatusGridRenderer] Processing template for cell ${cell.id}: \"${cellContent}\"`);\n\n        // SIMPLIFIED: Use DataSourceMixin for all template processing (including conditionals now)\n        const processedContent = cellContent.includes('?') && cellContent.includes(':') ?\n          this._processConditionalWithDataSourceMixin(cellContent, newDataSourceData) :\n          DataSourceMixin.processEnhancedTemplateStringsWithFallback(cellContent, 'StatusGridRenderer');\n\n        // Ensure we don't return [object Object]\n        const safeContent = (typeof processedContent === 'object') ?\n          JSON.stringify(processedContent) : String(processedContent);\n\n        return {\n          ...cell,\n          label: processedContent === cellContent ? cell.label : safeContent, // Only update label if content changed\n          content: safeContent,\n          data: {\n            ...cell.data,\n            value: this._extractValueFromTemplate(safeContent, newDataSourceData),\n            timestamp: Date.now()\n          },\n          lastUpdate: Date.now()\n        };\n      }      return cell;\n    });\n\n    return updatedCells;\n  }\n\n  /**\n   * Resolve cell content with template processing for initial render\n   * @private\n   * @param {Object} cell - Cell configuration\n   * @param {Object} style - Style configuration\n   * @returns {Object} Cell with processed content if templates are present\n   */\n  _resolveCellContentForInitialRender(cell, style) {\n    const cellContent = cell._raw?.content || cell._raw?.label || cell.label || cell.content || '';\n\n    // If content contains templates, process them using the appropriate approach\n    if (cellContent && typeof cellContent === 'string' && cellContent.includes('{')) {\n      console.log(`[StatusGridRenderer] Processing template for initial render in cell ${cell.id}: \"${cellContent}\"`);\n\n      // SIMPLIFIED: Handle conditional expressions by extracting DataSource references and delegating to DataSourceMixin\n      if (cellContent.includes('?') && cellContent.includes(':')) {\n        console.log(`[StatusGridRenderer] Conditional expression detected, extracting DataSource references`);\n\n        const resolvedContent = this._processConditionalWithDataSourceMixin(cellContent);\n\n        if (resolvedContent !== cellContent) {\n          console.log(`[StatusGridRenderer] Conditional resolved for ${cell.id}: \"${cellContent}\" → \"${resolvedContent}\"`);\n          return {\n            ...cell,\n            content: resolvedContent,\n            _originalContent: cellContent\n          };\n        } else {\n          console.log(`[StatusGridRenderer] Conditional not resolved for ${cell.id}, will resolve during updates`);\n          return {\n            ...cell,\n            content: cellContent,\n            _originalContent: cellContent,\n            _isConditional: true\n          };\n        }\n      }\n\n      // For non-conditional templates, use DataSourceMixin (this works great now)\n      const processedContent = DataSourceMixin.processEnhancedTemplateStringsWithFallback(cellContent, 'StatusGridRenderer');\n\n      if (processedContent !== cellContent) {\n        console.log(`[StatusGridRenderer] Template resolved for ${cell.id}: \"${cellContent}\" → \"${processedContent}\"`);\n        return {\n          ...cell,\n          content: processedContent,\n          _originalContent: cellContent\n        };\n      } else {\n        console.log(`[StatusGridRenderer] Template not resolved for ${cell.id}, will resolve during updates`);\n        return {\n          ...cell,\n          content: cellContent,\n          _originalContent: cellContent\n        };\n      }\n    }\n\n    return cell;\n  }\n\n  /**\n   * Extract numeric value from processed template for status calculations\n   * @private\n   */\n  _extractValueFromTemplate(processedContent, dataSourceData) {\n    // If the processed content is purely numeric, return it\n    const numericValue = parseFloat(processedContent);\n    if (!isNaN(numericValue)) {\n      return numericValue;\n    }\n\n    // Otherwise try to extract the raw value from dataSourceData\n    if (dataSourceData && typeof dataSourceData.v === 'number') {\n      return dataSourceData.v;\n    }\n\n    // Fallback to processed content as string\n    return processedContent;\n  }\n\n  /**\n   * Process conditional expression by extracting DataSource references and using DataSourceMixin\n   * @private\n   * @param {string} conditionalTemplate - Template with conditional expression\n   * @param {Object} [updateDataSourceData] - Updated DataSource data to use (for updates)\n   * @returns {string} Resolved conditional or original template\n   */\n  _processConditionalWithDataSourceMixin(conditionalTemplate, updateDataSourceData = null) {\n    try {\n      // Extract the conditional expression from the template\n      const templateMatch = conditionalTemplate.match(/\\{([^}]+)\\}/);\n      if (!templateMatch) return conditionalTemplate;\n\n      const expression = templateMatch[1];\n      console.log(`[StatusGridRenderer] Extracted conditional expression: \"${expression}\"`);\n\n      // Parse the conditional: \"path operator value ? trueValue : falseValue\"\n      const conditionMatch = expression.match(/^(.+?)\\s*([><=!]+)\\s*(.+?)\\s*\\?\\s*'(.+?)'\\s*:\\s*'(.+?)'$/);\n      if (!conditionMatch) {\n        console.warn(`[StatusGridRenderer] Could not parse conditional: ${expression}`);\n        return conditionalTemplate;\n      }\n\n      const [, leftPath, operator, rightValue, trueValue, falseValue] = conditionMatch;\n      console.log(`[StatusGridRenderer] Parsed conditional: \"${leftPath.trim()}\" ${operator} ${rightValue} ? \"${trueValue}\" : \"${falseValue}\"`);\n\n      // Create a simple template with just the DataSource reference\n      const dataSourceTemplate = `{${leftPath.trim()}}`;\n      console.log(`[StatusGridRenderer] Resolving DataSource template: \"${dataSourceTemplate}\"`);\n\n      let resolvedValue;\n\n      // If we have update data, try to extract the value directly first\n      if (updateDataSourceData) {\n        console.log(`[StatusGridRenderer] Using provided update data:`, updateDataSourceData);\n        resolvedValue = this._extractValueFromUpdateData(leftPath.trim(), updateDataSourceData);\n        console.log(`[StatusGridRenderer] Extracted from update data: \"${resolvedValue}\"`);\n      }\n\n      // If we couldn't extract from update data, fall back to DataSourceMixin\n      if (resolvedValue === null || resolvedValue === undefined) {\n        resolvedValue = DataSourceMixin.processEnhancedTemplateStringsWithFallback(dataSourceTemplate, 'StatusGridRenderer');\n        console.log(`[StatusGridRenderer] DataSourceMixin resolved: \"${dataSourceTemplate}\" → \"${resolvedValue}\"`);\n      }\n\n      // If DataSourceMixin couldn't resolve it, return original\n      if (resolvedValue === dataSourceTemplate) {\n        console.log(`[StatusGridRenderer] DataSource not resolved, returning original template`);\n        return conditionalTemplate;\n      }\n\n      // Parse the resolved value and apply conditional logic\n      const leftVal = parseFloat(resolvedValue);\n      const rightVal = parseFloat(rightValue.trim());\n\n      if (isNaN(leftVal) || isNaN(rightVal)) {\n        console.warn(`[StatusGridRenderer] Could not parse numeric values: left=\"${resolvedValue}\" (${leftVal}), right=\"${rightValue.trim()}\" (${rightVal})`);\n        return conditionalTemplate;\n      }\n\n      // Evaluate condition\n      let result = false;\n      switch (operator.trim()) {\n        case '>': result = leftVal > rightVal; break;\n        case '<': result = leftVal < rightVal; break;\n        case '>=': result = leftVal >= rightVal; break;\n        case '<=': result = leftVal <= rightVal; break;\n        case '==': result = leftVal == rightVal; break;\n        case '!=': result = leftVal != rightVal; break;\n        default:\n          console.warn(`[StatusGridRenderer] Unknown operator: ${operator}`);\n          return conditionalTemplate;\n      }\n\n      const finalValue = result ? trueValue : falseValue;\n      console.log(`[StatusGridRenderer] Conditional result: ${leftVal} ${operator} ${rightVal} = ${result} → \"${finalValue}\"`);\n      return finalValue;\n\n    } catch (error) {\n      console.error(`[StatusGridRenderer] Error processing conditional with DataSourceMixin:`, error);\n      return conditionalTemplate;\n    }\n  }\n\n  /**\n   * Extract value from update DataSource data based on path\n   * @private\n   * @param {string} path - DataSource path (e.g., \"temperature_enhanced.transformations.celsius\")\n   * @param {Object} updateData - Updated DataSource data\n   * @returns {*} Extracted value or null if not found\n   */\n  _extractValueFromUpdateData(path, updateData) {\n    const pathParts = path.split('.');\n\n    // For simple paths, use the raw value\n    if (pathParts.length === 1) {\n      return updateData?.v || updateData?.value || null;\n    }\n\n    // For complex paths like \"temperature_enhanced.transformations.celsius\"\n    let value = updateData;\n\n    // Skip the first part (source name) and navigate the rest\n    for (let i = 1; i < pathParts.length; i++) {\n      const part = pathParts[i];\n\n      if (value && typeof value === 'object' && part in value) {\n        value = value[part];\n      } else {\n        console.log(`[StatusGridRenderer] Path \"${part}\" not found in update data, falling back to DataSourceMixin`);\n        return null;\n      }\n    }\n\n    return value;\n  }\n}\n\n// Expose StatusGridRenderer to window for console debugging\nif (typeof window !== 'undefined') {\n  window.StatusGridRenderer = StatusGridRenderer;\n}","/**\n * Text Overlay Renderer - Advanced text rendering with comprehensive styling support\n * Provides rich text styling features similar to LineOverlayRenderer\n */\n\nimport { DataSourceMixin } from './DataSourceMixin.js';\n\nimport { PositionResolver } from './PositionResolver.js';\nimport { RendererUtils } from './RendererUtils.js';\n\nexport class TextOverlayRenderer {\n  constructor() {\n    // Pre-defined caches for performance optimization\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n    this.filterCache = new Map();\n  }\n\n  /**\n   * Render a text overlay with full styling support\n   * @param {Object} overlay - Text overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled text\n   */\n  static render(overlay, anchors, viewBox, svgContainer) {\n    // Create instance for non-static methods\n    const instance = new TextOverlayRenderer();\n    instance.container = svgContainer; // Set the container for the instance\n    instance.viewBox = viewBox; // Also store viewBox for reference\n    return instance.renderText(overlay, anchors, viewBox);\n  }\n\n  /**\n   * Instance method for comprehensive text rendering\n   * @param {Object} overlay - Text overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled text\n   */\n  renderText(overlay, anchors, viewBox) {\n    console.log(`[TextOverlayRenderer] DEBUG: renderText called for overlay \"${overlay.id}\"`);\n    console.log(`[TextOverlayRenderer] DEBUG: Full overlay object:`, overlay);\n    console.log(`[TextOverlayRenderer] DEBUG: Anchors:`, anchors);\n\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) {\n      console.warn('[TextOverlayRenderer] Text overlay position could not be resolved:', overlay.id);\n      console.log(`[TextOverlayRenderer] DEBUG: Position resolution failed for:`, {\n        overlayId: overlay.id,\n        position: overlay.position,\n        anchors: anchors\n      });\n      return '';\n    }\n    const [x, y] = position;\n\n    try {\n      const style = overlay.finalStyle || overlay.style || {};\n      console.log(`[TextOverlayRenderer] DEBUG: Style object for \"${overlay.id}\":`, style);\n\n      const textStyle = this._resolveTextStyles(style, overlay.id);\n\n      // NEW: adopt computed font when 'inherit' (prevents initial fallback mismatch)\n      if (this.container && typeof window !== 'undefined') {\n        try {\n          const host = this.container;\n          const cs = host ? getComputedStyle(host) : null;\n            if (cs) {\n              if (textStyle.fontFamily === 'inherit' && cs.fontFamily) {\n                textStyle.fontFamily = cs.fontFamily;\n              }\n              // Update fontSize if defaulted / unreasonable\n              if ((!style.font_size && !style.fontSize) && cs.fontSize) {\n                const px = parseFloat(cs.fontSize);\n                if (!isNaN(px) && px > 0) textStyle.fontSize = px;\n              }\n            }\n        } catch (_) {}\n      }\n\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n      const textContent = this._resolveTextContent(overlay, style);\n\n      console.log(`[TextOverlayRenderer] DEBUG: Final text content for \"${overlay.id}\": \"${textContent}\"`);\n\n      if (!textContent) {\n        console.warn(`[TextOverlayRenderer] No text content for overlay ${overlay.id}`);\n        console.log(`[TextOverlayRenderer] DEBUG: Content resolution chain failed - check the debug logs above`);\n        return '';\n      }\n      textStyle._cachedContent = textContent;\n\n      // NEW: single early measurement (width/height) used by decorations & emitted as attributes\n      const measure = this._measureTextBlock(textContent, x, y, textStyle);\n\n      const svgParts = [\n        this._buildDefinitions(textStyle, overlay.id),\n        this._buildMainText(textContent, x, y, textStyle, overlay.id, animationAttributes),\n        this._buildTextDecorations(textContent, x, y, textStyle, overlay.id),\n        this._buildEffects(textContent, x, y, textStyle, overlay.id)\n      ].filter(Boolean);\n\n      console.log(`[TextOverlayRenderer] Rendered enhanced text ${overlay.id} with ${textStyle.features.length} features`);\n\n      return `<g data-overlay-id=\"${overlay.id}\"\n                  data-overlay-type=\"text\"\n                  data-text-features=\"${textStyle.features.join(',')}\"\n                  data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                  data-text-width=\"${measure.width || 0}\"\n                  data-text-height=\"${measure.height || 0}\"\n                  data-font-family=\"${textStyle.fontFamily}\"\n                  data-font-size=\"${textStyle.fontSize}\"\n                  data-dominant-baseline=\"${textStyle.dominantBaseline}\"\n                  data-text-anchor=\"${textStyle.textAnchor}\"\n                  data-font-stabilized=\"0\">\n                ${svgParts.join('\\n')}\n              </g>`;\n    } catch (error) {\n      console.error(`[TextOverlayRenderer] Enhanced rendering failed for text ${overlay.id}:`, error);\n      return this._renderFallbackText(overlay, x, y);\n    }\n  }\n\n  /**\n   * Resolve comprehensive text styling from configuration using unified styling system\n   * @private\n   * @param {Object} style - Final resolved style object\n   * @param {string} overlayId - Overlay ID for unique identifiers\n   * @returns {Object} Complete text style configuration\n   */\n  _resolveTextStyles(style, overlayId) {\n    // Parse all standard styles using unified system\n    const standardStyles = RendererUtils.parseAllStandardStyles(style);\n\n    const textStyle = {\n      // Core text properties (enhanced with unified styling)\n      color: standardStyles.text.textColor || style.fill || 'var(--lcars-orange)',\n      fontSize: standardStyles.text.fontSize,\n      fontFamily: standardStyles.text.fontFamily !== 'monospace' ? standardStyles.text.fontFamily : (style.font_family || style.fontFamily || 'inherit'),\n      fontWeight: standardStyles.text.fontWeight,\n      fontStyle: standardStyles.text.fontStyle,\n\n      // Text positioning and alignment (enhanced with unified styling)\n      textAnchor: (standardStyles.text.textAlign === 'left' ? 'start' :\n                   standardStyles.text.textAlign === 'right' ? 'end' :\n                   standardStyles.text.textAlign === 'center' ? 'middle' :\n                   style.text_anchor || style.textAnchor || 'start').toLowerCase(),\n      dominantBaseline: (standardStyles.text.verticalAlign === 'top' ? 'hanging' :\n                        standardStyles.text.verticalAlign === 'bottom' ? 'text-after-edge' :\n                        standardStyles.text.verticalAlign === 'middle' ? 'central' :\n                        style.dominant_baseline || style.dominantBaseline || 'auto').toLowerCase(),\n      alignmentBaseline: (style.alignment_baseline || style.alignmentBaseline || 'auto').toLowerCase(),\n\n      // Advanced text styling (enhanced with unified styling)\n      letterSpacing: standardStyles.text.letterSpacing,\n      wordSpacing: style.word_spacing || style.wordSpacing || 'normal',\n      textDecoration: style.text_decoration || style.textDecoration || 'none',\n\n      // Opacity and visibility (using unified layout)\n      opacity: standardStyles.layout.opacity,\n      visibility: standardStyles.layout.visible ? 'visible' : 'hidden',\n\n      // Stroke properties for outlined text (enhanced with unified colors)\n      stroke: style.stroke || null,\n      strokeWidth: Number(style.stroke_width || style.strokeWidth || 0),\n      strokeOpacity: Number(style.stroke_opacity || style.strokeOpacity || 1),\n      strokeLinecap: (style.stroke_linecap || style.strokeLinecap || 'butt').toLowerCase(),\n      strokeLinejoin: (style.stroke_linejoin || style.strokeLinejoin || 'miter').toLowerCase(),\n      strokeDasharray: style.stroke_dasharray || style.strokeDasharray || null,\n      strokeDashoffset: Number(style.stroke_dashoffset || style.strokeDashoffset || 0),\n\n      // Advanced fill properties (using unified effects)\n      gradient: standardStyles.gradient,\n      pattern: standardStyles.pattern,\n\n      // Effects (using unified effects)\n      glow: standardStyles.glow,\n      shadow: standardStyles.shadow,\n      blur: standardStyles.blur,\n\n      // Multi-line text support (enhanced with unified styling)\n      multiline: style.multiline || false,\n      lineHeight: standardStyles.text.lineHeight,\n      maxWidth: standardStyles.layout.maxWidth || Number(style.max_width || style.maxWidth || 0),\n      textWrapping: style.text_wrapping || style.textWrapping || 'none',\n\n      // Animation states (using unified animation system)\n      animatable: standardStyles.animation.animatable,\n      pulseSpeed: Number(style.pulse_speed || standardStyles.animation.pulseOnChange ? 1 : 0),\n      fadeSpeed: Number(style.fade_speed || 0),\n      typewriterSpeed: Number(style.typewriter_speed || 0),\n\n      // LCARS-specific features (enhanced with unified colors)\n      status_indicator: style.status_indicator || null,\n      status_indicator_position: style.status_indicator_position || style.statusIndicatorPosition || 'left-center',\n      bracket_style: style.bracket_style || null,\n      highlight: style.highlight || false,\n\n      // Store reference to standard styles for access to additional features\n      standardStyles,\n\n      // Track enabled features for optimization\n      features: []\n    };\n\n    // Build feature list for conditional rendering\n    if (textStyle.gradient) textStyle.features.push('gradient');\n    if (textStyle.pattern) textStyle.features.push('pattern');\n    if (textStyle.stroke && textStyle.strokeWidth > 0) textStyle.features.push('stroke');\n    if (textStyle.glow) textStyle.features.push('glow');\n    if (textStyle.shadow) textStyle.features.push('shadow');\n    if (textStyle.blur) textStyle.features.push('blur');\n    if (textStyle.multiline) textStyle.features.push('multiline');\n    if (textStyle.pulseSpeed > 0) textStyle.features.push('pulse');\n    if (textStyle.fadeSpeed > 0) textStyle.features.push('fade');\n    if (textStyle.typewriterSpeed > 0) textStyle.features.push('typewriter');\n    if (textStyle.status_indicator) textStyle.features.push('status');\n    if (textStyle.bracket_style) textStyle.features.push('brackets');\n    if (textStyle.highlight) textStyle.features.push('highlight');\n\n    return textStyle;\n  }\n\n  /**\n   * Resolve text content from various sources including DataSource integration\n   * @private\n   */\n  _resolveTextContent(overlay, style) {\n    console.log(`[TextOverlayRenderer] DEBUG: Resolving text content for ${overlay.id}`);\n    console.log(`[TextOverlayRenderer] DEBUG: Available sources:`, {\n      'style.value': style.value,\n      'overlay.text': overlay.text,\n      'overlay.content': overlay.content,\n      '_raw.content': overlay._raw?.content,\n      '_raw.text': overlay._raw?.text\n    });\n\n    // Start with basic content resolution\n    let content = style.value || overlay.text || overlay.content || '';\n\n    // Check raw overlay configuration if content not found in standard properties\n    if (!content && overlay._raw?.content) {\n      content = overlay._raw.content;\n      console.log(`[TextOverlayRenderer] DEBUG: Found content in _raw.content: \"${content}\"`);\n    }\n    if (!content && overlay._raw?.text) {\n      content = overlay._raw.text;\n      console.log(`[TextOverlayRenderer] DEBUG: Found content in _raw.text: \"${content}\"`);\n    }\n\n      // Check if we have a value_format and a DataSource reference\n    let dataSourceRef = overlay.data_source || overlay._raw?.data_source || style.data_source;\n    if (!content && style.value_format && typeof style.value_format === 'string' && dataSourceRef) {\n      // Try to resolve the DataSource value\n      const dataSourceContent = DataSourceMixin.resolveDataSourceContent(dataSourceRef, style, 'TextOverlayRenderer');\n      if (dataSourceContent !== null) {\n        // Check if the DataSource content is already formatted or if it's a raw value\n        const numericValue = parseFloat(dataSourceContent);\n        if (!isNaN(numericValue) && String(numericValue) === String(dataSourceContent).trim()) {\n          // DataSource returned a raw numeric value, apply formatting using unified method\n          if (style.value_format.includes('{value')) {\n            content = style.value_format.replace(/\\{value(?::([^}]+))?\\}/g, (match, formatSpec) => {\n              if (formatSpec) {\n                // Use DataSourceMixin for unit-aware formatting\n                const dsManager = DataSourceMixin.getDataSourceManager();\n                const dataSource = dsManager?.getSource(dataSourceRef.split('.')[0]);\n                const unitOfMeasurement = dataSource?.getCurrentData()?.unit_of_measurement;\n                return DataSourceMixin.applyNumberFormat(numericValue, formatSpec, unitOfMeasurement);\n              }\n              return String(numericValue);\n            });\n          } else {\n            content = style.value_format.replace('{value}', String(numericValue));\n          }\n        } else {\n          // DataSource returned already formatted content, use it directly\n          content = dataSourceContent;\n        }\n        return content;\n      } else {\n        // DataSource not available, show loading state with format context\n        content = style.value_format.replace(/\\{value[^}]*\\}/g, '[Loading...]');\n        return content;\n      }\n    }    // Fallback: if we have a value_format but no DataSource, treat it as a template string\n    if (!content && style.value_format && typeof style.value_format === 'string') {\n      content = style.value_format;\n    }\n\n    // If we have basic content and it contains template strings, process them\n    if (content && typeof content === 'string' && content.includes('{')) {\n      content = DataSourceMixin.processTemplateForInitialRender(content, 'TextOverlayRenderer');\n      return content;\n    }\n\n    // If we have basic content without templates, return it\n    if (content) {\n      return content;\n    }\n\n    // No basic content found, try DataSource integration as fallback\n    if (!dataSourceRef) {\n      dataSourceRef = overlay.data_source || overlay._raw?.data_source || style.data_source;\n    }\n    if (dataSourceRef) {\n      const dataSourceContent = DataSourceMixin.resolveDataSourceContent(dataSourceRef, style, 'TextOverlayRenderer');\n      if (dataSourceContent !== null) {\n        return dataSourceContent;\n      } else {\n        // If we have a DataSource reference but it's not available, show loading state\n        return `[Loading: ${dataSourceRef}]`;\n      }\n    }\n\n    return content; // Return whatever we found (might be empty string)\n  }\n\n  /**\n   * Enhanced template string processing with better DataSource support\n   * @private\n   */\n  _processEnhancedTemplateStrings(content) {\n    return DataSourceMixin.processEnhancedTemplateStrings(content, 'TextOverlayRenderer');\n  }\n\n  /**\n   * Build SVG definitions for gradients, patterns, and effects\n   * @private\n   */\n  _buildDefinitions(textStyle, overlayId) {\n    const defs = [];\n\n    // Gradients\n    if (textStyle.gradient) {\n      defs.push(this._createGradientDefinition(textStyle.gradient, overlayId));\n    }\n\n    // Patterns\n    if (textStyle.pattern) {\n      defs.push(this._createPatternDefinition(textStyle.pattern, overlayId));\n    }\n\n    // Effects (filters)\n    if (textStyle.glow) {\n      defs.push(this._createGlowFilter(textStyle.glow, overlayId));\n    }\n\n    if (textStyle.shadow) {\n      defs.push(this._createShadowFilter(textStyle.shadow, overlayId));\n    }\n\n    if (textStyle.blur) {\n      defs.push(this._createBlurFilter(textStyle.blur, overlayId));\n    }\n\n    if (defs.length === 0) {\n      return '';\n    }\n\n    return `<defs>${defs.join('\\n')}</defs>`;\n  }\n\n  /**\n   * Build the main text element with all styling\n   * @private\n   */\n  _buildMainText(textContent, x, y, textStyle, overlayId, animationAttributes) {\n    if (textStyle.multiline) {\n      return this._buildMultilineText(textContent, x, y, textStyle, overlayId, animationAttributes);\n    }\n\n    const attributes = [];\n\n    // Position\n    attributes.push(`x=\"${x}\"`);\n    attributes.push(`y=\"${y}\"`);\n\n    // Core text styling\n    this._applyTextAttributes(attributes, textStyle, overlayId);\n\n    // Animation attributes (for future anime.js integration)\n    attributes.push(...animationAttributes.textAttributes);\n\n    const escapedText = this.escapeXml(textContent);\n    return `<text ${attributes.join(' ')}>${escapedText}</text>`;\n  }\n\n  /**\n   * Build multiline text with proper line spacing\n   * @private\n   */\n  _buildMultilineText(textContent, x, y, textStyle, overlayId, animationAttributes) {\n    const lines = textContent.split('\\n');\n    const lineHeight = textStyle.fontSize * textStyle.lineHeight;\n    const tspanElements = [];\n\n    lines.forEach((line, index) => {\n      const dy = index === 0 ? 0 : lineHeight;\n      const escapedLine = this.escapeXml(line);\n      tspanElements.push(`<tspan x=\"${x}\" dy=\"${dy}\">${escapedLine}</tspan>`);\n    });\n\n    const attributes = [];\n\n    // Position (y for first line)\n    attributes.push(`y=\"${y}\"`);\n\n    // Core text styling\n    this._applyTextAttributes(attributes, textStyle, overlayId);\n\n    // Animation attributes\n    attributes.push(...animationAttributes.textAttributes);\n\n    return `<text ${attributes.join(' ')}>${tspanElements.join('')}</text>`;\n  }\n\n  /**\n   * Apply common text attributes\n   * @private\n   */\n  _applyTextAttributes(attributes, textStyle, overlayId) {\n    // Fill styling\n    if (textStyle.gradient) {\n      attributes.push(`fill=\"url(#text-gradient-${overlayId})\"`);\n    } else if (textStyle.pattern) {\n      attributes.push(`fill=\"url(#text-pattern-${overlayId})\"`);\n    } else {\n      attributes.push(`fill=\"${textStyle.color}\"`);\n    }\n\n    attributes.push(`fill-opacity=\"${textStyle.opacity}\"`);\n\n    // Font styling\n    attributes.push(`font-size=\"${textStyle.fontSize}\"`);\n    if (textStyle.fontFamily !== 'inherit') {\n      attributes.push(`font-family=\"${textStyle.fontFamily}\"`);\n    }\n    if (textStyle.fontWeight !== 'normal') {\n      attributes.push(`font-weight=\"${textStyle.fontWeight}\"`);\n    }\n    if (textStyle.fontStyle !== 'normal') {\n      attributes.push(`font-style=\"${textStyle.fontStyle}\"`);\n    }\n\n    // Text alignment\n    if (textStyle.textAnchor !== 'start') {\n      attributes.push(`text-anchor=\"${textStyle.textAnchor}\"`);\n    }\n    if (textStyle.dominantBaseline !== 'auto') {\n      attributes.push(`dominant-baseline=\"${textStyle.dominantBaseline}\"`);\n    }\n    if (textStyle.alignmentBaseline !== 'auto') {\n      attributes.push(`alignment-baseline=\"${textStyle.alignmentBaseline}\"`);\n    }\n\n    // Spacing\n    if (textStyle.letterSpacing !== 'normal') {\n      attributes.push(`letter-spacing=\"${textStyle.letterSpacing}\"`);\n    }\n    if (textStyle.wordSpacing !== 'normal') {\n      attributes.push(`word-spacing=\"${textStyle.wordSpacing}\"`);\n    }\n\n    // Text decoration\n    if (textStyle.textDecoration !== 'none') {\n      attributes.push(`text-decoration=\"${textStyle.textDecoration}\"`);\n    }\n\n    // Stroke properties\n    if (textStyle.stroke && textStyle.strokeWidth > 0) {\n      attributes.push(`stroke=\"${textStyle.stroke}\"`);\n      attributes.push(`stroke-width=\"${textStyle.strokeWidth}\"`);\n      attributes.push(`stroke-opacity=\"${textStyle.strokeOpacity}\"`);\n      attributes.push(`stroke-linecap=\"${textStyle.strokeLinecap}\"`);\n      attributes.push(`stroke-linejoin=\"${textStyle.strokeLinejoin}\"`);\n\n      if (textStyle.strokeDasharray) {\n        attributes.push(`stroke-dasharray=\"${textStyle.strokeDasharray}\"`);\n        if (textStyle.strokeDashoffset !== 0) {\n          attributes.push(`stroke-dashoffset=\"${textStyle.strokeDashoffset}\"`);\n        }\n      }\n    }\n\n    // Visibility\n    if (textStyle.visibility !== 'visible') {\n      attributes.push(`visibility=\"${textStyle.visibility}\"`);\n    }\n\n    // Effects\n    const filters = [];\n    if (textStyle.glow) filters.push(`url(#text-glow-${overlayId})`);\n    if (textStyle.shadow) filters.push(`url(#text-shadow-${overlayId})`);\n    if (textStyle.blur) filters.push(`url(#text-blur-${overlayId})`);\n    if (filters.length > 0) {\n      attributes.push(`filter=\"${filters.join(' ')}\"`);\n    }\n  }\n\n  /**\n   * Build text decoration elements (brackets, highlights, etc.)\n   * @private\n   */\n  _buildTextDecorations(textContent, x, y, textStyle, overlayId) {\n    const decorations = [];\n\n    // LCARS-style brackets\n    if (textStyle.bracket_style) {\n      decorations.push(this._buildBrackets(textContent, x, y, textStyle, overlayId));\n    }\n\n    // Highlight background\n    if (textStyle.highlight) {\n      decorations.push(this._buildHighlight(textContent, x, y, textStyle, overlayId));\n    }\n\n    // Status indicator\n    if (textStyle.status_indicator) {\n      decorations.push(this._buildStatusIndicator(x, y, textStyle, overlayId));\n    }\n\n    return decorations.filter(Boolean).join('\\n');\n  }\n\n  /**\n   * Build special effects elements\n   * @private\n   */\n  _buildEffects(textContent, x, y, textStyle, overlayId) {\n    const effects = [];\n\n    // Future: Add text-specific animation elements\n    if (textStyle.features.includes('typewriter')) {\n      // Placeholder for typewriter animation elements\n    }\n\n    if (textStyle.features.includes('pulse')) {\n      // Placeholder for pulse animation elements\n    }\n\n    if (textStyle.features.includes('fade')) {\n      // Placeholder for fade animation elements\n    }\n\n    return effects.join('\\n');\n  }\n\n  /**\n   * Build LCARS-style brackets with precise measurements\n   * @private\n   * @param {string} textContent - Text content for measurement\n   * @param {number} x - Text x position\n   * @param {number} y - Text y position\n   * @param {Object} textStyle - Resolved text style configuration\n   * @param {string} overlayId - Overlay ID for unique identification\n   * @returns {string} SVG markup for LCARS brackets\n   */\n  _buildBrackets(textContent, x, y, textStyle, overlayId) {\n    // Use measurement-adjusted font (prevents width overestimation)\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n    let bbox;\n\n    if (textStyle.multiline) {\n      // For multiline text, get comprehensive measurements\n      const multilineMetrics = RendererUtils.measureMultilineText(textContent, font, textStyle.lineHeight);\n      // Create bbox-like object from multiline measurements\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - multilineMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - multilineMetrics.width;\n      }\n\n      let top = y - multilineMetrics.lineMetrics[0]?.ascent || 0;\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - multilineMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + multilineMetrics.width,\n        top,\n        bottom: top + multilineMetrics.height,\n        width: multilineMetrics.width,\n        height: multilineMetrics.height\n      };\n    } else {\n      // Single line text - use standard bounding box\n      bbox = RendererUtils.getTextBoundingBox(\n        textContent,\n        x,\n        y,\n        font,\n        textStyle.textAnchor,\n        textStyle.dominantBaseline\n      );\n    }\n\n    const bracketWidth = 8;\n    const padding = 4;\n    const extraHeight = 4; // Additional height for visual appeal\n\n    const leftX = bbox.left - bracketWidth - padding;\n    const rightX = bbox.right + padding;\n    const topY = bbox.top - extraHeight;\n    const bottomY = bbox.bottom + extraHeight;\n\n    const bracketColor = textStyle.color;\n    const strokeWidth = Math.max(1, textStyle.fontSize / 16);\n\n    return `<g data-decoration=\"brackets\">\n              <path d=\"M ${leftX + bracketWidth} ${topY} L ${leftX} ${topY} L ${leftX} ${bottomY} L ${leftX + bracketWidth} ${bottomY}\"\n                    stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n              <path d=\"M ${rightX - bracketWidth} ${topY} L ${rightX} ${topY} L ${rightX} ${bottomY} L ${rightX - bracketWidth} ${bottomY}\"\n                    stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n            </g>`;\n  }\n\n  /**\n   * Build highlight background with precise measurements and coordinate transformation\n   * @private\n   */\n  _buildHighlight(textContent, x, y, textStyle, overlayId) {\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n    let bbox;\n\n    if (textStyle.multiline) {\n      // For multiline text, get comprehensive measurements with coordinate transformation\n      const multilineMetrics = RendererUtils.measureMultilineText(\n        textContent,\n        font,\n        textStyle.lineHeight,\n        true,\n        this.container // Pass container for coordinate transformation\n      );\n\n      // Create bbox-like object from multiline measurements\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - multilineMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - multilineMetrics.width;\n      }\n\n      let top = y - multilineMetrics.lineMetrics[0]?.ascent || 0;\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - multilineMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + multilineMetrics.width,\n        top,\n        bottom: top + multilineMetrics.height,\n        width: multilineMetrics.width,\n        height: multilineMetrics.height\n      };\n    } else {\n      // Single line text - use standard bounding box with coordinate transformation\n      bbox = RendererUtils.getTextBoundingBox(\n        textContent,\n        x,\n        y,\n        font,\n        textStyle.textAnchor,\n        textStyle.dominantBaseline,\n        this.container // Pass container for coordinate transformation\n      );\n    }\n\n    // Get properly scaled padding\n    const transformInfo = RendererUtils._getSvgTransformInfo(this.container);\n    const padding = transformInfo ? transformInfo.pixelToViewBox(2) : 2;\n\n    const highlightX = bbox.left - padding;\n    const highlightY = bbox.top - padding;\n    const highlightWidth = bbox.width + (padding * 2);\n    const highlightHeight = bbox.height + (padding * 2);\n\n    const highlightColor = typeof textStyle.highlight === 'string' ?\n      textStyle.highlight : 'var(--lcars-blue-light)';\n    const highlightOpacity = typeof textStyle.highlight_opacity === 'number' ?\n      textStyle.highlight_opacity : 0.3;\n\n    return `<rect x=\"${highlightX}\" y=\"${highlightY}\"\n                  width=\"${highlightWidth}\" height=\"${highlightHeight}\"\n                  fill=\"${highlightColor}\" fill-opacity=\"${highlightOpacity}\"\n                  data-decoration=\"highlight\"/>`;\n  }\n\n  /**\n   * Build status indicator with precise positioning and proper coordinate transformation\n   * @private\n   * @param {number} x - Text x position\n   * @param {number} y - Text y position\n   * @param {Object} textStyle - Resolved text style configuration\n   * @param {string} overlayId - Overlay ID for unique identification\n   * @returns {string} SVG markup for status indicator\n   */\n  _buildStatusIndicator(x, y, textStyle, overlayId) {\n    const indicatorSize = textStyle.fontSize * 0.4;\n    const statusColor = typeof textStyle.status_indicator === 'string'\n      ? textStyle.status_indicator\n      : 'var(--lcars-green)';\n\n    const position = textStyle.status_indicator_position || 'left-center';\n\n    // Replace base font with measurement-adjusted font\n    const textContent = textStyle._cachedContent || textStyle.value || '';\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n\n    // Get the SVG transform info for debugging and padding calculation\n    const transformInfo = RendererUtils._getSvgTransformInfo(this.container);\n\n    console.log(`[TextOverlayRenderer] Transform info for ${overlayId}:`, {\n      transformInfo,\n      containerTag: this.container?.tagName,\n      hasSvg: !!this.container?.querySelector('svg')\n    });\n\n    let bbox;\n    if (textStyle.multiline) {\n      // For multiline text, get measurements and let RendererUtils handle coordinate transformation\n      const multilineMetrics = RendererUtils.measureMultilineText(\n        textContent,\n        font,\n        textStyle.lineHeight,\n        true,\n        this.container // Let RendererUtils handle the transformation\n      );\n\n      // Use the already-transformed measurements directly\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - multilineMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - multilineMetrics.width;\n      }\n\n      let top = y - (multilineMetrics.lineMetrics[0]?.ascent || 0);\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - multilineMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + multilineMetrics.width,\n        top,\n        bottom: top + multilineMetrics.height,\n        width: multilineMetrics.width,\n        height: multilineMetrics.height,\n        centerX: left + multilineMetrics.width / 2,\n        centerY: top + multilineMetrics.height / 2\n      };\n    } else {\n      // Single line text - get measurements and let RendererUtils handle coordinate transformation\n      const textMetrics = RendererUtils.measureText(textContent, font, true, this.container);\n\n      // Use the already-transformed measurements directly\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - textMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - textMetrics.width;\n      }\n\n      let top = y - textMetrics.ascent;\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - textMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + textMetrics.width,\n        top,\n        bottom: top + textMetrics.height,\n        width: textMetrics.width,\n        height: textMetrics.height,\n        centerX: left + textMetrics.width / 2,\n        centerY: top + textMetrics.height / 2\n      };\n    }\n\n    // Debug logging to trace coordinate issues\n    console.log(`[TextOverlayRenderer] Status indicator debug for ${overlayId}:`, {\n      textContent,\n      x, y,\n      textAnchor: textStyle.textAnchor,\n      dominantBaseline: textStyle.dominantBaseline,\n      position,\n      bbox,\n      fontSize: textStyle.fontSize,\n      hasContainer: !!this.container,\n      containerType: this.container?.tagName,\n      transformInfo: transformInfo ? {\n        scaleX: transformInfo.scaleX,\n        scaleY: transformInfo.scaleY,\n        viewBox: transformInfo.viewBox\n      } : null\n    });\n\n    // Calculate indicator position based on actual text bounds (already in correct coordinate space)\n    let indicatorX = x, indicatorY = y;\n\n    // Use a consistent padding value - transform pixel padding to viewBox coordinates only once\n    const pixelPadding = 8; // 8 pixel padding\n    const padding = transformInfo ?\n      transformInfo.pixelToViewBox(pixelPadding) :\n      indicatorSize; // Fallback to indicator size if no transform info\n\n    switch (position) {\n      case 'top-left':\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.top - padding;\n        break;\n      case 'top-right':\n        indicatorX = bbox.right + padding;\n        indicatorY = bbox.top - padding;\n        break;\n      case 'bottom-left':\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.bottom + padding;\n        break;\n      case 'bottom-right':\n        indicatorX = bbox.right + padding;\n        indicatorY = bbox.bottom + padding;\n        break;\n      case 'top':\n        indicatorX = bbox.centerX;\n        indicatorY = bbox.top - padding;\n        break;\n      case 'bottom':\n        indicatorX = bbox.centerX;\n        indicatorY = bbox.bottom + padding;\n        break;\n      case 'left-center':\n      case 'left':\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.centerY;\n        break;\n      case 'right-center':\n      case 'right':\n        indicatorX = bbox.right + padding;\n        indicatorY = bbox.centerY;\n        break;\n      case 'center':\n        indicatorX = bbox.centerX;\n        indicatorY = bbox.centerY;\n        break;\n      default:\n        // fallback to left-center\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.centerY;\n    }\n\n    console.log(`[TextOverlayRenderer] Status indicator final position for ${overlayId}:`, {\n      indicatorX,\n      indicatorY,\n      padding,\n      pixelPadding,\n      transformInfo: transformInfo ? 'present' : 'missing'\n    });\n\n    return `<circle cx=\"${indicatorX}\" cy=\"${indicatorY}\" r=\"${indicatorSize}\"\n                    fill=\"${statusColor}\"\n                    data-status-pos=\"${position}\"\n                    data-decoration=\"status-indicator\"/>`;\n  }\n\n\n  /**\n   * Create gradient definition for text\n   * @private\n   */\n  _createGradientDefinition(gradientConfig, overlayId) {\n    const gradientId = `text-gradient-${overlayId}`;\n\n    if (typeof gradientConfig === 'string') {\n      // Simple two-color gradient\n      const [color1, color2] = gradientConfig.split(',').map(c => c.trim());\n      return `<linearGradient id=\"${gradientId}\">\n                <stop offset=\"0%\" stop-color=\"${color1 || 'var(--lcars-orange)'}\"/>\n                <stop offset=\"100%\" stop-color=\"${color2 || 'var(--lcars-red)'}\"/>\n              </linearGradient>`;\n    }\n\n    // Advanced gradient configuration\n    const type = gradientConfig.type || 'linear';\n    const stops = gradientConfig.stops || [\n      { offset: '0%', color: 'var(--lcars-orange)' },\n      { offset: '100%', color: 'var(--lcars-red)' }\n    ];\n\n    if (type === 'radial') {\n      const cx = gradientConfig.cx || '50%';\n      const cy = gradientConfig.cy || '50%';\n      const r = gradientConfig.r || '50%';\n\n      const stopElements = stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<radialGradient id=\"${gradientId}\" cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\">\n                ${stopElements}\n              </radialGradient>`;\n    } else {\n      const x1 = gradientConfig.x1 || '0%';\n      const y1 = gradientConfig.y1 || '0%';\n      const x2 = gradientConfig.x2 || '100%';\n      const y2 = gradientConfig.y2 || '0%';\n\n      const stopElements = stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<linearGradient id=\"${gradientId}\" x1=\"${x1}\" y1=\"${y1}\" x2=\"${x2}\" y2=\"${y2}\">\n                ${stopElements}\n              </linearGradient>`;\n    }\n  }\n\n  /**\n   * Create pattern definition for text\n   * @private\n   */\n  _createPatternDefinition(patternConfig, overlayId) {\n    const patternId = `text-pattern-${overlayId}`;\n\n    if (typeof patternConfig === 'string') {\n      // Simple pattern types\n      switch (patternConfig) {\n        case 'dots':\n          return `<pattern id=\"${patternId}\" patternUnits=\"userSpaceOnUse\" width=\"8\" height=\"8\">\n                    <circle cx=\"4\" cy=\"4\" r=\"1\" fill=\"currentColor\"/>\n                  </pattern>`;\n        case 'lines':\n          return `<pattern id=\"${patternId}\" patternUnits=\"userSpaceOnUse\" width=\"4\" height=\"4\">\n                    <path d=\"M 0,4 l 4,-4 M -1,1 l 2,-2 M 3,5 l 2,-2\" stroke=\"currentColor\" stroke-width=\"1\"/>\n                  </pattern>`;\n        default:\n          return '';\n      }\n    }\n\n    // Advanced pattern configuration\n    const width = patternConfig.width || 10;\n    const height = patternConfig.height || 10;\n    const patternUnits = patternConfig.patternUnits || 'userSpaceOnUse';\n\n    return `<pattern id=\"${patternId}\" patternUnits=\"${patternUnits}\" width=\"${width}\" height=\"${height}\">\n              ${patternConfig.content || ''}\n            </pattern>`;\n  }\n\n  /**\n   * Create glow filter for text\n   * @private\n   */\n  _createGlowFilter(glowConfig, overlayId) {\n    const filterId = `text-glow-${overlayId}`;\n\n    let color, blur, intensity;\n    if (typeof glowConfig === 'string') {\n      color = glowConfig;\n      blur = 3;\n      intensity = 1;\n    } else {\n      color = glowConfig.color || 'var(--lcars-orange)';\n      blur = Number(glowConfig.blur || 3);\n      intensity = Number(glowConfig.intensity || 1);\n    }\n\n    return `<filter id=\"${filterId}\">\n              <feGaussianBlur stdDeviation=\"${blur}\" result=\"blur\"/>\n              <feFlood flood-color=\"${color}\" flood-opacity=\"${intensity}\" result=\"color\"/>\n              <feComposite in=\"color\" in2=\"blur\" operator=\"in\" result=\"coloredBlur\"/>\n              <feMerge>\n                <feMergeNode in=\"coloredBlur\"/>\n                <feMergeNode in=\"SourceGraphic\"/>\n              </feMerge>\n            </filter>`;\n  }\n\n  /**\n   * Create shadow filter for text\n   * @private\n   */\n  _createShadowFilter(shadowConfig, overlayId) {\n    const filterId = `text-shadow-${overlayId}`;\n\n    let offsetX, offsetY, blur, color;\n    if (typeof shadowConfig === 'string') {\n      [offsetX, offsetY, blur, color] = shadowConfig.split(' ');\n      offsetX = Number(offsetX) || 2;\n      offsetY = Number(offsetY) || 2;\n      blur = Number(blur) || 2;\n      color = color || 'rgba(0,0,0,0.5)';\n    } else {\n      offsetX = Number(shadowConfig.offsetX || 2);\n      offsetY = Number(shadowConfig.offsetY || 2);\n      blur = Number(shadowConfig.blur || 2);\n      color = shadowConfig.color || 'rgba(0,0,0,0.5)';\n    }\n\n    return `<filter id=\"${filterId}\">\n              <feDropShadow dx=\"${offsetX}\" dy=\"${offsetY}\" stdDeviation=\"${blur}\" flood-color=\"${color}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Create blur filter for text\n   * @private\n   */\n  _createBlurFilter(blurConfig, overlayId) {\n    const filterId = `text-blur-${overlayId}`;\n    const blur = typeof blurConfig === 'number' ? blurConfig : (Number(blurConfig) || 1);\n\n    return `<filter id=\"${filterId}\">\n              <feGaussianBlur stdDeviation=\"${blur}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Prepare animation attributes for future anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    // Use unified animation system\n    const standardStyles = RendererUtils.parseStandardAnimationStyles(style);\n\n    const animationAttributes = {\n      textAttributes: [],\n      hasAnimations: false\n    };\n\n    // Use standardized animation data attributes\n    const animationDataAttrs = RendererUtils.createAnimationDataAttributes(standardStyles);\n    if (animationDataAttrs) {\n      animationAttributes.textAttributes.push(animationDataAttrs);\n      animationAttributes.hasAnimations = true;\n    }\n\n    // Legacy support for existing animation properties\n    if (style.pulse_speed || style.pulseSpeed) {\n      animationAttributes.textAttributes.push(`data-pulse-speed=\"${style.pulse_speed || style.pulseSpeed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.fade_speed || style.fadeSpeed) {\n      animationAttributes.textAttributes.push(`data-fade-speed=\"${style.fade_speed || style.fadeSpeed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.typewriter_speed || style.typewriterSpeed) {\n      animationAttributes.textAttributes.push(`data-typewriter-speed=\"${style.typewriter_speed || style.typewriterSpeed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Render a simple fallback text when enhanced rendering fails\n   * @private\n   */\n  _renderFallbackText(overlay, x, y) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const text = style.value || overlay.text || '';\n    const color = style.color || 'var(--lcars-orange)';\n    const fontSize = style.font_size || style.fontSize || 16;\n\n    console.warn(`[TextOverlayRenderer] Using fallback rendering for text ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"text\" data-fallback=\"true\">\n              <text x=\"${x}\" y=\"${y}\"\n                    fill=\"${color}\"\n                    font-size=\"${fontSize}\"\n                    text-anchor=\"start\"\n                    dominant-baseline=\"auto\">\n                ${this.escapeXml(text)}\n              </text>\n            </g>`;\n  }\n\n  /**\n   * Update text styling dynamically (for future real-time updates)\n   * @public\n   */\n  updateTextStyle(overlayId, newStyle) {\n    // Future: Update existing text styles without full re-render\n    console.log(`[TextOverlayRenderer] Style update requested for text ${overlayId}`);\n  }\n\n  /**\n   * Get rendering capabilities and features supported\n   * @public\n   */\n  getCapabilities() {\n    return {\n      multiline: true,\n      gradients: true,\n      patterns: true,\n      effects: ['glow', 'shadow', 'blur'],\n      decorations: ['brackets', 'highlight', 'status'],\n      animations: ['pulse', 'fade', 'typewriter'], // Future implementation\n      textWrapping: true,\n      advancedTypography: true,\n      strokeText: true,\n      advanced: true\n    };\n  }\n\n  /**\n   * Escape XML special characters\n   * @private\n   */\n  static escapeXml(text) {\n    return String(text)\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n\n  /**\n   * Instance method for XML escaping\n   * @private\n   */\n  escapeXml(text) {\n    return TextOverlayRenderer.escapeXml(text);\n  }\n\n  /**\n   * Get attachment points for line connectors with proper coordinate transformation\n   * @public\n   */\n  getAttachmentPoints(overlay, x, y) {\n    const textContent = this._resolveTextContent(overlay, overlay.finalStyle || {});\n    const textStyle = this._resolveTextStyles(overlay.finalStyle || {}, overlay.id);\n    // Use adjusted font for consistent connector attachment\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n\n    return RendererUtils.getTextAttachmentPoints(\n      textContent,\n      x,\n      y,\n      font,\n      textStyle.textAnchor,\n      textStyle.dominantBaseline,\n      this.container\n    );\n  }\n\n  /**\n   * Compute attachment points & bbox for a text overlay without rendering (used by line routing).\n   * Returns null if position or content invalid.\n   */\n  static computeAttachmentPoints(overlay, anchors, container) {\n    if (!overlay || overlay.type !== 'text') return null;\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) return null;\n    const [x, y] = position;\n    const instance = new TextOverlayRenderer();\n    const style = overlay.finalStyle || overlay.style || {};\n    const textStyle = instance._resolveTextStyles(style, overlay.id);\n    const textContent = instance._resolveTextContent(overlay, style);\n    if (!textContent) return null;\n    // Measurement font (correct inherited font + scaling)\n    const font = RendererUtils.buildMeasurementFontString(textStyle, container);\n    const bbox = RendererUtils.getTextBoundingBox(\n      textContent,\n      x,\n      y,\n      font,\n      textStyle.textAnchor,\n      textStyle.dominantBaseline,\n      container\n    );\n    const points = RendererUtils.getTextAttachmentPoints(\n      textContent,\n      x,\n      y,\n      font,\n      textStyle.textAnchor,\n      textStyle.dominantBaseline,\n      container\n    );\n    return {\n      id: overlay.id,\n      center: points.center,\n      points,\n      bbox,\n      textStyle,\n      x,\n      y\n    };\n  }\n\n  // NEW: consolidated measurement helper (mirrors bracket/highlight logic)\n  _measureTextBlock(textContent, x, y, textStyle) {\n    try {\n      const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n      if (textStyle.multiline) {\n        const mm = RendererUtils.measureMultilineText(\n          textContent,\n          font,\n          textStyle.lineHeight,\n          true,\n          this.container\n        );\n        return {\n          width: mm.width,\n          height: mm.height\n        };\n      } else {\n        const m = RendererUtils.measureText(textContent, font, true, this.container);\n        return {\n          width: m.width,\n          height: m.height\n        };\n      }\n    } catch (_) {\n      return { width: 0, height: 0 };\n    }\n  }\n\n  /**\n   * Resolve text content with updated DataSource data (for dynamic updates)\n   * @public - Used by AdvancedRenderer for real-time text overlay updates\n   * @param {Object} overlay - Overlay configuration\n   * @param {Object} style - Style configuration\n   * @param {Object} newDataSourceData - Updated DataSource data\n   * @returns {string} Resolved text content with new data\n   */\n  _resolveTextContentWithData(overlay, style, newDataSourceData) {\n    console.log(`[TextOverlayRenderer] Resolving text content with updated data for ${overlay.id}`);\n\n    // Start with basic content resolution (same as original method)\n    let content = style.value || overlay.text || overlay.content || '';\n\n    // Check raw overlay configuration if content not found in standard properties\n    if (!content && overlay._raw?.content) {\n      content = overlay._raw.content;\n    }\n    if (!content && overlay._raw?.text) {\n      content = overlay._raw.text;\n    }\n\n    // ENHANCED: If we have template content and new DataSource data, process with new data\n    if (content && typeof content === 'string' && content.includes('{') && newDataSourceData) {\n      // CRITICAL FIX: The newDataSourceData might be for a specific source, not all sources\n      // We need to delegate to DataSourceMixin for proper template processing\n      console.log(`[TextOverlayRenderer] DEBUG: Processing template with DataSourceMixin for unified handling`);\n      content = DataSourceMixin.processEnhancedTemplateStringsWithFallback(content, 'TextOverlayRenderer');\n      return content;\n    }\n\n    // Fallback to original logic for other cases\n    return this._resolveTextContent(overlay, style);\n  }\n\n  /**\n   * Process template strings with specific DataSource data - SIMPLIFIED\n   * @private\n   * @param {string} templateString - Template string with placeholders\n   * @param {Object} dataSourceData - DataSource data to use for resolution\n   * @returns {string} Processed template string\n   */\n  _processTemplateWithData(templateString, dataSourceData) {\n    console.log(`[TextOverlayRenderer] DEBUG: Processing template with DataSourceMixin: \"${templateString}\"`);\n    console.log(`[TextOverlayRenderer] DEBUG: With data:`, dataSourceData);\n\n    // SIMPLIFIED: Just use DataSourceMixin which handles all the complexity\n    return DataSourceMixin.processEnhancedTemplateStringsWithFallback(templateString, 'TextOverlayRenderer');\n  }\n}","/* MSD Corner Arc Scenario Harness (Wave 5 - M5.5)\n * Usage:\n *   window.__msdScenarios.arcs.list()\n *   window.__msdScenarios.arcs.runAll()\n */\n(function initArcScenarios(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi(){ const p=W.__msdDebug?.pipelineInstance; if(!p||!p.enabled) throw new Error('pipeline disabled'); return p; }\n  function inspect(id){ return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(scope='*'){ W.__msdDebug?.routing?.invalidate(scope); }\n\n  const targetLine = 'line_grid_forced'; // has corner_style: round with >1 bend after obstacles\n\n  function ensureRound(lineId){\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===lineId);\n    if (!ov) throw new Error('overlay not found');\n    ov._raw = ov._raw || {};\n    ov._raw.corner_style = 'round';\n    ov._raw.corner_radius = ov._raw.corner_radius || 40;\n  }\n\n  function scenarioArcPresence() {\n    ensureRound(targetLine);\n    invalidate('*');\n    const res = inspect(targetLine);\n    const ok = !!res && /A\\d+/.test(res.d) && res.meta.arc && res.meta.arc.count > 0;\n    return { ok, details: { dSample: res?.d?.slice(0,120)+'...', arc: res?.meta?.arc } };\n  }\n\n  function scenarioRadiusClamp() {\n    ensureRound(targetLine);\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===targetLine);\n    const original = ov._raw.corner_radius;\n    ov._raw.corner_radius = 1000; // absurdly large to trigger clamping\n    invalidate('*');\n    const res = inspect(targetLine);\n    ov._raw.corner_radius = original;\n    invalidate('*');\n    const ok = !!res && res.meta.arc && res.meta.arc.count > 0;\n    return { ok, details: { trimPx: res?.meta?.arc?.trimPx, count: res?.meta?.arc?.count } };\n  }\n\n  function scenarioArcCacheReuse() {\n    ensureRound(targetLine);\n    invalidate('*');\n    const first = inspect(targetLine);\n    const second = inspect(targetLine);\n    const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true && second.meta.arc?.count >= 0;\n    return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit, arcCount: second?.meta?.arc?.count } };\n  }\n\n  function scenarioMiterFallback() {\n    // Temporarily set corner_style:miter expect no arc meta\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===targetLine);\n    if (!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origStyle = ov._raw.corner_style;\n    ov._raw.corner_style = 'miter';\n    invalidate('*');\n    const res = inspect(targetLine);\n    ov._raw.corner_style = origStyle;\n    invalidate('*');\n    const ok = !!res && !res.meta.arc;\n    return { ok, details: { hasArcMeta: !!res.meta.arc } };\n  }\n\n  const scenarios = {\n    arc_presence: scenarioArcPresence,\n    radius_clamp: scenarioRadiusClamp,\n    arc_cache_reuse: scenarioArcCacheReuse,\n    miter_fallback: scenarioMiterFallback\n  };\n\n  const api = {\n    list: ()=>Object.keys(scenarios),\n    run: (n)=>{\n      if(!scenarios[n]) { console.warn('[MSD Arc Scenario] Unknown', n); return null; }\n      try {\n        const r = scenarios[n]();\n        console.log(`[MSD Arc Scenario] ${n}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e){\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Arc Scenario] ${n}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: ()=>{\n      const res={};\n      for (const k of Object.keys(scenarios)) res[k]=api.run(k);\n      const allOk = Object.values(res).every(r=>r&&r.ok);\n      console.log('[MSD Arc Scenario] Summary:', allOk?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.arcs = api;\n  console.info('[MSD v1] Arc routing scenario harness installed. Use: window.__msdScenarios.arcs.list()');\n})();\n","/* MSD Channel Routing Scenario Harness (Wave 5 - M5.4)\n * Usage:\n *   window.__msdScenarios.channels.list()\n *   window.__msdScenarios.channels.runAll()\n */\n(function initChannelScenarios(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi(){ const p=W.__msdDebug?.pipelineInstance; if(!p||!p.enabled) throw new Error('pipeline disabled'); return p; }\n  function inspect(id){ return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(scope='*'){ W.__msdDebug?.routing?.invalidate(scope); }\n\n  function setMode(id, modeFull, mode=null){\n    const model = pi().getResolvedModel();\n    const ov = model?.overlays.find(o=>o.id===id);\n    if(!ov) throw new Error('overlay not found '+id);\n    ov._raw = ov._raw || {};\n    if (modeFull !== undefined) ov._raw.route_mode_full = modeFull;\n    if (mode !== null) ov._raw.route_mode = mode;\n    return ov;\n  }\n\n  function scenarioPreferImprovesCost() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origChannels = ov._raw.route_channels ? ov._raw.route_channels.slice() : [];\n    const origMode = ov._raw.route_channel_mode;\n\n    // Baseline without channels\n    ov._raw.route_channels = [];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const base = inspect(id);\n\n    // With channels\n    ov._raw.route_channels = ['main_bus'];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const preferred = inspect(id);\n\n    // restore\n    ov._raw.route_channels = origChannels;\n    ov._raw.route_channel_mode = origMode;\n    invalidate('*');\n\n    const ok = !!base && !!preferred && preferred.meta.cost <= base.meta.cost;\n    return { ok, details: { baseCost: base?.meta.cost, preferCost: preferred?.meta.cost } };\n  }\n\n  function scenarioAvoidIncreasesCost() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origChannels = ov._raw.route_channels ? ov._raw.route_channels.slice() : [];\n    const origMode = ov._raw.route_channel_mode;\n\n    ov._raw.route_channels = ['main_bus'];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const prefer = inspect(id);\n\n    ov._raw.route_channel_mode = 'avoid';\n    invalidate('*');\n    const avoid = inspect(id);\n\n    ov._raw.route_channels = origChannels;\n    ov._raw.route_channel_mode = origMode;\n    invalidate('*');\n\n    const ok = !!prefer && !!avoid && avoid.meta.cost >= prefer.meta.cost;\n    return { ok, details: { preferCost: prefer?.meta.cost, avoidCost: avoid?.meta.cost } };\n  }\n\n  function scenarioForcePenalty() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origChannels = ov._raw.route_channels ? ov._raw.route_channels.slice() : [];\n    const origMode = ov._raw.route_channel_mode;\n\n    ov._raw.route_channels = ['main_bus','aux_bus']; // force across two channels (likely outside some)\n    ov._raw.route_channel_mode = 'force';\n    invalidate('*');\n    const forced = inspect(id);\n\n    ov._raw.route_channels = origChannels;\n    ov._raw.route_channel_mode = origMode;\n    invalidate('*');\n\n    const ok = !!forced && forced.meta.channel && (forced.meta.channel.forcedOutside === true || forced.meta.channel.coveragePct === 100);\n    return { ok, details: forced?.meta.channel || {} };\n  }\n\n  // NEW: attempt to increase coverage by shaping (forces low baseline by clearing channels first)\n  function scenarioPreferShapingCoverage() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const save = {\n      channels: ov._raw.route_channels ? ov._raw.route_channels.slice():[],\n      mode: ov._raw.route_channel_mode,\n      modeFull: ov._raw.route_mode_full\n    };\n    ov._raw.route_mode_full = 'grid';\n    ov._raw.route_channels = ['main_bus'];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const first = inspect(id);\n    // if already high coverage, skip shaping test as pass\n    if (!first || !first.meta.channel) {\n      // restore\n      ov._raw.route_channels = save.channels; ov._raw.route_channel_mode = save.mode; ov._raw.route_mode_full = save.modeFull; invalidate('*');\n      return { ok:false, details:'channel meta missing'};\n    }\n    const c1 = first.meta.channel.coveragePct;\n    // Artificially move elbow outside channel to force shaping attempt by tweaking anchor via API if available\n    try {\n      const anchorSet = pi().setAnchor && pi().setAnchor;\n      if (anchorSet) {\n        // nudge anchor horizontally away\n        const anchorId = ov._raw.anchor;\n        const rm = pi().getResolvedModel();\n        if (rm?.anchors?.[anchorId]) {\n          const a = rm.anchors[anchorId].slice();\n            pi().setAnchor(anchorId, [a[0]-120, a[1]]);\n          invalidate('*');\n        }\n      }\n    } catch {}\n    const second = inspect(id);\n    const c2 = second?.meta?.channel?.coveragePct ?? c1;\n    // restore\n    ov._raw.route_channels = save.channels;\n    ov._raw.route_channel_mode = save.mode;\n    ov._raw.route_mode_full = save.modeFull;\n    invalidate('*');\n    const ok = c2 >= c1;\n    return { ok, details: { coverageBefore: c1, coverageAfter: c2 } };\n  }\n\n  function scenarioForceDowngradeOrFull() {\n    const id='line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const save = {\n      channels: ov._raw.route_channels ? ov._raw.route_channels.slice():[],\n      mode: ov._raw.route_channel_mode\n    };\n    ov._raw.route_channels = ['main_bus','aux_bus'];\n    ov._raw.route_channel_mode = 'force';\n    invalidate('*');\n    const res = inspect(id);\n    const chan = res?.meta?.channel;\n    ov._raw.route_channels = save.channels;\n    ov._raw.route_channel_mode = save.mode;\n    invalidate('*');\n    if (!chan) return { ok:false, details:'no channel meta'};\n    const ok = (chan.coveragePct === 100) || (chan.shaping && chan.shaping.downgraded);\n    return { ok, details: chan };\n  }\n\n  function scenarioChannelAcceptance() {\n    // Re-run core scenarios & aggregate pass/fail\n    const prefer = scenarioPreferImprovesCost();\n    const avoid = scenarioAvoidIncreasesCost();\n    const force = scenarioForcePenalty();\n    const shaping = (typeof scenarioPreferShapingCoverage === 'function') ? scenarioPreferShapingCoverage() : { ok:true };\n    const summaryOk = [prefer, avoid, force, shaping].every(r => r && r.ok);\n    return {\n      ok: summaryOk,\n      details: {\n        prefer, avoid, force, shaping\n      }\n    };\n  }\n\n  const scenarios = {\n    prefer_improves_cost: scenarioPreferImprovesCost,\n    avoid_increases_cost: scenarioAvoidIncreasesCost,\n    force_penalty_or_full_coverage: scenarioForcePenalty,\n    prefer_shaping_coverage: scenarioPreferShapingCoverage,\n    force_downgrade_or_full: scenarioForceDowngradeOrFull,\n    channel_acceptance: scenarioChannelAcceptance    // NEW\n  };\n\n  const api = {\n    list: () => Object.keys(scenarios),\n    run: (n) => {\n      if(!scenarios[n]) { console.warn('[MSD Channel Scenario] Unknown', n); return null; }\n      try {\n        const r = scenarios[n]();\n        console.log(`[MSD Channel Scenario] ${n}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e) {\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Channel Scenario] ${n}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: () => {\n      const res = {};\n      for (const k of Object.keys(scenarios)) res[k] = api.run(k);\n      const ok = Object.values(res).every(r=>r&&r.ok);\n      console.log('[MSD Channel Scenario] Summary:', ok?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.channels = api;\n  console.info('[MSD v1] Channel routing scenario harness installed. Use: window.__msdScenarios.channels.list()');\n})();\n","/* MSD Routing Scenario Harness (Wave 5)\n * Paste/import this once after the pipeline loads (e.g. include in bundle or run in console).\n * Provides reproducible, code-driven tests without editing YAML.\n *\n * Usage (in browser console after card rendered):\n *   window.__msdScenarios.routing.list()\n *   window.__msdScenarios.routing.run('cache')\n *   window.__msdScenarios.routing.runAll()\n *\n * Each scenario returns { ok:boolean, details, warnings:[] } and logs a concise summary.\n */\n\n(function initRoutingHarness(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function requirePipeline() {\n    const pi = W.__msdDebug?.pipelineInstance;\n    if (!pi || pi.enabled === false) throw new Error('Pipeline disabled or missing.');\n    return pi;\n  }\n\n  function getModel() {\n    // Prefer live lastRenderModel if provided by renderer hook\n    return W.__msdDebug?.lastRenderModel || requirePipeline().getResolvedModel?.() || null;\n  }\n\n  function listOverlays() {\n    const m = getModel();\n    return m?.overlays || [];\n  }\n\n  function findOverlay(id) {\n    return listOverlays().find(o => o.id === id);\n  }\n\n  function inspect(id) {\n    return W.__msdDebug?.routing?.inspect(id);\n  }\n\n  function invalidate(scope='*') {\n    W.__msdDebug?.routing?.invalidate(scope);\n  }\n\n  function anchorClone() {\n    const model = getModel();\n    return model?.anchors ? { ...model.anchors } : {};\n  }\n\n  function log(name, result) {\n    const color = result.ok ? 'color:#4caf50' : 'color:#f44336';\n    console.log(`%c[MSD Scenario] ${name}: ${result.ok?'OK':'FAIL'}`, color, result);\n  }\n\n  // --- Scenarios ---\n\n  function scenarioCache() {\n    const lineId = 'line_grid_forced';\n    invalidate('*');\n    const first = inspect(lineId);\n    const second = inspect(lineId);\n    const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true;\n    return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit } };\n  }\n\n  function scenarioGridVsManhattan() {\n    const grid = inspect('line_grid_forced');\n    const man = inspect('line_manhattan_baseline');\n    const ok = !!grid && !!man && grid.meta.strategy.startsWith('grid') && man.meta.strategy.startsWith('manhattan');\n    return { ok, details: { gridStrategy: grid?.meta.strategy, manStrategy: man?.meta.strategy } };\n  }\n\n  function scenarioAvoidCreatesBend() {\n    const targetId = 'line_smart_clear';\n    const ov = findOverlay(targetId);\n    if (!ov) return { ok:false, details:'overlay not found' };\n    const before = inspect(targetId);\n    // monkey patch avoid list\n    ov._raw = ov._raw || {};\n    const originalAvoid = Array.isArray(ov._raw.avoid) ? ov._raw.avoid.slice() : undefined;\n    if (!ov._raw.avoid) ov._raw.avoid = [];\n    if (!ov._raw.avoid.includes('obstacle_vertical')) ov._raw.avoid.push('obstacle_vertical');\n    invalidate('*');\n    const after = inspect(targetId);\n    // restore\n    if (originalAvoid === undefined) delete ov._raw.avoid; else ov._raw.avoid = originalAvoid;\n    invalidate('*');\n    const ok = !!before && !!after && after.meta.bends >= before.meta.bends;\n    return { ok, details: { bendsBefore: before?.meta.bends, bendsAfter: after?.meta.bends } };\n  }\n\n  function scenarioModeHintYX() {\n    const id = 'line_grid_forced';\n    const ov = findOverlay(id);\n    if (!ov) return { ok:false, details:'overlay not found'};\n    ov._raw = ov._raw || {};\n    // Baseline (xy / default)\n    ov._raw.route_mode = 'xy';\n    invalidate('*');\n    const base = inspect(id);\n    // yx\n    ov._raw.route_mode = 'yx';\n    invalidate('*');\n    const yx = inspect(id);\n    // restore\n    delete ov._raw.route_mode;\n    invalidate('*');\n    const basePts = base?.pts || [];\n    const yxPts = yx?.pts || [];\n    // Expect both have an elbow (>=3 points). In xy, second point shares y1 (horizontal first). In yx, second shares x1 (vertical first).\n    const baseHorizontalFirst = basePts.length>=3 && basePts[1][1] === basePts[0][1];\n    const yxVerticalFirst = yxPts.length>=3 && yxPts[1][0] === yxPts[0][0];\n    const ok = baseHorizontalFirst && yxVerticalFirst;\n    return { ok, details: { basePts, yxPts, baseHorizontalFirst, yxVerticalFirst } };\n  }\n\n  function scenarioClearanceShift() {\n    const id = 'line_grid_forced';\n    const router = requirePipeline().router;\n    if (!router) return { ok:false, details:'router missing' };\n    invalidate('*');\n    const base = inspect(id);\n    const orig = router.config.clearance;\n    router.config.clearance = (orig || 8) + 24;\n    invalidate('*');\n    const raised = inspect(id);\n    router.config.clearance = orig;\n    invalidate('*');\n    const ok = !!base && !!raised && raised.meta.cost >= base.meta.cost;\n    return { ok, details: { baseCost: base?.meta.cost, raisedCost: raised?.meta.cost } };\n  }\n\n  function scenarioAnchorMove() {\n    const anchorId = 'smart_far_anchor';\n    const pi = requirePipeline();\n    const model = getModel();\n    if (!model?.anchors || !model.anchors[anchorId]) return { ok:false, details:'anchor not present' };\n    const lineId = 'line_smart_far_avoid';\n    invalidate('*');\n    const before = inspect(lineId);\n    const orig = model.anchors[anchorId].slice();\n    // Use pipeline API (updates cardModel + resolvedModel + rerender)\n    const moved = pi.setAnchor(anchorId, [orig[0] + 40, orig[1]]);\n    invalidate('*');\n    const after = inspect(lineId);\n    // revert\n    pi.setAnchor(anchorId, orig);\n    invalidate('*');\n    const ok = moved && !!before && !!after && before.pts[0][0] !== after.pts[0][0];\n    return { ok, details: { from: before?.pts[0], to: after?.pts[0], moved } };\n  }\n\n  function scenarioFallbackOnImpossibleGrid() {\n    const router = requirePipeline().router;\n    if (!router) return { ok:false, details:'router missing'};\n    const originalComputeGrid = router._computeGrid;\n    // Force failure for this call only by returning null\n    router._computeGrid = function(req){ if (req.id === 'line_grid_forced') return null; return originalComputeGrid.call(this, req); };\n    invalidate('*');\n    const res = inspect('line_grid_forced');\n    // restore\n    router._computeGrid = originalComputeGrid;\n    invalidate('*');\n    const ok = !!res && /manhattan|fallback/.test(res.meta.strategy);\n    return { ok, details: { strategy: res?.meta.strategy } };\n  }\n\n  const scenarios = {\n    cache: scenarioCache,\n    grid_vs_manhattan: scenarioGridVsManhattan,\n    avoid_creates_bend: scenarioAvoidCreatesBend,\n    mode_hint_yx: scenarioModeHintYX,\n    clearance_shift: scenarioClearanceShift,\n    anchor_move: scenarioAnchorMove,\n    fallback_impossible_grid: scenarioFallbackOnImpossibleGrid\n  };\n\n  const api = {\n    list: () => Object.keys(scenarios),\n    run: (name) => {\n      if (!scenarios[name]) { console.warn('[MSD Scenario] Unknown', name); return null; }\n      try {\n        const r = scenarios[name]();\n        log(name, r);\n        return r;\n      } catch(e) {\n        const r = { ok:false, details:String(e) };\n        log(name, r);\n        return r;\n      }\n    },\n    runAll: () => {\n      const results = {};\n      for (const k of Object.keys(scenarios)) results[k] = api.run(k);\n      const summaryOk = Object.values(results).every(r => r && r.ok);\n      console.log('[MSD Scenario] Summary:', summaryOk?'ALL PASS':'FAILURES', results);\n      return results;\n    }\n  };\n\n  W.__msdScenarios.routing = api;\n  console.info('[MSD v1] Routing scenario harness installed. Use: window.__msdScenarios.routing.list()');\n})();\n","/* MSD Smart Routing Scenario Harness (Wave 5 - M5.3)\n * Usage:\n *   window.__msdScenarios.smart.list()\n *   window.__msdScenarios.smart.run('smart_vs_grid_cost')\n *   window.__msdScenarios.smart.runAll()\n */\n\n(function initSmartRoutingHarness(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi() {\n    const p = W.__msdDebug?.pipelineInstance;\n    if (!p || p.enabled === false) throw new Error('Pipeline disabled or missing.');\n    return p;\n  }\n  function inspect(id) { return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(scope='*'){ W.__msdDebug?.routing?.invalidate(scope); }\n\n  function withMode(id, modeFull, fn) {\n    const model = W.__msdDebug?.lastRenderModel;\n    const ov = model?.overlays?.find(o=>o.id===id);\n    if (!ov) throw new Error('overlay not found: '+id);\n    ov._raw = ov._raw || {};\n    const orig = ov._raw.route_mode_full;\n    ov._raw.route_mode_full = modeFull;\n    try {\n      invalidate('*');\n      return fn();\n    } finally {\n      ov._raw.route_mode_full = orig;\n      invalidate('*');\n    }\n  }\n\n  // NEW: helper to set mode without auto-restore (caller restores after use)\n  function setMode(id, modeFull) {\n    const model = W.__msdDebug?.lastRenderModel;\n    const ov = model?.overlays?.find(o=>o.id===id);\n    if (!ov) throw new Error('overlay not found: '+id);\n    ov._raw = ov._raw || {};\n    ov._raw.route_mode_full = modeFull;\n  }\n\n  function scenarioSmartVsGridCost() {\n    // Reuse a grid candidate overlay id\n    const id = 'line_grid_forced';\n    const grid = withMode(id, 'grid', ()=>inspect(id));\n    const smart = withMode(id, 'smart', ()=>inspect(id));\n    const ok = !!grid && !!smart && smart.meta.strategy === 'smart' && smart.meta.cost <= grid.meta.cost + 40;\n    return { ok, details: { gridCost: grid?.meta.cost, smartCost: smart?.meta.cost } };\n  }\n\n  function scenarioSmartRefinementAttempt() {\n    const id = 'line_grid_forced';\n    const smart = withMode(id, 'smart', ()=>inspect(id));\n    const smartMeta = smart?.meta?.smart;\n    const ok = !!smartMeta && smartMeta.detoursTried >= 0; // Accept even zero (no need for forced detour)\n    return { ok, details: smartMeta };\n  }\n\n  function scenarioSmartPenaltyReduction() {\n    const id = 'line_smart_blocked';\n    const baseSmart = withMode(id, 'smart', ()=>inspect(id));\n    const meta = baseSmart?.meta;\n    if (!meta?.smart) return { ok:false, details:'no smart meta' };\n    const ok = meta.smart.penaltyAfter <= meta.smart.penaltyBefore;\n    return { ok, details: meta.smart };\n  }\n\n  // REPLACE scenarioSmartCacheBehavior implementation\n  function scenarioSmartCacheBehavior() {\n    const id = 'line_smart_forced_xy';\n    const model = W.__msdDebug?.lastRenderModel;\n    const ov = model?.overlays?.find(o=>o.id===id);\n    if (!ov) return { ok:false, details:'overlay not found' };\n    ov._raw = ov._raw || {};\n    const original = ov._raw.route_mode_full;\n\n    try {\n      setMode(id, 'smart');\n      invalidate('*');\n      const first = inspect(id);        // expect miss\n      const second = inspect(id);       // expect hit (same mode & unchanged env)\n      const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true;\n      return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit } };\n    } catch(e) {\n      return { ok:false, details:String(e) };\n    } finally {\n      ov._raw.route_mode_full = original;\n      invalidate('*');\n    }\n  }\n\n  const scenarios = {\n    smart_vs_grid_cost: scenarioSmartVsGridCost,\n    smart_refinement_attempt: scenarioSmartRefinementAttempt,\n    smart_penalty_reduction: scenarioSmartPenaltyReduction,\n    smart_cache_behavior: scenarioSmartCacheBehavior\n  };\n\n  const api = {\n    list: ()=>Object.keys(scenarios),\n    run: (name)=>{\n      if (!scenarios[name]) { console.warn('[MSD Smart Scenario] Unknown', name); return null; }\n      try {\n        const r = scenarios[name]();\n        console.log(`[MSD Smart Scenario] ${name}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e) {\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Smart Scenario] ${name}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: ()=>{\n      const res = {};\n      for (const k of Object.keys(scenarios)) res[k] = api.run(k);\n      const summaryOk = Object.values(res).every(r => r && r.ok);\n      console.log('[MSD Smart Scenario] Summary:', summaryOk?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.smart = api;\n  console.info('[MSD v1] Smart routing scenario harness installed. Use: window.__msdScenarios.smart.list()');\n})();\n","/* MSD Smoothing Scenario Harness (Wave 5 - M5.6)\n * Usage:\n *   window.__msdScenarios.smoothing.list()\n *   window.__msdScenarios.smoothing.runAll()\n */\n(function initSmoothingScenarios(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi(){ const p=W.__msdDebug?.pipelineInstance; if(!p||!p.enabled) throw new Error('pipeline disabled'); return p; }\n  function inspect(id){ return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(){ W.__msdDebug?.routing?.invalidate('*'); }\n\n  const target = 'line_grid_forced';\n\n  function ensureBaseline(){\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===target);\n    if (!ov) throw new Error('overlay not found');\n    ov._raw = ov._raw || {};\n    return ov;\n  }\n\n  function scenarioSmoothingIncreasesPoints(){\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'none';\n    ov._raw.smoothing_iterations = 0;\n    invalidate();\n    const base = inspect(target);\n    ov._raw.smoothing_mode = 'chaikin';\n    ov._raw.smoothing_iterations = 2;\n    invalidate();\n    const sm = inspect(target);\n    // restore\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    const ok = !!base && !!sm && sm.pts.length > base.pts.length && sm.meta.smooth;\n    return { ok, details: { basePts: base?.pts.length, smoothPts: sm?.pts.length, meta: sm?.meta?.smooth } };\n  }\n\n  function scenarioCacheHit(){\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'chaikin';\n    ov._raw.smoothing_iterations = 1;\n    invalidate();\n    const first = inspect(target);\n    const second = inspect(target);\n    // restore\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true;\n    return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit } };\n  }\n\n  function scenarioDisableNoSmoothMeta(){\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'none';\n    ov._raw.smoothing_iterations = 0;\n    invalidate();\n    const res = inspect(target);\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    const ok = !!res && !res.meta.smooth;\n    return { ok, details: { hasSmoothMeta: !!res.meta.smooth } };\n  }\n\n  function scenarioInvalidModeFallback() {\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'bogus_mode';\n    ov._raw.smoothing_iterations = 2;\n    invalidate();\n    const res = inspect(target);\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    // Expect no meta.smooth because mode invalid → coerced to none\n    const ok = !!res && !res.meta.smooth;\n    return { ok, details: { hasSmoothMeta: !!res.meta.smooth } };\n  }\n\n  const scenarios = {\n    smoothing_increases_points: scenarioSmoothingIncreasesPoints,\n    smoothing_cache_hit: scenarioCacheHit,\n    smoothing_disabled_no_meta: scenarioDisableNoSmoothMeta,\n    smoothing_invalid_mode_fallback: scenarioInvalidModeFallback   // NEW\n  };\n\n  const api = {\n    list: ()=>Object.keys(scenarios),\n    run: (n)=>{\n      if(!scenarios[n]) { console.warn('[MSD Smooth Scenario] Unknown', n); return null; }\n      try {\n        const r = scenarios[n]();\n        console.log(`[MSD Smooth Scenario] ${n}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e){\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Smooth Scenario] ${n}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: ()=>{\n      const res={};\n      for(const k of Object.keys(scenarios)) res[k]=api.run(k);\n      const ok = Object.values(res).every(r=>r && r.ok);\n      console.log('[MSD Smooth Scenario] Summary:', ok?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.smoothing = api;\n  console.info('[MSD v1] Smoothing scenario harness installed. Use: window.__msdScenarios.smoothing.list()');\n})();\n","import { cblcarsLog } from './cb-lcars-logging.js';\nimport { animPresets } from './cb-lcars-anim-presets.js';\n\n/**\n * Waits for an element to be present in the DOM.\n * @param {string} selector - The CSS selector for the element.\n * @param {Element|Document} root - The root element to search within.\n * @param {number} timeout - The maximum time to wait in milliseconds.\n * @returns {Promise<Element>}\n */\nexport function waitForElement(selector, root = document, timeout = 2000) {\n  return new Promise((resolve, reject) => {\n    const found = root.querySelector(selector);\n    if (found) return resolve(found);\n\n    const observer = new MutationObserver(() => {\n      const el = root.querySelector(selector);\n      if (el) {\n        try { observer.disconnect(); } catch(_) {}\n        clearTimeout(to);\n        resolve(el);\n      }\n    });\n    observer.observe(root, { childList: true, subtree: true });\n\n    const to = setTimeout(() => {\n      try { observer.disconnect(); } catch(_) {}\n      reject(new Error(`[CB-LCARS] Timeout waiting for element: ${selector}`));\n    }, timeout);\n  });\n}\n\n/**\n * Resolves one or many targets into an array of Elements.\n * Enhancements:\n * - Supports comma-separated selector strings: \"#a, .b, svg path\"\n * - Expands NodeList/HTMLCollection into elements\n * - For selector strings, resolves first match by waiting, and also includes any currently matching additional elements\n * @param {string|Element|Array<string|Element>|NodeList|HTMLCollection} targets\n * @param {Element|Document} root\n * @param {number} timeout\n * @returns {Promise<Element[]>}\n */\nexport async function waitForElements(targets, root = document, timeout = 2000) {\n  const toArray = (v) => Array.isArray(v)\n    ? v\n    : (v && typeof v.length === 'number' && typeof v.item === 'function')\n      ? Array.from(v) // NodeList/HTMLCollection\n      : [v];\n\n  const items = toArray(targets).filter(Boolean);\n  const results = [];\n\n  for (const item of items) {\n    try {\n      if (item instanceof Element) {\n        results.push(item);\n        continue;\n      }\n\n      if (typeof item === 'string') {\n        // Split comma-separated selector lists\n        const selectors = item.split(',').map(s => s.trim()).filter(Boolean);\n        for (const sel of selectors) {\n          // Wait for first appearance of this selector\n          const first = await waitForElement(sel, root, timeout);\n          if (first) results.push(first);\n          // Also include any additional matches that are already present\n          const allNow = root.querySelectorAll(sel);\n          for (const el of Array.from(allNow)) {\n            if (!results.includes(el)) results.push(el);\n          }\n        }\n        continue;\n      }\n\n      cblcarsLog.warn('[waitForElements] Unsupported target type, skipping.', { item });\n    } catch (e) {\n      cblcarsLog.error('[waitForElements] Failed to resolve target:', { item, error: e });\n    }\n  }\n  return results;\n}\n\n/**\n * A generic wrapper for anime.js that resolves targets within a given root element.\n * If scopeId is provided, add the animation to the scope.\n * @param {object} options - The anime.js animation options.\n * @param {string|Element|Array} options.targets - Selector(s) or element(s).\n * @param {Element} [options.root=document] - The root element for the selector query.\n * @param {string} [options.scopeId] - The scope ID to use.\n */\nexport async function animateWithRoot(options) {\n  const { targets, root = document, scopeId, ...animOptions } = options;\n  if (!targets) {\n    cblcarsLog.warn('[animateWithRoot] Animation missing targets.', { options });\n    return;\n  }\n  try {\n    const elements = await waitForElements(targets, root);\n    if (elements.length === 0) {\n      cblcarsLog.warn('[animateWithRoot] No targets resolved.', { targets });\n      return;\n    }\n\n    for (const element of elements) {\n      try {\n        let animation;\n        if (scopeId && window.cblcars.anim.scopes.has(scopeId)) {\n          const scopeObj = window.cblcars.anim.scopes.get(scopeId);\n          animation = window.cblcars.anime(element, { ...animOptions, scope: scopeObj.scope });\n          scopeObj.addAnimation(animation);\n        } else {\n          animation = window.cblcars.anime(element, animOptions);\n        }\n      } catch (e) {\n        cblcarsLog.error('[animateWithRoot] Failed to animate a resolved element.', { element: element?.id, error: e });\n      }\n    }\n  } catch (error) {\n    cblcarsLog.error('[animateWithRoot] Failed to animate element(s):', { targets, error });\n  }\n}\n\n/**\n * Animates element(s) using anime.js with special handling for SVG animations.\n * Unchanged behavior, v4-native through window.cblcars.anim.anime\n */\nexport async function animateElement(scope, options, hass = null) {\n  const { type, targets, root = document, ...animOptions } = options;\n  if (!type || !targets || !scope) {\n    cblcarsLog.warn('[animateElement] Animation missing type, targets, or scope.', { options, scope });\n    return;\n  }\n  cblcarsLog.debug('[animateElement] Received options:', { options });\n\n  scope.scope.add(async () => {\n    try {\n      const elements = await waitForElements(targets, root);\n      if (!elements || elements.length === 0) {\n        cblcarsLog.error('[animateElement] Target element(s) not found:', { targets });\n        return;\n      }\n\n      for (const element of elements) {\n        const params = {\n          duration: 1000,\n          easing: 'easeInOutQuad',\n          ...animOptions,\n        };\n\n        // state_resolver hook (left as-is)\n        if (options.state_resolver && options.entity && window.cblcars.styleHelpers?.resolveStateStyles) {\n          const resolvedStyles = window.cblcars.styleHelpers.resolveStateStyles(\n            options.state_resolver,\n            hass,\n            options.entity\n          );\n          Object.assign(params, resolvedStyles);\n        }\n\n        // Apply preset(s)\n        if (Array.isArray(type)) {\n          applyPresets(type, params, element, options);\n        } else {\n          const presetFn = animPresets[String(type).toLowerCase()];\n          if (presetFn) {\n            await presetFn(params, element, options);\n          } else if (String(type).toLowerCase() === 'morph') {\n            if (!options.morph_to_selector) {\n              cblcarsLog.error('[animateElement] morph animation requires a `morph_to_selector`.', { options });\n              continue;\n            }\n            const morphTarget = await waitForElement(options.morph_to_selector, root);\n            if (!morphTarget) {\n              cblcarsLog.error(`[animateElement] morph could not find target shape for selector: ${options.morph_to_selector}`);\n              continue;\n            }\n            const precision = options.precision ? parseInt(options.precision, 10) : undefined;\n            Object.assign(params, { d: window.cblcars.animejs.svg.morphTo(morphTarget, precision) });\n          } else {\n            cblcarsLog.debug(`[animateElement] Using standard animation for type: ${type}`, { params });\n          }\n        }\n\n        // Skip if preset handled via CSS or nulled targets\n        if (params._cssAnimation || params.targets === null) {\n          continue;\n        }\n\n        window.cblcars.anim.anime(element, params);\n        cblcarsLog.debug(`[animateElement] Animation constructor added to scope: ${scope.id}`, { params, element: element.id });\n      }\n    } catch (error) {\n      cblcarsLog.error('[animateElement] Failed to animate element(s):', { targets, type, error });\n    }\n  });\n}\n\n\n/**\n * v4: Create a single timeline from an array of steps.\n * Uses createTimeline consistently and add(targets, vars, offset).\n * @param {Array} timelineConfig - [{ targets, ...vars, offset? }]\n * @param {string} scopeId\n * @param {Element|Document} root\n */\nexport async function createTimeline(timelineConfig, scopeId, root = document) {\n  const scopeObj = window.cblcars.anim.scopes.get(scopeId);\n  const timeline = window.cblcars.anim.animejs.createTimeline({ scope: scopeObj?.scope });\n\n  if (!Array.isArray(timelineConfig)) return timeline;\n\n  for (const step of timelineConfig) {\n    const { targets, offset, ...vars } = step || {};\n    if (!targets) continue;\n    const element = await window.cblcars.anim.waitForElement(targets, root);\n    if (!element) continue;\n    timeline.add(element, vars, offset);\n  }\n  if (scopeObj) scopeObj.addAnimation?.(timeline);\n  return timeline;\n}\n\n/**\n * Creates multiple anime.js timelines from a config object, supporting global params and step merging.\n * Enhancements:\n * - Supports step.state_resolver using variables.msd.presets (stylePresets).\n * - Only strips 'direction' (v4 removed); keeps 'alternate' and 'loop'.\n * - Respects autoplay: does not force timeline.play() when autoplay === false.\n * - Marks preset calls with __timeline for timeline-friendly behavior.\n *\n * @param {object} timelinesConfig\n * @param {string} scopeId\n * @param {Element|Document} root\n * @param {object} overlayConfigs\n * @param {object|null} hass\n * @param {object} stylePresets - variables.msd.presets\n * @returns {Promise<object>} timelines by name\n */\nexport async function createTimelines(\n  timelinesConfig,\n  scopeId,\n  root = document,\n  overlayConfigs = {},\n  hass = null,\n  stylePresets = {}\n) {\n  const scopeObj = window.cblcars.anim.scopes.get(scopeId);\n  if (!scopeObj) {\n    cblcarsLog.error('[createTimelines] Scope not found:', scopeId);\n    return {};\n  }\n  const timelines = {};\n  const resolveAll = window.cblcars.styleHelpers?.resolveAllDynamicValues;\n\n  for (const [timelineName, timelineConfig] of Object.entries(timelinesConfig || {})) {\n    const { steps, ...timelineGlobals } = timelineConfig || {};\n    const resolvedGlobals = resolveAll ? resolveAll(timelineGlobals, hass) : timelineGlobals;\n\n    const timeline = window.cblcars.anim.animejs.createTimeline({\n      scope: scopeObj.scope,\n      ...resolvedGlobals\n    });\n\n    if (!steps || !Array.isArray(steps)) {\n      cblcarsLog.warn(`[createTimelines] Timeline \"${timelineName}\" has no steps array.`);\n      timelines[timelineName] = timeline;\n      continue;\n    }\n\n    for (const step of steps) {\n      let elements = [];\n      try {\n        elements = await waitForElements(step.targets, root);\n      } catch (error) {\n        cblcarsLog.error(`[createTimelines] Failed to find target(s) for \"${timelineName}\":`, { targets: step.targets, error });\n        continue;\n      }\n      if (!elements || elements.length === 0) {\n        cblcarsLog.warn(`[createTimelines] No elements found for timeline \"${timelineName}\" step:`, { targets: step.targets });\n        continue;\n      }\n\n      for (const element of elements) {\n        const elementAnim = overlayConfigs?.[element.id]?.animation || {};\n        let mergedParams = { ...elementAnim, ...resolvedGlobals, ...step };\n\n        // State resolver on steps\n        if (step?.state_resolver && window.cblcars.styleHelpers?.resolveStatePreset) {\n          try {\n            const overrides = window.cblcars.styleHelpers.resolveStatePreset(\n              { state_resolver: step.state_resolver, entity: step.entity, attribute: step.attribute },\n              stylePresets,\n              hass\n            );\n            if (overrides && typeof overrides === 'object') {\n              if (overrides.animation && typeof overrides.animation === 'object') {\n                mergedParams = { ...mergedParams, ...overrides.animation };\n              } else {\n                mergedParams = { ...mergedParams, ...overrides };\n              }\n            }\n          } catch (e) {\n            cblcarsLog.warn('[createTimelines] step.state_resolver failed', { timelineName, step, error: e });\n          }\n        }\n\n        // Resolve dynamic values\n        mergedParams = resolveAll ? resolveAll(mergedParams, hass) : mergedParams;\n\n        // Defaults for text transforms in some presets\n        if (\n          (mergedParams.type === 'pulse' || mergedParams.type === 'glow') &&\n          (element.tagName === 'text' || element.tagName === 'TEXT')\n        ) {\n          element.style.transformOrigin = 'center';\n          element.style.transformBox = 'fill-box';\n        }\n\n        // Apply preset, marking timeline context\n        if (mergedParams.type && animPresets[mergedParams.type]) {\n          mergedParams.__timeline = true;\n          await animPresets[mergedParams.type](mergedParams, element, mergedParams);\n        }\n\n        // Strip non-anime keys\n        const {\n          targets, offset, direction,\n          state_resolver, preset, entity, attribute, __timeline,\n          // NEW: strip these flags from anime params\n          deep, descendants, apply_to,\n          ...animeParams\n        } = mergedParams;\n\n        // Determine whether to apply immediate props to descendants\n        const applyToDescendants =\n          mergedParams.descendants === true ||\n          mergedParams.deep === true ||\n          mergedParams.apply_to === 'descendants';\n\n        // Ensure non-animated properties are applied at the step start\n        const immediateKeys = ['fill', 'stroke', 'stroke-width', 'filter', 'color', 'opacity'];\n        const immediateSet = {};\n        for (const k of immediateKeys) {\n          if (animeParams[k] !== undefined && !Array.isArray(animeParams[k]) && typeof animeParams[k] !== 'object') {\n            immediateSet[k] = animeParams[k];\n          }\n        }\n        if (Object.keys(immediateSet).length) {\n          const userOnBegin = animeParams.onBegin;\n          animeParams.onBegin = () => {\n            try {\n              const nodes = applyToDescendants ? element.querySelectorAll('*') : [element];\n              if (window.cblcars?.anim?.utils?.set) {\n                nodes.forEach((n) => window.cblcars.anim.utils.set(n, immediateSet));\n              } else {\n                nodes.forEach((n) => {\n                  for (const [prop, val] of Object.entries(immediateSet)) {\n                    if (prop in n.style) n.style[prop] = val;\n                    else n.setAttribute(prop, val);\n                  }\n                });\n              }\n            } catch (_) {}\n            if (typeof userOnBegin === 'function') userOnBegin();\n          };\n        }\n\n        // v4 add(targets, vars, offset)\n        timeline.add(element, animeParams, offset);\n      }\n    }\n\n    if (typeof scopeObj.addAnimation === 'function') {\n      scopeObj.addAnimation(timeline);\n    }\n    timelines[timelineName] = timeline;\n\n    if (resolvedGlobals?.autoplay === false) {\n      cblcarsLog.info(`[createTimelines] Timeline \"${timelineName}\" created with autoplay: false.`);\n    }\n  }\n  return timelines;\n}\n\n/**\n * Applies one or more animation presets to the anime.js params object.\n */\nexport function applyPresets(types, params, element, options) {\n  const presetList = Array.isArray(types) ? types : [types];\n  for (const type of presetList) {\n    const presetFn = animPresets[type.toLowerCase()];\n    if (presetFn) {\n      presetFn(params, element, options?.[type] || options);\n    }\n  }\n}\n\n\n","import { cblcarsLog } from './cb-lcars-logging.js';\nimport * as svgHelpers from './cb-lcars-svg-helpers.js';\n\n// legacy - svg errors logged to overlay need to be ported to v1 style\n//import { svgOverlayManager } from './cb-lcars-overlay-helpers.js';\n\n/**\n * Utility: test if a path 'd' string has drawable geometry beyond a single move.\n */\nfunction hasUsablePathD(d) {\n  if (!d || typeof d !== 'string') return false;\n  // Must contain at least one command beyond the initial M (e.g., L,C,Q,A,Z)\n  return /[MLCQAHVZmlcqahvz].*[MLCQAHVZmlcqahvz]/.test(d) || /[LCAHVQZlca hvqz]/.test(d);\n}\n\nexport const animPresets = {\n    /**\n     * @preset draw\n     * Animates the drawing of an SVG path.\n     * @param {object} params - Anime.js v4 params object.\n     * @param {Element} element - SVG path element.\n     * @param {object} options - Animation config.\n     */\n    draw: (params, element, options = {}) => {\n        // Use animejs v4 createDrawable for robust SVG path drawing\n        const [drawable] = window.cblcars.animejs.svg.createDrawable(element);\n\n        // Standard anime.js options\n        const duration = params.duration ?? options.duration ?? 1200;\n        const easing = params.easing ?? options.easing ?? 'easeInOutSine';\n        const loop = params.loop ?? options.loop ?? false;\n        const alternate = params.alternate ?? options.alternate ?? false;\n\n        // Draw-specific config: prefer params.draw, then options.draw, then default\n        const drawCfg = params.draw || options.draw || {};\n        let drawValues;\n        if (Array.isArray(drawCfg)) {\n            drawValues = drawCfg;\n        } else if (drawCfg && Array.isArray(drawCfg.values)) {\n            drawValues = drawCfg.values;\n        } else {\n            drawValues = ['0 0', '0 1'];\n        }\n\n        // Set the anime.js params for draw animation\n        Object.assign(params, {\n            targets: drawable,\n            draw: drawValues,\n            duration,\n            easing,\n            loop,\n            alternate\n        });\n\n        // Remove any conflicting opacity/stroke-width from params\n        delete params.opacity;\n        delete params['stroke-width'];\n    },\n    /* //stutters on loop with anime.js .. use css version for now\n    march: (params, element, options) => {\n        const dashArray = element.getAttribute('stroke-dasharray');\n        if (!dashArray || dashArray === 'none') return;\n        const patternLength = dashArray.split(/[\\s,]+/).reduce((acc, len) => acc + parseFloat(len), 0);\n        if (patternLength === 0) return;\n        element.style.strokeDashoffset = '0';\n        const endValue = params.direction === 'reverse' ? patternLength : -patternLength;\n        Object.assign(params, {\n            strokeDashoffset: [0, endValue],\n        });\n        if (params.loop === undefined) params.loop = true;\n        if (params.easing === 'easeInOutQuad') params.easing = 'linear';\n    },\n    fade: (params) => {\n        Object.assign(params, { opacity: [0, 1] });\n    },\n    */\n    /**\n     * @preset pulse\n     * Pulses scale and opacity for a \"breathing\" effect (text), or stroke-width and opacity for lines.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    pulse: (params, element, options = {}) => {\n        cblcarsLog.debug('[pulse preset] Before mutation:', { params, element, options });\n\n        // Prefer pulse config from params.pulse, then options.pulse, then options, then defaults\n        const pulseCfg = params.pulse || options.pulse || options || {};\n        const maxScale = pulseCfg.max_scale !== undefined\n            ? pulseCfg.max_scale\n            : (element.tagName === 'text' || element.tagName === 'TEXT' ? 1.1 : 1.5);\n        const minOpacity = pulseCfg.min_opacity !== undefined\n            ? pulseCfg.min_opacity\n            : 0.7;\n\n        // Remove any previous stroke-width/opacity assignments to avoid conflicts\n        delete params['stroke-width'];\n        delete params.opacity;\n\n        // Generic anime.js options from main animation key\n        const duration = params.duration ?? options.duration ?? 1200;\n        const easing = params.easing ?? options.easing ?? 'easeInOutSine';\n        const loop = params.loop ?? options.loop ?? true;\n        const alternate = params.alternate ?? options.alternate ?? true;\n\n        if (element.tagName === 'text' || element.tagName === 'TEXT') {\n            Object.assign(params, {\n                scale: [1, maxScale],\n                opacity: [1, minOpacity],\n                easing,\n                duration,\n                loop,\n                alternate\n            });\n            element.style.transformOrigin = 'center';\n            element.style.transformBox = 'fill-box';\n            cblcarsLog.debug('[pulse preset] Set transformOrigin/transformBox for text:', {\n                id: element.id,\n                style: element.style.cssText\n            });\n        } else if (element.hasAttribute('stroke-width')) {\n            // Pulse lines: animate stroke-width and opacity\n            const width = parseFloat(element.getAttribute('stroke-width')) || 4;\n            Object.assign(params, {\n                'stroke-width': [width, width * maxScale],\n                opacity: [1, minOpacity],\n                easing,\n                duration,\n                loop,\n                alternate\n            });\n            cblcarsLog.debug('[pulse preset] Pulsing line:', {\n                id: element.id,\n                strokeWidth: width,\n                maxScale\n            });\n        } else {\n            // Fallback: just animate opacity\n            Object.assign(params, {\n                opacity: [1, minOpacity],\n                easing,\n                duration,\n                loop,\n                alternate\n            });\n        }\n        cblcarsLog.debug('[pulse preset] After mutation:', { params, element });\n    },\n    /**\n     * @preset blink\n     * Blinks opacity between two values.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    blink: (params, element, options) => {\n        Object.assign(params, {\n            opacity: [options.max_opacity ?? 1, options.min_opacity ?? 0.3],\n            alternate: true,\n            loop: true,\n            easing: options.easing || 'linear', // or 'easeInOutSine'\n            duration: options.duration ?? 1200\n        });\n    },\n\n    fade: (params, element, options = {}) => {\n    const duration = params.duration ?? options.duration ?? 1000;\n    const easing = params.easing ?? options.easing ?? 'linear';\n    const loop = params.loop ?? options.loop ?? false;\n    const alternate = params.alternate ?? options.alternate ?? false;\n    Object.assign(params, {\n        opacity: [0, 1],\n        duration,\n        easing,\n        loop,\n        alternate\n    });\n    },\n\n    /**\n     * @preset motionpath\n     * Animates a tracer along a path, with optional trail.\n     * Contract:\n     *  - tracer is required; if missing, the preset aborts and surfaces an overlay error.\n     *  - Waits until the target <path> has a valid 'd' before building transforms.\n     *  - If the path has data-cblcars-pending=\"true\" (sparkline baseline), trail is hidden until real data arrives.\n     *  - Listens for 'd' and 'data-cblcars-pending' changes, re-binding tracer and syncing trail as the path updates.\n     *\n     * Anime.js v4 notes:\n     *  - Use window.cblcars.anim.anime(targets, vars)\n     *  - Use window.cblcars.animejs.svg.createMotionPath(pathEl) → { translateX, translateY, rotate }\n     *  - Use window.cblcars.animejs.svg.createDrawable(pathEl) for draw animations\n     *\n     * Required external helpers (already in this project):\n     *  - window.cblcars.waitForElement(selector, root)\n     *  - svgOverlayManager.push(msg) for user-visible overlay errors\n     */\n\n\n    /**\n     * @preset motionpath  (UPDATED MOTIONPATH PRESET – Option D)\n     * Robust wait for usable path + pending flag, tracer & trail support, auto rebind.\n     */\n    motionpath: async function motionpathPreset(params, element, options = {}) {\n        try {\n            const root = options.root ?? document;\n\n            // Provide waitForElement alias if missing\n            if (!window.cblcars.waitForElement && window.cblcars.anim?.waitForElement) {\n                window.cblcars.waitForElement = window.cblcars.anim.waitForElement;\n            }\n\n            const tracerCfg = options.tracer;\n            if (!tracerCfg) {\n                const msg = '[motionpath] tracer is required';\n                cblcarsLog.warn(msg, { element });\n                //svgOverlayManager.push(msg);\n                params.targets = null;\n                return;\n            }\n\n            const pathSelector = options.path_selector;\n            let pathEl = pathSelector\n                ? (await window.cblcars.waitForElement(pathSelector, root).catch(() => null))\n                : element;\n\n            if (!pathEl) {\n                const errorMsg = `Motionpath: path not found for selector \"${pathSelector || '(self)'}\"`;\n                cblcarsLog.error(errorMsg);\n                //svgOverlayManager.push(errorMsg);\n                params.targets = null;\n                return;\n            }\n            if (String(pathEl.tagName).toLowerCase() !== 'path') {\n                const msg = '[motionpath] Target is not an SVG <path>';\n                cblcarsLog.warn(msg, { id: pathEl.id });\n                //svgOverlayManager.push(msg);\n                params.targets = null;\n                return;\n            }\n\n            const baseId = pathEl.id || 'msd_path';\n\n            // Helper: determine if path 'd' is actually usable (not just single move or zero length)\n            const hasUsablePathD = (p) => {\n                if (!p || typeof p !== 'string') return false;\n                // Require at least one command beyond initial M and a second coordinate\n                // Simpler: must contain an 'L','C','Q','A','H','V','Z' (besides the opening M)\n                return /[LCHQAVZlchqavz]/.test(p);\n            };\n            const pathLengthOk = (el) => {\n                try {\n                    return el.getTotalLength() > 0.5;\n                } catch (_) {\n                    return false;\n                }\n            };\n            const isPending = (el) => el?.getAttribute('data-cblcars-pending') === 'true';\n\n            const cleanupArtifacts = () => {\n                const svgRoot = pathEl.ownerSVGElement || pathEl.closest('svg') || root;\n                if (!svgRoot) return;\n                const priorTracer = svgRoot.querySelector(`#${baseId}_tracer[data-cblcars-owned=\"motionpath\"]`);\n                const priorTrail = svgRoot.querySelector(`#${baseId}_trail[data-cblcars-owned=\"motionpath\"]`);\n                if (priorTracer?.parentNode) priorTracer.parentNode.removeChild(priorTracer);\n                if (priorTrail?.parentNode) priorTrail.parentNode.removeChild(priorTrail);\n            };\n\n            let trailPath = null;\n            let tracerNode = null;\n            let pathMutationObserver = null;\n            let alive = true;\n\n            // Build trail (draw effect) if configured\n            const buildTrail = () => {\n                const trailOpt = options.trail;\n                if (!trailOpt) return;\n                try {\n                    trailPath = pathEl.cloneNode(true);\n                    trailPath.id = `${baseId}_trail`;\n                    trailPath.setAttribute('data-cblcars-owned', 'motionpath');\n                    const stroke = trailOpt.stroke || pathEl.getAttribute('stroke') || 'var(--lcars-yellow)';\n                    const sw = trailOpt['stroke-width']\n                        ?? options['stroke-width']\n                        ?? pathEl.getAttribute('stroke-width')\n                        ?? 4;\n                    trailPath.setAttribute('stroke', stroke);\n                    trailPath.setAttribute('stroke-width', sw);\n                    if (trailOpt.opacity !== undefined) trailPath.setAttribute('opacity', trailOpt.opacity);\n\n                    const mode = trailOpt.mode || 'overlay';\n                    if (mode === 'single') {\n                        pathEl.setAttribute('opacity', '0');\n                        pathEl.setAttribute('stroke', 'none');\n                    }\n                    if (isPending(pathEl)) {\n                        trailPath.setAttribute('visibility', 'hidden');\n                    }\n\n                    pathEl.parentNode.insertBefore(trailPath, pathEl.nextSibling);\n\n                    const [drawable] = window.cblcars.animejs.svg.createDrawable(trailPath);\n                    const trailVars = {\n                        draw: '0 1',\n                        duration: trailOpt.duration ?? params.duration ?? 1000,\n                        easing: trailOpt.easing ?? params.easing ?? 'linear',\n                        loop: trailOpt.loop ?? params.loop ?? true\n                    };\n                    window.cblcars.anim.anime(drawable, trailVars);\n                } catch (e) {\n                    cblcarsLog.error('[motionpath] Trail setup failed:', e);\n                }\n            };\n\n            // Build tracer node (circle or rect)\n            const buildTracer = () => {\n                let tid = tracerCfg.id || `${baseId}_tracer`;\n                const svgRoot = pathEl.ownerSVGElement || pathEl.closest('svg') || pathEl.parentNode;\n                const existing = svgRoot ? svgRoot.getElementById?.(tid) : null;\n                if (existing && existing.getAttribute('data-cblcars-owned') !== 'motionpath') {\n                    tid = `${tid}_mptrc`;\n                }\n\n                let tracerMarkup;\n                if (tracerCfg.shape === 'rect') {\n                    tracerMarkup = svgHelpers.drawRect({\n                        x: -((tracerCfg.width || 8) / 2),\n                        y: -((tracerCfg.height || 8) / 2),\n                        width: tracerCfg.width || 8,\n                        height: tracerCfg.height || 8,\n                        id: tid,\n                        attrs: { fill: tracerCfg.fill || 'var(--lcars-orange)' },\n                        style: tracerCfg.style || {}\n                    });\n                } else {\n                    tracerMarkup = svgHelpers.drawCircle({\n                        cx: 0,\n                        cy: 0,\n                        r: tracerCfg.r || 4,\n                        id: tid,\n                        attrs: { fill: tracerCfg.fill || 'var(--lcars-orange)' },\n                        style: tracerCfg.style || {}\n                    });\n                }\n                const temp = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n                temp.innerHTML = tracerMarkup;\n                tracerNode = temp.firstElementChild;\n                tracerNode.setAttribute('data-cblcars-owned', 'motionpath');\n                (svgRoot || pathEl.parentNode).appendChild(tracerNode);\n            };\n\n            const bindTracerAnimation = () => {\n                if (!tracerNode || !pathEl) return;\n                const { translateX, translateY, rotate } = window.cblcars.animejs.svg.createMotionPath(pathEl);\n\n                const exclude = new Set([\n                    'tracer', 'trail', 'path_selector', 'root', 'targets', 'type', 'animation',\n                    'stroke', 'stroke-width', 'corner_style', 'corner_radius', 'waypoints',\n                    'steps', 'rounded', 'smooth', 'smooth_tension', 'id'\n                ]);\n                const merged = {};\n                Object.entries({ ...params, ...options }).forEach(([k, v]) => {\n                    if (!exclude.has(k)) merged[k] = v;\n                });\n\n                try {\n                    if (tracerNode.__cblcars_motion && typeof tracerNode.__cblcars_motion.pause === 'function') {\n                        tracerNode.__cblcars_motion.pause();\n                    }\n                } catch (_) {}\n\n                tracerNode.__cblcars_motion = window.cblcars.anim.anime(tracerNode, {\n                    ...merged,\n                    translateX,\n                    translateY,\n                    rotate\n                });\n            };\n\n            const rebindAll = (reason = '') => {\n                try {\n                    if (!hasUsablePathD(pathEl.getAttribute('d')) || !pathLengthOk(pathEl)) {\n                        return;\n                    }\n                    if (trailPath) {\n                        trailPath.setAttribute('d', pathEl.getAttribute('d') || '');\n                        if (isPending(pathEl)) {\n                            trailPath.setAttribute('visibility', 'hidden');\n                        } else {\n                            trailPath.removeAttribute('visibility');\n                        }\n                    }\n                    bindTracerAnimation();\n                } catch (e) {\n                    cblcarsLog.warn('[motionpath] rebind failed', { reason, e });\n                }\n            };\n\n            const initArtifacts = () => {\n                buildTrail();\n                buildTracer();\n                rebindAll('initial');\n            };\n\n            // Robust wait logic\n            const waitMaxMs = Number.isFinite(options.wait_max_ms) ? options.wait_max_ms : 12000;\n            const pollInterval = 120;\n            const startTime = performance.now();\n\n            const waitForReady = () => new Promise((resolve) => {\n                const tick = () => {\n                    // If path replaced externally, bail (outer loop handles reattach)\n                    if (!alive) return resolve(false);\n\n                    const d = pathEl.getAttribute('d') || '';\n                    const pending = isPending(pathEl);\n                    const usable = hasUsablePathD(d) && pathLengthOk(pathEl);\n\n                    if (!pending && usable) return resolve(true);\n\n                    // Only count timeout time AFTER pending cleared\n                    if (!pending && (performance.now() - startTime) >= waitMaxMs) {\n                        return resolve(false);\n                    }\n                    setTimeout(tick, pollInterval);\n                };\n                tick();\n            });\n\n            // Initial cleanup & wait\n            cleanupArtifacts();\n            const ready = await waitForReady();\n\n            if (!ready) {\n                const msg = `[motionpath] Timed out waiting for usable path geometry (id=${pathEl.id})`;\n                cblcarsLog.warn(msg);\n                //svgOverlayManager.push(msg);\n                params.targets = null;\n                return;\n            }\n\n            initArtifacts();\n\n            // Observe path for d / pending changes\n            try {\n                pathMutationObserver = new MutationObserver((muts) => {\n                    let needs = false;\n                    for (const m of muts) {\n                        if (m.type === 'attributes' &&\n                            (m.attributeName === 'd' || m.attributeName === 'data-cblcars-pending')) {\n                            needs = true;\n                            break;\n                        }\n                    }\n                    if (needs) {\n                        // If pending turned back on, hide trail again\n                        if (trailPath && isPending(pathEl)) {\n                            trailPath.setAttribute('visibility', 'hidden');\n                        }\n                        rebindAll('mutation');\n                    }\n                });\n                pathMutationObserver.observe(pathEl, { attributes: true, attributeFilter: ['d', 'data-cblcars-pending'] });\n            } catch (_) {}\n\n            // Lightweight poll for element replacement\n            const pathId = pathEl.id;\n            const reattachPoll = () => {\n                if (!alive) return;\n                const current = (root.getElementById && root.getElementById(pathId)) || pathEl;\n                if (current !== pathEl && current instanceof SVGPathElement) {\n                    cblcarsLog.debug('[motionpath] Path element replaced; reinitializing', { id: pathId });\n                    try { pathMutationObserver?.disconnect(); } catch (_) {}\n                    pathEl = current;\n                    cleanupArtifacts();\n                    trailPath = null;\n                    tracerNode = null;\n                    // Wait again for readiness of the new path\n                    waitForReady().then((ok) => {\n                        if (ok) {\n                            initArtifacts();\n                            try {\n                                pathMutationObserver = new MutationObserver((muts) => {\n                                    let needs = false;\n                                    for (const m of muts) {\n                                        if (m.type === 'attributes' &&\n                                            (m.attributeName === 'd' || m.attributeName === 'data-cblcars-pending')) {\n                                            needs = true;\n                                            break;\n                                        }\n                                    }\n                                    if (needs) rebindAll('mutation(replaced)');\n                                });\n                                pathMutationObserver.observe(pathEl, { attributes: true, attributeFilter: ['d', 'data-cblcars-pending'] });\n                            } catch (_) {}\n                        }\n                    });\n                }\n                setTimeout(reattachPoll, 2000);\n            };\n            setTimeout(reattachPoll, 2000);\n\n            // Prevent base animateElement from adding another animation\n            params.targets = null;\n\n            // Cleanup hook if needed later\n            element.__cblcars_motionpath_cleanup = () => {\n                alive = false;\n                try { pathMutationObserver?.disconnect(); } catch (_) {}\n                try {\n                    if (tracerNode?.__cblcars_motion?.pause) tracerNode.__cblcars_motion.pause();\n                } catch (_) {}\n                try { cleanupArtifacts(); } catch (_) {}\n            };\n\n        } catch (e) {\n            cblcarsLog.error('[motionpath] Unhandled error', e);\n            //svgOverlayManager.push(`[motionpath] ${e?.message || e}`);\n            params.targets = null;\n        }\n    },\n\n    /**\n     * @preset march\n     * CSS-based marching dashed line animation.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    march: (params, element, options = {}) => {\n        // Get dash pattern from stroke_dasharray\n        let dashArray = params.stroke_dasharray ?? options.stroke_dasharray ?? [25, 15];\n        if (!Array.isArray(dashArray) || dashArray.length < 2) {\n            dashArray = [25, 15];\n        }\n        const [dashLength, gapLength] = dashArray;\n\n        // Set the stroke-dasharray for the dashed pattern\n        element.style.strokeDasharray = `${dashLength} ${gapLength}`;\n        element.style.strokeDashoffset = 0;\n\n        // Apply ststroberoke linecap if specified\n        const linecap = params.stroke_linecap ?? options.stroke_linecap;\n        if (linecap) {\n            element.style.strokeLinecap = linecap;\n        }\n\n        // Calculate cycle length (sum of dash and gap)\n        const cycleLength = dashLength + gapLength;\n\n        // Get animation duration, default to 2s if not specified\n        let duration = params.duration ?? options.duration ?? 2000;\n\n        // Convert to seconds for CSS\n        const durationSec = duration / 1000;\n\n        // Get direction\n        let reversed = params.reversed ?? options.reversed ?? false;\n\n        // Create unique animation name using element id or a random string\n        const animId = element.id || `march_${Math.random().toString(36).substring(2, 9)}`;\n        element.dataset.marchAnimId = animId;\n\n        // Direction: offset moves negative for forward, positive for reverse\n        const offsetTarget = reversed ? cycleLength : -cycleLength;\n\n        // Handle loop parameter (like anime.js)\n        // - true or undefined: infinite loop (CSS: infinite)\n        // - false or 0: no loop (CSS: 1)\n        // - number > 0: specific iteration count\n        let loopValue = params.loop ?? options.loop ?? true;\n        const iterationCount = loopValue === true ? 'infinite' :\n                              (loopValue === false || loopValue === 0) ? '1' :\n                              typeof loopValue === 'number' ? Math.max(1, loopValue) : 'infinite';\n\n        // Find the appropriate document to inject styles into\n        const targetDoc = element.getRootNode();\n        const isInShadowDOM = targetDoc !== document;\n\n        // Apply animation directly to the element via inline style\n        // This avoids Shadow DOM style isolation issues\n        const animationName = `march_${animId}`;\n        const keyframesStr = `@keyframes ${animationName} { to { stroke-dashoffset: ${offsetTarget}px; } }`;\n\n        // Apply animation directly to the element\n        const playbackRate = params.playbackRate ?? options.playbackRate ?? 1;\n        const effectiveDuration = `${durationSec / playbackRate}s`;\n\n        // Set inline styles directly on the element - more reliable across shadow DOM boundaries\n        element.style.animation = `${animationName} ${effectiveDuration} linear ${iterationCount}`;\n\n        // Create keyframes for the animation and inject them\n        if (isInShadowDOM && targetDoc.adoptedStyleSheets) {\n            // Modern Shadow DOM with Constructable Stylesheets\n            try {\n                let styleSheet = Array.from(targetDoc.adoptedStyleSheets)\n                    .find(sheet => sheet.marchAnimations);\n\n                if (!styleSheet) {\n                    styleSheet = new CSSStyleSheet();\n                    styleSheet.marchAnimations = true;\n                    targetDoc.adoptedStyleSheets = [...targetDoc.adoptedStyleSheets, styleSheet];\n                }\n\n                styleSheet.insertRule(keyframesStr, styleSheet.cssRules.length);\n            } catch (e) {\n                cblcarsLog.error('Failed to add CSS animation to Shadow DOM:', e);\n                fallbackStyleInjection();\n            }\n        } else {\n            // Fallback: add <style> element to document/shadowRoot\n            fallbackStyleInjection();\n        }\n\n        function fallbackStyleInjection() {\n            const styleId = 'march-smooth-css-animations';\n            let styleEl = targetDoc.getElementById ? targetDoc.getElementById(styleId) : null;\n\n            if (!styleEl) {\n                styleEl = document.createElement('style');\n                styleEl.id = styleId;\n                const target = isInShadowDOM ? targetDoc : document.head;\n                target.appendChild(styleEl);\n            }\n\n            if (!styleEl.textContent.includes(animationName)) {\n                styleEl.textContent += keyframesStr;\n            }\n        }\n\n        // Fill params with dummy values so anime.js doesn't override our CSS animation\n        Object.assign(params, {\n            _cssAnimation: true, // flag to indicate we're using CSS animation\n            duration: 1,\n            loop: false,\n            autoplay: false\n        });\n    },\n\n    /**\n     * @preset glow\n     * Animates stroke color and drop-shadow for a glowing effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    glow: (params, element, options = {}) => {\n        cblcarsLog.debug('[glow preset] Before mutation:', { params, element, options });\n\n        // Configurable values with defaults\n        const glowCfg = options.glow || {};\n        const color = glowCfg.color || options.color || 'var(--picard-light-blue)';\n        const intensity = glowCfg.intensity ?? options.intensity ?? 0.8;\n        const blurMin = glowCfg.blur_min ?? 0;\n        const blurMax = glowCfg.blur_max ?? 12;\n        const opacityMin = glowCfg.opacity_min ?? 0.4;\n        const opacityMax = glowCfg.opacity_max ?? intensity;\n        const duration = options.duration ?? glowCfg.duration ?? 900;\n        const easing = options.easing ?? glowCfg.easing ?? 'easeInOutSine';\n        const loop = options.loop ?? glowCfg.loop ?? true;\n        const alternate = options.alternate ?? glowCfg.alternate ?? true;\n\n        const glowState = { blur: blurMin, opacity: opacityMin };\n\n        Object.assign(params, {\n            targets: glowState,\n            blur: [blurMin, blurMax, blurMin],\n            opacity: [opacityMin, opacityMax, opacityMin],\n            duration,\n            easing,\n            loop,\n            alternate,\n            onUpdate() {\n                if (element.tagName === 'text' || element.tagName === 'TEXT') {\n                    // For text, animate both blur and opacity\n                    element.style.filter = `drop-shadow(0 0 ${glowState.blur}px ${color}) opacity(${glowState.opacity})`;\n                } else {\n                    // For lines, only animate blur, do not affect element opacity\n                    element.style.filter = `drop-shadow(0 0 ${glowState.blur}px ${color})`;\n                }\n            }\n        });\n        // Remove fill/stroke animation\n        delete params.fill;\n        delete params.stroke;\n        element.style.transformOrigin = 'center';\n        element.style.transformBox = 'fill-box';\n        cblcarsLog.debug('[glow preset] Animating drop-shadow:', { color, intensity, blurMin, blurMax, opacityMin, opacityMax, duration, easing, loop, alternate });\n\n        cblcarsLog.debug('[glow preset] After mutation:', { params, element });\n    },\n\n    /**\n     * @preset shimmer\n     * Animates fill and opacity for a shimmering effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    shimmer: (params, element, options = {}) => {\n        const color = options.color || 'var(--lcars-yellow)';\n        Object.assign(params, {\n            opacity: [1, 0.5, 1],\n            fill: [element.getAttribute('fill') || color, color],\n            alternate: true,\n            loop: true,\n            easing: 'easeInOutSine',\n            duration: options.duration ?? 1200\n        });\n    },\n\n    /**\n     * @preset strobe\n     * Rapidly toggles opacity for a strobe effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    strobe: (params, element, options = {}) => {\n        Object.assign(params, {\n            opacity: [1, 0.1],\n            alternate: true,\n            loop: true,\n            easing: 'steps(2, end)',\n            duration: options.duration ?? 400\n        });\n    },\n\n    /**\n     * @preset cascade\n     * Staggers opacity animation for multiple elements.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    cascade: (params, element, options = {}) => {\n        Object.assign(params, {\n            opacity: [0, 1],\n            delay: window.cblcars.animejs.stagger(options.stagger ?? 100),\n            easing: 'easeOutQuad',\n            duration: options.duration ?? 800\n        });\n    },\n\n    /**\n     * @preset ripple\n     * Animates scale and opacity for a ripple effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    ripple: (params, element, options = {}) => {\n        Object.assign(params, {\n            scale: [1, options.max_scale ?? 2, 1],\n            opacity: [1, 0.3, 1],\n            alternate: true,\n            loop: true,\n            easing: 'easeInOutSine',\n            duration: options.duration ?? 1200\n        });\n    },\n\n    /**\n     * @preset flicker\n     * Randomizes opacity for a flicker effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    flicker: (params, element, options = {}) => {\n        Object.assign(params, {\n            opacity: [\n                1,\n                0.7 + Math.random() * 0.3,\n                0.4 + Math.random() * 0.3,\n                1\n            ],\n            //alternate: true,\n            alternate: false,\n            loop: true,\n            easing: 'steps(4, end)',\n            duration: options.duration ?? 600\n        });\n    },\n\n    /**\n     * @preset set\n     * Sets properties/attributes/styles.\n     * Behavior:\n     * - In timeline steps: leave params as-is so anime.js applies them at the step time (no immediate mutation).\n     * - Outside timelines (free/overlay animations): mutate immediately via utils.set() and skip scheduling.\n     */\n    set: (params, element, options = {}) => {\n        // Timeline context: do not immediately set; let the step apply at its offset.\n        if (options && options.__timeline) {\n        return; // no-op; keep params as-is for anime step\n        }\n\n        const ignoreKeys = ['type', 'targets', 'root', 'animation', 'id', 'offset', '__timeline'];\n        const allParams = { ...params, ...options };\n        const propsToSet = {};\n        Object.entries(allParams).forEach(([key, value]) => {\n        if (ignoreKeys.includes(key) || value === undefined) return;\n        propsToSet[key] = value;\n        });\n\n        let animeSetWorked = false;\n        try {\n        if (window.cblcars?.anim?.utils?.set) {\n            window.cblcars.anim.utils.set(element, propsToSet);\n            animeSetWorked = true;\n        }\n        } catch (e) {\n        cblcarsLog.warn('[set preset] animejs.utils.set() failed, will fallback to manual mutation.', { e });\n        }\n\n        if (!animeSetWorked) {\n        for (const [key, value] of Object.entries(propsToSet)) {\n            try {\n            if (key in element.style) {\n                element.style[key] = value;\n            } else {\n                element.setAttribute(key, value);\n            }\n            } catch (e) {\n            cblcarsLog.warn(`[set preset] Could not set \"${key}\"=\"${value}\" manually`, { e });\n            }\n        }\n        }\n\n        // Prevent anime scheduling for non-timeline set\n        params._cssAnimation = true;\n        params.targets = null;\n    },\n\n    // Add more presets as needed...\n};","import * as CBLCARS from '../cb-lcars-vars.js';\n\nlet cblcarsGlobalLogLevel = 'info';\n\nexport function cblcarsSetGlobalLogLevel(level) {\n  cblcarsGlobalLogLevel = level;\n  cblcarsLog.info(`Setting CBLCARS global log level set to: ${level}`, {}, 'info');\n}\nexport function cblcarsGetGlobalLogLevel() {\n  return cblcarsGlobalLogLevel;\n}\n\n// Ensure the cblcars object exists on the window object\nwindow.cblcars = window.cblcars || {};\n// Attach the functions to the cblcars object\nwindow.cblcars.setGlobalLogLevel = cblcarsSetGlobalLogLevel;\nwindow.cblcars.getGlobalLogLevel = cblcarsGetGlobalLogLevel;\n// Add shortcut properties for each log level\n['error', 'warn', 'info', 'debug'].forEach(level => {\n  window.cblcars.setGlobalLogLevel[level] = () => cblcarsSetGlobalLogLevel(level);\n});\n\nexport function baseLogger(level, ...args) {\n  const levels = ['error', 'warn', 'info', 'debug'];\n  const currentLevelIndex = levels.indexOf(cblcarsGlobalLogLevel);\n  const messageLevelIndex = levels.indexOf(level);\n\n  if (messageLevelIndex > currentLevelIndex) return;\n\n  const commonStyles = 'color: white; padding: 1px 4px; border-radius: 15px;';\n  const levelStyles = {\n    info: 'background-color: #37a6d1',\n    warn: 'background-color: #ff6753',\n    error: 'background-color: #ef1d10',\n    debug: 'background-color: #8e44ad',\n    default: 'background-color: #6d748c',\n  };\n\n  const logMessage = `%c    CB-LCARS | ${level} `;\n  const style = `${levelStyles[level] || levelStyles.default}; ${commonStyles}`;\n\n  // Use spread to pass all args after the styled prefix\n  switch (level) {\n    case 'info':\n      console.log(logMessage, style, ...args);\n      break;\n    case 'warn':\n      console.warn(logMessage, style, ...args);\n      break;\n    case 'error':\n      console.error(logMessage, style, ...args);\n      break;\n    case 'debug':\n      console.debug(logMessage, style, ...args);\n      break;\n    default:\n      console.log(logMessage, style, ...args);\n      break;\n  }\n}\n\n/**\n * Centralized CB-LCARS logging utility.\n *\n * Supports log level filtering and styled output.\n * Functions as a drop-in replacement for `console.log`, `console.warn`, etc.\n *\n * **Preferred usage:**\n *   `cblcarsLog.info('message');`\n *   `cblcarsLog.warn('message');`\n *   `cblcarsLog.error('message');`\n *   `cblcarsLog.debug('message');`\n *   `cblcarsLog.log('message');`\n *\n * *Legacy usage (not recommended):*\n *   `cblcarsLog('warn', 'message');`\n *\n * **Log level filtering:**\n *\n *   Only messages at or above the global log level are printed.\n *   For example, if the global log level is 'warn', only 'warn' and 'error' messages are shown.\n *\n * **Setting the global log level:**\n *\n *   Use the function `cblcarsSetGlobalLogLevel(level)`, or\n *   `window.cblcars.setGlobalLogLevel(level)`\n *   Valid levels: `'error'`, `'warn'`, `'info'`, `'debug'`\n *\n * @param {'error'|'warn'|'info'|'debug'} level - The log level.\n * @param {...any} args - Arguments to log.\n * @returns {void}\n *\n * @property {function(...any):void} log   - Log an info-level message.\n * @property {function(...any):void} info  - Log an info-level message.\n * @property {function(...any):void} warn  - Log a warning message.\n * @property {function(...any):void} error - Log an error message.\n * @property {function(...any):void} debug - Log a debug message.\n */\nfunction cblcarsLog(level, ...args) {\n  return baseLogger(level, ...args);\n}\ncblcarsLog.log   = (...args) => baseLogger('info', ...args);\ncblcarsLog.info  = (...args) => baseLogger('info', ...args);\ncblcarsLog.warn  = (...args) => baseLogger('warn', ...args);\ncblcarsLog.error = (...args) => baseLogger('error', ...args);\ncblcarsLog.debug = (...args) => baseLogger('debug', ...args);\nexport { cblcarsLog };\n\n\nexport function cblcarsLogGroup(level, title) {\n    console.groupCollapsed(); // Create a collapsed group\n    cblcarsLog(level, `Group: ${title}`);\n    }\n\nexport function logImportStatus(importName, importedValue) {\n    if (importedValue === undefined) {\n        cblcarsLog.error(`Import error: ${importName} is not imported correctly.`);\n    } else {\n        cblcarsLog.debug(`${importName} imported successfully.`);\n    }\n}\n\nexport function cblcarsLogBanner() {\n  let styles1 = [\n      'color: white',\n      'font-weight: bold',\n      'padding: 2px 4px',\n      'border-radius: 5em 5em 0 0', // Top left and right rounded, bottom left and right square\n      'background-color: #37a6d1' // Blue\n  ];\n\n  let styles2 = [\n      'color: white',\n      'padding: 2px 4px',\n      'border-radius: 0 0 5em 5em', // Top left and right square, bottom left and right rounded\n      'background-color: #37a6d1' // Blue\n  ];\n\n  let invisibleStyle = [\n      'color: transparent',\n      'padding: 0',\n      'border: none'\n  ];\n\n  const version = CBLCARS.CBLCARS_VERSION;\n  const url = CBLCARS.project_url;\n  const baseString = \"CB-LCARS v\" + version;\n  const padding = 4;\n\n  // Calculate the total length including padding\n  const totalLength = url.length + padding;\n  const spacesNeeded = totalLength - baseString.length;\n\n  // FIXED: Protect against negative repeat count\n  const spaces = spacesNeeded > 0 ? ' '.repeat(spacesNeeded) : '';\n  const paddedUrl = ' '.repeat(padding) + url;\n\n  console.info(`%c${spaces}${baseString}  %c\\n%c${paddedUrl}  `, styles1.join(';'), invisibleStyle.join(';'), styles2.join(';'));\n}\n","// --- SVG Helpers ---\n\nexport function drawLine({ x1, y1, x2, y2, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<line id=\"${id || ''}\" x1=\"${x1}\" y1=\"${y1}\" x2=\"${x2}\" y2=\"${y2}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawPolyline({ points, id, attrs = {}, style = {} }) {\n  const pts = points.map(pt => pt.join(',')).join(' ');\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<polyline id=\"${id || ''}\" points=\"${pts}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawPath({ d, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<path id=\"${id || ''}\" d=\"${d}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawText({ x, y, text, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<text id=\"${id || ''}\" x=\"${x}\" y=\"${y}\"${attrsStr}${styleStr}>${text}</text>`;\n}\n\nexport function drawCircle({ cx, cy, r, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<circle id=\"${id || ''}\" cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawRect({ x, y, width, height, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<rect id=\"${id || ''}\" x=\"${x}\" y=\"${y}\" width=\"${width}\" height=\"${height}\"${attrsStr}${styleStr} />`;\n}\n\n// --- Utility helpers ---\n\nexport function attrsToString(attrs) {\n  if (!attrs || typeof attrs !== \"object\") return '';\n  return Object.entries(attrs)\n    .map(([k, v]) => ` ${k.replace(/[A-Z]/g, m => '-' + m.toLowerCase())}=\"${v}\"`)\n    .join('');\n}\n\nexport function styleToString(style) {\n  if (!style || typeof style !== \"object\") return \"\";\n  const s = Object.entries(style)\n    .map(([k, v]) => `${k.replace(/[A-Z]/g, m => '-' + m.toLowerCase())}:${v}`)\n    .join(';');\n  return s ? ` style=\"${s}\"` : '';\n}","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,i=t.trustedTypes,s=i?i.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,e=\"$lit$\",h=`lit$${Math.random().toFixed(9).slice(2)}$`,o=\"?\"+h,n=`<${o}>`,r=document,l=()=>r.createComment(\"\"),c=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,a=Array.isArray,u=t=>a(t)||\"function\"==typeof t?.[Symbol.iterator],d=\"[ \\t\\n\\f\\r]\",f=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\\\s\"'>=/]+)(${d}*=${d}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),p=/'/g,g=/\"/g,$=/^(?:script|style|textarea|title)$/i,y=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),x=y(1),b=y(2),w=y(3),T=Symbol.for(\"lit-noChange\"),E=Symbol.for(\"lit-nothing\"),A=new WeakMap,C=r.createTreeWalker(r,129);function P(t,i){if(!a(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==s?s.createHTML(i):i}const V=(t,i)=>{const s=t.length-1,o=[];let r,l=2===i?\"<svg>\":3===i?\"<math>\":\"\",c=f;for(let i=0;i<s;i++){const s=t[i];let a,u,d=-1,y=0;for(;y<s.length&&(c.lastIndex=y,u=c.exec(s),null!==u);)y=c.lastIndex,c===f?\"!--\"===u[1]?c=v:void 0!==u[1]?c=_:void 0!==u[2]?($.test(u[2])&&(r=RegExp(\"</\"+u[2],\"g\")),c=m):void 0!==u[3]&&(c=m):c===m?\">\"===u[0]?(c=r??f,d=-1):void 0===u[1]?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=void 0===u[3]?m:'\"'===u[3]?g:p):c===g||c===p?c=m:c===v||c===_?c=f:(c=m,r=void 0);const x=c===m&&t[i+1].startsWith(\"/>\")?\" \":\"\";l+=c===f?s+n:d>=0?(o.push(a),s.slice(0,d)+e+s.slice(d)+h+x):s+h+(-2===d?i:x)}return[P(t,l+(t[s]||\"<?>\")+(2===i?\"</svg>\":3===i?\"</math>\":\"\")),o]};class N{constructor({strings:t,_$litType$:s},n){let r;this.parts=[];let c=0,a=0;const u=t.length-1,d=this.parts,[f,v]=V(t,s);if(this.el=N.createElement(f,n),C.currentNode=this.el.content,2===s||3===s){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(r=C.nextNode())&&d.length<u;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(e)){const i=v[a++],s=r.getAttribute(t).split(h),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:c,name:e[2],strings:s,ctor:\".\"===e[1]?H:\"?\"===e[1]?I:\"@\"===e[1]?L:k}),r.removeAttribute(t)}else t.startsWith(h)&&(d.push({type:6,index:c}),r.removeAttribute(t));if($.test(r.tagName)){const t=r.textContent.split(h),s=t.length-1;if(s>0){r.textContent=i?i.emptyScript:\"\";for(let i=0;i<s;i++)r.append(t[i],l()),C.nextNode(),d.push({type:2,index:++c});r.append(t[s],l())}}}else if(8===r.nodeType)if(r.data===o)d.push({type:2,index:c});else{let t=-1;for(;-1!==(t=r.data.indexOf(h,t+1));)d.push({type:7,index:c}),t+=h.length-1}c++}}static createElement(t,i){const s=r.createElement(\"template\");return s.innerHTML=t,s}}function S(t,i,s=t,e){if(i===T)return i;let h=void 0!==e?s._$Co?.[e]:s._$Cl;const o=c(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(!1),void 0===o?h=void 0:(h=new o(t),h._$AT(t,s,e)),void 0!==e?(s._$Co??=[])[e]=h:s._$Cl=h),void 0!==h&&(i=S(t,h._$AS(t,i.values),h,e)),i}class M{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??r).importNode(i,!0);C.currentNode=e;let h=C.nextNode(),o=0,n=0,l=s[0];for(;void 0!==l;){if(o===l.index){let i;2===l.type?i=new R(h,h.nextSibling,this,t):1===l.type?i=new l.ctor(h,l.name,l.strings,this,t):6===l.type&&(i=new z(h,this,t)),this._$AV.push(i),l=s[++n]}o!==l?.index&&(h=C.nextNode(),o++)}return C.currentNode=r,e}p(t){let i=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=S(this,t,i),c(t)?t===E||null==t||\"\"===t?(this._$AH!==E&&this._$AR(),this._$AH=E):t!==this._$AH&&t!==T&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):u(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==E&&c(this._$AH)?this._$AA.nextSibling.data=t:this.T(r.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:s}=t,e=\"number\"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=N.createElement(P(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else{const t=new M(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t}}_$AC(t){let i=A.get(t.strings);return void 0===i&&A.set(t.strings,i=new N(t)),i}k(t){a(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const h of t)e===i.length?i.push(s=new R(this.O(l()),this.O(l()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=E,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||\"\"!==s[0]||\"\"!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=E}_$AI(t,i=this,s,e){const h=this.strings;let o=!1;if(void 0===h)t=S(this,t,i,0),o=!c(t)||t!==this._$AH&&t!==T,o&&(this._$AH=t);else{const e=t;let n,r;for(t=h[0],n=0;n<h.length-1;n++)r=S(this,e[s+n],i,n),r===T&&(r=this._$AH[n]),o||=!c(r)||r!==this._$AH[n],r===E?t=E:t!==E&&(t+=(r??\"\")+h[n+1]),this._$AH[n]=r}o&&!e&&this.j(t)}j(t){t===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??\"\")}}class H extends k{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===E?void 0:t}}class I extends k{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==E)}}class L extends k{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5}_$AI(t,i=this){if((t=S(this,t,i,0)??E)===T)return;const s=this._$AH,e=t===E&&s!==E||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==E&&(s===E||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){\"function\"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t)}}const Z={M:e,P:h,A:o,C:1,L:V,R:M,D:u,V:S,I:R,H:k,N:I,U:L,B:H,F:z},j=t.litHtmlPolyfillSupport;j?.(N,R),(t.litHtmlVersions??=[]).push(\"3.3.0\");const B=(t,i,s)=>{const e=s?.renderBefore??i;let h=e._$litPart$;if(void 0===h){const t=s?.renderBefore??null;e._$litPart$=h=new R(i.insertBefore(l(),t),t,void 0,s??{})}return h._$AI(t),h};export{Z as _$LH,x as html,w as mathml,T as noChange,E as nothing,B as render,b as svg};\n//# sourceMappingURL=lit-html.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},e=t=>(...e)=>({_$litDirective$:t,values:e});class i{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}export{i as Directive,t as PartType,e as directive};\n//# sourceMappingURL=directive.js.map\n","import{nothing as t,noChange as i}from\"../lit-html.js\";import{Directive as r,PartType as s,directive as n}from\"../directive.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class e extends r{constructor(i){if(super(i),this.it=t,i.type!==s.CHILD)throw Error(this.constructor.directiveName+\"() can only be used in child bindings\")}render(r){if(r===t||null==r)return this._t=void 0,this.it=r;if(r===i)return r;if(\"string\"!=typeof r)throw Error(this.constructor.directiveName+\"() called with a non-string value\");if(r===this.it)return this._t;this.it=r;const s=[r];return s.raw=s,this._t={_$litType$:this.constructor.resultType,strings:s,values:[]}}}e.directiveName=\"unsafeHTML\",e.resultType=1;const o=n(e);export{e as UnsafeHTMLDirective,o as unsafeHTML};\n//# sourceMappingURL=unsafe-html.js.map\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,e=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class n{constructor(t,e,o){if(this._$cssResult$=!0,o!==s)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const s=this.t;if(e&&void 0===t){const e=void 0!==s&&1===s.length;e&&(t=o.get(s)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&o.set(s,t))}return t}toString(){return this.cssText}}const r=t=>new n(\"string\"==typeof t?t:t+\"\",void 0,s),i=(t,...e)=>{const o=1===t.length?t[0]:e.reduce(((e,s,o)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(s)+t[o+1]),t[0]);return new n(o,t,s)},S=(s,o)=>{if(e)s.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const e of o){const o=document.createElement(\"style\"),n=t.litNonce;void 0!==n&&o.setAttribute(\"nonce\",n),o.textContent=e.cssText,s.appendChild(o)}},c=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const s of t.cssRules)e+=s.cssText;return r(e)})(t):t;export{n as CSSResult,S as adoptStyles,i as css,c as getCompatibleStyle,e as supportsAdoptingStyleSheets,r as unsafeCSS};\n//# sourceMappingURL=css-tag.js.map\n","import{getCompatibleStyle as t,adoptStyles as s}from\"./css-tag.js\";export{CSSResult,css,supportsAdoptingStyleSheets,unsafeCSS}from\"./css-tag.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{is:i,defineProperty:e,getOwnPropertyDescriptor:h,getOwnPropertyNames:r,getOwnPropertySymbols:o,getPrototypeOf:n}=Object,a=globalThis,c=a.trustedTypes,l=c?c.emptyScript:\"\",p=a.reactiveElementPolyfillSupport,d=(t,s)=>t,u={toAttribute(t,s){switch(s){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,s)=>!i(t,s),b={attribute:!0,type:String,converter:u,reflect:!1,useDefault:!1,hasChanged:f};Symbol.metadata??=Symbol(\"metadata\"),a.litPropertyMetadata??=new WeakMap;class y extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,s=b){if(s.state&&(s.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),h=this.getPropertyDescriptor(t,i,s);void 0!==h&&e(this.prototype,t,h)}}static getPropertyDescriptor(t,s,i){const{get:e,set:r}=h(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t}};return{get:e,set(s){const h=e?.call(this);r?.call(this,s),this.requestUpdate(t,h,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(d(\"elementProperties\")))return;const t=n(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(d(\"finalized\")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d(\"properties\"))){const t=this.properties,s=[...r(t),...o(t)];for(const i of s)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const i=this._$Eu(t,s);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(s){const i=[];if(Array.isArray(s)){const e=new Set(s.flat(1/0).reverse());for(const s of e)i.unshift(t(s))}else void 0!==s&&i.push(t(s));return i}static _$Eu(t,s){const i=s.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return s(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,s,i){this._$AK(t,i)}_$ET(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor._$Eu(t,i);if(void 0!==e&&!0===i.reflect){const h=(void 0!==i.converter?.toAttribute?i.converter:u).toAttribute(s,i.type);this._$Em=t,null==h?this.removeAttribute(e):this.setAttribute(e,h),this._$Em=null}}_$AK(t,s){const i=this.constructor,e=i._$Eh.get(t);if(void 0!==e&&this._$Em!==e){const t=i.getPropertyOptions(e),h=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:u;this._$Em=e,this[e]=h.fromAttribute(s,t.type)??this._$Ej?.get(e)??null,this._$Em=null}}requestUpdate(t,s,i){if(void 0!==t){const e=this.constructor,h=this[t];if(i??=e.getPropertyOptions(t),!((i.hasChanged??f)(h,s)||i.useDefault&&i.reflect&&h===this._$Ej?.get(t)&&!this.hasAttribute(e._$Eu(t,i))))return;this.C(t,s,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,s,{useDefault:i,reflect:e,wrapped:h},r){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??s??this[t]),!0!==h||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),!0===e&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,s]of this._$Ep)this[t]=s;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];!0!==t||this._$AL.has(s)||void 0===e||this.C(s,void 0,i,e)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(s)):this._$EM()}catch(s){throw t=!1,this._$EM(),s}t&&this._$AE(s)}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((t=>this._$ET(t,this[t]))),this._$EM()}updated(t){}firstUpdated(t){}}y.elementStyles=[],y.shadowRootOptions={mode:\"open\"},y[d(\"elementProperties\")]=new Map,y[d(\"finalized\")]=new Map,p?.({ReactiveElement:y}),(a.reactiveElementVersions??=[]).push(\"2.1.0\");export{y as ReactiveElement,s as adoptStyles,u as defaultConverter,t as getCompatibleStyle,f as notEqual};\n//# sourceMappingURL=reactive-element.js.map\n","import{ReactiveElement as t}from\"@lit/reactive-element\";export*from\"@lit/reactive-element\";import{render as e,noChange as r}from\"lit-html\";export*from\"lit-html\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=globalThis;class i extends t{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=e(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return r}}i._$litElement$=!0,i[\"finalized\"]=!0,s.litElementHydrateSupport?.({LitElement:i});const o=s.litElementPolyfillSupport;o?.({LitElement:i});const n={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(s.litElementVersions??=[]).push(\"4.2.0\");export{i as LitElement,n as _$LE};\n//# sourceMappingURL=lit-element.js.map\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst o=!1;export{o as isServer};\n//# sourceMappingURL=is-server.js.map\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * anime.js - ESM\n * @version v4.0.2\n * @author Julian Garnier\n * @license MIT\n * @copyright (c) 2025 Julian Garnier\n * @see https://animejs.com\n */\n\n/**\n * @typedef {Object} DefaultsParams\n * @property {Number|String} [id]\n * @property {PercentageKeyframes|DurationKeyframes} [keyframes]\n * @property {EasingParam} [playbackEase]\n * @property {Number} [playbackRate]\n * @property {Number} [frameRate]\n * @property {Number|Boolean} [loop]\n * @property {Boolean} [reversed]\n * @property {Boolean} [alternate]\n * @property {Boolean|ScrollObserver} [autoplay]\n * @property {Number|FunctionValue} [duration]\n * @property {Number|FunctionValue} [delay]\n * @property {Number} [loopDelay]\n * @property {EasingParam} [ease]\n * @property {'none'|'replace'|'blend'|compositionTypes} [composition]\n * @property {(v: any) => any} [modifier]\n * @property {(tickable: Tickable) => void} [onBegin]\n * @property {(tickable: Tickable) => void} [onBeforeUpdate]\n * @property {(tickable: Tickable) => void} [onUpdate]\n * @property {(tickable: Tickable) => void} [onLoop]\n * @property {(tickable: Tickable) => void} [onPause]\n * @property {(tickable: Tickable) => void} [onComplete]\n * @property {(renderable: Renderable) => void} [onRender]\n */\n\n/** @typedef {JSAnimation|Timeline} Renderable */\n/** @typedef {Timer|Renderable} Tickable */\n/** @typedef {Timer&JSAnimation&Timeline} CallbackArgument */\n/** @typedef {Animatable|Tickable|Draggable|ScrollObserver|Scope} Revertible */\n\n/**\n * @typedef {Object} DraggableAxisParam\n * @property {String} [mapTo]\n * @property {TweenModifier} [modifier]\n * @property {TweenComposition} [composition]\n * @property {Number|Array<Number>|((draggable: Draggable) => Number|Array<Number>)} [snap]\n */\n\n/**\n * @typedef {Object} DraggableCursorParams\n * @property {String} [onHover]\n * @property {String} [onGrab]\n */\n\n/**\n * @typedef {Object} DraggableParams\n * @property {DOMTargetSelector} [trigger]\n * @property {DOMTargetSelector|Array<Number>|((draggable: Draggable) => DOMTargetSelector|Array<Number>)} [container]\n * @property {Boolean|DraggableAxisParam} [x]\n * @property {Boolean|DraggableAxisParam} [y]\n * @property {TweenModifier} [modifier]\n * @property {Number|Array<Number>|((draggable: Draggable) => Number|Array<Number>)} [snap]\n * @property {Number|Array<Number>|((draggable: Draggable) => Number|Array<Number>)} [containerPadding]\n * @property {Number|((draggable: Draggable) => Number)} [containerFriction]\n * @property {Number|((draggable: Draggable) => Number)} [releaseContainerFriction]\n * @property {Number|((draggable: Draggable) => Number)} [dragSpeed]\n * @property {Number|((draggable: Draggable) => Number)} [scrollSpeed]\n * @property {Number|((draggable: Draggable) => Number)} [scrollThreshold]\n * @property {Number|((draggable: Draggable) => Number)} [minVelocity]\n * @property {Number|((draggable: Draggable) => Number)} [maxVelocity]\n * @property {Number|((draggable: Draggable) => Number)} [velocityMultiplier]\n * @property {Number} [releaseMass]\n * @property {Number} [releaseStiffness]\n * @property {Number} [releaseDamping]\n * @property {Boolean} [releaseDamping]\n * @property {EasingParam} [releaseEase]\n * @property {Boolean|DraggableCursorParams|((draggable: Draggable) => Boolean|DraggableCursorParams)} [cursor]\n * @property {Callback<Draggable>} [onGrab]\n * @property {Callback<Draggable>} [onDrag]\n * @property {Callback<Draggable>} [onRelease]\n * @property {Callback<Draggable>} [onUpdate]\n * @property {Callback<Draggable>} [onSettle]\n * @property {Callback<Draggable>} [onSnap]\n * @property {Callback<Draggable>} [onResize]\n * @property {Callback<Draggable>} [onAfterResize]\n */\n\n/**\n * @typedef {SVGGeometryElement & {\n *   setAttribute(name: 'draw', value: `${number} ${number}`): void;\n *   draw: `${number} ${number}`;\n * }} DrawableSVGGeometry\n */\n\n/**\n * @callback EasingFunction\n * @param {Number} time\n * @return {Number}\n */\n\n/**\n * @typedef {('linear'|'linear(x1, x2 25%, x3)'|'in'|'out'|'inOut'|'inQuad'|'outQuad'|'inOutQuad'|'inCubic'|'outCubic'|'inOutCubic'|'inQuart'|'outQuart'|'inOutQuart'|'inQuint'|'outQuint'|'inOutQuint'|'inSine'|'outSine'|'inOutSine'|'inCirc'|'outCirc'|'inOutCirc'|'inExpo'|'outExpo'|'inOutExpo'|'inBounce'|'outBounce'|'inOutBounce'|'inBack'|'outBack'|'inOutBack'|'inElastic'|'outElastic'|'inOutElastic'|'irregular'|'cubicBezier'|'steps'|'in(p = 1.675)'|'out(p = 1.675)'|'inOut(p = 1.675)'|'inBack(overshoot = 1.70158)'|'outBack(overshoot = 1.70158)'|'inOutBack(overshoot = 1.70158)'|'inElastic(amplitude = 1, period = .3)'|'outElastic(amplitude = 1, period = .3)'|'inOutElastic(amplitude = 1, period = .3)'|'irregular(length = 10, randomness = 1)'|'cubicBezier(x1, y1, x2, y2)'|'steps(steps = 10)')} EaseStringParamNames\n */\n\n// A hack to get both ease names suggestions AND allow any strings\n// https://github.com/microsoft/TypeScript/issues/29729#issuecomment-460346421\n/** @typedef {(String & {})|EaseStringParamNames|EasingFunction|Spring} EasingParam */\n\n/** @typedef {HTMLElement|SVGElement} DOMTarget */\n/** @typedef {Record<String, any>} JSTarget */\n/** @typedef {DOMTarget|JSTarget} Target */\n/** @typedef {Target|NodeList|String} TargetSelector */\n/** @typedef {DOMTarget|NodeList|String} DOMTargetSelector */\n/** @typedef {Array.<DOMTargetSelector>|DOMTargetSelector} DOMTargetsParam */\n/** @typedef {Array.<DOMTarget>} DOMTargetsArray */\n/** @typedef {Array.<JSTarget>|JSTarget} JSTargetsParam */\n/** @typedef {Array.<JSTarget>} JSTargetsArray */\n/** @typedef {Array.<TargetSelector>|TargetSelector} TargetsParam */\n/** @typedef {Array.<Target>} TargetsArray */\n\n/**\n * @callback FunctionValue\n * @param {Target} target - The animated target\n * @param {Number} index - The target index\n * @param {Number} length - The total number of animated targets\n * @return {Number|String|TweenObjectValue|Array.<Number|String|TweenObjectValue>}\n */\n\n/**\n * @callback TweenModifier\n * @param {Number} value - The animated value\n * @return {Number|String}\n */\n\n/** @typedef {[Number, Number, Number, Number]} ColorArray */\n\n/**\n * @template T\n * @callback Callback\n * @param {T} self - Returns itself\n * @param {PointerEvent} [e]\n * @return {*}\n */\n\n/**\n * @template {object} T\n * @typedef {Object} TickableCallbacks\n * @property {Callback<T>} [onBegin]\n * @property {Callback<T>} [onBeforeUpdate]\n * @property {Callback<T>} [onUpdate]\n * @property {Callback<T>} [onLoop]\n * @property {Callback<T>} [onPause]\n * @property {Callback<T>} [onComplete]\n */\n\n/**\n * @template {object} T\n * @typedef {Object} RenderableCallbacks\n * @property {Callback<T>} [onRender]\n */\n\n/**\n * @typedef {Object} Tween\n * @property {Number} id\n * @property {JSAnimation} parent\n * @property {String} property\n * @property {Target} target\n * @property {String|Number} _value\n * @property {Function|null} _func\n * @property {EasingFunction} _ease\n * @property {Array.<Number>} _fromNumbers\n * @property {Array.<Number>} _toNumbers\n * @property {Array.<String>} _strings\n * @property {Number} _fromNumber\n * @property {Number} _toNumber\n * @property {Array.<Number>} _numbers\n * @property {Number} _number\n * @property {String} _unit\n * @property {TweenModifier} _modifier\n * @property {Number} _currentTime\n * @property {Number} _delay\n * @property {Number} _updateDuration\n * @property {Number} _startTime\n * @property {Number} _changeDuration\n * @property {Number} _absoluteStartTime\n * @property {tweenTypes} _tweenType\n * @property {valueTypes} _valueType\n * @property {Number} _composition\n * @property {Number} _isOverlapped\n * @property {Number} _isOverridden\n * @property {Number} _renderTransforms\n * @property {Tween} _prevRep\n * @property {Tween} _nextRep\n * @property {Tween} _prevAdd\n * @property {Tween} _nextAdd\n * @property {Tween} _prev\n * @property {Tween} _next\n */\n\n/**\n * @typedef TweenDecomposedValue\n * @property {Number} t - Type\n * @property {Number} n - Single number value\n * @property {String} u - Value unit\n * @property {String} o - Value operator\n * @property {Array.<Number>} d - Array of Numbers (in case of complex value type)\n * @property {Array.<String>} s - Strings (in case of complex value type)\n */\n\n/** @typedef {{_head: null|Tween, _tail: null|Tween}} TweenPropertySiblings */\n/** @typedef {Record<String, TweenPropertySiblings>} TweenLookups */\n/** @typedef {WeakMap.<Target, TweenLookups>} TweenReplaceLookups */\n/** @typedef {Map.<Target, TweenLookups>} TweenAdditiveLookups */\n\n/**\n * @typedef {Object} TimerOptions\n * @property {Number|String} [id]\n * @property {TweenParamValue} [duration]\n * @property {TweenParamValue} [delay]\n * @property {Number} [loopDelay]\n * @property {Boolean} [reversed]\n * @property {Boolean} [alternate]\n * @property {Boolean|Number} [loop]\n * @property {Boolean|ScrollObserver} [autoplay]\n * @property {Number} [frameRate]\n * @property {Number} [playbackRate]\n */\n\n/**\n\n/**\n * @typedef {TimerOptions & TickableCallbacks<Timer>} TimerParams\n */\n\n/**\n * @typedef {Number|String|FunctionValue} TweenParamValue\n */\n\n/**\n * @typedef {TweenParamValue|[TweenParamValue, TweenParamValue]} TweenPropValue\n */\n\n/**\n * @typedef {(String & {})|'none'|'replace'|'blend'|compositionTypes} TweenComposition\n */\n\n/**\n * @typedef {Object} TweenParamsOptions\n * @property {TweenParamValue} [duration]\n * @property {TweenParamValue} [delay]\n * @property {EasingParam} [ease]\n * @property {TweenModifier} [modifier]\n * @property {TweenComposition} [composition]\n */\n\n/**\n * @typedef {Object} TweenValues\n * @property {TweenParamValue} [from]\n * @property {TweenPropValue} [to]\n * @property {TweenPropValue} [fromTo]\n */\n\n/**\n * @typedef {TweenParamsOptions & TweenValues} TweenKeyValue\n */\n\n/**\n * @typedef {Array.<TweenKeyValue|TweenPropValue>} ArraySyntaxValue\n */\n\n/**\n * @typedef {TweenParamValue|ArraySyntaxValue|TweenKeyValue} TweenOptions\n */\n\n/**\n * @typedef {Partial<{to: TweenParamValue|Array.<TweenParamValue>; from: TweenParamValue|Array.<TweenParamValue>; fromTo: TweenParamValue|Array.<TweenParamValue>;}>} TweenObjectValue\n */\n\n/**\n * @typedef {Object} PercentageKeyframeOptions\n * @property {EasingParam} [ease]\n */\n\n/**\n * @typedef {Record<String, TweenParamValue>} PercentageKeyframeParams\n */\n\n/**\n * @typedef {Record<String, PercentageKeyframeParams & PercentageKeyframeOptions>} PercentageKeyframes\n */\n\n/**\n * @typedef {Array<Record<String, TweenOptions | TweenModifier | boolean> & TweenParamsOptions>} DurationKeyframes\n */\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {PercentageKeyframes|DurationKeyframes} [keyframes]\n * @property {EasingParam} [playbackEase]\n */\n\n// TODO: Currently setting TweenModifier to the intersected Record<> makes the FunctionValue type target param any if only one parameter is set\n/**\n * @typedef {Record<String, TweenOptions | Callback<JSAnimation> | TweenModifier | boolean | PercentageKeyframes | DurationKeyframes | ScrollObserver> & TimerOptions & AnimationOptions & TweenParamsOptions & TickableCallbacks<JSAnimation> & RenderableCallbacks<JSAnimation>} AnimationParams\n */\n\n/**\n * @typedef {Object} TimelineOptions\n * @property {DefaultsParams} [defaults]\n * @property {EasingParam} [playbackEase]\n */\n\n/**\n * @typedef {TimerOptions & TimelineOptions & TickableCallbacks<Timeline> & RenderableCallbacks<Timeline>} TimelineParams\n */\n\n/**\n * @callback AnimatablePropertySetter\n * @param  {Number|Array.<Number>} to\n * @param  {Number} [duration]\n * @param  {EasingParam} [ease]\n * @return {AnimatableObject}\n */\n\n/**\n * @callback AnimatablePropertyGetter\n * @return {Number|Array.<Number>}\n */\n\n/**\n * @typedef {AnimatablePropertySetter & AnimatablePropertyGetter} AnimatableProperty\n */\n\n/**\n * @typedef {Animatable & Record<String, AnimatableProperty>} AnimatableObject\n */\n\n/**\n * @typedef {Object} AnimatablePropertyParamsOptions\n * @property {String} [unit]\n * @property {TweenParamValue} [duration]\n * @property {EasingParam} [ease]\n * @property {TweenModifier} [modifier]\n * @property {TweenComposition} [composition]\n */\n\n/**\n * @typedef {Record<String, TweenParamValue | EasingParam | TweenModifier | TweenComposition | AnimatablePropertyParamsOptions> & AnimatablePropertyParamsOptions} AnimatableParams\n */\n\n\n// Environments\n\n// TODO: Do we need to check if we're running inside a worker ?\nconst isBrowser = typeof window !== 'undefined';\n\n/** @type {Object|Null} */\nconst win = isBrowser ? window : null;\n\n/** @type {Document} */\nconst doc = isBrowser ? document : null;\n\n// Enums\n\n/** @enum {Number} */\nconst tweenTypes = {\n  OBJECT: 0,\n  ATTRIBUTE: 1,\n  CSS: 2,\n  TRANSFORM: 3,\n  CSS_VAR: 4,\n};\n\n/** @enum {Number} */\nconst valueTypes = {\n  NUMBER: 0,\n  UNIT: 1,\n  COLOR: 2,\n  COMPLEX: 3,\n};\n\n/** @enum {Number} */\nconst tickModes = {\n  NONE: 0,\n  AUTO: 1,\n  FORCE: 2,\n};\n\n/** @enum {Number} */\nconst compositionTypes = {\n  replace: 0,\n  none: 1,\n  blend: 2,\n};\n\n// Cache symbols\n\nconst isRegisteredTargetSymbol = Symbol();\nconst isDomSymbol = Symbol();\nconst isSvgSymbol = Symbol();\nconst transformsSymbol = Symbol();\nconst morphPointsSymbol = Symbol();\nconst proxyTargetSymbol = Symbol();\n\n// Numbers\n\nconst minValue = 1e-11;\nconst maxValue = 1e12;\nconst K = 1e3;\nconst maxFps = 120;\n\n// Strings\n\nconst emptyString = '';\nconst shortTransforms = new Map();\n\nshortTransforms.set('x', 'translateX');\nshortTransforms.set('y', 'translateY');\nshortTransforms.set('z', 'translateZ');\n\nconst validTransforms = [\n  'translateX',\n  'translateY',\n  'translateZ',\n  'rotate',\n  'rotateX',\n  'rotateY',\n  'rotateZ',\n  'scale',\n  'scaleX',\n  'scaleY',\n  'scaleZ',\n  'skew',\n  'skewX',\n  'skewY',\n  'perspective',\n  'matrix',\n  'matrix3d',\n];\n\nconst transformsFragmentStrings = validTransforms.reduce((a, v) => ({...a, [v]: v + '('}), {});\n\n// Functions\n\n/** @return {void} */\nconst noop = () => {};\n\n// Regex\n\nconst hexTestRgx = /(^#([\\da-f]{3}){1,2}$)|(^#([\\da-f]{4}){1,2}$)/i;\nconst rgbExecRgx = /rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/i;\nconst rgbaExecRgx = /rgba\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(-?\\d+|-?\\d*.\\d+)\\s*\\)/i;\nconst hslExecRgx = /hsl\\(\\s*(-?\\d+|-?\\d*.\\d+)\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*\\)/i;\nconst hslaExecRgx = /hsla\\(\\s*(-?\\d+|-?\\d*.\\d+)\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*,\\s*(-?\\d+|-?\\d*.\\d+)\\s*\\)/i;\n// export const digitWithExponentRgx = /[-+]?\\d*\\.?\\d+(?:[eE][-+]?\\d+)?/g;\nconst digitWithExponentRgx = /[-+]?\\d*\\.?\\d+(?:e[-+]?\\d)?/gi;\n// export const unitsExecRgx = /^([-+]?\\d*\\.?\\d+(?:[eE][-+]?\\d+)?)+([a-z]+|%)$/i;\nconst unitsExecRgx = /^([-+]?\\d*\\.?\\d+(?:e[-+]?\\d+)?)([a-z]+|%)$/i;\nconst lowerCaseRgx = /([a-z])([A-Z])/g;\nconst transformsExecRgx = /(\\w+)(\\([^)]+\\)+)/g; // Match inline transforms with cacl() values, returns the value wrapped in ()\nconst relativeValuesExecRgx = /(\\*=|\\+=|-=)/;\n\n\n\n\n/** @type {DefaultsParams} */\nconst defaults = {\n  id: null,\n  keyframes: null,\n  playbackEase: null,\n  playbackRate: 1,\n  frameRate: maxFps,\n  loop: 0,\n  reversed: false,\n  alternate: false,\n  autoplay: true,\n  duration: K,\n  delay: 0,\n  loopDelay: 0,\n  ease: 'out(2)',\n  composition: compositionTypes.replace,\n  modifier: v => v,\n  onBegin: noop,\n  onBeforeUpdate: noop,\n  onUpdate: noop,\n  onLoop: noop,\n  onPause: noop,\n  onComplete: noop,\n  onRender: noop,\n};\n\nconst globals = {\n  /** @type {DefaultsParams} */\n  defaults,\n  /** @type {Document|DOMTarget} */\n  root: doc,\n  /** @type {Scope} */\n  scope: null,\n  /** @type {Number} */\n  precision: 4,\n  /** @type {Number} */\n  timeScale: 1,\n  /** @type {Number} */\n  tickThreshold: 200,\n};\n\nconst globalVersions = { version: '4.0.2', engine: null };\n\nif (isBrowser) {\n  if (!win.AnimeJS) win.AnimeJS = [];\n  win.AnimeJS.push(globalVersions);\n}\n\n// Strings\n\n/**\n * @param  {String} str\n * @return {String}\n */\nconst toLowerCase = str => str.replace(lowerCaseRgx, '$1-$2').toLowerCase();\n\n/**\n * Prioritize this method instead of regex when possible\n * @param  {String} str\n * @param  {String} sub\n * @return {Boolean}\n */\nconst stringStartsWith = (str, sub) => str.indexOf(sub) === 0;\n\n// Time\n// Note: Date.now is used instead of performance.now since it is precise enough for timings calculations, performs slightly faster and works in Node.js environement.\nconst now = Date.now;\n\n// Types checkers\n\nconst isArr = Array.isArray;\n/**@param {any} a @return {a is Record<String, any>} */\nconst isObj = a => a && a.constructor === Object;\n/**@param {any} a @return {a is Number} */\nconst isNum = a => typeof a === 'number' && !isNaN(a);\n/**@param {any} a @return {a is String} */\nconst isStr = a => typeof a === 'string';\n/**@param {any} a @return {a is Function} */\nconst isFnc = a => typeof a === 'function';\n/**@param {any} a @return {a is undefined} */\nconst isUnd = a => typeof a === 'undefined';\n/**@param {any} a @return {a is null | undefined} */\nconst isNil = a => isUnd(a) || a === null;\n/**@param {any} a @return {a is SVGElement} */\nconst isSvg = a => isBrowser && a instanceof SVGElement;\n/**@param {any} a @return {Boolean} */\nconst isHex = a => hexTestRgx.test(a);\n/**@param {any} a @return {Boolean} */\nconst isRgb = a => stringStartsWith(a, 'rgb');\n/**@param {any} a @return {Boolean} */\nconst isHsl = a => stringStartsWith(a, 'hsl');\n/**@param {any} a @return {Boolean} */\nconst isCol = a => isHex(a) || isRgb(a) || isHsl(a);\n/**@param {any} a @return {Boolean} */\nconst isKey = a => !globals.defaults.hasOwnProperty(a);\n\n// Number\n\n/**\n * @param  {Number|String} str\n * @return {Number}\n */\nconst parseNumber = str => isStr(str) ?\n  parseFloat(/** @type {String} */(str)) :\n  /** @type {Number} */(str);\n\n// Math\n\nconst pow = Math.pow;\nconst sqrt = Math.sqrt;\nconst sin = Math.sin;\nconst cos = Math.cos;\nconst abs = Math.abs;\nconst exp = Math.exp;\nconst ceil = Math.ceil;\nconst floor = Math.floor;\nconst asin = Math.asin;\nconst max = Math.max;\nconst atan2 = Math.atan2;\nconst PI = Math.PI;\nconst _round = Math.round;\n\n/**\n * @param  {Number} v\n * @param  {Number} min\n * @param  {Number} max\n * @return {Number}\n */\nconst clamp = (v, min, max) => v < min ? min : v > max ? max : v;\n\nconst powCache = {};\n\n/**\n * @param  {Number} v\n * @param  {Number} decimalLength\n * @return {Number}\n */\nconst round = (v, decimalLength) => {\n  if (decimalLength < 0) return v;\n  if (!decimalLength) return _round(v);\n  let p = powCache[decimalLength];\n  if (!p) p = powCache[decimalLength] = 10 ** decimalLength;\n  return _round(v * p) / p;\n};\n\n/**\n * @param  {Number} v\n * @param  {Number|Array<Number>} increment\n * @return {Number}\n */\nconst snap = (v, increment) => isArr(increment) ? increment.reduce((closest, cv) => (abs(cv - v) < abs(closest - v) ? cv : closest)) : increment ? _round(v / increment) * increment : v;\n\n/**\n * @param  {Number} start\n * @param  {Number} end\n * @param  {Number} progress\n * @return {Number}\n */\nconst interpolate = (start, end, progress) => start + (end - start) * progress;\n\n/**\n * @param  {Number} v\n * @return {Number}\n */\nconst clampInfinity = v => v === Infinity ? maxValue : v === -Infinity ? -1e12 : v;\n\n/**\n * @param  {Number} v\n * @return {Number}\n */\nconst normalizeTime = v => v <= minValue ? minValue : clampInfinity(round(v, 11));\n\n// Arrays\n\n/**\n * @template T\n * @param {T[]} a\n * @return {T[]}\n */\nconst cloneArray = a => isArr(a) ? [ ...a ] : a;\n\n// Objects\n\n/**\n * @template T\n * @template U\n * @param {T} o1\n * @param {U} o2\n * @return {T & U}\n */\nconst mergeObjects = (o1, o2) => {\n  const merged = /** @type {T & U} */({ ...o1 });\n  for (let p in o2) {\n    const o1p = /** @type {T & U} */(o1)[p];\n    merged[p] = isUnd(o1p) ? /** @type {T & U} */(o2)[p] : o1p;\n  }  return merged;\n};\n\n// Linked lists\n\n/**\n * @param {Object} parent\n * @param {Function} callback\n * @param {Boolean} [reverse]\n * @param {String} [prevProp]\n * @param {String} [nextProp]\n * @return {void}\n */\nconst forEachChildren = (parent, callback, reverse, prevProp = '_prev', nextProp = '_next') => {\n  let next = parent._head;\n  let adjustedNextProp = nextProp;\n  if (reverse) {\n    next = parent._tail;\n    adjustedNextProp = prevProp;\n  }\n  while (next) {\n    const currentNext = next[adjustedNextProp];\n    callback(next);\n    next = currentNext;\n  }\n};\n\n/**\n * @param  {Object} parent\n * @param  {Object} child\n * @param  {String} [prevProp]\n * @param  {String} [nextProp]\n * @return {void}\n */\nconst removeChild = (parent, child, prevProp = '_prev', nextProp = '_next') => {\n  const prev = child[prevProp];\n  const next = child[nextProp];\n  prev ? prev[nextProp] = next : parent._head = next;\n  next ? next[prevProp] = prev : parent._tail = prev;\n  child[prevProp] = null;\n  child[nextProp] = null;\n};\n\n/**\n * @param  {Object} parent\n * @param  {Object} child\n * @param  {Function} [sortMethod]\n * @param  {String} prevProp\n * @param  {String} nextProp\n * @return {void}\n */\nconst addChild = (parent, child, sortMethod, prevProp = '_prev', nextProp = '_next') => {\n  let prev = parent._tail;\n  while (prev && sortMethod && sortMethod(prev, child)) prev = prev[prevProp];\n  const next = prev ? prev[nextProp] : parent._head;\n  prev ? prev[nextProp] = child : parent._head = child;\n  next ? next[prevProp] = child : parent._tail = child;\n  child[prevProp] = prev;\n  child[nextProp] = next;\n};\n\n/*\n * Base class to control framerate and playback rate.\n * Inherited by Engine, Timer, Animation and Timeline.\n */\nclass Clock {\n\n  /** @param {Number} [initTime] */\n  constructor(initTime = 0) {\n    /** @type {Number} */\n    this.deltaTime = 0;\n    /** @type {Number} */\n    this._currentTime = initTime;\n    /** @type {Number} */\n    this._elapsedTime = initTime;\n    /** @type {Number} */\n    this._startTime = initTime;\n    /** @type {Number} */\n    this._lastTime = initTime;\n    /** @type {Number} */\n    this._scheduledTime = 0;\n    /** @type {Number} */\n    this._frameDuration = round(K / maxFps, 0);\n    /** @type {Number} */\n    this._fps = maxFps;\n    /** @type {Number} */\n    this._speed = 1;\n    /** @type {Boolean} */\n    this._hasChildren = false;\n    /** @type {Tickable|Tween} */\n    this._head = null;\n    /** @type {Tickable|Tween} */\n    this._tail = null;\n  }\n\n  get fps() {\n    return this._fps;\n  }\n\n  set fps(frameRate) {\n    const previousFrameDuration = this._frameDuration;\n    const fr = +frameRate;\n    const fps = fr < minValue ? minValue : fr;\n    const frameDuration = round(K / fps, 0);\n    this._fps = fps;\n    this._frameDuration = frameDuration;\n    this._scheduledTime += frameDuration - previousFrameDuration;\n  }\n\n  get speed() {\n    return this._speed;\n  }\n\n  set speed(playbackRate) {\n    const pbr = +playbackRate;\n    this._speed = pbr < minValue ? minValue : pbr;\n  }\n\n  /**\n   * @param  {Number} time\n   * @return {tickModes}\n   */\n  requestTick(time) {\n    const scheduledTime = this._scheduledTime;\n    const elapsedTime = this._elapsedTime;\n    this._elapsedTime += (time - elapsedTime);\n    // If the elapsed time is lower than the scheduled time\n    // this means not enough time has passed to hit one frameDuration\n    // so skip that frame\n    if (elapsedTime < scheduledTime) return tickModes.NONE;\n    const frameDuration = this._frameDuration;\n    const frameDelta = elapsedTime - scheduledTime;\n    // Ensures that _scheduledTime progresses in steps of at least 1 frameDuration.\n    // Skips ahead if the actual elapsed time is higher.\n    this._scheduledTime += frameDelta < frameDuration ? frameDuration : frameDelta;\n    return tickModes.AUTO;\n  }\n\n  /**\n   * @param  {Number} time\n   * @return {Number}\n   */\n  computeDeltaTime(time) {\n    const delta = time - this._lastTime;\n    this.deltaTime = delta;\n    this._lastTime = time;\n    return delta;\n  }\n\n}\n\n\n\n\n/**\n * @param  {Tickable} tickable\n * @param  {Number} time\n * @param  {Number} muteCallbacks\n * @param  {Number} internalRender\n * @param  {tickModes} tickMode\n * @return {Number}\n */\nconst render = (tickable, time, muteCallbacks, internalRender, tickMode) => {\n\n  const parent = tickable.parent;\n  const duration = tickable.duration;\n  const completed = tickable.completed;\n  const iterationDuration = tickable.iterationDuration;\n  const iterationCount = tickable.iterationCount;\n  const _currentIteration = tickable._currentIteration;\n  const _loopDelay = tickable._loopDelay;\n  const _reversed = tickable._reversed;\n  const _alternate = tickable._alternate;\n  const _hasChildren = tickable._hasChildren;\n  const tickableDelay = tickable._delay;\n  const tickablePrevAbsoluteTime = tickable._currentTime; // TODO: rename ._currentTime to ._absoluteCurrentTime\n\n  const tickableEndTime = tickableDelay + iterationDuration;\n  const tickableAbsoluteTime = time - tickableDelay;\n  const tickablePrevTime = clamp(tickablePrevAbsoluteTime, -tickableDelay, duration);\n  const tickableCurrentTime = clamp(tickableAbsoluteTime, -tickableDelay, duration);\n  const deltaTime = tickableAbsoluteTime - tickablePrevAbsoluteTime;\n  const isCurrentTimeAboveZero = tickableCurrentTime > 0;\n  const isCurrentTimeEqualOrAboveDuration = tickableCurrentTime >= duration;\n  const isSetter = duration <= minValue;\n  const forcedTick = tickMode === tickModes.FORCE;\n\n  let isOdd = 0;\n  let iterationElapsedTime = tickableAbsoluteTime;\n  // Render checks\n  // Used to also check if the children have rendered in order to trigger the onRender callback on the parent timer\n  let hasRendered = 0;\n\n  // Execute the \"expensive\" iterations calculations only when necessary\n  if (iterationCount > 1) {\n    // bitwise NOT operator seems to be generally faster than Math.floor() across browsers\n    const currentIteration = ~~(tickableCurrentTime / (iterationDuration + (isCurrentTimeEqualOrAboveDuration ? 0 : _loopDelay)));\n    tickable._currentIteration = clamp(currentIteration, 0, iterationCount);\n    // Prevent the iteration count to go above the max iterations when reaching the end of the animation\n    if (isCurrentTimeEqualOrAboveDuration) tickable._currentIteration--;\n    isOdd = tickable._currentIteration % 2;\n    iterationElapsedTime = tickableCurrentTime % (iterationDuration + _loopDelay) || 0;\n  }\n\n  // Checks if exactly one of _reversed and (_alternate && isOdd) is true\n  const isReversed = _reversed ^ (_alternate && isOdd);\n  const _ease = /** @type {Renderable} */(tickable)._ease;\n  let iterationTime = isCurrentTimeEqualOrAboveDuration ? isReversed ? 0 : duration : isReversed ? iterationDuration - iterationElapsedTime : iterationElapsedTime;\n  if (_ease) iterationTime = iterationDuration * _ease(iterationTime / iterationDuration) || 0;\n  const isRunningBackwards = (parent ? parent.backwards : tickableAbsoluteTime < tickablePrevAbsoluteTime) ? !isReversed : !!isReversed;\n\n  tickable._currentTime = tickableAbsoluteTime;\n  tickable._iterationTime = iterationTime;\n  tickable.backwards = isRunningBackwards;\n\n  if (isCurrentTimeAboveZero && !tickable.began) {\n    tickable.began = true;\n    if (!muteCallbacks && !(parent && (isRunningBackwards || !parent.began))) {\n      tickable.onBegin(/** @type {CallbackArgument} */(tickable));\n    }\n  } else if (tickableAbsoluteTime <= 0) {\n    tickable.began = false;\n  }\n\n  // Only triggers onLoop for tickable without children, otherwise call the the onLoop callback in the tick function\n  // Make sure to trigger the onLoop before rendering to allow .refresh() to pickup the current values\n  if (!muteCallbacks && !_hasChildren && isCurrentTimeAboveZero && tickable._currentIteration !== _currentIteration) {\n    tickable.onLoop(/** @type {CallbackArgument} */(tickable));\n  }\n\n  if (\n    forcedTick ||\n    tickMode === tickModes.AUTO && (\n      time >= tickableDelay && time <= tickableEndTime || // Normal render\n      time <= tickableDelay && tickablePrevTime > tickableDelay || // Playhead is before the animation start time so make sure the animation is at its initial state\n      time >= tickableEndTime && tickablePrevTime !== duration // Playhead is after the animation end time so make sure the animation is at its end state\n    ) ||\n    iterationTime >= tickableEndTime && tickablePrevTime !== duration ||\n    iterationTime <= tickableDelay && tickablePrevTime > 0 ||\n    time <= tickablePrevTime && tickablePrevTime === duration && completed || // Force a render if a seek occurs on an completed animation\n    isCurrentTimeEqualOrAboveDuration && !completed && isSetter // This prevents 0 duration tickables to be skipped\n  ) {\n\n    if (isCurrentTimeAboveZero) {\n      // Trigger onUpdate callback before rendering\n      tickable.computeDeltaTime(tickablePrevTime);\n      if (!muteCallbacks) tickable.onBeforeUpdate(/** @type {CallbackArgument} */(tickable));\n    }\n\n    // Start tweens rendering\n    if (!_hasChildren) {\n\n      // Time has jumped more than globals.tickThreshold so consider this tick manual\n      const forcedRender = forcedTick || (isRunningBackwards ? deltaTime * -1 : deltaTime) >= globals.tickThreshold;\n      const absoluteTime = tickable._offset + (parent ? parent._offset : 0) + tickableDelay + iterationTime;\n\n      // Only Animation can have tweens, Timer returns undefined\n      let tween = /** @type {Tween} */(/** @type {JSAnimation} */(tickable)._head);\n      let tweenTarget;\n      let tweenStyle;\n      let tweenTargetTransforms;\n      let tweenTargetTransformsProperties;\n      let tweenTransformsNeedUpdate = 0;\n\n      while (tween) {\n\n        const tweenComposition = tween._composition;\n        const tweenCurrentTime = tween._currentTime;\n        const tweenChangeDuration = tween._changeDuration;\n        const tweenAbsEndTime = tween._absoluteStartTime + tween._changeDuration;\n        const tweenNextRep = tween._nextRep;\n        const tweenPrevRep = tween._prevRep;\n        const tweenHasComposition = tweenComposition !== compositionTypes.none;\n\n        if ((forcedRender || (\n            (tweenCurrentTime !== tweenChangeDuration || absoluteTime <= tweenAbsEndTime + (tweenNextRep ? tweenNextRep._delay : 0)) &&\n            (tweenCurrentTime !== 0 || absoluteTime >= tween._absoluteStartTime)\n          )) && (!tweenHasComposition || (\n            !tween._isOverridden &&\n            (!tween._isOverlapped || absoluteTime <= tweenAbsEndTime) &&\n            (!tweenNextRep || (tweenNextRep._isOverridden || absoluteTime <= tweenNextRep._absoluteStartTime)) &&\n            (!tweenPrevRep || (tweenPrevRep._isOverridden || (absoluteTime >= (tweenPrevRep._absoluteStartTime + tweenPrevRep._changeDuration) + tween._delay)))\n          ))\n        ) {\n\n          const tweenNewTime = tween._currentTime = clamp(iterationTime - tween._startTime, 0, tweenChangeDuration);\n          const tweenProgress = tween._ease(tweenNewTime / tween._updateDuration);\n          const tweenModifier = tween._modifier;\n          const tweenValueType = tween._valueType;\n          const tweenType = tween._tweenType;\n          const tweenIsObject = tweenType === tweenTypes.OBJECT;\n          const tweenIsNumber = tweenValueType === valueTypes.NUMBER;\n          // Only round the in-between frames values if the final value is a string\n          const tweenPrecision = (tweenIsNumber && tweenIsObject) || tweenProgress === 0 || tweenProgress === 1 ? -1 : globals.precision;\n\n          // Recompose tween value\n          /** @type {String|Number} */\n          let value;\n          /** @type {Number} */\n          let number;\n\n          if (tweenIsNumber) {\n            value = number = /** @type {Number} */(tweenModifier(round(interpolate(tween._fromNumber, tween._toNumber,  tweenProgress), tweenPrecision )));\n          } else if (tweenValueType === valueTypes.UNIT) {\n            // Rounding the values speed up string composition\n            number = /** @type {Number} */(tweenModifier(round(interpolate(tween._fromNumber, tween._toNumber,  tweenProgress), tweenPrecision)));\n            value = `${number}${tween._unit}`;\n          } else if (tweenValueType === valueTypes.COLOR) {\n            const fn = tween._fromNumbers;\n            const tn = tween._toNumbers;\n            const r = round(clamp(/** @type {Number} */(tweenModifier(interpolate(fn[0], tn[0], tweenProgress))), 0, 255), 0);\n            const g = round(clamp(/** @type {Number} */(tweenModifier(interpolate(fn[1], tn[1], tweenProgress))), 0, 255), 0);\n            const b = round(clamp(/** @type {Number} */(tweenModifier(interpolate(fn[2], tn[2], tweenProgress))), 0, 255), 0);\n            const a = clamp(/** @type {Number} */(tweenModifier(round(interpolate(fn[3], tn[3], tweenProgress), tweenPrecision))), 0, 1);\n            value = `rgba(${r},${g},${b},${a})`;\n            if (tweenHasComposition) {\n              const ns = tween._numbers;\n              ns[0] = r;\n              ns[1] = g;\n              ns[2] = b;\n              ns[3] = a;\n            }\n          } else if (tweenValueType === valueTypes.COMPLEX) {\n            value = tween._strings[0];\n            for (let j = 0, l = tween._toNumbers.length; j < l; j++) {\n              const n = /** @type {Number} */(tweenModifier(round(interpolate(tween._fromNumbers[j], tween._toNumbers[j], tweenProgress), tweenPrecision)));\n              const s = tween._strings[j + 1];\n              value += `${s ? n + s : n}`;\n              if (tweenHasComposition) {\n                tween._numbers[j] = n;\n              }\n            }\n          }\n\n          // For additive tweens and Animatables\n          if (tweenHasComposition) {\n            tween._number = number;\n          }\n\n          if (!internalRender && tweenComposition !== compositionTypes.blend) {\n\n            const tweenProperty = tween.property;\n            tweenTarget = tween.target;\n\n            if (tweenIsObject) {\n              tweenTarget[tweenProperty] = value;\n            } else if (tweenType === tweenTypes.ATTRIBUTE) {\n              /** @type {DOMTarget} */(tweenTarget).setAttribute(tweenProperty, /** @type {String} */(value));\n            } else {\n              tweenStyle = /** @type {DOMTarget} */(tweenTarget).style;\n              if (tweenType === tweenTypes.TRANSFORM) {\n                if (tweenTarget !== tweenTargetTransforms) {\n                  tweenTargetTransforms = tweenTarget;\n                  // NOTE: Referencing the cachedTransforms in the tween property directly can be a little bit faster but appears to increase memory usage.\n                  tweenTargetTransformsProperties = tweenTarget[transformsSymbol];\n                }\n                tweenTargetTransformsProperties[tweenProperty] = value;\n                tweenTransformsNeedUpdate = 1;\n              } else if (tweenType === tweenTypes.CSS) {\n                tweenStyle[tweenProperty] = value;\n              } else if (tweenType === tweenTypes.CSS_VAR) {\n                tweenStyle.setProperty(tweenProperty,/** @type {String} */(value));\n              }\n            }\n\n            if (isCurrentTimeAboveZero) hasRendered = 1;\n\n          } else {\n            // Used for composing timeline tweens without having to do a real render\n            tween._value = value;\n          }\n\n        }\n\n        // NOTE: Possible improvement: Use translate(x,y) / translate3d(x,y,z) syntax\n        // to reduce memory usage on string composition\n        if (tweenTransformsNeedUpdate && tween._renderTransforms) {\n          let str = emptyString;\n          for (let key in tweenTargetTransformsProperties) {\n            str += `${transformsFragmentStrings[key]}${tweenTargetTransformsProperties[key]}) `;\n          }\n          tweenStyle.transform = str;\n          tweenTransformsNeedUpdate = 0;\n        }\n\n        tween = tween._next;\n      }\n\n      if (!muteCallbacks && hasRendered) {\n        /** @type {JSAnimation} */(tickable).onRender(/** @type {JSAnimation} */(tickable));\n      }\n    }\n\n    if (!muteCallbacks && isCurrentTimeAboveZero) {\n      tickable.onUpdate(/** @type {CallbackArgument} */(tickable));\n    }\n\n  }\n\n  // End tweens rendering\n\n  // Handle setters on timeline differently and allow re-trigering the onComplete callback when seeking backwards\n  if (parent && isSetter) {\n    if (!muteCallbacks && (\n      (parent.began && !isRunningBackwards && tickableAbsoluteTime >= duration && !completed) ||\n      (isRunningBackwards && tickableAbsoluteTime <= minValue && completed)\n    )) {\n      tickable.onComplete(/** @type {CallbackArgument} */(tickable));\n      tickable.completed = !isRunningBackwards;\n    }\n  // If currentTime is both above 0 and at least equals to duration, handles normal onComplete or infinite loops\n  } else if (isCurrentTimeAboveZero && isCurrentTimeEqualOrAboveDuration) {\n    if (iterationCount === Infinity) {\n      // Offset the tickable _startTime with its duration to reset _currentTime to 0 and continue the infinite timer\n      tickable._startTime += tickable.duration;\n    } else if (tickable._currentIteration >= iterationCount - 1) {\n      // By setting paused to true, we tell the engine loop to not render this tickable and removes it from the list on the next tick\n      tickable.paused = true;\n      if (!completed && !_hasChildren) {\n        // If the tickable has children, triggers onComplete() only when all children have completed in the tick function\n        tickable.completed = true;\n        if (!muteCallbacks && !(parent && (isRunningBackwards || !parent.began))) {\n          tickable.onComplete(/** @type {CallbackArgument} */(tickable));\n          tickable._resolve(/** @type {CallbackArgument} */(tickable));\n        }\n      }\n    }\n  // Otherwise set the completed flag to false\n  } else {\n    tickable.completed = false;\n  }\n\n  // NOTE: hasRendered * direction (negative for backwards) this way we can remove the tickable.backwards property completly ?\n  return hasRendered;\n};\n\n/**\n * @param  {Tickable} tickable\n * @param  {Number} time\n * @param  {Number} muteCallbacks\n * @param  {Number} internalRender\n * @param  {Number} tickMode\n * @return {void}\n */\nconst tick = (tickable, time, muteCallbacks, internalRender, tickMode) => {\n  const _currentIteration = tickable._currentIteration;\n  render(tickable, time, muteCallbacks, internalRender, tickMode);\n  if (tickable._hasChildren) {\n    const tl = /** @type {Timeline} */(tickable);\n    const tlIsRunningBackwards = tl.backwards;\n    const tlChildrenTime = internalRender ? time : tl._iterationTime;\n    const tlCildrenTickTime = now();\n\n    let tlChildrenHasRendered = 0;\n    let tlChildrenHaveCompleted = true;\n\n    // If the timeline has looped forward, we need to manually triggers children skipped callbacks\n    if (!internalRender && tl._currentIteration !== _currentIteration) {\n      const tlIterationDuration = tl.iterationDuration;\n      forEachChildren(tl, (/** @type {JSAnimation} */child) => {\n        if (!tlIsRunningBackwards) {\n          // Force an internal render to trigger the callbacks if the child has not completed on loop\n          if (!child.completed && !child.backwards && child._currentTime < child.iterationDuration) {\n            render(child, tlIterationDuration, muteCallbacks, 1, tickModes.FORCE);\n          }\n          // Reset their began and completed flags to allow retrigering callbacks on the next iteration\n          child.began = false;\n          child.completed = false;\n        } else {\n          const childDuration = child.duration;\n          const childStartTime = child._offset + child._delay;\n          const childEndTime = childStartTime + childDuration;\n          // Triggers the onComplete callback on reverse for children on the edges of the timeline\n          if (!muteCallbacks && childDuration <= minValue && (!childStartTime || childEndTime === tlIterationDuration)) {\n            child.onComplete(child);\n          }\n        }\n      });\n      if (!muteCallbacks) tl.onLoop(/** @type {CallbackArgument} */(tl));\n    }\n\n    forEachChildren(tl, (/** @type {JSAnimation} */child) => {\n      const childTime = round((tlChildrenTime - child._offset) * child._speed, 12); // Rounding is needed when using seconds\n      const childTickMode = child._fps < tl._fps ? child.requestTick(tlCildrenTickTime) : tickMode;\n      tlChildrenHasRendered += render(child, childTime, muteCallbacks, internalRender, childTickMode);\n      if (!child.completed && tlChildrenHaveCompleted) tlChildrenHaveCompleted = false;\n    }, tlIsRunningBackwards);\n\n    // Renders on timeline are triggered by its children so it needs to be set after rendering the children\n    if (!muteCallbacks && tlChildrenHasRendered) tl.onRender(/** @type {CallbackArgument} */(tl));\n\n    // Triggers the timeline onComplete() once all chindren all completed and the current time has reached the end\n    if (tlChildrenHaveCompleted && tl._currentTime >= tl.duration) {\n      // Make sure the paused flag is false in case it has been skipped in the render function\n      tl.paused = true;\n      if (!tl.completed) {\n        tl.completed = true;\n        if (!muteCallbacks) {\n          tl.onComplete(/** @type {CallbackArgument} */(tl));\n          tl._resolve(/** @type {CallbackArgument} */(tl));\n        }\n      }\n    }\n  }\n};\n\n\n\n\nconst additive = {\n  animation: null,\n  update: noop,\n};\n\n/**\n * @typedef AdditiveAnimation\n * @property {Number} duration\n * @property {Number} _offset\n * @property {Number} _delay\n * @property {Tween} _head\n * @property {Tween} _tail\n */\n\n/**\n * @param  {TweenAdditiveLookups} lookups\n * @return {AdditiveAnimation}\n */\nconst addAdditiveAnimation = lookups => {\n  let animation = additive.animation;\n  if (!animation) {\n    animation = {\n      duration: minValue,\n      computeDeltaTime: noop,\n      _offset: 0,\n      _delay: 0,\n      _head: null,\n      _tail: null,\n    };\n    additive.animation = animation;\n    additive.update = () => {\n      lookups.forEach(propertyAnimation => {\n        for (let propertyName in propertyAnimation) {\n          const tweens = propertyAnimation[propertyName];\n          const lookupTween = tweens._head;\n          if (lookupTween) {\n            const valueType = lookupTween._valueType;\n            const additiveValues = valueType === valueTypes.COMPLEX || valueType === valueTypes.COLOR ? cloneArray(lookupTween._fromNumbers) : null;\n            let additiveValue = lookupTween._fromNumber;\n            let tween = tweens._tail;\n            while (tween && tween !== lookupTween) {\n              if (additiveValues) {\n                for (let i = 0, l = tween._numbers.length; i < l; i++) additiveValues[i] += tween._numbers[i];\n              } else {\n                additiveValue += tween._number;\n              }\n              tween = tween._prevAdd;\n            }\n            lookupTween._toNumber = additiveValue;\n            lookupTween._toNumbers = additiveValues;\n          }\n        }\n      });\n      // TODO: Avoid polymorphism here, idealy the additive animation should be a regular animation with a higher priority in the render loop\n      render(animation, 1, 1, 0, tickModes.FORCE);\n    };\n  }\n  return animation;\n};\n\nconst engineTickMethod = isBrowser ? requestAnimationFrame : setImmediate;\nconst engineCancelMethod = isBrowser ? cancelAnimationFrame : clearImmediate;\n\nclass Engine extends Clock {\n\n  /** @param {Number} [initTime] */\n  constructor(initTime) {\n    super(initTime);\n    this.useDefaultMainLoop = true;\n    this.pauseOnDocumentHidden = true;\n    /** @type {DefaultsParams} */\n    this.defaults = defaults;\n    this.paused = isBrowser && doc.hidden ? true  : false;\n    /** @type {Number|NodeJS.Immediate} */\n    this.reqId = null;\n  }\n\n  update() {\n    const time = this._currentTime = now();\n    if (this.requestTick(time)) {\n      this.computeDeltaTime(time);\n      const engineSpeed = this._speed;\n      const engineFps = this._fps;\n      let activeTickable = /** @type {Tickable} */(this._head);\n      while (activeTickable) {\n        const nextTickable = activeTickable._next;\n        if (!activeTickable.paused) {\n          tick(\n            activeTickable,\n            (time - activeTickable._startTime) * activeTickable._speed * engineSpeed,\n            0, // !muteCallbacks\n            0, // !internalRender\n            activeTickable._fps < engineFps ? activeTickable.requestTick(time) : tickModes.AUTO\n          );\n        } else {\n          removeChild(this, activeTickable);\n          this._hasChildren = !!this._tail;\n          activeTickable._running = false;\n          if (activeTickable.completed && !activeTickable._cancelled) {\n            activeTickable.cancel();\n          }\n        }\n        activeTickable = nextTickable;\n      }\n      additive.update();\n    }\n  }\n\n  wake() {\n    if (this.useDefaultMainLoop && !this.reqId && !this.paused) {\n      this.reqId = engineTickMethod(tickEngine);\n    }\n    return this;\n  }\n\n  pause() {\n    this.paused = true;\n    return killEngine();\n  }\n\n  resume() {\n    if (!this.paused) return;\n    this.paused = false;\n    forEachChildren(this, (/** @type {Tickable} */child) => child.resetTime());\n    return this.wake();\n  }\n\n  // Getter and setter for speed\n  get speed() {\n    return this._speed * (globals.timeScale === 1 ? 1 : K);\n  }\n\n  set speed(playbackRate) {\n    this._speed = playbackRate * globals.timeScale;\n    forEachChildren(this, (/** @type {Tickable} */child) => child.speed = child._speed);\n  }\n\n  // Getter and setter for timeUnit\n  get timeUnit() {\n    return globals.timeScale === 1 ? 'ms' : 's';\n  };\n\n  set timeUnit(unit) {\n    const secondsScale = 0.001;\n    const isSecond = unit === 's';\n    const newScale = isSecond ? secondsScale : 1;\n    if (globals.timeScale !== newScale) {\n      globals.timeScale = newScale;\n      globals.tickThreshold = 200 * newScale;\n      const scaleFactor = isSecond ? secondsScale : K;\n      /** @type {Number} */\n      (this.defaults.duration) *= scaleFactor;\n      this._speed *= scaleFactor;\n    }\n  }\n\n  // Getter and setter for precision\n  get precision() {\n    return globals.precision;\n  }\n\n  set precision(precision) {\n    globals.precision = precision;\n  }\n\n}\nconst engine = /*#__PURE__*/(() => {\n  const engine = new Engine(now());\n  if (isBrowser) {\n    globalVersions.engine = engine;\n    doc.addEventListener('visibilitychange', () => {\n      if (!engine.pauseOnDocumentHidden) return;\n      doc.hidden ? engine.pause() : engine.resume();\n    });\n  }\n  return engine;\n})();\n\n\nconst tickEngine = () => {\n  if (engine._head) {\n    engine.reqId = engineTickMethod(tickEngine);\n    engine.update();\n  } else {\n    engine.reqId = 0;\n  }\n};\n\nconst killEngine = () => {\n  engineCancelMethod(/** @type {NodeJS.Immediate & Number} */(engine.reqId));\n  engine.reqId = 0;\n  return engine;\n};\n\n\n\n\n/**\n * @param  {DOMTarget} target\n * @param  {String} propName\n * @param  {Object} animationInlineStyles\n * @return {String}\n */\nconst parseInlineTransforms = (target, propName, animationInlineStyles) => {\n  const inlineTransforms = target.style.transform;\n  let inlinedStylesPropertyValue;\n  if (inlineTransforms) {\n    const cachedTransforms = target[transformsSymbol];\n    let t; while (t = transformsExecRgx.exec(inlineTransforms)) {\n      const inlinePropertyName = t[1];\n      // const inlinePropertyValue = t[2];\n      const inlinePropertyValue = t[2].slice(1, -1);\n      cachedTransforms[inlinePropertyName] = inlinePropertyValue;\n      if (inlinePropertyName === propName) {\n        inlinedStylesPropertyValue = inlinePropertyValue;\n        // Store the new parsed inline styles if animationInlineStyles is provided\n        if (animationInlineStyles) {\n          animationInlineStyles[propName] = inlinePropertyValue;\n        }\n      }\n    }\n  }\n  return inlineTransforms && !isUnd(inlinedStylesPropertyValue) ? inlinedStylesPropertyValue :\n    stringStartsWith(propName, 'scale') ? '1' :\n    stringStartsWith(propName, 'rotate') || stringStartsWith(propName, 'skew') ? '0deg' : '0px';\n};\n\n\n\n\n/**\n * @param  {DOMTargetsParam|TargetsParam} v\n * @return {NodeList|HTMLCollection}\n */\nfunction getNodeList(v) {\n  const n = isStr(v) ? globals.root.querySelectorAll(v) : v;\n  if (n instanceof NodeList || n instanceof HTMLCollection) return n;\n}\n\n/**\n * @overload\n * @param  {DOMTargetsParam} targets\n * @return {DOMTargetsArray}\n *\n * @overload\n * @param  {JSTargetsParam} targets\n * @return {JSTargetsArray}\n *\n * @overload\n * @param  {TargetsParam} targets\n * @return {TargetsArray}\n *\n * @param  {DOMTargetsParam|JSTargetsParam|TargetsParam} targets\n */\nfunction parseTargets(targets) {\n  if (isNil(targets)) return /** @type {TargetsArray} */([]);\n  if (isArr(targets)) {\n    const flattened = targets.flat(Infinity);\n    /** @type {TargetsArray} */\n    const parsed = [];\n    for (let i = 0, l = flattened.length; i < l; i++) {\n      const item = flattened[i];\n      if (!isNil(item)) {\n        const nodeList = getNodeList(item);\n        if (nodeList) {\n          for (let j = 0, jl = nodeList.length; j < jl; j++) {\n            const subItem = nodeList[j];\n            if (!isNil(subItem)) {\n              let isDuplicate = false;\n              for (let k = 0, kl = parsed.length; k < kl; k++) {\n                if (parsed[k] === subItem) {\n                  isDuplicate = true;\n                  break;\n                }\n              }\n              if (!isDuplicate) {\n                parsed.push(subItem);\n              }\n            }\n          }\n        } else {\n          let isDuplicate = false;\n          for (let j = 0, jl = parsed.length; j < jl; j++) {\n            if (parsed[j] === item) {\n              isDuplicate = true;\n              break;\n            }\n          }\n          if (!isDuplicate) {\n            parsed.push(item);\n          }\n        }\n      }\n    }\n    return parsed;\n  }\n  if (!isBrowser) return /** @type {JSTargetsArray} */([targets]);\n  const nodeList = getNodeList(targets);\n  if (nodeList) return /** @type {DOMTargetsArray} */(Array.from(nodeList));\n  return /** @type {TargetsArray} */([targets]);\n}\n\n/**\n * @overload\n * @param  {DOMTargetsParam} targets\n * @return {DOMTargetsArray}\n *\n * @overload\n * @param  {JSTargetsParam} targets\n * @return {JSTargetsArray}\n *\n * @overload\n * @param  {TargetsParam} targets\n * @return {TargetsArray}\n *\n * @param  {DOMTargetsParam|JSTargetsParam|TargetsParam} targets\n */\nfunction registerTargets(targets) {\n  const parsedTargetsArray = parseTargets(targets);\n  const parsedTargetsLength = parsedTargetsArray.length;\n  if (parsedTargetsLength) {\n    for (let i = 0; i < parsedTargetsLength; i++) {\n      const target = parsedTargetsArray[i];\n      if (!target[isRegisteredTargetSymbol]) {\n        target[isRegisteredTargetSymbol] = true;\n        const isSvgType = isSvg(target);\n        const isDom = /** @type {DOMTarget} */(target).nodeType || isSvgType;\n        if (isDom) {\n          target[isDomSymbol] = true;\n          target[isSvgSymbol] = isSvgType;\n          target[transformsSymbol] = {};\n        }\n      }\n    }\n  }\n  return parsedTargetsArray;\n}\n\n\n\n\n/**\n * @param  {TargetsParam} path\n * @return {SVGGeometryElement|undefined}\n */\nconst getPath = path => {\n  const parsedTargets = parseTargets(path);\n  const $parsedSvg = /** @type {SVGGeometryElement} */(parsedTargets[0]);\n  if (!$parsedSvg || !isSvg($parsedSvg)) return;\n  return $parsedSvg;\n};\n\n/**\n * @param  {TargetsParam} path2\n * @param  {Number} [precision]\n * @return {FunctionValue}\n */\nconst morphTo = (path2, precision = .33) => ($path1) => {\n  const $path2 = /** @type {SVGGeometryElement} */(getPath(path2));\n  if (!$path2) return;\n  const isPath = $path1.tagName === 'path';\n  const separator = isPath ? ' ' : ',';\n  const previousPoints = $path1[morphPointsSymbol];\n  if (previousPoints) $path1.setAttribute(isPath ? 'd' : 'points', previousPoints);\n\n  let v1 = '', v2 = '';\n\n  if (!precision) {\n    v1 = $path1.getAttribute(isPath ? 'd' : 'points');\n    v2 = $path2.getAttribute(isPath ? 'd' : 'points');\n  } else {\n    const length1 = /** @type {SVGGeometryElement} */($path1).getTotalLength();\n    const length2 = $path2.getTotalLength();\n    const maxPoints = Math.max(Math.ceil(length1 * precision), Math.ceil(length2 * precision));\n    for (let i = 0; i < maxPoints; i++) {\n      const t = i / (maxPoints - 1);\n      const pointOnPath1 = /** @type {SVGGeometryElement} */($path1).getPointAtLength(length1 * t);\n      const pointOnPath2 = $path2.getPointAtLength(length2 * t);\n      const prefix = isPath ? (i === 0 ? 'M' : 'L') : '';\n      v1 += prefix + round(pointOnPath1.x, 3) + separator + pointOnPath1.y + ' ';\n      v2 += prefix + round(pointOnPath2.x, 3) + separator + pointOnPath2.y + ' ';\n    }\n  }\n\n  $path1[morphPointsSymbol] = v2;\n\n  return [v1, v2];\n};\n\n/**\n * @param {SVGGeometryElement} [$el]\n * @return {Number}\n */\nconst getScaleFactor = $el => {\n  let scaleFactor = 1;\n  if ($el && $el.getCTM) {\n    const ctm = $el.getCTM();\n    if (ctm) {\n      const scaleX = sqrt(ctm.a * ctm.a + ctm.b * ctm.b);\n      const scaleY = sqrt(ctm.c * ctm.c + ctm.d * ctm.d);\n      scaleFactor = (scaleX + scaleY) / 2;\n    }\n  }\n  return scaleFactor;\n};\n\n/**\n * Creates a proxy that wraps an SVGGeometryElement and adds drawing functionality.\n * @param {SVGGeometryElement} $el - The SVG element to transform into a drawable\n * @param {number} start - Starting position (0-1)\n * @param {number} end - Ending position (0-1)\n * @return {DrawableSVGGeometry} - Returns a proxy that preserves the original element's type with additional 'draw' attribute functionality\n */\nconst createDrawableProxy = ($el, start, end) => {\n  const pathLength = K;\n  const computedStyles = getComputedStyle($el);\n  const strokeLineCap = computedStyles.strokeLinecap;\n  // @ts-ignore\n  const $scalled = computedStyles.vectorEffect === 'non-scaling-stroke' ? $el : null;\n  let currentCap = strokeLineCap;\n\n  const proxy = new Proxy($el, {\n    get(target, property) {\n      const value = target[property];\n      if (property === proxyTargetSymbol) return target;\n      if (property === 'setAttribute') {\n        return (...args) => {\n          if (args[0] === 'draw') {\n            const value = args[1];\n            const values = value.split(' ');\n            const v1 = +values[0];\n            const v2 = +values[1];\n            // TOTO: Benchmark if performing two slices is more performant than one split\n            // const spaceIndex = value.indexOf(' ');\n            // const v1 = round(+value.slice(0, spaceIndex), precision);\n            // const v2 = round(+value.slice(spaceIndex + 1), precision);\n            const scaleFactor = getScaleFactor($scalled);\n            const os = v1 * -1e3 * scaleFactor;\n            const d1 = (v2 * pathLength * scaleFactor) + os;\n            const d2 = (pathLength * scaleFactor +\n                      ((v1 === 0 && v2 === 1) || (v1 === 1 && v2 === 0) ? 0 : 10 * scaleFactor) - d1);\n            if (strokeLineCap !== 'butt') {\n              const newCap = v1 === v2 ? 'butt' : strokeLineCap;\n              if (currentCap !== newCap) {\n                target.style.strokeLinecap = `${newCap}`;\n                currentCap = newCap;\n              }\n            }\n            target.setAttribute('stroke-dashoffset', `${os}`);\n            target.setAttribute('stroke-dasharray', `${d1} ${d2}`);\n          }\n          return Reflect.apply(value, target, args);\n        };\n      }\n\n      if (isFnc(value)) {\n        return (...args) => Reflect.apply(value, target, args);\n      } else {\n        return value;\n      }\n    }\n  });\n\n  if ($el.getAttribute('pathLength') !== `${pathLength}`) {\n    $el.setAttribute('pathLength', `${pathLength}`);\n    proxy.setAttribute('draw', `${start} ${end}`);\n  }\n\n  return /** @type {DrawableSVGGeometry} */(proxy);\n};\n\n/**\n * Creates drawable proxies for multiple SVG elements.\n * @param {TargetsParam} selector - CSS selector, SVG element, or array of elements and selectors\n * @param {number} [start=0] - Starting position (0-1)\n * @param {number} [end=0] - Ending position (0-1)\n * @return {Array<DrawableSVGGeometry>} - Array of proxied elements with drawing functionality\n */\nconst createDrawable = (selector, start = 0, end = 0) => {\n  const els = parseTargets(selector);\n  return els.map($el => createDrawableProxy(\n    /** @type {SVGGeometryElement} */($el),\n    start,\n    end\n  ));\n};\n\n// Motion path animation\n\n/**\n * @param {SVGGeometryElement} $path\n * @param {Number} progress\n * @param {Number}lookup\n * @return {DOMPoint}\n */\nconst getPathPoint = ($path, progress, lookup = 0) => {\n  return $path.getPointAtLength(progress + lookup >= 1 ? progress + lookup : 0);\n};\n\n/**\n * @param {SVGGeometryElement} $path\n * @param {String} pathProperty\n * @return {FunctionValue}\n */\nconst getPathProgess = ($path, pathProperty) => {\n  return $el => {\n    const totalLength = +($path.getTotalLength());\n    const inSvg = $el[isSvgSymbol];\n    const ctm = $path.getCTM();\n    /** @type {TweenObjectValue} */\n    return {\n      from: 0,\n      to: totalLength,\n      /** @type {TweenModifier} */\n      modifier: progress => {\n        if (pathProperty === 'a') {\n          const p0 = getPathPoint($path, progress, -1);\n          const p1 = getPathPoint($path, progress, 1);\n          return atan2(p1.y - p0.y, p1.x - p0.x) * 180 / PI;\n        } else {\n          const p = getPathPoint($path, progress, 0);\n          return pathProperty === 'x' ?\n            inSvg || !ctm ? p.x : p.x * ctm.a + p.y * ctm.c + ctm.e :\n            inSvg || !ctm ? p.y : p.x * ctm.b + p.y * ctm.d + ctm.f\n        }\n      }\n    }\n  }\n};\n\n/**\n * @param {TargetsParam} path\n */\nconst createMotionPath = path => {\n  const $path = getPath(path);\n  if (!$path) return;\n  return {\n    translateX: getPathProgess($path, 'x'),\n    translateY: getPathProgess($path, 'y'),\n    rotate: getPathProgess($path, 'a'),\n  }\n};\n\n// Check for valid SVG attribute\n\nconst cssReservedProperties = ['opacity', 'rotate', 'overflow', 'color'];\n\n/**\n * @param  {Target} el\n * @param  {String} propertyName\n * @return {Boolean}\n */\nconst isValidSVGAttribute = (el, propertyName) => {\n  // Return early and use CSS opacity animation instead (already better default values (opacity: 1 instead of 0)) and rotate should be considered a transform\n  if (cssReservedProperties.includes(propertyName)) return false;\n  if (el.getAttribute(propertyName) || propertyName in el) {\n    if (propertyName === 'scale') { // Scale\n      const elParentNode = /** @type {SVGGeometryElement} */(/** @type {DOMTarget} */(el).parentNode);\n      // Only consider scale as a valid SVG attribute on filter element\n      return elParentNode && elParentNode.tagName === 'filter';\n    }\n    return true;\n  }\n};\n\nconst svg = {\n  morphTo,\n  createMotionPath,\n  createDrawable,\n};\n\n\n\n\n/**\n * RGB / RGBA Color value string -> RGBA values array\n * @param  {String} rgbValue\n * @return {ColorArray}\n */\nconst rgbToRgba = rgbValue => {\n  const rgba = rgbExecRgx.exec(rgbValue) || rgbaExecRgx.exec(rgbValue);\n  const a = !isUnd(rgba[4]) ? +rgba[4] : 1;\n  return [\n    +rgba[1],\n    +rgba[2],\n    +rgba[3],\n    a\n  ]\n};\n\n/**\n * HEX3 / HEX3A / HEX6 / HEX6A Color value string -> RGBA values array\n * @param  {String} hexValue\n * @return {ColorArray}\n */\nconst hexToRgba = hexValue => {\n  const hexLength = hexValue.length;\n  const isShort = hexLength === 4 || hexLength === 5;\n  return [\n    +('0x' + hexValue[1] + hexValue[isShort ? 1 : 2]),\n    +('0x' + hexValue[isShort ? 2 : 3] + hexValue[isShort ? 2 : 4]),\n    +('0x' + hexValue[isShort ? 3 : 5] + hexValue[isShort ? 3 : 6]),\n    ((hexLength === 5 || hexLength === 9) ? +(+('0x' + hexValue[isShort ? 4 : 7] + hexValue[isShort ? 4 : 8]) / 255).toFixed(3) : 1)\n  ]\n};\n\n/**\n * @param  {Number} p\n * @param  {Number} q\n * @param  {Number} t\n * @return {Number}\n */\nconst hue2rgb = (p, q, t) => {\n  if (t < 0) t += 1;\n  if (t > 1) t -= 1;\n  return t < 1 / 6 ? p + (q - p) * 6 * t :\n         t < 1 / 2 ? q :\n         t < 2 / 3 ? p + (q - p) * (2 / 3 - t) * 6 :\n         p;\n};\n\n/**\n * HSL / HSLA Color value string -> RGBA values array\n * @param  {String} hslValue\n * @return {ColorArray}\n */\nconst hslToRgba = hslValue => {\n  const hsla = hslExecRgx.exec(hslValue) || hslaExecRgx.exec(hslValue);\n  const h = +hsla[1] / 360;\n  const s = +hsla[2] / 100;\n  const l = +hsla[3] / 100;\n  const a = !isUnd(hsla[4]) ? +hsla[4] : 1;\n  let r, g, b;\n  if (s === 0) {\n    r = g = b = l;\n  } else {\n    const q = l < .5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n    r = round(hue2rgb(p, q, h + 1 / 3) * 255, 0);\n    g = round(hue2rgb(p, q, h) * 255, 0);\n    b = round(hue2rgb(p, q, h - 1 / 3) * 255, 0);\n  }\n  return [r, g, b, a];\n};\n\n/**\n * All in one color converter that converts a color string value into an array of RGBA values\n * @param  {String} colorString\n * @return {ColorArray}\n */\nconst convertColorStringValuesToRgbaArray = colorString => {\n  return isRgb(colorString) ? rgbToRgba(colorString) :\n         isHex(colorString) ? hexToRgba(colorString) :\n         isHsl(colorString) ? hslToRgba(colorString) :\n         [0, 0, 0, 1];\n};\n\n\n\n\n/**\n * @template T, D\n * @param {T|undefined} targetValue\n * @param {D} defaultValue\n * @return {T|D}\n */\nconst setValue = (targetValue, defaultValue) => {\n  return isUnd(targetValue) ? defaultValue : targetValue;\n};\n\n/**\n * @param  {TweenPropValue} value\n * @param  {Target} target\n * @param  {Number} index\n * @param  {Number} total\n * @param  {Object} [store]\n * @return {any}\n */\nconst getFunctionValue = (value, target, index, total, store) => {\n  if (isFnc(value)) {\n    const func = () => {\n      const computed = /** @type {Function} */(value)(target, index, total);\n      // Fallback to 0 if the function returns undefined / NaN / null / false / 0\n      return !isNaN(+computed) ? +computed : computed || 0;\n    };\n    if (store) {\n      store.func = func;\n    }\n    return func();\n  } else {\n    return value;\n  }\n};\n\n/**\n * @param  {Target} target\n * @param  {String} prop\n * @return {tweenTypes}\n */\nconst getTweenType = (target, prop) => {\n  return !target[isDomSymbol] ? tweenTypes.OBJECT :\n    // Handle SVG attributes\n    target[isSvgSymbol] && isValidSVGAttribute(target, prop) ? tweenTypes.ATTRIBUTE :\n    // Handle CSS Transform properties differently than CSS to allow individual animations\n    validTransforms.includes(prop) || shortTransforms.get(prop) ? tweenTypes.TRANSFORM :\n    // CSS variables\n    stringStartsWith(prop, '--') ? tweenTypes.CSS_VAR :\n    // All other CSS properties\n    prop in /** @type {DOMTarget} */(target).style ? tweenTypes.CSS :\n    // Handle other DOM Attributes\n    prop in target ? tweenTypes.OBJECT :\n    tweenTypes.ATTRIBUTE;\n};\n\n/**\n * @param  {DOMTarget} target\n * @param  {String} propName\n * @param  {Object} animationInlineStyles\n * @return {String}\n */\nconst getCSSValue = (target, propName, animationInlineStyles) => {\n  const inlineStyles = target.style[propName];\n  if (inlineStyles && animationInlineStyles) {\n    animationInlineStyles[propName] = inlineStyles;\n  }\n  const value = inlineStyles || getComputedStyle(target[proxyTargetSymbol] || target).getPropertyValue(propName);\n  return value === 'auto' ? '0' : value;\n};\n\n/**\n * @param {Target} target\n * @param {String} propName\n * @param {tweenTypes} [tweenType]\n * @param {Object|void} [animationInlineStyles]\n * @return {String|Number}\n */\nconst getOriginalAnimatableValue = (target, propName, tweenType, animationInlineStyles) => {\n  const type = !isUnd(tweenType) ? tweenType : getTweenType(target, propName);\n  return type === tweenTypes.OBJECT ? target[propName] || 0 :\n         type === tweenTypes.ATTRIBUTE ? /** @type {DOMTarget} */(target).getAttribute(propName) :\n         type === tweenTypes.TRANSFORM ? parseInlineTransforms(/** @type {DOMTarget} */(target), propName, animationInlineStyles) :\n         type === tweenTypes.CSS_VAR ? getCSSValue(/** @type {DOMTarget} */(target), propName, animationInlineStyles).trimStart() :\n         getCSSValue(/** @type {DOMTarget} */(target), propName, animationInlineStyles);\n};\n\n/**\n * @param  {Number} x\n * @param  {Number} y\n * @param  {String} operator\n * @return {Number}\n */\nconst getRelativeValue = (x, y, operator) => {\n  return operator === '-' ? x - y :\n         operator === '+' ? x + y :\n         x * y;\n};\n\n/** @return {TweenDecomposedValue} */\nconst createDecomposedValueTargetObject = () => {\n  return {\n    /** @type {valueTypes} */\n    t: valueTypes.NUMBER,\n    n: 0,\n    u: null,\n    o: null,\n    d: null,\n    s: null,\n  }\n};\n\n/**\n * @param  {String|Number} rawValue\n * @param  {TweenDecomposedValue} targetObject\n * @return {TweenDecomposedValue}\n */\nconst decomposeRawValue = (rawValue, targetObject) => {\n  /** @type {valueTypes} */\n  targetObject.t = valueTypes.NUMBER;\n  targetObject.n = 0;\n  targetObject.u = null;\n  targetObject.o = null;\n  targetObject.d = null;\n  targetObject.s = null;\n  if (!rawValue) return targetObject;\n  const num = +rawValue;\n  if (!isNaN(num)) {\n    // It's a number\n    targetObject.n = num;\n    return targetObject;\n  } else {\n    // let str = /** @type {String} */(rawValue).trim();\n    let str = /** @type {String} */(rawValue);\n    // Parsing operators (+=, -=, *=) manually is much faster than using regex here\n    if (str[1] === '=') {\n      targetObject.o = str[0];\n      str = str.slice(2);\n    }\n    // Skip exec regex if the value type is complex or color to avoid long regex backtracking\n    const unitMatch = str.includes(' ') ? false : unitsExecRgx.exec(str);\n    if (unitMatch) {\n      // Has a number and a unit\n      targetObject.t = valueTypes.UNIT;\n      targetObject.n = +unitMatch[1];\n      targetObject.u = unitMatch[2];\n      return targetObject;\n    } else if (targetObject.o) {\n      // Has an operator (+=, -=, *=)\n      targetObject.n = +str;\n      return targetObject;\n    } else if (isCol(str)) {\n      // Is a color\n      targetObject.t = valueTypes.COLOR;\n      targetObject.d = convertColorStringValuesToRgbaArray(str);\n      return targetObject;\n    } else {\n      // Is a more complex string (generally svg coords, calc() or filters CSS values)\n      const matchedNumbers = str.match(digitWithExponentRgx);\n      targetObject.t = valueTypes.COMPLEX;\n      targetObject.d = matchedNumbers ? matchedNumbers.map(Number) : [];\n      targetObject.s = str.split(digitWithExponentRgx) || [];\n      return targetObject;\n    }\n  }\n};\n\n/**\n * @param  {Tween} tween\n * @param  {TweenDecomposedValue} targetObject\n * @return {TweenDecomposedValue}\n */\nconst decomposeTweenValue = (tween, targetObject) => {\n  targetObject.t = tween._valueType;\n  targetObject.n = tween._toNumber;\n  targetObject.u = tween._unit;\n  targetObject.o = null;\n  targetObject.d = cloneArray(tween._toNumbers);\n  targetObject.s = cloneArray(tween._strings);\n  return targetObject;\n};\n\nconst decomposedOriginalValue = createDecomposedValueTargetObject();\n\n\n\n\nconst lookups = {\n  /** @type {TweenReplaceLookups} */\n  _rep: new WeakMap(),\n  /** @type {TweenAdditiveLookups} */\n  _add: new Map(),\n};\n\n/**\n * @param  {Target} target\n * @param  {String} property\n * @param  {String} lookup\n * @return {TweenPropertySiblings}\n */\nconst getTweenSiblings = (target, property, lookup = '_rep') => {\n  const lookupMap = lookups[lookup];\n  let targetLookup = lookupMap.get(target);\n  if (!targetLookup) {\n    targetLookup = {};\n    lookupMap.set(target, targetLookup);\n  }\n  return targetLookup[property] ? targetLookup[property] : targetLookup[property] = {\n    _head: null,\n    _tail: null,\n  }\n};\n\n/**\n * @param  {Tween} p\n * @param  {Tween} c\n * @return {Number|Boolean}\n */\nconst addTweenSortMethod = (p, c) => {\n  return p._isOverridden || p._absoluteStartTime > c._absoluteStartTime;\n};\n\n/**\n * @param {Tween} tween\n */\nconst overrideTween = tween => {\n  tween._isOverlapped = 1;\n  tween._isOverridden = 1;\n  tween._changeDuration = minValue;\n  tween._currentTime = minValue;\n};\n\n/**\n * @param  {Tween} tween\n * @param  {TweenPropertySiblings} siblings\n * @return {Tween}\n */\nconst composeTween = (tween, siblings) => {\n\n  const tweenCompositionType = tween._composition;\n\n  // Handle replaced tweens\n\n  if (tweenCompositionType === compositionTypes.replace) {\n\n    const tweenAbsStartTime = tween._absoluteStartTime;\n\n    addChild(siblings, tween, addTweenSortMethod, '_prevRep', '_nextRep');\n\n    const prevSibling = tween._prevRep;\n\n    // Update the previous siblings for composition replace tweens\n\n    if (prevSibling) {\n\n      const prevParent = prevSibling.parent;\n      const prevAbsEndTime = prevSibling._absoluteStartTime + prevSibling._changeDuration;\n\n      // Handle looped animations tween\n\n      if (\n        // Check if the previous tween is from a different animation\n        tween.parent.id !== prevParent.id &&\n        // Check if the animation has loops\n        prevParent.iterationCount> 1 &&\n        // Check if _absoluteChangeEndTime of last loop overlaps the current tween\n        prevAbsEndTime + (prevParent.duration - prevParent.iterationDuration) > tweenAbsStartTime\n      ) {\n\n        // TODO: Find a way to only override the iterations overlapping with the tween\n        overrideTween(prevSibling);\n\n        let prevPrevSibling = prevSibling._prevRep;\n\n        // If the tween was part of a set of keyframes, override its siblings\n        while (prevPrevSibling && prevPrevSibling.parent.id === prevParent.id) {\n          overrideTween(prevPrevSibling);\n          prevPrevSibling = prevPrevSibling._prevRep;\n        }\n\n      }\n\n      const absoluteUpdateStartTime = tweenAbsStartTime - tween._delay;\n\n      if (prevAbsEndTime > absoluteUpdateStartTime) {\n\n        const prevChangeStartTime = prevSibling._startTime;\n        const prevTLOffset = prevAbsEndTime - (prevChangeStartTime + prevSibling._updateDuration);\n\n        prevSibling._changeDuration = absoluteUpdateStartTime - prevTLOffset - prevChangeStartTime;\n        prevSibling._currentTime = prevSibling._changeDuration;\n        prevSibling._isOverlapped = 1;\n\n        if (prevSibling._changeDuration < minValue) {\n          overrideTween(prevSibling);\n        }\n      }\n\n      // Pause (and cancel) the parent if it only contains overlapped tweens\n\n      let pausePrevParentAnimation = true;\n\n      forEachChildren(prevParent, (/** @type Tween */t) => {\n        if (!t._isOverlapped) pausePrevParentAnimation = false;\n      });\n\n      if (pausePrevParentAnimation) {\n        const prevParentTL = prevParent.parent;\n        if (prevParentTL) {\n          let pausePrevParentTL = true;\n          forEachChildren(prevParentTL, (/** @type JSAnimation */a) => {\n            if (a !== prevParent) {\n              forEachChildren(a, (/** @type Tween */t) => {\n                if (!t._isOverlapped) pausePrevParentTL = false;\n              });\n            }\n          });\n          if (pausePrevParentTL) {\n            prevParentTL.cancel();\n          }\n        } else {\n          prevParent.cancel();\n          // Previously, calling .cancel() on a timeline child would affect the render order of other children\n          // Worked around this by marking it as .completed and using .pause() for safe removal in the engine loop\n          // This is no longer needed since timeline tween composition is now handled separatly\n          // Keeping this here for reference\n          // prevParent.completed = true;\n          // prevParent.pause();\n        }\n      }\n\n    }\n\n    // let nextSibling = tween._nextRep;\n\n    // // All the next siblings are automatically overridden\n\n    // if (nextSibling && nextSibling._absoluteStartTime >= tweenAbsStartTime) {\n    //   while (nextSibling) {\n    //     overrideTween(nextSibling);\n    //     nextSibling = nextSibling._nextRep;\n    //   }\n    // }\n\n    // if (nextSibling && nextSibling._absoluteStartTime < tweenAbsStartTime) {\n    //   while (nextSibling) {\n    //     overrideTween(nextSibling);\n    //     console.log(tween.id, nextSibling.id);\n    //     nextSibling = nextSibling._nextRep;\n    //   }\n    // }\n\n  // Handle additive tweens composition\n\n  } else if (tweenCompositionType === compositionTypes.blend) {\n\n    const additiveTweenSiblings = getTweenSiblings(tween.target, tween.property, '_add');\n    const additiveAnimation = addAdditiveAnimation(lookups._add);\n\n    let lookupTween = additiveTweenSiblings._head;\n\n    if (!lookupTween) {\n      lookupTween = { ...tween };\n      lookupTween._composition = compositionTypes.replace;\n      lookupTween._updateDuration = minValue;\n      lookupTween._startTime = 0;\n      lookupTween._numbers = cloneArray(tween._fromNumbers);\n      lookupTween._number = 0;\n      lookupTween._next = null;\n      lookupTween._prev = null;\n      addChild(additiveTweenSiblings, lookupTween);\n      addChild(additiveAnimation, lookupTween);\n    }\n\n    // Convert the values of TO to FROM and set TO to 0\n\n    const toNumber = tween._toNumber;\n    tween._fromNumber = lookupTween._fromNumber - toNumber;\n    tween._toNumber = 0;\n    tween._numbers = cloneArray(tween._fromNumbers);\n    tween._number = 0;\n    lookupTween._fromNumber = toNumber;\n\n    if (tween._toNumbers) {\n      const toNumbers = cloneArray(tween._toNumbers);\n      if (toNumbers) {\n        toNumbers.forEach((value, i) => {\n          tween._fromNumbers[i] = lookupTween._fromNumbers[i] - value;\n          tween._toNumbers[i] = 0;\n        });\n      }\n      lookupTween._fromNumbers = toNumbers;\n    }\n\n    addChild(additiveTweenSiblings, tween, null, '_prevAdd', '_nextAdd');\n\n  }\n\n  return tween;\n\n};\n\n/**\n * @param  {Tween} tween\n * @return {Tween}\n */\nconst removeTweenSliblings = tween => {\n  const tweenComposition = tween._composition;\n  if (tweenComposition !== compositionTypes.none) {\n    const tweenTarget = tween.target;\n    const tweenProperty = tween.property;\n    const replaceTweensLookup = lookups._rep;\n    const replaceTargetProps = replaceTweensLookup.get(tweenTarget);\n    const tweenReplaceSiblings = replaceTargetProps[tweenProperty];\n    removeChild(tweenReplaceSiblings, tween, '_prevRep', '_nextRep');\n    if (tweenComposition === compositionTypes.blend) {\n      const addTweensLookup = lookups._add;\n      const addTargetProps = addTweensLookup.get(tweenTarget);\n      if (!addTargetProps) return;\n      const additiveTweenSiblings = addTargetProps[tweenProperty];\n      const additiveAnimation = additive.animation;\n      removeChild(additiveTweenSiblings, tween, '_prevAdd', '_nextAdd');\n      // If only one tween is left in the additive lookup, it's the tween lookup\n      const lookupTween = additiveTweenSiblings._head;\n      if (lookupTween && lookupTween === additiveTweenSiblings._tail) {\n        removeChild(additiveTweenSiblings, lookupTween, '_prevAdd', '_nextAdd');\n        removeChild(additiveAnimation, lookupTween);\n        let shouldClean = true;\n        for (let prop in addTargetProps) {\n          if (addTargetProps[prop]._head) {\n            shouldClean = false;\n            break;\n          }\n        }\n        if (shouldClean) {\n          addTweensLookup.delete(tweenTarget);\n        }\n      }\n    }\n  }\n  return tween;\n};\n\n\n\n\n/**\n * @param  {Timer} timer\n * @return {Timer}\n */\nconst resetTimerProperties = timer => {\n  timer.paused = true;\n  timer.began = false;\n  timer.completed = false;\n  return timer;\n};\n\n/**\n * @param  {Timer} timer\n * @return {Timer}\n */\nconst reviveTimer = timer => {\n  if (!timer._cancelled) return timer;\n  if (timer._hasChildren) {\n    forEachChildren(timer, reviveTimer);\n  } else {\n    forEachChildren(timer, (/** @type {Tween} tween*/tween) => {\n      if (tween._composition !== compositionTypes.none) {\n        composeTween(tween, getTweenSiblings(tween.target, tween.property));\n      }\n    });\n  }\n  timer._cancelled = 0;\n  return timer;\n};\n\nlet timerId = 0;\n\n/**\n * Base class used to create Timers, Animations and Timelines\n */\nclass Timer extends Clock {\n  /**\n   * @param {TimerParams} [parameters]\n   * @param {Timeline} [parent]\n   * @param {Number} [parentPosition]\n   */\n  constructor(parameters = {}, parent = null, parentPosition = 0) {\n\n    super(0);\n\n    const {\n      id,\n      delay,\n      duration,\n      reversed,\n      alternate,\n      loop,\n      loopDelay,\n      autoplay,\n      frameRate,\n      playbackRate,\n      onComplete,\n      onLoop,\n      onPause,\n      onBegin,\n      onBeforeUpdate,\n      onUpdate,\n    } = parameters;\n\n    if (globals.scope) globals.scope.revertibles.push(this);\n\n    const timerInitTime = parent ? 0 : engine._elapsedTime;\n    const timerDefaults = parent ? parent.defaults : globals.defaults;\n    const timerDelay = /** @type {Number} */(isFnc(delay) || isUnd(delay) ? timerDefaults.delay : +delay);\n    const timerDuration = isFnc(duration) || isUnd(duration) ? Infinity : +duration;\n    const timerLoop = setValue(loop, timerDefaults.loop);\n    const timerLoopDelay = setValue(loopDelay, timerDefaults.loopDelay);\n    const timerIterationCount = timerLoop === true ||\n                                timerLoop === Infinity ||\n                                /** @type {Number} */(timerLoop) < 0 ? Infinity :\n                                /** @type {Number} */(timerLoop) + 1;\n\n    let offsetPosition = 0;\n\n    if (parent) {\n      offsetPosition = parentPosition;\n    } else {\n      let startTime = now();\n      // Make sure to tick the engine once if suspended to avoid big gaps with the following offsetPosition calculation\n      if (engine.paused) {\n        engine.requestTick(startTime);\n        startTime = engine._elapsedTime;\n      }\n      offsetPosition = startTime - engine._startTime;\n    }\n\n    // Timer's parameters\n    this.id = !isUnd(id) ? id : ++timerId;\n    /** @type {Timeline} */\n    this.parent = parent;\n    // Total duration of the timer\n    this.duration = clampInfinity(((timerDuration + timerLoopDelay) * timerIterationCount) - timerLoopDelay) || minValue;\n    /** @type {Boolean} */\n    this.backwards = false;\n    /** @type {Boolean} */\n    this.paused = true;\n    /** @type {Boolean} */\n    this.began = false;\n    /** @type {Boolean} */\n    this.completed = false;\n    /** @type {Callback<this>} */\n    this.onBegin = onBegin || timerDefaults.onBegin;\n    /** @type {Callback<this>} */\n    this.onBeforeUpdate = onBeforeUpdate || timerDefaults.onBeforeUpdate;\n    /** @type {Callback<this>} */\n    this.onUpdate = onUpdate || timerDefaults.onUpdate;\n    /** @type {Callback<this>} */\n    this.onLoop = onLoop || timerDefaults.onLoop;\n    /** @type {Callback<this>} */\n    this.onPause = onPause || timerDefaults.onPause;\n    /** @type {Callback<this>} */\n    this.onComplete = onComplete || timerDefaults.onComplete;\n    /** @type {Number} */\n    this.iterationDuration = timerDuration; // Duration of one loop\n    /** @type {Number} */\n    this.iterationCount = timerIterationCount; // Number of loops\n    /** @type {Boolean|ScrollObserver} */\n    this._autoplay = parent ? false : setValue(autoplay, timerDefaults.autoplay);\n    /** @type {Number} */\n    this._offset = offsetPosition;\n    /** @type {Number} */\n    this._delay = timerDelay;\n    /** @type {Number} */\n    this._loopDelay = timerLoopDelay;\n    /** @type {Number} */\n    this._iterationTime = 0;\n    /** @type {Number} */\n    this._currentIteration = 0; // Current loop index\n    /** @type {Function} */\n    this._resolve = noop; // Used by .then()\n    /** @type {Boolean} */\n    this._running = false;\n    /** @type {Number} */\n    this._reversed = +setValue(reversed, timerDefaults.reversed);\n    /** @type {Number} */\n    this._reverse = this._reversed;\n    /** @type {Number} */\n    this._cancelled = 0;\n    /** @type {Boolean} */\n    this._alternate = setValue(alternate, timerDefaults.alternate);\n    /** @type {Renderable} */\n    this._prev = null;\n    /** @type {Renderable} */\n    this._next = null;\n\n    // Clock's parameters\n    /** @type {Number} */\n    this._elapsedTime = timerInitTime;\n    /** @type {Number} */\n    this._startTime = timerInitTime;\n    /** @type {Number} */\n    this._lastTime = timerInitTime;\n    /** @type {Number} */\n    this._fps = setValue(frameRate, timerDefaults.frameRate);\n    /** @type {Number} */\n    this._speed = setValue(playbackRate, timerDefaults.playbackRate);\n  }\n\n  get cancelled() {\n    return !!this._cancelled;\n  }\n\n  /** @param {Boolean} cancelled  */\n  set cancelled(cancelled) {\n    cancelled ? this.cancel() : this.reset(1).play();\n  }\n\n  get currentTime() {\n    return clamp(round(this._currentTime, globals.precision), -this._delay, this.duration);\n  }\n\n  /** @param {Number} time  */\n  set currentTime(time) {\n    const paused = this.paused;\n    // Pausing the timer is necessary to avoid time jumps on a running instance\n    this.pause().seek(+time);\n    if (!paused) this.resume();\n  }\n\n  get iterationCurrentTime() {\n    return round(this._iterationTime, globals.precision);\n  }\n\n  /** @param {Number} time  */\n  set iterationCurrentTime(time) {\n    this.currentTime = (this.iterationDuration * this._currentIteration) + time;\n  }\n\n  get progress() {\n    return clamp(round(this._currentTime / this.duration, 5), 0, 1);\n  }\n\n  /** @param {Number} progress  */\n  set progress(progress) {\n    this.currentTime = this.duration * progress;\n  }\n\n  get iterationProgress() {\n    return clamp(round(this._iterationTime / this.iterationDuration, 5), 0, 1);\n  }\n\n  /** @param {Number} progress  */\n  set iterationProgress(progress) {\n    const iterationDuration = this.iterationDuration;\n    this.currentTime = (iterationDuration * this._currentIteration) + (iterationDuration * progress);\n  }\n\n  get currentIteration() {\n    return this._currentIteration;\n  }\n\n  /** @param {Number} iterationCount  */\n  set currentIteration(iterationCount) {\n    this.currentTime = (this.iterationDuration * clamp(+iterationCount, 0, this.iterationCount - 1));\n  }\n\n  get reversed() {\n    return !!this._reversed;\n  }\n\n  /** @param {Boolean} reverse  */\n  set reversed(reverse) {\n    reverse ? this.reverse() : this.play();\n  }\n\n  get speed() {\n    return super.speed;\n  }\n\n  /** @param {Number} playbackRate  */\n  set speed(playbackRate) {\n    super.speed = playbackRate;\n    this.resetTime();\n  }\n\n  /**\n   * @param  {Number} internalRender\n   * @return {this}\n   */\n  reset(internalRender = 0) {\n    // If cancelled, revive the timer before rendering in order to have propertly composed tweens siblings\n    reviveTimer(this);\n    if (this._reversed && !this._reverse) this.reversed = false;\n    // Rendering before updating the completed flag to prevent skips and to make sure the properties are not overridden\n    // Setting the iterationTime at the end to force the rendering to happend backwards, otherwise calling .reset() on Timelines might not render children in the right order\n    // NOTE: This is only required for Timelines and might be better to move to the Timeline class?\n    this._iterationTime = this.iterationDuration;\n    // Set tickMode to tickModes.FORCE to force rendering\n    tick(this, 0, 1, internalRender, tickModes.FORCE);\n    // Reset timer properties after revive / render to make sure the props are not updated again\n    resetTimerProperties(this);\n    // Also reset children properties\n    if (this._hasChildren) {\n      forEachChildren(this, resetTimerProperties);\n    }\n    return this;\n  }\n\n  /**\n   * @param  {Number} internalRender\n   * @return {this}\n   */\n  init(internalRender = 0) {\n    this.fps = this._fps;\n    this.speed = this._speed;\n    // Manually calling .init() on timelines should render all children intial state\n    // Forces all children to render once then render to 0 when reseted\n    if (!internalRender && this._hasChildren) {\n      tick(this, this.duration, 1, internalRender, tickModes.FORCE);\n    }\n    this.reset(internalRender);\n    // Make sure to set autoplay to false to child timers so it doesn't attempt to autoplay / link\n    const autoplay = this._autoplay;\n    if (autoplay === true) {\n      this.resume();\n    } else if (autoplay && !isUnd(/** @type {ScrollObserver} */(autoplay).linked)) {\n      /** @type {ScrollObserver} */(autoplay).link(this);\n    }\n    return this;\n  }\n\n  /** @return {this} */\n  resetTime() {\n    const timeScale = 1 / (this._speed * engine._speed);\n    this._startTime = now() - (this._currentTime + this._delay) * timeScale;\n    return this;\n  }\n\n  /** @return {this} */\n  pause() {\n    if (this.paused) return this;\n    this.paused = true;\n    this.onPause(this);\n    return this;\n  }\n\n  /** @return {this} */\n  resume() {\n    if (!this.paused) return this;\n    this.paused = false;\n    // We can safely imediatly render a timer that has no duration and no children\n    if (this.duration <= minValue && !this._hasChildren) {\n      tick(this, minValue, 0, 0, tickModes.FORCE);\n    } else {\n      if (!this._running) {\n        addChild(engine, this);\n        engine._hasChildren = true;\n        this._running = true;\n      }\n      this.resetTime();\n      // Forces the timer to advance by at least one frame when the next tick occurs\n      this._startTime -= 12;\n      engine.wake();\n    }\n    return this;\n  }\n\n  /** @return {this} */\n  restart() {\n    return this.reset(0).resume();\n  }\n\n  /**\n   * @param  {Number} time\n   * @param  {Boolean|Number} [muteCallbacks]\n   * @param  {Boolean|Number} [internalRender]\n   * @return {this}\n   */\n  seek(time, muteCallbacks = 0, internalRender = 0) {\n    // Recompose the tween siblings in case the timer has been cancelled\n    reviveTimer(this);\n    // If you seek a completed animation, otherwise the next play will starts at 0\n    this.completed = false;\n    const isPaused = this.paused;\n    this.paused = true;\n    // timer, time, muteCallbacks, internalRender, tickMode\n    tick(this, time + this._delay, ~~muteCallbacks, ~~internalRender, tickModes.AUTO);\n    return isPaused ? this : this.resume();\n  }\n\n  /** @return {this} */\n  alternate() {\n    const reversed = this._reversed;\n    const count = this.iterationCount;\n    const duration = this.iterationDuration;\n    // Calculate the maximum iterations possible given the iteration duration\n    const iterations = count === Infinity ? floor(maxValue / duration) : count;\n    this._reversed = +(this._alternate && !(iterations % 2) ? reversed : !reversed);\n    if (count === Infinity) {\n      // Handle infinite loops to loop on themself\n      this.iterationProgress = this._reversed ? 1 - this.iterationProgress : this.iterationProgress;\n    } else {\n      this.seek((duration * iterations) - this._currentTime);\n    }\n    this.resetTime();\n    return this;\n  }\n\n  /** @return {this} */\n  play() {\n    if (this._reversed) this.alternate();\n    return this.resume();\n  }\n\n  /** @return {this} */\n  reverse() {\n    if (!this._reversed) this.alternate();\n    return this.resume();\n  }\n\n  // TODO: Move all the animation / tweens / children related code to Animation / Timeline\n\n  /** @return {this} */\n  cancel() {\n    if (this._hasChildren) {\n      forEachChildren(this, (/** @type {Renderable} */child) => child.cancel(), true);\n    } else {\n      forEachChildren(this, removeTweenSliblings);\n    }\n    this._cancelled = 1;\n    // Pausing the timer removes it from the engine\n    return this.pause();\n  }\n\n  /**\n   * @param  {Number} newDuration\n   * @return {this}\n   */\n  stretch(newDuration) {\n    const currentDuration = this.duration;\n    const normlizedDuration = normalizeTime(newDuration);\n    if (currentDuration === normlizedDuration) return this;\n    const timeScale = newDuration / currentDuration;\n    const isSetter = newDuration <= minValue;\n    this.duration = isSetter ? minValue : normlizedDuration;\n    this.iterationDuration = isSetter ? minValue : normalizeTime(this.iterationDuration * timeScale);\n    this._offset *= timeScale;\n    this._delay *= timeScale;\n    this._loopDelay *= timeScale;\n    return this;\n  }\n\n /**\n   * Cancels the timer by seeking it back to 0 and reverting the attached scroller if necessary\n   * @return {this}\n   */\n  revert() {\n    tick(this, 0, 1, 0, tickModes.AUTO);\n    const ap = /** @type {ScrollObserver} */(this._autoplay);\n    if (ap && ap.linked && ap.linked === this) ap.revert();\n    return this.cancel();\n  }\n\n /**\n   * Imediatly completes the timer, cancels it and triggers the onComplete callback\n   * @return {this}\n   */\n  complete() {\n    return this.seek(this.duration).cancel();\n  }\n\n  /**\n   * @param  {Callback<this>} [callback]\n   * @return {Promise}\n   */\n  then(callback = noop) {\n    const then = this.then;\n    const onResolve = () => {\n      // this.then = null prevents infinite recursion if returned by an async function\n      // https://github.com/juliangarnierorg/anime-beta/issues/26\n      this.then = null;\n      callback(this);\n      this.then = then;\n      this._resolve = noop;\n    };\n    return new Promise(r => {\n      this._resolve = () => r(onResolve());\n      // Make sure to resolve imediatly if the timer has already completed\n      if (this.completed) this._resolve();\n      return this;\n    });\n  }\n\n}\n\n\n/**\n * @param {TimerParams} [parameters]\n * @return {Timer}\n */\nconst createTimer = parameters => new Timer(parameters, null, 0).init();\n\n\n\n\n/** @type {EasingFunction} */\nconst none = t => t;\n\n// Cubic Bezier solver adapted from https://github.com/gre/bezier-ease © Gaëtan Renaudeau\n\n/**\n * @param  {Number} aT\n * @param  {Number} aA1\n * @param  {Number} aA2\n * @return {Number}\n */\nconst calcBezier = (aT, aA1, aA2) => (((1 - 3 * aA2 + 3 * aA1) * aT + (3 * aA2 - 6 * aA1)) * aT + (3 * aA1)) * aT;\n\n/**\n * @param  {Number} aX\n * @param  {Number} mX1\n * @param  {Number} mX2\n * @return {Number}\n */\nconst binarySubdivide = (aX, mX1, mX2) => {\n  let aA = 0, aB = 1, currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (abs(currentX) > .0000001 && ++i < 100);\n  return currentT;\n};\n\n/**\n * @param  {Number} [mX1]\n * @param  {Number} [mY1]\n * @param  {Number} [mX2]\n * @param  {Number} [mY2]\n * @return {EasingFunction}\n */\n\nconst cubicBezier = (mX1 = 0.5, mY1 = 0.0, mX2 = 0.5, mY2 = 1.0) => (mX1 === mY1 && mX2 === mY2) ? none :\n  t => t === 0 || t === 1 ? t :\n  calcBezier(binarySubdivide(t, mX1, mX2), mY1, mY2);\n\n/**\n * Steps ease implementation https://developer.mozilla.org/fr/docs/Web/CSS/transition-timing-function\n * Only covers 'end' and 'start' jumpterms\n * @param  {Number} steps\n * @param  {Boolean} [fromStart]\n * @return {EasingFunction}\n */\nconst steps = (steps = 10, fromStart) => {\n  const roundMethod = fromStart ? ceil : floor;\n  return t => roundMethod(clamp(t, 0, 1) * steps) * (1 / steps);\n};\n\n/**\n * Without parameters, the linear function creates a non-eased transition.\n * Parameters, if used, creates a piecewise linear easing by interpolating linearly between the specified points.\n * @param  {...String|Number} [args] - Points\n * @return {EasingFunction}\n */\nconst linear = (...args) => {\n  const argsLength = args.length;\n  if (!argsLength) return none;\n  const totalPoints = argsLength - 1;\n  const firstArg = args[0];\n  const lastArg = args[totalPoints];\n  const xPoints = [0];\n  const yPoints = [parseNumber(firstArg)];\n  for (let i = 1; i < totalPoints; i++) {\n    const arg = args[i];\n    const splitValue = isStr(arg) ?\n    /** @type {String} */(arg).trim().split(' ') :\n    [arg];\n    const value = splitValue[0];\n    const percent = splitValue[1];\n    xPoints.push(!isUnd(percent) ? parseNumber(percent) / 100 : i / totalPoints);\n    yPoints.push(parseNumber(value));\n  }\n  yPoints.push(parseNumber(lastArg));\n  xPoints.push(1);\n  return function easeLinear(t) {\n    for (let i = 1, l = xPoints.length; i < l; i++) {\n      const currentX = xPoints[i];\n      if (t <= currentX) {\n        const prevX = xPoints[i - 1];\n        const prevY = yPoints[i - 1];\n        return prevY + (yPoints[i] - prevY) * (t - prevX) / (currentX - prevX);\n      }\n    }\n    return yPoints[yPoints.length - 1];\n  }\n};\n\n/**\n * Generate random steps\n * @param  {Number} [length] - The number of steps\n * @param  {Number} [randomness] - How strong the randomness is\n * @return {EasingFunction}\n */\nconst irregular = (length = 10, randomness = 1) => {\n  const values = [0];\n  const total = length - 1;\n  for (let i = 1; i < total; i++) {\n    const previousValue = values[i - 1];\n    const spacing = i / total;\n    const segmentEnd = (i + 1) / total;\n    const randomVariation = spacing + (segmentEnd - spacing) * Math.random();\n    // Mix the even spacing and random variation based on the randomness parameter\n    const randomValue = spacing * (1 - randomness) + randomVariation * randomness;\n    values.push(clamp(randomValue, previousValue, 1));\n  }\n  values.push(1);\n  return linear(...values);\n};\n\n// Easing functions adapted from http://www.robertpenner.com/ease © Robert Penner\n\n/**\n * @callback PowerEasing\n * @param {Number|String} [power=1.675]\n * @return {EasingFunction}\n */\n\n/**\n * @callback BackEasing\n * @param {Number|String} [overshoot=1.70158]\n * @return {EasingFunction}\n */\n\n/**\n * @callback ElasticEasing\n * @param {Number|String} [amplitude=1]\n * @param {Number|String} [period=.3]\n * @return {EasingFunction}\n */\n\n/**\n * @callback EaseFactory\n * @param {Number|String} [paramA]\n * @param {Number|String} [paramB]\n * @return {EasingFunction|Number}\n */\n\n/** @typedef {PowerEasing|BackEasing|ElasticEasing} EasesFactory */\n\nconst halfPI = PI / 2;\nconst doublePI = PI * 2;\n/** @type {PowerEasing} */\nconst easeInPower = (p = 1.68) => t => pow(t, +p);\n\n/** @type {Record<String, EasesFactory|EasingFunction>} */\nconst easeInFunctions = {\n  [emptyString]: easeInPower,\n  Quad: easeInPower(2),\n  Cubic: easeInPower(3),\n  Quart: easeInPower(4),\n  Quint: easeInPower(5),\n  /** @type {EasingFunction} */\n  Sine: t => 1 - cos(t * halfPI),\n  /** @type {EasingFunction} */\n  Circ: t => 1 - sqrt(1 - t * t),\n  /** @type {EasingFunction} */\n  Expo: t => t ? pow(2, 10 * t - 10) : 0,\n  /** @type {EasingFunction} */\n  Bounce: t => {\n    let pow2, b = 4;\n    while (t < ((pow2 = pow(2, --b)) - 1) / 11);\n    return 1 / pow(4, 3 - b) - 7.5625 * pow((pow2 * 3 - 2) / 22 - t, 2);\n  },\n  /** @type {BackEasing} */\n  Back: (overshoot = 1.70158) => t => (+overshoot + 1) * t * t * t - +overshoot * t * t,\n  /** @type {ElasticEasing} */\n  Elastic: (amplitude = 1, period = .3) => {\n    const a = clamp(+amplitude, 1, 10);\n    const p = clamp(+period, minValue, 2);\n    const s = (p / doublePI) * asin(1 / a);\n    const e = doublePI / p;\n    return t => t === 0 || t === 1 ? t : -a * pow(2, -10 * (1 - t)) * sin(((1 - t) - s) * e);\n  }\n};\n\n/**\n * @callback EaseType\n * @param {EasingFunction} Ease\n * @return {EasingFunction}\n */\n\n/** @type {Record<String, EaseType>} */\nconst easeTypes = {\n  in: easeIn => t => easeIn(t),\n  out: easeIn => t => 1 - easeIn(1 - t),\n  inOut: easeIn => t => t < .5 ? easeIn(t * 2) / 2 : 1 - easeIn(t * -2 + 2) / 2,\n  outIn: easeIn => t => t < .5 ? (1 - easeIn(1 - t * 2)) / 2 : (easeIn(t * 2 - 1) + 1) / 2,\n};\n\n/**\n * @param  {String} string\n * @param  {Record<String, EasesFactory|EasingFunction>} easesFunctions\n * @param  {Object} easesLookups\n * @return {EasingFunction}\n */\nconst parseEaseString = (string, easesFunctions, easesLookups) => {\n  if (easesLookups[string]) return easesLookups[string];\n  if (string.indexOf('(') <= -1) {\n    const hasParams = easeTypes[string] || string.includes('Back') || string.includes('Elastic');\n    const parsedFn = /** @type {EasingFunction} */(hasParams ? /** @type {EasesFactory} */(easesFunctions[string])() : easesFunctions[string]);\n    return parsedFn ? easesLookups[string] = parsedFn : none;\n  } else {\n    const split = string.slice(0, -1).split('(');\n    const parsedFn = /** @type {EasesFactory} */(easesFunctions[split[0]]);\n    return parsedFn ? easesLookups[string] = parsedFn(...split[1].split(',')) : none;\n  }\n};\n\n/**\n * @typedef  {Object} EasesFunctions\n * @property {typeof linear} linear\n * @property {typeof irregular} irregular\n * @property {typeof steps} steps\n * @property {typeof cubicBezier} cubicBezier\n * @property {PowerEasing} in\n * @property {PowerEasing} out\n * @property {PowerEasing} inOut\n * @property {PowerEasing} outIn\n * @property {EasingFunction} inQuad\n * @property {EasingFunction} outQuad\n * @property {EasingFunction} inOutQuad\n * @property {EasingFunction} outInQuad\n * @property {EasingFunction} inCubic\n * @property {EasingFunction} outCubic\n * @property {EasingFunction} inOutCubic\n * @property {EasingFunction} outInCubic\n * @property {EasingFunction} inQuart\n * @property {EasingFunction} outQuart\n * @property {EasingFunction} inOutQuart\n * @property {EasingFunction} outInQuart\n * @property {EasingFunction} inQuint\n * @property {EasingFunction} outQuint\n * @property {EasingFunction} inOutQuint\n * @property {EasingFunction} outInQuint\n * @property {EasingFunction} inSine\n * @property {EasingFunction} outSine\n * @property {EasingFunction} inOutSine\n * @property {EasingFunction} outInSine\n * @property {EasingFunction} inCirc\n * @property {EasingFunction} outCirc\n * @property {EasingFunction} inOutCirc\n * @property {EasingFunction} outInCirc\n * @property {EasingFunction} inExpo\n * @property {EasingFunction} outExpo\n * @property {EasingFunction} inOutExpo\n * @property {EasingFunction} outInExpo\n * @property {EasingFunction} inBounce\n * @property {EasingFunction} outBounce\n * @property {EasingFunction} inOutBounce\n * @property {EasingFunction} outInBounce\n * @property {BackEasing} inBack\n * @property {BackEasing} outBack\n * @property {BackEasing} inOutBack\n * @property {BackEasing} outInBack\n * @property {ElasticEasing} inElastic\n * @property {ElasticEasing} outElastic\n * @property {ElasticEasing} inOutElastic\n * @property {ElasticEasing} outInElastic\n */\n\nconst eases = (/*#__PURE__*/ (() => {\n  const list = { linear, irregular, steps, cubicBezier };\n  for (let type in easeTypes) {\n    for (let name in easeInFunctions) {\n      const easeIn = easeInFunctions[name];\n      const easeType = easeTypes[type];\n      list[type + name] = /** @type {EasesFactory|EasingFunction} */(\n        name === emptyString || name === 'Back' || name === 'Elastic' ?\n        (a, b) => easeType(/** @type {EasesFactory} */(easeIn)(a, b)) :\n        easeType(/** @type {EasingFunction} */(easeIn))\n      );\n    }\n  }\n  return /** @type {EasesFunctions} */(list);\n})());\n\n/** @type {Record<String, EasingFunction>} */\nconst JSEasesLookups = { linear: none };\n\n/**\n * @param  {EasingParam} ease\n * @return {EasingFunction}\n */\nconst parseEasings = ease => isFnc(ease) ? ease :\n  isStr(ease) ? parseEaseString(/** @type {String} */(ease), eases, JSEasesLookups) :\n  none;\n\n\n\n\nconst propertyNamesCache = {};\n\n/**\n * @param  {String} propertyName\n * @param  {Target} target\n * @param  {tweenTypes} tweenType\n * @return {String}\n */\nconst sanitizePropertyName = (propertyName, target, tweenType) => {\n  if (tweenType === tweenTypes.TRANSFORM) {\n    const t = shortTransforms.get(propertyName);\n    return t ? t : propertyName;\n  } else if (\n    tweenType === tweenTypes.CSS ||\n    // Handle special cases where properties like \"strokeDashoffset\" needs to be set as \"stroke-dashoffset\"\n    // but properties like \"baseFrequency\" should stay in lowerCamelCase\n    (tweenType === tweenTypes.ATTRIBUTE && (isSvg(target) && propertyName in /** @type {DOMTarget} */(target).style))\n  ) {\n    const cachedPropertyName = propertyNamesCache[propertyName];\n    if (cachedPropertyName) {\n      return cachedPropertyName;\n    } else {\n      const lowerCaseName = propertyName ? toLowerCase(propertyName) : propertyName;\n      propertyNamesCache[propertyName] = lowerCaseName;\n      return lowerCaseName;\n    }\n  } else {\n    return propertyName;\n  }\n};\n\n\n\n\nconst angleUnitsMap = { 'deg': 1, 'rad': 180 / PI, 'turn': 360 };\nconst convertedValuesCache = {};\n\n/**\n * @param  {DOMTarget} el\n * @param  {TweenDecomposedValue} decomposedValue\n * @param  {String} unit\n * @param  {Boolean} [force]\n * @return {TweenDecomposedValue}\n */\nconst convertValueUnit = (el, decomposedValue, unit, force = false) => {\n  const currentUnit = decomposedValue.u;\n  const currentNumber = decomposedValue.n;\n  if (decomposedValue.t === valueTypes.UNIT && currentUnit === unit) { // TODO: Check if checking against the same unit string is necessary\n    return decomposedValue;\n  }\n  const cachedKey = currentNumber + currentUnit + unit;\n  const cached = convertedValuesCache[cachedKey];\n  if (!isUnd(cached) && !force) {\n    decomposedValue.n = cached;\n  } else {\n    let convertedValue;\n    if (currentUnit in angleUnitsMap) {\n      convertedValue = currentNumber * angleUnitsMap[currentUnit] / angleUnitsMap[unit];\n    } else {\n      const baseline = 100;\n      const tempEl = /** @type {DOMTarget} */(el.cloneNode());\n      const parentNode = el.parentNode;\n      const parentEl = (parentNode && (parentNode !== doc)) ? parentNode : doc.body;\n      parentEl.appendChild(tempEl);\n      const elStyle = tempEl.style;\n      elStyle.width = baseline + currentUnit;\n      const currentUnitWidth = /** @type {HTMLElement} */(tempEl).offsetWidth || baseline;\n      elStyle.width = baseline + unit;\n      const newUnitWidth = /** @type {HTMLElement} */(tempEl).offsetWidth || baseline;\n      const factor = currentUnitWidth / newUnitWidth;\n      parentEl.removeChild(tempEl);\n      convertedValue = factor * currentNumber;\n    }\n    decomposedValue.n = convertedValue;\n    convertedValuesCache[cachedKey] = convertedValue;\n  }\n  decomposedValue.t === valueTypes.UNIT;\n  decomposedValue.u = unit;\n  return decomposedValue;\n};\n\n\n\n\n/**\n * @template {Renderable} T\n * @param {T} renderable\n * @return {T}\n */\nconst cleanInlineStyles = renderable => {\n  // Allow cleanInlineStyles() to be called on timelines\n  if (renderable._hasChildren) {\n    forEachChildren(renderable, cleanInlineStyles, true);\n  } else {\n    const animation = /** @type {JSAnimation} */(renderable);\n    animation.pause();\n    forEachChildren(animation, (/** @type {Tween} */tween) => {\n      const tweenProperty = tween.property;\n      const tweenTarget = tween.target;\n      if (tweenTarget[isDomSymbol]) {\n        const targetStyle = /** @type {DOMTarget} */(tweenTarget).style;\n        const originalInlinedValue = animation._inlineStyles[tweenProperty];\n        if (tween._tweenType === tweenTypes.TRANSFORM) {\n          const cachedTransforms = tweenTarget[transformsSymbol];\n          if (isUnd(originalInlinedValue) || originalInlinedValue === emptyString) {\n            delete cachedTransforms[tweenProperty];\n          } else {\n            cachedTransforms[tweenProperty] = originalInlinedValue;\n          }\n          if (tween._renderTransforms) {\n            if (!Object.keys(cachedTransforms).length) {\n              targetStyle.removeProperty('transform');\n            } else {\n              let str = emptyString;\n              for (let key in cachedTransforms) {\n                str += transformsFragmentStrings[key] + cachedTransforms[key] + ') ';\n              }\n              targetStyle.transform = str;\n            }\n          }\n        } else {\n          if (isUnd(originalInlinedValue) || originalInlinedValue === emptyString) {\n            targetStyle.removeProperty(tweenProperty);\n          } else {\n            targetStyle[tweenProperty] = originalInlinedValue;\n          }\n        }\n        if (animation._tail === tween) {\n          animation.targets.forEach(t => {\n            if (t.getAttribute && t.getAttribute('style') === emptyString) {\n              t.removeAttribute('style');\n            }          });\n        }\n      }\n    });\n  }\n  return renderable;\n};\n\n// Defines decomposed values target objects only once and mutate their properties later to avoid GC\n// TODO: Maybe move the objects creation to values.js and use the decompose function to create the base object\nconst fromTargetObject = createDecomposedValueTargetObject();\nconst toTargetObject = createDecomposedValueTargetObject();\nconst toFunctionStore = { func: null };\nconst keyframesTargetArray = [null];\nconst fastSetValuesArray = [null, null];\n/** @type {TweenKeyValue} */\nconst keyObjectTarget = { to: null };\n\nlet tweenId = 0;\nlet keyframes;\n/** @type {TweenParamsOptions & TweenValues} */\nlet key;\n\n/**\n * @param {DurationKeyframes | PercentageKeyframes} keyframes\n * @param {AnimationParams} parameters\n * @return {AnimationParams}\n */\nconst generateKeyframes = (keyframes, parameters) => {\n  /** @type {AnimationParams} */\n  const properties = {};\n  if (isArr(keyframes)) {\n    const propertyNames = [].concat(.../** @type {DurationKeyframes} */(keyframes).map(key => Object.keys(key))).filter(isKey);\n    for (let i = 0, l = propertyNames.length; i < l; i++) {\n      const propName = propertyNames[i];\n      const propArray = /** @type {DurationKeyframes} */(keyframes).map(key => {\n        /** @type {TweenKeyValue} */\n        const newKey = {};\n        for (let p in key) {\n          const keyValue = /** @type {TweenPropValue} */(key[p]);\n          if (isKey(p)) {\n            if (p === propName) {\n              newKey.to = keyValue;\n            }\n          } else {\n            newKey[p] = keyValue;\n          }\n        }\n        return newKey;\n      });\n      properties[propName] = /** @type {ArraySyntaxValue} */(propArray);\n    }\n\n  } else {\n    const totalDuration = /** @type {Number} */(setValue(parameters.duration, globals.defaults.duration));\n    const keys = Object.keys(keyframes)\n    .map(key => { return {o: parseFloat(key) / 100, p: keyframes[key]} })\n    .sort((a, b) => a.o - b.o);\n    keys.forEach(key => {\n      const offset = key.o;\n      const prop = key.p;\n      for (let name in prop) {\n        if (isKey(name)) {\n          let propArray = /** @type {Array} */(properties[name]);\n          if (!propArray) propArray = properties[name] = [];\n          const duration = offset * totalDuration;\n          let length = propArray.length;\n          let prevKey = propArray[length - 1];\n          const keyObj = { to: prop[name] };\n          let durProgress = 0;\n          for (let i = 0; i < length; i++) {\n            durProgress += propArray[i].duration;\n          }\n          if (length === 1) {\n            keyObj.from = prevKey.to;\n          }\n          if (prop.ease) {\n            keyObj.ease = prop.ease;\n          }\n          keyObj.duration = duration - (length ? durProgress : 0);\n          propArray.push(keyObj);\n        }\n      }\n      return key;\n    });\n\n    for (let name in properties) {\n      const propArray = /** @type {Array} */(properties[name]);\n      let prevEase;\n      // let durProgress = 0\n      for (let i = 0, l = propArray.length; i < l; i++) {\n        const prop = propArray[i];\n        // Emulate WAPPI easing parameter position\n        const currentEase = prop.ease;\n        prop.ease = prevEase ? prevEase : undefined;\n        prevEase = currentEase;\n        // durProgress += prop.duration;\n        // if (i === l - 1 && durProgress !== totalDuration) {\n        //   propArray.push({ from: prop.to, ease: prop.ease, duration: totalDuration - durProgress })\n        // }\n      }\n      if (!propArray[0].duration) {\n        propArray.shift();\n      }\n    }\n\n  }\n\n  return properties;\n};\n\nclass JSAnimation extends Timer {\n  /**\n   * @param {TargetsParam} targets\n   * @param {AnimationParams} parameters\n   * @param {Timeline} [parent]\n   * @param {Number} [parentPosition]\n   * @param {Boolean} [fastSet=false]\n   * @param {Number} [index=0]\n   * @param {Number} [length=0]\n   */\n  constructor(\n    targets,\n    parameters,\n    parent,\n    parentPosition,\n    fastSet = false,\n    index = 0,\n    length = 0\n  ) {\n\n    super(/** @type {TimerParams&AnimationParams} */(parameters), parent, parentPosition);\n\n    const parsedTargets = registerTargets(targets);\n    const targetsLength = parsedTargets.length;\n\n    // If the parameters object contains a \"keyframes\" property, convert all the keyframes values to regular properties\n\n    const kfParams = /** @type {AnimationParams} */(parameters).keyframes;\n    const params = /** @type {AnimationParams} */(kfParams ? mergeObjects(generateKeyframes(/** @type {DurationKeyframes} */(kfParams), parameters), parameters) : parameters);\n\n    const {\n      delay,\n      duration,\n      ease,\n      playbackEase,\n      modifier,\n      composition,\n      onRender,\n    } = params;\n\n    const animDefaults = parent ? parent.defaults : globals.defaults;\n    const animaPlaybackEase = setValue(playbackEase, animDefaults.playbackEase);\n    const animEase = animaPlaybackEase ? parseEasings(animaPlaybackEase) : null;\n    const hasSpring = !isUnd(ease) && !isUnd(/** @type {Spring} */(ease).ease);\n    const tEasing = hasSpring ? /** @type {Spring} */(ease).ease : setValue(ease, animEase ? 'linear' : animDefaults.ease);\n    const tDuration = hasSpring ? /** @type {Spring} */(ease).duration : setValue(duration, animDefaults.duration);\n    const tDelay = setValue(delay, animDefaults.delay);\n    const tModifier = modifier || animDefaults.modifier;\n    // If no composition is defined and the targets length is high (>= 1000) set the composition to 'none' (0) for faster tween creation\n    const tComposition = isUnd(composition) && targetsLength >= K ? compositionTypes.none : !isUnd(composition) ? composition : animDefaults.composition;\n    // TODO: Do not create an empty object until we know the animation will generate inline styles\n    const animInlineStyles = {};\n    // const absoluteOffsetTime = this._offset;\n    const absoluteOffsetTime = this._offset + (parent ? parent._offset : 0);\n\n    let iterationDuration = NaN;\n    let iterationDelay = NaN;\n    let animationAnimationLength = 0;\n    let shouldTriggerRender = 0;\n\n    for (let targetIndex = 0; targetIndex < targetsLength; targetIndex++) {\n\n      const target = parsedTargets[targetIndex];\n      const ti = index || targetIndex;\n      const tl = length || targetsLength;\n\n      let lastTransformGroupIndex = NaN;\n      let lastTransformGroupLength = NaN;\n\n      for (let p in params) {\n\n        if (isKey(p)) {\n\n          const tweenType = getTweenType(target, p);\n\n          const propName = sanitizePropertyName(p, target, tweenType);\n\n          let propValue = params[p];\n\n          const isPropValueArray = isArr(propValue);\n\n          if (fastSet && !isPropValueArray) {\n            fastSetValuesArray[0] = propValue;\n            fastSetValuesArray[1] = propValue;\n            propValue = fastSetValuesArray;\n          }\n\n          // TODO: Allow nested keyframes inside ObjectValue value (prop: { to: [.5, 1, .75, 2, 3] })\n          // Normalize property values to valid keyframe syntax:\n          // [x, y] to [{to: [x, y]}] or {to: x} to [{to: x}] or keep keys syntax [{}, {}, {}...]\n          // const keyframes = isArr(propValue) ? propValue.length === 2 && !isObj(propValue[0]) ? [{ to: propValue }] : propValue : [propValue];\n          if (isPropValueArray) {\n            const arrayLength = /** @type {Array} */(propValue).length;\n            const isNotObjectValue = !isObj(propValue[0]);\n            // Convert [x, y] to [{to: [x, y]}]\n            if (arrayLength === 2 && isNotObjectValue) {\n              keyObjectTarget.to = /** @type {TweenParamValue} */(/** @type {unknown} */(propValue));\n              keyframesTargetArray[0] = keyObjectTarget;\n              keyframes = keyframesTargetArray;\n            // Convert [x, y, z] to [[x, y], z]\n            } else if (arrayLength > 2 && isNotObjectValue) {\n              keyframes = [];\n              /** @type {Array.<Number>} */(propValue).forEach((v, i) => {\n                if (!i) {\n                  fastSetValuesArray[0] = v;\n                } else if (i === 1) {\n                  fastSetValuesArray[1] = v;\n                  keyframes.push(fastSetValuesArray);\n                } else {\n                  keyframes.push(v);\n                }\n              });\n            } else {\n              keyframes = /** @type {Array.<TweenKeyValue>} */(propValue);\n            }\n          } else {\n            keyframesTargetArray[0] = propValue;\n            keyframes = keyframesTargetArray;\n          }\n\n          let siblings = null;\n          let prevTween = null;\n          let firstTweenChangeStartTime = NaN;\n          let lastTweenChangeEndTime = 0;\n          let tweenIndex = 0;\n\n          for (let l = keyframes.length; tweenIndex < l; tweenIndex++) {\n\n            const keyframe = keyframes[tweenIndex];\n\n            if (isObj(keyframe)) {\n              key = keyframe;\n            } else {\n              keyObjectTarget.to = /** @type {TweenParamValue} */(keyframe);\n              key = keyObjectTarget;\n            }\n\n            toFunctionStore.func = null;\n\n            const computedToValue = getFunctionValue(key.to, target, ti, tl, toFunctionStore);\n\n            let tweenToValue;\n            // Allows function based values to return an object syntax value ({to: v})\n            if (isObj(computedToValue) && !isUnd(computedToValue.to)) {\n              key = computedToValue;\n              tweenToValue = computedToValue.to;\n            } else {\n              tweenToValue = computedToValue;\n            }\n            const tweenFromValue = getFunctionValue(key.from, target, ti, tl);\n            const keyEasing = key.ease;\n            const hasSpring = !isUnd(keyEasing) && !isUnd(/** @type {Spring} */(keyEasing).ease);\n            // Easing are treated differently and don't accept function based value to prevent having to pass a function wrapper that returns an other function all the time\n            const tweenEasing = hasSpring ? /** @type {Spring} */(keyEasing).ease : keyEasing || tEasing;\n            // Calculate default individual keyframe duration by dividing the tl of keyframes\n            const tweenDuration = hasSpring ? /** @type {Spring} */(keyEasing).duration : getFunctionValue(setValue(key.duration, (l > 1 ? getFunctionValue(tDuration, target, ti, tl) / l : tDuration)), target, ti, tl);\n            // Default delay value should only be applied to the first tween\n            const tweenDelay = getFunctionValue(setValue(key.delay, (!tweenIndex ? tDelay : 0)), target, ti, tl);\n            const computedComposition = getFunctionValue(setValue(key.composition, tComposition), target, ti, tl);\n            const tweenComposition = isNum(computedComposition) ? computedComposition : compositionTypes[computedComposition];\n            // Modifiers are treated differently and don't accept function based value to prevent having to pass a function wrapper\n            const tweenModifier = key.modifier || tModifier;\n            const hasFromvalue = !isUnd(tweenFromValue);\n            const hasToValue = !isUnd(tweenToValue);\n            const isFromToArray = isArr(tweenToValue);\n            const isFromToValue = isFromToArray || (hasFromvalue && hasToValue);\n            const tweenStartTime = prevTween ? lastTweenChangeEndTime + tweenDelay : tweenDelay;\n            const absoluteStartTime = absoluteOffsetTime + tweenStartTime;\n\n            // Force a onRender callback if the animation contains at least one from value and autoplay is set to false\n            if (!shouldTriggerRender && (hasFromvalue || isFromToArray)) shouldTriggerRender = 1;\n\n            let prevSibling = prevTween;\n\n            if (tweenComposition !== compositionTypes.none) {\n              if (!siblings) siblings = getTweenSiblings(target, propName);\n              let nextSibling = siblings._head;\n              // Iterate trough all the next siblings until we find a sibling with an equal or inferior start time\n              while (nextSibling && !nextSibling._isOverridden && nextSibling._absoluteStartTime <= absoluteStartTime) {\n                prevSibling = nextSibling;\n                nextSibling = nextSibling._nextRep;\n                // Overrides all the next siblings if the next sibling starts at the same time of after as the new tween start time\n                if (nextSibling && nextSibling._absoluteStartTime >= absoluteStartTime) {\n                  while (nextSibling) {\n                    overrideTween(nextSibling);\n                    // This will ends both the current while loop and the upper one once all the next sibllings have been overriden\n                    nextSibling = nextSibling._nextRep;\n                  }\n                }\n              }\n            }\n\n            // Decompose values\n            if (isFromToValue) {\n              decomposeRawValue(isFromToArray ? getFunctionValue(tweenToValue[0], target, ti, tl) : tweenFromValue, fromTargetObject);\n              decomposeRawValue(isFromToArray ? getFunctionValue(tweenToValue[1], target, ti, tl, toFunctionStore) : tweenToValue, toTargetObject);\n              if (fromTargetObject.t === valueTypes.NUMBER) {\n                if (prevSibling) {\n                  if (prevSibling._valueType === valueTypes.UNIT) {\n                    fromTargetObject.t = valueTypes.UNIT;\n                    fromTargetObject.u = prevSibling._unit;\n                  }\n                } else {\n                  decomposeRawValue(\n                    getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles),\n                    decomposedOriginalValue\n                  );\n                  if (decomposedOriginalValue.t === valueTypes.UNIT) {\n                    fromTargetObject.t = valueTypes.UNIT;\n                    fromTargetObject.u = decomposedOriginalValue.u;\n                  }\n                }\n              }\n            } else {\n              if (hasToValue) {\n                decomposeRawValue(tweenToValue, toTargetObject);\n              } else {\n                if (prevTween) {\n                  decomposeTweenValue(prevTween, toTargetObject);\n                } else {\n                  // No need to get and parse the original value if the tween is part of a timeline and has a previous sibling part of the same timeline\n                  decomposeRawValue(parent && prevSibling && prevSibling.parent.parent === parent ? prevSibling._value :\n                  getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles), toTargetObject);\n                }\n              }\n              if (hasFromvalue) {\n                decomposeRawValue(tweenFromValue, fromTargetObject);\n              } else {\n                if (prevTween) {\n                  decomposeTweenValue(prevTween, fromTargetObject);\n                } else {\n                  decomposeRawValue(parent && prevSibling && prevSibling.parent.parent === parent ? prevSibling._value :\n                  // No need to get and parse the original value if the tween is part of a timeline and has a previous sibling part of the same timeline\n                  getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles), fromTargetObject);\n                }\n              }\n            }\n\n            // Apply operators\n            if (fromTargetObject.o) {\n              fromTargetObject.n = getRelativeValue(\n                !prevSibling ? decomposeRawValue(\n                  getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles),\n                  decomposedOriginalValue\n                ).n : prevSibling._toNumber,\n                fromTargetObject.n,\n                fromTargetObject.o\n              );\n            }\n\n            if (toTargetObject.o) {\n              toTargetObject.n = getRelativeValue(fromTargetObject.n, toTargetObject.n, toTargetObject.o);\n            }\n\n            // Values omogenisation in cases of type difference between \"from\" and \"to\"\n            if (fromTargetObject.t !== toTargetObject.t) {\n              if (fromTargetObject.t === valueTypes.COMPLEX || toTargetObject.t === valueTypes.COMPLEX) {\n                const complexValue = fromTargetObject.t === valueTypes.COMPLEX ? fromTargetObject : toTargetObject;\n                const notComplexValue = fromTargetObject.t === valueTypes.COMPLEX ? toTargetObject : fromTargetObject;\n                notComplexValue.t = valueTypes.COMPLEX;\n                notComplexValue.s = cloneArray(complexValue.s);\n                notComplexValue.d = complexValue.d.map(() => notComplexValue.n);\n              } else if (fromTargetObject.t === valueTypes.UNIT || toTargetObject.t === valueTypes.UNIT) {\n                const unitValue = fromTargetObject.t === valueTypes.UNIT ? fromTargetObject : toTargetObject;\n                const notUnitValue = fromTargetObject.t === valueTypes.UNIT ? toTargetObject : fromTargetObject;\n                notUnitValue.t = valueTypes.UNIT;\n                notUnitValue.u = unitValue.u;\n              } else if (fromTargetObject.t === valueTypes.COLOR || toTargetObject.t === valueTypes.COLOR) {\n                const colorValue = fromTargetObject.t === valueTypes.COLOR ? fromTargetObject : toTargetObject;\n                const notColorValue = fromTargetObject.t === valueTypes.COLOR ? toTargetObject : fromTargetObject;\n                notColorValue.t = valueTypes.COLOR;\n                notColorValue.s = colorValue.s;\n                notColorValue.d = [0, 0, 0, 1];\n              }\n            }\n\n            // Unit conversion\n            if (fromTargetObject.u !== toTargetObject.u) {\n              let valueToConvert = toTargetObject.u ? fromTargetObject : toTargetObject;\n              valueToConvert = convertValueUnit(/** @type {DOMTarget} */(target), valueToConvert, toTargetObject.u ? toTargetObject.u : fromTargetObject.u, false);\n              // TODO:\n              // convertValueUnit(target, to.u ? from : to, to.u ? to.u : from.u);\n            }\n\n            // Fill in non existing complex values\n            if (toTargetObject.d && fromTargetObject.d && (toTargetObject.d.length !== fromTargetObject.d.length)) {\n              const longestValue = fromTargetObject.d.length > toTargetObject.d.length ? fromTargetObject : toTargetObject;\n              const shortestValue = longestValue === fromTargetObject ? toTargetObject : fromTargetObject;\n              // TODO: Check if n should be used instead of 0 for default complex values\n              shortestValue.d = longestValue.d.map((_, i) => isUnd(shortestValue.d[i]) ? 0 : shortestValue.d[i]);\n              shortestValue.s = cloneArray(longestValue.s);\n            }\n\n            // Tween factory\n\n            // Rounding is necessary here to minimize floating point errors\n            const tweenUpdateDuration = round(+tweenDuration || minValue, 12);\n\n            /** @type {Tween} */\n            const tween = {\n              parent: this,\n              id: tweenId++,\n              property: propName,\n              target: target,\n              _value: null,\n              _func: toFunctionStore.func,\n              _ease: parseEasings(tweenEasing),\n              _fromNumbers: cloneArray(fromTargetObject.d),\n              _toNumbers: cloneArray(toTargetObject.d),\n              _strings: cloneArray(toTargetObject.s),\n              _fromNumber: fromTargetObject.n,\n              _toNumber: toTargetObject.n,\n              _numbers: cloneArray(fromTargetObject.d), // For additive tween and animatables\n              _number: fromTargetObject.n, // For additive tween and animatables\n              _unit: toTargetObject.u,\n              _modifier: tweenModifier,\n              _currentTime: 0,\n              _startTime: tweenStartTime,\n              _delay: +tweenDelay,\n              _updateDuration: tweenUpdateDuration,\n              _changeDuration: tweenUpdateDuration,\n              _absoluteStartTime: absoluteStartTime,\n              // NOTE: Investigate bit packing to stores ENUM / BOOL\n              _tweenType: tweenType,\n              _valueType: toTargetObject.t,\n              _composition: tweenComposition,\n              _isOverlapped: 0,\n              _isOverridden: 0,\n              _renderTransforms: 0,\n              _prevRep: null, // For replaced tween\n              _nextRep: null, // For replaced tween\n              _prevAdd: null, // For additive tween\n              _nextAdd: null, // For additive tween\n              _prev: null,\n              _next: null,\n            };\n\n            if (tweenComposition !== compositionTypes.none) {\n              composeTween(tween, siblings);\n            }\n\n            if (isNaN(firstTweenChangeStartTime)) {\n              firstTweenChangeStartTime = tween._startTime;\n            }\n            // Rounding is necessary here to minimize floating point errors\n            lastTweenChangeEndTime = round(tweenStartTime + tweenUpdateDuration, 12);\n            prevTween = tween;\n            animationAnimationLength++;\n\n            addChild(this, tween);\n\n          }\n\n          // Update animation timings with the added tweens properties\n\n          if (isNaN(iterationDelay) || firstTweenChangeStartTime < iterationDelay) {\n            iterationDelay = firstTweenChangeStartTime;\n          }\n\n          if (isNaN(iterationDuration) || lastTweenChangeEndTime > iterationDuration) {\n            iterationDuration = lastTweenChangeEndTime;\n          }\n\n          // TODO: Find a way to inline tween._renderTransforms = 1 here\n          if (tweenType === tweenTypes.TRANSFORM) {\n            lastTransformGroupIndex = animationAnimationLength - tweenIndex;\n            lastTransformGroupLength = animationAnimationLength;\n          }\n\n        }\n\n      }\n\n      // Set _renderTransforms to last transform property to correctly render the transforms list\n      if (!isNaN(lastTransformGroupIndex)) {\n        let i = 0;\n        forEachChildren(this, (/** @type {Tween} */tween) => {\n          if (i >= lastTransformGroupIndex && i < lastTransformGroupLength) {\n            tween._renderTransforms = 1;\n            if (tween._composition === compositionTypes.blend) {\n              forEachChildren(additive.animation, (/** @type {Tween} */additiveTween) => {\n                if (additiveTween.id === tween.id) {\n                  additiveTween._renderTransforms = 1;\n                }\n              });\n            }\n          }\n          i++;\n        });\n      }\n\n    }\n\n    if (!targetsLength) {\n      console.warn(`No target found. Make sure the element you're trying to animate is accessible before creating your animation.`);\n    }\n\n    if (iterationDelay) {\n      forEachChildren(this, (/** @type {Tween} */tween) => {\n        // If (startTime - delay) equals 0, this means the tween is at the begining of the animation so we need to trim the delay too\n        if (!(tween._startTime - tween._delay)) {\n          tween._delay -= iterationDelay;\n        }\n        tween._startTime -= iterationDelay;\n      });\n      iterationDuration -= iterationDelay;\n    } else {\n      iterationDelay = 0;\n    }\n\n    // Prevents iterationDuration to be NaN if no valid animatable props have been provided\n    // Prevents _iterationCount to be NaN if no valid animatable props have been provided\n    if (!iterationDuration) {\n      iterationDuration = minValue;\n      this.iterationCount = 0;\n    }\n    /** @type {TargetsArray} */\n    this.targets = parsedTargets;\n    /** @type {Number} */\n    this.duration = iterationDuration === minValue ? minValue : clampInfinity(((iterationDuration + this._loopDelay) * this.iterationCount) - this._loopDelay) || minValue;\n    /** @type {Callback<this>} */\n    this.onRender = onRender || animDefaults.onRender;\n    /** @type {EasingFunction} */\n    this._ease = animEase;\n    /** @type {Number} */\n    this._delay = iterationDelay;\n    // NOTE: I'm keeping delay values separated from offsets in timelines because delays can override previous tweens and it could be confusing to debug a timeline with overridden tweens and no associated visible delays.\n    // this._delay = parent ? 0 : iterationDelay;\n    // this._offset += parent ? iterationDelay : 0;\n    /** @type {Number} */\n    this.iterationDuration = iterationDuration;\n    /** @type {{}} */\n    this._inlineStyles = animInlineStyles;\n\n    if (!this._autoplay && shouldTriggerRender) this.onRender(this);\n  }\n\n  /**\n   * @param  {Number} newDuration\n   * @return {this}\n   */\n  stretch(newDuration) {\n    const currentDuration = this.duration;\n    if (currentDuration === normalizeTime(newDuration)) return this;\n    const timeScale = newDuration / currentDuration;\n    // NOTE: Find a better way to handle the stretch of an animation after stretch = 0\n    forEachChildren(this, (/** @type {Tween} */tween) => {\n      // Rounding is necessary here to minimize floating point errors\n      tween._updateDuration = normalizeTime(tween._updateDuration * timeScale);\n      tween._changeDuration = normalizeTime(tween._changeDuration * timeScale);\n      tween._currentTime *= timeScale;\n      tween._startTime *= timeScale;\n      tween._absoluteStartTime *= timeScale;\n    });\n    return super.stretch(newDuration);\n  }\n\n  /**\n   * @return {this}\n   */\n  refresh() {\n    forEachChildren(this, (/** @type {Tween} */tween) => {\n      const ogValue = getOriginalAnimatableValue(tween.target, tween.property, tween._tweenType);\n      decomposeRawValue(ogValue, decomposedOriginalValue);\n      tween._fromNumbers = cloneArray(decomposedOriginalValue.d);\n      tween._fromNumber = decomposedOriginalValue.n;\n      if (tween._func) {\n        decomposeRawValue(tween._func(), toTargetObject);\n        tween._toNumbers = cloneArray(toTargetObject.d);\n        tween._strings = cloneArray(toTargetObject.s);\n        tween._toNumber = toTargetObject.n;\n      }\n    });\n    return this;\n  }\n\n  /**\n   * Cancel the animation and revert all the values affected by this animation to their original state\n   * @return {this}\n   */\n  revert() {\n    super.revert();\n    return cleanInlineStyles(this);\n  }\n\n  /**\n   * @param  {Callback<this>} [callback]\n   * @return {Promise}\n   */\n  then(callback) {\n    return super.then(callback);\n  }\n\n}\n\n/**\n * @param {TargetsParam} targets\n * @param {AnimationParams} parameters\n * @return {JSAnimation}\n */\nconst animate = (targets, parameters) => new JSAnimation(targets, parameters, null, 0, false).init();\n\n\n\n\n/**\n * Converts an easing function into a valid CSS linear() timing function string\n * @param {EasingFunction} fn\n * @param {number} [samples=100]\n * @returns {string} CSS linear() timing function\n */\nconst easingToLinear = (fn, samples = 100) => {\n  const points = [];\n  for (let i = 0; i <= samples; i++) points.push(fn(i / samples));\n  return `linear(${points.join(', ')})`;\n};\n\nconst WAAPIEasesLookups = {\n  in: 'ease-in',\n  out: 'ease-out',\n  inOut: 'ease-in-out',\n};\n\nconst WAAPIeases = /*#__PURE__*/(() => {\n  const list = {};\n  for (let type in easeTypes) list[type] = a => easeTypes[type](easeInPower(a));\n  return /** @type {Record<String, EasingFunction>} */(list);\n})();\n\n/**\n * @param  {EasingParam} ease\n * @return {String}\n */\nconst parseWAAPIEasing = (ease) => {\n  let parsedEase = WAAPIEasesLookups[ease];\n  if (parsedEase) return parsedEase;\n  parsedEase = 'linear';\n  if (isStr(ease)) {\n    if (\n      stringStartsWith(ease, 'linear') ||\n      stringStartsWith(ease, 'cubic-') ||\n      stringStartsWith(ease, 'steps') ||\n      stringStartsWith(ease, 'ease')\n    ) {\n      parsedEase = ease;\n    } else if (stringStartsWith(ease, 'cubicB')) {\n      parsedEase = toLowerCase(ease);\n    } else {\n      const parsed = parseEaseString(ease, WAAPIeases, WAAPIEasesLookups);\n      if (isFnc(parsed)) parsedEase = parsed === none ? 'linear' : easingToLinear(parsed);\n    }\n    WAAPIEasesLookups[ease] = parsedEase;\n  } else if (isFnc(ease)) {\n    const easing = easingToLinear(ease);\n    if (easing) parsedEase = easing;\n  } else if (/** @type {Spring} */(ease).ease) {\n    parsedEase = easingToLinear(/** @type {Spring} */(ease).ease);\n  }\n  return parsedEase;\n};\n\n/**\n * @typedef {String|Number|Array<String>|Array<Number>} WAAPITweenValue\n */\n\n/**\n * @callback WAAPIFunctionvalue\n * @param {DOMTarget} target - The animated target\n * @param {Number} index - The target index\n * @param {Number} length - The total number of animated targets\n * @return {WAAPITweenValue}\n */\n\n/**\n * @typedef {WAAPITweenValue|WAAPIFunctionvalue|Array<String|Number|WAAPIFunctionvalue>} WAAPIKeyframeValue\n */\n\n/**\n * @typedef {(animation: WAAPIAnimation) => void} WAAPICallback\n */\n\n/**\n * @typedef {Object} WAAPITweenOptions\n * @property {WAAPIKeyframeValue} [to]\n * @property {WAAPIKeyframeValue} [from]\n * @property {Number|WAAPIFunctionvalue} [duration]\n * @property {Number|WAAPIFunctionvalue} [delay]\n * @property {EasingParam} [ease]\n * @property {CompositeOperation} [composition]\n */\n\n/**\n * @typedef {Object} WAAPIAnimationOptions\n * @property {Number|Boolean} [loop]\n * @property {Boolean} [Reversed]\n * @property {Boolean} [Alternate]\n * @property {Boolean|ScrollObserver} [autoplay]\n * @property {Number} [playbackRate]\n * @property {Number|WAAPIFunctionvalue} [duration]\n * @property {Number|WAAPIFunctionvalue} [delay]\n * @property {EasingParam} [ease]\n * @property {CompositeOperation} [composition]\n * @property {WAAPICallback} [onComplete]\n */\n\n/**\n * @typedef {Record<String, WAAPIKeyframeValue | WAAPIAnimationOptions | Boolean | ScrollObserver | WAAPICallback | EasingParam | WAAPITweenOptions> & WAAPIAnimationOptions} WAAPIAnimationParams\n */\n\nconst transformsShorthands = ['x', 'y', 'z'];\nconst commonDefaultPXProperties = [\n  'perspective',\n  'width',\n  'height',\n  'margin',\n  'padding',\n  'top',\n  'right',\n  'bottom',\n  'left',\n  'borderWidth',\n  'fontSize',\n  'borderRadius',\n  ...transformsShorthands\n];\n\nconst validIndividualTransforms = [...transformsShorthands, ...validTransforms.filter(t => ['X', 'Y', 'Z'].some(axis => t.endsWith(axis)))];\n\n// Setting it to true in case CSS.registerProperty is not supported will automatically skip the registration and fallback to no animation\nlet transformsPropertiesRegistered = isBrowser && (isUnd(CSS) || !Object.hasOwnProperty.call(CSS, 'registerProperty'));\n\nconst registerTransformsProperties = () => {\n  if (transformsPropertiesRegistered) return;\n  validTransforms.forEach(t => {\n    const isSkew = stringStartsWith(t, 'skew');\n    const isScale = stringStartsWith(t, 'scale');\n    const isRotate = stringStartsWith(t, 'rotate');\n    const isTranslate = stringStartsWith(t, 'translate');\n    const isAngle = isRotate || isSkew;\n    const syntax = isAngle ? '<angle>' : isScale ? \"<number>\" : isTranslate ? \"<length-percentage>\" : \"*\";\n    try {\n      CSS.registerProperty({\n        name: '--' + t,\n        syntax,\n        inherits: false,\n        initialValue: isTranslate ? '0px' : isAngle ? '0deg' : isScale ? '1' : '0',\n      });\n    } catch {}  });\n  transformsPropertiesRegistered = true;\n};\n\nconst WAAPIAnimationsLookups = {\n  _head: null,\n  _tail: null,\n};\n\n/**\n * @param {DOMTarget} $el\n * @param {String} [property]\n * @param {WAAPIAnimation} [parent]\n */\nconst removeWAAPIAnimation = ($el, property, parent) => {\n  let nextLookup = WAAPIAnimationsLookups._head;\n  while (nextLookup) {\n    const next = nextLookup._next;\n    const matchTarget = nextLookup.$el === $el;\n    const matchProperty = !property || nextLookup.property === property;\n    const matchParent = !parent || nextLookup.parent === parent;\n    if (matchTarget && matchProperty && matchParent) {\n      const anim = nextLookup.animation;\n      try { anim.commitStyles(); } catch {}      anim.cancel();\n      removeChild(WAAPIAnimationsLookups, nextLookup);\n      const lookupParent = nextLookup.parent;\n      if (lookupParent) {\n        lookupParent._completed++;\n        if (lookupParent.animations.length === lookupParent._completed) {\n          lookupParent.completed = true;\n          if (!lookupParent.muteCallbacks) {\n            lookupParent.paused = true;\n            lookupParent.onComplete(lookupParent);\n            lookupParent._resolve(lookupParent);\n          }\n        }\n      }\n    }\n    nextLookup = next;\n  }\n};\n\n/**\n * @param {WAAPIAnimation} parent\n * @param {DOMTarget} $el\n * @param {String} property\n * @param {PropertyIndexedKeyframes} keyframes\n * @param {KeyframeAnimationOptions} params\n * @retun {Animation}\n */\nconst addWAAPIAnimation = (parent, $el, property, keyframes, params) => {\n  const animation = $el.animate(keyframes, params);\n  const animTotalDuration = params.delay + (+params.duration * params.iterations);\n  animation.playbackRate = parent._speed;\n  if (parent.paused) animation.pause();\n  if (parent.duration < animTotalDuration) {\n    parent.duration = animTotalDuration;\n    parent.controlAnimation = animation;\n  }\n  parent.animations.push(animation);\n  removeWAAPIAnimation($el, property);\n  addChild(WAAPIAnimationsLookups, { parent, animation, $el, property, _next: null, _prev: null });\n  const handleRemove = () => { removeWAAPIAnimation($el, property, parent); };\n  animation.onremove = handleRemove;\n  animation.onfinish = handleRemove;\n  return animation;\n};\n\n/**\n * @param  {String} propName\n * @param  {WAAPIKeyframeValue} value\n * @param  {DOMTarget} $el\n * @param  {Number} i\n * @param  {Number} targetsLength\n * @return {String}\n */\nconst normalizeTweenValue = (propName, value, $el, i, targetsLength) => {\n  let v = getFunctionValue(/** @type {any} */(value), $el, i, targetsLength);\n  if (!isNum(v)) return v;\n  if (commonDefaultPXProperties.includes(propName) || stringStartsWith(propName, 'translate')) return `${v}px`;\n  if (stringStartsWith(propName, 'rotate') || stringStartsWith(propName, 'skew')) return `${v}deg`;\n  return `${v}`;\n};\n\n/**\n * @param  {DOMTarget} $el\n * @param  {String} propName\n * @param  {WAAPIKeyframeValue} from\n * @param  {WAAPIKeyframeValue} to\n * @param  {Number} i\n * @param  {Number} targetsLength\n * @return {WAAPITweenValue}\n */\nconst parseIndividualTweenValue = ($el, propName, from, to, i, targetsLength) => {\n  /** @type {WAAPITweenValue} */\n  let tweenValue = '0';\n  const computedTo = !isUnd(to) ? normalizeTweenValue(propName, to, $el, i, targetsLength) : getComputedStyle($el)[propName];\n  if (!isUnd(from)) {\n    const computedFrom = normalizeTweenValue(propName, from, $el, i, targetsLength);\n    tweenValue = [computedFrom, computedTo];\n  } else {\n    tweenValue = isArr(to) ? to.map((/** @type {any} */v) => normalizeTweenValue(propName, v, $el, i, targetsLength)) : computedTo;\n  }\n  return tweenValue;\n};\n\nclass WAAPIAnimation {\n/**\n * @param {DOMTargetsParam} targets\n * @param {WAAPIAnimationParams} params\n */\n  constructor(targets, params) {\n\n    if (globals.scope) globals.scope.revertibles.push(this);\n\n    registerTransformsProperties();\n\n    const parsedTargets = registerTargets(targets);\n    const targetsLength = parsedTargets.length;\n\n    if (!targetsLength) {\n      console.warn(`No target found. Make sure the element you're trying to animate is accessible before creating your animation.`);\n    }\n\n    const ease = setValue(params.ease, parseWAAPIEasing(globals.defaults.ease));\n    const spring = /** @type {Spring} */(ease).ease && ease;\n    const autoplay = setValue(params.autoplay, globals.defaults.autoplay);\n    const scroll = autoplay && /** @type {ScrollObserver} */(autoplay).link ? autoplay : false;\n    const alternate = params.alternate && /** @type {Boolean} */(params.alternate) === true;\n    const reversed = params.reversed && /** @type {Boolean} */(params.reversed) === true;\n    const loop = setValue(params.loop, globals.defaults.loop);\n    const iterations = /** @type {Number} */((loop === true || loop === Infinity) ? Infinity : isNum(loop) ? loop + 1 : 1);\n    /** @type {PlaybackDirection} */\n    const direction = alternate ? reversed ? 'alternate-reverse' : 'alternate' : reversed ? 'reverse' : 'normal';\n    /** @type {FillMode} */\n    const fill = 'forwards';\n    /** @type {String} */\n    const easing = parseWAAPIEasing(ease);\n    const timeScale = (globals.timeScale === 1 ? 1 : K);\n\n    /** @type {DOMTargetsArray}] */\n    this.targets = parsedTargets;\n    /** @type {Array<globalThis.Animation>}] */\n    this.animations = [];\n    /** @type {globalThis.Animation}] */\n    this.controlAnimation = null;\n    /** @type {Callback<this>} */\n    this.onComplete = params.onComplete || noop;\n    /** @type {Number} */\n    this.duration = 0;\n    /** @type {Boolean} */\n    this.muteCallbacks = false;\n    /** @type {Boolean} */\n    this.completed = false;\n    /** @type {Boolean} */\n    this.paused = !autoplay || scroll !== false;\n    /** @type {Boolean} */\n    this.reversed = reversed;\n    /** @type {Boolean|ScrollObserver} */\n    this.autoplay = autoplay;\n    /** @type {Number} */\n    this._speed = setValue(params.playbackRate, globals.defaults.playbackRate);\n    /** @type {Function} */\n    this._resolve = noop; // Used by .then()\n    /** @type {Number} */\n    this._completed = 0;\n    /** @type {Array<Object>}] */\n    this._inlineStyles = parsedTargets.map($el => $el.getAttribute('style'));\n\n    parsedTargets.forEach(($el, i) => {\n\n      const cachedTransforms = $el[transformsSymbol];\n\n      const hasIndividualTransforms = validIndividualTransforms.some(t => params.hasOwnProperty(t));\n\n      /** @type {Number} */\n      const duration = (spring ? /** @type {Spring} */(spring).duration : getFunctionValue(setValue(params.duration, globals.defaults.duration), $el, i, targetsLength)) * timeScale;\n      /** @type {Number} */\n      const delay = getFunctionValue(setValue(params.delay, globals.defaults.delay), $el, i, targetsLength) * timeScale;\n      /** @type {CompositeOperation} */\n      const composite = /** @type {CompositeOperation} */(setValue(params.composition, 'replace'));\n\n      for (let name in params) {\n        if (!isKey(name)) continue;\n        /** @type {PropertyIndexedKeyframes} */\n        const keyframes = {};\n        /** @type {KeyframeAnimationOptions} */\n        const tweenParams = { iterations, direction, fill, easing, duration, delay, composite };\n        const propertyValue = params[name];\n        const individualTransformProperty = hasIndividualTransforms ? validTransforms.includes(name) ? name : shortTransforms.get(name) : false;\n        let parsedPropertyValue;\n        if (isObj(propertyValue)) {\n          const tweenOptions = /** @type {WAAPITweenOptions} */(propertyValue);\n          const tweenOptionsEase = setValue(tweenOptions.ease, ease);\n          const tweenOptionsSpring = /** @type {Spring} */(tweenOptionsEase).ease && tweenOptionsEase;\n          const to = /** @type {WAAPITweenOptions} */(tweenOptions).to;\n          const from = /** @type {WAAPITweenOptions} */(tweenOptions).from;\n          /** @type {Number} */\n          tweenParams.duration = (tweenOptionsSpring ? /** @type {Spring} */(tweenOptionsSpring).duration : getFunctionValue(setValue(tweenOptions.duration, duration), $el, i, targetsLength)) * timeScale;\n          /** @type {Number} */\n          tweenParams.delay = getFunctionValue(setValue(tweenOptions.delay, delay), $el, i, targetsLength) * timeScale;\n          /** @type {CompositeOperation} */\n          tweenParams.composite = /** @type {CompositeOperation} */(setValue(tweenOptions.composition, composite));\n          /** @type {String} */\n          tweenParams.easing = parseWAAPIEasing(tweenOptionsEase);\n          parsedPropertyValue = parseIndividualTweenValue($el, name, from, to, i, targetsLength);\n          if (individualTransformProperty) {\n            keyframes[`--${individualTransformProperty}`] = parsedPropertyValue;\n            cachedTransforms[individualTransformProperty] = parsedPropertyValue;\n          } else {\n            keyframes[name] = parseIndividualTweenValue($el, name, from, to, i, targetsLength);\n          }\n          addWAAPIAnimation(this, $el, name, keyframes, tweenParams);\n          if (!isUnd(from)) {\n            if (!individualTransformProperty) {\n              $el.style[name] = keyframes[name][0];\n            } else {\n              const key = `--${individualTransformProperty}`;\n              $el.style.setProperty(key, keyframes[key][0]);\n            }\n          }\n        } else {\n          parsedPropertyValue = isArr(propertyValue) ?\n                                propertyValue.map((/** @type {any} */v) => normalizeTweenValue(name, v, $el, i, targetsLength)) :\n                                normalizeTweenValue(name, /** @type {any} */(propertyValue), $el, i, targetsLength);\n          if (individualTransformProperty) {\n            keyframes[`--${individualTransformProperty}`] = parsedPropertyValue;\n            cachedTransforms[individualTransformProperty] = parsedPropertyValue;\n          } else {\n            keyframes[name] = parsedPropertyValue;\n          }\n          addWAAPIAnimation(this, $el, name, keyframes, tweenParams);\n        }\n      }\n      if (hasIndividualTransforms) {\n        let transforms = emptyString;\n        for (let t in cachedTransforms) {\n          transforms += `${transformsFragmentStrings[t]}var(--${t})) `;\n        }\n        $el.style.transform = transforms;\n      }\n    });\n\n    if (scroll) {\n      /** @type {ScrollObserver} */(this.autoplay).link(this);\n    }\n  }\n\n  /**\n   * @callback forEachCallback\n   * @param {globalThis.Animation} animation\n   */\n\n  /**\n   * @param  {forEachCallback|String} callback\n   * @return {this}\n   */\n  forEach(callback) {\n    const cb = isStr(callback) ? a => a[callback]() : callback;\n    this.animations.forEach(cb);\n    return this;\n  }\n\n  get speed() {\n    return this._speed;\n  }\n\n  /** @param {Number} speed */\n  set speed(speed) {\n    this._speed = +speed;\n    this.forEach(anim => anim.playbackRate = speed);\n  }\n\n  get currentTime() {\n    const controlAnimation = this.controlAnimation;\n    const timeScale = globals.timeScale;\n    return this.completed ? this.duration : controlAnimation ? +controlAnimation.currentTime * (timeScale === 1 ? 1 : timeScale) : 0;\n  }\n\n  /** @param {Number} time */\n  set currentTime(time) {\n    const t = time * (globals.timeScale === 1 ? 1 : K);\n    this.forEach(anim => {\n      // Make sure the animation playState is not 'paused' in order to properly trigger an onfinish callback.\n      // The \"paused\" play state supersedes the \"finished\" play state; if the animation is both paused and finished, the \"paused\" state is the one that will be reported.\n      // https://developer.mozilla.org/en-US/docs/Web/API/Animation/finish_event\n      if (t >= this.duration) anim.play();\n      anim.currentTime = t;\n    });\n  }\n\n  get progress() {\n    return this.currentTime / this.duration;\n  }\n\n  /** @param {Number} progress */\n  set progress(progress) {\n    this.forEach(anim => anim.currentTime = progress * this.duration || 0);\n  }\n\n  resume() {\n    if (!this.paused) return this;\n    this.paused = false;\n    // TODO: Store the current time, and seek back to the last position\n    return this.forEach('play');\n  }\n\n  pause() {\n    if (this.paused) return this;\n    this.paused = true;\n    return this.forEach('pause');\n  }\n\n  alternate() {\n    this.reversed = !this.reversed;\n    this.forEach('reverse');\n    if (this.paused) this.forEach('pause');\n    return this;\n  }\n\n  play() {\n    if (this.reversed) this.alternate();\n    return this.resume();\n  }\n\n  reverse() {\n    if (!this.reversed) this.alternate();\n    return this.resume();\n  }\n\n /**\n  * @param {Number} time\n  * @param {Boolean} muteCallbacks\n  */\n  seek(time, muteCallbacks = false) {\n    if (muteCallbacks) this.muteCallbacks = true;\n    if (time < this.duration) this.completed = false;\n    this.currentTime = time;\n    this.muteCallbacks = false;\n    if (this.paused) this.pause();\n    return this;\n  }\n\n  restart() {\n    this.completed = false;\n    return this.seek(0, true).resume();\n  }\n\n  commitStyles() {\n    return this.forEach('commitStyles');\n  }\n\n  complete() {\n    return this.seek(this.duration);\n  }\n\n  cancel() {\n    this.forEach('cancel');\n    return this.pause();\n  }\n\n  revert() {\n    this.cancel();\n    this.targets.forEach(($el, i) => $el.setAttribute('style', this._inlineStyles[i]) );\n    return this;\n  }\n\n  /**\n   * @param  {WAAPICallback} [callback]\n   * @return {Promise}\n   */\n  then(callback = noop) {\n    const then = this.then;\n    const onResolve = () => {\n      this.then = null;\n      callback(this);\n      this.then = then;\n      this._resolve = noop;\n    };\n    return new Promise(r => {\n      this._resolve = () => r(onResolve());\n      if (this.completed) this._resolve();\n      return this;\n    });\n  }\n}\n\nconst waapi = {\n/**\n * @param {DOMTargetsParam} targets\n * @param {WAAPIAnimationParams} params\n * @return {WAAPIAnimation}\n */\n  animate: (targets, params) => new WAAPIAnimation(targets, params),\n  convertEase: easingToLinear\n};\n\n\n\n\n/**\n * @param  {Callback<Timer>} [callback]\n * @return {Timer}\n */\nconst sync = (callback = noop) => {\n  return new Timer({ duration: 1 * globals.timeScale, onComplete: callback }, null, 0).resume();\n};\n\n/**\n * @overload\n * @param  {DOMTargetSelector} targetSelector\n * @param  {String}            propName\n * @return {String}\n *\n * @overload\n * @param  {JSTargetsParam} targetSelector\n * @param  {String}         propName\n * @return {Number|String}\n *\n * @overload\n * @param  {DOMTargetsParam} targetSelector\n * @param  {String}          propName\n * @param  {String}          unit\n * @return {String}\n *\n * @overload\n * @param  {TargetsParam} targetSelector\n * @param  {String}       propName\n * @param  {Boolean}      unit\n * @return {Number}\n *\n * @param  {TargetsParam}   targetSelector\n * @param  {String}         propName\n * @param  {String|Boolean} [unit]\n */\nfunction getTargetValue(targetSelector, propName, unit) {\n  const targets = registerTargets(targetSelector);\n  if (!targets.length) return;\n  const [ target ] = targets;\n  const tweenType = getTweenType(target, propName);\n  const normalizePropName = sanitizePropertyName(propName, target, tweenType);\n  let originalValue = getOriginalAnimatableValue(target, normalizePropName);\n  if (isUnd(unit)) {\n    return originalValue;\n  } else {\n    decomposeRawValue(originalValue, decomposedOriginalValue);\n    if (decomposedOriginalValue.t === valueTypes.NUMBER || decomposedOriginalValue.t === valueTypes.UNIT) {\n      if (unit === false) {\n        return decomposedOriginalValue.n;\n      } else {\n        const convertedValue = convertValueUnit(/** @type {DOMTarget} */(target), decomposedOriginalValue, /** @type {String} */(unit), false);\n        return `${round(convertedValue.n, globals.precision)}${convertedValue.u}`;\n      }\n    }\n  }\n}\n\n/**\n * @param  {TargetsParam}    targets\n * @param  {AnimationParams} parameters\n * @return {JSAnimation}\n */\nconst setTargetValues = (targets, parameters) => {\n  if (isUnd(parameters)) return;\n  parameters.duration = minValue;\n  // Do not overrides currently active tweens by default\n  parameters.composition = setValue(parameters.composition, compositionTypes.none);\n  // Skip init() and force rendering by playing the animation\n  return new JSAnimation(targets, parameters, null, 0, true).resume();\n};\n\n/**\n * @param  {TargetsArray} targetsArray\n * @param  {JSAnimation}    animation\n * @param  {String}       [propertyName]\n * @return {Boolean}\n */\nconst removeTargetsFromAnimation = (targetsArray, animation, propertyName) => {\n  let tweensMatchesTargets = false;\n  forEachChildren(animation, (/**@type {Tween} */tween) => {\n    const tweenTarget = tween.target;\n    if (targetsArray.includes(tweenTarget)) {\n      const tweenName = tween.property;\n      const tweenType = tween._tweenType;\n      const normalizePropName = sanitizePropertyName(propertyName, tweenTarget, tweenType);\n      if (!normalizePropName || normalizePropName && normalizePropName === tweenName) {\n        // Make sure to flag the previous CSS transform tween to renderTransform\n        if (tween.parent._tail === tween &&\n            tween._tweenType === tweenTypes.TRANSFORM &&\n            tween._prev &&\n            tween._prev._tweenType === tweenTypes.TRANSFORM\n        ) {\n          tween._prev._renderTransforms = 1;\n        }\n        // Removes the tween from the selected animation\n        removeChild(animation, tween);\n        // Detach the tween from its siblings to make sure blended tweens are correctlly removed\n        removeTweenSliblings(tween);\n        tweensMatchesTargets = true;\n      }\n    }\n  }, true);\n  return tweensMatchesTargets;\n};\n\n/**\n * @param  {TargetsParam} targets\n * @param  {Renderable|WAAPIAnimation} [renderable]\n * @param  {String}                    [propertyName]\n * @return {TargetsArray}\n */\nconst remove = (targets, renderable, propertyName) => {\n  const targetsArray = parseTargets(targets);\n  const parent = /** @type {Renderable|typeof engine} **/(renderable ? renderable : engine);\n  const waapiAnimation = renderable && /** @type {WAAPIAnimation} */(renderable).controlAnimation && /** @type {WAAPIAnimation} */(renderable);\n  for (let i = 0, l = targetsArray.length; i < l; i++) {\n    const $el = /** @type {DOMTarget}  */(targetsArray[i]);\n    removeWAAPIAnimation($el, propertyName, waapiAnimation);\n  }\n  let removeMatches;\n  if (parent._hasChildren) {\n    let iterationDuration = 0;\n    forEachChildren(parent, (/** @type {Renderable} */child) => {\n      if (!child._hasChildren) {\n        removeMatches = removeTargetsFromAnimation(targetsArray, /** @type {JSAnimation} */(child), propertyName);\n        // Remove the child from its parent if no tweens and no children left after the removal\n        if (removeMatches && !child._head) {\n          child.cancel();\n          removeChild(parent, child);\n        } else {\n          // Calculate the new iterationDuration value to handle onComplete with last child in render()\n          const childTLOffset = child._offset + child._delay;\n          const childDur = childTLOffset + child.duration;\n          if (childDur > iterationDuration) {\n            iterationDuration = childDur;\n          }\n        }\n      }\n      // Make sure to also remove engine's children targets\n      // NOTE: Avoid recursion?\n      if (child._head) {\n        remove(targets, child, propertyName);\n      } else {\n        child._hasChildren = false;\n      }\n    }, true);\n    // Update iterationDuration value to handle onComplete with last child in render()\n    if (!isUnd(/** @type {Renderable} */(parent).iterationDuration)) {\n      /** @type {Renderable} */(parent).iterationDuration = iterationDuration;\n    }\n  } else {\n    removeMatches = removeTargetsFromAnimation(\n      targetsArray,\n      /** @type {JSAnimation} */(parent),\n      propertyName\n    );\n  }\n\n  if (removeMatches && !parent._head) {\n    parent._hasChildren = false;\n    // Cancel the parent if there are no tweens and no children left after the removal\n    // We have to check if the .cancel() method exist to handle cases where the parent is the engine itself\n    if (/** @type {Renderable} */(parent).cancel) /** @type {Renderable} */(parent).cancel();\n  }\n\n  return targetsArray;\n};\n\n/**\n * @param  {Number} min\n * @param  {Number} max\n * @param  {Number} [decimalLength]\n * @return {Number}\n */\nconst random = (min, max, decimalLength) => { const m = 10 ** (decimalLength || 0); return floor((Math.random() * (max - min + (1 / m)) + min) * m) / m };\n\n/**\n * @param  {String|Array} items\n * @return {any}\n */\nconst randomPick = items => items[random(0, items.length - 1)];\n\n/**\n * Adapted from https://bost.ocks.org/mike/shuffle/\n * @param  {Array} items\n * @return {Array}\n */\nconst shuffle = items => {\n  let m = items.length, t, i;\n  while (m) { i = random(0, --m); t = items[m]; items[m] = items[i]; items[i] = t; }\n  return items;\n};\n\n/**\n * @param  {Number|String} v\n * @param  {Number} decimalLength\n * @return {String}\n */\nconst roundPad = (v, decimalLength) => (+v).toFixed(decimalLength);\n\n/**\n * @param  {Number} v\n * @param  {Number} totalLength\n * @param  {String} padString\n * @return {String}\n */\nconst padStart = (v, totalLength, padString) => `${v}`.padStart(totalLength, padString);\n\n/**\n * @param  {Number} v\n * @param  {Number} totalLength\n * @param  {String} padString\n * @return {String}\n */\nconst padEnd = (v, totalLength, padString) => `${v}`.padEnd(totalLength, padString);\n\n/**\n * @param  {Number} v\n * @param  {Number} min\n * @param  {Number} max\n * @return {Number}\n */\nconst wrap = (v, min, max) => (((v - min) % (max - min) + (max - min)) % (max - min)) + min;\n\n/**\n * @param  {Number} value\n * @param  {Number} inLow\n * @param  {Number} inHigh\n * @param  {Number} outLow\n * @param  {Number} outHigh\n * @return {Number}\n */\nconst mapRange = (value, inLow, inHigh, outLow, outHigh) => outLow + ((value - inLow) / (inHigh - inLow)) * (outHigh - outLow);\n\n/**\n * @param  {Number} degrees\n * @return {Number}\n */\nconst degToRad = degrees => degrees * PI / 180;\n\n/**\n * @param  {Number} radians\n * @return {Number}\n */\nconst radToDeg = radians => radians * 180 / PI;\n\n/**\n * https://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\n * @param  {Number} start\n * @param  {Number} end\n * @param  {Number} amount\n * @param  {Renderable|Boolean} [renderable]\n * @return {Number}\n */\nconst lerp = (start, end, amount, renderable) => {\n  let dt = K / globals.defaults.frameRate;\n  if (renderable !== false) {\n    const ticker = /** @type Renderable */\n                   (renderable) ||\n                   (engine._hasChildren && engine);\n    if (ticker && ticker.deltaTime) {\n      dt = ticker.deltaTime;\n    }\n  }\n  const t = 1 - Math.exp(-amount * dt * .1);\n  return !amount ? start : amount === 1 ? end : (1 - t) * start + t * end;\n};\n\n// Chain-able utilities\n\n/**\n * @callback UtilityFunction\n * @param {...*} args\n * @return {Number|String}\n *\n * @param {UtilityFunction} fn\n * @param {Number} [last=0]\n * @return {function(...(Number|String)): function(Number|String): (Number|String)}\n */\nconst curry = (fn, last = 0) => (...args) => last ? v => fn(...args, v) : v => fn(v, ...args);\n\n/**\n * @param {Function} fn\n * @return {function(...(Number|String))}\n */\nconst chain = fn => {\n   return (...args) => {\n    const result = fn(...args);\n    return new Proxy(noop, {\n      apply: (_, __, [v]) => result(v),\n      get: (_, prop) => chain(/**@param {...Number|String} nextArgs */(...nextArgs) => {\n        const nextResult = utils[prop](...nextArgs);\n        return (/**@type {Number|String} */v) => nextResult(result(v));\n      })\n    });\n  }\n};\n\n/**\n * @param {UtilityFunction} fn\n * @param {Number} [right]\n * @return {function(...(Number|String)): UtilityFunction}\n */\nconst makeChainable = (fn, right = 0) => (...args) => (args.length < fn.length ? chain(curry(fn, right)) : fn)(...args);\n\n/**\n * @callback ChainedUtilsResult\n * @param {Number} value\n * @return {Number}\n *\n * @typedef {Object} ChainableUtils\n * @property {ChainedClamp} clamp\n * @property {ChainedRound} round\n * @property {ChainedSnap} snap\n * @property {ChainedWrap} wrap\n * @property {ChainedInterpolate} interpolate\n * @property {ChainedMapRange} mapRange\n * @property {ChainedRoundPad} roundPad\n * @property {ChainedPadStart} padStart\n * @property {ChainedPadEnd} padEnd\n * @property {ChainedDegToRad} degToRad\n * @property {ChainedRadToDeg} radToDeg\n *\n * @typedef {ChainableUtils & ChainedUtilsResult} ChainableUtil\n *\n * @callback ChainedClamp\n * @param {Number} min\n * @param {Number} max\n * @return {ChainableUtil}\n *\n * @callback ChainedRound\n * @param {Number} decimalLength\n * @return {ChainableUtil}\n *\n * @callback ChainedSnap\n * @param {Number} increment\n * @return {ChainableUtil}\n *\n * @callback ChainedWrap\n * @param {Number} min\n * @param {Number} max\n * @return {ChainableUtil}\n *\n * @callback ChainedInterpolate\n * @param {Number} start\n * @param {Number} end\n * @return {ChainableUtil}\n *\n * @callback ChainedMapRange\n * @param {Number} inLow\n * @param {Number} inHigh\n * @param {Number} outLow\n * @param {Number} outHigh\n * @return {ChainableUtil}\n *\n * @callback ChainedRoundPad\n * @param {Number} decimalLength\n * @return {ChainableUtil}\n *\n * @callback ChainedPadStart\n * @param {Number} totalLength\n * @param {String} padString\n * @return {ChainableUtil}\n *\n * @callback ChainedPadEnd\n * @param {Number} totalLength\n * @param {String} padString\n * @return {ChainableUtil}\n *\n * @callback ChainedDegToRad\n * @return {ChainableUtil}\n *\n * @callback ChainedRadToDeg\n * @return {ChainableUtil}\n */\n\nconst utils = {\n  $: registerTargets,\n  get: getTargetValue,\n  set: setTargetValues,\n  remove,\n  cleanInlineStyles,\n  random,\n  randomPick,\n  shuffle,\n  lerp,\n  sync,\n  clamp: /** @type {typeof clamp & ChainedClamp} */(makeChainable(clamp)),\n  round: /** @type {typeof round & ChainedRound} */(makeChainable(round)),\n  snap: /** @type {typeof snap & ChainedSnap} */(makeChainable(snap)),\n  wrap: /** @type {typeof wrap & ChainedWrap} */(makeChainable(wrap)),\n  interpolate: /** @type {typeof interpolate & ChainedInterpolate} */(makeChainable(interpolate, 1)),\n  mapRange: /** @type {typeof mapRange & ChainedMapRange} */(makeChainable(mapRange)),\n  roundPad: /** @type {typeof roundPad & ChainedRoundPad} */(makeChainable(roundPad)),\n  padStart: /** @type {typeof padStart & ChainedPadStart} */(makeChainable(padStart)),\n  padEnd: /** @type {typeof padEnd & ChainedPadEnd} */(makeChainable(padEnd)),\n  degToRad: /** @type {typeof degToRad & ChainedDegToRad} */(makeChainable(degToRad)),\n  radToDeg: /** @type {typeof radToDeg & ChainedRadToDeg} */(makeChainable(radToDeg)),\n};\n\n\n\n\n/**\n * @typedef {Number|String|Function} TimePosition\n */\n\n/**\n * Timeline's children offsets positions parser\n * @param  {Timeline} timeline\n * @param  {String} timePosition\n * @return {Number}\n */\nconst getPrevChildOffset = (timeline, timePosition) => {\n  if (stringStartsWith(timePosition, '<')) {\n    const goToPrevAnimationOffset = timePosition[1] === '<';\n    const prevAnimation = /** @type {Tickable} */(timeline._tail);\n    const prevOffset = prevAnimation ? prevAnimation._offset + prevAnimation._delay : 0;\n    return goToPrevAnimationOffset ? prevOffset : prevOffset + prevAnimation.duration;\n  }\n};\n\n/**\n * @param  {Timeline} timeline\n * @param  {TimePosition} [timePosition]\n * @return {Number}\n */\nconst parseTimelinePosition = (timeline, timePosition) => {\n  let tlDuration = timeline.iterationDuration;\n  if (tlDuration === minValue) tlDuration = 0;\n  if (isUnd(timePosition)) return tlDuration;\n  if (isNum(+timePosition)) return +timePosition;\n  const timePosStr = /** @type {String} */(timePosition);\n  const tlLabels = timeline ? timeline.labels : null;\n  const hasLabels = !isNil(tlLabels);\n  const prevOffset = getPrevChildOffset(timeline, timePosStr);\n  const hasSibling = !isUnd(prevOffset);\n  const matchedRelativeOperator = relativeValuesExecRgx.exec(timePosStr);\n  if (matchedRelativeOperator) {\n    const fullOperator = matchedRelativeOperator[0];\n    const split = timePosStr.split(fullOperator);\n    const labelOffset = hasLabels && split[0] ? tlLabels[split[0]] : tlDuration;\n    const parsedOffset = hasSibling ? prevOffset : hasLabels ? labelOffset : tlDuration;\n    const parsedNumericalOffset = +split[1];\n    return getRelativeValue(parsedOffset, parsedNumericalOffset, fullOperator[0]);\n  } else {\n    return hasSibling ? prevOffset :\n           hasLabels ? !isUnd(tlLabels[timePosStr]) ? tlLabels[timePosStr] :\n           tlDuration : tlDuration;\n  }\n};\n\n/**\n * @param {Timeline} tl\n * @return {Number}\n */\nfunction getTimelineTotalDuration(tl) {\n  return clampInfinity(((tl.iterationDuration + tl._loopDelay) * tl.iterationCount) - tl._loopDelay) || minValue;\n}\n\n/**\n * @overload\n * @param  {TimerParams} childParams\n * @param  {Timeline} tl\n * @param  {Number} timePosition\n * @return {Timeline}\n *\n * @overload\n * @param  {AnimationParams} childParams\n * @param  {Timeline} tl\n * @param  {Number} timePosition\n * @param  {TargetsParam} targets\n * @param  {Number} [index]\n * @param  {Number} [length]\n * @return {Timeline}\n *\n * @param  {TimerParams|AnimationParams} childParams\n * @param  {Timeline} tl\n * @param  {Number} timePosition\n * @param  {TargetsParam} [targets]\n * @param  {Number} [index]\n * @param  {Number} [length]\n */\nfunction addTlChild(childParams, tl, timePosition, targets, index, length) {\n  const isSetter = isNum(childParams.duration) && /** @type {Number} */(childParams.duration) <= minValue;\n  // Offset the tl position with -minValue for 0 duration animations or .set() calls in order to align their end value with the defined position\n  const adjustedPosition = isSetter ? timePosition - minValue : timePosition;\n  tick(tl, adjustedPosition, 1, 1, tickModes.AUTO);\n  const tlChild = targets ?\n    new JSAnimation(targets,/** @type {AnimationParams} */(childParams), tl, adjustedPosition, false, index, length) :\n    new Timer(/** @type {TimerParams} */(childParams), tl, adjustedPosition);\n  tlChild.init(1);\n  // TODO: Might be better to insert at a position relative to startTime?\n  addChild(tl, tlChild);\n  forEachChildren(tl, (/** @type {Renderable} */child) => {\n    const childTLOffset = child._offset + child._delay;\n    const childDur = childTLOffset + child.duration;\n    if (childDur > tl.iterationDuration) tl.iterationDuration = childDur;\n  });\n  tl.duration = getTimelineTotalDuration(tl);\n  return tl;\n}\n\nclass Timeline extends Timer {\n\n  /**\n   * @param {TimelineParams} [parameters]\n   */\n  constructor(parameters = {}) {\n    super(/** @type {TimerParams&TimelineParams} */(parameters), null, 0);\n    /** @type {Number} */\n    this.duration = 0; // TL duration starts at 0 and grows when adding children\n    /** @type {Record<String, Number>} */\n    this.labels = {};\n    const defaultsParams = parameters.defaults;\n    const globalDefaults = globals.defaults;\n    /** @type {DefaultsParams} */\n    this.defaults = defaultsParams ? mergeObjects(defaultsParams, globalDefaults) : globalDefaults;\n    /** @type {Callback<this>} */\n    this.onRender = parameters.onRender || globalDefaults.onRender;\n    const tlPlaybackEase = setValue(parameters.playbackEase, globalDefaults.playbackEase);\n    this._ease = tlPlaybackEase ? parseEasings(tlPlaybackEase) : null;\n    /** @type {Number} */\n    this.iterationDuration = 0;\n  }\n\n  /**\n   * @overload\n   * @param {TargetsParam} a1\n   * @param {AnimationParams} a2\n   * @param {TimePosition} [a3]\n   * @return {this}\n   *\n   * @overload\n   * @param {TimerParams} a1\n   * @param {TimePosition} [a2]\n   * @return {this}\n   *\n   * @param {TargetsParam|TimerParams} a1\n   * @param {AnimationParams|TimePosition} a2\n   * @param {TimePosition} [a3]\n   */\n  add(a1, a2, a3) {\n    const isAnim = isObj(a2);\n    const isTimer = isObj(a1);\n    if (isAnim || isTimer) {\n      this._hasChildren = true;\n      if (isAnim) {\n        const childParams = /** @type {AnimationParams} */(a2);\n        // Check for function for children stagger positions\n        if (isFnc(a3)) {\n          const staggeredPosition = /** @type {Function} */(a3);\n          const parsedTargetsArray = parseTargets(/** @type {TargetsParam} */(a1));\n          // Store initial duration before adding new children that will change the duration\n          const tlDuration = this.duration;\n          // Store initial _iterationDuration before adding new children that will change the duration\n          const tlIterationDuration = this.iterationDuration;\n          // Store the original id in order to add specific indexes to the new animations ids\n          const id = childParams.id;\n          let i = 0;\n          const parsedLength = parsedTargetsArray.length;\n          parsedTargetsArray.forEach((/** @type {Target} */target) => {\n            // Create a new parameter object for each staggered children\n            const staggeredChildParams = { ...childParams };\n            // Reset the duration of the timeline iteration before each stagger to prevent wrong start value calculation\n            this.duration = tlDuration;\n            this.iterationDuration = tlIterationDuration;\n            if (!isUnd(id)) staggeredChildParams.id = id + '-' + i;\n            addTlChild(\n              staggeredChildParams,\n              this,\n              staggeredPosition(target, i, parsedLength, this),\n              target,\n              i,\n              parsedLength\n            );\n            i++;\n          });\n        } else {\n          addTlChild(\n            childParams,\n            this,\n            parseTimelinePosition(this, a3),\n            /** @type {TargetsParam} */(a1),\n          );\n        }\n      } else {\n        // It's a Timer\n        addTlChild(\n          /** @type TimerParams */(a1),\n          this,\n          parseTimelinePosition(this,/** @type TimePosition */(a2)),\n        );\n      }\n      return this.init(1); // 1 = internalRender\n    }\n  }\n\n  /**\n   * @overload\n   * @param {Tickable} [synced]\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   * @overload\n   * @param {globalThis.Animation} [synced]\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   * @overload\n   * @param {WAAPIAnimation} [synced]\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   * @param {Tickable|WAAPIAnimation|globalThis.Animation} [synced]\n   * @param {TimePosition} [position]\n   */\n  sync(synced, position) {\n    if (isUnd(synced) || synced && isUnd(synced.pause)) return this;\n    synced.pause();\n    const duration = +(/** @type {globalThis.Animation} */(synced).effect ? /** @type {globalThis.Animation} */(synced).effect.getTiming().duration : /** @type {Tickable} */(synced).duration);\n    return this.add(synced, { currentTime: [0, duration], duration, ease: 'linear' }, position);\n  }\n\n  /**\n   * @param  {TargetsParam} targets\n   * @param  {AnimationParams} parameters\n   * @param  {TimePosition} [position]\n   * @return {this}\n   */\n  set(targets, parameters, position) {\n    if (isUnd(parameters)) return this;\n    parameters.duration = minValue;\n    parameters.composition = compositionTypes.replace;\n    return this.add(targets, parameters, position);\n  }\n\n  /**\n   * @param {Callback<Timer>} callback\n   * @param {TimePosition} [position]\n   * @return {this}\n   */\n  call(callback, position) {\n    if (isUnd(callback) || callback && !isFnc(callback)) return this;\n    return this.add({ duration: 0, onComplete: () => callback(this) }, position);\n  }\n\n  /**\n   * @param {String} labelName\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   */\n  label(labelName, position) {\n    if (isUnd(labelName) || labelName && !isStr(labelName)) return this;\n    this.labels[labelName] = parseTimelinePosition(this,/** @type TimePosition */(position));\n    return this;\n  }\n\n  /**\n   * @param  {TargetsParam} targets\n   * @param  {String} [propertyName]\n   * @return {this}\n   */\n  remove(targets, propertyName) {\n    remove(targets, this, propertyName);\n    return this;\n  }\n\n  /**\n   * @param  {Number} newDuration\n   * @return {this}\n   */\n  stretch(newDuration) {\n    const currentDuration = this.duration;\n    if (currentDuration === normalizeTime(newDuration)) return this;\n    const timeScale = newDuration / currentDuration;\n    const labels = this.labels;\n    forEachChildren(this, (/** @type {JSAnimation} */child) => child.stretch(child.duration * timeScale));\n    for (let labelName in labels) labels[labelName] *= timeScale;\n    return super.stretch(newDuration);\n  }\n\n  /**\n   * @return {this}\n   */\n  refresh() {\n    forEachChildren(this, (/** @type {JSAnimation} */child) => {\n      if (child.refresh) child.refresh();\n    });\n    return this;\n  }\n\n  /**\n   * @return {this}\n   */\n  revert() {\n    super.revert();\n    forEachChildren(this, (/** @type {JSAnimation} */child) => child.revert, true);\n    return cleanInlineStyles(this);\n  }\n\n  /**\n   * @param  {Callback<this>} [callback]\n   * @return {Promise}\n   */\n  then(callback) {\n    return super.then(callback);\n  }\n}\n\n/**\n * @param {TimelineParams} [parameters]\n * @return {Timeline}\n */\nconst createTimeline = parameters => new Timeline(parameters).init();\n\n\n\n\nclass Animatable {\n  /**\n   * @param {TargetsParam} targets\n   * @param {AnimatableParams} parameters\n   */\n  constructor(targets, parameters) {\n    if (globals.scope) globals.scope.revertibles.push(this);\n    /** @type {AnimationParams} */\n    const globalParams = {};\n    const properties = {};\n    this.targets = [];\n    this.animations = {};\n    if (isUnd(targets) || isUnd(parameters)) return;\n    for (let propName in parameters) {\n      const paramValue = parameters[propName];\n      if (isKey(propName)) {\n        properties[propName] = paramValue;\n      } else {\n        globalParams[propName] = paramValue;\n      }\n    }\n    for (let propName in properties) {\n      const propValue = properties[propName];\n      const isObjValue = isObj(propValue);\n      /** @type {TweenParamsOptions} */\n      let propParams = {};\n      let to = '+=0';\n      if (isObjValue) {\n        const unit = propValue.unit;\n        if (isStr(unit)) to += unit;\n      } else {\n        propParams.duration = propValue;\n      }\n      propParams[propName] = isObjValue ? mergeObjects({ to }, propValue) : to;\n      const animParams = mergeObjects(globalParams, propParams);\n      animParams.composition = compositionTypes.replace;\n      animParams.autoplay = false;\n      const animation = this.animations[propName] = new JSAnimation(targets, animParams, null, 0, false).init();\n      if (!this.targets.length) this.targets.push(...animation.targets);\n      /** @type {AnimatableProperty} */\n      this[propName] = (to, duration, ease) => {\n        const tween = /** @type {Tween} */(animation._head);\n        if (isUnd(to) && tween) {\n          const numbers = tween._numbers;\n          if (numbers && numbers.length) {\n            return numbers;\n          } else {\n            return tween._modifier(tween._number);\n          }\n        } else {\n          forEachChildren(animation, (/** @type {Tween} */tween) => {\n            if (isArr(to)) {\n              for (let i = 0, l = /** @type {Array} */(to).length; i < l; i++) {\n                if (!isUnd(tween._numbers[i])) {\n                  tween._fromNumbers[i] = /** @type {Number} */(tween._modifier(tween._numbers[i]));\n                  tween._toNumbers[i] = to[i];\n                }\n              }\n            } else {\n              tween._fromNumber = /** @type {Number} */(tween._modifier(tween._number));\n              tween._toNumber = /** @type {Number} */(to);\n            }\n            if (!isUnd(ease)) tween._ease = parseEasings(ease);\n            tween._currentTime = 0;\n          });\n          if (!isUnd(duration)) animation.stretch(duration);\n          animation.reset(1).resume();\n          return this;\n        }\n      };\n    }\n  }\n\n  revert() {\n    for (let propName in this.animations) {\n      this[propName] = noop;\n      this.animations[propName].revert();\n    }\n    this.animations = {};\n    this.targets.length = 0;\n    return this;\n  }\n}\n\n/**\n * @param {TargetsParam} targets\n * @param {AnimatableParams} parameters\n * @return {AnimatableObject}\n */\nconst createAnimatable = (targets, parameters) => /** @type {AnimatableObject} */(new Animatable(targets, parameters));\n\n\n\n\n/*\n * Spring ease solver adapted from https://webkit.org/demos/spring/spring.js\n * Webkit Copyright © 2016 Apple Inc\n */\n\n/**\n * @typedef {Object} SpringParams\n * @property {Number} [mass=1] - Mass, default 1\n * @property {Number} [stiffness=100] - Stiffness, default 100\n * @property {Number} [damping=10] - Damping, default 10\n * @property {Number} [velocity=0] - Initial velocity, default 0\n */\n\nclass Spring {\n  /**\n   * @param {SpringParams} [parameters]\n   */\n  constructor(parameters = {}) {\n    this.timeStep = .02; // Interval fed to the solver to calculate duration\n    this.restThreshold = .0005; // Values below this threshold are considered resting position\n    this.restDuration = 200; // Duration in ms used to check if the spring is resting after reaching restThreshold\n    this.maxDuration = 60000; // The maximum allowed spring duration in ms (default 1 min)\n    this.maxRestSteps = this.restDuration / this.timeStep / K; // How many steps allowed after reaching restThreshold before stopping the duration calculation\n    this.maxIterations = this.maxDuration / this.timeStep / K; // Calculate the maximum iterations allowed based on maxDuration\n    this.m = clamp(setValue(parameters.mass, 1), 0, K);\n    this.s = clamp(setValue(parameters.stiffness, 100), 1, K);\n    this.d = clamp(setValue(parameters.damping, 10), .1, K);\n    this.v = clamp(setValue(parameters.velocity, 0), -1e3, K);\n    this.w0 = 0;\n    this.zeta = 0;\n    this.wd = 0;\n    this.b = 0;\n    this.solverDuration = 0;\n    this.duration = 0;\n    this.compute();\n    /** @type {EasingFunction} */\n    this.ease = t => t === 0 || t === 1 ? t : this.solve(t * this.solverDuration);\n  }\n\n  /** @type {EasingFunction} */\n  solve(time) {\n    const { zeta, w0, wd, b } = this;\n    let t = time;\n    if (zeta < 1) {\n      t = exp(-t * zeta * w0) * (1 * cos(wd * t) + b * sin(wd * t));\n    } else {\n      t = (1 + b * t) * exp(-t * w0);\n    }\n    return 1 - t;\n  }\n\n  compute() {\n    const { maxRestSteps, maxIterations, restThreshold, timeStep, m, d, s, v } = this;\n    const w0 = this.w0 = clamp(sqrt(s / m), minValue, K);\n    const zeta = this.zeta = d / (2 * sqrt(s * m));\n    const wd = this.wd = zeta < 1 ? w0 * sqrt(1 - zeta * zeta) : 0;\n    this.b = zeta < 1 ? (zeta * w0 + -v) / wd : -v + w0;\n    let solverTime = 0;\n    let restSteps = 0;\n    let iterations = 0;\n    while (restSteps < maxRestSteps && iterations < maxIterations) {\n      if (abs(1 - this.solve(solverTime)) < restThreshold) {\n        restSteps++;\n      } else {\n        restSteps = 0;\n      }\n      this.solverDuration = solverTime;\n      solverTime += timeStep;\n      iterations++;\n    }\n    this.duration = round(this.solverDuration * K, 0) * globals.timeScale;\n  }\n\n  get mass() {\n    return this.m;\n  }\n\n  set mass(v) {\n    this.m = clamp(setValue(v, 1), 0, K);\n    this.compute();\n  }\n\n  get stiffness() {\n    return this.s;\n  }\n\n  set stiffness(v) {\n    this.s = clamp(setValue(v, 100), 1, K);\n    this.compute();\n  }\n\n  get damping() {\n    return this.d;\n  }\n\n  set damping(v) {\n    this.d = clamp(setValue(v, 10), .1, K);\n    this.compute();\n  }\n\n  get velocity() {\n    return this.v;\n  }\n\n  set velocity(v) {\n    this.v = clamp(setValue(v, 0), -1e3, K);\n    this.compute();\n  }\n}\n\n/**\n * @param {SpringParams} [parameters]\n * @returns {Spring}\n */\nconst createSpring = (parameters) => new Spring(parameters);\n\n\n\n\n/**\n * @param {Event} e\n */\nconst preventDefault = e => {\n  if (e.cancelable) e.preventDefault();\n};\n\nclass DOMProxy {\n  /** @param {Object} el */\n  constructor(el) {\n    this.el = el;\n    this.zIndex = 0;\n    this.parentElement = null;\n    this.classList = {\n      add: noop,\n      remove: noop,\n    };\n  }\n\n  get x() { return this.el.x || 0 };\n  set x(v) { this.el.x = v; };\n\n  get y() { return this.el.y || 0 };\n  set y(v) { this.el.y = v; };\n\n  get width() { return this.el.width || 0 };\n  set width(v) { this.el.width = v; };\n\n  get height() { return this.el.height || 0 };\n  set height(v) { this.el.height = v; };\n\n  getBoundingClientRect() {\n    return {\n      top: this.y,\n      right: this.x,\n      bottom: this.y + this.height,\n      left: this.x + this.width,\n    }\n  }\n}\n\nclass Transforms {\n  /**\n   * @param {DOMTarget|DOMProxy} $el\n   */\n  constructor($el) {\n    this.$el = $el;\n    this.inlineTransforms = [];\n    this.point = new DOMPoint();\n    this.inversedMatrix = this.getMatrix().inverse();\n  }\n\n  /**\n   * @param {Number} x\n   * @param {Number} y\n   * @return {DOMPoint}\n   */\n  normalizePoint(x, y) {\n    this.point.x = x;\n    this.point.y = y;\n    return this.point.matrixTransform(this.inversedMatrix);\n  }\n\n  /**\n   * @callback TraverseParentsCallback\n   * @param {DOMTarget} $el\n   * @param {Number} i\n   */\n\n  /**\n   * @param {TraverseParentsCallback} cb\n   */\n  traverseUp(cb) {\n    let $el = /** @type {DOMTarget|Document} */(this.$el.parentElement), i = 0;\n    while ($el && $el !== doc) {\n      cb(/** @type {DOMTarget} */($el), i);\n      $el = /** @type {DOMTarget} */($el.parentElement);\n      i++;\n    }\n  }\n\n  getMatrix() {\n    const matrix = new DOMMatrix();\n    this.traverseUp($el => {\n      const transformValue = getComputedStyle($el).transform;\n      if (transformValue) {\n        const elMatrix = new DOMMatrix(transformValue);\n        matrix.preMultiplySelf(elMatrix);\n      }\n    });\n    return matrix;\n  }\n\n  remove() {\n    this.traverseUp(($el, i) => {\n      this.inlineTransforms[i] = $el.style.transform;\n      $el.style.transform = 'none';\n    });\n  }\n\n  revert() {\n    this.traverseUp(($el, i) => {\n      const ct = this.inlineTransforms[i];\n      if (ct === '') {\n        $el.style.removeProperty('transform');\n      } else {\n        $el.style.transform = ct;\n      }\n    });\n  }\n}\n\n/**\n * @template {Array<Number>|DOMTargetSelector|String|Number|Boolean|Function|DraggableCursorParams} T\n * @param {T | ((draggable: Draggable) => T)} value\n * @param {Draggable} draggable\n * @return {T}\n */\nconst parseDraggableFunctionParameter = (value, draggable) => value && isFnc(value) ? /** @type {Function} */(value)(draggable) : value;\n\nlet zIndex = 0;\n\nclass Draggable {\n  /**\n   * @param {TargetsParam} target\n   * @param {DraggableParams} [parameters]\n   */\n  constructor(target, parameters = {}) {\n    if (!target) return;\n    if (globals.scope) globals.scope.revertibles.push(this);\n    const paramX = parameters.x;\n    const paramY = parameters.y;\n    const trigger = parameters.trigger;\n    const modifier = parameters.modifier;\n    const ease = parameters.releaseEase;\n    const customEase = ease && parseEasings(ease);\n    const hasSpring = !isUnd(ease) && !isUnd(/** @type {Spring} */(ease).ease);\n    const xProp = /** @type {String} */(isObj(paramX) && !isUnd(/** @type {Object} */(paramX).mapTo) ? /** @type {Object} */(paramX).mapTo : 'translateX');\n    const yProp = /** @type {String} */(isObj(paramY) && !isUnd(/** @type {Object} */(paramY).mapTo) ? /** @type {Object} */(paramY).mapTo : 'translateY');\n    const container = parseDraggableFunctionParameter(parameters.container, this);\n    this.containerArray = isArr(container) ? container : null;\n    this.$container = /** @type {HTMLElement} */(container && !this.containerArray ? parseTargets(/** @type {DOMTarget} */(container))[0] : doc.body);\n    this.useWin = this.$container === doc.body;\n    /** @type {Window | HTMLElement} */\n    this.$scrollContainer = this.useWin ? win : this.$container;\n    this.$target = /** @type {HTMLElement} */(isObj(target) ? new DOMProxy(target) : parseTargets(target)[0]);\n    this.$trigger = /** @type {HTMLElement} */(parseTargets(trigger ? trigger : target)[0]);\n    this.fixed = getTargetValue(this.$target, 'position') === 'fixed';\n    // Refreshable parameters\n    this.isFinePointer = true;\n    /** @type {[Number, Number, Number, Number]} */\n    this.containerPadding = [0, 0, 0, 0];\n    /** @type {Number} */\n    this.containerFriction = 0;\n    /** @type {Number} */\n    this.releaseContainerFriction = 0;\n    /** @type {Number|Array<Number>} */\n    this.snapX = 0;\n    /** @type {Number|Array<Number>} */\n    this.snapY = 0;\n    /** @type {Number} */\n    this.scrollSpeed = 0;\n    /** @type {Number} */\n    this.scrollThreshold = 0;\n    /** @type {Number} */\n    this.dragSpeed = 0;\n    /** @type {Number} */\n    this.maxVelocity = 0;\n    /** @type {Number} */\n    this.minVelocity = 0;\n    /** @type {Number} */\n    this.velocityMultiplier = 0;\n    /** @type {Boolean|DraggableCursorParams} */\n    this.cursor = false;\n    /** @type {Spring} */\n    this.releaseXSpring = hasSpring ? /** @type {Spring} */(ease) : createSpring({\n      mass: setValue(parameters.releaseMass, 1),\n      stiffness: setValue(parameters.releaseStiffness, 80),\n      damping: setValue(parameters.releaseDamping, 20),\n    });\n    /** @type {Spring} */\n    this.releaseYSpring = hasSpring ? /** @type {Spring} */(ease) : createSpring({\n      mass: setValue(parameters.releaseMass, 1),\n      stiffness: setValue(parameters.releaseStiffness, 80),\n      damping: setValue(parameters.releaseDamping, 20),\n    });\n    /** @type {EasingFunction} */\n    this.releaseEase = customEase || eases.outQuint;\n    /** @type {Boolean} */\n    this.hasReleaseSpring = hasSpring;\n    /** @type {Callback<this>} */\n    this.onGrab = parameters.onGrab || noop;\n    /** @type {Callback<this>} */\n    this.onDrag = parameters.onDrag || noop;\n    /** @type {Callback<this>} */\n    this.onRelease = parameters.onRelease || noop;\n    /** @type {Callback<this>} */\n    this.onUpdate = parameters.onUpdate || noop;\n    /** @type {Callback<this>} */\n    this.onSettle = parameters.onSettle || noop;\n    /** @type {Callback<this>} */\n    this.onSnap = parameters.onSnap || noop;\n    /** @type {Callback<this>} */\n    this.onResize = parameters.onResize || noop;\n    /** @type {Callback<this>} */\n    this.onAfterResize = parameters.onAfterResize || noop;\n    /** @type {[Number, Number]} */\n    this.disabled = [0, 0];\n    /** @type {AnimatableParams} */\n    const animatableParams = {};\n    if (modifier) animatableParams.modifier = modifier;\n    if (isUnd(paramX) || paramX === true) {\n      animatableParams[xProp] = 0;\n    } else if (isObj(paramX)) {\n      const paramXObject = /** @type {DraggableAxisParam} */(paramX);\n      const animatableXParams = {};\n      if (paramXObject.modifier) animatableXParams.modifier = paramXObject.modifier;\n      if (paramXObject.composition) animatableXParams.composition = paramXObject.composition;\n      animatableParams[xProp] = animatableXParams;\n    } else if (paramX === false) {\n      animatableParams[xProp] = 0;\n      this.disabled[0] = 1;\n    }\n    if (isUnd(paramY) || paramY === true) {\n      animatableParams[yProp] = 0;\n    } else if (isObj(paramY)) {\n      const paramYObject = /** @type {DraggableAxisParam} */(paramY);\n      const animatableYParams = {};\n      if (paramYObject.modifier) animatableYParams.modifier = paramYObject.modifier;\n      if (paramYObject.composition) animatableYParams.composition = paramYObject.composition;\n      animatableParams[yProp] = animatableYParams;\n    } else if (paramY === false) {\n      animatableParams[yProp] = 0;\n      this.disabled[1] = 1;\n    }\n    /** @type {AnimatableObject} */\n    this.animate = /** @type {AnimatableObject} */(new Animatable(this.$target, animatableParams));\n    // Internal props\n    this.xProp = xProp;\n    this.yProp = yProp;\n    this.destX = 0;\n    this.destY = 0;\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.scroll = {x: 0, y: 0};\n    /** @type {[Number, Number, Number, Number]} */\n    this.coords = [this.x, this.y, 0, 0]; // x, y, temp x, temp y\n    /** @type {[Number, Number]} */\n    this.snapped = [0, 0]; // x, y\n    /** @type {[Number, Number, Number, Number, Number, Number, Number, Number]} */\n    this.pointer = [0, 0, 0, 0, 0, 0, 0, 0]; // x1, y1, x2, y2, temp x1, temp y1, temp x2, temp y2\n    /** @type {[Number, Number]} */\n    this.scrollView = [0, 0]; // w, h\n    /** @type {[Number, Number, Number, Number]} */\n    this.dragArea = [0, 0, 0, 0]; // x, y, w, h\n    /** @type {[Number, Number, Number, Number]} */\n    this.containerBounds = [-1e12, maxValue, maxValue, -1e12]; // t, r, b, l\n    /** @type {[Number, Number, Number, Number]} */\n    this.scrollBounds = [0, 0, 0, 0]; // t, r, b, l\n    /** @type {[Number, Number, Number, Number]} */\n    this.targetBounds = [0, 0, 0, 0]; // t, r, b, l\n    /** @type {[Number, Number]} */\n    this.window = [0, 0]; // w, h\n    /** @type {[Number, Number, Number]} */\n    this.velocityStack = [0, 0, 0];\n    /** @type {Number} */\n    this.velocityStackIndex = 0;\n    /** @type {Number} */\n    this.velocityTime = now();\n    /** @type {Number} */\n    this.velocity = 0;\n    /** @type {Number} */\n    this.angle = 0;\n    /** @type {JSAnimation} */\n    this.cursorStyles = null;\n    /** @type {JSAnimation} */\n    this.triggerStyles = null;\n    /** @type {JSAnimation} */\n    this.bodyStyles = null;\n    /** @type {JSAnimation} */\n    this.targetStyles = null;\n    /** @type {JSAnimation} */\n    this.touchActionStyles = null;\n    this.transforms = new Transforms(this.$target);\n    this.overshootCoords = { x: 0, y: 0 };\n    this.overshootXTicker = new Timer({ autoplay: false }, null, 0).init();\n    this.overshootYTicker = new Timer({ autoplay: false }, null, 0).init();\n    this.updateTicker = new Timer({ autoplay: false }, null, 0).init();\n    this.overshootXTicker.onUpdate = () => {\n      if (this.disabled[0]) return;\n      this.updated = true;\n      this.manual = true;\n      this.animate[this.xProp](this.overshootCoords.x, 0);\n    };\n    this.overshootXTicker.onComplete = () => {\n      if (this.disabled[0]) return;\n      this.manual = false;\n      this.animate[this.xProp](this.overshootCoords.x, 0);\n    };\n    this.overshootYTicker.onUpdate = () => {\n      if (this.disabled[1]) return;\n      this.updated = true;\n      this.manual = true;\n      this.animate[this.yProp](this.overshootCoords.y, 0);\n    };\n    this.overshootYTicker.onComplete = () => {\n      if (this.disabled[1]) return;\n      this.manual = false;\n      this.animate[this.yProp](this.overshootCoords.y, 0);\n    };\n    this.updateTicker.onUpdate = () => this.update();\n    this.contained = !isUnd(container);\n    this.manual = false;\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = false;\n    this.released = false;\n    this.canScroll = false;\n    this.enabled = false;\n    this.initialized = false;\n    this.activeProp = this.disabled[1] ? xProp : yProp;\n    this.animate.animations[this.activeProp].onRender = () => {\n      const hasUpdated = this.updated;\n      const hasMoved = this.grabbed && hasUpdated;\n      const hasReleased = !hasMoved && this.released;\n      const x = this.x;\n      const y = this.y;\n      const dx = x - this.coords[2];\n      const dy = y - this.coords[3];\n      this.deltaX = dx;\n      this.deltaY = dy;\n      this.coords[2] = x;\n      this.coords[3] = y;\n      if (hasUpdated) {\n        this.onUpdate(this);\n      }\n      if (!hasReleased) {\n        this.updated = false;\n      } else {\n        this.computeVelocity(dx, dy);\n        this.angle = atan2(dy, dx);\n      }\n    };\n    this.animate.animations[this.activeProp].onComplete = () => {\n      if ((!this.grabbed && this.released)) {\n        // Set eleased to false before calling onSettle to avoid recursion\n        this.released = false;\n      }\n      if (!this.manual) {\n        this.deltaX = 0;\n        this.deltaY = 0;\n        this.velocity = 0;\n        this.velocityStack[0] = 0;\n        this.velocityStack[1] = 0;\n        this.velocityStack[2] = 0;\n        this.velocityStackIndex = 0;\n        this.onSettle(this);\n      }\n    };\n    this.resizeTicker = new Timer({\n      autoplay: false,\n      duration: 150 * globals.timeScale,\n      onComplete: () => {\n        this.onResize(this);\n        this.refresh();\n        this.onAfterResize(this);\n      },\n    }).init();\n    this.parameters = parameters;\n    this.resizeObserver = new ResizeObserver(() => {\n      if (this.initialized) {\n        this.resizeTicker.restart();\n      } else {\n        this.initialized = true;\n      }\n    });\n    this.enable();\n    this.refresh();\n    this.resizeObserver.observe(this.$container);\n    if (!isObj(target)) this.resizeObserver.observe(this.$target);\n  }\n\n  /**\n   * @param  {Number} dx\n   * @param  {Number} dy\n   * @return {Number}\n   */\n  computeVelocity(dx, dy) {\n    const prevTime = this.velocityTime;\n    const curTime = now();\n    const elapsed = curTime - prevTime;\n    if (elapsed < 17) return this.velocity;\n    this.velocityTime = curTime;\n    const velocityStack = this.velocityStack;\n    const vMul = this.velocityMultiplier;\n    const minV = this.minVelocity;\n    const maxV = this.maxVelocity;\n    const vi = this.velocityStackIndex;\n    velocityStack[vi] = round(clamp((sqrt(dx * dx + dy * dy) / elapsed) * vMul, minV, maxV), 5);\n    const velocity = max(velocityStack[0], velocityStack[1], velocityStack[2]);\n    this.velocity = velocity;\n    this.velocityStackIndex = (vi + 1) % 3;\n    return velocity;\n  }\n\n  /**\n   * @param {Number}  x\n   * @param {Boolean} [muteUpdateCallback]\n   * @return {this}\n   */\n  setX(x, muteUpdateCallback = false) {\n    if (this.disabled[0]) return;\n    const v = round(x, 5);\n    this.overshootXTicker.pause();\n    this.manual = true;\n    this.updated = !muteUpdateCallback;\n    this.destX = v;\n    this.snapped[0] = snap(v, this.snapX);\n    this.animate[this.xProp](v, 0);\n    this.manual = false;\n    return this;\n  }\n\n  /**\n   * @param {Number}  y\n   * @param {Boolean} [muteUpdateCallback]\n   * @return {this}\n   */\n  setY(y, muteUpdateCallback = false) {\n    if (this.disabled[1]) return;\n    const v = round(y, 5);\n    this.overshootYTicker.pause();\n    this.manual = true;\n    this.updated = !muteUpdateCallback;\n    this.destY = v;\n    this.snapped[1] = snap(v, this.snapY);\n    this.animate[this.yProp](v, 0);\n    this.manual = false;\n    return this;\n  }\n\n  get x() {\n    return round(/** @type {Number} */(this.animate[this.xProp]()), globals.precision);\n  }\n\n  set x(x) {\n    this.setX(x, false);\n  }\n\n  get y() {\n    return round(/** @type {Number} */(this.animate[this.yProp]()), globals.precision);\n  }\n\n  set y(y) {\n    this.setY(y, false);\n  }\n\n  get progressX() {\n    return mapRange(this.x, this.containerBounds[3], this.containerBounds[1], 0, 1);\n  }\n\n  set progressX(x) {\n    this.setX(mapRange(x, 0, 1, this.containerBounds[3], this.containerBounds[1]), false);\n  }\n\n  get progressY() {\n    return mapRange(this.y, this.containerBounds[0], this.containerBounds[2], 0, 1);\n  }\n\n  set progressY(y) {\n    this.setY(mapRange(y, 0, 1, this.containerBounds[0], this.containerBounds[2]), false);\n  }\n\n  updateScrollCoords() {\n    const sx = round(this.useWin ? win.scrollX : this.$container.scrollLeft, 0);\n    const sy = round(this.useWin ? win.scrollY : this.$container.scrollTop, 0);\n    const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n    const threshold = this.scrollThreshold;\n    this.scroll.x = sx;\n    this.scroll.y = sy;\n    this.scrollBounds[0] = sy - this.targetBounds[0] + cpt - threshold;\n    this.scrollBounds[1] = sx - this.targetBounds[1] - cpr + threshold;\n    this.scrollBounds[2] = sy - this.targetBounds[2] - cpb + threshold;\n    this.scrollBounds[3] = sx - this.targetBounds[3] + cpl - threshold;\n  }\n\n  updateBoundingValues() {\n    const $container = this.$container;\n    const cx = this.x;\n    const cy = this.y;\n    const cx2 = this.coords[2];\n    const cy2 =  this.coords[3];\n    // Prevents interfering with the scroll area in cases the target is outside of the container\n    // Make sure the temp coords are also adjuset to prevents wrong delta calculation on updates\n    this.coords[2] = 0;\n    this.coords[3] = 0;\n    this.setX(0, true);\n    this.setY(0, true);\n    this.transforms.remove();\n    const iw = this.window[0] = win.innerWidth;\n    const ih = this.window[1] = win.innerHeight;\n    const uw = this.useWin;\n    const sw = $container.scrollWidth;\n    const sh = $container.scrollHeight;\n    const fx = this.fixed;\n    const transformContainerRect = $container.getBoundingClientRect();\n    const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n    this.dragArea[0] = uw ? 0 : transformContainerRect.left;\n    this.dragArea[1] = uw ? 0 : transformContainerRect.top;\n    this.scrollView[0] = uw ? clamp(sw, iw, sw) : sw;\n    this.scrollView[1] = uw ? clamp(sh, ih, sh) : sh;\n    this.updateScrollCoords();\n    const { width, height, left, top, right, bottom } = $container.getBoundingClientRect();\n    this.dragArea[2] = round(uw ? clamp(width, iw, iw) : width, 0);\n    this.dragArea[3] = round(uw ? clamp(height, ih, ih) : height, 0);\n    const containerOverflow = getTargetValue($container, 'overflow');\n    const visibleOverflow = containerOverflow === 'visible';\n    const hiddenOverflow = containerOverflow === 'hidden';\n    this.canScroll = fx ? false :\n      this.contained &&\n      (($container === doc.body && visibleOverflow) || (!hiddenOverflow && !visibleOverflow)) &&\n      (sw > this.dragArea[2] + cpl - cpr || sh > this.dragArea[3] + cpt - cpb) &&\n      (!this.containerArray || (this.containerArray && !isArr(this.containerArray)));\n    if (this.contained) {\n      const sx = this.scroll.x;\n      const sy = this.scroll.y;\n      const canScroll = this.canScroll;\n      const targetRect = this.$target.getBoundingClientRect();\n      const hiddenLeft = canScroll ? uw ? 0 : $container.scrollLeft : 0;\n      const hiddenTop = canScroll ? uw ? 0 : $container.scrollTop : 0;\n      const hiddenRight = canScroll ? this.scrollView[0] - hiddenLeft - width : 0;\n      const hiddenBottom = canScroll ? this.scrollView[1] - hiddenTop - height : 0;\n      this.targetBounds[0] = round((targetRect.top + sy) - (uw ? 0 : top), 0);\n      this.targetBounds[1] = round((targetRect.right + sx) - (uw ? iw : right), 0);\n      this.targetBounds[2] = round((targetRect.bottom + sy) - (uw ? ih : bottom), 0);\n      this.targetBounds[3] = round((targetRect.left + sx) - (uw ? 0 : left), 0);\n      if (this.containerArray) {\n        this.containerBounds[0] = this.containerArray[0] + cpt;\n        this.containerBounds[1] = this.containerArray[1] - cpr;\n        this.containerBounds[2] = this.containerArray[2] - cpb;\n        this.containerBounds[3] = this.containerArray[3] + cpl;\n      } else {\n        this.containerBounds[0] = -round(targetRect.top - (fx ? clamp(top, 0, ih) : top) + hiddenTop - cpt, 0);\n        this.containerBounds[1] = -round(targetRect.right - (fx ? clamp(right, 0, iw) : right) - hiddenRight + cpr, 0);\n        this.containerBounds[2] = -round(targetRect.bottom - (fx ? clamp(bottom, 0, ih) : bottom) - hiddenBottom + cpb, 0);\n        this.containerBounds[3] = -round(targetRect.left - (fx ? clamp(left, 0, iw) : left) + hiddenLeft - cpl, 0);\n      }\n    }\n    this.transforms.revert();\n    // Restore coordinates\n    this.coords[2] = cx2;\n    this.coords[3] = cy2;\n    this.setX(cx, true);\n    this.setY(cy, true);\n  }\n\n  /**\n   * Returns 0 if not OB, 1 if x is OB, 2 if y is OB, 3 if both x and y are OB\n   *\n   * @param  {Array} bounds\n   * @param  {Number} x\n   * @param  {Number} y\n   * @return {Number}\n   */\n  isOutOfBounds(bounds, x, y) {\n    if (!this.contained) return 0;\n    const [ bt, br, bb, bl ] = bounds;\n    const [ dx, dy ] = this.disabled;\n    const obx = !dx && x < bl || !dx && x > br;\n    const oby = !dy && y < bt || !dy && y > bb;\n    return obx && !oby ? 1 : !obx && oby ? 2 : obx && oby ? 3 : 0;\n  }\n\n  refresh() {\n    const params = this.parameters;\n    const paramX = params.x;\n    const paramY = params.y;\n    const container = parseDraggableFunctionParameter(params.container, this);\n    const cp = parseDraggableFunctionParameter(params.containerPadding, this) || 0;\n    const containerPadding = /** @type {[Number, Number, Number, Number]} */(isArr(cp) ? cp : [cp, cp, cp, cp]);\n    const cx = this.x;\n    const cy = this.y;\n    const parsedCursorStyles = parseDraggableFunctionParameter(params.cursor, this);\n    const cursorStyles = { onHover: 'grab', onGrab: 'grabbing' };\n    if (parsedCursorStyles) {\n      const { onHover, onGrab } = /** @type {DraggableCursorParams} */(parsedCursorStyles);\n      if (onHover) cursorStyles.onHover = onHover;\n      if (onGrab) cursorStyles.onGrab = onGrab;\n    }\n    this.containerArray = isArr(container) ? container : null;\n    this.$container = /** @type {HTMLElement} */(container && !this.containerArray ? parseTargets(/** @type {DOMTarget} */(container))[0] : doc.body);\n    this.useWin = this.$container === doc.body;\n    /** @type {Window | HTMLElement} */\n    this.$scrollContainer = this.useWin ? win : this.$container;\n    this.isFinePointer = matchMedia('(pointer:fine)').matches;\n    this.containerPadding = setValue(containerPadding, [0, 0, 0, 0]);\n    this.containerFriction = clamp(setValue(parseDraggableFunctionParameter(params.containerFriction, this), .8), 0, 1);\n    this.releaseContainerFriction = clamp(setValue(parseDraggableFunctionParameter(params.releaseContainerFriction, this), this.containerFriction), 0, 1);\n    this.snapX = parseDraggableFunctionParameter(isObj(paramX) && !isUnd(paramX.snap) ? paramX.snap : params.snap, this);\n    this.snapY = parseDraggableFunctionParameter(isObj(paramY) && !isUnd(paramY.snap) ? paramY.snap : params.snap, this);\n    this.scrollSpeed = setValue(parseDraggableFunctionParameter(params.scrollSpeed, this), 1.5);\n    this.scrollThreshold = setValue(parseDraggableFunctionParameter(params.scrollThreshold, this), 20);\n    this.dragSpeed = setValue(parseDraggableFunctionParameter(params.dragSpeed, this), 1);\n    this.minVelocity = setValue(parseDraggableFunctionParameter(params.minVelocity, this), 0);\n    this.maxVelocity = setValue(parseDraggableFunctionParameter(params.maxVelocity, this), 50);\n    this.velocityMultiplier = setValue(parseDraggableFunctionParameter(params.velocityMultiplier, this), 1);\n    this.cursor = parsedCursorStyles === false ? false : cursorStyles;\n    this.updateBoundingValues();\n\n    // const ob = this.isOutOfBounds(this.containerBounds, this.x, this.y);\n    // if (ob === 1 || ob === 3) this.progressX = px;\n    // if (ob === 2 || ob === 3) this.progressY = py;\n\n    // if (this.initialized && this.contained) {\n    //   if (this.progressX !== px) this.progressX = px;\n    //   if (this.progressY !== py) this.progressY = py;\n    // }\n\n    const [ bt, br, bb, bl ] = this.containerBounds;\n    this.setX(clamp(cx, bl, br), true);\n    this.setY(clamp(cy, bt, bb), true);\n  }\n\n  update() {\n    this.updateScrollCoords();\n    if (this.canScroll) {\n      const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n      const [ sw, sh ] = this.scrollView;\n      const daw = this.dragArea[2];\n      const dah = this.dragArea[3];\n      const csx = this.scroll.x;\n      const csy = this.scroll.y;\n      const nsw = this.$container.scrollWidth;\n      const nsh = this.$container.scrollHeight;\n      const csw = this.useWin ? clamp(nsw, this.window[0], nsw) : nsw;\n      const csh = this.useWin ? clamp(nsh, this.window[1], nsh) : nsh;\n      const swd = sw - csw;\n      const shd = sh - csh;\n      // Handle cases where the scrollarea dimensions changes during drag\n      if (this.dragged && swd > 0) {\n        this.coords[0] -= swd;\n        this.scrollView[0] = csw;\n      }\n      if (this.dragged && shd > 0) {\n        this.coords[1] -= shd;\n        this.scrollView[1] = csh;\n      }\n      // Handle autoscroll when target is at the edges of the scroll bounds\n      const s = this.scrollSpeed * 10;\n      const threshold = this.scrollThreshold;\n      const [ x, y ] = this.coords;\n      const [ st, sr, sb, sl ] = this.scrollBounds;\n      const t = round(clamp((y - st + cpt) / threshold, -1, 0) * s, 0);\n      const r = round(clamp((x - sr - cpr) / threshold, 0, 1) * s, 0);\n      const b = round(clamp((y - sb - cpb) / threshold, 0, 1) * s, 0);\n      const l = round(clamp((x - sl + cpl) / threshold, -1, 0) * s, 0);\n      if (t || b || l || r) {\n        const [nx, ny] = this.disabled;\n        let scrollX = csx;\n        let scrollY = csy;\n        if (!nx) {\n          scrollX = round(clamp(csx + (l || r), 0, sw - daw), 0);\n          this.coords[0] -= csx - scrollX;\n        }\n        if (!ny) {\n          scrollY = round(clamp(csy + (t || b), 0, sh - dah), 0);\n          this.coords[1] -= csy - scrollY;\n        }\n        // Note: Safari mobile requires to use different scroll methods depending if using the window or not\n        if (this.useWin) {\n          this.$scrollContainer.scrollBy(-(csx - scrollX), -(csy - scrollY));\n        } else {\n          this.$scrollContainer.scrollTo(scrollX, scrollY);\n        }\n      }\n    }\n    const [ ct, cr, cb, cl ] = this.containerBounds;\n    const [ px1, py1, px2, py2, px3, py3 ] = this.pointer;\n    this.coords[0] += (px1 - px3) * this.dragSpeed;\n    this.coords[1] += (py1 - py3) * this.dragSpeed;\n    this.pointer[4] = px1;\n    this.pointer[5] = py1;\n    const [ cx, cy ] = this.coords;\n    const [ sx, sy ] = this.snapped;\n    const cf = (1 - this.containerFriction) * this.dragSpeed;\n    this.setX(cx > cr ? cr + (cx - cr) * cf : cx < cl ? cl + (cx - cl) * cf : cx, false);\n    this.setY(cy > cb ? cb + (cy - cb) * cf : cy < ct ? ct + (cy - ct) * cf : cy, false);\n    this.computeVelocity(px1 - px3, py1 - py3);\n    this.angle = atan2(py1 - py2, px1 - px2);\n    const [ nsx, nsy ] = this.snapped;\n    if (nsx !== sx && this.snapX || nsy !== sy && this.snapY) {\n      this.onSnap(this);\n    }\n  }\n\n  stop() {\n    this.updateTicker.pause();\n    this.overshootXTicker.pause();\n    this.overshootYTicker.pause();\n    // Pauses the in bounds onRelease animations\n    for (let prop in this.animate.animations) this.animate.animations[prop].pause();\n    remove(this, null, 'x');\n    remove(this, null, 'y');\n    remove(this, null, 'progressX');\n    remove(this, null, 'progressY');\n    remove(this.scroll); // Removes any active animations on the container scroll\n    remove(this.overshootCoords); // Removes active overshoot animations\n    return this;\n  }\n\n  /**\n   * @param {Number} [duration]\n   * @param {Number} [gap]\n   * @param {EasingParam} [ease]\n   * @return {this}\n   */\n  scrollInView(duration, gap = 0, ease = eases.inOutQuad) {\n    this.updateScrollCoords();\n    const x = this.destX;\n    const y = this.destY;\n    const scroll = this.scroll;\n    const scrollBounds = this.scrollBounds;\n    const canScroll = this.canScroll;\n    if (!this.containerArray && this.isOutOfBounds(scrollBounds, x, y)) {\n      const [ st, sr, sb, sl ] = scrollBounds;\n      const t = round(clamp(y - st, -1e12, 0), 0);\n      const r = round(clamp(x - sr, 0, maxValue), 0);\n      const b = round(clamp(y - sb, 0, maxValue), 0);\n      const l = round(clamp(x - sl, -1e12, 0), 0);\n      new JSAnimation(scroll, {\n        x: round(scroll.x + (l ? l - gap : r ? r + gap : 0), 0),\n        y: round(scroll.y + (t ? t - gap : b ? b + gap : 0), 0),\n        duration: isUnd(duration) ? 350 * globals.timeScale : duration,\n        ease,\n        onUpdate: () => {\n          this.canScroll = false;\n          this.$scrollContainer.scrollTo(scroll.x, scroll.y);\n        }\n      }).init().then(() => {\n        this.canScroll = canScroll;\n      });\n    }\n    return this;\n  }\n\n  handleHover() {\n    if (this.isFinePointer && this.cursor && !this.cursorStyles) {\n      this.cursorStyles = setTargetValues(this.$trigger, {\n        cursor: /** @type {DraggableCursorParams} */(this.cursor).onHover\n      });\n    }\n  }\n\n  /**\n   * @param  {Number} [duration]\n   * @param  {Number} [gap]\n   * @param  {EasingParam} [ease]\n   * @return {this}\n   */\n  animateInView(duration, gap = 0, ease = eases.inOutQuad) {\n    this.stop();\n    this.updateBoundingValues();\n    const x = this.x;\n    const y = this.y;\n    const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n    const bt = this.scroll.y - this.targetBounds[0] + cpt + gap;\n    const br = this.scroll.x - this.targetBounds[1] - cpr - gap;\n    const bb = this.scroll.y - this.targetBounds[2] - cpb - gap;\n    const bl = this.scroll.x - this.targetBounds[3] + cpl + gap;\n    const ob = this.isOutOfBounds([bt, br, bb, bl], x, y);\n    if (ob) {\n      const [ disabledX, disabledY ] = this.disabled;\n      const destX = clamp(snap(x, this.snapX), bl, br);\n      const destY = clamp(snap(y, this.snapY), bt, bb);\n      const dur = isUnd(duration) ? 350 * globals.timeScale : duration;\n      if (!disabledX && (ob === 1 || ob === 3)) this.animate[this.xProp](destX, dur, ease);\n      if (!disabledY && (ob === 2 || ob === 3)) this.animate[this.yProp](destY, dur, ease);\n    }\n    return this;\n  }\n\n  /**\n   * @param {MouseEvent|TouchEvent} e\n   */\n  handleDown(e) {\n    const $eTarget = /** @type {HTMLElement} */(e.target);\n    if (this.grabbed || /** @type {HTMLInputElement}  */($eTarget).type === 'range') return;\n\n    e.stopPropagation();\n\n    this.grabbed = true;\n    this.released = false;\n    this.stop();\n    this.updateBoundingValues();\n    const touches = /** @type {TouchEvent} */(e).changedTouches;\n    const eventX = touches ? touches[0].clientX : /** @type {MouseEvent} */(e).clientX;\n    const eventY = touches ? touches[0].clientY : /** @type {MouseEvent} */(e).clientY;\n    const { x, y } = this.transforms.normalizePoint(eventX, eventY);\n    const [ ct, cr, cb, cl ] = this.containerBounds;\n    const cf = (1 - this.containerFriction) * this.dragSpeed;\n    const cx = this.x;\n    const cy = this.y;\n    this.coords[0] = this.coords[2] = !cf ? cx : cx > cr ? cr + (cx - cr) / cf : cx < cl ? cl + (cx - cl) / cf : cx;\n    this.coords[1] = this.coords[3] = !cf ? cy : cy > cb ? cb + (cy - cb) / cf : cy < ct ? ct + (cy - ct) / cf : cy;\n    this.pointer[0] = x;\n    this.pointer[1] = y;\n    this.pointer[2] = x;\n    this.pointer[3] = y;\n    this.pointer[4] = x;\n    this.pointer[5] = y;\n    this.pointer[6] = x;\n    this.pointer[7] = y;\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.velocity = 0;\n    this.velocityStack[0] = 0;\n    this.velocityStack[1] = 0;\n    this.velocityStack[2] = 0;\n    this.velocityStackIndex = 0;\n    this.angle = 0;\n    if (this.targetStyles) {\n      this.targetStyles.revert();\n      this.targetStyles = null;\n    }\n    const z = /** @type {Number} */(getTargetValue(this.$target, 'zIndex', false));\n    zIndex = (z > zIndex ? z : zIndex) + 1;\n    this.targetStyles = setTargetValues(this.$target, { zIndex });\n    if (this.triggerStyles) {\n      this.triggerStyles.revert();\n      this.triggerStyles = null;\n    }\n    if (this.cursorStyles) {\n      this.cursorStyles.revert();\n      this.cursorStyles = null;\n    }\n    if (this.isFinePointer && this.cursor) {\n      this.bodyStyles = setTargetValues(doc.body, {\n        cursor: /** @type {DraggableCursorParams} */(this.cursor).onGrab\n      });\n    }\n    this.scrollInView(100, 0, eases.out(3));\n    this.onGrab(this);\n\n    doc.addEventListener('touchmove', this);\n    doc.addEventListener('touchend', this);\n    doc.addEventListener('touchcancel', this);\n    doc.addEventListener('mousemove', this);\n    doc.addEventListener('mouseup', this);\n    doc.addEventListener('selectstart', this);\n  }\n\n  /**\n   * @param {MouseEvent|TouchEvent} e\n   */\n  handleMove(e) {\n    if (!this.grabbed) return;\n    const touches = /** @type {TouchEvent} */(e).changedTouches;\n    const eventX = touches ? touches[0].clientX : /** @type {MouseEvent} */(e).clientX;\n    const eventY = touches ? touches[0].clientY : /** @type {MouseEvent} */(e).clientY;\n    const { x, y } = this.transforms.normalizePoint(eventX, eventY);\n    const movedX = x - this.pointer[6];\n    const movedY = y - this.pointer[7];\n\n    let $parent = /** @type {HTMLElement} */(e.target);\n    let isAtTop = false;\n    let isAtBottom = false;\n    let canTouchScroll = false;\n\n    while (touches && $parent && $parent !== this.$trigger) {\n      const overflowY = getTargetValue($parent, 'overflow-y');\n      if (overflowY !== 'hidden' && overflowY !== 'visible') {\n        const { scrollTop, scrollHeight, clientHeight } = $parent;\n        if (scrollHeight > clientHeight) {\n          canTouchScroll = true;\n          isAtTop = scrollTop <= 3;\n          isAtBottom = scrollTop >= (scrollHeight - clientHeight) - 3;\n          break;\n        }\n      }\n      $parent = /** @type {HTMLElement} */($parent.parentNode);\n    }\n\n    if (canTouchScroll && ((!isAtTop && !isAtBottom) || (isAtTop && movedY < 0) || (isAtBottom && movedY > 0))) {\n\n      this.pointer[0] = x;\n      this.pointer[1] = y;\n      this.pointer[2] = x;\n      this.pointer[3] = y;\n      this.pointer[4] = x;\n      this.pointer[5] = y;\n      this.pointer[6] = x;\n      this.pointer[7] = y;\n\n    } else {\n\n      preventDefault(e);\n\n      // Needed to prevents click on handleUp\n      if (!this.triggerStyles) this.triggerStyles = setTargetValues(this.$trigger, { pointerEvents: 'none' });\n      // Needed to prevent page scroll while dragging on touch devvice\n      this.$trigger.addEventListener('touchstart', preventDefault, { passive: false });\n      this.$trigger.addEventListener('touchmove', preventDefault, { passive: false });\n      this.$trigger.addEventListener('touchend', preventDefault);\n\n\n      if ((!this.disabled[0] && abs(movedX) > 3) || (!this.disabled[1] && abs(movedY) > 3)) {\n\n        this.updateTicker.resume();\n        this.pointer[2] = this.pointer[0];\n        this.pointer[3] = this.pointer[1];\n        this.pointer[0] = x;\n        this.pointer[1] = y;\n        this.dragged = true;\n        this.released = false;\n        this.onDrag(this);\n      }\n    }\n  }\n\n  handleUp() {\n\n    if (!this.grabbed) return;\n\n    this.updateTicker.pause();\n\n    if (this.triggerStyles) {\n      this.triggerStyles.revert();\n      this.triggerStyles = null;\n    }\n\n    if (this.bodyStyles) {\n      this.bodyStyles.revert();\n      this.bodyStyles = null;\n    }\n\n    const [ disabledX, disabledY ] = this.disabled;\n    const [ px1, py1, px2, py2, px3, py3 ] = this.pointer;\n    const [ ct, cr, cb, cl ] = this.containerBounds;\n    const [ sx, sy ] = this.snapped;\n    const springX = this.releaseXSpring;\n    const springY = this.releaseYSpring;\n    const releaseEase = this.releaseEase;\n    const hasReleaseSpring = this.hasReleaseSpring;\n    const overshootCoords = this.overshootCoords;\n    const cx = this.x;\n    const cy = this.y;\n    const pv = this.computeVelocity(px1 - px3, py1 - py3);\n    const pa = this.angle = atan2(py1 - py2, px1 - px2);\n    const ds = pv * 150;\n    const cf = (1 - this.releaseContainerFriction) * this.dragSpeed;\n    const nx = cx + (cos(pa) * ds);\n    const ny = cy + (sin(pa) * ds);\n    const bx = nx > cr ? cr + (nx - cr) * cf : nx < cl ? cl + (nx - cl) * cf : nx;\n    const by = ny > cb ? cb + (ny - cb) * cf : ny < ct ? ct + (ny - ct) * cf : ny;\n    const dx = this.destX = clamp(round(snap(bx, this.snapX), 5), cl, cr);\n    const dy = this.destY = clamp(round(snap(by, this.snapY), 5), ct, cb);\n    const ob = this.isOutOfBounds(this.containerBounds, nx, ny);\n\n    let durationX = 0;\n    let durationY = 0;\n    let easeX = releaseEase;\n    let easeY = releaseEase;\n    let longestReleaseDuration = 0;\n\n    overshootCoords.x = cx;\n    overshootCoords.y = cy;\n\n    if (!disabledX) {\n      const directionX = dx === cr ? cx > cr ? -1 : 1 : cx < cl ? -1 : 1;\n      const distanceX = round(cx - dx, 0);\n      springX.velocity = disabledY && hasReleaseSpring ? distanceX ? (ds * directionX) / abs(distanceX) : 0 : pv;\n      const { ease, duration, restDuration } = springX;\n      durationX = cx === dx ? 0 : hasReleaseSpring ? duration : duration - (restDuration * globals.timeScale);\n      if (hasReleaseSpring) easeX = ease;\n      if (durationX > longestReleaseDuration) longestReleaseDuration = durationX;\n    }\n\n    if (!disabledY) {\n      const directionY = dy === cb ? cy > cb ? -1 : 1 : cy < ct ? -1 : 1;\n      const distanceY = round(cy - dy, 0);\n      springY.velocity = disabledX && hasReleaseSpring ? distanceY ? (ds * directionY) / abs(distanceY) : 0 : pv;\n      const { ease, duration, restDuration } = springY;\n      durationY = cy === dy ? 0 : hasReleaseSpring ? duration : duration - (restDuration * globals.timeScale);\n      if (hasReleaseSpring) easeY = ease;\n      if (durationY > longestReleaseDuration) longestReleaseDuration = durationY;\n    }\n\n    if (!hasReleaseSpring && ob && cf && (durationX || durationY)) {\n\n        const composition = compositionTypes.blend;\n\n        new JSAnimation(overshootCoords, {\n          x: { to: bx, duration: durationX * .65 },\n          y: { to: by, duration: durationY * .65 },\n          ease: releaseEase,\n          composition,\n        }).init();\n\n        new JSAnimation(overshootCoords, {\n          x: { to: dx, duration: durationX },\n          y: { to: dy, duration: durationY },\n          ease: releaseEase,\n          composition,\n        }).init();\n\n        this.overshootXTicker.stretch(durationX).restart();\n        this.overshootYTicker.stretch(durationY).restart();\n\n    } else {\n\n      if (!disabledX) this.animate[this.xProp](dx, durationX, easeX);\n      if (!disabledY) this.animate[this.yProp](dy, durationY, easeY);\n\n    }\n\n    this.scrollInView(longestReleaseDuration, this.scrollThreshold, releaseEase);\n\n    let hasSnapped = false;\n\n    if (dx !== sx) {\n      this.snapped[0] = dx;\n      if (this.snapX) hasSnapped = true;\n    }\n\n    if (dy !== sy && this.snapY) {\n      this.snapped[1] = dy;\n      if (this.snapY) hasSnapped = true;\n    }\n\n    if (hasSnapped) this.onSnap(this);\n\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = true;\n    this.released = true;\n\n    // It's important to trigger the callback after the release animations to be able to cancel them\n    this.onRelease(this);\n\n    this.$trigger.removeEventListener('touchstart', preventDefault);\n    this.$trigger.removeEventListener('touchmove', preventDefault);\n    this.$trigger.removeEventListener('touchend', preventDefault);\n\n    doc.removeEventListener('touchmove', this);\n    doc.removeEventListener('touchend', this);\n    doc.removeEventListener('touchcancel', this);\n    doc.removeEventListener('mousemove', this);\n    doc.removeEventListener('mouseup', this);\n    doc.removeEventListener('selectstart', this);\n  }\n\n  reset() {\n    this.stop();\n    this.resizeTicker.pause();\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = false;\n    this.released = false;\n    this.canScroll = false;\n    this.setX(0, true);\n    this.setY(0, true);\n    this.coords[0] = 0;\n    this.coords[1] = 0;\n    this.pointer[0] = 0;\n    this.pointer[1] = 0;\n    this.pointer[2] = 0;\n    this.pointer[3] = 0;\n    this.pointer[4] = 0;\n    this.pointer[5] = 0;\n    this.pointer[6] = 0;\n    this.pointer[7] = 0;\n    this.velocity = 0;\n    this.velocityStack[0] = 0;\n    this.velocityStack[1] = 0;\n    this.velocityStack[2] = 0;\n    this.velocityStackIndex = 0;\n    this.angle = 0;\n    return this;\n  }\n\n  enable() {\n    if (!this.enabled) {\n      this.enabled = true;\n      this.$target.classList.remove('is-disabled');\n      this.touchActionStyles = setTargetValues(this.$trigger, {\n        touchAction: this.disabled[0] ? 'pan-x' : this.disabled[1] ? 'pan-y' : 'none'\n      });\n      this.$trigger.addEventListener('touchstart', this, { passive: true });\n      this.$trigger.addEventListener('mousedown', this, { passive: true });\n      this.$trigger.addEventListener('mouseenter', this);\n    }\n    return this;\n  }\n\n  disable() {\n    this.enabled = false;\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = false;\n    this.released = false;\n    this.canScroll = false;\n    this.touchActionStyles.revert();\n    if (this.cursorStyles) {\n      this.cursorStyles.revert();\n      this.cursorStyles = null;\n    }\n    if (this.triggerStyles) {\n      this.triggerStyles.revert();\n      this.triggerStyles = null;\n    }\n    if (this.bodyStyles) {\n      this.bodyStyles.revert();\n      this.bodyStyles = null;\n    }\n    if (this.targetStyles) {\n      this.targetStyles.revert();\n      this.targetStyles = null;\n    }\n    this.stop();\n    this.$target.classList.add('is-disabled');\n    this.$trigger.removeEventListener('touchstart', this);\n    this.$trigger.removeEventListener('mousedown', this);\n    this.$trigger.removeEventListener('mouseenter', this);\n    doc.removeEventListener('touchmove', this);\n    doc.removeEventListener('touchend', this);\n    doc.removeEventListener('touchcancel', this);\n    doc.removeEventListener('mousemove', this);\n    doc.removeEventListener('mouseup', this);\n    doc.removeEventListener('selectstart', this);\n    return this;\n  }\n\n  revert() {\n    this.reset();\n    this.disable();\n    this.$target.classList.remove('is-disabled');\n    this.updateTicker.revert();\n    this.overshootXTicker.revert();\n    this.overshootYTicker.revert();\n    this.resizeTicker.revert();\n    this.animate.revert();\n    return this;\n  }\n\n  /**\n   * @param {Event} e\n   */\n  handleEvent(e) {\n    switch (e.type) {\n      case 'mousedown':\n        this.handleDown(/** @type {MouseEvent} */(e));\n        break;\n      case 'touchstart':\n        this.handleDown(/** @type {TouchEvent} */(e));\n        break;\n      case 'mousemove':\n        this.handleMove(/** @type {MouseEvent} */(e));\n        break;\n      case 'touchmove':\n        this.handleMove(/** @type {TouchEvent} */(e));\n        break;\n      case 'mouseup':\n        this.handleUp();\n        break;\n      case 'touchend':\n        this.handleUp();\n        break;\n      case 'touchcancel':\n        this.handleUp();\n        break;\n      case 'mouseenter':\n        this.handleHover();\n        break;\n      case 'selectstart':\n        preventDefault(e);\n        break;\n    }\n  }\n}\n\n/**\n * @param {TargetsParam} target\n * @param {DraggableParams} [parameters]\n * @return {Draggable}\n */\nconst createDraggable = (target, parameters) => new Draggable(target, parameters);\n\n\n\n\n/**\n * @typedef {Object} ReactRef\n * @property {HTMLElement|SVGElement|null} [current]\n */\n\n/**\n * @typedef {Object} AngularRef\n * @property {HTMLElement|SVGElement} [nativeElement]\n */\n\n/**\n * @typedef {Object} ScopeParams\n * @property {DOMTargetSelector|ReactRef|AngularRef} [root]\n * @property {DefaultsParams} [defaults]\n * @property {Record<String, String>} [mediaQueries]\n */\n\n/**\n * @callback ScopeCleanup\n * @param {Scope} [scope]\n */\n\n/**\n * @callback ScopeConstructor\n * @param {Scope} [scope]\n * @return {ScopeCleanup|void}\n */\n\n/**\n * @callback ScopeMethod\n * @param {...*} args\n * @return {ScopeCleanup|void}\n */\n\nclass Scope {\n  /** @param {ScopeParams} [parameters] */\n  constructor(parameters = {}) {\n    if (globals.scope) globals.scope.revertibles.push(this);\n    const rootParam = parameters.root;\n    /** @type {Document|DOMTarget} */\n    let root = doc;\n    if (rootParam) {\n      root = /** @type {ReactRef} */(rootParam).current ||\n             /** @type {AngularRef} */(rootParam).nativeElement ||\n             parseTargets(/** @type {DOMTargetSelector} */(rootParam))[0] ||\n             doc;\n    }\n    const scopeDefaults = parameters.defaults;\n    const globalDefault = globals.defaults;\n    const mediaQueries = parameters.mediaQueries;\n    /** @type {DefaultsParams} */\n    this.defaults = scopeDefaults ? mergeObjects(scopeDefaults, globalDefault) : globalDefault;\n    /** @type {Document|DOMTarget} */\n    this.root = root;\n    /** @type {Array<ScopeConstructor>} */\n    this.constructors = [];\n    /** @type {Array<Function>} */\n    this.revertConstructors = [];\n    /** @type {Array<Revertible>} */\n    this.revertibles = [];\n    /** @type {Record<String, Function>} */\n    this.methods = {};\n    /** @type {Record<String, Boolean>} */\n    this.matches = {};\n    /** @type {Record<String, MediaQueryList>} */\n    this.mediaQueryLists = {};\n    /** @type {Record<String, any>} */\n    this.data = {};\n    if (mediaQueries) {\n      for (let mq in mediaQueries) {\n        const _mq = win.matchMedia(mediaQueries[mq]);\n        this.mediaQueryLists[mq] = _mq;\n        _mq.addEventListener('change', this);\n      }\n    }\n  }\n\n  /**\n   * @callback ScoppedCallback\n   * @param {this} scope\n   * @return {any}\n   *\n   * @param {ScoppedCallback} cb\n   * @return {this}\n   */\n  execute(cb) {\n    let activeScope = globals.scope;\n    let activeRoot = globals.root;\n    let activeDefaults = globals.defaults;\n    globals.scope = this;\n    globals.root = this.root;\n    globals.defaults = this.defaults;\n    const mqs = this.mediaQueryLists;\n    for (let mq in mqs) this.matches[mq] = mqs[mq].matches;\n    const returned = cb(this);\n    globals.scope = activeScope;\n    globals.root = activeRoot;\n    globals.defaults = activeDefaults;\n    return returned;\n  }\n\n  /**\n   * @return {this}\n   */\n  refresh() {\n    this.execute(() => {\n      let i = this.revertibles.length;\n      let y = this.revertConstructors.length;\n      while (i--) this.revertibles[i].revert();\n      while (y--) this.revertConstructors[y](this);\n      this.revertibles.length = 0;\n      this.revertConstructors.length = 0;\n      this.constructors.forEach( constructor => {\n        const revertConstructor = constructor(this);\n        if (revertConstructor) {\n          this.revertConstructors.push(revertConstructor);\n        }\n      });\n    });\n    return this;\n  }\n\n  /**\n   * @callback contructorCallback\n   * @param {this} self\n   *\n   * @overload\n   * @param {String} a1\n   * @param {ScopeMethod} a2\n   * @return {this}\n   *\n   * @overload\n   * @param {contructorCallback} a1\n   * @return {this}\n   *\n   * @param {String|contructorCallback} a1\n   * @param {ScopeMethod} [a2]\n   */\n  add(a1, a2) {\n    if (isFnc(a1)) {\n      const constructor = /** @type {contructorCallback} */(a1);\n      this.constructors.push(constructor);\n      this.execute(() => {\n        const revertConstructor = constructor(this);\n        if (revertConstructor) {\n          this.revertConstructors.push(revertConstructor);\n        }\n      });\n    } else {\n      this.methods[/** @type {String} */(a1)] = (/** @type {any} */...args) => this.execute(() => a2(...args));\n    }\n    return this;\n  }\n\n  /**\n   * @param {Event} e\n   */\n  handleEvent(e) {\n    switch (e.type) {\n      case 'change':\n        this.refresh();\n        break;\n    }\n  }\n\n  revert() {\n    const revertibles = this.revertibles;\n    const revertConstructors = this.revertConstructors;\n    const mqs = this.mediaQueryLists;\n    let i = revertibles.length;\n    let y = revertConstructors.length;\n    while (i--) revertibles[i].revert();\n    while (y--) revertConstructors[y](this);\n    for (let mq in mqs) mqs[mq].removeEventListener('change', this);\n    revertibles.length = 0;\n    revertConstructors.length = 0;\n    this.constructors.length = 0;\n    this.matches = {};\n    this.methods = {};\n    this.mediaQueryLists = {};\n    this.data = {};\n  }\n}\n\n/**\n * @param {ScopeParams} [params]\n * @return {Scope}\n */\nconst createScope = params => new Scope(params);\n\n/**\n * @typedef {String|Number} ScrollThresholdValue\n */\n\n/**\n * @return {Number}\n */\nconst getMaxViewHeight = () => {\n  const $el = document.createElement('div');\n  doc.body.appendChild($el);\n  $el.style.height = '100lvh';\n  const height = $el.offsetHeight;\n  doc.body.removeChild($el);\n  return height;\n};\n\n/**\n * @template {ScrollThresholdValue|String|Number|Boolean|Function|Object} T\n * @param {T | ((observer: ScrollObserver) => T)} value\n * @param {ScrollObserver} scroller\n * @return {T}\n */\nconst parseScrollObserverFunctionParameter = (value, scroller) => value && isFnc(value) ? /** @type {Function} */(value)(scroller) : value;\n\nconst scrollContainers = new Map();\n\nclass ScrollContainer {\n  /**\n   * @param {HTMLElement} $el\n   */\n  constructor($el) {\n    /** @type {HTMLElement} */\n    this.element = $el;\n    /** @type {Boolean} */\n    this.useWin = this.element === doc.body;\n    /** @type {Number} */\n    this.winWidth = 0;\n    /** @type {Number} */\n    this.winHeight = 0;\n    /** @type {Number} */\n    this.width = 0;\n    /** @type {Number} */\n    this.height = 0;\n    /** @type {Number} */\n    this.left = 0;\n    /** @type {Number} */\n    this.top = 0;\n    /** @type {Number} */\n    this.zIndex = 0;\n    /** @type {Number} */\n    this.scrollX = 0;\n    /** @type {Number} */\n    this.scrollY = 0;\n    /** @type {Number} */\n    this.prevScrollX = 0;\n    /** @type {Number} */\n    this.prevScrollY = 0;\n    /** @type {Number} */\n    this.scrollWidth = 0;\n    /** @type {Number} */\n    this.scrollHeight = 0;\n    /** @type {Number} */\n    this.velocity = 0;\n    /** @type {Boolean} */\n    this.backwardX = false;\n    /** @type {Boolean} */\n    this.backwardY = false;\n    /** @type {Timer} */\n    this.scrollTicker = new Timer({\n      autoplay: false,\n      onBegin: () => this.dataTimer.resume(),\n      onUpdate: () => {\n        const backwards = this.backwardX || this.backwardY;\n        forEachChildren(this, (/** @type {ScrollObserver} */child) => child.handleScroll(), backwards);\n      },\n      onComplete: () => this.dataTimer.pause()\n    }).init();\n    /** @type {Timer} */\n    this.dataTimer = new Timer({\n      autoplay: false,\n      frameRate: 30,\n      onUpdate: self => {\n        const dt = self.deltaTime;\n        const px = this.prevScrollX;\n        const py = this.prevScrollY;\n        const nx = this.scrollX;\n        const ny = this.scrollY;\n        const dx = px - nx;\n        const dy = py - ny;\n        this.prevScrollX = nx;\n        this.prevScrollY = ny;\n        if (dx) this.backwardX = px > nx;\n        if (dy) this.backwardY = py > ny;\n        this.velocity = round(dt > 0 ? Math.sqrt(dx * dx + dy * dy) / dt : 0, 5);\n      }\n    }).init();\n    /** @type {Timer} */\n    this.resizeTicker = new Timer({\n      autoplay: false,\n      duration: 250 * globals.timeScale,\n      onComplete: () => {\n        this.updateWindowBounds();\n        this.refreshScrollObservers();\n        this.handleScroll();\n      }\n    }).init();\n    /** @type {Timer} */\n    this.wakeTicker = new Timer({\n      autoplay: false,\n      duration: 500 * globals.timeScale,\n      onBegin: () => {\n        this.scrollTicker.resume();\n      },\n      onComplete: () => {\n        this.scrollTicker.pause();\n      }\n    }).init();\n    /** @type {ScrollObserver} */\n    this._head = null;\n    /** @type {ScrollObserver} */\n    this._tail = null;\n    this.updateScrollCoords();\n    this.updateWindowBounds();\n    this.updateBounds();\n    this.refreshScrollObservers();\n    this.handleScroll();\n    this.resizeObserver = new ResizeObserver(() => this.resizeTicker.restart());\n    this.resizeObserver.observe(this.element);\n    (this.useWin ? win : this.element).addEventListener('scroll', this, false);\n  }\n\n  updateScrollCoords() {\n    const useWin = this.useWin;\n    const $el = this.element;\n    this.scrollX = round(useWin ? win.scrollX : $el.scrollLeft, 0);\n    this.scrollY = round(useWin ? win.scrollY : $el.scrollTop, 0);\n  }\n\n  updateWindowBounds() {\n    this.winWidth = win.innerWidth;\n    this.winHeight = getMaxViewHeight();\n  }\n\n  updateBounds() {\n    const style = getComputedStyle(this.element);\n    const $el = this.element;\n    this.scrollWidth = $el.scrollWidth + parseFloat(style.marginLeft) + parseFloat(style.marginRight);\n    this.scrollHeight = $el.scrollHeight + parseFloat(style.marginTop) + parseFloat(style.marginBottom);\n    this.updateWindowBounds();\n    let width, height;\n    if (this.useWin) {\n      width = this.winWidth;\n      height = this.winHeight;\n    } else {\n      const elRect = $el.getBoundingClientRect();\n      width = elRect.width;\n      height = elRect.height;\n      this.top = elRect.top;\n      this.left = elRect.left;\n    }\n    this.width = width;\n    this.height = height;\n  }\n\n  refreshScrollObservers() {\n    forEachChildren(this, (/** @type {ScrollObserver} */child) => {\n      if (child._debug) {\n        child.removeDebug();\n      }\n    });\n    this.updateBounds();\n    forEachChildren(this, (/** @type {ScrollObserver} */child) => {\n      child.refresh();\n      if (child._debug) {\n        child.debug();\n      }\n    });\n  }\n\n  refresh() {\n    this.updateWindowBounds();\n    this.updateBounds();\n    this.refreshScrollObservers();\n    this.handleScroll();\n  }\n\n  handleScroll() {\n    this.updateScrollCoords();\n    this.wakeTicker.restart();\n  }\n\n  /**\n   * @param {Event} e\n   */\n  handleEvent(e) {\n    switch (e.type) {\n      case 'scroll':\n        this.handleScroll();\n        break;\n    }\n  }\n\n  revert() {\n    this.scrollTicker.cancel();\n    this.dataTimer.cancel();\n    this.resizeTicker.cancel();\n    this.wakeTicker.cancel();\n    this.resizeObserver.unobserve(this.element);\n    (this.useWin ? win : this.element).removeEventListener('scroll', this);\n    scrollContainers.delete(this.element);\n  }\n}\n\n/**\n * @param {TargetsParam} target\n * @return {ScrollContainer}\n */\nconst registerAndGetScrollContainer = target => {\n  const $el = /** @type {HTMLElement} */(target ? parseTargets(target)[0] || doc.body : doc.body);\n  let scrollContainer = scrollContainers.get($el);\n  if (!scrollContainer) {\n    scrollContainer = new ScrollContainer($el);\n    scrollContainers.set($el, scrollContainer);\n  }\n  return scrollContainer;\n};\n\n/**\n * @param {HTMLElement} $el\n * @param {Number|string} v\n * @param {Number} size\n * @param {Number} [under]\n * @param {Number} [over]\n * @return {Number}\n */\nconst convertValueToPx = ($el, v, size, under, over) => {\n  const clampMin = v === 'min';\n  const clampMax = v === 'max';\n  const value = v === 'top' || v === 'left' || v === 'start' || clampMin ? 0 :\n                v === 'bottom' || v === 'right' || v === 'end' || clampMax ? '100%' :\n                v === 'center' ? '50%' :\n                v;\n  const { n, u } = decomposeRawValue(value, decomposedOriginalValue);\n  let px = n;\n  if (u === '%') {\n    px = (n / 100) * size;\n  } else if (u) {\n    px = convertValueUnit($el, decomposedOriginalValue, 'px', true).n;\n  }\n  if (clampMax && under < 0) px += under;\n  if (clampMin && over > 0) px += over;\n  return px;\n};\n\n/**\n * @param {HTMLElement} $el\n * @param {ScrollThresholdValue} v\n * @param {Number} size\n * @param {Number} [under]\n * @param {Number} [over]\n * @return {Number}\n */\nconst parseBoundValue = ($el, v, size, under, over) => {\n  /** @type {Number} */\n  let value;\n  if (isStr(v)) {\n    const matchedOperator = relativeValuesExecRgx.exec(/** @type {String} */(v));\n    if (matchedOperator) {\n      const splitter = matchedOperator[0];\n      const operator = splitter[0];\n      const splitted = /** @type {String} */(v).split(splitter);\n      const clampMin = splitted[0] === 'min';\n      const clampMax = splitted[0] === 'max';\n      const valueAPx = convertValueToPx($el, splitted[0], size, under, over);\n      const valueBPx = convertValueToPx($el, splitted[1], size, under, over);\n      if (clampMin) {\n        const min = getRelativeValue(convertValueToPx($el, 'min', size), valueBPx, operator);\n        value = min < valueAPx ? valueAPx : min;\n      } else if (clampMax) {\n        const max = getRelativeValue(convertValueToPx($el, 'max', size), valueBPx, operator);\n        value = max > valueAPx ? valueAPx : max;\n      } else {\n        value = getRelativeValue(valueAPx, valueBPx, operator);\n      }\n    } else {\n      value = convertValueToPx($el, v, size, under, over);\n    }\n  } else {\n    value = /** @type {Number} */(v);\n  }\n  return round(value, 0);\n};\n\n/**\n * @param {JSAnimation} linked\n * @return {HTMLElement}\n */\nconst getAnimationDomTarget = linked => {\n  let $linkedTarget;\n  const linkedTargets = linked.targets;\n  for (let i = 0, l = linkedTargets.length; i < l; i++) {\n    const target = linkedTargets[i];\n    if (target[isDomSymbol]) {\n      $linkedTarget = /** @type {HTMLElement} */(target);\n      break;\n    }\n  }\n  return $linkedTarget;\n};\n\nlet scrollerIndex = 0;\n\nconst debugColors = ['#FF4B4B','#FF971B','#FFC730','#F9F640','#7AFF5A','#18FF74','#17E09B','#3CFFEC','#05DBE9','#33B3F1','#638CF9','#C563FE','#FF4FCF','#F93F8A'];\n\n/**\n * @typedef {Object} ScrollThresholdParam\n * @property {ScrollThresholdValue} [target]\n * @property {ScrollThresholdValue} [container]\n */\n\n/**\n * @callback ScrollObserverAxisCallback\n * @param {ScrollObserver} self\n * @return {'x'|'y'}\n */\n\n/**\n * @callback ScrollThresholdCallback\n * @param {ScrollObserver} self\n * @return {ScrollThresholdValue|ScrollThresholdParam}\n */\n\n/**\n * @typedef {Object} ScrollObserverParams\n * @property {Number|String} [id]\n * @property {Boolean|Number|String|EasingParam} [sync]\n * @property {TargetsParam} [container]\n * @property {TargetsParam} [target]\n * @property {'x'|'y'|ScrollObserverAxisCallback|((observer: ScrollObserver) => 'x'|'y'|ScrollObserverAxisCallback)} [axis]\n * @property {ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback|((observer: ScrollObserver) => ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback)} [enter]\n * @property {ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback|((observer: ScrollObserver) => ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback)} [leave]\n * @property {Boolean|((observer: ScrollObserver) => Boolean)} [repeat]\n * @property {Boolean} [debug]\n * @property {Callback<ScrollObserver>} [onEnter]\n * @property {Callback<ScrollObserver>} [onLeave]\n * @property {Callback<ScrollObserver>} [onEnterForward]\n * @property {Callback<ScrollObserver>} [onLeaveForward]\n * @property {Callback<ScrollObserver>} [onEnterBackward]\n * @property {Callback<ScrollObserver>} [onLeaveBackward]\n * @property {Callback<ScrollObserver>} [onUpdate]\n * @property {Callback<ScrollObserver>} [onSyncComplete]\n */\n\nclass ScrollObserver {\n  /**\n   * @param {ScrollObserverParams} parameters\n   */\n  constructor(parameters = {}) {\n    if (globals.scope) globals.scope.revertibles.push(this);\n    const syncMode = setValue(parameters.sync, 'play pause');\n    const ease = syncMode ? parseEasings(/** @type {EasingParam} */(syncMode)) : null;\n    const isLinear = syncMode && (syncMode === 'linear' || syncMode === none);\n    const isEase = syncMode && !(ease === none && !isLinear);\n    const isSmooth = syncMode && (isNum(syncMode) || syncMode === true || isLinear);\n    const isMethods = syncMode && (isStr(syncMode) && !isEase && !isSmooth);\n    const syncMethods = isMethods ? /** @type {String} */(syncMode).split(' ').map(\n      (/** @type {String} */m) => () => {\n        const linked = this.linked;\n        return linked && linked[m] ? linked[m]() : null;\n      }\n    ) : null;\n    const biDirSync = isMethods && syncMethods.length > 2;\n    /** @type {Number} */\n    this.index = scrollerIndex++;\n    /** @type {String|Number} */\n    this.id = !isUnd(parameters.id) ? parameters.id : this.index;\n    /** @type {ScrollContainer} */\n    this.container = registerAndGetScrollContainer(parameters.container);\n    /** @type {HTMLElement} */\n    this.target = null;\n    /** @type {Tickable|WAAPIAnimation} */\n    this.linked = null;\n    /** @type {Boolean} */\n    this.repeat = null;\n    /** @type {Boolean} */\n    this.horizontal = null;\n    /** @type {ScrollThresholdParam|ScrollThresholdValue|ScrollThresholdCallback} */\n    this.enter = null;\n    /** @type {ScrollThresholdParam|ScrollThresholdValue|ScrollThresholdCallback} */\n    this.leave = null;\n    /** @type {Boolean} */\n    this.sync = isEase || isSmooth || !!syncMethods;\n    /** @type {EasingFunction} */\n    this.syncEase = isEase ? ease : null;\n    /** @type {Number} */\n    this.syncSmooth = isSmooth ? syncMode === true || isLinear ? 1 : /** @type {Number} */(syncMode) : null;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncEnter = syncMethods && !biDirSync && syncMethods[0] ? syncMethods[0] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncLeave = syncMethods && !biDirSync && syncMethods[1] ? syncMethods[1] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncEnterForward = syncMethods && biDirSync && syncMethods[0] ? syncMethods[0] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncLeaveForward = syncMethods && biDirSync && syncMethods[1] ? syncMethods[1] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncEnterBackward = syncMethods && biDirSync && syncMethods[2] ? syncMethods[2] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncLeaveBackward = syncMethods && biDirSync && syncMethods[3] ? syncMethods[3] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onEnter = parameters.onEnter || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onLeave = parameters.onLeave || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onEnterForward = parameters.onEnterForward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onLeaveForward = parameters.onLeaveForward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onEnterBackward = parameters.onEnterBackward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onLeaveBackward = parameters.onLeaveBackward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onUpdate = parameters.onUpdate || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncComplete = parameters.onSyncComplete || noop;\n    /** @type {Boolean} */\n    this.reverted = false;\n    /** @type {Boolean} */\n    this.completed = false;\n    /** @type {Boolean} */\n    this.began = false;\n    /** @type {Boolean} */\n    this.isInView = false;\n    /** @type {Boolean} */\n    this.forceEnter = false;\n    /** @type {Boolean} */\n    this.hasEntered = false;\n    /** @type {Array.<Number>} */\n    this.offsets = [];\n    /** @type {Number} */\n    this.offset = 0;\n    /** @type {Number} */\n    this.offsetStart = 0;\n    /** @type {Number} */\n    this.offsetEnd = 0;\n    /** @type {Number} */\n    this.distance = 0;\n    /** @type {Number} */\n    this.prevProgress = 0;\n    /** @type {Array} */\n    this.thresholds = ['start', 'end', 'end', 'start'];\n    /** @type {[Number, Number, Number, Number]} */\n    this.coords = [0, 0, 0, 0];\n    /** @type {JSAnimation} */\n    this.debugStyles = null;\n    /** @type {HTMLElement} */\n    this.$debug = null;\n    /** @type {ScrollObserverParams} */\n    this._params = parameters;\n    /** @type {Boolean} */\n    this._debug = setValue(parameters.debug, false);\n    /** @type {ScrollObserver} */\n    this._next = null;\n    /** @type {ScrollObserver} */\n    this._prev = null;\n    addChild(this.container, this);\n    // Wait for the next frame to add to the container in order to handle calls to link()\n    sync(() => {\n      if (this.reverted) return;\n      if (!this.target) {\n        const target = /** @type {HTMLElement} */(parseTargets(parameters.target)[0]);\n        this.target = target || doc.body;\n        this.refresh();\n      }\n      if (this._debug) this.debug();\n    });\n  }\n\n  /**\n   * @param {Tickable|WAAPIAnimation} linked\n   */\n  link(linked) {\n    if (linked) {\n      // Make sure to pause the linked object in case it's added later\n      linked.pause();\n      this.linked = linked;\n      // Try to use a target of the linked object if no target parameters specified\n      if (!this._params.target) {\n        /** @type {HTMLElement} */\n        let $linkedTarget;\n        if (!isUnd(/** @type {JSAnimation} */(linked).targets)) {\n          $linkedTarget = getAnimationDomTarget(/** @type {JSAnimation} */(linked));\n        } else {\n          forEachChildren(/** @type {Timeline} */(linked), (/** @type {JSAnimation} */child) => {\n            if (child.targets && !$linkedTarget) {\n              $linkedTarget = getAnimationDomTarget(/** @type {JSAnimation} */(child));\n            }\n          });\n        }\n        // Fallback to body if no target found\n        this.target = $linkedTarget || doc.body;\n        this.refresh();\n      }\n    }\n    return this;\n  }\n\n  get velocity() {\n    return this.container.velocity;\n  }\n\n  get backward() {\n    return this.horizontal ? this.container.backwardX : this.container.backwardY;\n  }\n\n  get scroll() {\n    return this.horizontal ? this.container.scrollX : this.container.scrollY;\n  }\n\n  get progress() {\n    const p = (this.scroll - this.offsetStart) / this.distance;\n    return p === Infinity || isNaN(p) ? 0 : round(clamp(p, 0, 1), 6);\n  }\n\n  refresh() {\n    this.reverted = false;\n    const params = this._params;\n    this.repeat = setValue(parseScrollObserverFunctionParameter(params.repeat, this), true);\n    this.horizontal = setValue(parseScrollObserverFunctionParameter(params.axis, this), 'y') === 'x';\n    this.enter = setValue(parseScrollObserverFunctionParameter(params.enter, this), 'end start');\n    this.leave = setValue(parseScrollObserverFunctionParameter(params.leave, this), 'start end');\n    this.updateBounds();\n    this.handleScroll();\n    return this;\n  }\n\n  removeDebug() {\n    if (this.$debug) {\n      this.$debug.parentNode.removeChild(this.$debug);\n      this.$debug = null;\n    }\n    if (this.debugStyles) {\n      this.debugStyles.revert();\n      this.$debug = null;\n    }\n    return this;\n  }\n\n  debug() {\n    this.removeDebug();\n    const container = this.container;\n    const isHori = this.horizontal;\n    const $existingDebug = container.element.querySelector(':scope > .animejs-onscroll-debug');\n    const $debug = doc.createElement('div');\n    const $thresholds = doc.createElement('div');\n    const $triggers = doc.createElement('div');\n    const color = debugColors[this.index % debugColors.length];\n    const useWin = container.useWin;\n    const containerWidth = useWin ? container.winWidth : container.width;\n    const containerHeight = useWin ? container.winHeight : container.height;\n    const scrollWidth = container.scrollWidth;\n    const scrollHeight = container.scrollHeight;\n    const size = this.container.width > 360 ? 320 : 260;\n    const offLeft = isHori ? 0 : 10;\n    const offTop = isHori ? 10 : 0;\n    const half = isHori ? 24 : size / 2;\n    const labelHeight = isHori ? half : 15;\n    const labelWidth = isHori ? 60 : half;\n    const labelSize = isHori ? labelWidth : labelHeight;\n    const repeat = isHori ? 'repeat-x' : 'repeat-y';\n    /**\n     * @param {Number} v\n     * @return {String}\n     */\n    const gradientOffset = v => isHori ? '0px '+(v)+'px' : (v)+'px'+' 2px';\n    /**\n     * @param {String} c\n     * @return {String}\n     */\n    const lineCSS = (c) => `linear-gradient(${isHori ? 90 : 0}deg, ${c} 2px, transparent 1px)`;\n    /**\n     * @param {String} p\n     * @param {Number} l\n     * @param {Number} t\n     * @param {Number} w\n     * @param {Number} h\n     * @return {String}\n     */\n    const baseCSS = (p, l, t, w, h) => `position:${p};left:${l}px;top:${t}px;width:${w}px;height:${h}px;`;\n    $debug.style.cssText = `${baseCSS('absolute', offLeft, offTop, isHori ? scrollWidth : size, isHori ? size : scrollHeight)}\n      pointer-events: none;\n      z-index: ${this.container.zIndex++};\n      display: flex;\n      flex-direction: ${isHori ? 'column' : 'row'};\n      filter: drop-shadow(0px 1px 0px rgba(0,0,0,.75));\n    `;\n    $thresholds.style.cssText = `${baseCSS('sticky', 0, 0, isHori ? containerWidth : half, isHori ? half : containerHeight)}`;\n    if (!$existingDebug) {\n      $thresholds.style.cssText += `background:\n        ${lineCSS('#FFFF')}${gradientOffset(half-10)} / ${isHori ? '100px 100px' : '100px 100px'} ${repeat},\n        ${lineCSS('#FFF8')}${gradientOffset(half-10)} / ${isHori ? '10px 10px' : '10px 10px'} ${repeat};\n      `;\n    }\n    $triggers.style.cssText = `${baseCSS('relative', 0, 0, isHori ? scrollWidth : half, isHori ? half : scrollHeight)}`;\n    if (!$existingDebug) {\n      $triggers.style.cssText += `background:\n        ${lineCSS('#FFFF')}${gradientOffset(0)} / ${isHori ? '100px 10px' : '10px 100px'} ${repeat},\n        ${lineCSS('#FFF8')}${gradientOffset(0)} / ${isHori ? '10px 0px' : '0px 10px'} ${repeat};\n      `;\n    }\n    const labels = [' enter: ', ' leave: '];\n    this.coords.forEach((v, i) => {\n      const isView = i > 1;\n      const value = (isView ? 0 : this.offset) + v;\n      const isTail = i % 2;\n      const isFirst = value < labelSize;\n      const isOver = value > (isView ? isHori ? containerWidth : containerHeight : isHori ? scrollWidth : scrollHeight) - labelSize;\n      const isFlip = (isView ? isTail && !isFirst : !isTail && !isFirst) || isOver;\n      const $label = doc.createElement('div');\n      const $text = doc.createElement('div');\n      const dirProp = isHori ? isFlip ? 'right' : 'left' : isFlip ? 'bottom' : 'top';\n      const flipOffset = isFlip ? (isHori ? labelWidth : labelHeight) + (!isView ? isHori ? -1 : -2 : isHori ? -1 : isOver ? 0 : -2) : !isView ? isHori ? 1 : 0 : isHori ? 1 : 0;\n      // $text.innerHTML = `${!isView ? '' : labels[isTail] + ' '}${this.id}: ${this.thresholds[i]} ${isView ? '' : labels[isTail]}`;\n      $text.innerHTML = `${this.id}${labels[isTail]}${this.thresholds[i]}`;\n      $label.style.cssText = `${baseCSS('absolute', 0, 0, labelWidth, labelHeight)}\n        display: flex;\n        flex-direction: ${isHori ? 'column' : 'row'};\n        justify-content: flex-${isView ? 'start' : 'end'};\n        align-items: flex-${isFlip ? 'end' : 'start'};\n        border-${dirProp}: 2px ${isTail ? 'solid' : 'solid'} ${color};\n      `;\n      $text.style.cssText = `\n        overflow: hidden;\n        max-width: ${(size / 2) - 10}px;\n        height: ${labelHeight};\n        margin-${isHori ? isFlip ? 'right' : 'left' : isFlip ? 'bottom' : 'top'}: -2px;\n        padding: 1px;\n        font-family: ui-monospace, monospace;\n        font-size: 10px;\n        letter-spacing: -.025em;\n        line-height: 9px;\n        font-weight: 600;\n        text-align: ${isHori && isFlip || !isHori && !isView ? 'right' : 'left'};\n        white-space: pre;\n        text-overflow: ellipsis;\n        color: ${isTail ? color : 'rgba(0,0,0,.75)'};\n        background-color: ${isTail ? 'rgba(0,0,0,.65)' : color};\n        border: 2px solid ${isTail ? color : 'transparent'};\n        border-${isHori ? isFlip ? 'top-left' : 'top-right' : isFlip ? 'top-left' : 'bottom-left'}-radius: 5px;\n        border-${isHori ? isFlip ? 'bottom-left' : 'bottom-right' : isFlip ? 'top-right' : 'bottom-right'}-radius: 5px;\n      `;\n      $label.appendChild($text);\n      let position = value - flipOffset + (isHori ? 1 : 0);\n      $label.style[isHori ? 'left' : 'top'] = `${position}px`;\n      // $label.style[isHori ? 'left' : 'top'] = value - flipOffset + (!isFlip && isFirst && !isView ? 1 : isFlip ? 0 : -2) + 'px';\n      (isView ? $thresholds : $triggers).appendChild($label);\n    });\n\n    $debug.appendChild($thresholds);\n    $debug.appendChild($triggers);\n    container.element.appendChild($debug);\n\n    if (!$existingDebug) $debug.classList.add('animejs-onscroll-debug');\n    this.$debug = $debug;\n    const containerPosition = getTargetValue(container.element, 'position');\n    if (containerPosition === 'static') {\n      this.debugStyles = setTargetValues(container.element, { position: 'relative '});\n    }\n\n  }\n\n  updateBounds() {\n    if (this._debug) {\n      this.removeDebug();\n    }\n    let stickys;\n    const $target = this.target;\n    const container = this.container;\n    const isHori = this.horizontal;\n    const linked = this.linked;\n    let linkedTime;\n    let $el = $target;\n    let offsetX = 0;\n    let offsetY = 0;\n    /** @type {Element} */\n    let $offsetParent = $el;\n    if (linked) {\n      linkedTime = linked.currentTime;\n      linked.seek(0, true);\n    }\n    const isContainerStatic = getTargetValue(container.element, 'position') === 'static' ? setTargetValues(container.element, { position: 'relative '}) : false;\n    while ($el && $el !== container.element && $el !== doc.body) {\n      const isSticky = getTargetValue($el, 'position') === 'sticky' ?\n                       setTargetValues($el, { position: 'static' }) :\n                       false;\n      if ($el === $offsetParent) {\n        offsetX += $el.offsetLeft || 0;\n        offsetY += $el.offsetTop || 0;\n        $offsetParent = $el.offsetParent;\n      }\n      $el = /** @type {HTMLElement} */($el.parentElement);\n      if (isSticky) {\n        if (!stickys) stickys = [];\n        stickys.push(isSticky);\n      }\n    }\n    if (isContainerStatic) isContainerStatic.revert();\n    const offset = isHori ? offsetX : offsetY;\n    const targetSize = isHori ? $target.offsetWidth : $target.offsetHeight;\n    const containerSize = isHori ? container.width : container.height;\n    const scrollSize = isHori ? container.scrollWidth : container.scrollHeight;\n    const maxScroll = scrollSize - containerSize;\n    const enter = this.enter;\n    const leave = this.leave;\n\n    /** @type {ScrollThresholdValue} */\n    let enterTarget = 'start';\n    /** @type {ScrollThresholdValue} */\n    let leaveTarget = 'end';\n    /** @type {ScrollThresholdValue} */\n    let enterContainer = 'end';\n    /** @type {ScrollThresholdValue} */\n    let leaveContainer = 'start';\n\n    if (isStr(enter)) {\n      const splitted = /** @type {String} */(enter).split(' ');\n      enterContainer = splitted[0];\n      enterTarget = splitted.length > 1 ? splitted[1] : enterTarget;\n    } else if (isObj(enter)) {\n      const e = /** @type {ScrollThresholdParam} */(enter);\n      if (!isUnd(e.container)) enterContainer = e.container;\n      if (!isUnd(e.target)) enterTarget = e.target;\n    } else if (isNum(enter)) {\n      enterContainer = /** @type {Number} */(enter);\n    }\n\n    if (isStr(leave)) {\n      const splitted = /** @type {String} */(leave).split(' ');\n      leaveContainer = splitted[0];\n      leaveTarget = splitted.length > 1 ? splitted[1] : leaveTarget;\n    } else if (isObj(leave)) {\n      const t = /** @type {ScrollThresholdParam} */(leave);\n      if (!isUnd(t.container)) leaveContainer = t.container;\n      if (!isUnd(t.target)) leaveTarget = t.target;\n    } else if (isNum(leave)) {\n      leaveContainer = /** @type {Number} */(leave);\n    }\n\n    const parsedEnterTarget = parseBoundValue($target, enterTarget, targetSize);\n    const parsedLeaveTarget = parseBoundValue($target, leaveTarget, targetSize);\n    const under = (parsedEnterTarget + offset) - containerSize;\n    const over = (parsedLeaveTarget + offset) - maxScroll;\n    const parsedEnterContainer = parseBoundValue($target, enterContainer, containerSize, under, over);\n    const parsedLeaveContainer = parseBoundValue($target, leaveContainer, containerSize, under, over);\n    const offsetStart = parsedEnterTarget + offset - parsedEnterContainer;\n    const offsetEnd = parsedLeaveTarget + offset - parsedLeaveContainer;\n    const scrollDelta = offsetEnd - offsetStart;\n    this.offsets[0] = offsetX;\n    this.offsets[1] = offsetY;\n    this.offset = offset;\n    this.offsetStart = offsetStart;\n    this.offsetEnd = offsetEnd;\n    this.distance = scrollDelta <= 0 ? 0 : scrollDelta;\n    this.thresholds = [enterTarget, leaveTarget, enterContainer, leaveContainer];\n    this.coords = [parsedEnterTarget, parsedLeaveTarget, parsedEnterContainer, parsedLeaveContainer];\n    if (stickys) {\n      stickys.forEach(sticky => sticky.revert());\n    }\n    if (linked) {\n      linked.seek(linkedTime, true);\n    }\n    if (this._debug) {\n      this.debug();\n    }\n  }\n\n  handleScroll() {\n    const linked = this.linked;\n    const sync = this.sync;\n    const syncEase = this.syncEase;\n    const syncSmooth = this.syncSmooth;\n    const shouldSeek = linked && (syncEase || syncSmooth);\n    const isHori = this.horizontal;\n    const container = this.container;\n    const scroll = this.scroll;\n    const isBefore = scroll <= this.offsetStart;\n    const isAfter = scroll >= this.offsetEnd;\n    const isInView = !isBefore && !isAfter;\n    const isOnTheEdge = scroll === this.offsetStart || scroll === this.offsetEnd;\n    const forceEnter = !this.hasEntered && isOnTheEdge;\n    const $debug = this._debug && this.$debug;\n    let hasUpdated = false;\n    let syncCompleted = false;\n    let p = this.progress;\n\n    if (isBefore && this.began) {\n      this.began = false;\n    }\n\n    if (p > 0 && !this.began) {\n      this.began = true;\n    }\n\n    if (shouldSeek) {\n      const lp = linked.progress;\n      if (syncSmooth && isNum(syncSmooth)) {\n        if (/** @type {Number} */(syncSmooth) < 1) {\n          const step = 0.0001;\n          const snap = lp < p && p === 1 ? step : lp > p && !p ? -1e-4 : 0;\n          p = round(lerp(lp, p, interpolate(.01, .2, /** @type {Number} */(syncSmooth)), false) + snap, 6);\n        }\n      } else if (syncEase) {\n        p = syncEase(p);\n      }\n      hasUpdated = p !== this.prevProgress;\n      syncCompleted = lp === 1;\n      if (hasUpdated && !syncCompleted && (syncSmooth && lp)) {\n        container.wakeTicker.restart();\n      }\n    }\n\n    if ($debug) {\n      const sticky = isHori ? container.scrollY : container.scrollX;\n      $debug.style[isHori ? 'top' : 'left'] = sticky + 10 + 'px';\n    }\n\n    // Trigger enter callbacks if already in view or when entering the view\n    if ((isInView && !this.isInView) || (forceEnter && !this.forceEnter && !this.hasEntered)) {\n      if (isInView) this.isInView = true;\n      if (!this.forceEnter || !this.hasEntered) {\n        if ($debug && isInView) $debug.style.zIndex = `${this.container.zIndex++}`;\n        this.onSyncEnter(this);\n        this.onEnter(this);\n        if (this.backward) {\n          this.onSyncEnterBackward(this);\n          this.onEnterBackward(this);\n        } else {\n          this.onSyncEnterForward(this);\n          this.onEnterForward(this);\n        }\n        this.hasEntered = true;\n        if (forceEnter) this.forceEnter = true;\n      } else if (isInView) {\n        this.forceEnter = false;\n      }\n    }\n\n    if (isInView || !isInView && this.isInView) {\n      hasUpdated = true;\n    }\n\n    if (hasUpdated) {\n      if (shouldSeek) linked.seek(linked.duration * p);\n      this.onUpdate(this);\n    }\n\n    if (!isInView && this.isInView) {\n      this.isInView = false;\n      this.onSyncLeave(this);\n      this.onLeave(this);\n      if (this.backward) {\n        this.onSyncLeaveBackward(this);\n        this.onLeaveBackward(this);\n      } else {\n        this.onSyncLeaveForward(this);\n        this.onLeaveForward(this);\n      }\n      if (sync && !syncSmooth) {\n        syncCompleted = true;\n      }\n    }\n\n    if (p >= 1 && this.began && !this.completed && (sync && syncCompleted || !sync)) {\n      if (sync) {\n        this.onSyncComplete(this);\n      }\n      this.completed = true;\n      if ((!this.repeat && !linked) || (!this.repeat && linked && linked.completed)) {\n        this.revert();\n      }\n    }\n\n    if (p < 1 && this.completed) {\n      this.completed = false;\n    }\n\n    this.prevProgress = p;\n  }\n\n  revert() {\n    if (this.reverted) return;\n    const container = this.container;\n    removeChild(container, this);\n    if (!container._head) {\n      container.revert();\n    }\n    if (this._debug) {\n      this.removeDebug();\n    }\n    this.reverted = true;\n    return this;\n  }\n\n}\n\n/**\n * @param {ScrollObserverParams} [parameters={}]\n * @return {ScrollObserver}\n */\nconst onScroll = (parameters = {}) => new ScrollObserver(parameters);\n\n\n\n\n/**\n * @typedef  {Object} StaggerParameters\n * @property {Number|String} [start]\n * @property {Number|'first'|'center'|'last'} [from]\n * @property {Boolean} [reversed]\n * @property {Array.<Number>} [grid]\n * @property {('x'|'y')} [axis]\n * @property {EasingParam} [ease]\n * @property {TweenModifier} [modifier]\n */\n\n/**\n * @callback StaggerFunction\n * @param {Target} [target]\n * @param {Number} [index]\n * @param {Number} [length]\n * @param {Timeline} [tl]\n * @return {Number|String}\n */\n\n/**\n * @param  {Number|String|[Number|String,Number|String]} val\n * @param  {StaggerParameters} params\n * @return {StaggerFunction}\n */\nconst stagger = (val, params = {}) => {\n  let values = [];\n  let maxValue = 0;\n  const from = params.from;\n  const reversed = params.reversed;\n  const ease = params.ease;\n  const hasEasing = !isUnd(ease);\n  const hasSpring = hasEasing && !isUnd(/** @type {Spring} */(ease).ease);\n  const staggerEase = hasSpring ? /** @type {Spring} */(ease).ease : hasEasing ? parseEasings(ease) : null;\n  const grid = params.grid;\n  const axis = params.axis;\n  const fromFirst = isUnd(from) || from === 0 || from === 'first';\n  const fromCenter = from === 'center';\n  const fromLast = from === 'last';\n  const isRange = isArr(val);\n  const val1 = isRange ? parseNumber(val[0]) : parseNumber(val);\n  const val2 = isRange ? parseNumber(val[1]) : 0;\n  const unitMatch = unitsExecRgx.exec((isRange ? val[1] : val) + emptyString);\n  const start = params.start || 0 + (isRange ? val1 : 0);\n  let fromIndex = fromFirst ? 0 : isNum(from) ? from : 0;\n  return (_, i, t, tl) => {\n    if (fromCenter) fromIndex = (t - 1) / 2;\n    if (fromLast) fromIndex = t - 1;\n    if (!values.length) {\n      for (let index = 0; index < t; index++) {\n        if (!grid) {\n          values.push(abs(fromIndex - index));\n        } else {\n          const fromX = !fromCenter ? fromIndex % grid[0] : (grid[0] - 1) / 2;\n          const fromY = !fromCenter ? floor(fromIndex / grid[0]) : (grid[1] - 1) / 2;\n          const toX = index % grid[0];\n          const toY = floor(index / grid[0]);\n          const distanceX = fromX - toX;\n          const distanceY = fromY - toY;\n          let value = sqrt(distanceX * distanceX + distanceY * distanceY);\n          if (axis === 'x') value = -distanceX;\n          if (axis === 'y') value = -distanceY;\n          values.push(value);\n        }\n        maxValue = max(...values);\n      }\n      if (staggerEase) values = values.map(val => staggerEase(val / maxValue) * maxValue);\n      if (reversed) values = values.map(val => axis ? (val < 0) ? val * -1 : -val : abs(maxValue - val));\n    }\n    const spacing = isRange ? (val2 - val1) / maxValue : val1;\n    const offset = tl ? parseTimelinePosition(tl, isUnd(params.start) ? tl.iterationDuration : start) : /** @type {Number} */(start);\n    /** @type {String|Number} */\n    let output = offset + ((spacing * round(values[i], 2)) || 0);\n    if (params.modifier) output = params.modifier(output);\n    if (unitMatch) output = `${output}${unitMatch[2]}`;\n    return output;\n  }\n};\n\nexport { Animatable, Draggable, JSAnimation, Scope, ScrollObserver, Spring, Timeline, Timer, WAAPIAnimation, animate, createAnimatable, createDraggable, createScope, createSpring, createTimeline, createTimer, eases, engine, onScroll, scrollContainers, stagger, svg, utils, waapi };\n","\n/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */\nfunction isNothing(subject) {\n  return (typeof subject === 'undefined') || (subject === null);\n}\n\n\nfunction isObject(subject) {\n  return (typeof subject === 'object') && (subject !== null);\n}\n\n\nfunction toArray(sequence) {\n  if (Array.isArray(sequence)) return sequence;\n  else if (isNothing(sequence)) return [];\n\n  return [ sequence ];\n}\n\n\nfunction extend(target, source) {\n  var index, length, key, sourceKeys;\n\n  if (source) {\n    sourceKeys = Object.keys(source);\n\n    for (index = 0, length = sourceKeys.length; index < length; index += 1) {\n      key = sourceKeys[index];\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\n\nfunction repeat(string, count) {\n  var result = '', cycle;\n\n  for (cycle = 0; cycle < count; cycle += 1) {\n    result += string;\n  }\n\n  return result;\n}\n\n\nfunction isNegativeZero(number) {\n  return (number === 0) && (Number.NEGATIVE_INFINITY === 1 / number);\n}\n\n\nvar isNothing_1      = isNothing;\nvar isObject_1       = isObject;\nvar toArray_1        = toArray;\nvar repeat_1         = repeat;\nvar isNegativeZero_1 = isNegativeZero;\nvar extend_1         = extend;\n\nvar common = {\n\tisNothing: isNothing_1,\n\tisObject: isObject_1,\n\ttoArray: toArray_1,\n\trepeat: repeat_1,\n\tisNegativeZero: isNegativeZero_1,\n\textend: extend_1\n};\n\n// YAML error class. http://stackoverflow.com/questions/8458984\n\n\nfunction formatError(exception, compact) {\n  var where = '', message = exception.reason || '(unknown reason)';\n\n  if (!exception.mark) return message;\n\n  if (exception.mark.name) {\n    where += 'in \"' + exception.mark.name + '\" ';\n  }\n\n  where += '(' + (exception.mark.line + 1) + ':' + (exception.mark.column + 1) + ')';\n\n  if (!compact && exception.mark.snippet) {\n    where += '\\n\\n' + exception.mark.snippet;\n  }\n\n  return message + ' ' + where;\n}\n\n\nfunction YAMLException$1(reason, mark) {\n  // Super constructor\n  Error.call(this);\n\n  this.name = 'YAMLException';\n  this.reason = reason;\n  this.mark = mark;\n  this.message = formatError(this, false);\n\n  // Include stack trace in error object\n  if (Error.captureStackTrace) {\n    // Chrome and NodeJS\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    // FF, IE 10+ and Safari 6+. Fallback for others\n    this.stack = (new Error()).stack || '';\n  }\n}\n\n\n// Inherit from Error\nYAMLException$1.prototype = Object.create(Error.prototype);\nYAMLException$1.prototype.constructor = YAMLException$1;\n\n\nYAMLException$1.prototype.toString = function toString(compact) {\n  return this.name + ': ' + formatError(this, compact);\n};\n\n\nvar exception = YAMLException$1;\n\n// get snippet for a single line, respecting maxLength\nfunction getLine(buffer, lineStart, lineEnd, position, maxLineLength) {\n  var head = '';\n  var tail = '';\n  var maxHalfLength = Math.floor(maxLineLength / 2) - 1;\n\n  if (position - lineStart > maxHalfLength) {\n    head = ' ... ';\n    lineStart = position - maxHalfLength + head.length;\n  }\n\n  if (lineEnd - position > maxHalfLength) {\n    tail = ' ...';\n    lineEnd = position + maxHalfLength - tail.length;\n  }\n\n  return {\n    str: head + buffer.slice(lineStart, lineEnd).replace(/\\t/g, '→') + tail,\n    pos: position - lineStart + head.length // relative position\n  };\n}\n\n\nfunction padStart(string, max) {\n  return common.repeat(' ', max - string.length) + string;\n}\n\n\nfunction makeSnippet(mark, options) {\n  options = Object.create(options || null);\n\n  if (!mark.buffer) return null;\n\n  if (!options.maxLength) options.maxLength = 79;\n  if (typeof options.indent      !== 'number') options.indent      = 1;\n  if (typeof options.linesBefore !== 'number') options.linesBefore = 3;\n  if (typeof options.linesAfter  !== 'number') options.linesAfter  = 2;\n\n  var re = /\\r?\\n|\\r|\\0/g;\n  var lineStarts = [ 0 ];\n  var lineEnds = [];\n  var match;\n  var foundLineNo = -1;\n\n  while ((match = re.exec(mark.buffer))) {\n    lineEnds.push(match.index);\n    lineStarts.push(match.index + match[0].length);\n\n    if (mark.position <= match.index && foundLineNo < 0) {\n      foundLineNo = lineStarts.length - 2;\n    }\n  }\n\n  if (foundLineNo < 0) foundLineNo = lineStarts.length - 1;\n\n  var result = '', i, line;\n  var lineNoLength = Math.min(mark.line + options.linesAfter, lineEnds.length).toString().length;\n  var maxLineLength = options.maxLength - (options.indent + lineNoLength + 3);\n\n  for (i = 1; i <= options.linesBefore; i++) {\n    if (foundLineNo - i < 0) break;\n    line = getLine(\n      mark.buffer,\n      lineStarts[foundLineNo - i],\n      lineEnds[foundLineNo - i],\n      mark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo - i]),\n      maxLineLength\n    );\n    result = common.repeat(' ', options.indent) + padStart((mark.line - i + 1).toString(), lineNoLength) +\n      ' | ' + line.str + '\\n' + result;\n  }\n\n  line = getLine(mark.buffer, lineStarts[foundLineNo], lineEnds[foundLineNo], mark.position, maxLineLength);\n  result += common.repeat(' ', options.indent) + padStart((mark.line + 1).toString(), lineNoLength) +\n    ' | ' + line.str + '\\n';\n  result += common.repeat('-', options.indent + lineNoLength + 3 + line.pos) + '^' + '\\n';\n\n  for (i = 1; i <= options.linesAfter; i++) {\n    if (foundLineNo + i >= lineEnds.length) break;\n    line = getLine(\n      mark.buffer,\n      lineStarts[foundLineNo + i],\n      lineEnds[foundLineNo + i],\n      mark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo + i]),\n      maxLineLength\n    );\n    result += common.repeat(' ', options.indent) + padStart((mark.line + i + 1).toString(), lineNoLength) +\n      ' | ' + line.str + '\\n';\n  }\n\n  return result.replace(/\\n$/, '');\n}\n\n\nvar snippet = makeSnippet;\n\nvar TYPE_CONSTRUCTOR_OPTIONS = [\n  'kind',\n  'multi',\n  'resolve',\n  'construct',\n  'instanceOf',\n  'predicate',\n  'represent',\n  'representName',\n  'defaultStyle',\n  'styleAliases'\n];\n\nvar YAML_NODE_KINDS = [\n  'scalar',\n  'sequence',\n  'mapping'\n];\n\nfunction compileStyleAliases(map) {\n  var result = {};\n\n  if (map !== null) {\n    Object.keys(map).forEach(function (style) {\n      map[style].forEach(function (alias) {\n        result[String(alias)] = style;\n      });\n    });\n  }\n\n  return result;\n}\n\nfunction Type$1(tag, options) {\n  options = options || {};\n\n  Object.keys(options).forEach(function (name) {\n    if (TYPE_CONSTRUCTOR_OPTIONS.indexOf(name) === -1) {\n      throw new exception('Unknown option \"' + name + '\" is met in definition of \"' + tag + '\" YAML type.');\n    }\n  });\n\n  // TODO: Add tag format check.\n  this.options       = options; // keep original options in case user wants to extend this type later\n  this.tag           = tag;\n  this.kind          = options['kind']          || null;\n  this.resolve       = options['resolve']       || function () { return true; };\n  this.construct     = options['construct']     || function (data) { return data; };\n  this.instanceOf    = options['instanceOf']    || null;\n  this.predicate     = options['predicate']     || null;\n  this.represent     = options['represent']     || null;\n  this.representName = options['representName'] || null;\n  this.defaultStyle  = options['defaultStyle']  || null;\n  this.multi         = options['multi']         || false;\n  this.styleAliases  = compileStyleAliases(options['styleAliases'] || null);\n\n  if (YAML_NODE_KINDS.indexOf(this.kind) === -1) {\n    throw new exception('Unknown kind \"' + this.kind + '\" is specified for \"' + tag + '\" YAML type.');\n  }\n}\n\nvar type = Type$1;\n\n/*eslint-disable max-len*/\n\n\n\n\n\nfunction compileList(schema, name) {\n  var result = [];\n\n  schema[name].forEach(function (currentType) {\n    var newIndex = result.length;\n\n    result.forEach(function (previousType, previousIndex) {\n      if (previousType.tag === currentType.tag &&\n          previousType.kind === currentType.kind &&\n          previousType.multi === currentType.multi) {\n\n        newIndex = previousIndex;\n      }\n    });\n\n    result[newIndex] = currentType;\n  });\n\n  return result;\n}\n\n\nfunction compileMap(/* lists... */) {\n  var result = {\n        scalar: {},\n        sequence: {},\n        mapping: {},\n        fallback: {},\n        multi: {\n          scalar: [],\n          sequence: [],\n          mapping: [],\n          fallback: []\n        }\n      }, index, length;\n\n  function collectType(type) {\n    if (type.multi) {\n      result.multi[type.kind].push(type);\n      result.multi['fallback'].push(type);\n    } else {\n      result[type.kind][type.tag] = result['fallback'][type.tag] = type;\n    }\n  }\n\n  for (index = 0, length = arguments.length; index < length; index += 1) {\n    arguments[index].forEach(collectType);\n  }\n  return result;\n}\n\n\nfunction Schema$1(definition) {\n  return this.extend(definition);\n}\n\n\nSchema$1.prototype.extend = function extend(definition) {\n  var implicit = [];\n  var explicit = [];\n\n  if (definition instanceof type) {\n    // Schema.extend(type)\n    explicit.push(definition);\n\n  } else if (Array.isArray(definition)) {\n    // Schema.extend([ type1, type2, ... ])\n    explicit = explicit.concat(definition);\n\n  } else if (definition && (Array.isArray(definition.implicit) || Array.isArray(definition.explicit))) {\n    // Schema.extend({ explicit: [ type1, type2, ... ], implicit: [ type1, type2, ... ] })\n    if (definition.implicit) implicit = implicit.concat(definition.implicit);\n    if (definition.explicit) explicit = explicit.concat(definition.explicit);\n\n  } else {\n    throw new exception('Schema.extend argument should be a Type, [ Type ], ' +\n      'or a schema definition ({ implicit: [...], explicit: [...] })');\n  }\n\n  implicit.forEach(function (type$1) {\n    if (!(type$1 instanceof type)) {\n      throw new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n    }\n\n    if (type$1.loadKind && type$1.loadKind !== 'scalar') {\n      throw new exception('There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.');\n    }\n\n    if (type$1.multi) {\n      throw new exception('There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.');\n    }\n  });\n\n  explicit.forEach(function (type$1) {\n    if (!(type$1 instanceof type)) {\n      throw new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n    }\n  });\n\n  var result = Object.create(Schema$1.prototype);\n\n  result.implicit = (this.implicit || []).concat(implicit);\n  result.explicit = (this.explicit || []).concat(explicit);\n\n  result.compiledImplicit = compileList(result, 'implicit');\n  result.compiledExplicit = compileList(result, 'explicit');\n  result.compiledTypeMap  = compileMap(result.compiledImplicit, result.compiledExplicit);\n\n  return result;\n};\n\n\nvar schema = Schema$1;\n\nvar str = new type('tag:yaml.org,2002:str', {\n  kind: 'scalar',\n  construct: function (data) { return data !== null ? data : ''; }\n});\n\nvar seq = new type('tag:yaml.org,2002:seq', {\n  kind: 'sequence',\n  construct: function (data) { return data !== null ? data : []; }\n});\n\nvar map = new type('tag:yaml.org,2002:map', {\n  kind: 'mapping',\n  construct: function (data) { return data !== null ? data : {}; }\n});\n\nvar failsafe = new schema({\n  explicit: [\n    str,\n    seq,\n    map\n  ]\n});\n\nfunction resolveYamlNull(data) {\n  if (data === null) return true;\n\n  var max = data.length;\n\n  return (max === 1 && data === '~') ||\n         (max === 4 && (data === 'null' || data === 'Null' || data === 'NULL'));\n}\n\nfunction constructYamlNull() {\n  return null;\n}\n\nfunction isNull(object) {\n  return object === null;\n}\n\nvar _null = new type('tag:yaml.org,2002:null', {\n  kind: 'scalar',\n  resolve: resolveYamlNull,\n  construct: constructYamlNull,\n  predicate: isNull,\n  represent: {\n    canonical: function () { return '~';    },\n    lowercase: function () { return 'null'; },\n    uppercase: function () { return 'NULL'; },\n    camelcase: function () { return 'Null'; },\n    empty:     function () { return '';     }\n  },\n  defaultStyle: 'lowercase'\n});\n\nfunction resolveYamlBoolean(data) {\n  if (data === null) return false;\n\n  var max = data.length;\n\n  return (max === 4 && (data === 'true' || data === 'True' || data === 'TRUE')) ||\n         (max === 5 && (data === 'false' || data === 'False' || data === 'FALSE'));\n}\n\nfunction constructYamlBoolean(data) {\n  return data === 'true' ||\n         data === 'True' ||\n         data === 'TRUE';\n}\n\nfunction isBoolean(object) {\n  return Object.prototype.toString.call(object) === '[object Boolean]';\n}\n\nvar bool = new type('tag:yaml.org,2002:bool', {\n  kind: 'scalar',\n  resolve: resolveYamlBoolean,\n  construct: constructYamlBoolean,\n  predicate: isBoolean,\n  represent: {\n    lowercase: function (object) { return object ? 'true' : 'false'; },\n    uppercase: function (object) { return object ? 'TRUE' : 'FALSE'; },\n    camelcase: function (object) { return object ? 'True' : 'False'; }\n  },\n  defaultStyle: 'lowercase'\n});\n\nfunction isHexCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) ||\n         ((0x41/* A */ <= c) && (c <= 0x46/* F */)) ||\n         ((0x61/* a */ <= c) && (c <= 0x66/* f */));\n}\n\nfunction isOctCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x37/* 7 */));\n}\n\nfunction isDecCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */));\n}\n\nfunction resolveYamlInteger(data) {\n  if (data === null) return false;\n\n  var max = data.length,\n      index = 0,\n      hasDigits = false,\n      ch;\n\n  if (!max) return false;\n\n  ch = data[index];\n\n  // sign\n  if (ch === '-' || ch === '+') {\n    ch = data[++index];\n  }\n\n  if (ch === '0') {\n    // 0\n    if (index + 1 === max) return true;\n    ch = data[++index];\n\n    // base 2, base 8, base 16\n\n    if (ch === 'b') {\n      // base 2\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (ch !== '0' && ch !== '1') return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'x') {\n      // base 16\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isHexCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'o') {\n      // base 8\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isOctCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n  }\n\n  // base 10 (except 0)\n\n  // value should not start with `_`;\n  if (ch === '_') return false;\n\n  for (; index < max; index++) {\n    ch = data[index];\n    if (ch === '_') continue;\n    if (!isDecCode(data.charCodeAt(index))) {\n      return false;\n    }\n    hasDigits = true;\n  }\n\n  // Should have digits and should not end with `_`\n  if (!hasDigits || ch === '_') return false;\n\n  return true;\n}\n\nfunction constructYamlInteger(data) {\n  var value = data, sign = 1, ch;\n\n  if (value.indexOf('_') !== -1) {\n    value = value.replace(/_/g, '');\n  }\n\n  ch = value[0];\n\n  if (ch === '-' || ch === '+') {\n    if (ch === '-') sign = -1;\n    value = value.slice(1);\n    ch = value[0];\n  }\n\n  if (value === '0') return 0;\n\n  if (ch === '0') {\n    if (value[1] === 'b') return sign * parseInt(value.slice(2), 2);\n    if (value[1] === 'x') return sign * parseInt(value.slice(2), 16);\n    if (value[1] === 'o') return sign * parseInt(value.slice(2), 8);\n  }\n\n  return sign * parseInt(value, 10);\n}\n\nfunction isInteger(object) {\n  return (Object.prototype.toString.call(object)) === '[object Number]' &&\n         (object % 1 === 0 && !common.isNegativeZero(object));\n}\n\nvar int = new type('tag:yaml.org,2002:int', {\n  kind: 'scalar',\n  resolve: resolveYamlInteger,\n  construct: constructYamlInteger,\n  predicate: isInteger,\n  represent: {\n    binary:      function (obj) { return obj >= 0 ? '0b' + obj.toString(2) : '-0b' + obj.toString(2).slice(1); },\n    octal:       function (obj) { return obj >= 0 ? '0o'  + obj.toString(8) : '-0o'  + obj.toString(8).slice(1); },\n    decimal:     function (obj) { return obj.toString(10); },\n    /* eslint-disable max-len */\n    hexadecimal: function (obj) { return obj >= 0 ? '0x' + obj.toString(16).toUpperCase() :  '-0x' + obj.toString(16).toUpperCase().slice(1); }\n  },\n  defaultStyle: 'decimal',\n  styleAliases: {\n    binary:      [ 2,  'bin' ],\n    octal:       [ 8,  'oct' ],\n    decimal:     [ 10, 'dec' ],\n    hexadecimal: [ 16, 'hex' ]\n  }\n});\n\nvar YAML_FLOAT_PATTERN = new RegExp(\n  // 2.5e4, 2.5 and integers\n  '^(?:[-+]?(?:[0-9][0-9_]*)(?:\\\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?' +\n  // .2e4, .2\n  // special case, seems not from spec\n  '|\\\\.[0-9_]+(?:[eE][-+]?[0-9]+)?' +\n  // .inf\n  '|[-+]?\\\\.(?:inf|Inf|INF)' +\n  // .nan\n  '|\\\\.(?:nan|NaN|NAN))$');\n\nfunction resolveYamlFloat(data) {\n  if (data === null) return false;\n\n  if (!YAML_FLOAT_PATTERN.test(data) ||\n      // Quick hack to not allow integers end with `_`\n      // Probably should update regexp & check speed\n      data[data.length - 1] === '_') {\n    return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlFloat(data) {\n  var value, sign;\n\n  value  = data.replace(/_/g, '').toLowerCase();\n  sign   = value[0] === '-' ? -1 : 1;\n\n  if ('+-'.indexOf(value[0]) >= 0) {\n    value = value.slice(1);\n  }\n\n  if (value === '.inf') {\n    return (sign === 1) ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY;\n\n  } else if (value === '.nan') {\n    return NaN;\n  }\n  return sign * parseFloat(value, 10);\n}\n\n\nvar SCIENTIFIC_WITHOUT_DOT = /^[-+]?[0-9]+e/;\n\nfunction representYamlFloat(object, style) {\n  var res;\n\n  if (isNaN(object)) {\n    switch (style) {\n      case 'lowercase': return '.nan';\n      case 'uppercase': return '.NAN';\n      case 'camelcase': return '.NaN';\n    }\n  } else if (Number.POSITIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '.inf';\n      case 'uppercase': return '.INF';\n      case 'camelcase': return '.Inf';\n    }\n  } else if (Number.NEGATIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '-.inf';\n      case 'uppercase': return '-.INF';\n      case 'camelcase': return '-.Inf';\n    }\n  } else if (common.isNegativeZero(object)) {\n    return '-0.0';\n  }\n\n  res = object.toString(10);\n\n  // JS stringifier can build scientific format without dots: 5e-100,\n  // while YAML requres dot: 5.e-100. Fix it with simple hack\n\n  return SCIENTIFIC_WITHOUT_DOT.test(res) ? res.replace('e', '.e') : res;\n}\n\nfunction isFloat(object) {\n  return (Object.prototype.toString.call(object) === '[object Number]') &&\n         (object % 1 !== 0 || common.isNegativeZero(object));\n}\n\nvar float = new type('tag:yaml.org,2002:float', {\n  kind: 'scalar',\n  resolve: resolveYamlFloat,\n  construct: constructYamlFloat,\n  predicate: isFloat,\n  represent: representYamlFloat,\n  defaultStyle: 'lowercase'\n});\n\nvar json = failsafe.extend({\n  implicit: [\n    _null,\n    bool,\n    int,\n    float\n  ]\n});\n\nvar core = json;\n\nvar YAML_DATE_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9])'                    + // [2] month\n  '-([0-9][0-9])$');                   // [3] day\n\nvar YAML_TIMESTAMP_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9]?)'                   + // [2] month\n  '-([0-9][0-9]?)'                   + // [3] day\n  '(?:[Tt]|[ \\\\t]+)'                 + // ...\n  '([0-9][0-9]?)'                    + // [4] hour\n  ':([0-9][0-9])'                    + // [5] minute\n  ':([0-9][0-9])'                    + // [6] second\n  '(?:\\\\.([0-9]*))?'                 + // [7] fraction\n  '(?:[ \\\\t]*(Z|([-+])([0-9][0-9]?)' + // [8] tz [9] tz_sign [10] tz_hour\n  '(?::([0-9][0-9]))?))?$');           // [11] tz_minute\n\nfunction resolveYamlTimestamp(data) {\n  if (data === null) return false;\n  if (YAML_DATE_REGEXP.exec(data) !== null) return true;\n  if (YAML_TIMESTAMP_REGEXP.exec(data) !== null) return true;\n  return false;\n}\n\nfunction constructYamlTimestamp(data) {\n  var match, year, month, day, hour, minute, second, fraction = 0,\n      delta = null, tz_hour, tz_minute, date;\n\n  match = YAML_DATE_REGEXP.exec(data);\n  if (match === null) match = YAML_TIMESTAMP_REGEXP.exec(data);\n\n  if (match === null) throw new Error('Date resolve error');\n\n  // match: [1] year [2] month [3] day\n\n  year = +(match[1]);\n  month = +(match[2]) - 1; // JS month starts with 0\n  day = +(match[3]);\n\n  if (!match[4]) { // no hour\n    return new Date(Date.UTC(year, month, day));\n  }\n\n  // match: [4] hour [5] minute [6] second [7] fraction\n\n  hour = +(match[4]);\n  minute = +(match[5]);\n  second = +(match[6]);\n\n  if (match[7]) {\n    fraction = match[7].slice(0, 3);\n    while (fraction.length < 3) { // milli-seconds\n      fraction += '0';\n    }\n    fraction = +fraction;\n  }\n\n  // match: [8] tz [9] tz_sign [10] tz_hour [11] tz_minute\n\n  if (match[9]) {\n    tz_hour = +(match[10]);\n    tz_minute = +(match[11] || 0);\n    delta = (tz_hour * 60 + tz_minute) * 60000; // delta in mili-seconds\n    if (match[9] === '-') delta = -delta;\n  }\n\n  date = new Date(Date.UTC(year, month, day, hour, minute, second, fraction));\n\n  if (delta) date.setTime(date.getTime() - delta);\n\n  return date;\n}\n\nfunction representYamlTimestamp(object /*, style*/) {\n  return object.toISOString();\n}\n\nvar timestamp = new type('tag:yaml.org,2002:timestamp', {\n  kind: 'scalar',\n  resolve: resolveYamlTimestamp,\n  construct: constructYamlTimestamp,\n  instanceOf: Date,\n  represent: representYamlTimestamp\n});\n\nfunction resolveYamlMerge(data) {\n  return data === '<<' || data === null;\n}\n\nvar merge = new type('tag:yaml.org,2002:merge', {\n  kind: 'scalar',\n  resolve: resolveYamlMerge\n});\n\n/*eslint-disable no-bitwise*/\n\n\n\n\n\n// [ 64, 65, 66 ] -> [ padding, CR, LF ]\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\\n\\r';\n\n\nfunction resolveYamlBinary(data) {\n  if (data === null) return false;\n\n  var code, idx, bitlen = 0, max = data.length, map = BASE64_MAP;\n\n  // Convert one by one.\n  for (idx = 0; idx < max; idx++) {\n    code = map.indexOf(data.charAt(idx));\n\n    // Skip CR/LF\n    if (code > 64) continue;\n\n    // Fail on illegal characters\n    if (code < 0) return false;\n\n    bitlen += 6;\n  }\n\n  // If there are any bits left, source was corrupted\n  return (bitlen % 8) === 0;\n}\n\nfunction constructYamlBinary(data) {\n  var idx, tailbits,\n      input = data.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max = input.length,\n      map = BASE64_MAP,\n      bits = 0,\n      result = [];\n\n  // Collect by 6*4 bits (3 bytes)\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      result.push((bits >> 16) & 0xFF);\n      result.push((bits >> 8) & 0xFF);\n      result.push(bits & 0xFF);\n    }\n\n    bits = (bits << 6) | map.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    result.push((bits >> 16) & 0xFF);\n    result.push((bits >> 8) & 0xFF);\n    result.push(bits & 0xFF);\n  } else if (tailbits === 18) {\n    result.push((bits >> 10) & 0xFF);\n    result.push((bits >> 2) & 0xFF);\n  } else if (tailbits === 12) {\n    result.push((bits >> 4) & 0xFF);\n  }\n\n  return new Uint8Array(result);\n}\n\nfunction representYamlBinary(object /*, style*/) {\n  var result = '', bits = 0, idx, tail,\n      max = object.length,\n      map = BASE64_MAP;\n\n  // Convert every three bytes to 4 ASCII characters.\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 3 === 0) && idx) {\n      result += map[(bits >> 18) & 0x3F];\n      result += map[(bits >> 12) & 0x3F];\n      result += map[(bits >> 6) & 0x3F];\n      result += map[bits & 0x3F];\n    }\n\n    bits = (bits << 8) + object[idx];\n  }\n\n  // Dump tail\n\n  tail = max % 3;\n\n  if (tail === 0) {\n    result += map[(bits >> 18) & 0x3F];\n    result += map[(bits >> 12) & 0x3F];\n    result += map[(bits >> 6) & 0x3F];\n    result += map[bits & 0x3F];\n  } else if (tail === 2) {\n    result += map[(bits >> 10) & 0x3F];\n    result += map[(bits >> 4) & 0x3F];\n    result += map[(bits << 2) & 0x3F];\n    result += map[64];\n  } else if (tail === 1) {\n    result += map[(bits >> 2) & 0x3F];\n    result += map[(bits << 4) & 0x3F];\n    result += map[64];\n    result += map[64];\n  }\n\n  return result;\n}\n\nfunction isBinary(obj) {\n  return Object.prototype.toString.call(obj) ===  '[object Uint8Array]';\n}\n\nvar binary = new type('tag:yaml.org,2002:binary', {\n  kind: 'scalar',\n  resolve: resolveYamlBinary,\n  construct: constructYamlBinary,\n  predicate: isBinary,\n  represent: representYamlBinary\n});\n\nvar _hasOwnProperty$3 = Object.prototype.hasOwnProperty;\nvar _toString$2       = Object.prototype.toString;\n\nfunction resolveYamlOmap(data) {\n  if (data === null) return true;\n\n  var objectKeys = [], index, length, pair, pairKey, pairHasKey,\n      object = data;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n    pairHasKey = false;\n\n    if (_toString$2.call(pair) !== '[object Object]') return false;\n\n    for (pairKey in pair) {\n      if (_hasOwnProperty$3.call(pair, pairKey)) {\n        if (!pairHasKey) pairHasKey = true;\n        else return false;\n      }\n    }\n\n    if (!pairHasKey) return false;\n\n    if (objectKeys.indexOf(pairKey) === -1) objectKeys.push(pairKey);\n    else return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlOmap(data) {\n  return data !== null ? data : [];\n}\n\nvar omap = new type('tag:yaml.org,2002:omap', {\n  kind: 'sequence',\n  resolve: resolveYamlOmap,\n  construct: constructYamlOmap\n});\n\nvar _toString$1 = Object.prototype.toString;\n\nfunction resolveYamlPairs(data) {\n  if (data === null) return true;\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    if (_toString$1.call(pair) !== '[object Object]') return false;\n\n    keys = Object.keys(pair);\n\n    if (keys.length !== 1) return false;\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return true;\n}\n\nfunction constructYamlPairs(data) {\n  if (data === null) return [];\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    keys = Object.keys(pair);\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return result;\n}\n\nvar pairs = new type('tag:yaml.org,2002:pairs', {\n  kind: 'sequence',\n  resolve: resolveYamlPairs,\n  construct: constructYamlPairs\n});\n\nvar _hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n\nfunction resolveYamlSet(data) {\n  if (data === null) return true;\n\n  var key, object = data;\n\n  for (key in object) {\n    if (_hasOwnProperty$2.call(object, key)) {\n      if (object[key] !== null) return false;\n    }\n  }\n\n  return true;\n}\n\nfunction constructYamlSet(data) {\n  return data !== null ? data : {};\n}\n\nvar set = new type('tag:yaml.org,2002:set', {\n  kind: 'mapping',\n  resolve: resolveYamlSet,\n  construct: constructYamlSet\n});\n\nvar _default = core.extend({\n  implicit: [\n    timestamp,\n    merge\n  ],\n  explicit: [\n    binary,\n    omap,\n    pairs,\n    set\n  ]\n});\n\n/*eslint-disable max-len,no-use-before-define*/\n\n\n\n\n\n\n\nvar _hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n\n\nvar CONTEXT_FLOW_IN   = 1;\nvar CONTEXT_FLOW_OUT  = 2;\nvar CONTEXT_BLOCK_IN  = 3;\nvar CONTEXT_BLOCK_OUT = 4;\n\n\nvar CHOMPING_CLIP  = 1;\nvar CHOMPING_STRIP = 2;\nvar CHOMPING_KEEP  = 3;\n\n\nvar PATTERN_NON_PRINTABLE         = /[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x84\\x86-\\x9F\\uFFFE\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/;\nvar PATTERN_NON_ASCII_LINE_BREAKS = /[\\x85\\u2028\\u2029]/;\nvar PATTERN_FLOW_INDICATORS       = /[,\\[\\]\\{\\}]/;\nvar PATTERN_TAG_HANDLE            = /^(?:!|!!|![a-z\\-]+!)$/i;\nvar PATTERN_TAG_URI               = /^(?:!|[^,\\[\\]\\{\\}])(?:%[0-9a-f]{2}|[0-9a-z\\-#;\\/\\?:@&=\\+\\$,_\\.!~\\*'\\(\\)\\[\\]])*$/i;\n\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\n\nfunction is_EOL(c) {\n  return (c === 0x0A/* LF */) || (c === 0x0D/* CR */);\n}\n\nfunction is_WHITE_SPACE(c) {\n  return (c === 0x09/* Tab */) || (c === 0x20/* Space */);\n}\n\nfunction is_WS_OR_EOL(c) {\n  return (c === 0x09/* Tab */) ||\n         (c === 0x20/* Space */) ||\n         (c === 0x0A/* LF */) ||\n         (c === 0x0D/* CR */);\n}\n\nfunction is_FLOW_INDICATOR(c) {\n  return c === 0x2C/* , */ ||\n         c === 0x5B/* [ */ ||\n         c === 0x5D/* ] */ ||\n         c === 0x7B/* { */ ||\n         c === 0x7D/* } */;\n}\n\nfunction fromHexCode(c) {\n  var lc;\n\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  /*eslint-disable no-bitwise*/\n  lc = c | 0x20;\n\n  if ((0x61/* a */ <= lc) && (lc <= 0x66/* f */)) {\n    return lc - 0x61 + 10;\n  }\n\n  return -1;\n}\n\nfunction escapedHexLen(c) {\n  if (c === 0x78/* x */) { return 2; }\n  if (c === 0x75/* u */) { return 4; }\n  if (c === 0x55/* U */) { return 8; }\n  return 0;\n}\n\nfunction fromDecimalCode(c) {\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  return -1;\n}\n\nfunction simpleEscapeSequence(c) {\n  /* eslint-disable indent */\n  return (c === 0x30/* 0 */) ? '\\x00' :\n        (c === 0x61/* a */) ? '\\x07' :\n        (c === 0x62/* b */) ? '\\x08' :\n        (c === 0x74/* t */) ? '\\x09' :\n        (c === 0x09/* Tab */) ? '\\x09' :\n        (c === 0x6E/* n */) ? '\\x0A' :\n        (c === 0x76/* v */) ? '\\x0B' :\n        (c === 0x66/* f */) ? '\\x0C' :\n        (c === 0x72/* r */) ? '\\x0D' :\n        (c === 0x65/* e */) ? '\\x1B' :\n        (c === 0x20/* Space */) ? ' ' :\n        (c === 0x22/* \" */) ? '\\x22' :\n        (c === 0x2F/* / */) ? '/' :\n        (c === 0x5C/* \\ */) ? '\\x5C' :\n        (c === 0x4E/* N */) ? '\\x85' :\n        (c === 0x5F/* _ */) ? '\\xA0' :\n        (c === 0x4C/* L */) ? '\\u2028' :\n        (c === 0x50/* P */) ? '\\u2029' : '';\n}\n\nfunction charFromCodepoint(c) {\n  if (c <= 0xFFFF) {\n    return String.fromCharCode(c);\n  }\n  // Encode UTF-16 surrogate pair\n  // https://en.wikipedia.org/wiki/UTF-16#Code_points_U.2B010000_to_U.2B10FFFF\n  return String.fromCharCode(\n    ((c - 0x010000) >> 10) + 0xD800,\n    ((c - 0x010000) & 0x03FF) + 0xDC00\n  );\n}\n\nvar simpleEscapeCheck = new Array(256); // integer, for fast access\nvar simpleEscapeMap = new Array(256);\nfor (var i = 0; i < 256; i++) {\n  simpleEscapeCheck[i] = simpleEscapeSequence(i) ? 1 : 0;\n  simpleEscapeMap[i] = simpleEscapeSequence(i);\n}\n\n\nfunction State$1(input, options) {\n  this.input = input;\n\n  this.filename  = options['filename']  || null;\n  this.schema    = options['schema']    || _default;\n  this.onWarning = options['onWarning'] || null;\n  // (Hidden) Remove? makes the loader to expect YAML 1.1 documents\n  // if such documents have no explicit %YAML directive\n  this.legacy    = options['legacy']    || false;\n\n  this.json      = options['json']      || false;\n  this.listener  = options['listener']  || null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.typeMap       = this.schema.compiledTypeMap;\n\n  this.length     = input.length;\n  this.position   = 0;\n  this.line       = 0;\n  this.lineStart  = 0;\n  this.lineIndent = 0;\n\n  // position of first leading tab in the current line,\n  // used to make sure there are no tabs in the indentation\n  this.firstTabInLine = -1;\n\n  this.documents = [];\n\n  /*\n  this.version;\n  this.checkLineBreaks;\n  this.tagMap;\n  this.anchorMap;\n  this.tag;\n  this.anchor;\n  this.kind;\n  this.result;*/\n\n}\n\n\nfunction generateError(state, message) {\n  var mark = {\n    name:     state.filename,\n    buffer:   state.input.slice(0, -1), // omit trailing \\0\n    position: state.position,\n    line:     state.line,\n    column:   state.position - state.lineStart\n  };\n\n  mark.snippet = snippet(mark);\n\n  return new exception(message, mark);\n}\n\nfunction throwError(state, message) {\n  throw generateError(state, message);\n}\n\nfunction throwWarning(state, message) {\n  if (state.onWarning) {\n    state.onWarning.call(null, generateError(state, message));\n  }\n}\n\n\nvar directiveHandlers = {\n\n  YAML: function handleYamlDirective(state, name, args) {\n\n    var match, major, minor;\n\n    if (state.version !== null) {\n      throwError(state, 'duplication of %YAML directive');\n    }\n\n    if (args.length !== 1) {\n      throwError(state, 'YAML directive accepts exactly one argument');\n    }\n\n    match = /^([0-9]+)\\.([0-9]+)$/.exec(args[0]);\n\n    if (match === null) {\n      throwError(state, 'ill-formed argument of the YAML directive');\n    }\n\n    major = parseInt(match[1], 10);\n    minor = parseInt(match[2], 10);\n\n    if (major !== 1) {\n      throwError(state, 'unacceptable YAML version of the document');\n    }\n\n    state.version = args[0];\n    state.checkLineBreaks = (minor < 2);\n\n    if (minor !== 1 && minor !== 2) {\n      throwWarning(state, 'unsupported YAML version of the document');\n    }\n  },\n\n  TAG: function handleTagDirective(state, name, args) {\n\n    var handle, prefix;\n\n    if (args.length !== 2) {\n      throwError(state, 'TAG directive accepts exactly two arguments');\n    }\n\n    handle = args[0];\n    prefix = args[1];\n\n    if (!PATTERN_TAG_HANDLE.test(handle)) {\n      throwError(state, 'ill-formed tag handle (first argument) of the TAG directive');\n    }\n\n    if (_hasOwnProperty$1.call(state.tagMap, handle)) {\n      throwError(state, 'there is a previously declared suffix for \"' + handle + '\" tag handle');\n    }\n\n    if (!PATTERN_TAG_URI.test(prefix)) {\n      throwError(state, 'ill-formed tag prefix (second argument) of the TAG directive');\n    }\n\n    try {\n      prefix = decodeURIComponent(prefix);\n    } catch (err) {\n      throwError(state, 'tag prefix is malformed: ' + prefix);\n    }\n\n    state.tagMap[handle] = prefix;\n  }\n};\n\n\nfunction captureSegment(state, start, end, checkJson) {\n  var _position, _length, _character, _result;\n\n  if (start < end) {\n    _result = state.input.slice(start, end);\n\n    if (checkJson) {\n      for (_position = 0, _length = _result.length; _position < _length; _position += 1) {\n        _character = _result.charCodeAt(_position);\n        if (!(_character === 0x09 ||\n              (0x20 <= _character && _character <= 0x10FFFF))) {\n          throwError(state, 'expected valid JSON character');\n        }\n      }\n    } else if (PATTERN_NON_PRINTABLE.test(_result)) {\n      throwError(state, 'the stream contains non-printable characters');\n    }\n\n    state.result += _result;\n  }\n}\n\nfunction mergeMappings(state, destination, source, overridableKeys) {\n  var sourceKeys, key, index, quantity;\n\n  if (!common.isObject(source)) {\n    throwError(state, 'cannot merge mappings; the provided source object is unacceptable');\n  }\n\n  sourceKeys = Object.keys(source);\n\n  for (index = 0, quantity = sourceKeys.length; index < quantity; index += 1) {\n    key = sourceKeys[index];\n\n    if (!_hasOwnProperty$1.call(destination, key)) {\n      destination[key] = source[key];\n      overridableKeys[key] = true;\n    }\n  }\n}\n\nfunction storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode,\n  startLine, startLineStart, startPos) {\n\n  var index, quantity;\n\n  // The output is a plain object here, so keys can only be strings.\n  // We need to convert keyNode to a string, but doing so can hang the process\n  // (deeply nested arrays that explode exponentially using aliases).\n  if (Array.isArray(keyNode)) {\n    keyNode = Array.prototype.slice.call(keyNode);\n\n    for (index = 0, quantity = keyNode.length; index < quantity; index += 1) {\n      if (Array.isArray(keyNode[index])) {\n        throwError(state, 'nested arrays are not supported inside keys');\n      }\n\n      if (typeof keyNode === 'object' && _class(keyNode[index]) === '[object Object]') {\n        keyNode[index] = '[object Object]';\n      }\n    }\n  }\n\n  // Avoid code execution in load() via toString property\n  // (still use its own toString for arrays, timestamps,\n  // and whatever user schema extensions happen to have @@toStringTag)\n  if (typeof keyNode === 'object' && _class(keyNode) === '[object Object]') {\n    keyNode = '[object Object]';\n  }\n\n\n  keyNode = String(keyNode);\n\n  if (_result === null) {\n    _result = {};\n  }\n\n  if (keyTag === 'tag:yaml.org,2002:merge') {\n    if (Array.isArray(valueNode)) {\n      for (index = 0, quantity = valueNode.length; index < quantity; index += 1) {\n        mergeMappings(state, _result, valueNode[index], overridableKeys);\n      }\n    } else {\n      mergeMappings(state, _result, valueNode, overridableKeys);\n    }\n  } else {\n    if (!state.json &&\n        !_hasOwnProperty$1.call(overridableKeys, keyNode) &&\n        _hasOwnProperty$1.call(_result, keyNode)) {\n      state.line = startLine || state.line;\n      state.lineStart = startLineStart || state.lineStart;\n      state.position = startPos || state.position;\n      throwError(state, 'duplicated mapping key');\n    }\n\n    // used for this specific key only because Object.defineProperty is slow\n    if (keyNode === '__proto__') {\n      Object.defineProperty(_result, keyNode, {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value: valueNode\n      });\n    } else {\n      _result[keyNode] = valueNode;\n    }\n    delete overridableKeys[keyNode];\n  }\n\n  return _result;\n}\n\nfunction readLineBreak(state) {\n  var ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x0A/* LF */) {\n    state.position++;\n  } else if (ch === 0x0D/* CR */) {\n    state.position++;\n    if (state.input.charCodeAt(state.position) === 0x0A/* LF */) {\n      state.position++;\n    }\n  } else {\n    throwError(state, 'a line break is expected');\n  }\n\n  state.line += 1;\n  state.lineStart = state.position;\n  state.firstTabInLine = -1;\n}\n\nfunction skipSeparationSpace(state, allowComments, checkIndent) {\n  var lineBreaks = 0,\n      ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    while (is_WHITE_SPACE(ch)) {\n      if (ch === 0x09/* Tab */ && state.firstTabInLine === -1) {\n        state.firstTabInLine = state.position;\n      }\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (allowComments && ch === 0x23/* # */) {\n      do {\n        ch = state.input.charCodeAt(++state.position);\n      } while (ch !== 0x0A/* LF */ && ch !== 0x0D/* CR */ && ch !== 0);\n    }\n\n    if (is_EOL(ch)) {\n      readLineBreak(state);\n\n      ch = state.input.charCodeAt(state.position);\n      lineBreaks++;\n      state.lineIndent = 0;\n\n      while (ch === 0x20/* Space */) {\n        state.lineIndent++;\n        ch = state.input.charCodeAt(++state.position);\n      }\n    } else {\n      break;\n    }\n  }\n\n  if (checkIndent !== -1 && lineBreaks !== 0 && state.lineIndent < checkIndent) {\n    throwWarning(state, 'deficient indentation');\n  }\n\n  return lineBreaks;\n}\n\nfunction testDocumentSeparator(state) {\n  var _position = state.position,\n      ch;\n\n  ch = state.input.charCodeAt(_position);\n\n  // Condition state.position === state.lineStart is tested\n  // in parent on each call, for efficiency. No needs to test here again.\n  if ((ch === 0x2D/* - */ || ch === 0x2E/* . */) &&\n      ch === state.input.charCodeAt(_position + 1) &&\n      ch === state.input.charCodeAt(_position + 2)) {\n\n    _position += 3;\n\n    ch = state.input.charCodeAt(_position);\n\n    if (ch === 0 || is_WS_OR_EOL(ch)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction writeFoldedLines(state, count) {\n  if (count === 1) {\n    state.result += ' ';\n  } else if (count > 1) {\n    state.result += common.repeat('\\n', count - 1);\n  }\n}\n\n\nfunction readPlainScalar(state, nodeIndent, withinFlowCollection) {\n  var preceding,\n      following,\n      captureStart,\n      captureEnd,\n      hasPendingContent,\n      _line,\n      _lineStart,\n      _lineIndent,\n      _kind = state.kind,\n      _result = state.result,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (is_WS_OR_EOL(ch)      ||\n      is_FLOW_INDICATOR(ch) ||\n      ch === 0x23/* # */    ||\n      ch === 0x26/* & */    ||\n      ch === 0x2A/* * */    ||\n      ch === 0x21/* ! */    ||\n      ch === 0x7C/* | */    ||\n      ch === 0x3E/* > */    ||\n      ch === 0x27/* ' */    ||\n      ch === 0x22/* \" */    ||\n      ch === 0x25/* % */    ||\n      ch === 0x40/* @ */    ||\n      ch === 0x60/* ` */) {\n    return false;\n  }\n\n  if (ch === 0x3F/* ? */ || ch === 0x2D/* - */) {\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (is_WS_OR_EOL(following) ||\n        withinFlowCollection && is_FLOW_INDICATOR(following)) {\n      return false;\n    }\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  captureStart = captureEnd = state.position;\n  hasPendingContent = false;\n\n  while (ch !== 0) {\n    if (ch === 0x3A/* : */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following) ||\n          withinFlowCollection && is_FLOW_INDICATOR(following)) {\n        break;\n      }\n\n    } else if (ch === 0x23/* # */) {\n      preceding = state.input.charCodeAt(state.position - 1);\n\n      if (is_WS_OR_EOL(preceding)) {\n        break;\n      }\n\n    } else if ((state.position === state.lineStart && testDocumentSeparator(state)) ||\n               withinFlowCollection && is_FLOW_INDICATOR(ch)) {\n      break;\n\n    } else if (is_EOL(ch)) {\n      _line = state.line;\n      _lineStart = state.lineStart;\n      _lineIndent = state.lineIndent;\n      skipSeparationSpace(state, false, -1);\n\n      if (state.lineIndent >= nodeIndent) {\n        hasPendingContent = true;\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      } else {\n        state.position = captureEnd;\n        state.line = _line;\n        state.lineStart = _lineStart;\n        state.lineIndent = _lineIndent;\n        break;\n      }\n    }\n\n    if (hasPendingContent) {\n      captureSegment(state, captureStart, captureEnd, false);\n      writeFoldedLines(state, state.line - _line);\n      captureStart = captureEnd = state.position;\n      hasPendingContent = false;\n    }\n\n    if (!is_WHITE_SPACE(ch)) {\n      captureEnd = state.position + 1;\n    }\n\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  captureSegment(state, captureStart, captureEnd, false);\n\n  if (state.result) {\n    return true;\n  }\n\n  state.kind = _kind;\n  state.result = _result;\n  return false;\n}\n\nfunction readSingleQuotedScalar(state, nodeIndent) {\n  var ch,\n      captureStart, captureEnd;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x27/* ' */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x27/* ' */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (ch === 0x27/* ' */) {\n        captureStart = state.position;\n        state.position++;\n        captureEnd = state.position;\n      } else {\n        return true;\n      }\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a single quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a single quoted scalar');\n}\n\nfunction readDoubleQuotedScalar(state, nodeIndent) {\n  var captureStart,\n      captureEnd,\n      hexLength,\n      hexResult,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x22/* \" */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x22/* \" */) {\n      captureSegment(state, captureStart, state.position, true);\n      state.position++;\n      return true;\n\n    } else if (ch === 0x5C/* \\ */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (is_EOL(ch)) {\n        skipSeparationSpace(state, false, nodeIndent);\n\n        // TODO: rework to inline fn with no type cast?\n      } else if (ch < 256 && simpleEscapeCheck[ch]) {\n        state.result += simpleEscapeMap[ch];\n        state.position++;\n\n      } else if ((tmp = escapedHexLen(ch)) > 0) {\n        hexLength = tmp;\n        hexResult = 0;\n\n        for (; hexLength > 0; hexLength--) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if ((tmp = fromHexCode(ch)) >= 0) {\n            hexResult = (hexResult << 4) + tmp;\n\n          } else {\n            throwError(state, 'expected hexadecimal character');\n          }\n        }\n\n        state.result += charFromCodepoint(hexResult);\n\n        state.position++;\n\n      } else {\n        throwError(state, 'unknown escape sequence');\n      }\n\n      captureStart = captureEnd = state.position;\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a double quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a double quoted scalar');\n}\n\nfunction readFlowCollection(state, nodeIndent) {\n  var readNext = true,\n      _line,\n      _lineStart,\n      _pos,\n      _tag     = state.tag,\n      _result,\n      _anchor  = state.anchor,\n      following,\n      terminator,\n      isPair,\n      isExplicitPair,\n      isMapping,\n      overridableKeys = Object.create(null),\n      keyNode,\n      keyTag,\n      valueNode,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x5B/* [ */) {\n    terminator = 0x5D;/* ] */\n    isMapping = false;\n    _result = [];\n  } else if (ch === 0x7B/* { */) {\n    terminator = 0x7D;/* } */\n    isMapping = true;\n    _result = {};\n  } else {\n    return false;\n  }\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  while (ch !== 0) {\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === terminator) {\n      state.position++;\n      state.tag = _tag;\n      state.anchor = _anchor;\n      state.kind = isMapping ? 'mapping' : 'sequence';\n      state.result = _result;\n      return true;\n    } else if (!readNext) {\n      throwError(state, 'missed comma between flow collection entries');\n    } else if (ch === 0x2C/* , */) {\n      // \"flow collection entries can never be completely empty\", as per YAML 1.2, section 7.4\n      throwError(state, \"expected the node content, but found ','\");\n    }\n\n    keyTag = keyNode = valueNode = null;\n    isPair = isExplicitPair = false;\n\n    if (ch === 0x3F/* ? */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following)) {\n        isPair = isExplicitPair = true;\n        state.position++;\n        skipSeparationSpace(state, true, nodeIndent);\n      }\n    }\n\n    _line = state.line; // Save the current line.\n    _lineStart = state.lineStart;\n    _pos = state.position;\n    composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n    keyTag = state.tag;\n    keyNode = state.result;\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((isExplicitPair || state.line === _line) && ch === 0x3A/* : */) {\n      isPair = true;\n      ch = state.input.charCodeAt(++state.position);\n      skipSeparationSpace(state, true, nodeIndent);\n      composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n      valueNode = state.result;\n    }\n\n    if (isMapping) {\n      storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos);\n    } else if (isPair) {\n      _result.push(storeMappingPair(state, null, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos));\n    } else {\n      _result.push(keyNode);\n    }\n\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === 0x2C/* , */) {\n      readNext = true;\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      readNext = false;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a flow collection');\n}\n\nfunction readBlockScalar(state, nodeIndent) {\n  var captureStart,\n      folding,\n      chomping       = CHOMPING_CLIP,\n      didReadContent = false,\n      detectedIndent = false,\n      textIndent     = nodeIndent,\n      emptyLines     = 0,\n      atMoreIndented = false,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x7C/* | */) {\n    folding = false;\n  } else if (ch === 0x3E/* > */) {\n    folding = true;\n  } else {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n\n  while (ch !== 0) {\n    ch = state.input.charCodeAt(++state.position);\n\n    if (ch === 0x2B/* + */ || ch === 0x2D/* - */) {\n      if (CHOMPING_CLIP === chomping) {\n        chomping = (ch === 0x2B/* + */) ? CHOMPING_KEEP : CHOMPING_STRIP;\n      } else {\n        throwError(state, 'repeat of a chomping mode identifier');\n      }\n\n    } else if ((tmp = fromDecimalCode(ch)) >= 0) {\n      if (tmp === 0) {\n        throwError(state, 'bad explicit indentation width of a block scalar; it cannot be less than one');\n      } else if (!detectedIndent) {\n        textIndent = nodeIndent + tmp - 1;\n        detectedIndent = true;\n      } else {\n        throwError(state, 'repeat of an indentation width identifier');\n      }\n\n    } else {\n      break;\n    }\n  }\n\n  if (is_WHITE_SPACE(ch)) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (is_WHITE_SPACE(ch));\n\n    if (ch === 0x23/* # */) {\n      do { ch = state.input.charCodeAt(++state.position); }\n      while (!is_EOL(ch) && (ch !== 0));\n    }\n  }\n\n  while (ch !== 0) {\n    readLineBreak(state);\n    state.lineIndent = 0;\n\n    ch = state.input.charCodeAt(state.position);\n\n    while ((!detectedIndent || state.lineIndent < textIndent) &&\n           (ch === 0x20/* Space */)) {\n      state.lineIndent++;\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (!detectedIndent && state.lineIndent > textIndent) {\n      textIndent = state.lineIndent;\n    }\n\n    if (is_EOL(ch)) {\n      emptyLines++;\n      continue;\n    }\n\n    // End of the scalar.\n    if (state.lineIndent < textIndent) {\n\n      // Perform the chomping.\n      if (chomping === CHOMPING_KEEP) {\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n      } else if (chomping === CHOMPING_CLIP) {\n        if (didReadContent) { // i.e. only if the scalar is not empty.\n          state.result += '\\n';\n        }\n      }\n\n      // Break this `while` cycle and go to the funciton's epilogue.\n      break;\n    }\n\n    // Folded style: use fancy rules to handle line breaks.\n    if (folding) {\n\n      // Lines starting with white space characters (more-indented lines) are not folded.\n      if (is_WHITE_SPACE(ch)) {\n        atMoreIndented = true;\n        // except for the first content line (cf. Example 8.1)\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n\n      // End of more-indented block.\n      } else if (atMoreIndented) {\n        atMoreIndented = false;\n        state.result += common.repeat('\\n', emptyLines + 1);\n\n      // Just one line break - perceive as the same line.\n      } else if (emptyLines === 0) {\n        if (didReadContent) { // i.e. only if we have already read some scalar content.\n          state.result += ' ';\n        }\n\n      // Several line breaks - perceive as different lines.\n      } else {\n        state.result += common.repeat('\\n', emptyLines);\n      }\n\n    // Literal style: just add exact number of line breaks between content lines.\n    } else {\n      // Keep all line breaks except the header line break.\n      state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n    }\n\n    didReadContent = true;\n    detectedIndent = true;\n    emptyLines = 0;\n    captureStart = state.position;\n\n    while (!is_EOL(ch) && (ch !== 0)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    captureSegment(state, captureStart, state.position, false);\n  }\n\n  return true;\n}\n\nfunction readBlockSequence(state, nodeIndent) {\n  var _line,\n      _tag      = state.tag,\n      _anchor   = state.anchor,\n      _result   = [],\n      following,\n      detected  = false,\n      ch;\n\n  // there is a leading tab before this token, so it can't be a block sequence/mapping;\n  // it can still be flow sequence/mapping or a scalar\n  if (state.firstTabInLine !== -1) return false;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    if (state.firstTabInLine !== -1) {\n      state.position = state.firstTabInLine;\n      throwError(state, 'tab characters must not be used in indentation');\n    }\n\n    if (ch !== 0x2D/* - */) {\n      break;\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (!is_WS_OR_EOL(following)) {\n      break;\n    }\n\n    detected = true;\n    state.position++;\n\n    if (skipSeparationSpace(state, true, -1)) {\n      if (state.lineIndent <= nodeIndent) {\n        _result.push(null);\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      }\n    }\n\n    _line = state.line;\n    composeNode(state, nodeIndent, CONTEXT_BLOCK_IN, false, true);\n    _result.push(state.result);\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a sequence entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'sequence';\n    state.result = _result;\n    return true;\n  }\n  return false;\n}\n\nfunction readBlockMapping(state, nodeIndent, flowIndent) {\n  var following,\n      allowCompact,\n      _line,\n      _keyLine,\n      _keyLineStart,\n      _keyPos,\n      _tag          = state.tag,\n      _anchor       = state.anchor,\n      _result       = {},\n      overridableKeys = Object.create(null),\n      keyTag        = null,\n      keyNode       = null,\n      valueNode     = null,\n      atExplicitKey = false,\n      detected      = false,\n      ch;\n\n  // there is a leading tab before this token, so it can't be a block sequence/mapping;\n  // it can still be flow sequence/mapping or a scalar\n  if (state.firstTabInLine !== -1) return false;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    if (!atExplicitKey && state.firstTabInLine !== -1) {\n      state.position = state.firstTabInLine;\n      throwError(state, 'tab characters must not be used in indentation');\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n    _line = state.line; // Save the current line.\n\n    //\n    // Explicit notation case. There are two separate blocks:\n    // first for the key (denoted by \"?\") and second for the value (denoted by \":\")\n    //\n    if ((ch === 0x3F/* ? */ || ch === 0x3A/* : */) && is_WS_OR_EOL(following)) {\n\n      if (ch === 0x3F/* ? */) {\n        if (atExplicitKey) {\n          storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n          keyTag = keyNode = valueNode = null;\n        }\n\n        detected = true;\n        atExplicitKey = true;\n        allowCompact = true;\n\n      } else if (atExplicitKey) {\n        // i.e. 0x3A/* : */ === character after the explicit key.\n        atExplicitKey = false;\n        allowCompact = true;\n\n      } else {\n        throwError(state, 'incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line');\n      }\n\n      state.position += 1;\n      ch = following;\n\n    //\n    // Implicit notation case. Flow-style node as the key first, then \":\", and the value.\n    //\n    } else {\n      _keyLine = state.line;\n      _keyLineStart = state.lineStart;\n      _keyPos = state.position;\n\n      if (!composeNode(state, flowIndent, CONTEXT_FLOW_OUT, false, true)) {\n        // Neither implicit nor explicit notation.\n        // Reading is done. Go to the epilogue.\n        break;\n      }\n\n      if (state.line === _line) {\n        ch = state.input.charCodeAt(state.position);\n\n        while (is_WHITE_SPACE(ch)) {\n          ch = state.input.charCodeAt(++state.position);\n        }\n\n        if (ch === 0x3A/* : */) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if (!is_WS_OR_EOL(ch)) {\n            throwError(state, 'a whitespace character is expected after the key-value separator within a block mapping');\n          }\n\n          if (atExplicitKey) {\n            storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n            keyTag = keyNode = valueNode = null;\n          }\n\n          detected = true;\n          atExplicitKey = false;\n          allowCompact = false;\n          keyTag = state.tag;\n          keyNode = state.result;\n\n        } else if (detected) {\n          throwError(state, 'can not read an implicit mapping pair; a colon is missed');\n\n        } else {\n          state.tag = _tag;\n          state.anchor = _anchor;\n          return true; // Keep the result of `composeNode`.\n        }\n\n      } else if (detected) {\n        throwError(state, 'can not read a block mapping entry; a multiline key may not be an implicit key');\n\n      } else {\n        state.tag = _tag;\n        state.anchor = _anchor;\n        return true; // Keep the result of `composeNode`.\n      }\n    }\n\n    //\n    // Common reading code for both explicit and implicit notations.\n    //\n    if (state.line === _line || state.lineIndent > nodeIndent) {\n      if (atExplicitKey) {\n        _keyLine = state.line;\n        _keyLineStart = state.lineStart;\n        _keyPos = state.position;\n      }\n\n      if (composeNode(state, nodeIndent, CONTEXT_BLOCK_OUT, true, allowCompact)) {\n        if (atExplicitKey) {\n          keyNode = state.result;\n        } else {\n          valueNode = state.result;\n        }\n      }\n\n      if (!atExplicitKey) {\n        storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _keyLine, _keyLineStart, _keyPos);\n        keyTag = keyNode = valueNode = null;\n      }\n\n      skipSeparationSpace(state, true, -1);\n      ch = state.input.charCodeAt(state.position);\n    }\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a mapping entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  //\n  // Epilogue.\n  //\n\n  // Special case: last mapping's node contains only the key in explicit notation.\n  if (atExplicitKey) {\n    storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n  }\n\n  // Expose the resulting mapping.\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'mapping';\n    state.result = _result;\n  }\n\n  return detected;\n}\n\nfunction readTagProperty(state) {\n  var _position,\n      isVerbatim = false,\n      isNamed    = false,\n      tagHandle,\n      tagName,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x21/* ! */) return false;\n\n  if (state.tag !== null) {\n    throwError(state, 'duplication of a tag property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  if (ch === 0x3C/* < */) {\n    isVerbatim = true;\n    ch = state.input.charCodeAt(++state.position);\n\n  } else if (ch === 0x21/* ! */) {\n    isNamed = true;\n    tagHandle = '!!';\n    ch = state.input.charCodeAt(++state.position);\n\n  } else {\n    tagHandle = '!';\n  }\n\n  _position = state.position;\n\n  if (isVerbatim) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (ch !== 0 && ch !== 0x3E/* > */);\n\n    if (state.position < state.length) {\n      tagName = state.input.slice(_position, state.position);\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      throwError(state, 'unexpected end of the stream within a verbatim tag');\n    }\n  } else {\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n\n      if (ch === 0x21/* ! */) {\n        if (!isNamed) {\n          tagHandle = state.input.slice(_position - 1, state.position + 1);\n\n          if (!PATTERN_TAG_HANDLE.test(tagHandle)) {\n            throwError(state, 'named tag handle cannot contain such characters');\n          }\n\n          isNamed = true;\n          _position = state.position + 1;\n        } else {\n          throwError(state, 'tag suffix cannot contain exclamation marks');\n        }\n      }\n\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    tagName = state.input.slice(_position, state.position);\n\n    if (PATTERN_FLOW_INDICATORS.test(tagName)) {\n      throwError(state, 'tag suffix cannot contain flow indicator characters');\n    }\n  }\n\n  if (tagName && !PATTERN_TAG_URI.test(tagName)) {\n    throwError(state, 'tag name cannot contain such characters: ' + tagName);\n  }\n\n  try {\n    tagName = decodeURIComponent(tagName);\n  } catch (err) {\n    throwError(state, 'tag name is malformed: ' + tagName);\n  }\n\n  if (isVerbatim) {\n    state.tag = tagName;\n\n  } else if (_hasOwnProperty$1.call(state.tagMap, tagHandle)) {\n    state.tag = state.tagMap[tagHandle] + tagName;\n\n  } else if (tagHandle === '!') {\n    state.tag = '!' + tagName;\n\n  } else if (tagHandle === '!!') {\n    state.tag = 'tag:yaml.org,2002:' + tagName;\n\n  } else {\n    throwError(state, 'undeclared tag handle \"' + tagHandle + '\"');\n  }\n\n  return true;\n}\n\nfunction readAnchorProperty(state) {\n  var _position,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x26/* & */) return false;\n\n  if (state.anchor !== null) {\n    throwError(state, 'duplication of an anchor property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an anchor node must contain at least one character');\n  }\n\n  state.anchor = state.input.slice(_position, state.position);\n  return true;\n}\n\nfunction readAlias(state) {\n  var _position, alias,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x2A/* * */) return false;\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an alias node must contain at least one character');\n  }\n\n  alias = state.input.slice(_position, state.position);\n\n  if (!_hasOwnProperty$1.call(state.anchorMap, alias)) {\n    throwError(state, 'unidentified alias \"' + alias + '\"');\n  }\n\n  state.result = state.anchorMap[alias];\n  skipSeparationSpace(state, true, -1);\n  return true;\n}\n\nfunction composeNode(state, parentIndent, nodeContext, allowToSeek, allowCompact) {\n  var allowBlockStyles,\n      allowBlockScalars,\n      allowBlockCollections,\n      indentStatus = 1, // 1: this>parent, 0: this=parent, -1: this<parent\n      atNewLine  = false,\n      hasContent = false,\n      typeIndex,\n      typeQuantity,\n      typeList,\n      type,\n      flowIndent,\n      blockIndent;\n\n  if (state.listener !== null) {\n    state.listener('open', state);\n  }\n\n  state.tag    = null;\n  state.anchor = null;\n  state.kind   = null;\n  state.result = null;\n\n  allowBlockStyles = allowBlockScalars = allowBlockCollections =\n    CONTEXT_BLOCK_OUT === nodeContext ||\n    CONTEXT_BLOCK_IN  === nodeContext;\n\n  if (allowToSeek) {\n    if (skipSeparationSpace(state, true, -1)) {\n      atNewLine = true;\n\n      if (state.lineIndent > parentIndent) {\n        indentStatus = 1;\n      } else if (state.lineIndent === parentIndent) {\n        indentStatus = 0;\n      } else if (state.lineIndent < parentIndent) {\n        indentStatus = -1;\n      }\n    }\n  }\n\n  if (indentStatus === 1) {\n    while (readTagProperty(state) || readAnchorProperty(state)) {\n      if (skipSeparationSpace(state, true, -1)) {\n        atNewLine = true;\n        allowBlockCollections = allowBlockStyles;\n\n        if (state.lineIndent > parentIndent) {\n          indentStatus = 1;\n        } else if (state.lineIndent === parentIndent) {\n          indentStatus = 0;\n        } else if (state.lineIndent < parentIndent) {\n          indentStatus = -1;\n        }\n      } else {\n        allowBlockCollections = false;\n      }\n    }\n  }\n\n  if (allowBlockCollections) {\n    allowBlockCollections = atNewLine || allowCompact;\n  }\n\n  if (indentStatus === 1 || CONTEXT_BLOCK_OUT === nodeContext) {\n    if (CONTEXT_FLOW_IN === nodeContext || CONTEXT_FLOW_OUT === nodeContext) {\n      flowIndent = parentIndent;\n    } else {\n      flowIndent = parentIndent + 1;\n    }\n\n    blockIndent = state.position - state.lineStart;\n\n    if (indentStatus === 1) {\n      if (allowBlockCollections &&\n          (readBlockSequence(state, blockIndent) ||\n           readBlockMapping(state, blockIndent, flowIndent)) ||\n          readFlowCollection(state, flowIndent)) {\n        hasContent = true;\n      } else {\n        if ((allowBlockScalars && readBlockScalar(state, flowIndent)) ||\n            readSingleQuotedScalar(state, flowIndent) ||\n            readDoubleQuotedScalar(state, flowIndent)) {\n          hasContent = true;\n\n        } else if (readAlias(state)) {\n          hasContent = true;\n\n          if (state.tag !== null || state.anchor !== null) {\n            throwError(state, 'alias node should not have any properties');\n          }\n\n        } else if (readPlainScalar(state, flowIndent, CONTEXT_FLOW_IN === nodeContext)) {\n          hasContent = true;\n\n          if (state.tag === null) {\n            state.tag = '?';\n          }\n        }\n\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n      }\n    } else if (indentStatus === 0) {\n      // Special case: block sequences are allowed to have same indentation level as the parent.\n      // http://www.yaml.org/spec/1.2/spec.html#id2799784\n      hasContent = allowBlockCollections && readBlockSequence(state, blockIndent);\n    }\n  }\n\n  if (state.tag === null) {\n    if (state.anchor !== null) {\n      state.anchorMap[state.anchor] = state.result;\n    }\n\n  } else if (state.tag === '?') {\n    // Implicit resolving is not allowed for non-scalar types, and '?'\n    // non-specific tag is only automatically assigned to plain scalars.\n    //\n    // We only need to check kind conformity in case user explicitly assigns '?'\n    // tag, for example like this: \"!<?> [0]\"\n    //\n    if (state.result !== null && state.kind !== 'scalar') {\n      throwError(state, 'unacceptable node kind for !<?> tag; it should be \"scalar\", not \"' + state.kind + '\"');\n    }\n\n    for (typeIndex = 0, typeQuantity = state.implicitTypes.length; typeIndex < typeQuantity; typeIndex += 1) {\n      type = state.implicitTypes[typeIndex];\n\n      if (type.resolve(state.result)) { // `state.result` updated in resolver if matched\n        state.result = type.construct(state.result);\n        state.tag = type.tag;\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n        break;\n      }\n    }\n  } else if (state.tag !== '!') {\n    if (_hasOwnProperty$1.call(state.typeMap[state.kind || 'fallback'], state.tag)) {\n      type = state.typeMap[state.kind || 'fallback'][state.tag];\n    } else {\n      // looking for multi type\n      type = null;\n      typeList = state.typeMap.multi[state.kind || 'fallback'];\n\n      for (typeIndex = 0, typeQuantity = typeList.length; typeIndex < typeQuantity; typeIndex += 1) {\n        if (state.tag.slice(0, typeList[typeIndex].tag.length) === typeList[typeIndex].tag) {\n          type = typeList[typeIndex];\n          break;\n        }\n      }\n    }\n\n    if (!type) {\n      throwError(state, 'unknown tag !<' + state.tag + '>');\n    }\n\n    if (state.result !== null && type.kind !== state.kind) {\n      throwError(state, 'unacceptable node kind for !<' + state.tag + '> tag; it should be \"' + type.kind + '\", not \"' + state.kind + '\"');\n    }\n\n    if (!type.resolve(state.result, state.tag)) { // `state.result` updated in resolver if matched\n      throwError(state, 'cannot resolve a node with !<' + state.tag + '> explicit tag');\n    } else {\n      state.result = type.construct(state.result, state.tag);\n      if (state.anchor !== null) {\n        state.anchorMap[state.anchor] = state.result;\n      }\n    }\n  }\n\n  if (state.listener !== null) {\n    state.listener('close', state);\n  }\n  return state.tag !== null ||  state.anchor !== null || hasContent;\n}\n\nfunction readDocument(state) {\n  var documentStart = state.position,\n      _position,\n      directiveName,\n      directiveArgs,\n      hasDirectives = false,\n      ch;\n\n  state.version = null;\n  state.checkLineBreaks = state.legacy;\n  state.tagMap = Object.create(null);\n  state.anchorMap = Object.create(null);\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (state.lineIndent > 0 || ch !== 0x25/* % */) {\n      break;\n    }\n\n    hasDirectives = true;\n    ch = state.input.charCodeAt(++state.position);\n    _position = state.position;\n\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    directiveName = state.input.slice(_position, state.position);\n    directiveArgs = [];\n\n    if (directiveName.length < 1) {\n      throwError(state, 'directive name must not be less than one character in length');\n    }\n\n    while (ch !== 0) {\n      while (is_WHITE_SPACE(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      if (ch === 0x23/* # */) {\n        do { ch = state.input.charCodeAt(++state.position); }\n        while (ch !== 0 && !is_EOL(ch));\n        break;\n      }\n\n      if (is_EOL(ch)) break;\n\n      _position = state.position;\n\n      while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      directiveArgs.push(state.input.slice(_position, state.position));\n    }\n\n    if (ch !== 0) readLineBreak(state);\n\n    if (_hasOwnProperty$1.call(directiveHandlers, directiveName)) {\n      directiveHandlers[directiveName](state, directiveName, directiveArgs);\n    } else {\n      throwWarning(state, 'unknown document directive \"' + directiveName + '\"');\n    }\n  }\n\n  skipSeparationSpace(state, true, -1);\n\n  if (state.lineIndent === 0 &&\n      state.input.charCodeAt(state.position)     === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 1) === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 2) === 0x2D/* - */) {\n    state.position += 3;\n    skipSeparationSpace(state, true, -1);\n\n  } else if (hasDirectives) {\n    throwError(state, 'directives end mark is expected');\n  }\n\n  composeNode(state, state.lineIndent - 1, CONTEXT_BLOCK_OUT, false, true);\n  skipSeparationSpace(state, true, -1);\n\n  if (state.checkLineBreaks &&\n      PATTERN_NON_ASCII_LINE_BREAKS.test(state.input.slice(documentStart, state.position))) {\n    throwWarning(state, 'non-ASCII line breaks are interpreted as content');\n  }\n\n  state.documents.push(state.result);\n\n  if (state.position === state.lineStart && testDocumentSeparator(state)) {\n\n    if (state.input.charCodeAt(state.position) === 0x2E/* . */) {\n      state.position += 3;\n      skipSeparationSpace(state, true, -1);\n    }\n    return;\n  }\n\n  if (state.position < (state.length - 1)) {\n    throwError(state, 'end of the stream or a document separator is expected');\n  } else {\n    return;\n  }\n}\n\n\nfunction loadDocuments(input, options) {\n  input = String(input);\n  options = options || {};\n\n  if (input.length !== 0) {\n\n    // Add tailing `\\n` if not exists\n    if (input.charCodeAt(input.length - 1) !== 0x0A/* LF */ &&\n        input.charCodeAt(input.length - 1) !== 0x0D/* CR */) {\n      input += '\\n';\n    }\n\n    // Strip BOM\n    if (input.charCodeAt(0) === 0xFEFF) {\n      input = input.slice(1);\n    }\n  }\n\n  var state = new State$1(input, options);\n\n  var nullpos = input.indexOf('\\0');\n\n  if (nullpos !== -1) {\n    state.position = nullpos;\n    throwError(state, 'null byte is not allowed in input');\n  }\n\n  // Use 0 as string terminator. That significantly simplifies bounds check.\n  state.input += '\\0';\n\n  while (state.input.charCodeAt(state.position) === 0x20/* Space */) {\n    state.lineIndent += 1;\n    state.position += 1;\n  }\n\n  while (state.position < (state.length - 1)) {\n    readDocument(state);\n  }\n\n  return state.documents;\n}\n\n\nfunction loadAll$1(input, iterator, options) {\n  if (iterator !== null && typeof iterator === 'object' && typeof options === 'undefined') {\n    options = iterator;\n    iterator = null;\n  }\n\n  var documents = loadDocuments(input, options);\n\n  if (typeof iterator !== 'function') {\n    return documents;\n  }\n\n  for (var index = 0, length = documents.length; index < length; index += 1) {\n    iterator(documents[index]);\n  }\n}\n\n\nfunction load$1(input, options) {\n  var documents = loadDocuments(input, options);\n\n  if (documents.length === 0) {\n    /*eslint-disable no-undefined*/\n    return undefined;\n  } else if (documents.length === 1) {\n    return documents[0];\n  }\n  throw new exception('expected a single document in the stream, but found more');\n}\n\n\nvar loadAll_1 = loadAll$1;\nvar load_1    = load$1;\n\nvar loader = {\n\tloadAll: loadAll_1,\n\tload: load_1\n};\n\n/*eslint-disable no-use-before-define*/\n\n\n\n\n\nvar _toString       = Object.prototype.toString;\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar CHAR_BOM                  = 0xFEFF;\nvar CHAR_TAB                  = 0x09; /* Tab */\nvar CHAR_LINE_FEED            = 0x0A; /* LF */\nvar CHAR_CARRIAGE_RETURN      = 0x0D; /* CR */\nvar CHAR_SPACE                = 0x20; /* Space */\nvar CHAR_EXCLAMATION          = 0x21; /* ! */\nvar CHAR_DOUBLE_QUOTE         = 0x22; /* \" */\nvar CHAR_SHARP                = 0x23; /* # */\nvar CHAR_PERCENT              = 0x25; /* % */\nvar CHAR_AMPERSAND            = 0x26; /* & */\nvar CHAR_SINGLE_QUOTE         = 0x27; /* ' */\nvar CHAR_ASTERISK             = 0x2A; /* * */\nvar CHAR_COMMA                = 0x2C; /* , */\nvar CHAR_MINUS                = 0x2D; /* - */\nvar CHAR_COLON                = 0x3A; /* : */\nvar CHAR_EQUALS               = 0x3D; /* = */\nvar CHAR_GREATER_THAN         = 0x3E; /* > */\nvar CHAR_QUESTION             = 0x3F; /* ? */\nvar CHAR_COMMERCIAL_AT        = 0x40; /* @ */\nvar CHAR_LEFT_SQUARE_BRACKET  = 0x5B; /* [ */\nvar CHAR_RIGHT_SQUARE_BRACKET = 0x5D; /* ] */\nvar CHAR_GRAVE_ACCENT         = 0x60; /* ` */\nvar CHAR_LEFT_CURLY_BRACKET   = 0x7B; /* { */\nvar CHAR_VERTICAL_LINE        = 0x7C; /* | */\nvar CHAR_RIGHT_CURLY_BRACKET  = 0x7D; /* } */\n\nvar ESCAPE_SEQUENCES = {};\n\nESCAPE_SEQUENCES[0x00]   = '\\\\0';\nESCAPE_SEQUENCES[0x07]   = '\\\\a';\nESCAPE_SEQUENCES[0x08]   = '\\\\b';\nESCAPE_SEQUENCES[0x09]   = '\\\\t';\nESCAPE_SEQUENCES[0x0A]   = '\\\\n';\nESCAPE_SEQUENCES[0x0B]   = '\\\\v';\nESCAPE_SEQUENCES[0x0C]   = '\\\\f';\nESCAPE_SEQUENCES[0x0D]   = '\\\\r';\nESCAPE_SEQUENCES[0x1B]   = '\\\\e';\nESCAPE_SEQUENCES[0x22]   = '\\\\\"';\nESCAPE_SEQUENCES[0x5C]   = '\\\\\\\\';\nESCAPE_SEQUENCES[0x85]   = '\\\\N';\nESCAPE_SEQUENCES[0xA0]   = '\\\\_';\nESCAPE_SEQUENCES[0x2028] = '\\\\L';\nESCAPE_SEQUENCES[0x2029] = '\\\\P';\n\nvar DEPRECATED_BOOLEANS_SYNTAX = [\n  'y', 'Y', 'yes', 'Yes', 'YES', 'on', 'On', 'ON',\n  'n', 'N', 'no', 'No', 'NO', 'off', 'Off', 'OFF'\n];\n\nvar DEPRECATED_BASE60_SYNTAX = /^[-+]?[0-9_]+(?::[0-9_]+)+(?:\\.[0-9_]*)?$/;\n\nfunction compileStyleMap(schema, map) {\n  var result, keys, index, length, tag, style, type;\n\n  if (map === null) return {};\n\n  result = {};\n  keys = Object.keys(map);\n\n  for (index = 0, length = keys.length; index < length; index += 1) {\n    tag = keys[index];\n    style = String(map[tag]);\n\n    if (tag.slice(0, 2) === '!!') {\n      tag = 'tag:yaml.org,2002:' + tag.slice(2);\n    }\n    type = schema.compiledTypeMap['fallback'][tag];\n\n    if (type && _hasOwnProperty.call(type.styleAliases, style)) {\n      style = type.styleAliases[style];\n    }\n\n    result[tag] = style;\n  }\n\n  return result;\n}\n\nfunction encodeHex(character) {\n  var string, handle, length;\n\n  string = character.toString(16).toUpperCase();\n\n  if (character <= 0xFF) {\n    handle = 'x';\n    length = 2;\n  } else if (character <= 0xFFFF) {\n    handle = 'u';\n    length = 4;\n  } else if (character <= 0xFFFFFFFF) {\n    handle = 'U';\n    length = 8;\n  } else {\n    throw new exception('code point within a string may not be greater than 0xFFFFFFFF');\n  }\n\n  return '\\\\' + handle + common.repeat('0', length - string.length) + string;\n}\n\n\nvar QUOTING_TYPE_SINGLE = 1,\n    QUOTING_TYPE_DOUBLE = 2;\n\nfunction State(options) {\n  this.schema        = options['schema'] || _default;\n  this.indent        = Math.max(1, (options['indent'] || 2));\n  this.noArrayIndent = options['noArrayIndent'] || false;\n  this.skipInvalid   = options['skipInvalid'] || false;\n  this.flowLevel     = (common.isNothing(options['flowLevel']) ? -1 : options['flowLevel']);\n  this.styleMap      = compileStyleMap(this.schema, options['styles'] || null);\n  this.sortKeys      = options['sortKeys'] || false;\n  this.lineWidth     = options['lineWidth'] || 80;\n  this.noRefs        = options['noRefs'] || false;\n  this.noCompatMode  = options['noCompatMode'] || false;\n  this.condenseFlow  = options['condenseFlow'] || false;\n  this.quotingType   = options['quotingType'] === '\"' ? QUOTING_TYPE_DOUBLE : QUOTING_TYPE_SINGLE;\n  this.forceQuotes   = options['forceQuotes'] || false;\n  this.replacer      = typeof options['replacer'] === 'function' ? options['replacer'] : null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.explicitTypes = this.schema.compiledExplicit;\n\n  this.tag = null;\n  this.result = '';\n\n  this.duplicates = [];\n  this.usedDuplicates = null;\n}\n\n// Indents every line in a string. Empty lines (\\n only) are not indented.\nfunction indentString(string, spaces) {\n  var ind = common.repeat(' ', spaces),\n      position = 0,\n      next = -1,\n      result = '',\n      line,\n      length = string.length;\n\n  while (position < length) {\n    next = string.indexOf('\\n', position);\n    if (next === -1) {\n      line = string.slice(position);\n      position = length;\n    } else {\n      line = string.slice(position, next + 1);\n      position = next + 1;\n    }\n\n    if (line.length && line !== '\\n') result += ind;\n\n    result += line;\n  }\n\n  return result;\n}\n\nfunction generateNextLine(state, level) {\n  return '\\n' + common.repeat(' ', state.indent * level);\n}\n\nfunction testImplicitResolving(state, str) {\n  var index, length, type;\n\n  for (index = 0, length = state.implicitTypes.length; index < length; index += 1) {\n    type = state.implicitTypes[index];\n\n    if (type.resolve(str)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// [33] s-white ::= s-space | s-tab\nfunction isWhitespace(c) {\n  return c === CHAR_SPACE || c === CHAR_TAB;\n}\n\n// Returns true if the character can be printed without escaping.\n// From YAML 1.2: \"any allowed characters known to be non-printable\n// should also be escaped. [However,] This isn’t mandatory\"\n// Derived from nb-char - \\t - #x85 - #xA0 - #x2028 - #x2029.\nfunction isPrintable(c) {\n  return  (0x00020 <= c && c <= 0x00007E)\n      || ((0x000A1 <= c && c <= 0x00D7FF) && c !== 0x2028 && c !== 0x2029)\n      || ((0x0E000 <= c && c <= 0x00FFFD) && c !== CHAR_BOM)\n      ||  (0x10000 <= c && c <= 0x10FFFF);\n}\n\n// [34] ns-char ::= nb-char - s-white\n// [27] nb-char ::= c-printable - b-char - c-byte-order-mark\n// [26] b-char  ::= b-line-feed | b-carriage-return\n// Including s-white (for some reason, examples doesn't match specs in this aspect)\n// ns-char ::= c-printable - b-line-feed - b-carriage-return - c-byte-order-mark\nfunction isNsCharOrWhitespace(c) {\n  return isPrintable(c)\n    && c !== CHAR_BOM\n    // - b-char\n    && c !== CHAR_CARRIAGE_RETURN\n    && c !== CHAR_LINE_FEED;\n}\n\n// [127]  ns-plain-safe(c) ::= c = flow-out  ⇒ ns-plain-safe-out\n//                             c = flow-in   ⇒ ns-plain-safe-in\n//                             c = block-key ⇒ ns-plain-safe-out\n//                             c = flow-key  ⇒ ns-plain-safe-in\n// [128] ns-plain-safe-out ::= ns-char\n// [129]  ns-plain-safe-in ::= ns-char - c-flow-indicator\n// [130]  ns-plain-char(c) ::=  ( ns-plain-safe(c) - “:” - “#” )\n//                            | ( /* An ns-char preceding */ “#” )\n//                            | ( “:” /* Followed by an ns-plain-safe(c) */ )\nfunction isPlainSafe(c, prev, inblock) {\n  var cIsNsCharOrWhitespace = isNsCharOrWhitespace(c);\n  var cIsNsChar = cIsNsCharOrWhitespace && !isWhitespace(c);\n  return (\n    // ns-plain-safe\n    inblock ? // c = flow-in\n      cIsNsCharOrWhitespace\n      : cIsNsCharOrWhitespace\n        // - c-flow-indicator\n        && c !== CHAR_COMMA\n        && c !== CHAR_LEFT_SQUARE_BRACKET\n        && c !== CHAR_RIGHT_SQUARE_BRACKET\n        && c !== CHAR_LEFT_CURLY_BRACKET\n        && c !== CHAR_RIGHT_CURLY_BRACKET\n  )\n    // ns-plain-char\n    && c !== CHAR_SHARP // false on '#'\n    && !(prev === CHAR_COLON && !cIsNsChar) // false on ': '\n    || (isNsCharOrWhitespace(prev) && !isWhitespace(prev) && c === CHAR_SHARP) // change to true on '[^ ]#'\n    || (prev === CHAR_COLON && cIsNsChar); // change to true on ':[^ ]'\n}\n\n// Simplified test for values allowed as the first character in plain style.\nfunction isPlainSafeFirst(c) {\n  // Uses a subset of ns-char - c-indicator\n  // where ns-char = nb-char - s-white.\n  // No support of ( ( “?” | “:” | “-” ) /* Followed by an ns-plain-safe(c)) */ ) part\n  return isPrintable(c) && c !== CHAR_BOM\n    && !isWhitespace(c) // - s-white\n    // - (c-indicator ::=\n    // “-” | “?” | “:” | “,” | “[” | “]” | “{” | “}”\n    && c !== CHAR_MINUS\n    && c !== CHAR_QUESTION\n    && c !== CHAR_COLON\n    && c !== CHAR_COMMA\n    && c !== CHAR_LEFT_SQUARE_BRACKET\n    && c !== CHAR_RIGHT_SQUARE_BRACKET\n    && c !== CHAR_LEFT_CURLY_BRACKET\n    && c !== CHAR_RIGHT_CURLY_BRACKET\n    // | “#” | “&” | “*” | “!” | “|” | “=” | “>” | “'” | “\"”\n    && c !== CHAR_SHARP\n    && c !== CHAR_AMPERSAND\n    && c !== CHAR_ASTERISK\n    && c !== CHAR_EXCLAMATION\n    && c !== CHAR_VERTICAL_LINE\n    && c !== CHAR_EQUALS\n    && c !== CHAR_GREATER_THAN\n    && c !== CHAR_SINGLE_QUOTE\n    && c !== CHAR_DOUBLE_QUOTE\n    // | “%” | “@” | “`”)\n    && c !== CHAR_PERCENT\n    && c !== CHAR_COMMERCIAL_AT\n    && c !== CHAR_GRAVE_ACCENT;\n}\n\n// Simplified test for values allowed as the last character in plain style.\nfunction isPlainSafeLast(c) {\n  // just not whitespace or colon, it will be checked to be plain character later\n  return !isWhitespace(c) && c !== CHAR_COLON;\n}\n\n// Same as 'string'.codePointAt(pos), but works in older browsers.\nfunction codePointAt(string, pos) {\n  var first = string.charCodeAt(pos), second;\n  if (first >= 0xD800 && first <= 0xDBFF && pos + 1 < string.length) {\n    second = string.charCodeAt(pos + 1);\n    if (second >= 0xDC00 && second <= 0xDFFF) {\n      // https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n      return (first - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n    }\n  }\n  return first;\n}\n\n// Determines whether block indentation indicator is required.\nfunction needIndentIndicator(string) {\n  var leadingSpaceRe = /^\\n* /;\n  return leadingSpaceRe.test(string);\n}\n\nvar STYLE_PLAIN   = 1,\n    STYLE_SINGLE  = 2,\n    STYLE_LITERAL = 3,\n    STYLE_FOLDED  = 4,\n    STYLE_DOUBLE  = 5;\n\n// Determines which scalar styles are possible and returns the preferred style.\n// lineWidth = -1 => no limit.\n// Pre-conditions: str.length > 0.\n// Post-conditions:\n//    STYLE_PLAIN or STYLE_SINGLE => no \\n are in the string.\n//    STYLE_LITERAL => no lines are suitable for folding (or lineWidth is -1).\n//    STYLE_FOLDED => a line > lineWidth and can be folded (and lineWidth != -1).\nfunction chooseScalarStyle(string, singleLineOnly, indentPerLevel, lineWidth,\n  testAmbiguousType, quotingType, forceQuotes, inblock) {\n\n  var i;\n  var char = 0;\n  var prevChar = null;\n  var hasLineBreak = false;\n  var hasFoldableLine = false; // only checked if shouldTrackWidth\n  var shouldTrackWidth = lineWidth !== -1;\n  var previousLineBreak = -1; // count the first line correctly\n  var plain = isPlainSafeFirst(codePointAt(string, 0))\n          && isPlainSafeLast(codePointAt(string, string.length - 1));\n\n  if (singleLineOnly || forceQuotes) {\n    // Case: no block styles.\n    // Check for disallowed characters to rule out plain and single.\n    for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n      char = codePointAt(string, i);\n      if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char, prevChar, inblock);\n      prevChar = char;\n    }\n  } else {\n    // Case: block styles permitted.\n    for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n      char = codePointAt(string, i);\n      if (char === CHAR_LINE_FEED) {\n        hasLineBreak = true;\n        // Check if any line can be folded.\n        if (shouldTrackWidth) {\n          hasFoldableLine = hasFoldableLine ||\n            // Foldable line = too long, and not more-indented.\n            (i - previousLineBreak - 1 > lineWidth &&\n             string[previousLineBreak + 1] !== ' ');\n          previousLineBreak = i;\n        }\n      } else if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char, prevChar, inblock);\n      prevChar = char;\n    }\n    // in case the end is missing a \\n\n    hasFoldableLine = hasFoldableLine || (shouldTrackWidth &&\n      (i - previousLineBreak - 1 > lineWidth &&\n       string[previousLineBreak + 1] !== ' '));\n  }\n  // Although every style can represent \\n without escaping, prefer block styles\n  // for multiline, since they're more readable and they don't add empty lines.\n  // Also prefer folding a super-long line.\n  if (!hasLineBreak && !hasFoldableLine) {\n    // Strings interpretable as another type have to be quoted;\n    // e.g. the string 'true' vs. the boolean true.\n    if (plain && !forceQuotes && !testAmbiguousType(string)) {\n      return STYLE_PLAIN;\n    }\n    return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n  }\n  // Edge case: block indentation indicator can only have one digit.\n  if (indentPerLevel > 9 && needIndentIndicator(string)) {\n    return STYLE_DOUBLE;\n  }\n  // At this point we know block styles are valid.\n  // Prefer literal style unless we want to fold.\n  if (!forceQuotes) {\n    return hasFoldableLine ? STYLE_FOLDED : STYLE_LITERAL;\n  }\n  return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n}\n\n// Note: line breaking/folding is implemented for only the folded style.\n// NB. We drop the last trailing newline (if any) of a returned block scalar\n//  since the dumper adds its own newline. This always works:\n//    • No ending newline => unaffected; already using strip \"-\" chomping.\n//    • Ending newline    => removed then restored.\n//  Importantly, this keeps the \"+\" chomp indicator from gaining an extra line.\nfunction writeScalar(state, string, level, iskey, inblock) {\n  state.dump = (function () {\n    if (string.length === 0) {\n      return state.quotingType === QUOTING_TYPE_DOUBLE ? '\"\"' : \"''\";\n    }\n    if (!state.noCompatMode) {\n      if (DEPRECATED_BOOLEANS_SYNTAX.indexOf(string) !== -1 || DEPRECATED_BASE60_SYNTAX.test(string)) {\n        return state.quotingType === QUOTING_TYPE_DOUBLE ? ('\"' + string + '\"') : (\"'\" + string + \"'\");\n      }\n    }\n\n    var indent = state.indent * Math.max(1, level); // no 0-indent scalars\n    // As indentation gets deeper, let the width decrease monotonically\n    // to the lower bound min(state.lineWidth, 40).\n    // Note that this implies\n    //  state.lineWidth ≤ 40 + state.indent: width is fixed at the lower bound.\n    //  state.lineWidth > 40 + state.indent: width decreases until the lower bound.\n    // This behaves better than a constant minimum width which disallows narrower options,\n    // or an indent threshold which causes the width to suddenly increase.\n    var lineWidth = state.lineWidth === -1\n      ? -1 : Math.max(Math.min(state.lineWidth, 40), state.lineWidth - indent);\n\n    // Without knowing if keys are implicit/explicit, assume implicit for safety.\n    var singleLineOnly = iskey\n      // No block styles in flow mode.\n      || (state.flowLevel > -1 && level >= state.flowLevel);\n    function testAmbiguity(string) {\n      return testImplicitResolving(state, string);\n    }\n\n    switch (chooseScalarStyle(string, singleLineOnly, state.indent, lineWidth,\n      testAmbiguity, state.quotingType, state.forceQuotes && !iskey, inblock)) {\n\n      case STYLE_PLAIN:\n        return string;\n      case STYLE_SINGLE:\n        return \"'\" + string.replace(/'/g, \"''\") + \"'\";\n      case STYLE_LITERAL:\n        return '|' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(string, indent));\n      case STYLE_FOLDED:\n        return '>' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(foldString(string, lineWidth), indent));\n      case STYLE_DOUBLE:\n        return '\"' + escapeString(string) + '\"';\n      default:\n        throw new exception('impossible error: invalid scalar style');\n    }\n  }());\n}\n\n// Pre-conditions: string is valid for a block scalar, 1 <= indentPerLevel <= 9.\nfunction blockHeader(string, indentPerLevel) {\n  var indentIndicator = needIndentIndicator(string) ? String(indentPerLevel) : '';\n\n  // note the special case: the string '\\n' counts as a \"trailing\" empty line.\n  var clip =          string[string.length - 1] === '\\n';\n  var keep = clip && (string[string.length - 2] === '\\n' || string === '\\n');\n  var chomp = keep ? '+' : (clip ? '' : '-');\n\n  return indentIndicator + chomp + '\\n';\n}\n\n// (See the note for writeScalar.)\nfunction dropEndingNewline(string) {\n  return string[string.length - 1] === '\\n' ? string.slice(0, -1) : string;\n}\n\n// Note: a long line without a suitable break point will exceed the width limit.\n// Pre-conditions: every char in str isPrintable, str.length > 0, width > 0.\nfunction foldString(string, width) {\n  // In folded style, $k$ consecutive newlines output as $k+1$ newlines—\n  // unless they're before or after a more-indented line, or at the very\n  // beginning or end, in which case $k$ maps to $k$.\n  // Therefore, parse each chunk as newline(s) followed by a content line.\n  var lineRe = /(\\n+)([^\\n]*)/g;\n\n  // first line (possibly an empty line)\n  var result = (function () {\n    var nextLF = string.indexOf('\\n');\n    nextLF = nextLF !== -1 ? nextLF : string.length;\n    lineRe.lastIndex = nextLF;\n    return foldLine(string.slice(0, nextLF), width);\n  }());\n  // If we haven't reached the first content line yet, don't add an extra \\n.\n  var prevMoreIndented = string[0] === '\\n' || string[0] === ' ';\n  var moreIndented;\n\n  // rest of the lines\n  var match;\n  while ((match = lineRe.exec(string))) {\n    var prefix = match[1], line = match[2];\n    moreIndented = (line[0] === ' ');\n    result += prefix\n      + (!prevMoreIndented && !moreIndented && line !== ''\n        ? '\\n' : '')\n      + foldLine(line, width);\n    prevMoreIndented = moreIndented;\n  }\n\n  return result;\n}\n\n// Greedy line breaking.\n// Picks the longest line under the limit each time,\n// otherwise settles for the shortest line over the limit.\n// NB. More-indented lines *cannot* be folded, as that would add an extra \\n.\nfunction foldLine(line, width) {\n  if (line === '' || line[0] === ' ') return line;\n\n  // Since a more-indented line adds a \\n, breaks can't be followed by a space.\n  var breakRe = / [^ ]/g; // note: the match index will always be <= length-2.\n  var match;\n  // start is an inclusive index. end, curr, and next are exclusive.\n  var start = 0, end, curr = 0, next = 0;\n  var result = '';\n\n  // Invariants: 0 <= start <= length-1.\n  //   0 <= curr <= next <= max(0, length-2). curr - start <= width.\n  // Inside the loop:\n  //   A match implies length >= 2, so curr and next are <= length-2.\n  while ((match = breakRe.exec(line))) {\n    next = match.index;\n    // maintain invariant: curr - start <= width\n    if (next - start > width) {\n      end = (curr > start) ? curr : next; // derive end <= length-2\n      result += '\\n' + line.slice(start, end);\n      // skip the space that was output as \\n\n      start = end + 1;                    // derive start <= length-1\n    }\n    curr = next;\n  }\n\n  // By the invariants, start <= length-1, so there is something left over.\n  // It is either the whole string or a part starting from non-whitespace.\n  result += '\\n';\n  // Insert a break if the remainder is too long and there is a break available.\n  if (line.length - start > width && curr > start) {\n    result += line.slice(start, curr) + '\\n' + line.slice(curr + 1);\n  } else {\n    result += line.slice(start);\n  }\n\n  return result.slice(1); // drop extra \\n joiner\n}\n\n// Escapes a double-quoted string.\nfunction escapeString(string) {\n  var result = '';\n  var char = 0;\n  var escapeSeq;\n\n  for (var i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n    char = codePointAt(string, i);\n    escapeSeq = ESCAPE_SEQUENCES[char];\n\n    if (!escapeSeq && isPrintable(char)) {\n      result += string[i];\n      if (char >= 0x10000) result += string[i + 1];\n    } else {\n      result += escapeSeq || encodeHex(char);\n    }\n  }\n\n  return result;\n}\n\nfunction writeFlowSequence(state, level, object) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length,\n      value;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    value = object[index];\n\n    if (state.replacer) {\n      value = state.replacer.call(object, String(index), value);\n    }\n\n    // Write only valid elements, put null instead of invalid elements.\n    if (writeNode(state, level, value, false, false) ||\n        (typeof value === 'undefined' &&\n         writeNode(state, level, null, false, false))) {\n\n      if (_result !== '') _result += ',' + (!state.condenseFlow ? ' ' : '');\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = '[' + _result + ']';\n}\n\nfunction writeBlockSequence(state, level, object, compact) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length,\n      value;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    value = object[index];\n\n    if (state.replacer) {\n      value = state.replacer.call(object, String(index), value);\n    }\n\n    // Write only valid elements, put null instead of invalid elements.\n    if (writeNode(state, level + 1, value, true, true, false, true) ||\n        (typeof value === 'undefined' &&\n         writeNode(state, level + 1, null, true, true, false, true))) {\n\n      if (!compact || _result !== '') {\n        _result += generateNextLine(state, level);\n      }\n\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        _result += '-';\n      } else {\n        _result += '- ';\n      }\n\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '[]'; // Empty sequence if no valid values.\n}\n\nfunction writeFlowMapping(state, level, object) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      pairBuffer;\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n\n    pairBuffer = '';\n    if (_result !== '') pairBuffer += ', ';\n\n    if (state.condenseFlow) pairBuffer += '\"';\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (state.replacer) {\n      objectValue = state.replacer.call(object, objectKey, objectValue);\n    }\n\n    if (!writeNode(state, level, objectKey, false, false)) {\n      continue; // Skip this pair because of invalid key;\n    }\n\n    if (state.dump.length > 1024) pairBuffer += '? ';\n\n    pairBuffer += state.dump + (state.condenseFlow ? '\"' : '') + ':' + (state.condenseFlow ? '' : ' ');\n\n    if (!writeNode(state, level, objectValue, false, false)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = '{' + _result + '}';\n}\n\nfunction writeBlockMapping(state, level, object, compact) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      explicitPair,\n      pairBuffer;\n\n  // Allow sorting keys so that the output file is deterministic\n  if (state.sortKeys === true) {\n    // Default sorting\n    objectKeyList.sort();\n  } else if (typeof state.sortKeys === 'function') {\n    // Custom sort function\n    objectKeyList.sort(state.sortKeys);\n  } else if (state.sortKeys) {\n    // Something is wrong\n    throw new exception('sortKeys must be a boolean or a function');\n  }\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n    pairBuffer = '';\n\n    if (!compact || _result !== '') {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (state.replacer) {\n      objectValue = state.replacer.call(object, objectKey, objectValue);\n    }\n\n    if (!writeNode(state, level + 1, objectKey, true, true, true)) {\n      continue; // Skip this pair because of invalid key.\n    }\n\n    explicitPair = (state.tag !== null && state.tag !== '?') ||\n                   (state.dump && state.dump.length > 1024);\n\n    if (explicitPair) {\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        pairBuffer += '?';\n      } else {\n        pairBuffer += '? ';\n      }\n    }\n\n    pairBuffer += state.dump;\n\n    if (explicitPair) {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    if (!writeNode(state, level + 1, objectValue, true, explicitPair)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n      pairBuffer += ':';\n    } else {\n      pairBuffer += ': ';\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '{}'; // Empty mapping if no valid pairs.\n}\n\nfunction detectType(state, object, explicit) {\n  var _result, typeList, index, length, type, style;\n\n  typeList = explicit ? state.explicitTypes : state.implicitTypes;\n\n  for (index = 0, length = typeList.length; index < length; index += 1) {\n    type = typeList[index];\n\n    if ((type.instanceOf  || type.predicate) &&\n        (!type.instanceOf || ((typeof object === 'object') && (object instanceof type.instanceOf))) &&\n        (!type.predicate  || type.predicate(object))) {\n\n      if (explicit) {\n        if (type.multi && type.representName) {\n          state.tag = type.representName(object);\n        } else {\n          state.tag = type.tag;\n        }\n      } else {\n        state.tag = '?';\n      }\n\n      if (type.represent) {\n        style = state.styleMap[type.tag] || type.defaultStyle;\n\n        if (_toString.call(type.represent) === '[object Function]') {\n          _result = type.represent(object, style);\n        } else if (_hasOwnProperty.call(type.represent, style)) {\n          _result = type.represent[style](object, style);\n        } else {\n          throw new exception('!<' + type.tag + '> tag resolver accepts not \"' + style + '\" style');\n        }\n\n        state.dump = _result;\n      }\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// Serializes `object` and writes it to global `result`.\n// Returns true on success, or false on invalid object.\n//\nfunction writeNode(state, level, object, block, compact, iskey, isblockseq) {\n  state.tag = null;\n  state.dump = object;\n\n  if (!detectType(state, object, false)) {\n    detectType(state, object, true);\n  }\n\n  var type = _toString.call(state.dump);\n  var inblock = block;\n  var tagStr;\n\n  if (block) {\n    block = (state.flowLevel < 0 || state.flowLevel > level);\n  }\n\n  var objectOrArray = type === '[object Object]' || type === '[object Array]',\n      duplicateIndex,\n      duplicate;\n\n  if (objectOrArray) {\n    duplicateIndex = state.duplicates.indexOf(object);\n    duplicate = duplicateIndex !== -1;\n  }\n\n  if ((state.tag !== null && state.tag !== '?') || duplicate || (state.indent !== 2 && level > 0)) {\n    compact = false;\n  }\n\n  if (duplicate && state.usedDuplicates[duplicateIndex]) {\n    state.dump = '*ref_' + duplicateIndex;\n  } else {\n    if (objectOrArray && duplicate && !state.usedDuplicates[duplicateIndex]) {\n      state.usedDuplicates[duplicateIndex] = true;\n    }\n    if (type === '[object Object]') {\n      if (block && (Object.keys(state.dump).length !== 0)) {\n        writeBlockMapping(state, level, state.dump, compact);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowMapping(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object Array]') {\n      if (block && (state.dump.length !== 0)) {\n        if (state.noArrayIndent && !isblockseq && level > 0) {\n          writeBlockSequence(state, level - 1, state.dump, compact);\n        } else {\n          writeBlockSequence(state, level, state.dump, compact);\n        }\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowSequence(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object String]') {\n      if (state.tag !== '?') {\n        writeScalar(state, state.dump, level, iskey, inblock);\n      }\n    } else if (type === '[object Undefined]') {\n      return false;\n    } else {\n      if (state.skipInvalid) return false;\n      throw new exception('unacceptable kind of an object to dump ' + type);\n    }\n\n    if (state.tag !== null && state.tag !== '?') {\n      // Need to encode all characters except those allowed by the spec:\n      //\n      // [35] ns-dec-digit    ::=  [#x30-#x39] /* 0-9 */\n      // [36] ns-hex-digit    ::=  ns-dec-digit\n      //                         | [#x41-#x46] /* A-F */ | [#x61-#x66] /* a-f */\n      // [37] ns-ascii-letter ::=  [#x41-#x5A] /* A-Z */ | [#x61-#x7A] /* a-z */\n      // [38] ns-word-char    ::=  ns-dec-digit | ns-ascii-letter | “-”\n      // [39] ns-uri-char     ::=  “%” ns-hex-digit ns-hex-digit | ns-word-char | “#”\n      //                         | “;” | “/” | “?” | “:” | “@” | “&” | “=” | “+” | “$” | “,”\n      //                         | “_” | “.” | “!” | “~” | “*” | “'” | “(” | “)” | “[” | “]”\n      //\n      // Also need to encode '!' because it has special meaning (end of tag prefix).\n      //\n      tagStr = encodeURI(\n        state.tag[0] === '!' ? state.tag.slice(1) : state.tag\n      ).replace(/!/g, '%21');\n\n      if (state.tag[0] === '!') {\n        tagStr = '!' + tagStr;\n      } else if (tagStr.slice(0, 18) === 'tag:yaml.org,2002:') {\n        tagStr = '!!' + tagStr.slice(18);\n      } else {\n        tagStr = '!<' + tagStr + '>';\n      }\n\n      state.dump = tagStr + ' ' + state.dump;\n    }\n  }\n\n  return true;\n}\n\nfunction getDuplicateReferences(object, state) {\n  var objects = [],\n      duplicatesIndexes = [],\n      index,\n      length;\n\n  inspectNode(object, objects, duplicatesIndexes);\n\n  for (index = 0, length = duplicatesIndexes.length; index < length; index += 1) {\n    state.duplicates.push(objects[duplicatesIndexes[index]]);\n  }\n  state.usedDuplicates = new Array(length);\n}\n\nfunction inspectNode(object, objects, duplicatesIndexes) {\n  var objectKeyList,\n      index,\n      length;\n\n  if (object !== null && typeof object === 'object') {\n    index = objects.indexOf(object);\n    if (index !== -1) {\n      if (duplicatesIndexes.indexOf(index) === -1) {\n        duplicatesIndexes.push(index);\n      }\n    } else {\n      objects.push(object);\n\n      if (Array.isArray(object)) {\n        for (index = 0, length = object.length; index < length; index += 1) {\n          inspectNode(object[index], objects, duplicatesIndexes);\n        }\n      } else {\n        objectKeyList = Object.keys(object);\n\n        for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n          inspectNode(object[objectKeyList[index]], objects, duplicatesIndexes);\n        }\n      }\n    }\n  }\n}\n\nfunction dump$1(input, options) {\n  options = options || {};\n\n  var state = new State(options);\n\n  if (!state.noRefs) getDuplicateReferences(input, state);\n\n  var value = input;\n\n  if (state.replacer) {\n    value = state.replacer.call({ '': value }, '', value);\n  }\n\n  if (writeNode(state, 0, value, true, true)) return state.dump + '\\n';\n\n  return '';\n}\n\nvar dump_1 = dump$1;\n\nvar dumper = {\n\tdump: dump_1\n};\n\nfunction renamed(from, to) {\n  return function () {\n    throw new Error('Function yaml.' + from + ' is removed in js-yaml 4. ' +\n      'Use yaml.' + to + ' instead, which is now safe by default.');\n  };\n}\n\n\nvar Type                = type;\nvar Schema              = schema;\nvar FAILSAFE_SCHEMA     = failsafe;\nvar JSON_SCHEMA         = json;\nvar CORE_SCHEMA         = core;\nvar DEFAULT_SCHEMA      = _default;\nvar load                = loader.load;\nvar loadAll             = loader.loadAll;\nvar dump                = dumper.dump;\nvar YAMLException       = exception;\n\n// Re-export all types in case user wants to create custom schema\nvar types = {\n  binary:    binary,\n  float:     float,\n  map:       map,\n  null:      _null,\n  pairs:     pairs,\n  set:       set,\n  timestamp: timestamp,\n  bool:      bool,\n  int:       int,\n  merge:     merge,\n  omap:      omap,\n  seq:       seq,\n  str:       str\n};\n\n// Removed functions from JS-YAML 3.0.x\nvar safeLoad            = renamed('safeLoad', 'load');\nvar safeLoadAll         = renamed('safeLoadAll', 'loadAll');\nvar safeDump            = renamed('safeDump', 'dump');\n\nvar jsYaml = {\n\tType: Type,\n\tSchema: Schema,\n\tFAILSAFE_SCHEMA: FAILSAFE_SCHEMA,\n\tJSON_SCHEMA: JSON_SCHEMA,\n\tCORE_SCHEMA: CORE_SCHEMA,\n\tDEFAULT_SCHEMA: DEFAULT_SCHEMA,\n\tload: load,\n\tloadAll: loadAll,\n\tdump: dump,\n\tYAMLException: YAMLException,\n\ttypes: types,\n\tsafeLoad: safeLoad,\n\tsafeLoadAll: safeLoadAll,\n\tsafeDump: safeDump\n};\n\nexport default jsYaml;\nexport { CORE_SCHEMA, DEFAULT_SCHEMA, FAILSAFE_SCHEMA, JSON_SCHEMA, Schema, Type, YAMLException, dump, load, loadAll, safeDump, safeLoad, safeLoadAll, types };\n","//import * as CBLCARS from '../cb-lcars-vars.js';\nimport { cblcarsLog } from './cb-lcars-logging.js';\nimport jsyaml from 'js-yaml';\n\n// Ensure global fallback for legacy callers expecting window.jsyaml\ntry {\n  if (typeof window !== 'undefined' && !window.jsyaml) {\n    window.jsyaml = { load: jsyaml.load, dump: jsyaml.dump };\n  }\n} catch {}\n\n/**\n * Fetch YAML content from a given URL.\n * @param {string} url - The URL of the YAML file.\n * @returns {Promise<string>} - A promise that resolves to the YAML content as a string.\n */\nexport async function fetchYAML(url) {\n    try {\n        const response = await fetch(url);\n        if (response.ok) {\n            const yamlContent = await response.text();\n            //cblcarsLog.debug(`Fetched yaml file ${url}`);\n\n            return yamlContent;\n        } //else {\n          //  throw new Error(`Error fetching YAML: ${response.status} ${response.statusText}`);\n        //}\n    } catch (error) {\n        cblcarsLog.error('[fetchYAML] Error fetching YAML file ',error);\n        throw error;\n    }\n}\n\n// Function to read and parse the YAML file\nexport async function readYamlFile(url) {\n    try {\n        const response = await fetchYAML(url);\n        const jsObject = jsyaml.load(response);\n        //await cblcarsLog.info(`Processed YAML file: ${url}`);\n        //await cblcarsLog.debug(jsObject);\n        return jsObject;\n    } catch (error) {\n        cblcarsLog.error('[readYamlFile] Failed to parse YAML file',error.message);\n        throw error; // Re-throw the error after logging it\n    }\n}\n\n/**\n * Ensure the SVG cache exists on the window object.\n */\nfunction ensureSVGCache() {\n    window.cblcars = window.cblcars || {};\n    window.cblcars.msd = window.cblcars.msd || {};\n    window.cblcars.msd.svg_templates = window.cblcars.msd.svg_templates || {};\n    return window.cblcars.msd.svg_templates;\n}\n\n/**\n * Load an SVG from a URL and cache it under the given key.\n * Returns a promise that resolves to the SVG string.\n */\nexport async function loadSVGToCache(key, url) {\n    const cache = ensureSVGCache();\n    if (cache[key]) {\n        // Already cached\n        return cache[key];\n    }\n    try {\n        const response = await fetch(url);\n        if (!response.ok) {\n            cblcarsLog.error(`[loadSVGToCache] Failed to fetch SVG [${url}] for key [${key}]: ${response.status} ${response.statusText}`);\n            return undefined;\n        }\n        let svgText = await response.text();\n\n        // Find the opening <svg> tag and its attributes.\n        svgText = svgText.replace(/<svg([^>]*)>/i, (match, attributes) => {\n            // Remove existing width and height attributes.\n            let newAttributes = attributes.replace(/\\s(width|height)=[\"'][^\"']*[\"']/gi, '');\n            // Add width=\"100%\" and height=\"100%\".\n            return `<svg width=\"100%\" height=\"100%\"${newAttributes}>`;\n        });\n\n        cache[key] = svgText;\n        cblcarsLog.debug(`[loadSVGToCache] Loaded SVG [${key}] from [${url}]`);\n        return svgText;\n    } catch (error) {\n        cblcarsLog.error(`[loadSVGToCache] Error loading SVG [${key}] from [${url}]`, error);\n        return undefined;\n    }\n}\n\n/**\n * Get an SVG from the cache by key.\n */\nexport function getSVGFromCache(key) {\n    const cache = ensureSVGCache();\n    return cache[key];\n}\n\n/**\n * Preload a list of SVGs from a base path.\n * svgList: array of keys (filenames without .svg)\n * basePath: path to prepend (should end with /)\n * Returns a promise that resolves when all SVGs are loaded.\n */\nexport async function preloadSVGs(svgList, basePath) {\n    const promises = svgList.map(key => {\n        const url = `${basePath}${key}.svg`;\n        return loadSVGToCache(key, url);\n    });\n    await Promise.all(promises);\n    cblcarsLog.info(`[preloadSVGs] Preloaded SVGs: ${svgList.join(', ')} from ${basePath}`);\n}\n","import * as CBLCARS from '../cb-lcars-vars.js'\nimport { cblcarsLog } from '../utils/cb-lcars-logging.js';\n\nimport { html, css, unsafeCSS } from 'lit';\n\nimport EditorForm from 'ha-editor-formbuilder-yaml';\n\nexport class CBLCARSCardEditor extends EditorForm {\n\n    _formControls;\n    _cardType;\n\n    constructor(cardType) {\n        super();\n\n        this._formControls = {};\n        this._cardType = \"\";\n        this._cardType = cardType;\n\n        //cblcarsLog.debug(`Setting up editor for ${cardType}`);\n\n        this._initializationPromise = this._initialize();\n    }\n\n    async _initialize() {\n        try {\n            // Fetch only the relevant JSON file for this card type\n            const response = await fetch(`${CBLCARS.card_editor_uri}/${this._cardType}.json`);\n            if (!response.ok) throw new Error(`Form definition not found for card type: ${this._cardType}`);\n            const formControls = await response.json();\n            cblcarsLog.debug('Loaded formControls:', formControls);\n            this._formControls = formControls;\n\n            // Handle user styles if present\n            this._userStyles = css`${unsafeCSS((formControls.css && formControls.css.cssText) || '')}`;\n            this._mergeUserStyles = formControls?.css?.mergeUserStyles ?? true;\n\n            this.requestUpdate();\n        } catch(error) {\n            cblcarsLog.error('Error fetching editor form definition: ', error);\n        }\n    }\n\n    async setConfig(config) {\n\n        await this._initializationPromise;\n\n        super.setConfig(config);\n        this.requestUpdate();\n\n    }\n\n    render() {\n        if (!this._hass) {\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Home Assistant instance is missing.</ha-alert>`;\n        }\n\n        if (!this._config) {\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Card configuration is missing.</ha-alert>`;\n        }\n\n        if (!this._formControls) {\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Form controls are missing.</ha-alert>`;\n        }\n\n        try {\n            const formContent = this._formControls;\n            const returnForm = this.generateForm(formContent);\n            return returnForm;\n        } catch (error) {\n            cblcarsLog.error('Error rendering configuration form:', error);\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Error rendering form: ${error.message}</ha-alert>`;\n        }\n    }\n\n}\n","import { core_fonts, font_url } from '../cb-lcars-vars.js';\nimport { cblcarsLog } from './cb-lcars-logging.js';\n\n/**\n * Process card configurations to load all fonts.\n */\nexport function loadAllFontsFromConfig(config) {\n  const fonts = new Set();\n  function scan(obj) {\n    if (obj && typeof obj === 'object') {\n      for (const key in obj) {\n        if (key === 'font_family' && typeof obj[key] === 'string') {\n          fonts.add(obj[key]);\n        } else if (typeof obj[key] === 'object') {\n          scan(obj[key]);\n        }\n      }\n    }\n  }\n  scan(config);\n  fonts.forEach(font => window.cblcars.loadFont(font));\n}\n\n/**\n * Dynamically loads a CB-LCARS font based on font-family name.\n * Only loads if not already injected.\n */\nexport function loadFont(fontInput) {\n  window.cblcars._loadedFonts = window.cblcars._loadedFonts || new Set();\n\n  const fontList = fontInput.split(',').map(f =>\n    f.trim().replace(/^['\"]|['\"]$/g, '')\n  );\n\n  fontList.forEach(fontName => {\n    // If it’s a URL, inject directly\n    if (fontName.startsWith('http://') || fontName.startsWith('https://')) {\n      const href = fontName;\n      if (window.cblcars._loadedFonts.has(href)) return;\n      if (document.querySelector(`link[href=\"${href}\"]`)) {\n        window.cblcars._loadedFonts.add(href);\n        return;\n      }\n      const link = document.createElement('link');\n      link.rel = 'stylesheet';\n      link.href = href;\n      document.head.appendChild(link);\n      window.cblcars._loadedFonts.add(href);\n      cblcarsLog.info(`[loadFont] Loaded remote font from: ${href}`);\n      return;\n    }\n\n    // Else assume local CB-LCARS font\n    if (!fontName.startsWith('cb-lcars_')) return;\n\n    const href = `/hacsfiles/cb-lcars/fonts/${fontName}.css`;\n    const fontKey = fontName;\n\n    if (window.cblcars._loadedFonts.has(fontKey)) return;\n    if (document.querySelector(`link[href=\"${href}\"]`)) {\n      window.cblcars._loadedFonts.add(fontKey);\n      return;\n    }\n\n    const link = document.createElement('link');\n    link.rel = 'stylesheet';\n    link.href = href;\n    document.head.appendChild(link);\n    window.cblcars._loadedFonts.add(fontKey);\n    cblcarsLog.info(`[loadFont] Loaded local font: ${fontName}`);\n  });\n}\n\n\n/**\n * Loads all core CB-LCARS fonts using the shared dynamic loader.\n */\nexport async function loadCoreFonts() {\n  try {\n    const fonts = Array.isArray(core_fonts) ? core_fonts : [core_fonts];\n    for (const font of fonts) {\n      window.cblcars.loadFont(font);\n    }\n  } catch (error) {\n    cblcarsLog.error(`[loadCoreFonts] Failed to preload core fonts: ${error.message}`);\n  }\n}\n","function t(t,e,i,n){var r,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(s<3?r(a):s>3?r(e,i,a):r(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}const e=window,i=e.ShadowRoot&&(void 0===e.ShadyCSS||e.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,n=Symbol(),r=new WeakMap;class s{constructor(t,e,i){if(this._$cssResult$=!0,i!==n)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(i&&void 0===t){const i=void 0!==e&&1===e.length;i&&(t=r.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&r.set(e,t))}return t}toString(){return this.cssText}}const a=i?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const i of t.cssRules)e+=i.cssText;return(t=>new s(\"string\"==typeof t?t:t+\"\",void 0,n))(e)})(t):t;var o;const l=window,c=l.trustedTypes,h=c?c.emptyScript:\"\",u=l.reactiveElementPolyfillSupport,d={toAttribute(t,e){switch(e){case Boolean:t=t?h:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,e)=>e!==t&&(e==e||t==t),p={attribute:!0,type:String,converter:d,reflect:!1,hasChanged:f},m=\"finalized\";class g extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,i)=>{const n=this._$Ep(i,e);void 0!==n&&(this._$Ev.set(n,i),t.push(n))})),t}static createProperty(t,e=p){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const i=\"symbol\"==typeof t?Symbol():\"__\"+t,n=this.getPropertyDescriptor(t,i,e);void 0!==n&&Object.defineProperty(this.prototype,t,n)}}static getPropertyDescriptor(t,e,i){return{get(){return this[e]},set(n){const r=this[t];this[e]=n,this.requestUpdate(t,r,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||p}static finalize(){if(this.hasOwnProperty(m))return!1;this[m]=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty(\"properties\")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const i of e)this.createProperty(i,t[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift(a(t))}else void 0!==t&&e.push(a(t));return e}static _$Ep(t,e){const i=e.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,i;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(i=t.hostConnected)||void 0===i||i.call(t))}removeController(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t;const n=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,n)=>{i?t.adoptedStyleSheets=n.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):n.forEach((i=>{const n=document.createElement(\"style\"),r=e.litNonce;void 0!==r&&n.setAttribute(\"nonce\",r),n.textContent=i.cssText,t.appendChild(n)}))})(n,this.constructor.elementStyles),n}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EO(t,e,i=p){var n;const r=this.constructor._$Ep(t,i);if(void 0!==r&&!0===i.reflect){const s=(void 0!==(null===(n=i.converter)||void 0===n?void 0:n.toAttribute)?i.converter:d).toAttribute(e,i.type);this._$El=t,null==s?this.removeAttribute(r):this.setAttribute(r,s),this._$El=null}}_$AK(t,e){var i;const n=this.constructor,r=n._$Ev.get(t);if(void 0!==r&&this._$El!==r){const t=n.getPropertyOptions(r),s=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(i=t.converter)||void 0===i?void 0:i.fromAttribute)?t.converter:d;this._$El=r,this[r]=s.fromAttribute(e,t.type),this._$El=null}}requestUpdate(t,e,i){let n=!0;void 0!==t&&(((i=i||this.constructor.getPropertyOptions(t)).hasChanged||f)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===i.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,i))):n=!1),!this.isUpdatePending&&n&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,e)=>this[e]=t)),this._$Ei=void 0);let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(i)):this._$Ek()}catch(t){throw e=!1,this._$Ek(),t}e&&this._$AE(i)}willUpdate(t){}_$AE(t){var e;null===(e=this._$ES)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,e)=>this._$EO(e,this[e],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}var _;g[m]=!0,g.elementProperties=new Map,g.elementStyles=[],g.shadowRootOptions={mode:\"open\"},null==u||u({ReactiveElement:g}),(null!==(o=l.reactiveElementVersions)&&void 0!==o?o:l.reactiveElementVersions=[]).push(\"1.6.2\");const v=window,b=v.trustedTypes,y=b?b.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,w=\"$lit$\",$=`lit$${(Math.random()+\"\").slice(9)}$`,A=\"?\"+$,x=`<${A}>`,k=document,S=()=>k.createComment(\"\"),E=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,O=Array.isArray,T=\"[ \\t\\n\\f\\r]\",C=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,M=/-->/g,j=/>/g,H=RegExp(`>|${T}(?:([^\\\\s\"'>=/]+)(${T}*=${T}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),D=/'/g,R=/\"/g,N=/^(?:script|style|textarea|title)$/i,P=(t=>(e,...i)=>({_$litType$:t,strings:e,values:i}))(1),z=Symbol.for(\"lit-noChange\"),L=Symbol.for(\"lit-nothing\"),I=new WeakMap,F=k.createTreeWalker(k,129,null,!1);function V(t,e){if(!Array.isArray(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==y?y.createHTML(e):e}const U=(t,e)=>{const i=t.length-1,n=[];let r,s=2===e?\"<svg>\":\"\",a=C;for(let o=0;o<i;o++){const e=t[o];let i,l,c=-1,h=0;for(;h<e.length&&(a.lastIndex=h,l=a.exec(e),null!==l);)h=a.lastIndex,a===C?\"!--\"===l[1]?a=M:void 0!==l[1]?a=j:void 0!==l[2]?(N.test(l[2])&&(r=RegExp(\"</\"+l[2],\"g\")),a=H):void 0!==l[3]&&(a=H):a===H?\">\"===l[0]?(a=null!=r?r:C,c=-1):void 0===l[1]?c=-2:(c=a.lastIndex-l[2].length,i=l[1],a=void 0===l[3]?H:'\"'===l[3]?R:D):a===R||a===D?a=H:a===M||a===j?a=C:(a=H,r=void 0);const u=a===H&&t[o+1].startsWith(\"/>\")?\" \":\"\";s+=a===C?e+x:c>=0?(n.push(i),e.slice(0,c)+w+e.slice(c)+$+u):e+$+(-2===c?(n.push(void 0),o):u)}return[V(t,s+(t[i]||\"<?>\")+(2===e?\"</svg>\":\"\")),n]};class B{constructor({strings:t,_$litType$:e},i){let n;this.parts=[];let r=0,s=0;const a=t.length-1,o=this.parts,[l,c]=U(t,e);if(this.el=B.createElement(l,i),F.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(n=F.nextNode())&&o.length<a;){if(1===n.nodeType){if(n.hasAttributes()){const t=[];for(const e of n.getAttributeNames())if(e.endsWith(w)||e.startsWith($)){const i=c[s++];if(t.push(e),void 0!==i){const t=n.getAttribute(i.toLowerCase()+w).split($),e=/([.?@])?(.*)/.exec(i);o.push({type:1,index:r,name:e[2],strings:t,ctor:\".\"===e[1]?Y:\"?\"===e[1]?J:\"@\"===e[1]?X:G})}else o.push({type:6,index:r})}for(const e of t)n.removeAttribute(e)}if(N.test(n.tagName)){const t=n.textContent.split($),e=t.length-1;if(e>0){n.textContent=b?b.emptyScript:\"\";for(let i=0;i<e;i++)n.append(t[i],S()),F.nextNode(),o.push({type:2,index:++r});n.append(t[e],S())}}}else if(8===n.nodeType)if(n.data===A)o.push({type:2,index:r});else{let t=-1;for(;-1!==(t=n.data.indexOf($,t+1));)o.push({type:7,index:r}),t+=$.length-1}r++}}static createElement(t,e){const i=k.createElement(\"template\");return i.innerHTML=t,i}}function W(t,e,i=t,n){var r,s,a,o;if(e===z)return e;let l=void 0!==n?null===(r=i._$Co)||void 0===r?void 0:r[n]:i._$Cl;const c=E(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(s=null==l?void 0:l._$AO)||void 0===s||s.call(l,!1),void 0===c?l=void 0:(l=new c(t),l._$AT(t,i,n)),void 0!==n?(null!==(a=(o=i)._$Co)&&void 0!==a?a:o._$Co=[])[n]=l:i._$Cl=l),void 0!==l&&(e=W(t,l._$AS(t,e.values),l,n)),e}class q{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var e;const{el:{content:i},parts:n}=this._$AD,r=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:k).importNode(i,!0);F.currentNode=r;let s=F.nextNode(),a=0,o=0,l=n[0];for(;void 0!==l;){if(a===l.index){let e;2===l.type?e=new Z(s,s.nextSibling,this,t):1===l.type?e=new l.ctor(s,l.name,l.strings,this,t):6===l.type&&(e=new Q(s,this,t)),this._$AV.push(e),l=n[++o]}a!==(null==l?void 0:l.index)&&(s=F.nextNode(),a++)}return F.currentNode=k,r}v(t){let e=0;for(const i of this._$AV)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class Z{constructor(t,e,i,n){var r;this.type=2,this._$AH=L,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=n,this._$Cp=null===(r=null==n?void 0:n.isConnected)||void 0===r||r}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===(null==t?void 0:t.nodeType)&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=W(this,t,e),E(t)?t===L||null==t||\"\"===t?(this._$AH!==L&&this._$AR(),this._$AH=L):t!==this._$AH&&t!==z&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):(t=>O(t)||\"function\"==typeof(null==t?void 0:t[Symbol.iterator]))(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==L&&E(this._$AH)?this._$AA.nextSibling.data=t:this.$(k.createTextNode(t)),this._$AH=t}g(t){var e;const{values:i,_$litType$:n}=t,r=\"number\"==typeof n?this._$AC(t):(void 0===n.el&&(n.el=B.createElement(V(n.h,n.h[0]),this.options)),n);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===r)this._$AH.v(i);else{const t=new q(r,this),e=t.u(this.options);t.v(i),this.$(e),this._$AH=t}}_$AC(t){let e=I.get(t.strings);return void 0===e&&I.set(t.strings,e=new B(t)),e}T(t){O(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,n=0;for(const r of t)n===e.length?e.push(i=new Z(this.k(S()),this.k(S()),this,this.options)):i=e[n],i._$AI(r),n++;n<e.length&&(this._$AR(i&&i._$AB.nextSibling,n),e.length=n)}_$AR(t=this._$AA.nextSibling,e){var i;for(null===(i=this._$AP)||void 0===i||i.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cp=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class G{constructor(t,e,i,n,r){this.type=1,this._$AH=L,this._$AN=void 0,this.element=t,this.name=e,this._$AM=n,this.options=r,i.length>2||\"\"!==i[0]||\"\"!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=L}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,i,n){const r=this.strings;let s=!1;if(void 0===r)t=W(this,t,e,0),s=!E(t)||t!==this._$AH&&t!==z,s&&(this._$AH=t);else{const n=t;let a,o;for(t=r[0],a=0;a<r.length-1;a++)o=W(this,n[i+a],e,a),o===z&&(o=this._$AH[a]),s||(s=!E(o)||o!==this._$AH[a]),o===L?t=L:t!==L&&(t+=(null!=o?o:\"\")+r[a+1]),this._$AH[a]=o}s&&!n&&this.j(t)}j(t){t===L?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:\"\")}}class Y extends G{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===L?void 0:t}}const K=b?b.emptyScript:\"\";class J extends G{constructor(){super(...arguments),this.type=4}j(t){t&&t!==L?this.element.setAttribute(this.name,K):this.element.removeAttribute(this.name)}}class X extends G{constructor(t,e,i,n,r){super(t,e,i,n,r),this.type=5}_$AI(t,e=this){var i;if((t=null!==(i=W(this,t,e,0))&&void 0!==i?i:L)===z)return;const n=this._$AH,r=t===L&&n!==L||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,s=t!==L&&(n===L||r);r&&this.element.removeEventListener(this.name,this,n),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,i;\"function\"==typeof this._$AH?this._$AH.call(null!==(i=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==i?i:this.element,t):this._$AH.handleEvent(t)}}class Q{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){W(this,t)}}const tt=v.litHtmlPolyfillSupport;null==tt||tt(B,Z),(null!==(_=v.litHtmlVersions)&&void 0!==_?_:v.litHtmlVersions=[]).push(\"2.7.5\");var et,it;class nt extends g{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const i=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=i.firstChild),i}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,i)=>{var n,r;const s=null!==(n=null==i?void 0:i.renderBefore)&&void 0!==n?n:e;let a=s._$litPart$;if(void 0===a){const t=null!==(r=null==i?void 0:i.renderBefore)&&void 0!==r?r:null;s._$litPart$=a=new Z(e.insertBefore(S(),t),t,void 0,null!=i?i:{})}return a._$AI(t),a})(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return z}}nt.finalized=!0,nt._$litElement$=!0,null===(et=globalThis.litElementHydrateSupport)||void 0===et||et.call(globalThis,{LitElement:nt});const rt=globalThis.litElementPolyfillSupport;null==rt||rt({LitElement:nt}),(null!==(it=globalThis.litElementVersions)&&void 0!==it?it:globalThis.litElementVersions=[]).push(\"3.3.2\");const st=(t,e)=>\"method\"===e.kind&&e.descriptor&&!(\"value\"in e.descriptor)?{...e,finisher(i){i.createProperty(e.key,t)}}:{kind:\"field\",key:Symbol(),placement:\"own\",descriptor:{},originalKey:e.key,initializer(){\"function\"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(i){i.createProperty(e.key,t)}};function at(t){return(e,i)=>void 0!==i?((t,e,i)=>{e.constructor.createProperty(i,t)})(t,e,i):st(t,e)}const ot=({finisher:t,descriptor:e})=>(i,n)=>{var r;if(void 0===n){const n=null!==(r=i.originalKey)&&void 0!==r?r:i.key,s=null!=e?{kind:\"method\",placement:\"prototype\",key:n,descriptor:e(i.key)}:{...i,key:n};return null!=t&&(s.finisher=function(e){t(e,n)}),s}{const r=i.constructor;void 0!==e&&Object.defineProperty(i,n,e(n)),null==t||t(r,n)}};function lt(t){return ot({finisher:(e,i)=>{Object.assign(e.prototype[i],t)}})}var ct;null===(ct=window.HTMLSlotElement)||void 0===ct||ct.prototype.assignedElements;class ht{constructor(t){this.startPress=e=>{t().then((t=>{t&&t.startPress(e)}))},this.endPress=()=>{t().then((t=>{t&&t.endPress()}))},this.startFocus=()=>{t().then((t=>{t&&t.startFocus()}))},this.endFocus=()=>{t().then((t=>{t&&t.endFocus()}))},this.startHover=()=>{t().then((t=>{t&&t.startHover()}))},this.endHover=()=>{t().then((t=>{t&&t.endHover()}))}}}const ut=1,dt=2,ft=t=>(...e)=>({_$litDirective$:t,values:e});class pt{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}const mt=\"important\",gt=\" !\"+mt,_t=ft(class extends pt{constructor(t){var e;if(super(t),t.type!==ut||\"style\"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error(\"The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.\")}render(t){return Object.keys(t).reduce(((e,i)=>{const n=t[i];return null==n?e:e+`${i=i.includes(\"-\")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,\"-$&\").toLowerCase()}:${n};`}),\"\")}update(t,[e]){const{style:i}=t.element;if(void 0===this.ut){this.ut=new Set;for(const t in e)this.ut.add(t);return this.render(e)}this.ut.forEach((t=>{null==e[t]&&(this.ut.delete(t),t.includes(\"-\")?i.removeProperty(t):i[t]=\"\")}));for(const n in e){const t=e[n];if(null!=t){this.ut.add(n);const e=\"string\"==typeof t&&t.endsWith(gt);n.includes(\"-\")||e?i.setProperty(n,e?t.slice(0,-11):t,e?mt:\"\"):i[n]=t}}return z}});class vt extends pt{constructor(t){if(super(t),this.et=L,t.type!==dt)throw Error(this.constructor.directiveName+\"() can only be used in child bindings\")}render(t){if(t===L||null==t)return this.ft=void 0,this.et=t;if(t===z)return t;if(\"string\"!=typeof t)throw Error(this.constructor.directiveName+\"() called with a non-string value\");if(t===this.et)return this.ft;this.et=t;const e=[t];return e.raw=e,this.ft={_$litType$:this.constructor.resultType,strings:e,values:[]}}}vt.directiveName=\"unsafeHTML\",vt.resultType=1;const bt=ft(vt),yt=ft(class extends pt{constructor(t){var e;if(super(t),t.type!==ut||\"class\"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error(\"`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.\")}render(t){return\" \"+Object.keys(t).filter((e=>t[e])).join(\" \")+\" \"}update(t,[e]){var i,n;if(void 0===this.it){this.it=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(\" \").split(/\\s/).filter((t=>\"\"!==t))));for(const t in e)e[t]&&!(null===(i=this.nt)||void 0===i?void 0:i.has(t))&&this.it.add(t);return this.render(e)}const r=t.element.classList;this.it.forEach((t=>{t in e||(r.remove(t),this.it.delete(t))}));for(const s in e){const t=!!e[s];t===this.it.has(s)||(null===(n=this.nt)||void 0===n?void 0:n.has(s))||(t?(r.add(s),this.it.add(s)):(r.remove(s),this.it.delete(s)))}return z}}),wt=(t,e,i,n)=>{n=n||{},i=null==i?{}:i;const r=new Event(e,{bubbles:void 0===n.bubbles||n.bubbles,cancelable:Boolean(n.cancelable),composed:void 0===n.composed||n.composed});return r.detail=i,t.dispatchEvent(r),r},$t=(t,e)=>{if(t===e)return!0;if(t&&e&&\"object\"==typeof t&&\"object\"==typeof e){if(t.constructor!==e.constructor)return!1;let i,n;if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(i=n;0!=i--;)if(!$t(t[i],e[i]))return!1;return!0}if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(i of t.entries())if(!e.has(i[0]))return!1;for(i of t.entries())if(!$t(i[1],e.get(i[0])))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(i of t.entries())if(!e.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!==e.length)return!1;for(i=n;0!=i--;)if(t[i]!==e[i])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const r=Object.keys(t);if(n=r.length,n!==Object.keys(e).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(e,r[i]))return!1;for(i=n;0!=i--;){const n=r[i];if(!$t(t[n],e[n]))return!1}return!0}return t!=t&&e!=e},At=\"ontouchstart\"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;class xt extends HTMLElement{constructor(){super(),this.holdTime=500,this.held=!1,this.cancelled=!1,this.isRepeating=!1,this.repeatCount=0,this.ripple=document.createElement(\"mwc-ripple\")}connectedCallback(){Object.assign(this.style,{position:\"fixed\",width:At?\"100px\":\"50px\",height:At?\"100px\":\"50px\",transform:\"translate(-50%, -50%)\",pointerEvents:\"none\",zIndex:\"999\"}),this.appendChild(this.ripple),this.ripple.primary=!0,[\"touchcancel\",\"mouseout\",\"mouseup\",\"touchmove\",\"mousewheel\",\"wheel\",\"scroll\"].forEach((t=>{document.addEventListener(t,(()=>{this.cancelled=!0,this.timer&&(this.stopAnimation(),clearTimeout(this.timer),this.timer=void 0,this.isRepeating&&this.repeatTimeout&&(clearInterval(this.repeatTimeout),this.isRepeating=!1))}),{passive:!0})}))}bind(t,e){t.actionHandler&&$t(e,t.actionHandler.options)||(t.actionHandler?(t.removeEventListener(\"touchstart\",t.actionHandler.start),t.removeEventListener(\"touchend\",t.actionHandler.end),t.removeEventListener(\"touchcancel\",t.actionHandler.end),t.removeEventListener(\"mousedown\",t.actionHandler.start),t.removeEventListener(\"click\",t.actionHandler.end),t.removeEventListener(\"keyup\",t.actionHandler.handleEnter)):t.addEventListener(\"contextmenu\",(t=>{const e=t||window.event;return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,!1})),t.actionHandler={options:e},e.disabled||(t.actionHandler.start=i=>{let n,r;this.cancelled=!1,i.touches?(n=i.touches[0].clientX,r=i.touches[0].clientY):(n=i.clientX,r=i.clientY),e.hasHold&&(this.held=!1,this.timer=window.setTimeout((()=>{this.startAnimation(n,r),this.held=!0,e.repeat&&!this.isRepeating&&(this.repeatCount=0,this.isRepeating=!0,this.repeatTimeout=setInterval((()=>{wt(t,\"action\",{action:\"hold\"}),this.repeatCount++,this.repeatTimeout&&e.repeatLimit&&this.repeatCount>=e.repeatLimit&&(clearInterval(this.repeatTimeout),this.isRepeating=!1)}),e.repeat))}),this.holdTime))},t.actionHandler.end=t=>{if([\"touchend\",\"touchcancel\"].includes(t.type)&&this.cancelled)return void(this.isRepeating&&this.repeatTimeout&&(clearInterval(this.repeatTimeout),this.isRepeating=!1));const i=t.target;t.cancelable&&t.preventDefault(),e.hasHold&&(clearTimeout(this.timer),this.isRepeating&&this.repeatTimeout&&clearInterval(this.repeatTimeout),this.isRepeating=!1,this.stopAnimation(),this.timer=void 0),e.hasHold&&this.held?e.repeat||wt(i,\"action\",{action:\"hold\"}):e.hasDoubleClick?\"click\"===t.type&&t.detail<2||!this.dblClickTimeout?this.dblClickTimeout=window.setTimeout((()=>{this.dblClickTimeout=void 0,wt(i,\"action\",{action:\"tap\"})}),250):(clearTimeout(this.dblClickTimeout),this.dblClickTimeout=void 0,wt(i,\"action\",{action:\"double_tap\"})):wt(i,\"action\",{action:\"tap\"})},t.actionHandler.handleEnter=t=>{13===t.keyCode&&t.currentTarget.actionHandler.end(t)},t.addEventListener(\"touchstart\",t.actionHandler.start,{passive:!0}),t.addEventListener(\"touchend\",t.actionHandler.end),t.addEventListener(\"touchcancel\",t.actionHandler.end),t.addEventListener(\"mousedown\",t.actionHandler.start,{passive:!0}),t.addEventListener(\"click\",t.actionHandler.end),t.addEventListener(\"keyup\",t.actionHandler.handleEnter)))}startAnimation(t,e){Object.assign(this.style,{left:`${t}px`,top:`${e}px`,display:null}),this.ripple.disabled=!1,this.ripple.startPress(),this.ripple.unbounded=!0}stopAnimation(){this.ripple.endPress(),this.ripple.disabled=!0,this.style.display=\"none\"}}customElements.define(\"cblcars-button-card-action-handler\",xt);const kt=(t,e)=>{const i=(()=>{const t=document.body;if(t.querySelector(\"cblcars-button-card-action-handler\"))return t.querySelector(\"cblcars-button-card-action-handler\");const e=document.createElement(\"cblcars-button-card-action-handler\");return t.appendChild(e),e})();i&&i.bind(t,e)},St=ft(class extends pt{update(t,[e]){return kt(t.element,e),z}render(t){}});function Et(t,e){(function(t){return\"string\"==typeof t&&-1!==t.indexOf(\".\")&&1===parseFloat(t)})(t)&&(t=\"100%\");var i=function(t){return\"string\"==typeof t&&-1!==t.indexOf(\"%\")}(t);return t=360===e?t:Math.min(e,Math.max(0,parseFloat(t))),i&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:t=360===e?(t<0?t%e+e:t%e)/parseFloat(String(e)):t%e/parseFloat(String(e))}function Ot(t){return Math.min(1,Math.max(0,t))}function Tt(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Ct(t){return t<=1?\"\".concat(100*Number(t),\"%\"):t}function Mt(t){return 1===t.length?\"0\"+t:String(t)}function jt(t,e,i){t=Et(t,255),e=Et(e,255),i=Et(i,255);var n=Math.max(t,e,i),r=Math.min(t,e,i),s=0,a=0,o=(n+r)/2;if(n===r)a=0,s=0;else{var l=n-r;switch(a=o>.5?l/(2-n-r):l/(n+r),n){case t:s=(e-i)/l+(e<i?6:0);break;case e:s=(i-t)/l+2;break;case i:s=(t-e)/l+4}s/=6}return{h:s,s:a,l:o}}function Ht(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*i*(e-t):i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function Dt(t,e,i){t=Et(t,255),e=Et(e,255),i=Et(i,255);var n=Math.max(t,e,i),r=Math.min(t,e,i),s=0,a=n,o=n-r,l=0===n?0:o/n;if(n===r)s=0;else{switch(n){case t:s=(e-i)/o+(e<i?6:0);break;case e:s=(i-t)/o+2;break;case i:s=(t-e)/o+4}s/=6}return{h:s,s:l,v:a}}function Rt(t,e,i,n){var r=[Mt(Math.round(t).toString(16)),Mt(Math.round(e).toString(16)),Mt(Math.round(i).toString(16))];return n&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join(\"\")}function Nt(t){return Math.round(255*parseFloat(t)).toString(16)}function Pt(t){return zt(t)/255}function zt(t){return parseInt(t,16)}var Lt={aliceblue:\"#f0f8ff\",antiquewhite:\"#faebd7\",aqua:\"#00ffff\",aquamarine:\"#7fffd4\",azure:\"#f0ffff\",beige:\"#f5f5dc\",bisque:\"#ffe4c4\",black:\"#000000\",blanchedalmond:\"#ffebcd\",blue:\"#0000ff\",blueviolet:\"#8a2be2\",brown:\"#a52a2a\",burlywood:\"#deb887\",cadetblue:\"#5f9ea0\",chartreuse:\"#7fff00\",chocolate:\"#d2691e\",coral:\"#ff7f50\",cornflowerblue:\"#6495ed\",cornsilk:\"#fff8dc\",crimson:\"#dc143c\",cyan:\"#00ffff\",darkblue:\"#00008b\",darkcyan:\"#008b8b\",darkgoldenrod:\"#b8860b\",darkgray:\"#a9a9a9\",darkgreen:\"#006400\",darkgrey:\"#a9a9a9\",darkkhaki:\"#bdb76b\",darkmagenta:\"#8b008b\",darkolivegreen:\"#556b2f\",darkorange:\"#ff8c00\",darkorchid:\"#9932cc\",darkred:\"#8b0000\",darksalmon:\"#e9967a\",darkseagreen:\"#8fbc8f\",darkslateblue:\"#483d8b\",darkslategray:\"#2f4f4f\",darkslategrey:\"#2f4f4f\",darkturquoise:\"#00ced1\",darkviolet:\"#9400d3\",deeppink:\"#ff1493\",deepskyblue:\"#00bfff\",dimgray:\"#696969\",dimgrey:\"#696969\",dodgerblue:\"#1e90ff\",firebrick:\"#b22222\",floralwhite:\"#fffaf0\",forestgreen:\"#228b22\",fuchsia:\"#ff00ff\",gainsboro:\"#dcdcdc\",ghostwhite:\"#f8f8ff\",goldenrod:\"#daa520\",gold:\"#ffd700\",gray:\"#808080\",green:\"#008000\",greenyellow:\"#adff2f\",grey:\"#808080\",honeydew:\"#f0fff0\",hotpink:\"#ff69b4\",indianred:\"#cd5c5c\",indigo:\"#4b0082\",ivory:\"#fffff0\",khaki:\"#f0e68c\",lavenderblush:\"#fff0f5\",lavender:\"#e6e6fa\",lawngreen:\"#7cfc00\",lemonchiffon:\"#fffacd\",lightblue:\"#add8e6\",lightcoral:\"#f08080\",lightcyan:\"#e0ffff\",lightgoldenrodyellow:\"#fafad2\",lightgray:\"#d3d3d3\",lightgreen:\"#90ee90\",lightgrey:\"#d3d3d3\",lightpink:\"#ffb6c1\",lightsalmon:\"#ffa07a\",lightseagreen:\"#20b2aa\",lightskyblue:\"#87cefa\",lightslategray:\"#778899\",lightslategrey:\"#778899\",lightsteelblue:\"#b0c4de\",lightyellow:\"#ffffe0\",lime:\"#00ff00\",limegreen:\"#32cd32\",linen:\"#faf0e6\",magenta:\"#ff00ff\",maroon:\"#800000\",mediumaquamarine:\"#66cdaa\",mediumblue:\"#0000cd\",mediumorchid:\"#ba55d3\",mediumpurple:\"#9370db\",mediumseagreen:\"#3cb371\",mediumslateblue:\"#7b68ee\",mediumspringgreen:\"#00fa9a\",mediumturquoise:\"#48d1cc\",mediumvioletred:\"#c71585\",midnightblue:\"#191970\",mintcream:\"#f5fffa\",mistyrose:\"#ffe4e1\",moccasin:\"#ffe4b5\",navajowhite:\"#ffdead\",navy:\"#000080\",oldlace:\"#fdf5e6\",olive:\"#808000\",olivedrab:\"#6b8e23\",orange:\"#ffa500\",orangered:\"#ff4500\",orchid:\"#da70d6\",palegoldenrod:\"#eee8aa\",palegreen:\"#98fb98\",paleturquoise:\"#afeeee\",palevioletred:\"#db7093\",papayawhip:\"#ffefd5\",peachpuff:\"#ffdab9\",peru:\"#cd853f\",pink:\"#ffc0cb\",plum:\"#dda0dd\",powderblue:\"#b0e0e6\",purple:\"#800080\",rebeccapurple:\"#663399\",red:\"#ff0000\",rosybrown:\"#bc8f8f\",royalblue:\"#4169e1\",saddlebrown:\"#8b4513\",salmon:\"#fa8072\",sandybrown:\"#f4a460\",seagreen:\"#2e8b57\",seashell:\"#fff5ee\",sienna:\"#a0522d\",silver:\"#c0c0c0\",skyblue:\"#87ceeb\",slateblue:\"#6a5acd\",slategray:\"#708090\",slategrey:\"#708090\",snow:\"#fffafa\",springgreen:\"#00ff7f\",steelblue:\"#4682b4\",tan:\"#d2b48c\",teal:\"#008080\",thistle:\"#d8bfd8\",tomato:\"#ff6347\",turquoise:\"#40e0d0\",violet:\"#ee82ee\",wheat:\"#f5deb3\",white:\"#ffffff\",whitesmoke:\"#f5f5f5\",yellow:\"#ffff00\",yellowgreen:\"#9acd32\"};function It(t){var e={r:0,g:0,b:0},i=1,n=null,r=null,s=null,a=!1,o=!1;return\"string\"==typeof t&&(t=function(t){if(t=t.trim().toLowerCase(),0===t.length)return!1;var e=!1;if(Lt[t])t=Lt[t],e=!0;else if(\"transparent\"===t)return{r:0,g:0,b:0,a:0,format:\"name\"};var i=Bt.rgb.exec(t);if(i)return{r:i[1],g:i[2],b:i[3]};if(i=Bt.rgba.exec(t),i)return{r:i[1],g:i[2],b:i[3],a:i[4]};if(i=Bt.hsl.exec(t),i)return{h:i[1],s:i[2],l:i[3]};if(i=Bt.hsla.exec(t),i)return{h:i[1],s:i[2],l:i[3],a:i[4]};if(i=Bt.hsv.exec(t),i)return{h:i[1],s:i[2],v:i[3]};if(i=Bt.hsva.exec(t),i)return{h:i[1],s:i[2],v:i[3],a:i[4]};if(i=Bt.hex8.exec(t),i)return{r:zt(i[1]),g:zt(i[2]),b:zt(i[3]),a:Pt(i[4]),format:e?\"name\":\"hex8\"};if(i=Bt.hex6.exec(t),i)return{r:zt(i[1]),g:zt(i[2]),b:zt(i[3]),format:e?\"name\":\"hex\"};if(i=Bt.hex4.exec(t),i)return{r:zt(i[1]+i[1]),g:zt(i[2]+i[2]),b:zt(i[3]+i[3]),a:Pt(i[4]+i[4]),format:e?\"name\":\"hex8\"};if(i=Bt.hex3.exec(t),i)return{r:zt(i[1]+i[1]),g:zt(i[2]+i[2]),b:zt(i[3]+i[3]),format:e?\"name\":\"hex\"};return!1}(t)),\"object\"==typeof t&&(Wt(t.r)&&Wt(t.g)&&Wt(t.b)?(e=function(t,e,i){return{r:255*Et(t,255),g:255*Et(e,255),b:255*Et(i,255)}}(t.r,t.g,t.b),a=!0,o=\"%\"===String(t.r).substr(-1)?\"prgb\":\"rgb\"):Wt(t.h)&&Wt(t.s)&&Wt(t.v)?(n=Ct(t.s),r=Ct(t.v),e=function(t,e,i){t=6*Et(t,360),e=Et(e,100),i=Et(i,100);var n=Math.floor(t),r=t-n,s=i*(1-e),a=i*(1-r*e),o=i*(1-(1-r)*e),l=n%6;return{r:255*[i,a,s,s,o,i][l],g:255*[o,i,i,a,s,s][l],b:255*[s,s,o,i,i,a][l]}}(t.h,n,r),a=!0,o=\"hsv\"):Wt(t.h)&&Wt(t.s)&&Wt(t.l)&&(n=Ct(t.s),s=Ct(t.l),e=function(t,e,i){var n,r,s;if(t=Et(t,360),e=Et(e,100),i=Et(i,100),0===e)r=i,s=i,n=i;else{var a=i<.5?i*(1+e):i+e-i*e,o=2*i-a;n=Ht(o,a,t+1/3),r=Ht(o,a,t),s=Ht(o,a,t-1/3)}return{r:255*n,g:255*r,b:255*s}}(t.h,n,s),a=!0,o=\"hsl\"),Object.prototype.hasOwnProperty.call(t,\"a\")&&(i=t.a)),i=Tt(i),{ok:a,format:t.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:i}}var Ft=\"(?:\".concat(\"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\",\")|(?:\").concat(\"[-\\\\+]?\\\\d+%?\",\")\"),Vt=\"[\\\\s|\\\\(]+(\".concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")\\\\s*\\\\)?\"),Ut=\"[\\\\s|\\\\(]+(\".concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")\\\\s*\\\\)?\"),Bt={CSS_UNIT:new RegExp(Ft),rgb:new RegExp(\"rgb\"+Vt),rgba:new RegExp(\"rgba\"+Ut),hsl:new RegExp(\"hsl\"+Vt),hsla:new RegExp(\"hsla\"+Ut),hsv:new RegExp(\"hsv\"+Vt),hsva:new RegExp(\"hsva\"+Ut),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Wt(t){return Boolean(Bt.CSS_UNIT.exec(String(t)))}var qt=function(){function t(e,i){var n;if(void 0===e&&(e=\"\"),void 0===i&&(i={}),e instanceof t)return e;\"number\"==typeof e&&(e=function(t){return{r:t>>16,g:(65280&t)>>8,b:255&t}}(e)),this.originalInput=e;var r=It(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(n=i.format)&&void 0!==n?n:r.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},t.prototype.getLuminance=function(){var t=this.toRgb(),e=t.r/255,i=t.g/255,n=t.b/255;return.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(t){return this.a=Tt(t),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){return 0===this.toHsl().s},t.prototype.toHsv=function(){var t=Dt(this.r,this.g,this.b);return{h:360*t.h,s:t.s,v:t.v,a:this.a}},t.prototype.toHsvString=function(){var t=Dt(this.r,this.g,this.b),e=Math.round(360*t.h),i=Math.round(100*t.s),n=Math.round(100*t.v);return 1===this.a?\"hsv(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%)\"):\"hsva(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%, \").concat(this.roundA,\")\")},t.prototype.toHsl=function(){var t=jt(this.r,this.g,this.b);return{h:360*t.h,s:t.s,l:t.l,a:this.a}},t.prototype.toHslString=function(){var t=jt(this.r,this.g,this.b),e=Math.round(360*t.h),i=Math.round(100*t.s),n=Math.round(100*t.l);return 1===this.a?\"hsl(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%)\"):\"hsla(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%, \").concat(this.roundA,\")\")},t.prototype.toHex=function(t){return void 0===t&&(t=!1),Rt(this.r,this.g,this.b,t)},t.prototype.toHexString=function(t){return void 0===t&&(t=!1),\"#\"+this.toHex(t)},t.prototype.toHex8=function(t){return void 0===t&&(t=!1),function(t,e,i,n,r){var s=[Mt(Math.round(t).toString(16)),Mt(Math.round(e).toString(16)),Mt(Math.round(i).toString(16)),Mt(Nt(n))];return r&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join(\"\")}(this.r,this.g,this.b,this.a,t)},t.prototype.toHex8String=function(t){return void 0===t&&(t=!1),\"#\"+this.toHex8(t)},t.prototype.toHexShortString=function(t){return void 0===t&&(t=!1),1===this.a?this.toHexString(t):this.toHex8String(t)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var t=Math.round(this.r),e=Math.round(this.g),i=Math.round(this.b);return 1===this.a?\"rgb(\".concat(t,\", \").concat(e,\", \").concat(i,\")\"):\"rgba(\".concat(t,\", \").concat(e,\", \").concat(i,\", \").concat(this.roundA,\")\")},t.prototype.toPercentageRgb=function(){var t=function(t){return\"\".concat(Math.round(100*Et(t,255)),\"%\")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var t=function(t){return Math.round(100*Et(t,255))};return 1===this.a?\"rgb(\".concat(t(this.r),\"%, \").concat(t(this.g),\"%, \").concat(t(this.b),\"%)\"):\"rgba(\".concat(t(this.r),\"%, \").concat(t(this.g),\"%, \").concat(t(this.b),\"%, \").concat(this.roundA,\")\")},t.prototype.toName=function(){if(0===this.a)return\"transparent\";if(this.a<1)return!1;for(var t=\"#\"+Rt(this.r,this.g,this.b,!1),e=0,i=Object.entries(Lt);e<i.length;e++){var n=i[e],r=n[0];if(t===n[1])return r}return!1},t.prototype.toString=function(t){var e=Boolean(t);t=null!=t?t:this.format;var i=!1,n=this.a<1&&this.a>=0;return e||!n||!t.startsWith(\"hex\")&&\"name\"!==t?(\"rgb\"===t&&(i=this.toRgbString()),\"prgb\"===t&&(i=this.toPercentageRgbString()),\"hex\"!==t&&\"hex6\"!==t||(i=this.toHexString()),\"hex3\"===t&&(i=this.toHexString(!0)),\"hex4\"===t&&(i=this.toHex8String(!0)),\"hex8\"===t&&(i=this.toHex8String()),\"name\"===t&&(i=this.toName()),\"hsl\"===t&&(i=this.toHslString()),\"hsv\"===t&&(i=this.toHsvString()),i||this.toHexString()):\"name\"===t&&0===this.a?this.toName():this.toRgbString()},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.l+=e/100,i.l=Ot(i.l),new t(i)},t.prototype.brighten=function(e){void 0===e&&(e=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(-e/100*255))),i.g=Math.max(0,Math.min(255,i.g-Math.round(-e/100*255))),i.b=Math.max(0,Math.min(255,i.b-Math.round(-e/100*255))),new t(i)},t.prototype.darken=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.l-=e/100,i.l=Ot(i.l),new t(i)},t.prototype.tint=function(t){return void 0===t&&(t=10),this.mix(\"white\",t)},t.prototype.shade=function(t){return void 0===t&&(t=10),this.mix(\"black\",t)},t.prototype.desaturate=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.s-=e/100,i.s=Ot(i.s),new t(i)},t.prototype.saturate=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.s+=e/100,i.s=Ot(i.s),new t(i)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var i=this.toHsl(),n=(i.h+e)%360;return i.h=n<0?360+n:n,new t(i)},t.prototype.mix=function(e,i){void 0===i&&(i=50);var n=this.toRgb(),r=new t(e).toRgb(),s=i/100;return new t({r:(r.r-n.r)*s+n.r,g:(r.g-n.g)*s+n.g,b:(r.b-n.b)*s+n.b,a:(r.a-n.a)*s+n.a})},t.prototype.analogous=function(e,i){void 0===e&&(e=6),void 0===i&&(i=30);var n=this.toHsl(),r=360/i,s=[this];for(n.h=(n.h-(r*e>>1)+720)%360;--e;)n.h=(n.h+r)%360,s.push(new t(n));return s},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){void 0===e&&(e=6);for(var i=this.toHsv(),n=i.h,r=i.s,s=i.v,a=[],o=1/e;e--;)a.push(new t({h:n,s:r,v:s})),s=(s+o)%1;return a},t.prototype.splitcomplement=function(){var e=this.toHsl(),i=e.h;return[this,new t({h:(i+72)%360,s:e.s,l:e.l}),new t({h:(i+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var i=this.toRgb(),n=new t(e).toRgb(),r=i.a+n.a*(1-i.a);return new t({r:(i.r*i.a+n.r*n.a*(1-i.a))/r,g:(i.g*i.a+n.g*n.a*(1-i.a))/r,b:(i.b*i.a+n.b*n.a*(1-i.a))/r,a:r})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var i=this.toHsl(),n=i.h,r=[this],s=360/e,a=1;a<e;a++)r.push(new t({h:(n+a*s)%360,s:i.s,l:i.l}));return r},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}();function Zt(t,e){return void 0===t&&(t=\"\"),void 0===e&&(e={}),new qt(t,e)}const Gt=\"unavailable\",Yt=(Kt=[Gt,\"unknown\"],(t,e)=>Kt.includes(t,e));var Kt;const Jt=new Set([\"fan\",\"input_boolean\",\"light\",\"switch\",\"group\",\"automation\",\"humidifier\"]),Xt=[\"auto\",\"auto-no-temperature\"],Qt=[\"card\",\"label-card\"],te=[\"--ha-card-background\",\"--card-background-color\"],ee=\"var(--primary-text-color)\";function ie(t){return t.substr(0,t.indexOf(\".\"))}function ne(t,e){const i=[];let n=e;return\"var\"===e.trim().substring(0,3)&&(e.split(\",\").forEach((t=>{const e=t.match(/var\\(\\s*([a-zA-Z0-9-]*)/);e&&i.push(e[1])})),i.some((e=>{const i=window.getComputedStyle(t).getPropertyValue(e);return!!i&&(n=i,!0)}))),n}function re(...t){const e=t=>t&&\"object\"==typeof t;return t.reduce(((t,i)=>(Object.keys(i).forEach((n=>{const r=t[n],s=i[n];Array.isArray(r)&&Array.isArray(s)?t[n]=r.concat(...s):e(r)&&e(s)?t[n]=re(r,s):t[n]=s})),t)),{})}function se(t,e){let i=[];return t&&t.forEach((t=>{let n=t;e&&e.forEach((e=>{e.id&&t.id&&e.id==t.id&&(n=re(n,e))})),i.push(n)})),e&&(i=i.concat(e.filter((e=>!t||!t.find((t=>!(!t.id||!e.id)&&t.id==e.id)))))),i}function ae(t,e){if(void 0===t)return!1;const i=ie(t.entity_id),n=void 0!==e?e:null==t?void 0:t.state;if([\"button\",\"event\",\"input_button\",\"scene\"].includes(i))return n!==Gt;if(Yt(n))return!1;if(\"off\"===n&&\"alert\"!==i)return!1;switch(i){case\"alarm_control_panel\":return\"disarmed\"!==n;case\"alert\":return\"idle\"!==n;case\"cover\":return\"closed\"!==n;case\"device_tracker\":case\"person\":return\"not_home\"!==n;case\"lock\":return\"locked\"!==n;case\"media_player\":return\"standby\"!==n;case\"vacuum\":return![\"idle\",\"docked\",\"paused\"].includes(n);case\"plant\":return\"problem\"===n;case\"group\":return[\"on\",\"home\",\"open\",\"locked\",\"problem\"].includes(n);case\"timer\":return\"active\"===n;case\"camera\":return\"streaming\"===n}return!0}function oe(t){return Array.isArray(t)?t.reverse().reduce(((t,e)=>`var(${e}${t?`, ${t}`:\"\"})`),void 0):`var(${t})`}function le(t){const e=t.split(\":\").map(Number);return 3600*e[0]+60*e[1]+e[2]}const ce=t=>t<10?`0${t}`:t;const he=new Set([\"call-service\",\"divider\",\"section\",\"weblink\",\"cast\",\"select\"]),ue={alert:\"toggle\",automation:\"toggle\",climate:\"climate\",cover:\"cover\",fan:\"toggle\",group:\"group\",input_boolean:\"toggle\",input_number:\"input-number\",input_select:\"input-select\",input_text:\"input-text\",light:\"toggle\",lock:\"lock\",media_player:\"media-player\",remote:\"toggle\",scene:\"scene\",script:\"script\",sensor:\"sensor\",timer:\"timer\",switch:\"toggle\",vacuum:\"toggle\",water_heater:\"climate\",input_datetime:\"input-datetime\"},de=((t,...e)=>{const i=1===t.length?t[0]:e.reduce(((e,i,n)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(i)+t[n+1]),t[0]);return new s(i,t,n)})`\n  :host {\n    position: relative;\n    display: block;\n    --state-inactive-color: var(--paper-item-icon-color);\n  }\n  ha-card {\n    cursor: pointer;\n    overflow: hidden;\n    box-sizing: border-box;\n    position: relative;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    line-height: normal;\n\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n    -khtml-user-select: none; /* Konqueror HTML */\n    -moz-user-select: none; /* Old versions of Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none; /* Non-prefixed version, currently\n                          supported by Chrome, Opera and Firefox */\n  }\n  ha-card.disabled {\n    pointer-events: none;\n    cursor: default;\n  }\n  :host(.tooltip) .tooltiptext {\n    pointer-events: none;\n    opacity: 0;\n    text-align: center;\n    padding: 4px;\n    border-radius: var(--ha-card-border-radius, 4px);\n    box-shadow: var(\n      --ha-card-box-shadow,\n      0px 2px 1px -1px rgba(0, 0, 0, 0.2),\n      0px 1px 1px 0px rgba(0, 0, 0, 0.14),\n      0px 1px 3px 0px rgba(0, 0, 0, 0.12)\n    );\n    background: var(--ha-card-background, var(--card-background-color, white));\n    border: 1px solid var(--primary-text-color);\n    color: var(--primary-text-color);\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n  }\n  :host(.tooltip:hover) span.tooltiptext {\n    opacity: 1;\n    transition-delay: 1.5s;\n  }\n  :not(ha-state-icon) ha-icon,\n  ha-state-icon {\n    display: inline-block;\n    margin: auto;\n    --mdc-icon-size: 100%;\n    --iron-icon-width: 100%;\n    --iron-icon-height: 100%;\n  }\n  ha-card.button-card-main {\n    padding: 4% 0px;\n    text-transform: none;\n    font-weight: 400;\n    font-size: 1.2rem;\n    align-items: center;\n    text-align: center;\n    letter-spacing: normal;\n    width: 100%;\n  }\n  .ellipsis {\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n\n  #overlay {\n    align-items: flex-start;\n    justify-content: flex-end;\n    padding: 8px 7px;\n    opacity: 0.5;\n    /* DO NOT override items below */\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    display: flex;\n  }\n  #lock {\n    -webkit-animation-fill-mode: both;\n    animation-fill-mode: both;\n    margin: unset;\n    width: 24px;\n  }\n  .invalid {\n    animation: blink 1s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;\n  }\n  .hidden {\n    visibility: hidden;\n    opacity: 0;\n    transition: visibility 0s 1s, opacity 1s linear;\n  }\n  @keyframes blink {\n    0% {\n      opacity: 0;\n    }\n    50% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0;\n    }\n  }\n  @-webkit-keyframes rotating /* Safari and Chrome */ {\n    from {\n      -webkit-transform: rotate(0deg);\n      -o-transform: rotate(0deg);\n      transform: rotate(0deg);\n    }\n    to {\n      -webkit-transform: rotate(360deg);\n      -o-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n  @keyframes rotating {\n    from {\n      -ms-transform: rotate(0deg);\n      -moz-transform: rotate(0deg);\n      -webkit-transform: rotate(0deg);\n      -o-transform: rotate(0deg);\n      transform: rotate(0deg);\n    }\n    to {\n      -ms-transform: rotate(360deg);\n      -moz-transform: rotate(360deg);\n      -webkit-transform: rotate(360deg);\n      -o-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n  [rotating] {\n    -webkit-animation: rotating 2s linear infinite;\n    -moz-animation: rotating 2s linear infinite;\n    -ms-animation: rotating 2s linear infinite;\n    -o-animation: rotating 2s linear infinite;\n    animation: rotating 2s linear infinite;\n  }\n\n  #container {\n    display: grid;\n    width: 100%;\n    height: 100%;\n    text-align: center;\n    align-items: center;\n  }\n  #img-cell {\n    display: flex;\n    grid-area: i;\n    height: 100%;\n    width: 100%;\n    max-width: 100%;\n    max-height: 100%;\n    align-self: center;\n    justify-self: center;\n    overflow: hidden;\n    justify-content: center;\n    align-items: center;\n    position: relative;\n  }\n\n  ha-state-icon#icon {\n    height: 100%;\n    width: 100%;\n    max-height: 100%;\n    position: absolute;\n  }\n  img#icon {\n    display: block;\n    height: auto;\n    width: 100%;\n    position: absolute;\n  }\n  #name {\n    grid-area: n;\n    max-width: 100%;\n    align-self: center;\n    justify-self: center;\n    /* margin: auto; */\n  }\n  #state {\n    grid-area: s;\n    max-width: 100%;\n    align-self: center;\n    justify-self: center;\n    /* margin: auto; */\n  }\n\n  #label {\n    grid-area: l;\n    max-width: 100%;\n    align-self: center;\n    justify-self: center;\n  }\n\n  #container.vertical {\n    grid-template-areas: 'i' 'n' 's' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr min-content min-content min-content;\n  }\n  /* Vertical No Icon */\n  #container.vertical.no-icon {\n    grid-template-areas: 'n' 's' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr min-content 1fr;\n  }\n  #container.vertical.no-icon #state {\n    align-self: center;\n  }\n  #container.vertical.no-icon #name {\n    align-self: end;\n  }\n  #container.vertical.no-icon #label {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No Name */\n  #container.vertical.no-icon.no-name {\n    grid-template-areas: 's' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.vertical.no-icon.no-name #state {\n    align-self: end;\n  }\n  #container.vertical.no-icon.no-name #label {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No State */\n  #container.vertical.no-icon.no-state {\n    grid-template-areas: 'n' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.vertical.no-icon.no-state #name {\n    align-self: end;\n  }\n  #container.vertical.no-icon.no-state #label {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No Label */\n  #container.vertical.no-icon.no-label {\n    grid-template-areas: 'n' 's';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.vertical.no-icon.no-label #name {\n    align-self: end;\n  }\n  #container.vertical.no-icon.no-label #state {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No Label No Name */\n  #container.vertical.no-icon.no-label.no-name {\n    grid-template-areas: 's';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.vertical.no-icon.no-label.no-name #state {\n    align-self: center;\n  }\n  /* Vertical No Icon No Label No State */\n  #container.vertical.no-icon.no-label.no-state {\n    grid-template-areas: 'n';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.vertical.no-icon.no-label.no-state #name {\n    align-self: center;\n  }\n\n  /* Vertical No Icon No Name No State */\n  #container.vertical.no-icon.no-name.no-state {\n    grid-template-areas: 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.vertical.no-icon.no-name.no-state #label {\n    align-self: center;\n  }\n\n  #container.icon_name_state {\n    grid-template-areas: 'i n' 'l l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content;\n  }\n\n  #container.icon_name {\n    grid-template-areas: 'i n' 's s' 'l l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n\n  #container.icon_state {\n    grid-template-areas: 'i s' 'n n' 'l l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n\n  #container.name_state {\n    grid-template-areas: 'i' 'n' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n  #container.name_state.no-icon {\n    grid-template-areas: 'n' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.name_state.no-icon #name {\n    align-self: end;\n  }\n  #container.name_state.no-icon #label {\n    align-self: start;\n  }\n\n  #container.name_state.no-icon.no-label {\n    grid-template-areas: 'n';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.name_state.no-icon.no-label #name {\n    align-self: center;\n  }\n\n  /* icon_name_state2nd default */\n  #container.icon_name_state2nd {\n    grid-template-areas: 'i n' 'i s' 'i l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content 1fr;\n  }\n  #container.icon_name_state2nd #name {\n    align-self: end;\n  }\n  #container.icon_name_state2nd #state {\n    align-self: center;\n  }\n  #container.icon_name_state2nd #label {\n    align-self: start;\n  }\n\n  /* icon_name_state2nd No Label */\n  #container.icon_name_state2nd.no-label {\n    grid-template-areas: 'i n' 'i s';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.icon_name_state2nd #name {\n    align-self: end;\n  }\n  #container.icon_name_state2nd #state {\n    align-self: start;\n  }\n\n  /* icon_state_name2nd Default */\n  #container.icon_state_name2nd {\n    grid-template-areas: 'i s' 'i n' 'i l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content 1fr;\n  }\n  #container.icon_state_name2nd #state {\n    align-self: end;\n  }\n  #container.icon_state_name2nd #name {\n    align-self: center;\n  }\n  #container.icon_state_name2nd #label {\n    align-self: start;\n  }\n\n  /* icon_state_name2nd No Label */\n  #container.icon_state_name2nd.no-label {\n    grid-template-areas: 'i s' 'i n';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.icon_state_name2nd #state {\n    align-self: end;\n  }\n  #container.icon_state_name2nd #name {\n    align-self: start;\n  }\n\n  #container.icon_label {\n    grid-template-areas: 'i l' 'n n' 's s';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n\n  [style*='--aspect-ratio'] > :first-child {\n    width: 100%;\n  }\n  [style*='--aspect-ratio'] > img {\n    height: auto;\n  }\n  @supports (--custom: property) {\n    [style*='--aspect-ratio'] {\n      position: relative;\n    }\n    [style*='--aspect-ratio']::before {\n      content: '';\n      display: block;\n      padding-bottom: calc(100% / (var(--aspect-ratio)));\n    }\n    [style*='--aspect-ratio'] > :first-child {\n      position: absolute;\n      top: 0;\n      left: 0;\n      height: 100%;\n    }\n  }\n`;var fe,pe,me,ge,_e;!function(t){t.language=\"language\",t.system=\"system\",t.comma_decimal=\"comma_decimal\",t.decimal_comma=\"decimal_comma\",t.space_comma=\"space_comma\",t.none=\"none\"}(fe||(fe={})),function(t){t.language=\"language\",t.system=\"system\",t.am_pm=\"12\",t.twenty_four=\"24\"}(pe||(pe={})),function(t){t.local=\"local\",t.server=\"server\"}(me||(me={})),function(t){t.language=\"language\",t.system=\"system\",t.DMY=\"DMY\",t.MDY=\"MDY\",t.YMD=\"YMD\"}(ge||(ge={})),function(t){t.language=\"language\",t.monday=\"monday\",t.tuesday=\"tuesday\",t.wednesday=\"wednesday\",t.thursday=\"thursday\",t.friday=\"friday\",t.saturday=\"saturday\",t.sunday=\"sunday\"}(_e||(_e={}));const ve=(t,e,i)=>{const n=e?(t=>{switch(t.number_format){case fe.comma_decimal:return[\"en-US\",\"en\"];case fe.decimal_comma:return[\"de\",\"es\",\"it\"];case fe.space_comma:return[\"fr\",\"sv\",\"cs\"];case fe.system:return;default:return t.language}})(e):void 0;if(Number.isNaN=Number.isNaN||function t(e){return\"number\"==typeof e&&t(e)},(null==e?void 0:e.number_format)!==fe.none&&!Number.isNaN(Number(t))&&Intl)try{return new Intl.NumberFormat(n,ye(t,i)).format(Number(t))}catch(r){return console.error(r),new Intl.NumberFormat(void 0,ye(t,i)).format(Number(t))}return\"string\"==typeof t?t:`${((t,e=2)=>Math.round(t*10**e)/10**e)(t,null==i?void 0:i.maximumFractionDigits).toString()}${\"currency\"===(null==i?void 0:i.style)?` ${i.currency}`:\"\"}`},be=(t,e,i)=>{var n;let r=null==i?void 0:i.display_precision;return void 0!==e&&(r=e),null!=r?{maximumFractionDigits:r,minimumFractionDigits:r}:Number.isInteger(Number(null===(n=t.attributes)||void 0===n?void 0:n.step))&&Number.isInteger(Number(t.state))?{maximumFractionDigits:0}:null!=t.attributes.step?{maximumFractionDigits:Math.ceil(Math.log10(1/t.attributes.step))}:void 0},ye=(t,e)=>{const i=Object.assign({maximumFractionDigits:2},e);if(\"string\"!=typeof t)return i;if(!e||void 0===e.minimumFractionDigits&&void 0===e.maximumFractionDigits){const e=t.indexOf(\".\")>-1?t.split(\".\")[1].length:0;i.minimumFractionDigits=e,i.maximumFractionDigits=e}return i};var we,$e,Ae,xe,ke;!function(t){t.language=\"language\",t.system=\"system\",t.comma_decimal=\"comma_decimal\",t.decimal_comma=\"decimal_comma\",t.space_comma=\"space_comma\",t.none=\"none\"}(we||(we={})),function(t){t.language=\"language\",t.system=\"system\",t.am_pm=\"12\",t.twenty_four=\"24\"}($e||($e={})),function(t){t.local=\"local\",t.server=\"server\"}(Ae||(Ae={})),function(t){t.language=\"language\",t.system=\"system\",t.DMY=\"DMY\",t.MDY=\"MDY\",t.YMD=\"YMD\"}(xe||(xe={})),function(t){t.language=\"language\",t.monday=\"monday\",t.tuesday=\"tuesday\",t.wednesday=\"wednesday\",t.thursday=\"thursday\",t.friday=\"friday\",t.saturday=\"saturday\",t.sunday=\"sunday\"}(ke||(ke={}));const Se=(t,e=2)=>{let i=\"\"+t;for(let n=1;n<e;n++)i=parseInt(i)<10**n?`0${i}`:i;return i};const Ee={ms:1,s:1e3,min:6e4,h:36e5,d:864e5},Oe=(t,e)=>function(t){const e=Math.floor(t/1e3/3600),i=Math.floor(t/1e3%3600/60),n=Math.floor(t/1e3%3600%60),r=Math.floor(t%1e3);return e>0?`${e}:${Se(i)}:${Se(n)}`:i>0?`${i}:${Se(n)}`:n>0||r>0?`${n}${r>0?`.${Se(r,3)}`:\"\"}`:null}(parseFloat(t)*Ee[e])||\"0\";var Te=Number.isNaN||function(t){return\"number\"==typeof t&&t!=t};function Ce(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(n=t[i],r=e[i],!(n===r||Te(n)&&Te(r)))return!1;var n,r;return!0}function Me(t,e){void 0===e&&(e=Ce);var i=null;function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(i&&i.lastThis===this&&e(n,i.lastArgs))return i.lastResult;var s=t.apply(this,n);return i={lastResult:s,lastArgs:n,lastThis:this},s}return n.clear=function(){i=null},n}const je=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:\"long\",month:\"long\",day:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),He=(t,e,i)=>De(e,i.time_zone).format(t),De=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{year:\"numeric\",month:\"long\",day:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),Re=(t,e,i)=>{var n,r,s,a;const o=Ne(e,i.time_zone);if(e.date_format===ge.language||e.date_format===ge.system)return o.format(t);const l=o.formatToParts(t),c=null===(n=l.find((t=>\"literal\"===t.type)))||void 0===n?void 0:n.value,h=null===(r=l.find((t=>\"day\"===t.type)))||void 0===r?void 0:r.value,u=null===(s=l.find((t=>\"month\"===t.type)))||void 0===s?void 0:s.value,d=null===(a=l.find((t=>\"year\"===t.type)))||void 0===a?void 0:a.value,f=l[l.length-1];let p=\"literal\"===(null==f?void 0:f.type)?null==f?void 0:f.value:\"\";\"bg\"===e.language&&e.date_format===ge.YMD&&(p=\"\");return{[ge.DMY]:`${h}${c}${u}${c}${d}${p}`,[ge.MDY]:`${u}${c}${h}${c}${d}${p}`,[ge.YMD]:`${d}${c}${u}${c}${h}${p}`}[e.date_format]},Ne=Me(((t,e)=>{const i=t.date_format===ge.system?void 0:t.language;return t.date_format===ge.language||(t.date_format,ge.system),new Intl.DateTimeFormat(i,{year:\"numeric\",month:\"numeric\",day:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0})})),Pe=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{day:\"numeric\",month:\"short\",timeZone:\"server\"===t.time_zone?e:void 0}))),ze=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{month:\"long\",year:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),Le=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{month:\"long\",timeZone:\"server\"===t.time_zone?e:void 0}))),Ie=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{year:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),Fe=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:\"long\",timeZone:\"server\"===t.time_zone?e:void 0}))),Ve=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:\"short\",timeZone:\"server\"===t.time_zone?e:void 0}))),Ue=Me((t=>{if(t.time_format===pe.language||t.time_format===pe.system){const e=t.time_format===pe.language?t.language:void 0,i=(new Date).toLocaleString(e);return i.includes(\"AM\")||i.includes(\"PM\")}return t.time_format===pe.am_pm})),Be=(t,e,i)=>We(e,i.time_zone).format(t),We=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{hour:\"numeric\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),qe=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Ze=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{weekday:\"long\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Ge=Me(((t,e)=>new Intl.DateTimeFormat(\"en-GB\",{hour:\"numeric\",minute:\"2-digit\",hour12:!1,timeZone:\"server\"===t.time_zone?e:void 0}))),Ye=(t,e,i)=>Ke(e,i.time_zone).format(t),Ke=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{year:\"numeric\",month:\"long\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Je=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{year:\"numeric\",month:\"short\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Xe=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{month:\"short\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Qe=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{year:\"numeric\",month:\"long\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),ti=(t,e)=>0!=(t.supported_features&e),ei=t=>(t=>ti(t,4)&&\"number\"==typeof t.in_progress)(t)||!!t.in_progress,ii=(t,e,i,n,r,s,a)=>{const o=r[e.entity_id];return ni(t,i,n,o,e.entity_id,e.attributes,s,void 0!==a?a:e.state)},ni=(t,e,i,n,r,s,a,o)=>{var l;if(\"unknown\"===o||\"unavailable\"===o)return t(`state.default.${o}`);if(function(t){return!!t.unit_of_measurement||!!t.state_class}(s)){if(\"duration\"===s.device_class&&s.unit_of_measurement&&Ee[s.unit_of_measurement])try{return Oe(o,s.unit_of_measurement)}catch(h){}if(\"monetary\"===s.device_class)try{return ve(o,e,Object.assign({style:\"currency\",currency:(null==a?void 0:a.units)||s.unit_of_measurement,minimumFractionDigits:2},be({state:o,attributes:s},null==a?void 0:a.numeric_precision,n)))}catch(h){}const t=(null==a?void 0:a.show_units)?(null==a?void 0:a.units)?null==a?void 0:a.units:s.unit_of_measurement:void 0,i=t?\"%\"===t?(t=>{switch(t.language){case\"cz\":case\"de\":case\"fi\":case\"fr\":case\"sk\":case\"sv\":return\" \";default:return\"\"}})(e)+\"%\":` ${t}`:\"\";return`${ve(o,e,be({state:o,attributes:s},null==a?void 0:a.numeric_precision,n))}${i}`}const c=ie(r);if(\"datetime\"===c){const t=new Date(o);return Ye(t,e,i)}if([\"date\",\"input_datetime\",\"time\"].includes(c))try{const t=o.split(\" \");if(2===t.length)return Ye(new Date(t.join(\"T\")),Object.assign(Object.assign({},e),{time_zone:Ae.local}),i);if(1===t.length){if(o.includes(\"-\"))return He(new Date(`${o}T00:00`),Object.assign(Object.assign({},e),{time_zone:Ae.local}),i);if(o.includes(\":\")){const t=new Date;return Be(new Date(`${t.toISOString().split(\"T\")[0]}T${o}`),Object.assign(Object.assign({},e),{time_zone:Ae.local}),i)}}return o}catch(u){return o}if(\"counter\"===c||\"number\"===c||\"input_number\"===c)return ve(o,e,be({state:o,attributes:s},null==a?void 0:a.numeric_precision,n));if([\"button\",\"event\",\"input_button\",\"scene\",\"stt\",\"tts\"].includes(c)||\"sensor\"===c&&\"timestamp\"===s.device_class)try{return Ye(new Date(o),e,i)}catch(h){return o}return\"update\"===c?\"on\"===o?ei(s)?ti(s,4)&&\"number\"==typeof s.in_progress?t(\"ui.card.update.installing_with_progress\",{progress:s.in_progress}):t(\"ui.card.update.installing\"):s.latest_version:s.skipped_version===s.latest_version?null!==(l=s.latest_version)&&void 0!==l?l:t(\"state.default.unavailable\"):t(\"ui.card.update.up_to_date\"):(null==n?void 0:n.translation_key)&&t(`component.${n.platform}.entity.${c}.${n.translation_key}.state.${o}`)||s.device_class&&t(`component.${c}.entity_component.${s.device_class}.state.${o}`)||t(`component.${c}.entity_component._.state.${o}`)||o};var ri=Function.prototype.toString,si=Object.create,ai=Object.defineProperty,oi=Object.getOwnPropertyDescriptor,li=Object.getOwnPropertyNames,ci=Object.getOwnPropertySymbols,hi=Object.getPrototypeOf,ui=Object.prototype,di=ui.hasOwnProperty,fi=ui.propertyIsEnumerable,pi=\"function\"==typeof ci,mi=\"function\"==typeof WeakMap,gi=function(){if(mi)return function(){return new WeakMap};var t=function(){function t(){this._keys=[],this._values=[]}return t.prototype.has=function(t){return!!~this._keys.indexOf(t)},t.prototype.get=function(t){return this._values[this._keys.indexOf(t)]},t.prototype.set=function(t,e){this._keys.push(t),this._values.push(e)},t}();return function(){return new t}}(),_i=function(t,e){var i=t.__proto__||hi(t);if(!i)return si(null);var n=i.constructor;if(n===e.Object)return i===e.Object.prototype?{}:si(i);if(~ri.call(n).indexOf(\"[native code]\"))try{return new n}catch(ui){}return si(i)},vi=function(t,e,i,n){var r=_i(t,e);for(var s in n.set(t,r),t)di.call(t,s)&&(r[s]=i(t[s],n));if(pi)for(var a=ci(t),o=0,l=a.length,c=void 0;o<l;++o)c=a[o],fi.call(t,c)&&(r[c]=i(t[c],n));return r},bi=function(t,e,i,n){var r=_i(t,e);n.set(t,r);for(var s=pi?li(t).concat(ci(t)):li(t),a=0,o=s.length,l=void 0,c=void 0;a<o;++a)if(\"callee\"!==(l=s[a])&&\"caller\"!==l)if(c=oi(t,l)){c.get||c.set||(c.value=i(t[l],n));try{ai(r,l,c)}catch(h){r[l]=c.value}}else r[l]=i(t[l],n);return r},yi=Array.isArray,wi=Object.getPrototypeOf,$i=function(){return\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:(console&&console.error&&console.error('Unable to locate global object, returning \"this\".'),this)}();function Ai(t,e){var i=!(!e||!e.isStrict),n=e&&e.realm||$i,r=i?bi:vi,s=function(t,e){if(!t||\"object\"!=typeof t)return t;if(e.has(t))return e.get(t);var a,o,l,c=t.__proto__||wi(t),h=c&&c.constructor;if(!h||h===n.Object)return r(t,n,s,e);if(yi(t)){if(i)return bi(t,n,s,e);a=new h,e.set(t,a);for(var u=0,d=t.length;u<d;++u)a[u]=s(t[u],e);return a}if(t instanceof n.Date)return new h(t.getTime());if(t instanceof n.RegExp)return(a=new h(t.source,t.flags||(l=\"\",(o=t).global&&(l+=\"g\"),o.ignoreCase&&(l+=\"i\"),o.multiline&&(l+=\"m\"),o.unicode&&(l+=\"u\"),o.sticky&&(l+=\"y\"),l))).lastIndex=t.lastIndex,a;if(n.Map&&t instanceof n.Map)return a=new h,e.set(t,a),t.forEach((function(t,i){a.set(i,s(t,e))})),a;if(n.Set&&t instanceof n.Set)return a=new h,e.set(t,a),t.forEach((function(t){a.add(s(t,e))})),a;if(n.Blob&&t instanceof n.Blob)return t.slice(0,t.size,t.type);if(n.Buffer&&n.Buffer.isBuffer(t))return a=n.Buffer.allocUnsafe?n.Buffer.allocUnsafe(t.length):new h(t.length),e.set(t,a),t.copy(a),a;if(n.ArrayBuffer){if(n.ArrayBuffer.isView(t))return a=new h(t.buffer.slice(0)),e.set(t,a),a;if(t instanceof n.ArrayBuffer)return a=t.slice(0),e.set(t,a),a}return\"function\"==typeof t.then||t instanceof Error||n.WeakMap&&t instanceof n.WeakMap||n.WeakSet&&t instanceof n.WeakSet?t:r(t,n,s,e)};return s(t,gi())}Ai.default=Ai,Ai.strict=function(t,e){return Ai(t,{isStrict:!0,realm:e?e.realm:void 0})};const xi=new Set([\"alarm_control_panel\",\"alert\",\"automation\",\"binary_sensor\",\"calendar\",\"camera\",\"climate\",\"cover\",\"device_tracker\",\"fan\",\"group\",\"humidifier\",\"input_boolean\",\"light\",\"lock\",\"media_player\",\"person\",\"plant\",\"remote\",\"schedule\",\"script\",\"siren\",\"sun\",\"switch\",\"timer\",\"update\",\"vacuum\"]),ki=(t,e,i)=>{if((void 0!==e?e:null==t?void 0:t.state)===Gt)return\"var(--state-unavailable-color)\";const n=Ei(t,e,i);return n?oe(n):void 0},Si=(t,e,i,n)=>{const r=void 0!==i?i:e.state,s=ae(e,i),a=[],o=function(t,e=\"_\"){const i=\"àáäâãåăæąçćčđďèéěėëêęğǵḧìíïîįłḿǹńňñòóöôœøṕŕřßşśšșťțùúüûǘůűūųẃẍÿýźžż·/_,:;\",n=`aaaaaaaaacccddeeeeeeegghiiiiilmnnnnooooooprrsssssttuuuuuuuuuwxyyzzz${e}${e}${e}${e}${e}${e}`,r=new RegExp(i.split(\"\").join(\"|\"),\"g\");return t.toString().toLowerCase().replace(/\\s+/g,e).replace(r,(t=>n.charAt(i.indexOf(t)))).replace(/&/g,`${e}and${e}`).replace(/[^\\w-]+/g,\"\").replace(/-/g,e).replace(new RegExp(`(${e})\\\\1+`,\"g\"),\"$1\").replace(new RegExp(`^${e}+`),\"\").replace(new RegExp(`${e}+$`),\"\")}(r,\"_\"),l=s?\"active\":\"inactive\";if(n&&Qt.includes(n)&&\"inactive\"==l)return te;const c=e.attributes.device_class;return c&&a.push(`--state-${t}-${c}-${o}-color`),a.push(`--state-${t}-${o}-color`,`--state-${t}-${l}-color`,`--state-${l}-color`),a},Ei=(t,e,i)=>{const n=void 0!==e?e:null==t?void 0:t.state,r=ie(t.entity_id),s=t.attributes.device_class;if(\"sensor\"===r&&\"battery\"===s){const t=(t=>{const e=Number(t);if(!isNaN(e))return e>=70?\"--state-sensor-battery-high-color\":e>=30?\"--state-sensor-battery-medium-color\":\"--state-sensor-battery-low-color\"})(n);if(t)return[t]}if(\"group\"===r){const n=(t=>{const e=t.attributes.entity_id||[],i=[...new Set(e.map((t=>ie(t))))];return 1===i.length?i[0]:void 0})(t);if(n&&xi.has(n))return Si(n,t,e,i)}return xi.has(r)?Si(r,t,e,i):i&&Qt.includes(i)?te:void 0};let Oi=window.cardHelpers;const Ti=new Promise((async t=>{Oi&&t(),window.loadCardHelpers&&(Oi=await window.loadCardHelpers(),window.cardHelpers=Oi,t())}));console.info(\"%c  BUTTON-CARD (mod for CB-LCARS)  \\n%c Version 4.1.2-cblcars.3 \",\"color: white; font-weight: bold; background: #37a6d1\",\"color: white; font-weight: bold; background: #37a6d1\");let Ci=class extends nt{constructor(){super(...arguments),this._cards={},this._cardsConfig={},this._entities=[],this._initialSetupComplete=!1,this._rippleHandlers=new ht((()=>this._ripple))}get _doIHaveEverything(){return!!this._hass&&!!this._config&&this.isConnected}set hass(t){this._hass=t,Object.keys(this._cards).forEach((t=>{this._cards[t].hass=this._hass})),this._initialSetupComplete||this._finishSetup()}disconnectedCallback(){super.disconnectedCallback(),this._clearInterval()}connectedCallback(){super.connectedCallback(),this._initialSetupComplete?this._startTimerCountdown():this._finishSetup()}_evaluateVariablesSkipError(t){var e;if(this._evaledVariables={},null===(e=this._config)||void 0===e?void 0:e.variables){Object.keys(this._config.variables).sort().forEach((e=>{try{this._evaledVariables[e]=this._objectEvalTemplate(t,this._config.variables[e])}catch(vt){}}))}}_finishSetup(){if(!this._initialSetupComplete&&this._doIHaveEverything){if(this._evaluateVariablesSkipError(),this._config.entity){const t=this._getTemplateOrValue(void 0,this._config.entity);this._config.entity=t,this._stateObj=this._hass.states[t]}this._evaluateVariablesSkipError(this._stateObj),this._config.entity&&Jt.has(ie(this._config.entity))?this._config=Object.assign({tap_action:{action:\"toggle\"}},this._config):this._config.entity?this._config=Object.assign({tap_action:{action:\"more-info\"}},this._config):this._config=Object.assign({tap_action:{action:\"none\"}},this._config);const t=JSON.stringify(this._config);if(this._entities=[],Array.isArray(this._config.triggers_update))this._config.triggers_update.forEach((t=>{try{const e=this._getTemplateOrValue(this._stateObj,t);null==e||this._entities.includes(e)||this._entities.push(e)}catch(vt){}}));else if(\"string\"==typeof this._config.triggers_update){const t=this._getTemplateOrValue(this._stateObj,this._config.triggers_update);t&&\"all\"!==t?this._entities.push(t):this._config.triggers_update=t}if(\"all\"!==this._config.triggers_update){const e=new RegExp(/states\\[\\s*('|\\\\\")([a-zA-Z0-9_]+\\.[a-zA-Z0-9_]+)\\1\\s*\\]/,\"gm\"),i=new RegExp(/states\\[\\s*('|\\\\\")([a-zA-Z0-9_]+\\.[a-zA-Z0-9_]+)\\1\\s*\\]/,\"m\"),n=t.match(e);null==n||n.forEach((t=>{const e=t.match(i);e&&!this._entities.includes(e[2])&&this._entities.push(e[2])}))}this._config.entity&&!this._entities.includes(this._config.entity)&&this._entities.push(this._config.entity),this._expandTriggerGroups();const e=new RegExp(\"\\\\[\\\\[\\\\[.*\\\\]\\\\]\\\\]\",\"m\");this._hasTemplate=!(\"all\"!==this._config.triggers_update||!t.match(e)),this._startTimerCountdown(),this._initialSetupComplete=!0}}_startTimerCountdown(){if(this._config&&this._config.entity&&\"timer\"===ie(this._config.entity)){const t=this._hass.states[this._config.entity];this._startInterval(t)}}_createCard(t){if(Oi)return Oi.createCardElement(t);{const e=((t,e=!1)=>{const i=(t,e)=>n(\"hui-error-card\",{type:\"error\",error:t,config:e}),n=(t,e)=>{const n=window.document.createElement(t);try{if(!n.setConfig)return;n.setConfig(e)}catch(r){return console.error(t,r),i(r.message,e)}return n};if(!t||\"object\"!=typeof t||!e&&!t.type)return i(\"No type defined\",t);let r=t.type;if(r&&r.startsWith(\"custom:\"))r=r.substr(7);else if(e)if(he.has(r))r=`hui-${r}-row`;else{if(!t.entity)return i(\"Invalid config given.\",t);const e=t.entity.split(\".\",1)[0];r=`hui-${ue[e]||\"text\"}-entity-row`}else r=`hui-${r}-card`;if(customElements.get(r))return n(r,t);const s=i(`Custom element doesn't exist: ${t.type}.`,t);s.style.display=\"None\";const a=setTimeout((()=>{s.style.display=\"\"}),2e3);return customElements.whenDefined(t.type).then((()=>{clearTimeout(a),wt(s,\"ll-rebuild\",{},s)})),s})(t);return Ti.then((()=>{wt(e,\"ll-rebuild\",{})})),e}}static get styles(){return de}render(){var t;if(!this._config||!this._hass)return P``;this._stateObj=this._config.entity?this._hass.states[this._config.entity]:void 0;try{if(this._evaledVariables={},null===(t=this._config)||void 0===t?void 0:t.variables){Object.keys(this._config.variables).sort().forEach((t=>{this._evaledVariables[t]=this._objectEvalTemplate(this._stateObj,this._config.variables[t])}))}return this._cardHtml()}catch(vt){vt.stack?console.error(vt.stack):console.error(vt);const e=document.createElement(\"hui-error-card\");return e.setConfig({type:\"error\",error:vt.toString(),origConfig:this._config}),P` ${e} `}}shouldUpdate(t){return!(!this._hasTemplate&&!t.has(\"_timeRemaining\")&&!function(t,e){if(e.has(\"_config\"))return!0;const i=e.get(\"_hass\");if(i)return t._entities.some((function(e){return(null==i?void 0:i.states[e])!==t._hass.states[e]}));return!1}(this,t))&&(this._expandTriggerGroups(),!0)}updated(t){if(super.updated(t),this._config&&this._config.entity&&\"timer\"===ie(this._config.entity)&&t.has(\"_hass\")){const e=this._hass.states[this._config.entity],i=t.get(\"_hass\");(i?i.states[this._config.entity]:void 0)!==e?this._startInterval(e):e||this._clearInterval()}}_clearInterval(){this._interval&&(window.clearInterval(this._interval),this._interval=void 0)}_startInterval(t){this._clearInterval(),this._calculateRemaining(t),\"active\"===t.state&&(this._interval=window.setInterval((()=>this._calculateRemaining(t)),1e3))}_calculateRemaining(t){t.attributes.remaining&&(this._timeRemaining=(t=>{if(!t.attributes.remaining)return;let e=le(t.attributes.remaining);if(\"active\"===t.state){const i=(new Date).getTime(),n=new Date(t.last_changed).getTime();e=Math.max(e-(i-n)/1e3,0)}return e})(t))}_computeTimeDisplay(t){if(t)return function(t){const e=Math.floor(t/3600),i=Math.floor(t%3600/60),n=Math.floor(t%3600%60);return e>0?`${e}:${ce(i)}:${ce(n)}`:i>0?`${i}:${ce(n)}`:n>0?\"\"+n:null}(this._timeRemaining||le(t.attributes.duration))}_getMatchingConfigState(t){if(!this._config.state)return;const e=this._config.state.find((t=>\"template\"===t.operator));if(!t&&!e)return;let i;const n=this._config.state.find((e=>{if(!e.operator)return t&&this._getTemplateOrValue(t,e.value)==t.state;switch(e.operator){case\"==\":return t&&t.state==this._getTemplateOrValue(t,e.value);case\"<=\":return t&&t.state<=this._getTemplateOrValue(t,e.value);case\"<\":return t&&t.state<this._getTemplateOrValue(t,e.value);case\">=\":return t&&t.state>=this._getTemplateOrValue(t,e.value);case\">\":return t&&t.state>this._getTemplateOrValue(t,e.value);case\"!=\":return t&&t.state!=this._getTemplateOrValue(t,e.value);case\"regex\":return!(!t||!t.state.match(this._getTemplateOrValue(t,e.value)));case\"template\":return this._getTemplateOrValue(t,e.value);case\"default\":return i=e,!1;default:return!1}}));return!n&&i?i:n}_localize(t,e,i,n=!0,r){var s;return ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,{numeric_precision:\"card\"===i?null===(s=this._config)||void 0===s?void 0:s.numeric_precision:i,show_units:n,units:r},e)}_relativeTime(t,e=!1){return t?P`\n        <ha-relative-time\n          id=\"relative-time\"\n          class=\"ellipsis\"\n          .hass=\"${this._hass}\"\n          .datetime=\"${t}\"\n          .capitalize=\"${e}\"\n        ></ha-relative-time>\n      `:\"\"}_getTemplateHelpers(){return{localize:this._localize.bind(this),formatDateTime:t=>Ye(new Date(t),this._hass.locale,this._hass.config),formatShortDateTimeWithYear:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Je(i,n.time_zone).format(e);var e,i,n},formatShortDateTime:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Xe(i,n.time_zone).format(e);var e,i,n},formatDateTimeWithSeconds:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Qe(i,n.time_zone).format(e);var e,i,n},formatDateTimeNumeric:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,`${Re(e,i,n)}, ${Be(e,i,n)}`;var e,i,n},relativeTime:this._relativeTime.bind(this),formatTime:t=>Be(new Date(t),this._hass.locale,this._hass.config),formatTimeWithSeconds:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,qe(i,n.time_zone).format(e);var e,i,n},formatTimeWeekday:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ze(i,n.time_zone).format(e);var e,i,n},formatTime24h:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ge(i,n.time_zone).format(e);var e,i,n},formatDateWeekdayDay:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,je(i,n.time_zone).format(e);var e,i,n},formatDate:t=>He(new Date(t),this._hass.locale,this._hass.config),formatDateNumeric:t=>Re(new Date(t),this._hass.locale,this._hass.config),formatDateShort:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Pe(i,n.time_zone).format(e);var e,i,n},formatDateMonthYear:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,ze(i,n.time_zone).format(e);var e,i,n},formatDateMonth:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Le(i,n.time_zone).format(e);var e,i,n},formatDateYear:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ie(i,n.time_zone).format(e);var e,i,n},formatDateWeekday:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Fe(i,n.time_zone).format(e);var e,i,n},formatDateWeekdayShort:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ve(i,n.time_zone).format(e);var e,i,n}}}_evalTemplate(t,e){try{return new Function(\"states\",\"entity\",\"user\",\"hass\",\"variables\",\"html\",\"helpers\",`'use strict'; ${e}`).call(this,this._hass.states,t,this._hass.user,this._hass,this._evaledVariables,P,this._getTemplateHelpers())}catch(vt){const i=e.length<=100?e.trim():`${e.trim().substring(0,98)}...`;throw vt.message=`${vt.name}: ${vt.message} in '${i}'`,vt.name=\"ButtonCardJSTemplateError\",vt}}_objectEvalTemplate(t,e){const i=Ai(e);return this._getTemplateOrValue(t,i)}_getTemplateOrValue(t,e){if([\"number\",\"boolean\"].includes(typeof e))return e;if(!e)return e;if(\"object\"==typeof e)return Object.keys(e).forEach((i=>{e[i]=this._getTemplateOrValue(t,e[i])})),e;const i=e.trim();return\"[[[\"===i.substring(0,3)&&\"]]]\"===i.slice(-3)?this._evalTemplate(t,i.slice(3,-3)):e}_getColorForLightEntity(t,e,i){let n=ee;return Qt.includes(n)&&(n=oe(te)),t&&(ae(t)?(n=t.attributes.rgb_color?`rgb(${t.attributes.rgb_color.join(\",\")})`:e&&t.attributes.color_temp&&t.attributes.min_mireds&&t.attributes.max_mireds?function(t,e,i){const n=new qt(\"rgb(255, 160, 0)\"),r=new qt(\"rgb(166, 209, 255)\"),s=new qt(\"white\"),a=(t-e)/(i-e)*100;return a<50?Zt(r).mix(s,2*a).toRgbString():Zt(s).mix(n,2*(a-50)).toRgbString()}(t.attributes.color_temp,t.attributes.min_mireds,t.attributes.max_mireds):ki(t,t.state,i)||ee,t.attributes.brightness&&(n=function(t,e,i){const n=new qt(ne(t,e));if(n.isValid){const t=n.mix(\"black\",100-i).toString();if(t)return t}return e}(this,n,(t.attributes.brightness+245)/5))):n=ki(t,t.state,i)||ee),n}_buildCssColorAttribute(t,e){var i,n;let r,s=\"\";return(null==e?void 0:e.color)?s=e.color:this._config.color&&(s=this._config.color),Xt.includes(s)&&(!t||t&&\"light\"!==ie(t.entity_id))&&(s=\"\"),r=Xt.includes(s)?this._getColorForLightEntity(t,\"auto-no-temperature\"!==s,null===(i=this._config)||void 0===i?void 0:i.color_type):s||(t&&ki(t,t.state,null===(n=this._config)||void 0===n?void 0:n.color_type)||ee),r}_buildIcon(t,e){if(!this._config.show_icon)return;let i;if(null==e?void 0:e.icon)i=e.icon;else{if(!this._config.icon)return;i=this._config.icon}return this._getTemplateOrValue(t,i)}_buildEntityPicture(t,e){if(!this._config.show_entity_picture||!t&&!e&&!this._config.entity_picture)return;let i;return(null==e?void 0:e.entity_picture)?i=e.entity_picture:this._config.entity_picture?i=this._config.entity_picture:t&&(i=t.attributes&&t.attributes.entity_picture?t.attributes.entity_picture:void 0),this._getTemplateOrValue(t,i)}_buildStyleGeneric(t,e,i){var n,r;let s={};if((null===(n=this._config.styles)||void 0===n?void 0:n[i])&&(s=Object.assign(s,...this._config.styles[i])),null===(r=null==e?void 0:e.styles)||void 0===r?void 0:r[i]){let t={};t=Object.assign(t,...e.styles[i]),s=Object.assign(Object.assign({},s),t)}return Object.keys(s).forEach((e=>{s[e]=this._getTemplateOrValue(t,s[e])})),s}_buildCustomStyleGeneric(t,e,i){var n,r,s,a;let o={};if((null===(r=null===(n=this._config.styles)||void 0===n?void 0:n.custom_fields)||void 0===r?void 0:r[i])&&(o=Object.assign(o,...this._config.styles.custom_fields[i])),null===(a=null===(s=null==e?void 0:e.styles)||void 0===s?void 0:s.custom_fields)||void 0===a?void 0:a[i]){let t={};t=Object.assign(t,...e.styles.custom_fields[i]),o=Object.assign(Object.assign({},o),t)}return Object.keys(o).forEach((e=>{o[e]=this._getTemplateOrValue(t,o[e])})),o}_buildName(t,e){if(!1===this._config.show_name)return;let i;var n;return(null==e?void 0:e.name)?i=e.name:this._config.name?i=this._config.name:t&&(i=t.attributes&&t.attributes.friendly_name?t.attributes.friendly_name:(n=t.entity_id).substr(n.indexOf(\".\")+1)),this._getTemplateOrValue(t,i)}_buildStateString(t){let e;return this._config.show_state&&t&&t.state&&(\"timer\"===ie(t.entity_id)?\"idle\"===t.state||0===this._timeRemaining?e=ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,this._config):(e=this._computeTimeDisplay(t),\"paused\"===t.state&&(e+=` (${ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,this._config)})`)):e=ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,this._config)),e}_buildLastChanged(t,e){return this._config.show_last_changed&&t?P`\n          <ha-relative-time\n            id=\"label\"\n            class=\"ellipsis\"\n            .hass=\"${this._hass}\"\n            .datetime=\"${t.last_changed}\"\n            style=${_t(e)}\n          ></ha-relative-time>\n        `:void 0}_buildLabel(t,e){if(!this._config.show_label)return;let i;return i=(null==e?void 0:e.label)?e.label:this._config.label,this._getTemplateOrValue(t,i)}_buildCustomFields(t,e){let i=P``;const n={},r={};return this._config.custom_fields&&Object.keys(this._config.custom_fields).forEach((e=>{const i=this._config.custom_fields[e];i.card?i.do_not_eval?r[e]=Ai(i.card):r[e]=this._objectEvalTemplate(t,i.card):n[e]=this._getTemplateOrValue(t,i)})),(null==e?void 0:e.custom_fields)&&Object.keys(e.custom_fields).forEach((i=>{const s=e.custom_fields[i];s.card?s.do_not_eval?r[i]=Ai(s.card):r[i]=this._objectEvalTemplate(t,s.card):n[i]=this._getTemplateOrValue(t,s)})),Object.keys(n).forEach((r=>{if(null!=n[r]){const s=Object.assign(Object.assign({},this._buildCustomStyleGeneric(t,e,r)),{\"grid-area\":r});i=P`\n          ${i}\n          <div id=${r} class=\"ellipsis\" style=${_t(s)}>${this._unsafeHTMLorNot(n[r])}</div>\n        `}})),Object.keys(r).forEach((n=>{if(null!=r[n]){const s=Object.assign(Object.assign({},this._buildCustomStyleGeneric(t,e,n)),{\"grid-area\":n});let a;$t(this._cardsConfig[n],r[n])?a=this._cards[n]:(a=this._createCard(r[n]),this._cards[n]=a,this._cardsConfig[n]=Ai(r[n])),a.hass=this._hass,i=P`\n          ${i}\n          <div\n            id=${n}\n            @action=${this._stopPropagation}\n            @click=${this._stopPropagation}\n            @touchstart=${this._stopPropagation}\n            @mousedown=${this._stopPropagation}\n            @mouseup=${this._stopPropagation}\n            @touchend=${this._stopPropagation}\n            @touchcancel=${this._stopPropagation}\n            style=${_t(s)}\n          >\n            ${a}\n          </div>\n        `}})),i}_hasChildCards(t){return!!t&&Object.keys(t).some((e=>!!t[e].card))}_isClickable(t,e){const i=this._getTemplateOrValue(t,this._config.tap_action.action),n=this._getTemplateOrValue(t,this._config.hold_action.action),r=this._getTemplateOrValue(t,this._config.double_tap_action.action),s=this._hasChildCards(this._config.custom_fields)||!(!e||!this._hasChildCards(e.custom_fields));return\"none\"!=i||\"none\"!=n||\"none\"!=r||s}_rotate(t){return!!(null==t?void 0:t.spin)}_blankCardColoredHtml(t){const e=Object.assign({background:\"none\",\"box-shadow\":\"none\",\"border-style\":\"none\"},t);return P`\n      <ha-card class=\"disabled\" style=${_t(e)}>\n        <div></div>\n      </ha-card>\n    `}_cardHtml(){var t,e,i,n;const r=this._getMatchingConfigState(this._stateObj);let s=\"var(--state-inactive-color)\";(null==r?void 0:r.color)&&!Xt.includes(r.color)?s=r.color:(null===(t=this._config)||void 0===t?void 0:t.color)&&!Xt.includes(this._config.color)?this._stateObj?ae(this._stateObj)&&(s=(null===(e=this._config)||void 0===e?void 0:e.color)||s):s=this._config.color:s=this._buildCssColorAttribute(this._stateObj,r);let a=s,o={},l={};const c={},h=this._buildStyleGeneric(this._stateObj,r,\"lock\"),u=this._buildStyleGeneric(this._stateObj,r,\"card\"),d=this._buildStyleGeneric(this._stateObj,r,\"tooltip\"),f={\"button-card-main\":!0,disabled:!this._isClickable(this._stateObj,r)};switch((null===(i=this._config)||void 0===i?void 0:i.tooltip)&&this.classList.add(\"tooltip\"),u.width&&(this.style.setProperty(\"flex\",\"0 0 auto\"),this.style.setProperty(\"max-width\",\"fit-content\")),this._config.color_type){case\"blank-card\":return this._blankCardColoredHtml(u);case\"card\":case\"label-card\":{const t=function(t,e){const i=new qt(ne(t,e)).getLuminance(),n=new qt({r:225,g:225,b:225}),r=n.getLuminance(),s=new qt({r:28,g:28,b:28}),a=s.getLuminance();return 0===i||(Math.max(i,r)+.05)/Math.min(i,r+.05)>(Math.max(i,a)+.05)/Math.min(i,a+.05)?n.toRgbString():s.toRgbString()}(this,s);o.color=t,l.color=t,o[\"background-color\"]=s,o=Object.assign(Object.assign({},o),u),a=\"inherit\";break}default:o=u}this._config.aspect_ratio?(c[\"--aspect-ratio\"]=this._config.aspect_ratio,o.position=\"absolute\"):c.display=\"inline\",this.style.setProperty(\"--button-card-light-color\",this._getColorForLightEntity(this._stateObj,!0)),this.style.setProperty(\"--button-card-light-color-no-temperature\",this._getColorForLightEntity(this._stateObj,!1)),l=Object.assign(Object.assign({},l),h);const p=this._config.extra_styles?P`\n          <style>\n            ${this._getTemplateOrValue(this._stateObj,this._config.extra_styles)}\n          </style>\n        `:P``;return P`\n      ${p}\n      <div id=\"aspect-ratio\" style=${_t(c)}>\n        <ha-card\n          id=\"card\"\n          class=${yt(f)}\n          style=${_t(o)}\n          @action=${this._handleAction}\n          @focus=\"${this.handleRippleFocus}\"\n          @blur=\"${this.handleRippleBlur}\"\n          @mousedown=\"${this.handleRippleActivate}\"\n          @mouseup=\"${this.handleRippleDeactivate}\"\n          @touchstart=\"${this.handleRippleActivate}\"\n          @touchend=\"${this.handleRippleDeactivate}\"\n          @touchcancel=\"${this.handleRippleDeactivate}\"\n          .actionHandler=${St({hasDoubleClick:\"none\"!==this._config.double_tap_action.action,hasHold:\"none\"!==this._config.hold_action.action,repeat:this._config.hold_action.repeat,repeatLimit:this._config.hold_action.repeat_limit})}\n          .config=\"${this._config}\"\n        >\n          ${this._buttonContent(this._stateObj,r,a)}\n          <mwc-ripple id=\"ripple\"></mwc-ripple>\n        </ha-card>\n        ${this._getLock(l)}\n      </div>\n      ${(null===(n=this._config)||void 0===n?void 0:n.tooltip)?P`\n            <span class=\"tooltiptext\" style=${_t(d)}>\n              ${this._getTemplateOrValue(this._stateObj,this._config.tooltip)}\n            </span>\n          `:\"\"}\n    `}_getLock(t){return this._config.lock&&this._getTemplateOrValue(this._stateObj,this._config.lock.enabled)?P`\n        <div\n          id=\"overlay\"\n          style=${_t(t)}\n          @action=${this._handleUnlockType}\n          .actionHandler=${St({hasDoubleClick:\"double_tap\"===this._config.lock.unlock,hasHold:\"hold\"===this._config.lock.unlock})}\n          .config=\"${this._config}\"\n        >\n          <ha-icon id=\"lock\" icon=\"mdi:lock-outline\"></ha-icon>\n        </div>\n      `:P``}_buttonContent(t,e,i){const n=this._buildName(t,e),r=(null==e?void 0:e.state_display)||this._config.state_display||void 0,s=this._config.show_state&&r?this._getTemplateOrValue(t,r):void 0,a=s||this._buildStateString(t),o=function(t,e){if(!t&&!e)return;let i;return i=e?t?`${t}: ${e}`:e:t,i}(n,a);switch(this._config.layout){case\"icon_name_state\":case\"name_state\":return this._gridHtml(t,e,this._config.layout,i,o,void 0);default:return this._gridHtml(t,e,this._config.layout,i,n,a)}}_unsafeHTMLorNot(t){return t.strings||t.values?t:bt(`${t}`)}_gridHtml(t,e,i,n,r,s){const a=this._getIconHtml(t,e,n),o=[i],l=this._buildLabel(t,e),c=this._buildStyleGeneric(t,e,\"name\"),h=this._buildStyleGeneric(t,e,\"state\"),u=this._buildStyleGeneric(t,e,\"label\"),d=this._buildLastChanged(t,u),f=this._buildStyleGeneric(t,e,\"grid\");return a||o.push(\"no-icon\"),r||o.push(\"no-name\"),s||o.push(\"no-state\"),l||d||o.push(\"no-label\"),P`\n      <div id=\"container\" class=${o.join(\" \")} style=${_t(f)}>\n        ${a||\"\"}\n        ${r?P`\n              <div id=\"name\" class=\"ellipsis\" style=${_t(c)}>\n                ${this._unsafeHTMLorNot(r)}\n              </div>\n            `:\"\"}\n        ${s?P`\n              <div id=\"state\" class=\"ellipsis\" style=${_t(h)}>\n                ${this._unsafeHTMLorNot(s)}\n              </div>\n            `:\"\"}\n        ${l&&!d?P`\n              <div id=\"label\" class=\"ellipsis\" style=${_t(u)}>\n                ${this._unsafeHTMLorNot(l)}\n              </div>\n            `:\"\"}\n        ${d||\"\"} ${this._buildCustomFields(t,e)}\n      </div>\n    `}_getIconHtml(t,e,i){const n=this._buildIcon(t,e),r=this._buildEntityPicture(t,e),s=this._buildStyleGeneric(t,e,\"entity_picture\"),a=this._buildStyleGeneric(t,e,\"icon\"),o=this._buildStyleGeneric(t,e,\"img_cell\"),l=this._buildStyleGeneric(t,e,\"card\"),c=Object.assign({color:i,width:this._config.size,\"--ha-icon-display\":l.height?\"inline\":void 0,position:this._config.aspect_ratio||l.height?\"absolute\":\"relative\"},a),h=Object.assign(Object.assign({},c),s),u=this._buildLiveStream(h),d=this._config.show_icon&&(n||t);if(d||r){let i;return t&&(i=ie(t.entity_id)),P`\n        <div id=\"img-cell\" style=${_t(o)}>\n          ${!d||r||u?\"\":P`\n                <ha-state-icon\n                  .state=${t}\n                  .stateObj=${t}\n                  .hass=${this._hass}\n                  ?data-domain=${i}\n                  data-state=${(t=>null!=t?t:L)(null==t?void 0:t.state)}\n                  style=${_t(c)}\n                  .icon=\"${n}\"\n                  id=\"icon\"\n                  ?rotating=${this._rotate(e)}\n                ></ha-state-icon>\n              `}\n          ${u||\"\"}\n          ${r&&!u?P`\n                <img\n                  src=\"${r}\"\n                  style=${_t(h)}\n                  id=\"icon\"\n                  ?rotating=${this._rotate(e)}\n                />\n              `:\"\"}\n        </div>\n      `}}_buildLiveStream(t){return this._config.show_live_stream&&this._config.entity&&\"camera\"===ie(this._config.entity)?P`\n        <hui-image\n          .hass=${this._hass}\n          .cameraImage=${this._config.entity}\n          .entity=${this._config.entity}\n          cameraView=\"live\"\n          style=${_t(t)}\n        ></hui-image>\n      `:void 0}_configFromLLTemplates(t,e){const i=e.template;if(!i)return e;let n,r={};const s=i&&Array.isArray(i)?i:[i];return null==s||s.forEach((e=>{var i,s;let a;if(null===(i=t.config.cblcars_card_templates)||void 0===i?void 0:i[e])a=t.config.cblcars_card_templates[e];else{if(!(null===(s=window.cblcars_card_templates)||void 0===s?void 0:s[e]))throw new Error(`LCARS Button-card template '${e}' is missing!`);a=window.cblcars_card_templates[e]}const o=this._configFromLLTemplates(t,a);r=re(r,o),n=se(n,o.state)})),r=re(r,e),r.state=se(n,e.state),r}setConfig(t){if(!t)throw new Error(\"Invalid configuration\");this._initialSetupComplete&&(this._initialSetupComplete=!1),this._cards={},this._cardsConfig={};const e=function(){let t=document.querySelector(\"home-assistant\");if(t=t&&t.shadowRoot,t=t&&t.querySelector(\"home-assistant-main\"),t=t&&t.shadowRoot,t=t&&t.querySelector(\"app-drawer-layout partial-panel-resolver, ha-drawer partial-panel-resolver\"),t=t&&t.shadowRoot||t,t=t&&t.querySelector(\"ha-panel-lovelace\"),t=t&&t.shadowRoot,t=t&&t.querySelector(\"hui-root\"),t){const e=t.lovelace;return e.current_view=t.___curView,e}return null}()||function(){let t=document.querySelector(\"hc-main\");if(t=t&&t.shadowRoot,t=t&&t.querySelector(\"hc-lovelace\"),t=t&&t.shadowRoot,t=t&&(t.querySelector(\"hui-view\")||t.querySelector(\"hui-panel-view\")),t){const e=t.lovelace;return e.current_view=t.___curView,e}return null}();let i=Ai(t);i=this._configFromLLTemplates(e,i),this._config=Object.assign(Object.assign({type:\"custom:cblcars-button-card\",group_expand:!1,hold_action:{action:\"none\"},double_tap_action:{action:\"none\"},layout:\"vertical\",size:\"40%\",color_type:\"icon\",show_name:!0,show_state:!1,show_icon:!0,show_units:!0,show_label:!1,show_entity_picture:!1,show_live_stream:!1,card_size:3},i),{lock:Object.assign({enabled:!1,duration:5,unlock:\"tap\"},i.lock)}),this._initialSetupComplete||this._finishSetup()}_loopGroup(t){t&&t.forEach((t=>{var e,i;(null===(e=this._hass)||void 0===e?void 0:e.states[t])&&((null===(i=this._hass.states[t].attributes)||void 0===i?void 0:i.entity_id)?this._loopGroup(this._hass.states[t].attributes.entity_id):this._entities.includes(t)||this._entities.push(t))}))}_expandTriggerGroups(){var t;this._hass&&(null===(t=this._config)||void 0===t?void 0:t.group_expand)&&this._entities&&this._entities.forEach((t=>{var e,i,n,r,s;(null===(n=null===(i=null===(e=this._hass)||void 0===e?void 0:e.states[t])||void 0===i?void 0:i.attributes)||void 0===n?void 0:n.entity_id)&&this._loopGroup(null===(s=null===(r=this._hass)||void 0===r?void 0:r.states[t].attributes)||void 0===s?void 0:s.entity_id)}))}getCardSize(){var t;return(null===(t=this._config)||void 0===t?void 0:t.card_size)||3}_evalActions(t,e){var i,n,r,s,a;const o=Ai(t),l=t=>t?(Object.keys(t).forEach((e=>{\"object\"==typeof t[e]?t[e]=l(t[e]):t[e]=this._getTemplateOrValue(this._stateObj,t[e])})),t):t;return\"entity\"===(null===(n=null===(i=o[e])||void 0===i?void 0:i.service_data)||void 0===n?void 0:n.entity_id)&&(o[e].service_data.entity_id=t.entity),\"entity\"===(null===(s=null===(r=o[e])||void 0===r?void 0:r.data)||void 0===s?void 0:s.entity_id)&&(o[e].data.entity_id=t.entity),o[e]=l(o[e]),!o[e].confirmation&&o.confirmation&&(o[e].confirmation=l(o.confirmation)),(null===(a=o[e])||void 0===a?void 0:a.entity)&&(o.entity=o[e].entity),o}handleRippleActivate(t){this._ripple.then((e=>e&&\"function\"==typeof e.startPress&&this._rippleHandlers.startPress(t)))}handleRippleDeactivate(){this._ripple.then((t=>t&&\"function\"==typeof t.endPress&&this._rippleHandlers.endPress()))}handleRippleFocus(){this._ripple.then((t=>t&&\"function\"==typeof t.startFocus&&this._rippleHandlers.startFocus()))}handleRippleBlur(){this._ripple.then((t=>t&&\"function\"==typeof t.endFocus&&this._rippleHandlers.endFocus()))}_handleAction(t){var e;if(null===(e=t.detail)||void 0===e?void 0:e.action)switch(t.detail.action){case\"tap\":case\"hold\":case\"double_tap\":const e=this._config;if(!e)return;const i=t.detail.action,n=this._evalActions(e,`${i}_action`);(async(t,e,i,n)=>{wt(t,\"hass-action\",{config:i,action:n})})(this,this._hass,n,i)}}_handleUnlockType(t){const e=this._config;e&&e.lock.unlock===t.detail.action&&this._handleLock()}_handleLock(){var t;const e=this.shadowRoot.getElementById(\"lock\");if(!e)return;if(this._config.lock.exemptions){if(!(null===(t=this._hass.user)||void 0===t?void 0:t.name)||!this._hass.user.id)return;let i=!1;if(this._config.lock.exemptions.forEach((t=>{var e,n;(!i&&t.user===(null===(e=this._hass.user)||void 0===e?void 0:e.id)||t.username===(null===(n=this._hass.user)||void 0===n?void 0:n.name))&&(i=!0)})),!i)return e.classList.add(\"invalid\"),void window.setTimeout((()=>{e&&e.classList.remove(\"invalid\")}),3e3)}const i=this.shadowRoot.getElementById(\"overlay\");if(i.style.setProperty(\"pointer-events\",\"none\"),e){const t=document.createAttribute(\"icon\");t.value=\"mdi:lock-open-outline\",e.attributes.setNamedItem(t),e.classList.add(\"hidden\")}window.setTimeout((()=>{if(i.style.setProperty(\"pointer-events\",\"\"),e){e.classList.remove(\"hidden\");const t=document.createAttribute(\"icon\");t.value=\"mdi:lock-outline\",e.attributes.setNamedItem(t)}}),1e3*this._config.lock.duration)}_stopPropagation(t){t.stopPropagation()}};t([at()],Ci.prototype,\"_hass\",void 0),t([at()],Ci.prototype,\"_config\",void 0),t([at()],Ci.prototype,\"_timeRemaining\",void 0),t([function(t){return ot({descriptor:e=>({async get(){var e;return await this.updateComplete,null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t)},enumerable:!0,configurable:!0})})}(\"mwc-ripple\")],Ci.prototype,\"_ripple\",void 0),t([lt({passive:!0})],Ci.prototype,\"handleRippleActivate\",null),t([lt({passive:!0})],Ci.prototype,\"handleRippleDeactivate\",null),t([lt({passive:!0})],Ci.prototype,\"handleRippleFocus\",null),t([lt({passive:!0})],Ci.prototype,\"handleRippleBlur\",null),t([lt({passive:!0})],Ci.prototype,\"_handleAction\",null),t([lt({passive:!0})],Ci.prototype,\"_handleUnlockType\",null),t([lt({passive:!0})],Ci.prototype,\"_handleLock\",null),t([lt({passive:!0})],Ci.prototype,\"_stopPropagation\",null),Ci=t([(t=>e=>\"function\"==typeof e?((t,e)=>(customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:i,elements:n}=e;return{kind:i,elements:n,finisher(e){customElements.define(t,e)}}})(t,e))(\"cblcars-button-card\")],Ci);export{Ci as ButtonCard};\n","// Extract anchor points from SVG content\n\nexport function findSvgAnchors(svgContent) {\n  const anchors = {};\n  // Improved <circle> extraction: match cx/cy in any order\n  const circleRegex = /<circle[^>]*id=\"([^\"]+)\"[^>]*>/g;\n  let m;\n  while ((m = circleRegex.exec(svgContent)) !== null) {\n    const id = m[1];\n    const tag = m[0];\n    const cxMatch = tag.match(/\\scx=\"([^\"]+)\"/);\n    const cyMatch = tag.match(/\\scy=\"([^\"]+)\"/);\n    if (cxMatch && cyMatch) {\n      anchors[id] = [parseFloat(cxMatch[1]), parseFloat(cyMatch[1])];\n    }\n  }\n\n  // Improved <text> extraction: match x/y in any order\n  const textRegex = /<text[^>]*id=\"([^\"]+)\"[^>]*>/g;\n  while ((m = textRegex.exec(svgContent)) !== null) {\n    const id = m[1];\n    // Extract x and y attributes from the tag\n    const tag = m[0];\n    const xMatch = tag.match(/\\sx=\"([^\"]+)\"/);\n    const yMatch = tag.match(/\\sy=\"([^\"]+)\"/);\n    if (xMatch && yMatch) {\n      anchors[id] = [parseFloat(xMatch[1]), parseFloat(yMatch[1])];\n    }\n  }\n  // <g id=\"anchor\">\n  const groupRegex = /<g[^>]*id=\"([^\"]+)\"[^>]*>/g;\n  while ((m = groupRegex.exec(svgContent)) !== null) {\n    anchors[m[1]] = null; // Optionally: calculate centroid if needed\n  }\n  return anchors;\n}\n\nexport function getSvgContent(base_svg) {\n  let svgKey = null;\n  if (base_svg && base_svg.startsWith('builtin:')) {\n    svgKey = base_svg.replace('builtin:', '');\n  } else if (base_svg && base_svg.startsWith('/local/')) {\n    svgKey = base_svg.split('/').pop().replace('.svg','');\n  }\n  return svgKey && window.cblcars?.msd?.svg_templates?.[svgKey];\n}\n\nexport function getSvgViewBox(svgContent) {\n  const match = svgContent && svgContent.match(/viewBox=\"([0-9.\\-]+)\\s+([0-9.\\-]+)\\s+([0-9.\\-]+)\\s+([0-9.\\-]+)\"/);\n  if (match) {\n    return [parseFloat(match[1]), parseFloat(match[2]), parseFloat(match[3]), parseFloat(match[4])];\n  }\n  return [0, 0, 400, 200];\n}\n\nexport function getSvgAspectRatio(viewBox) {\n  return viewBox[2] && viewBox[3] ? (viewBox[2] / viewBox[3]) : 2;\n}\n\n\n","/**\n * Canonical checksum generation for MSD configurations\n * Uses Web Crypto API for browser compatibility\n */\n\nexport async function computeCanonicalChecksum(obj) {\n  const cleaned = stripMetaFields(obj);\n  const stable = stableStringify(cleaned);\n\n  // Check if we're in a secure context (HTTPS or localhost)\n  if (typeof crypto !== 'undefined' && crypto.subtle) {\n    // Use Web Crypto API (available in browsers and Node 16+)\n    const encoder = new TextEncoder();\n    const data = encoder.encode(stable);\n    const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n    const hashArray = new Uint8Array(hashBuffer);\n    const hashHex = Array.from(hashArray)\n      .map(b => b.toString(16).padStart(2, '0'))\n      .join('');\n\n    // Return first 10 characters for readability\n    return hashHex.substring(0, 10);\n  } else {\n    // Fallback for non-secure contexts (HTTP)\n    return simpleHash(stable).substring(0, 10);\n  }\n}\n\nfunction stripMetaFields(obj) {\n  if (obj === null || typeof obj !== 'object') {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    return obj.map(stripMetaFields);\n  }\n\n  const cleaned = {};\n\n  for (const [key, value] of Object.entries(obj)) {\n    // Skip metadata fields that don't affect semantic meaning\n    if (key.startsWith('__') ||\n        key === 'checksum' ||\n        key === 'origin_pack' ||\n        key === 'timestamp') {\n      continue;\n    }\n\n    cleaned[key] = stripMetaFields(value);\n  }\n\n  return cleaned;\n}\n\nfunction stableStringify(obj) {\n  if (obj === null || typeof obj !== 'object') {\n    return JSON.stringify(obj);\n  }\n\n  if (Array.isArray(obj)) {\n    const items = obj.map(stableStringify);\n    return `[${items.join(',')}]`;\n  }\n\n  // Sort object keys for deterministic output\n  const sortedKeys = Object.keys(obj).sort();\n  const pairs = sortedKeys.map(key => {\n    const value = stableStringify(obj[key]);\n    return `\"${key}\":${value}`;\n  });\n\n  return `{${pairs.join(',')}}`;\n}\n\n// Simple hash function for non-secure contexts\nfunction simpleHash(str) {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // Convert to 32-bit integer\n  }\n  return Math.abs(hash).toString(16);\n}\n\n/**\n * Compare two objects for semantic equality (ignoring metadata)\n */\nexport function semanticEquals(obj1, obj2) {\n  const clean1 = stripMetaFields(obj1);\n  const clean2 = stripMetaFields(obj2);\n  return stableStringify(clean1) === stableStringify(clean2);\n}\n","/**\n * Performance tracking and instrumentation for MSD pipeline\n * Provides detailed timing and counter metrics for optimization\n */\n\nclass PerformanceTracker {\n  constructor() {\n    this.counters = new Map();\n    this.timings = new Map();\n    this.sessionStart = performance.now();\n  }\n\n  /**\n   * Add timing measurement\n   */\n  addTiming(key, ms, metadata = {}) {\n    if (!this.timings.has(key)) {\n      this.timings.set(key, {\n        last: 0,\n        totalMs: 0,\n        samples: 0,\n        avg: 0,\n        min: Infinity,\n        max: 0,\n        metadata: []\n      });\n    }\n\n    const timing = this.timings.get(key);\n    timing.last = ms;\n    timing.totalMs += ms;\n    timing.samples++;\n    timing.avg = timing.totalMs / timing.samples;\n    timing.min = Math.min(timing.min, ms);\n    timing.max = Math.max(timing.max, ms);\n\n    if (Object.keys(metadata).length > 0) {\n      timing.metadata.push({ ...metadata, ms, timestamp: Date.now() });\n      // Keep only last 10 metadata entries\n      if (timing.metadata.length > 10) {\n        timing.metadata = timing.metadata.slice(-10);\n      }\n    }\n  }\n\n  /**\n   * Add discrete counter\n   */\n  addCount(key, increment = 1, metadata = {}) {\n    if (!this.counters.has(key)) {\n      this.counters.set(key, {\n        count: 0,\n        rate: 0,\n        lastUpdate: performance.now(),\n        metadata: []\n      });\n    }\n\n    const counter = this.counters.get(key);\n    const now = performance.now();\n    const deltaTime = (now - counter.lastUpdate) / 1000; // seconds\n\n    counter.count += increment;\n    counter.rate = deltaTime > 0 ? increment / deltaTime : 0;\n    counter.lastUpdate = now;\n\n    if (Object.keys(metadata).length > 0) {\n      counter.metadata.push({ ...metadata, increment, timestamp: Date.now() });\n      // Keep only last 10 metadata entries\n      if (counter.metadata.length > 10) {\n        counter.metadata = counter.metadata.slice(-10);\n      }\n    }\n  }\n\n  /**\n   * Time a function execution\n   */\n  async timeAsync(key, fn, metadata = {}) {\n    const start = performance.now();\n    try {\n      const result = await fn();\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, metadata);\n      return result;\n    } catch (error) {\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, { ...metadata, error: error.message });\n      throw error;\n    }\n  }\n\n  /**\n   * Time a synchronous function execution\n   */\n  timeSync(key, fn, metadata = {}) {\n    const start = performance.now();\n    try {\n      const result = fn();\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, metadata);\n      return result;\n    } catch (error) {\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, { ...metadata, error: error.message });\n      throw error;\n    }\n  }\n\n  /**\n   * Get all performance data\n   */\n  getAll() {\n    const sessionDuration = performance.now() - this.sessionStart;\n\n    return {\n      session: {\n        duration_ms: sessionDuration,\n        started_at: Date.now() - sessionDuration\n      },\n      timings: Object.fromEntries(this.timings),\n      counters: Object.fromEntries(this.counters),\n      summary: this.getSummary()\n    };\n  }\n\n  /**\n   * Get performance summary for quick overview\n   */\n  getSummary() {\n    const criticalTimings = ['merge.total', 'validation.total', 'render.total'];\n    const criticalCounters = ['rules.eval.count', 'rules.match.count', 'animation.instance.reuse'];\n\n    const summary = {\n      timings: {},\n      counters: {},\n      health: 'good'\n    };\n\n    // Extract critical timing data\n    criticalTimings.forEach(key => {\n      if (this.timings.has(key)) {\n        const timing = this.timings.get(key);\n        summary.timings[key] = {\n          avg: timing.avg,\n          last: timing.last,\n          samples: timing.samples\n        };\n\n        // Health check: mark as warning if average is high\n        if (timing.avg > 50) { // 50ms threshold\n          summary.health = 'warning';\n        }\n        if (timing.avg > 100) { // 100ms threshold\n          summary.health = 'critical';\n        }\n      }\n    });\n\n    // Extract critical counter data\n    criticalCounters.forEach(key => {\n      if (this.counters.has(key)) {\n        const counter = this.counters.get(key);\n        summary.counters[key] = {\n          count: counter.count,\n          rate: counter.rate\n        };\n      }\n    });\n\n    return summary;\n  }\n\n  /**\n   * Reset all performance data\n   */\n  reset() {\n    this.counters.clear();\n    this.timings.clear();\n    this.sessionStart = performance.now();\n  }\n\n  /**\n   * Export performance data for analysis\n   */\n  export(options = {}) {\n    const data = this.getAll();\n\n    if (options.format === 'csv') {\n      return this.exportToCsv(data);\n    }\n\n    if (options.minify) {\n      return this.minifyData(data);\n    }\n\n    return data;\n  }\n\n  minifyData(data) {\n    // Remove metadata and keep only essential metrics\n    const minified = {\n      session: data.session,\n      timings: {},\n      counters: {},\n      summary: data.summary\n    };\n\n    for (const [key, timing] of Object.entries(data.timings)) {\n      minified.timings[key] = {\n        avg: timing.avg,\n        last: timing.last,\n        samples: timing.samples,\n        min: timing.min,\n        max: timing.max\n      };\n    }\n\n    for (const [key, counter] of Object.entries(data.counters)) {\n      minified.counters[key] = {\n        count: counter.count,\n        rate: counter.rate\n      };\n    }\n\n    return minified;\n  }\n}\n\n// Global instance\nconst globalPerfTracker = new PerformanceTracker();\n\n// Utility functions for common operations\nexport function perfTime(key, fn, metadata = {}) {\n  if (typeof fn === 'function') {\n    return globalPerfTracker.timeSync(key, fn, metadata);\n  }\n  // Return timing function for manual timing\n  return {\n    end: (metadata = {}) => {\n      const duration = performance.now() - perfTime.start;\n      globalPerfTracker.addTiming(key, duration, metadata);\n    }\n  };\n}\n\nexport async function perfTimeAsync(key, fn, metadata = {}) {\n  return globalPerfTracker.timeAsync(key, fn, metadata);\n}\n\nexport function perfCount(key, increment = 1, metadata = {}) {\n  globalPerfTracker.addCount(key, increment, metadata);\n}\n\nexport function perfGetAll() {\n  return globalPerfTracker.getAll();\n}\n\nexport function perfGetSummary() {\n  return globalPerfTracker.getSummary();\n}\n\nexport function perfReset() {\n  globalPerfTracker.reset();\n}\n\nexport function perfExport(options = {}) {\n  return globalPerfTracker.export(options);\n}\n\n// Node.js and browser compatibility\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdPerf = {\n    getAll: perfGetAll,\n    getSummary: perfGetSummary,\n    reset: perfReset,\n    export: perfExport\n  };\n}\n","import { computeCanonicalChecksum } from '../util/checksum.js';\nimport { perfTime, perfTimeAsync, perfCount } from '../util/performance.js';\n\n/**\n * Single consolidated merge algorithm - COMPLETE REPLACEMENT\n * Removes all legacy dual merge logic per Milestone 1.1\n */\nexport async function mergePacks(userConfig) {\n  return await perfTimeAsync('merge.total', async () => {\n    const layers = await perfTimeAsync('merge.loadLayers', () => loadAllLayers(userConfig));\n    const merged = await perfTimeAsync('merge.processSingle', () => processSinglePass(layers));\n\n    return merged;\n  }, {\n    config_overlays: userConfig.overlays?.length || 0,\n    config_rules: userConfig.rules?.length || 0,\n    config_anchors: Object.keys(userConfig.anchors || {}).length,\n    use_packs: userConfig.use_packs?.builtin?.length || 0\n  });\n}\n\nasync function loadAllLayers(userConfig) {\n  const layers = [];\n\n  // Load builtin packs first\n  const builtinPacks = userConfig.use_packs?.builtin || ['core'];\n  for (const packName of builtinPacks) {\n    const pack = await loadBuiltinPack(packName);\n    if (pack) {\n      layers.push({\n        type: 'builtin',\n        pack: packName,\n        data: pack,\n        priority: 100\n      });\n    }\n  }\n\n  // Load external packs with timeout\n  if (userConfig.use_packs?.external?.length > 0) {\n    const externalResults = await loadExternalPacks(userConfig.use_packs.external);\n    externalResults.forEach((result, index) => {\n      if (result.data && !result.error) {\n        layers.push({\n          type: 'external',\n          pack: result.url,\n          data: result.data,\n          priority: 200 + index\n        });\n      }\n    });\n  }\n\n  // User config layer (highest priority)\n  layers.push({\n    type: 'user',\n    pack: 'user_config',\n    data: userConfig,\n    priority: 1000\n  });\n\n  return layers.sort((a, b) => a.priority - b.priority);\n}\n\nasync function processSinglePass(layers) {\n  const merged = {\n    version: 1,\n    anchors: {},\n    palettes: {},\n    profiles: [],\n    overlays: [],\n    rules: [],\n    animations: [],\n    timelines: [],\n    routing: {},\n    data_sources: {},\n    active_profiles: ['normal'],\n    __provenance: {\n      anchors: {},\n      palettes: {},\n      overlays: {},\n      rules: {},\n      animations: {},\n      merge_order: []\n    }\n  };\n\n  // Process each layer in priority order\n  for (const layer of layers) {\n    perfTime('merge.processLayer', () => processLayer(merged, layer), {\n      layer: layer.pack,\n      type: layer.type\n    });\n\n    merged.__provenance.merge_order.push({\n      type: layer.type,\n      pack: layer.pack,\n      priority: layer.priority\n    });\n  }\n\n  // Apply removals after all merges\n  perfTime('merge.applyRemovals', () => applyRemovals(merged, layers[layers.length - 1]?.data?.remove));\n\n  // Generate canonical checksum\n  merged.checksum = await perfTimeAsync('merge.checksum', () => computeCanonicalChecksum(merged));\n\n  return merged;\n}\n\nasync function loadBuiltinPack(packName) {\n  // Try debug packs first (for development)\n  try {\n    const dbgPacks = window.__msdDebug?.packs;\n    if (dbgPacks) {\n      const dbgSource = packName === 'core'\n        ? dbgPacks.core\n        : dbgPacks.builtin?.[packName];\n\n      if (dbgSource && typeof dbgSource === 'object') {\n        return dbgSource;\n      }\n    }\n  } catch (e) {\n    // Fallback to normal loading\n  }\n\n  // Normal builtin pack loading would go here\n  // For now, return minimal core pack with simulated SVG anchors\n  if (packName === 'core') {\n    return {\n      version: 1,\n      // Simulate SVG-extracted anchors\n      anchors: {\n        svg_bridge: [200, 150],  // Simulated SVG extraction\n        svg_warp: [350, 200],    // Simulated SVG extraction\n      },\n      _extracted_anchors: ['svg_bridge', 'svg_warp'], // Mark as SVG-extracted\n      profiles: [\n        {\n          id: 'normal',\n          defaults: {\n            line: { color: 'var(--lcars-orange)', width: 2 },\n            text: { color: 'var(--lcars-orange)', font_size: 14 }\n          }\n        }\n      ],\n      palettes: {\n        default: {\n          accent1: 'var(--lcars-orange)',\n          accent2: 'var(--lcars-yellow)',\n          danger: 'var(--lcars-red)',\n          info: 'var(--lcars-cyan)'\n        }\n      }\n    };\n  }\n\n  return null;\n}\n\nasync function loadExternalPacks(urls, options = {}) {\n  const {\n    timeout = 5000,\n    retries = 2,\n    retryDelay = 1000,\n    enableCaching = true\n  } = options;\n\n  const results = [];\n  const perfTracker = {\n    total_packs: urls.length,\n    successful: 0,\n    failed: 0,\n    retried: 0,\n    cached_hits: 0,\n    total_time_ms: 0\n  };\n\n  const startTime = performance.now();\n\n  for (let i = 0; i < urls.length; i++) {\n    const url = urls[i];\n    const packResult = await loadSingleExternalPack(url, {\n      timeout,\n      retries,\n      retryDelay,\n      enableCaching,\n      index: i\n    });\n\n    results.push(packResult);\n\n    // Update performance tracking\n    if (packResult.error) {\n      perfTracker.failed++;\n    } else {\n      perfTracker.successful++;\n    }\n\n    if (packResult.retryCount > 0) {\n      perfTracker.retried++;\n    }\n\n    if (packResult.cached) {\n      perfTracker.cached_hits++;\n    }\n  }\n\n  perfTracker.total_time_ms = performance.now() - startTime;\n\n  // Store performance data for debugging - Node.js compatible\n  try {\n    const debugNamespace = (typeof window !== 'undefined') ? window : global;\n    debugNamespace.__msdDebug = debugNamespace.__msdDebug || {};\n    debugNamespace.__msdDebug._lastExternalPackPerf = perfTracker;\n  } catch (e) {}\n\n  return results;\n}\n\nasync function loadSingleExternalPack(url, options) {\n  const { timeout, retries, retryDelay, enableCaching, index } = options;\n\n  // Check cache first\n  if (enableCaching && externalPackCache.has(url)) {\n    const cached = externalPackCache.get(url);\n    if (Date.now() - cached.timestamp < 300000) { // 5 minute cache\n      return {\n        url,\n        data: cached.data,\n        error: cached.error,\n        cached: true,\n        loadTime: 0,\n        retryCount: 0,\n        index\n      };\n    }\n  }\n\n  let lastError = null;\n  let retryCount = 0;\n\n  for (let attempt = 0; attempt <= retries; attempt++) {\n    const attemptStart = performance.now();\n\n    try {\n      const result = await Promise.race([\n        fetchWithValidation(url),\n        createTimeoutPromise(timeout, url)\n      ]);\n\n      const loadTime = performance.now() - attemptStart;\n\n      // Cache successful result\n      if (enableCaching) {\n        externalPackCache.set(url, {\n          data: result.data,\n          error: null,\n          timestamp: Date.now()\n        });\n      }\n\n      return {\n        url,\n        data: result.data,\n        error: null,\n        cached: false,\n        loadTime,\n        retryCount,\n        index,\n        contentType: result.contentType,\n        size: result.size\n      };\n\n    } catch (error) {\n      lastError = error;\n      retryCount = attempt;\n\n      // Don't retry on certain error types\n      if (error.name === 'ValidationError' ||\n          error.name === 'SyntaxError' ||\n          error.message.includes('404')) {\n        break;\n      }\n\n      // Wait before retry\n      if (attempt < retries) {\n        await new Promise(resolve => setTimeout(resolve, retryDelay * (attempt + 1)));\n      }\n    }\n  }\n\n  // Cache failed result to avoid repeated failures\n  if (enableCaching) {\n    externalPackCache.set(url, {\n      data: null,\n      error: lastError.message,\n      timestamp: Date.now()\n    });\n  }\n\n  return {\n    url,\n    data: null,\n    error: lastError?.message || 'Unknown error',\n    errorType: classifyError(lastError),\n    cached: false,\n    loadTime: 0,\n    retryCount,\n    index\n  };\n}\n\nasync function fetchWithValidation(url) {\n  // Validate URL format\n  try {\n    new URL(url);\n  } catch (e) {\n    const error = new Error(`Invalid URL format: ${url}`);\n    error.name = 'ValidationError';\n    throw error;\n  }\n\n  // Perform fetch\n  const response = await fetch(url);\n\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status}: ${response.statusText} for ${url}`);\n  }\n\n  // Validate content type\n  const contentType = response.headers.get('content-type') || '';\n  if (!contentType.includes('application/json') && !contentType.includes('text/')) {\n    console.warn(`[MSD] External pack ${url} has unexpected content-type: ${contentType}`);\n  }\n\n  // Parse JSON with size limits\n  const text = await response.text();\n  if (text.length > 1024 * 1024) { // 1MB limit\n    throw new Error(`External pack ${url} too large: ${text.length} bytes (max 1MB)`);\n  }\n\n  let data;\n  try {\n    data = JSON.parse(text);\n  } catch (e) {\n    const error = new Error(`Invalid JSON in external pack ${url}: ${e.message}`);\n    error.name = 'SyntaxError';\n    throw error;\n  }\n\n  // Basic MSD structure validation\n  if (data && typeof data === 'object') {\n    validateExternalPackStructure(data, url);\n  }\n\n  return {\n    data,\n    contentType,\n    size: text.length\n  };\n}\n\nfunction createTimeoutPromise(timeout, url) {\n  return new Promise((_, reject) => {\n    setTimeout(() => {\n      const error = new Error(`Timeout loading external pack: ${url} (${timeout}ms)`);\n      error.name = 'TimeoutError';\n      reject(error);\n    }, timeout);\n  });\n}\n\nfunction validateExternalPackStructure(data, url) {\n  // Basic validation - ensure it looks like an MSD pack\n  const validFields = ['version', 'anchors', 'overlays', 'rules', 'animations', 'profiles', 'palettes', 'timelines'];\n  const dataFields = Object.keys(data);\n  const hasValidField = validFields.some(field => dataFields.includes(field));\n\n  if (!hasValidField) {\n    console.warn(`[MSD] External pack ${url} doesn't contain recognized MSD fields`);\n  }\n\n  // Check for required ID fields in collections\n  const collections = ['overlays', 'rules', 'animations', 'profiles'];\n  collections.forEach(collection => {\n    if (Array.isArray(data[collection])) {\n      data[collection].forEach((item, index) => {\n        if (!item.id) {\n          console.warn(`[MSD] External pack ${url} ${collection}[${index}] missing required 'id' field`);\n        }\n      });\n    }\n  });\n}\n\nfunction classifyError(error) {\n  if (!error) return 'unknown';\n\n  if (error.name === 'TimeoutError') return 'timeout';\n  if (error.name === 'ValidationError') return 'validation';\n  if (error.name === 'SyntaxError') return 'syntax';\n  if (error.message.includes('404')) return 'not_found';\n  if (error.message.includes('403')) return 'forbidden';\n  if (error.message.includes('network')) return 'network';\n\n  return 'unknown';\n}\n\n// Simple cache for external packs\nconst externalPackCache = new Map();\n\n// Export for testing\nexport { externalPackCache };\n\nasync function processLayer(merged, layer) {\n  const collections = ['overlays', 'rules', 'animations', 'profiles', 'timelines'];\n\n  // Process collections with ID-based merging\n  for (const collection of collections) {\n    if (layer.data[collection] && Array.isArray(layer.data[collection])) {\n      perfTime(`merge.collection.${collection}`, () => {\n        // Initialize provenance collection if missing\n        if (!merged.__provenance[collection]) {\n          merged.__provenance[collection] = {};\n        }\n\n        for (const item of layer.data[collection]) {\n          if (!item.id) continue;\n\n          // Handle inline removal\n          if (item.remove === true) {\n            const index = merged[collection].findIndex(existing => existing.id === item.id);\n            if (index >= 0) {\n              merged[collection].splice(index, 1);\n              merged.__provenance[collection][item.id] = {\n                ...(merged.__provenance[collection][item.id] || {}),\n                removed: true,\n                removal_source: layer.pack\n              };\n            }\n            continue;\n          }\n\n          // Normal merge\n          const existingIndex = merged[collection].findIndex(existing => existing.id === item.id);\n          const cloned = structuredClone(item);\n          delete cloned.remove;\n\n          if (existingIndex >= 0) {\n            // Override existing\n            merged[collection][existingIndex] = cloned;\n            merged.__provenance[collection][item.id] = {\n              origin_pack: merged.__provenance[collection][item.id]?.origin_pack || layer.pack,\n              overridden: true,\n              override_layer: layer.pack\n            };\n          } else {\n            // Add new\n            merged[collection].push(cloned);\n            merged.__provenance[collection][item.id] = {\n              origin_pack: layer.pack,\n              overridden: false\n            };\n          }\n        }\n\n        // Track items processed\n        perfCount(`merge.items.${collection}`, layer.data[collection].length);\n      });\n    }\n  }\n\n  // Enhanced token-level palette merging\n  if (layer.data.palettes) {\n    perfTime('merge.palettes', () => {\n      merged.palettes = merged.palettes || {};\n      // Initialize palette provenance if missing\n      if (!merged.__provenance.palettes) {\n        merged.__provenance.palettes = {};\n      }\n\n      for (const [paletteName, tokens] of Object.entries(layer.data.palettes)) {\n        if (typeof tokens === 'object' && !Array.isArray(tokens)) {\n          // Initialize palette if it doesn't exist\n          if (!merged.palettes[paletteName]) {\n            merged.palettes[paletteName] = {};\n            merged.__provenance.palettes[paletteName] = {\n              origin_pack: layer.pack,\n              tokens: {},\n              overridden: false\n            };\n          }\n\n          // Initialize token-level provenance tracking for this palette\n          if (!merged.__provenance.palettes[paletteName].tokens) {\n            merged.__provenance.palettes[paletteName].tokens = {};\n          }\n\n          // Process each token individually\n          for (const [tokenName, value] of Object.entries(tokens)) {\n            const tokenExisted = merged.palettes[paletteName][tokenName] !== undefined;\n            const previousValue = merged.palettes[paletteName][tokenName];\n\n            // Set the token value\n            merged.palettes[paletteName][tokenName] = value;\n\n            // Track token-level provenance\n            if (tokenExisted) {\n              // Token is being overridden\n              merged.__provenance.palettes[paletteName].tokens[tokenName] = {\n                origin_pack: merged.__provenance.palettes[paletteName].tokens[tokenName]?.origin_pack || 'unknown',\n                current_value: value,\n                previous_value: previousValue,\n                overridden: true,\n                override_pack: layer.pack,\n                override_history: [\n                  ...(merged.__provenance.palettes[paletteName].tokens[tokenName]?.override_history || []),\n                  {\n                    pack: layer.pack,\n                    value: value,\n                    timestamp: Date.now()\n                  }\n                ]\n              };\n            } else {\n              // New token\n              merged.__provenance.palettes[paletteName].tokens[tokenName] = {\n                origin_pack: layer.pack,\n                current_value: value,\n                overridden: false,\n                override_history: []\n              };\n            }\n          }\n\n          // Update palette-level provenance\n          if (merged.__provenance.palettes[paletteName].origin_pack !== layer.pack) {\n            merged.__provenance.palettes[paletteName].overridden = true;\n            merged.__provenance.palettes[paletteName].last_modified_by = layer.pack;\n          }\n        }\n      }\n\n      // Count processed palettes and tokens\n      let tokenCount = 0;\n      Object.values(layer.data.palettes).forEach(tokens => {\n        if (typeof tokens === 'object' && !Array.isArray(tokens)) {\n          tokenCount += Object.keys(tokens).length;\n        }\n      });\n\n      perfCount('merge.palette.tokens', tokenCount);\n      perfCount('merge.palettes', Object.keys(layer.data.palettes).length);\n    });\n  }\n\n  // Enhanced anchor processing with comprehensive provenance\n  if (layer.data.anchors) {\n    perfTime('merge.anchors', () => {\n      for (const [anchorId, coordinates] of Object.entries(layer.data.anchors)) {\n        const existed = anchorId in merged.anchors;\n        const previousCoordinates = merged.anchors[anchorId];\n\n        // Set the anchor coordinates\n        merged.anchors[anchorId] = coordinates;\n\n        // Determine origin type for this layer\n        const originType = determineAnchorOriginType(layer, anchorId);\n\n        if (existed) {\n          // Anchor is being overridden\n          const existingProvenance = merged.__provenance.anchors[anchorId];\n\n          merged.__provenance.anchors[anchorId] = {\n            origin_pack: existingProvenance?.origin_pack || 'unknown',\n            origin_type: existingProvenance?.origin_type || 'unknown',\n            coordinates: coordinates,\n            overridden: true,\n            override_source: layer.pack,\n            override_type: originType,\n            previous_coordinates: previousCoordinates,\n            override_history: [\n              ...(existingProvenance?.override_history || []),\n              {\n                pack: layer.pack,\n                type: originType,\n                coordinates: coordinates,\n                previous_coordinates: previousCoordinates,\n                timestamp: Date.now()\n              }\n            ]\n          };\n        } else {\n          // New anchor\n          merged.__provenance.anchors[anchorId] = {\n            origin_pack: layer.pack,\n            origin_type: originType,\n            coordinates: coordinates,\n            overridden: false,\n            override_history: []\n          };\n        }\n      }\n\n      perfCount('merge.anchors', Object.keys(layer.data.anchors).length);\n    });\n  }\n\n  // Process other top-level properties\n  if (layer.data.routing) {\n    merged.routing = { ...merged.routing, ...layer.data.routing };\n  }\n\n  if (layer.data.data_sources) {\n    merged.data_sources = { ...merged.data_sources, ...layer.data.data_sources };\n  }\n\n  // Process debug configuration\n  if (layer.data.debug) {\n    merged.debug = { ...merged.debug, ...layer.data.debug };\n\n    // Track debug config provenance\n    if (!merged.__provenance.debug) {\n      merged.__provenance.debug = {\n        origin_pack: layer.pack,\n        overridden: false\n      };\n    } else {\n      merged.__provenance.debug.overridden = true;\n      merged.__provenance.debug.override_layer = layer.pack;\n    }\n  }\n\n  if (Array.isArray(layer.data.active_profiles)) {\n    merged.active_profiles = [...layer.data.active_profiles];\n  }\n}\n\nfunction determineAnchorOriginType(layer, anchorId) {\n  // Determine the origin type based on layer characteristics\n  if (layer.type === 'builtin' || layer.type === 'external') {\n    // For builtin/external packs, check if this looks like an SVG-extracted anchor\n    if (layer.data._extracted_anchors && layer.data._extracted_anchors.includes(anchorId)) {\n      return 'svg';\n    }\n    return 'pack';\n  }\n\n  if (layer.type === 'user') {\n    // User-defined anchors\n    return 'user';\n  }\n\n  return 'unknown';\n}\n\nfunction applyRemovals(merged, removals) {\n  if (!removals || typeof removals !== 'object') return;\n\n  const collections = ['overlays', 'rules', 'animations', 'profiles', 'timelines'];\n\n  for (const collection of collections) {\n    const removeIds = removals[collection];\n    if (Array.isArray(removeIds)) {\n      for (const removeId of removeIds) {\n        const index = merged[collection].findIndex(item => item.id === removeId);\n        if (index >= 0) {\n          merged[collection].splice(index, 1);\n          merged.__provenance[collection][removeId] = {\n            ...(merged.__provenance[collection][removeId] || {}),\n            removed: true,\n            removal_source: 'global'\n          };\n        }\n      }\n    }\n  }\n}\n\n/**\n * Export collapsed user configuration\n */\nexport function exportCollapsed(userMsd) {\n  const out = {};\n  const keep = [\n    'version', 'use_packs', 'anchors', 'overlays', 'animations',\n    'rules', 'profiles', 'timelines', 'palettes', 'routing',\n    'active_profiles', 'remove', 'debug'\n  ];\n\n  keep.forEach(k => {\n    if (userMsd && userMsd[k] !== undefined) {\n      out[k] = userMsd[k];\n    }\n  });\n\n  return out;\n}\n\n// Attach debug helpers\ntry {\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.packs = window.__msdDebug.packs || {};\n    window.__msdDebug.packs.mergePacks = mergePacks;\n    window.__msdDebug.exportCollapsed = () => exportCollapsed(window.__msdDebug._hudUserMsdConfig || {});\n  }\n} catch (e) {\n  // Ignore in Node.js environments\n}\n","/**\n * MSD Configuration Validation - Following Ratified Schema V1\n * Validates merged configuration against schema requirements\n */\n\nexport function validateMerged(config) {\n  const issues = {\n    errors: [],\n    warnings: []\n  };\n\n  if (!config || typeof config !== 'object') {\n    issues.errors.push({\n      code: 'config.invalid',\n      message: 'Configuration must be an object'\n    });\n    return issues;\n  }\n\n  // Core validation functions\n  validateStructure(config, issues);\n  validateAnchors(config, issues);\n  validateOverlays(config, issues);\n  validateRules(config, issues);\n  validateAnimations(config, issues);\n  validateProfiles(config, issues);\n  validatePalettes(config, issues);\n  validateRouting(config, issues);\n  validateDuplicateIds(config, issues);\n\n  return issues;\n}\n\nfunction validateStructure(config, issues) {\n  // Version validation\n  if (!config.version) {\n    issues.warnings.push({\n      code: 'version.missing',\n      message: 'Missing version field - assuming version 1'\n    });\n  } else if (typeof config.version !== 'number' || config.version !== 1) {\n    issues.errors.push({\n      code: 'version.invalid',\n      message: 'Version must be 1 (only supported version)'\n    });\n  }\n\n  // View box validation\n  if (config.view_box !== undefined) {\n    const vb = config.view_box;\n    if (vb !== 'auto' && (!Array.isArray(vb) || vb.length !== 4 || !vb.every(n => typeof n === 'number'))) {\n      issues.errors.push({\n        code: 'view_box.invalid',\n        message: 'view_box must be \"auto\" or array of 4 numbers [x, y, width, height]'\n      });\n    }\n  }\n}\n\nfunction validateAnchors(config, issues) {\n  if (!config.anchors) return;\n\n  Object.entries(config.anchors).forEach(([anchorId, coordinates]) => {\n    if (!Array.isArray(coordinates) || coordinates.length !== 2) {\n      issues.errors.push({\n        code: 'anchor.coordinates.invalid',\n        anchor_id: anchorId,\n        message: `Anchor '${anchorId}' coordinates must be array of 2 elements [x, y]`\n      });\n      return;\n    }\n\n    coordinates.forEach((coord, index) => {\n      const axis = index === 0 ? 'x' : 'y';\n      if (typeof coord === 'string') {\n        // Percentage validation\n        if (!coord.endsWith('%') || isNaN(parseFloat(coord.slice(0, -1)))) {\n          issues.errors.push({\n            code: 'anchor.coordinates.invalid',\n            anchor_id: anchorId,\n            message: `Anchor '${anchorId}' ${axis}-coordinate '${coord}' must be number or percentage string`\n          });\n        }\n      } else if (typeof coord !== 'number') {\n        issues.errors.push({\n          code: 'anchor.coordinates.invalid',\n          anchor_id: anchorId,\n          message: `Anchor '${anchorId}' ${axis}-coordinate must be number or percentage string`\n        });\n      }\n    });\n  });\n}\n\nfunction validateOverlays(config, issues) {\n  if (!config.overlays) return;\n\n  const anchors = new Set(Object.keys(config.anchors || {}));\n\n  // Add overlay IDs as \"virtual anchors\" - any overlay can be an attachment target\n  config.overlays.forEach(overlay => {\n    if (overlay && overlay.id) {\n      anchors.add(overlay.id); // Make overlay IDs valid anchor targets\n    }\n  });\n\n  config.overlays.forEach(overlay => {\n    if (!overlay.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'overlays',\n        message: 'Overlay missing required id field'\n      });\n      return;\n    }\n\n    if (!overlay.type) {\n      issues.errors.push({\n        code: 'overlay.type.missing',\n        overlay_id: overlay.id,\n        message: `Overlay '${overlay.id}' missing required type field`\n      });\n    }\n\n    // Validate position/anchor references\n    ['anchor', 'attach_to'].forEach(field => {\n      if (overlay[field]) {\n        if (typeof overlay[field] === 'string' && !anchors.has(overlay[field])) {\n          issues.errors.push({\n            code: 'anchor.missing',\n            collection: 'overlays',\n            item_id: overlay.id,\n            anchor: overlay[field],\n            message: `Overlay '${overlay.id}' references missing anchor '${overlay[field]}'`\n          });\n        } else if (Array.isArray(overlay[field])) {\n          validateCoordinateArray(overlay[field], issues, `Overlay '${overlay.id}' ${field}`);\n        }\n      }\n    });\n\n    if (overlay.position && Array.isArray(overlay.position)) {\n      validateCoordinateArray(overlay.position, issues, `Overlay '${overlay.id}' position`);\n    }\n\n    // Validate animation references\n    if (overlay.animation_ref && config.animations) {\n      const animExists = config.animations.some(anim => anim.id === overlay.animation_ref);\n      if (!animExists) {\n        issues.errors.push({\n          code: 'animation.missing',\n          overlay_id: overlay.id,\n          animation_ref: overlay.animation_ref,\n          message: `Overlay '${overlay.id}' references missing animation '${overlay.animation_ref}'`\n        });\n      }\n    }\n  });\n}\n\nfunction validateRules(config, issues) {\n  if (!config.rules) return;\n\n  config.rules.forEach(rule => {\n    if (!rule.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'rules',\n        message: 'Rule missing required id field'\n      });\n      return;\n    }\n\n    if (!rule.when) {\n      issues.errors.push({\n        code: 'rule.when.missing',\n        rule_id: rule.id,\n        message: `Rule '${rule.id}' missing required when conditions`\n      });\n      return;\n    }\n\n    // Validate when conditions structure\n    const hasAll = Array.isArray(rule.when.all);\n    const hasAny = Array.isArray(rule.when.any);\n\n    if (!hasAll && !hasAny) {\n      issues.errors.push({\n        code: 'rule.when.invalid',\n        rule_id: rule.id,\n        message: `Rule '${rule.id}' when must have 'all' or 'any' array of conditions`\n      });\n    }\n\n    // Validate time_between format\n    [...(rule.when.all || []), ...(rule.when.any || [])].forEach(condition => {\n      if (condition.time_between) {\n        if (!/^\\d{2}:\\d{2}-\\d{2}:\\d{2}$/.test(condition.time_between)) {\n          issues.errors.push({\n            code: 'rule.time_between.invalid',\n            rule_id: rule.id,\n            message: `Rule '${rule.id}' time_between must be format \"HH:MM-HH:MM\"`\n          });\n        }\n      }\n\n      // Validate regex patterns\n      if (condition.regex) {\n        try {\n          new RegExp(condition.regex);\n        } catch (e) {\n          issues.warnings.push({\n            code: 'rule.regex.invalid',\n            rule_id: rule.id,\n            message: `Rule '${rule.id}' has invalid regex pattern - rule will be ignored`\n          });\n        }\n      }\n    });\n\n    // Validate priority\n    if (rule.priority !== undefined && (!Number.isInteger(rule.priority))) {\n      issues.errors.push({\n        code: 'rule.priority.invalid',\n        rule_id: rule.id,\n        message: `Rule '${rule.id}' priority must be an integer`\n      });\n    }\n  });\n}\n\nfunction validateAnimations(config, issues) {\n  if (!config.animations) return;\n\n  config.animations.forEach(animation => {\n    if (!animation.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'animations',\n        message: 'Animation missing required id field'\n      });\n      return;\n    }\n\n    if (!animation.preset) {\n      issues.errors.push({\n        code: 'animation.preset.missing',\n        animation_id: animation.id,\n        message: `Animation '${animation.id}' missing required preset field`\n      });\n    }\n\n    // Validate duration\n    if (animation.params?.duration && typeof animation.params.duration !== 'number') {\n      issues.errors.push({\n        code: 'animation.duration.invalid',\n        animation_id: animation.id,\n        message: `Animation '${animation.id}' duration must be a number (milliseconds)`\n      });\n    }\n  });\n}\n\nfunction validateProfiles(config, issues) {\n  if (!config.profiles) return;\n\n  config.profiles.forEach(profile => {\n    if (!profile.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'profiles',\n        message: 'Profile missing required id field'\n      });\n    }\n  });\n\n  // Validate active_profiles references\n  if (config.active_profiles) {\n    if (!Array.isArray(config.active_profiles)) {\n      issues.errors.push({\n        code: 'active_profiles.invalid',\n        message: 'active_profiles must be an array of profile IDs'\n      });\n    } else {\n      const profileIds = new Set((config.profiles || []).map(p => p.id));\n      config.active_profiles.forEach(profileId => {\n        if (!profileIds.has(profileId)) {\n          issues.warnings.push({\n            code: 'profile.missing',\n            profile_id: profileId,\n            message: `active_profiles references missing profile '${profileId}'`\n          });\n        }\n      });\n    }\n  }\n}\n\nfunction validatePalettes(config, issues) {\n  if (!config.palettes) return;\n\n  Object.entries(config.palettes).forEach(([paletteName, tokens]) => {\n    if (typeof tokens !== 'object' || Array.isArray(tokens)) {\n      issues.errors.push({\n        code: 'palette.tokens.invalid',\n        palette_name: paletteName,\n        message: `Palette '${paletteName}' tokens must be an object`\n      });\n    }\n  });\n}\n\nfunction validateRouting(config, issues) {\n  if (!config.routing) return;\n\n  const routing = config.routing;\n\n  // Validate clearance\n  if (routing.clearance !== undefined && typeof routing.clearance !== 'number') {\n    issues.errors.push({\n      code: 'routing.clearance.invalid',\n      message: 'routing.clearance must be a number'\n    });\n  }\n\n  // Validate grid_resolution\n  if (routing.grid_resolution !== undefined && typeof routing.grid_resolution !== 'number') {\n    issues.errors.push({\n      code: 'routing.grid_resolution.invalid',\n      message: 'routing.grid_resolution must be a number'\n    });\n  }\n\n  // Validate smoothing_mode\n  if (routing.smoothing_mode !== undefined) {\n    const validModes = ['none', 'chaikin'];\n    if (!validModes.includes(routing.smoothing_mode)) {\n      issues.warnings.push({\n        code: 'routing.smoothing_mode.invalid',\n        message: `routing.smoothing_mode '${routing.smoothing_mode}' invalid, using 'none'`\n      });\n    }\n  }\n}\n\nfunction validateDuplicateIds(config, issues) {\n  const collections = ['overlays', 'rules', 'animations', 'profiles', 'timelines'];\n\n  collections.forEach(collection => {\n    const items = config[collection] || [];\n    const seenIds = new Set();\n\n    items.forEach((item, index) => {\n      if (!item || !item.id) {\n        issues.errors.push({\n          code: 'id.missing',\n          collection,\n          index,\n          message: `Missing id in ${collection} item at index ${index}`\n        });\n        return;\n      }\n\n      if (seenIds.has(item.id)) {\n        issues.errors.push({\n          code: 'duplicate.id',\n          collection,\n          id: item.id,\n          message: `Duplicate ${collection} ID: ${item.id}`\n        });\n      } else {\n        seenIds.add(item.id);\n      }\n    });\n  });\n}\n\nfunction validateCoordinateArray(coords, issues, context) {\n  if (!Array.isArray(coords) || coords.length !== 2) {\n    issues.errors.push({\n      code: 'coordinates.invalid',\n      message: `${context} must be array of 2 elements [x, y]`\n    });\n    return;\n  }\n\n  coords.forEach((coord, index) => {\n    const axis = index === 0 ? 'x' : 'y';\n    if (typeof coord === 'string') {\n      if (!coord.endsWith('%') || isNaN(parseFloat(coord.slice(0, -1)))) {\n        issues.errors.push({\n          code: 'coordinates.invalid',\n          message: `${context} ${axis}-coordinate '${coord}' must be number or percentage string`\n        });\n      }\n    } else if (typeof coord !== 'number') {\n      issues.errors.push({\n        code: 'coordinates.invalid',\n        message: `${context} ${axis}-coordinate must be number or percentage string`\n      });\n    }\n  });\n}\n\n","/**\n * Enhanced Sparkline Renderer - Advanced sparkline rendering with comprehensive styling support\n * Provides rich sparkline styling features similar to LineOverlayRenderer and TextOverlayRenderer\n */\n\nimport { PositionResolver } from './PositionResolver.js';\nimport { RendererUtils } from './RendererUtils.js';\nimport { DataSourceMixin } from './DataSourceMixin.js';\n\nexport class SparklineRenderer {\n  constructor() {\n    // Pre-defined caches for performance optimization\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n    this.filterCache = new Map();\n    this.pathCache = new Map();\n  }\n\n  /**\n   * Render a sparkline overlay with comprehensive styling support\n   * @param {Object} overlay - Sparkline overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled sparkline\n   */\n  static render(overlay, anchors, viewBox) {\n    // Create instance for non-static methods\n    const instance = new SparklineRenderer();\n    return instance.renderSparkline(overlay, anchors, viewBox);\n  }\n\n  /**\n   * Instance method for comprehensive sparkline rendering\n   * @param {Object} overlay - Sparkline overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled sparkline\n   */\n  renderSparkline(overlay, anchors, viewBox) {\n\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) {\n      console.warn('[SparklineRenderer] Sparkline overlay position could not be resolved:', overlay.id);\n      return '';\n    }\n\n    const [x, y] = position;\n    const size = overlay.size || [200, 60];\n    const [width, height] = size;\n\n    try {\n      // Use unified DataSource access through DataSourceMixin\n      const dataResult = this._getHistoricalDataForSparkline(overlay.source);\n\n      // Extract comprehensive styling\n      const style = overlay.finalStyle || overlay.style || {};\n      const sparklineStyle = this._resolveSparklineStyles(style, overlay.id);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      console.log(`[SparklineRenderer] Data result for ${overlay.id}:`, dataResult.status, dataResult.data?.length);\n\n      if (dataResult.status === 'OK' && dataResult.data && dataResult.data.length >= 2) {\n        // Render real sparkline with advanced features\n        return this._renderEnhancedSparkline(\n          overlay, x, y, width, height, dataResult.data,\n          sparklineStyle, animationAttributes\n        );\n      } else {\n        // Render enhanced status indicator\n        return this._renderEnhancedStatusIndicator(\n          overlay, x, y, width, height, dataResult,\n          sparklineStyle, animationAttributes\n        );\n      }\n    } catch (error) {\n      console.error(`[SparklineRenderer] Enhanced rendering failed for sparkline ${overlay.id}:`, error);\n      return this._renderFallbackSparkline(overlay, x, y, width, height);\n    }\n  }\n\n  /**\n   * Instance method to get historical data using unified DataSource patterns\n   * @private\n   */\n  _getHistoricalDataForSparkline(dataSourceRef) {\n    return SparklineRenderer.getHistoricalDataForSparkline(dataSourceRef);\n  }\n\n  /**\n   * Resolve comprehensive sparkline styling from configuration\n   * @private\n   * @param {Object} style - Final resolved style object\n   * @param {string} overlayId - Overlay ID for unique identifiers\n   * @returns {Object} Complete sparkline style configuration\n   */\n  _resolveSparklineStyles(style, overlayId) {\n    const sparklineStyle = {\n      // Core line properties\n      color: style.color || style.stroke || 'var(--lcars-yellow)',\n      width: Number(style.width || style.stroke_width || style.strokeWidth || 2),\n      opacity: Number(style.opacity || 1),\n\n      // Advanced stroke styling\n      lineCap: (style.line_cap || style.lineCap || style.strokeLinecap || 'round').toLowerCase(),\n      lineJoin: (style.line_join || style.lineJoin || style.strokeLinejoin || 'round').toLowerCase(),\n      miterLimit: Number(style.miter_limit || style.miterLimit || 4),\n\n      // Dash patterns\n      dashArray: style.dash_array || style.dashArray || style.strokeDasharray || null,\n      dashOffset: Number(style.dash_offset || style.dashOffset || style.strokeDashoffset || 0),\n\n      // Path generation options\n      smoothing_mode: (style.smoothing_mode || style.smoothingMode || 'none').toLowerCase(),\n      interpolation: (style.interpolation || 'linear').toLowerCase(),\n      path_precision: Number(style.path_precision || style.pathPrecision || 2),\n\n      // Area fill properties\n      fill: style.fill || 'none',\n      fillOpacity: Number(style.fill_opacity || style.fillOpacity || 0.2),\n      fillGradient: this._parseGradientConfig(style.fill_gradient || style.fillGradient),\n\n      // Advanced styling\n      gradient: this._parseGradientConfig(style.gradient),\n      pattern: this._parsePatternConfig(style.pattern),\n\n      // Data visualization features\n      show_points: style.show_points || style.showPoints || false,\n      point_size: Number(style.point_size || style.pointSize || 3),\n      point_color: style.point_color || style.pointColor || null,\n      show_last_value: style.show_last_value || style.showLastValue || false,\n      value_format: style.value_format || style.valueFormat || null,\n\n      // Threshold and reference lines\n      thresholds: this._parseThresholds(style.thresholds),\n      zero_line: style.zero_line || style.zeroLine || false,\n      zero_line_color: style.zero_line_color || style.zeroLineColor || 'var(--lcars-gray)',\n\n      // Value range control\n      min_value: style.min_value !== undefined ? Number(style.min_value) : null,\n      max_value: style.max_value !== undefined ? Number(style.max_value) : null,\n      auto_scale: style.auto_scale !== false,\n\n      // Effects\n      glow: this._parseGlowConfig(style.glow),\n      shadow: this._parseShadowConfig(style.shadow),\n      blur: this._parseBlurConfig(style.blur),\n\n      // LCARS-specific features\n      bracket_style: style.bracket_style || style.bracketStyle || false,\n      bracket_width: Number(style.bracket_width || style.bracketWidth || 2), // Configurable bracket stroke width\n      bracket_color: style.bracket_color || style.bracketColor || null, // Separate bracket color\n      bracket_gap: Number(style.bracket_gap || style.bracketGap || 6), // Distance from sparkline\n      bracket_corner_radius: Number(style.bracket_corner_radius || style.bracketCornerRadius || 0),\n      bracket_style_mode: (style.bracket_style_mode || style.bracketStyleMode || 'square').toLowerCase(),\n\n      status_indicator: style.status_indicator || style.statusIndicator || false,\n      scan_line: style.scan_line || style.scanLine || false,\n\n      grid_lines: style.grid_lines || style.gridLines || false,\n      grid_color: style.grid_color || style.gridColor || 'var(--lcars-gray)',\n      grid_opacity: Number(style.grid_opacity || style.gridOpacity || 0.4), // Increased default opacity\n      grid_stroke_width: Number(style.grid_stroke_width || style.gridStrokeWidth || 1), // Configurable grid stroke width\n      grid_horizontal_count: Number(style.grid_horizontal_count || style.gridHorizontalCount || 3),\n      grid_vertical_count: Number(style.grid_vertical_count || style.gridVerticalCount || 5),\n\n      // Animation states (for future anime.js integration)\n      animatable: style.animatable !== false,\n      tracer_speed: Number(style.tracer_speed || style.tracerSpeed || 0),\n      pulse_speed: Number(style.pulse_speed || style.pulseSpeed || 0),\n\n      // Performance options\n      decimation: Number(style.decimation || 0), // 0 = no decimation\n      max_points: Number(style.max_points || style.maxPoints || 1000),\n\n      // Track enabled features for optimization\n      features: []\n    };\n\n    // Build feature list for conditional rendering\n    if (sparklineStyle.gradient) sparklineStyle.features.push('gradient');\n    if (sparklineStyle.pattern) sparklineStyle.features.push('pattern');\n    if (sparklineStyle.fill !== 'none') sparklineStyle.features.push('area-fill');\n    if (sparklineStyle.fillGradient) sparklineStyle.features.push('area-gradient');\n    if (sparklineStyle.show_points) sparklineStyle.features.push('data-points');\n    if (sparklineStyle.thresholds && sparklineStyle.thresholds.length > 0) sparklineStyle.features.push('thresholds');\n    if (sparklineStyle.zero_line) sparklineStyle.features.push('zero-line');\n    if (sparklineStyle.glow) sparklineStyle.features.push('glow');\n    if (sparklineStyle.shadow) sparklineStyle.features.push('shadow');\n    if (sparklineStyle.blur) sparklineStyle.features.push('blur');\n    if (sparklineStyle.bracket_style) sparklineStyle.features.push('brackets');\n    if (sparklineStyle.status_indicator) sparklineStyle.features.push('status');\n    if (sparklineStyle.scan_line) sparklineStyle.features.push('scan-line');\n    if (sparklineStyle.grid_lines) sparklineStyle.features.push('grid');\n    if (sparklineStyle.show_last_value) sparklineStyle.features.push('value-label');\n    if (sparklineStyle.smoothing_mode !== 'none') sparklineStyle.features.push('smoothing');\n    if (sparklineStyle.tracer_speed > 0) sparklineStyle.features.push('tracer');\n    if (sparklineStyle.pulse_speed > 0) sparklineStyle.features.push('pulse');\n\n    return sparklineStyle;\n  }\n\n  /**\n   * Render enhanced sparkline with all features\n   * @private\n   */\n  _renderEnhancedSparkline(overlay, x, y, width, height, data, sparklineStyle, animationAttributes) {\n    const svgParts = [\n      this._buildDefinitions(sparklineStyle, overlay.id),\n      this._buildSparklineBackground(width, height, sparklineStyle, overlay.id),\n      this._buildGridLines(width, height, sparklineStyle, overlay.id),\n      this._buildThresholdLines(data, width, height, sparklineStyle, overlay.id),\n      this._buildZeroLine(data, width, height, sparklineStyle, overlay.id),\n      this._buildAreaFill(data, width, height, sparklineStyle, overlay.id),\n      this._buildMainSparklinePath(data, width, height, sparklineStyle, overlay.id, animationAttributes),\n      this._buildDataPoints(data, width, height, sparklineStyle, overlay.id),\n      this._buildValueLabel(data, width, height, sparklineStyle, overlay.id),\n      this._buildBrackets(width, height, sparklineStyle, overlay.id),\n      this._buildStatusIndicator(width, height, sparklineStyle, overlay.id),\n      this._buildScanLine(width, height, sparklineStyle, overlay.id)\n    ].filter(Boolean);\n\n    console.log(`[SparklineRenderer] Rendered enhanced sparkline ${overlay.id} with ${sparklineStyle.features.length} features`);\n\n    return `<g data-overlay-id=\"${overlay.id}\"\n                data-overlay-type=\"sparkline\"\n                data-source=\"${overlay.source}\"\n                data-sparkline-features=\"${sparklineStyle.features.join(',')}\"\n                data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                transform=\"translate(${x}, ${y})\">\n              ${svgParts.join('\\n')}\n            </g>`;\n  }\n\n  /**\n   * Build SVG definitions for gradients, patterns, and effects\n   * @private\n   */\n  _buildDefinitions(sparklineStyle, overlayId) {\n    const defs = [];\n\n    // Line gradients\n    if (sparklineStyle.gradient) {\n      defs.push(RendererUtils.createGradientDefinition(sparklineStyle.gradient, `sparkline-gradient-${overlayId}`));\n    }\n\n    // Area fill gradients\n    if (sparklineStyle.fillGradient) {\n      defs.push(RendererUtils.createGradientDefinition(sparklineStyle.fillGradient, `sparkline-area-gradient-${overlayId}`));\n    }\n\n    // Patterns\n    if (sparklineStyle.pattern) {\n      defs.push(RendererUtils.createPatternDefinition(sparklineStyle.pattern, `sparkline-pattern-${overlayId}`));\n    }\n\n    // Effects (filters)\n    if (sparklineStyle.glow) {\n      defs.push(RendererUtils.createGlowFilter(sparklineStyle.glow, `sparkline-glow-${overlayId}`));\n    }\n\n    if (sparklineStyle.shadow) {\n      defs.push(RendererUtils.createShadowFilter(sparklineStyle.shadow, `sparkline-shadow-${overlayId}`));\n    }\n\n    if (sparklineStyle.blur) {\n      defs.push(RendererUtils.createBlurFilter(sparklineStyle.blur, `sparkline-blur-${overlayId}`));\n    }\n\n    return defs.length > 0 ? `<defs>${defs.join('\\n')}</defs>` : '';\n  }\n\n  /**\n   * Build background rectangle for contrast\n   * @private\n   */\n  _buildSparklineBackground(width, height, sparklineStyle, overlayId) {\n    // Only render background if explicitly configured\n    return '';\n  }\n\n  /**\n   * Build grid lines for technical appearance\n   * @private\n   */\n  _buildGridLines(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.grid_lines) return '';\n\n    const lines = [];\n\n    // Horizontal grid lines\n    for (let i = 1; i < sparklineStyle.grid_horizontal_count; i++) {\n      const y = (height / sparklineStyle.grid_horizontal_count) * i;\n      lines.push(`<line x1=\"0\" y1=\"${y}\" x2=\"${width}\" y2=\"${y}\"\n                        stroke=\"${sparklineStyle.grid_color}\"\n                        stroke-width=\"${sparklineStyle.grid_stroke_width}\"\n                        opacity=\"${sparklineStyle.grid_opacity}\"/>`);\n    }\n\n    // Vertical grid lines\n    for (let i = 1; i < sparklineStyle.grid_vertical_count; i++) {\n      const x = (width / sparklineStyle.grid_vertical_count) * i;\n      lines.push(`<line x1=\"${x}\" y1=\"0\" x2=\"${x}\" y2=\"${height}\"\n                        stroke=\"${sparklineStyle.grid_color}\"\n                        stroke-width=\"${sparklineStyle.grid_stroke_width}\"\n                        opacity=\"${sparklineStyle.grid_opacity}\"/>`);\n    }\n\n    return `<g data-feature=\"grid-lines\">${lines.join('\\n')}</g>`;\n  }\n\n  /**\n   * Build threshold reference lines\n   * @private\n   */\n  _buildThresholdLines(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.thresholds || sparklineStyle.thresholds.length === 0) return '';\n\n    const values = data.map(d => d.value);\n    const minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n    const maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n    const valueRange = maxValue - minValue || 1;\n\n    const thresholdLines = sparklineStyle.thresholds.map(threshold => {\n      const y = height - ((threshold.value - minValue) / valueRange) * height;\n      const color = threshold.color || 'var(--lcars-orange)';\n      const strokeWidth = threshold.width || 1;\n      const opacity = threshold.opacity || 0.7;\n      const dashArray = threshold.dash ? '4,2' : null;\n\n      return `<line x1=\"0\" y1=\"${y}\" x2=\"${width}\" y2=\"${y}\"\n                    stroke=\"${color}\" stroke-width=\"${strokeWidth}\" opacity=\"${opacity}\"\n                    ${dashArray ? `stroke-dasharray=\"${dashArray}\"` : ''}\n                    data-threshold=\"${threshold.value}\"/>`;\n    });\n\n    return `<g data-feature=\"threshold-lines\">${thresholdLines.join('\\n')}</g>`;\n  }\n\n  /**\n   * Build zero baseline reference\n   * @private\n   */\n  _buildZeroLine(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.zero_line) return '';\n\n    const values = data.map(d => d.value);\n    const minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n    const maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n\n    // Only show zero line if zero is within the data range\n    if (minValue > 0 || maxValue < 0) return '';\n\n    const valueRange = maxValue - minValue || 1;\n    const zeroY = height - ((0 - minValue) / valueRange) * height;\n\n    return `<line x1=\"0\" y1=\"${zeroY}\" x2=\"${width}\" y2=\"${zeroY}\"\n                  stroke=\"${sparklineStyle.zero_line_color}\" stroke-width=\"1\" opacity=\"0.5\"\n                  stroke-dasharray=\"2,2\"\n                  data-feature=\"zero-line\"/>`;\n  }\n\n  /**\n   * Build area fill under sparkline\n   * @private\n   */\n  _buildAreaFill(data, width, height, sparklineStyle, overlayId) {\n    if (sparklineStyle.fill === 'none' && !sparklineStyle.fillGradient) return '';\n\n    const processedData = this._processDataForRendering(data, sparklineStyle);\n    const pathData = this._createSparklinePath(processedData, { width, height }, sparklineStyle);\n\n    // Create area path by adding bottom edge\n    const areaPath = pathData + ` L ${width} ${height} L 0 ${height} Z`;\n\n    let fillColor = sparklineStyle.fill;\n    if (sparklineStyle.fillGradient) {\n      fillColor = `url(#sparkline-area-gradient-${overlayId})`;\n    } else if (fillColor === 'none') {\n      fillColor = sparklineStyle.color;\n    }\n\n    return `<path d=\"${areaPath}\"\n                  fill=\"${fillColor}\"\n                  fill-opacity=\"${sparklineStyle.fillOpacity}\"\n                  data-feature=\"area-fill\"/>`;\n  }\n\n  /**\n   * Build the main sparkline path with advanced styling\n   * @private\n   */\n  _buildMainSparklinePath(data, width, height, sparklineStyle, overlayId, animationAttributes) {\n    const processedData = this._processDataForRendering(data, sparklineStyle);\n    const pathData = this._createSparklinePath(processedData, { width, height }, sparklineStyle);\n\n    const attributes = [];\n\n    // Core path\n    attributes.push(`d=\"${pathData}\"`);\n    attributes.push(`fill=\"none\"`);\n\n    // Stroke styling\n    if (sparklineStyle.gradient) {\n      attributes.push(`stroke=\"url(#sparkline-gradient-${overlayId})\"`);\n    } else if (sparklineStyle.pattern) {\n      attributes.push(`stroke=\"url(#sparkline-pattern-${overlayId})\"`);\n    } else {\n      attributes.push(`stroke=\"${sparklineStyle.color}\"`);\n    }\n\n    attributes.push(`stroke-width=\"${sparklineStyle.width}\"`);\n    attributes.push(`stroke-opacity=\"${sparklineStyle.opacity}\"`);\n    attributes.push(`stroke-linecap=\"${sparklineStyle.lineCap}\"`);\n    attributes.push(`stroke-linejoin=\"${sparklineStyle.lineJoin}\"`);\n    attributes.push(`vector-effect=\"non-scaling-stroke\"`);\n\n    if (sparklineStyle.lineJoin === 'miter' && sparklineStyle.miterLimit !== 4) {\n      attributes.push(`stroke-miterlimit=\"${sparklineStyle.miterLimit}\"`);\n    }\n\n    if (sparklineStyle.dashArray) {\n      attributes.push(`stroke-dasharray=\"${sparklineStyle.dashArray}\"`);\n      if (sparklineStyle.dashOffset !== 0) {\n        attributes.push(`stroke-dashoffset=\"${sparklineStyle.dashOffset}\"`);\n      }\n    }\n\n    // Effects\n    const filters = [];\n    if (sparklineStyle.glow) filters.push(`url(#sparkline-glow-${overlayId})`);\n    if (sparklineStyle.shadow) filters.push(`url(#sparkline-shadow-${overlayId})`);\n    if (sparklineStyle.blur) filters.push(`url(#sparkline-blur-${overlayId})`);\n    if (filters.length > 0) {\n      attributes.push(`filter=\"${filters.join(' ')}\"`);\n    }\n\n    // Animation attributes\n    attributes.push(...animationAttributes.pathAttributes);\n\n    return `<path ${attributes.join(' ')} data-feature=\"main-path\"/>`;\n  }\n\n  /**\n   * Build data point markers\n   * @private\n   */\n  _buildDataPoints(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.show_points) return '';\n\n    const processedData = this._processDataForRendering(data, sparklineStyle);\n    const points = this._calculateDataPointPositions(processedData, { width, height }, sparklineStyle);\n\n    const pointColor = sparklineStyle.point_color || sparklineStyle.color;\n    const pointSize = sparklineStyle.point_size;\n\n    const pointElements = points.map((point, index) => {\n      return `<circle cx=\"${point.x.toFixed(sparklineStyle.path_precision)}\"\n                      cy=\"${point.y.toFixed(sparklineStyle.path_precision)}\"\n                      r=\"${pointSize}\"\n                      fill=\"${pointColor}\"\n                      opacity=\"${sparklineStyle.opacity}\"\n                      data-value=\"${point.value}\"\n                      data-timestamp=\"${point.timestamp}\"/>`;\n    });\n\n    return `<g data-feature=\"data-points\">${pointElements.join('\\n')}</g>`;\n  }\n\n  /**\n   * Build last value label\n   * @private\n   */\n  _buildValueLabel(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.show_last_value || data.length === 0) return '';\n\n    const lastValue = data[data.length - 1].value;\n    const formattedValue = sparklineStyle.value_format ?\n      this._formatValue(lastValue, sparklineStyle.value_format) :\n      lastValue.toFixed(1);\n\n    const fontSize = Math.min(width / 10, height / 3, 12);\n    const labelX = width + 4;\n    const labelY = height / 2;\n\n    return `<text x=\"${labelX}\" y=\"${labelY}\"\n                  fill=\"${sparklineStyle.color}\"\n                  font-size=\"${fontSize}\"\n                  text-anchor=\"start\"\n                  dominant-baseline=\"middle\"\n                  font-family=\"var(--lcars-font-family, monospace)\"\n                  data-feature=\"value-label\">\n              ${formattedValue}\n            </text>`;\n  }\n\n  /**\n   * Build LCARS-style brackets with proper orientation and corner styling\n   * @private\n   */\n  _buildBrackets(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.bracket_style) return '';\n\n    const bracketColor = sparklineStyle.bracket_color || sparklineStyle.color;\n    const strokeWidth = sparklineStyle.bracket_width;\n\n    let gap = sparklineStyle.bracket_gap;\n    if (sparklineStyle.smoothing_mode !== 'none') {\n      gap = Math.max(gap, 12);\n    }\n\n    const cornerRadius = sparklineStyle.bracket_corner_radius;\n    const styleMode = sparklineStyle.bracket_style_mode;\n\n    let leftBracketPath, rightBracketPath;\n    if (styleMode === 'rounded' && cornerRadius > 0) {\n      leftBracketPath = this._buildRoundedBracketPath('left', gap, height, cornerRadius);\n      rightBracketPath = this._buildRoundedBracketPath('right', width, gap, height, cornerRadius);\n    } else if (styleMode === 'lcars') {\n      leftBracketPath = this._buildLcarsBracketPath('left', gap, height);\n      rightBracketPath = this._buildLcarsBracketPath('right', width, gap, height);\n    } else {\n      leftBracketPath = this._buildSquareBracketPath('left', gap, height);\n      rightBracketPath = this._buildSquareBracketPath('right', width, gap, height);\n    }\n\n    return `<g data-feature=\"brackets\">\n              <path d=\"${leftBracketPath}\" stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n              <path d=\"${rightBracketPath}\" stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n            </g>`;\n  }\n\n  /**\n   * Build square corner bracket path\n   * @private\n   */\n  _buildSquareBracketPath(side, gapOrWidth, gapOrHeight, height) {\n    if (side === 'left') {\n      const gap = gapOrWidth;\n      const h = gapOrHeight;\n      return `M ${-gap - 4} 0 L ${-gap - 4} ${h} M ${-gap - 4} 0 L ${-gap/2} 0 M ${-gap - 4} ${h} L ${-gap/2} ${h}`;\n    } else {\n      const width = gapOrWidth;\n      const gap = gapOrHeight;\n      const h = height;\n      return `M ${width + gap/2} 0 L ${width + gap + 4} 0 M ${width + gap + 4} 0 L ${width + gap + 4} ${h} M ${width + gap/2} ${h} L ${width + gap + 4} ${h}`;\n    }\n  }\n\n  /**\n   * Build rounded corner bracket path\n   * @private\n   */\n  _buildRoundedBracketPath(side, gapOrWidth, gapOrHeight, heightOrRadius, radiusOrHeight) {\n    if (side === 'left') {\n      const gap = gapOrWidth;\n      const h = gapOrHeight;\n      const radius = heightOrRadius;\n      const minRadius = Math.min(radius, gap/4, h/6);\n      return `M ${-gap - 4} ${minRadius}\n              A ${minRadius} ${minRadius} 0 0 1 ${-gap - 4 + minRadius} 0\n              L ${-gap/2} 0\n              M ${-gap - 4} ${h - minRadius}\n              A ${minRadius} ${minRadius} 0 0 0 ${-gap - 4 + minRadius} ${h}\n              L ${-gap/2} ${h}\n              M ${-gap - 4} ${minRadius}\n              L ${-gap - 4} ${h - minRadius}`;\n    } else {\n      const width = gapOrWidth;\n      const gap = gapOrHeight;\n      const h = heightOrRadius;\n      const radius = radiusOrHeight;\n      const minRadius = Math.min(radius, gap/4, h/6);\n      return `M ${width + gap/2} 0\n              L ${width + gap + 4 - minRadius} 0\n              A ${minRadius} ${minRadius} 0 0 1 ${width + gap + 4} ${minRadius}\n              M ${width + gap/2} ${h}\n              L ${width + gap + 4 - minRadius} ${h}\n              A ${minRadius} ${minRadius} 0 0 0 ${width + gap + 4} ${h - minRadius}\n              M ${width + gap + 4} ${minRadius}\n              L ${width + gap + 4} ${h - minRadius}`;\n    }\n  }\n\n  /**\n   * Build LCARS-style bracket path with characteristic corner cuts\n   * @private\n   */\n  _buildLcarsBracketPath(side, gapOrWidth, gapOrHeight, height) {\n    if (side === 'left') {\n      const gap = gapOrWidth;\n      const h = gapOrHeight;\n      const cutSize = Math.min(4, gap/4, h/10);\n      return `M ${-gap - 4} ${cutSize}\n              L ${-gap - 4 + cutSize} 0\n              L ${-gap/2} 0\n              M ${-gap - 4} ${h - cutSize}\n              L ${-gap - 4 + cutSize} ${h}\n              L ${-gap/2} ${h}\n              M ${-gap - 4} ${cutSize}\n              L ${-gap - 4} ${h - cutSize}`;\n    } else {\n      const width = gapOrWidth;\n      const gap = gapOrHeight;\n      const h = height;\n      const cutSize = Math.min(4, gap/4, h/10);\n      return `M ${width + gap/2} 0\n              L ${width + gap + 4 - cutSize} 0\n              L ${width + gap + 4} ${cutSize}\n              M ${width + gap/2} ${h}\n              L ${width + gap + 4 - cutSize} ${h}\n              L ${width + gap + 4} ${h - cutSize}\n              M ${width + gap + 4} ${cutSize}\n              L ${width + gap + 4} ${h - cutSize}`;\n    }\n  }\n\n  /**\n   * Build status indicator\n   * @private\n   */\n  _buildStatusIndicator(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.status_indicator) return '';\n\n    const indicatorSize = 4;\n    const indicatorColor = typeof sparklineStyle.status_indicator === 'string' ?\n      sparklineStyle.status_indicator : 'var(--lcars-green)';\n\n    return `<circle cx=\"${-indicatorSize - 4}\" cy=\"${height / 2}\" r=\"${indicatorSize}\"\n                    fill=\"${indicatorColor}\"\n                    data-feature=\"status-indicator\"/>`;\n  }\n\n  /**\n   * Build scan line animation element\n   * @private\n   */\n  _buildScanLine(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.scan_line) return '';\n\n    return `<line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"${height}\"\n                  stroke=\"${sparklineStyle.color}\" stroke-width=\"1\" opacity=\"0.8\"\n                  data-feature=\"scan-line\"\n                  data-scan-speed=\"${sparklineStyle.tracer_speed || 2}\">\n              <animate attributeName=\"x1\" values=\"0;${width};0\" dur=\"3s\" repeatCount=\"indefinite\"/>\n              <animate attributeName=\"x2\" values=\"0;${width};0\" dur=\"3s\" repeatCount=\"indefinite\"/>\n            </line>`;\n  }\n\n  /**\n   * Create enhanced sparkline path with smoothing options\n   * @private\n   */\n  _createSparklinePath(data, bounds, sparklineStyle) {\n    if (!data || data.length < 2) {\n      return `M 0 ${bounds.height / 2} L ${bounds.width} ${bounds.height / 2}`;\n    }\n\n    const { width, height } = bounds;\n    const points = this._calculateDataPointPositions(data, bounds, sparklineStyle);\n\n    // Apply smoothing based on mode with proper width normalization\n    let path;\n    switch (sparklineStyle.smoothing_mode) {\n      case 'chaikin':\n        path = this._createChaikinPath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'constrained':\n        path = this._createConstrainedSmoothPath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'bezier':\n        path = this._createBezierPath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'spline':\n        path = this._createSplinePath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'stepped':\n        path = this._createSteppedPath(points, sparklineStyle.path_precision);\n        break;\n      default:\n        path = this._createLinearPath(points, sparklineStyle.path_precision);\n        break;\n    }\n\n    return path;\n  }\n\n  /**\n   * Calculate data point positions with scaling\n   * @private\n   */\n  _calculateDataPointPositions(data, bounds, sparklineStyle) {\n    const { width, height } = bounds;\n\n    // Find value range\n    const values = data.map(d => d.value);\n    let minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n    let maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n\n    // Handle edge cases\n    if (minValue === maxValue) {\n      minValue -= 0.5;\n      maxValue += 0.5;\n    }\n\n    const valueRange = maxValue - minValue;\n\n    return data.map((point, index) => ({\n      x: (index / (data.length - 1)) * width,\n      y: height - ((point.value - minValue) / valueRange) * height,\n      value: point.value,\n      timestamp: point.timestamp\n    }));\n  }\n\n  /**\n   * Create linear path (default)\n   * @private\n   */\n  _createLinearPath(points, precision) {\n    const pathSegments = [];\n\n    points.forEach((point, index) => {\n      const x = point.x.toFixed(precision);\n      const y = point.y.toFixed(precision);\n\n      if (index === 0) {\n        pathSegments.push(`M ${x} ${y}`);\n      } else {\n        pathSegments.push(`L ${x} ${y}`);\n      }\n    });\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Create stepped path\n   * @private\n   */\n  _createSteppedPath(points, precision) {\n    const pathSegments = [];\n\n    points.forEach((point, index) => {\n      const x = point.x.toFixed(precision);\n      const y = point.y.toFixed(precision);\n\n      if (index === 0) {\n        pathSegments.push(`M ${x} ${y}`);\n      } else {\n        const prevY = points[index - 1].y.toFixed(precision);\n        pathSegments.push(`L ${x} ${prevY}`);\n        pathSegments.push(`L ${x} ${y}`);\n      }\n    });\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Create Chaikin smoothed path with width normalization\n   * @private\n   */\n  _createChaikinPath(points, precision, targetWidth) {\n    if (points.length < 3) return this._createLinearPath(points, precision);\n\n    // Chaikin subdivision algorithm\n    let smoothedPoints = [...points];\n\n    // Apply Chaikin subdivision iterations\n    for (let iteration = 0; iteration < 2; iteration++) {\n      const newPoints = [];\n\n      for (let i = 0; i < smoothedPoints.length - 1; i++) {\n        const p1 = smoothedPoints[i];\n        const p2 = smoothedPoints[i + 1];\n\n        // Quarter point\n        newPoints.push({\n          x: p1.x * 0.75 + p2.x * 0.25,\n          y: p1.y * 0.75 + p2.y * 0.25\n        });\n\n        // Three-quarter point\n        newPoints.push({\n          x: p1.x * 0.25 + p2.x * 0.75,\n          y: p1.y * 0.25 + p2.y * 0.75\n        });\n      }\n\n      smoothedPoints = newPoints;\n    }\n\n    // Normalize X coordinates to span full width\n    if (smoothedPoints.length > 1) {\n      const minX = Math.min(...smoothedPoints.map(p => p.x));\n      const maxX = Math.max(...smoothedPoints.map(p => p.x));\n      const currentWidth = maxX - minX;\n\n      if (currentWidth > 0) {\n        smoothedPoints = smoothedPoints.map(point => ({\n          x: ((point.x - minX) / currentWidth) * targetWidth,\n          y: point.y\n        }));\n      }\n    }\n\n    return this._createLinearPath(smoothedPoints, precision);\n  }\n\n  /**\n   * Create Bezier curved path with width normalization\n   * @private\n   */\n  _createBezierPath(points, precision, targetWidth) {\n    if (points.length < 3) return this._createLinearPath(points, precision);\n\n    const pathSegments = [`M ${points[0].x.toFixed(precision)} ${points[0].y.toFixed(precision)}`];\n\n    for (let i = 1; i < points.length - 1; i++) {\n      const p0 = points[i - 1];\n      const p1 = points[i];\n      const p2 = points[i + 1];\n\n      // Control points for smooth curve\n      const cp1x = p0.x + (p1.x - p0.x) * 0.5;\n      const cp1y = p0.y + (p1.y - p0.y) * 0.5;\n      const cp2x = p1.x - (p2.x - p1.x) * 0.5;\n      const cp2y = p1.y - (p2.y - p1.y) * 0.5;\n\n      pathSegments.push(`Q ${cp1x.toFixed(precision)} ${cp1y.toFixed(precision)} ${p1.x.toFixed(precision)} ${p1.y.toFixed(precision)}`);\n    }\n\n    // Final point\n    const lastPoint = points[points.length - 1];\n    pathSegments.push(`L ${lastPoint.x.toFixed(precision)} ${lastPoint.y.toFixed(precision)}`);\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Create spline path with width normalization\n   * @private\n   */\n  _createSplinePath(points, precision, targetWidth) {\n    if (points.length < 4) return this._createBezierPath(points, precision, targetWidth);\n\n    // Generate spline points\n    const splinePoints = [];\n\n    // Start with first point\n    splinePoints.push(points[0]);\n\n    // Generate intermediate spline points\n    for (let i = 1; i < points.length - 2; i++) {\n      const p0 = points[i - 1];\n      const p1 = points[i];\n      const p2 = points[i + 1];\n      const p3 = points[i + 2];\n\n      // Catmull-Rom spline - generate multiple points along the curve\n      const segments = 10; // Number of segments between each pair of points\n      for (let t = 0; t <= segments; t++) {\n        const u = t / segments;\n        const u2 = u * u;\n        const u3 = u2 * u;\n\n        // Catmull-Rom basis functions\n        const f1 = -0.5 * u3 + u2 - 0.5 * u;\n        const f2 = 1.5 * u3 - 2.5 * u2 + 1;\n        const f3 = -1.5 * u3 + 2 * u2 + 0.5 * u;\n        const f4 = 0.5 * u3 - 0.5 * u2;\n\n        const x = f1 * p0.x + f2 * p1.x + f3 * p2.x + f4 * p3.x;\n        const y = f1 * p0.y + f2 * p1.y + f3 * p2.y + f4 * p3.y;\n\n        splinePoints.push({ x, y });\n      }\n    }\n\n    // Add final point\n    splinePoints.push(points[points.length - 1]);\n\n    // Normalize X coordinates to span full width\n    if (splinePoints.length > 1) {\n      const minX = Math.min(...splinePoints.map(p => p.x));\n      const maxX = Math.max(...splinePoints.map(p => p.x));\n      const currentWidth = maxX - minX;\n\n      if (currentWidth > 0) {\n        splinePoints.forEach(point => {\n          point.x = ((point.x - minX) / currentWidth) * targetWidth;\n        });\n      }\n    }\n\n    return this._createLinearPath(splinePoints, precision);\n  }\n\n  /**\n   * Create constrained smooth path that passes through all data points\n   * @private\n   */\n  _createConstrainedSmoothPath(points, precision, targetWidth) {\n    if (points.length < 3) return this._createLinearPath(points, precision);\n\n    const pathSegments = [];\n\n    // Start at first point\n    pathSegments.push(`M ${points[0].x.toFixed(precision)} ${points[0].y.toFixed(precision)}`);\n\n    // Create smooth curves between each pair of points\n    for (let i = 0; i < points.length - 1; i++) {\n      const current = points[i];\n      const next = points[i + 1];\n\n      // Calculate control points for smooth curve\n      let cp1x, cp1y, cp2x, cp2y;\n\n      if (i === 0) {\n        // First segment - use next point for direction\n        const next2 = points[i + 2] || next;\n        cp1x = current.x + (next.x - current.x) * 0.3;\n        cp1y = current.y + (next.y - current.y) * 0.2;\n        cp2x = next.x - (next2.x - current.x) * 0.2;\n        cp2y = next.y - (next2.y - current.y) * 0.1;\n      } else if (i === points.length - 2) {\n        // Last segment - use previous point for direction\n        const prev = points[i - 1];\n        cp1x = current.x + (next.x - prev.x) * 0.2;\n        cp1y = current.y + (next.y - prev.y) * 0.1;\n        cp2x = next.x - (next.x - current.x) * 0.3;\n        cp2y = next.y - (next.y - current.y) * 0.2;\n      } else {\n        // Middle segments - use surrounding points for smooth direction\n        const prev = points[i - 1];\n        const next2 = points[i + 2];\n\n        const prevSlope = {\n          x: next.x - prev.x,\n          y: next.y - prev.y\n        };\n        const nextSlope = {\n          x: next2.x - current.x,\n          y: next2.y - current.y\n        };\n\n        // Smooth the transition\n        cp1x = current.x + prevSlope.x * 0.25;\n        cp1y = current.y + prevSlope.y * 0.15;\n        cp2x = next.x - nextSlope.x * 0.25;\n        cp2y = next.y - nextSlope.y * 0.15;\n      }\n\n      // Clamp control points to reasonable bounds\n      cp1x = Math.max(current.x, Math.min(next.x, cp1x));\n      cp2x = Math.max(current.x, Math.min(next.x, cp2x));\n\n      pathSegments.push(`C ${cp1x.toFixed(precision)} ${cp1y.toFixed(precision)} ${cp2x.toFixed(precision)} ${cp2y.toFixed(precision)} ${next.x.toFixed(precision)} ${next.y.toFixed(precision)}`);\n    }\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Process data for rendering (decimation, filtering)\n   * @private\n   */\n  _processDataForRendering(data, sparklineStyle) {\n    let processedData = [...data];\n\n    // Apply decimation if needed\n    if (sparklineStyle.decimation > 0 && processedData.length > sparklineStyle.decimation) {\n      const step = Math.floor(processedData.length / sparklineStyle.decimation);\n      processedData = processedData.filter((_, index) => index % step === 0);\n\n      // Always include the last point\n      if (processedData[processedData.length - 1] !== data[data.length - 1]) {\n        processedData.push(data[data.length - 1]);\n      }\n    }\n\n    // Apply max_points limit\n    if (sparklineStyle.max_points > 0 && processedData.length > sparklineStyle.max_points) {\n      const step = Math.floor(processedData.length / sparklineStyle.max_points);\n      processedData = processedData.filter((_, index) => index % step === 0);\n\n      // Always include the last point\n      if (processedData[processedData.length - 1] !== data[data.length - 1]) {\n        processedData.push(data[data.length - 1]);\n      }\n    }\n\n    return processedData;\n  }\n\n  /**\n   * Render enhanced status indicator\n   * @private\n   */\n  _renderEnhancedStatusIndicator(overlay, x, y, width, height, dataResult, sparklineStyle, animationAttributes) {\n    const statusColors = {\n      'NO_SOURCE': 'var(--lcars-red)',\n      'MANAGER_NOT_AVAILABLE': 'var(--lcars-blue)',\n      'SOURCE_NOT_FOUND': 'var(--lcars-orange)',\n      'NO_BUFFER': 'var(--lcars-orange)',\n      'EMPTY_BUFFER': 'var(--lcars-blue)',\n      'INSUFFICIENT_DATA': 'var(--lcars-blue)',\n      'ERROR': 'var(--lcars-red)'\n    };\n\n    const statusMessages = {\n      'NO_SOURCE': 'NO SOURCE',\n      'MANAGER_NOT_AVAILABLE': 'LOADING',\n      'SOURCE_NOT_FOUND': 'NOT FOUND',\n      'NO_BUFFER': 'NO BUFFER',\n      'EMPTY_BUFFER': 'NO DATA',\n      'INSUFFICIENT_DATA': 'LOADING',\n      'ERROR': 'ERROR'\n    };\n\n    const indicatorColor = statusColors[dataResult.status] || sparklineStyle.color;\n    const indicatorText = statusMessages[dataResult.status] || 'UNKNOWN';\n    const fontSize = Math.min(width / 8, height / 3, 14);\n\n    // Enhanced status with LCARS styling\n    const loadingStates = ['MANAGER_NOT_AVAILABLE', 'INSUFFICIENT_DATA'];\n    const isLoading = loadingStates.includes(dataResult.status);\n\n    const animationProps = isLoading ? `\n      <animate attributeName=\"opacity\" values=\"0.3;1.0;0.3\" dur=\"1s\" repeatCount=\"indefinite\"/>\n    ` : `\n      <animate attributeName=\"opacity\" values=\"0.3;0.8;0.3\" dur=\"2s\" repeatCount=\"indefinite\"/>\n    `;\n\n    const svgParts = [\n      this._buildDefinitions(sparklineStyle, overlay.id),\n      sparklineStyle.bracket_style ? this._buildBrackets(width, height, { ...sparklineStyle, color: indicatorColor }, overlay.id) : '',\n      `<rect width=\"${width}\" height=\"${height}\"\n             fill=\"none\" stroke=\"${indicatorColor}\" stroke-width=\"2\"\n             stroke-dasharray=\"${isLoading ? '4,2' : '8,4'}\" opacity=\"0.6\">\n        ${animationProps}\n       </rect>`,\n      `<text x=\"${width / 2}\" y=\"${height / 2}\"\n             fill=\"${indicatorColor}\" text-anchor=\"middle\" dominant-baseline=\"middle\"\n             font-family=\"var(--lcars-font-family, monospace)\"\n             font-size=\"${fontSize}\" font-weight=\"bold\">\n        ${indicatorText}\n       </text>`,\n      width > 120 ? `<text x=\"${width / 2}\" y=\"${height / 2 + fontSize + 4}\"\n                           fill=\"${indicatorColor}\" text-anchor=\"middle\" dominant-baseline=\"middle\"\n                           font-family=\"var(--lcars-font-family, monospace)\"\n                           font-size=\"${Math.max(8, fontSize * 0.6)}\" opacity=\"0.7\">\n                      ${overlay.source || 'NO SOURCE ID'}\n                     </text>` : ''\n    ].filter(Boolean);\n\n    return `<g data-overlay-id=\"${overlay.id}\"\n                data-overlay-type=\"sparkline\"\n                data-source=\"${overlay.source || 'unknown'}\"\n                data-status=\"${dataResult.status}\"\n                data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                transform=\"translate(${x}, ${y})\">\n              ${svgParts.join('\\n')}\n            </g>`;\n  }\n\n  /**\n   * Parse various configuration formats\n   * @private\n   */\n  _parseGradientConfig(gradientConfig) {\n    return RendererUtils.parseGradientConfig(gradientConfig);\n  }\n\n  _parsePatternConfig(patternConfig) {\n    return RendererUtils.parsePatternConfig(patternConfig);\n  }\n\n  _parseGlowConfig(glowConfig) {\n    return RendererUtils.parseGlowConfig(glowConfig);\n  }\n\n  _parseShadowConfig(shadowConfig) {\n    return RendererUtils.parseShadowConfig(shadowConfig);\n  }\n\n  _parseBlurConfig(blurConfig) {\n    return RendererUtils.parseBlurConfig(blurConfig);\n  }\n\n  /**\n   * Parse threshold configuration\n   * @private\n   */\n  _parseThresholds(thresholds) {\n    if (!thresholds || !Array.isArray(thresholds)) return [];\n\n    return thresholds.map(threshold => ({\n      value: Number(threshold.value || threshold),\n      color: threshold.color || 'var(--lcars-orange)',\n      width: Number(threshold.width || 1),\n      opacity: Number(threshold.opacity || 0.7),\n      dash: threshold.dash || false,\n      label: threshold.label || null\n    }));\n  }\n\n  /**\n   * Format value for display\n   * @private\n   */\n  _formatValue(value, format) {\n    if (typeof format === 'function') {\n      return format(value);\n    }\n\n    if (typeof format === 'string') {\n      return format.replace('{value}', value.toFixed(1));\n    }\n\n    return value.toFixed(1);\n  }\n\n  /**\n   * Prepare animation attributes for future anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    const animationAttributes = {\n      pathAttributes: [],\n      hasAnimations: false\n    };\n\n    // Animation hooks for future implementation\n    if (style.animatable !== false) {\n      animationAttributes.pathAttributes.push(`data-animatable=\"true\"`);\n    }\n\n    if (style.tracer_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-tracer-speed=\"${style.tracer_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.pulse_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-pulse-speed=\"${style.pulse_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Render simple fallback sparkline\n   * @private\n   */\n  _renderFallbackSparkline(overlay, x, y, width, height) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const color = style.color || 'var(--lcars-yellow)';\n    const strokeWidth = style.width || 2;\n\n    console.warn(`[SparklineRenderer] Using fallback rendering for sparkline ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"sparkline\" data-fallback=\"true\">\n              <g transform=\"translate(${x}, ${y})\">\n                <path d=\"M 0 ${height / 2} L ${width} ${height / 2}\"\n                      fill=\"none\" stroke=\"${color}\" stroke-width=\"${strokeWidth}\"\n                      vector-effect=\"non-scaling-stroke\"/>\n              </g>\n            </g>`;\n  }\n\n  // === EXISTING DATA SOURCE METHODS (PRESERVED FROM ORIGINAL) ===\n\n  /**\n   * Get historical data with multiple fallback strategies and DataSource enhancement support\n   * @param {string} dataSourceRef - Data source reference (source_name or source_name.data_key)\n   * @returns {Object} {data: Array|null, status: string, message: string, metadata: Object}\n   */\n  static getHistoricalDataForSparkline(dataSourceRef) {\n    if (!dataSourceRef) {\n      return {\n        data: null,\n        status: 'NO_SOURCE',\n        message: 'No data source specified',\n        metadata: {}\n      };\n    }\n\n    try {\n      // Parse data source reference for enhanced data access\n      const { sourceName, dataKey, isTransformation, isAggregation } = SparklineRenderer.parseDataSourceReference(dataSourceRef);\n\n      const dataSourceManager = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n\n      if (dataSourceManager) {\n        console.log(`[SparklineRenderer] 🔍 Checking DataSourceManager for '${sourceName}' with data key: '${dataKey}'`);\n\n        const dataSource = dataSourceManager.getSource(sourceName);\n\n        if (dataSource) {\n          const currentData = dataSource.getCurrentData();\n          console.log(`[SparklineRenderer] Source data for '${sourceName}':`, {\n            bufferSize: currentData?.bufferSize || 0,\n            historyReady: currentData?.historyReady,\n            started: currentData?.started,\n            historyLoaded: currentData?.stats?.historyLoaded || 0,\n            hasTransformations: Object.keys(currentData?.transformations || {}).length,\n            hasAggregations: Object.keys(currentData?.aggregations || {}).length,\n            requestedDataKey: dataKey\n          });\n\n          // NEW: Support for enhanced data access\n          if (dataKey && (isTransformation || isAggregation)) {\n            return SparklineRenderer.getEnhancedDataSourceData(currentData, dataKey, isTransformation, isAggregation, sourceName);\n          }\n\n          // Original buffer-based data access\n          if (currentData?.buffer) {\n            const bufferData = currentData.buffer.getAll();\n            console.log(`[SparklineRenderer] Raw buffer data for '${sourceName}':`, bufferData);\n\n            if (bufferData && bufferData.length >= 2) {\n              const historicalData = bufferData.map(point => ({\n                timestamp: point.t,\n                value: point.v\n              }));\n\n              console.log(`[SparklineRenderer] ✅ Found ${historicalData.length} data points for '${sourceName}'`);\n              return {\n                data: historicalData,\n                status: 'OK',\n                message: `${historicalData.length} data points`,\n                metadata: {\n                  sourceName,\n                  dataType: 'raw',\n                  transformations: currentData.transformations,\n                  aggregations: currentData.aggregations\n                }\n              };\n            } else if (bufferData && bufferData.length === 1) {\n              console.log(`[SparklineRenderer] ⚠️ Only 1 data point available for '${sourceName}'`);\n              return {\n                data: null,\n                status: 'INSUFFICIENT_DATA',\n                message: 'Only 1 data point available (need 2+ for sparkline)',\n                metadata: { sourceName, dataType: 'raw' }\n              };\n            } else {\n              console.log(`[SparklineRenderer] ⚠️ Buffer exists but is empty for '${sourceName}'`);\n              return {\n                data: null,\n                status: 'EMPTY_BUFFER',\n                message: 'Buffer exists but contains no data',\n                metadata: { sourceName, dataType: 'raw' }\n              };\n            }\n          }\n\n          console.log(`[SparklineRenderer] ⚠️ Data source '${sourceName}' found but no buffer`);\n          return {\n            data: null,\n            status: 'NO_BUFFER',\n            message: 'Data source found but no buffer available',\n            metadata: { sourceName }\n          };\n        }\n\n        const availableSources = Array.from(dataSourceManager.sources.keys());\n        console.warn(`[SparklineRenderer] ❌ Source '${sourceName}' not found in DataSourceManager`);\n        return {\n          data: null,\n          status: 'SOURCE_NOT_FOUND',\n          message: `Source '${sourceName}' not found. Available: ${availableSources.join(', ')}`,\n          metadata: { requestedSource: sourceName, availableSources }\n        };\n      }\n\n      return {\n        data: null,\n        status: 'MANAGER_NOT_AVAILABLE',\n        message: 'DataSourceManager not available',\n        metadata: {}\n      };\n\n    } catch (error) {\n      console.error(`[SparklineRenderer] Error getting data for '${dataSourceRef}':`, error);\n      return {\n        data: null,\n        status: 'ERROR',\n        message: `Error occurred: ${error.message}`,\n        metadata: { error: error.message }\n      };\n    }\n  }\n\n  /**\n   * Update sparkline data dynamically when data source changes with enhanced synchronization\n   * @param {Element} sparklineElement - The sparkline SVG element\n   * @param {Object} overlay - Overlay configuration\n   * @param {Object} sourceData - New data from the data source\n   */\n  static updateSparklineData(sparklineElement, overlay, sourceData) {\n    console.log(`[SparklineRenderer] updateSparklineData called for ${overlay.id}:`, {\n      hasBuffer: !!(sourceData?.buffer),\n      bufferSize: sourceData?.buffer?.size?.() || 0,\n      currentStatus: sparklineElement.getAttribute('data-status'),\n      elementFound: !!sparklineElement,\n      currentValue: sourceData?.v\n    });\n\n    if (!sparklineElement || !overlay || !sourceData) {\n      console.warn('[SparklineRenderer] updateSparklineData: Missing required parameters');\n      return;\n    }\n\n    // Create instance for update operations\n    const instance = new SparklineRenderer();\n    instance._updateSparklineElementSynchronized(sparklineElement, overlay, sourceData);\n  }\n\n  /**\n   * Enhanced synchronized update method that ensures markers and lines stay in sync\n   * @private\n   */\n  _updateSparklineElementSynchronized(sparklineElement, overlay, sourceData) {\n    const currentStatus = sparklineElement.getAttribute('data-status');\n    const isStatusIndicator = currentStatus !== null;\n\n    // If status indicator and data is now available, upgrade\n    if (isStatusIndicator && (sourceData.buffer || sourceData.historicalData)) {\n      this._upgradeStatusIndicatorToSparkline(sparklineElement, overlay, sourceData);\n      return;\n    }\n\n    // Extract current historical data\n    const historicalData = this._extractHistoricalData(sourceData);\n\n    if (historicalData.length < 2) {\n      console.warn(`[SparklineRenderer] Insufficient data for sparkline ${overlay.id}: ${historicalData.length} points`);\n      sparklineElement.setAttribute('data-status', historicalData.length === 0 ? 'NO_DATA' : 'INSUFFICIENT_DATA');\n      return;\n    }\n\n    try {\n      // Extract dimensions from overlay config\n      const bounds = {\n        width: overlay.size?.[0] || 200,\n        height: overlay.size?.[1] || 60\n      };\n\n      // Re-resolve styles for consistency\n      const style = overlay.finalStyle || overlay.style || {};\n      const sparklineStyle = this._resolveSparklineStyles(style, overlay.id);\n\n      // SYNCHRONIZED UPDATE: Update both path and markers together\n      this._updateSparklinePathAndMarkers(sparklineElement, historicalData, bounds, sparklineStyle, overlay.id);\n\n      // Update other features that might depend on data\n      this._updateSparklineFeatures(sparklineElement, historicalData, bounds, sparklineStyle, overlay.id);\n\n      // Update status attributes\n      sparklineElement.removeAttribute('data-status');\n      sparklineElement.setAttribute('data-last-update', Date.now());\n\n      console.log(`[SparklineRenderer] ✅ Synchronized update for sparkline ${overlay.id} with ${historicalData.length} points`);\n\n    } catch (error) {\n      console.error(`[SparklineRenderer] Error in synchronized update for ${overlay.id}:`, error);\n      sparklineElement.setAttribute('data-status', 'ERROR');\n    }\n  }\n\n  /**\n   * Update both path and markers simultaneously to ensure synchronization\n   * @private\n   */\n  _updateSparklinePathAndMarkers(sparklineElement, historicalData, bounds, sparklineStyle, overlayId) {\n    // Generate processed data once\n    const processedData = this._processDataForRendering(historicalData, sparklineStyle);\n\n    // Update main path\n    const pathElement = sparklineElement.querySelector('path[data-feature=\"main-path\"]');\n    if (pathElement) {\n      const newPathData = this._createSparklinePath(processedData, bounds, sparklineStyle);\n      pathElement.setAttribute('d', newPathData);\n    }\n\n    // Update data points markers if they exist\n    const dataPointsGroup = sparklineElement.querySelector('g[data-feature=\"data-points\"]');\n    if (dataPointsGroup && sparklineStyle.show_points) {\n      const points = this._calculateDataPointPositions(processedData, bounds, sparklineStyle);\n      const pointElements = dataPointsGroup.querySelectorAll('circle');\n\n      // Update existing points or create new ones\n      points.forEach((point, index) => {\n        let pointElement = pointElements[index];\n        if (!pointElement) {\n          pointElement = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n          dataPointsGroup.appendChild(pointElement);\n        }\n\n        pointElement.setAttribute('cx', point.x.toFixed(sparklineStyle.path_precision));\n        pointElement.setAttribute('cy', point.y.toFixed(sparklineStyle.path_precision));\n        pointElement.setAttribute('r', sparklineStyle.point_size);\n        pointElement.setAttribute('data-value', point.value);\n        pointElement.setAttribute('data-timestamp', point.timestamp);\n      });\n\n      // Remove excess point elements\n      for (let i = points.length; i < pointElements.length; i++) {\n        pointElements[i].remove();\n      }\n    }\n\n    // Update area fill if it exists\n    const areaElement = sparklineElement.querySelector('path[data-feature=\"area-fill\"]');\n    if (areaElement && (sparklineStyle.fill !== 'none' || sparklineStyle.fillGradient)) {\n      const pathData = this._createSparklinePath(processedData, bounds, sparklineStyle);\n      const areaPath = pathData + ` L ${bounds.width} ${bounds.height} L 0 ${bounds.height} Z`;\n      areaElement.setAttribute('d', areaPath);\n    }\n  }\n\n  /**\n   * Update other sparkline features that might depend on data\n   * @private\n   */\n  _updateSparklineFeatures(sparklineElement, historicalData, bounds, sparklineStyle, overlayId) {\n    // Update value label if it exists\n    const valueLabelElement = sparklineElement.querySelector('text[data-feature=\"value-label\"]');\n    if (valueLabelElement && sparklineStyle.show_last_value && historicalData.length > 0) {\n      const lastValue = historicalData[historicalData.length - 1].value;\n      const formattedValue = sparklineStyle.value_format ?\n        this._formatValue(lastValue, sparklineStyle.value_format) :\n        lastValue.toFixed(1);\n      valueLabelElement.textContent = formattedValue;\n    }\n\n    // Update threshold lines if data range changed significantly\n    const thresholdGroup = sparklineElement.querySelector('g[data-feature=\"threshold-lines\"]');\n    if (thresholdGroup && sparklineStyle.thresholds && sparklineStyle.thresholds.length > 0) {\n      // Recalculate threshold positions based on new data range\n      const values = historicalData.map(d => d.value);\n      const minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n      const maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n      const valueRange = maxValue - minValue || 1;\n\n      sparklineStyle.thresholds.forEach((threshold, index) => {\n        const thresholdLine = thresholdGroup.children[index];\n        if (thresholdLine) {\n          const y = bounds.height - ((threshold.value - minValue) / valueRange) * bounds.height;\n          thresholdLine.setAttribute('y1', y);\n          thresholdLine.setAttribute('y2', y);\n        }\n      });\n    }\n\n    // Update zero line if it exists and data range changed\n    const zeroLineElement = sparklineElement.querySelector('line[data-feature=\"zero-line\"]');\n    if (zeroLineElement && sparklineStyle.zero_line) {\n      const values = historicalData.map(d => d.value);\n      const minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n      const maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n\n      if (minValue <= 0 && maxValue >= 0) {\n        const valueRange = maxValue - minValue || 1;\n        const zeroY = bounds.height - ((0 - minValue) / valueRange) * bounds.height;\n        zeroLineElement.setAttribute('y1', zeroY);\n        zeroLineElement.setAttribute('y2', zeroY);\n        zeroLineElement.style.display = '';\n      } else {\n        zeroLineElement.style.display = 'none';\n      }\n    }\n  }\n\n  /**\n   * Extract historical data from various source data formats\n   * @private\n   */\n  _upgradeStatusIndicatorToSparkline(sparklineElement, overlay, sourceData) {\n    const historicalData = this._extractHistoricalData(sourceData);\n\n    if (historicalData.length > 1) {\n      const size = overlay.size || [200, 60];\n      const [width, height] = size;\n      const style = overlay.finalStyle || overlay.style || {};\n      const sparklineStyle = this._resolveSparklineStyles(style, overlay.id);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      // Generate complete enhanced sparkline with ALL features\n      const svgParts = [\n        this._buildDefinitions(sparklineStyle, overlay.id),\n        this._buildSparklineBackground(width, height, sparklineStyle, overlay.id),\n        this._buildGridLines(width, height, sparklineStyle, overlay.id),\n        this._buildThresholdLines(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildZeroLine(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildAreaFill(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildMainSparklinePath(historicalData, width, height, sparklineStyle, overlay.id, animationAttributes),\n        this._buildDataPoints(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildValueLabel(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildBrackets(width, height, sparklineStyle, overlay.id),\n        this._buildStatusIndicator(width, height, sparklineStyle, overlay.id),\n        this._buildScanLine(width, height, sparklineStyle, overlay.id)\n      ].filter(Boolean);\n\n      // Replace entire innerHTML with complete sparkline content\n      sparklineElement.innerHTML = svgParts.join('\\n');\n\n      sparklineElement.removeAttribute('data-status');\n      sparklineElement.setAttribute('data-last-update', Date.now());\n      sparklineElement.setAttribute('data-sparkline-features', sparklineStyle.features.join(','));\n\n      console.log(`[SparklineRenderer] ✅ Upgraded status indicator ${overlay.id} to full sparkline with ${sparklineStyle.features.length} features and ${historicalData.length} data points`);\n    } else {\n      sparklineElement.setAttribute('data-status', historicalData.length === 0 ? 'NO_DATA' : 'INSUFFICIENT_DATA');\n    }\n  }\n\n  /**\n   * Extract historical data from various source data formats\n   * @private\n   */\n  _extractHistoricalData(sourceData) {\n    let historicalData = [];\n\n    // Method 1: Use buffer data directly\n    if (sourceData.buffer && typeof sourceData.buffer.getAll === 'function') {\n      const bufferData = sourceData.buffer.getAll();\n      historicalData = bufferData.map(point => ({\n        timestamp: point.t,\n        value: point.v\n      }));\n      console.log('[SparklineRenderer] Using buffer data:', historicalData.length, 'points');\n    }\n    // Method 2: Use pre-formatted historical data\n    else if (sourceData.historicalData && Array.isArray(sourceData.historicalData)) {\n      historicalData = sourceData.historicalData;\n      console.log('[SparklineRenderer] Using pre-formatted historical data:', historicalData.length, 'points');\n    }\n    // Method 3: Generate from single current value (fallback for testing)\n    else if (sourceData.v !== undefined && sourceData.t !== undefined) {\n      console.log('[SparklineRenderer] Generating demo data from current value:', sourceData.v);\n      const now = Date.now();\n      for (let i = 0; i < 20; i++) {\n        historicalData.push({\n          timestamp: now - (19 - i) * 60000,\n          value: sourceData.v + (Math.random() - 0.5) * (sourceData.v * 0.1)\n        });\n      }\n    }\n\n    return historicalData;\n  }\n\n  /**\n   * Get rendering capabilities and features supported\n   * @public\n   */\n  getCapabilities() {\n    return {\n      pathSmoothing: ['none', 'constrained', 'chaikin', 'bezier', 'spline', 'stepped'],\n      dataVisualization: ['points', 'thresholds', 'zero-line', 'value-labels'],\n      styling: ['gradients', 'patterns', 'area-fill', 'dash-patterns'],\n      effects: ['glow', 'shadow', 'blur'],\n      lcarsFeatures: ['brackets', 'status-indicator', 'scan-line', 'grid-lines'],\n      animations: ['tracer', 'pulse'], // Future implementation\n      performance: ['decimation', 'max-points', 'viewport-optimization'],\n      advanced: true\n    };\n  }\n\n  // === DEBUG METHODS (PRESERVED FROM ORIGINAL) ===\n\n  /**\n   * Parse DataSource reference to support enhanced data access\n   * @param {string} dataSourceRef - Reference like 'source_name' or 'source_name.transformations.key'\n   * @returns {Object} Parsed reference details\n   */\n  static parseDataSourceReference(dataSourceRef) {\n    const parts = dataSourceRef.split('.');\n    const sourceName = parts[0];\n\n    if (parts.length === 1) {\n      // Simple source reference\n      return {\n        sourceName,\n        dataKey: null,\n        isTransformation: false,\n        isAggregation: false\n      };\n    }\n\n    if (parts.length >= 3) {\n      // Enhanced reference: source.transformations.key or source.aggregations.key\n      const dataType = parts[1];\n      const dataKey = parts.slice(2).join('.');\n\n      return {\n        sourceName,\n        dataKey,\n        isTransformation: dataType === 'transformations',\n        isAggregation: dataType === 'aggregations'\n      };\n    }\n\n    // Fallback for malformed references\n    return {\n      sourceName,\n      dataKey: null,\n      isTransformation: false,\n      isAggregation: false\n    };\n  }\n\n  /**\n   * Get enhanced DataSource data (transformations/aggregations) for sparklines\n   * @param {Object} currentData - Current data from DataSource\n   * @param {string} dataKey - Key for transformation or aggregation\n   * @param {boolean} isTransformation - Whether accessing transformation data\n   * @param {boolean} isAggregation - Whether accessing aggregation data\n   * @param {string} sourceName - Source name for logging\n   * @returns {Object} Data result for sparkline rendering\n   */\n  static getEnhancedDataSourceData(currentData, dataKey, isTransformation, isAggregation, sourceName) {\n    try {\n      let enhancedValue = null;\n      let dataType = 'unknown';\n\n      if (isTransformation && currentData.transformations) {\n        enhancedValue = currentData.transformations[dataKey];\n        dataType = 'transformation';\n        console.log(`[SparklineRenderer] 🔄 Accessing transformation '${dataKey}':`, enhancedValue);\n      } else if (isAggregation && currentData.aggregations) {\n        const aggregationData = currentData.aggregations[dataKey];\n        dataType = 'aggregation';\n\n        // Handle different aggregation result types\n        if (typeof aggregationData === 'object' && aggregationData !== null) {\n          // Complex aggregation (e.g., min/max/avg object, trend object)\n          if (aggregationData.avg !== undefined) {\n            enhancedValue = aggregationData.avg;\n          } else if (aggregationData.value !== undefined) {\n            enhancedValue = aggregationData.value;\n          } else if (aggregationData.slope !== undefined) {\n            enhancedValue = aggregationData.slope;\n          } else {\n            // Use the whole object - sparkline might handle it\n            enhancedValue = aggregationData;\n          }\n        } else {\n          // Simple aggregation value\n          enhancedValue = aggregationData;\n        }\n\n        console.log(`[SparklineRenderer] 📊 Accessing aggregation '${dataKey}':`, aggregationData, '-> value:', enhancedValue);\n      }\n\n      if (enhancedValue === null || enhancedValue === undefined) {\n        return {\n          data: null,\n          status: 'ENHANCED_DATA_NOT_FOUND',\n          message: `${dataType} '${dataKey}' not found or has no data`,\n          metadata: {\n            sourceName,\n            dataKey,\n            dataType,\n            availableTransformations: Object.keys(currentData.transformations || {}),\n            availableAggregations: Object.keys(currentData.aggregations || {})\n          }\n        };\n      }\n\n      // For single values, generate synthetic historical data\n      if (typeof enhancedValue === 'number') {\n        return SparklineRenderer.generateSyntheticHistoricalData(enhancedValue, currentData, sourceName, dataKey, dataType);\n      }\n\n      // For complex objects, try to extract meaningful data\n      if (typeof enhancedValue === 'object') {\n        return SparklineRenderer.extractHistoricalFromObject(enhancedValue, currentData, sourceName, dataKey, dataType);\n      }\n\n      // Fallback for non-numeric data\n      return {\n        data: null,\n        status: 'ENHANCED_DATA_NOT_NUMERIC',\n        message: `${dataType} '${dataKey}' is not numeric: ${typeof enhancedValue}`,\n        metadata: { sourceName, dataKey, dataType, value: enhancedValue }\n      };\n\n    } catch (error) {\n      console.error(`[SparklineRenderer] Error accessing enhanced data:`, error);\n      return {\n        data: null,\n        status: 'ENHANCED_DATA_ERROR',\n        message: `Error accessing ${isTransformation ? 'transformation' : 'aggregation'} '${dataKey}': ${error.message}`,\n        metadata: { sourceName, dataKey, error: error.message }\n      };\n    }\n  }\n\n  /**\n   * Generate synthetic historical data for single enhanced values\n   * @param {number} currentValue - Current transformed/aggregated value\n   * @param {Object} currentData - Full DataSource data\n   * @param {string} sourceName - Source name\n   * @param {string} dataKey - Data key\n   * @param {string} dataType - Type of data (transformation/aggregation)\n   * @returns {Object} Data result with synthetic history\n   */\n  static generateSyntheticHistoricalData(currentValue, currentData, sourceName, dataKey, dataType) {\n    const historicalData = [];\n    const now = Date.now();\n\n    // Use buffer data if available for better synthetic generation\n    if (currentData.buffer) {\n      const bufferData = currentData.buffer.getAll();\n\n      if (bufferData.length > 1) {\n        // Apply transformation/aggregation logic to each historical point\n        bufferData.forEach(point => {\n          // This is a simplified approach - in reality, transformations should be applied to each point\n          // For now, we'll generate reasonable synthetic data based on the raw values\n          let syntheticValue = currentValue;\n\n          if (dataType === 'transformation') {\n            // Estimate transformation based on ratio to current raw value\n            const ratio = currentData.v ? currentValue / currentData.v : 1;\n            syntheticValue = point.v * ratio;\n          } else if (dataType === 'aggregation') {\n            // For aggregations, use a sliding calculation or approximation\n            syntheticValue = currentValue + (Math.random() - 0.5) * (currentValue * 0.1);\n          }\n\n          historicalData.push({\n            timestamp: point.t,\n            value: syntheticValue\n          });\n        });\n\n        console.log(`[SparklineRenderer] ✅ Generated ${historicalData.length} synthetic ${dataType} points for '${dataKey}'`);\n        return {\n          data: historicalData,\n          status: 'OK_SYNTHETIC',\n          message: `${historicalData.length} synthetic ${dataType} points`,\n          metadata: {\n            sourceName,\n            dataKey,\n            dataType,\n            synthetic: true,\n            currentValue,\n            basedOnRawData: true\n          }\n        };\n      }\n    }\n\n    // Fallback: Generate simple synthetic data\n    for (let i = 19; i >= 0; i--) {\n      const timestamp = now - i * 30000; // 30-second intervals\n      const variance = (Math.random() - 0.5) * (currentValue * 0.05); // 5% variance\n      historicalData.push({\n        timestamp,\n        value: currentValue + variance\n      });\n    }\n\n    console.log(`[SparklineRenderer] ⚠️ Generated ${historicalData.length} fallback synthetic ${dataType} points for '${dataKey}'`);\n    return {\n      data: historicalData,\n      status: 'OK_SYNTHETIC_FALLBACK',\n      message: `${historicalData.length} fallback synthetic ${dataType} points`,\n      metadata: {\n        sourceName,\n        dataKey,\n        dataType,\n        synthetic: true,\n        currentValue,\n        basedOnRawData: false\n      }\n    };\n  }\n\n  /**\n   * Extract historical data from complex aggregation objects\n   * @param {Object} aggregationObject - Complex aggregation result\n   * @param {Object} currentData - Full DataSource data\n   * @param {string} sourceName - Source name\n   * @param {string} dataKey - Data key\n   * @param {string} dataType - Type of data\n   * @returns {Object} Data result\n   */\n  static extractHistoricalFromObject(aggregationObject, currentData, sourceName, dataKey, dataType) {\n    // Handle trend objects\n    if (aggregationObject.direction && aggregationObject.slope !== undefined) {\n      return SparklineRenderer.generateSyntheticHistoricalData(\n        aggregationObject.slope,\n        currentData,\n        sourceName,\n        `${dataKey}.slope`,\n        'trend-slope'\n      );\n    }\n\n    // Handle min/max/avg objects\n    if (aggregationObject.avg !== undefined) {\n      return SparklineRenderer.generateSyntheticHistoricalData(\n        aggregationObject.avg,\n        currentData,\n        sourceName,\n        `${dataKey}.avg`,\n        'stats-average'\n      );\n    }\n\n    // Handle session stats objects\n    if (aggregationObject.count !== undefined && aggregationObject.last !== undefined) {\n      return SparklineRenderer.generateSyntheticHistoricalData(\n        aggregationObject.last,\n        currentData,\n        sourceName,\n        `${dataKey}.last`,\n        'session-last'\n      );\n    }\n\n    // Fallback for unknown object types\n    console.warn(`[SparklineRenderer] Unknown aggregation object structure for '${dataKey}':`, aggregationObject);\n    return {\n      data: null,\n      status: 'ENHANCED_OBJECT_UNKNOWN',\n      message: `Unknown aggregation object structure for '${dataKey}'`,\n      metadata: { sourceName, dataKey, dataType, objectKeys: Object.keys(aggregationObject) }\n    };\n  }\n\n  static debugSparklineUpdates() {\n    console.log('🔍 Enhanced Sparkline Update Debug Report');\n    console.log('==========================================');\n\n    const dsm = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n    if (dsm) {\n      const stats = dsm.getStats();\n      console.log('DataSourceManager stats:', stats);\n    } else {\n      console.warn('DataSourceManager not accessible via debug interface');\n    }\n  }\n\n  static debugDataSource(dataSourceName) {\n    console.log(`🔍 Enhanced Debugging data source: ${dataSourceName}`);\n    console.log('====================================================');\n\n    const dsm = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n    if (!dsm) {\n      console.error('❌ DataSourceManager not available');\n      return;\n    }\n\n    const source = dsm.getSource(dataSourceName);\n    if (!source) {\n      console.error(`❌ Source '${dataSourceName}' not found`);\n      console.log('Available sources:', Array.from(dsm.sources.keys()));\n      return;\n    }\n\n    // Detailed analysis as before...\n    return { source };\n  }\n}\n\n// Expose SparklineRenderer to window for console debugging\nif (typeof window !== 'undefined') {\n  window.SparklineRenderer = SparklineRenderer;\n}","/**\n * Line Overlay Renderer - Advanced line rendering with comprehensive styling support\n * Leverages RouterCore's sophisticated path computation and adds rich visual features\n */\n\nimport { PositionResolver } from './PositionResolver.js';\n\nexport class LineOverlayRenderer {\n  constructor(routerCore) {\n    this.routerCore = routerCore;\n\n    // Pre-defined marker templates for performance\n    this.markerCache = new Map();\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n\n    this.textAttachmentPoints = new Map();\n  }\n\n  setTextAttachmentPoints(map) {\n    this.textAttachmentPoints = map || new Map();\n  }\n\n  /**\n   * Render a line overlay with full styling support\n   * @param {Object} overlay - Line overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions for routing\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled line\n   */\n  render(overlay, anchors, viewBox) {\n    if (!this.routerCore) {\n      console.error('[LineOverlayRenderer] RouterCore not available for line rendering');\n      return '';\n    }\n\n    let anchor1 = PositionResolver.resolvePosition(overlay.anchor, anchors);\n    let anchor2 = PositionResolver.resolvePosition(overlay.attach_to, anchors);\n\n    // If attach_to not an anchor but matches a text overlay id we have attachment points\n    let attachMeta = null;\n    if (!anchor2 && overlay.attach_to && this.textAttachmentPoints.has(overlay.attach_to)) {\n      attachMeta = this.textAttachmentPoints.get(overlay.attach_to);\n      // Compute smart attachment point\n      anchor2 = this._computeTextAttachPoint(anchor1, attachMeta, overlay);\n    }\n\n    if (!anchor1 || !anchor2) {\n      console.warn(`[LineOverlayRenderer] Line ${overlay.id} missing anchor points`);\n      return '';\n    }\n\n    try {\n      // Get the computed path from RouterCore (includes all smart routing)\n      const routeRequest = this.routerCore.buildRouteRequest(overlay, anchor1, anchor2);\n      const pathResult = this.routerCore.computePath(routeRequest);\n\n      if (!pathResult?.d) {\n        console.warn(`[LineOverlayRenderer] No path computed for line ${overlay.id}`);\n        return '';\n      }\n\n      // Extract comprehensive styling\n      const style = overlay.finalStyle || overlay.style || {};\n      const lineStyle = this._resolveLineStyles(style, overlay.id);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      // Build SVG group with all features\n      const svgParts = [\n        this._buildDefinitions(lineStyle, overlay.id),\n        this._buildMainPath(pathResult.d, lineStyle, overlay.id, animationAttributes),\n        this._buildMarkers(pathResult, lineStyle, overlay.id),\n        this._buildEffects(pathResult, lineStyle, overlay.id)\n      ].filter(Boolean);\n\n      console.log(`[LineOverlayRenderer] Rendered enhanced line ${overlay.id} with ${lineStyle.features.length} features`);\n\n      return `<g data-overlay-id=\"${overlay.id}\"\n                  data-overlay-type=\"line\"\n                  data-routing-strategy=\"${pathResult.meta?.strategy || 'unknown'}\"\n                  data-animation-ready=\"${!!animationAttributes.hasAnimations}\">\n                ${svgParts.join('\\n')}\n              </g>`;\n\n    } catch (error) {\n      console.error(`[LineOverlayRenderer] Enhanced rendering failed for line ${overlay.id}:`, error);\n      return this._renderFallbackLine(overlay, anchor1, anchor2);\n    }\n  }\n\n  /**\n   * Resolve comprehensive line styling from configuration\n   * @private\n   * @param {Object} style - Final resolved style object\n   * @param {string} overlayId - Overlay ID for unique identifiers\n   * @returns {Object} Complete line style configuration\n   */\n  _resolveLineStyles(style, overlayId) {\n    const lineStyle = {\n      // Core stroke properties\n      color: style.color || style.stroke || 'var(--lcars-orange)',\n      width: Number(style.width || style.stroke_width || style.strokeWidth || 2),\n      opacity: Number(style.opacity || 1),\n\n      // Advanced stroke styling\n      lineCap: (style.line_cap || style.lineCap || style.strokeLinecap || 'round').toLowerCase(),\n      lineJoin: (style.line_join || style.lineJoin || style.strokeLinejoin || 'round').toLowerCase(),\n      miterLimit: Number(style.miter_limit || style.miterLimit || 4),\n\n      // Dash patterns\n      dashArray: style.dash_array || style.dashArray || style.strokeDasharray || null,\n      dashOffset: Number(style.dash_offset || style.dashOffset || style.strokeDashoffset || 0),\n\n      // Fill properties (for thick lines or special effects)\n      fill: style.fill || 'none',\n      fillOpacity: Number(style.fill_opacity || style.fillOpacity || 1),\n\n      // Gradient and pattern support\n      gradient: this._parseGradientConfig(style.gradient),\n      pattern: this._parsePatternConfig(style.pattern),\n\n      // Markers (arrowheads, dots, etc.)\n      markerStart: this._parseMarkerConfig(style.marker_start || style.markerStart),\n      markerMid: this._parseMarkerConfig(style.marker_mid || style.markerMid),\n      markerEnd: this._parseMarkerConfig(style.marker_end || style.markerEnd),\n\n      // Effects\n      glow: this._parseGlowConfig(style.glow),\n      shadow: this._parseShadowConfig(style.shadow),\n\n      // Animation states (for future anime.js integration)\n      animatable: style.animatable !== false,\n      pulseSpeed: Number(style.pulse_speed || 0),\n      flowSpeed: Number(style.flow_speed || 0),\n\n      // LCARS-specific features\n      segment_colors: this._parseSegmentColors(style.segment_colors),\n      status_indicator: style.status_indicator || null,\n\n      // Track enabled features for optimization\n      features: []\n    };\n\n    // Build feature list for conditional rendering\n    if (lineStyle.gradient) lineStyle.features.push('gradient');\n    if (lineStyle.pattern) lineStyle.features.push('pattern');\n    if (lineStyle.markerStart || lineStyle.markerMid || lineStyle.markerEnd) lineStyle.features.push('markers');\n    if (lineStyle.glow) lineStyle.features.push('glow');\n    if (lineStyle.shadow) lineStyle.features.push('shadow');\n    if (lineStyle.segment_colors) lineStyle.features.push('segments');\n    if (lineStyle.pulseSpeed > 0) lineStyle.features.push('pulse');\n    if (lineStyle.flowSpeed > 0) lineStyle.features.push('flow');\n\n    return lineStyle;\n  }\n\n  /**\n   * Parse gradient configuration\n   * @private\n   */\n  _parseGradientConfig(gradientConfig) {\n    if (!gradientConfig) return null;\n\n    if (typeof gradientConfig === 'string') {\n      // Simple gradient: \"red-to-blue\" or \"#ff0000-to-#0000ff\"\n      const match = gradientConfig.match(/^(.+?)-to-(.+)$/);\n      if (match) {\n        return {\n          type: 'linear',\n          direction: 'horizontal',\n          stops: [\n            { offset: '0%', color: match[1].trim() },\n            { offset: '100%', color: match[2].trim() }\n          ]\n        };\n      }\n      return null;\n    }\n\n    if (typeof gradientConfig === 'object') {\n      return {\n        type: gradientConfig.type || 'linear',\n        direction: gradientConfig.direction || 'horizontal',\n        stops: gradientConfig.stops || [\n          { offset: '0%', color: gradientConfig.from || '#ff6600' },\n          { offset: '100%', color: gradientConfig.to || '#ffcc00' }\n        ]\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse pattern configuration\n   * @private\n   */\n  _parsePatternConfig(patternConfig) {\n    if (!patternConfig) return null;\n\n    if (typeof patternConfig === 'string') {\n      // Predefined patterns: \"dots\", \"diagonal\", \"grid\"\n      return { type: patternConfig, size: 8, color: 'currentColor' };\n    }\n\n    if (typeof patternConfig === 'object') {\n      return {\n        type: patternConfig.type || 'dots',\n        size: Number(patternConfig.size || 8),\n        color: patternConfig.color || 'currentColor',\n        opacity: Number(patternConfig.opacity || 0.5)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse marker configuration (arrows, dots, etc.)\n   * @private\n   */\n  _parseMarkerConfig(markerConfig) {\n    if (!markerConfig) return null;\n\n    if (typeof markerConfig === 'string') {\n      // Predefined markers: \"arrow\", \"dot\", \"diamond\"\n      return { type: markerConfig, size: 'medium', color: 'inherit' };\n    }\n\n    if (typeof markerConfig === 'object') {\n      return {\n        type: markerConfig.type || 'arrow',\n        size: markerConfig.size || 'medium',\n        color: markerConfig.color || 'inherit',\n        rotate: markerConfig.rotate !== false\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse glow effect configuration\n   * @private\n   */\n  _parseGlowConfig(glowConfig) {\n    if (!glowConfig) return null;\n\n    if (glowConfig === true) {\n      return { color: 'currentColor', size: 4, opacity: 0.6 };\n    }\n\n    if (typeof glowConfig === 'object') {\n      return {\n        color: glowConfig.color || 'currentColor',\n        size: Number(glowConfig.size || 4),\n        opacity: Number(glowConfig.opacity || 0.6)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse shadow effect configuration\n   * @private\n   */\n  _parseShadowConfig(shadowConfig) {\n    if (!shadowConfig) return null;\n\n    if (shadowConfig === true) {\n      return { color: 'rgba(0,0,0,0.3)', offset: [2, 2], blur: 3 };\n    }\n\n    if (typeof shadowConfig === 'object') {\n      return {\n        color: shadowConfig.color || 'rgba(0,0,0,0.3)',\n        offset: shadowConfig.offset || [2, 2],\n        blur: Number(shadowConfig.blur || 3)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse segment colors configuration\n   * @private\n   */\n  _parseSegmentColors(segmentConfig) {\n    if (!segmentConfig || !Array.isArray(segmentConfig)) return null;\n\n    return segmentConfig.map(segment => ({\n      color: segment.color || 'var(--lcars-orange)',\n      start: Number(segment.start || 0),\n      end: Number(segment.end || 1)\n    }));\n  }\n\n  /**\n   * Build SVG definitions for gradients, patterns, markers, and effects\n   * @private\n   */\n  _buildDefinitions(lineStyle, overlayId) {\n    const defs = [];\n\n    // Gradients\n    if (lineStyle.gradient) {\n      defs.push(this._createGradientDefinition(lineStyle.gradient, overlayId));\n    }\n\n    // Patterns\n    if (lineStyle.pattern) {\n      defs.push(this._createPatternDefinition(lineStyle.pattern, overlayId));\n    }\n\n    // Markers\n    ['markerStart', 'markerMid', 'markerEnd'].forEach(markerType => {\n      if (lineStyle[markerType]) {\n        defs.push(this._createMarkerDefinition(lineStyle[markerType], overlayId, markerType));\n      }\n    });\n\n    // Effects (filters)\n    if (lineStyle.glow) {\n      defs.push(this._createGlowFilter(lineStyle.glow, overlayId));\n    }\n\n    if (lineStyle.shadow) {\n      defs.push(this._createShadowFilter(lineStyle.shadow, overlayId));\n    }\n\n    return defs.length > 0 ? `<defs>${defs.join('\\n')}</defs>` : '';\n  }\n\n  /**\n   * Create gradient definition\n   * @private\n   */\n  _createGradientDefinition(gradient, overlayId) {\n    const gradientId = `line-gradient-${overlayId}`;\n\n    if (gradient.type === 'radial') {\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<radialGradient id=\"${gradientId}\">${stops}</radialGradient>`;\n    } else {\n      // Linear gradient\n      const coords = this._getLinearGradientCoords(gradient.direction);\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<linearGradient id=\"${gradientId}\" ${coords}>${stops}</linearGradient>`;\n    }\n  }\n\n  /**\n   * Get linear gradient coordinates based on direction\n   * @private\n   */\n  _getLinearGradientCoords(direction) {\n    const directions = {\n      horizontal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"',\n      vertical: 'x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      diagonal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"',\n      'diagonal-reverse': 'x1=\"100%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"'\n    };\n    return directions[direction] || directions.horizontal;\n  }\n\n  /**\n   * Create pattern definition\n   * @private\n   */\n  _createPatternDefinition(pattern, overlayId) {\n    const patternId = `line-pattern-${overlayId}`;\n    const size = pattern.size;\n\n    let patternContent = '';\n\n    switch (pattern.type) {\n      case 'dots':\n        patternContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"1\" fill=\"${pattern.color}\" opacity=\"${pattern.opacity}\"/>`;\n        break;\n      case 'diagonal':\n        patternContent = `<path d=\"M0,${size} L${size},0\" stroke=\"${pattern.color}\" stroke-width=\"1\" opacity=\"${pattern.opacity}\"/>`;\n        break;\n      case 'grid':\n        patternContent = `\n          <path d=\"M0,0 L0,${size}\" stroke=\"${pattern.color}\" stroke-width=\"0.5\" opacity=\"${pattern.opacity}\"/>\n          <path d=\"M0,0 L${size},0\" stroke=\"${pattern.color}\" stroke-width=\"0.5\" opacity=\"${pattern.opacity}\"/>\n        `;\n        break;\n    }\n\n    return `<pattern id=\"${patternId}\" x=\"0\" y=\"0\" width=\"${size}\" height=\"${size}\" patternUnits=\"userSpaceOnUse\">\n              ${patternContent}\n            </pattern>`;\n  }\n\n  /**\n   * Create marker definition (arrows, dots, etc.)\n   * @private\n   */\n  _createMarkerDefinition(marker, overlayId, markerType) {\n    const markerId = `line-marker-${overlayId}-${markerType}`;\n    const size = this._getMarkerSize(marker.size);\n\n    let markerContent = '';\n    let viewBox = `0 0 ${size} ${size}`;\n    let refX = size / 2;\n    let refY = size / 2;\n\n    switch (marker.type) {\n      case 'arrow':\n        viewBox = '0 0 10 10';\n        refX = 8;\n        refY = 5;\n        markerContent = `<path d=\"M2,2 L8,5 L2,8 z\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n      case 'dot':\n        markerContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/4}\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n      case 'diamond':\n        markerContent = `<path d=\"M${size/2},2 L${size-2},${size/2} L${size/2},${size-2} L2,${size/2} z\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n      case 'square':\n        markerContent = `<rect x=\"2\" y=\"2\" width=\"${size-4}\" height=\"${size-4}\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n    }\n\n    return `<marker id=\"${markerId}\"\n                    viewBox=\"${viewBox}\"\n                    refX=\"${refX}\" refY=\"${refY}\"\n                    markerWidth=\"${size}\" markerHeight=\"${size}\"\n                    markerUnits=\"strokeWidth\"\n                    orient=\"${marker.rotate ? 'auto' : '0'}\">\n              ${markerContent}\n            </marker>`;\n  }\n\n  /**\n   * Get numeric marker size from size descriptor\n   * @private\n   */\n  _getMarkerSize(size) {\n    const sizes = { small: 6, medium: 8, large: 12, xlarge: 16 };\n    return sizes[size] || Number(size) || 8;\n  }\n\n  /**\n   * Create glow filter definition\n   * @private\n   */\n  _createGlowFilter(glow, overlayId) {\n    const filterId = `line-glow-${overlayId}`;\n\n    return `<filter id=\"${filterId}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feGaussianBlur stdDeviation=\"${glow.size}\" result=\"coloredBlur\"/>\n              <feMerge>\n                <feMergeNode in=\"coloredBlur\"/>\n                <feMergeNode in=\"SourceGraphic\"/>\n              </feMerge>\n            </filter>`;\n  }\n\n  /**\n   * Create drop shadow filter definition\n   * @private\n   */\n  _createShadowFilter(shadow, overlayId) {\n    const filterId = `line-shadow-${overlayId}`;\n    const [dx, dy] = shadow.offset;\n\n    return `<filter id=\"${filterId}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feDropShadow dx=\"${dx}\" dy=\"${dy}\"\n                           stdDeviation=\"${shadow.blur}\"\n                           flood-color=\"${shadow.color}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Build the main path element with all styling\n   * @private\n   */\n  _buildMainPath(pathData, lineStyle, overlayId, animationAttributes) {\n    const attributes = [];\n\n    // Core path and styling\n    attributes.push(`d=\"${pathData}\"`);\n    attributes.push(`fill=\"${lineStyle.fill}\"`);\n    attributes.push(`fill-opacity=\"${lineStyle.fillOpacity}\"`);\n\n    // Stroke styling\n    if (lineStyle.gradient) {\n      attributes.push(`stroke=\"url(#line-gradient-${overlayId})\"`);\n    } else if (lineStyle.pattern) {\n      attributes.push(`stroke=\"url(#line-pattern-${overlayId})\"`);\n    } else {\n      attributes.push(`stroke=\"${lineStyle.color}\"`);\n    }\n\n    attributes.push(`stroke-width=\"${lineStyle.width}\"`);\n    attributes.push(`stroke-opacity=\"${lineStyle.opacity}\"`);\n    attributes.push(`stroke-linecap=\"${lineStyle.lineCap}\"`);\n    attributes.push(`stroke-linejoin=\"${lineStyle.lineJoin}\"`);\n\n    if (lineStyle.lineJoin === 'miter' && lineStyle.miterLimit !== 4) {\n      attributes.push(`stroke-miterlimit=\"${lineStyle.miterLimit}\"`);\n    }\n\n    if (lineStyle.dashArray) {\n      attributes.push(`stroke-dasharray=\"${lineStyle.dashArray}\"`);\n      if (lineStyle.dashOffset !== 0) {\n        attributes.push(`stroke-dashoffset=\"${lineStyle.dashOffset}\"`);\n      }\n    }\n\n    // Markers\n    if (lineStyle.markerStart) {\n      attributes.push(`marker-start=\"url(#line-marker-${overlayId}-markerStart)\"`);\n    }\n    if (lineStyle.markerMid) {\n      attributes.push(`marker-mid=\"url(#line-marker-${overlayId}-markerMid)\"`);\n    }\n    if (lineStyle.markerEnd) {\n      attributes.push(`marker-end=\"url(#line-marker-${overlayId}-markerEnd)\"`);\n    }\n\n    // Effects\n    const filters = [];\n    if (lineStyle.glow) filters.push(`url(#line-glow-${overlayId})`);\n    if (lineStyle.shadow) filters.push(`url(#line-shadow-${overlayId})`);\n    if (filters.length > 0) {\n      attributes.push(`filter=\"${filters.join(' ')}\"`);\n    }\n\n    // Animation attributes (for future anime.js integration)\n    attributes.push(...animationAttributes.pathAttributes);\n\n    return `<path ${attributes.join(' ')}/>`;\n  }\n\n  /**\n   * Build additional marker elements (beyond standard markers)\n   * @private\n   */\n  _buildMarkers(pathResult, lineStyle, overlayId) {\n    // Future: Add custom markers along path at specific positions\n    return '';\n  }\n\n  /**\n   * Build special effects elements\n   * @private\n   */\n  _buildEffects(pathResult, lineStyle, overlayId) {\n    const effects = [];\n\n    // Future: Add flowing particles, pulse effects, etc.\n    if (lineStyle.features.includes('flow')) {\n      // Placeholder for flow animation elements\n    }\n\n    if (lineStyle.features.includes('pulse')) {\n      // Placeholder for pulse animation elements\n    }\n\n    return effects.join('\\n');\n  }\n\n  /**\n   * Prepare animation attributes for future anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    const animationAttributes = {\n      hasAnimations: false,\n      pathAttributes: [],\n      groupAttributes: []\n    };\n\n    // Animation hooks for future implementation\n    if (style.animatable !== false) {\n      animationAttributes.pathAttributes.push(`data-animatable=\"true\"`);\n    }\n\n    if (style.pulse_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-pulse-speed=\"${style.pulse_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.flow_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-flow-speed=\"${style.flow_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    // Add animation reference if specified\n    if (overlay._raw?.animation_ref) {\n      animationAttributes.groupAttributes.push(`data-animation-ref=\"${overlay._raw.animation_ref}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Render a simple fallback line when enhanced rendering fails\n   * @private\n   */\n  _renderFallbackLine(overlay, anchor1, anchor2) {\n    const [x1, y1] = anchor1;\n    const [x2, y2] = anchor2;\n    const style = overlay.finalStyle || overlay.style || {};\n    const color = style.color || 'var(--lcars-orange)';\n    const width = style.width || 2;\n\n    console.warn(`[LineOverlayRenderer] Using fallback rendering for line ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"line\" data-fallback=\"true\">\n              <line x1=\"${x1}\" y1=\"${y1}\" x2=\"${x2}\" y2=\"${y2}\"\n                    stroke=\"${color}\" stroke-width=\"${width}\"\n                    stroke-linecap=\"round\" fill=\"none\"/>\n            </g>`;\n  }\n\n  /**\n   * Update line styling dynamically (for future real-time updates)\n   * @public\n   */\n  updateLineStyle(overlayId, newStyle) {\n    // Future: Update existing line styles without full re-render\n    console.log(`[LineOverlayRenderer] Style update requested for line ${overlayId}`);\n  }\n\n  /**\n   * Get rendering capabilities and features supported\n   * @public\n   */\n  getCapabilities() {\n    return {\n      routing: true,\n      gradients: true,\n      patterns: true,\n      markers: ['arrow', 'dot', 'diamond', 'square'],\n      effects: ['glow', 'shadow'],\n      animations: ['pulse', 'flow'], // Future implementation\n      segmentColors: true,\n      dashPatterns: true,\n      advanced: true\n    };\n  }\n\n  /**\n   * Choose attachment point on target text overlay bbox, honoring attach_side or auto.\n   * Applies configurable gap (attach_gap | gap | line_gap) in outward normal direction.\n   */\n  _computeTextAttachPoint(origin, attachMeta, overlay) {\n    if (!origin || !attachMeta) return attachMeta?.center;\n\n    const raw = overlay._raw || overlay.raw || overlay;\n    const sidePref = (raw.attach_side || raw.attachSide || 'auto').toLowerCase();\n    const gapRaw = raw.attach_gap ?? raw.attachment_gap ?? raw.line_gap ?? raw.gap;\n    const gap = Number(gapRaw ?? 4);\n    const { bbox, points } = attachMeta;\n    const center = points.center;\n    let side = sidePref;\n\n    if (side === 'auto') {\n      const dx = origin[0] - center[0];\n      const dy = origin[1] - center[1];\n      if (Math.abs(dx) >= Math.abs(dy)) {\n        side = dx <= 0 ? 'left' : 'right';\n      } else {\n        side = dy <= 0 ? 'top' : 'bottom';\n      }\n    }\n\n    let basePoint;\n    let outward = [0,0];\n    switch (side) {\n      case 'left':\n      case 'left-center':\n        basePoint = [bbox.left, center[1]];\n        outward = [-1,0];\n        break;\n      case 'right':\n      case 'right-center':\n        basePoint = [bbox.right, center[1]];\n        outward = [1,0];\n        break;\n      case 'top':\n      case 'top-center':\n        basePoint = [center[0], bbox.top];\n        outward = [0,-1];\n        break;\n      case 'bottom':\n      case 'bottom-center':\n        basePoint = [center[0], bbox.bottom];\n        outward = [0,1];\n        break;\n      default:\n        basePoint = [bbox.left, center[1]];\n        outward = [-1,0];\n    }\n\n    // Apply gap outward\n    const attachPoint = [\n      basePoint[0] + outward[0] * gap,\n      basePoint[1] + outward[1] * gap\n    ];\n\n    // Store meta for potential debug / future features\n    overlay._attachComputed = {\n      targetOverlay: attachMeta.id,\n      sideChosen: side,\n      gap,\n      basePoint,\n      attachPoint\n    };\n\n    return attachPoint;\n  }\n}","/**\n * Advanced Renderer - Clean implementation for MSD v1\n * Main orchestrator that delegates to specialized renderers\n */\n\nimport { TextOverlayRenderer } from './TextOverlayRenderer.js';\nimport { SparklineRenderer } from './SparklineRenderer.js';\nimport { LineOverlayRenderer } from './LineOverlayRenderer.js';\nimport { StatusGridRenderer } from './StatusGridRenderer.js';\nimport { RendererUtils } from './RendererUtils.js';\n\nexport class AdvancedRenderer {\n  constructor(mountEl, routerCore, systemsManager = null) {\n    this.mountEl = mountEl;\n    this.routerCore = routerCore;\n    this.systemsManager = systemsManager; // ADDED: Store reference to systems manager\n    this.overlayElements = new Map();\n    this.lastRenderArgs = null;\n    this.lineRenderer = new LineOverlayRenderer(routerCore);\n\n    // Track overlay elements for efficient updates\n    this.overlayElementCache = new Map(); // overlayId -> DOM element\n    this.textAttachmentPoints = new Map();\n    this._lineDeps = new Map(); // targetOverlayId -> Set(lineOverlayId)\n  }\n\n  render(resolvedModel) {\n\n    console.log('[MSD DEBUG] 🎨 AdvancedRenderer.render() ENTRY:', {\n      timestamp: new Date().toISOString(),\n      hasResolvedModel: !!resolvedModel,\n      overlayCount: resolvedModel?.overlays?.length || 0,\n      anchorCount: resolvedModel?.anchors ? Object.keys(resolvedModel.anchors).length : 0,\n      hasViewBox: !!resolvedModel?.viewBox,\n      mountElExists: !!this.mountEl,\n      stackTrace: new Error().stack.split('\\n').slice(1, 3).join('\\n')\n    });\n\n    if (!resolvedModel) {\n      console.error('[MSD DEBUG] ❌ AdvancedRenderer.render() - No resolved model provided');\n      return { svgMarkup: '', overlayCount: 0 };\n    }\n    const { overlays = [], anchors = {}, viewBox } = resolvedModel;\n    console.log(`[MSD DEBUG] 🎨 AdvancedRenderer processing:`, {\n      overlayCount: overlays.length,\n      overlayTypes: overlays.map(o => o.type),\n      anchorCount: Object.keys(anchors).length,\n      viewBox\n    });\n    this.overlayElements.clear();\n    // Phase rendering requires live SVG early\n    const svg = this.mountEl?.querySelector('svg');\n    if (!svg) {\n      console.error('[MSD DEBUG] ❌ AdvancedRenderer.render() - SVG element not found in container:', {\n        mountEl: this.mountEl,\n        mountElTagName: this.mountEl?.tagName,\n        mountElChildren: this.mountEl?.children?.length || 0\n      });\n      return { svgMarkup: '', overlayCount: 0 };\n    }\n\n    console.log('[MSD DEBUG] ✅ SVG element found, proceeding with overlay rendering');\n\n    // Prepare / clear overlay group\n    const overlayGroup = this._ensureOverlayGroup(svg);\n    overlayGroup.innerHTML = '';\n    this.overlayElementCache.clear();\n\n    // Precompute text attachment points (unchanged)\n    this.textAttachmentPoints.clear();\n    overlays.filter(o => o.type === 'text').forEach(tov => {\n      const ap = TextOverlayRenderer.computeAttachmentPoints(tov, anchors, this.mountEl);\n      if (ap) this.textAttachmentPoints.set(tov.id, ap);\n    });\n    this.lineRenderer.setTextAttachmentPoints(this.textAttachmentPoints);\n\n    // Phase 1: render overlays that others may depend on (text, sparkline)\n    const earlyTypes = new Set(['text', 'sparkline']);\n    let svgMarkupAccum = '';\n    let processedCount = 0;\n    overlays.filter(o => earlyTypes.has(o.type)).forEach(ov => {\n      try {\n        const html = this.renderOverlay(ov, anchors, viewBox);\n        if (html) {\n          svgMarkupAccum += html;\n        }\n        processedCount++;\n      } catch (e) {\n        console.warn('[AdvancedRenderer] Phase1 failed for', ov.id, e);\n      }\n    });\n    overlayGroup.innerHTML = svgMarkupAccum;\n    this._cacheElementsFrom(overlayGroup);\n\n    // Build dynamic anchors (overlay destinations)\n    this._dynamicAnchors = { ...anchors };\n    this._buildDynamicOverlayAnchors(overlays, this._dynamicAnchors);\n\n    // Phase 2: render line overlays (now DOM for targets exists)\n    overlays.filter(o => !earlyTypes.has(o.type)).forEach(ov => {\n      try {\n        const html = this.renderOverlay(ov, this._dynamicAnchors, viewBox); // pass dynamic anchors\n        if (html) {\n          overlayGroup.insertAdjacentHTML('beforeend', html);\n          svgMarkupAccum += html;\n          const el = overlayGroup.querySelector(`[data-overlay-id=\"${ov.id}\"]`);\n          if (el) this.overlayElementCache.set(ov.id, el);\n          const raw = ov._raw || ov.raw || {};\n          const targetId = raw.attach_to || raw.attachTo;\n          if (targetId) {\n            if (!this._lineDeps.has(targetId)) this._lineDeps.set(targetId, new Set());\n            this._lineDeps.get(targetId).add(ov.id);\n\n            // NEW: ensure RouterCore sees a route for overlay-destination line (HUD listing)\n            if (this.routerCore && raw.anchor && this._dynamicAnchors[raw.anchor] && this._dynamicAnchors[targetId]) {\n              try {\n                const req = this.routerCore.buildRouteRequest(\n                  ov,\n                  this._dynamicAnchors[raw.anchor],\n                  this._dynamicAnchors[targetId]\n                );\n                this.routerCore.computePath(req);\n              } catch (e) {\n                console.warn('[AdvancedRenderer] Overlay-destination route registration failed', ov.id, e);\n              }\n            }\n          }\n        }\n        processedCount++;\n      } catch (e) {\n        console.warn('[AdvancedRenderer] Phase2 failed for', ov.id, e);\n      }\n    });\n\n    console.log('[AdvancedRenderer] Injected elements (after phased render):', {\n      total: this.overlayElementCache.size,\n      text: overlayGroup.querySelectorAll('[data-overlay-type=\"text\"]').length,\n      lines: overlayGroup.querySelectorAll('[data-overlay-type=\"line\"]').length,\n      sparklines: overlayGroup.querySelectorAll('[data-overlay-type=\"sparkline\"]').length\n    });\n\n    // NEW: schedule deferred line refresh to fix first-load orientation/position\n    this._scheduleDeferredLineRefresh(overlays, this._dynamicAnchors, viewBox);\n\n    // NEW: schedule font stabilization pass (re-measure after real fonts load)\n    this._scheduleFontStabilization(overlays, this._dynamicAnchors, viewBox);\n\n    this.lastRenderArgs = { resolvedModel, overlays, svg };\n    return {\n      svgMarkup: svgMarkupAccum,\n      overlayCount: processedCount,\n      errors: overlays.length - processedCount\n    };\n  }\n\n  _ensureOverlayGroup(svg) {\n    let group = svg.querySelector('#msd-overlay-container');\n    if (!group) {\n      group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n      group.setAttribute('id', 'msd-overlay-container');\n      svg.appendChild(group);\n    }\n    return group;\n  }\n\n  _cacheElementsFrom(group) {\n    const nodes = group.querySelectorAll('[data-overlay-id]');\n    nodes.forEach(el => {\n      const id = el.getAttribute('data-overlay-id');\n      if (id) this.overlayElementCache.set(id, el);\n    });\n  }\n\n  // NEW: build virtual anchors for lines that attach to overlays\n  _buildDynamicOverlayAnchors(overlays, anchorMap) {\n    overlays.filter(o => o.type === 'line').forEach(line => {\n      const raw = line._raw || line.raw || {};\n      const dest = raw.attach_to || raw.attachTo;\n      if (!dest) return;\n      const tap = this.textAttachmentPoints.get(dest);\n      if (!tap || !tap.points) return;\n      const side = (raw.attach_side || raw.attachSide || '').toLowerCase();\n      const basePt = this._resolveOverlayAttachmentPoint(tap.points, side);\n      if (!basePt) return;\n      const gapPt = this._applyAttachGap(basePt, side, raw, tap.bbox);\n      anchorMap[dest] = gapPt;\n      // Register in routerCore so HUD sees it as an anchor\n      if (this.routerCore && this.routerCore.anchors) {\n        this.routerCore.anchors[dest] = gapPt;\n        try {\n          this.routerCore.invalidate(line.id);\n          const srcAnchor = anchorMap[raw.anchor] || this.routerCore.anchors[raw.anchor];\n          if (srcAnchor) {\n            const req = this.routerCore.buildRouteRequest(line, srcAnchor, gapPt);\n            this.routerCore.computePath(req);\n          }\n        } catch(e) {\n          console.warn('[AdvancedRenderer] Route registration (initial) failed', line.id, e);\n        }\n      }\n      // Track dependency\n      if (!this._lineDeps.has(dest)) this._lineDeps.set(dest, new Set());\n      this._lineDeps.get(dest).add(line.id);\n    });\n  }\n\n  // NEW: update dynamic anchors for changed text overlays\n  _updateDynamicAnchorsForOverlays(changedIds, overlays, anchorMap) {\n    if (!changedIds.size) return;\n    changedIds.forEach(id => {\n      const tap = this.textAttachmentPoints.get(id);\n      if (!tap || !tap.points) return;\n      const dep = this._lineDeps.get(id);\n      if (!dep) return;\n      dep.forEach(lineId => {\n        const line = overlays.find(o => o.id === lineId);\n        if (!line) return;\n        const raw = line._raw || line.raw || {};\n        const side = (raw.attach_side || raw.attachSide || '').toLowerCase();\n        const basePt = this._resolveOverlayAttachmentPoint(tap.points, side);\n        if (!basePt) return;\n        const gapPt = this._applyAttachGap(basePt, side, raw, tap.bbox);\n        anchorMap[id] = gapPt;\n        if (this.routerCore && this.routerCore.anchors) {\n          this.routerCore.anchors[id] = gapPt;\n          try {\n            this.routerCore.invalidate(line.id);\n            const srcAnchor = anchorMap[raw.anchor] || this.routerCore.anchors[raw.anchor];\n            if (srcAnchor) {\n              const req = this.routerCore.buildRouteRequest(line, srcAnchor, gapPt);\n              this.routerCore.computePath(req);\n            }\n          } catch(e) {\n            console.warn('[AdvancedRenderer] Route registration (update) failed', line.id, e);\n          }\n        }\n      });\n    });\n  }\n\n  // NEW: apply attach_gap offsets\n  _applyAttachGap(point, side, raw, bbox) {\n    const gap = Number(raw.attach_gap || raw.attachGap || 0);\n    const gapX = Number(raw.attach_gap_x || raw.attachGapX || gap || 0);\n    const gapY = Number(raw.attach_gap_y || raw.attachGapY || gap || 0);\n    if (!(gapX || gapY)) return point;\n    const [x, y] = point;\n    let dx = 0, dy = 0;\n    switch (side) {\n      case 'left': dx = -gapX; break;\n      case 'right': dx = gapX; break;\n      case 'top': dy = -gapY; break;\n      case 'bottom': dy = gapY; break;\n      case 'top-left': dx = -gapX; dy = -gapY; break;\n      case 'top-right': dx = gapX; dy = -gapY; break;\n      case 'bottom-left': dx = -gapX; dy = gapY; break;\n      case 'bottom-right': dx = gapX; dy = gapY; break;\n      default: break;\n    }\n    // Optional: ensure gap extends outward (based on bbox) if bbox provided\n    if (bbox) {\n      if (side.includes('left') && x > bbox.left) dx = -Math.abs(dx);\n      if (side.includes('right') && x < bbox.right) dx = Math.abs(dx);\n      if (side.includes('top') && y > bbox.top) dy = -Math.abs(dy);\n      if (side.includes('bottom') && y < bbox.bottom) dy = Math.abs(dy);\n    }\n    return [x + dx, y + dy];\n  }\n\n  // NEW: resolve which attachment point to use based on side keyword\n  _resolveOverlayAttachmentPoint(points, side) {\n    if (!points) return null;\n    switch (side) {\n      case 'left': return points.left || points.leftPadded || points.center;\n      case 'right': return points.right || points.rightPadded || points.center;\n      case 'top': return points.top || points.topPadded || points.center;\n      case 'bottom': return points.bottom || points.bottomPadded || points.center;\n      case 'top-left': return points.topLeft || points.left || points.top || points.center;\n      case 'top-right': return points.topRight || points.right || points.top || points.center;\n      case 'bottom-left': return points.bottomLeft || points.left || points.bottom || points.center;\n      case 'bottom-right': return points.bottomRight || points.right || points.bottom || points.center;\n      case 'center':\n      default:\n        return points.center;\n    }\n  }\n\n  // UPDATED: font stabilization pass using actual DOM glyph metrics (multi-pass) with better async handling\n  _scheduleFontStabilization(overlays, anchorsRef, viewBox) {\n    if (!overlays.some(o => o.type === 'text')) return;\n    const MAX_PASSES = 10;\n    const EXTRA_PASSES = 5; // safety extra passes after fonts load\n    const TOL = 0.01;\n    let pass = 0;\n    const run = () => {\n      const changedTargets = new Set();\n      let anyUnstable = false;\n      overlays.filter(o=>o.type==='text').forEach(ov => {\n        const group = this.overlayElementCache.get(ov.id);\n        if (!group) return;\n        const bb = RendererUtils.getDomTextBBox(group);\n        if (!bb) { anyUnstable = true; return; }\n        const recordedW = parseFloat(group.getAttribute('data-text-width')||'0')||0;\n        const recordedH = parseFloat(group.getAttribute('data-text-height')||'0')||0;\n        const diffW = Math.abs(bb.width - recordedW);\n        const diffH = Math.abs(bb.height - recordedH);\n        const needsRerender = (diffW > TOL) || (diffH > TOL);\n\n        if (needsRerender) {\n          const newGroup = this._reRenderSingleTextOverlay(ov, anchorsRef, viewBox);\n          if (newGroup) {\n            const bb2 = RendererUtils.getDomTextBBox(newGroup);\n            if (bb2) {\n              newGroup.setAttribute('data-text-width', String(bb2.width));\n              newGroup.setAttribute('data-text-height', String(bb2.height));\n              this._updateStatusIndicatorPosition(newGroup, bb2);\n            }\n            changedTargets.add(ov.id);\n            anyUnstable = true;\n          }\n        } else {\n          if (diffW > 0 || diffH > 0) {\n            group.setAttribute('data-text-width', String(bb.width));\n            group.setAttribute('data-text-height', String(bb.height));\n            changedTargets.add(ov.id);\n          }\n          if (group.getAttribute('data-font-stabilized') !== '1') {\n            group.setAttribute('data-font-stabilized','1');\n          }\n          this._updateTextAttachmentPointsFromDom(ov, group, bb);\n          // NEW: always update status indicator position even without re-render\n          this._updateStatusIndicatorPosition(group, bb);\n        }\n      });\n\n      this.lineRenderer.setTextAttachmentPoints(this.textAttachmentPoints);\n\n      if (changedTargets.size) {\n        this._updateDynamicAnchorsForOverlays(changedTargets, overlays, this._dynamicAnchors);\n        this._rerenderDependentLines(changedTargets, overlays, this._dynamicAnchors, viewBox);\n      }\n\n      pass++;\n      const morePassesAllowed = pass < (MAX_PASSES + EXTRA_PASSES);\n      if ((changedTargets.size || anyUnstable) && morePassesAllowed) {\n        requestAnimationFrame(run);\n      } else {\n        if (changedTargets.size) {\n          this._scheduleDeferredLineRefresh(overlays, this._dynamicAnchors, viewBox);\n        }\n        // Final safety delayed pass in case font finished loading just after loop\n        setTimeout(() => {\n          const remaining = overlays.filter(o=>o.type==='text')\n            .some(o => {\n              const g = this.overlayElementCache.get(o.id);\n              return g && g.getAttribute('data-font-stabilized') !== '1';\n            });\n          if (remaining) {\n            console.log('[AdvancedRenderer] Running safety stabilization pass');\n            pass = 0;\n            requestAnimationFrame(run);\n          }\n        }, 180);\n        console.log('[AdvancedRenderer] Font stabilization complete', { passes: pass, changed: Array.from(changedTargets) });\n      }\n    };\n\n    // Wait for font faces if still loading\n    const fontAPI = document.fonts;\n    if (fontAPI && fontAPI.status !== 'loaded') {\n      fontAPI.ready.then(() => requestAnimationFrame(run)).catch(() => requestAnimationFrame(run));\n    } else {\n      requestAnimationFrame(run);\n    }\n  }\n\n  // UPDATED signature usages for dynamic anchors\n  _scheduleDeferredLineRefresh(overlays, anchorsRef, viewBox) {\n    if (typeof requestAnimationFrame !== 'function') return;\n    const lineOverlays = overlays.filter(o =>\n      o.type === 'line' &&\n      ((o._raw || o.raw || {}).attach_side || (o._raw || o.raw || {}).attach_to)\n    );\n    if (!lineOverlays.length) return;\n    requestAnimationFrame(() => {\n      lineOverlays.forEach(ov => {\n        const existingEl = this.overlayElementCache.get(ov.id);\n        if (!existingEl) return;\n        try {\n          const newMarkup = this.lineRenderer.render(ov, anchorsRef, viewBox);\n          if (!newMarkup) return;\n          // Parse markup into element\n          const temp = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n          temp.innerHTML = newMarkup.trim();\n          const newEl = temp.firstElementChild;\n          if (!newEl) return;\n            existingEl.replaceWith(newEl);\n          this.overlayElementCache.set(ov.id, newEl);\n        } catch (e) {\n          console.warn('[AdvancedRenderer] Deferred line refresh failed', ov.id, e);\n        }\n      });\n      console.log('[AdvancedRenderer] Deferred line refresh pass complete');\n    });\n  }\n\n  renderOverlay(overlay, anchors, viewBox) {\n    if (!overlay || !overlay.type) {\n      console.warn('[AdvancedRenderer] Invalid overlay - missing type:', overlay);\n      return '';\n    }\n\n    // Ensure SVG container is available before rendering\n    const svgContainer = this.mountEl;\n    const svg = svgContainer?.querySelector('svg');\n\n    if (!svg) {\n      console.warn('[AdvancedRenderer] SVG element not found in container for overlay:', overlay.id);\n    }\n\n    // ADDED: Ensure SVG doesn't interfere with control events\n    if (svg) {\n      svg.style.pointerEvents = 'auto';\n      svg.style.zIndex = '0'; // Keep SVG in background\n    }\n\n    switch (overlay.type) {\n      case 'text':\n        // DEBUG: Check what overlay object is being passed to TextOverlayRenderer\n        if (overlay.id === 'title_overlay') {\n          console.log('[AdvancedRenderer] 🔍 Passing title_overlay to TextOverlayRenderer:', {\n            id: overlay.id,\n            color: overlay.style?.color,\n            status_indicator: overlay.style?.status_indicator,\n            finalStyleColor: overlay.finalStyle?.color,\n            finalStyleStatusIndicator: overlay.finalStyle?.status_indicator\n          });\n        }\n\n        // Update (in case dynamic overlays later): recompute & refresh map\n        const ap = TextOverlayRenderer.computeAttachmentPoints(overlay, anchors, svgContainer);\n        if (ap) this.textAttachmentPoints.set(overlay.id, ap);\n        return TextOverlayRenderer.render(overlay, anchors, viewBox, svgContainer);\n      case 'sparkline':\n        return SparklineRenderer.render(overlay, anchors, viewBox);\n      case 'line':\n        return this.lineRenderer.render(overlay, anchors, viewBox);\n      case 'control':\n        // ADDED: Control overlays are handled by MsdControlsRenderer, not SVG renderer\n        console.log('[AdvancedRenderer] Control overlay detected, skipping SVG rendering:', overlay.id);\n        return ''; // Return empty string - controls are rendered separately by MsdControlsRenderer\n      case 'status_grid':\n        return StatusGridRenderer.render(overlay, anchors, viewBox);\n      default:\n        console.warn(`[AdvancedRenderer] Unknown overlay type: ${overlay.type}`);\n        return '';\n    }\n  }\n\n    injectSvgContent(svgContent) {\n    const svg = this.mountEl.querySelector('svg');\n    if (!svg) {\n      console.warn('[AdvancedRenderer] No SVG element found for overlay injection');\n      return;\n    }\n\n    let overlayGroup = svg.querySelector('#msd-overlay-container');\n    if (!overlayGroup) {\n      overlayGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n      overlayGroup.setAttribute('id', 'msd-overlay-container');\n      svg.appendChild(overlayGroup);\n    } else {\n      overlayGroup.innerHTML = '';\n    }\n\n    try {\n      overlayGroup.innerHTML = svgContent;\n      console.log('[AdvancedRenderer] SVG content injected successfully');\n\n      // Build element cache after injection\n      this.overlayElementCache.clear();\n      const overlayElements = overlayGroup.querySelectorAll('[data-overlay-id]');\n      overlayElements.forEach(element => {\n        const overlayId = element.getAttribute('data-overlay-id');\n        if (overlayId) {\n          this.overlayElementCache.set(overlayId, element);\n          console.log(`[AdvancedRenderer] Cached element for overlay: ${overlayId}`);\n        }\n      });\n\n      // Verify injection\n      const sparklines = overlayGroup.querySelectorAll('[data-overlay-type=\"sparkline\"]');\n      const lines = overlayGroup.querySelectorAll('[data-overlay-type=\"line\"]');\n      const texts = overlayGroup.querySelectorAll('[data-overlay-type=\"text\"]');\n\n      console.log('[AdvancedRenderer] Injected elements:', {\n        sparklines: sparklines.length,\n        lines: lines.length,\n        texts: texts.length,\n        cached: this.overlayElementCache.size\n      });\n\n    } catch (error) {\n      console.error('[AdvancedRenderer] Failed to inject SVG content:', error);\n    }\n  }\n\n  // === DATA UPDATE METHODS ===\n\n  /**\n   * Update overlay data when data source changes\n   * @param {string} overlayId - ID of the overlay to update\n   * @param {Object} sourceData - Data from the data source\n   */\n  updateOverlayData(overlayId, sourceData) {\n    console.log('[AdvancedRenderer] updateOverlayData called:', {\n      overlayId,\n      hasSourceData: !!sourceData,\n      sourceDataKeys: sourceData ? Object.keys(sourceData) : 'none',\n      hasBuffer: !!(sourceData?.buffer),\n      bufferSize: sourceData?.buffer?.size?.() || 0,\n      hasCachedElement: this.overlayElementCache.has(overlayId)\n    });\n\n    if (!sourceData) {\n      console.warn('[AdvancedRenderer] updateOverlayData: Missing sourceData');\n      return;\n    }\n\n    // Use cached element - no DOM searching needed with subscription system\n    const overlayElement = this.overlayElementCache.get(overlayId);\n\n    if (!overlayElement) {\n      console.warn(`[AdvancedRenderer] Could not find cached overlay element: ${overlayId}. Element should be cached during render.`);\n      return;\n    }\n\n    const overlay = this.lastRenderArgs?.overlays?.find(o => o.id === overlayId);\n    if (!overlay) {\n      console.warn(`[AdvancedRenderer] Could not find overlay config: ${overlayId}`);\n      return;\n    }\n\n    // Delegate to type-specific renderer\n    switch (overlay.type) {\n      case 'sparkline':\n        SparklineRenderer.updateSparklineData(overlayElement, overlay, sourceData);\n        break;\n      case 'text':\n        console.log(`[AdvancedRenderer] Updating text overlay: ${overlayId}`);\n        this.updateTextOverlay(overlayId, sourceData);\n        break;\n      case 'status_grid':\n        console.log(`[AdvancedRenderer] Updating status grid overlay: ${overlayId}`);\n        this.updateStatusGridWithTemplates(overlayId, sourceData);\n        break;\n      default:\n        console.warn(`[AdvancedRenderer] Update not implemented for overlay type: ${overlay.type}`);\n    }\n  }\n\n  handleDataSourceUpdate(updateData) {\n    if (!this.mountEl) return;\n\n    // Find sparklines using cached elements instead of DOM search\n    const cachedElements = Array.from(this.overlayElementCache.values());\n    const sparklines = cachedElements.filter(el =>\n      el.getAttribute('data-source') === updateData.sourceId\n    );\n\n    if (sparklines.length === 0) {\n      console.log(`[AdvancedRenderer] No cached sparklines found for source: ${updateData.sourceId}`);\n      return;\n    }\n\n    sparklines.forEach(sparklineElement => {\n      const overlay = this.lastRenderArgs.overlays?.find(o =>\n        o.id === sparklineElement.getAttribute('data-overlay-id')\n      );\n      if (!overlay) return;\n\n      // Use SparklineRenderer's update method\n      SparklineRenderer.updateSparklineData(sparklineElement, overlay, updateData.data);\n    });\n  }\n\n  /**\n   * Clean up resources when renderer is destroyed\n   */\n  destroy() {\n    this.overlayElements.clear();\n    this.overlayElementCache.clear();\n    this.lastRenderArgs = null;\n  }\n\n  _updateTextAttachmentPointsFromDom(overlay, groupEl, bb) {\n    if (!overlay || !groupEl || !bb) return;\n    const ap = {\n      id: overlay.id,\n      center: [bb.centerX, bb.centerY],\n      bbox: {\n        left: bb.left, right: bb.right, top: bb.top, bottom: bb.bottom,\n        width: bb.width, height: bb.height\n      },\n      points: {\n        center: [bb.centerX, bb.centerY],\n        top: [bb.centerX, bb.top],\n        bottom: [bb.centerX, bb.bottom],\n        left: [bb.left, bb.centerY],\n        right: [bb.right, bb.centerY],\n        topLeft: [bb.left, bb.top],\n        topRight: [bb.right, bb.top],\n        bottomLeft: [bb.left, bb.bottom],\n        bottomRight: [bb.right, bb.bottom]\n      }\n    };\n    this.textAttachmentPoints.set(overlay.id, ap);\n  }\n\n  _rerenderDependentLines(changedSet, overlays, anchorsRef, viewBox) {\n    if (!changedSet || !changedSet.size) return;\n    const toRerender = new Set();\n    changedSet.forEach(tid => {\n      const dep = this._lineDeps.get(tid);\n      if (dep) dep.forEach(id => toRerender.add(id));\n    });\n    if (!toRerender.size) return;\n    requestAnimationFrame(() => {\n      toRerender.forEach(lineId => {\n        const overlay = overlays.find(o => o.id === lineId);\n        if (!overlay) return;\n        const existingEl = this.overlayElementCache.get(lineId);\n        if (!existingEl) return;\n        try {\n          const newMarkup = this.lineRenderer.render(overlay, anchorsRef, viewBox);\n          if (!newMarkup) return;\n          const temp = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n          temp.innerHTML = newMarkup.trim();\n          const newEl = temp.firstElementChild;\n          if (!newEl) return;\n          existingEl.replaceWith(newEl);\n          this.overlayElementCache.set(lineId, newEl);\n        } catch(e) {\n          console.warn('[AdvancedRenderer] Dep line re-render failed', lineId, e);\n        }\n      });\n      console.log('[AdvancedRenderer] Rerendered dependent lines after font stabilization', { count: toRerender.size });\n    });\n  }\n\n  _reRenderSingleTextOverlay(overlay, anchorsRef, viewBox) {\n    try {\n      const oldGroup = this.overlayElementCache.get(overlay.id);\n      if (!oldGroup) return null;\n      const markup = TextOverlayRenderer.render(overlay, anchorsRef, viewBox, this.mountEl);\n      if (!markup) return null;\n      const temp = document.createElementNS('http://www.w3.org/2000/svg','g');\n      temp.innerHTML = markup.trim();\n      const newGroup = temp.firstElementChild;\n      if (!newGroup) return null;\n      oldGroup.replaceWith(newGroup);\n      this.overlayElementCache.set(overlay.id, newGroup);\n      // Update DOM-based attachment points immediately\n      const bb = RendererUtils.getDomTextBBox(newGroup);\n      if (bb) this._updateTextAttachmentPointsFromDom(overlay, newGroup, bb);\n      return newGroup;\n    } catch(e) {\n      console.warn('[AdvancedRenderer] Re-render text overlay failed', overlay.id, e);\n      return null;\n    }\n  }\n\n  _updateStatusIndicatorPosition(groupEl, textBBox) {\n    try {\n      if (!groupEl) return;\n      const circle = groupEl.querySelector('circle[data-decoration=\"status-indicator\"]');\n      if (!circle) return;\n      // Read required data\n      const pos = circle.getAttribute('data-status-pos') || 'left-center';\n      const fontSize = Number(groupEl.getAttribute('data-font-size') || 16);\n      const indicatorSize = fontSize * 0.4;\n      // Padding calculation (mirror TextOverlayRenderer)\n      const transformInfo = RendererUtils._getSvgTransformInfo(this.mountEl);\n      const pixelPadding = 8;\n      const padding = transformInfo ? transformInfo.pixelToViewBox(pixelPadding) : indicatorSize;\n\n      const bbox = textBBox; // has left/right/top/bottom/centerX/centerY\n      let cx = bbox.centerX, cy = bbox.centerY;\n      switch (pos) {\n        case 'top-left':     cx = bbox.left - padding;  cy = bbox.top - padding; break;\n        case 'top-right':    cx = bbox.right + padding; cy = bbox.top - padding; break;\n        case 'bottom-left':  cx = bbox.left - padding;  cy = bbox.bottom + padding; break;\n        case 'bottom-right': cx = bbox.right + padding; cy = bbox.bottom + padding; break;\n        case 'top':          cx = bbox.centerX;         cy = bbox.top - padding; break;\n        case 'bottom':       cx = bbox.centerX;         cy = bbox.bottom + padding; break;\n        case 'left':\n        case 'left-center':  cx = bbox.left - padding;  cy = bbox.centerY; break;\n        case 'right':\n        case 'right-center': cx = bbox.right + padding; cy = bbox.centerY; break;\n        case 'center':       cx = bbox.centerX;         cy = bbox.centerY; break;\n        default:             cx = bbox.left - padding;  cy = bbox.centerY;\n      }\n      circle.setAttribute('cx', cx);\n      circle.setAttribute('cy', cy);\n      circle.setAttribute('r', indicatorSize);\n    } catch(_) {\n      // silent\n    }\n  }\n\n  /**\n   * Update text overlay content dynamically without full re-render\n   * @param {string} overlayId - ID of the text overlay to update\n   * @param {Object} sourceData - New DataSource data\n   */\n  updateTextOverlay(overlayId, sourceData) {\n    try {\n      // Find the text element in the DOM\n      const textElement = this.mountEl.querySelector(`[data-overlay-id=\"${overlayId}\"] text`);\n      if (!textElement) {\n        console.warn(`[AdvancedRenderer] Text element not found for overlay: ${overlayId}`);\n        return;\n      }\n\n      // Get the overlay configuration to resolve new content\n      const resolvedModel = this.systemsManager?.rulesEngine?.getResolvedModel?.() ||\n                           this.systemsManager?.getResolvedModel?.() ||\n                           window.__msdDebug?.pipelineInstance?.getResolvedModel?.();\n\n      const overlay = resolvedModel?.overlays?.find(o => o.id === overlayId);\n      if (!overlay) {\n        console.warn(`[AdvancedRenderer] Overlay configuration not found: ${overlayId}`);\n        return;\n      }\n\n      // Import the TextOverlayRenderer for content resolution\n      import('./TextOverlayRenderer.js').then(({ TextOverlayRenderer }) => {\n        const renderer = new TextOverlayRenderer();\n\n        // Resolve new text content using the same logic as initial rendering\n        const newContent = renderer._resolveTextContentWithData(overlay, overlay.finalStyle || {}, sourceData);\n\n        if (newContent && newContent !== textElement.textContent) {\n          console.log(`[AdvancedRenderer] Updating text overlay ${overlayId}: \"${textElement.textContent}\" → \"${newContent}\"`);\n\n          // Update the text content\n          textElement.textContent = TextOverlayRenderer.escapeXml(newContent);\n\n          // Update any status indicators that might depend on the content\n          this.updateTextDecorations(overlayId, newContent, overlay);\n\n          console.log(`[AdvancedRenderer] ✅ Text overlay ${overlayId} updated successfully`);\n        } else {\n          console.log(`[AdvancedRenderer] Text overlay ${overlayId} content unchanged`);\n        }\n      }).catch(error => {\n        console.error(`[AdvancedRenderer] Failed to update text overlay ${overlayId}:`, error);\n      });\n\n    } catch (error) {\n      console.error(`[AdvancedRenderer] Error updating text overlay ${overlayId}:`, error);\n    }\n  }\n\n  /**\n   * Update text decorations (status indicators, etc.) when content changes\n   * @param {string} overlayId - ID of the text overlay\n   * @param {string} newContent - New text content\n   * @param {Object} overlay - Overlay configuration\n   */\n  updateTextDecorations(overlayId, newContent, overlay) {\n    try {\n      // Update status indicator position if needed (since text width may have changed)\n      const statusIndicator = this.mountEl.querySelector(`[data-overlay-id=\"${overlayId}\"] [data-decoration=\"status-indicator\"]`);\n      if (statusIndicator && overlay.finalStyle?.status_indicator) {\n        // Recalculate status indicator position\n        // This could be enhanced to recalculate based on new text metrics\n        console.log(`[AdvancedRenderer] Status indicator position may need updating for ${overlayId}`);\n      }\n    } catch (error) {\n      console.error(`[AdvancedRenderer] Error updating text decorations for ${overlayId}:`, error);\n    }\n  }\n\n  /**\n   * Update status grid cells with new data (similar to updateTextOverlay)\n   * @param {string} overlayId - Status grid overlay ID\n   * @param {Array} updatedCells - Updated cell configurations\n   * @public\n   */\n  updateStatusGrid(overlayId, updatedCells) {\n    console.log(`[AdvancedRenderer] Updating status grid ${overlayId} with ${updatedCells.length} cells`);\n\n    // Find the status grid element in the DOM\n    const gridElement = this.mountEl?.querySelector(`[data-overlay-id=\"${overlayId}\"]`);\n    if (!gridElement) {\n      console.warn(`[AdvancedRenderer] Status grid element not found: ${overlayId}`);\n      return;\n    }\n\n    // For now, log the update and add a simple visual indication\n    console.log(`[AdvancedRenderer] Status grid ${overlayId} cells updated:`, updatedCells);\n\n    // Add visual indication that the grid was updated\n    const timestamp = new Date().toISOString();\n    gridElement.setAttribute('data-last-update', timestamp);\n\n    // Future: Implement proper cell-by-cell updates\n    // This would involve updating individual cell elements within the grid\n    // For now, we'll trigger a re-render of the entire overlay if needed\n\n    console.log(`[AdvancedRenderer] ✅ Status grid ${overlayId} update placeholder completed`);\n  }\n\n  /**\n   * Enhanced status grid update method with template processing\n   * @param {string} overlayId - Status grid overlay ID\n   * @param {Object} sourceData - New DataSource data\n   * @public\n   */\n  updateStatusGridWithTemplates(overlayId, sourceData) {\n    console.log(`[AdvancedRenderer] Updating status grid ${overlayId} with DataSource data`);\n\n    try {\n      // Get the overlay configuration to resolve new content\n      const resolvedModel = this.systemsManager?.rulesEngine?.getResolvedModel?.() ||\n                           this.systemsManager?.getResolvedModel?.() ||\n                           window.__msdDebug?.pipelineInstance?.getResolvedModel?.();\n\n      const overlay = resolvedModel?.overlays?.find(o => o.id === overlayId);\n      if (!overlay) {\n        console.warn(`[AdvancedRenderer] Status grid overlay configuration not found: ${overlayId}`);\n        return;\n      }\n\n      // Import the StatusGridRenderer for content resolution\n      import('./StatusGridRenderer.js').then(({ StatusGridRenderer }) => {\n        const renderer = new StatusGridRenderer();\n\n        // Get updated cells with processed template content\n        const style = overlay.finalStyle || overlay.style || {};\n        const updatedCells = renderer.updateCellsWithData(overlay, style, sourceData);\n\n        console.log(`[AdvancedRenderer] Processing ${updatedCells.length} updated cells for grid ${overlayId}`);\n\n        // Update each cell's content in the DOM\n        updatedCells.forEach(cell => {\n          const cellContentElement = this.mountEl?.querySelector(`[data-cell-content=\"${cell.id}\"]`);\n\n          if (cellContentElement && cell.content !== undefined) {\n            const oldContent = cellContentElement.textContent?.trim();\n            let newContent = cell.content;\n\n            // Handle [object Object] issue - ensure content is always a string\n            if (typeof newContent === 'object') {\n              console.warn(`[AdvancedRenderer] Cell ${cell.id} has object content, converting to string`);\n              newContent = newContent !== null ? String(newContent) : 'N/A';\n            }\n\n            // Ensure newContent is a string\n            newContent = String(newContent);\n\n            if (newContent !== oldContent) {\n              console.log(`[AdvancedRenderer] Updating cell ${cell.id}: \"${oldContent}\" → \"${newContent}\"`);\n              cellContentElement.textContent = newContent;\n            }\n          }\n        });\n\n        console.log(`[AdvancedRenderer] ✅ Status grid ${overlayId} updated successfully`);\n\n      }).catch(error => {\n        console.error(`[AdvancedRenderer] Failed to update status grid ${overlayId}:`, error);\n      });\n\n    } catch (error) {\n      console.error(`[AdvancedRenderer] Error updating status grid ${overlayId}:`, error);\n    }\n  }\n\n  /**\n   * Enhanced template detection that supports multiple overlay types\n   * @param {Object} overlay - Overlay configuration\n   * @returns {boolean} True if overlay contains template content\n   * @private\n   */\n  _hasTemplateContentEnhanced(overlay) {\n    if (!overlay) return false;\n\n    // Handle different overlay types\n    switch (overlay.type) {\n      case 'text':\n        // Text overlays: check content property\n        const textContent = overlay.content || overlay._raw?.content || overlay.raw?.content;\n        return textContent && typeof textContent === 'string' && textContent.includes('{');\n\n      case 'status_grid':\n        // Status grids: check cells for template content\n        const cellsConfig = overlay.cells || overlay._raw?.cells || overlay.raw?.cells;\n        if (cellsConfig && Array.isArray(cellsConfig)) {\n          return cellsConfig.some(cell =>\n            (cell.content && typeof cell.content === 'string' && cell.content.includes('{')) ||\n            (cell.label && typeof cell.label === 'string' && cell.label.includes('{'))\n          );\n        }\n        return false;\n\n      default:\n        // Fallback: check common content properties\n        const content = overlay.content || overlay._raw?.content || overlay.raw?.content;\n        return content && typeof content === 'string' && content.includes('{');\n    }\n  }\n\n  /**\n   * Initialize enhanced template detection for status grids\n   * Called during renderer initialization\n   * @private\n   */\n  _initializeEnhancedTemplateDetection() {\n    // Monkey-patch BaseOverlayUpdater to support status grid template detection\n    const overlayUpdater = this.systemsManager?.overlayUpdater;\n\n    if (overlayUpdater && overlayUpdater._hasTemplateContent) {\n      console.log('[AdvancedRenderer] Enhancing BaseOverlayUpdater template detection for status grids');\n\n      // Store original method\n      const originalHasTemplateContent = overlayUpdater._hasTemplateContent.bind(overlayUpdater);\n\n      // Replace with enhanced version\n      overlayUpdater._hasTemplateContent = (overlay) => {\n        // Use our enhanced detection method\n        return this._hasTemplateContentEnhanced(overlay);\n      };\n\n      console.log('[AdvancedRenderer] ✅ Enhanced template detection activated');\n    }\n  }\n}","/**\n * Phase 2: Debug visualization renderer\n * Shows anchor markers, overlay bounding boxes, routing guidelines, performance overlays.\n * Handles timing resilience for systems that may not be fully initialized at first render.\n */\nexport class MsdDebugRenderer {\n  constructor() {\n    this.enabled = false;\n    this.debugLayer = null;\n    this.anchorMarkers = new Map();\n    this.boundingBoxes = new Map();\n    this.routingOverlays = new Map();\n    this.performanceOverlays = new Map();\n\n    this.scale = 1.0;\n\n    // Remove old feature flags - now managed by DebugManager\n    this.debugManager = null;\n    this.unsubscribeDebug = null;\n\n    // Store last render context for reactive re-renders\n    this._lastRenderContext = null;\n\n    // Remove retry mechanism - no longer needed\n  }\n\n  /**\n   * Initialize with systems manager and subscribe to debug changes\n   * @param {SystemsManager} systemsManager - Systems manager instance\n   */\n  init(systemsManager) {\n    this.debugManager = systemsManager.debugManager;\n\n    // Subscribe to debug state changes for reactive rendering\n    this.unsubscribeDebug = this.debugManager.onChange((event) => {\n      // REDUCED: Only log significant events\n      if (event.type === 'feature' || event.type === 'scale' || event.type === 'router-ready') {\n        this._scheduleRerender();\n      }\n    });\n\n    // REDUCED: Minimal initialization logging\n  }\n\n  /**\n   * Set scale factor from debug configuration\n   * @param {number} scale - Scale multiplier (default 1.0)\n   */\n  setScale(scale = 1.0) {\n    this.scale = Math.max(0.3, Math.min(3.0, scale)); // Clamp between reasonable bounds\n    console.log(`[MsdDebugRenderer] Scale factor set to: ${this.scale}`);\n  }\n\n  /**\n   * Main render method - now powered by DebugManager state\n   * @param {Element} root - DOM root element\n   * @param {Array} viewBox - SVG viewBox [x, y, width, height]\n   * @param {Object} opts - Render options\n   */\n  render(root, viewBox, opts = {}) {\n    // REDUCED: Only log if debug is actually enabled\n    const debugState = this.debugManager?.getSnapshot();\n    if (!debugState?.enabled) {\n      return;\n    }\n\n    // Store context for reactive re-renders\n    this._lastRenderContext = { root, viewBox, opts };\n\n    if (!this.debugManager || !this.debugManager.initialized) {\n      return;\n    }\n\n    if (!root || typeof root.querySelector !== 'function') {\n      console.warn('[MsdDebugRenderer] Invalid root element');\n      return;\n    }\n\n    const svgElement = root.querySelector('svg');\n    if (!svgElement) {\n      console.warn('[MsdDebugRenderer] No SVG element found in root');\n      return;\n    }\n\n    // Update scale from DebugManager\n    this.setScale(debugState.scale);\n\n    // Setup debug layer\n    this.integrateWithAdvancedRenderer(svgElement, viewBox, opts.anchors);\n\n    // Clear existing debug content\n    if (this.debugLayer) {\n      this.debugLayer.innerHTML = '';\n    }\n\n    // Exit early if no features enabled\n    if (!debugState.enabled) {\n      if (this.debugLayer) {\n        this.debugLayer.style.display = 'none';\n      }\n      return;\n    }\n\n    // REDUCED: Only log when actually rendering features\n    console.log('[MsdDebugRenderer] Rendering debug features');\n\n    // Render enabled features using DebugManager state\n    if (debugState.anchors && opts.anchors) {\n      console.log('[MsdDebugRenderer] Rendering anchors...');\n      this.renderAnchorMarkers(opts.anchors);\n    }\n\n    if (debugState.bounding_boxes && opts.overlays) {\n      console.log('[MsdDebugRenderer] Rendering bounding boxes...');\n      this.renderOverlayBounds(opts.overlays);\n    }\n\n    if (debugState.routing && this.debugManager.canRenderRouting()) {\n      console.log('[MsdDebugRenderer] Rendering routing guides...');\n      this.renderRoutingGuides(opts);\n    }\n\n    if (debugState.performance) {\n      console.log('[MsdDebugRenderer] Rendering performance overlays...');\n      this.renderPerformanceOverlays(opts);\n    }\n\n    // Show debug layer\n    if (this.debugLayer) {\n      this.debugLayer.style.display = 'block';\n    }\n  }\n\n  /**\n   * Schedule a reactive re-render\n   * @private\n   */\n  _scheduleRerender() {\n    if (this._lastRenderContext) {\n      // Use requestAnimationFrame to avoid excessive re-renders\n      requestAnimationFrame(() => {\n        const { root, viewBox, opts } = this._lastRenderContext;\n        this.render(root, viewBox, opts);\n      });\n    }\n  }\n\n  /**\n   * Render routing guides - simplified without retry mechanism\n   * @param {Object} opts - Render options\n   */\n  renderRoutingGuides(opts) {\n    if (!this.debugLayer) return;\n\n    // Clear existing routes\n    this.routingOverlays.forEach(o => o.remove());\n    this.routingOverlays.clear();\n\n    // Get routing system from window.__msdDebug (set by pipeline)\n    const routing = opts.router || window.__msdDebug?.routing;\n\n    if (!routing || typeof routing.inspect !== 'function') {\n      console.log('[MsdDebugRenderer] Routing system not available for debug rendering');\n      return;\n    }\n\n    const overlays = opts.overlays || [];\n    const lineOverlays = overlays.filter(o => o.type === 'line');\n\n    if (lineOverlays.length === 0) {\n      console.log('[MsdDebugRenderer] No line overlays found for routing visualization');\n      return;\n    }\n\n    let routeCount = 0;\n    lineOverlays.forEach(overlay => {\n      try {\n        const routeInfo = routing.inspect(overlay.id);\n        if (routeInfo && routeInfo.pts && routeInfo.pts.length > 1) {\n          const routeOverlay = this.createRoutingOverlay(overlay.id, routeInfo);\n          this.debugLayer.appendChild(routeOverlay);\n          this.routingOverlays.set(overlay.id, routeOverlay);\n          routeCount++;\n        } else {\n          // Fine-grained debug, not necessarily an error\n          console.log(`[MsdDebugRenderer] No route info for overlay ${overlay.id}`);\n        }\n      } catch (error) {\n        console.warn(`[MsdDebugRenderer] Failed to render routing guide for ${overlay.id}:`, error);\n      }\n    });\n\n    console.log(`[MsdDebugRenderer] Rendered ${routeCount} routing guides`);\n  }\n\n  /**\n   * Create routing visualization overlay group.\n   * @param {string} overlayId\n   * @param {Object} routeInfo\n   * @returns {SVGGElement}\n   */\n  createRoutingOverlay(overlayId, routeInfo) {\n    const doc = this.debugLayer.ownerDocument;\n    const group = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n    group.setAttribute('class', 'msd-debug-routing');\n\n    const points = routeInfo.pts || [];\n    points.forEach((pt, index) => {\n      if (Array.isArray(pt) && pt.length >= 2) {\n        const [x, y] = pt;\n        const waypoint = doc.createElementNS('http://www.w3.org/2000/svg', 'circle');\n        waypoint.setAttribute('cx', x);\n        waypoint.setAttribute('cy', y);\n        waypoint.setAttribute('r', 2 * this.scale);\n        waypoint.setAttribute('fill', 'magenta');\n        waypoint.setAttribute('stroke', 'white');\n        waypoint.setAttribute('stroke-width', 1 * this.scale);\n        waypoint.setAttribute('opacity', '0.8');\n        group.appendChild(waypoint);\n\n        if (index === 0 || index === points.length - 1 || points.length <= 6) {\n          const label = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n            label.setAttribute('x', x + (4 * this.scale));\n            label.setAttribute('y', y - (4 * this.scale));\n            label.setAttribute('fill', 'magenta');\n            label.setAttribute('font-size', 8 * this.scale);\n            label.setAttribute('font-family', 'monospace');\n            label.setAttribute('opacity', '0.8');\n            label.textContent = index;\n            group.appendChild(label);\n        }\n      }\n    });\n\n    if (routeInfo.meta) {\n      const startPt = points[0];\n      if (startPt && Array.isArray(startPt) && startPt.length >= 2) {\n        const info = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n        info.setAttribute('x', startPt[0]);\n        info.setAttribute('y', startPt[1] - (12 * this.scale));\n        info.setAttribute('fill', 'magenta');\n        info.setAttribute('font-size', 9 * this.scale);\n        info.setAttribute('font-family', 'monospace');\n        info.setAttribute('opacity', '0.9');\n        info.textContent = `${routeInfo.meta.strategy || 'auto'} (${Math.round(routeInfo.meta.cost || 0)})`;\n        group.appendChild(info);\n      }\n    }\n\n    return group;\n  }\n\n  /**\n   * Render anchor markers\n   * @param {Object} anchors\n   */\n  renderAnchorMarkers(anchors) {\n    if (!anchors || !this.debugLayer) return;\n\n    this.anchorMarkers.forEach(marker => marker.remove());\n    this.anchorMarkers.clear();\n\n    let markerCount = 0;\n    for (const [name, pt] of Object.entries(anchors)) {\n      if (Array.isArray(pt) && pt.length >= 2) {\n        const marker = this.createAnchorMarker(name, pt[0], pt[1]);\n        this.debugLayer.appendChild(marker);\n        this.anchorMarkers.set(name, marker);\n        markerCount++;\n      }\n    }\n\n    console.log(`[MsdDebugRenderer] Rendered ${markerCount} anchor markers`);\n  }\n\n  /**\n   * Create individual anchor marker group element\n   * @param {string} name\n   * @param {number} x\n   * @param {number} y\n   * @returns {SVGGElement}\n   */\n  createAnchorMarker(name, x, y) {\n    const group = this.debugLayer.ownerDocument.createElementNS('http://www.w3.org/2000/svg', 'g');\n    group.setAttribute('transform', `translate(${x}, ${y})`);\n    group.setAttribute('class', 'msd-debug-anchor');\n\n    const crosshairSize = 8 * this.scale;\n    const strokeWidth = 2 * this.scale;\n    const circleRadius = 3 * this.scale;\n    const fontSize = 12 * this.scale;\n    const labelOffset = 12 * this.scale;\n\n    const crosshair = `\n      <line x1=\"${-crosshairSize}\" y1=\"0\" x2=\"${crosshairSize}\" y2=\"0\" stroke=\"cyan\" stroke-width=\"${strokeWidth}\" opacity=\"0.8\"/>\n      <line x1=\"0\" y1=\"${-crosshairSize}\" x2=\"0\" y2=\"${crosshairSize}\" stroke=\"cyan\" stroke-width=\"${strokeWidth}\" opacity=\"0.8\"/>\n      <circle cx=\"0\" cy=\"0\" r=\"${circleRadius}\" fill=\"cyan\" stroke=\"white\" stroke-width=\"${this.scale}\" opacity=\"0.9\"/>\n    `;\n    const label = `\n      <text x=\"${labelOffset}\" y=\"4\" fill=\"cyan\" font-size=\"${fontSize}\" font-family=\"monospace\" opacity=\"0.9\">\n        ${name} (${Math.round(x)}, ${Math.round(y)})\n      </text>\n    `;\n\n    group.innerHTML = crosshair + label;\n    return group;\n  }\n\n  /**\n   * Render overlay bounding boxes\n   * @param {Array<Object>} overlays\n   */\n  renderOverlayBounds(overlays = []) {\n    if (!this.debugLayer) return;\n\n    this.boundingBoxes.forEach((bboxObj) => {\n      bboxObj.rect?.remove();\n      bboxObj.label?.remove();\n    });\n    this.boundingBoxes.clear();\n\n    let bboxCount = 0;\n    overlays.forEach(overlay => {\n      if (overlay.position && Array.isArray(overlay.position)) {\n        const [x, y] = overlay.position;\n\n        // Get actual dimensions based on overlay type\n        const dimensions = this._getOverlayDimensions(overlay, x, y);\n        if (!dimensions) return;\n\n        const bboxObj = this.createBoundingBox(overlay.id, dimensions.x, dimensions.y, dimensions.width, dimensions.height);\n        this.debugLayer.appendChild(bboxObj.rect);\n        this.debugLayer.appendChild(bboxObj.label);\n        this.boundingBoxes.set(overlay.id, bboxObj);\n        bboxCount++;\n      }\n    });\n\n    console.log(`[MsdDebugRenderer] Rendered ${bboxCount} bounding boxes`);\n  }\n\n  /**\n   * Create bounding box visualization objects\n   * @param {string} id\n   * @param {number} x\n   * @param {number} y\n   * @param {number} width\n   * @param {number} height\n   * @returns {{rect: SVGRectElement, label: SVGTextElement}}\n   */\n  createBoundingBox(id, x, y, width, height) {\n    const doc = this.debugLayer.ownerDocument;\n    const rect = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    rect.setAttribute('x', x);\n    rect.setAttribute('y', y);\n    rect.setAttribute('width', width);\n    rect.setAttribute('height', height);\n    rect.setAttribute('fill', 'none');\n    rect.setAttribute('stroke', 'orange');\n    rect.setAttribute('stroke-width', 1 * this.scale);\n    rect.setAttribute('stroke-dasharray', `${3 * this.scale},${3 * this.scale}`);\n    rect.setAttribute('opacity', '0.7');\n    rect.setAttribute('class', 'msd-debug-bbox');\n\n    const label = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n    label.setAttribute('x', x + (2 * this.scale));\n    label.setAttribute('y', y + (12 * this.scale));\n    label.setAttribute('fill', 'orange');\n    label.setAttribute('font-size', 10 * this.scale);\n    label.setAttribute('font-family', 'monospace');\n    label.setAttribute('opacity', '0.9');\n    label.textContent = id || 'unknown';\n    label.setAttribute('class', 'msd-debug-bbox-label');\n\n    return { rect, label };\n  }\n\n  /**\n   * Render performance overlays - with proper value formatting\n   * @param {Object} opts\n   */\n  renderPerformanceOverlays(opts) {\n    if (!this.debugLayer) return;\n\n    this.performanceOverlays.forEach(o => o.remove());\n    this.performanceOverlays.clear();\n\n    const perf = window.__msdDebug?.getPerf?.() || {};\n    const perfEntries = [];\n\n    if (perf.timers) {\n      Object.entries(perf.timers).forEach(([key, data]) => {\n        if (data && typeof data === 'object') {\n          const avg = data.count > 0 ? (data.total / data.count) : 0;\n            perfEntries.push(`${key}: ${avg.toFixed(2)}ms avg`);\n        }\n      });\n    }\n\n    if (perf.counters) {\n      Object.entries(perf.counters).forEach(([key, value]) => {\n        perfEntries.push(`${key}: ${value}`);\n      });\n    }\n\n    if (perfEntries.length === 0) {\n      Object.entries(perf).slice(0, 10).forEach(([key, value]) => {\n        let displayValue;\n        if (typeof value === 'object' && value !== null) {\n          if (value.count !== undefined && value.total !== undefined) {\n            const avg = value.count > 0 ? (value.total / value.count) : 0;\n            displayValue = `${avg.toFixed(2)}ms avg`;\n          } else {\n            displayValue = JSON.stringify(value);\n          }\n        } else {\n          displayValue = String(value);\n        }\n        perfEntries.push(`${key}: ${displayValue}`);\n      });\n    }\n\n    if (perfEntries.length === 0) {\n      console.log('[MsdDebugRenderer] No performance data available');\n      return;\n    }\n\n    const doc = this.debugLayer.ownerDocument;\n    const perfGroup = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n    perfGroup.setAttribute('class', 'msd-debug-performance');\n\n    const baseX = 10 * this.scale;\n    const baseY = 10 * this.scale;\n    const width = 200 * this.scale;\n    const padding = 5 * this.scale;\n\n    const bg = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    bg.setAttribute('x', baseX);\n    bg.setAttribute('y', baseY);\n    bg.setAttribute('width', width);\n    bg.setAttribute('height', (20 + perfEntries.slice(0, 8).length * 15) * this.scale);\n    bg.setAttribute('fill', 'rgba(0,0,0,0.8)');\n    bg.setAttribute('stroke', 'yellow');\n    bg.setAttribute('stroke-width', 1 * this.scale);\n    bg.setAttribute('rx', 4 * this.scale);\n    perfGroup.appendChild(bg);\n\n    const title = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n    title.setAttribute('x', baseX + padding);\n    title.setAttribute('y', baseY + (15 * this.scale));\n    title.setAttribute('fill', 'yellow');\n    title.setAttribute('font-size', 12 * this.scale);\n    title.setAttribute('font-family', 'monospace');\n    title.setAttribute('font-weight', 'bold');\n    title.textContent = 'Performance';\n    perfGroup.appendChild(title);\n\n    perfEntries.slice(0, 8).forEach((entryText, index) => {\n      const entry = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n      entry.setAttribute('x', baseX + padding);\n      entry.setAttribute('y', baseY + (30 + index * 15) * this.scale);\n      entry.setAttribute('fill', 'yellow');\n      entry.setAttribute('font-size', 10 * this.scale);\n      entry.setAttribute('font-family', 'monospace');\n      entry.textContent = entryText;\n      perfGroup.appendChild(entry);\n    });\n\n    this.debugLayer.appendChild(perfGroup);\n    this.performanceOverlays.set('perf-info', perfGroup);\n\n    console.log(`[MsdDebugRenderer] Rendered performance overlay with ${perfEntries.length} metrics at scale ${this.scale}`);\n  }\n\n  /**\n   * Connect to AdvancedRenderer's SVG structure\n   * @param {SVGElement} svgElement\n   * @param {Array} viewBox\n   * @param {Object} anchors\n   */\n  integrateWithAdvancedRenderer(svgElement, viewBox, anchors = {}) {\n    if (!svgElement) return;\n    this.ensureDebugLayer(svgElement);\n    this.viewBox = viewBox;\n    this.anchors = anchors;\n  }\n\n  /**\n   * Setup debug layer container group inside the SVG.\n   * @param {SVGElement} svgElement\n   */\n  ensureDebugLayer(svgElement) {\n    if (!svgElement) {\n      console.warn('[MsdDebugRenderer] ensureDebugLayer: no SVG element provided');\n      return;\n    }\n\n    let debugLayer = svgElement.querySelector('#msd-debug-layer');\n    if (!debugLayer) {\n      console.log('[MsdDebugRenderer] Creating new debug layer');\n      const doc = svgElement.ownerDocument;\n      debugLayer = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n      debugLayer.id = 'msd-debug-layer';\n      debugLayer.style.pointerEvents = 'none';\n      debugLayer.style.zIndex = '1000';\n      svgElement.appendChild(debugLayer);\n    } else {\n      console.log('[MsdDebugRenderer] Using existing debug layer');\n    }\n\n    this.debugLayer = debugLayer;\n  }\n\n  /**\n   * Toggle debug visualization on/off.\n   * @param {boolean} enabled\n   * @returns {boolean}\n   */\n  toggle(enabled = !this.enabled) {\n    this.enabled = enabled;\n    if (this.debugLayer) {\n      this.debugLayer.style.display = enabled ? 'block' : 'none';\n    }\n    console.log(`[MsdDebugRenderer] Debug visualization ${enabled ? 'enabled' : 'disabled'}`);\n    return enabled;\n  }\n\n  /**\n   * Toggle a specific debug feature.\n   * @param {string} feature - Feature key\n   * @param {boolean} enabled - Desired state\n   */\n  toggleFeature(feature, enabled) {\n    if (this.features.hasOwnProperty(feature)) {\n      this.features[feature] = enabled;\n      console.log(`[MsdDebugRenderer] Feature '${feature}' ${enabled ? 'enabled' : 'disabled'}`);\n\n      // Optionally re-render (future HUD integration may call up-stream)\n      setTimeout(() => {\n        if (this._lastRenderContext) {\n          const { root, viewBox, opts } = this._lastRenderContext;\n          this.render(root, viewBox, opts);\n        }\n      }, 10);\n    }\n  }\n\n  /**\n   * Get current debug state summary.\n   * @returns {Object}\n   */\n  getDebugState() {\n    return {\n      enabled: this.enabled,\n      features: { ...this.features },\n      hasDebugLayer: Boolean(this.debugLayer),\n      markerCount: this.anchorMarkers.size,\n      boundingBoxCount: this.boundingBoxes.size,\n      routingOverlayCount: this.routingOverlays.size,\n      performanceOverlayCount: this.performanceOverlays.size\n    };\n  }\n\n  /**\n   * Get overlay dimensions based on overlay type and rendered content - ENHANCED for baseline accuracy\n   * @private\n   * @param {Object} overlay - Overlay configuration\n   * @param {number} x - X position\n   * @param {number} y - Y position\n   * @returns {Object|null} Dimensions object with x, y, width, height\n   */\n  _getOverlayDimensions(overlay, x, y) {\n    // First, check if the overlay has been rendered and has dimension data attributes\n    if (this.debugLayer) {\n      const svgElement = this.debugLayer.closest('svg');\n      if (svgElement) {\n        const renderedOverlay = svgElement.querySelector(`[data-overlay-id=\"${overlay.id}\"]`);\n        if (renderedOverlay) {\n          // Try to get dimensions from data attributes (set by TextOverlayRenderer)\n          const width = renderedOverlay.getAttribute('data-text-width');\n          const height = renderedOverlay.getAttribute('data-text-height');\n          const fontSize = renderedOverlay.getAttribute('data-font-size');\n          const dominantBaseline = renderedOverlay.getAttribute('data-dominant-baseline');\n          const textAnchor = renderedOverlay.getAttribute('data-text-anchor');\n\n          if (width && height && width !== '0' && height !== '0') {\n            console.log(`[MsdDebugRenderer] Using rendered dimensions for ${overlay.id}: ${width}x${height}, baseline: ${dominantBaseline}, anchor: ${textAnchor}`);\n\n            // Calculate proper positions based on actual rendered attributes\n            const textHeight = parseFloat(height);\n            const textWidth = parseFloat(width);\n            const textFontSize = parseFloat(fontSize) || 16;\n\n            // Y position calculation based on actual dominant baseline\n            let adjustedY = y;\n            const actualBaseline = dominantBaseline || 'auto';\n\n            if (actualBaseline === 'hanging') {\n              // Text starts at y, so bounding box starts at y\n              adjustedY = y;\n            } else if (actualBaseline === 'middle' || actualBaseline === 'central') {\n              // Text is centered on y, so bounding box starts at y - height/2\n              adjustedY = y - textHeight / 2;\n            } else if (actualBaseline === 'text-after-edge') {\n              // Text ends at y, so bounding box starts at y - height\n              adjustedY = y - textHeight;\n            } else {\n              // Default/auto baseline - estimate ascent position\n              const ascent = textFontSize * 0.7;\n              adjustedY = y - ascent;\n            }\n\n            // X position calculation based on actual text anchor\n            let adjustedX = x;\n            const actualTextAnchor = textAnchor || 'start';\n\n            if (actualTextAnchor === 'middle') {\n              adjustedX = x - textWidth / 2;\n            } else if (actualTextAnchor === 'end') {\n              adjustedX = x - textWidth;\n            }\n            // 'start' anchor keeps x as-is\n\n            console.log(`[MsdDebugRenderer] Calculated bbox for ${overlay.id}: x=${adjustedX}, y=${adjustedY}, baseline=${actualBaseline}, anchor=${actualTextAnchor}`);\n\n            return {\n              x: adjustedX,\n              y: adjustedY,\n              width: textWidth,\n              height: textHeight\n            };\n          }\n        }\n      }\n    }\n\n    // Fallback to overlay-specific dimension calculation\n    switch (overlay.type) {\n      case 'text':\n        return this._calculateTextOverlayDimensions(overlay, x, y);\n\n      case 'line':\n        return this._calculateLineOverlayDimensions(overlay, x, y);\n\n      case 'image':\n        return this._calculateImageOverlayDimensions(overlay, x, y);\n\n      case 'rect':\n      case 'rectangle':\n        return this._calculateRectOverlayDimensions(overlay, x, y);\n\n      default:\n        // Generic fallback using size property or default\n        const width = overlay.size ? overlay.size[0] : 100;\n        const height = overlay.size ? overlay.size[1] : 20;\n        return { x, y, width, height };\n    }\n  }\n\n  /**\n   * Calculate text overlay dimensions using similar logic to TextOverlayRenderer\n   * @private\n   */\n  _calculateTextOverlayDimensions(overlay, x, y) {\n    try {\n      // Get the SVG container for proper measurement context\n      const svgElement = this.debugLayer?.closest('svg');\n      const container = svgElement?.parentElement || this.debugLayer;\n\n      // Try to use TextOverlayRenderer's attachment point calculation\n      if (window.cblcars?.TextOverlayRenderer?.computeAttachmentPoints) {\n        const attachmentData = window.cblcars.TextOverlayRenderer.computeAttachmentPoints(\n          overlay,\n          this.anchors || {},\n          container\n        );\n\n        if (attachmentData && attachmentData.bbox) {\n          console.log(`[MsdDebugRenderer] Using TextOverlayRenderer bbox for ${overlay.id}`);\n          return {\n            x: attachmentData.bbox.left,\n            y: attachmentData.bbox.top,\n            width: attachmentData.bbox.width,\n            height: attachmentData.bbox.height\n          };\n        }\n      }\n\n      // Alternative: Try to get dimensions from already rendered overlay\n      if (svgElement) {\n        const renderedElement = svgElement.querySelector(`[data-overlay-id=\"${overlay.id}\"]`);\n        if (renderedElement) {\n          try {\n            const bbox = renderedElement.getBBox();\n            if (bbox.width > 0 && bbox.height > 0) {\n              console.log(`[MsdDebugRenderer] Using getBBox for ${overlay.id}: ${bbox.width}x${bbox.height}`);\n              return {\n                x: bbox.x,\n                y: bbox.y,\n                width: bbox.width,\n                height: bbox.height\n              };\n            }\n          } catch (bboxError) {\n            console.warn(`[MsdDebugRenderer] getBBox failed for ${overlay.id}:`, bboxError);\n          }\n        }\n      }\n\n      // Fallback to manual text measurement\n      const style = overlay.finalStyle || overlay.style || {};\n      const textContent = style.value || overlay.text || overlay.content ||\n                         overlay._raw?.content || overlay._raw?.text || '';\n\n      if (!textContent) {\n        return { x, y, width: 0, height: 0 };\n      }\n\n      // Basic text measurement fallback\n      const fontSize = style.font_size || style.fontSize || 16;\n      const fontFamily = style.font_family || style.fontFamily || 'monospace';\n\n      // Estimate dimensions (this is a rough approximation)\n      const charWidth = fontSize * 0.6; // Rough estimate for monospace\n      const lineHeight = fontSize * 1.2;\n\n      const lines = textContent.split('\\n');\n      const maxLineLength = Math.max(...lines.map(line => line.length));\n\n      const width = maxLineLength * charWidth;\n      const height = lines.length * lineHeight;\n\n      // Adjust position based on text anchor and baseline\n      const textAnchor = style.text_anchor || style.textAnchor || 'start';\n      const dominantBaseline = style.dominant_baseline || style.dominantBaseline || 'auto';\n\n      let adjustedX = x;\n      if (textAnchor === 'middle') {\n        adjustedX = x - width / 2;\n      } else if (textAnchor === 'end') {\n        adjustedX = x - width;\n      }\n\n      // Calculate proper Y position based on dominant baseline\n      let adjustedY = y;\n      const ascent = fontSize * 0.7; // Estimate ascent\n\n      if (dominantBaseline === 'hanging') {\n        // Text starts at y, so bounding box starts at y\n        adjustedY = y;\n      } else if (dominantBaseline === 'middle' || dominantBaseline === 'central') {\n        // Text is centered on y, so bounding box starts at y - height/2\n        adjustedY = y - height / 2;\n      } else if (dominantBaseline === 'text-after-edge') {\n        // Text ends at y, so bounding box starts at y - height\n        adjustedY = y - height;\n      } else {\n        // Default/auto baseline - text baseline is at y, so bounding box starts at y - ascent\n        adjustedY = y - ascent;\n      }\n\n      return {\n        x: adjustedX,\n        y: adjustedY,\n        width,\n        height\n      };    } catch (error) {\n      console.warn(`[MsdDebugRenderer] Failed to calculate text dimensions for ${overlay.id}:`, error);\n      return { x, y, width: 100, height: 20 };\n    }\n  }\n\n  /**\n   * Calculate line overlay dimensions\n   * @private\n   */\n  _calculateLineOverlayDimensions(overlay, x, y) {\n    const endpoints = overlay.endpoints || overlay.end_points;\n    if (!endpoints || !Array.isArray(endpoints) || endpoints.length < 2) {\n      return { x, y, width: 50, height: 2 };\n    }\n\n    const [start, end] = endpoints;\n    const startX = Array.isArray(start) ? start[0] : start.x || x;\n    const startY = Array.isArray(start) ? start[1] : start.y || y;\n    const endX = Array.isArray(end) ? end[0] : end.x || x + 50;\n    const endY = Array.isArray(end) ? end[1] : end.y || y;\n\n    const minX = Math.min(startX, endX);\n    const minY = Math.min(startY, endY);\n    const width = Math.abs(endX - startX);\n    const height = Math.abs(endY - startY);\n\n    return {\n      x: minX,\n      y: minY,\n      width: Math.max(width, 2), // Minimum width for visibility\n      height: Math.max(height, 2) // Minimum height for visibility\n    };\n  }\n\n  /**\n   * Calculate image overlay dimensions\n   * @private\n   */\n  _calculateImageOverlayDimensions(overlay, x, y) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const width = style.width || overlay.width || overlay.size?.[0] || 64;\n    const height = style.height || overlay.height || overlay.size?.[1] || 64;\n\n    return { x, y, width: parseFloat(width), height: parseFloat(height) };\n  }\n\n  /**\n   * Calculate rectangle overlay dimensions\n   * @private\n   */\n  _calculateRectOverlayDimensions(overlay, x, y) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const width = style.width || overlay.width || overlay.size?.[0] || 100;\n    const height = style.height || overlay.height || overlay.size?.[1] || 50;\n\n    return { x, y, width: parseFloat(width), height: parseFloat(height) };\n  }\n\n  /**\n   * Essential cleanup to prevent memory leaks\n   */\n  destroy() {\n    // Unsubscribe from debug manager changes\n    if (this.unsubscribeDebug) {\n      this.unsubscribeDebug();\n      this.unsubscribeDebug = null;\n    }\n\n    // Clear debug layer reference\n    this.debugLayer = null;\n    this._lastRenderContext = null;\n  }\n}\n\n// Keep browser fallback for direct script loading\nif (typeof window !== 'undefined') {\n  window.cblcars = window.cblcars || {};\n  window.cblcars.MsdDebugRenderer = MsdDebugRenderer;\n}","/**\n * Phase 4: Home Assistant card controls renderer\n * Handles HA card embedding with SVG foreignObject positioning for proper scaling\n */\n\nimport { PositionResolver } from '../renderer/PositionResolver.js';\n\nexport class MsdControlsRenderer {\n  constructor(renderer) {\n    this.renderer = renderer;\n    this.controlElements = new Map();\n    this.hass = null;\n    this.lastRenderArgs = null;\n    this._isRendering = false;\n    this._lastSignature = null;\n    if (typeof window !== 'undefined') {\n      window._msdControlsRenderer = this;\n    }\n\n    // DEBUGGING: Log when MsdControlsRenderer is created\n    console.log('[MsdControlsRenderer] Constructor called');\n  }\n\n  setHass(hass) {\n    console.log('[MsdControlsRenderer] setHass called with:', {\n      hasHass: !!hass,\n      entityCount: hass?.states ? Object.keys(hass.states).length : 0,\n      hasLightDesk: !!hass?.states?.['light.desk'],\n      lightDeskState: hass?.states?.['light.desk']?.state,\n      previousHass: !!this.hass,\n      controlElementsCount: this.controlElements.size\n    });\n\n    this.hass = hass;\n\n    // ADDED: Immediately update all existing control cards with new HASS context\n    if (this.controlElements.size > 0) {\n      console.log('[MsdControlsRenderer] Updating HASS context for', this.controlElements.size, 'control cards');\n      this._updateAllControlsHass(hass);\n    } else {\n      console.log('[MsdControlsRenderer] No control elements to update');\n\n      // Try to find and update any CB-LCARS cards that might exist but aren't tracked\n      //this._updateUnmanagedCards(hass);\n    }\n  }\n\n  // DEBUGGING: Try to update cards that exist but aren't managed by us\n  /*\n  _updateUnmanagedCards(hass) {\n    console.log('[MsdControlsRenderer] Looking for unmanaged CB-LCARS cards to update');\n\n    const unmanagedCards = document.querySelectorAll('cb-lcars-button-card, [data-card-type*=\"cb-lcars\"]');\n    console.log(`[MsdControlsRenderer] Found ${unmanagedCards.length} unmanaged cards`);\n\n    unmanagedCards.forEach((card, index) => {\n      try {\n        const entity = card._config?.entity || card.entity;\n        const currentState = card.hass?.states?.[entity]?.state;\n        const newState = hass?.states?.[entity]?.state;\n\n        console.log(`[MsdControlsRenderer] Unmanaged card ${index}:`, {\n          entity,\n          currentState,\n          newState,\n          stateChanged: currentState !== newState\n        });\n\n        this._applyHassToCard(card, hass, `unmanaged-${index}`);\n      } catch (e) {\n        console.warn(`[MsdControlsRenderer] Failed to update unmanaged card ${index}:`, e);\n      }\n    });\n  }\n  */\n\n  // ADDED: Update HASS context for all existing control cards\n  _updateAllControlsHass(hass) {\n    console.log(`[MsdControlsRenderer] Updating HASS for ${this.controlElements.size} control cards`);\n\n    for (const [overlayId, wrapperElement] of this.controlElements) {\n      try {\n        // Find the actual card element inside the wrapper\n        const cardElement = wrapperElement.querySelector('[class*=\"card\"], [data-card-type], cb-lcars-button-card, hui-light-card') ||\n                           wrapperElement.firstElementChild;\n\n        if (cardElement) {\n          this._applyHassToCard(cardElement, hass, overlayId);\n        }\n      } catch (error) {\n        console.warn('[MsdControlsRenderer] Failed to update HASS for control:', overlayId, error);\n      }\n    }\n  }\n\n\n  /**\n   * Apply HASS context to a specific control card\n   * @private\n   * @param {Element} card - The card element\n   * @param {Object} hass - Home Assistant object\n   * @param {string} controlId - Control identifier for logging\n   */\n  _applyHassToCard(card, hass, controlId) {\n      console.log(`[MsdControlsRenderer] Updating HASS for ${controlId}:`, {\n          tagName: card.tagName,\n          isCustomButtonCard: card.tagName.toLowerCase().includes('button-card'),\n          hasConfig: !!card._config,\n          hasSetConfig: typeof card.setConfig === 'function',\n          currentHass: !!card.hass,\n          hasSetHass: typeof card.setHass === 'function',\n          entity: card._config?.entity || 'none'\n      });\n\n      try {\n          const tagName = card.tagName ? card.tagName.toLowerCase() : '';\n\n          // FIXED: Only CB-LCARS cards use property assignment\n          const isCBLCARSCard = tagName.includes('cb-lcars');\n          const isStandardHACard = tagName.includes('hui-') || (tagName.includes('button-card') && !tagName.includes('cb-lcars'));\n\n          if (isCBLCARSCard) {\n              console.log(`[MsdControlsRenderer] Using property assignment for CB-LCARS card: ${controlId}`);\n\n              // Store old HASS for change detection\n              const oldHass = card.hass;\n\n              // CRITICAL: Update _stateObj BEFORE setting HASS to ensure proper state synchronization\n              if (card._config?.entity && hass.states?.[card._config.entity]) {\n                  const newStateObj = hass.states[card._config.entity];\n                  console.log(`[MsdControlsRenderer] Updating _stateObj for ${controlId} entity: ${card._config.entity}`, {\n                      oldState: card._stateObj?.state,\n                      newState: newStateObj?.state,\n                      stateChanged: card._stateObj?.state !== newStateObj?.state\n                  });\n                  card._stateObj = newStateObj;\n              }\n\n              // Use PROPERTY ASSIGNMENT (not method call) to trigger LitElement reactivity\n              card.hass = hass;\n              card._hass = hass;  // Also set internal property for compatibility\n\n              // Trigger LitElement's reactive property system\n              if (typeof card.requestUpdate === 'function') {\n                  console.log(`[MsdControlsRenderer] Triggering LitElement property update for ${controlId}`);\n                  card.requestUpdate('hass', oldHass);\n                  card.requestUpdate('_hass', oldHass);\n\n                  // Also trigger update for state object changes\n                  if (card._config?.entity) {\n                      card.requestUpdate('_stateObj');\n                  }\n              }\n          } else if (isStandardHACard) {\n              console.log(`[MsdControlsRenderer] Using setHass() method for standard HA card: ${controlId}`);\n\n              // Standard HA cards: Use setHass method (their preferred approach)\n              if (card.setHass && typeof card.setHass === 'function') {\n                  card.setHass(hass);\n              } else {\n                  console.warn(`[MsdControlsRenderer] Standard HA card ${controlId} has no setHass method`);\n\n                  // Fallback: property assignment\n                  const oldHass = card.hass;\n                  card.hass = hass;\n                  card._hass = hass;\n\n                  if (typeof card.requestUpdate === 'function') {\n                      card.requestUpdate('hass', oldHass);\n                  }\n              }\n          } else {\n              console.log(`[MsdControlsRenderer] Using fallback approach for unknown card type: ${controlId}`);\n\n              // Unknown card type: Try setHass first, then property assignment\n              if (card.setHass && typeof card.setHass === 'function') {\n                  card.setHass(hass);\n              } else {\n                  const oldHass = card.hass;\n                  card.hass = hass;\n                  card._hass = hass;\n\n                  if (typeof card.requestUpdate === 'function') {\n                      card.requestUpdate('hass', oldHass);\n                  }\n              }\n          }          return true;\n\n      } catch (error) {\n          console.error(`[MsdControlsRenderer] ❌ Failed to update HASS for ${controlId}:`, error);\n          return false;\n      }\n  }\n\n\n  async renderControls(controlOverlays, resolvedModel) {\n    // ADDED: More comprehensive safety checks\n    if (this._isRendering) {\n      console.log('[MsdControlsRenderer] renderControls skipped (in progress)');\n      return;\n    }\n\n    if (!controlOverlays?.length) {\n      console.log('[MsdControlsRenderer] No control overlays to render');\n      return;\n    }\n\n    // ADDED: Validate resolved model\n    if (!resolvedModel) {\n      console.error('[MsdControlsRenderer] No resolved model provided');\n      return;\n    }\n\n    // ADDED: Validate DOM environment\n    if (typeof document === 'undefined') {\n      console.error('[MsdControlsRenderer] Document not available');\n      return;\n    }\n\n    const signature = controlOverlays.map(o => o.id).sort().join('|');\n    if (\n      this._lastSignature === signature &&\n      this.controlElements.size === controlOverlays.length\n    ) {\n      console.log('[MsdControlsRenderer] renderControls skipped (unchanged signature)', signature);\n      return;\n    }\n\n    this._isRendering = true;\n    try {\n      console.log('[MsdControlsRenderer] renderControls called', {\n        count: controlOverlays.length,\n        ids: controlOverlays.map(o => o.id),\n        signature,\n        hasHass: !!this.hass\n      });\n\n      // STEP 1: Ensure SVG container exists and clear existing controls\n      const svgContainer = this.getSvgControlsContainer();\n      if (!svgContainer) {\n        console.error('[MsdControlsRenderer] No SVG container available; abort render');\n        return;\n      }\n\n      console.log('[MsdControlsRenderer] SVG container found, clearing existing controls');\n      svgContainer.innerHTML = '';\n      this.controlElements.clear();\n\n      // ADDED: Render controls with individual error handling\n      for (const overlay of controlOverlays) {\n        try {\n          await this.renderControlOverlay(overlay, resolvedModel);\n        } catch (overlayError) {\n          console.error(`[MsdControlsRenderer] Failed to render control overlay ${overlay.id}:`, overlayError);\n          // Continue with other overlays\n        }\n      }\n\n      this.lastRenderArgs = { controlOverlays, resolvedModel };\n      this._lastSignature = signature;\n\n      console.log('[MsdControlsRenderer] renderControls completed successfully');\n\n    } catch (error) {\n      console.error('[MsdControlsRenderer] renderControls failed:', error);\n      throw error; // Re-throw so caller knows it failed\n    } finally {\n      this._isRendering = false;\n    }\n  }\n\n  async renderControlOverlay(overlay, resolvedModel) {\n    // Remove any existing foreignObject for this overlay\n    const existingForeignObject = document.querySelector(`#msd-control-foreign-${overlay.id}`);\n    if (existingForeignObject) {\n      console.log('[MsdControlsRenderer] Existing foreignObject found for', overlay.id, '- removing to avoid duplicates');\n      try { existingForeignObject.remove(); } catch(_) {}\n    }\n\n    // If we somehow already have a control element instance registered, drop it (fresh rebuild model)\n    if (this.controlElements.has(overlay.id)) {\n      this.controlElements.delete(overlay.id);\n    }\n\n    console.log('[MsdControlsRenderer] Creating control overlay', overlay.id);\n    const controlElement = await this.createControlElement(overlay);\n    if (!controlElement) return;\n\n    this.positionControlElement(controlElement, overlay, resolvedModel);\n    this.controlElements.set(overlay.id, controlElement);\n  }\n\n  // ADDED: recover original card definition even if pipeline stripped it\n  resolveCardDefinition(overlay) {\n    if (overlay.card) return overlay.card;\n    if (overlay.card_config) return overlay.card_config;\n    if (overlay.cardConfig) return overlay.cardConfig;\n    if (overlay._card) return overlay._card;\n    if (overlay.meta?.card) return overlay.meta.card;\n    if (overlay.extension?.card) return overlay.extension.card;\n\n    // Build raw overlay index once from global cache if available\n    if (!this._rawOverlayIndex) {\n      const raw = (window && window._msdRawOverlays) ? window._msdRawOverlays : [];\n      this._rawOverlayIndex = new Map(raw.map(o => [o.id, o]));\n    }\n    const rawEntry = this._rawOverlayIndex?.get(overlay.id);\n    if (rawEntry?.card) return rawEntry.card;\n\n    return null;\n  }\n\n  // ADDED: Build the final config object passed to setConfig\n  /* TO BE REMOVED - no longer needed\n  buildCardConfig(cardObj) {\n    if (!cardObj) return null;\n    // If nested config key provided, that is authoritative\n    if (cardObj.config && typeof cardObj.config === 'object') {\n      return { ...cardObj.config }; // shallow clone\n    }\n    // Otherwise treat the card object (minus wrapper-only keys) as config\n    const { type, config, ...rest } = cardObj;\n    // Include type too (some built-in cards ignore, harmless if present)\n    return { type, ...rest };\n  }\n  */\n\n  // ADDED: Normalize card type to handle HA built-in cards\n  _normalizeCardType(cardType) {\n    if (!cardType) return null;\n\n    // Handle custom cards\n    if (cardType.startsWith('custom:')) {\n      return cardType.slice(7); // Remove 'custom:' prefix\n    }\n\n    // ADDED: Map HA built-in card types to their actual element names\n    const builtInCardMap = {\n      'button': 'hui-button-card',\n      'light': 'hui-light-card',\n      'switch': 'hui-switch-card',\n      'sensor': 'hui-sensor-card',\n      'binary-sensor': 'hui-binary-sensor-card',\n      'cover': 'hui-cover-card',\n      'fan': 'hui-fan-card',\n      'climate': 'hui-climate-card',\n      'thermostat': 'hui-thermostat-card',\n      'media-player': 'hui-media-control-card',\n      'alarm-panel': 'hui-alarm-panel-card',\n      'input-number': 'hui-input-number-card',\n      'input-select': 'hui-input-select-card',\n      'input-text': 'hui-input-text-card',\n      'lock': 'hui-lock-card',\n      'vacuum': 'hui-vacuum-card',\n      'water-heater': 'hui-water-heater-card',\n      'weather': 'hui-weather-forecast-card'\n    };\n\n    return builtInCardMap[cardType] || cardType;\n  }\n\n  // ADDED: normalize card type to an actual custom element tag name\n  /* TO BE REMOVED - no longer needed\n  normalizeCardTag(cardType) {\n    if (!cardType) return null;\n    if (cardType.startsWith('custom:')) return cardType.slice(7); // HA style -> real tag\n    return cardType;\n  }\n  */\n\n  // ADDED: schedule retries for setConfig / hass once element upgrades\n  /* TO BE REMOVED - no longer needed\n  _scheduleDeferredConfig(cardElement, finalConfig, overlayId, attempt = 0) {\n    if (!finalConfig) return;\n    const maxAttempts = 8;\n    if (typeof cardElement.setConfig === 'function') {\n      try {\n        cardElement.setConfig(finalConfig);\n        cardElement._config = finalConfig;\n        if (this.hass) {\n          try { cardElement.hass = this.hass; } catch { cardElement._hass = this.hass; }\n        }\n        console.debug('[MSD Controls] Deferred setConfig applied', overlayId, { attempt });\n      } catch (e) {\n        console.warn('[MSD Controls] Deferred setConfig failed', overlayId, e);\n      }\n      return;\n    }\n    if (attempt >= maxAttempts) {\n      console.warn('[MSD Controls] Gave up waiting for setConfig', overlayId);\n      return;\n    }\n    const delay = 150 * (attempt + 1);\n    setTimeout(() => this._scheduleDeferredConfig(cardElement, finalConfig, overlayId, attempt + 1), delay);\n  }\n    */\n\n  async createControlElement(overlay) {\n    const cardDef = this.resolveCardDefinition(overlay);\n    if (!cardDef) {\n      console.warn('[MsdControlsRenderer] No card definition found for control overlay', overlay.id);\n      return null;\n    }\n\n    try {\n      // Browser environment - Fixed card creation and configuration\n      const cardType = cardDef.type;\n      let cardElement = null;\n\n      // FIXED: Use the new normalization method\n      const normalizedCardType = this._normalizeCardType(cardType);\n\n      console.log('[MsdControls] Creating card element:', {\n        originalType: cardType,\n        normalizedType: normalizedCardType,\n        overlayId: overlay.id\n      });\n\n      // ADDED: Special handling for HA built-in cards\n      if (normalizedCardType.startsWith('hui-')) {\n        cardElement = await this._createHomeAssistantCard(normalizedCardType, cardDef, overlay);\n      } else {\n        // Handle custom cards with existing logic\n        cardElement = await this._createCustomCard(normalizedCardType, cardDef, overlay);\n      }\n\n      // Fallback: Create a placeholder\n      if (!cardElement) {\n        console.warn(`Could not create card element for type: ${cardType}, creating fallback`);\n        cardElement = this._createFallbackCard(cardType, cardDef);\n      }\n\n      // FIXED: Apply HASS context BEFORE configuration\n      console.log('[MsdControls] Applying HASS and config:', {\n        overlayId: overlay.id,\n        hasHass: !!this.hass,\n        hasSetConfig: typeof cardElement.setConfig === 'function'\n      });\n\n      // Apply HASS context first\n      if (this.hass) {\n        await this._applyHassContext(cardElement, overlay.id);\n      }\n\n      // Then apply configuration\n      await this._configureCard(cardElement, cardDef, overlay);\n\n      // Create wrapper for positioning\n      const wrapper = document.createElement('div');\n      wrapper.className = 'msd-control-wrapper';\n      wrapper.dataset.msdControlId = overlay.id;\n      wrapper.style.position = 'absolute';\n      wrapper.style.pointerEvents = 'auto';\n      wrapper.style.touchAction = 'manipulation'; // ADDED: Better touch handling\n      wrapper.appendChild(cardElement);\n\n      // Event isolation\n      this._setupEventIsolation(wrapper, cardElement, overlay);\n\n      return wrapper;\n\n    } catch (error) {\n      console.error(`[MSD Controls] Failed to create card ${cardDef?.type}:`, error);\n      return this._createFallbackCard(cardDef?.type || 'unknown', cardDef);\n    }\n  }\n\n  // ADDED: Create Home Assistant built-in cards\n  async _createHomeAssistantCard(normalizedCardType, cardDef, overlay) {\n    console.log('[MsdControls] Creating HA built-in card:', normalizedCardType);\n\n    try {\n      // Wait for Home Assistant's card registry to be available\n      if (!window.customCards && !document.querySelector('home-assistant')) {\n        console.warn('[MsdControls] Home Assistant not fully loaded yet');\n        return null;\n      }\n\n      // Try to get the card constructor from HA's registry\n      let cardElement = null;\n\n      // Strategy 1: Use HA's card creation helper if available\n      if (window.customElements && window.customElements.get(normalizedCardType)) {\n        const CardClass = window.customElements.get(normalizedCardType);\n        cardElement = new CardClass();\n      } else {\n        // Strategy 2: Create via document and wait for upgrade\n        cardElement = document.createElement(normalizedCardType);\n        await this._waitForElementUpgrade(cardElement, 3000);\n      }\n\n      // ADDED: HA cards need different configuration approach\n      if (cardElement && typeof cardElement.setConfig !== 'function') {\n        // Some HA cards expose setConfig later or via different mechanism\n        console.log('[MsdControls] HA card created but setConfig not available, trying alternative approach');\n\n        // Wait a bit more for HA card to fully initialize\n        await new Promise(resolve => setTimeout(resolve, 500));\n\n        if (typeof cardElement.setConfig !== 'function') {\n          console.warn('[MsdControls] HA card does not have setConfig method:', normalizedCardType);\n          return null;\n        }\n      }\n\n      return cardElement;\n\n    } catch (error) {\n      console.warn('[MsdControls] HA card creation failed:', error);\n      return null;\n    }\n  }\n\n  // ADDED: Create custom cards (extracted from existing logic)\n  async _createCustomCard(normalizedCardType, cardDef, overlay) {\n    console.log('[MsdControls] Starting custom card creation strategies for:', normalizedCardType);\n    let cardElement = null;\n\n    // Strategy 1: Try direct custom element creation\n    console.log('[MsdControls] Strategy 1: Attempting direct custom element creation for:', normalizedCardType);\n    if (window.customElements && typeof window.customElements.get === 'function') {\n      try {\n        const CardClass = window.customElements.get(normalizedCardType);\n        if (CardClass) {\n          cardElement = new CardClass();\n          console.log('[MsdControls] ✅ Strategy 1 SUCCESS: Created via constructor:', normalizedCardType);\n        } else {\n          console.log('[MsdControls] ❌ Strategy 1 FAILED: No custom element found for:', normalizedCardType);\n        }\n      } catch (e) {\n        console.log('[MsdControls] ❌ Strategy 1 FAILED: Constructor error for', normalizedCardType, ':', e.message);\n      }\n    } else {\n      console.log('[MsdControls] ❌ Strategy 1 SKIPPED: customElements not available');\n    }\n\n    // Strategy 2: Try document.createElement with normalized type\n    if (!cardElement) {\n      console.log('[MsdControls] Strategy 2: Attempting createElement with upgrade for:', normalizedCardType);\n      try {\n        cardElement = document.createElement(normalizedCardType);\n\n        // Check if this is actually a custom element (not a generic div)\n        if (cardElement.tagName.toLowerCase() === normalizedCardType.toLowerCase()) {\n          console.log('[MsdControls] Strategy 2: Created element, waiting for upgrade:', normalizedCardType);\n          // Wait for potential custom element upgrade\n          await this._waitForElementUpgrade(cardElement);\n\n          if (typeof cardElement.setConfig === 'function') {\n            console.log('[MsdControls] ✅ Strategy 2 SUCCESS: Created via createElement with upgrade:', normalizedCardType);\n          } else {\n            console.log('[MsdControls] ❌ Strategy 2 FAILED: Element created but no setConfig after upgrade:', normalizedCardType);\n            cardElement = null;\n          }\n        } else {\n          console.log('[MsdControls] ❌ Strategy 2 FAILED: Generic element created, not custom card:', normalizedCardType);\n          // Generic element created, not the custom card\n          cardElement = null;\n        }\n      } catch (e) {\n        console.log('[MsdControls] ❌ Strategy 2 FAILED: createElement error for', normalizedCardType, ':', e.message);\n      }\n    }\n\n    // Strategy 3: Try creating in document body first (some cards need to be in DOM)\n    if (!cardElement) {\n      console.log('[MsdControls] Strategy 3: Attempting body attachment technique for:', normalizedCardType);\n      try {\n        cardElement = document.createElement(normalizedCardType);\n        // Temporarily attach to body to trigger upgrade\n        const tempParent = document.createElement('div');\n        tempParent.style.position = 'absolute';\n        tempParent.style.left = '-10000px';\n        document.body.appendChild(tempParent);\n        tempParent.appendChild(cardElement);\n\n        console.log('[MsdControls] Strategy 3: Element attached to body, waiting for upgrade:', normalizedCardType);\n        // Wait for upgrade\n        await this._waitForElementUpgrade(cardElement, 5000);\n\n        // Remove from temp parent\n        cardElement.remove();\n        tempParent.remove();\n\n        if (typeof cardElement.setConfig === 'function') {\n          console.log('[MsdControls] ✅ Strategy 3 SUCCESS: Created via body attachment:', normalizedCardType);\n        } else {\n          console.log('[MsdControls] ❌ Strategy 3 FAILED: Body attachment did not result in working card:', normalizedCardType);\n          cardElement = null;\n        }\n      } catch (e) {\n        console.log('[MsdControls] ❌ Strategy 3 FAILED: Body attachment error for', normalizedCardType, ':', e.message);\n      }\n    }\n\n    if (cardElement) {\n      console.log('[MsdControls] 🎉 Custom card creation SUCCESSFUL for:', normalizedCardType);\n    } else {\n      console.log('[MsdControls] 💥 ALL STRATEGIES FAILED for:', normalizedCardType);\n    }\n\n    return cardElement;\n  }\n\n  /**\n   * Wait for custom element to be fully upgraded\n   */\n  async _waitForElementUpgrade(element, maxWait = 5000) {\n    const startTime = Date.now();\n\n    console.log('[MsdControls] Waiting for element upgrade:', {\n      tagName: element.tagName,\n      hasSetConfig: typeof element.setConfig === 'function'\n    });\n\n    while (Date.now() - startTime < maxWait) {\n      // Check if element has been upgraded (has setConfig method)\n      if (typeof element.setConfig === 'function') {\n        console.log('[MsdControls] Element upgraded successfully:', element.tagName);\n        return element;\n      }\n\n      // Check if element has upgrade promise\n      if (element.updateComplete) {\n        try {\n          await element.updateComplete;\n          if (typeof element.setConfig === 'function') {\n            console.log('[MsdControls] Element upgraded via updateComplete:', element.tagName);\n            return element;\n          }\n        } catch (e) {\n          // Ignore update errors\n        }\n      }\n\n      // Force upgrade attempt\n      if (window.customElements && window.customElements.upgrade) {\n        try {\n          window.customElements.upgrade(element);\n        } catch (e) {\n          // Ignore upgrade errors\n        }\n      }\n\n      // Short wait before next check\n      await new Promise(resolve => setTimeout(resolve, 100));\n    }\n\n    console.warn('[MsdControls] Element upgrade timeout:', {\n      tagName: element.tagName,\n      hasSetConfig: typeof element.setConfig === 'function',\n      waitTime: Date.now() - startTime\n    });\n\n    return element;\n  }\n\n  /**\n   * Configure the card with config and HASS context\n   */\n  async _configureCard(cardElement, cardDef, overlay) {\n    // Build the final configuration\n    const config = this._buildCardConfig(cardDef);\n\n    console.log('[MsdControls] Configuring card:', {\n      overlayId: overlay.id,\n      cardType: cardDef.type,\n      hasSetConfig: typeof cardElement.setConfig === 'function',\n      hasHass: !!this.hass,\n      config: config\n    });\n\n    // Apply configuration with retries\n    if (config) {\n      const success = await this._applyCardConfig(cardElement, config, overlay.id);\n      if (!success) {\n        // Try one more time after a longer delay\n        setTimeout(async () => {\n          console.log('[MsdControls] Retrying config application after delay:', overlay.id);\n          await this._applyCardConfig(cardElement, config, overlay.id);\n        }, 1000);\n      }\n    }\n\n    // Force update if possible\n    if (typeof cardElement.requestUpdate === 'function') {\n      try {\n        await cardElement.requestUpdate();\n        console.log('[MsdControls] Requested update for:', overlay.id);\n      } catch (e) {\n        console.debug('[MsdControls] requestUpdate failed:', e);\n      }\n    }\n\n    // ENHANCED: Additional update strategies for different card types\n    if (cardElement.tagName) {\n      const tagName = cardElement.tagName.toLowerCase();\n      const isCustomButtonCard = tagName.includes('cb-lcars') ||\n                                 tagName.includes('button-card') ||\n                                 cardElement._isCustomButtonCard ||\n                                 cardElement.constructor?.name?.includes('Button');\n\n      if (isCustomButtonCard) {\n        // CB-LCARS and custom-button-card specific updates\n        console.log(`[MsdControls] Setting up custom-button-card updates for:`, overlay.id);\n\n        setTimeout(() => {\n          try {\n            // Ensure HASS is set\n            if (this.hass) {\n              cardElement.hass = this.hass;\n              cardElement._hass = this.hass;\n            }\n\n            // Force full re-evaluation to trigger state-based styling\n            if (cardElement._config && typeof cardElement.setConfig === 'function') {\n              const currentConfig = { ...cardElement._config };\n              cardElement.setConfig(currentConfig);\n\n              // Re-apply HASS after config\n              if (this.hass) {\n                cardElement.hass = this.hass;\n              }\n            }\n\n            // LitElement update if available\n            if (typeof cardElement.requestUpdate === 'function') {\n              cardElement.requestUpdate();\n            }\n\n            console.debug('[MsdControls] ✅ Custom-button-card initial update completed for:', overlay.id);\n\n          } catch (e) {\n            console.debug('[MsdControls] Custom-button-card specific update failed:', e);\n          }\n        }, 100);\n\n      } else if (tagName.startsWith('hui-')) {\n        // Home Assistant built-in card updates\n        setTimeout(() => {\n          try {\n            if (typeof cardElement.requestUpdate === 'function') {\n              cardElement.requestUpdate();\n            }\n            // Force state update\n            if (this.hass) {\n              cardElement.hass = this.hass;\n            }\n          } catch (e) {\n            console.debug('[MsdControls] HA card specific update failed:', e);\n          }\n        }, 200);\n      }\n    }\n  }\n\n  /**\n   * Build card configuration from card definition\n   */\n  _buildCardConfig(cardDef) {\n    if (!cardDef) return null;\n\n    let finalConfig;\n\n    // Handle nested config structure: { type: \"light\", config: { entity: \"light.example\" } }\n    if (cardDef.config && typeof cardDef.config === 'object') {\n      finalConfig = {\n        type: cardDef.type,\n        ...cardDef.config\n      };\n    } else {\n      // Handle flat structure: { type: \"light\", entity: \"light.example\", name: \"My Light\" }\n      const { type, config, card, card_config, cardConfig, ...otherProps } = cardDef;\n      finalConfig = {\n        type,\n        ...otherProps\n      };\n    }\n\n    // FIXED: More precise detection for CB-LCARS and custom-button-card based cards\n    const cardType = finalConfig.type;\n    const isCustomButtonCard = cardType === 'custom:cb-lcars-button-card' ||\n                               cardType === 'cb-lcars-button-card' ||\n                               cardType === 'custom:button-card' ||\n                               cardType === 'button-card';\n\n    // Do NOT treat regular HA built-in cards as custom-button-cards\n    const isBuiltInCard = cardType === 'button' || cardType === 'light' || cardType === 'switch' ||\n                          cardType.startsWith('hui-');\n\n    if (isCustomButtonCard && !isBuiltInCard && finalConfig.entity) {\n      console.log(`[MsdControlsRenderer] Adding triggers_update for CB-LCARS card with entity: ${finalConfig.entity}`);\n\n      // Ensure triggers_update includes the entity\n      if (isCustomButtonCard && !isBuiltInCard) {\n        console.log(`[MsdControlsRenderer] Setting triggers_update to 'all' for CB-LCARS card: ${finalConfig.entity}`);\n\n        // FIXED: Use 'all' so the card sees ALL HASS updates, not just specific entities\n        finalConfig.triggers_update = 'all';\n\n        console.log(`[MsdControlsRenderer] CB-LCARS card configured with triggers_update: 'all'`);\n      }\n\n      console.log(`[MsdControlsRenderer] CB-LCARS card configured with triggers_update:`, finalConfig.triggers_update);\n    } else if (isBuiltInCard) {\n      console.log(`[MsdControlsRenderer] Skipping triggers_update for built-in HA card: ${cardType}`);\n    }    // Mark as MSD-generated\n    finalConfig._msdGenerated = true;\n\n    return finalConfig;\n  }\n\n  /**\n   * Apply HASS context to card element with multiple strategies\n   */\n  async _applyHassContext(cardElement, overlayId) {\n    if (!this.hass) {\n      console.warn('[MsdControls] No HASS context available for:', overlayId);\n      return false;\n    }\n\n    console.log('[MsdControls] Starting HASS application strategies for:', overlayId);\n\n    const strategies = [\n      // Strategy 1: Direct property assignment\n      () => {\n        console.log('[MsdControls] HASS Strategy 1: Attempting direct property assignment for:', overlayId);\n        try {\n          cardElement.hass = this.hass;\n          const success = cardElement.hass === this.hass;\n          if (success) {\n            console.log('[MsdControls] ✅ HASS Strategy 1 SUCCESS: Direct property assignment for:', overlayId);\n          } else {\n            console.log('[MsdControls] ❌ HASS Strategy 1 FAILED: Property assignment did not stick for:', overlayId);\n          }\n          return success;\n        } catch (e) {\n          console.log('[MsdControls] ❌ HASS Strategy 1 FAILED: Property assignment error for', overlayId, ':', e.message);\n          return false;\n        }\n      },\n\n      // Strategy 2: Use property descriptor\n      () => {\n        console.log('[MsdControls] HASS Strategy 2: Attempting property descriptor for:', overlayId);\n        try {\n          Object.defineProperty(cardElement, 'hass', {\n            value: this.hass,\n            writable: true,\n            configurable: true\n          });\n          console.log('[MsdControls] ✅ HASS Strategy 2 SUCCESS: Property descriptor applied for:', overlayId);\n          return true;\n        } catch (e) {\n          console.log('[MsdControls] ❌ HASS Strategy 2 FAILED: Property descriptor error for', overlayId, ':', e.message);\n          return false;\n        }\n      },\n\n      // Strategy 3: Store in private property for later access\n      () => {\n        console.log('[MsdControls] HASS Strategy 3: Attempting private property fallback for:', overlayId);\n        try {\n          cardElement._hass = this.hass;\n          // Also try setting via property if it exists\n          if ('hass' in cardElement) {\n            cardElement.hass = this.hass;\n            console.log('[MsdControls] HASS Strategy 3: Also set public hass property for:', overlayId);\n          }\n          console.log('[MsdControls] ✅ HASS Strategy 3 SUCCESS: Private property fallback for:', overlayId);\n          return true;\n        } catch (e) {\n          console.log('[MsdControls] ❌ HASS Strategy 3 FAILED: Private property error for', overlayId, ':', e.message);\n          return false;\n        }\n      }\n    ];\n\n    for (const [index, strategy] of strategies.entries()) {\n      if (strategy()) {\n        console.log(`[MsdControls] 🎉 HASS application SUCCESSFUL via strategy ${index + 1} for:`, overlayId);\n        return true;\n      }\n    }\n\n    console.log('[MsdControls] 💥 ALL HASS STRATEGIES FAILED for:', overlayId);\n    return false;\n  }\n\n  /**\n   * Apply card configuration with retry logic\n   */\n  async _applyCardConfig(cardElement, config, overlayId) {\n    if (!config) return false;\n\n    console.log('[MsdControls] Applying config:', {\n      overlayId: overlayId,\n      hasSetConfig: typeof cardElement.setConfig === 'function',\n      cardType: config.type,\n      entity: config.entity,\n      triggersUpdate: config.triggers_update,\n      config: config\n    });\n\n    const maxRetries = 8; // Increased retries\n\n    for (let attempt = 0; attempt < maxRetries; attempt++) {\n      try {\n        if (typeof cardElement.setConfig === 'function') {\n          cardElement.setConfig(config);\n          cardElement._config = config;\n\n          // ADDED: Verify the config was applied correctly\n          if (cardElement._config && cardElement._config.triggers_update) {\n            console.log(`[MsdControls] ✅ Config applied with triggers_update:${cardElement._config.triggers_update} for:`, overlayId);\n          } else {\n            console.warn(`[MsdControls] ⚠️ Config applied but no triggers_update found for:`, overlayId);\n          }\n\n          console.log(`[MsdControls] ✅ Config applied on attempt ${attempt + 1} for:`, overlayId);\n          return true;\n        }\n\n        // If setConfig not available yet, wait and retry\n        if (attempt < maxRetries - 1) {\n          const delay = 200 * (attempt + 1); // Increased delay\n          console.log(`[MsdControls] Retrying config in ${delay}ms for:`, overlayId);\n          await new Promise(resolve => setTimeout(resolve, delay));\n        }\n\n      } catch (e) {\n        console.warn(`[MsdControls] setConfig attempt ${attempt + 1} failed for ${overlayId}:`, e);\n\n        if (attempt < maxRetries - 1) {\n          await new Promise(resolve => setTimeout(resolve, 200 * (attempt + 1)));\n        }\n      }\n    }\n\n    // Store config for later application\n    cardElement._pendingConfig = config;\n    console.warn('[MsdControls] ❌ Config stored for deferred application:', overlayId);\n\n    // Set up a periodic retry\n    const retryInterval = setInterval(() => {\n      if (typeof cardElement.setConfig === 'function') {\n        try {\n          cardElement.setConfig(config);\n          cardElement._config = config;\n          console.log('[MsdControls] ✅ Deferred config finally applied:', overlayId);\n          clearInterval(retryInterval);\n        } catch (e) {\n          console.warn('[MsdControls] Deferred config retry failed:', overlayId, e);\n        }\n      }\n    }, 1000);\n\n    // Clear interval after 10 seconds\n    setTimeout(() => clearInterval(retryInterval), 10000);\n\n    return false;\n  }\n\n  /**\n   * Create fallback card when creation fails\n   */\n  _createFallbackCard(cardType, cardDef) {\n    const fallback = document.createElement('div');\n    fallback.className = 'msd-control-fallback';\n\n    Object.assign(fallback.style, {\n      border: '2px dashed var(--primary-color, #ffa500)',\n      borderRadius: '8px',\n      padding: '16px',\n      background: 'var(--card-background-color, rgba(0,0,0,0.8))',\n      color: 'var(--primary-text-color, #ffffff)',\n      fontSize: '14px',\n      textAlign: 'center',\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n      alignItems: 'center',\n      minHeight: '80px'\n    });\n\n    const title = document.createElement('div');\n    title.textContent = `Card: ${cardType}`;\n    title.style.fontWeight = 'bold';\n    title.style.marginBottom = '8px';\n\n    const subtitle = document.createElement('div');\n    subtitle.textContent = '(Card failed to load)';\n    subtitle.style.fontSize = '12px';\n    subtitle.style.opacity = '0.7';\n\n    fallback.appendChild(title);\n    fallback.appendChild(subtitle);\n\n    // Make it interactive for debugging\n    fallback.addEventListener('click', () => {\n      console.log('[MsdControls] Fallback card clicked:', { cardType, cardDef });\n    });\n\n    return fallback;\n  }\n\n  /**\n   * Setup event isolation for control interactions\n   */\n  _setupEventIsolation(wrapper, cardElement, overlay) {\n    // FIXED: Less aggressive event isolation - allow events to reach card, but prevent bubbling to MSD\n    const events = [\n      'click', 'dblclick', 'contextmenu',\n      'pointerdown', 'pointerup', 'pointermove', 'pointercancel',\n      'touchstart', 'touchend', 'touchmove', 'touchcancel',\n      'mousedown', 'mouseup', 'mousemove', 'mouseenter', 'mouseleave',\n      'focus', 'blur', 'focusin', 'focusout',\n      'keydown', 'keyup', 'keypress'\n    ];\n\n    events.forEach(eventType => {\n      wrapper.addEventListener(eventType, (event) => {\n        // FIXED: Only stop propagation if the event originated from our card\n        // This prevents MSD from handling card events, but allows the card to work\n        if (event.target === cardElement || cardElement.contains(event.target)) {\n          // Allow the event to proceed to the card normally\n          // Only stop it from bubbling further up to MSD\n          event.stopPropagation();\n          /*\n          console.debug('[MsdControls] Event allowed to card but prevented from bubbling:', {\n            type: event.type,\n            overlayId: overlay.id,\n            target: event.target.tagName,\n            cardType: cardElement?.tagName\n          });\n          */\n        }\n      }, {\n        capture: false,  // CHANGED: Use bubble phase so card gets events first\n        passive: false   // Allow preventDefault if needed\n      });\n    });\n\n    // ADDED: Set higher z-index and pointer events\n    wrapper.style.pointerEvents = 'auto';\n    wrapper.style.position = 'absolute';\n    wrapper.style.zIndex = '1000'; // Ensure it's above other layers\n    wrapper.setAttribute('tabindex', '0');\n\n    // ADDED: Ensure the card element itself can receive events\n    if (cardElement) {\n      cardElement.style.pointerEvents = 'auto';\n      cardElement.style.position = 'relative';\n      cardElement.style.zIndex = '1';\n\n      // ADDED: Ensure card can receive all necessary events for hold actions\n      cardElement.style.touchAction = 'manipulation'; // Improves touch responsiveness\n    }\n  }\n\n  positionControlElement(element, overlay, resolvedModel) {\n    const position = this.resolvePosition(overlay.position, resolvedModel);\n    const size = this.resolveSize(overlay.size, resolvedModel);\n\n    if (!position || !size) {\n      console.warn('[MSD Controls] Invalid position or size for control:', overlay.id);\n      return;\n    }\n\n    // Create SVG foreignObject wrapper to live in viewBox coordinate space\n    const foreignObject = this.createSvgForeignObject(overlay.id, position, size);\n    if (!foreignObject) {\n      console.error('[MSD Controls] Failed to create SVG foreignObject for:', overlay.id);\n      return;\n    }\n\n    // Configure the control element for SVG embedding\n    this.configureControlForSvg(element, overlay, size);\n\n    // Insert control into foreignObject\n    foreignObject.appendChild(element);\n\n    // Add to SVG container (this will scale automatically with viewBox)\n    const svgContainer = this.getSvgControlsContainer();\n    if (svgContainer && foreignObject.parentNode !== svgContainer) {\n      svgContainer.appendChild(foreignObject);\n      console.debug('[MSD Controls] Control positioned in SVG coordinates:', overlay.id, { position, size });\n    }\n  }\n\n  /**\n   * Create an SVG foreignObject element to embed HTML controls in viewBox space\n   */\n  createSvgForeignObject(overlayId, position, size) {\n    const targetContainer = this.renderer.container || this.renderer.mountEl;\n    const svg = targetContainer?.querySelector('svg');\n\n    if (!svg) {\n      console.warn('[MSD Controls] No SVG element found for foreignObject creation');\n      return null;\n    }\n\n    try {\n      const foreignObject = document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject');\n\n      // Position in viewBox coordinates\n      foreignObject.setAttribute('x', position[0]);\n      foreignObject.setAttribute('y', position[1]);\n      foreignObject.setAttribute('width', size[0]);\n      foreignObject.setAttribute('height', size[1]);\n\n      // Add identification attributes\n      foreignObject.setAttribute('data-msd-control-id', overlayId);\n      foreignObject.setAttribute('id', `msd-control-foreign-${overlayId}`);\n\n      // Ensure proper event handling\n      foreignObject.style.pointerEvents = 'auto';\n      foreignObject.style.overflow = 'visible';\n\n      return foreignObject;\n\n    } catch (error) {\n      console.error('[MSD Controls] Failed to create foreignObject:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Configure control element for SVG embedding\n   */\n  configureControlForSvg(element, overlay, size) {\n    // Remove any absolute positioning that would interfere with foreignObject\n    element.style.position = 'relative';\n    element.style.left = 'auto';\n    element.style.top = 'auto';\n\n    // Size the element to fill the foreignObject\n    element.style.width = '100%';\n    element.style.height = '100%';\n    element.style.boxSizing = 'border-box';\n\n    // Ensure proper event handling\n    element.style.pointerEvents = 'auto';\n    element.style.zIndex = overlay.z_index || 'auto';\n\n    // Maintain background if needed\n    if (!element.style.background && !element.shadowRoot) {\n      element.style.background = 'none';\n    }\n\n    console.debug('[MSD Controls] Configured element for SVG embedding:', overlay.id);\n  }\n\n  /**\n   * Get or create the SVG controls container group\n   */\n  getSvgControlsContainer() {\n    const targetContainer = this.renderer.container || this.renderer.mountEl;\n    const svg = targetContainer?.querySelector('svg');\n\n    if (!svg) {\n      console.warn('[MSD Controls] No SVG element found for controls container');\n      return null;\n    }\n\n    // Look for existing controls group\n    let controlsGroup = svg.querySelector('#msd-controls-container');\n\n    if (!controlsGroup) {\n      // Create new controls group\n      controlsGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n      controlsGroup.setAttribute('id', 'msd-controls-container');\n      controlsGroup.style.pointerEvents = 'none'; // Group itself doesn't capture events\n\n      // Insert after overlay container but before debug layer\n      const overlayContainer = svg.querySelector('#msd-overlay-container');\n      const debugLayer = svg.querySelector('#msd-debug-layer');\n\n      if (debugLayer) {\n        svg.insertBefore(controlsGroup, debugLayer);\n      } else if (overlayContainer) {\n        svg.insertBefore(controlsGroup, overlayContainer.nextSibling);\n      } else {\n        svg.appendChild(controlsGroup);\n      }\n\n      console.log('[MSD Controls] Created SVG controls container group');\n    }\n\n    return controlsGroup;\n  }\n\n  // Helper methods for position and size resolution\n  resolvePosition(position, resolvedModel) {\n    // Use the PositionResolver for consistency with other overlays\n    const resolved = PositionResolver.resolvePosition(position, resolvedModel.anchors || {});\n    if (resolved) {\n      return resolved;\n    }\n\n    // Fallback: Return default position if resolution fails\n    console.warn('[MSD Controls] Position resolution failed, using default [0, 0]');\n    return [0, 0];\n  }\n\n  resolveSize(size, resolvedModel) {\n    if (!size || !Array.isArray(size) || size.length < 2) {\n      return [100, 100];\n    }\n    return [size[0], size[1]];\n  }\n\n  // Cleanup method\n  cleanup() {\n    console.log('[MsdControlsRenderer] Cleaning up controls renderer');\n\n    // Clear control elements (now foreignObjects in SVG)\n    for (const [id, element] of this.controlElements) {\n      try {\n        // Remove foreignObject wrapper from SVG\n        const foreignObject = element.closest('foreignObject') ||\n                             document.querySelector(`#msd-control-foreign-${id}`);\n        if (foreignObject && foreignObject.remove) {\n          foreignObject.remove();\n        } else if (element && element.remove) {\n          element.remove();\n        }\n      } catch (e) {\n        console.warn(`Failed to remove control element ${id}:`, e);\n      }\n    }\n    this.controlElements.clear();\n\n    // Remove SVG controls container\n    const targetContainer = this.renderer?.container || this.renderer?.mountEl;\n    const svg = targetContainer?.querySelector('svg');\n    const svgControlsContainer = svg?.querySelector('#msd-controls-container');\n    if (svgControlsContainer) {\n      try {\n        svgControlsContainer.remove();\n      } catch (e) {\n        console.warn('Failed to remove SVG controls container:', e);\n      }\n    }\n\n    // Clean up any legacy DOM container if it exists\n    const legacyContainer = targetContainer?.querySelector('#msd-controls-container');\n    if (legacyContainer && legacyContainer.tagName === 'DIV') {\n      try {\n        legacyContainer.remove();\n        console.log('[MsdControlsRenderer] Removed legacy DOM controls container');\n      } catch (e) {\n        console.warn('Failed to remove legacy controls container:', e);\n      }\n    }\n\n    // Clear HASS reference\n    this.hass = null;\n  }\n}\n\n","/**\n * Enhanced Performance monitoring panel for MSD HUD\n * Timer and counter data with threshold alerts and reset functionality\n */\n\nexport class PerformancePanel {\n  constructor() {\n    this.thresholds = new Map(); // timerId -> threshold config\n    this.previousSnapshot = {};\n  }\n\n  // Instance methods replacing global panel handlers\n  setThreshold(timerId, avgMs) {\n    const t = parseFloat(avgMs);\n    if (isNaN(t)) this.thresholds.delete(timerId);\n    else this.thresholds.set(timerId, { avgMs: t });\n  }\n  resetTimer(timerId) {\n    try { window.__msdDebug?.getPerf?.()?.resetTimer?.(timerId); } catch {}\n  }\n  clearAllTimers() {\n    try { window.__msdDebug?.getPerf?.()?.clear?.(); } catch {}\n    this.thresholds.clear();\n  }\n  exportData() {\n    const perfData = window.__msdDebug?.getPerf?.() || {};\n    const data = {\n      timestamp: Date.now(),\n      timers: perfData.timers || {},\n      counters: perfData.counters || {},\n      thresholds: Object.fromEntries(this.thresholds)\n    };\n\n    console.table(data.timers);\n    console.log('[PerformancePanel] Performance data:', data);\n\n    // Create downloadable export\n    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `msd-performance-${Date.now()}.json`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  }\n\n  captureData() {\n    const timers = {};\n    const counters = {};\n    const alerts = [];\n    const regressions = [];\n\n    try {\n      // FIXED: Use centralized debug status access for performance state\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n\n      // Get performance data using consistent approach\n      const perfData = window.__msdDebug?.getPerf?.() || {};\n\n      // Process timers\n      if (perfData.timers) {\n        Object.entries(perfData.timers).forEach(([key, data]) => {\n          const timerData = {\n            count: data.count || 0,\n            total: data.total || 0,\n            avg: data.count > 0 ? (data.total / data.count) : 0,\n            last: data.last || 0,\n            max: data.max || 0,\n            min: data.min || 0\n          };\n\n          timers[key] = timerData;\n\n          // Check thresholds\n          const threshold = this.thresholds.get(key);\n          if (threshold && timerData.avg > threshold.avgMs) {\n            alerts.push({\n              type: 'threshold',\n              timer: key,\n              current: timerData.avg,\n              threshold: threshold.avgMs,\n              severity: timerData.avg > threshold.avgMs * 2 ? 'high' : 'medium'\n            });\n          }\n\n          // Check for regressions\n          const previous = this.previousSnapshot[key];\n          if (previous && previous.avg > 0) {\n            const regression = ((timerData.avg - previous.avg) / previous.avg) * 100;\n            if (regression > 20) { // >20% increase\n              regressions.push({\n                timer: key,\n                previousAvg: previous.avg,\n                currentAvg: timerData.avg,\n                regression: regression\n              });\n            }\n          }\n        });\n      }\n\n      // Process counters\n      if (perfData.counters) {\n        Object.entries(perfData.counters).forEach(([key, value]) => {\n          counters[key] = Number(value) || 0;\n        });\n      }\n\n      // Store snapshot for regression detection\n      this.previousSnapshot = { ...timers };\n\n    } catch (e) {\n      console.warn('[PerformancePanel] Data capture failed:', e);\n    }\n\n    return { timers, counters, alerts, regressions };\n  }\n\n  renderHtml(performance) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Performance Monitor</h3>';\n\n    const { timers, counters, alerts, regressions } = performance;\n\n    // Controls section\n    html += '<div class=\"msd-hud-section\"><h4>Controls</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;\">';\n\n    html += `<button data-bus-event=\"performance:clear-all\" onclick=\"__msdHudBus('performance:clear-all')\"\n      style=\"font-size:10px;padding:2px 6px;background:#666;color:#fff;border:1px solid #888;border-radius:3px;cursor:pointer;\">\n      Clear All\n    </button>`;\n\n    html += `<button data-bus-event=\"performance:export\" onclick=\"__msdHudBus('performance:export')\"\n      style=\"font-size:10px;padding:2px 6px;background:#333;color:#fff;border:1px solid #555;border-radius:3px;cursor:pointer;\">\n      Export\n    </button>`;\n\n    html += '</div></div>';\n\n    // Alerts section\n    if (alerts && alerts.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-warning\"><h4>Threshold Alerts</h4>';\n      alerts.forEach(alert => {\n        const severityColor = alert.severity === 'high' ? '#ff4444' : '#ffaa00';\n        html += `<div class=\"msd-hud-metric msd-hud-warning\">\n          <span class=\"msd-hud-metric-name\" style=\"color:${severityColor};\">${alert.timer}</span>\n          <span class=\"msd-hud-metric-value\">${alert.current.toFixed(2)}ms > ${alert.threshold}ms</span>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Regressions section\n    if (regressions && regressions.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-error\"><h4>Performance Regressions</h4>';\n      regressions.forEach(regression => {\n        html += `<div class=\"msd-hud-metric msd-hud-error\">\n          <span class=\"msd-hud-metric-name\">${regression.timer}</span>\n          <span class=\"msd-hud-metric-value\">+${regression.regression.toFixed(1)}%</span>\n        </div>`;\n        html += `<div class=\"msd-hud-metric-detail\">\n          ${regression.previousAvg.toFixed(2)}ms → ${regression.currentAvg.toFixed(2)}ms\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Timers section\n    const timerEntries = Object.entries(timers || {}).slice(0, 10);\n    if (timerEntries.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Timers</h4>';\n\n      // Sort by average time descending\n      timerEntries.sort(([,a], [,b]) => b.avg - a.avg);\n\n      timerEntries.forEach(([key, data]) => {\n        const hasThreshold = this.thresholds.has(key);\n        const threshold = this.thresholds.get(key);\n        const isOverThreshold = hasThreshold && data.avg > threshold.avgMs;\n        const avgColor = isOverThreshold ? '#ff6666' : data.avg > 10 ? '#ffaa00' : '#66ff99';\n\n        html += `<div class=\"msd-hud-metric\" style=\"margin:4px 0;padding:4px;border:1px solid #333;border-radius:3px;\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${key}</span>\n            <span class=\"msd-hud-metric-value\" style=\"color:${avgColor};\">${data.avg.toFixed(2)}ms</span>\n          </div>\n          <div style=\"font-size:10px;color:#888;margin-top:2px;\">\n            Count: ${data.count} • Max: ${data.max.toFixed(1)}ms • Last: ${data.last.toFixed(1)}ms\n          </div>\n          <div style=\"display:flex;gap:4px;margin-top:4px;\">\n            <input type=\"number\" placeholder=\"Threshold (ms)\" value=\"${hasThreshold ? threshold.avgMs : ''}\"\n              id=\"perf-threshold-${key.replace(/[^a-z0-9_-]/gi,'-')}\"\n              name=\"perf-threshold-${key.replace(/[^a-z0-9_-]/gi,'-')}\"\n              data-bus-event=\"performance:set-threshold\" data-timer=\"${key}\"\n              onchange=\"__msdHudBus('performance:set-threshold',{timer:'${key}',value:this.value})\"\n              style=\"width:80px;font-size:9px;padding:1px 3px;\">\n            <button data-bus-event=\"performance:reset-timer\"\n              onclick=\"__msdHudBus('performance:reset-timer',{timer:'${key}'})\"\n              style=\"font-size:9px;padding:1px 4px;background:#555;color:#fff;border:1px solid #777;border-radius:2px;cursor:pointer;\">\n              Reset\n            </button>\n          </div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Counters section\n    const counterEntries = Object.entries(counters || {}).slice(0, 8);\n    if (counterEntries.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Counters</h4>';\n      counterEntries.forEach(([key, value]) => {\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">${key}</span>\n          <span class=\"msd-hud-metric-value\">${value}</span>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    if (timerEntries.length === 0 && counterEntries.length === 0) {\n      html += '<div class=\"msd-hud-section\">No performance data available</div>';\n    }\n\n    // Summary\n    const alertCount = alerts?.length || 0;\n    const regressionCount = regressions?.length || 0;\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${timerEntries.length} timers • ${counterEntries.length} counters\n      ${alertCount > 0 ? ` • ${alertCount} alerts` : ''}\n      ${regressionCount > 0 ? ` • ${regressionCount} regressions` : ''}\n    </div>`;\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Validation monitoring panel for MSD HUD\n * Displays validation errors and warnings with overlay highlighting\n */\n\nexport class ValidationPanel {\n  captureData() {\n    const errors = [];\n    const warnings = [];\n\n    try {\n      // FIXED: Use centralized silent debug status access\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n      let validationData = {};\n\n      if (debugStatus.enabled && window.__msdDebug?.validation?.issues) {\n        validationData = window.__msdDebug.validation.issues() || {};\n      } else {\n        // Fallback: try direct access without debug interface\n        validationData = window.__msdDebug?.pipelineInstance?.getValidationIssues?.() || {};\n      }\n\n      if (validationData.errors) {\n        validationData.errors.forEach(error => {\n          errors.push({\n            code: error.code || 'unknown',\n            severity: error.severity || 'error',\n            message: error.msg || error.message || 'Unknown error',\n            overlay: error.overlay,\n            anchor: error.anchor\n          });\n        });\n      }\n\n      if (validationData.warnings) {\n        validationData.warnings.forEach(warning => {\n          warnings.push({\n            code: warning.code || 'unknown',\n            severity: warning.severity || 'warning',\n            message: warning.msg || warning.message || 'Unknown warning',\n            overlay: warning.overlay,\n            anchor: warning.anchor\n          });\n        });\n      }\n    } catch (_) {}\n\n    return { errors, warnings };\n  }\n\n  renderHtml(validation) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Validation</h3>';\n\n    // Errors section\n    const errors = validation.errors || [];\n    if (errors.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-errors\"><h4>Errors</h4>';\n      errors.slice(0, 6).forEach(error => {\n        html += `<div class=\"msd-hud-metric msd-hud-error\"\n          data-select-type=\"${error.overlay ? 'overlay':'anchor'}\"\n          data-select-id=\"${error.overlay || error.anchor || error.code}\"\n          onclick=\"__msdHudBus('select:set',{type:'${error.overlay ? 'overlay':'anchor'}',id:'${error.overlay || error.anchor || error.code}',source:'validation'})\"\n        >\n          <span class=\"msd-hud-metric-name\">${error.code}</span>\n          <span class=\"msd-hud-metric-value\">${error.message}</span>\n        </div>`;\n        if (error.overlay) {\n          html += `<div class=\"msd-hud-metric-detail\">Overlay: ${error.overlay}</div>`;\n        }\n        if (error.anchor) {\n          html += `<div class=\"msd-hud-metric-detail\">Anchor: ${error.anchor}</div>`;\n        }\n      });\n      html += '</div>';\n    }\n\n    // Warnings section\n    const warnings = validation.warnings || [];\n    if (warnings.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-warnings\"><h4>Warnings</h4>';\n      warnings.slice(0, 6).forEach(warning => {\n        html += `<div class=\"msd-hud-metric msd-hud-warning\"\n          data-select-type=\"${warning.overlay ? 'overlay':'anchor'}\"\n          data-select-id=\"${warning.overlay || warning.anchor || warning.code}\"\n          onclick=\"__msdHudBus('select:set',{type:'${warning.overlay ? 'overlay':'anchor'}',id:'${warning.overlay || warning.anchor || warning.code}',source:'validation'})\"\n        >\n          <span class=\"msd-hud-metric-name\">${warning.code}</span>\n          <span class=\"msd-hud-metric-value\">${warning.message}</span>\n        </div>`;\n        if (warning.overlay) {\n          html += `<div class=\"msd-hud-metric-detail\">Overlay: ${warning.overlay}</div>`;\n        }\n      });\n      html += '</div>';\n    }\n\n    // Status section\n    const totalIssues = errors.length + warnings.length;\n    if (totalIssues === 0) {\n      html += '<div class=\"msd-hud-section msd-hud-success\">✅ No validation issues</div>';\n    } else {\n      html += `<div class=\"msd-hud-section msd-hud-summary\">\n        ${errors.length} errors, ${warnings.length} warnings\n      </div>`;\n    }\n\n    html += '</div>';\n    return html;\n\n}\n}\n","/**\n * Enhanced Data source monitoring panel for MSD HUD\n * DataSourceManager integration health checks and subscription diagnostics\n */\n\nexport class DataSourcePanel {\n  constructor() {\n    this.entityChangeHistory = new Map(); // entityId -> recent state changes\n    this.maxHistoryLength = 10;\n\n    // ADDED: Set up global helper functions\n    this._setupGlobalHelpers();\n  }\n\n  // ADDED: Setup simple global helper functions with direct access\n  _setupGlobalHelpers() {\n    // Global entity inspection function with direct DataSourceManager access\n    window.__msdInspectDataEntity = (entityId) => {\n      console.log('[DataSourcePanel] Inspecting entity:', entityId);\n\n      const dsManager = window.__msdDebug?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n\n      if (!dsManager?.getEntity) {\n        console.warn('[DataSourcePanel] DataSourceManager not available');\n        return;\n      }\n\n      const entity = dsManager.getEntity(entityId);\n      if (!entity) {\n        console.warn('[DataSourcePanel] Entity not found:', entityId);\n        return;\n      }\n\n      // Show available methods for debugging\n      console.log('[DataSourcePanel] Available dsManager methods:', Object.getOwnPropertyNames(dsManager).filter(name => typeof dsManager[name] === 'function'));\n\n      // Console logging\n      console.group(`🔍 Entity Inspection: ${entityId}`);\n      console.log('Entity Data:', entity);\n      console.table([entity]);\n      console.groupEnd();\n\n      // Show popup with the entity data we just retrieved\n      this._showEntityPopup(entityId, entity);\n    };\n\n    // Global subscription inspection function with direct DataSourceManager access\n    window.__msdInspectDataSubscription = (sourceName) => {\n      console.log('[DataSourcePanel] Inspecting subscription:', sourceName);\n\n      const dsManager = window.__msdDebug?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n\n      if (!dsManager?.getStats) {\n        console.warn('[DataSourcePanel] DataSourceManager not available');\n        return;\n      }\n\n      const stats = dsManager.getStats() || {};\n      const sourceData = stats.sources?.[sourceName] || {};\n\n      // ADDED: Get subscriber details using new API\n      let subscribers = [];\n      try {\n        subscribers = dsManager.getSourceSubscribers?.(sourceName) || [];\n        console.log('[DataSourcePanel] Found subscribers via API:', subscribers);\n      } catch (e) {\n        console.warn('[DataSourcePanel] Error getting subscribers:', e);\n      }\n\n      // Console logging\n      console.group(`🔍 Subscription Inspection: ${sourceName}`);\n      console.log('Source Stats:', sourceData);\n      console.log('Subscribers:', subscribers);\n      console.log('All Stats:', stats);\n      console.groupEnd();\n\n      // Show popup with the subscription data and subscriber details\n      this._showSubscriptionPopup(sourceName, sourceData, subscribers);\n    };    // Simple refresh function\n    window.__msdRefreshDataSources = () => {\n      const dsManager = window.__msdDebug?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n\n      if (dsManager?.refreshSubscriptions) {\n        dsManager.refreshSubscriptions();\n        console.log('[DataSourcePanel] Subscriptions refreshed');\n      } else {\n        console.warn('[DataSourcePanel] Refresh not available');\n      }\n\n      // Trigger HUD refresh\n      if (window.__msdDebug?.hud?.refresh) {\n        window.__msdDebug.hud.refresh();\n      }\n    };\n  }\n\n  // SIMPLE: Show entity popup using fresh DataSourceManager data\n  _showEntityPopup(entityId, entity) {\n    // Remove any existing popup\n    const existing = document.getElementById('msd-entity-inspection-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-entity-inspection-popup';\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #66ff99;\n      padding: 20px;\n      border: 2px solid #66ff99;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 700px;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 4px 20px rgba(102, 255, 153, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 16px;color:#ffaa00;\">🔍 Entity Inspection: ${entityId}</h3>`;\n\n    // Basic entity information\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#88ffcc;\">📊 Entity State</h4>\n        <div style=\"display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px;\">\n          <div><strong>Current State:</strong> <span style=\"color:#ffcc88;\">${entity.state || 'N/A'}</span></div>\n          <div><strong>Domain:</strong> ${entityId.split('.')[0]}</div>\n          <div><strong>Last Changed:</strong> ${entity.last_changed ? new Date(entity.last_changed).toLocaleString() : 'N/A'}</div>\n          <div><strong>Last Updated:</strong> ${entity.last_updated ? new Date(entity.last_updated).toLocaleString() : 'N/A'}</div>\n        </div>\n      </div>\n    `;\n\n    // Entity attributes\n    if (entity.attributes && Object.keys(entity.attributes).length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\">🏷️ Attributes (${Object.keys(entity.attributes).length})</h4>\n          <div style=\"font-size:10px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;\">\n      `;\n\n      Object.entries(entity.attributes).forEach(([key, value]) => {\n        const displayValue = typeof value === 'object' ? JSON.stringify(value) : String(value);\n        const truncatedValue = displayValue.length > 60 ? displayValue.substring(0, 57) + '...' : displayValue;\n        content += `<div style=\"margin:2px 0;\"><strong style=\"color:#99ddff;\">${key}:</strong> <span style=\"color:#ccc;\">${truncatedValue}</span></div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Raw entity data\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#88ffcc;\">🔧 Raw Entity Data</h4>\n        <div style=\"font-size:9px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;word-break:break-all;color:#aaa;\">\n          ${JSON.stringify(entity, null, 2)}\n        </div>\n      </div>\n    `;\n\n    // Action buttons\n    content += `\n      <div style=\"text-align:center;margin-top:20px;border-top:1px solid #333;padding-top:16px;\">\n        <button onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(entity)}, null, 2)); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy Entity', 2000);\"\n          style=\"background:#225522;color:#fff;border:1px solid #55aa55;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Copy Entity\n        </button>\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n  }\n\n  // UPDATED: Show subscription popup with basic subscriber details\n  _showSubscriptionPopup(sourceName, sourceData, subscribers = []) {\n    // Remove any existing popup\n    const existing = document.getElementById('msd-subscription-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-subscription-popup';\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #ffaa66;\n      padding: 20px;\n      border: 2px solid #ffaa66;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 600px;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 4px 20px rgba(255, 170, 102, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 16px;color:#ff9900;\">🔗 Subscription: ${sourceName}</h3>`;\n\n    // Subscription statistics\n    if (sourceData && Object.keys(sourceData).length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#ffcc88;\">📊 Statistics</h4>\n          <div style=\"display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px;\">\n            <div><strong>Subscribers:</strong> <span style=\"color:#88ccff;\">${sourceData.subscribers || 0}</span></div>\n            <div><strong>Updates Received:</strong> <span style=\"color:#88ff88;\">${sourceData.received || 0}</span></div>\n            <div><strong>Cache Hits:</strong> <span style=\"color:#ffcc88;\">${sourceData.cacheHits || 0}</span></div>\n            <div><strong>Errors:</strong> <span style=\"color:${sourceData.errors > 0 ? '#ff6666' : '#888'};\">${sourceData.errors || 0}</span></div>\n            <div><strong>Last Update:</strong> ${sourceData.lastUpdate ? new Date(sourceData.lastUpdate).toLocaleString() : 'Never'}</div>\n          </div>\n        </div>\n      `;\n\n      // Cache hit rate\n      if (sourceData.received > 0) {\n        const hitRate = ((sourceData.cacheHits || 0) / sourceData.received * 100).toFixed(1);\n        content += `\n          <div style=\"margin-bottom:16px;\">\n            <h4 style=\"margin:0 0 8px;color:#ffcc88;\">📈 Performance</h4>\n            <div style=\"font-size:11px;\">\n              <div><strong>Cache Hit Rate:</strong> <span style=\"color:#88ff88;\">${hitRate}%</span></div>\n            </div>\n          </div>\n        `;\n      }\n    }\n\n    // ADDED: Basic subscriber details section\n    if (subscribers && subscribers.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#ffcc88;\">👥 Subscribers (${subscribers.length})</h4>\n          <div style=\"font-size:10px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:120px;overflow-y:auto;\">\n      `;\n\n      subscribers.forEach((subscriber, i) => {\n        const name = subscriber.name || subscriber.id || `Subscriber ${i + 1}`;\n        const type = subscriber.type || 'unknown';\n        content += `<div style=\"margin:2px 0;color:#ccc;\">• ${name} <span style=\"color:#888;\">(${type})</span></div>`;\n      });\n\n      content += `</div></div>`;\n    } else if (sourceData.subscribers > 0) {\n      // Show that we know there are subscribers but couldn't get details\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#ffcc88;\">👥 Subscribers</h4>\n          <div style=\"font-size:11px;color:#888;\">\n            ${sourceData.subscribers} active subscriber${sourceData.subscribers === 1 ? '' : 's'} (basic details available)\n          </div>\n        </div>\n      `;\n    }\n\n    // Raw data section\n    const combinedData = { stats: sourceData, subscribers };\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#ffcc88;\">🔧 Raw Data</h4>\n        <div style=\"font-size:9px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;word-break:break-all;color:#aaa;\">\n          ${JSON.stringify(combinedData, null, 2)}\n        </div>\n      </div>\n    `;\n\n    // Action buttons\n    content += `\n      <div style=\"text-align:center;margin-top:20px;border-top:1px solid #333;padding-top:16px;\">\n        <button onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(combinedData)}, null, 2)); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy Data', 2000);\"\n          style=\"background:#552200;color:#fff;border:1px solid #aa5500;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Copy Data\n        </button>\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n  }\n\n  // NEW: Create detailed entity inspection popup\n  _createEntityPopup(entityId, entity, extras = {}) {\n    // Remove any existing popup\n    const existing = document.getElementById('msd-entity-inspection-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-entity-inspection-popup';\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #66ff99;\n      padding: 20px;\n      border: 2px solid #66ff99;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 700px;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 4px 20px rgba(102, 255, 153, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 16px;color:#ffaa00;\">🔍 Entity Inspection: ${entityId}</h3>`;\n\n    // Basic entity information\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#88ffcc;\">📊 Entity State</h4>\n        <div style=\"display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px;\">\n          <div><strong>Current State:</strong> <span style=\"color:#ffcc88;\">${entity.state || 'N/A'}</span></div>\n          <div><strong>Domain:</strong> ${entityId.split('.')[0]}</div>\n          <div><strong>Last Changed:</strong> ${entity.last_changed ? new Date(entity.last_changed).toLocaleString() : 'N/A'}</div>\n          <div><strong>Last Updated:</strong> ${entity.last_updated ? new Date(entity.last_updated).toLocaleString() : 'N/A'}</div>\n        </div>\n      </div>\n    `;\n\n    // Entity attributes\n    if (entity.attributes && Object.keys(entity.attributes).length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\">🏷️ Attributes</h4>\n          <div style=\"font-size:10px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:150px;overflow-y:auto;\">\n      `;\n\n      Object.entries(entity.attributes).forEach(([key, value]) => {\n        const displayValue = typeof value === 'object' ? JSON.stringify(value) : String(value);\n        const truncatedValue = displayValue.length > 50 ? displayValue.substring(0, 47) + '...' : displayValue;\n        content += `<div style=\"margin:2px 0;\"><strong style=\"color:#99ddff;\">${key}:</strong> <span style=\"color:#ccc;\">${truncatedValue}</span></div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Change history\n    if (extras.history) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\">📈 Recent Activity</h4>\n          <div style=\"font-size:11px;color:#ccc;\">\n            <div><strong>Previous State:</strong> ${extras.history.state || 'N/A'}</div>\n            <div><strong>Changed:</strong> ${new Date(extras.history.timestamp).toLocaleString()}</div>\n          </div>\n        </div>\n      `;\n    }\n\n    // Subscribers\n    if (extras.subscribers && extras.subscribers.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\">👥 Subscribers (${extras.subscribers.length})</h4>\n          <div style=\"font-size:10px;color:#ccc;\">\n      `;\n\n      extras.subscribers.forEach((subscriber, i) => {\n        const subscriberName = typeof subscriber === 'string' ? subscriber : (subscriber.name || subscriber.id || `Subscriber ${i + 1}`);\n        content += `<div style=\"margin:2px 0;\">• ${subscriberName}</div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Transforms\n    if (extras.transforms && extras.transforms.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\">🔄 Transforms (${extras.transforms.length})</h4>\n          <div style=\"font-size:10px;color:#ccc;\">\n      `;\n\n      extras.transforms.forEach((transform, i) => {\n        const transformName = typeof transform === 'string' ? transform : (transform.type || transform.name || `Transform ${i + 1}`);\n        content += `<div style=\"margin:2px 0;\">• ${transformName}</div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Calculations\n    if (extras.calculations && extras.calculations.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\">🧮 Calculations (${extras.calculations.length})</h4>\n          <div style=\"font-size:10px;color:#ccc;\">\n      `;\n\n      extras.calculations.forEach((calc, i) => {\n        const calcName = typeof calc === 'string' ? calc : (calc.type || calc.name || `Calculation ${i + 1}`);\n        content += `<div style=\"margin:2px 0;\">• ${calcName}</div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Raw entity data\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#88ffcc;\">🔧 Raw Entity Data</h4>\n        <div style=\"font-size:9px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;word-break:break-all;color:#aaa;\">\n          ${JSON.stringify(entity, null, 2)}\n        </div>\n      </div>\n    `;\n\n    // Action buttons\n    content += `\n      <div style=\"text-align:center;margin-top:20px;border-top:1px solid #333;padding-top:16px;\">\n        <button onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(entity)}, null, 2)); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy Entity', 2000);\"\n          style=\"background:#225522;color:#fff;border:1px solid #55aa55;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Copy Entity\n        </button>\n        <button onclick=\"console.log('Entity ${entityId}:', ${JSON.stringify(entity)}); this.textContent='Logged!'; setTimeout(() => this.textContent='Log to Console', 2000);\"\n          style=\"background:#552255;color:#fff;border:1px solid #aa55aa;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Log to Console\n        </button>\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n  }\n\n  // NEW: Show subscription inspection popup using stored data\n  _showSubscriptionInspectionPopup(sourceName) {\n    try {\n      if (!this._currentData?.subscriptions) {\n        console.warn('[DataSourcePanel] No subscription data available');\n        return;\n      }\n\n      const sourceData = this._currentData.subscriptions[sourceName];\n      if (!sourceData) {\n        console.warn('[DataSourcePanel] Subscription not found:', sourceName);\n        return;\n      }\n\n      // Log to console\n      console.group(`🔍 Subscription Inspection: ${sourceName}`);\n      console.log('Source Stats:', sourceData);\n      console.groupEnd();\n\n      // Show detailed popup\n      this._createSubscriptionPopup(sourceName, sourceData, {});\n\n    } catch (e) {\n      console.warn('[DataSourcePanel] Subscription inspection failed:', e);\n    }\n  }\n\n  // NEW: Create subscription inspection popup\n  _createSubscriptionPopup(sourceName, sourceData, details) {\n    // Remove any existing popup\n    const existing = document.getElementById('msd-subscription-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-subscription-popup';\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #ffaa66;\n      padding: 20px;\n      border: 2px solid #ffaa66;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 600px;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 4px 20px rgba(255, 170, 102, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 16px;color:#ff9900;\">🔗 Subscription: ${sourceName}</h3>`;\n\n    // Subscription statistics\n    if (sourceData && Object.keys(sourceData).length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#ffcc88;\">📊 Statistics</h4>\n          <div style=\"display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px;\">\n            <div><strong>Subscribers:</strong> <span style=\"color:#88ccff;\">${sourceData.subscribers || 0}</span></div>\n            <div><strong>Updates Received:</strong> <span style=\"color:#88ff88;\">${sourceData.received || 0}</span></div>\n            <div><strong>Cache Hits:</strong> <span style=\"color:#ffcc88;\">${sourceData.cacheHits || 0}</span></div>\n            <div><strong>Errors:</strong> <span style=\"color:${sourceData.errors > 0 ? '#ff6666' : '#888'};\">${sourceData.errors || 0}</span></div>\n            <div><strong>Last Update:</strong> ${sourceData.lastUpdate ? new Date(sourceData.lastUpdate).toLocaleString() : 'Never'}</div>\n          </div>\n        </div>\n      `;\n\n      // Cache hit rate\n      if (sourceData.received > 0) {\n        const hitRate = ((sourceData.cacheHits || 0) / sourceData.received * 100).toFixed(1);\n        content += `\n          <div style=\"margin-bottom:16px;\">\n            <h4 style=\"margin:0 0 8px;color:#ffcc88;\">📈 Performance</h4>\n            <div style=\"font-size:11px;\">\n              <div><strong>Cache Hit Rate:</strong> <span style=\"color:#88ff88;\">${hitRate}%</span></div>\n            </div>\n          </div>\n        `;\n      }\n    }\n\n    // Detailed subscription info\n    if (details && Object.keys(details).length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#ffcc88;\">🔧 Details</h4>\n          <div style=\"font-size:10px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;\">\n      `;\n\n      Object.entries(details).forEach(([key, value]) => {\n        const displayValue = typeof value === 'object' ? JSON.stringify(value, null, 2) : String(value);\n        content += `<div style=\"margin:3px 0;\"><strong style=\"color:#ffaa88;\">${key}:</strong><br><span style=\"color:#ccc;margin-left:10px;\">${displayValue}</span></div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Raw data section\n    const combinedData = { stats: sourceData, details };\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#ffcc88;\">🔧 Raw Data</h4>\n        <div style=\"font-size:9px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;word-break:break-all;color:#aaa;\">\n          ${JSON.stringify(combinedData, null, 2)}\n        </div>\n      </div>\n    `;\n\n    // Action buttons\n    content += `\n      <div style=\"text-align:center;margin-top:20px;border-top:1px solid #333;padding-top:16px;\">\n        <button onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(combinedData)}, null, 2)); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy Data', 2000);\"\n          style=\"background:#552200;color:#fff;border:1px solid #aa5500;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Copy Data\n        </button>\n        <button onclick=\"console.log('Subscription ${sourceName}:', ${JSON.stringify(combinedData)}); this.textContent='Logged!'; setTimeout(() => this.textContent='Log to Console', 2000);\"\n          style=\"background:#552255;color:#fff;border:1px solid #aa55aa;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Log to Console\n        </button>\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n  }\n\n  refreshSubscriptions() {\n    // REMOVED: Not useful - DataSourceManager doesn't have refreshSubscriptions method\n    // and HUD auto-refreshes anyway\n    console.log('[DataSourcePanel] Refresh functionality removed - HUD auto-refreshes');\n  }\n\n  clearHistory() {\n    // REMOVED: Only clears internal panel history, rebuilds automatically\n    // this.entityChangeHistory.clear();\n    console.log('[DataSourcePanel] Clear history functionality removed - limited utility');\n  }\n\n  captureData() {\n    const entities = {};\n    const stats = {};\n    const health = {};\n    const subscriptions = {};\n    const recentChanges = [];\n\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      const dsManager = pipelineInstance?.dataSourceManager ||\n                       pipelineInstance?.systemsManager?.dataSourceManager ||\n                       window.__msdDebug?.dataSourceManager;\n\n      if (dsManager) {\n        // Get comprehensive stats\n        const entityIds = dsManager.listIds?.() || [];\n        const dsStats = dsManager.getStats?.() || {};\n        const healthCheck = dsManager.getHealth?.() || {};\n\n        // Transform stats\n        stats.count = entityIds.length;\n        stats.subscribed = Object.keys(dsStats.sources || {}).length;\n        stats.updated = Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.received || 0), 0);\n        stats.cacheHits = Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.cacheHits || 0), 0);\n        stats.errors = Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.errors || 0), 0);\n\n        // Health metrics\n        if (healthCheck.status) {\n          health.status = healthCheck.status;\n          health.uptime = healthCheck.uptime || 0;\n          health.lastError = healthCheck.lastError;\n          health.connectionCount = healthCheck.connectionCount || 0;\n        }\n\n        // Subscription details\n        if (dsStats.sources) {\n          Object.entries(dsStats.sources).forEach(([sourceName, sourceData]) => {\n            subscriptions[sourceName] = {\n              subscribers: sourceData.subscribers || 0,\n              received: sourceData.received || 0,\n              errors: sourceData.errors || 0,\n              lastUpdate: sourceData.lastUpdate,\n              cacheHits: sourceData.cacheHits || 0\n            };\n          });\n        }\n\n        // Sample recent entities and track changes\n        entityIds.slice(0, 15).forEach(id => {\n          const entity = dsManager.getEntity?.(id);\n          if (entity) {\n            // Track state changes\n            const previousState = this.entityChangeHistory.get(id);\n            if (previousState && previousState.state !== entity.state) {\n              recentChanges.push({\n                id: id,\n                from: previousState.state,\n                to: entity.state,\n                timestamp: Date.now()\n              });\n            }\n\n            // Store current state\n            this.entityChangeHistory.set(id, {\n              state: entity.state,\n              timestamp: Date.now()\n            });\n\n            // Trim history\n            if (this.entityChangeHistory.size > this.maxHistoryLength) {\n              const oldestKey = this.entityChangeHistory.keys().next().value;\n              this.entityChangeHistory.delete(oldestKey);\n            }\n\n            entities[id] = {\n              state: entity.state,\n              lastChanged: entity.last_changed,\n              lastUpdated: entity.last_updated,\n              attributes: entity.attributes || {},\n              domain: id.split('.')[0] // Extract domain for grouping\n            };\n          }\n        });\n\n      } else {\n        console.warn('[DataSourcePanel] DataSourceManager not available via consolidated interface');\n        stats.error = 'DataSourceManager not available';\n      }\n    } catch (e) {\n      console.warn('[DataSourcePanel] Data capture failed:', e);\n      stats.error = e.message;\n    }\n\n    return { entities, stats, health, subscriptions, recentChanges };\n  }\n\n  renderHtml(entityData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Data Sources</h3>';\n\n    const { entities, stats, health, subscriptions, recentChanges } = entityData;\n\n    // ADDED: Store data for popup access\n    this._currentData = entityData;\n\n    // Error handling\n    if (stats.error) {\n      html += `<div class=\"msd-hud-section msd-hud-error\">\n        <h4>Error</h4>\n        <div class=\"msd-hud-metric-value\">${stats.error}</div>\n      </div>`;\n      html += '</div>';\n      return html;\n    }\n\n    // Health section\n    if (health && health.status) {\n      const statusColor = health.status === 'healthy' ? '#66ff99' :\n                         health.status === 'warning' ? '#ffaa00' : '#ff6666';\n\n      html += '<div class=\"msd-hud-section\"><h4>Health Status</h4>';\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Status</span>\n        <span class=\"msd-hud-metric-value\" style=\"color:${statusColor};\">${health.status}</span>\n      </div>`;\n\n      if (health.uptime > 0) {\n        const uptimeHours = (health.uptime / (1000 * 60 * 60)).toFixed(1);\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">Uptime</span>\n          <span class=\"msd-hud-metric-value\">${uptimeHours}h</span>\n        </div>`;\n      }\n\n      if (health.connectionCount !== undefined) {\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">Connections</span>\n          <span class=\"msd-hud-metric-value\">${health.connectionCount}</span>\n        </div>`;\n      }\n\n      if (health.lastError) {\n        html += `<div class=\"msd-hud-metric msd-hud-warning\">\n          <span class=\"msd-hud-metric-name\">Last Error</span>\n          <span class=\"msd-hud-metric-value\">${health.lastError}</span>\n        </div>`;\n      }\n\n      html += '</div>';\n    }\n\n    // Enhanced statistics section\n    html += '<div class=\"msd-hud-section\"><h4>Statistics</h4>';\n    html += `<div class=\"msd-hud-metric\">\n      <span class=\"msd-hud-metric-name\">Total Entities</span>\n      <span class=\"msd-hud-metric-value\">${stats.count || 0}</span>\n    </div>`;\n    html += `<div class=\"msd-hud-metric\">\n      <span class=\"msd-hud-metric-name\">Data Sources</span>\n      <span class=\"msd-hud-metric-value\">${stats.subscribed || 0}</span>\n    </div>`;\n    html += `<div class=\"msd-hud-metric\">\n      <span class=\"msd-hud-metric-name\">Total Updates</span>\n      <span class=\"msd-hud-metric-value\">${stats.updated || 0}</span>\n    </div>`;\n    if (stats.cacheHits !== undefined) {\n      const hitRate = stats.updated > 0 ? ((stats.cacheHits / stats.updated) * 100).toFixed(1) : '0';\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Cache Hit Rate</span>\n        <span class=\"msd-hud-metric-value\">${hitRate}%</span>\n      </div>`;\n    }\n    if (stats.errors !== undefined && stats.errors > 0) {\n      html += `<div class=\"msd-hud-metric msd-hud-warning\">\n        <span class=\"msd-hud-metric-name\">Errors</span>\n        <span class=\"msd-hud-metric-value\">${stats.errors}</span>\n      </div>`;\n    }\n    html += '</div>';\n\n    // Subscription diagnostics\n    if (subscriptions && Object.keys(subscriptions).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Active Subscriptions</h4>';\n      Object.entries(subscriptions).slice(0, 6).forEach(([sourceName, sourceData]) => {\n        const shortName = sourceName.length > 18 ? sourceName.substring(0, 15) + '...' : sourceName;\n        const hasErrors = sourceData.errors > 0;\n        const errorClass = hasErrors ? 'msd-hud-warning' : '';\n\n        html += `<div class=\"msd-hud-metric ${errorClass}\" style=\"cursor:pointer;\"\n          onclick=\"window.__msdInspectDataSubscription('${sourceName}')\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortName}</span>\n            <span class=\"msd-hud-metric-value\">${sourceData.subscribers} subs</span>\n          </div>\n          <div style=\"font-size:10px;color:#888;margin-top:2px;\">\n            ${sourceData.received} updates • ${sourceData.cacheHits} cached\n            ${hasErrors ? ` • ${sourceData.errors} errors` : ''}\n          </div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Recent state changes\n    if (recentChanges && recentChanges.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Recent Changes</h4>';\n      recentChanges.slice(-5).forEach(change => {\n        const shortId = change.id.length > 20 ? change.id.substring(0, 17) + '...' : change.id;\n        const timeAgo = Math.round((Date.now() - change.timestamp) / 1000);\n\n        html += `<div class=\"msd-hud-metric\" style=\"cursor:pointer;\"\n          onclick=\"window.__msdInspectDataEntity('${change.id}')\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span style=\"font-size:10px;color:#888;\">${timeAgo}s ago</span>\n          </div>\n          <div class=\"msd-hud-metric-value\" style=\"font-size:10px;color:#ccc;margin-top:1px;\">\n            ${change.from} → ${change.to}\n          </div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Entity samples by domain\n    const entities_entries = Object.entries(entities || {});\n    if (entities_entries.length > 0) {\n      // Group by domain\n      const byDomain = {};\n      entities_entries.forEach(([id, entity]) => {\n        const domain = entity.domain || 'unknown';\n        if (!byDomain[domain]) byDomain[domain] = [];\n        byDomain[domain].push([id, entity]);\n      });\n\n      html += '<div class=\"msd-hud-section\"><h4>Entity Samples</h4>';\n      Object.entries(byDomain).slice(0, 4).forEach(([domain, domainEntities]) => {\n        html += `<div style=\"margin-bottom:6px;\">\n          <div style=\"font-weight:bold;font-size:11px;color:#ffaa00;\">${domain} (${domainEntities.length})</div>`;\n\n        domainEntities.slice(0, 3).forEach(([id, entity]) => {\n          const shortId = id.length > 20 ? id.substring(0, 17) + '...' : id;\n          const stateValue = entity.state || 'N/A';\n          const shortState = stateValue.length > 12 ? stateValue.substring(0, 9) + '...' : stateValue;\n\n          html += `<div class=\"msd-hud-metric\" style=\"cursor:pointer;margin-left:10px;\"\n            onclick=\"window.__msdInspectDataEntity('${id}')\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span class=\"msd-hud-metric-value\">${shortState}</span>\n          </div>`;\n        });\n\n        html += '</div>';\n      });\n      html += '</div>';\n    } else if (stats.count > 0) {\n      html += '<div class=\"msd-hud-section\">Entities available but no recent data</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No entity data available</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n}\n\n","/**\n * Enhanced Routing diagnostics panel for MSD HUD\n * Displays routing statistics and path computation data with filtering and analysis\n */\n\nexport class RoutingPanel {\n  constructor() {\n    this.filters = {\n      strategy: 'all',\n      minCost: 0,\n      maxCost: 1500, // FIXED: Increased from 1000 to 1500\n      cacheHit: 'all',\n      showArcs: false\n    };\n\n    // FIXED: Track input focus to prevent refresh interference\n    this.inputStates = {\n      minCostFocused: false,\n      maxCostFocused: false\n    };\n\n    // ADDED: Set up global helper function for route analysis\n    this._setupGlobalHelpers();\n  }\n\n  // ADDED: Setup global helper functions\n  _setupGlobalHelpers() {\n    // Global route analysis function that includes both console and popup\n    window.__msdAnalyzeRoute = (routeId) => {\n      console.log('[RoutingPanel] Global analyze for:', routeId);\n\n      const routing = window.__msdDebug?.routing;\n      if (!routing?.inspect) {\n        console.warn('[RoutingPanel] No routing inspector available');\n        return;\n      }\n\n      const analysis = routing.inspect(routeId);\n\n      // Console logging (same as before)\n      console.group(`🔍 Route Analysis: ${routeId}`);\n\n      if (analysis.meta) {\n        console.table({\n          Strategy: analysis.meta.strategy || 'unknown',\n          Cost: analysis.meta.cost || 0,\n          Segments: analysis.meta.segments || 0,\n          Bends: analysis.meta.bends || 0,\n          'Cache Hit': analysis.meta.cache_hit ? '✅ Yes' : '❌ No'\n        });\n      }\n\n      if (analysis.pts && analysis.pts.length > 0) {\n        console.log('📍 Path Points:', analysis.pts.length, 'points');\n        console.table(analysis.pts.map((pt, i) => ({\n          Index: i,\n          X: pt[0],\n          Y: pt[1],\n          Type: i === 0 ? 'Start' : i === analysis.pts.length - 1 ? 'End' : 'Waypoint'\n        })));\n      }\n\n      if (analysis.meta?.hint) {\n        console.log('💡 Routing Hints:');\n        console.table(analysis.meta.hint);\n      }\n\n      if (analysis.d) {\n        const pathData = analysis.d.length > 100 ? analysis.d.substring(0, 97) + '...' : analysis.d;\n        console.log('🎨 SVG Path:', pathData);\n      }\n\n      console.log('📋 Full Analysis Object:', analysis);\n      console.groupEnd();\n\n      // Show popup (same as showRouteAnalysisFeedback)\n      this._showRouteAnalysisPopup(routeId, analysis);\n    };\n  }\n\n  // ADDED: Show route analysis popup (extracted from showRouteAnalysisFeedback)\n  _showRouteAnalysisPopup(routeId, analysis) {\n    // Remove any existing popup\n    const existing = document.getElementById('msd-route-analysis-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-route-analysis-popup';\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #00ffff;\n      padding: 20px;\n      border: 2px solid #00ffff;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 600px;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 4px 20px rgba(0, 255, 255, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 16px;color:#ffaa00;\">🔍 Route Analysis: ${routeId}</h3>`;\n\n    // Basic routing information\n    if (analysis.meta) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\">📊 Routing Metrics</h4>\n          <div style=\"display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px;\">\n            <div><strong>Strategy:</strong> ${analysis.meta.strategy || 'unknown'}</div>\n            <div><strong>Cost:</strong> <span style=\"color:#ffcc88;\">${analysis.meta.cost || 0}</span></div>\n            <div><strong>Segments:</strong> ${analysis.meta.segments || 0}</div>\n            <div><strong>Bends:</strong> <span style=\"color:#ff99cc;\">${analysis.meta.bends || 0}</span></div>\n            <div><strong>Cache Hit:</strong> ${analysis.meta.cache_hit ? '<span style=\"color:#66ff99;\">✅ Yes</span>' : '<span style=\"color:#ff6666;\">❌ No</span>'}</div>\n            <div><strong>Smooth:</strong> ${analysis.meta.smooth ? '✅ Yes' : '❌ No'}</div>\n          </div>\n        </div>\n      `;\n    }\n\n    // Path points detail\n    if (analysis.pts && analysis.pts.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\">📍 Path Points (${analysis.pts.length} total)</h4>\n          <div style=\"font-size:10px;margin-bottom:8px;\">\n            <strong>Start:</strong> (${analysis.pts[0][0]}, ${analysis.pts[0][1]})<br>\n            <strong>End:</strong> (${analysis.pts[analysis.pts.length-1][0]}, ${analysis.pts[analysis.pts.length-1][1]})\n          </div>\n      `;\n\n      // Show all points if not too many, otherwise show first few and last few\n      if (analysis.pts.length <= 8) {\n        content += `<div style=\"font-size:10px;color:#ccc;\">`;\n        analysis.pts.forEach((pt, i) => {\n          const type = i === 0 ? 'Start' : i === analysis.pts.length - 1 ? 'End' : 'Waypoint';\n          content += `<div>${i}: (${pt[0]}, ${pt[1]}) - ${type}</div>`;\n        });\n        content += `</div>`;\n      } else {\n        content += `<div style=\"font-size:10px;color:#ccc;\">`;\n        // Show first 3 points\n        for (let i = 0; i < 3; i++) {\n          const pt = analysis.pts[i];\n          const type = i === 0 ? 'Start' : 'Waypoint';\n          content += `<div>${i}: (${pt[0]}, ${pt[1]}) - ${type}</div>`;\n        }\n        content += `<div style=\"color:#888;\">... ${analysis.pts.length - 5} intermediate points ...</div>`;\n        // Show last 2 points\n        for (let i = analysis.pts.length - 2; i < analysis.pts.length; i++) {\n          const pt = analysis.pts[i];\n          const type = i === analysis.pts.length - 1 ? 'End' : 'Waypoint';\n          content += `<div>${i}: (${pt[0]}, ${pt[1]}) - ${type}</div>`;\n        }\n        content += `</div>`;\n      }\n      content += `</div>`;\n    }\n\n    // Routing hints\n    if (analysis.meta?.hint) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\">💡 Routing Hints</h4>\n          <div style=\"font-size:11px;color:#ccc;\">\n            <div><strong>First:</strong> ${analysis.meta.hint.first || 'n/a'}\n                 <span style=\"color:#888;\">(${analysis.meta.hint.sourceFirst || 'n/a'})</span></div>\n            <div><strong>Last:</strong> ${analysis.meta.hint.last || 'n/a'}\n                 <span style=\"color:#888;\">(${analysis.meta.hint.sourceLast || 'n/a'})</span></div>\n          </div>\n        </div>\n      `;\n    }\n\n    // SVG path data\n    if (analysis.d) {\n      const pathData = analysis.d;\n      const isLong = pathData.length > 200;\n      const displayPath = isLong ? pathData.substring(0, 197) + '...' : pathData;\n\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\">🎨 SVG Path Data</h4>\n          <div style=\"font-size:10px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;word-break:break-all;color:#ccc;font-family:monospace;\">\n            ${displayPath}\n          </div>\n          ${isLong ? '<div style=\"font-size:9px;color:#888;margin-top:4px;\">Path truncated for display</div>' : ''}\n        </div>\n      `;\n    }\n\n    // Performance metrics (if available)\n    if (analysis.meta?.compute_time_ms || analysis.meta?.cache_time_ms) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\">⚡ Performance</h4>\n          <div style=\"font-size:11px;color:#ccc;\">\n            ${analysis.meta.compute_time_ms ? `<div><strong>Compute Time:</strong> ${analysis.meta.compute_time_ms}ms</div>` : ''}\n            ${analysis.meta.cache_time_ms ? `<div><strong>Cache Time:</strong> ${analysis.meta.cache_time_ms}ms</div>` : ''}\n          </div>\n        </div>\n      `;\n    }\n\n    // Additional metadata\n    const additionalMeta = Object.keys(analysis.meta || {}).filter(key =>\n      !['strategy', 'cost', 'segments', 'bends', 'cache_hit', 'smooth', 'hint', 'compute_time_ms', 'cache_time_ms'].includes(key)\n    );\n\n    if (additionalMeta.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\">🔧 Additional Metadata</h4>\n          <div style=\"font-size:10px;color:#ccc;\">\n      `;\n      additionalMeta.forEach(key => {\n        const value = analysis.meta[key];\n        const displayValue = typeof value === 'object' ? JSON.stringify(value) : value;\n        content += `<div><strong>${key}:</strong> ${displayValue}</div>`;\n      });\n      content += `</div></div>`;\n    }\n\n    // Action buttons\n    content += `\n      <div style=\"text-align:center;margin-top:20px;border-top:1px solid #333;padding-top:16px;\">\n        <button onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(analysis)}, null, 2)); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy Analysis', 2000);\"\n          style=\"background:#552255;color:#fff;border:1px solid #aa55aa;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Copy Analysis\n        </button>\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n\n    // REMOVED: Auto-close timeout - user must click close button\n  }\n\n  // ADDED: Former global handlers as instance methods\n  setFilter(key, value) { this.filters[key] = value; }\n  updateCostFilter(type, value) {\n    const n = parseFloat(value);\n    if (!isNaN(n)) this.filters[type] = n;\n  }\n  finalizeCostFilter() {}\n  setInputFocus(field, focused) { this.inputStates[field] = focused; }\n  highlightRoute(routeId) {\n    console.log('[RoutingPanel] Highlighting route:', routeId);\n\n    try {\n      // Get the mount element from the pipeline/debug interface\n      const mountElement = window.__msdDebug?.pipelineInstance?.mountElement ||\n                          window.__msdDebug?.mountElement ||\n                          document.querySelector('cb-lcars-msd-card')?.shadowRoot ||\n                          document;\n\n      if (!mountElement) {\n        console.warn('[RoutingPanel] No mount element found for route highlighting');\n        return;\n      }\n\n      // FIXED: Simpler, smaller glow effect with better cleanup\n      const routeElements = mountElement.querySelectorAll(`g[data-overlay-id=\"${routeId}\"], path[data-overlay-id=\"${routeId}\"], #${routeId}`);\n      const overlayGroups = mountElement.querySelectorAll(`g[data-overlay-id=\"${routeId}\"]`);\n\n      // Clear any existing highlights for this route first\n      const existingHighlights = mountElement.querySelectorAll(`.msd-route-highlight-${routeId.replace(/[^a-zA-Z0-9]/g, '_')}`);\n      existingHighlights.forEach(el => {\n        el.style.filter = el.dataset.originalFilter || '';\n        el.style.outline = el.dataset.originalOutline || '';\n        el.style.removeProperty('outline-offset');\n        el.classList.remove(`msd-route-highlight-${routeId.replace(/[^a-zA-Z0-9]/g, '_')}`);\n        delete el.dataset.originalFilter;\n        delete el.dataset.originalOutline;\n      });\n\n      // Apply highlight to route containers\n      routeElements.forEach(element => {\n        const safeId = routeId.replace(/[^a-zA-Z0-9]/g, '_');\n        element.dataset.originalOutline = element.style.outline || '';\n\n        // FIXED: Much smaller, subtler glow\n        element.style.outline = '2px solid #ff00ff';\n        element.style.outlineOffset = '1px';\n        element.classList.add(`msd-route-highlight-${safeId}`);\n      });\n\n      // Apply highlight to paths within groups\n      overlayGroups.forEach(group => {\n        const paths = group.querySelectorAll('path');\n        paths.forEach(path => {\n          const safeId = routeId.replace(/[^a-zA-Z0-9]/g, '_');\n          path.dataset.originalFilter = path.style.filter || '';\n\n          // FIXED: Single, subtle glow instead of multiple layers\n          path.style.filter = `drop-shadow(0 0 4px #ff00ff) ${path.dataset.originalFilter}`.trim();\n          path.classList.add(`msd-route-highlight-${safeId}`);\n        });\n      });\n\n      // Clean up after 3 seconds\n      setTimeout(() => {\n        const highlightedElements = mountElement.querySelectorAll(`.msd-route-highlight-${routeId.replace(/[^a-zA-Z0-9]/g, '_')}`);\n        highlightedElements.forEach(element => {\n          element.style.filter = element.dataset.originalFilter || '';\n          element.style.outline = element.dataset.originalOutline || '';\n          element.style.removeProperty('outline-offset');\n          element.classList.remove(`msd-route-highlight-${routeId.replace(/[^a-zA-Z0-9]/g, '_')}`);\n          delete element.dataset.originalFilter;\n          delete element.dataset.originalOutline;\n        });\n      }, 3000);\n\n      // Show user feedback\n      this.showRouteHighlightFeedback(routeId);\n\n    } catch (e) {\n      console.warn('[RoutingPanel] Route highlighting failed:', e);\n    }\n\n    // Emit routing focus event for other panels\n    if (window.__msdDebug?.hud?.emit) {\n      window.__msdDebug.hud.emit('routing:focus', { id: routeId });\n    }\n  }  analyzeRoute(routeId) {\n    console.log('[RoutingPanel] analyzeRoute called with:', routeId);\n\n    if (!routeId) {\n      console.warn('[RoutingPanel] No route ID provided for analysis');\n      return;\n    }\n\n    const routing = window.__msdDebug?.routing;\n    if (routing?.inspect) {\n      const analysis = routing.inspect(routeId);\n\n      // FIXED: Enhanced route analysis display\n      console.group(`🔍 Route Analysis: ${routeId}`);\n\n      // Basic info table\n      if (analysis.meta) {\n        console.table({\n          Strategy: analysis.meta.strategy || 'unknown',\n          Cost: analysis.meta.cost || 0,\n          Segments: analysis.meta.segments || 0,\n          Bends: analysis.meta.bends || 0,\n          'Cache Hit': analysis.meta.cache_hit ? '✅ Yes' : '❌ No'\n        });\n      }\n\n      // Path details\n      if (analysis.pts && analysis.pts.length > 0) {\n        console.log('📍 Path Points:', analysis.pts.length, 'points');\n        console.table(analysis.pts.map((pt, i) => ({\n          Index: i,\n          X: pt[0],\n          Y: pt[1],\n          Type: i === 0 ? 'Start' : i === analysis.pts.length - 1 ? 'End' : 'Waypoint'\n        })));\n      }\n\n      // Hint information\n      if (analysis.meta?.hint) {\n        console.log('💡 Routing Hints:');\n        console.table(analysis.meta.hint);\n      }\n\n      // SVG path data (truncated if long)\n      if (analysis.d) {\n        const pathData = analysis.d.length > 100 ? analysis.d.substring(0, 97) + '...' : analysis.d;\n        console.log('🎨 SVG Path:', pathData);\n      }\n\n      // Raw object for developers who need it\n      console.log('📋 Full Analysis Object:', analysis);\n      console.groupEnd();\n\n      // FIXED: Also show visual feedback in HUD\n      this.showRouteAnalysisFeedback(routeId, analysis);\n    } else {\n      console.warn('[RoutingPanel] No routing inspector available');\n    }\n  }\n\n  // FIXED: Add visual feedback method\n  showRouteHighlightFeedback(routeId) {\n    // Create temporary feedback element\n    const feedback = document.createElement('div');\n    feedback.style.cssText = `\n      position: fixed;\n      top: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: rgba(255, 0, 255, 0.9);\n      color: white;\n      padding: 8px 16px;\n      border-radius: 4px;\n      font-size: 12px;\n      z-index: 1000001;\n      pointer-events: none;\n    `;\n    feedback.textContent = `Highlighting route: ${routeId}`;\n    document.body.appendChild(feedback);\n\n    setTimeout(() => {\n      feedback.remove();\n    }, 2000);\n  }\n\n  // FIXED: Add route analysis feedback method\n  showRouteAnalysisFeedback(routeId, analysis) {\n    // Create analysis popup\n    const popup = document.createElement('div');\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #00ffff;\n      padding: 16px;\n      border: 2px solid #00ffff;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 400px;\n      box-shadow: 0 4px 20px rgba(0, 255, 255, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 12px;color:#ffaa00;\">Route Analysis: ${routeId}</h3>`;\n\n    if (analysis.meta) {\n      content += `\n        <div style=\"margin-bottom:12px;\">\n          <div><strong>Strategy:</strong> ${analysis.meta.strategy || 'unknown'}</div>\n          <div><strong>Cost:</strong> ${analysis.meta.cost || 0}</div>\n          <div><strong>Segments:</strong> ${analysis.meta.segments || 0}</div>\n          <div><strong>Bends:</strong> ${analysis.meta.bends || 0}</div>\n          <div><strong>Cache Hit:</strong> ${analysis.meta.cache_hit ? '✅ Yes' : '❌ No'}</div>\n        </div>\n      `;\n    }\n\n    if (analysis.pts && analysis.pts.length > 0) {\n      content += `\n        <div style=\"margin-bottom:12px;\">\n          <strong>Path:</strong> ${analysis.pts.length} points<br>\n          <div style=\"font-size:10px;margin-top:4px;\">\n            Start: (${analysis.pts[0][0]}, ${analysis.pts[0][1]})<br>\n            End: (${analysis.pts[analysis.pts.length-1][0]}, ${analysis.pts[analysis.pts.length-1][1]})\n          </div>\n        </div>\n      `;\n    }\n\n    if (analysis.meta?.hint) {\n      content += `\n        <div style=\"margin-bottom:12px;\">\n          <strong>Hints:</strong><br>\n          <div style=\"font-size:10px;margin-top:4px;\">\n            First: ${analysis.meta.hint.first || 'n/a'} (${analysis.meta.hint.sourceFirst || 'n/a'})<br>\n            Last: ${analysis.meta.hint.last || 'n/a'} (${analysis.meta.hint.sourceLast || 'n/a'})\n          </div>\n        </div>\n      `;\n    }\n\n    content += `\n      <div style=\"text-align:center;margin-top:12px;\">\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:4px 12px;border-radius:4px;cursor:pointer;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n\n    // Auto-close after 10 seconds\n    setTimeout(() => {\n      if (popup.parentElement) {\n        popup.remove();\n      }\n    }, 25000);\n  }\n\n  captureData() {\n    const stats = {};\n    const routes = {};\n    const performance = {};\n\n    try {\n      const routing = window.__msdDebug?.routing;\n      if (routing) {\n        // Get routing statistics\n        const routingStats = routing.stats?.() || {};\n        Object.assign(stats, routingStats);\n\n        // Add performance metrics\n        if (routing.getPerformanceMetrics) {\n          performance.metrics = routing.getPerformanceMetrics();\n        }\n\n        // Get route inspections for line overlays\n        const pipeline = window.__msdDebug?.pipelineInstance;\n        if (pipeline) {\n          const model = pipeline.getResolvedModel?.();\n          if (model?.overlays) {\n            const lineOverlays = model.overlays\n              .filter(o => o.type === 'line' && o.anchor && o.attach_to)\n              .slice(0, 15); // More routes for filtering\n\n            lineOverlays.forEach(overlay => {\n              try {\n                const routeInfo = routing.inspect?.(overlay.id);\n                if (routeInfo && routeInfo.pts) {\n                  routes[overlay.id] = {\n                    id: overlay.id,\n                    strategy: routeInfo.meta?.strategy || 'auto',\n                    pathLength: routeInfo.pts?.length || 0,\n                    segments: routeInfo.meta?.segments || 0,\n                    bends: routeInfo.meta?.bends || 0,\n                    cost: routeInfo.meta?.cost || 0,\n                    cached: routeInfo.meta?.cache_hit || false,\n                    success: routeInfo.pts && routeInfo.pts.length > 0,\n                    arcCount: routeInfo.meta?.arc?.count || 0,\n                    // Enhanced data\n                    startAnchor: overlay.anchor,\n                    endAnchor: overlay.attach_to,\n                    smooth: routeInfo.meta?.smooth || false,\n                    channel: routeInfo.meta?.channel,\n                    computeTime: routeInfo.meta?.compute_time_ms || 0\n                  };\n                } else {\n                  routes[overlay.id] = {\n                    id: overlay.id,\n                    strategy: 'unknown',\n                    pathLength: 0,\n                    segments: 0,\n                    bends: 0,\n                    cost: 0,\n                    cached: false,\n                    success: false,\n                    arcCount: 0,\n                    startAnchor: overlay.anchor,\n                    endAnchor: overlay.attach_to,\n                    smooth: false,\n                    channel: null,\n                    computeTime: 0\n                  };\n                }\n              } catch (e) {\n                console.warn(`[RoutingPanel] Route inspection failed for ${overlay.id}:`, e);\n              }\n            });\n          }\n        }\n      }\n    } catch (e) {\n      console.warn('[RoutingPanel] Data capture failed:', e);\n    }\n\n    return { stats, routes, performance };\n  }\n\n  filterRoutes(routes) {\n    return Object.values(routes).filter(route => {\n      // Strategy filter\n      if (this.filters.strategy !== 'all' && route.strategy !== this.filters.strategy) {\n        return false;\n      }\n\n      // Cost range filter\n      if (route.cost < this.filters.minCost || route.cost > this.filters.maxCost) {\n        return false;\n      }\n\n      // Cache hit filter\n      if (this.filters.cacheHit === 'hit' && !route.cached) return false;\n      if (this.filters.cacheHit === 'miss' && route.cached) return false;\n\n      // Arc filter\n      if (this.filters.showArcs && route.arcCount === 0) return false;\n\n      return true;\n    });\n  }\n\n  renderHtml(routingData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Enhanced Routing</h3>';\n\n    // FIXED: Add CSS for route highlighting\n    html += `<style>\n      .msd-route-highlighted {\n        outline: 3px solid #ff00ff !important;\n        background: rgba(255, 0, 255, 0.1) !important;\n        box-shadow: 0 0 10px #ff00ff !important;\n      }\n    </style>`;\n\n    // Filters section\n    html += '<div class=\"msd-hud-section\"><h4>Filters</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;margin-bottom:6px;\">';\n\n    // Strategy filter\n    const strategies = ['all', 'auto', 'manhattan', 'smooth', 'direct'];\n    html += '<select id=\"hud-routing-strategy\" name=\"hud-routing-strategy\" data-bus-event=\"routing:set-filter\" data-key=\"strategy\" onchange=\"__msdHudBus(\\'routing:set-filter\\', {key:\\'strategy\\', value:this.value})\" style=\"font-size:10px;\">';\n    strategies.forEach(strategy => {\n      const selected = this.filters.strategy === strategy ? 'selected' : '';\n      html += `<option value=\"${strategy}\" ${selected}>${strategy}</option>`;\n    });\n    html += '</select>';\n\n    // FIXED: Cost range with better input handling\n    html += `<input type=\"number\" id=\"hud-routing-min-cost\" name=\"hud-routing-min-cost\"\n      data-bus-event=\"routing:update-cost\" data-key=\"minCost\"\n      onfocus=\"__msdHudBus('routing:focus-set',{field:'minCostFocused',focus:true})\"\n      onblur=\"__msdHudBus('routing:focus-set',{field:'minCostFocused',focus:false});__msdHudBus('routing:finalize-cost')\"\n      oninput=\"__msdHudBus('routing:update-cost',{key:'minCost',value:this.value})\"\n      placeholder=\"Min cost\" value=\"${this.filters.minCost}\" style=\"width:60px;font-size:10px;\">`;\n\n    html += `<input type=\"number\" id=\"hud-routing-max-cost\" name=\"hud-routing-max-cost\"\n      data-bus-event=\"routing:update-cost\" data-key=\"maxCost\"\n      onfocus=\"__msdHudBus('routing:focus-set',{field:'maxCostFocused',focus:true})\"\n      onblur=\"__msdHudBus('routing:focus-set',{field:'maxCostFocused',focus:false});__msdHudBus('routing:finalize-cost')\"\n      oninput=\"__msdHudBus('routing:update-cost',{key:'maxCost',value:this.value})\"\n      placeholder=\"Max cost\" value=\"${this.filters.maxCost}\" style=\"width:60px;font-size:10px;\">`;\n\n    // Cache filter\n    html += '<select id=\"hud-routing-cachehit\" name=\"hud-routing-cachehit\" data-bus-event=\"routing:set-filter\" data-key=\"cacheHit\" onchange=\"__msdHudBus(\\'routing:set-filter\\', {key:\\'cacheHit\\', value:this.value})\" style=\"font-size:10px;\">';\n    ['all', 'hit', 'miss'].forEach(cache => {\n      const selected = this.filters.cacheHit === cache ? 'selected' : '';\n      html += `<option value=\"${cache}\" ${selected}>Cache: ${cache}</option>`;\n    });\n    html += '</select>';\n\n    html += '</div></div>';\n\n    // Statistics section\n    const stats = routingData.stats || {};\n    if (Object.keys(stats).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Cache Statistics</h4>';\n\n      Object.entries(stats).forEach(([key, value]) => {\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">${key}</span>\n          <span class=\"msd-hud-metric-value\">${value}</span>\n        </div>`;\n      });\n\n      html += '</div>';\n    }\n\n    // Performance section\n    const performance = routingData.performance || {};\n    if (performance.metrics) {\n      html += '<div class=\"msd-hud-section\"><h4>Performance</h4>';\n\n      Object.entries(performance.metrics).forEach(([key, value]) => {\n        const displayValue = typeof value === 'number' ? value.toFixed(2) : value;\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">${key}</span>\n          <span class=\"msd-hud-metric-value\">${displayValue}</span>\n        </div>`;\n      });\n\n      html += '</div>';\n    }\n\n    // Filtered routes section\n    const allRoutes = routingData.routes || {};\n    const filteredRoutes = this.filterRoutes(allRoutes);\n\n    if (filteredRoutes.length > 0) {\n      html += `<div class=\"msd-hud-section\"><h4>Routes (${filteredRoutes.length}/${Object.keys(allRoutes).length})</h4>`;\n\n      // Sort by cost descending\n      filteredRoutes.sort((a, b) => b.cost - a.cost);\n\n      filteredRoutes.slice(0, 8).forEach(route => {\n        const shortId = route.id.length > 15 ? route.id.substring(0, 12) + '...' : route.id;\n        const statusClass = route.success ? 'msd-hud-success' : 'msd-hud-error';\n        const costColor = route.cost > 50 ? '#ff6666' : route.cost > 20 ? '#ffaa00' : '#66ff99';\n\n        // FIXED: Update data attribute for easier highlighting\n        html += `<div class=\"msd-hud-metric\"\n          data-overlay-id=\"${route.id}\"\n          data-select-type=\"route\"\n          data-select-id=\"${route.id}\"\n          style=\"cursor:pointer;border:1px solid #333;padding:4px;margin:2px 0;border-radius:3px;transition:all 0.3s;\"\n          onclick=\"__msdHudBus('select:set',{type:'route',id:'${route.id}',source:'routing'});__msdHudBus('routing:highlight',{id:'${route.id}'})\"\n          onmouseover=\"this.style.background='rgba(255,0,255,0.1)'\"\n          onmouseout=\"this.style.background=''\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span class=\"msd-hud-metric-value\" style=\"color:${costColor};\">${route.cost.toFixed(1)}</span>\n          </div>\n          <div style=\"font-size:11px;color:#aaa;margin-top:3px;line-height:1.3;\">\n            <span style=\"color:#88ccff;\">${route.strategy}</span> •\n            <span style=\"color:#99dd99;\" title=\"Path points\">${route.pathLength} pts</span> •\n            <span style=\"color:#ffcc88;\" title=\"Direction changes\">${route.bends} turns</span>\n            ${route.cached ? ' • <span style=\"color:#66ddff;\" title=\"Cached result\">� cached</span>' : ''}\n            ${route.arcCount > 0 ? ` • <span style=\"color:#ff99cc;\" title=\"Arc segments\">${route.arcCount} arcs</span>` : ''}\n          </div>\n        </div>`;\n\n        // Add analysis button - Simplified approach with global helper\n        html += `<div style=\"text-align:right;margin-top:2px;\">\n          <button\n            onclick=\"event.stopPropagation();window.__msdAnalyzeRoute('${route.id}');\"\n            style=\"font-size:9px;padding:1px 4px;background:#333;color:#ccc;border:1px solid #555;border-radius:2px;cursor:pointer;\">\n            Analyze\n          </button>\n        </div>`;\n      });\n\n      if (filteredRoutes.length > 8) {\n        html += `<div style=\"font-size:10px;text-align:center;color:#666;margin-top:4px;\">\n          ... ${filteredRoutes.length - 8} more routes\n        </div>`;\n      }\n\n      html += '</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No routes match current filters</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n\n  // FIXED: Add method to check if inputs are focused (prevents refresh interference)\n  shouldSkipRefresh() {\n    return this.inputStates.minCostFocused || this.inputStates.maxCostFocused;\n  }\n}\n","/**\n * Advanced Channel Trend Panel for MSD HUD\n * Historical channel usage analysis with conflict detection\n */\n\nexport class ChannelTrendPanel {\n  constructor() {\n    this.history = new Map(); // channelId -> array of usage counts\n    this.maxHistoryLength = 30;\n    this.conflictThreshold = 3; // channels with >3 simultaneous routes\n    this.lastSnapshot = null;\n  }\n\n  captureData() {\n    const routing = window.__msdDebug?.routing;\n    const current = routing?.channels?._occupancy || {};\n    const conflicts = [];\n    const trends = {};\n    const recommendations = [];\n\n    try {\n      // Update history\n      Object.entries(current).forEach(([channelId, count]) => {\n        if (!this.history.has(channelId)) {\n          this.history.set(channelId, []);\n        }\n\n        const channelHistory = this.history.get(channelId);\n        channelHistory.push(count);\n\n        // Trim history\n        if (channelHistory.length > this.maxHistoryLength) {\n          channelHistory.shift();\n        }\n      });\n\n      // Detect conflicts (channels with high usage)\n      Object.entries(current).forEach(([channelId, count]) => {\n        if (count >= this.conflictThreshold) {\n          conflicts.push({\n            channel: channelId,\n            count: count,\n            severity: count >= 5 ? 'high' : 'medium'\n          });\n        }\n      });\n\n      // Calculate trends\n      this.history.forEach((history, channelId) => {\n        if (history.length >= 3) {\n          const recent = history.slice(-3);\n          const avg = recent.reduce((sum, val) => sum + val, 0) / recent.length;\n          const trend = recent[recent.length - 1] - recent[0];\n\n          trends[channelId] = {\n            current: recent[recent.length - 1],\n            average: avg,\n            trend: trend, // positive = increasing usage\n            variance: this.calculateVariance(recent),\n            history: [...history] // copy for rendering\n          };\n        }\n      });\n\n      // Generate optimization recommendations\n      if (conflicts.length > 0) {\n        recommendations.push({\n          type: 'conflict',\n          message: `${conflicts.length} channel conflicts detected`,\n          action: 'Consider adjusting routing strategy'\n        });\n      }\n\n      const highVarianceChannels = Object.entries(trends)\n        .filter(([_, data]) => data.variance > 2)\n        .length;\n\n      if (highVarianceChannels > 0) {\n        recommendations.push({\n          type: 'variance',\n          message: `${highVarianceChannels} channels show high variance`,\n          action: 'Review routing stability'\n        });\n      }\n\n      // Check for unused optimization\n      const totalChannels = this.history.size;\n      const activeChannels = Object.keys(current).length;\n      const unusedChannels = totalChannels - activeChannels;\n\n      if (unusedChannels > 5) {\n        recommendations.push({\n          type: 'optimization',\n          message: `${unusedChannels} channels currently unused`,\n          action: 'Potential for route optimization'\n        });\n      }\n\n    } catch (e) {\n      console.warn('[ChannelTrendPanel] Data capture failed:', e);\n    }\n\n    return { current, conflicts, trends, recommendations };\n  }\n\n  calculateVariance(values) {\n    if (values.length === 0) return 0;\n    const mean = values.reduce((sum, val) => sum + val, 0) / values.length;\n    const squaredDiffs = values.map(val => Math.pow(val - mean, 2));\n    return squaredDiffs.reduce((sum, val) => sum + val, 0) / values.length;\n  }\n\n  renderSparkline(history, maxValue = null) {\n    if (!history || history.length === 0) return '';\n\n    const max = maxValue || Math.max(...history, 1);\n    const width = 40;\n    const chars = ' ▁▂▃▄▅▆▇█';\n\n    let sparkline = '';\n    const step = Math.max(1, Math.floor(history.length / width));\n\n    for (let i = 0; i < history.length; i += step) {\n      const value = history[i];\n      const ratio = value / max;\n      const level = Math.min(chars.length - 1, Math.floor(ratio * (chars.length - 1)));\n      sparkline += chars[level];\n    }\n\n    return sparkline;\n  }\n\n  renderHtml(channelData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Channel Trends</h3>';\n\n    const { current, conflicts, trends, recommendations } = channelData;\n\n    // Conflicts section\n    if (conflicts && conflicts.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-warning\"><h4>Conflicts Detected</h4>';\n      conflicts.forEach(conflict => {\n        const severityColor = conflict.severity === 'high' ? '#ff4444' : '#ffaa00';\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\" style=\"color:${severityColor};\">${conflict.channel}</span>\n          <span class=\"msd-hud-metric-value\">${conflict.count} routes</span>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Recommendations section\n    if (recommendations && recommendations.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Recommendations</h4>';\n      recommendations.forEach(rec => {\n        const typeColor = rec.type === 'conflict' ? '#ff6666' :\n                         rec.type === 'variance' ? '#ffaa00' : '#66ff99';\n        html += `<div class=\"msd-hud-metric\">\n          <div style=\"color:${typeColor};font-size:10px;\">${rec.message}</div>\n          <div style=\"color:#888;font-size:9px;\">${rec.action}</div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Trends section with sparklines\n    if (trends && Object.keys(trends).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Usage Trends</h4>';\n\n      // Sort by current usage\n      const sortedTrends = Object.entries(trends)\n        .sort(([,a], [,b]) => b.current - a.current)\n        .slice(0, 8);\n\n      sortedTrends.forEach(([channelId, data]) => {\n        const shortId = channelId.length > 15 ? channelId.substring(0, 12) + '...' : channelId;\n        const trendIndicator = data.trend > 0 ? '↗' : data.trend < 0 ? '↘' : '→';\n        const trendColor = data.trend > 0 ? '#ff6666' : data.trend < 0 ? '#66ff99' : '#888';\n        const sparkline = this.renderSparkline(data.history);\n\n        html += `<div class=\"msd-hud-metric\" style=\"margin:4px 0;\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span class=\"msd-hud-metric-value\">${data.current}</span>\n          </div>\n          <div style=\"display:flex;justify-content:space-between;font-size:10px;margin-top:2px;\">\n            <span style=\"font-family:monospace;color:#888;\">${sparkline}</span>\n            <span style=\"color:${trendColor};\">${trendIndicator} ${data.average.toFixed(1)}</span>\n          </div>\n        </div>`;\n      });\n\n      html += '</div>';\n    }\n\n    // Current status summary\n    const currentCount = Object.keys(current || {}).length;\n    const totalUsage = Object.values(current || {}).reduce((sum, count) => sum + count, 0);\n    const historySize = this.history.size;\n\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${currentCount} active channels • ${totalUsage} total routes • ${historySize} tracked\n    </div>`;\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Flags Panel for MSD HUD\n * Runtime debug feature management using actual MSD debug interface\n * Based on __msdDebug.debug.enable/disable API\n */\n\nexport class FlagsPanel {\n  constructor() {\n    // Actual MSD debug features\n    this.debugFeatures = [\n      'anchors', 'bounding_boxes', 'routing', 'performance'\n    ];\n  }\n\n  toggleFeature(feature) {\n    console.log('[FlagsPanel] toggleFeature called:', feature);\n\n    if (!window.__msdDebug?.debug) {\n      console.warn('[FlagsPanel] Debug interface not available');\n      return;\n    }\n\n    // FIXED: Use silent status access instead of status() which dumps to console\n    const debugManager = window.__msdDebug?.debugManager ||\n                         window.__msdDebug?.pipelineInstance?.systemsManager?.debugManager;\n\n    if (!debugManager) {\n      console.warn('[FlagsPanel] DebugManager not available');\n      return;\n    }\n\n    const currentStatus = debugManager.getSnapshot();\n    const currentlyEnabled = currentStatus[feature];\n\n    if (currentlyEnabled) {\n      window.__msdDebug.debug.disable(feature);\n    } else {\n      window.__msdDebug.debug.enable(feature);\n    }\n\n    // FIXED: Force immediate re-render after state change\n    setTimeout(() => {\n      try {\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (pipelineInstance?.reRender) {\n          console.log('[FlagsPanel] Triggering re-render after', feature, currentlyEnabled ? 'disable' : 'enable');\n          pipelineInstance.reRender();\n        } else {\n          console.warn('[FlagsPanel] No reRender method available on pipeline instance');\n        }\n      } catch (error) {\n        console.warn('[FlagsPanel] Failed to trigger re-render:', error);\n      }\n    }, 50);\n\n    // Refresh HUD after a delay to show updated state\n    setTimeout(() => {\n      if (window.__msdDebug?.hud?.refresh) {\n        window.__msdDebug.hud.refresh();\n      }\n    }, 100);\n  }\n\n  adjustScale(direction) {\n    if (!window.__msdDebug?.debug?.status) return;\n    const currentScale = window.__msdDebug.debug.status().scale || 1.0;\n    const step = 0.1;\n    const newScale = direction > 0 ? currentScale + step : currentScale - step;\n    const clampedScale = Math.max(0.5, Math.min(3.0, newScale));\n\n    if (window.__msdDebug.debug.setScale) {\n      window.__msdDebug.debug.setScale(clampedScale);\n    }\n  }\n\n  setScale(scale) {\n    const numScale = parseFloat(scale);\n    if (isNaN(numScale)) return;\n    const clampedScale = Math.max(0.5, Math.min(3.0, numScale));\n\n    if (window.__msdDebug?.debug?.setScale) {\n      window.__msdDebug.debug.setScale(clampedScale);\n    }\n  }\n\n  refreshDebug() {\n    window.__msdDebug?.debug?.refresh?.();\n  }\n\n  captureData() {\n    const flags = {};\n    const debugFeatures = {};\n\n    try {\n      // FIXED: Use centralized silent debug status access\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n\n      // FIXED: Properly capture debug features and readiness\n      Object.assign(debugFeatures, debugStatus);\n\n      // Get current debug flags (legacy support)\n      Object.assign(flags, window.__msdDebug?._debugFlags || {});\n    } catch (e) {\n      console.warn('[FlagsPanel] Data capture failed:', e);\n    }\n\n    return { flags, debugFeatures };\n  }\n\n  renderHtml(flagsData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Debug Features</h3>';\n\n    // FIXED: Use debugFeatures instead of separate features object\n    const debugFeatures = flagsData.debugFeatures || {};\n    const scale = debugFeatures.scale || 1.0;\n    const debugReady = debugFeatures.initialized || false;\n\n    // Debug status\n    if (!debugReady) {\n      html += '<div class=\"msd-hud-section msd-hud-warning\"><h4>Status</h4>';\n      html += '<div>Debug interface not ready</div></div>';\n    } else {\n      html += '<div class=\"msd-hud-section\"><h4>Status</h4>';\n      html += `<div>Debug ready • Scale: ${scale.toFixed(1)}x</div></div>`;\n    }\n\n    // Individual features section\n    html += '<div class=\"msd-hud-section\"><h4>Debug Features</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;margin-bottom:6px;\">';\n\n    this.debugFeatures.forEach(feature => {\n      // FIXED: Check debugFeatures instead of features\n      const isEnabled = Boolean(debugFeatures[feature]);\n      const displayName = feature.replace('_', ' ');\n      html += `<button data-bus-event=\"flags:toggle\" onclick=\"__msdHudBus('flags:toggle',{feature:'${feature}'})\"\n        style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n        background:${isEnabled ? '#ff00ff' : '#333'};color:${isEnabled ? '#000' : '#eee'};\">\n        ${displayName}\n      </button>`;\n    });\n\n    html += '</div></div>';\n\n    // Scale control\n    html += '<div class=\"msd-hud-section\"><h4>Scale Control</h4>';\n    html += '<div style=\"display:flex;gap:4px;align-items:center;margin-bottom:6px;\">';\n\n    // +/- buttons and input\n    html += `<button data-bus-event=\"flags:scale-adjust\" onclick=\"__msdHudBus('flags:scale-adjust',{dir:-1})\" style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n      background:#333;color:#eee;\">-</button>`;\n\n    html += `<input type=\"number\" id=\"hud-flags-scale\" name=\"hud-flags-scale\"\n      value=\"${scale.toFixed(1)}\" min=\"0.5\" max=\"3.0\" step=\"0.1\" data-bus-event=\"flags:scale-set\"\n      onchange=\"__msdHudBus('flags:scale-set',{scale:this.value})\"\n      style=\"width:60px;font-size:10px;padding:2px 4px;border:1px solid #444;border-radius:3px;\n      background:#222;color:#eee;text-align:center;\">`;\n\n    html += `<button data-bus-event=\"flags:scale-adjust\" onclick=\"__msdHudBus('flags:scale-adjust',{dir:1})\" style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n      background:#333;color:#eee;\">+</button>`;\n\n    html += '</div>';\n\n    // Preset scale buttons\n    html += '<div style=\"display:flex;gap:4px;align-items:center;\">';\n    [0.8, 1.0, 1.2, 1.5, 2.0].forEach(scaleValue => {\n      const isActive = Math.abs(scale - scaleValue) < 0.05;\n      html += `<button data-bus-event=\"flags:scale-set\"\n        onclick=\"__msdHudBus('flags:scale-set',{scale:${scaleValue}})\"\n        style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n        background:${isActive ? '#ffaa00' : '#333'};color:${isActive ? '#000' : '#eee'};\">\n        ${scaleValue}x\n      </button>`;\n    });\n\n    html += `<button data-bus-event=\"flags:refresh\" onclick=\"__msdHudBus('flags:refresh')\" style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n      background:#333;color:#eee;margin-left:8px;\">\n      Refresh\n    </button>`;\n    html += '</div></div>';\n\n    // Status section\n    // FIXED: Use debugFeatures to count enabled features\n    const enabledCount = this.debugFeatures.filter(feature => debugFeatures[feature]).length;\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${enabledCount}/${this.debugFeatures.length} features enabled\n    </div>`;\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Enhanced Issues Panel for MSD HUD\n * Unified issue aggregation with smart routing to editors/actions\n * Based on legacy HUD issues panel functionality\n */\n\nexport class IssuesPanel {\n  constructor() {\n    this.issueCategories = {\n      validation: { label: 'Validation', color: '#ff6666', icon: '⚠️' },\n      routing: { label: 'Routing', color: '#ffaa00', icon: '🔀' },\n      performance: { label: 'Performance', color: '#ff9900', icon: '⏱️' },\n      debug: { label: 'Debug', color: '#66cfff', icon: '🔧' }\n    };\n  }\n\n  handleIssueClick(action, id, overlay) {\n    console.log('[IssuesPanel] Issue clicked:', { action, id, overlay });\n\n    switch (action) {\n      case 'overlay':\n        if (overlay && window.__msdDebug?.debug) {\n          // Try to highlight the overlay\n          console.log(`[IssuesPanel] Highlighting overlay: ${overlay}`);\n          // Could integrate with overlay editor here\n        }\n        break;\n\n      case 'routing':\n        console.log('[IssuesPanel] Opening routing diagnostics');\n        // Could emit routing focus event\n        if (window.__msdDebug?.hud?.refresh) {\n          window.__msdDebug.hud.refresh();\n        }\n        break;\n\n      case 'performance':\n        console.log(`[IssuesPanel] Performance issue: ${id}`);\n        // Could open performance panel or set thresholds\n        break;\n\n      case 'debug':\n        console.log('[IssuesPanel] Debug issue clicked - attempting to initialize debug interface');\n        // Try to initialize debug interface\n        if (window.__msdDebug?.debug?.refresh) {\n          window.__msdDebug.debug.refresh();\n        }\n        break;\n\n      // ADDED: New action for enabling debug features\n      case 'enable-features':\n        console.log('[IssuesPanel] Enabling basic debug features');\n        if (window.__msdDebug?.debug) {\n          // Enable a basic set of debug features\n          window.__msdDebug.debug.enable('anchors');\n          window.__msdDebug.debug.enable('bounding_boxes');\n\n          // Show user feedback\n          const feedback = document.createElement('div');\n          feedback.style.cssText = `\n            position: fixed;\n            top: 20px;\n            left: 50%;\n            transform: translateX(-50%);\n            background: rgba(0, 255, 0, 0.9);\n            color: white;\n            padding: 8px 16px;\n            border-radius: 4px;\n            font-size: 12px;\n            z-index: 1000001;\n            pointer-events: none;\n          `;\n          feedback.textContent = 'Debug features enabled: anchors, bounding_boxes';\n          document.body.appendChild(feedback);\n\n          setTimeout(() => feedback.remove(), 3000);\n        }\n        break;\n    }\n\n    // ADDED: Selection heuristics\n    if (this.bus) {\n      if (action === 'overlay' && overlay) {\n        this.bus.emit('select:set', { type: 'overlay', id: overlay, source: 'issues' });\n      } else if (action === 'routing' && id) {\n        this.bus.emit('select:set', { type: 'route', id, source: 'issues' });\n      } else if (action === 'performance' && id) {\n        this.bus.emit('select:set', { type: 'timer', id, source: 'issues' });\n      }\n    }\n  }\n\n  captureData() {\n    const issues = {\n      validation: [],\n      routing: [],\n      performance: [],\n      debug: []\n    };\n\n    try {\n      // Validation issues\n      const validationData = window.__msdDebug?.validation?.issues?.() || {};\n      if (validationData.errors) {\n        validationData.errors.forEach(error => {\n          issues.validation.push({\n            id: error.overlay || error.anchor || 'unknown',\n            type: 'validation',\n            severity: 'error',\n            message: error.msg || error.message || 'Validation error',\n            code: error.code,\n            overlay: error.overlay,\n            anchor: error.anchor,\n            clickAction: 'overlay'\n          });\n        });\n      }\n      if (validationData.warnings) {\n        validationData.warnings.forEach(warning => {\n          issues.validation.push({\n            id: warning.overlay || warning.anchor || 'unknown',\n            type: 'validation',\n            severity: 'warning',\n            message: warning.msg || warning.message || 'Validation warning',\n            code: warning.code,\n            overlay: warning.overlay,\n            anchor: warning.anchor,\n            clickAction: 'overlay'\n          });\n        });\n      }\n\n      // Routing issues from debug features\n      // FIXED: Use centralized silent debug status access\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n      if (debugStatus.enabled) {\n        // Check for routing problems (this would need actual routing diagnostics)\n        const routing = window.__msdDebug?.routing;\n        if (routing?.stats) {\n          const stats = routing.stats();\n          if (stats.errors && stats.errors > 0) {\n            issues.routing.push({\n              id: 'routing-errors',\n              type: 'routing',\n              severity: 'error',\n              message: `${stats.errors} routing errors detected`,\n              code: 'routing_errors',\n              clickAction: 'routing'\n            });\n          }\n        }\n      }\n\n      // Performance issues from debug status\n      if (debugStatus.performance) {\n        // Could check for performance thresholds here\n        // This is a placeholder for actual performance monitoring\n        const perfData = window.__msdDebug?.getPerf?.() || {};\n        if (perfData.timers) {\n          Object.entries(perfData.timers).forEach(([key, timer]) => {\n            if (timer.avg > 50) { // Example threshold\n              issues.performance.push({\n                id: key,\n                type: 'performance',\n                severity: 'warning',\n                message: `Slow timer: ${key} (${timer.avg.toFixed(1)}ms avg)`,\n                code: 'slow_timer',\n                clickAction: 'performance'\n              });\n            }\n          });\n        }\n      }\n\n      // Debug feature issues\n      // FIXED: Better debug feature status detection\n      if (!debugStatus.initialized) {\n        // Actually not initialized\n        issues.debug.push({\n          id: 'debug-status',\n          type: 'debug',\n          severity: 'warning',\n          message: 'Debug interface not initialized',\n          code: 'debug_not_initialized',\n          clickAction: 'debug'\n        });\n      } else if (!debugStatus.enabled) {\n        // Initialized but no features enabled - this is not really an \"issue\"\n        // We could either skip this entirely or show an info message\n        issues.debug.push({\n          id: 'debug-features-disabled',\n          type: 'debug',\n          severity: 'info',\n          message: 'All debug features are disabled',\n          code: 'debug_features_off',\n          clickAction: 'enable-features'\n        });\n      }\n\n    } catch (e) {\n      console.warn('[IssuesPanel] Data capture failed:', e);\n      issues.debug.push({\n        id: 'capture-error',\n        type: 'debug',\n        severity: 'error',\n        message: `Issue capture failed: ${e.message}`,\n        code: 'capture_error',\n        clickAction: 'debug'\n      });\n    }\n\n    return issues;\n  }\n\n  renderHtml(issuesData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Issues</h3>';\n\n    // Count total issues\n    const allIssues = [];\n    Object.values(issuesData).forEach(categoryIssues => {\n      allIssues.push(...categoryIssues);\n    });\n\n    if (allIssues.length === 0) {\n      html += '<div class=\"msd-hud-section msd-hud-success\">✅ No issues detected</div>';\n      html += '</div>';\n      return html;\n    }\n\n    // Summary section\n    const errorCount = allIssues.filter(i => i.severity === 'error').length;\n    const warningCount = allIssues.filter(i => i.severity === 'warning').length;\n\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${errorCount} errors, ${warningCount} warnings • Click to fix\n    </div>`;\n\n    // Issues by category\n    Object.entries(issuesData).forEach(([categoryKey, categoryIssues]) => {\n      if (categoryIssues.length === 0) return;\n\n      const category = this.issueCategories[categoryKey];\n      html += `<div class=\"msd-hud-section\">\n        <h4 style=\"color: ${category.color};\">${category.icon} ${category.label} (${categoryIssues.length})</h4>\n      `;\n\n      categoryIssues.slice(0, 6).forEach((issue, index) => {\n        const severityColor = issue.severity === 'error' ? '#ff6666' : '#ffaa00';\n        const issueId = `issue-${categoryKey}-${index}`;\n\n        html += `<div class=\"msd-hud-metric msd-issue-row\"\n          data-bus-event=\"issues:action\"\n          data-action=\"${issue.clickAction}\"\n          data-id=\"${issue.id}\"\n          data-overlay=\"${issue.overlay || ''}\"\n          data-select-type=\"${issue.clickAction === 'overlay' ? 'overlay' : issue.clickAction === 'routing' ? 'route' : issue.clickAction === 'performance' ? 'timer' : 'issue'}\"\n          data-select-id=\"${issue.overlay || issue.id}\"\n          onclick=\"__msdHudBus('issues:action',{action:'${issue.clickAction}',id:'${issue.id}',overlay:'${issue.overlay || ''}'});__msdHudBus('select:set',{type:'${issue.clickAction === 'overlay' ? 'overlay' : issue.clickAction === 'routing' ? 'route' : issue.clickAction === 'performance' ? 'timer' : 'issue'}',id:'${issue.overlay || issue.id}',source:'issues'})\"\n          style=\"cursor:pointer; border-left:3px solid ${severityColor}; padding-left:6px; margin:2px 0;\">\n          <div style=\"display: flex; justify-content: space-between; align-items: center;\">\n            <span class=\"msd-hud-metric-name\">[${issue.code || issue.type}]</span>\n            <span style=\"color: ${severityColor}; font-size: 10px;\">${issue.severity.toUpperCase()}</span>\n          </div>\n          <div style=\"font-size: 10px; color: #ccc; margin-top: 2px;\">${issue.message}</div>\n        </div>`;\n      });\n\n      if (categoryIssues.length > 6) {\n        html += `<div style=\"font-size: 9px; opacity: 0.6; text-align: center;\">\n          ... ${categoryIssues.length - 6} more ${category.label.toLowerCase()} issues\n        </div>`;\n      }\n\n      html += '</div>';\n    });\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Packs Panel for MSD HUD\n * Shows pack collections and provenance information\n */\n\nexport class PacksPanel {\n  captureData() {\n    const collections = {};\n    const provenance = {};\n    const summary = {};\n\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      if (pipelineInstance) {\n        const resolvedModel = pipelineInstance.getResolvedModel?.();\n        if (resolvedModel) {\n          // Capture collections\n          const collectionTypes = ['animations', 'timelines', 'rules', 'profiles', 'overlays'];\n          collectionTypes.forEach(type => {\n            collections[type] = resolvedModel[type] || [];\n            summary[type] = collections[type].length;\n          });\n\n          // Capture provenance if available\n          if (resolvedModel.__provenance) {\n            Object.assign(provenance, resolvedModel.__provenance);\n          }\n        }\n\n        // Try to get merged config for additional info\n        const merged = pipelineInstance.merged;\n        if (merged) {\n          Object.keys(collections).forEach(type => {\n            if (merged[type]) {\n              collections[type] = merged[type];\n              summary[type] = merged[type].length;\n            }\n          });\n\n          if (merged.__provenance) {\n            Object.assign(provenance, merged.__provenance);\n          }\n        }\n      }\n    } catch (e) {\n      console.warn('[PacksPanel] Data capture failed:', e);\n    }\n\n    return { collections, provenance, summary };\n  }\n\n  renderHtml(packsData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Packs & Collections</h3>';\n\n    const { collections, provenance, summary } = packsData;\n\n    // Summary section\n    if (summary && Object.keys(summary).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Collection Summary</h4>';\n      html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;font-size:10px;\">';\n\n      Object.entries(summary).forEach(([type, count]) => {\n        const color = count > 0 ? '#66ff99' : '#666';\n        html += `<span style=\"background:#222;color:${color};padding:2px 4px;border:1px solid #444;border-radius:3px;\">\n          ${type}:${count}\n        </span>`;\n      });\n      html += '</div></div>';\n    }\n\n    // Provenance section (if available)\n    if (provenance && Object.keys(provenance).some(k => Object.keys(provenance[k] || {}).length > 0)) {\n      html += '<div class=\"msd-hud-section\"><h4>Provenance Sample</h4>';\n\n      const allEntries = [];\n      Object.entries(provenance).forEach(([collection, items]) => {\n        Object.entries(items || {}).forEach(([id, chain]) => {\n          allEntries.push({ collection, id, chain });\n        });\n      });\n\n      // Show first 8 entries\n      allEntries.slice(0, 8).forEach(entry => {\n        const shortId = entry.id.length > 15 ? entry.id.substring(0, 12) + '...' : entry.id;\n        const chainStr = (entry.chain || [])\n          .map(c => `${c.layer_id}${c.overridden ? '*' : ''}`)\n          .join(' → ');\n\n        html += `<div class=\"msd-hud-metric\" style=\"margin:2px 0;\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${entry.collection}:${shortId}</span>\n          </div>\n          <div style=\"font-size:9px;color:#888;margin-top:1px;font-family:monospace;\">\n            ${chainStr || 'No chain data'}\n          </div>\n        </div>`;\n      });\n\n      if (allEntries.length > 8) {\n        html += `<div style=\"font-size:9px;opacity:0.6;text-align:center;\">\n          ... ${allEntries.length - 8} more items\n        </div>`;\n      }\n\n      html += '</div>';\n    }\n\n    // Collections detail section\n    if (collections && Object.keys(collections).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Collections Detail</h4>';\n\n      Object.entries(collections).forEach(([type, items]) => {\n        if (!Array.isArray(items) || items.length === 0) return;\n\n        html += `<div style=\"margin-bottom:6px;\">\n          <div style=\"font-weight:bold;font-size:11px;color:#ffaa00;\">${type} (${items.length})</div>`;\n\n        // Show first few items with badges\n        items.slice(0, 6).forEach(item => {\n          if (!item || !item.id) return;\n\n          const badges = [];\n          if (item.__meta?.origin_pack) {\n            const pack = item.__meta.origin_pack;\n            if (pack === 'builtin:core') badges.push({ text: 'core', color: '#555' });\n            else if (pack.startsWith('builtin:')) badges.push({ text: 'builtin', color: '#663399' });\n            else if (pack.startsWith('external:')) badges.push({ text: 'ext', color: '#cc6600' });\n            else badges.push({ text: 'user', color: '#996515' });\n          }\n\n          if (item.__meta?.overridden) badges.push({ text: 'mod', color: '#8a6d00' });\n          if (item.__meta?.removed) badges.push({ text: 'rm', color: '#702020' });\n\n          const badgeHtml = badges.map(b =>\n            `<span style=\"background:${b.color};color:#fff;padding:0 3px;margin-left:4px;border-radius:2px;font-size:8px;\">\n              ${b.text}\n            </span>`\n          ).join('');\n\n          const shortId = item.id.length > 20 ? item.id.substring(0, 17) + '...' : item.id;\n          html += `<div style=\"margin-left:10px;font-size:10px;margin:1px 0;\">\n            ${shortId}${badgeHtml}\n          </div>`;\n        });\n\n        if (items.length > 6) {\n          html += `<div style=\"margin-left:10px;font-size:9px;color:#666;\">\n            ... ${items.length - 6} more\n          </div>`;\n        }\n\n        html += '</div>';\n      });\n\n      html += '</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No pack data available</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Rules Panel for MSD HUD\n * Shows rules engine evaluation trace and rule activity\n */\n\nexport class RulesPanel {\n  captureData() {\n    const rules = [];\n    const trace = [];\n    const stats = {};\n\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      const rulesEngine = pipelineInstance?.systemsManager?.rulesEngine ||\n                         pipelineInstance?.rulesEngine;\n\n      if (rulesEngine) {\n        // Get trace information - FIXED: Handle non-array trace\n        const engineTrace = rulesEngine.getTrace?.() || [];\n        if (Array.isArray(engineTrace)) {\n          trace.push(...engineTrace);\n        } else if (engineTrace) {\n          // Handle case where trace might be a single object or other format\n          trace.push(engineTrace);\n        }\n\n        // Get rules list - FIXED: Handle non-array rules\n        const rulesList = rulesEngine.rules || rulesEngine._rules || [];\n        if (Array.isArray(rulesList)) {\n          rulesList.forEach(rule => {\n            const traceInfo = trace.find(t => t && t.id === rule.id);\n            rules.push({\n              id: rule.id,\n              priority: rule.priority || 0,\n              lastMatch: traceInfo?.matched || false,\n              matchCount: rule._matchCount || rule.matchCount || 0,\n              conditions: rule.when ? Object.keys(rule.when).length : 0,\n              actions: rule.apply ? Object.keys(rule.apply).length : 0\n            });\n          });\n        }\n\n        // Calculate stats\n        stats.totalRules = rules.length;\n        stats.matchedRules = rules.filter(r => r.lastMatch).length;\n        stats.totalMatches = rules.reduce((sum, r) => sum + r.matchCount, 0);\n        stats.avgPriority = rules.length > 0 ?\n          rules.reduce((sum, r) => sum + r.priority, 0) / rules.length : 0;\n      }\n    } catch (e) {\n      console.warn('[RulesPanel] Data capture failed:', e);\n      // ADDED: Provide fallback data structure to prevent rendering errors\n      return {\n        rules: [],\n        trace: [],\n        stats: {\n          totalRules: 0,\n          matchedRules: 0,\n          totalMatches: 0,\n          avgPriority: 0\n        }\n      };\n    }\n\n    return { rules, trace, stats };\n  }\n\n  renderHtml(rulesData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Rules Engine</h3>';\n\n    const { rules, trace, stats } = rulesData;\n\n    // Stats section\n    if (stats && Object.keys(stats).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Statistics</h4>';\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Total Rules</span>\n        <span class=\"msd-hud-metric-value\">${stats.totalRules}</span>\n      </div>`;\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Currently Matched</span>\n        <span class=\"msd-hud-metric-value\" style=\"color:${stats.matchedRules > 0 ? '#66ff99' : '#666'};\">\n          ${stats.matchedRules}\n        </span>\n      </div>`;\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Total Matches</span>\n        <span class=\"msd-hud-metric-value\">${stats.totalMatches}</span>\n      </div>`;\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Avg Priority</span>\n        <span class=\"msd-hud-metric-value\">${stats.avgPriority.toFixed(1)}</span>\n      </div>`;\n      html += '</div>';\n    }\n\n    // Rules list section\n    if (rules && rules.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Rules Activity</h4>';\n\n      // Sort by priority descending, then by match status\n      const sortedRules = [...rules].sort((a, b) => {\n        if (a.lastMatch !== b.lastMatch) return b.lastMatch - a.lastMatch; // matched first\n        return b.priority - a.priority; // then by priority\n      });\n\n      sortedRules.slice(0, 10).forEach(rule => {\n        const shortId = rule.id.length > 20 ? rule.id.substring(0, 17) + '...' : rule.id;\n        const matchStatus = rule.lastMatch ? '✓' : '○';\n        const matchColor = rule.lastMatch ? '#66ff99' : '#666';\n\n        html += `<div class=\"msd-hud-metric\"\n          data-select-type=\"rule\"\n          data-select-id=\"${rule.id}\"\n          onclick=\"__msdHudBus('select:set',{type:'rule',id:'${rule.id}',source:'rules'})\"\n          style=\"margin:2px 0;padding:2px;${rule.lastMatch ? 'background:rgba(102,255,153,0.1);' : ''} border-radius:3px;\">\n          <div style=\"display:flex;justify-content:space-between;align-items:center;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <div style=\"display:flex;gap:8px;align-items:center;\">\n              <span style=\"font-size:10px;color:#888;\">p:${rule.priority}</span>\n              <span style=\"color:${matchColor};font-weight:bold;\">${matchStatus}</span>\n            </div>\n          </div>\n          <div style=\"font-size:10px;color:#888;margin-top:1px;\">\n            ${rule.conditions} conditions • ${rule.actions} actions • ${rule.matchCount} matches\n          </div>\n        </div>`;\n      });\n\n      if (sortedRules.length > 10) {\n        html += `<div style=\"font-size:10px;text-align:center;color:#666;margin-top:4px;\">\n          ... ${sortedRules.length - 10} more rules\n        </div>`;\n      }\n\n      html += '</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No rules engine data available</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Export Panel for MSD HUD\n * Interactive configuration export/import/diff tools\n * Based on legacy HudController export functionality\n */\n\nexport class ExportPanel {\n  constructor() {\n    // FIXED: Only log construction once, not on every refresh\n    console.log('[ExportPanel] Constructor called');\n    this.initialized = false;\n    this.initialized = true;\n  }\n\n  exportCollapsed() {\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      if (pipeline?.exportCollapsedJson) {\n        const json = pipeline.exportCollapsedJson(true);\n        this.downloadJson(json, 'msd-config-collapsed');\n        this.updateTextarea('collapsed', json);\n      }\n    } catch (e) {\n      console.error('[ExportPanel] Collapsed export failed:', e);\n    }\n  }\n\n  exportFull(includeMeta = false) {\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      if (pipeline?.exportFullSnapshotJson) {\n        const options = includeMeta ? { include_meta: true } : {};\n        const json = pipeline.exportFullSnapshotJson(options, true);\n        const filename = includeMeta ? 'msd-snapshot-with-meta' : 'msd-snapshot';\n        this.downloadJson(json, filename);\n        this.updateTextarea('full', json);\n      }\n    } catch (e) {\n      console.error('[ExportPanel] Full export failed:', e);\n    }\n  }\n\n  diffItem() {\n    // Future implementation\n  }\n\n  clearTextarea(type) {\n    this.updateTextarea(type, '');\n  }\n\n  copyToClipboard(type) {\n    const textarea = document.getElementById(`export-${type}-textarea`);\n    if (textarea && textarea.value) {\n      navigator.clipboard.writeText(textarea.value).then(() => {\n        this.showFeedback('Copied to clipboard!');\n      }).catch(e => {\n        console.warn('Clipboard copy failed:', e);\n        textarea.select();\n        textarea.setSelectionRange(0, 99999);\n      });\n    }\n  }\n\n  downloadJson(jsonString, filename) {\n    try {\n      const blob = new Blob([jsonString], { type: 'application/json' });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `${filename}-${Date.now()}.json`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n\n      this.showFeedback(`Downloaded: ${a.download}`);\n    } catch (e) {\n      console.error('[ExportPanel] Download failed:', e);\n    }\n  }\n\n  updateTextarea(type, content) {\n    const textarea = document.getElementById(`export-${type}-textarea`);\n    if (textarea) {\n      textarea.value = content;\n    }\n  }\n\n  showFeedback(message, type = 'info') {\n    const colors = {\n      info: '#00ffff',\n      success: '#00ff00',\n      warning: '#ffaa00',\n      error: '#ff6666'\n    };\n\n    const feedback = document.createElement('div');\n    feedback.style.cssText = `\n      position: fixed;\n      top: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: rgba(0, 0, 0, 0.9);\n      color: ${colors[type]};\n      padding: 8px 16px;\n      border: 1px solid ${colors[type]};\n      border-radius: 4px;\n      font-size: 12px;\n      z-index: 1000001;\n      pointer-events: none;\n    `;\n    feedback.textContent = message;\n    document.body.appendChild(feedback);\n\n    setTimeout(() => feedback.remove(), 3000);\n  }\n\n  captureData() {\n    const pipeline = window.__msdDebug?.pipelineInstance;\n\n    // FIXED: Add more detailed debugging for export panel visibility\n    const data = {\n      available: !!pipeline,\n      hasExportMethods: !!(pipeline?.exportCollapsedJson && pipeline?.exportFullSnapshotJson),\n      hasDiffMethod: !!pipeline?.diffItem,\n      collections: ['animations', 'timelines', 'rules', 'profiles', 'overlays'],\n      initialized: this.initialized,\n      globalHandlers: !!window.__msdExportPanel\n    };\n\n    // FIXED: Only log data capture issues, not every successful capture\n    if (!data.available) {\n      console.warn('[ExportPanel] Pipeline not available for export functionality');\n    }\n\n    return data;\n  }\n\n  renderHtml(exportData) {\n    // FIXED: Add debug info to help troubleshoot rendering\n    if (!exportData.available) {\n      return `<h3>Export & Config</h3>\n        <div class=\"msd-hud-section msd-hud-error\">\n          Pipeline instance not available\n          <div style=\"font-size: 10px; color: #888; margin-top: 4px;\">\n            Initialized: ${exportData.initialized} | Handlers: ${exportData.globalHandlers}\n          </div>\n        </div>`;\n    }\n\n    let html = '<h3>Export & Config</h3>';\n\n    // Export Controls Section\n    html += '<div class=\"msd-hud-section\"><h4>Export Configuration</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;margin-bottom:8px;\">';\n\n    html += `<button data-bus-event=\"export:collapsed\" onclick=\"__msdHudBus('export:collapsed')\"\n      style=\"font-size:10px;padding:2px 6px;background:#333;color:#fff;border:1px solid #555;border-radius:3px;cursor:pointer;\">\n      Collapsed JSON\n    </button>`;\n\n    html += `<button data-bus-event=\"export:full\" onclick=\"__msdHudBus('export:full')\"\n      style=\"font-size:10px;padding:2px 6px;background:#333;color:#fff;border:1px solid #555;border-radius:3px;cursor:pointer;\">\n      Full Snapshot\n    </button>`;\n\n    html += `<button data-bus-event=\"export:full-meta\" onclick=\"__msdHudBus('export:full-meta')\"\n      style=\"font-size:10px;padding:2px 6px;background:#666;color:#fff;border:1px solid #888;border-radius:3px;cursor:pointer;\">\n      +Metadata\n    </button>`;\n\n    html += '</div>';\n\n    // Collapsed JSON textarea\n    html += '<div style=\"margin-bottom:6px;\">';\n    html += '<div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:2px;\">';\n    html += '<span style=\"font-size:11px;color:#ffaa00;\">Collapsed JSON:</span>';\n    html += '<div style=\"display:flex;gap:2px;\">';\n    html += `<button data-bus-event=\"export:copy\" onclick=\"__msdHudBus('export:copy',{type:'collapsed'})\" style=\"font-size:9px;padding:1px 4px;background:#444;color:#fff;border:1px solid #666;border-radius:2px;cursor:pointer;\">Copy</button>`;\n    html += `<button data-bus-event=\"export:clear\" onclick=\"__msdHudBus('export:clear',{type:'collapsed'})\" style=\"font-size:9px;padding:1px 4px;background:#666;color:#fff;border:1px solid #888;border-radius:2px;cursor:pointer;\">Clear</button>`;\n    html += '</div></div>';\n    html += `<textarea id=\"export-collapsed-textarea\" name=\"export-collapsed\" readonly\n      style=\"width:100%;height:80px;font-size:9px;font-family:monospace;background:#111;color:#ccc;border:1px solid #444;border-radius:3px;padding:4px;resize:vertical;\"></textarea>`;\n    html += '</div>';\n\n    // Full JSON textarea\n    html += '<div style=\"margin-bottom:6px;\">';\n    html += '<div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:2px;\">';\n    html += '<span style=\"font-size:11px;color:#ffaa00;\">Full Snapshot:</span>';\n    html += '<div style=\"display:flex;gap:2px;\">';\n    html += `<button data-bus-event=\"export:copy\" onclick=\"__msdHudBus('export:copy',{type:'full'})\" style=\"font-size:9px;padding:1px 4px;background:#444;color:#fff;border:1px solid #666;border-radius:2px;cursor:pointer;\">Copy</button>`;\n    html += `<button data-bus-event=\"export:clear\" onclick=\"__msdHudBus('export:clear',{type:'full'})\" style=\"font-size:9px;padding:1px 4px;background:#666;color:#fff;border:1px solid #888;border-radius:2px;cursor:pointer;\">Clear</button>`;\n    html += '</div></div>';\n    html += `<textarea id=\"export-full-textarea\" name=\"export-full\" readonly\n      style=\"width:100%;height:100px;font-size:9px;font-family:monospace;background:#111;color:#ccc;border:1px solid #444;border-radius:3px;padding:4px;resize:vertical;\"></textarea>`;\n    html += '</div>';\n\n    html += '</div>';\n\n    // Status\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      Export: ${exportData.hasExportMethods ? '✅' : '❌'} •\n      Diff: ${exportData.hasDiffMethod ? '✅' : '❌'} •\n      Handlers: ${exportData.globalHandlers ? '✅' : '❌'} •\n      Ready for config management\n    </div>`;\n\n    return html;\n  }\n}\n","// Lightweight HUD Event Bus\nexport class HudEventBus {\n  constructor() {\n    this._listeners = new Map(); // event -> Set<fn>\n  }\n  on(event, fn) {\n    if (!this._listeners.has(event)) this._listeners.set(event, new Set());\n    this._listeners.get(event).add(fn);\n    return () => this.off(event, fn);\n  }\n  once(event, fn) {\n    const off = this.on(event, (p) => { off(); fn(p); });\n  }\n  off(event, fn) {\n    this._listeners.get(event)?.delete(fn);\n  }\n  emit(event, payload) {\n    const list = this._listeners.get(event);\n    if (list) {\n      list.forEach(fn => {\n        try { fn(payload); } catch (e) { /* swallow */ }\n      });\n    }\n    // Wildcard listeners\n    const any = this._listeners.get('*');\n    if (any) {\n      any.forEach(fn => {\n        try { fn({ event, payload }); } catch (_) {}\n      });\n    }\n  }\n  clear() {\n    this._listeners.clear();\n  }\n}\n\nexport class SelectionManager {\n  constructor(bus) {\n    this.bus = bus;\n    this.current = null;\n  }\n  set(type, id, meta = {}) {\n    if (!type || !id) return;\n    this.current = {\n      type,\n      id,\n      meta,\n      ts: Date.now()\n    };\n    this.bus?.emit('select:changed', this.current);\n  }\n  clear() {\n    this.current = null;\n    this.bus?.emit('select:changed', null);\n  }\n  get() {\n    return this.current;\n  }\n}\n","/**\n * Overlays Inspection Panel\n * Lists resolved overlays with quick highlight and structural info.\n */\nexport class OverlaysPanel {\n  captureData() {\n    const overlays = [];\n    const stats = { total: 0, byType: {} };\n\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      const model = pipeline?.getResolvedModel?.();\n      if (model?.overlays) {\n        model.overlays.forEach(o => {\n          stats.total++;\n            stats.byType[o.type] = (stats.byType[o.type] || 0) + 1;\n          overlays.push({\n            id: o.id,\n            type: o.type || 'unknown',\n            anchor: o.anchor,\n            attach_to: o.attach_to,\n            profileCount: Array.isArray(o._profiles) ? o._profiles.length : 0,\n            patchCount: Array.isArray(o._patches) ? o._patches.length : 0,\n            styleSourceCount: Array.isArray(o._styleSources) ? o._styleSources.length : 0,\n            finalStyle: o.finalStyle || o.style || {},\n            smooth: o.smooth,\n            channel: o.channel,\n            meta: {\n              fromPacks: o.__meta?.origin_pack,\n              overridden: !!o.__meta?.overridden\n            }\n          });\n        });\n      }\n    } catch (e) {\n      console.warn('[OverlaysPanel] captureData failed:', e);\n    }\n\n    return { overlays, stats };\n  }\n\n  // REPLACED: Simplified, mount-scoped highlight with SVG-safe styling\n  highlightOverlay(id) {\n    try {\n      if (!id) return;\n      const mount = window.__msdDebug?.pipelineInstance?.mountElement ||\n                    window.__msdDebug?.mountElement;\n      if (!mount) {\n        console.warn('[OverlaysPanel] No mountElement available for highlight');\n        return;\n      }\n\n      this._ensureHighlightStyles();\n\n      // ADDED: Get overlay type to handle controls differently\n      const overlay = this._findOverlayModel(id);\n      const isControlsType = overlay?.type === 'control'; // FIXED: singular 'control' not 'controls'\n\n      console.log(`[OverlaysPanel] Overlay \"${id}\":`, overlay);\n      console.log(`[OverlaysPanel] Overlay type: \"${overlay?.type}\", isControlsType: ${isControlsType}`);\n\n      // Search only inside mount (and shadow root if present)\n      const roots = [mount];\n      if (mount.shadowRoot) roots.push(mount.shadowRoot);\n\n      const matches = [];\n      const selectorExact = `[data-overlay-id=\"${CSS.escape(id)}\"]`;\n      const selectorId = `#${CSS.escape(id)}`;\n\n      // ADDED: For controls type, search for the control containers (much simpler!)\n      const controlsSelectors = isControlsType ? [\n        `foreignObject[data-msd-control-id=\"${CSS.escape(id)}\"]`,\n        `div[data-msd-control-id=\"${CSS.escape(id)}\"]`,\n        `#msd-control-foreign-${CSS.escape(id)}`\n      ] : [];\n\n      roots.forEach(root => {\n        console.log(`[OverlaysPanel] Searching in root:`, root);\n\n        // Try standard selectors first\n        const exactMatches = root.querySelectorAll(selectorExact);\n        const byIdMatch = root.querySelector(selectorId);\n        console.log(`[OverlaysPanel] Standard selectors for \"${id}\":`, {\n          selectorExact: selectorExact,\n          exactMatches: exactMatches.length,\n          selectorId: selectorId,\n          byIdMatch: !!byIdMatch\n        });\n\n        exactMatches.forEach(el => matches.push(el));\n        if (byIdMatch && !matches.includes(byIdMatch)) matches.push(byIdMatch);\n\n        // ADDED: Search for controls-specific elements\n        if (isControlsType) {\n          console.log(`[OverlaysPanel] Searching for controls overlay: ${id}`);\n          console.log(`[OverlaysPanel] Controls selectors:`, controlsSelectors);\n          controlsSelectors.forEach(selector => {\n            try {\n              const found = root.querySelectorAll(selector);\n              console.log(`[OverlaysPanel] Selector \"${selector}\" found ${found.length} elements:`, found);\n              found.forEach(el => {\n                if (!matches.includes(el)) matches.push(el);\n              });\n            } catch (e) {\n              console.warn(`[OverlaysPanel] Invalid selector: ${selector}`, e);\n            }\n          });\n        } else {\n          console.log(`[OverlaysPanel] Not a controls type overlay, skipping controls selectors`);\n        }\n      });\n\n      console.log(`[OverlaysPanel] Total matches found: ${matches.length}`, matches);\n\n      if (matches.length === 0) {\n        console.warn('[OverlaysPanel] No nodes found for overlay', id);\n        this._toast(`Overlay not found: ${id}`, '#ff4444');\n        return;\n      }\n\n      // Apply highlight to each match\n      matches.forEach(node => {\n        if (isControlsType) {\n          // ADDED: Special highlighting for controls type\n          this._applyControlsHighlight(node, '#ff66ff');\n        } else {\n          this._applyElementHighlight(node, '#ff66ff');\n          // If group/container, highlight child paths too\n          if (node.tagName && node.tagName.toLowerCase() === 'g') {\n            node.querySelectorAll('path, line, polyline, polygon, rect, circle, ellipse').forEach(child => {\n              this._applyElementHighlight(child, '#ff66ff', true);\n            });\n          }\n        }\n      });\n\n      this._toast(`Overlay: ${id} (${overlay?.type || 'unknown'})`, '#ff66ff');\n    } catch (e) {\n      console.warn('[OverlaysPanel] highlightOverlay failed:', e);\n    }\n  }\n\n  // NEW: Special highlighting for controls type overlays (HA cards)\n  _applyControlsHighlight(node, color) {\n    const DURATION = 3000;\n\n    // Store originals for restoration\n    if (!node.dataset._msdCtrlHl) {\n      node.dataset._msdCtrlHl = '1';\n      node.dataset._msdPrevBoxShadow = node.style.boxShadow || '';\n      node.dataset._msdPrevZIndex = node.style.zIndex || '';\n      node.dataset._msdPrevOutline = node.style.outline || '';\n      node.dataset._msdPrevFilter = node.style.filter || '';\n    }\n\n    // FIXED: Apply glow/pulse highlighting without scaling to avoid position shifts\n    node.style.boxShadow = `0 0 15px ${color}, 0 0 30px ${color}, inset 0 0 15px rgba(255,102,255,0.2)`;\n    node.style.zIndex = '999999';\n    node.style.outline = `2px solid ${color}`;\n    node.style.outlineOffset = '2px';\n    node.style.filter = `drop-shadow(0 0 8px ${color}) brightness(1.1)`;\n    node.classList.add('msd-overlay-highlighted', 'msd-controls-highlighted');\n\n    // Enhanced pulsing animation without transform scaling\n    const pulseStyle = document.createElement('style');\n    pulseStyle.id = `msd-pulse-${node.dataset._msdCtrlHl}`;\n    pulseStyle.textContent = `\n      .msd-controls-highlighted {\n        animation: msdControlsPulse 1.2s ease-in-out infinite alternate;\n      }\n      @keyframes msdControlsPulse {\n        0% {\n          filter: drop-shadow(0 0 8px ${color}) brightness(1.1) saturate(1);\n          box-shadow: 0 0 15px ${color}, 0 0 30px ${color}, inset 0 0 15px rgba(255,102,255,0.2);\n        }\n        100% {\n          filter: drop-shadow(0 0 12px ${color}) brightness(1.3) saturate(1.2);\n          box-shadow: 0 0 20px ${color}, 0 0 40px ${color}, inset 0 0 20px rgba(255,102,255,0.3);\n        }\n      }\n    `;\n    document.head.appendChild(pulseStyle);\n\n    setTimeout(() => {\n      // Restore original styles\n      if (node.dataset._msdPrevBoxShadow !== undefined) {\n        if (node.dataset._msdPrevBoxShadow) node.style.boxShadow = node.dataset._msdPrevBoxShadow;\n        else node.style.removeProperty('box-shadow');\n      }\n      if (node.dataset._msdPrevZIndex !== undefined) {\n        if (node.dataset._msdPrevZIndex) node.style.zIndex = node.dataset._msdPrevZIndex;\n        else node.style.removeProperty('z-index');\n      }\n      if (node.dataset._msdPrevOutline !== undefined) {\n        if (node.dataset._msdPrevOutline) node.style.outline = node.dataset._msdPrevOutline;\n        else node.style.removeProperty('outline');\n      }\n      if (node.dataset._msdPrevFilter !== undefined) {\n        if (node.dataset._msdPrevFilter) node.style.filter = node.dataset._msdPrevFilter;\n        else node.style.removeProperty('filter');\n      }\n      node.style.removeProperty('outline-offset');\n      node.classList.remove('msd-overlay-highlighted', 'msd-controls-highlighted');\n\n      // Remove pulse animation\n      const pulse = document.getElementById(`msd-pulse-${node.dataset._msdCtrlHl}`);\n      if (pulse) pulse.remove();\n    }, DURATION);\n  }\n\n  // NEW: Apply highlight with restoration\n  _applyElementHighlight(node, color, isChild = false) {\n    const tag = (node.tagName || '').toLowerCase();\n    const isSvg =\n      ['path','g','line','polyline','polygon','rect','circle','ellipse'].includes(tag) ||\n      node instanceof SVGElement;\n\n    const DURATION = 3000;\n\n    if (isSvg) {\n      // Store originals only once\n      if (!node.dataset._msdHl) {\n        node.dataset._msdHl = '1';\n        node.dataset._msdPrevStroke = node.getAttribute('stroke') || node.style.stroke || '';\n        node.dataset._msdPrevStrokeW = node.getAttribute('stroke-width') || node.style.strokeWidth || '';\n        node.dataset._msdPrevFilter = node.style.filter || '';\n      }\n      // Emphasize\n      node.style.stroke = color;\n      if (tag !== 'g') {\n        node.style.strokeWidth = '4';\n      }\n      node.style.filter = 'drop-shadow(0 0 6px ' + color + ')';\n      node.classList.add('msd-overlay-highlighted');\n\n      setTimeout(() => {\n        // Restore\n        if (node.dataset._msdPrevStroke !== undefined) {\n          if (node.dataset._msdPrevStroke) node.style.stroke = node.dataset._msdPrevStroke;\n          else node.style.removeProperty('stroke');\n        }\n        if (node.dataset._msdPrevStrokeW !== undefined) {\n            if (node.dataset._msdPrevStrokeW) node.style.strokeWidth = node.dataset._msdPrevStrokeW;\n            else node.style.removeProperty('stroke-width');\n        }\n        if (node.dataset._msdPrevFilter !== undefined) {\n          if (node.dataset._msdPrevFilter) node.style.filter = node.dataset._msdPrevFilter;\n          else node.style.removeProperty('filter');\n        }\n        node.classList.remove('msd-overlay-highlighted');\n      }, DURATION);\n\n    } else {\n      // Non-SVG element highlight\n      if (!node.dataset._msdHlBox) {\n        node.dataset._msdHlBox = '1';\n        node.dataset._msdPrevOutline = node.style.outline || '';\n        node.dataset._msdPrevBoxShadow = node.style.boxShadow || '';\n        node.dataset._msdPrevFilter = node.style.filter || '';\n      }\n      node.style.outline = `3px solid ${color}`;\n      node.style.boxShadow = `0 0 10px ${color}`;\n      node.style.filter = `drop-shadow(0 0 6px ${color})`;\n      node.classList.add('msd-overlay-highlighted');\n\n      setTimeout(() => {\n        if (node.dataset._msdPrevOutline !== undefined) {\n          if (node.dataset._msdPrevOutline) node.style.outline = node.dataset._msdPrevOutline;\n          else node.style.removeProperty('outline');\n        }\n        if (node.dataset._msdPrevBoxShadow !== undefined) {\n          if (node.dataset._msdPrevBoxShadow) node.style.boxShadow = node.dataset._msdPrevBoxShadow;\n          else node.style.removeProperty('box-shadow');\n        }\n        if (node.dataset._msdPrevFilter !== undefined) {\n          if (node.dataset._msdPrevFilter) node.style.filter = node.dataset._msdPrevFilter;\n          else node.style.removeProperty('filter');\n        }\n        node.classList.remove('msd-overlay-highlighted');\n      }, DURATION);\n    }\n  }\n\n  // UPDATED: ensure styles (kept minimal)\n  _ensureHighlightStyles() {\n    if (document.getElementById('msd-overlay-highlight-style')) return;\n    const style = document.createElement('style');\n    style.id = 'msd-overlay-highlight-style';\n    style.textContent = `\n      .msd-overlay-highlighted {\n        transition: outline .15s, box-shadow .15s;\n      }\n    `;\n    document.head.appendChild(style);\n  }\n\n  analyzeOverlay(id) {\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      const model = pipeline?.getResolvedModel?.();\n      const overlay = model?.overlays?.find(o => o.id === id);\n      if (!overlay) {\n        console.warn('[OverlaysPanel] analyzeOverlay: overlay not found', id);\n        this._toast('Overlay not found', '#ff4444');\n        return;\n      }\n\n      // Console diagnostics\n      console.group(`🛰 Overlay Analysis: ${id}`);\n      console.table([{\n        id: overlay.id,\n        type: overlay.type,\n        anchor: overlay.anchor,\n        attach_to: overlay.attach_to,\n        channel: overlay.channel,\n        smooth: overlay.smooth,\n        profiles: (overlay._profiles || []).length,\n        patches: (overlay._patches || []).length,\n        styleSources: (overlay._styleSources || []).length\n      }]);\n      if (overlay.finalStyle || overlay.style) {\n        console.log('Final Style:', overlay.finalStyle || overlay.style);\n      }\n      if (overlay._styleSources) {\n        console.log('Style Sources (detailed):', overlay._styleSources);\n        // ADDED: Log each source individually for debugging\n        overlay._styleSources.forEach((source, i) => {\n          console.log(`Source ${i}:`, source);\n        });\n      }\n      if (overlay._patches) {\n        console.log('Rule Patches:', overlay._patches);\n      }\n      if (overlay.__meta) {\n        console.log('Metadata:', overlay.__meta);\n      }\n      // ADDED: Log full overlay object for debugging\n      console.log('Full Overlay Object:', overlay);\n      console.groupEnd();\n\n      // Popup\n      this._showOverlayPopup(overlay);\n    } catch (e) {\n      console.warn('[OverlaysPanel] analyzeOverlay failed:', e);\n    }\n  }\n\n  _showOverlayPopup(overlay) {\n    const existing = document.getElementById('msd-overlay-popup');\n    if (existing) existing.remove();\n\n    // ADDED: Get proportional font sizes for popup\n    const baseFontSize = window.__msdDebug?.hud?.manager?.state?.fontSize || 14;\n    const sectionFontSize = Math.round(baseFontSize * 1.0); // 12px when base is 12px\n    const metricFontSize = Math.round(baseFontSize * 0.92); // 11px when base is 12px\n    const controlsFontSize = Math.round(baseFontSize * 0.83); // 10px when base is 12px\n    const smallFontSize = Math.round(baseFontSize * 0.75); // 9px when base is 12px\n    const tinyFontSize = Math.round(baseFontSize * 0.67); // 8px when base is 12px\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-overlay-popup';\n    popup.style.cssText = `\n      position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);\n      background:rgba(0,0,0,0.95);color:#ff66ff;\n      border:2px solid #ff66ff;border-radius:8px;\n      padding:14px 16px;z-index:1000003;\n      font-family:monospace;font-size:${sectionFontSize}px;\n      max-width:480px;max-height:70vh;overflow:auto;\n      box-shadow:0 4px 18px rgba(255,102,255,0.4);\n    `;\n\n    const stylePreview = (() => {\n      try {\n        const s = JSON.stringify(overlay.finalStyle || overlay.style || {}, null, 2);\n        return s.length > 520 ? s.slice(0, 517) + '...' : s;\n      } catch { return '{}'; }\n    })();\n\n    const sources = (overlay._styleSources || []).map(s => `${s.kind}:${s.id}`).join(', ') || 'none';\n    const patches = (overlay._patches || []).map(p => p.ruleId || p.id).join(', ') || 'none';\n    const profiles = (overlay._profiles || []).map(p => p.id || p).join(', ') || 'none';\n\n    // ADDED: Enhanced sources breakdown showing properties from each source\n    const sourcesDetail = (() => {\n      if (!overlay._styleSources || overlay._styleSources.length === 0) return 'none';\n\n      try {\n        const finalStyleProps = overlay.finalStyle ? Object.keys(overlay.finalStyle) : [];\n        console.log('[OverlaysPanel] Final style properties:', finalStyleProps);\n        console.log('[OverlaysPanel] Number of sources:', overlay._styleSources.length);\n\n        // FIXED: Show each property individually with its source\n        const propertyMappings = [];\n\n        overlay._styleSources.forEach((source, index) => {\n          const sourceLabel = `${source.kind || 'unknown'}:${source.id || `source-${index}`}`;\n\n          // Match source index to property index\n          if (index < finalStyleProps.length) {\n            const property = finalStyleProps[index];\n            propertyMappings.push(`${property} <span style=\"color:#ffaa00;font-weight:bold;font-size:${Math.round(controlsFontSize * 1.3)}px;\"> ◀ </span> ${sourceLabel}`);\n            console.log(`[OverlaysPanel] Source ${index} (${sourceLabel}) → ${property}`);\n          }\n        });\n\n        // If we have more properties than sources, the remaining might be from defaults\n        if (finalStyleProps.length > overlay._styleSources.length) {\n          const remainingProps = finalStyleProps.slice(overlay._styleSources.length);\n          remainingProps.forEach(prop => {\n            propertyMappings.push(`${prop} <span style=\"color:#ffaa00;font-weight:bold;font-size:${Math.round(controlsFontSize * 1.3)}px;\"> ◀ </span> default:computed`);\n          });\n        }\n\n        // Format as individual property lines\n        return propertyMappings.join('<br>') || 'none';\n      } catch (e) {\n        console.warn('[OverlaysPanel] Error processing sources:', e);\n        // Fallback to simple list\n        return overlay._styleSources.map((s, i) => `property${i} <span style=\"color:#ffaa00;font-weight:bold;font-size:${Math.round(controlsFontSize * 1.3)}px;\"> ◀ </span> ${s.kind || 'unknown'}:${s.id || 'unnamed'}`).join('<br>');\n      }\n    })();    popup.innerHTML = `\n      <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;\">\n        <h3 style=\"margin:0;color:#ffaaee;\">Overlay: ${overlay.id}</h3>\n        <button style=\"background:#331133;color:#fff;border:1px solid #553366;border-radius:4px;padding:2px 8px;cursor:pointer;font-size:${metricFontSize}px;\"\n          onclick=\"document.getElementById('msd-overlay-popup')?.remove()\">\n          Close\n        </button>\n      </div>\n      <div style=\"font-size:${metricFontSize}px;line-height:1.4;color:#ddd;\">\n        <strong>Type:</strong> ${overlay.type || 'n/a'}<br>\n        <strong>Anchor:</strong> ${overlay.anchor || 'none'} → <strong>Attach:</strong> ${overlay.attach_to || 'none'}<br>\n        <strong>Channel:</strong> ${overlay.channel || 'none'} | <strong>Smooth:</strong> ${overlay.smooth ? 'yes':'no'}<br>\n        <strong>Profiles:</strong> ${profiles}<br>\n        <strong>Sources:</strong><br>\n        <div style=\"margin-left:12px;font-size:${controlsFontSize}px;color:#bbb;line-height:1.3;\">\n          ${sourcesDetail}\n        </div>\n        <strong>Patches:</strong> ${patches}<br>\n        <strong>Meta:</strong> ${overlay.__meta ? Object.keys(overlay.__meta).join(', ') : 'none'}\n      </div>\n      <div style=\"margin-top:8px;\">\n        <div style=\"color:#ffaaee;font-size:${metricFontSize}px;margin-bottom:4px;\">Final Style</div>\n        <pre style=\"margin:0;background:#111;color:#ccc;padding:8px;border:1px solid #552255;border-radius:4px;font-size:${controlsFontSize}px;max-height:200px;overflow:auto;\">${stylePreview}</pre>\n      </div>\n      <div style=\"margin-top:8px;text-align:right;\">\n        <button\n          style=\"background:#552255;color:#fff;border:1px solid #aa55aa;border-radius:4px;padding:3px 10px;cursor:pointer;font-size:${metricFontSize}px;\"\n          onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(overlay.finalStyle || overlay.style || {})},null,2))\">\n          Copy Style\n        </button>\n        <button\n          style=\"background:#331133;color:#fff;border:1px solid #553366;border-radius:4px;padding:3px 10px;cursor:pointer;font-size:${metricFontSize}px;margin-left:6px;\"\n          onclick=\"document.getElementById('msd-overlay-popup')?.remove()\">\n          Done\n        </button>\n      </div>\n    `;\n\n    document.body.appendChild(popup);\n    setTimeout(() => {\n      if (popup.parentElement) popup.style.opacity = '1';\n    }, 10);\n\n    // REMOVED: Auto-close timeout - let users close manually\n    // setTimeout(() => popup.parentElement && popup.remove(), 25000);\n  }\n\n  // NEW: analyzeOverlay remains (unchanged) above/below if already present\n\n  // NEW helper: ensure CSS\n  _ensureHighlightStyles() {\n    if (document.getElementById('msd-overlay-highlight-style')) return;\n    const style = document.createElement('style');\n    style.id = 'msd-overlay-highlight-style';\n    style.textContent = `\n      .msd-overlay-highlighted {\n        transition: outline .15s, box-shadow .15s;\n      }\n    `;\n    document.head.appendChild(style);\n  }\n\n  // NEW helper: locate overlay model object\n  _findOverlayModel(id) {\n    try {\n      const model = window.__msdDebug?.pipelineInstance?.getResolvedModel?.();\n      return model?.overlays?.find(o => o.id === id);\n    } catch {\n      return null;\n    }\n  }\n\n  // NEW helper: create bounding box from overlay anchor + attach_to if anchors exist\n  _highlightBoundingBoxFromModel(overlay, id) {\n    try {\n      const anchorId = overlay.anchor;\n      const attachId = overlay.attach_to;\n      const mount =\n        window.__msdDebug?.pipelineInstance?.mountElement ||\n        window.__msdDebug?.mountElement ||\n        document;\n\n      const anchorEl = anchorId ? mount.querySelector(`[data-anchor-id=\"${CSS.escape(anchorId)}\"],#${CSS.escape(anchorId)}`) : null;\n      const attachEl = attachId ? mount.querySelector(`[data-anchor-id=\"${CSS.escape(attachId)}\"],#${CSS.escape(attachId)}`) : null;\n\n      if (!anchorEl && !attachEl) {\n        // fallback to mount bounding box\n        const rect = mount.getBoundingClientRect();\n        this._spawnBoundingBox(rect, id, '#ff66ff');\n        return;\n      }\n\n      // Compute combined rect\n      const rects = [];\n      if (anchorEl) rects.push(anchorEl.getBoundingClientRect());\n      if (attachEl) rects.push(attachEl.getBoundingClientRect());\n\n      const minX = Math.min(...rects.map(r => r.left));\n      const minY = Math.min(...rects.map(r => r.top));\n      const maxR = Math.max(...rects.map(r => r.right));\n      const maxB = Math.max(...rects.map(r => r.bottom));\n\n      this._spawnBoundingBox(\n        { left: minX, top: minY, width: maxR - minX, height: maxB - minY },\n        id,\n        '#ff66ff'\n      );\n    } catch (e) {\n      console.warn('[OverlaysPanel] _highlightBoundingBoxFromModel failed:', e);\n    }\n  }\n\n  // NEW helper: spawn absolute box\n  _spawnBoundingBox(rect, id, color) {\n    if (!rect) return;\n    const box = document.createElement('div');\n    box.className = 'msd-overlay-box-highlight';\n    box.style.left = rect.left + 'px';\n    box.style.top = rect.top + 'px';\n    box.style.width = rect.width + 'px';\n    box.style.height = rect.height + 'px';\n    box.dataset.overlayBoxFor = id;\n    document.body.appendChild(box);\n    setTimeout(() => box.remove(), 3000);\n    this._toast(`Overlay (bbox): ${id}`, color);\n  }\n\n  _toast(msg, color = '#ff66ff') {\n    // ADDED: Get proportional font size for toast\n    const baseFontSize = window.__msdDebug?.hud?.manager?.state?.fontSize || 14;\n    const controlsFontSize = Math.round(baseFontSize * 0.83); // 10px when base is 12px\n\n    const el = document.createElement('div');\n    el.style.cssText = `\n      position:fixed;top:18px;right:18px;\n      background:#000;padding:4px 10px;\n      border:1px solid ${color};color:${color};\n      font:${controlsFontSize}px monospace;z-index:1000002;\n      border-radius:4px;opacity:.95;\n    `;\n    el.textContent = msg;\n    document.body.appendChild(el);\n    setTimeout(() => el.remove(), 1600);\n  }\n\n  renderHtml(data) {\n    const { overlays = [], stats = {} } = data;\n\n    // ADDED: Get font size from HUD manager context for proportional scaling\n    const baseFontSize = window.__msdDebug?.hud?.manager?.state?.fontSize || 14;\n    const metricFontSize = Math.round(baseFontSize * 0.92); // 11px when base is 12px\n    const controlsFontSize = Math.round(baseFontSize * 0.83); // 10px when base is 12px\n    const smallFontSize = Math.round(baseFontSize * 0.75); // 9px when base is 12px\n    const tinyFontSize = Math.round(baseFontSize * 0.67); // 8px when base is 12px\n\n    let html = '<div class=\"msd-hud-panel\"><h3>Overlays</h3>';\n    html += `<style>\n      .msd-overlay-highlighted { outline:3px solid #ff66ff !important; }\n    </style>`;\n    html += '<div class=\"msd-hud-section\"><h4>Stats</h4>';\n    html += `<div class=\"msd-hud-metric\"><span class=\"msd-hud-metric-name\">Total</span><span class=\"msd-hud-metric-value\">${stats.total || 0}</span></div>`;\n    Object.entries(stats.byType || {}).slice(0,6).forEach(([type,count]) => {\n      html += `<div class=\"msd-hud-metric\" style=\"font-size:${controlsFontSize}px;\">\n        <span class=\"msd-hud-metric-name\">${type}</span>\n        <span class=\"msd-hud-metric-value\">${count}</span>\n      </div>`;\n    });\n    html += '</div>';\n\n    if (!overlays.length) {\n      html += '<div class=\"msd-hud-section\">No overlays</div></div>';\n      return html;\n    }\n\n    html += '<div class=\"msd-hud-section\"><h4>Overlay List</h4>';\n    overlays.slice(0,25).forEach(o => {\n      const shortId = o.id.length > 22 ? o.id.slice(0,19)+'...' : o.id;\n      const badge = o.meta.overridden ? ' • mod' : '';\n      const stylePreview = (() => {\n        try {\n          const json = JSON.stringify(o.finalStyle);\n          return json.length > 50 ? json.slice(0,47)+'...' : json;\n        } catch { return ''; }\n      })();\n      html += `<div\n        data-select-type=\"overlay\"\n        data-select-id=\"${o.id}\"\n        style=\"cursor:pointer;border:1px solid #222;padding:4px;border-radius:4px;margin:4px 0;\"\n        onclick=\"__msdHudBus('select:set',{type:'overlay',id:'${o.id}',source:'overlays'});__msdHudBus('overlay:highlight',{id:'${o.id}'})\"\n      >\n        <div style=\"display:flex;justify-content:space-between;align-items:center;\">\n          <span style=\"color:#aaa;\">${shortId}${badge}</span>\n          <span style=\"color:#ff66ff;font-size:${metricFontSize}px;\">${o.type}</span>\n        </div>\n        <div style=\"font-size:${controlsFontSize}px;color:#888;margin-top:2px;\">\n          ${o.anchor ? `Anchor: ${o.anchor}` : 'No anchor'} ${o.attach_to ? `<span style=\"color:#ffaa00;font-weight:bold;font-size:${Math.round(controlsFontSize * 1.2)}px;\"> ➤ </span>${o.attach_to}` : ''} ${o.channel ? `• Channel: ${o.channel}` : ''} ${o.smooth ? '• Smooth' : ''}\n        </div>\n        <div style=\"font-size:${controlsFontSize}px;color:#666;margin-top:2px;\">\n          Sources: ${o.styleSourceCount} • Profiles: ${o.profileCount} • Patches: ${o.patchCount}\n        </div>\n        <div style=\"font-size:${smallFontSize}px;color:#555;overflow:hidden;text-overflow:ellipsis;margin-top:2px;\">\n          ${stylePreview}\n        </div>\n        <div style=\"margin-top:4px;text-align:right;\">\n          <button\n            onclick=\"event.stopPropagation();__msdHudBus('overlay:highlight',{id:'${o.id}'});__msdHudBus('overlay:analyze',{id:'${o.id}'})\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#331133;color:#ffccff;border:1px solid #553355;border-radius:3px;cursor:pointer;\">\n            Analyze\n          </button>\n        </div>\n      </div>`;\n    });\n    if (overlays.length > 25) {\n      html += `<div style=\"font-size:${smallFontSize}px;opacity:.6;text-align:center;margin-top:4px;\">... ${overlays.length - 25} more</div>`;\n    }\n    html += '</div></div>';\n    return html;\n  }\n}\n","/**\n * MSD HUD Manager - Coordinates all debug panels\n * Provides development interface for monitoring MSD v1 pipeline\n */\n\nimport { PerformancePanel } from './panels/PerformancePanel.js';\nimport { ValidationPanel } from './panels/ValidationPanel.js';\nimport { DataSourcePanel } from './panels/DataSourcePanel.js';\nimport { RoutingPanel } from './panels/RoutingPanel.js';\nimport { ChannelTrendPanel } from './panels/ChannelTrendPanel.js';\nimport { FlagsPanel } from './panels/FlagsPanel.js';\nimport { IssuesPanel } from './panels/IssuesPanel.js';\nimport { PacksPanel } from './panels/PacksPanel.js';\nimport { RulesPanel } from './panels/RulesPanel.js';\nimport { ExportPanel } from './panels/ExportPanel.js';\nimport { HudEventBus } from './hudService.js'; // existing\nimport { SelectionManager } from './hudService.js'; // ADDED\nimport { OverlaysPanel } from './panels/OverlaysPanel.js'; // ADDED\n\n// FIXED: Move debug verification to constructor only, not on every import\nconsole.log('[MsdHudManager] Importing ExportPanel class');\n\nexport class MsdHudManager {\n  constructor() {\n    // FIXED: Test ExportPanel instantiation only once during construction\n    console.log('[MsdHudManager] Testing ExportPanel instantiation...');\n    try {\n      const testExportPanel = new ExportPanel();\n      console.log('[MsdHudManager] ExportPanel test successful');\n    } catch (e) {\n      console.error('[MsdHudManager] ExportPanel instantiation failed:', e);\n    }\n\n    this.bus = new HudEventBus(); // ADDED\n    window.__msdHudBus = (evt, payload) => this.bus.emit(evt, payload || {}); // ADDED global helper\n\n    this.panels = {\n      issues: new IssuesPanel(),\n      flags: new FlagsPanel(),\n      performance: new PerformancePanel(),\n      export: new ExportPanel(),\n      rules: new RulesPanel(),\n      packs: new PacksPanel(),\n      overlays: new OverlaysPanel(), // ADDED\n      routing: new RoutingPanel(),\n      channelTrend: new ChannelTrendPanel(),\n      dataSources: new DataSourcePanel(),\n      validation: new ValidationPanel()\n    };\n\n    // FIXED: Only log panel creation once during construction\n    console.log('[MsdHudManager] Created panels:', Object.keys(this.panels));\n\n    this.state = {\n      visible: false,\n      activePanel: 'performance',\n      refreshRate: 2000,\n      lastRefresh: 0,\n      panelVisibility: {\n        issues: true,\n        flags: true,\n        performance: true,\n        export: true,\n        rules: true,\n        packs: true,\n        overlays: true, // ADDED (default visible)\n        routing: false,\n        channelTrend: false,\n        dataSources: false,\n        validation: false\n      },\n      panelOrder: ['issues','flags','performance','export','rules','packs','overlays','routing','channelTrend','dataSources','validation'], // UPDATED\n      compactMode: false,\n      autoPosition: true,\n      panelManagerOpen: false,\n      hudWidth: 420,\n      resizable: false,\n      // ADDED: Font and scaling options\n      fontSize: 14, // Base font size in pixels (default 14px)\n      hudScale: 1.0, // Overall HUD scale factor (0.8 - 1.5)\n      fontFamily: '\"Antonio\", monospace' // Font family with LCARS default + fallback\n    };\n\n    // FIXED: Only log state once during construction\n    console.log('[MsdHudManager] Initial panel order:', this.state.panelOrder);\n\n    this.hudElement = null;\n    this.refreshInterval = null;\n    this.mountElement = null;\n\n    this.dragState = {\n      isDragging: false,\n      startX: 0,\n      startY: 0,\n      startLeft: 0,\n      startTop: 0\n    };\n\n    this._setupGlobalPanelControls();\n    this.keyboardEnabled = true;\n    this._setupKeyboardShortcuts();\n\n    // ADDED: Provide bus to panels (optional future use)\n    Object.values(this.panels).forEach(p => { p.bus = this.bus; });\n\n    this._registerBusHandlers(); // ADDED\n    this.selection = new SelectionManager(this.bus); // ADDED\n    this._registerSelectionHandlers(); // ADDED\n\n    // ADDED: Bind core instance methods to prevent context loss in external handlers\n    this.show = this.show.bind(this);\n    this.hide = this.hide.bind(this);\n    this.toggle = this.toggle.bind(this);\n    this.refresh = this.refresh.bind(this);\n    this.setRefreshRate = this.setRefreshRate.bind(this);\n  }\n\n  // ADDED: Setup global panel control handlers\n  _setupGlobalPanelControls() {\n    if (window.__msdHudPanelControls) return;\n\n    const self = this;\n    window.__msdHudPanelControls = {\n      togglePanel: function(panelName) {\n        self.state.panelVisibility[panelName] = !self.state.panelVisibility[panelName];\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n      },\n\n      setCompactMode: function(enabled) {\n        self.state.compactMode = enabled;\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n      },\n\n      setAutoPosition: function(enabled) {\n        self.state.autoPosition = enabled;\n        if (enabled) {\n          self._autoPositionHud();\n        }\n      },\n\n      resetPanelLayout: function() {\n        // FIXED: Reset to default visibility including export panel\n        Object.keys(self.state.panelVisibility).forEach(panel => {\n          self.state.panelVisibility[panel] = ['issues', 'flags', 'performance', 'export'].includes(panel);\n        });\n        self.state.compactMode = false;\n        self.state.autoPosition = true;\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n        self._autoPositionHud();\n      },\n\n      movePanel: function(panelName, direction) {\n        const currentOrder = [...self.state.panelOrder];\n        const currentIndex = currentOrder.indexOf(panelName);\n\n        if (currentIndex === -1) return;\n\n        const newIndex = direction === 'up' ?\n          Math.max(0, currentIndex - 1) :\n          Math.min(currentOrder.length - 1, currentIndex + 1);\n\n        // Swap positions\n        [currentOrder[currentIndex], currentOrder[newIndex]] =\n        [currentOrder[newIndex], currentOrder[currentIndex]];\n\n        self.state.panelOrder = currentOrder;\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n      },\n\n      // ENHANCED: Set up panel manager toggle handler\n      togglePanelManager: function() {\n        self.state.panelManagerOpen = !self.state.panelManagerOpen;\n\n        const manager = document.getElementById('msd-panel-manager');\n        if (manager) {\n          manager.style.display = self.state.panelManagerOpen ? 'block' : 'none';\n\n          // FIXED: Always attach event listeners when toggling\n          if (self.state.panelManagerOpen) {\n            setTimeout(() => self._attachPanelManagerEventListeners(), 10);\n          }\n        }\n\n        console.log('[MsdHudManager] Panel manager toggled:', self.state.panelManagerOpen);\n      },\n\n      // ADDED: Close panel manager handler\n      closePanelManager: function() {\n        self.state.panelManagerOpen = false;\n\n        const manager = document.getElementById('msd-panel-manager');\n        if (manager) {\n          manager.style.display = 'none';\n        }\n\n        console.log('[MsdHudManager] Panel manager closed');\n      },\n\n      // ADDED: Font size controls\n      adjustFontSize: function(delta) {\n        // FIXED: Add throttling to prevent rapid multiple calls\n        if (self._fontSizeThrottle) return;\n        self._fontSizeThrottle = true;\n\n        setTimeout(() => {\n          self._fontSizeThrottle = false;\n        }, 200); // 200ms throttle\n\n        const newSize = Math.max(8, Math.min(20, self.state.fontSize + delta));\n        if (newSize !== self.state.fontSize) {\n          self.state.fontSize = newSize;\n          self._applyFontAndScale();\n          console.log(`[MsdHudManager] Font size adjusted to ${newSize}px`);\n        }\n      },\n\n      setFontSize: function(size) {\n        const newSize = Math.max(8, Math.min(20, parseInt(size) || 14));\n        if (newSize !== self.state.fontSize) {\n          self.state.fontSize = newSize;\n          self._applyFontAndScale();\n          console.log(`[MsdHudManager] Font size set to ${newSize}px`);\n        }\n      },\n\n      // ADDED: HUD scale controls\n      adjustHudScale: function(delta) {\n        // FIXED: Add throttling to prevent rapid multiple calls\n        if (self._scaleThrottle) return;\n        self._scaleThrottle = true;\n\n        setTimeout(() => {\n          self._scaleThrottle = false;\n        }, 200); // 200ms throttle\n\n        const newScale = Math.max(0.7, Math.min(2.0, self.state.hudScale + delta));\n        if (Math.abs(newScale - self.state.hudScale) > 0.05) {\n          self.state.hudScale = newScale;\n          self._applyFontAndScale();\n          console.log(`[MsdHudManager] HUD scale adjusted to ${newScale.toFixed(2)}x`);\n        }\n      },\n\n      setHudScale: function(scale) {\n        const newScale = Math.max(0.7, Math.min(2.0, parseFloat(scale) || 1.0));\n        if (Math.abs(newScale - self.state.hudScale) > 0.05) {\n          self.state.hudScale = newScale;\n          self._applyFontAndScale();\n          console.log(`[MsdHudManager] HUD scale set to ${newScale.toFixed(2)}x`);\n        }\n      },\n\n      // ADDED: Font family controls\n      setFontFamily: function(family) {\n        console.log(`[MsdHudManager] setFontFamily called with: \"${family}\"`);\n        const validFamilies = [\n          '\"Antonio\", monospace',\n          'monospace',\n          'sans-serif',\n          'serif',\n          '\"Courier New\", monospace',\n          '\"Roboto Mono\", monospace'\n        ];\n\n        // Handle HTML-encoded quotes and normalize\n        let normalizedFamily = family;\n        if (family.includes('&quot;')) {\n          normalizedFamily = family.replace(/&quot;/g, '\"');\n        }\n\n        console.log(`[MsdHudManager] Normalized font family: \"${normalizedFamily}\"`);\n\n        if (validFamilies.includes(normalizedFamily)) {\n          self.state.fontFamily = normalizedFamily;\n          self._applyFontAndScale();\n          // FIXED: Don't force a content update that might close dropdowns\n          // setTimeout(() => self.updateHudContent(), 50);\n          console.log(`[MsdHudManager] Font family successfully set to: ${normalizedFamily}`);\n        } else {\n          console.warn(`[MsdHudManager] Invalid font family: \"${family}\" (normalized: \"${normalizedFamily}\")`, {\n            validFamilies,\n            received: family,\n            normalized: normalizedFamily\n          });\n        }\n      }\n    };\n  }\n\n  // ADDED: Apply font size and scale changes\n  _applyFontAndScale() {\n    if (!this.hudElement) return;\n\n    const baseFontSize = this.state.fontSize;\n    const scale = this.state.hudScale;\n    const family = this.state.fontFamily;\n\n    // Apply transform and font changes to the main HUD element\n    this.hudElement.style.transform = `scale(${scale})`;\n    this.hudElement.style.transformOrigin = 'top left';\n    this.hudElement.style.fontFamily = family;\n    this.hudElement.style.fontSize = `${baseFontSize}px`;\n\n    // Adjust positioning if scaled to prevent clipping\n    if (scale !== 1.0) {\n      const rect = this.hudElement.getBoundingClientRect();\n      const scaledWidth = this.state.hudWidth * scale;\n      const scaledHeight = rect.height * scale;\n\n      // Ensure HUD doesn't go off-screen when scaled\n      const currentLeft = parseInt(this.hudElement.style.left) || 0;\n      const currentTop = parseInt(this.hudElement.style.top) || 0;\n\n      const maxLeft = window.innerWidth - scaledWidth - 10;\n      const maxTop = window.innerHeight - scaledHeight - 10;\n\n      if (currentLeft > maxLeft) {\n        this.hudElement.style.left = Math.max(10, maxLeft) + 'px';\n      }\n      if (currentTop > maxTop) {\n        this.hudElement.style.top = Math.max(10, maxTop) + 'px';\n      }\n    }\n\n    console.log(`[MsdHudManager] Applied font: ${baseFontSize}px ${family}, scale: ${scale}x`);\n  }\n\n  // ADDED: Auto-positioning logic\n  _autoPositionHud() {\n    if (!this.state.autoPosition || !this.hudElement) return;\n\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n    const hudWidth = this.state.hudWidth; // ENHANCED: Use configurable width\n\n    // Calculate optimal height based on visible panels\n    const visiblePanelCount = Object.values(this.state.panelVisibility).filter(Boolean).length;\n    const estimatedHeight = Math.min(\n      viewportHeight * 0.9, // ENHANCED: Increased from 0.85 to 0.9\n      200 + (visiblePanelCount * (this.state.compactMode ? 80 : 140)) // ENHANCED: Increased panel height estimate\n    );\n\n    // Check for Home Assistant header and sidebar\n    const haHeader = document.querySelector('app-header, ha-app-layout app-header');\n    const haSidebar = document.querySelector('ha-sidebar, app-drawer-layout ha-sidebar');\n\n    const headerHeight = haHeader ? haHeader.offsetHeight : 0;\n    const sidebarWidth = haSidebar && !haSidebar.hasAttribute('collapsed') ?\n      haSidebar.offsetWidth : 0;\n\n    // Smart positioning algorithm\n    let left, top;\n\n    // Try right side first (most common)\n    left = viewportWidth - hudWidth - 20;\n\n    // If sidebar takes up left space, ensure we don't overlap\n    if (sidebarWidth > 0 && left < sidebarWidth + 20) {\n      left = Math.max(sidebarWidth + 20, viewportWidth - hudWidth - 20);\n    }\n\n    // If still not enough space, try left side\n    if (left < 20) {\n      left = 20;\n    }\n\n    // Vertical positioning accounting for header\n    top = Math.max(headerHeight + 20, 20);\n\n    // Ensure bottom doesn't go off screen\n    if (top + estimatedHeight > viewportHeight - 20) {\n      top = Math.max(headerHeight + 20, viewportHeight - estimatedHeight - 20);\n    }\n\n    // ADDED: Smooth positioning transition\n    this.hudElement.style.transition = 'all 0.3s ease';\n    this.hudElement.style.left = left + 'px';\n    this.hudElement.style.top = top + 'px';\n    this.hudElement.style.right = 'auto';\n\n    // Remove transition after animation\n    setTimeout(() => {\n      this.hudElement.style.transition = '';\n    }, 300);\n\n    console.log(`[MsdHudManager] Auto-positioned to (${left}, ${top}) avoiding header:${headerHeight}px sidebar:${sidebarWidth}px`);\n  }\n\n  // ADDED: Handle window resize for auto-positioning\n  _setupResizeHandler() {\n    if (this._resizeSetup) return;\n    this._resizeSetup = true;\n\n    let resizeTimeout;\n    window.addEventListener('resize', () => {\n      if (this.state.autoPosition && this.state.visible) {\n        clearTimeout(resizeTimeout);\n        resizeTimeout = setTimeout(() => {\n          this._autoPositionHud();\n        }, 250);\n      }\n    });\n  }\n\n  /**\n   * Initialize with mount element from pipeline\n   * @param {HTMLElement} mountElement - Mount element from pipeline\n   */\n  init(mountElement) {\n    // Store mount element for pipeline context but don't use it for HUD mounting\n    this.mountElement = mountElement;\n\n    // ENHANCED: Store mount element in debug interface for panels to access\n    if (window.__msdDebug) {\n      window.__msdDebug.mountElement = mountElement;\n    }\n\n    // ADDED: Setup centralized debug status access for panels\n    this._setupDebugStatusHelper();\n\n    console.log('[MsdHudManager] Initialized with pipeline mount element reference');\n  }\n\n  // ADDED: Centralized debug status access for all panels\n  _setupDebugStatusHelper() {\n    if (window.__msdDebug?.getDebugStatusSilent) return; // Already setup\n\n    const W = typeof window !== 'undefined' ? window : {};\n    W.__msdDebug = W.__msdDebug || {};\n\n    W.__msdDebug.getDebugStatusSilent = function() {\n      try {\n        // Try debugManager first (preferred)\n        const pipelineInstance = W.__msdDebug?.pipelineInstance;\n        const debugManager = pipelineInstance?.systemsManager?.debugManager;\n        if (debugManager?.getSnapshot) {\n          return debugManager.getSnapshot();\n        }\n\n        // Fallback to debug._state directly (no console output)\n        const debug = W.__msdDebug?.debug;\n        if (debug?._state) {\n          return { ...debug._state };\n        }\n\n        // Last resort fallback\n        return { enabled: false, initialized: false };\n      } catch (e) {\n        return { enabled: false, initialized: false, error: e.message };\n      }\n    };\n  }\n\n  _registerBusHandlers() {\n    const { routing, performance, flags, export: exp, dataSources, issues, overlays } = this.panels;\n\n    // Routing\n    this.bus.on('routing:highlight', ({ id }) => routing?.highlightRoute?.(id));\n    this.bus.on('routing:analyze', ({ id }) => routing?.analyzeRoute?.(id));\n    this.bus.on('routing:set-filter', ({ key, value }) => routing?.setFilter?.(key, value));\n    this.bus.on('routing:update-cost', ({ key, value }) => routing?.updateCostFilter?.(key, value));\n    this.bus.on('routing:finalize-cost', () => routing?.finalizeCostFilter?.());\n    this.bus.on('routing:focus-set', ({ field, focus }) => routing?.setInputFocus?.(field, focus));\n\n    // Performance\n    this.bus.on('performance:clear-all', () => performance?.clearAllTimers?.());\n    this.bus.on('performance:export', () => performance?.exportData?.());\n    this.bus.on('performance:reset-timer', ({ timer }) => performance?.resetTimer?.(timer));\n    this.bus.on('performance:set-threshold', ({ timer, value }) => performance?.setThreshold?.(timer, value));\n\n    // Flags\n    this.bus.on('flags:toggle', ({ feature }) => flags?.toggleFeature?.(feature));\n    this.bus.on('flags:scale-adjust', ({ dir }) => flags?.adjustScale?.(dir));\n    this.bus.on('flags:scale-set', ({ scale }) => flags?.setScale?.(scale));\n    this.bus.on('flags:refresh', () => flags?.refreshDebug?.());\n\n    // Export\n    this.bus.on('export:collapsed', () => exp?.exportCollapsed?.());\n    this.bus.on('export:full', () => exp?.exportFull?.(false));\n    this.bus.on('export:full-meta', () => exp?.exportFull?.(true));\n    this.bus.on('export:copy', ({ type }) => exp?.copyToClipboard?.(type));\n    this.bus.on('export:clear', ({ type }) => exp?.clearTextarea?.(type));\n\n    // Data sources\n    this.bus.on('datasource:inspect', ({ id }) => dataSources?.inspectEntity?.(id));\n    this.bus.on('datasource:refresh-subs', () => dataSources?.refreshSubscriptions?.());\n    this.bus.on('datasource:clear-history', () => dataSources?.clearHistory?.());\n\n    // Issues\n    this.bus.on('issues:action', ({ action, id, overlay }) => issues?.handleIssueClick?.(action, id, overlay));\n\n    // ADDED: Overlay highlight bus\n    this.bus.on('overlay:highlight', ({ id }) => overlays?.highlightOverlay?.(id));\n    // ADDED: overlay analyze\n    this.bus.on('overlay:analyze', ({ id }) => overlays?.analyzeOverlay?.(id));\n\n    // Generic\n    this.bus.on('hud:refresh', () => this.refresh());\n\n    // ADDED: HUD settings controls\n    this.bus.on('refresh-rate:change', ({ value }) => {\n      console.log('[MsdHudManager] Refresh rate change event:', value);\n      const rate = parseInt(value);\n      if (!isNaN(rate) && rate > 0) {\n        this.setRefreshRate(rate);\n        console.log('[MsdHudManager] Refresh rate set to:', rate);\n      }\n    });\n\n    this.bus.on('width:adjust', ({ delta }) => {\n      console.log('[MsdHudManager] Width adjust event:', delta);\n      this.adjustWidth(parseInt(delta));\n    });\n\n    this.bus.on('font:adjust', ({ delta }) => {\n      console.log('[MsdHudManager] Font adjust event:', delta, 'throttled:', !!this._fontSizeThrottle);\n      window.__msdHudPanelControls?.adjustFontSize(parseInt(delta));\n    });\n\n    this.bus.on('scale:adjust', ({ delta }) => {\n      console.log('[MsdHudManager] Scale adjust event:', delta, 'throttled:', !!this._scaleThrottle);\n      window.__msdHudPanelControls?.adjustHudScale(parseFloat(delta));\n    });\n\n    this.bus.on('font-family:change', ({ value }) => {\n      console.log('[MsdHudManager] Font family change event:', value);\n      // FIXED: Add small delay to prevent event conflicts\n      setTimeout(() => {\n        window.__msdHudPanelControls?.setFontFamily(value);\n      }, 10);\n    });\n\n    this.bus.on('font:reset', () => {\n      console.log('[MsdHudManager] Font reset event');\n      this.state.fontSize = 14;\n      this.state.hudScale = 1.0;\n      this.state.fontFamily = '\"Antonio\", monospace';\n      this._applyFontAndScale();\n      this.updateHudContent();\n      console.log('[MsdHudManager] Font settings reset to defaults');\n    });\n  }\n\n  _registerSelectionHandlers() { // ADDED\n    this.bus.on('select:set', ({ type, id, source }) => {\n      this.selection.set(type, id, { source });\n      // Optional contextual highlight actions\n      if (type === 'route') {\n        this.bus.emit('routing:highlight', { id });\n      } else if (type === 'overlay') {\n        this.bus.emit('overlay:highlight', { id });\n      }\n      this.refresh();\n    });\n    this.bus.on('select:clear', () => {\n      this.selection.clear();\n      this.refresh();\n    });\n    // Passive listener to apply highlight after render\n    this.bus.on('select:changed', () => {\n      // If HUD already rendered, apply highlight without full refresh\n      this._applySelectionHighlight();\n      this._updateSelectionBadge();\n    });\n  }\n\n  _applySelectionHighlight() { // ADDED\n    if (!this.hudElement) return;\n    const sel = this.selection.get();\n    // Clear old\n    this.hudElement.querySelectorAll('.msd-selected').forEach(el => el.classList.remove('msd-selected'));\n    if (!sel) return;\n    // Match any element with matching data-select-type & id\n    const matches = this.hudElement.querySelectorAll(\n      `[data-select-type=\"${sel.type}\"][data-select-id=\"${CSS.escape(sel.id)}\"]`\n    );\n    matches.forEach(el => el.classList.add('msd-selected'));\n  }\n\n  _updateSelectionBadge() { // ADDED\n    if (!this.hudElement) return;\n    const badge = this.hudElement.querySelector('#msd-selection-badge');\n    if (!badge) return;\n    const sel = this.selection.get();\n    if (!sel) {\n      badge.innerHTML = '';\n      return;\n    }\n    badge.innerHTML = `\n      <span style=\"background:#222;border:1px solid #444;padding:2px 6px;border-radius:4px;font-size:10px;display:inline-flex;gap:6px;align-items:center;\">\n        <span style=\"color:#ffaa00;\">${sel.type}</span>\n        <span style=\"color:#00ffff;max-width:160px;overflow:hidden;text-overflow:ellipsis;\">${sel.id}</span>\n        <button data-bus-event=\"select:clear\"\n          onclick=\"__msdHudBus('select:clear')\"\n          style=\"background:#333;color:#ccc;border:1px solid #555;border-radius:3px;font-size:9px;cursor:pointer;padding:0 4px;\">\n          ✕\n        </button>\n      </span>\n    `;\n  }\n\n  // ADDED: Toggle collapse\n  togglePanelCollapse(panelName) {\n    this.state.collapsedPanels[panelName] = !this.state.collapsedPanels[panelName];\n    // Lightweight re-render (no data recapture)\n    this._applyCollapseState();\n  }\n\n  // ADDED: Toggle focus (exclusive view)\n  toggleFocusPanel(panelName) {\n    if (this.state.focusPanel === panelName) {\n      this.state.focusPanel = null;\n    } else {\n      this.state.focusPanel = panelName;\n    }\n    this.updateHudContent();\n  }\n\n  // ADDED: Apply collapse styling post-render\n  _applyCollapseState() {\n    if (!this.hudElement) return;\n    const wrappers = this.hudElement.querySelectorAll('.msd-hud-panel[data-panel]');\n    wrappers.forEach(w => {\n      const name = w.getAttribute('data-panel');\n      const collapsed = this.state.collapsedPanels[name];\n      if (collapsed) {\n        w.classList.add('collapsed');\n      } else {\n        w.classList.remove('collapsed');\n      }\n      // Update indicator symbol\n      const h3 = w.querySelector(':scope h3');\n      const ind = h3?.querySelector('.msd-collapse-indicator');\n      if (ind) ind.textContent = collapsed ? '+' : '−';\n      // Focus visibility\n      if (this.state.focusPanel && this.state.focusPanel !== name) {\n        w.classList.add('focus-hidden');\n      } else {\n        w.classList.remove('focus-hidden');\n      }\n      // Filter handling\n      if (this.state.filterTerm) {\n        const term = this.state.filterTerm.toLowerCase();\n        const matches = name.toLowerCase().includes(term);\n        if (!matches) {\n          w.classList.add('filter-hidden');\n        } else {\n          w.classList.remove('filter-hidden');\n        }\n      } else {\n        w.classList.remove('filter-hidden');\n      }\n    });\n    this._updateFocusBadgeInFooter();\n  }\n\n  // ADDED: Decorate panel headers after render\n  _decoratePanelHeaders() {\n    if (!this.hudElement) return;\n    const wrappers = this.hudElement.querySelectorAll('.msd-hud-panel[data-panel]');\n    wrappers.forEach(w => {\n      const name = w.getAttribute('data-panel');\n      const h3 = w.querySelector(':scope h3'); // first h3 inside nested structure\n      if (!h3 || h3.dataset.enhanced === '1') return;\n      h3.dataset.enhanced = '1';\n      h3.style.cursor = 'pointer';\n      // Insert collapse indicator\n      const indicator = document.createElement('span');\n      indicator.className = 'msd-collapse-indicator';\n      indicator.style.cssText = 'margin-left:6px;font-weight:bold;color:#ffaa00;';\n      indicator.textContent = this.state.collapsedPanels[name] ? '+' : '−';\n      h3.appendChild(indicator);\n      h3.title = 'Click: Collapse/Expand • Alt+Click: Focus panel';\n      h3.addEventListener('click', (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (e.altKey) {\n          this.toggleFocusPanel(name);\n        } else {\n          this.togglePanelCollapse(name);\n        }\n      });\n    });\n    this._applyCollapseState();\n  }\n\n  // ADDED: Footer focus badge update\n  _updateFocusBadgeInFooter() {\n    if (!this.hudElement) return;\n    const footerFocus = this.hudElement.querySelector('#msd-focus-footer');\n    if (!footerFocus) return;\n    if (!this.state.focusPanel) {\n      footerFocus.innerHTML = '';\n      return;\n    }\n    footerFocus.innerHTML = `\n      <span style=\"background:#222;border:1px solid #444;padding:2px 6px;border-radius:4px;font-size:9px;\">\n        Focus: <strong style=\"color:#ffaa00;\">${this.state.focusPanel}</strong>\n        <button style=\"margin-left:6px;font-size:9px;background:#333;color:#ccc;border:1px solid #555;border-radius:3px;cursor:pointer;padding:0 4px;\"\n          onclick=\"__msdHudBus && window.__msdDebug?.hud?.manager?.toggleFocusPanel && window.__msdDebug.hud.manager.toggleFocusPanel('${this.state.focusPanel}')\">\n          Exit\n        </button>\n      </span>\n    `;\n  }\n\n  // ADDED: Quick filter apply (called on input)\n  setFilterTerm(term) {\n    this.state.filterTerm = term || '';\n    this._applyCollapseState();\n  }\n\n  createHudElement() {\n    if (this.hudElement) return;\n\n    // ENHANCED: Use configurable width and improved styling\n    this.hudElement = document.createElement('div');\n    this.hudElement.id = 'msd-debug-hud';\n    this.hudElement.style.cssText = `\n      position: fixed;\n      top: 10px;\n      right: 10px;\n      width: ${this.state.hudWidth}px;\n      max-height: 90vh;\n      background: rgba(0, 0, 0, 0.95);\n      border: 2px solid #00ffff;\n      border-radius: 8px;\n      color: #00ffff;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000000;\n      overflow-y: auto;\n      backdrop-filter: blur(10px);\n      box-shadow: 0 4px 20px rgba(0, 255, 255, 0.3);\n      cursor: move;\n      user-select: none;\n      ${this.state.resizable ? 'resize: horizontal; min-width: 300px; max-width: 600px;' : ''}\n    `;\n\n    // ADDED: Dragging functionality - only allow dragging from header\n    this.setupDragging();\n\n    // Mount to document.body for full screen access\n    document.body.appendChild(this.hudElement);\n    this.updateHudContent();\n\n    this._attachDelegatedEvents(); // ADDED\n  }\n\n  _attachDelegatedEvents() {\n    if (this._delegatedEventsAttached || !this.hudElement) return;\n    this._delegatedEventsAttached = true;\n\n    const mapEvent = (domEvent) => {\n      this.hudElement.addEventListener(domEvent, (e) => {\n        const target = e.target.closest('[data-bus-event]');\n        if (!target || !this.hudElement.contains(target)) return;\n\n        // FIXED: For select elements, only handle 'change' events, not 'click' or 'input'\n        if (target.tagName === 'SELECT' && domEvent !== 'change') {\n          return; // Don't handle click/input events on select elements\n        }\n\n        // FIXED: For buttons, only handle 'click' events to prevent multiple firing\n        if (target.tagName === 'BUTTON' && domEvent !== 'click') {\n          return; // Don't handle other events on buttons\n        }\n\n        // FIXED: Prevent multiple event handling\n        e.preventDefault();\n        e.stopPropagation();\n\n        // Build payload from data-* excluding busEvent\n        const { busEvent, ...rest } = Object.fromEntries(\n          Object.entries(target.dataset).map(([k, v]) => [k.replace(/-[a-z]/g, m => m[1].toUpperCase()), v])\n        );\n\n        // For select elements, add the selected value\n        if (target.tagName === 'SELECT') {\n          rest.value = target.value;\n        }\n\n        // Numeric coercion for simple numbers\n        Object.keys(rest).forEach(k => {\n          if (/^-?\\d+(\\.\\d+)?$/.test(rest[k])) rest[k] = Number(rest[k]);\n        });\n\n        console.log(`[MsdHudManager] Bus event: ${target.dataset.busEvent}`, rest);\n        this.bus.emit(target.dataset.busEvent, rest);\n      }, true);\n    };\n\n    ['click', 'change', 'input', 'blur', 'focus'].forEach(mapEvent);\n    // ADDED: Direct listener for filter input (outside data-bus-event)\n    this.hudElement.addEventListener('input', (e) => {\n      const el = e.target;\n      if (el && el.id === 'msd-hud-filter') {\n        this.setFilterTerm(el.value);\n      }\n    }, true);\n  }\n\n  updateHudContent() {\n    if (!this.hudElement) return;\n\n    // Skip update if routing panel inputs are focused to prevent refresh interference\n    if (this.panels.routing?.shouldSkipRefresh?.()) {\n      return;\n    }\n\n    // FIXED: Skip update if any dropdown is currently open\n    const openDropdowns = this.hudElement.querySelectorAll('select:focus, select:focus-within');\n    if (openDropdowns.length > 0) {\n      console.log('[MsdHudManager] Skipping refresh - dropdown is open');\n      return;\n    }\n\n    // FIXED: Preserve panel manager state without logging every refresh\n    const wasManagerOpen = this.state.panelManagerOpen;\n\n    const data = {};\n\n    // Capture data from all panels\n    Object.entries(this.panels).forEach(([panelName, panel]) => {\n      try {\n        if (panel.captureData) {\n          data[panelName] = panel.captureData();\n        }\n      } catch (error) {\n        console.warn(`[MsdHudManager] Panel ${panelName} data capture failed:`, error);\n        data[panelName] = { error: error.message };\n      }\n    });\n\n    // Update timestamp\n    this.state.lastRefresh = Date.now();\n\n    // Render HTML\n    try {\n      const html = this.renderHudHtml(data);\n      this.hudElement.innerHTML = html;\n\n      // Apply compact mode class\n      if (this.state.compactMode) {\n        this.hudElement.classList.add('msd-hud-compact');\n      } else {\n        this.hudElement.classList.remove('msd-hud-compact');\n      }\n\n      this._attachPanelManagerEventListeners();\n      // ADDED: Apply selection highlight & badge after render\n      this._updateSelectionBadge();\n      this._applySelectionHighlight();\n      // REMOVED: _decoratePanelHeaders(), filter value restore, collapse/focus logic\n      // Reset filter input value after render\n      const f = this.hudElement.querySelector('#msd-hud-filter');\n      if (f && f.value !== this.state.filterTerm) f.value = this.state.filterTerm;\n\n      // Restore panel manager state after render\n      if (wasManagerOpen) {\n        this.state.panelManagerOpen = true;\n        const manager = document.getElementById('msd-panel-manager');\n        if (manager) {\n          manager.style.display = 'block';\n        }\n      }\n    } catch (error) {\n      console.error('[MsdHudManager] HUD render failed:', error);\n      this.hudElement.innerHTML = `\n        <div class=\"msd-hud-header\">\n          <span class=\"msd-hud-title\">MSD Debug HUD - Error</span>\n          <span class=\"msd-hud-close\" onclick=\"window.__msdDebug?.hud?.hide?.()\" title=\"Close\">✕</span>\n        </div>\n        <div style=\"padding:8px;color:#ff6666;\">\n          Render failed: ${error.message}\n        </div>\n      `;\n    }\n  }\n\n  renderHudHtml(data) {\n    const compactClass = this.state.compactMode ? 'msd-hud-compact' : '';\n\n    // ADDED: Calculate proportional font sizes based on base font size\n    const baseFontSize = this.state.fontSize;\n    const titleFontSize = Math.round(baseFontSize * 1.17); // 14px when base is 12px\n    const compactTitleFontSize = Math.round(baseFontSize * 1.0); // 12px when base is 12px\n    const sectionFontSize = Math.round(baseFontSize * 1.0); // 12px when base is 12px\n    const metricFontSize = Math.round(baseFontSize * 0.92); // 11px when base is 12px\n    const controlsFontSize = Math.round(baseFontSize * 0.83); // 10px when base is 12px\n    const smallFontSize = Math.round(baseFontSize * 0.75); // 9px when base is 12px\n    const tinyFontSize = Math.round(baseFontSize * 0.67); // 8px when base is 12px\n\n    let html = `\n      <style>\n        #msd-debug-hud .msd-hud-header {\n          padding: 8px;\n          background: rgba(0,255,255,0.2);\n          border-bottom: 1px solid #00ffff;\n          display:flex;\n          justify-content:space-between;\n          align-items:center;\n          cursor:grab;\n        }\n        #msd-debug-hud .msd-hud-title { font-weight:bold; pointer-events:none; }\n        #msd-debug-hud .msd-hud-controls { font-size:${controlsFontSize}px; display:flex; gap:4px; }\n        #msd-debug-hud .msd-hud-close, #msd-debug-hud .msd-hud-refresh, #msd-debug-hud .msd-hud-menu {\n          cursor:pointer; padding:2px 6px; border-radius:3px; pointer-events:auto;\n        }\n        #msd-debug-hud .msd-hud-close { background:rgba(255,0,0,0.7); }\n        #msd-debug-hud .msd-hud-refresh { background:rgba(0,255,0,0.7); }\n        #msd-debug-hud .msd-hud-menu { background:rgba(255,170,0,0.7); }\n        #msd-debug-hud .msd-hud-panel { padding:${this.state.compactMode ? '4px':'8px'}; border-bottom:1px solid rgba(0,255,255,0.3); }\n        #msd-debug-hud .msd-hud-panel.hidden { display:none; }\n        #msd-debug-hud .msd-hud-panel h3 {\n          margin:0 0 ${this.state.compactMode ? '4px':'8px'} 0;\n          color:#ffaa00; font-size:${this.state.compactMode ? compactTitleFontSize : titleFontSize}px;\n        }\n        #msd-debug-hud .msd-hud-section h4 { margin:6px 0 4px 0; color:#fff; font-size:${sectionFontSize}px; }\n        #msd-debug-hud .msd-hud-metric { display:flex; justify-content:space-between; margin:2px 0; font-size:${metricFontSize}px; }\n        #msd-debug-hud .msd-hud-metric-name { color:#aaa; }\n        #msd-debug-hud .msd-hud-metric-value { color:#0ff; font-weight:bold; }\n        #msd-debug-hud .msd-hud-error { border-left:3px solid #ff0000; padding-left:6px; }\n        #msd-debug-hud .msd-hud-warning { border-left:3px solid #ffaa00; padding-left:6px; }\n        #msd-debug-hud .msd-hud-success { color:#00ff00; font-size:${metricFontSize}px; text-align:center; padding:4px; }\n        #msd-debug-hud .msd-hud-summary { text-align:center; font-size:${metricFontSize}px; padding:4px; background:rgba(255,170,0,0.2); }\n        #msd-debug-hud .msd-selected { outline:2px solid #ffaa00; background:rgba(255,170,0,0.12)!important; position:relative; }\n        #msd-debug-hud .msd-selected::after { content:'●'; position:absolute; top:2px; right:4px; font-size:${tinyFontSize}px; color:#ffaa00; }\n        #msd-debug-hud .msd-panel-controls {\n          padding:6px 8px;\n          background:rgba(0,0,0,0.35);\n          border-bottom:1px solid rgba(0,255,255,0.25);\n          font-size:${controlsFontSize}px;\n        }\n        #msd-debug-hud .msd-panel-controls h4 {\n          margin:4px 0 6px;\n          font-size:${metricFontSize}px;\n          color:#ffaa00;\n        }\n        #msd-debug-hud .msd-panel-toggle-buttons {\n          display:flex;\n          flex-wrap:wrap;\n          gap:6px;\n          margin:4px 0 8px;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn {\n          cursor:pointer;\n          padding:3px 8px;\n          font-size:${controlsFontSize}px;\n          border:1px solid #044;\n          background:linear-gradient(#022,#011);\n          color:#0ff;\n          border-radius:14px;\n          line-height:1;\n          letter-spacing:.5px;\n          transition:all .18s;\n          position:relative;\n          pointer-events:auto;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn.active {\n          background:linear-gradient(#0ff,#066);\n          color:#000;\n          font-weight:bold;\n          box-shadow:0 0 6px #0ff;\n          border-color:#0aa;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn.inactive {\n          opacity:.45;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn:not(.active):hover {\n          opacity:.8;\n          border-color:#088;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn:focus {\n          outline:1px solid #0ff;\n        }\n        #msd-debug-hud .msd-panel-controls .msd-panel-meta {\n          font-size:${smallFontSize}px;\n          opacity:.65;\n          margin-top:2px;\n        }\n        #msd-debug-hud select, #msd-debug-hud button, #msd-debug-hud input {\n          pointer-events: auto !important;\n          cursor: pointer !important;\n        }\n        #msd-debug-hud select:hover, #msd-debug-hud button:hover {\n          opacity: 0.9;\n        }\n        /* ADDED: Scale form elements proportionally */\n        #msd-debug-hud select, #msd-debug-hud input {\n          font-size: ${smallFontSize}px !important;\n        }\n        #msd-debug-hud button {\n          font-size: ${smallFontSize}px !important;\n        }\n        /* ADDED: Scale footer text */\n        #msd-debug-hud .msd-footer {\n          font-size: ${controlsFontSize}px;\n        }\n        #msd-debug-hud .msd-footer-shortcuts {\n          font-size: ${smallFontSize}px;\n        }\n        #msd-debug-hud .msd-footer-debug {\n          font-size: ${tinyFontSize}px;\n        }\n      </style>\n    `;\n    html += `\n      <div class=\"msd-hud-header\">\n        <span class=\"msd-hud-title\">MSD v1 Debug HUD</span>\n        <div id=\"msd-selection-badge\" style=\"flex:1;display:flex;justify-content:center;\"></div>\n        <div class=\"msd-hud-controls\">\n          <span class=\"msd-hud-menu\" onclick=\"window.__msdHudPanelControls?.togglePanelManager?.()\" title=\"Panel Settings\">⚙</span>\n          <span class=\"msd-hud-refresh\" onclick=\"window.__msdDebug?.hud?.refresh?.()\" title=\"Refresh\">⟳</span>\n          <span class=\"msd-hud-close\" onclick=\"window.__msdDebug?.hud?.hide?.()\" title=\"Close\">✕</span>\n        </div>\n      </div>\n    `;\n    // REMOVED: filter bar / focus exit button\n    html += this._renderPanelControls();\n\n    // FIXED: Debug panel rendering with detailed logging\n    let renderedPanelCount = 0;\n    let visiblePanelCount = 0;\n\n    this.state.panelOrder.forEach(panelName => {\n      const panel = this.panels[panelName];\n      if (!panel) {\n        console.warn(`[MsdHudManager] Panel '${panelName}' not found in panels object`);\n        return;\n      }\n\n      const isVisible = this.state.panelVisibility[panelName];\n      const hiddenClass = isVisible ? '' : 'hidden';\n\n      if (isVisible) {\n        visiblePanelCount++;\n      }\n\n      try {\n        const panelData = data[panelName] || {};\n\n        const panelHtml = panel.renderHtml(panelData);\n\n        // Wrap panel with visibility control\n        html += `<div class=\"msd-hud-panel ${hiddenClass}\" data-panel=\"${panelName}\">\n          ${panelHtml}\n        </div>`;\n\n        renderedPanelCount++;\n      } catch (error) {\n        console.error(`[MsdHudManager] Panel ${panelName} render failed:`, error);\n        html += `<div class=\"msd-hud-panel ${hiddenClass}\" data-panel=\"${panelName}\">\n          <h3>${panelName} (Error)</h3>\n          <div class=\"msd-hud-section\">Panel render failed: ${error.message}</div>\n        </div>`;\n\n        renderedPanelCount++;\n      }\n    });\n\n    const refreshAge = Math.round((Date.now() - this.state.lastRefresh) / 1000);\n\n    // FIXED: Correct panel counting in footer with scaled font sizes\n    html += `<div class=\"msd-footer\" style=\"padding: 4px; text-align: center; color: #666; font-size: ${controlsFontSize}px;\">\n      ${visiblePanelCount}/${renderedPanelCount} panels visible • Updated ${refreshAge}s ago • ${this.state.refreshRate / 1000}s\n      <div class=\"msd-footer-shortcuts\" style=\"margin-top: 2px; opacity: 0.7; font-size: ${smallFontSize}px;\">\n        Shortcuts: Ctrl+H toggle • Ctrl+R refresh • Ctrl+P panels • Ctrl+K compact • 1-9 toggle panels\n      </div>\n      <div class=\"msd-footer-debug\" style=\"margin-top: 1px; opacity: 0.5; font-size: ${tinyFontSize}px;\">\n        Panels: [${this.state.panelOrder.join(', ')}] | Available: [${Object.keys(this.panels).join(', ')}]\n      </div>\n    </div>`;\n\n    return html;\n  }\n\n  // ADDED: Missing startRefresh method\n  startRefresh() {\n    this.stopRefresh(); // Clear any existing interval\n\n    if (this.state.refreshRate > 0) {\n      this.refreshInterval = setInterval(() => {\n        if (this.state.visible) {\n          this.updateHudContent();\n        }\n      }, this.state.refreshRate);\n    }\n  }\n\n  // ADDED: Missing stopRefresh method\n  stopRefresh() {\n    if (this.refreshInterval) {\n      clearInterval(this.refreshInterval);\n      this.refreshInterval = null;\n    }\n  }\n\n  // ADDED: Missing toggle method\n  toggle() {\n    // FIXED: Harden against lost context (runtime \"this.show is not a function\")\n    if (!this || !this.state) return;\n    const isVisible = !!this.state.visible;\n    if (isVisible) {\n      if (typeof this.hide === 'function') this.hide();\n    } else {\n      if (typeof this.show === 'function') this.show();\n    }\n  }\n\n  // ADDED: Missing setRefreshRate method\n  setRefreshRate(rate) {\n    const numRate = parseInt(rate);\n    if (isNaN(numRate) || numRate < 0) return;\n\n    this.state.refreshRate = numRate;\n\n    if (this.state.visible) {\n      this.startRefresh(); // Restart with new rate\n    }\n  }\n\n  // ADDED: Dragging implementation\n  setupDragging() {\n    const startDrag = (e) => {\n      // FIXED: Be very specific about dragging - only from header title area\n      const isValidDragArea = e.target.classList.contains('msd-hud-title') ||\n                             (e.target.closest('.msd-hud-header') &&\n                              !e.target.closest('.msd-hud-controls') &&\n                              !e.target.closest('select') &&\n                              !e.target.closest('button') &&\n                              !e.target.tagName === 'SELECT' &&\n                              !e.target.tagName === 'BUTTON');\n\n      if (!isValidDragArea) {\n        return; // Only allow dragging from the title or safe header areas\n      }\n\n      e.preventDefault();\n      e.stopPropagation(); // Prevent other event handlers\n\n      this.dragState.isDragging = true;\n      this.dragState.startX = e.clientX;\n      this.dragState.startY = e.clientY;\n\n      const rect = this.hudElement.getBoundingClientRect();\n      this.dragState.startLeft = rect.left;\n      this.dragState.startTop = rect.top;\n\n      this.hudElement.style.cursor = 'grabbing';\n      document.addEventListener('mousemove', handleDrag);\n      document.addEventListener('mouseup', endDrag);\n    };\n\n    const handleDrag = (e) => {\n      if (!this.dragState.isDragging) return;\n\n      const deltaX = e.clientX - this.dragState.startX;\n      const deltaY = e.clientY - this.dragState.startY;\n\n      let newLeft = this.dragState.startLeft + deltaX;\n      let newTop = this.dragState.startTop + deltaY;\n\n      // Constrain to viewport\n      const rect = this.hudElement.getBoundingClientRect();\n      newLeft = Math.max(0, Math.min(window.innerWidth - rect.width, newLeft));\n      newTop = Math.max(0, Math.min(window.innerHeight - rect.height, newTop));\n\n      this.hudElement.style.left = newLeft + 'px';\n      this.hudElement.style.top = newTop + 'px';\n      this.hudElement.style.right = 'auto'; // Remove right positioning\n    };\n\n    const endDrag = () => {\n      this.dragState.isDragging = false;\n      this.hudElement.style.cursor = 'move';\n      document.removeEventListener('mousemove', handleDrag);\n      document.removeEventListener('mouseup', endDrag);\n    };\n\n    this.hudElement.addEventListener('mousedown', startDrag);\n  }\n\n  // ADDED: Manual refresh capability\n  refresh() {\n    if (this.state.visible && this.hudElement) {\n      this.updateHudContent();\n      console.log('[MsdHudManager] Manual refresh triggered');\n    }\n  }\n\n  // ADDED: Render panel controls interface\n  _renderPanelControls() {\n    // ADDED: Calculate proportional font sizes for panel controls\n    const baseFontSize = this.state.fontSize;\n    const smallFontSize = Math.round(baseFontSize * 0.75); // 9px when base is 12px\n\n    let html = `<div class=\"msd-panel-controls\" id=\"msd-panel-manager\" style=\"display:${this.state.panelManagerOpen ? 'block':'none'};\">\n      <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;\">\n        <strong style=\"letter-spacing:.5px;\">Panel Settings</strong>\n        <div style=\"display:flex;gap:4px;\">\n          <button data-action=\"compact\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:${this.state.compactMode ? '#ffaa00':'#222'};color:${this.state.compactMode ? '#000':'#ccc'};border:1px solid #555;border-radius:4px;cursor:pointer;\">\n            Compact\n          </button>\n          <button data-action=\"reset\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#333;color:#ccc;border:1px solid #555;border-radius:4px;cursor:pointer;\">\n            Reset\n          </button>\n          <button data-action=\"close\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#ff4444;color:#fff;border:1px solid #a00;border-radius:4px;cursor:pointer;\">\n            ✕\n          </button>\n        </div>\n      </div>\n      <div class=\"msd-panel-toggle-buttons\">`;\n\n    this.state.panelOrder.forEach(panelName => {\n      const enabled = !!this.state.panelVisibility[panelName];\n      html += `<button\n        class=\"msd-panel-toggle-btn ${enabled ? 'active':'inactive'}\"\n        data-panel-toggle=\"${panelName}\"\n        aria-pressed=\"${enabled}\"\n        title=\"Toggle ${panelName} panel\">\n        ${panelName}\n      </button>`;\n    });\n\n    html += `</div>\n      <div style=\"display:flex;align-items:center;gap:6px;margin-top:4px;\">\n        <label style=\"font-size:${smallFontSize}px;opacity:.75;\">Refresh:</label>\n        <select id=\"msd-hud-refresh-rate\" name=\"refresh-rate\" data-bus-event=\"refresh-rate:change\"\n          style=\"font-size:${smallFontSize}px;background:#111;color:#0ff;border:1px solid #044;padding:2px 4px;border-radius:4px;\">\n          <option value=\"1000\" ${this.state.refreshRate===1000?'selected':''}>1s</option>\n          <option value=\"2000\" ${this.state.refreshRate===2000?'selected':''}>2s</option>\n          <option value=\"5000\" ${this.state.refreshRate===5000?'selected':''}>5s</option>\n          <option value=\"10000\" ${this.state.refreshRate===10000?'selected':''}>10s</option>\n        </select>\n        <div style=\"margin-left:auto;display:flex;gap:4px;\">\n          <button data-bus-event=\"width:adjust\" data-delta=\"-20\" title=\"Narrower\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">◀</button>\n          <button data-bus-event=\"width:adjust\" data-delta=\"20\" title=\"Wider\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">▶</button>\n        </div>\n      </div>\n\n      <div style=\"display:flex;align-items:center;gap:6px;margin-top:6px;padding-top:4px;border-top:1px solid rgba(0,255,255,0.2);\">\n        <label style=\"font-size:${smallFontSize}px;opacity:.75;\">Font Size:</label>\n        <button data-bus-event=\"font:adjust\" data-delta=\"-1\" title=\"Smaller Font\"\n          style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">A-</button>\n        <span style=\"font-size:${smallFontSize}px;color:#ffaa00;min-width:28px;text-align:center;\">${this.state.fontSize}px</span>\n        <button data-bus-event=\"font:adjust\" data-delta=\"1\" title=\"Larger Font\"\n          style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">A+</button>\n\n        <div style=\"margin-left:8px;display:flex;align-items:center;gap:4px;\">\n          <label style=\"font-size:${smallFontSize}px;opacity:.75;\">Scale:</label>\n          <button data-bus-event=\"scale:adjust\" data-delta=\"-0.1\" title=\"Scale Down\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">-</button>\n          <span style=\"font-size:${smallFontSize}px;color:#ffaa00;min-width:32px;text-align:center;\">${this.state.hudScale.toFixed(1)}x</span>\n          <button data-bus-event=\"scale:adjust\" data-delta=\"0.1\" title=\"Scale Up\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">+</button>\n        </div>\n      </div>\n\n      <div style=\"display:flex;align-items:center;gap:6px;margin-top:4px;\">\n        <label style=\"font-size:${smallFontSize}px;opacity:.75;\">Font:</label>\n        <select id=\"msd-hud-font-family\" name=\"font-family\" data-bus-event=\"font-family:change\"\n          style=\"font-size:${smallFontSize}px;background:#111;color:#0ff;border:1px solid #044;padding:2px 4px;border-radius:4px;flex:1;\">\n          <option value=\"&quot;Antonio&quot;, monospace\" ${this.state.fontFamily==='\"Antonio\", monospace'?'selected':''}>Antonio (LCARS)</option>\n          <option value=\"monospace\" ${this.state.fontFamily==='monospace'?'selected':''}>Monospace</option>\n          <option value=\"sans-serif\" ${this.state.fontFamily==='sans-serif'?'selected':''}>Sans-serif</option>\n          <option value=\"serif\" ${this.state.fontFamily==='serif'?'selected':''}>Serif</option>\n          <option value=\"&quot;Courier New&quot;, monospace\" ${this.state.fontFamily==='\"Courier New\", monospace'?'selected':''}>Courier New</option>\n          <option value=\"&quot;Roboto Mono&quot;, monospace\" ${this.state.fontFamily==='\"Roboto Mono\", monospace'?'selected':''}>Roboto Mono</option>\n        </select>\n        <button data-bus-event=\"font:reset\" title=\"Reset Font Settings\"\n          style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#333;color:#ccc;border:1px solid #555;border-radius:4px;cursor:pointer;\">Reset</button>\n      </div>      <div class=\"msd-panel-meta\">\n        Click buttons to toggle panels • Order: ${this.state.panelOrder.join(', ')}\n      </div>\n    </div>`;\n    return html;\n  }\n\n  _attachPanelManagerEventListeners() {\n    try {\n      const manager = document.getElementById('msd-panel-manager');\n      if (!manager) return;\n\n      const compactBtn = manager.querySelector('[data-action=\"compact\"]');\n      if (compactBtn) {\n        compactBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          window.__msdHudPanelControls?.setCompactMode(!this.state.compactMode);\n        };\n      }\n\n      const resetBtn = manager.querySelector('[data-action=\"reset\"]');\n      if (resetBtn) {\n        resetBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          window.__msdHudPanelControls?.resetPanelLayout();\n        };\n      }\n\n      const closeBtn = manager.querySelector('[data-action=\"close\"]');\n      if (closeBtn) {\n        closeBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          window.__msdHudPanelControls?.closePanelManager();\n        };\n      }\n\n      const toggleBtns = manager.querySelectorAll('[data-panel-toggle]');\n      toggleBtns.forEach(btn => {\n        const panelName = btn.getAttribute('data-panel-toggle');\n        if (panelName) {\n          btn.onclick = (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            window.__msdHudPanelControls?.togglePanel(panelName);\n          };\n        }\n      });\n\n      // NOTE: Refresh rate, font controls, and width controls now use the event bus system\n      // No manual event listeners needed for dropdowns and buttons with data-bus-event\n    } catch (e) {\n      console.warn('[MsdHudManager] Failed to attach panel manager event listeners:', e);\n    }\n  }\n\n  adjustWidth(delta) {\n    const newWidth = Math.max(300, Math.min(600, this.state.hudWidth + delta));\n    if (newWidth !== this.state.hudWidth) {\n      this.state.hudWidth = newWidth;\n\n      if (this.hudElement) {\n        this.hudElement.style.width = newWidth + 'px';\n      }\n\n      console.log(`[MsdHudManager] HUD width adjusted to ${newWidth}px`);\n\n      setTimeout(() => this.updateHudContent(), 100);\n    }\n  }\n\n  // ADDED: Keyboard shortcut system\n  _setupKeyboardShortcuts() {\n    if (this._keyboardSetup) return;\n    this._keyboardSetup = true;\n\n    const self = this;\n    document.addEventListener('keydown', (e) => {\n      if (!self.keyboardEnabled || !self.state.visible) return;\n\n      // Only handle shortcuts when not in input fields\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;\n\n      // Ctrl/Cmd + specific keys for HUD control\n      if (e.ctrlKey || e.metaKey) {\n        switch (e.key.toLowerCase()) {\n          case 'h':\n            e.preventDefault();\n            self.toggle();\n            break;\n\n          case 'r':\n            if (self.state.visible) {\n              e.preventDefault();\n              self.refresh();\n            }\n            break;\n\n          case 'p':\n            if (self.state.visible) {\n              e.preventDefault();\n              window.__msdHudPanelControls?.togglePanelManager?.();\n            }\n            break;\n\n          case 'k':\n            if (self.state.visible) {\n              e.preventDefault();\n              self.state.compactMode = !self.state.compactMode;\n              self.updateHudContent();\n            }\n            break;\n        }\n      }\n\n      // Number keys to toggle panels (1-9)\n      if (self.state.visible && !e.ctrlKey && !e.metaKey) {\n        const num = parseInt(e.key);\n        if (num >= 1 && num <= 9) {\n          const panelName = self.state.panelOrder[num - 1];\n          if (panelName) {\n            e.preventDefault();\n            window.__msdHudPanelControls?.togglePanel(panelName);\n          }\n        }\n      }\n    });\n\n    // Global shortcut to show HUD (Ctrl+Shift+H)\n    document.addEventListener('keydown', (e) => {\n      if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'h') {\n        e.preventDefault();\n        self.toggle();\n      }\n    });\n  }\n\n  // ADDED: Previously removed show() method (needed before binding in constructor)\n  show() {\n    if (this.state.visible) return;\n    this.state.visible = true;\n    this.createHudElement();\n    this.startRefresh();\n    this._setupResizeHandler();\n\n    // ADDED: Apply font and scale settings after creating HUD element\n    this._applyFontAndScale();\n\n    if (window.__msdDebug) {\n      window.__msdDebug.hud = {\n        manager: this,\n        refresh: () => this.refresh(),\n        hide: () => this.hide(),\n        show: () => this.show(),\n        toggle: () => this.toggle(),\n        setRefreshRate: (rate) => this.setRefreshRate(rate),\n        bus: this.bus\n      };\n    }\n    if (this.state.autoPosition) {\n      setTimeout(() => this._autoPositionHud(), 100);\n    }\n    console.log('[MsdHudManager] HUD activated and exposed globally');\n  }\n\n  // ADDED: Previously removed hide() method\n  hide() {\n    if (!this.state.visible) return;\n    this.state.visible = false;\n    this.stopRefresh();\n    if (this.hudElement) {\n      this.hudElement.remove();\n      this.hudElement = null;\n    }\n    console.log('[MsdHudManager] HUD deactivated');\n  }\n}\n","/**\n * RollingBuffer - Efficient circular buffer for time-series data\n *\n * Features:\n * - Fixed capacity with automatic overflow handling\n * - Time-based slicing for windowed data access\n * - Optimized for sparkline/ribbon real-time updates\n * - Memory efficient - no array reallocations during normal operation\n */\nexport class RollingBuffer {\n  constructor(capacity = 100) {\n    if (capacity < 1) {\n      throw new Error('RollingBuffer capacity must be at least 1');\n    }\n\n    // Cap capacity at reasonable maximum for memory efficiency\n    this.capacity = Math.min(capacity, 1000);\n\n    // Pre-allocate arrays for performance\n    this._timestamps = new Array(capacity);\n    this._values = new Array(capacity);\n\n    // Circular buffer state\n    this._head = 0;      // Next write position\n    this._size = 0;      // Current number of items\n    this._full = false;  // Whether we've wrapped around\n\n    // Performance tracking\n    this._stats = {\n      pushes: 0,\n      overwrites: 0,\n      queries: 0\n    };\n\n    // Add coalescing state\n    this._lastPushTime = 0;\n    this._coalescingThresholdMs = 10; // Coalesce pushes within 10ms\n  }\n\n  /**\n   * Add a new data point (timestamp, value)\n   * Automatically handles capacity overflow by replacing oldest data\n   */\n  push(timestamp, value) {\n    // Enhanced timestamp validation\n    const now = Date.now();\n    const oneYearAgo = now - (365 * 24 * 60 * 60 * 1000);\n    const oneHourFromNow = now + (60 * 60 * 1000);\n\n    // Check for reasonable timestamp range\n    if (timestamp < oneYearAgo || timestamp > oneHourFromNow) {\n      console.warn(`[RollingBuffer] Suspicious timestamp: ${timestamp} (${new Date(timestamp).toISOString()}), current: ${now} (${new Date(now).toISOString()})`);\n      // Don't reject, but log for debugging\n    }\n\n    // Validate inputs\n    if (!Number.isFinite(timestamp) || timestamp < 0) {\n      console.warn('[RollingBuffer] Invalid timestamp:', timestamp);\n      return;\n    }\n\n    if (typeof value !== 'number' || !isFinite(value)) {\n      console.warn(`[RollingBuffer] Invalid value: ${value} for timestamp ${timestamp}`);\n      return;\n    }\n\n    // AGGRESSIVE COALESCING: Skip if very recent push with similar timestamp\n    if (this._size > 0 && (now - this._lastPushTime) < this._coalescingThresholdMs) {\n      // Check if timestamp is very close to last timestamp\n      const lastIndex = this._head === 0 ? this.capacity - 1 : this._head - 1;\n      const lastTimestamp = this._timestamps[lastIndex];\n\n      if (Math.abs(timestamp - lastTimestamp) < 1000) { // Within 1 second\n        // COALESCE: Just update the value, don't add new point\n        this._values[lastIndex] = value;\n        this._stats.overwrites++; // Count as coalescence\n        this._lastPushTime = now;\n        return;\n      }\n    }\n\n    // Store at current head position\n    this._timestamps[this._head] = timestamp;\n    this._values[this._head] = value;\n\n    // Update statistics\n    this._stats.pushes++;\n    if (this._full) {\n      this._stats.overwrites++;\n    }\n\n    // Advance head pointer (circular)\n    this._head = (this._head + 1) % this.capacity;\n\n    // Update size tracking\n    if (this._size < this.capacity) {\n      this._size++;\n    } else {\n      this._full = true;\n    }\n\n    this._lastPushTime = now;\n\n    console.log(`[RollingBuffer] Added point: ${value} at ${new Date(timestamp).toISOString()} (buffer size: ${this._size})`);\n  }\n\n  /**\n   * Get data as parallel arrays { t: timestamps[], v: values[] }\n   * Returns data in chronological order (oldest first)\n   */\n  getArrays() {\n    this._stats.queries++;\n\n    if (this._size === 0) {\n      return { t: [], v: [] };\n    }\n\n    const t = new Array(this._size);\n    const v = new Array(this._size);\n\n    // Calculate start position (oldest data)\n    const startPos = this._full ? this._head : 0;\n\n    // Copy data in chronological order\n    for (let i = 0; i < this._size; i++) {\n      const bufferIndex = (startPos + i) % this.capacity;\n      t[i] = this._timestamps[bufferIndex];\n      v[i] = this._values[bufferIndex];\n    }\n\n    return { t, v };\n  }\n\n  /**\n   * Get all data points in chronological order\n   * @returns {Array} Array of {t: timestamp, v: value} objects\n   */\n  getAll() {\n    this._stats.queries++;\n\n    if (this._size === 0) {\n      return [];\n    }\n\n    const result = new Array(this._size);\n\n    // Calculate start position (oldest data)\n    const startPos = this._full ? this._head : 0;\n\n    // Copy data in chronological order\n    for (let i = 0; i < this._size; i++) {\n      const bufferIndex = (startPos + i) % this.capacity;\n      result[i] = {\n        t: this._timestamps[bufferIndex],\n        v: this._values[bufferIndex]\n      };\n    }\n\n    return result;\n  }\n\n  /**\n   * Get data points newer than specified time window (in milliseconds)\n   * @param {number} msWindow - Time window in milliseconds from now\n   * @returns {object} { t: timestamps[], v: values[] }\n   */\n  sliceSince(msWindow) {\n    this._stats.queries++;\n\n    if (this._size === 0 || !Number.isFinite(msWindow) || msWindow <= 0) {\n      return { t: [], v: [] };\n    }\n\n    const cutoffTime = Date.now() - msWindow;\n    const { t, v } = this.getArrays();\n\n    // Find first index where timestamp >= cutoffTime\n    let startIndex = 0;\n    for (let i = 0; i < t.length; i++) {\n      if (t[i] >= cutoffTime) {\n        startIndex = i;\n        break;\n      }\n    }\n\n    // Return slice from startIndex to end\n    return {\n      t: t.slice(startIndex),\n      v: v.slice(startIndex)\n    };\n  }\n\n  /**\n   * Get the most recent data point\n   * @returns {object|null} { t: timestamp, v: value } or null if empty\n   */\n  last() {\n    if (this._size === 0) {\n      return null;\n    }\n\n    // Most recent item is just before current head position\n    const lastIndex = this._head === 0 ? this.capacity - 1 : this._head - 1;\n\n    return {\n      t: this._timestamps[lastIndex],\n      v: this._values[lastIndex]\n    };\n  }\n\n  /**\n   * Get the oldest data point\n   * @returns {object|null} { t: timestamp, v: value } or null if empty\n   */\n  first() {\n    if (this._size === 0) {\n      return null;\n    }\n\n    const firstIndex = this._full ? this._head : 0;\n\n    return {\n      t: this._timestamps[firstIndex],\n      v: this._values[firstIndex]\n    };\n  }\n\n  /**\n   * Clear all data while preserving capacity\n   */\n  clear() {\n    this._head = 0;\n    this._size = 0;\n    this._full = false;\n\n    // Performance: don't actually clear arrays, just reset pointers\n    // Data will be naturally overwritten as new data comes in\n  }\n\n  /**\n   * Get current buffer statistics\n   */\n  getStats() {\n    return {\n      capacity: this.capacity,\n      size: this._size,\n      utilization: this._size / this.capacity,\n      pushes: this._stats.pushes,\n      overwrites: this._stats.overwrites,\n      queries: this._stats.queries,\n      overwriteRate: this._stats.pushes > 0 ? this._stats.overwrites / this._stats.pushes : 0\n    };\n  }\n\n  /**\n   * Check if buffer is at full capacity\n   */\n  isFull() {\n    return this._full;\n  }\n\n  /**\n   * Get number of items currently stored\n   */\n  size() {\n    return this._size;\n  }\n\n  /**\n   * Debug method: validate internal consistency\n   * @returns {boolean} true if consistent\n   */\n  _validateConsistency() {\n    const issues = [];\n\n    // Check size bounds\n    if (this._size < 0 || this._size > this.capacity) {\n      issues.push(`Invalid size: ${this._size} (capacity: ${this.capacity})`);\n    }\n\n    // Check head bounds\n    if (this._head < 0 || this._head >= this.capacity) {\n      issues.push(`Invalid head: ${this._head} (capacity: ${this.capacity})`);\n    }\n\n    // Check full flag consistency\n    if (this._full && this._size !== this.capacity) {\n      issues.push(`Full flag inconsistent: full=${this._full}, size=${this._size}, capacity=${this.capacity}`);\n    }\n\n    // Check timestamp ordering (within stored data)\n    if (this._size > 1) {\n      const { t } = this.getArrays();\n      for (let i = 1; i < t.length; i++) {\n        if (t[i] < t[i-1]) {\n          issues.push(`Timestamp ordering violation at index ${i}: ${t[i-1]} -> ${t[i]}`);\n          break; // Only report first violation\n        }\n      }\n    }\n\n    if (issues.length > 0) {\n      console.warn('[RollingBuffer] Consistency issues:', issues);\n      return false;\n    }\n\n    return true;\n  }\n}\n","/**\n * TransformationProcessor - Base class for data transformations\n *\n * Features:\n * - Chainable transformations with configurable keys\n * - Type-safe transformation pipeline\n * - Error handling and fallback values\n * - Performance tracking\n */\n\nexport class TransformationProcessor {\n  constructor(config) {\n    this.config = { ...config };\n    this.key = config.key || this.constructor.name.toLowerCase();\n    this.enabled = config.enabled !== false;\n\n    // Performance tracking\n    this._stats = {\n      transformations: 0,\n      errors: 0,\n      totalTime: 0\n    };\n  }\n\n  /**\n   * Transform a value with timing and error handling\n   * @param {number} value - Input value\n   * @param {number} timestamp - Current timestamp\n   * @param {RollingBuffer} buffer - Historical data buffer\n   * @returns {number|null} Transformed value or null on error\n   */\n  transform(value, timestamp, buffer) {\n    if (!this.enabled) return value;\n\n    const startTime = performance.now();\n\n    try {\n      const result = this._doTransform(value, timestamp, buffer);\n\n      this._stats.transformations++;\n      this._stats.totalTime += performance.now() - startTime;\n\n      return result;\n    } catch (error) {\n      this._stats.errors++;\n      console.warn(`[${this.constructor.name}] Transform failed:`, error);\n      return this._getFallbackValue(value);\n    }\n  }\n\n  /**\n   * Override this method in subclasses to implement transformation logic\n   * @protected\n   * @param {number} value - Input value\n   * @param {number} timestamp - Current timestamp\n   * @param {RollingBuffer} buffer - Historical data buffer\n   * @returns {number} Transformed value\n   */\n  _doTransform(value, timestamp, buffer) {\n    throw new Error('_doTransform must be implemented by subclasses');\n  }\n\n  /**\n   * Get fallback value on transformation error\n   * @protected\n   * @param {number} originalValue - Original input value\n   * @returns {number|null} Fallback value\n   */\n  _getFallbackValue(originalValue) {\n    return originalValue; // Default: return original value\n  }\n\n  /**\n   * Get transformation statistics\n   * @returns {Object} Statistics object\n   */\n  getStats() {\n    return {\n      ...this._stats,\n      key: this.key,\n      enabled: this.enabled,\n      avgTime: this._stats.transformations > 0 ?\n        this._stats.totalTime / this._stats.transformations : 0\n    };\n  }\n\n  /**\n   * Reset statistics\n   */\n  resetStats() {\n    this._stats = {\n      transformations: 0,\n      errors: 0,\n      totalTime: 0\n    };\n  }\n}\n\n/**\n * Unit Conversion Processor\n * Converts between different units using configurable factors or functions\n */\nexport class UnitConversionProcessor extends TransformationProcessor {\n  constructor(config) {\n    super(config);\n\n    // Predefined conversion factors\n    this.conversions = {\n      '°f_to_°c': (f) => (f - 32) * 5/9,\n      'f_to_c': (f) => (f - 32) * 5/9,\n      '°c_to_°f': (c) => (c * 9/5) + 32,\n      'c_to_f': (c) => (c * 9/5) + 32,\n      'w_to_kw': (w) => w / 1000,\n      'kw_to_w': (kw) => kw * 1000,\n      'kb_to_mb': (kb) => kb / 1024,\n      'mb_to_gb': (mb) => mb / 1024\n    };\n\n    this.fromUnit = config.from?.toLowerCase();\n    this.toUnit = config.to?.toLowerCase();\n    this.factor = config.factor;\n    this.offset = config.offset || 0;\n    this.customFunction = config.customFunction;\n  }  _doTransform(value, timestamp, buffer) {\n    if (!Number.isFinite(value)) return null;\n\n    // Custom function takes precedence\n    if (this.customFunction && typeof this.customFunction === 'function') {\n      return this.customFunction(value);\n    }\n\n    // Try multiple conversion key formats\n    const conversionKeys = [\n      `${this.fromUnit}_to_${this.toUnit}`,\n      `${this.fromUnit.replace(/°/g, '')}_to_${this.toUnit.replace(/°/g, '')}`,\n      `${this.fromUnit.replace(/[°\\s]/g, '')}_to_${this.toUnit.replace(/[°\\s]/g, '')}`\n    ];\n\n    for (const conversionKey of conversionKeys) {\n      if (this.conversions[conversionKey]) {\n        return this.conversions[conversionKey](value);\n      }\n    }\n\n    // Simple factor conversion\n    if (Number.isFinite(this.factor)) {\n      return (value * this.factor) + this.offset;\n    }\n\n    throw new Error(`No conversion method available for ${this.fromUnit} to ${this.toUnit}. Available: ${Object.keys(this.conversions).join(', ')}`);\n  }\n}\n\n/**\n * Scale/Range Processor\n * Maps input values from one range to another range\n */\nexport class ScaleProcessor extends TransformationProcessor {\n  constructor(config) {\n    super(config);\n\n    this.inputRange = config.input_range || config.inputRange || [0, 100];\n    this.outputRange = config.output_range || config.outputRange || [0, 1];\n    this.clamp = config.clamp !== false; // Default to true\n\n    if (!Array.isArray(this.inputRange) || this.inputRange.length !== 2) {\n      throw new Error('input_range must be an array of 2 numbers');\n    }\n    if (!Array.isArray(this.outputRange) || this.outputRange.length !== 2) {\n      throw new Error('output_range must be an array of 2 numbers');\n    }\n  }\n\n  _doTransform(value, timestamp, buffer) {\n    if (!Number.isFinite(value)) return null;\n\n    const [inMin, inMax] = this.inputRange;\n    const [outMin, outMax] = this.outputRange;\n\n    // Clamp input if enabled\n    let inputValue = this.clamp ?\n      Math.max(inMin, Math.min(inMax, value)) : value;\n\n    // Linear interpolation\n    const ratio = (inputValue - inMin) / (inMax - inMin);\n    return outMin + ratio * (outMax - outMin);\n  }\n}\n\n/**\n * Smoothing Processor\n * Applies various smoothing algorithms to reduce noise\n */\nexport class SmoothingProcessor extends TransformationProcessor {\n  constructor(config) {\n    super(config);\n\n    this.method = config.method || 'exponential';\n    this.alpha = config.alpha || 0.3; // For exponential smoothing\n    this.windowSize = config.window_size || config.windowSize || 5; // For moving average\n\n    // State for smoothing algorithms\n    this._lastSmoothed = null;\n    this._window = [];\n  }\n\n  _doTransform(value, timestamp, buffer) {\n    if (!Number.isFinite(value)) return null;\n\n    switch (this.method) {\n      case 'exponential':\n        return this._exponentialSmooth(value);\n\n      case 'moving_average':\n        return this._movingAverage(value);\n\n      case 'median':\n        return this._medianFilter(value);\n\n      default:\n        throw new Error(`Unknown smoothing method: ${this.method}`);\n    }\n  }\n\n  _exponentialSmooth(value) {\n    if (this._lastSmoothed === null) {\n      this._lastSmoothed = value;\n      return value;\n    }\n\n    this._lastSmoothed = this.alpha * value + (1 - this.alpha) * this._lastSmoothed;\n    return this._lastSmoothed;\n  }\n\n  _movingAverage(value) {\n    this._window.push(value);\n\n    if (this._window.length > this.windowSize) {\n      this._window.shift();\n    }\n\n    const sum = this._window.reduce((acc, val) => acc + val, 0);\n    return sum / this._window.length;\n  }\n\n  _medianFilter(value) {\n    this._window.push(value);\n\n    if (this._window.length > this.windowSize) {\n      this._window.shift();\n    }\n\n    const sorted = [...this._window].sort((a, b) => a - b);\n    const mid = Math.floor(sorted.length / 2);\n\n    return sorted.length % 2 === 0 ?\n      (sorted[mid - 1] + sorted[mid]) / 2 :\n      sorted[mid];\n  }\n}\n\n/**\n * Expression Processor\n * Evaluates JavaScript expressions with context\n */\nexport class ExpressionProcessor extends TransformationProcessor {\n  constructor(config) {\n    super(config);\n\n    this.expression = config.expression;\n    if (!this.expression) {\n      throw new Error('Expression is required for ExpressionProcessor');\n    }\n\n    // Pre-compile the expression for performance\n    try {\n      this._compiledFunction = new Function('value', 'timestamp', 'buffer', 'Math', `\n        \"use strict\";\n        return (${this.expression});\n      `);\n    } catch (error) {\n      throw new Error(`Failed to compile expression: ${error.message}`);\n    }\n  }\n\n  _doTransform(value, timestamp, buffer) {\n    if (!Number.isFinite(value)) return null;\n\n    try {\n      const result = this._compiledFunction(value, timestamp, buffer, Math);\n      return Number.isFinite(result) ? result : null;\n    } catch (error) {\n      throw new Error(`Expression evaluation failed: ${error.message}`);\n    }\n  }\n}\n\n/**\n * Create a transformation processor from configuration\n * @param {Object} config - Transformation configuration\n * @returns {TransformationProcessor} Configured processor instance\n */\nexport function createTransformationProcessor(config) {\n  if (!config || !config.type) {\n    throw new Error('Transformation config must specify a type');\n  }\n\n  switch (config.type) {\n    case 'unit_conversion':\n      return new UnitConversionProcessor(config);\n\n    case 'scale':\n      return new ScaleProcessor(config);\n\n    case 'smooth':\n      return new SmoothingProcessor(config);\n\n    case 'expression':\n      return new ExpressionProcessor(config);\n\n    default:\n      throw new Error(`Unknown transformation type: ${config.type}`);\n  }\n}","/**\n * AggregationProcessor - Base class for data aggregations\n *\n * Features:\n * - Runtime-only aggregations (no persistence)\n * - Time-windowed calculations\n * - Memory-efficient for MSD page lifecycles\n * - Configurable reset behavior\n */\n\nexport class AggregationProcessor {\n  constructor(type, config) {\n    this.type = type;\n    this.config = { ...config };\n    this.key = config.key || type;\n    this.enabled = config.enabled !== false;\n\n    // Parse time window if specified\n    this.windowMs = this._parseTimeWindow(config.window);\n    this.maxAge = this.windowMs || (24 * 60 * 60 * 1000); // Default 24h max\n\n    // Internal state\n    this._values = [];\n    this._lastUpdate = 0;\n    this._result = null;\n\n    // Performance tracking\n    this._stats = {\n      updates: 0,\n      calculations: 0,\n      resets: 0\n    };\n  }\n\n  /**\n   * Update aggregation with new value\n   * @param {number} timestamp - Current timestamp\n   * @param {number} value - New value to aggregate\n   * @param {Object} transformedData - Any transformed values from the same update\n   */\n  update(timestamp, value, transformedData = {}) {\n    if (!this.enabled || !Number.isFinite(value)) return;\n\n    // Clean old values first\n    this._cleanOldValues(timestamp);\n\n    // Add new value\n    this._values.push({ timestamp, value, transformed: transformedData });\n    this._lastUpdate = timestamp;\n    this._stats.updates++;\n\n    // Recalculate result\n    this._calculate();\n  }\n\n  /**\n   * Get current aggregation result\n   * @returns {any} Current aggregated value\n   */\n  getValue() {\n    return this._result;\n  }\n\n  /**\n   * Get aggregation statistics and metadata\n   * @returns {Object} Statistics object\n   */\n  getStats() {\n    return {\n      ...this._stats,\n      type: this.type,\n      key: this.key,\n      enabled: this.enabled,\n      valueCount: this._values.length,\n      windowMs: this.windowMs,\n      lastUpdate: this._lastUpdate,\n      currentResult: this._result\n    };\n  }\n\n  /**\n   * Reset aggregation state\n   */\n  reset() {\n    this._values = [];\n    this._result = null;\n    this._stats.resets++;\n  }\n\n  /**\n   * Clean values older than the window\n   * @private\n   * @param {number} currentTimestamp - Current timestamp\n   */\n  _cleanOldValues(currentTimestamp) {\n    if (!this.windowMs) return; // No window limit\n\n    const cutoffTime = currentTimestamp - this.windowMs;\n    const originalLength = this._values.length;\n\n    this._values = this._values.filter(item => item.timestamp >= cutoffTime);\n\n    if (this._values.length !== originalLength) {\n      this._stats.cleanedValues = (this._stats.cleanedValues || 0) +\n        (originalLength - this._values.length);\n    }\n  }\n\n  /**\n   * Parse time window string to milliseconds\n   * @private\n   * @param {string|number} window - Time window specification\n   * @returns {number|null} Window in milliseconds or null if unlimited\n   */\n  _parseTimeWindow(window) {\n    if (typeof window === 'number') return window;\n    if (typeof window !== 'string') return null;\n\n    const match = window.match(/^(\\d+(?:\\.\\d+)?)\\s*(s|sec|m|min|h|hr|d|day)s?$/i);\n    if (!match) return null;\n\n    const value = parseFloat(match[1]);\n    const unit = match[2].toLowerCase();\n\n    switch (unit) {\n      case 's':\n      case 'sec':\n        return value * 1000;\n      case 'm':\n      case 'min':\n        return value * 60 * 1000;\n      case 'h':\n      case 'hr':\n        return value * 60 * 60 * 1000;\n      case 'd':\n      case 'day':\n        return value * 24 * 60 * 60 * 1000;\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * Override this method in subclasses to implement aggregation logic\n   * @protected\n   */\n  _calculate() {\n    throw new Error('_calculate must be implemented by subclasses');\n  }\n}\n\n/**\n * Moving Average Aggregation\n * Calculates average over a time window or fixed number of samples\n */\nexport class MovingAverageAggregation extends AggregationProcessor {\n  constructor(config) {\n    super('moving_average', config);\n    this.maxSamples = config.max_samples || config.maxSamples;\n  }\n\n  _calculate() {\n    if (this._values.length === 0) {\n      this._result = null;\n      return;\n    }\n\n    // Limit by sample count if specified\n    let values = this._values;\n    if (this.maxSamples && values.length > this.maxSamples) {\n      values = values.slice(-this.maxSamples);\n    }\n\n    const sum = values.reduce((acc, item) => acc + item.value, 0);\n    this._result = sum / values.length;\n    this._stats.calculations++;\n  }\n}\n\n/**\n * Min/Max Aggregation\n * Tracks minimum and maximum values\n */\nexport class MinMaxAggregation extends AggregationProcessor {\n  constructor(config) {\n    super('min_max', config);\n    this.trackMin = config.min !== false;\n    this.trackMax = config.max !== false;\n    this.trackAvg = config.avg === true;\n  }\n\n  _calculate() {\n    if (this._values.length === 0) {\n      this._result = null;\n      return;\n    }\n\n    const values = this._values.map(item => item.value);\n    const result = {};\n\n    if (this.trackMin) {\n      result.min = Math.min(...values);\n    }\n\n    if (this.trackMax) {\n      result.max = Math.max(...values);\n    }\n\n    if (this.trackAvg) {\n      const sum = values.reduce((acc, val) => acc + val, 0);\n      result.avg = sum / values.length;\n    }\n\n    result.count = values.length;\n    this._result = result;\n    this._stats.calculations++;\n  }\n}\n\n/**\n * Rate of Change Aggregation\n * Calculates rate of change between values\n */\nexport class RateOfChangeAggregation extends AggregationProcessor {\n  constructor(config) {\n    super('rate_of_change', config);\n    this.unit = config.unit || 'per_second'; // per_second, per_minute, per_hour\n    this.smoothing = config.smoothing || false;\n  }\n\n  _calculate() {\n    if (this._values.length < 2) {\n      this._result = null;\n      return;\n    }\n\n    const recent = this._values.slice(-2);\n    const [prev, curr] = recent;\n\n    const timeDiff = (curr.timestamp - prev.timestamp) / 1000; // Convert to seconds\n    if (timeDiff <= 0) {\n      this._result = 0;\n      return;\n    }\n\n    const valueDiff = curr.value - prev.value;\n    let rate = valueDiff / timeDiff;\n\n    // Convert to requested unit\n    switch (this.unit) {\n      case 'per_minute':\n        rate *= 60;\n        break;\n      case 'per_hour':\n        rate *= 3600;\n        break;\n      // per_second is default, no conversion needed\n    }\n\n    this._result = rate;\n    this._stats.calculations++;\n  }\n}\n\n/**\n * Session Statistics Aggregation\n * Tracks statistics since page load/reset\n */\nexport class SessionStatsAggregation extends AggregationProcessor {\n  constructor(config) {\n    super('session_stats', config);\n    this._firstValue = null;\n    this._sessionStart = Date.now();\n  }\n\n  _calculate() {\n    if (this._values.length === 0) {\n      this._result = null;\n      return;\n    }\n\n    const values = this._values.map(item => item.value);\n    const timestamps = this._values.map(item => item.timestamp);\n\n    if (this._firstValue === null) {\n      this._firstValue = values[0];\n    }\n\n    const result = {\n      count: values.length,\n      min: Math.min(...values),\n      max: Math.max(...values),\n      avg: values.reduce((sum, val) => sum + val, 0) / values.length,\n      first: this._firstValue,\n      last: values[values.length - 1],\n      sessionDuration: (Date.now() - this._sessionStart) / 1000, // seconds\n      dataSpan: (timestamps[timestamps.length - 1] - timestamps[0]) / 1000 // seconds\n    };\n\n    this._result = result;\n    this._stats.calculations++;\n  }\n}\n\n/**\n * Recent Trend Aggregation\n * Analyzes recent trend direction\n */\nexport class RecentTrendAggregation extends AggregationProcessor {\n  constructor(config) {\n    super('recent_trend', config);\n    this.samples = config.samples || 5;\n    this.threshold = config.threshold || 0.01; // Minimum change to consider significant\n  }\n\n  _calculate() {\n    if (this._values.length < 2) {\n      this._result = { direction: 'unknown', strength: 0 };\n      return;\n    }\n\n    // Get recent samples\n    const recentValues = this._values.slice(-this.samples);\n    if (recentValues.length < 2) {\n      this._result = { direction: 'unknown', strength: 0 };\n      return;\n    }\n\n    // Simple linear regression\n    const n = recentValues.length;\n    const sumX = recentValues.reduce((sum, _, i) => sum + i, 0);\n    const sumY = recentValues.reduce((sum, item) => sum + item.value, 0);\n    const sumXY = recentValues.reduce((sum, item, i) => sum + i * item.value, 0);\n    const sumXX = recentValues.reduce((sum, _, i) => sum + i * i, 0);\n\n    const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);\n\n    let direction = 'stable';\n    if (Math.abs(slope) > this.threshold) {\n      direction = slope > 0 ? 'increasing' : 'decreasing';\n    }\n\n    this._result = {\n      direction,\n      strength: Math.abs(slope),\n      slope\n    };\n\n    this._stats.calculations++;\n  }\n}\n\n/**\n * Create aggregation processor from configuration\n * @param {string} type - Aggregation type\n * @param {Object} config - Aggregation configuration\n * @returns {AggregationProcessor} Configured processor instance\n */\nexport function createAggregationProcessor(type, config) {\n  switch (type) {\n    case 'moving_average':\n      return new MovingAverageAggregation(config);\n\n    case 'min_max':\n    case 'daily_stats':\n      return new MinMaxAggregation(config);\n\n    case 'rate_of_change':\n      return new RateOfChangeAggregation(config);\n\n    case 'session_stats':\n      return new SessionStatsAggregation(config);\n\n    case 'recent_trend':\n      return new RecentTrendAggregation(config);\n\n    default:\n      throw new Error(`Unknown aggregation type: ${type}`);\n  }\n}","/**\n * MsdDataSource - Complete port of cb-lcars-data.js DataSource functionality\n *\n * Provides real-time Home Assistant entity subscriptions with:\n * - Coalescing and throttling for performance\n * - History preload capability\n * - Rolling buffer management\n * - Identical API and behavior to original implementation\n */\n\nimport { RollingBuffer } from './RollingBuffer.js';\nimport { createTransformationProcessor } from './transformations/TransformationProcessor.js';\nimport { createAggregationProcessor } from './aggregations/AggregationProcessor.js';\n\n// Node.js polyfills for test environment\nconst isNode = typeof window === 'undefined';\nconst requestAnimationFrame = isNode\n  ? (callback) => setTimeout(callback, 16) // 60fps approximation\n  : window.requestAnimationFrame;\nconst cancelAnimationFrame = isNode\n  ? (id) => clearTimeout(id)\n  : window.cancelAnimationFrame;\n\nexport class MsdDataSource {\n  constructor(cfg, hass) {\n    this.cfg = { ...cfg };\n    this.hass = hass;\n\n    // Validate essential config\n    if (!this.cfg.entity) {\n      console.warn('[MsdDataSource] No entity specified in config');\n      this.cfg.entity = '';\n    }\n\n    // PORT: Complete buffer sizing logic from original\n    let wsSec = 60; // Default window\n    if (typeof cfg.windowSeconds === 'number' && isFinite(cfg.windowSeconds)) {\n      wsSec = Math.max(1, cfg.windowSeconds);\n    } else if (typeof cfg.windowSeconds === 'string') {\n      const ms = this._parseTimeWindowMs(cfg.windowSeconds);\n      if (Number.isFinite(ms)) {\n        wsSec = Math.max(1, Math.floor(ms / 1000));\n      }\n    }\n\n    // Buffer capacity: aim for ~10 points per second for the window\n    const capacity = Math.max(60, Math.floor(wsSec * 10));\n    this.buffer = new RollingBuffer(capacity);\n\n    // PORT: Complete timing configuration from original - MADE MORE AGGRESSIVE\n    const minEmitMs = Number.isFinite(cfg.minEmitMs) ? cfg.minEmitMs\n      : Number.isFinite(cfg.sampleMs) ? cfg.sampleMs : 100;\n\n    this.minEmitMs = Math.max(10, minEmitMs);\n\n    // MORE AGGRESSIVE coalescing by default\n    this.coalesceMs = Number.isFinite(cfg.coalesceMs)\n      ? Math.max(20, cfg.coalesceMs)  // Reduced from 30 to 20\n      : Math.max(20, Math.round(this.minEmitMs * 0.4));  // Reduced from 0.6 to 0.4\n\n    this.maxDelayMs = Number.isFinite(cfg.maxDelayMs)\n      ? Math.max(this.minEmitMs, cfg.maxDelayMs)\n      : Math.max(this.minEmitMs, this.coalesceMs * 3);  // Reduced from 4 to 3\n\n    this.emitOnSameValue = cfg.emitOnSameValue !== false; // Default true\n\n    // Subscription management\n    this.subscribers = new Set();\n    this.haUnsubscribe = null;\n\n    // NEW: Transformation and aggregation processors\n    this.transformations = new Map();\n    this.aggregations = new Map();\n    this._transformationData = new Map();\n    this._aggregationData = new Map();\n\n    // PORT: Complete internal timing state from original\n    this._lastEmitTime = 0;\n    this._lastEmittedValue = null;\n    this._pendingRaf = 0;\n    this._pending = false;\n    this._pendingFirstTs = 0;\n    this._pendingCount = 0;\n\n    // Performance statistics\n    this._stats = {\n      emits: 0,\n      coalesced: 0,\n      skipsSameValue: 0,\n      received: 0,\n      invalid: 0,\n      historyLoaded: 0\n    };\n\n    // Lifecycle state\n    this._started = false;\n    this._destroyed = false;\n\n    // Initialize processors from configuration\n    this._initializeProcessors(cfg);\n  }\n\n  /**\n   * Initialize transformation and aggregation processors from configuration\n   * @private\n   * @param {Object} cfg - Data source configuration\n   */\n  _initializeProcessors(cfg) {\n    // Initialize transformations\n    if (cfg.transformations && Array.isArray(cfg.transformations)) {\n      cfg.transformations.forEach((transform, index) => {\n        try {\n          const key = transform.key || `transform_${index}`;\n          const processor = createTransformationProcessor(transform);\n          this.transformations.set(key, processor);\n          console.log(`[MsdDataSource] Initialized transformation: ${key} (${transform.type})`);\n        } catch (error) {\n          console.warn(`[MsdDataSource] Failed to create transformation ${index}:`, error);\n        }\n      });\n    }\n\n    // Initialize aggregations\n    if (cfg.aggregations && typeof cfg.aggregations === 'object') {\n      Object.entries(cfg.aggregations).forEach(([type, config]) => {\n        try {\n          const key = config.key || type;\n          const processor = createAggregationProcessor(type, config);\n          this.aggregations.set(key, processor);\n          console.log(`[MsdDataSource] Initialized aggregation: ${key} (${type})`);\n        } catch (error) {\n          console.warn(`[MsdDataSource] Failed to create aggregation ${type}:`, error);\n        }\n      });\n    }\n\n    console.log(`[MsdDataSource] Processor initialization complete: ${this.transformations.size} transformations, ${this.aggregations.size} aggregations`);\n  }\n\n  /**\n   * ENHANCED: Preload historical data with multiple fallback strategies\n   * @private\n   */\n  async _preloadHistory() {\n    if (!this.hass?.callService || !this.cfg.entity) return;\n\n    // Check if history is enabled in config\n    const historyConfig = this.cfg.history || {};\n    if (historyConfig.enabled === false) return;\n\n    const hours = Math.max(1, Math.min(168, historyConfig.hours || 6));\n    const endTime = new Date();\n    const startTime = new Date(endTime.getTime() - hours * 3600000);\n\n    console.log(`[MsdDataSource] 📊 Preloading ${hours}h history for ${this.cfg.entity}`);\n\n    try {\n      // Strategy 1: Try Home Assistant's history service (most reliable)\n      await this._preloadWithHistoryService(startTime, endTime);\n    } catch (error) {\n      console.warn(`[MsdDataSource] History service failed for ${this.cfg.entity}, trying statistics:`, error.message);\n\n      try {\n        // Strategy 2: Fall back to enhanced statistics\n        await this._preloadWithStatistics(startTime, endTime);\n      } catch (statError) {\n        console.warn(`[MsdDataSource] Statistics failed, trying state history:`, statError.message);\n        // Strategy 3: Final fallback (existing _preloadStateHistory method)\n        await this._preloadStateHistory(startTime, endTime);\n      }\n    }\n\n    console.log(`[MsdDataSource] History preload complete: ${this._stats.historyLoaded} points loaded`);\n  }\n\n  /**\n   * NEW: Primary history loading using HA history service\n   * @private\n   * @param {Date} startTime - Start time for history query\n   * @param {Date} endTime - End time for history query\n   */\n  async _preloadWithHistoryService(startTime, endTime) {\n    const response = await this.hass.callService('history', 'get_history', {\n      entity_ids: [this.cfg.entity],\n      start_time: startTime.toISOString(),\n      end_time: endTime.toISOString()\n    });\n\n    if (response && response[0]) {\n      const states = response[0];\n      console.log(`[MsdDataSource] History service returned ${states.length} states for ${this.cfg.entity}`);\n\n      for (const state of states) {\n        const timestamp = new Date(state.last_changed || state.last_updated).getTime();\n        const rawValue = this.cfg.attribute ? state.attributes?.[this.cfg.attribute] : state.state;\n        const value = this._toNumber(rawValue);\n\n        if (value !== null) {\n          this.buffer.push(timestamp, value);\n          this._stats.historyLoaded++;\n        }\n      }\n    }\n  }\n\n  /**\n   * ENHANCED: Statistics-based history loading with finer granularity\n   * @private\n   * @param {Date} startTime - Start time for history query\n   * @param {Date} endTime - End time for history query\n   */\n  async _preloadWithStatistics(startTime, endTime) {\n    // Use 5-minute periods for more granular data\n    const response = await this.hass.callService('recorder', 'get_statistics', {\n      statistic_ids: [this.cfg.entity],\n      start_time: startTime.toISOString(),\n      end_time: endTime.toISOString(),\n      period: '5minute'  // Changed from 'hour' to '5minute'\n    });\n\n    if (response && response[0]?.statistics) {\n      const statistics = response[0].statistics;\n      console.log(`[MsdDataSource] Statistics returned ${statistics.length} points for ${this.cfg.entity}`);\n\n      for (const stat of statistics) {\n        const timestamp = new Date(stat.start).getTime();\n        const value = this._extractStatisticValue(stat);\n\n        if (value !== null) {\n          this.buffer.push(timestamp, value);\n          this._stats.historyLoaded++;\n        }\n      }\n    }\n  }\n\n  /**\n   * Start the data source with proper initialization sequence\n   * @returns {Promise} Resolves when fully initialized\n   */\n  async start() {\n    if (this._started || this._destroyed) return;\n\n    try {\n      console.log(`[MsdDataSource] 🚀 Starting initialization for ${this.cfg.entity}`);\n\n      // STEP 1: Preload historical data FIRST\n      if (this.hass?.callService) {\n        await this._preloadHistory();\n      }\n\n      // STEP 2: Initialize with current HASS state if available\n      if (this.hass.states && this.hass.states[this.cfg.entity]) {\n        const currentState = this.hass.states[this.cfg.entity];\n        console.log(`[MsdDataSource] 🔄 Loading initial state for ${this.cfg.entity}:`, currentState.state);\n\n        // ENHANCED: Capture unit_of_measurement from initial state\n        if (currentState.attributes?.unit_of_measurement) {\n          this.cfg.unit_of_measurement = currentState.attributes.unit_of_measurement;\n          console.log(`[MsdDataSource] 📊 Captured initial unit_of_measurement for ${this.cfg.entity}: \"${this.cfg.unit_of_measurement}\"`);\n        }\n\n        // FIXED: Use current timestamp for initial state\n        const currentTimestamp = Date.now();\n        const rawValue = this.cfg.attribute ? currentState.attributes?.[this.cfg.attribute] : currentState.state;\n        const value = this._toNumber(rawValue);\n\n        if (value !== null) {\n          console.log(`[MsdDataSource] Adding current state: ${value} at ${currentTimestamp}`);\n          this.buffer.push(currentTimestamp, value);\n          this._stats.currentValue = value;\n        }\n      }\n\n      // STEP 3: Setup real-time subscriptions\n      this.haUnsubscribe = await this.hass.connection.subscribeEvents((event) => {\n        if (event.event_type === 'state_changed' &&\n            event.data?.entity_id === this.cfg.entity) {\n          console.log(`[MsdDataSource] 📊 HA event received for ${this.cfg.entity}:`, event.data.new_state?.state);\n          this._handleStateChange(event.data);\n        }\n      }, 'state_changed');\n\n      this._started = true;\n      console.log(`[MsdDataSource] ✅ Full initialization complete for ${this.cfg.entity} - Buffer: ${this.buffer.size()} points`);\n\n      // STEP 4: Emit initial data to any existing subscribers\n      this._emitInitialData();\n\n    } catch (error) {\n      console.error(`[MsdDataSource] ❌ Failed to initialize ${this.cfg.entity}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * NEW: Emit initial data to subscribers after full initialization\n   * @private\n   */\n  _emitInitialData() {\n    if (this.subscribers.size > 0) {\n      const lastPoint = this.buffer.last();\n      if (lastPoint) {\n        console.log(`[MsdDataSource] 📤 Emitting initial data for ${this.cfg.entity} to ${this.subscribers.size} subscribers`);\n        const emitData = {\n          t: lastPoint.t,\n          v: lastPoint.v,\n          buffer: this.buffer,\n          stats: { ...this._stats },\n          transformations: this._getTransformationData(), // Convert Map to Object\n          aggregations: this._getAggregationData(),       // Convert Map to Object\n          entity: this.cfg.entity,\n          unit_of_measurement: this.cfg.unit_of_measurement,\n          historyReady: this._stats.historyLoaded > 0,\n          isInitialEmission: true // NEW: Flag to indicate this is initial data\n        };\n\n        this.subscribers.forEach(callback => {\n          try {\n            callback(emitData);\n          } catch (error) {\n            console.error(`[MsdDataSource] Initial callback error for ${this.cfg.entity}:`, error);\n          }\n        });\n      } else {\n        // Even if no buffer data, emit initial structure for consistency\n        console.log(`[MsdDataSource] 📤 Emitting initial empty data structure for ${this.cfg.entity} to ${this.subscribers.size} subscribers`);\n        const emitData = {\n          t: null,\n          v: null,\n          buffer: this.buffer,\n          stats: { ...this._stats },\n          transformations: this._getTransformationData(),\n          aggregations: this._getAggregationData(),\n          entity: this.cfg.entity,\n          unit_of_measurement: this.cfg.unit_of_measurement,\n          historyReady: this._stats.historyLoaded > 0,\n          isInitialEmission: true\n        };\n\n        this.subscribers.forEach(callback => {\n          try {\n            callback(emitData);\n          } catch (error) {\n            console.error(`[MsdDataSource] Initial callback error for ${this.cfg.entity}:`, error);\n          }\n        });\n      }\n    }\n  }\n\n  async _preloadHistory() {\n    if (!this.hass?.connection || !this.cfg.entity) {\n      console.warn('[MsdDataSource] No HASS connection or entity for history preload');\n      return;\n    }\n\n    const hours = Math.max(1, Math.min(168, this.cfg.history?.hours || 6)); // 1-168 hours\n    const endTime = new Date();\n    const startTime = new Date(endTime.getTime() - hours * 3600000);\n\n    console.log(`[MsdDataSource] 🔄 Preloading ${hours}h history for ${this.cfg.entity}`);\n\n    try {\n      // Use modern WebSocket call for statistics (preferred)\n      const statisticsData = await this.hass.connection.sendMessagePromise({\n        type: 'recorder/statistics_during_period',\n        start_time: startTime.toISOString(),\n        end_time: endTime.toISOString(),\n        statistic_ids: [this.cfg.entity],\n        period: 'hour'\n      });\n\n      if (statisticsData && statisticsData[this.cfg.entity]) {\n        const statistics = statisticsData[this.cfg.entity];\n        console.log(`[MsdDataSource] 📊 Got ${statistics.length} statistics points`);\n\n        for (const stat of statistics) {\n          const timestamp = new Date(stat.start).getTime();\n          const value = this._extractStatisticValue(stat);\n\n          if (value !== null) {\n            this.buffer.push(timestamp, value);\n            this._stats.historyLoaded++;\n          }\n        }\n\n        console.log(`[MsdDataSource] ✅ Loaded ${this._stats.historyLoaded} statistics points`);\n        return; // Success with statistics\n      }\n    } catch (error) {\n      console.warn('[MsdDataSource] Statistics failed, trying state history:', error.message);\n    }\n\n    // Fallback: try state history via WebSocket\n    await this._preloadStateHistoryWS(startTime, endTime);\n  }\n\n  async _preloadStateHistoryWS(startTime, endTime) {\n    try {\n      console.log(`[MsdDataSource] 📚 Trying WebSocket state history for ${this.cfg.entity}`);\n\n      // Use modern WebSocket call for history\n      const historyData = await this.hass.connection.sendMessagePromise({\n        type: 'history/history_during_period',\n        start_time: startTime.toISOString(),\n        end_time: endTime.toISOString(),\n        entity_ids: [this.cfg.entity],\n        minimal_response: true,\n        no_attributes: true\n      });\n\n      if (historyData && historyData[0]) {\n        const states = historyData[0];\n        console.log(`[MsdDataSource] 📊 Got ${states.length} history states`);\n\n        for (const state of states) {\n          const timestamp = new Date(state.last_changed || state.last_updated).getTime();\n          const rawValue = this.cfg.attribute ? state.attributes?.[this.cfg.attribute] : state.state;\n          const value = this._toNumber(rawValue);\n\n          if (value !== null) {\n            this.buffer.push(timestamp, value);\n            this._stats.historyLoaded++;\n          }\n        }\n\n        console.log(`[MsdDataSource] ✅ Loaded ${this._stats.historyLoaded} history points`);\n      } else {\n        console.warn('[MsdDataSource] No history data returned from WebSocket call');\n      }\n    } catch (error) {\n      console.error('[MsdDataSource] WebSocket state history also failed:', error);\n\n      // Final fallback: try direct REST API if available\n      await this._preloadHistoryREST(startTime, endTime);\n    }\n  }\n\n  async _preloadHistoryREST(startTime, endTime) {\n    try {\n      console.log(`[MsdDataSource] 🌐 Trying REST API history for ${this.cfg.entity}`);\n\n      const startParam = startTime.toISOString();\n      const url = `/api/history/period/${startParam}?filter_entity_id=${this.cfg.entity}&minimal_response&no_attributes`;\n\n      const response = await fetch(url, {\n        headers: {\n          'Authorization': `Bearer ${this.hass.auth?.accessToken}`,\n          'Content-Type': 'application/json'\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const historyData = await response.json();\n\n      if (historyData && historyData[0]) {\n        const states = historyData[0];\n        console.log(`[MsdDataSource] 📊 Got ${states.length} REST history states`);\n\n        for (const state of states) {\n          const timestamp = new Date(state.last_changed || state.last_updated).getTime();\n          const rawValue = this.cfg.attribute ? state.attributes?.[this.cfg.attribute] : state.state;\n          const value = this._toNumber(rawValue);\n\n          if (value !== null) {\n            this.buffer.push(timestamp, value);\n            this._stats.historyLoaded++;\n          }\n        }\n\n        console.log(`[MsdDataSource] ✅ Loaded ${this._stats.historyLoaded} REST history points`);\n      }\n    } catch (error) {\n      console.error('[MsdDataSource] REST history fallback also failed:', error);\n    }\n  }\n\n  /**\n   * Handle state change from Home Assistant\n   * @private\n   * @param {Object} eventData - State change event data\n   */\n  _handleStateChange(eventData) {\n\n    console.log('[MSD DEBUG] 📊 MsdDataSource._handleStateChange() ENTRY:', {\n      entity: this.cfg.entity,\n      timestamp: new Date().toISOString(),\n      hasEventData: !!eventData,\n      hasNewState: !!eventData?.new_state,\n      newStateValue: eventData?.new_state?.state,\n      subscriberCount: this.subscribers.size,\n      stackTrace: new Error().stack.split('\\n').slice(1, 3).join('\\n')\n    });\n\n    if (!eventData?.new_state || this._destroyed) {\n      console.log('[MSD DEBUG] ⏭️ Skipping state change - no new state or destroyed');\n      return;\n    }\n\n    // CRITICAL: Store the original state object before any conversion\n    this._lastOriginalState = eventData.new_state;\n\n    // ENHANCED: Capture and store unit_of_measurement from the entity\n    if (eventData.new_state.attributes?.unit_of_measurement) {\n      this.cfg.unit_of_measurement = eventData.new_state.attributes.unit_of_measurement;\n      console.log(`[MSD DEBUG] 📊 Captured unit_of_measurement for ${this.cfg.entity}: \"${this.cfg.unit_of_measurement}\"`);\n    }\n\n    // FIXED: Use current timestamp instead of state timestamp\n    const timestamp = Date.now();\n    const rawValue = this.cfg.attribute\n      ? eventData.new_state.attributes?.[this.cfg.attribute]\n      : eventData.new_state.state;\n\n    const value = this._toNumber(rawValue);\n\n    if (value !== null) {\n      console.log(`[MSD DEBUG] 📊 Processing state change for ${this.cfg.entity}:`, {\n        value,\n        timestamp,\n        subscriberCount: this.subscribers.size,\n        originalState: this._lastOriginalState.state,\n        unit_of_measurement: this.cfg.unit_of_measurement\n      });\n\n      // Add to buffer with proper timestamp\n      this.buffer.push(timestamp, value);\n      this._stats.updates++;\n      this._stats.currentValue = value;\n\n      // NEW: Apply transformations\n      const transformedData = this._applyTransformations(timestamp, value);\n\n      // NEW: Update aggregations\n      this._updateAggregations(timestamp, value, transformedData);\n\n      // Emit to subscribers\n      console.log(`[MSD DEBUG] 📤 Emitting to ${this.subscribers.size} subscribers:`, value);\n\n      const emitData = {\n        t: timestamp,\n        v: value,\n        buffer: this.buffer,\n        stats: { ...this._stats },\n        transformations: this._getTransformationData(), // NEW\n        aggregations: this._getAggregationData(),       // NEW\n        entity: this.cfg.entity,\n        unit_of_measurement: this.cfg.unit_of_measurement, // NEW: Include unit info\n        historyReady: this._stats.historyLoaded > 0\n      };\n\n      this.subscribers.forEach((callback, index) => {\n        try {\n          console.log(`[MSD DEBUG] 📞 Calling subscriber ${index} for ${this.cfg.entity}`);\n          callback(emitData);\n          console.log(`[MSD DEBUG] ✅ Subscriber ${index} completed successfully`);\n        } catch (error) {\n          console.error(`[MSD DEBUG] ❌ Subscriber ${index} callback FAILED for ${this.cfg.entity}:`, error);\n          console.error(`[MSD DEBUG] ❌ Subscriber error stack:`, error.stack);\n        }\n      });\n    } else {\n      console.log(`[MSD DEBUG] ⚠️ Skipping state change - invalid value:`, { rawValue, entity: this.cfg.entity });\n    }\n  }\n\n  /**\n   * Check if we should emit data to subscribers based on timing and value rules\n   */\n  _shouldEmit(value, timestamp) {\n    const now = Date.now();\n\n    // Respect minimum emit interval\n    if (this._lastEmitTime && (timestamp - this._lastEmitTime) < this.minEmitMs) {\n      this._stats.coalesced++;\n      return false;\n    }\n\n    // Skip if value hasn't changed (if configured)\n    if (!this.emitOnSameValue && value === this._lastEmittedValue) {\n      this._stats.skipsSameValue++;\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Emit data to all subscribers\n   */\n  _emit(data) {\n    const now = Date.now();\n    this._lastEmitTime = now;\n    this._lastEmittedValue = data.v;\n    this._stats.emits++;\n\n    console.log(`[MsdDataSource] 📤 Emitting to ${this.subscribers.size} subscribers:`, data.v);\n\n    // Call all subscribers\n    this.subscribers.forEach(callback => {\n      try {\n        callback(data);\n      } catch (error) {\n        console.warn(`[MsdDataSource] Subscriber callback error:`, error);\n      }\n    });\n  }\n\n  async _subscribeLive() {\n    if (!this.hass?.connection?.subscribeEvents || !this.cfg.entity) return;\n\n    const entityId = this.cfg.entity;\n\n    try {\n      this.haUnsubscribe = await this.hass.connection.subscribeEvents((event) => {\n        const newState = event?.data?.new_state;\n        if (!newState || newState.entity_id !== entityId) return;\n\n        const timestamp = new Date(newState.last_changed || newState.last_updated || Date.now()).getTime();\n        const rawValue = this.cfg.attribute ? newState.attributes?.[this.cfg.attribute] : newState.state;\n        const value = this._toNumber(rawValue);\n\n        this._onRawEventValue(timestamp, value);\n      }, 'state_changed');\n\n    } catch (error) {\n      console.warn('[MsdDataSource] Failed to subscribe to HA events:', error.message);\n    }\n  }\n\n  _onRawEventValue(timestamp, value) {\n    if (value === null) {\n      this._stats.invalid++;\n      return;\n    }\n\n    // ENHANCED: Check for rapid-fire identical values and skip some\n    const now = isNode ? Date.now() : performance.now();\n\n    // Store in buffer - buffer now handles its own coalescing\n    this.buffer.push(timestamp, value);\n    this._stats.received++;\n\n    // FIXED: More aggressive coalescing logic for stress scenarios\n    if (!this._pending) {\n      this._pending = true;\n      this._pendingFirstTs = now;\n      this._pendingCount = 1;\n\n      // For stress tests: delay first emission slightly to allow coalescing\n      if (this._stats.received > 10) {\n        // High-frequency scenario - be more patient\n        setTimeout(() => this._ensureScheduleEmit(), 5);\n      } else {\n        // Normal scenario - immediate response for first subscription\n        if (this.subscribers.size > 0 && this._stats.emits === 0) {\n          this._emit();\n        } else {\n          this._ensureScheduleEmit();\n        }\n      }\n    } else {\n      this._pendingCount++;\n      const timeSinceFirst = now - this._pendingFirstTs;\n\n      if (timeSinceFirst >= this.coalesceMs) {\n        // Coalescing window expired - emit and start new window\n        this._emit();\n\n        // Start fresh coalescing window\n        this._pending = true;\n        this._pendingFirstTs = now;\n        this._pendingCount = 1;\n        this._ensureScheduleEmit();\n      } else {\n        // Still within coalescing window - increment coalesced counter\n        this._stats.coalesced++;\n      }\n    }\n  }\n\n  _ensureScheduleEmit() {\n    if (this._pendingRaf) return; // Already scheduled\n\n    this._pendingRaf = requestAnimationFrame(() => {\n      this._pendingRaf = 0;\n      this._frameEmitCheck();\n    });\n  }\n\n  _frameEmitCheck() {\n    if (!this._pending || this._destroyed) return;\n\n    const now = isNode ? Date.now() : performance.now();\n    const timeSinceLastEmit = now - this._lastEmitTime;\n    const timeSincePendingStart = now - this._pendingFirstTs;\n\n    // Should we emit now?\n    let shouldEmit = false;\n\n    // Check minimum emit interval\n    if (timeSinceLastEmit >= this.minEmitMs) {\n      // Minimum time passed - check coalescing window\n      if (timeSincePendingStart >= this.coalesceMs) {\n        shouldEmit = true;\n      }\n    }\n\n    // Max delay override - always emit if we've been pending too long\n    if (timeSincePendingStart >= this.maxDelayMs) {\n      shouldEmit = true;\n    }\n\n    if (shouldEmit) {\n      this._emit();\n    } else {\n      // IMPROVED: More precise next check timing\n      const untilMinEmit = Math.max(0, this.minEmitMs - timeSinceLastEmit);\n      const untilCoalesce = Math.max(0, this.coalesceMs - timeSincePendingStart);\n      const untilMaxDelay = Math.max(0, this.maxDelayMs - timeSincePendingStart);\n\n      const nextCheck = Math.min(\n        untilMinEmit || Infinity,\n        untilCoalesce || Infinity,\n        untilMaxDelay || Infinity\n      );\n\n      if (nextCheck < Infinity && nextCheck > 0) {\n        setTimeout(() => {\n          this._ensureScheduleEmit();\n        }, Math.max(1, Math.min(50, nextCheck)));\n      }\n    }\n  }\n\n  /* OLD\n  subscribe(callback) {\n    if (typeof callback !== 'function') {\n      console.warn('[MsdDataSource] Subscribe requires a function callback');\n      return () => {};\n    }\n\n    this.subscribers.add(callback);\n\n    // Immediate hydration with current data\n    const lastPoint = this.buffer.last();\n    if (lastPoint) {\n      try {\n        callback({\n          t: lastPoint.t,\n          v: lastPoint.v,\n          buffer: this.buffer,\n          stats: this._stats\n        });\n      } catch (error) {\n        console.warn('[MsdDataSource] Initial callback error:', error);\n      }\n    }\n\n    // Return unsubscribe function\n    return () => {\n      this.subscribers.delete(callback);\n    };\n  }\n  */\n\n\n  subscribe(callback) {\n    if (typeof callback !== 'function') {\n      console.warn('[MsdDataSource] Subscribe requires a function callback');\n      return () => {};\n    }\n\n    this.subscribers.add(callback);\n\n    // Enhanced immediate hydration with current data\n    const lastPoint = this.buffer.last();\n    if (lastPoint) {\n      try {\n        const currentData = {\n          t: lastPoint.t,\n          v: lastPoint.v,\n          buffer: this.buffer,\n          stats: { ...this._stats },\n          transformations: this._getTransformationData(), // Convert Map to Object\n          aggregations: this._getAggregationData(),       // Convert Map to Object\n          entity: this.cfg.entity,\n          historyReady: this._stats.historyLoaded > 0\n        };\n\n        console.log(`[MsdDataSource] Providing immediate hydration for new subscriber:`, {\n          entity: this.cfg.entity,\n          value: lastPoint.v,\n          bufferSize: this.buffer.size(),\n          timestamp: new Date(lastPoint.t).toISOString()\n        });\n\n        // Use setTimeout to avoid blocking the subscription\n        setTimeout(() => {\n          callback(currentData);\n        }, 0);\n\n      } catch (error) {\n        console.warn('[MsdDataSource] Initial callback error:', error);\n      }\n    } else {\n      console.log(`[MsdDataSource] No data available for immediate hydration:`, {\n        entity: this.cfg.entity,\n        bufferSize: this.buffer.size(),\n        started: this._started\n      });\n    }\n\n    // Return unsubscribe function\n    return () => {\n      this.subscribers.delete(callback);\n    };\n  }\n\n  // ENHANCED: Subscribe with metadata support\n  subscribeWithMetadata(callback, metadata = {}) {\n    if (typeof callback !== 'function') {\n      console.warn('[MsdDataSource] Subscribe requires a function callback');\n      return () => {};\n    }\n\n    // Store metadata on the callback function\n    callback._subscriberMetadata = {\n      overlayId: metadata.overlayId || 'unknown',\n      overlayType: metadata.overlayType || 'unknown',\n      component: metadata.component || 'unknown',\n      subscribedAt: Date.now()\n    };\n\n    return this.subscribe(callback);\n  }\n\n\n  /**\n   * Convert raw value to number with support for boolean states\n   * @param {*} raw - Raw value from HA state\n   * @returns {number|null} Converted number or null if invalid\n   */\n  _toNumber(raw) {\n    console.log('[MSD DEBUG] 📊 _toNumber() converting:', {\n      raw,\n      type: typeof raw,\n      entity: this.cfg.entity\n    });\n\n    if (raw === null || raw === undefined) {\n      console.log('[MSD DEBUG] ⚠️ _toNumber() - null/undefined value');\n      return null;\n    }\n\n    // Handle numeric values\n    if (typeof raw === 'number') {\n      const result = isNaN(raw) ? null : raw;\n      console.log('[MSD DEBUG] 📊 _toNumber() - numeric:', { raw, result });\n      return result;\n    }\n\n    // Handle string values\n    if (typeof raw === 'string') {\n      // Try direct numeric conversion first\n      const num = parseFloat(raw);\n      if (!isNaN(num) && isFinite(num)) {\n        console.log('[MSD DEBUG] 📊 _toNumber() - string numeric:', { raw, num });\n        return num;\n      }\n\n      // ADDED: Handle boolean-like string states\n      const lowerRaw = raw.toLowerCase().trim();\n      if (lowerRaw === 'on' || lowerRaw === 'true' || lowerRaw === 'active' || lowerRaw === 'open') {\n        console.log('[MSD DEBUG] 📊 _toNumber() - boolean TRUE:', { raw, converted: 1 });\n        return 1;\n      }\n\n      if (lowerRaw === 'off' || lowerRaw === 'false' || lowerRaw === 'inactive' || lowerRaw === 'closed') {\n        console.log('[MSD DEBUG] 📊 _toNumber() - boolean FALSE:', { raw, converted: 0 });\n        return 0;\n      }\n\n      // Handle unavailable/unknown states\n      if (lowerRaw === 'unavailable' || lowerRaw === 'unknown') {\n        console.log('[MSD DEBUG] 📊 _toNumber() - unavailable state:', { raw, converted: null });\n        return null;\n      }\n\n      console.log('[MSD DEBUG] ⚠️ _toNumber() - unhandled string:', { raw });\n      return null;\n    }\n\n    // Handle boolean values\n    if (typeof raw === 'boolean') {\n      const result = raw ? 1 : 0;\n      console.log('[MSD DEBUG] 📊 _toNumber() - boolean:', { raw, result });\n      return result;\n    }\n\n    console.log('[MSD DEBUG] ⚠️ _toNumber() - unsupported type:', { raw, type: typeof raw });\n    return null;\n  }\n\n  _parseTimeWindowMs(windowStr) {\n    if (typeof windowStr !== 'string') return NaN;\n\n    const match = windowStr.match(/^(\\d+(?:\\.\\d+)?)\\s*(s|sec|m|min|h|hr|d|day)s?$/i);\n    if (!match) return NaN;\n\n    const value = parseFloat(match[1]);\n    const unit = match[2].toLowerCase();\n\n    switch (unit) {\n      case 's':\n      case 'sec':\n        return value * 1000;\n      case 'm':\n      case 'min':\n        return value * 60 * 1000;\n      case 'h':\n      case 'hr':\n        return value * 60 * 60 * 1000;\n      case 'd':\n      case 'day':\n        return value * 24 * 60 * 60 * 1000;\n      default:\n        return NaN;\n    }\n  }\n\n  // Debug and introspection methods\n  getStats() {\n    return {\n      ...this._stats,\n      config: {\n        entity: this.cfg.entity,\n        windowSeconds: this.cfg.windowSeconds,\n        minEmitMs: this.minEmitMs,\n        coalesceMs: this.coalesceMs,\n        maxDelayMs: this.maxDelayMs\n      },\n      buffer: this.buffer.getStats(),\n      subscribers: this.subscribers.size,\n      state: {\n        started: this._started,\n        pending: this._pending,\n        destroyed: this._destroyed\n      }\n    };\n  }\n\n  // ENHANCED: Basic subscriber information with overlay metadata\n  getSubscriberInfo() {\n    return Array.from(this.subscribers).map((callback, index) => {\n      // Check if callback has stored metadata\n      const metadata = callback._subscriberMetadata;\n\n      if (metadata) {\n        return {\n          id: metadata.overlayId,\n          name: `${metadata.overlayType}_${metadata.overlayId}`,\n          type: metadata.overlayType,\n          component: metadata.component,\n          subscribedAt: metadata.subscribedAt,\n          index: index\n        };\n      }\n\n      // Fallback to basic detection for callbacks without metadata\n      const name = callback.name || 'anonymous';\n      const isWrapped = callback.toString().includes('overlay') || callback.toString().includes('callback');\n\n      return {\n        id: `subscriber_${index}`,\n        name: name === 'anonymous' && isWrapped ? 'overlay_callback' : name,\n        type: 'function',\n        component: 'unknown',\n        index: index\n      };\n    });\n  }  /**\n   * Get current data with enhanced metadata\n   * @returns {Object|null} Current data object or null\n   */\n  getCurrentData() {\n    const lastPoint = this.buffer.last();\n    if (!lastPoint) {\n      // Return minimal data structure even if no data points exist\n      return {\n        t: null,\n        v: null,\n        buffer: this.buffer,\n        stats: { ...this._stats },\n        transformations: this._getTransformationData(), // Convert Map to Object\n        aggregations: this._getAggregationData(),       // Convert Map to Object\n        entity: this.cfg.entity,\n        unit_of_measurement: this.cfg.unit_of_measurement, // NEW: Include unit info\n        historyReady: this._stats.historyLoaded > 0,\n        bufferSize: 0,\n        started: this._started\n      };\n    }\n\n    return {\n      t: lastPoint.t,\n      v: lastPoint.v,\n      buffer: this.buffer,\n      stats: { ...this._stats },\n      transformations: this._getTransformationData(), // Convert Map to Object\n      aggregations: this._getAggregationData(),       // Convert Map to Object\n      entity: this.cfg.entity,\n      unit_of_measurement: this.cfg.unit_of_measurement, // NEW: Include unit info\n      historyReady: this._stats.historyLoaded > 0,\n      bufferSize: this.buffer.size(),\n      started: this._started\n    };\n  }\n\n  // NEW: Add EntityRuntime-compatible method\n  getEntity() {\n    return this.currentState ? {\n      state: this.currentState.state,\n      attributes: this.currentState.attributes || {}\n    } : null;\n  }\n\n  /**\n   * Stop the data source and release resources\n   */\n  async stop() {\n    this._started = false;\n\n    if (this.haUnsubscribe) {\n      try {\n        this.haUnsubscribe();\n      } catch (error) {\n        console.warn('[MsdDataSource] HA unsubscribe error:', error);\n      }\n      this.haUnsubscribe = null;\n    }\n\n    if (this._pendingRaf) {\n      cancelAnimationFrame(this._pendingRaf);\n      this._pendingRaf = 0;\n    }\n\n    this._pending = false;\n  }\n\n  destroy() {\n    this._destroyed = true;\n    this.stop();\n    this.subscribers.clear();\n    this.buffer.clear();\n  }\n\n  _extractStatisticValue(stat) {\n    // Priority order for statistic values\n    if (Number.isFinite(stat.mean)) return stat.mean;\n    if (Number.isFinite(stat.state)) return stat.state;\n    if (Number.isFinite(stat.sum)) return stat.sum;\n    if (Number.isFinite(stat.max)) return stat.max;\n    if (Number.isFinite(stat.min)) return stat.min;\n    return null;\n  }\n\n  /**\n   * Apply all configured transformations to a value\n   * @private\n   * @param {number} timestamp - Current timestamp\n   * @param {number} value - Raw value to transform\n   * @returns {Object} Map of transformation keys to results\n   */\n  _applyTransformations(timestamp, value) {\n    const results = { original: value };\n\n    this.transformations.forEach((processor, key) => {\n      try {\n        results[key] = processor.transform(value, timestamp, this.buffer);\n        this._transformationData.set(key, results[key]);\n      } catch (error) {\n        console.warn(`[MsdDataSource] Transformation ${key} failed:`, error);\n        results[key] = null;\n        this._transformationData.set(key, null);\n      }\n    });\n\n    return results;\n  }\n\n  /**\n   * Update all configured aggregations with new data\n   * @private\n   * @param {number} timestamp - Current timestamp\n   * @param {number} value - Raw value\n   * @param {Object} transformedData - Transformed values from this update\n   */\n  _updateAggregations(timestamp, value, transformedData) {\n    this.aggregations.forEach((processor, key) => {\n      try {\n        processor.update(timestamp, value, transformedData);\n        this._aggregationData.set(key, processor.getValue());\n      } catch (error) {\n        console.warn(`[MsdDataSource] Aggregation ${key} failed:`, error);\n        this._aggregationData.set(key, null);\n      }\n    });\n  }\n\n  /**\n   * Get current transformation data for emission\n   * @private\n   * @returns {Object} Current transformation results\n   */\n  _getTransformationData() {\n    const data = {};\n    this._transformationData.forEach((value, key) => {\n      data[key] = value;\n    });\n    return data;\n  }\n\n  /**\n   * Get current aggregation data for emission\n   * @private\n   * @returns {Object} Current aggregation results\n   */\n  _getAggregationData() {\n    const data = {};\n    this._aggregationData.forEach((value, key) => {\n      data[key] = value;\n    });\n    return data;\n  }\n}\n","/**\n * DataSourceManager - Manages multiple data sources and overlay subscriptions\n *\n * Features:\n * - Multi-source lifecycle management\n * - Overlay subscription system\n * - Clean shutdown and resource management\n * - Performance monitoring and statistics\n * - EntityRuntime API compatibility for rules engine\n */\n\nimport { MsdDataSource } from './MsdDataSource.js';\n\nexport class DataSourceManager {\n  constructor(hass) {\n    this.hass = hass;\n    this.sources = new Map();\n    this.overlaySubscriptions = new Map();\n\n    // NEW: Entity runtime compatibility\n    this.entityIndex = new Map(); // entityId -> dataSource\n    this.globalEntityChangeListeners = new Set();\n\n    // Performance statistics\n    this._stats = {\n      sourcesCreated: 0,\n      subscriptionsActive: 0,\n      dataUpdates: 0,\n      errors: 0\n    };\n\n    // Lifecycle state\n    this._destroyed = false;\n  }\n\n  /**\n   * Initialize data sources from configuration with history preloading\n   * @param {Object} dataSourceConfigs - Configuration for data sources\n   * @returns {Promise<number>} Number of sources created\n   */\n  async initializeFromConfig(dataSourceConfigs) {\n    if (this._destroyed) {\n      throw new Error('DataSourceManager has been destroyed');\n    }\n\n    console.log(`[DataSourceManager] 🚀 Initializing ${Object.keys(dataSourceConfigs || {}).length} data sources`);\n\n    // Create all data sources from config\n    const promises = Object.entries(dataSourceConfigs || {}).map(async ([name, config]) => {\n      try {\n        const source = await this.createDataSource(name, config);\n        this._stats.sourcesCreated++;\n        return source;\n      } catch (error) {\n        console.warn(`[DataSourceManager] Failed to create source ${name}:`, error);\n        this._stats.errors++;\n        throw error;\n      }\n    });\n\n    await Promise.all(promises);\n\n    // NEW: Wait for history preloading to complete\n    if (this.sources.size > 0) {\n      await this._waitForHistoryPreloading();\n    }\n\n    const successful = this.sources.size;\n    const failed = Object.keys(dataSourceConfigs || {}).length - successful;\n    console.log(`[DataSourceManager] ✅ Initialization complete: ${successful} successful, ${failed} failed`);\n\n    return successful;\n  }\n\n  async createDataSource(name, config) {\n    if (this.sources.has(name)) {\n      return this.sources.get(name);\n    }\n\n    const source = new MsdDataSource(config, this.hass);\n    this.sources.set(name, source);\n\n    // NEW: Index by entity for global lookups\n    if (config.entity) {\n      this.entityIndex.set(config.entity, source);\n\n      // Forward entity changes to global listeners\n      source.subscribe((data) => {\n        this._notifyGlobalEntityChangeListeners([config.entity]);\n      });\n    }\n\n    try {\n      await source.start();\n\n      // NEW: Preload initial state from HASS if available\n      if (config.entity && this.hass.states && this.hass.states[config.entity]) {\n        const hassState = this.hass.states[config.entity];\n\n        // Simulate initial state change to populate the data source\n        source._handleStateChange({\n          entity_id: config.entity,\n          new_state: hassState,\n          old_state: null\n        });\n      }\n\n    } catch (error) {\n      console.warn(`[DataSourceManager] Failed to start source ${name}:`, error);\n      this.sources.delete(name);\n      this.entityIndex.delete(config.entity);\n      this._stats.errors++;\n      throw error;\n    }\n\n    return source;\n  }\n\n  /**\n   * NEW: Wait for all sources to complete their history loading\n   * @private\n   * @param {number} maxWaitMs - Maximum wait time in milliseconds\n   */\n  async _waitForHistoryPreloading(maxWaitMs = 10000) {\n    const startTime = Date.now();\n    const checkInterval = 100;\n\n    console.log(`[DataSourceManager] ⏳ Waiting for history preloading...`);\n\n    while (Date.now() - startTime < maxWaitMs) {\n      let allReady = true;\n      let totalSources = 0;\n      let readySources = 0;\n\n      for (const [name, source] of this.sources) {\n        totalSources++;\n        const stats = source.getStats();\n        if (stats.historyLoaded > 0 || !source.cfg.history?.enabled) {\n          readySources++;\n        } else {\n          allReady = false;\n        }\n      }\n\n      if (readySources > 0) {\n        console.log(`[DataSourceManager] History loading progress: ${readySources}/${totalSources} sources ready`);\n      }\n\n      if (allReady || totalSources === 0) {\n        console.log(`[DataSourceManager] ✅ History preloading complete in ${Date.now() - startTime}ms`);\n        break;\n      }\n\n      await new Promise(resolve => setTimeout(resolve, checkInterval));\n    }\n  }\n\n  // NEW: EntityRuntime compatibility methods\n  getEntity(entityId) {\n    // NEW: Support dot notation for datasource aggregations/transformations\n    if (entityId.includes('.')) {\n      const [sourceId, ...pathParts] = entityId.split('.');\n      const source = this.sources.get(sourceId);\n\n      if (source) {\n        const currentData = source.getCurrentData();\n        if (!currentData) return null;\n\n        // Handle dot notation paths\n        if (pathParts.length >= 2) {\n          const dataType = pathParts[0]; // 'aggregations' or 'transformations'\n          const dataKey = pathParts.slice(1).join('.'); // Support nested keys\n\n          if (dataType === 'transformations' && currentData.transformations) {\n            const value = currentData.transformations[dataKey];\n            if (value !== undefined && value !== null) {\n              return {\n                state: String(value), // Convert to string properly\n                attributes: {\n                  data_path: entityId,\n                  source_type: 'datasource_transformation',\n                  raw_value: value\n                }\n              };\n            }\n          } else if (dataType === 'aggregations' && currentData.aggregations) {\n            const aggData = currentData.aggregations[dataKey];\n\n            // Handle aggregation objects with multiple properties\n            if (typeof aggData === 'object' && aggData !== null) {\n              // Return the most relevant value from aggregation\n              let value = aggData.avg ?? aggData.value ?? aggData.last ?? aggData.current;\n              if (value !== undefined && value !== null) {\n                return {\n                  state: String(value),\n                  attributes: {\n                    data_path: entityId,\n                    source_type: 'datasource_aggregation',\n                    raw_value: value,\n                    aggregation_data: aggData\n                  }\n                };\n              }\n            } else if (aggData !== undefined && aggData !== null) {\n              return {\n                state: String(aggData),\n                attributes: {\n                  data_path: entityId,\n                  source_type: 'datasource_aggregation',\n                  raw_value: aggData\n                }\n              };\n            }\n          }\n        }\n\n        // Default to current value if no specific path found\n        return {\n          state: currentData.v?.toString() || 'unavailable',\n          attributes: {\n            timestamp: currentData.t,\n            source_type: 'datasource',\n            ...currentData.stats\n          }\n        };\n      }\n    }\n\n    // Check entity index for direct entity mappings\n    const source = this.entityIndex.get(entityId);\n    if (source) {\n      const currentData = source.getCurrentData();\n      if (currentData) {\n        return {\n          state: currentData.v?.toString() || 'unavailable',\n          attributes: {\n            timestamp: currentData.t,\n            source_type: 'datasource'\n          }\n        };\n      }\n    }\n\n    // Fallback to HASS states directly\n    if (this.hass.states && this.hass.states[entityId]) {\n      const hassState = this.hass.states[entityId];\n      return {\n        state: hassState.state,\n        attributes: hassState.attributes || {}\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Resolve dot notation paths in aggregation/transformation data\n   * @private\n   * @param {Object} data - Data object to traverse\n   * @param {string} path - Dot notation path\n   * @returns {Object|null} Entity-like object or null\n   */\n  _resolveDataPath(data, path) {\n    if (!data || typeof data !== 'object') return null;\n\n    const pathParts = path.split('.');\n    let current = data;\n\n    // Skip first part if it's the category (aggregations/transformations)\n    const startIndex = (pathParts[0] === 'aggregations' || pathParts[0] === 'transformations') ? 1 : 0;\n\n    for (let i = startIndex; i < pathParts.length; i++) {\n      if (current && typeof current === 'object') {\n        current = current[pathParts[i]];\n      } else {\n        return null;\n      }\n    }\n\n    // If we found a value, wrap it in entity-like format\n    if (current !== undefined && current !== null) {\n      return {\n        state: current.toString(),\n        attributes: {\n          data_path: path,\n          source_type: 'datasource_processed'\n        }\n      };\n    }\n\n    return null;\n  }\n\n  listIds() {\n    return Array.from(this.entityIndex.keys());\n  }\n\n  // NEW: Add global entity change listener for rules engine\n  addEntityChangeListener(callback) {\n    this.globalEntityChangeListeners.add(callback);\n    return () => this.globalEntityChangeListeners.delete(callback);\n  }\n\n  _notifyGlobalEntityChangeListeners(changedEntityIds) {\n    if (this.globalEntityChangeListeners.size === 0) return;\n\n    this.globalEntityChangeListeners.forEach(callback => {\n      try {\n        callback(changedEntityIds);\n      } catch (error) {\n        console.warn('[DataSourceManager] Global entity listener error:', error);\n      }\n    });\n  }\n\n  /**\n   * Subscribe an overlay to data source updates\n   * Enhanced for sparkline real-time updates\n   * @param {Object} overlay - Overlay configuration with source property\n   * @param {Function} callback - Callback function for updates\n   */\n  subscribeOverlay(overlay, callback) {\n    if (!overlay.source) {\n      console.warn('[DataSourceManager] subscribeOverlay: No source specified for overlay', overlay.id);\n      return;\n    }\n\n    const source = this.sources.get(overlay.source);\n    if (!source) {\n      console.warn('[DataSourceManager] subscribeOverlay: Source not found:', overlay.source);\n      return;\n    }\n\n    console.log(`[DataSourceManager] 🔗 Setting up subscription for ${overlay.id} to ${overlay.source}`);\n\n    // Subscribe to the data source with enhanced data for sparklines\n    const unsubscribe = source.subscribeWithMetadata?.((data) => {\n      // Enhanced callback data for sparklines\n      const enhancedData = {\n        ...data,\n        sourceId: overlay.source,\n        overlayId: overlay.id,\n        overlayType: overlay.type,\n        // Include buffer reference for sparklines\n        buffer: overlay.type === 'sparkline' ? data.buffer : undefined,\n        // Include historical data if available\n        historicalData: overlay.type === 'sparkline' && data.buffer ?\n          data.buffer.getAll().map(point => ({ timestamp: point.t, value: point.v })) : undefined\n      };\n\n      // DEBUG: Log what we're about to send\n      console.log(`[DataSourceManager] 📤 Calling callback for ${overlay.id}:`, {\n        hasBuffer: !!enhancedData.buffer,\n        bufferSize: enhancedData.buffer?.size?.() || 0,\n        hasHistoricalData: !!enhancedData.historicalData,\n        historicalDataLength: enhancedData.historicalData?.length || 0,\n        currentValue: enhancedData.v\n      });\n\n      // Call the callback with overlay and enhanced update data\n      callback(overlay, enhancedData);\n    }, {\n      // ADDED: Pass overlay metadata to the subscription\n      overlayId: overlay.id,\n      overlayType: overlay.type,\n      component: 'OverlayManager'\n    }) || source.subscribe((data) => {\n      // Fallback if subscribeWithMetadata not available\n      const enhancedData = {\n        ...data,\n        sourceId: overlay.source,\n        overlayId: overlay.id,\n        overlayType: overlay.type,\n        buffer: overlay.type === 'sparkline' ? data.buffer : undefined,\n        historicalData: overlay.type === 'sparkline' && data.buffer ?\n          data.buffer.getAll().map(point => ({ timestamp: point.t, value: point.v })) : undefined\n      };\n\n      callback(overlay, enhancedData);\n    });\n\n    // CRITICAL: Provide immediate callback if data already exists\n    // This fixes the timing issue where overlays subscribe after data is ready\n    const currentData = source.getCurrentData();\n    if (currentData && (currentData.buffer?.size?.() > 0 || currentData.v !== undefined)) {\n      console.log(`[DataSourceManager] 🔄 Providing immediate data for ${overlay.id}`);\n\n      const immediateData = {\n        ...currentData,\n        sourceId: overlay.source,\n        overlayId: overlay.id,\n        overlayType: overlay.type,\n        buffer: overlay.type === 'sparkline' ? currentData.buffer : undefined,\n        historicalData: overlay.type === 'sparkline' && currentData.buffer ?\n          currentData.buffer.getAll().map(point => ({ timestamp: point.t, value: point.v })) : undefined\n      };\n\n      // Use setTimeout to avoid blocking the subscription setup\n      setTimeout(() => {\n        callback(overlay, immediateData);\n      }, 0);\n    }\n\n\n\n    // Store the unsubscribe function\n    if (!this.overlaySubscriptions.has(overlay.id)) {\n      this.overlaySubscriptions.set(overlay.id, []);\n    }\n    this.overlaySubscriptions.get(overlay.id).push(unsubscribe);\n    this._stats.subscriptionsActive++;\n\n    console.log(`[DataSourceManager] ✅ Subscribed ${overlay.type} overlay ${overlay.id} to source ${overlay.source} (${source.subscribers?.size || 0} total subscribers)`);\n\n    return unsubscribe;\n  }\n\n  unsubscribeOverlay(overlayId) {\n    const subscriptions = this.overlaySubscriptions.get(overlayId);\n    if (subscriptions) {\n      subscriptions.forEach(unsubscribe => {\n        try {\n          unsubscribe();\n        } catch (error) {\n          console.warn(`[DataSourceManager] Error unsubscribing overlay ${overlayId}:`, error);\n          this._stats.errors++;\n        }\n      });\n      this.overlaySubscriptions.delete(overlayId);\n      this._stats.subscriptionsActive--;\n    }\n  }\n\n  getSource(name) {\n    return this.sources.get(name);\n  }\n\n  getAllSources() {\n    return Array.from(this.sources.values());\n  }\n\n  /**\n   * Get a specific data source by ID\n   * @param {string} id - Data source ID\n   * @returns {MsdDataSource|null} The data source or null if not found\n   */\n  getDataSource(id) {\n    return this._dataSources.get(id) || null;\n  }\n\n  getStats() {\n    const sourceStats = {};\n    for (const [name, source] of this.sources) {\n      sourceStats[name] = source.getStats ? source.getStats() : { error: 'No stats available' };\n    }\n\n    return {\n      manager: this._stats,\n      sources: sourceStats,\n      summary: {\n        totalSources: this.sources.size,\n        activeSubscriptions: this.overlaySubscriptions.size,\n        entityCount: this.entityIndex.size,\n        destroyed: this._destroyed\n      }\n    };\n  }\n\n  // ADDED: Basic subscriber information methods\n  getSourceSubscribers(sourceName) {\n    const source = this.sources.get(sourceName);\n    return source?.getSubscriberInfo?.() || [];\n  }\n\n  getAllSubscribers() {\n    const result = {};\n    this.sources.forEach((source, name) => {\n      result[name] = source.getSubscriberInfo?.() || [];\n    });\n    return result;\n  }\n\n  async destroy() {\n    if (this._destroyed) return;\n    this._destroyed = true;\n\n    // Unsubscribe all overlays\n    for (const overlayId of this.overlaySubscriptions.keys()) {\n      this.unsubscribeOverlay(overlayId);\n    }\n\n    // Stop all data sources\n    const stopPromises = [];\n    for (const [name, source] of this.sources) {\n      try {\n        if (source.stop) {\n          stopPromises.push(source.stop());\n        } else if (source.destroy) {\n          stopPromises.push(source.destroy());\n        }\n      } catch (error) {\n        console.warn(`[DataSourceManager] Error stopping source ${name}:`, error);\n      }\n    }\n\n    await Promise.all(stopPromises);\n\n    this.sources.clear();\n    this.overlaySubscriptions.clear();\n    this.entityIndex.clear();\n    this.globalEntityChangeListeners.clear();\n  }\n\n  // Debug and introspection methods\n  debugDump() {\n    return {\n      sources: Array.from(this.sources.keys()),\n      subscriptions: Array.from(this.overlaySubscriptions.keys()),\n      entities: Array.from(this.entityIndex.keys()),\n      stats: this.getStats()\n    };\n  }\n}\n","const counters = Object.create(null);\nexport function perfInc(key, delta = 1) {\n  counters[key] = (counters[key] || 0) + delta;\n}\nexport function perfSet(key, val) {\n  counters[key] = val;\n}\nexport function perfGetAll() {\n  return { ...counters };\n}\nexport function perfTime(key, fn) {\n  const t0 = performance.now();\n  const res = fn();\n  const done = () => {\n    const dt = performance.now() - t0;\n    perfInc(key + '.samples', 1);\n    perfInc(key + '.totalMs', dt);\n    perfSet(key + '.lastMs', dt);\n  };\n  if (res && typeof res.then === 'function') {\n    return res.then(r => { done(); return r; });\n  }\n  done();\n  return res;\n}\n","import { perfInc, perfTime } from '../perf/PerfCounters.js';\n\n/**\n * M5.1 RouterCore\n * - Manhattan basic routing\n * - Caching\n * - Placeholders for obstacles & channels\n */\nexport class RouterCore {\n  constructor(routingConfig, anchors, viewBox) {\n    this.config = routingConfig || {};\n    this.anchors = anchors || {};\n    this.viewBox = viewBox;\n    this._cache = new Map(); // key -> RouteResult\n    this._cacheOrder = [];\n    this._maxCache = 256;\n    this._rev = 0; // increment to invalidate globally\n    this._overlaysRef = null;\n    this._obstacles = [];\n    this._obsVersion = 0;\n    this._gridCache = new Map(); // resolution|obsVersion -> occupancy grid\n    this._channels = this._normalizeChannels(this.config.channels || []);\n    this._channelForcePenalty = Number(this.config.channel_force_penalty || 800);\n    this._channelAvoidMultiplier = Number(this.config.channel_avoid_multiplier || 1.0);\n    // NEW (M5.4 shaping config)\n    this._channelTargetCoverage = Number(this.config.channel_target_coverage ?? 0.6);\n    this._channelShapingMaxAttempts = Number(this.config.channel_shaping_max_attempts ?? 12);\n    this._channelShapingSpan = Number(this.config.channel_shaping_span ?? 32);\n    this._channelMinCoverageGain = Number(this.config.channel_min_coverage_gain ?? 0.04);\n  }\n\n  invalidate(id='*') {\n    if (id === '*' ) {\n      this._cache.clear();\n      this._cacheOrder.length = 0;\n      this._rev++;\n    } else {\n      // Cache key includes overlay id only indirectly; brute force purge by scan.\n      for (const k of Array.from(this._cache.keys())) {\n        if (k.includes(`@${id}|`)) {\n          this._cache.delete(k);\n          const i = this._cacheOrder.indexOf(k);\n          if (i >= 0) this._cacheOrder.splice(i,1);\n        }\n      }\n    }\n    perfInc('routing.invalidate.events', 1);\n  }\n\n  setOverlays(overlays) {\n    if (!Array.isArray(overlays)) return;\n    if (overlays === this._overlaysRef) return;\n    this._overlaysRef = overlays;\n    // Rebuild obstacle list (ribbon or obstacle:true)\n    const obs = [];\n    for (const ov of overlays) {\n      if (!ov || !ov.id) continue;\n      const raw = ov._raw || ov.raw || {};\n      const isObstacle = raw.obstacle === true || ov.type === 'ribbon';\n      if (!isObstacle) continue;\n      // Determine bounds. Prefer size+position (raw.position / raw.size) else anchor if available.\n      let x = 0, y = 0, w = 0, h = 0;\n      if (Array.isArray(raw.position) && Array.isArray(raw.size)) {\n        [x,y] = raw.position;\n        [w,h] = raw.size;\n      } else if (raw.anchor && this.anchors[raw.anchor]) {\n        const [ax,ay] = this.anchors[raw.anchor];\n        x = ax - 1; y = ay - 1; w = 2; h = 2;\n      } else continue;\n      if (!Number.isFinite(x+y+w+h) || w <= 0 || h <= 0) continue;\n      obs.push({ id: ov.id, x1: x, y1: y, x2: x + w, y2: y + h });\n    }\n    this._obstacles = obs;\n    this._obsVersion++;\n    // Invalidate grids & route cache referencing old obstacles\n    this._gridCache.clear();\n    this.invalidate('*');\n    perfInc('routing.obstacles.count', obs.length);\n  }\n\n  stats() {\n    return {\n      size: this._cache.size,\n      max: this._maxCache,\n      rev: this._rev,\n      obstacles: this._obstacles.length,\n      obsVersion: this._obsVersion\n    };\n  }\n\n\n  /**\n   * Build a route request object with both entry and exit direction hints.\n   * If route_mode_last is not specified and the destination is an overlay with attach_side,\n   * auto-set route_mode_last based on attach_side (left/right → xy; top/bottom → yx).\n   * If only route_mode_last is set, use it for the last segment, first segment is auto.\n   * If neither is set, fallback to geometry-based auto.\n   * @param {object} overlay - The overlay config object\n   * @param {number[]} a1 - Start anchor [x, y]\n   * @param {number[]} a2 - End anchor [x, y]\n   * @returns {object} Route request with modeHint and modeHintLast\n   */\n  buildRouteRequest(overlay, a1, a2) {\n    const raw = overlay._raw || overlay.raw || {};\n    const fs = overlay.finalStyle || {};\n    let channelMode = (raw.route_channel_mode || raw.routeChannelMode || raw.channel_mode || 'prefer').toLowerCase();\n    if (!['prefer','avoid','force'].includes(channelMode)) {\n      perfInc && perfInc('routing.channel.mode.invalid', 1);\n      channelMode = 'prefer';\n    }\n    let smoothingMode = (\n      raw.smoothing_mode ||\n      raw.corner_smoothing_mode ||\n      fs.smoothing_mode ||\n      this.config.smoothing_mode ||\n      (this.config.smoothing && this.config.smoothing.mode) ||\n      'none'\n    ).toLowerCase();\n    const allowedSmooth = ['none','chaikin'];\n    if (!allowedSmooth.includes(smoothingMode)) {\n      try { perfInc('routing.smooth.mode.invalid', 1); } catch(_) {}\n      smoothingMode = 'none';\n    }\n\n    // Parse both first and last segment hints\n    let modeHint = (raw.route_mode || '').toLowerCase();\n    let modeHintLast = (raw.route_mode_last || '').toLowerCase();\n    let hintSourceFirst = modeHint ? 'explicit' : 'auto';\n    let hintSourceLast = modeHintLast ? 'explicit' : null;\n\n    // Improved destination overlay detection:\n    // 1. If attach_side is present we treat destination as an overlay (even if anchor not yet resolved)\n    // 2. If attach_to is not an existing anchor id we assume it is an overlay id (will be resolved later)\n    let isDestinationOverlay = false;\n    if (raw.attach_side) {\n      isDestinationOverlay = true;\n    } else if (typeof raw.attach_to === 'string' && raw.attach_to) {\n      if (!this.anchors[raw.attach_to]) {\n        isDestinationOverlay = true;\n      }\n    }\n\n    // Auto-set modeHintLast based on attach_side when not explicitly provided\n    if (!modeHintLast && isDestinationOverlay) {\n      const attachSide = (raw.attach_side || '').toLowerCase();\n      if (attachSide === 'left' || attachSide === 'right') {\n        modeHintLast = 'yx'; // final horizontal\n        hintSourceLast = 'attach_side';\n        try { perfInc('routing.hint.attach_side.horizontal',1); } catch(_){}\n      } else if (attachSide === 'top' || attachSide === 'bottom') {\n        modeHintLast = 'xy'; // final vertical\n        hintSourceLast = 'attach_side';\n        try { perfInc('routing.hint.attach_side.vertical',1); } catch(_){}\n      }\n    }\n    // Geometry-based first segment if not provided\n    if (!modeHint) {\n      const [x1, y1] = a1;\n      const [x2, y2] = a2;\n      if (Number.isFinite(x1+y1+x2+y2)) {\n        const dx = Math.abs(x2 - x1);\n        const dy = Math.abs(y2 - y1);\n        modeHint = dx >= dy ? 'xy' : 'yx';\n      } else {\n        modeHint = 'xy'; // safe fallback\n      }\n      hintSourceFirst = 'geometry';\n    }\n    if (!modeHintLast) {\n      modeHintLast = modeHint;\n      if (!hintSourceLast) hintSourceLast = hintSourceFirst;\n    }\n\n    const smoothingIterations = Number(\n      raw.smoothing_iterations ||\n      raw.corner_smoothing_iterations ||\n      fs.smoothing_iterations ||\n      this.config.smoothing_iterations ||\n      (this.config.smoothing && this.config.smoothing.iterations) ||\n      0\n    );\n    const smoothingMaxPoints = Number(\n      raw.smoothing_max_points ||\n      fs.smoothing_max_points ||\n      this.config.smoothing_max_points ||\n      (this.config.smoothing && this.config.smoothing.max_points) ||\n      160\n    );\n    return {\n      id: overlay.id,\n      a: a1,\n      b: a2,\n      modeFull: (raw.route_mode_full || raw.route_mode || 'manhattan').toLowerCase(),\n      modeHint,\n      modeHintLast,\n      _hintSourceFirst: hintSourceFirst,\n      _hintSourceLast: hintSourceLast,\n      avoidIds: Array.isArray(raw.avoid) ? raw.avoid.slice() : [],\n      channels: (raw.route_channels || raw.routeChannels || []),\n      channelMode,\n      cornerRadius: Number(raw.corner_radius || raw.cornerRadius || fs.corner_radius || 0),\n      cornerStyle: (raw.corner_style || raw.cornerStyle || fs.corner_style || 'miter').toLowerCase(),\n      smoothingMode,\n      smoothingIterations,\n      smoothingMaxPoints,\n      clearance: Number(raw.clearance || this.config.clearance || 0),\n      proximity: Number(raw.smart_proximity || this.config.smart_proximity || 0),\n      smart: {\n        detourSpan: Number(this.config.smart_detour_span || 48),\n        maxExtraBends: Number(this.config.smart_max_extra_bends || 3),\n        minImprovement: Number(this.config.smart_min_improvement || 4),\n        maxDetoursPerElbow: Number(this.config.smart_max_detours_per_elbow || 4)\n      },\n      _rev: this._rev\n    };\n  }\n\n  _cacheKey(req) {\n    const [x1,y1] = req.a;\n    const [x2,y2] = req.b;\n    const avoidKey = req.avoidIds.sort().join(',');\n    const chanKey = req.channels.sort().join(',');\n    return `${req.id}@${x1},${y1}-${x2},${y2}|${req.modeFull}|${req.modeHint}|A:${avoidKey}|C:${chanKey}|${req.channelMode}|R:${req._rev}|O:${this._obsVersion}|P:${req.proximity}|CR:${req.cornerRadius}|CS:${req.cornerStyle}|SM:${req.smoothingMode}|SI:${req.smoothingIterations}`;\n  }\n\n  computePath(req) {\n    return perfTime('routing.compute.ms', () => {\n      const key = this._cacheKey(req);\n      const cached = this._cache.get(key);\n      if (cached) {\n        perfInc('routing.cache.hit', 1);\n        return { ...cached, meta: { ...cached.meta, cache_hit: true } };\n      }\n      perfInc('routing.cache.miss', 1);\n      let result;\n      const mode = req.modeFull;\n      try {\n        if (mode === 'grid') {\n          result = this._computeGrid(req);\n        } else if (mode === 'smart') {\n          perfInc('routing.strategy.smart', 1);\n          // Phase 1: base grid\n            const gridBase = this._computeGrid(req, { smart: true });\n          if (gridBase) {\n            result = this._refineSmart(req, gridBase);\n          }\n        }\n      } catch (e) {\n        console.warn('[MSD v1] smart/grid router error; fallback to manhattan', e);\n      }\n      if (!result) {\n        if (mode === 'smart') perfInc('routing.strategy.smart', 1);\n        result = this._computeManhattan(req);\n      }\n\n      if (result && req.cornerStyle === 'round' && req.cornerRadius > 0) {\n        const arcApplied = this._applyCornerRounding(result, req.cornerRadius);\n        if (arcApplied) result = arcApplied;\n      }\n      // NEW (M5.6) apply smoothing AFTER arcs (arcs preserved, path rebuilt as polyline if smoothing >0)\n      if (result && req.smoothingMode !== 'none' && req.smoothingIterations > 0) {\n        const smoothApplied = this._applySmoothing(result, req);\n        if (smoothApplied) result = smoothApplied;\n      }\n\n      this._cache.set(key, result);\n      this._cacheOrder.push(key);\n      if (this._cacheOrder.length > this._maxCache) {\n        const oldest = this._cacheOrder.shift();\n        if (oldest) this._cache.delete(oldest);\n      }\n      return { ...result, meta: { ...result.meta, cache_hit: false } };\n    });\n  }\n\n  _computeGrid(req, flags={}) {\n    perfInc('routing.strategy.grid', 1);\n    const vb = this.viewBox || [0,0,400,200];\n    const width = vb[2];\n    const height = vb[3];\n    const baseRes = Number(this.config.grid_resolution || 64);\n    const res = baseRes > 4 ? baseRes : 32;\n    const cols = Math.max(2, Math.ceil(width / res));\n    const rows = Math.max(2, Math.ceil(height / res));\n    const clearance = Math.max(0, req.clearance || this.config.clearance || 0);\n\n    const gridKey = `${res}|${this._obsVersion}|${clearance}`;\n    let occ = this._gridCache.get(gridKey);\n    if (!occ) {\n      occ = this._buildOccupancy(cols, rows, res, clearance);\n      this._gridCache.set(gridKey, occ);\n    }\n\n    const w2c = (x)=>Math.min(cols-1, Math.max(0, Math.round(x / res)));\n    const h2c = (y)=>Math.min(rows-1, Math.max(0, Math.round(y / res)));\n    const c2x = (c)=> c * res;\n    const c2y = (r)=> r * res;\n\n    const start = { c: w2c(req.a[0]), r: h2c(req.a[1]) };\n    const goal  = { c: w2c(req.b[0]), r: h2c(req.b[1]) };\n\n    // A* (4-direction)\n    const open = new MinHeap();\n    const key = (c,r)=>`${c},${r}`;\n    const gScore = new Map();\n    const came = new Map();\n    const h = (c,r)=> Math.abs(c-goal.c)+Math.abs(r-goal.r);\n\n    gScore.set(key(start.c,start.r),0);\n    open.push({ c:start.c, r:start.r, f:h(start.c,start.r) });\n\n    const blocked = (c,r)=> occ[r] && occ[r][c] === 1;\n\n    const maxIterations = cols*rows * 4; // guard\n    let iterations = 0;\n    let found = false;\n\n    while(!open.isEmpty() && iterations++ < maxIterations) {\n      const cur = open.pop();\n      if (cur.c === goal.c && cur.r === goal.r) { found = true; break; }\n      const gCur = gScore.get(key(cur.c,cur.r));\n      for (const [dc,dr] of [[1,0],[-1,0],[0,1],[0,-1]]) {\n        const nc = cur.c+dc, nr = cur.r+dr;\n        if (nc<0||nr<0||nc>=cols||nr>=rows) continue;\n        if (blocked(nc,nr)) continue;\n        const nk = key(nc,nr);\n        const gNew = gCur + 1;\n        if (gNew < (gScore.get(nk) ?? Infinity)) {\n            gScore.set(nk,gNew);\n            came.set(nk, [cur.c,cur.r]);\n            const f = gNew + h(nc,nr);\n            open.push({ c:nc, r:nr, f });\n        }\n      }\n    }\n\n    if (!found) {\n      return null; // caller will fallback\n    }\n\n    // Reconstruct\n    const pathCells = [];\n    let cc = goal.c, cr = goal.r;\n    while(true) {\n      pathCells.push([cc,cr]);\n      if (cc === start.c && cr === start.r) break;\n      const prev = came.get(key(cc,cr));\n      if (!prev) break;\n      [cc,cr] = prev;\n    }\n    pathCells.reverse();\n\n    // Compress straight runs into polyline world coords\n    const pts = [];\n    let lastDir = null;\n    for (let i=0;i<pathCells.length;i++) {\n      const [pc,pr] = pathCells[i];\n      const wx = c2x(pc);\n      const wy = c2y(pr);\n      if (i===0) { pts.push([wx,wy]); continue; }\n      const [pcPrev,prPrev] = pathCells[i-1];\n      const dir = [pc-pcPrev, pr-prPrev].join(',');\n      if (dir !== lastDir) {\n        // new direction, keep previous cell as corner (if not already added)\n        pts.push([wx,wy]);\n        lastDir = dir;\n      } else {\n        // same direction – update last point to current (extend segment)\n        pts[pts.length-1] = [wx,wy];\n      }\n    }\n    // Ensure final destination snapping\n    pts[0] = [req.a[0], req.a[1]];\n    pts[pts.length-1] = [req.b[0], req.b[1]];\n\n    // NEW (M5.2 fix): If compression produced a single diagonal segment, insert a Manhattan elbow.\n    if (pts.length === 2) {\n      const [sx, sy] = pts[0];\n      const [tx, ty] = pts[1];\n      if (sx !== tx && sy !== ty) {\n        const mode = (req.modeHint === 'yx') ? 'yx' : 'xy';\n        if (mode === 'yx') {\n          pts.splice(1, 0, [sx, ty]);\n        } else {\n          pts.splice(1, 0, [tx, sy]);\n        }\n      }\n    }\n\n    const bendW = (this.config?.cost_defaults?.bend ?? 10);\n    const proxW = (this.config?.cost_defaults?.proximity ?? 4);\n    const { penalty: proxPenalty } = this._segmentProximityPenalty(pts, req.clearance, req.proximity, proxW);\n    let channelInfo = this._channelDelta(pts, req);\n    let shapingMeta = null;\n    if (req.channels?.length && (req.channelMode === 'prefer' || req.channelMode === 'force')) {\n      const desired = (req.channelMode === 'force') ? 1.0 : this._channelTargetCoverage;\n      if (channelInfo.coverage < desired) {\n        const shapeRes = this._shapeForChannels(req, pts, channelInfo, desired);\n        if (shapeRes && shapeRes.accepted) {\n          pts = shapeRes.pts;\n          channelInfo = this._channelDelta(pts, req); // recompute\n          shapingMeta = shapeRes.meta;\n          perfInc('routing.channel.shape.accept', 1);\n        } else if (shapeRes) {\n          shapingMeta = shapeRes.meta;\n        }\n      }\n    }\n    const totalCost = this._costComposite(pts, bendW, proxW, proxPenalty, channelInfo.delta);\n    const d = this._polylineToPath(pts);\n    return {\n      d,\n      pts,\n      meta: {\n        strategy: flags.smart ? 'grid-smart-preface' : 'grid',\n        cost: totalCost,\n        segments: pts.length - 1,\n        bends: Math.max(0, pts.length - 2),\n        grid: { resolution: res, iterations },\n        ...(req.channels?.length ? {\n          channel: {\n            mode: channelInfo.mode,\n            insidePx: channelInfo.inside,\n            outsidePx: channelInfo.outside,\n            coveragePct: Number((channelInfo.coverage*100).toFixed(1)),\n            deltaCost: channelInfo.delta,\n            forcedOutside: channelInfo.forcedOutside,\n            ...(shapingMeta ? { shaping: shapingMeta } : {})\n          }\n        } : {})\n      }\n    };\n  }\n\n  _buildOccupancy(cols, rows, res, clearance) {\n    // 0 = free, 1 = blocked\n    const occ = Array.from({ length: rows }, () => new Uint8Array(cols));\n    if (!this._obstacles.length) return occ;\n    for (const ob of this._obstacles) {\n      const x1 = ob.x1 - clearance;\n      const y1 = ob.y1 - clearance;\n      const x2 = ob.x2 + clearance;\n      const y2 = ob.y2 + clearance;\n      const c0 = Math.max(0, Math.floor(x1 / res));\n      const r0 = Math.max(0, Math.floor(y1 / res));\n      const c1 = Math.min(cols-1, Math.ceil(x2 / res));\n      const r1 = Math.min(rows-1, Math.ceil(y2 / res));\n      for (let r=r0; r<=r1; r++) {\n        const row = occ[r];\n        for (let c=c0; c<=c1; c++) {\n          row[c] = 1;\n        }\n      }\n    }\n    return occ;\n  }\n\n  /**\n   * Manhattan routing supporting independent first and last segment hints.\n   * @param {object} req - Route request with modeHint and modeHintLast\n   */\n  _computeManhattan(req) {\n    const [x1, y1] = req.a;\n    const [x2, y2] = req.b;\n    const firstMode = (req.modeHint === 'yx') ? 'yx' : 'xy';\n    const lastMode  = (req.modeHintLast === 'yx') ? 'yx' : 'xy';\n    let pts;\n    if (x1 === x2 || y1 === y2) {\n      pts = [[x1,y1],[x2,y2]];\n    } else {\n      // We honor lastMode for the final segment orientation.\n      // lastMode = 'xy' => final segment is along Y (because order x then y)\n      // lastMode = 'yx' => final segment is along X.\n      if (lastMode === 'xy') {\n        // Final vertical => elbow shares x2, start y1\n        pts = [[x1,y1],[x2,y1],[x2,y2]];\n      } else {\n        // lastMode === 'yx' final horizontal => elbow shares y2, start x1\n        pts = [[x1,y1],[x1,y2],[x2,y2]];\n      }\n      // If explicit first hint conflicts, we could insert an intermediate elbow (optional)\n      // For now, we accept 3-point L shape determined by lastMode.\n    }\n    const d = this._polylineToPath(pts);\n    return {\n      d,\n      pts,\n      meta: {\n        strategy: 'manhattan-basic',\n        cost: this._costSimple(pts),\n        segments: pts.length - 1,\n        bends: Math.max(0, pts.length - 2),\n        hint: {\n          first: req.modeHint,\n            last: req.modeHintLast,\n          sourceFirst: req._hintSourceFirst,\n          sourceLast: req._hintSourceLast\n        }\n      }\n    };\n  }\n\n  _polylineToPath(pts) {\n    if (!pts.length) return '';\n    let p = `M${pts[0][0]},${pts[0][1]}`;\n    for (let i=1;i<pts.length;i++) {\n      p += ` L${pts[i][0]},${pts[i][1]}`;\n    }\n    return p;\n  }\n\n  _costSimple(pts) {\n    let dist = 0;\n    for (let i=1;i<pts.length;i++) {\n      const dx = pts[i][0]-pts[i-1][0];\n      const dy = pts[i][1]-pts[i-1][1];\n      dist += Math.abs(dx)+Math.abs(dy);\n    }\n    const bends = Math.max(0, pts.length-2);\n    const bendWeight = (this.config?.cost_defaults?.bend ?? 10);\n    return dist + bends * bendWeight;\n  }\n\n  _costComposite(pts, bendsWeight, proximityWeight, proximityPenalty, channelDelta = 0) {\n    // distance + bendsWeight*bends + proximityWeight*penalty\n    let dist = 0;\n    for (let i=1;i<pts.length;i++) {\n      dist += Math.abs(pts[i][0]-pts[i-1][0]) + Math.abs(pts[i][1]-pts[i-1][1]);\n    }\n    const bends = Math.max(0, pts.length - 2);\n    return dist + bends * bendsWeight + proximityPenalty * proximityWeight + channelDelta;\n  }\n\n  _segmentProximityPenalty(pts, clearance, proximity, proximityWeightRaw) {\n    if (!proximity || !this._obstacles.length) return { penalty: 0, detail: [] };\n    const band = clearance + proximity;\n    let total = 0;\n    const detail = [];\n    for (let i=1;i<pts.length;i++) {\n      const a = pts[i-1], b = pts[i];\n      const segPenalty = this._nearestObstacleBandOverlap(a, b, band);\n      if (segPenalty > 0) {\n        total += segPenalty;\n        detail.push({ i, segPenalty });\n      }\n    }\n    return { penalty: total, detail };\n  }\n\n  _nearestObstacleBandOverlap(a, b, band) {\n    // Axis-aligned segments only\n    const vertical = a[0] === b[0];\n    const x1 = Math.min(a[0], b[0]);\n    const x2 = Math.max(a[0], b[0]);\n    const y1 = Math.min(a[1], b[1]);\n    const y2 = Math.max(a[1], b[1]);\n    let worst = 0;\n    for (const ob of this._obstacles) {\n      // Quick reject bounding box enlarged by band\n      if (x2 < ob.x1 - band || x1 > ob.x2 + band || y2 < ob.y1 - band || y1 > ob.y2 + band) continue;\n      let d;\n      if (vertical) {\n        // Distance from line x=a.x to obstacle horizontal span\n        if (a[0] < ob.x1) d = ob.x1 - a[0];\n        else if (a[0] > ob.x2) d = a[0] - ob.x2;\n        else d = 0;\n      } else {\n        if (a[1] < ob.y1) d = ob.y1 - a[1];\n        else if (a[1] > ob.y2) d = a[1] - ob.y2;\n        else d = 0;\n      }\n      if (d < band) {\n        const p = (band - d); // linear penalty (could square later)\n        if (p > worst) worst = p;\n      }\n    }\n    return worst;\n  }\n\n  _normalizeChannels(list) {\n    if (!Array.isArray(list)) return [];\n    return list\n      .filter(c => c && Array.isArray(c.rect) && c.rect.length === 4)\n      .map(c => {\n        const [x,y,w,h] = c.rect;\n        return {\n          id: c.id || `chan_${x}_${y}`,\n          x1: x, y1: y, x2: x + w, y2: y + h,\n          weight: Number(c.weight || c.w || 0.5)\n        };\n      });\n  }\n\n  _channelDelta(pts, req) {\n    if (!this._channels.length || !req.channels || !req.channels.length) return { delta: 0, inside: 0, outside: 0, coverage: 0, forcedOutside: false, mode: req.channelMode };\n    // Filter to requested channel IDs (ignore unknown)\n    const chanSet = new Set(req.channels);\n    const chans = this._channels.filter(c => chanSet.has(c.id));\n    if (!chans.length) return { delta: 0, inside: 0, outside: 0, coverage: 0, forcedOutside: false };\n\n    let inside = 0;\n    let outside = 0;\n    // Forcing: a point is \"inside preferred set\" if midpoint is inside ANY requested channel rect.\n    for (let i=1;i<pts.length;i++) {\n      const a = pts[i-1], b = pts[i];\n      const segLen = Math.abs(a[0]-b[0]) + Math.abs(a[1]-b[1]);\n      if (segLen === 0) continue;\n      // Midpoint (orthogonal so pick center)\n      const mx = (a[0] + b[0]) / 2;\n      const my = (a[1] + b[1]) / 2;\n      const inChan = chans.some(c => mx >= c.x1 && mx <= c.x2 && my >= c.y1 && my <= c.y2);\n      if (inChan) inside += segLen;\n      else outside += segLen;\n    }\n    const coverage = inside / (inside + outside || 1);\n    let delta = 0;\n    const mode = (req.channelMode || 'prefer').toLowerCase();\n    let forcedOutside = false;\n    if (mode === 'prefer') {\n      // Reward inside (subtract)\n      const weightAvg = chans.reduce((s,c)=>s+c.weight,0)/chans.length;\n      delta -= inside * weightAvg;\n    } else if (mode === 'avoid') {\n      const weightAvg = chans.reduce((s,c)=>s+c.weight,0)/chans.length;\n      delta += inside * weightAvg * this._channelAvoidMultiplier;\n    } else if (mode === 'force') {\n      if (outside > 0) {\n        forcedOutside = true;\n        delta += this._channelForcePenalty;\n      } else {\n        const weightAvg = chans.reduce((s,c)=>s+c.weight,0)/chans.length;\n        delta -= inside * weightAvg; // full reward when fully inside\n      }\n    }\n    if (delta !== 0) perfInc('routing.channel.applied', 1);\n    if (forcedOutside) perfInc('routing.channel.force.penalty', 1);\n    return { delta, inside, outside, coverage, forcedOutside, mode: req.channelMode };\n  }\n\n  _refineSmart(req, gridBase) {\n    if (!gridBase || !Array.isArray(gridBase.pts) || gridBase.pts.length < 2) return gridBase;\n    const bendW = (this.config?.cost_defaults?.bend ?? 10);\n    const proxW = (this.config?.cost_defaults?.proximity ?? 4);\n    const { penalty: penaltyBefore } = this._segmentProximityPenalty(gridBase.pts, req.clearance, req.proximity, proxW);\n    let bestPts = gridBase.pts.slice();\n    let bestPenalty = penaltyBefore;\n    let bestCost = this._costComposite(bestPts, bendW, proxW, bestPenalty);\n    let detoursTried = 0;\n    let detoursAccepted = 0;\n\n    if (req.proximity > 0 && bestPts.length > 2) {\n      // Try shifting each elbow (not endpoints)\n      const span = req.smart.detourSpan;\n      const maxExtraBends = req.smart.maxExtraBends;\n      const minImprove = req.smart.min_improvement;\n      for (let i=1;i<bestPts.length-1;i++) {\n        const elbow = bestPts[i];\n        const prev = bestPts[i-1];\n        const next = bestPts[i+1];\n        const verticalIn = prev[0] === elbow[0]; // incoming dir\n        const horizontalOut = elbow[1] === next[1]; // outgoing dir\n        // Only elbows where both dirs present (true elbow)\n        if ((verticalIn && horizontalOut) || (!verticalIn && !horizontalOut)) {\n          // Determine orthogonal shift axis (shift elbow along one axis to widen clearance)\n          const candidates = [];\n          if (verticalIn && horizontalOut) {\n            // elbow shape └ or ┌ etc. shift in a box: along x and y\n            candidates.push([elbow[0] + span, elbow[1]]);\n            candidates.push([elbow[0] - span, elbow[1]]);\n            candidates.push([elbow[0], elbow[1] + span]);\n            candidates.push([elbow[0], elbow[1] - span]);\n          } else {\n            candidates.push([elbow[0] + span, elbow[1]]);\n            candidates.push([elbow[0] - span, elbow[1]]);\n            candidates.push([elbow[0], elbow[1] + span]);\n            candidates.push([elbow[0], elbow[1] - span]);\n          }\n          let tries = 0;\n          for (const c of candidates) {\n            if (tries++ >= req.smart.maxDetoursPerElbow) break;\n            detoursTried++;\n            const newPts = bestPts.slice();\n            newPts[i] = c;\n            // Prevent duplicate successive collinear points (basic)\n            const compact = this._compactPolyline(newPts);\n            if (compact.length - bestPts.length > maxExtraBends) continue;\n            const { penalty: p2 } = this._segmentProximityPenalty(compact, req.clearance, req.proximity, proxW);\n            const cost2 = this._costComposite(compact, bendW, proxW, p2);\n            if (cost2 + minImprove <= bestCost) {\n              bestCost = cost2;\n              bestPts = compact;\n              bestPenalty = p2;\n              detoursAccepted++;\n            }\n          }\n        }\n      }\n    }\n\n    const channelInfo = this._channelDelta(bestPts, req);\n    // Channel shaping (only prefer/force & if coverage below target)\n    let shapingMeta = null;\n    if (req.channels?.length && (req.channelMode === 'prefer' || req.channelMode === 'force')) {\n      const desired = (req.channelMode === 'force') ? 1.0 : this._channelTargetCoverage;\n      if (channelInfo.coverage < desired) {\n        const shapeRes = this._shapeForChannels(req, bestPts, channelInfo, desired);\n        if (shapeRes && shapeRes.accepted) {\n          bestPts = shapeRes.pts;\n          // recompute penalties\n          const newChan = this._channelDelta(bestPts, req);\n          const { penalty: newProx } = this._segmentProximityPenalty(bestPts, req.clearance, req.proximity, proxW);\n            bestPenalty = newProx; // proximity might change slightly (rare) – reassign\n          shapingMeta = shapeRes.meta;\n          // recompute cost with new channel delta\n          bestCost = this._costComposite(bestPts, bendW, proxW, bestPenalty, newChan.delta);\n          // overwrite channelInfo for meta\n          channelInfo.inside = newChan.inside;\n          channelInfo.outside = newChan.outside;\n          channelInfo.coverage = newChan.coverage;\n          channelInfo.delta = newChan.delta;\n          channelInfo.forcedOutside = newChan.forcedOutside;\n          perfInc('routing.channel.shape.accept', 1);\n        } else if (shapeRes) {\n          shapingMeta = shapeRes.meta;\n        }\n      }\n    }\n    // REPLACED duplicate const bestCost decl with in-place update earlier\n    bestCost = this._costComposite(bestPts, bendW, proxW, bestPenalty, channelInfo.delta);\n    const d = this._polylineToPath(bestPts);\n    const baseMeta = gridBase.meta || {};\n    baseMeta.strategy = 'smart';\n    baseMeta.cost = bestCost;\n    baseMeta.bends = Math.max(0, bestPts.length - 2);\n    baseMeta.segments = bestPts.length - 1;\n    baseMeta.smart = {\n      penaltyBefore,\n      penaltyAfter: bestPenalty,\n      detoursTried,\n      detoursAccepted\n    };\n    if (req.channels?.length) {\n      baseMeta.channel = {\n        mode: channelInfo.mode,\n        insidePx: channelInfo.inside,\n        outsidePx: channelInfo.outside,\n        coveragePct: Number((channelInfo.coverage*100).toFixed(1)),\n        deltaCost: channelInfo.delta,\n        forcedOutside: channelInfo.forcedOutside,\n        ...(shapingMeta ? { shaping: shapingMeta } : {})\n      };\n    }\n    perfInc('routing.smart.refine.attempt', detoursTried);\n    perfInc('routing.smart.refine.accept', detoursAccepted);\n    return { d, pts: bestPts, meta: baseMeta };\n  }\n\n  _compactPolyline(pts) {\n    if (pts.length <= 2) return pts;\n    const out = [pts[0]];\n    for (let i=1;i<pts.length-1;i++) {\n      const a = out[out.length-1];\n      const b = pts[i];\n      const c = pts[i+1];\n      // If a->b and b->c are collinear, skip b\n      if ((a[0] === b[0] && b[0] === c[0]) || (a[1] === b[1] && b[1] === c[1])) continue;\n      out.push(b);\n    }\n    out.push(pts[pts.length-1]);\n    return out;\n  }\n\n  _shapeForChannels(req, pts, channelInfo, desiredCoverage) {\n    perfInc('routing.channel.shape.attempt', 1);\n    const attemptsMax = this._channelShapingMaxAttempts;\n    const span = this._channelShapingSpan;\n    const minGain = this._channelMinCoverageGain;\n    const chanIds = new Set(req.channels);\n    const chans = this._channels.filter(c => chanIds.has(c.id));\n    if (!chans.length) return null;\n\n    const coverage0 = channelInfo.coverage;\n    let bestPts = pts.slice();\n    let bestCoverage = coverage0;\n    let accepted = false;\n    let attempts = 0;\n    let coverageHistory = [Number(coverage0.toFixed(4))];\n    const forceMode = (req.channelMode === 'force');\n\n    function midpoint(a,b){ return [(a[0]+b[0])/2,(a[1]+b[1])/2]; }\n    const inAny = (x,y)=>chans.some(c=> x>=c.x1 && x<=c.x2 && y>=c.y1 && y<=c.y2);\n\n    const segsOutside = () => {\n      const list = [];\n      for (let i=1;i<bestPts.length;i++){\n        const a=bestPts[i-1], b=bestPts[i];\n        const len=Math.abs(a[0]-b[0])+Math.abs(a[1]-b[1]);\n        if(!len) continue;\n        const [mx,my]=midpoint(a,b);\n        if(!inAny(mx,my)) list.push({i,len,a,b,mx,my});\n      }\n      return list.sort((x,y)=>y.len-x.len);\n    };\n\n    while (attempts < attemptsMax) {\n      attempts++;\n      const outsideSegs = segsOutside();\n      if (!outsideSegs.length) break; // fully inside\n      // pick the largest outside segment\n      const seg = outsideSegs[0];\n      // Try shifting its interior elbow(s) if any\n      // Identify candidate elbow indices around this segment\n      const elbowIndices = [];\n      if (seg.i-1 > 0) elbowIndices.push(seg.i-1);\n      if (seg.i < bestPts.length-1) elbowIndices.push(seg.i);\n\n      let improved = false;\n      for (const ei of elbowIndices) {\n        const copy = bestPts.map(p=>p.slice());\n        // shift target elbow towards nearest channel center\n        const e = copy[ei];\n        // Compute shortest move vector to enter any channel (axis aligned)\n        let bestMove = null;\n        let bestMoveDist = Infinity;\n        chans.forEach(c => {\n          // For a point outside, compute minimal axis step into rect\n            const dx = (e[0] < c.x1) ? (c.x1 - e[0]) :\n                       (e[0] > c.x2) ? (c.x2 - e[0]) : 0;\n            const dy = (e[1] < c.y1) ? (c.y1 - e[1]) :\n                       (e[1] > c.y2) ? (c.y2 - e[1]) : 0;\n          // Only consider moving along one axis per attempt (choose smaller non-zero)\n          if (dx !==0 && dy !==0) {\n            // pick smaller\n            if (Math.abs(dx) < Math.abs(dy)) {\n              if (Math.abs(dx) < bestMoveDist) { bestMoveDist = Math.abs(dx); bestMove = [dx,0]; }\n            } else {\n              if (Math.abs(dy) < bestMoveDist) { bestMoveDist = Math.abs(dy); bestMove = [0,dy]; }\n            }\n          } else if (dx !==0 || dy !==0) {\n            const d = Math.abs(dx||dy);\n            if (d < bestMoveDist) { bestMoveDist = d; bestMove = [dx,dy]; }\n          }\n        });\n        if (!bestMove) continue;\n        // scale move to span (limit)\n        const mv = [\n          bestMove[0] === 0 ? 0 : Math.sign(bestMove[0]) * Math.min(Math.abs(bestMove[0]), span),\n          bestMove[1] === 0 ? 0 : Math.sign(bestMove[1]) * Math.min(Math.abs(bestMove[1]), span)\n        ];\n        copy[ei] = [e[0] + mv[0], e[1] + mv[1]];\n        // Compact polyline if collinear introduced\n        const compact = this._compactPolyline(copy);\n        const newChan = this._channelDelta(compact, req);\n        const gain = newChan.coverage - bestCoverage;\n        if (gain >= minGain) {\n          bestPts = compact;\n          bestCoverage = newChan.coverage;\n          coverageHistory.push(Number(bestCoverage.toFixed(4)));\n          improved = true;\n          if (forceMode && bestCoverage >= 0.999) break;\n          if (!forceMode && bestCoverage >= desiredCoverage) break;\n        }\n      }\n      if (!improved) break;\n      if ((forceMode && bestCoverage >= 0.999) || (!forceMode && bestCoverage >= desiredCoverage)) {\n        accepted = true;\n        break;\n      }\n    }\n\n    // Force downgrade if still outside & force mode\n    let downgraded = false;\n    if (forceMode && bestCoverage < 0.999) {\n      downgraded = true;\n      // mark but caller meta will keep mode=force + forcedOutside flag (HUD can show downgrade)\n      perfInc('routing.channel.shape.downgrade', 1);\n    }\n\n    return {\n      accepted,\n      pts: bestPts,\n      meta: {\n        attempts,\n        coverageBefore: Number(coverage0.toFixed(4)),\n        coverageAfter: Number(bestCoverage.toFixed(4)),\n        coverageHistory,\n        accepted,\n        downgraded\n      }\n    };\n  }\n\n  _applyCornerRounding(routeResult, radiusGlobal) {\n    const pts = routeResult.pts;\n    if (!Array.isArray(pts) || pts.length < 3) {\n      perfInc('routing.arc.none', 1);\n      return null;\n    }\n    const arcMin = 1;\n    let arcCount = 0;\n    let totalTrim = 0;\n    const parts = [];\n    let lastOut = pts[0].slice();\n    parts.push(`M${lastOut[0]},${lastOut[1]}`);\n    for (let i = 1; i < pts.length - 1; i++) {\n      const pPrev = pts[i - 1];\n      const p = pts[i];\n      const pNext = pts[i + 1];\n      const vIn = [p[0] - pPrev[0], p[1] - pPrev[1]];\n      const vOut = [pNext[0] - p[0], pNext[1] - p[1]];\n      const isOrth = (vIn[0] === 0 || vIn[1] === 0) && (vOut[0] === 0 || vOut[1] === 0) && !(vIn[0] === 0 && vIn[1] === 0) && !(vOut[0] === 0 && vOut[1] === 0) && !(Math.sign(vIn[0]) === Math.sign(vOut[0]) && vIn[0] !== 0) && !(Math.sign(vIn[1]) === Math.sign(vOut[1]) && vIn[1] !== 0);\n      if (!isOrth) {\n        // Just connect full corner\n        if (p[0] !== lastOut[0] || p[1] !== lastOut[1]) {\n          parts.push(`L${p[0]},${p[1]}`);\n          lastOut = p.slice();\n        }\n        continue;\n      }\n      const lenIn = Math.abs(vIn[0]) + Math.abs(vIn[1]);\n      const lenOut = Math.abs(vOut[0]) + Math.abs(vOut[1]);\n      let r = Math.min(radiusGlobal, lenIn / 2, lenOut / 2);\n      if (r < arcMin) {\n        if (p[0] !== lastOut[0] || p[1] !== lastOut[1]) {\n          parts.push(`L${p[0]},${p[1]}`);\n          lastOut = p.slice();\n        }\n        continue;\n      }\n      // Trim points\n      let pInTrim = p.slice();\n      if (vIn[0] !== 0) {\n        pInTrim[0] = p[0] - Math.sign(vIn[0]) * r;\n      } else {\n        pInTrim[1] = p[1] - Math.sign(vIn[1]) * r;\n      }\n      let pOutTrim = p.slice();\n      if (vOut[0] !== 0) {\n        pOutTrim[0] = p[0] + Math.sign(vOut[0]) * r;\n      } else {\n        pOutTrim[1] = p[1] + Math.sign(vOut[1]) * r;\n      }\n      // Line to trimmed incoming point\n      if (pInTrim[0] !== lastOut[0] || pInTrim[1] !== lastOut[1]) {\n        parts.push(`L${pInTrim[0]},${pInTrim[1]}`);\n      }\n      // Determine sweep flag (clockwise vs counter-clockwise) using z of 2D cross\n      const cross = vIn[0] * vOut[1] - vIn[1] * vOut[0];\n      const sweep = cross < 0 ? 0 : 1;\n      // Use small arc (90°) => large-arc-flag = 0\n      parts.push(`A${r},${r} 0 0 ${sweep} ${pOutTrim[0]},${pOutTrim[1]}`);\n      totalTrim += 2 * r;\n      arcCount++;\n      lastOut = pOutTrim;\n    }\n    // Last point\n    const pEnd = pts[pts.length - 1];\n    if (pEnd[0] !== lastOut[0] || pEnd[1] !== lastOut[1]) {\n      parts.push(`L${pEnd[0]},${pEnd[1]}`);\n    }\n    // If no arcs applied, skip\n    if (!arcCount) {\n      perfInc('routing.arc.none', 1);\n      return null;\n    }\n    perfInc('routing.arc.apply', 1);\n    const newResult = {\n      ...routeResult,\n      d: parts.join(' '),\n      meta: {\n        ...routeResult.meta,\n        arc: {\n          count: arcCount,\n          trimPx: Math.round(totalTrim)\n        }\n      }\n    };\n    return newResult;\n  }\n\n  _applySmoothing(routeResult, req) {\n    const mode = req.smoothingMode;\n    if (mode === 'none' || req.smoothingIterations <= 0) return null;\n    let iters = Math.min(5, Math.max(1, req.smoothingIterations|0));\n    if (!Array.isArray(routeResult.pts) || routeResult.pts.length < 3) return null;\n    if (mode !== 'chaikin') return null; // only mode supported now\n    let pts = routeResult.pts.map(p=>[p[0],p[1]]);\n    // If arcs already applied we try to reconstruct polyline from original pts (already available)\n    // Chaikin corner cutting\n    for (let k=0; k<iters; k++) {\n      const next = [pts[0]];\n      for (let i=0;i<pts.length-1;i++){\n        const p=pts[i], q=pts[i+1];\n        const Q=[0.75*p[0]+0.25*q[0], 0.75*p[1]+0.25*q[1]];\n        const R=[0.25*p[0]+0.75*q[0], 0.25*p[1]+0.75*q[1]];\n        next.push(Q,R);\n        if (next.length >= req.smoothingMaxPoints) break;\n      }\n      next.push(pts[pts.length-1]);\n      pts = next;\n      if (pts.length >= req.smoothingMaxPoints) break;\n    }\n    // Build path (polyline with many short segments)\n    const d = pts.reduce((acc,p,i)=> acc + (i?` L${p[0]},${p[1]}`:`M${p[0]},${p[1]}`),'');\n    const newMeta = {\n      ...routeResult.meta,\n      smooth: {\n        mode,\n        iterations: iters,\n        points: pts.length,\n        addedPoints: pts.length - routeResult.pts.length\n      }\n    };\n    perfInc('routing.smooth.apply',1);\n    return { ...routeResult, d, pts, meta: newMeta };\n  }\n}\n\n// Simple min-heap for A*\nclass MinHeap {\n  constructor(){ this.a=[]; }\n  push(n){ this.a.push(n); this._up(this.a.length-1); }\n  pop(){\n    if(!this.a.length) return null;\n    const top=this.a[0];\n    const last=this.a.pop();\n    if(this.a.length){ this.a[0]=last; this._down(0); }\n    return top;\n  }\n  isEmpty(){ return this.a.length===0; }\n  _up(i){\n    while(i>0){\n      const p=(i-1)>>1;\n      if(this.a[p].f <= this.a[i].f) break;\n      [this.a[p],this.a[i]]=[this.a[i],this.a[p]];\n      i=p;\n    }\n  }\n  _down(i){\n    const n=this.a.length;\n    while(true){\n      let l=i*2+1, r=l+1, m=i;\n      if(l<n && this.a[l].f < this.a[m].f) m=l;\n      if(r<n && this.a[r].f < this.a[m].f) m=r;\n      if(m===i) break;\n      [this.a[m],this.a[i]]=[this.a[i],this.a[m]];\n      i=m;\n    }\n  }\n}\n","/**\n * Object hashing utilities for semantic comparison\n * Used by animation registry and other caching systems\n */\n\n/**\n * Compute deterministic hash of an object\n */\nexport function computeObjectHash(obj) {\n  const normalized = normalizeForHashing(obj);\n  const serialized = stableStringify(normalized);\n  return simpleHash(serialized);\n}\n\n/**\n * Normalize object for consistent hashing\n */\nfunction normalizeForHashing(obj) {\n  if (obj === null || obj === undefined) return null;\n\n  if (typeof obj !== 'object') return obj;\n\n  if (Array.isArray(obj)) {\n    return obj.map(normalizeForHashing);\n  }\n\n  const normalized = {};\n  Object.keys(obj).sort().forEach(key => {\n    normalized[key] = normalizeForHashing(obj[key]);\n  });\n\n  return normalized;\n}\n\n/**\n * Stable JSON stringify with sorted keys\n */\nfunction stableStringify(obj) {\n  if (typeof obj !== 'object' || obj === null) {\n    return JSON.stringify(obj);\n  }\n\n  if (Array.isArray(obj)) {\n    return '[' + obj.map(stableStringify).join(',') + ']';\n  }\n\n  const keys = Object.keys(obj).sort();\n  const pairs = keys.map(key => `\"${key}\":${stableStringify(obj[key])}`);\n  return '{' + pairs.join(',') + '}';\n}\n\n/**\n * Simple but effective hash function\n */\nfunction simpleHash(str) {\n  let hash = 0;\n\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // Convert to 32bit integer\n  }\n\n  // Convert to positive string\n  return Math.abs(hash).toString(36);\n}\n\n/**\n * Compare two objects for semantic equality\n */\nexport function objectsEqual(a, b) {\n  return computeObjectHash(a) === computeObjectHash(b);\n}\n\n/**\n * Hash array of objects consistently\n */\nexport function hashArray(arr) {\n  if (!Array.isArray(arr)) return computeObjectHash(arr);\n\n  const hashes = arr.map(computeObjectHash);\n  return simpleHash(hashes.join('|'));\n}\n","import { perfTime, perfTimeAsync, perfCount } from '../util/performance.js';\nimport { computeObjectHash } from '../util/hashing.js';\n\n/**\n * Animation Registry for efficient animation reuse\n * Provides semantic comparison and intelligent caching\n */\nexport class AnimationRegistry {\n  constructor() {\n    this.cache = new Map(); // hash -> instance\n    this.instanceToHash = new WeakMap(); // instance -> hash\n    this.usageStats = new Map(); // hash -> { count, lastUsed }\n    this.maxCacheSize = 500;\n    this.cleanupThreshold = 600;\n\n    // Performance tracking\n    this.perfStats = {\n      cacheHits: 0,\n      cacheMisses: 0,\n      instancesCreated: 0,\n      instancesReused: 0,\n      cleanupRuns: 0\n    };\n  }\n\n  /**\n   * Get or create animation instance with intelligent reuse\n   */\n  getOrCreateInstance(definition, targets) {\n    return perfTime('animation.getInstance', () => {\n      const hash = this.computeInstanceHash(definition);\n\n      // Check cache first\n      if (this.cache.has(hash)) {\n        const cached = this.cache.get(hash);\n\n        // Verify targets compatibility\n        if (this.targetsCompatible(cached.targets, targets)) {\n          this.recordCacheHit(hash);\n          perfCount('animation.instance.reuse', 1);\n          this.perfStats.instancesReused++;\n\n          return this.reuseInstance(cached, targets);\n        } else {\n          // Targets incompatible, remove from cache\n          this.cache.delete(hash);\n          this.perfStats.cacheMisses++;\n        }\n      }\n\n      // Create new instance\n      const instance = this.createAnimationInstance(definition, targets);\n\n      // Cache the instance\n      this.cacheInstance(hash, instance, definition);\n\n      perfCount('animation.instance.new', 1);\n      this.perfStats.instancesCreated++;\n      this.perfStats.cacheMisses++;\n\n      return instance;\n    });\n  }\n\n  /**\n   * Compute semantic hash for animation definition\n   */\n  computeInstanceHash(definition) {\n    // Extract only semantic properties (exclude DOM references)\n    const semantic = {\n      preset: definition.preset,\n      params: this.normalizeParams(definition.params),\n      duration: this.normalizeNumber(definition.duration),\n      easing: definition.easing,\n      loop: definition.loop,\n      alternate: definition.alternate,\n      delay: this.normalizeNumber(definition.delay),\n      // Exclude: targets, callbacks, DOM-specific properties\n    };\n\n    // Handle animation_ref and overrides\n    if (definition.animation_ref) {\n      semantic.animation_ref = definition.animation_ref;\n      if (definition.override) {\n        semantic.override = this.normalizeParams(definition.override.params);\n      }\n    }\n\n    return computeObjectHash(semantic);\n  }\n\n  /**\n   * Normalize a single number to prevent precision churn\n   */\n  normalizeNumber(value) {\n    if (typeof value === 'number') {\n      return Math.round(value * 1000) / 1000;\n    }\n    return value;\n  }\n\n  /**\n   * Normalize parameters to reduce hash churn from floating point precision\n   */\n  normalizeParams(params) {\n    if (!params || typeof params !== 'object') return params;\n\n    const normalized = {};\n    Object.entries(params).forEach(([key, value]) => {\n      if (typeof value === 'number') {\n        // Round to 3 decimal places to prevent hash churn\n        normalized[key] = Math.round(value * 1000) / 1000;\n      } else if (Array.isArray(value)) {\n        normalized[key] = value.map(v =>\n          typeof v === 'number' ? Math.round(v * 1000) / 1000 : v\n        );\n      } else if (typeof value === 'object' && value !== null) {\n        normalized[key] = this.normalizeParams(value);\n      } else {\n        normalized[key] = value;\n      }\n    });\n\n    return normalized;\n  }\n\n  /**\n   * Check if animation targets are compatible for reuse\n   */\n  targetsCompatible(cachedTargets, newTargets) {\n    if (!cachedTargets || !newTargets) return false;\n\n    // Convert to arrays for comparison\n    const cached = Array.isArray(cachedTargets) ? cachedTargets : [cachedTargets];\n    const newOnes = Array.isArray(newTargets) ? newTargets : [newTargets];\n\n    if (cached.length !== newOnes.length) return false;\n\n    // For DOM elements, compare by id or selector\n    for (let i = 0; i < cached.length; i++) {\n      const cachedTarget = cached[i];\n      const newTarget = newOnes[i];\n\n      // String selectors must match exactly\n      if (typeof cachedTarget === 'string' && typeof newTarget === 'string') {\n        if (cachedTarget !== newTarget) return false;\n        continue;\n      }\n\n      // DOM elements - compare by id or position in DOM\n      if (cachedTarget?.id && newTarget?.id) {\n        if (cachedTarget.id !== newTarget.id) return false;\n        continue;\n      }\n\n      // If we can't determine compatibility, assume incompatible\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Create new animation instance using the runtime animation system\n   */\n  createAnimationInstance(definition, targets) {\n    try {\n      // Use the global animation system if available\n      if (typeof window !== 'undefined' && window.cblcars?.anim?.create) {\n        return window.cblcars.anim.create(definition, targets);\n      }\n\n      // Fallback mock for testing\n      return {\n        definition: { ...definition },\n        targets: Array.isArray(targets) ? [...targets] : [targets],\n        id: `anim_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        play: () => {},\n        pause: () => {},\n        stop: () => {},\n        restart: () => {}\n      };\n    } catch (error) {\n      console.warn('[AnimationRegistry] Failed to create animation instance:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Reuse existing animation instance with new targets\n   */\n  reuseInstance(cachedInstance, newTargets) {\n    try {\n      // If the animation system supports retargeting, use it\n      if (cachedInstance.retarget && typeof cachedInstance.retarget === 'function') {\n        return cachedInstance.retarget(newTargets);\n      }\n\n      // Otherwise, create a shallow copy with new targets\n      return {\n        ...cachedInstance,\n        targets: Array.isArray(newTargets) ? [...newTargets] : [newTargets],\n        id: `${cachedInstance.id}_reused_${Date.now()}`\n      };\n    } catch (error) {\n      console.warn('[AnimationRegistry] Failed to reuse animation instance:', error);\n      return this.createAnimationInstance(cachedInstance.definition, newTargets);\n    }\n  }\n\n  /**\n   * Cache animation instance with metadata\n   */\n  cacheInstance(hash, instance, definition) {\n    // Store in cache\n    this.cache.set(hash, {\n      instance,\n      definition,\n      targets: instance.targets,\n      createdAt: Date.now(),\n      hash\n    });\n\n    // Track usage\n    this.usageStats.set(hash, {\n      count: 1,\n      lastUsed: Date.now(),\n      hash\n    });\n\n    // Map instance back to hash for debugging\n    this.instanceToHash.set(instance, hash);\n\n    // Clean cache if needed AFTER adding the new item\n    if (this.cache.size > this.maxCacheSize) {\n      this.cleanupCache();\n    }\n  }\n\n  /**\n   * Record cache hit and update usage statistics\n   */\n  recordCacheHit(hash) {\n    const usage = this.usageStats.get(hash);\n    if (usage) {\n      usage.count++;\n      usage.lastUsed = Date.now();\n    }\n\n    this.perfStats.cacheHits++;\n  }\n\n  /**\n   * Clean up least recently used cache entries\n   */\n  cleanupCache() {\n    perfTime('animation.cache.cleanup', () => {\n      const entries = Array.from(this.usageStats.entries());\n\n      // Sort by last used time (oldest first)\n      entries.sort(([, a], [, b]) => a.lastUsed - b.lastUsed);\n\n      // Remove oldest entries until we're under max size\n      const toRemove = entries.slice(0, entries.length - this.maxCacheSize);\n\n      toRemove.forEach(([hash]) => {\n        this.cache.delete(hash);\n        this.usageStats.delete(hash);\n      });\n\n      this.perfStats.cleanupRuns++;\n      perfCount('animation.cache.cleanup', toRemove.length);\n    });\n  }\n\n  /**\n   * Get performance statistics\n   */\n  getStats() {\n    const stats = { ...this.perfStats };\n\n    stats.cacheSize = this.cache.size;\n    stats.hitRate = stats.cacheHits / (stats.cacheHits + stats.cacheMisses) || 0;\n    stats.reuseRate = stats.instancesReused / (stats.instancesReused + stats.instancesCreated) || 0;\n\n    return stats;\n  }\n\n  /**\n   * Get cache contents for debugging\n   */\n  getCacheContents() {\n    const contents = {};\n\n    this.cache.forEach((cached, hash) => {\n      const usage = this.usageStats.get(hash);\n      contents[hash] = {\n        definition: cached.definition,\n        createdAt: cached.createdAt,\n        usage: usage ? { count: usage.count, lastUsed: usage.lastUsed } : null\n      };\n    });\n\n    return contents;\n  }\n\n  /**\n   * Clear cache and reset statistics\n   */\n  clear() {\n    this.cache.clear();\n    this.usageStats.clear();\n    this.perfStats = {\n      cacheHits: 0,\n      cacheMisses: 0,\n      instancesCreated: 0,\n      instancesReused: 0,\n      cleanupRuns: 0\n    };\n\n    perfCount('animation.cache.cleared', 1);\n  }\n\n  /**\n   * Export cache statistics for analysis\n   */\n  exportStats(options = {}) {\n    const stats = this.getStats();\n\n    if (options.includeCache) {\n      stats.cacheContents = this.getCacheContents();\n    }\n\n    if (options.format === 'csv') {\n      return this.exportToCsv(stats);\n    }\n\n    return JSON.stringify(stats, null, 2);\n  }\n\n  exportToCsv(stats) {\n    const rows = [\n      'metric,value',\n      `cacheHits,${stats.cacheHits}`,\n      `cacheMisses,${stats.cacheMisses}`,\n      `instancesCreated,${stats.instancesCreated}`,\n      `instancesReused,${stats.instancesReused}`,\n      `cacheSize,${stats.cacheSize}`,\n      `hitRate,${stats.hitRate.toFixed(3)}`,\n      `reuseRate,${stats.reuseRate.toFixed(3)}`,\n      `cleanupRuns,${stats.cleanupRuns}`\n    ];\n\n    return rows.join('\\n');\n  }\n}\n\n// Create global registry instance\nconst globalAnimationRegistry = new AnimationRegistry();\n\n// Debug exposure\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdAnimRegistry = {\n    registry: globalAnimationRegistry,\n    getStats: () => globalAnimationRegistry.getStats(),\n    getCacheContents: () => globalAnimationRegistry.getCacheContents(),\n    clear: () => globalAnimationRegistry.clear(),\n    export: (options) => globalAnimationRegistry.exportStats(options)\n  };\n}\n\nexport { globalAnimationRegistry };\n","/**\n * Ring buffer for rule evaluation traces\n * Provides debugging capabilities and HUD integration\n */\n\nexport class RuleTraceBuffer {\n  constructor(maxSize = 1000) {\n    this.buffer = [];\n    this.maxSize = maxSize;\n    this.index = 0;\n    this.totalTraces = 0;\n  }\n\n  addTrace(ruleId, matched, conditions, evaluationTime, metadata = {}) {\n    const trace = {\n      ruleId,\n      matched,\n      conditions,\n      evaluationTime,\n      timestamp: Date.now(),\n      metadata: { ...metadata }\n    };\n\n    if (this.buffer.length < this.maxSize) {\n      this.buffer.push(trace);\n    } else {\n      this.buffer[this.index] = trace;\n      this.index = (this.index + 1) % this.maxSize;\n    }\n\n    this.totalTraces++;\n  }\n\n  getRecentTraces(limit = 50, filter = {}) {\n    const recent = [];\n    let idx = this.index - 1;\n\n    for (let i = 0; i < Math.min(limit, this.buffer.length); i++) {\n      if (idx < 0) idx = this.buffer.length - 1;\n\n      const trace = this.buffer[idx];\n      if (this.matchesFilter(trace, filter)) {\n        recent.unshift(trace);\n      }\n\n      idx--;\n    }\n\n    return recent;\n  }\n\n  getRuleHistory(ruleId, limit = 20) {\n    return this.getRecentTraces(this.buffer.length, { ruleId }).slice(0, limit);\n  }\n\n  getMatchedRules(timeWindow = 60000, limit = 100) {\n    const cutoff = Date.now() - timeWindow;\n    return this.getRecentTraces(this.buffer.length, { matched: true })\n      .filter(trace => trace.timestamp > cutoff)\n      .slice(0, limit);\n  }\n\n  getStats() {\n    const recent = this.getRecentTraces(this.buffer.length);\n    const matched = recent.filter(t => t.matched).length;\n    const avgEvalTime = recent.length > 0\n      ? recent.reduce((sum, t) => sum + t.evaluationTime, 0) / recent.length\n      : 0;\n\n    return {\n      totalTraces: this.totalTraces,\n      bufferedTraces: this.buffer.length,\n      recentMatched: matched,\n      recentTotal: recent.length,\n      matchRate: recent.length > 0 ? matched / recent.length : 0,\n      avgEvaluationTime: avgEvalTime\n    };\n  }\n\n  matchesFilter(trace, filter) {\n    if (filter.ruleId && trace.ruleId !== filter.ruleId) return false;\n    if (filter.matched !== undefined && trace.matched !== filter.matched) return false;\n    if (filter.minTime && trace.timestamp < filter.minTime) return false;\n    if (filter.maxTime && trace.timestamp > filter.maxTime) return false;\n    if (filter.minEvalTime && trace.evaluationTime < filter.minEvalTime) return false;\n\n    return true;\n  }\n\n  clear() {\n    this.buffer = [];\n    this.index = 0;\n    this.totalTraces = 0;\n  }\n\n  exportTraces(options = {}) {\n    const {\n      format = 'json',\n      limit = 100,\n      includeConditions = true,\n      includeMetadata = false\n    } = options;\n\n    const traces = this.getRecentTraces(limit);\n\n    const exported = traces.map(trace => {\n      const exported = {\n        ruleId: trace.ruleId,\n        matched: trace.matched,\n        evaluationTime: trace.evaluationTime,\n        timestamp: trace.timestamp\n      };\n\n      if (includeConditions) {\n        exported.conditions = trace.conditions;\n      }\n\n      if (includeMetadata) {\n        exported.metadata = trace.metadata;\n      }\n\n      return exported;\n    });\n\n    if (format === 'csv') {\n      return this.exportToCsv(exported);\n    }\n\n    return JSON.stringify(exported, null, 2);\n  }\n\n  exportToCsv(traces) {\n    if (traces.length === 0) return 'No traces available\\n';\n\n    const headers = ['ruleId', 'matched', 'evaluationTime', 'timestamp'];\n    const rows = traces.map(trace => [\n      trace.ruleId,\n      trace.matched,\n      trace.evaluationTime.toFixed(3),\n      new Date(trace.timestamp).toISOString()\n    ]);\n\n    return [\n      headers.join(','),\n      ...rows.map(row => row.join(','))\n    ].join('\\n');\n  }\n}\n\n// Global trace buffer instance\nconst globalTraceBuffer = new RuleTraceBuffer();\n\n// Node.js and browser compatibility\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdRuleTrace = {\n    buffer: globalTraceBuffer,\n    getRecent: (limit) => globalTraceBuffer.getRecentTraces(limit),\n    getStats: () => globalTraceBuffer.getStats(),\n    getRuleHistory: (ruleId) => globalTraceBuffer.getRuleHistory(ruleId),\n    export: (options) => globalTraceBuffer.exportTraces(options),\n    clear: () => globalTraceBuffer.clear()\n  };\n}\n\nexport { globalTraceBuffer };\n","import { perfTime, perfCount } from '../util/performance.js';\nimport { globalTraceBuffer } from './RuleTraceBuffer.js';\n\nexport class RulesEngine {\n  constructor(rules = [], dataSourceManager = null) {\n    this.rules = Array.isArray(rules) ? rules : [];\n    this.rulesById = new Map();\n    this.dependencyIndex = null;\n    this.dirtyRules = new Set();\n    this.lastEvaluation = new Map(); // ruleId -> evaluation result\n    this.traceBuffer = globalTraceBuffer;\n    this.stopProcessing = new Map(); // overlayId -> Set of stopped rule priorities\n\n    // NEW: DataSource integration\n    this.dataSourceManager = dataSourceManager;\n\n    // Performance tracking\n    this.evalCounts = {\n      total: 0,\n      dirty: 0,\n      matched: 0,\n      skipped: 0\n    };\n\n    this.buildRulesIndex();\n    this.buildDependencyIndex();\n    this.markAllDirty(); // Initial state\n  }\n\n  buildRulesIndex() {\n    this.rulesById.clear();\n    this.rules.forEach(rule => {\n      if (rule.id) {\n        this.rulesById.set(rule.id, rule);\n      }\n    });\n  }\n\n  buildDependencyIndex() {\n    const entityToRules = new Map();\n    const ruleToEntities = new Map();\n\n    this.rules.forEach(rule => {\n      const entities = this.extractEntityReferences(rule);\n      ruleToEntities.set(rule.id, entities);\n\n      entities.forEach(entityId => {\n        if (!entityToRules.has(entityId)) {\n          entityToRules.set(entityId, new Set());\n        }\n        entityToRules.get(entityId).add(rule.id);\n      });\n    });\n\n    this.dependencyIndex = { entityToRules, ruleToEntities };\n\n    // Debug exposure\n    try {\n      const debugNamespace = (typeof window !== 'undefined') ? window : global;\n      if (debugNamespace.__msdDebug) {\n        debugNamespace.__msdDebug.rulesDeps = {\n          entityToRules: Object.fromEntries(entityToRules),\n          ruleToEntities: Object.fromEntries(ruleToEntities),\n          totalEntities: entityToRules.size,\n          totalRules: this.rules.length\n        };\n      }\n    } catch (e) {}\n  }\n\n  extractEntityReferences(rule) {\n    const entities = new Set();\n\n    if (!rule.when) return Array.from(entities);\n\n    // Extract from all/any conditions\n    const conditions = [\n      ...(rule.when.all || []),\n      ...(rule.when.any || [])\n    ];\n\n    conditions.forEach(condition => {\n      // Direct entity reference\n      if (condition.entity) {\n        // Check if this is a DataSource reference\n        if (condition.entity.includes('.') && this.dataSourceManager) {\n          const sourceName = condition.entity.split('.')[0];\n          const dataSource = this.dataSourceManager.getSource(sourceName);\n          if (dataSource) {\n            // Add the DataSource itself to dependencies\n            entities.add(sourceName);\n            // Also add the full reference for more granular tracking\n            entities.add(condition.entity);\n          } else {\n            // Treat as regular entity if DataSource not found\n            entities.add(condition.entity);\n          }\n        } else {\n          // Regular Home Assistant entity\n          entities.add(condition.entity);\n        }\n      }\n\n      // Entity attribute reference (e.g., \"sensor.temp.state\")\n      if (condition.entity_attr) {\n        const entityId = condition.entity_attr.split('.')[0];\n        entities.add(entityId);\n      }\n\n      // Map range condition\n      if (condition.map_range_cond?.entity) {\n        entities.add(condition.map_range_cond.entity);\n      }\n\n      // Value map references in rule conditions\n      if (condition.value_map?.entity) {\n        entities.add(condition.value_map.entity);\n      }\n    });\n\n    return Array.from(entities);\n  }\n\n  markEntitiesDirty(changedEntityIds) {\n    if (!Array.isArray(changedEntityIds)) {\n      changedEntityIds = [changedEntityIds];\n    }\n\n    let affectedRules = 0;\n\n    changedEntityIds.forEach(entityId => {\n      // Direct entity/DataSource rule matches\n      const rules = this.dependencyIndex.entityToRules.get(entityId);\n      if (rules) {\n        rules.forEach(ruleId => {\n          if (!this.dirtyRules.has(ruleId)) {\n            this.dirtyRules.add(ruleId);\n            affectedRules++;\n          }\n        });\n      }\n\n      // Handle DataSource change propagation\n      // If a DataSource changes, mark rules that depend on its transformations/aggregations\n      if (this.dataSourceManager?.getSource(entityId)) {\n        // Find rules that depend on this DataSource's transformations/aggregations\n        for (const [fullRef, ruleSet] of this.dependencyIndex.entityToRules) {\n          if (fullRef.startsWith(`${entityId}.`)) {\n            ruleSet.forEach(ruleId => {\n              if (!this.dirtyRules.has(ruleId)) {\n                this.dirtyRules.add(ruleId);\n                affectedRules++;\n              }\n            });\n          }\n        }\n      }\n    });\n\n    perfCount('rules.dirty.entities', changedEntityIds.length);\n    perfCount('rules.dirty.affected', affectedRules);\n\n    return affectedRules;\n  }\n\n  markAllDirty() {\n    this.dirtyRules.clear();\n    this.rules.forEach(rule => {\n      if (rule.id) {\n        this.dirtyRules.add(rule.id);\n      }\n    });\n    perfCount('rules.dirty.all', this.dirtyRules.size);\n  }\n\n  evaluateDirty(context = {}) {\n    return perfTime('rules.evaluate', () => {\n      let { getEntity } = context;\n\n      // NEW: Use DataSourceManager's enhanced getEntity if available\n      if (!getEntity && this.dataSourceManager) {\n        getEntity = (entityId) => {\n          // Check if this is a DataSource reference\n          if (entityId.includes('.') && this.dataSourceManager) {\n            const value = this.resolveDataSourceValue(entityId);\n            if (value !== null) {\n              // Return entity-like object for DataSource values\n              return {\n                entity_id: entityId,\n                state: String(value),\n                attributes: {}\n              };\n            }\n          }\n\n          // Try DataSourceManager's getEntity method\n          if (this.dataSourceManager.getEntity) {\n            const entity = this.dataSourceManager.getEntity(entityId);\n            if (entity) return entity;\n          }\n\n          // Fallback: try entity index directly\n          if (this.dataSourceManager.entityIndex) {\n            const entity = this.dataSourceManager.entityIndex.get(entityId);\n            if (entity) return entity;\n          }\n\n          return null;\n        };\n      }\n\n      if (!getEntity || typeof getEntity !== 'function') {\n        console.warn('[RulesEngine] evaluateDirty called without getEntity function and no DataSourceManager available');\n        return this.createEmptyResult();\n      }\n\n      const totalDirty = this.dirtyRules.size;\n      const results = [];\n      const processedRules = new Set();\n\n      // Sort dirty rules by priority (higher first)\n      const dirtyRulesArray = Array.from(this.dirtyRules)\n        .map(ruleId => this.rulesById.get(ruleId))\n        .filter(rule => rule)\n        .sort((a, b) => (b.priority || 0) - (a.priority || 0));\n\n      dirtyRulesArray.forEach(rule => {\n        if (processedRules.has(rule.id)) return;\n\n        const result = this.evaluateRule(rule, getEntity);\n        processedRules.add(rule.id);\n\n        // Cache evaluation result\n        this.lastEvaluation.set(rule.id, {\n          matched: result.matched,\n          timestamp: Date.now(),\n          conditions: result.conditions\n        });\n\n        if (result.matched) {\n          results.push(result);\n          this.evalCounts.matched++;\n        }\n\n        // Remove from dirty set\n        this.dirtyRules.delete(rule.id);\n      });\n\n      // Performance tracking\n      this.evalCounts.total += totalDirty;\n      this.evalCounts.dirty += totalDirty;\n      this.evalCounts.skipped += (this.rules.length - totalDirty);\n\n      perfCount('rules.eval.total', totalDirty);\n      perfCount('rules.eval.matched', results.length);\n      perfCount('rules.eval.skipped', this.rules.length - totalDirty);\n\n      return this.aggregateResults(results);\n    });\n  }\n\n  evaluateRule(rule, getEntity) {\n    const startTime = performance.now();\n\n    try {\n      const conditions = this.evaluateConditions(rule.when, getEntity);\n      const matched = this.determineMatch(rule.when, conditions);\n      const evaluationTime = performance.now() - startTime;\n\n      const result = {\n        ruleId: rule.id,\n        priority: rule.priority || 0,\n        matched,\n        conditions,\n        rule,\n        evaluationTime\n      };\n\n      // Add trace entry\n      this.traceBuffer.addTrace(\n        rule.id,\n        matched,\n        conditions,\n        evaluationTime,\n        {\n          priority: rule.priority || 0,\n          conditionCount: this.countConditions(rule.when),\n          entityRefs: this.dependencyIndex?.ruleToEntities.get(rule.id) || []\n        }\n      );\n\n      if (matched && rule.apply) {\n        result.overlayPatches = rule.apply.overlays || [];\n        result.profilesAdd = rule.apply.profiles_add || [];\n        result.profilesRemove = rule.apply.profiles_remove || [];\n        result.animations = rule.apply.animations || [];\n        result.stopAfter = rule.stop === true;\n      }\n\n      return result;\n\n    } catch (error) {\n      const evaluationTime = performance.now() - startTime;\n\n      // Trace error\n      this.traceBuffer.addTrace(\n        rule.id,\n        false,\n        {},\n        evaluationTime,\n        { error: error.message }\n      );\n\n      console.warn(`[RulesEngine] Error evaluating rule ${rule.id}:`, error);\n      return {\n        ruleId: rule.id,\n        matched: false,\n        error: error.message,\n        evaluationTime\n      };\n    }\n  }\n\n  evaluateConditions(when, getEntity) {\n    if (!when) return {};\n\n    const results = {};\n\n    // Evaluate all conditions\n    if (when.all) {\n      results.all = when.all.map(condition => this.evaluateCondition(condition, getEntity));\n    }\n\n    // Evaluate any conditions\n    if (when.any) {\n      results.any = when.any.map(condition => this.evaluateCondition(condition, getEntity));\n    }\n\n    return results;\n  }\n\n  evaluateCondition(condition, getEntity) {\n    const result = {\n      condition,\n      matched: false,\n      value: null,\n      error: null\n    };\n\n    try {\n      // Entity state condition (supports both HA entities and DataSource references)\n      if (condition.entity) {\n        // Check if this is a DataSource reference (contains dots) - handle it directly\n        if (condition.entity.includes('.') && this.dataSourceManager) {\n          const dataSourceValue = this.resolveDataSourceValue(condition.entity);\n          if (dataSourceValue === null) {\n            result.error = `DataSource ${condition.entity} not found or no data`;\n            return result;\n          }\n\n          result.value = dataSourceValue;\n\n          // Numeric comparisons for DataSource values\n          if (condition.above !== undefined) {\n            const numValue = parseFloat(dataSourceValue);\n            result.matched = !isNaN(numValue) && numValue > condition.above;\n          } else if (condition.below !== undefined) {\n            const numValue = parseFloat(dataSourceValue);\n            result.matched = !isNaN(numValue) && numValue < condition.below;\n          } else if (condition.equals !== undefined) {\n            result.matched = dataSourceValue == condition.equals;\n          } else {\n            result.matched = true; // DataSource exists and has data\n          }\n\n          return result; // Return immediately for DataSource conditions\n        } else {\n          // Standard Home Assistant entity\n          const entity = getEntity(condition.entity);\n          if (!entity) {\n            result.error = `Entity ${condition.entity} not found`;\n            return result;\n          }\n\n          result.value = entity.state;\n\n          // Numeric comparisons for entity state\n          if (condition.above !== undefined) {\n            const numValue = parseFloat(entity.state);\n            result.matched = !isNaN(numValue) && numValue > condition.above;\n          } else if (condition.below !== undefined) {\n            const numValue = parseFloat(entity.state);\n            result.matched = !isNaN(numValue) && numValue < condition.below;\n          } else if (condition.equals !== undefined) {\n            result.matched = entity.state == condition.equals;\n          } else {\n            result.matched = true; // Entity exists\n          }\n        }\n      }\n\n      // Time between condition\n      if (condition.time_between) {\n        result.matched = this.evaluateTimeBetween(condition.time_between);\n        result.value = new Date().toTimeString().substring(0, 5);\n      }\n\n      // Map range condition\n      if (condition.map_range_cond) {\n        result.matched = this.evaluateMapRangeCondition(condition.map_range_cond, getEntity);\n      }\n\n    } catch (error) {\n      result.error = error.message;\n    }\n\n    return result;\n  }\n\n  evaluateTimeBetween(timeRange) {\n    const [startTime, endTime] = timeRange.split('-');\n    const now = new Date();\n    const currentTime = now.getHours() * 60 + now.getMinutes();\n\n    const [startHour, startMin] = startTime.split(':').map(Number);\n    const [endHour, endMin] = endTime.split(':').map(Number);\n\n    const start = startHour * 60 + startMin;\n    const end = endHour * 60 + endMin;\n\n    if (start <= end) {\n      return currentTime >= start && currentTime <= end;\n    } else {\n      // Crosses midnight\n      return currentTime >= start || currentTime <= end;\n    }\n  }\n\n  evaluateMapRangeCondition(mapRangeCondition, getEntity) {\n    const { entity, input, output, above, below, equals } = mapRangeCondition;\n\n    const entityObj = getEntity(entity);\n    if (!entityObj) return false;\n\n    const rawValue = parseFloat(entityObj.state);\n    if (isNaN(rawValue)) return false;\n\n    // Map the value\n    const mappedValue = this.mapRange(rawValue, input, output);\n\n    // Apply condition on mapped value\n    if (above !== undefined) return mappedValue > above;\n    if (below !== undefined) return mappedValue < below;\n    if (equals !== undefined) return Math.abs(mappedValue - equals) < 0.001;\n\n    return false;\n  }\n\n  mapRange(value, inputRange, outputRange) {\n    const [inMin, inMax] = inputRange;\n    const [outMin, outMax] = outputRange;\n\n    // Clamp input value\n    const clampedValue = Math.max(inMin, Math.min(inMax, value));\n\n    // Linear interpolation\n    const ratio = (clampedValue - inMin) / (inMax - inMin);\n    return outMin + ratio * (outMax - outMin);\n  }\n\n  /**\n   * Resolve a DataSource reference to its current value\n   * @param {string} dataSourceRef - Reference like 'source.transformations.key' or 'source.aggregations.key'\n   * @returns {any|null} Resolved value or null if not found\n   */\n  resolveDataSourceValue(dataSourceRef) {\n    try {\n      // Parse the DataSource reference\n      const parts = dataSourceRef.split('.');\n      const sourceName = parts[0];\n\n      // Get the DataSource\n      const dataSource = this.dataSourceManager.getSource(sourceName);\n      if (!dataSource) {\n        return null;\n      }\n\n      const currentData = dataSource.getCurrentData();\n      if (!currentData) {\n        return null;\n      }\n\n      // Handle simple DataSource reference (just the source name)\n      if (parts.length === 1) {\n        return currentData.v;\n      }\n\n      // Handle enhanced DataSource references\n      if (parts.length >= 3) {\n        const dataType = parts[1]; // 'transformations' or 'aggregations'\n        const dataKey = parts.slice(2).join('.'); // Support nested keys\n\n        if (dataType === 'transformations' && currentData.transformations) {\n          return currentData.transformations[dataKey];\n        } else if (dataType === 'aggregations' && currentData.aggregations) {\n          const aggData = currentData.aggregations[dataKey];\n\n          // Handle aggregation objects with multiple properties\n          if (typeof aggData === 'object' && aggData !== null) {\n            // Return the most relevant value from aggregation\n            if (aggData.avg !== undefined) return aggData.avg;\n            if (aggData.value !== undefined) return aggData.value;\n            if (aggData.last !== undefined) return aggData.last;\n            if (aggData.current !== undefined) return aggData.current;\n            return aggData; // Return the object itself if no standard property\n          }\n\n          return aggData;\n        }\n      }\n\n      return null;\n    } catch (error) {\n      console.warn(`[RulesEngine] Error resolving DataSource reference '${dataSourceRef}':`, error);\n      return null;\n    }\n  }  determineMatch(when, conditions) {\n    if (!when) return false;\n\n    let allMatch = true;\n    let anyMatch = false;\n\n    // Check all conditions\n    if (when.all && conditions.all) {\n      allMatch = conditions.all.every(result => result.matched);\n    }\n\n    // Check any conditions\n    if (when.any && conditions.any) {\n      anyMatch = conditions.any.some(result => result.matched);\n    }\n\n    // Determine final match\n    if (when.all && when.any) {\n      return allMatch && anyMatch;\n    } else if (when.all) {\n      return allMatch;\n    } else if (when.any) {\n      return anyMatch;\n    }\n\n    return false;\n  }\n\n  aggregateResults(ruleResults) {\n    const aggregated = {\n      overlayPatches: [],\n      profilesAdd: [],\n      profilesRemove: [],\n      animations: []\n    };\n\n    // Group results by target overlays for stop semantics\n    const overlayGroups = new Map();\n\n    ruleResults.forEach(result => {\n      if (result.overlayPatches) {\n        result.overlayPatches.forEach(patch => {\n          if (!overlayGroups.has(patch.id)) {\n            overlayGroups.set(patch.id, []);\n          }\n          overlayGroups.get(patch.id).push({\n            ...result,\n            overlayPatch: patch\n          });\n        });\n      }\n    });\n\n    // Process each overlay group with stop semantics\n    overlayGroups.forEach((rules, overlayId) => {\n      this.processOverlayRules(overlayId, rules, aggregated);\n    });\n\n    // Add non-overlay results (profiles, animations)\n    ruleResults\n      .sort((a, b) => (b.priority || 0) - (a.priority || 0))\n      .forEach(result => {\n        if (result.profilesAdd) {\n          aggregated.profilesAdd.push(...result.profilesAdd);\n        }\n        if (result.profilesRemove) {\n          aggregated.profilesRemove.push(...result.profilesRemove);\n        }\n        if (result.animations) {\n          aggregated.animations.push(...result.animations);\n        }\n      });\n\n    return aggregated;\n  }\n\n  processOverlayRules(overlayId, rules, aggregated) {\n    // Sort by priority (higher first)\n    const sortedRules = rules.sort((a, b) => (b.priority || 0) - (a.priority || 0));\n\n    let shouldStop = false;\n\n    sortedRules.forEach(result => {\n      if (shouldStop) {\n        // Rule was stopped, add to trace\n        this.traceBuffer.addTrace(\n          result.ruleId,\n          result.matched,\n          result.conditions,\n          result.evaluationTime,\n          {\n            stopped: true,\n            stoppedBy: overlayId,\n            reason: 'stop_semantics'\n          }\n        );\n\n        perfCount('rules.stopped', 1);\n        return;\n      }\n\n      // Apply the rule result\n      if (result.overlayPatch) {\n        aggregated.overlayPatches.push(result.overlayPatch);\n      }\n\n      // Check for stop condition\n      if (result.stopAfter) {\n        shouldStop = true;\n        perfCount('rules.stop.triggered', 1);\n\n        // Add stop trace\n        this.traceBuffer.addTrace(\n          result.ruleId,\n          result.matched,\n          result.conditions,\n          result.evaluationTime,\n          {\n            stopTriggered: true,\n            affectedOverlay: overlayId\n          }\n        );\n      }\n    });\n  }\n\n  countConditions(when) {\n    if (!when) return 0;\n    return (when.all?.length || 0) + (when.any?.length || 0);\n  }\n\n  createEmptyResult() {\n    return {\n      overlayPatches: [],\n      profilesAdd: [],\n      profilesRemove: [],\n      animations: []\n    };\n  }\n\n  // Enhanced debug and introspection methods\n  getTrace() {\n    const baseTrace = {\n      totalRules: this.rules.length,\n      dirtyRules: this.dirtyRules.size,\n      lastEvaluations: Object.fromEntries(this.lastEvaluation),\n      evalCounts: { ...this.evalCounts },\n      dependencyStats: {\n        entitiesTracked: this.dependencyIndex?.entityToRules.size || 0,\n        avgRulesPerEntity: this.dependencyIndex ?\n          Array.from(this.dependencyIndex.entityToRules.values()).reduce((sum, rules) => sum + rules.size, 0) / this.dependencyIndex.entityToRules.size : 0\n      }\n    };\n\n    // Add trace buffer stats\n    const traceStats = this.traceBuffer.getStats();\n    baseTrace.traceStats = traceStats;\n\n    return baseTrace;\n  }\n\n  getRuleTrace(ruleId, limit = 20) {\n    return this.traceBuffer.getRuleHistory(ruleId, limit);\n  }\n\n  getRecentMatches(timeWindow = 60000) {\n    return this.traceBuffer.getMatchedRules(timeWindow);\n  }\n\n  exportTrace(options = {}) {\n    return this.traceBuffer.exportTraces(options);\n  }\n\n  clearTrace() {\n    this.traceBuffer.clear();\n    perfCount('rules.trace.cleared', 1);\n  }\n\n  /**\n   * Set the DataSourceManager reference (for cases where it wasn't available during construction)\n   * @param {Object} dataSourceManager - DataSourceManager instance\n   */\n  setDataSourceManager(dataSourceManager) {\n    console.log(`[RulesEngine] Setting DataSourceManager:`, dataSourceManager);\n    this.dataSourceManager = dataSourceManager;\n\n    // Rebuild dependency index to include DataSource references\n    this.buildDependencyIndex();\n\n    // Mark all rules dirty since DataSource conditions might now be evaluable\n    this.markAllDirty();\n\n    console.log(`[RulesEngine] DataSourceManager set, rebuilding dependencies and marking rules dirty`);\n  }\n\n  getRuleDependencies(ruleId) {\n    return this.dependencyIndex?.ruleToEntities.get(ruleId) || [];\n  }\n\n  getEntityDependents(entityId) {\n    return Array.from(this.dependencyIndex?.entityToRules.get(entityId) || []);\n  }\n}\n\n// Helper function for applying overlay patches from rule results\nexport function applyOverlayPatches(overlays, patches) {\n  if (!patches || patches.length === 0) {\n    return overlays;\n  }\n\n  console.log('[RulesEngine] 🎨 Applying overlay patches:', {\n    overlayCount: overlays.length,\n    patchCount: patches.length,\n    patches: patches.map(p => ({ id: p.id, styleKeys: Object.keys(p.style || {}) }))\n  });\n\n  const patchMap = new Map(patches.map(patch => [patch.id, patch]));\n\n  return overlays.map(overlay => {\n    const patch = patchMap.get(overlay.id);\n    if (!patch) {\n      return overlay;\n    }\n\n    console.log('[RulesEngine] 🎯 Applying patch to overlay:', {\n      id: overlay.id,\n      originalStyle: overlay.style,\n      originalFinalStyle: overlay.finalStyle,\n      patch: patch.style\n    });\n\n    // FIXED: Apply patches to BOTH style and finalStyle\n    const patchedOverlay = {\n      ...overlay,\n      style: {\n        ...overlay.style,\n        ...patch.style\n      },\n      finalStyle: {\n        ...(overlay.finalStyle || overlay.style || {}),\n        ...patch.style\n      }\n    };\n\n    console.log('[RulesEngine] ✅ Patched overlay result:', {\n      id: patchedOverlay.id,\n      newStyle: patchedOverlay.style,\n      newFinalStyle: patchedOverlay.finalStyle\n    });\n\n    return patchedOverlay;\n  });\n}\n","/**\n * @file DebugManager.js\n * @description Centralized debug state manager with proper initialization ordering\n */\nexport class DebugManager {\n  constructor() {\n    /** @type {Object} Debug feature states */\n    this.state = {\n      anchors: false,\n      bounding_boxes: false,\n      routing: false,\n      performance: false,\n      scale: 1.0\n    };\n\n    /** @type {Set<Function>} Change callbacks */\n    this.callbacks = new Set();\n\n    /** @type {boolean} Manager initialization state */\n    this.initialized = false;\n\n    /** @type {boolean} RouterCore readiness state */\n    this.routerReady = false;\n\n    /** @type {Array<Function>} Actions queued before router ready */\n    this.pendingRouterActions = [];\n\n    /** @type {Array<Function>} Actions queued before init */\n    this.pendingInitActions = [];\n\n    // Add debouncing properties\n    this._notifyTimeout = null;\n    this._pendingNotification = null;\n  }\n\n  /**\n   * Initialize debug manager with config\n   * @param {Object} debugConfig - Debug configuration from MSD config\n   */\n  init(debugConfig = {}) {\n    // REDUCED: Only log if debug is actually enabled\n    if (debugConfig && Object.keys(debugConfig).length > 0) {\n      console.log('[DebugManager] Initializing with config:', debugConfig);\n    }\n\n    // FIXED: Apply initial config - handle both flat and nested structures\n    if (debugConfig.overlays) {\n      // Handle nested structure: debug.overlays.anchors\n      Object.keys(this.state).forEach(key => {\n        if (key !== 'scale' && debugConfig.overlays[key] !== undefined) {\n          this.state[key] = debugConfig.overlays[key];\n        }\n      });\n    } else {\n      // Handle flat structure: debug.anchors\n      Object.keys(this.state).forEach(key => {\n        if (debugConfig[key] !== undefined) {\n          this.state[key] = debugConfig[key];\n        }\n      });\n    }\n\n    // Handle scale separately\n    if (debugConfig.scale !== undefined) {\n      this.state.scale = debugConfig.scale;\n    }\n\n    this.initialized = true;\n\n    // REDUCED: Only log state if features are enabled\n    const hasEnabledFeatures = this.isAnyEnabled();\n    if (hasEnabledFeatures) {\n      console.log('[DebugManager] State after config init:', this.state);\n    }\n\n    // Process pending init actions\n    this.pendingInitActions.forEach(action => action());\n    this.pendingInitActions = [];\n\n    // If router is already ready, process router actions too\n    if (this.routerReady) {\n      this.pendingRouterActions.forEach(action => action());\n      this.pendingRouterActions = [];\n    }\n\n    this._scheduleNotification('init');\n  }\n\n  /**\n   * Mark RouterCore as ready and process pending router-dependent actions\n   */\n  markRouterReady() {\n    this.routerReady = true;\n\n    // Process pending router actions if we're initialized\n    if (this.initialized) {\n      this.pendingRouterActions.forEach(action => action());\n      this.pendingRouterActions = [];\n      this._scheduleNotification('router-ready');\n    }\n  }\n\n  /**\n   * Enable a debug feature\n   * @param {string} feature - Feature name (anchors, bounding_boxes, routing, performance)\n   */\n  enable(feature) {\n    this._setFeature(feature, true);\n  }\n\n  /**\n   * Disable a debug feature\n   * @param {string} feature - Feature name\n   */\n  disable(feature) {\n    this._setFeature(feature, false);\n  }\n\n  /**\n   * Toggle a debug feature\n   * @param {string} feature - Feature name\n   */\n  toggle(feature) {\n    this._setFeature(feature, !this.state[feature]);\n  }\n\n  /**\n   * Set debug scale\n   * @param {number} scale - Scale multiplier (0.1 - 3.0)\n   */\n  setScale(scale) {\n    const action = () => {\n      const newScale = Math.max(0.1, Math.min(3.0, Number(scale) || 1));\n      if (newScale !== this.state.scale) {\n        this.state.scale = newScale;\n        this._scheduleNotification('scale', { scale: newScale });\n      }\n    };\n\n    this._executeWhenReady(action, false); // Scale doesn't need router\n  }\n\n  /**\n   * Get current debug state snapshot (silent - no console output)\n   * @returns {Object} Current state\n   */\n  getSnapshot() {\n    return {\n      ...this.state,\n      enabled: this.isAnyEnabled(),\n      initialized: this.initialized,\n      routerReady: this.routerReady\n    };\n  }\n\n  /**\n   * Get status with console output (for manual debugging)\n   * @returns {Object} Current state\n   */\n  status() {\n    const snapshot = this.getSnapshot();\n    console.table(snapshot);\n    return snapshot;\n  }\n\n  /**\n   * Check if any debug feature is enabled\n   * @returns {boolean} True if any feature enabled\n   */\n  isAnyEnabled() {\n    return ['anchors', 'bounding_boxes', 'routing', 'performance']\n      .some(feature => this.state[feature]);\n  }\n\n  /**\n   * Check if routing debug can be rendered\n   * @returns {boolean} True if routing debug is ready\n   */\n  canRenderRouting() {\n    return this.state.routing && this.routerReady;\n  }\n\n  /**\n   * Register callback for state changes\n   * @param {Function} callback - Change callback function\n   * @returns {Function} Unregister function\n   */\n  onChange(callback) {\n    this.callbacks.add(callback);\n    return () => this.callbacks.delete(callback);\n  }\n\n  /**\n   * Enable multiple features at once\n   * @param {string[]} features - Array of feature names\n   */\n  enableMultiple(features) {\n    features.forEach(feature => this.enable(feature));\n  }\n\n  /**\n   * Disable multiple features at once\n   * @param {string[]} features - Array of feature names\n   */\n  disableMultiple(features) {\n    features.forEach(feature => this.disable(feature));\n  }\n\n  /**\n   * Get available debug features\n   * @returns {string[]} Array of feature names\n   */\n  getAvailableFeatures() {\n    return Object.keys(this.state).filter(key => key !== 'scale');\n  }\n\n  /**\n   * Check if a specific feature is enabled\n   * @param {string} feature - Feature name\n   * @returns {boolean} True if enabled\n   */\n  isEnabled(feature) {\n    return Boolean(this.state[feature]);\n  }\n\n  /**\n   * Schedule debounced notification to prevent excessive callbacks\n   * @param {string} type - Change type\n   * @param {Object} details - Change details\n   * @private\n   */\n  _scheduleNotification(type, details) {\n    // Clear existing timeout\n    if (this._notifyTimeout) {\n      clearTimeout(this._notifyTimeout);\n    }\n\n    // Store pending notification\n    this._pendingNotification = { type, details };\n\n    // Schedule debounced notification (~60fps)\n    this._notifyTimeout = setTimeout(() => {\n      if (this._pendingNotification) {\n        this._notifyChange(this._pendingNotification.type, this._pendingNotification.details);\n        this._pendingNotification = null;\n      }\n      this._notifyTimeout = null;\n    }, 16);\n  }\n\n  /**\n   * Notify callbacks of state changes\n   * @param {string} type - Change type\n   * @param {Object} details - Change details\n   * @private\n   */\n  _notifyChange(type, details = {}) {\n    const event = {\n      type,\n      details,\n      snapshot: this.getSnapshot(),\n      timestamp: Date.now()\n    };\n\n    this.callbacks.forEach(callback => {\n      try {\n        callback(event);\n      } catch (error) {\n        console.warn('[DebugManager] Callback error:', error);\n      }\n    });\n  }\n\n  /**\n   * Set feature state with proper queuing\n   * @param {string} feature - Feature name\n   * @param {boolean} enabled - Enable state\n   * @private\n   */\n  _setFeature(feature, enabled) {\n    if (!this.state.hasOwnProperty(feature) || feature === 'scale') {\n      console.warn(`[DebugManager] Invalid debug feature: ${feature}`);\n      return;\n    }\n\n    const action = () => {\n      if (this.state[feature] !== enabled) {\n        console.log(`[DebugManager] Setting ${feature} to ${enabled}`);\n        this.state[feature] = enabled;\n        this._scheduleNotification('feature', { feature, enabled });\n\n        // FIXED: Trigger immediate re-render when feature state changes\n        setTimeout(() => {\n          try {\n            const pipelineInstance = window.__msdDebug?.pipelineInstance;\n            if (pipelineInstance?.reRender) {\n              console.log(`[DebugManager] Auto re-render after ${feature} ${enabled ? 'enable' : 'disable'}`);\n              pipelineInstance.reRender();\n            }\n          } catch (error) {\n            console.warn('[DebugManager] Auto re-render failed:', error);\n          }\n        }, 5);\n      }\n    };\n\n    // Routing feature needs router to be ready\n    const needsRouter = feature === 'routing';\n    this._executeWhenReady(action, needsRouter);\n  }\n\n  /**\n   * Execute action when dependencies are ready\n   * @param {Function} action - Action to execute\n   * @param {boolean} needsRouter - Whether action needs RouterCore\n   * @private\n   */\n  _executeWhenReady(action, needsRouter = false) {\n    if (!this.initialized) {\n      this.pendingInitActions.push(() => this._executeWhenReady(action, needsRouter));\n      return;\n    }\n\n    if (needsRouter && !this.routerReady) {\n      this.pendingRouterActions.push(action);\n      return;\n    }\n\n    action();\n  }\n}","/**\n * Base Overlay Update System - Unified interface for dynamic overlay updates\n * Provides consistent template processing and DataSource integration across all overlay types\n */\n\nexport class BaseOverlayUpdater {\n  constructor(systemsManager) {\n    this.systemsManager = systemsManager;\n    this.overlayUpdaters = new Map();\n\n    // Register overlay-specific updaters\n    this._registerUpdaters();\n  }\n\n  /**\n   * Register overlay-specific update handlers\n   * @private\n   */\n  _registerUpdaters() {\n    // Text overlay updater with template processing\n    this.overlayUpdaters.set('text', {\n      needsUpdate: (overlay, sourceData) => this._textNeedsUpdate(overlay, sourceData),\n      update: (overlayId, overlay, sourceData) => this._updateTextOverlay(overlayId, overlay, sourceData),\n      hasTemplates: (overlay) => this._hasTemplateContent(overlay)\n    });\n\n    // Status grid updater (future implementation)\n    this.overlayUpdaters.set('status_grid', {\n      needsUpdate: (overlay, sourceData) => this._statusGridNeedsUpdate(overlay, sourceData),\n      update: (overlayId, overlay, sourceData) => this._updateStatusGrid(overlayId, overlay, sourceData),\n      hasTemplates: (overlay) => this._hasTemplateContent(overlay)\n    });\n\n    // Sparkline updater with enhanced synchronization\n    this.overlayUpdaters.set('sparkline', {\n      needsUpdate: (overlay, sourceData) => true, // Always update sparklines for data synchronization\n      update: (overlayId, overlay, sourceData) => this._updateSparkline(overlayId, overlay, sourceData),\n      hasTemplates: () => false // Sparklines don't use templates\n    });\n\n    // Generic updater for future overlay types\n    this.overlayUpdaters.set('default', {\n      needsUpdate: (overlay, sourceData) => this._hasTemplateContent(overlay),\n      update: (overlayId, overlay, sourceData) => this._updateGenericOverlay(overlayId, overlay, sourceData),\n      hasTemplates: (overlay) => this._hasTemplateContent(overlay)\n    });\n  }\n\n  /**\n   * Main entry point for updating overlays when DataSource changes\n   * @param {Array} changedIds - Entity IDs that changed\n   * @public\n   */\n  updateOverlaysForDataSourceChanges(changedIds) {\n    console.log('[BaseOverlayUpdater] Checking overlays for DataSource changes:', changedIds);\n\n    const resolvedModel = this.systemsManager.modelBuilder?.getResolvedModel?.();\n    if (!resolvedModel?.overlays) {\n      return;\n    }\n\n    // Check each overlay type\n    resolvedModel.overlays.forEach(overlay => {\n      const updater = this.overlayUpdaters.get(overlay.type) || this.overlayUpdaters.get('default');\n\n      if (updater.hasTemplates(overlay)) {\n        const needsUpdate = this._overlayReferencesChangedDataSources(overlay, changedIds);\n\n        if (needsUpdate) {\n          const updatedDataSourceId = this._findDataSourceForEntity(changedIds[0]);\n          if (updatedDataSourceId) {\n            const dataSource = this.systemsManager.dataSourceManager.getSource(updatedDataSourceId);\n            if (dataSource) {\n              const currentData = dataSource.getCurrentData();\n\n              console.log(`[BaseOverlayUpdater] Updating ${overlay.type} overlay ${overlay.id}`);\n              updater.update(overlay.id, overlay, currentData);\n            }\n          }\n        }\n      }\n    });\n  }\n\n  /**\n   * Check if overlay content contains template references\n   * @private\n   */\n  _hasTemplateContent(overlay) {\n    // Check main overlay content\n    const mainContent = overlay._raw?.content || overlay.content || overlay.text ||\n                       overlay._raw?.value_format || overlay.value_format || '';\n\n    if (mainContent && typeof mainContent === 'string' && mainContent.includes('{')) {\n      return true;\n    }\n\n    // For status grids, also check cell configurations - ENHANCED to check multiple sources\n    if (overlay.type === 'status_grid') {\n      const cellsConfig = overlay.cells || overlay._raw?.cells || overlay.raw?.cells;\n      if (cellsConfig && Array.isArray(cellsConfig)) {\n        return cellsConfig.some(cell => {\n          const cellContent = cell.content || cell.label || cell.value_format || '';\n          return cellContent && typeof cellContent === 'string' && cellContent.includes('{');\n        });\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Check if overlay references any of the changed DataSources\n   * @private\n   */\n  _overlayReferencesChangedDataSources(overlay, changedIds) {\n    // Check main overlay content\n    const mainContent = overlay._raw?.content || overlay.content || overlay.text || '';\n\n    let hasReference = false;\n\n    // Check main content\n    if (mainContent && this._contentReferencesChangedDataSources(mainContent, changedIds)) {\n      hasReference = true;\n    }\n\n    // For status grids, also check cell configurations - ENHANCED to check multiple sources\n    if (overlay.type === 'status_grid') {\n      const cellsConfig = overlay.cells || overlay._raw?.cells || overlay.raw?.cells;\n      if (cellsConfig && Array.isArray(cellsConfig)) {\n        hasReference = hasReference || cellsConfig.some(cell => {\n          const cellContent = cell.content || cell.label || cell.value_format || '';\n          return this._contentReferencesChangedDataSources(cellContent, changedIds);\n        });\n      }\n    }\n\n    return hasReference;\n  }\n\n  /**\n   * Check if content string references any of the changed DataSources\n   * @private\n   */\n  _contentReferencesChangedDataSources(content, changedIds) {\n    if (!content || typeof content !== 'string') return false;\n\n    return changedIds.some(entityId => {\n      if (this.systemsManager.dataSourceManager) {\n        for (const [sourceId, source] of this.systemsManager.dataSourceManager.sources || new Map()) {\n          if (source.cfg && source.cfg.entity === entityId && content.includes(sourceId)) {\n            return true;\n          }\n        }\n      }\n      return false;\n    });\n  }  /**\n   * Text overlay specific update logic\n   * @private\n   */\n  _updateTextOverlay(overlayId, overlay, sourceData) {\n    if (this.systemsManager.renderer && this.systemsManager.renderer.updateTextOverlay) {\n      this.systemsManager.renderer.updateTextOverlay(overlayId, sourceData);\n    }\n  }\n\n  /**\n   * Status grid update logic with template processing\n   * @private\n   */\n    /**\n   * Status grid update logic with template processing\n   * @private\n   */\n  _updateStatusGrid(overlayId, overlay, sourceData) {\n    console.log(`[BaseOverlayUpdater] Updating status grid ${overlayId} with template processing`);\n\n    // Import StatusGridRenderer for template processing\n    import('./StatusGridRenderer.js').then(({ StatusGridRenderer }) => {\n      const renderer = new StatusGridRenderer();\n\n      // Process cell templates with new DataSource data\n      const updatedCells = renderer.updateCellsWithData(overlay, overlay.finalStyle || {}, sourceData);\n\n      console.log(`[BaseOverlayUpdater] Processed ${updatedCells.length} cells for status grid ${overlayId}`);\n\n      // SIMPLIFIED: Let the external renderer handle the actual DOM update\n      // We've done our job of processing the data - the external system will handle rendering\n      if (this.systemsManager.renderer && this.systemsManager.renderer.updateOverlayData) {\n        this.systemsManager.renderer.updateOverlayData(overlayId, sourceData);\n      } else {\n        console.log(`[BaseOverlayUpdater] No external renderer available - data processed but not rendered`);\n      }\n    }).catch(error => {\n      console.error(`[BaseOverlayUpdater] Failed to import StatusGridRenderer:`, error);\n    });\n  }\n\n  /**\n   * Sparkline update logic with enhanced synchronization\n   * @private\n   */\n  _updateSparkline(overlayId, overlay, sourceData) {\n    console.log(`[BaseOverlayUpdater] Updating sparkline ${overlayId} with enhanced synchronization`);\n\n    if (this.systemsManager.renderer && this.systemsManager.renderer.updateSparklineData) {\n      // Use the enhanced sparkline update method that handles synchronization\n      this.systemsManager.renderer.updateSparklineData(overlayId, sourceData);\n    } else if (this.systemsManager.renderer && this.systemsManager.renderer.updateOverlayData) {\n      this.systemsManager.renderer.updateOverlayData(overlayId, sourceData);\n    }\n  }\n\n  /**\n   * Generic overlay update logic\n   * @private\n   */\n  _updateGenericOverlay(overlayId, overlay, sourceData) {\n    console.log(`[BaseOverlayUpdater] Generic update for ${overlay.type} overlay ${overlayId}`);\n    // Could implement generic template processing here\n  }\n\n  /**\n   * Enhanced overlay update with initial data handling for Status Grid\n   * @private\n   * @param {Object} overlay - Overlay to update\n   * @param {Object} data - Data from DataSource\n   */\n  /*\n  static _updateOverlayWithData(overlay, data) {\n    const currentTimestamp = Date.now();\n\n    // ENHANCED: Handle initial data differently than ongoing updates\n    const isInitialData = data.historyReady && (!overlay.lastUpdate || overlay.lastUpdate === 0);\n\n    if (isInitialData) {\n      console.log(`[BaseOverlayUpdater] 🚀 Processing INITIAL data for ${overlay.type} overlay ${overlay.id}`);\n    }\n\n    // ENHANCED: Update based on overlay type with initial data consideration\n    if (overlay.type === 'text') {\n      TextOverlayRenderer.updateTextOverlay(overlay, data.entity, data.v, currentTimestamp, data.unit_of_measurement);\n      console.log(`[BaseOverlayUpdater] ✅ Updated TEXT overlay ${overlay.id} with value: ${data.v}`);\n\n    } else if (overlay.type === 'status_grid') {\n      // For Status Grid, ensure initial data triggers proper rendering\n      StatusGridRenderer.updateCellsWithData(overlay, data);\n\n      if (isInitialData) {\n        console.log(`[BaseOverlayUpdater] 🎯 STATUS GRID ${overlay.id} received initial data - forcing re-render if needed`);\n        // Trigger a re-render to ensure templates are processed with new data\n        overlay._needsRerender = true;\n      }\n\n      console.log(`[BaseOverlayUpdater] ✅ Updated STATUS GRID overlay ${overlay.id} with data from entity: ${data.entity}`);\n\n    } else if (overlay.type === 'sparkline') {\n      SparklineRenderer.updateSparklineData(overlay, data);\n      console.log(`[BaseOverlayUpdater] ✅ Updated SPARKLINE overlay ${overlay.id} with buffer data`);\n\n    } else {\n      // Fallback for other overlay types\n      overlay.data = data;\n      overlay.lastUpdate = currentTimestamp;\n      console.log(`[BaseOverlayUpdater] ✅ Updated ${overlay.type} overlay ${overlay.id} with generic data`);\n    }\n\n    // Set lastUpdate timestamp\n    overlay.lastUpdate = currentTimestamp;\n  }\n  */\n\n  /**\n   * Helper methods\n   * @private\n   */\n  _textNeedsUpdate(overlay, sourceData) {\n    return this._hasTemplateContent(overlay);\n  }\n\n  _statusGridNeedsUpdate(overlay, sourceData) {\n    return this._hasTemplateContent(overlay);\n  }\n\n  _findDataSourceForEntity(entityId) {\n    if (this.systemsManager.dataSourceManager) {\n      for (const [sourceId, source] of this.systemsManager.dataSourceManager.sources || new Map()) {\n        if (source.cfg && source.cfg.entity === entityId) {\n          return sourceId;\n        }\n      }\n    }\n    return null;\n  }\n}\n\n// TODO: Replace the specific text overlay update logic in SystemsManager\n// with this generalized BaseOverlayUpdater","import { AdvancedRenderer } from '../renderer/AdvancedRenderer.js';\nimport { MsdDebugRenderer } from '../debug/MsdDebugRenderer.js';\nimport { MsdControlsRenderer } from '../controls/MsdControlsRenderer.js';\nimport { MsdHudManager } from '../hud/MsdHudManager.js';\nimport { DataSourceManager } from '../data/DataSourceManager.js';\nimport { RouterCore } from '../routing/RouterCore.js';\nimport { AnimationRegistry } from '../animation/AnimationRegistry.js';\nimport { RulesEngine } from '../rules/RulesEngine.js';\nimport { DebugManager } from '../debug/DebugManager.js';\nimport { BaseOverlayUpdater } from '../renderer/BaseOverlayUpdater.js';\n\nexport class SystemsManager {\n  constructor() {\n    this.dataSourceManager = null;\n    this.renderer = null;\n    this.debugRenderer = null;\n    this.controlsRenderer = null;\n    this.hudManager = null;\n    this.router = null;\n    this.animRegistry = null;\n    this.rulesEngine = null;\n    this.debugManager = new DebugManager();\n    this.overlayUpdater = null; // ADDED: Unified overlay update system\n    this._renderTimeout = null;\n    this._reRenderCallback = null;\n    this._queuedReRender = false; // ADDED: Flag for queued renders\n    this._debugControlsRendering = false;\n    this.mergedConfig = null; // Store for entity change handler\n    this._originalHass = null;  // Pristine copy for controls\n    this._currentHass = null;   // Working copy for MSD internal processing\n    this._previousRuleStates = new Map(); // ADDED: Track rule states for threshold crossing detection\n\n    // ADDED: Render progress tracking with automatic queue execution\n    this._internalRenderInProgress = false;\n    Object.defineProperty(this, '_renderInProgress', {\n      get() {\n        return this._internalRenderInProgress;\n      },\n      set(value) {\n        const oldValue = this._internalRenderInProgress;\n        this._internalRenderInProgress = value;\n\n        // CRITICAL FIX: Execute queued render when render completes (true → false)\n        if (oldValue === true && value === false && this._queuedReRender) {\n          console.log('[MSD DEBUG] 🔄 Executing queued re-render (render completed)');\n          this._queuedReRender = false;\n\n          setTimeout(() => {\n            if (!this._internalRenderInProgress && this._reRenderCallback) {\n              console.log('[MSD DEBUG] 🚀 Executing queued re-render callback');\n              try {\n                this._reRenderCallback();\n              } catch (error) {\n                console.error('[MSD DEBUG] ❌ Queued re-render failed:', error);\n              }\n            }\n          }, 50);\n        }\n      }\n    });\n  }\n\n  async initializeSystems(mergedConfig, cardModel, mountEl, hass) {\n    console.log('[MSD v1] Initializing runtime systems');\n\n    // Store config for later use\n    this.mergedConfig = mergedConfig;\n\n    // ADDED: Store HASS context immediately\n    this._currentHass = hass;\n\n    // ENHANCED: Initialize debug manager early with config and better logging\n    const debugConfig = mergedConfig.debug || {};\n    console.log('[MSD v1] Raw debug config from mergedConfig:', debugConfig);\n\n    this.debugManager.init(debugConfig);\n    console.log('[MSD v1] DebugManager initialized with config:', debugConfig);\n\n    // Initialize data source manager FIRST\n    await this._initializeDataSources(hass, mergedConfig);\n\n    // Initialize rules engine AFTER DataSourceManager with proper connection\n    this.rulesEngine = new RulesEngine(mergedConfig.rules, this.dataSourceManager);\n    this.rulesEngine.markAllDirty();\n    this._instrumentRulesEngine(mergedConfig);\n\n    // Connect data source manager to rules engine for entity changes\n    if (this.dataSourceManager) {\n      const entityChangeHandler = this._createEntityChangeHandler();\n\n      // Add entity change listener\n      this.dataSourceManager.addEntityChangeListener(entityChangeHandler);\n      console.log('[MSD v1] DataSourceManager connected to rules engine with entity change handler');\n\n      console.log('[MSD v1] DataSourceManager entity count:', this.dataSourceManager.listIds().length);\n    } else {\n      console.warn('[MSD v1] DataSourceManager not initialized - no data sources configured or HASS unavailable');\n    }\n\n    // Initialize rendering systems\n    this.router = new RouterCore(mergedConfig.routing, cardModel.anchors, cardModel.viewBox);\n    this.renderer = new AdvancedRenderer(mountEl, this.router, this); // ADDED: Pass 'this' as systemsManager\n    this.debugRenderer = new MsdDebugRenderer();\n    this.controlsRenderer = new MsdControlsRenderer(this.renderer);\n\n    // ADDED: Set HASS context on controls renderer immediately if available\n    if (this._currentHass && this.controlsRenderer) {\n      console.log('[MSD v1] Setting initial HASS context on controls renderer');\n      this.controlsRenderer.setHass(this._currentHass);\n    }\n\n    // REPLACED: Initialize unified HUD manager with document.body mounting\n    this.hudManager = new MsdHudManager();\n    this.hudManager.init(mountEl); // Pass mount element for pipeline context, but HUD uses document.body\n\n    // ADDED: Integrate HUD into global debug interface immediately\n    this._setupGlobalHudInterface();\n\n    // Initialize debug renderer with systems manager reference\n    this.debugRenderer.init(this);\n\n    // Mark router as ready for debug system\n    this.debugManager.markRouterReady();\n    console.log('[MSD v1] RouterCore marked ready for debug system');\n\n    // Initialize animation registry\n    this.animRegistry = new AnimationRegistry();\n\n    // ADDED: Initialize unified overlay update system\n    this.overlayUpdater = new BaseOverlayUpdater(this);\n    console.log('[MSD v1] BaseOverlayUpdater initialized for unified overlay updates');\n\n    // CRITICAL FIX: Temporarily disable status indicators to prevent NaN coordinate SVG errors\n    // The TextOverlayRenderer calculates invalid coordinates causing SVG errors and MSD disappearing\n    if (this.mergedConfig && this.mergedConfig.overlays) {\n      console.log('[MSD v1] Applying status indicator fix to prevent NaN coordinate errors');\n      this.mergedConfig.overlays = this.mergedConfig.overlays.map(overlay => {\n        if (overlay && overlay.status_indicator) {\n          console.log(`[MSD v1] DISABLED status indicator for ${overlay.id} to prevent NaN coordinates`);\n          return { ...overlay, status_indicator: false };\n        }\n        return overlay;\n      });\n    }\n\n    console.log('[MSD v1] All systems initialized successfully');\n    return this;\n  }\n\n  setReRenderCallback(callback) {\n    this._reRenderCallback = callback;\n  }\n\n\n\n  _createEntityChangeHandler() {\n      return (changedIds, enhancedData = null) => {\n          const timestamp = Date.now();\n\n          console.log('[MSD DEBUG] 🔔 Entity change handler TRIGGERED:', {\n              timestamp: new Date().toISOString(),\n              changedIds,\n              hasEnhancedData: !!enhancedData,\n              stackTrace: new Error().stack.split('\\n').slice(1, 5).join('\\n'),\n              renderTimeout: !!this._renderTimeout,\n              renderInProgress: !!this._renderInProgress\n          });\n\n          // STEP 1: Handle controls with FRESH CURRENT HASS (restored logic)\n          const controlEntities = this._extractControlEntities(this.mergedConfig);\n          const controlChangedIds = changedIds.filter(id => controlEntities.includes(id));\n\n          if (controlChangedIds.length > 0 && this.controlsRenderer) {\n              // SIMPLIFIED: Direct subscription handles control updates automatically\n              console.log('[SystemsManager] 📡 Control entities changed:', controlChangedIds);\n              console.log('[SystemsManager] ℹ️ Direct subscription will handle these updates automatically');\n              // NOTE: The direct HASS subscription automatically handles control updates\n              // No need to manually forward HASS here as it causes duplicate/stale updates\n          }\n\n          // STEP 2: Update MSD internal HASS with converted data (existing logic)\n          const workingHass = this.getCurrentHass();\n          if (workingHass && this.dataSourceManager) {\n              console.log('[MSD DEBUG] 📤 Refreshing MSD internal HASS context with converted entity states');\n\n              // Get converted state from data source manager for MSD internal use\n              const freshStates = {};\n              changedIds.forEach(entityId => {\n                  const entity = this.dataSourceManager.getEntity(entityId);\n                  if (entity && entity.state !== undefined) {\n                      // For MSD internal processing, use converted numeric values\n                      freshStates[entityId] = {\n                          state: entity.state.toString(), // MSD converted state\n                          last_changed: new Date().toISOString(),\n                          last_updated: new Date().toISOString(),\n                          attributes: entity.attributes || workingHass.states[entityId]?.attributes || {},\n                          entity_id: entityId,\n                          context: {\n                              id: Date.now().toString(),\n                              user_id: null\n                          }\n                      };\n\n                      console.log('[MSD DEBUG] 🔄 Updated MSD internal state for', entityId, {\n                          originalState: this._originalHass?.states[entityId]?.state,\n                          convertedState: freshStates[entityId].state,\n                          rawValue: entity.state\n                      });\n                  } else {\n                      console.log('[MSD DEBUG] ⚠️ No data source found for entity:', entityId, '(entity will not be updated in MSD internal HASS)');\n                  }\n              });\n\n              // Only update HASS if we have fresh states from data sources\n              if (Object.keys(freshStates).length > 0) {\n                  // Update the working HASS states object with converted data\n                  this._currentHass = {\n                      ...workingHass,\n                      states: {\n                          ...workingHass.states,\n                          ...freshStates\n                      }\n                  };\n\n                  console.log('[MSD DEBUG] ✅ MSD internal HASS context refreshed with', Object.keys(freshStates).length, 'converted entities');\n              } else {\n                  console.log('[MSD DEBUG] ℹ️ No data source entities changed - MSD internal HASS unchanged');\n              }\n          } else {\n              console.log('[MSD DEBUG] ⚠️ Skipping MSD internal HASS update:', {\n                  hasWorkingHass: !!workingHass,\n                  hasDataSourceManager: !!this.dataSourceManager,\n                  dataSourceManagerIsNull: this.dataSourceManager === null\n              });\n          }\n\n          // STEP 2.5: ENHANCED - Update overlays with DataSource changes using unified system\n          if (this.overlayUpdater) {\n              console.log('[MSD DEBUG] 🔄 Using BaseOverlayUpdater for overlay updates');\n              this.overlayUpdater.updateOverlaysForDataSourceChanges(changedIds);\n          } else {\n              console.log('[MSD DEBUG] ⚠️ BaseOverlayUpdater not available, skipping overlay updates');\n          }\n\n          // Mark rules dirty for future renders\n          if (this.rulesEngine) {\n              // Enhanced: Map entity IDs to DataSource IDs for rules\n              const entitiesToMarkDirty = new Set();\n\n              changedIds.forEach(entityId => {\n                  // Add the original entity ID\n                  entitiesToMarkDirty.add(entityId);\n\n                  // Check if this entity ID corresponds to any DataSources\n                  if (this.dataSourceManager) {\n                      // Find DataSources that use this entity\n                      for (const [sourceId, source] of this.dataSourceManager.sources) {\n                          if (source.cfg && source.cfg.entity === entityId) {\n                              // Add the DataSource ID so rules can be triggered\n                              entitiesToMarkDirty.add(sourceId);\n                              console.log(`[MSD DEBUG] 📏 Mapped entity \"${entityId}\" to DataSource \"${sourceId}\"`);\n                          }\n                      }\n                  }\n              });\n\n              const finalEntityList = Array.from(entitiesToMarkDirty);\n              this.rulesEngine.markEntitiesDirty(finalEntityList);\n              console.log('[MSD DEBUG] 📏 Marked rules dirty for entities:', finalEntityList);\n          } else {\n              console.log('[MSD DEBUG] ⚠️ No rules engine available to mark dirty');\n          }\n\n          if (this._renderTimeout) {\n              console.log('[MSD DEBUG] ⏰ Clearing existing render timeout');\n              clearTimeout(this._renderTimeout);\n          }\n\n          // SIMPLIFIED: Check if this is ONLY a control-triggered change with no data source implications\n          const isControlTriggered = changedIds.some(entityId => controlEntities.includes(entityId));\n          const hasDataSourceChanges = changedIds.some(entityId => {\n              return this.dataSourceManager && this.dataSourceManager.getEntity(entityId);\n          });\n\n          // Store analysis results\n          this._lastEntityAnalysis = {\n              isControlTriggered,\n              hasDataSourceChanges,\n              timestamp,\n              changedIds,\n              controlEntities,\n              matchingEntities: changedIds.filter(id => controlEntities.includes(id))\n          };\n\n          console.log('[MSD DEBUG] 🎯 Entity change analysis:', this._lastEntityAnalysis);\n\n          // IMPROVED: Only trigger re-render if rules might have actually changed\n          if (hasDataSourceChanges) {\n              console.log('[MSD DEBUG] 🔄 Checking if rules need re-evaluation for data source changes');\n\n              // Check if rule conditions might have changed\n              const needsRuleReRender = this._checkIfRulesNeedReRender(changedIds);\n\n              if (needsRuleReRender) {\n                  console.log('[MSD DEBUG] 🎨 Rule conditions may have changed - scheduling full re-render');\n                  this._scheduleFullReRender();\n              } else {\n                  console.log('[MSD DEBUG] 📊 Only content changed - rules unchanged, skipping full re-render');\n                  // Content updates happen automatically via DataSource subscriptions\n                  // No full re-render needed for content-only changes\n              }\n          } else {\n              console.log('[MSD DEBUG] ⏭️ SKIPPING re-render - no relevant entity changes for MSD');\n          }\n      };\n  }\n\n\n\n  /**\n   * Set the original HASS object and keep a pristine reference for controls\n   * @param {Object} hass - Original Home Assistant object\n   */\n  setOriginalHass(hass) {\n      console.log('[SystemsManager] 📚 Setting original HASS reference:', {\n          hasStates: !!hass?.states,\n          entityCount: hass?.states ? Object.keys(hass.states).length : 0,\n          hasAuth: !!hass?.auth,\n          hasConnection: !!hass?.connection,\n          lightDeskState: hass?.states?.['light.desk']?.state,\n          timestamp: new Date().toISOString()\n      });\n\n      // ALWAYS update original HASS to keep it fresh - this should be the most current\n      this._originalHass = hass;\n\n      // If this is the first time setting HASS, also set working copy\n      if (!this._currentHass) {\n          this._currentHass = hass;\n          console.log('[SystemsManager] 📚 Also setting _currentHass (first time)');\n      }\n\n      // ADDED: Set up direct subscription to ensure fresh HASS for controls\n      this.setupDirectHassSubscription(hass);\n\n      // Note: _currentHass will be modified separately in entity change handler with converted data\n  }\n\n  /**\n   * Get the current working HASS (for MSD internal use)\n   */\n  getCurrentHass() {\n      return this._currentHass;\n  }\n\n  /**\n   * Get the original pristine HASS (for controls)\n   */\n  getOriginalHass() {\n      return this._originalHass;\n  }\n\n\n  _instrumentRulesEngine(mergedConfig) {\n    try {\n      const depIndex = new Map();\n      (mergedConfig.rules||[]).forEach(r=>{\n        const condBlocks = (r.when && (r.when.all || r.when.any)) || [];\n        condBlocks.forEach(c=>{\n          const ent = c?.entity;\n            if (ent) {\n              if (!depIndex.has(ent)) depIndex.set(ent, new Set());\n              depIndex.get(ent).add(r.id);\n            }\n        });\n      });\n      this.rulesEngine.__hudDeps = depIndex;\n\n      const W = typeof window!=='undefined'?window:{};\n      W.__msdDebug = W.__msdDebug || {};\n      const perfStore = W.__msdDebug.__perfStore = W.__msdDebug.__perfStore || { counters:{}, timings:{} };\n      function perfCount(k,inc=1){ perfStore.counters[k]=(perfStore.counters[k]||0)+inc; }\n\n      if (!this.rulesEngine.__perfWrapped && typeof this.rulesEngine.evaluateDirty === 'function'){\n        const orig = this.rulesEngine.evaluateDirty;\n        this.rulesEngine.evaluateDirty = function(){\n          const ruleCount = (mergedConfig.rules||[]).length;\n          perfCount('rules.eval.count', ruleCount||0);\n          const res = orig.apply(this, arguments);\n          try {\n            const trace = (this.getTrace && this.getTrace()) || [];\n            const matched = Array.isArray(trace) ? trace.filter(t=>t && t.matched).length : 0;\n            perfCount('rules.match.count', matched);\n          } catch { /* ignore */ }\n          return res;\n        };\n        this.rulesEngine.__perfWrapped = true;\n      }\n    } catch(e){\n      console.warn('[MSD v1][rules instrumentation] failed', e);\n    }\n  }\n\n  async _initializeDataSources(hass, mergedConfig) {\n    this.dataSourceManager = null;\n\n    // ENHANCED: Better logging and error handling\n    if (!hass) {\n      console.warn('[MSD v1] No HASS provided - DataSourceManager will not be initialized');\n      return;\n    }\n\n    // ENHANCED: Explicit-only data sources - no auto-creation\n    const configuredDataSources = mergedConfig.data_sources || {};\n\n    console.log('[MSD v1] 🔍 Using explicit-only data sources mode');\n    console.log('[MSD v1] 🔍 Configured data sources:', Object.keys(configuredDataSources));\n\n    // Controls use direct HASS - no data sources needed\n    const controlEntities = this._extractControlEntities(mergedConfig);\n    console.log('[MSD v1] 🔍 Control entities (using direct HASS):', controlEntities);\n\n    // Use only explicitly configured data sources\n    const allDataSources = { ...configuredDataSources };\n\n    console.log('[MSD v1] 📊 Data source summary:', {\n      configured: Object.keys(configuredDataSources).length,\n      total: Object.keys(allDataSources).length,\n      allDataSourceIds: Object.keys(allDataSources)\n    });\n\n    if (Object.keys(allDataSources).length === 0) {\n      console.log('[MSD v1] No explicit data sources configured - DataSourceManager will not be initialized');\n      console.log('[MSD v1] Note: Control overlays will use direct HASS (no data sources needed)');\n      return;\n    }\n\n    console.log('[MSD v1] Initializing DataSourceManager with', Object.keys(allDataSources).length, 'explicit data sources');\n\n    try {\n      this.dataSourceManager = new DataSourceManager(hass);\n      const sourceCount = await this.dataSourceManager.initializeFromConfig(allDataSources);\n      console.log('[MSD v1] ✅ DataSourceManager initialized -', sourceCount, 'sources started');\n\n      // ADDED: Verify entities are available\n      const entityIds = this.dataSourceManager.listIds();\n      console.log('[MSD v1] ✅ DataSourceManager entities available:', entityIds);\n\n    } catch (error) {\n      console.error('[MSD v1] ❌ DataSourceManager initialization failed:', error);\n      console.error('[MSD v1] Error details:', error.stack);\n      this.dataSourceManager = null;\n    }\n  }\n\n  /**\n   * Extract entity IDs from control overlays for auto data source creation\n   */\n  _extractControlEntities(mergedConfig) {\n    const entities = new Set();\n\n    // Extract from overlays\n    const overlays = mergedConfig.overlays || [];\n    overlays.forEach(overlay => {\n      if (overlay.type === 'control' && overlay.card) {\n        // Check multiple possible entity locations\n        const entity = overlay.card.config?.entity ||\n                      overlay.card.config?.variables?.entity ||\n                      overlay.card.entity;\n\n        if (entity) {\n          entities.add(entity);\n        }\n      }\n    });\n\n    // Extract from any other control configurations\n    // (Add more extraction logic here as needed)\n\n    return Array.from(entities);\n  }\n\n  /**\n   * Essential cleanup method\n   */\n  destroy() {\n    if (this.debugRenderer) {\n      this.debugRenderer.destroy();\n    }\n\n    // Clear render timeout\n    if (this._renderTimeout) {\n      clearTimeout(this._renderTimeout);\n      this._renderTimeout = null;\n    }\n\n    // Clear re-render callback\n    this._reRenderCallback = null;\n  }\n\n  /**\n   * Render debug overlays and controls using DebugManager with basic performance tracking\n   * @param {Object} resolvedModel - The resolved model\n   * @param {Element} mountEl - The shadowRoot/mount element\n   */\n  async renderDebugAndControls(resolvedModel, mountEl = null) {\n    // ADDED: Early exit if already rendering\n    if (this._debugControlsRendering) {\n      console.log('[SystemsManager] renderDebugAndControls already in progress, skipping');\n      return;\n    }\n\n    this._debugControlsRendering = true;\n\n    try {\n      const debugState = this.debugManager.getSnapshot();\n\n      console.log('[SystemsManager] renderDebugAndControls called:', {\n        anyEnabled: this.debugManager.isAnyEnabled(),\n        controlOverlays: resolvedModel.overlays.filter(o => o.type === 'control').length,\n        hasHass: !!this._currentHass,\n        hasResolvedModel: !!resolvedModel,\n        hasOverlays: !!resolvedModel?.overlays\n      });\n\n      // ADDED: Validate resolved model\n      if (!resolvedModel || !resolvedModel.overlays) {\n        console.warn('[SystemsManager] Invalid resolved model for renderDebugAndControls');\n        return;\n      }\n\n      // Render debug visualizations with error boundary\n      if (this.debugManager.isAnyEnabled()) {\n        try {\n          const debugOptions = {\n            anchors: resolvedModel.anchors || {},\n            overlays: resolvedModel.overlays || [],\n            showAnchors: debugState.anchors,\n            showBoundingBoxes: debugState.bounding_boxes,\n            showRouting: this.debugManager.canRenderRouting(),\n            showPerformance: debugState.performance,\n            scale: debugState.scale\n          };\n\n          this.debugRenderer.render(mountEl || this.renderer?.mountEl, resolvedModel.viewBox, debugOptions);\n          console.log('[SystemsManager] ✅ Debug renderer completed');\n        } catch (error) {\n          console.error('[SystemsManager] ❌ Debug renderer failed:', error);\n          // Continue execution - don't fail the entire render\n        }\n      }\n\n      // FIXED: Render control overlays with comprehensive error handling\n      const controlOverlays = resolvedModel.overlays.filter(o => o.type === 'control');\n      if (controlOverlays.length > 0) {\n        console.log('[SystemsManager] Rendering control overlays:', controlOverlays.map(c => c.id));\n\n        try {\n          // ADDED: Validate controls renderer exists\n          if (!this.controlsRenderer) {\n            console.error('[SystemsManager] No controls renderer available');\n            return;\n          }\n\n          // Ensure controls renderer has current HASS context\n          if (this._currentHass && this.controlsRenderer) {\n            this.controlsRenderer.setHass(this._currentHass);\n            console.log('[SystemsManager] HASS context applied to controls renderer');\n          } else {\n            console.warn('[SystemsManager] No HASS context available for controls');\n          }\n\n          // REMOVED: Defensive container creation - not needed with SVG foreignObject approach\n          // The renderControls() method handles all necessary container creation internally\n\n          // ADDED: Defensive controls rendering with timeout\n          const renderPromise = this.controlsRenderer.renderControls(controlOverlays, resolvedModel);\n          const timeoutPromise = new Promise((_, reject) =>\n            setTimeout(() => reject(new Error('Controls render timeout')), 5000)\n          );\n\n          await Promise.race([renderPromise, timeoutPromise]);\n          console.log('[SystemsManager] ✅ Controls rendered successfully');\n\n        } catch (error) {\n          console.error('[SystemsManager] ❌ Controls rendering failed:', error);\n          console.error('[SystemsManager] Error stack:', error.stack);\n        }\n      }\n\n    } catch (error) {\n      console.error('[SystemsManager] renderDebugAndControls failed completely:', error);\n      console.error('[SystemsManager] Error stack:', error.stack);\n    } finally {\n      this._debugControlsRendering = false;\n    }\n  }\n\n  /**\n   * Check if debug should be rendered based on config\n   * @param {Object} debugConfig - Debug configuration\n   * @returns {boolean} Whether debug should be rendered\n   */\n  _shouldRenderDebugFromConfig(debugConfig) {\n    if (!debugConfig || !debugConfig.overlays) return false;\n\n    return debugConfig.overlays.anchors ||\n          debugConfig.overlays.bounding_boxes ||\n          debugConfig.overlays.routing ||\n          debugConfig.overlays.performance;\n  }\n\n  /**\n   * Legacy debug flag support (for backward compatibility)\n   * @returns {Object} Debug flags\n   */\n  _getDebugFlags() {\n    return window.cblcars?._debugFlags || {};\n  }\n\n  /**\n   * Legacy debug check (for backward compatibility)\n   * @param {Object} debugFlags - Debug flags\n   * @returns {boolean} Whether debug should be rendered\n   */\n  _shouldRenderDebug(debugFlags) {\n    return debugFlags && (debugFlags.overlay || debugFlags.connectors || debugFlags.geometry);\n  }\n\n  // Public API methods - now exclusively using DataSourceManager\n  ingestHass(hass) {\n    console.log('[SystemsManager] ingestHass called with:', {\n      hasHass: !!hass,\n      hasStates: !!hass?.states,\n      entityCount: hass?.states ? Object.keys(hass.states).length : 0,\n      hasLightDesk: !!hass?.states?.['light.desk'],\n      lightDeskState: hass?.states?.['light.desk']?.state,\n      timestamp: new Date().toISOString()\n    });\n\n    if (!hass || !hass.states) {\n      console.warn('[MSD v1] ingestHass called without valid hass.states');\n      return;\n    }\n\n    // CRITICAL: Update BOTH working copy AND original copy to keep them fresh\n    this._currentHass = hass;\n    this._originalHass = hass;  // ADDED: Keep original fresh too\n\n    console.log('[SystemsManager] Updated both _currentHass and _originalHass with fresh data');\n\n    // ENHANCED: Pass HASS to controls renderer EVERY time to ensure cards get updates\n    if (this.controlsRenderer) {\n      console.log('[SystemsManager] Updating HASS context in controls renderer immediately');\n      this.controlsRenderer.setHass(hass);\n    } else {\n      console.warn('[SystemsManager] No controls renderer available for HASS update');\n    }\n\n    // DataSources handle HASS updates automatically via their subscriptions\n    // No manual ingestion needed - handled by individual data sources\n    console.log('[MSD v1] HASS ingestion handled by individual data sources');\n  }\n\n  updateEntities(map) {\n    if (!map || typeof map !== 'object') return;\n\n    console.log('[MSD v1] Manual entity updates not supported in DataSources system');\n    console.warn('[MSD v1] Use direct HASS state updates instead of manual entity updates');\n  }\n\n  // Entity API methods using DataSourceManager\n  listEntities() {\n    return this.dataSourceManager ? this.dataSourceManager.listIds() : [];\n  }\n\n  getEntity(id) {\n    return this.dataSourceManager ? this.dataSourceManager.getEntity(id) : null;\n  }\n\n  /**\n   * Set up direct HASS subscription to ensure fresh HASS for controls\n   * @param {Object} hass - Home Assistant object with connection\n   */\n  setupDirectHassSubscription(hass) {\n    if (hass && hass.connection && !this._directHassSubscription) {\n      console.log('[SystemsManager] 🔗 Setting up direct HASS subscription for fresh control updates');\n\n      this._directHassSubscription = hass.connection.subscribeEvents((event) => {\n        if (event.event_type === 'state_changed' && event.data && event.data.entity_id) {\n          const entityId = event.data.entity_id;\n          const newState = event.data.new_state;\n\n          // Check if this is a control entity\n          const controlEntities = this._extractControlEntities(this.mergedConfig);\n          if (controlEntities.includes(entityId) && newState) {\n            console.log('[SystemsManager] 📡 Direct HASS update for control entity:', entityId, 'new state:', newState.state);\n\n            // Update our HASS with the fresh state\n            if (this._originalHass && this._originalHass.states) {\n              const freshHass = {\n                ...this._originalHass,\n                states: {\n                  ...this._originalHass.states,\n                  [entityId]: newState\n                }\n              };\n\n              console.log('[SystemsManager] 📊 Updated HASS with fresh state for', entityId, ':', newState.state);\n              this._originalHass = freshHass;\n              this._currentHass = freshHass;\n\n              // Forward fresh HASS to controls immediately\n              if (this.controlsRenderer) {\n                console.log('[SystemsManager] 📤 Immediately forwarding fresh HASS to controls');\n                this.controlsRenderer.setHass(freshHass);\n              }\n            }\n          }\n        }\n      }, 'state_changed');\n\n            console.log('[SystemsManager] ✅ Direct HASS subscription established');\n    }\n  }\n\n  /**\n   * Set up global HUD interface (placeholder for future implementation)\n   * @private\n   */\n  _setupGlobalHudInterface() {\n    console.log('[SystemsManager] Global HUD interface setup completed');\n    // This method is called during initialization\n    // Future HUD interface setup will go here\n  }\n\n  /**\n   * Check if entity changes might affect rule conditions (requiring full re-render)\n   * @param {Array} changedIds - Entity IDs that changed\n   * @returns {boolean} True if rules might need re-evaluation\n   * @private\n   */\n  _checkIfRulesNeedReRender(changedIds) {\n    if (!this.rulesEngine || !this.mergedConfig?.rules) {\n      return false; // No rules to evaluate\n    }\n\n    // For now, be conservative and assume any DataSource change might affect rules\n    // TODO: In the future, we could be more sophisticated and check specific rule conditions\n    const affectedDataSources = changedIds.filter(id => {\n      // Check if this entity maps to a DataSource used in rules\n      return this.dataSourceManager?.getEntity(id) ||\n             changedIds.some(entityId => this.dataSourceManager?.getSource(entityId));\n    });\n\n    if (affectedDataSources.length > 0) {\n      console.log('[MSD DEBUG] 🎯 DataSource entities affected by changes:', affectedDataSources);\n\n      // ADVANCED: Check if the specific rule thresholds might be crossed\n      // This is where we could add more sophisticated logic to detect actual rule changes\n      const mightCrossThresholds = this._checkThresholdCrossing(changedIds);\n\n      console.log('[MSD DEBUG] 🌡️ Threshold crossing check:', mightCrossThresholds);\n      return mightCrossThresholds;\n    }\n\n    return false;\n  }\n\n  /**\n   * Check if entity changes might cross rule thresholds\n   * @param {Array} changedIds - Entity IDs that changed\n   * @returns {boolean} True if thresholds might be crossed\n   * @private\n   */\n  _checkThresholdCrossing(changedIds) {\n    // For temperature example: check if we're crossing the 70°F threshold\n    const rules = this.mergedConfig.rules || [];\n\n    for (const rule of rules) {\n      const conditions = rule.when?.any || rule.when?.all || [];\n\n      for (const condition of conditions) {\n        if (condition.entity && (condition.above !== undefined || condition.below !== undefined)) {\n          // Check if this entity or its DataSource is in changedIds\n          const entityInRule = condition.entity;\n          const isDataSourceAffected = changedIds.some(id => {\n            // Check if changed entity maps to the DataSource used in the rule\n            const dataSourceId = entityInRule.split('.')[0]; // e.g., \"temperature_enhanced\"\n            const source = this.dataSourceManager?.getSource(dataSourceId);\n            return source && source.cfg?.entity === id;\n          });\n\n          if (isDataSourceAffected) {\n            console.log('[MSD DEBUG] 🎯 Rule condition potentially affected:', {\n              rule: rule.id,\n              entity: entityInRule,\n              threshold: condition.above || condition.below,\n              operator: condition.above ? 'above' : 'below'\n            });\n\n            // IMPROVED: Check actual threshold crossing instead of always returning true\n            const currentEntity = this.dataSourceManager?.getEntity(entityInRule);\n            if (currentEntity && currentEntity.state !== undefined) {\n              const currentValue = parseFloat(currentEntity.state);\n              const threshold = condition.above || condition.below;\n              const isAboveThreshold = currentValue > threshold;\n              const isBelowThreshold = currentValue < threshold;\n\n              // Check if current value satisfies the condition\n              const currentlyMatches = condition.above ? isAboveThreshold : isBelowThreshold;\n\n              console.log('[MSD DEBUG] 🌡️ Detailed threshold analysis:', {\n                currentValue,\n                threshold,\n                operator: condition.above ? 'above' : 'below',\n                isAboveThreshold,\n                isBelowThreshold,\n                currentlyMatches,\n                ruleId: rule.id\n              });\n\n              // Store the current rule state for next comparison\n              if (!this._previousRuleStates) {\n                this._previousRuleStates = new Map();\n              }\n\n              const ruleKey = `${rule.id}_${condition.entity}`;\n              const previouslyMatched = this._previousRuleStates.get(ruleKey);\n\n              console.log('[MSD DEBUG] 📊 Rule state comparison:', {\n                ruleKey,\n                previouslyMatched,\n                currentlyMatches,\n                stateChanged: previouslyMatched !== currentlyMatches\n              });\n\n              // Update the stored state\n              this._previousRuleStates.set(ruleKey, currentlyMatches);\n\n              // Only trigger re-render if the rule state actually changed\n              if (previouslyMatched !== undefined && previouslyMatched !== currentlyMatches) {\n                console.log('[MSD DEBUG] 🔄 Rule state CHANGED - threshold crossing detected!');\n                return true;\n              } else if (previouslyMatched === undefined) {\n                console.log('[MSD DEBUG] 🆕 First rule evaluation - storing state');\n                // First time seeing this rule, don't trigger re-render\n                return false;\n              } else {\n                console.log('[MSD DEBUG] 📌 Rule state UNCHANGED - no threshold crossing');\n                return false;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    console.log('[MSD DEBUG] 📊 No threshold crossings detected');\n    return false;\n  }  /**\n   * Schedule a full re-render with proper queuing\n   * @private\n   */\n  _scheduleFullReRender() {\n    if (this._renderTimeout) {\n      console.log('[MSD DEBUG] ⏰ Clearing existing render timeout');\n      clearTimeout(this._renderTimeout);\n    }\n\n    // Safe re-render for data source changes\n    this._renderTimeout = setTimeout(() => {\n      if (this._reRenderCallback && !this._renderInProgress) {\n        try {\n          this._renderInProgress = true;\n          console.log('[MSD DEBUG] 🚀 TRIGGERING full re-render from rule change timeout');\n          this._reRenderCallback();\n        } catch (error) {\n          console.error('[MSD DEBUG] ❌ Re-render FAILED in entity change handler:', error);\n        } finally {\n          this._renderInProgress = false;\n        }\n      }\n      this._renderTimeout = null;\n    }, 100);\n  }\n\n  /**\n   * Update text overlays when DataSource entities change\n   * @param {Array} changedIds - Entity IDs that changed\n   * @private\n   */\n  _updateTextOverlaysForDataSourceChanges(changedIds) {\n    console.log('[MSD DEBUG] 🔤 Checking for text overlays affected by DataSource changes:', changedIds);\n\n    // Get current resolved model to find text overlays\n    const resolvedModel = this.modelBuilder?.getResolvedModel?.();\n    if (!resolvedModel || !resolvedModel.overlays) {\n      console.log('[MSD DEBUG] ⚠️ No resolved model available for text overlay updates');\n      return;\n    }\n\n    // Find text overlays that might be affected\n    const textOverlays = resolvedModel.overlays.filter(overlay => overlay.type === 'text');\n    console.log('[MSD DEBUG] 🔤 Found', textOverlays.length, 'text overlays to check');\n\n    textOverlays.forEach(overlay => {\n      // Check if this text overlay uses template strings that reference the changed DataSources\n      const content = overlay._raw?.content || overlay.content || overlay.text || '';\n\n      if (content && typeof content === 'string' && content.includes('{')) {\n        console.log(`[MSD DEBUG] 🔤 Checking text overlay ${overlay.id} with content: \"${content}\"`);\n\n        // Check if any of the changed entities map to DataSources referenced in the template\n        const needsUpdate = changedIds.some(entityId => {\n          // Find DataSources that use this entity\n          if (this.dataSourceManager) {\n            for (const [sourceId, source] of this.dataSourceManager.sources || new Map()) {\n              if (source.cfg && source.cfg.entity === entityId) {\n                console.log(`[MSD DEBUG] 🔗 Entity ${entityId} maps to DataSource ${sourceId}`);\n\n                // Check if the template content references this DataSource\n                if (content.includes(sourceId)) {\n                  console.log(`[MSD DEBUG] ✅ Text overlay ${overlay.id} references DataSource ${sourceId} - needs update`);\n                  return true;\n                }\n              }\n            }\n          }\n          return false;\n        });\n\n        if (needsUpdate) {\n          console.log(`[MSD DEBUG] 🚀 Updating text overlay ${overlay.id} for DataSource changes`);\n\n          // Get the updated DataSource data for the first changed DataSource\n          const updatedDataSourceId = this._findDataSourceForEntity(changedIds[0]);\n          if (updatedDataSourceId) {\n            const dataSource = this.dataSourceManager.getSource(updatedDataSourceId);\n            if (dataSource) {\n              const currentData = dataSource.getCurrentData();\n              console.log(`[MSD DEBUG] 📊 Using DataSource ${updatedDataSourceId} data:`, currentData);\n\n              // Update the text overlay with new data\n              if (this.renderer && this.renderer.updateTextOverlay) {\n                try {\n                  this.renderer.updateTextOverlay(overlay.id, currentData);\n                  console.log(`[MSD DEBUG] ✅ Text overlay ${overlay.id} updated successfully`);\n                } catch (error) {\n                  console.error(`[MSD DEBUG] ❌ Failed to update text overlay ${overlay.id}:`, error);\n                }\n              }\n            }\n          }\n        } else {\n          console.log(`[MSD DEBUG] ⏭️ Text overlay ${overlay.id} not affected by these changes`);\n        }\n      }\n    });\n  }\n\n  /**\n   * Find DataSource ID for a given entity ID\n   * @param {string} entityId - Entity ID\n   * @returns {string|null} DataSource ID\n   * @private\n   */\n  _findDataSourceForEntity(entityId) {\n    if (this.dataSourceManager) {\n      for (const [sourceId, source] of this.dataSourceManager.sources || new Map()) {\n        if (source.cfg && source.cfg.entity === entityId) {\n          return sourceId;\n        }\n      }\n    }\n    return null;\n  }\n}\n\n// CLEANUP NOTE: The old text-specific overlay update methods have been removed\n  // and replaced with the unified BaseOverlayUpdater system in BaseOverlayUpdater.js\n  // This provides consistent template processing across all overlay types.\n\n","import { perfTime, perfCount } from '../util/performance.js';\n\n/**\n * Profile system for layered style resolution\n * Handles active_profiles precedence and profile-specific overrides\n *\n * FIXED: Overlay styles now have HIGHER precedence than profile styles\n */\nexport class ProfileResolver {\n  constructor() {\n    this.profileIndex = new Map(); // profileId -> profile data\n    this.activeProfiles = [];\n    this.styleCache = new Map(); // overlayId -> cached merged style\n    this.lastActiveProfiles = null; // For cache invalidation\n\n    // Performance tracking\n    this.perfStats = {\n      profileLoads: 0,\n      styleMerges: 0,\n      cacheHits: 0,\n      cacheMisses: 0,\n      invalidations: 0\n    };\n  }\n\n  /**\n   * Load profiles into the resolver index\n   */\n  loadProfiles(profiles) {\n    perfTime('profile.load', () => {\n      this.profileIndex.clear();\n\n      profiles.forEach(profile => {\n        if (profile.id) {\n          this.profileIndex.set(profile.id, profile);\n          this.perfStats.profileLoads++;\n        }\n      });\n\n      perfCount('profile.loaded', profiles.length);\n    });\n  }\n\n  /**\n   * Set active profiles and invalidate cache if changed\n   */\n  setActiveProfiles(activeProfiles) {\n    const newActiveProfiles = Array.isArray(activeProfiles) ? activeProfiles : [];\n\n    // Check if profiles changed\n    const changed = JSON.stringify(this.activeProfiles) !== JSON.stringify(newActiveProfiles);\n\n    if (changed) {\n      this.activeProfiles = [...newActiveProfiles];\n      this.invalidateStyleCache();\n      perfCount('profile.active.changed', 1);\n    }\n  }\n\n  /**\n   * Resolve styles for all overlays with profile layering\n   */\n  resolveOverlayStyles(overlays) {\n    return perfTime('profile.resolve.overlays', () => {\n      const resolved = overlays.map(overlay => {\n        const resolvedOverlay = { ...overlay };\n\n        // Get merged style with profile layers\n        resolvedOverlay.style = this.resolveOverlayStyle(overlay);\n\n        return resolvedOverlay;\n      });\n\n      perfCount('profile.overlays.processed', overlays.length);\n      return resolved;\n    });\n  }\n\n  /**\n   * Resolve style for a single overlay with profile layering\n   */\n  resolveOverlayStyle(overlay) {\n    return perfTime('profile.resolve.single', () => {\n      // Check cache first\n      const cacheKey = this.buildStyleCacheKey(overlay);\n\n      if (this.styleCache.has(cacheKey)) {\n        this.perfStats.cacheHits++;\n        perfCount('profile.cache.hits', 1);\n        return this.styleCache.get(cacheKey);\n      }\n\n      // Build style layers\n      const styleLayers = this.buildStyleLayers(overlay);\n\n      // Merge layers with precedence\n      const mergedStyle = this.mergeStyleLayers(styleLayers);\n\n      // Cache the result\n      this.styleCache.set(cacheKey, mergedStyle);\n      this.perfStats.cacheMisses++;\n      this.perfStats.styleMerges++;\n      perfCount('profile.cache.misses', 1);\n\n      return mergedStyle;\n    });\n  }\n\n  /**\n   * Build ordered style layers for an overlay\n   *\n   * FIXED: Corrected precedence order - overlays should override profiles\n   */\n  buildStyleLayers(overlay) {\n    const layers = [];\n\n    // Layer 1-N: Active profile styles (LOWEST precedence - applied first)\n    this.activeProfiles.forEach((profileId, index) => {\n      const profile = this.profileIndex.get(profileId);\n\n      if (profile) {\n        // Check for overlay-specific style in profile\n        const overlayStyle = this.getProfileOverlayStyle(profile, overlay.id, overlay.type);\n\n        if (overlayStyle) {\n          layers.push({\n            source: 'profile',\n            sourceId: profileId,\n            style: overlayStyle,\n            precedence: 100 + index // Earlier profiles have lower precedence\n          });\n        }\n      }\n    });\n\n    // Layer N+1: Base overlay style (HIGHEST precedence - applied last)\n    if (overlay.style) {\n      layers.push({\n        source: 'overlay',\n        sourceId: overlay.id,\n        style: overlay.style,\n        precedence: 1000 // Much higher than any profile\n      });\n    }\n\n    // Sort by precedence (lower numbers first, higher numbers override)\n    return layers.sort((a, b) => a.precedence - b.precedence);\n  }\n\n  /**\n   * Get profile style for a specific overlay\n   */\n  getProfileOverlayStyle(profile, overlayId, overlayType) {\n    // Check for direct overlay ID match\n    if (profile.overlays && profile.overlays[overlayId]) {\n      return profile.overlays[overlayId];\n    }\n\n    // Check for type-based defaults\n    if (profile.defaults && profile.defaults[overlayType]) {\n      return profile.defaults[overlayType];\n    }\n\n    return null;\n  }\n\n  /**\n   * Merge style layers with proper precedence\n   */\n  mergeStyleLayers(layers) {\n    const merged = {};\n    const provenance = {}; // Track which profile/source set each property\n\n    layers.forEach(layer => {\n      Object.entries(layer.style).forEach(([property, value]) => {\n        // Later layers override earlier ones\n        merged[property] = value;\n        provenance[property] = {\n          source: layer.source,\n          sourceId: layer.sourceId,\n          precedence: layer.precedence\n        };\n      });\n    });\n\n    // Attach provenance for debugging (non-enumerable)\n    Object.defineProperty(merged, '__styleProvenance', {\n      value: provenance,\n      enumerable: false,\n      writable: false\n    });\n\n    return merged;\n  }\n\n  /**\n   * Build cache key for overlay style\n   */\n  buildStyleCacheKey(overlay) {\n    const keyParts = [\n      overlay.id,\n      overlay.type || 'unknown',\n      this.getOverlayStyleHash(overlay.style),\n      this.activeProfiles.join(',')\n    ];\n\n    return keyParts.join('|');\n  }\n\n  /**\n   * Get simple hash of overlay style for cache key\n   */\n  getOverlayStyleHash(style) {\n    if (!style || typeof style !== 'object') return 'empty';\n\n    // Simple hash based on stringified style\n    return JSON.stringify(style).length.toString(36);\n  }\n\n  /**\n   * Invalidate style cache\n   */\n  invalidateStyleCache() {\n    this.styleCache.clear();\n    this.perfStats.invalidations++;\n    perfCount('profile.cache.invalidated', 1);\n  }\n\n  /**\n   * Get profile by ID\n   */\n  getProfile(profileId) {\n    return this.profileIndex.get(profileId);\n  }\n\n  /**\n   * Get all active profiles\n   */\n  getActiveProfiles() {\n    return [...this.activeProfiles];\n  }\n\n  /**\n   * Get available profile IDs\n   */\n  getAvailableProfiles() {\n    return Array.from(this.profileIndex.keys());\n  }\n\n  /**\n   * Check if a profile is active\n   */\n  isProfileActive(profileId) {\n    return this.activeProfiles.includes(profileId);\n  }\n\n  /**\n   * Get performance statistics\n   */\n  getStats() {\n    return {\n      ...this.perfStats,\n      profileCount: this.profileIndex.size,\n      activeProfileCount: this.activeProfiles.length,\n      cacheSize: this.styleCache.size,\n      hitRate: this.perfStats.cacheHits / (this.perfStats.cacheHits + this.perfStats.cacheMisses) || 0\n    };\n  }\n\n  /**\n   * Get detailed profile information for debugging\n   */\n  getDebugInfo() {\n    const info = {\n      availableProfiles: {},\n      activeProfiles: this.activeProfiles,\n      cacheSize: this.styleCache.size,\n      stats: this.getStats()\n    };\n\n    // Add profile details\n    this.profileIndex.forEach((profile, profileId) => {\n      info.availableProfiles[profileId] = {\n        hasDefaults: !!(profile.defaults && Object.keys(profile.defaults).length > 0),\n        hasOverlays: !!(profile.overlays && Object.keys(profile.overlays).length > 0),\n        defaultTypes: profile.defaults ? Object.keys(profile.defaults) : [],\n        overlayIds: profile.overlays ? Object.keys(profile.overlays) : []\n      };\n    });\n\n    return info;\n  }\n\n  /**\n   * Export resolver statistics for debugging\n   */\n  exportStats(options = {}) {\n    const stats = this.getStats();\n\n    if (options.includeDebug) {\n      stats.debug = this.getDebugInfo();\n    }\n\n    return options.format === 'json' ?\n      JSON.stringify(stats, null, 2) :\n      stats;\n  }\n}\n\n// Global resolver instance\nconst globalProfileResolver = new ProfileResolver();\n\n// Debug exposure\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdProfile = {\n    resolver: globalProfileResolver,\n    getStats: () => globalProfileResolver.getStats(),\n    getDebugInfo: () => globalProfileResolver.getDebugInfo(),\n    getActiveProfiles: () => globalProfileResolver.getActiveProfiles(),\n    getAvailableProfiles: () => globalProfileResolver.getAvailableProfiles(),\n    export: (options) => globalProfileResolver.exportStats(options)\n  };\n}\n\nexport { globalProfileResolver };","export function isPlain(o) {\n  return o && typeof o === 'object' && !Array.isArray(o);\n}\nexport function deepMerge(target, source) {\n  if (!isPlain(source)) return source;\n  if (!isPlain(target)) target = {};\n  for (const k of Object.keys(source)) {\n    const sv = source[k];\n    const tv = target[k];\n    if (isPlain(sv) && isPlain(tv)) {\n      target[k] = deepMerge(tv, sv);\n    } else {\n      // Arrays & scalars replace (per spec).\n      target[k] = sv;\n    }\n  }\n  return target;\n}\n","import { globalProfileResolver } from '../profile/ProfileResolver.js';\nimport { applyOverlayPatches } from '../rules/RulesEngine.js';\nimport { resolveValueMaps } from '../valueMap/resolveValueMaps.js';\nimport { resolveDesiredAnimations } from '../animation/resolveAnimations.js';\nimport { resolveDesiredTimelines } from '../animation/resolveTimelines.js';\nimport { perfTime } from '../perf/PerfCounters.js';\n\nexport class ModelBuilder {\n  constructor(mergedConfig, cardModel, systemsManager) {\n    this.mergedConfig = mergedConfig;\n    this.cardModel = cardModel;\n    this.systems = systemsManager;\n\n    // Replace profile index building with ProfileResolver\n    globalProfileResolver.loadProfiles(mergedConfig.profiles || []);\n\n    this.animationIndex = new Map((mergedConfig.animations || []).map(a => [a.id, a]));\n    this.timelineDefs = mergedConfig.timelines || [];\n    this.runtimeActiveProfiles = Array.isArray(mergedConfig.active_profiles)\n      ? mergedConfig.active_profiles.slice()\n      : [];\n    this._resolvedModelRef = null;\n  }\n\n  computeResolvedModel() {\n    // Anchor repair diagnostic\n    this._ensureAnchors();\n\n    // Assemble base overlays with profiles\n    const baseOverlays = this._assembleBaseOverlays();\n\n    // Subscribe overlays to data sources\n    this._subscribeOverlaysToDataSources(baseOverlays);\n\n    // Apply rules\n    const ruleResult = this._applyRules();\n\n    // Handle profile changes from rules\n    this._updateActiveProfiles(ruleResult);\n\n    // Apply overlay patches\n    const overlaysWithPatches = this._applyOverlayPatches(baseOverlays, ruleResult);\n\n    // Value map substitutions\n    this._resolveValueMaps(overlaysWithPatches);\n\n    // Process animations\n    const { activeAnimations, animDiff, tlDiff } = this._processAnimations(overlaysWithPatches, ruleResult);\n\n    // Build final resolved model\n    const resolved = {\n      viewBox: this.cardModel.viewBox,\n      anchors: { ...this.cardModel.anchors },\n      overlays: overlaysWithPatches,\n      animations: animDiff.active,\n      timelines: tlDiff.active,\n      config: this.mergedConfig,\n      active_profiles: this.runtimeActiveProfiles.slice()\n    };\n\n    // DEBUG: Check final overlay state before rendering\n    const titleOverlay = resolved.overlays.find(o => o.id === 'title_overlay');\n    if (titleOverlay) {\n      console.log('[ModelBuilder] 🏁 Final title_overlay state before rendering:', {\n        id: titleOverlay.id,\n        color: titleOverlay.style?.color,\n        status_indicator: titleOverlay.style?.status_indicator,\n        finalStyle: titleOverlay.finalStyle\n      });\n    }\n\n    // Update router\n    try {\n      this.systems.router.setOverlays && this.systems.router.setOverlays(resolved.overlays);\n    } catch(_) {}\n\n    this._resolvedModelRef = resolved;\n    return resolved;\n  }\n\n  getResolvedModel() {\n    return this._resolvedModelRef;\n  }\n\n  _ensureAnchors() {\n    if (!this.cardModel.anchors || Object.keys(this.cardModel.anchors).length === 0) {\n      if (this.mergedConfig.anchors && Object.keys(this.mergedConfig.anchors).length) {\n        console.warn('[MSD v1] computeResolvedModel: anchors missing – repairing from merged.anchors');\n        this.cardModel.anchors = { ...this.mergedConfig.anchors };\n      } else {\n        console.warn('[MSD v1] computeResolvedModel: anchors missing and no merged fallback available.');\n      }\n    }\n  }\n\n  _assembleBaseOverlays() {\n    return perfTime('profiles.assemble', () => {\n      // Set active profiles before resolving\n      globalProfileResolver.setActiveProfiles(this.runtimeActiveProfiles);\n\n      return this.cardModel.overlaysBase.map(o => {\n        // Replace assembleOverlayBaseStyle with ProfileResolver\n        const style = globalProfileResolver.resolveOverlayStyle(o);\n\n        // Get provenance from resolved style (if needed for debugging)\n        const sources = style.__styleProvenance ?\n          Object.entries(style.__styleProvenance).map(([prop, prov]) => ({\n            kind: prov.source,\n            id: prov.sourceId\n          })) : [];\n\n        // Preserve ALL properties from raw overlay config\n        const resolvedOverlay = {\n          id: o.id,\n          type: o.type,\n          style,\n          finalStyle: { ...style },\n          _styleSources: sources,\n          _raw: o.raw,\n          anchor: o.raw?.anchor,\n          attach_to: o.raw?.attach_to,\n          position: o.raw?.position,\n          size: o.raw?.size\n        };\n\n        // Preserve data source and routing properties\n        if (o.raw?.source) {\n          resolvedOverlay.source = o.raw.source;\n        }\n\n        if (o.raw?.route) {\n          resolvedOverlay.route = o.raw.route;\n        }\n\n        return resolvedOverlay;\n      });\n    });\n  }\n\n  /* OLD\n  _subscribeOverlaysToDataSources(baseOverlays) {\n    if (this.systems.dataSourceManager && baseOverlays) {\n      let subscriptionCount = 0;\n      baseOverlays.forEach(overlay => {\n        if ((overlay.type === 'sparkline' || overlay.type === 'ribbon') && overlay.source) {\n          try {\n            this.systems.dataSourceManager.subscribeOverlay(overlay, (overlay, updateData) => {\n              // FIX: updateData IS the source data, not updateData.sourceData\n              console.log('[MSD v1] 📊 Data update for overlay', overlay.id, 'value:', updateData.v);\n\n              // Update the renderer with real data - pass updateData directly\n              if (this.systems.renderer && this.systems.renderer.updateOverlayData) {\n                this.systems.renderer.updateOverlayData(overlay.id, updateData);\n              }\n            });\n            subscriptionCount++;\n            console.log('[MSD v1] ✅ Subscribed overlay', overlay.id, 'to data source', overlay.source);\n          } catch (error) {\n            console.warn('[MSD v1] ⚠️ Failed to subscribe overlay', overlay.id, 'to source', overlay.source, ':', error.message);\n          }\n        }\n      });\n\n      if (subscriptionCount > 0) {\n        console.log('[MSD v1] ✅ Established', subscriptionCount, 'overlay data subscriptions');\n      }\n    }\n  }\n  */\n\n\n\n  _subscribeOverlaysToDataSources(baseOverlays) {\n    if (!this.systems.dataSourceManager || !baseOverlays) {\n      console.log('[MSD v1] Skipping overlay subscriptions - no DataSourceManager or overlays');\n      return;\n    }\n\n    let subscriptionCount = 0;\n    let pendingSubscriptions = 0;\n\n    baseOverlays.forEach(overlay => {\n      if ((overlay.type === 'sparkline' || overlay.type === 'ribbon') && overlay.source) {\n        try {\n          // Check if data source exists and is ready\n          const dataSource = this.systems.dataSourceManager.getSource(overlay.source);\n          if (!dataSource) {\n            console.warn(`[MSD v1] Data source '${overlay.source}' not found for overlay ${overlay.id}`);\n            return;\n          }\n\n          // Check data source readiness\n          const currentData = dataSource.getCurrentData();\n          const isReady = currentData && (currentData.bufferSize > 0 || currentData.v !== undefined);\n\n          console.log(`[MSD v1] Subscribing overlay ${overlay.id} to source ${overlay.source}:`, {\n            sourceReady: isReady,\n            bufferSize: currentData?.bufferSize || 0,\n            hasValue: currentData?.v !== undefined\n          });\n\n          // Subscribe with enhanced callback\n          const unsubscribe = this.systems.dataSourceManager.subscribeOverlay(overlay, (overlayConfig, updateData) => {\n            console.log(`[MSD v1] 📊 Data update for overlay ${overlayConfig.id}:`, {\n              value: updateData.v,\n              bufferSize: updateData.buffer?.size?.() || 0,\n              hasHistoricalData: !!(updateData.historicalData?.length),\n              sourceReady: true\n            });\n\n            // Update the renderer with real data\n            if (this.systems.renderer && this.systems.renderer.updateOverlayData) {\n              try {\n                this.systems.renderer.updateOverlayData(overlayConfig.id, updateData);\n              } catch (error) {\n                console.error(`[MSD v1] Error updating overlay ${overlayConfig.id}:`, error);\n              }\n            } else {\n              console.warn(`[MSD v1] Renderer not available for overlay update: ${overlayConfig.id}`);\n            }\n          });\n\n          if (unsubscribe) {\n            subscriptionCount++;\n            if (isReady) {\n              console.log(`[MSD v1] ✅ Subscribed overlay ${overlay.id} to ready source ${overlay.source}`);\n            } else {\n              pendingSubscriptions++;\n              console.log(`[MSD v1] ⏳ Subscribed overlay ${overlay.id} to pending source ${overlay.source}`);\n            }\n\n            // Store unsubscribe function for cleanup\n            if (!this._overlayUnsubscribers) {\n              this._overlayUnsubscribers = new Map();\n            }\n            if (!this._overlayUnsubscribers.has(overlay.id)) {\n              this._overlayUnsubscribers.set(overlay.id, []);\n            }\n            this._overlayUnsubscribers.get(overlay.id).push(unsubscribe);\n          }\n\n        } catch (error) {\n          console.warn(`[MSD v1] ⚠️ Failed to subscribe overlay ${overlay.id} to source ${overlay.source}:`, error.message);\n        }\n      }\n    });\n\n    if (subscriptionCount > 0) {\n      console.log(`[MSD v1] ✅ Established ${subscriptionCount} overlay data subscriptions (${pendingSubscriptions} pending data)`);\n    }\n\n    // Monitor pending subscriptions and log when they become ready\n    if (pendingSubscriptions > 0) {\n      this._monitorPendingSubscriptions(baseOverlays, pendingSubscriptions);\n    }\n\n    // Subscribe to text overlays data sources\n    this._subscribeTextOverlaysToDataSources(baseOverlays);\n  }\n\n\n\n\n  /**\n   * Monitor pending subscriptions and report when data becomes available\n   * @private\n   * @param {Array} baseOverlays - Array of overlay configurations\n   * @param {number} pendingCount - Initial count of pending subscriptions\n   */\n  _monitorPendingSubscriptions(baseOverlays, pendingCount) {\n    let checkCount = 0;\n    const maxChecks = 50; // Maximum number of checks (5 seconds with 100ms intervals)\n\n    const checkInterval = setInterval(() => {\n      checkCount++;\n      let stillPending = 0;\n\n      baseOverlays.forEach(overlay => {\n        if ((overlay.type === 'sparkline' || overlay.type === 'ribbon') && overlay.source) {\n          const dataSource = this.systems.dataSourceManager.getSource(overlay.source);\n          if (dataSource) {\n            const currentData = dataSource.getCurrentData();\n            const isReady = currentData && (currentData.bufferSize > 0 || currentData.v !== undefined);\n            if (!isReady) {\n              stillPending++;\n            }\n          }\n        }\n      });\n\n      if (stillPending === 0) {\n        console.log(`[MSD v1] 🎉 All overlay data sources are now ready (checked ${checkCount} times)`);\n        clearInterval(checkInterval);\n      } else if (checkCount >= maxChecks) {\n        console.warn(`[MSD v1] ⏰ Timeout waiting for ${stillPending} data sources to become ready`);\n        clearInterval(checkInterval);\n      } else if (checkCount % 10 === 0) {\n        // Log progress every second (10 * 100ms)\n        console.log(`[MSD v1] ⏳ Still waiting for ${stillPending} data sources (${checkCount * 100}ms elapsed)`);\n      }\n    }, 100); // Check every 100ms\n  }\n\n\n\n\n  _applyRules() {\n    console.log('[ModelBuilder] 🔍 _applyRules() called');\n\n    // FIXED: Always evaluate rules during render, not just when dirty\n    // This ensures rule patches are generated even if rules weren't marked dirty externally\n    this.systems.rulesEngine.markAllDirty();\n    console.log('[ModelBuilder] 📏 Marked all rules dirty');\n\n    // Use DataSourceManager's getEntity for comprehensive entity resolution\n    const getEntity = (entityId) => {\n      // Use DataSourceManager's getEntity which handles:\n      // - DataSource references with dot notation (temperature_enhanced.transformations.celsius)\n      // - Regular Home Assistant entities\n      // - Fallback to HASS states\n      if (this.systems.dataSourceManager && this.systems.dataSourceManager.getEntity) {\n        return this.systems.dataSourceManager.getEntity(entityId);\n      }\n\n      // Fallback to direct HASS access if no DataSourceManager\n      if (this.systems._currentHass?.states?.[entityId]) {\n        const hassState = this.systems._currentHass.states[entityId];\n        return {\n          state: hassState.state,\n          attributes: hassState.attributes || {}\n        };\n      }\n\n      return null;\n    };\n\n    const ruleResult = this.systems.rulesEngine.evaluateDirty({ getEntity });\n    console.log('[ModelBuilder] 📏 Rule evaluation result:', {\n      overlayPatches: ruleResult.overlayPatches.length,\n      patches: ruleResult.overlayPatches\n    });\n\n    return ruleResult;\n  }  _updateActiveProfiles(ruleResult) {\n    if (ruleResult.profilesAdd?.length || ruleResult.profilesRemove?.length) {\n      const set = new Set(this.runtimeActiveProfiles);\n      ruleResult.profilesAdd.forEach(p => set.add(p));\n      ruleResult.profilesRemove.forEach(p => set.delete(p));\n      this.runtimeActiveProfiles = Array.from(set);\n\n      // Update ProfileResolver with new active profiles\n      globalProfileResolver.setActiveProfiles(this.runtimeActiveProfiles);\n    }\n  }\n\n  _applyOverlayPatches(baseOverlays, ruleResult) {\n    console.log('[ModelBuilder] 🎨 _applyOverlayPatches() called with:', {\n      overlayCount: baseOverlays.length,\n      patchCount: ruleResult.overlayPatches.length,\n      patches: ruleResult.overlayPatches\n    });\n\n    const result = perfTime('styles.patch', () =>\n      applyOverlayPatches(baseOverlays, ruleResult.overlayPatches)\n    );\n\n    console.log('[ModelBuilder] 🎨 Overlay patches applied. Checking title_overlay:');\n    const titleOverlay = result.find(o => o.id === 'title_overlay');\n    if (titleOverlay) {\n      console.log('[ModelBuilder] 🎯 Title overlay after patching:', {\n        id: titleOverlay.id,\n        color: titleOverlay.style?.color,\n        status_indicator: titleOverlay.style?.status_indicator\n      });\n    }\n\n    return result;\n  }\n\n  _resolveValueMaps(overlaysWithPatches) {\n    perfTime('value_map.subst', () =>\n      resolveValueMaps(overlaysWithPatches, {\n        getEntity: id => this.systems.entityRuntime.getEntity(id)\n      })\n    );\n  }\n\n  _processAnimations(overlaysWithPatches, ruleResult) {\n    const desiredAnimations = resolveDesiredAnimations(overlaysWithPatches, this.animationIndex, ruleResult.animations);\n    const desiredTimelines = resolveDesiredTimelines(this.timelineDefs);\n    const activeAnimations = [];\n\n    desiredAnimations.forEach(animDef => {\n      const instance = this.systems.animRegistry.getOrCreateInstance(animDef.definition, animDef.targets);\n      if (instance) {\n        activeAnimations.push({\n          id: animDef.id,\n          instance,\n          hash: this.systems.animRegistry.computeInstanceHash(animDef.definition)\n        });\n      }\n    });\n\n    const animDiff = { active: activeAnimations };\n    const tlDiff = { active: desiredTimelines };\n\n    // Assign animation hash to overlays\n    const overlayAnimByKey = new Map();\n    animDiff.active.forEach(a => {\n      if (a.overlayId) overlayAnimByKey.set(a.overlayId, a.hash);\n    });\n    overlaysWithPatches.forEach(o => {\n      const h = overlayAnimByKey.get(o.id);\n      if (h) o.animation_hash = h;\n    });\n\n    return { activeAnimations, animDiff, tlDiff };\n  }\n\n\n  /**\n   * Clean up overlay subscriptions\n   * @public\n   */\n  destroy() {\n    if (this._overlayUnsubscribers) {\n      console.log(`[MSD v1] Cleaning up ${this._overlayUnsubscribers.size} overlay subscriptions`);\n\n      for (const [overlayId, unsubscribers] of this._overlayUnsubscribers) {\n        unsubscribers.forEach(unsubscribe => {\n          try {\n            unsubscribe();\n          } catch (error) {\n            console.warn(`[MSD v1] Error unsubscribing overlay ${overlayId}:`, error);\n          }\n        });\n      }\n\n      this._overlayUnsubscribers.clear();\n    }\n  }\n\n  /**\n   * Set up DataSource subscriptions for text overlays that use template strings\n   * @param {Array} overlays - Array of overlay configurations\n   * @private\n   */\n  _subscribeTextOverlaysToDataSources(overlays) {\n    overlays.forEach(overlay => {\n      if (overlay.type === 'text') {\n        // Check if text content contains DataSource references\n        const textContent = overlay.text || overlay.content || overlay.finalStyle?.value || '';\n        const dataSourceRef = overlay.data_source || overlay._raw?.data_source || overlay.finalStyle?.data_source;\n\n        // Extract DataSource references from template strings like {temperature_enhanced.transformations.celsius}\n        const templateRefs = this._extractDataSourceReferences(textContent);\n\n        // Subscribe to direct DataSource references\n        if (dataSourceRef) {\n          this._subscribeTextOverlayToDataSource(overlay.id, dataSourceRef);\n        }\n\n        // Subscribe to template string DataSource references\n        templateRefs.forEach(ref => {\n          this._subscribeTextOverlayToDataSource(overlay.id, ref);\n        });\n      }\n    });\n  }\n\n  /**\n   * Subscribe a text overlay to a specific DataSource\n   * @param {string} overlayId - ID of the text overlay\n   * @param {string} dataSourceRef - DataSource reference (e.g., 'temperature_enhanced')\n   * @private\n   */\n  _subscribeTextOverlayToDataSource(overlayId, dataSourceRef) {\n    try {\n      const dataSourceManager = this.systems?.dataSourceManager;\n      if (!dataSourceManager) {\n        console.warn(`[ModelBuilder] DataSourceManager not available for text overlay subscription: ${overlayId}`);\n        return;\n      }\n\n      // Parse DataSource reference to get source name\n      const sourceName = dataSourceRef.split('.')[0];\n      const dataSource = dataSourceManager.getSource(sourceName);\n\n      if (!dataSource) {\n        console.warn(`[ModelBuilder] DataSource '${sourceName}' not found for text overlay: ${overlayId}`);\n        return;\n      }\n\n      // Create subscription callback\n      const callback = (data) => {\n        console.log(`[ModelBuilder] 📊 Text overlay ${overlayId} received DataSource update from ${sourceName}`);\n\n        // Notify AdvancedRenderer to update the text overlay\n        if (this.systems.renderer && this.systems.renderer.updateOverlayData) {\n          this.systems.renderer.updateOverlayData(overlayId, data);\n        }\n      };\n\n      // Subscribe to the DataSource\n      dataSource.subscribe(overlayId, callback);\n\n      console.log(`[ModelBuilder] ✅ Subscribed text overlay ${overlayId} to DataSource ${sourceName}`);\n\n    } catch (error) {\n      console.error(`[ModelBuilder] Failed to subscribe text overlay ${overlayId} to DataSource ${dataSourceRef}:`, error);\n    }\n  }\n\n  /**\n   * Extract DataSource references from template strings\n   * @param {string} content - Text content that may contain template strings\n   * @returns {Array<string>} Array of DataSource references\n   * @private\n   */\n  _extractDataSourceReferences(content) {\n    if (!content || typeof content !== 'string') {\n      return [];\n    }\n\n    const references = [];\n    const templatePattern = /\\{([^}]+)\\}/g;\n    let match;\n\n    while ((match = templatePattern.exec(content)) !== null) {\n      const reference = match[1].split(':')[0].trim(); // Remove formatting specs\n\n      // Only include if it looks like a DataSource reference (contains dots or is a simple identifier)\n      if (reference.includes('.') || /^[a-zA-Z_][a-zA-Z0-9_]*$/.test(reference)) {\n        const sourceName = reference.split('.')[0];\n        if (!references.includes(sourceName)) {\n          references.push(sourceName);\n        }\n      }\n    }\n\n    return references;\n  }\n}\n","import { perfInc, perfTime } from '../perf/PerfCounters.js';\nimport { linearMap } from '../util/linearMap.js';\n\nexport function resolveValueMaps(resolvedOverlays, ctx) {\n  return perfTime('value_map.resolve', () => {\n    let success = 0;\n    let fail = 0;\n\n    for (const ov of resolvedOverlays) {\n      if (!ov.finalStyle) continue;\n      ov.finalStyle = walk(ov.finalStyle);\n    }\n\n    perfInc('value_map.resolve.count', success);\n    perfInc('value_map.fail.count', fail);\n\n    function walk(node) {\n      if (!node || typeof node !== 'object') return node;\n      // value_map descriptor: exact shape { value_map: {...} } OR object with only that key\n      if (node.value_map && Object.keys(node).length === 1) {\n        const val = computeValueMap(node.value_map);\n        return val;\n      }\n      // Recurse\n      if (Array.isArray(node)) return node.map(walk);\n      const out = {};\n      for (const k of Object.keys(node)) {\n        out[k] = walk(node[k]);\n      }\n      return out;\n    }\n\n    function computeValueMap(desc) {\n      try {\n        const entityId = desc.entity;\n        if (!entityId) { fail++; return fallback(desc); }\n        const ent = ctx?.getEntity ? ctx.getEntity(entityId) : null;\n        if (!ent) { fail++; return fallback(desc); }\n        let raw = ent.state;\n        if (desc.attribute && ent.attributes) raw = ent.attributes[desc.attribute];\n        let num = Number(raw);\n        if (!Number.isFinite(num)) { fail++; return fallback(desc); }\n        const [inA, inB] = desc.input || [];\n        const [outA, outB] = desc.output || [];\n        if (![inA,inB,outA,outB].every(Number.isFinite)) { fail++; return fallback(desc); }\n        let mapped = linearMap(num, inA, inB, outA, outB, !!desc.clamp);\n        if (Number.isFinite(desc.round)) {\n          const pow = Math.pow(10, desc.round);\n          mapped = Math.round(mapped * pow) / pow;\n        }\n        success++;\n        return mapped;\n      } catch {\n        fail++;\n        return fallback(desc);\n      }\n    }\n    function fallback(desc) {\n      if (desc && Number.isFinite(desc.default)) return desc.default;\n      if (Array.isArray(desc?.output) && Number.isFinite(desc.output[0])) return desc.output[0];\n      return 1; // minimal visible default\n    }\n  });\n}\n","export function linearMap(val, inMin, inMax, outMin, outMax, clamp) {\n  if (inMax === inMin) return outMin;\n  let t = (val - inMin) / (inMax - inMin);\n  if (clamp) {\n    if (t < 0) t = 0;\n    else if (t > 1) t = 1;\n  }\n  return outMin + t * (outMax - outMin);\n}\n","import { deepMerge } from '../util/deepMerge.js';\n\n/**\n * Build desired animation instances.\n * @param {Array} overlays resolved overlays (with _raw for original)\n * @param {Object} animationIndex id -> animation def\n * @param {Array} ruleAnimations from rulesEngine (ref, override, priority)\n */\n// NOTE Wave 1: preset resolution deferred to AnimationRegistry (builders in presets.js)\nexport function resolveDesiredAnimations(overlays, animationIndex, ruleAnimations) {\n  const desired = [];\n  const ruleOverridesGrouped = groupRuleAnimOverrides(ruleAnimations);\n\n  // Overlay-level animations\n  for (const ov of overlays) {\n    const raw = ov._raw || ov.raw || {};\n    if (!raw.animation_ref) continue;\n    const base = animationIndex.get(raw.animation_ref);\n    if (!base) continue;\n    // Build merged params\n    let params = {};\n    if (base.params) params = deepMerge(params, base.params);\n    if (raw.animation_override?.params) params = deepMerge(params, raw.animation_override.params);\n\n    // Apply highest-priority rule override first (only first per ref used per overlay)\n    const ruleList = ruleOverridesGrouped.get(raw.animation_ref);\n    if (ruleList && ruleList.length) {\n      // Already sorted by priority desc\n      for (const r of ruleList) {\n        if (r.override?.params) params = deepMerge(params, r.override.params);\n        break; // only top-level override for now\n      }\n    }\n\n    desired.push({\n      key: `overlay:${ov.id}:${raw.animation_ref}`,\n      preset: base.preset,\n      params,\n      targets: [`#${ov.id}`],\n      ref: raw.animation_ref,\n      overlayId: ov.id\n    });\n  }\n\n  // Standalone animations (defs with explicit targets)\n  for (const [id, def] of animationIndex.entries()) {\n    if (!def.targets) continue;\n    desired.push({\n      key: `standalone:${id}`,\n      preset: def.preset,\n      params: def.params || {},\n      targets: Array.isArray(def.targets) ? def.targets.slice() : [def.targets],\n      ref: id\n    });\n  }\n\n  return desired;\n}\n\nfunction groupRuleAnimOverrides(ruleAnims) {\n  const map = new Map();\n  (ruleAnims || []).forEach(a => {\n    if (!a.ref) return;\n    if (!map.has(a.ref)) map.set(a.ref, []);\n    map.get(a.ref).push(a);\n  });\n  // Sort each list by priority desc\n  map.forEach(list => list.sort((a, b) => (b.priority || 0) - (a.priority || 0)));\n  return map;\n}\n","import { deepMerge } from '../util/deepMerge.js';\n\nexport function resolveDesiredTimelines(timelineDefs = []) {\n  return timelineDefs.map(tl => {\n    const globals = { ...(tl.globals || {}) };\n    const steps = (tl.steps || []).map(s => ({\n      targets: s.targets,\n      preset: s.preset,\n      params: deepMerge({}, s.params || {}),\n      offset: s.offset\n    }));\n    return {\n      id: tl.id,\n      globals,\n      steps\n    };\n  });\n}\n","/**\n * Phase 2: Overlay introspection utilities\n * Provides overlay listing, highlighting, and geometry utilities\n */\n\nexport class MsdIntrospection {\n  static getOverlaysSvg(root) {\n    return root?.querySelector?.('#msd_svg_overlays svg') ||\n           root?.querySelector?.('#cblcars-msd-wrapper svg') || null;\n  }\n\n  static listOverlays(root) {\n    const out = [];\n    const svg = this.getOverlaysSvg(root);\n    if (!svg) return out;\n\n    // Get resolved model from new pipeline\n    const resolvedModel = root.__msdResolvedModel || {};\n    const overlaysById = new Map((resolvedModel.overlays || []).map(o => [o.id, o]));\n\n    // Find overlay elements\n    let nodes = Array.from(svg.querySelectorAll('[id][data-cblcars-root=\"true\"]'));\n    if (!nodes.length) {\n      // Fallback: find any elements with IDs, excluding debug layers\n      nodes = Array.from(svg.querySelectorAll('[id]'))\n        .filter(n => n.id && n.id !== 'cblcars-debug-layer' && n.id !== 'cblcars-highlight-layer');\n    }\n\n    for (const node of nodes) {\n      const id = node.id;\n      const overlay = overlaysById.get(id);\n      const bbox = this.getOverlayBBox(id, root);\n\n      out.push({\n        id,\n        type: overlay?.type || node.getAttribute?.('data-cblcars-type') || node.tagName?.toLowerCase() || 'unknown',\n        bbox,\n        hasErrors: false, // TODO: Integration with validation system\n        hasWarnings: false,\n        element: node,\n        config: overlay\n      });\n    }\n\n    return out;\n  }\n\n  static getOverlayBBox(id, root) {\n    if (!id || !root) return null;\n\n    // 1) Try SVG element getBBox\n    let el = root.getElementById?.(id);\n    if (el && typeof el.getBBox === 'function') {\n      try {\n        const gbb = el.getBBox();\n        if (gbb && Number.isFinite(gbb.width) && Number.isFinite(gbb.height)) {\n          return { x: gbb.x, y: gbb.y, w: gbb.width, h: gbb.height };\n        }\n      } catch (_) {}\n    }\n\n    // 2) Ribbon fallback: backdrop element\n    const backdrop = root.getElementById?.(`${id}_backdrop`);\n    if (backdrop && typeof backdrop.getBBox === 'function') {\n      try {\n        const bb2 = backdrop.getBBox();\n        if (bb2 && (bb2.width > 0 || bb2.height > 0)) {\n          return { x: bb2.x, y: bb2.y, w: bb2.width, h: bb2.height };\n        }\n      } catch (_) {}\n    }\n\n    // 3) Config fallback: compute from overlay position + size\n    const resolvedModel = root.__msdResolvedModel || {};\n    const overlay = resolvedModel.overlays?.find(o => o.id === id);\n    if (overlay && overlay.position && overlay.size) {\n      const anchors = resolvedModel.anchors || {};\n      const vb = resolvedModel.viewBox || [0, 0, 100, 100];\n      const pos = this.resolvePointFromConfig(overlay.position, anchors, vb);\n      const sz = this.resolveSizeFromConfig(overlay.size, vb);\n      if (pos && sz) {\n        return { x: pos[0], y: pos[1], w: sz.w, h: sz.h };\n      }\n    }\n\n    return null;\n  }\n\n  static highlight(ids, opts = {}) {\n    const idList = Array.isArray(ids) ? ids : [ids];\n    const root = opts.root;\n\n    // Require explicit root element - no document fallback\n    if (!root) {\n      console.warn('[MsdIntrospection] Root element required for highlighting');\n      return;\n    }\n\n    const svg = this.getOverlaysSvg(root);\n    if (!svg) {\n      console.warn('[MsdIntrospection] No SVG found for highlighting');\n      return;\n    }\n\n    const viewBox = this.getViewBox(root, svg) || [0, 0, 400, 200];\n    const color = opts.color || '#ffcc00';\n    const strokeWidth = Number.isFinite(opts.strokeWidth)\n      ? opts.strokeWidth\n      : Math.max(1.5, Math.round(viewBox[3] * 0.004));\n    const duration = Math.max(250, opts.duration || 1500);\n\n    // Use proper createElementNS from root's document\n    const doc = root.ownerDocument || root.document;\n    if (!doc || !doc.createElementNS) {\n      console.warn('[MsdIntrospection] createElementNS not available');\n      return;\n    }\n\n    // Ensure highlight layer exists\n    let highlightLayer = svg.querySelector('#cblcars-highlight-layer');\n    if (!highlightLayer) {\n      highlightLayer = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n      highlightLayer.setAttribute('id', 'cblcars-highlight-layer');\n      highlightLayer.style.pointerEvents = 'none';\n      svg.appendChild(highlightLayer);\n    }\n\n    // Clear existing highlights\n    highlightLayer.innerHTML = '';\n\n    // Create highlight rectangles\n    for (const id of idList) {\n      const bbox = this.getOverlayBBox(id, root);\n      if (bbox) {\n        const rect = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\n        rect.setAttribute('x', bbox.x);\n        rect.setAttribute('y', bbox.y);\n        rect.setAttribute('width', bbox.w);\n        rect.setAttribute('height', bbox.h);\n        rect.setAttribute('fill', 'none');\n        rect.setAttribute('stroke', color);\n        rect.setAttribute('stroke-width', strokeWidth);\n        rect.setAttribute('opacity', '0.9');\n\n        highlightLayer.appendChild(rect);\n      }\n    }\n\n    // Auto-clear after duration\n    setTimeout(() => {\n      if (highlightLayer && highlightLayer.parentNode) {\n        highlightLayer.innerHTML = '';\n      }\n    }, duration);\n  }\n\n  static getViewBox(root, svg) {\n    if (!svg) return null;\n\n    const viewBoxAttr = svg.getAttribute('viewBox');\n    if (viewBoxAttr) {\n      const parts = viewBoxAttr.split(/\\s+/).map(Number);\n      if (parts.length === 4) {\n        return parts;\n      }\n    }\n\n    return [0, 0, 400, 200]; // fallback\n  }\n\n  // Helper methods for point/size resolution\n  static resolvePointFromConfig(position, anchors = {}, viewBox = [0, 0, 400, 200]) {\n    const [minX, minY, vw, vh] = viewBox;\n    if (!position) return null;\n    if (typeof position === 'string' && anchors[position]) return anchors[position];\n    if (Array.isArray(position) && position.length === 2) {\n      const r = (v, axis) =>\n        typeof v === 'string' && v.trim().endsWith('%')\n          ? axis === 'x'\n            ? minX + (parseFloat(v) / 100) * vw\n            : minY + (parseFloat(v) / 100) * vh\n          : Number(v);\n      const x = r(position[0], 'x');\n      const y = r(position[1], 'y');\n      if (Number.isFinite(x) && Number.isFinite(y)) return [x, y];\n    }\n    return null;\n  }\n\n  static resolveSizeFromConfig(size, viewBox = [0, 0, 400, 200]) {\n    if (!Array.isArray(size) || size.length !== 2) return null;\n    const [, , vw, vh] = viewBox;\n    const toDim = (val, max) =>\n      typeof val === 'string' && val.trim().endsWith('%') ? (parseFloat(val) / 100) * max : Number(val);\n    const w = toDim(size[0], vw);\n    const h = toDim(size[1], vh);\n    if (!Number.isFinite(w) || !Number.isFinite(h)) return null;\n    return { w, h };\n  }\n}\n","import { perfTime } from '../perf/PerfCounters.js';\n\nexport async function buildCardModel(mergedConfig) {\n  return perfTime('cardModel.build', () => {\n    // Phase A: implement viewBox:auto + SVG anchor extraction + percent resolution.\n    const viewBox = [0, 0, 400, 200];\n    const anchors = {}; // merged + normalized numeric\n    const overlaysBase = mergedConfig.overlays.map(o => ({ id: o.id, type: o.type, style: o.style || {}, raw: o }));\n\n    // Ensure status_grid overlays preserve cells configuration\n    // Status grid overlays need special handling to preserve cell definitions\n\n    return { viewBox, anchors, overlaysBase, __raw: mergedConfig };\n  });\n}\n","/**\n * Phase 4: Unified MSD API structure\n * Provides window.cblcars.msd.api namespace\n * MSD v1 is now the stable system - no feature flag needed\n */\n\nexport class MsdApi {\n  static attach() {\n    if (typeof window === 'undefined') return;\n\n    window.cblcars = window.cblcars || {};\n    window.cblcars.msd = window.cblcars.msd || {};\n\n    // Enhanced API structure with DebugManager integration\n    window.cblcars.msd.api = {\n      overlays: {\n        list: (root) => this.listOverlays(root),\n        highlight: (ids, opts) => this.highlightOverlays(ids, opts),\n        getBBox: (id, root) => this.getOverlayBBox(id, root),\n        update: (id, data) => this.updateOverlay(id, data)\n      },\n\n      anchors: {\n        list: () => this.listAnchors(),\n        get: (id) => this.getAnchor(id),\n        set: (id, x, y) => this.setAnchor(id, x, y),\n        dump: () => this.dumpAnchors()\n      },\n\n      debug: {\n        enable: (feature) => this.enableDebugFeature(feature),\n        disable: (feature) => this.disableDebugFeature(feature),\n        toggle: (feature) => this.toggleDebugFeature(feature),\n        setScale: (scale) => this.setDebugScale(scale),\n        status: () => this.getDebugStatus(),\n\n        // Legacy methods with deprecation warnings\n        showAnchors: () => {\n          console.warn('[MsdApi] debug.showAnchors deprecated, use debug.enable(\"anchors\")');\n          this.enableDebugFeature('anchors');\n        },\n        showOverlays: () => {\n          console.warn('[MsdApi] debug.showOverlays deprecated, use debug.enable(\"bounding_boxes\")');\n          this.enableDebugFeature('bounding_boxes');\n        },\n        clear: () => {\n          console.warn('[MsdApi] debug.clear deprecated, use debug.disable(\"all\")');\n          this.disableDebugFeature('all');\n        }\n      },\n\n      performance: {\n        dump: () => this.getPerformanceData(),\n        counters: () => this.getPerformanceData().counters || {},\n        timers: () => this.getPerformanceData().timers || {}\n      },\n\n      pipeline: {\n        getResolvedModel: () => this.getResolvedModel(),\n        reRender: () => this.reRender(),\n        validate: () => this.getValidationIssues()\n      }\n    };\n\n    // Backward compatibility aliases (temporary - remove after migration)\n    window.cblcars.msd.listOverlays = (root) => this.listOverlays(root);\n    window.cblcars.msd.listAnchors = () => this.listAnchors();\n    window.cblcars.msd.getOverlayBBox = (id, root) => this.getOverlayBBox(id, root);\n    window.cblcars.msd.highlight = (ids, opts) => this.highlightOverlays(ids, opts);\n  }\n\n  static getWindow() {\n    if (typeof window !== 'undefined') return window;\n    if (typeof global !== 'undefined' && global.window) return global.window;\n    return null;\n  }\n\n  static listOverlays(root) {\n    try {\n      // Try to use MsdIntrospection if available\n      const window = this.getWindow();\n      const MsdIntrospection = window?.MsdIntrospection;\n\n      if (MsdIntrospection && MsdIntrospection.listOverlays) {\n        return MsdIntrospection.listOverlays(root);\n      }\n\n      // Fallback implementation\n      const overlays = [];\n      const resolvedModel = this.getResolvedModel();\n\n      if (resolvedModel && resolvedModel.overlays) {\n        resolvedModel.overlays.forEach(overlay => {\n          overlays.push({\n            id: overlay.id,\n            type: overlay.type,\n            bbox: this.getOverlayBBox(overlay.id, root),\n            hasErrors: false,\n            hasWarnings: false\n          });\n        });\n      }\n\n      return overlays;\n    } catch (_) {\n      return [];\n    }\n  }\n\n  static listAnchors() {\n    try {\n      const resolvedModel = this.getResolvedModel();\n      return Object.keys(resolvedModel?.anchors || {});\n    } catch (_) {\n      return [];\n    }\n  }\n\n  static getAnchor(id) {\n    try {\n      const resolvedModel = this.getResolvedModel();\n      return resolvedModel?.anchors?.[id] || null;\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static dumpAnchors() {\n    try {\n      const resolvedModel = this.getResolvedModel();\n      return { ...resolvedModel?.anchors } || {};\n    } catch (_) {\n      return {};\n    }\n  }\n\n  static getOverlayBBox(id, root) {\n    try {\n      // Try to use MsdIntrospection if available\n      const window = this.getWindow();\n      const MsdIntrospection = window?.MsdIntrospection;\n\n      if (MsdIntrospection && MsdIntrospection.getOverlayBBox) {\n        return MsdIntrospection.getOverlayBBox(id, root);\n      }\n\n      // Fallback: basic bbox from config\n      const resolvedModel = this.getResolvedModel();\n      const overlay = resolvedModel?.overlays?.find(o => o.id === id);\n\n      if (overlay && overlay.position && overlay.size) {\n        const pos = Array.isArray(overlay.position) ? overlay.position : [0, 0];\n        const size = Array.isArray(overlay.size) ? overlay.size : [100, 50];\n\n        return {\n          x: Number(pos[0]) || 0,\n          y: Number(pos[1]) || 0,\n          w: Number(size[0]) || 100,\n          h: Number(size[1]) || 50\n        };\n      }\n\n      return null;\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static highlightOverlays(ids, opts) {\n    try {\n      // Try to use MsdIntrospection if available\n      const window = this.getWindow();\n      const MsdIntrospection = window?.MsdIntrospection;\n\n      if (MsdIntrospection && MsdIntrospection.highlight) {\n        return MsdIntrospection.highlight(ids, opts);\n      }\n\n      // Fallback: log highlight request\n      console.log('[MSD API] Highlight request:', ids, opts);\n    } catch (_) {}\n  }\n\n  static getResolvedModel() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.pipelineInstance?.getResolvedModel?.() || null;\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static getPerformanceData() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.getPerf?.() || { timers: {}, counters: {} };\n    } catch (_) {\n      return { timers: {}, counters: {} };\n    }\n  }\n\n  static getValidationIssues() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.validation?.issues?.() || [];\n    } catch (_) {\n      return [];\n    }\n  }\n\n  static setDebugFlag(flag, value) {\n    try {\n      const window = this.getWindow();\n      window.cblcars = window.cblcars || {};\n      window.cblcars._debugFlags = window.cblcars._debugFlags || {};\n      window.cblcars._debugFlags[flag] = value;\n    } catch (_) {}\n  }\n\n  static clearDebugFlags() {\n    try {\n      const window = this.getWindow();\n      window.cblcars = window.cblcars || {};\n      window.cblcars._debugFlags = {\n        overlay: false,\n        connectors: false,\n        geometry: false\n      };\n    } catch (_) {}\n  }\n\n  static updateOverlay(id, data) {\n    // Future: Dynamic overlay updates\n    console.warn('[MSD API] Dynamic overlay updates not yet implemented');\n    return false;\n  }\n\n  static setAnchor(id, x, y) {\n    try {\n      const window = this.getWindow();\n      const result = window?.__msdDebug?.pipelineInstance?.setAnchor?.(id, [x, y]);\n      return result || { id, position: [x, y] };\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static reRender() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.pipelineInstance?.reRender?.() || { success: false };\n    } catch (_) {\n      return { success: false };\n    }\n  }\n\n  static enableDebugFeature(feature) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      if (feature === 'all') {\n        debugManager.enableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.enable(feature);\n      }\n    }\n  }\n\n  static disableDebugFeature(feature) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      if (feature === 'all') {\n        debugManager.disableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.disable(feature);\n      }\n    }\n  }\n\n  static toggleDebugFeature(feature) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      debugManager.toggle(feature);\n    }\n  }\n\n  static setDebugScale(scale) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      debugManager.setScale(scale);\n    }\n  }\n\n  static getDebugStatus() {\n    const debugManager = this.getDebugManager();\n    return debugManager ? debugManager.getSnapshot() : { error: 'DebugManager not available' };\n  }\n\n  static getDebugManager() {\n    const window = this.getWindow();\n    return window?.__msdDebug?.debugManager ||\n           window?.__msdDebug?.pipelineInstance?.systemsManager?.debugManager;\n  }\n}\n\n","import { stableStringify } from '../util/stableStringify.js';\n\nfunction stripMeta(item) {\n  if (!item || typeof item !== 'object') return item;\n  const { __meta, ...rest } = item;\n  return rest;\n}\n\nexport function exportCollapsed(merged) {\n  const raw = merged.__raw_msd || {};\n  // User-origin items only (origin_pack === 'user')\n  function userItems(col) {\n    return (merged[col] || [])\n      .filter(i => i.__meta?.origin_pack === 'user' && !i.__meta.removed)\n      .map(stripMeta);\n  }\n  const out = {\n    msd: {\n      version: raw.version || 1,\n      base_svg: raw.base_svg,\n      view_box: raw.view_box,\n      use_packs: raw.use_packs,\n      anchors: raw.anchors,\n      palettes: raw.palettes,\n      remove: raw.remove,\n      profiles: userItems('profiles'),\n      animations: userItems('animations'),\n      timelines: userItems('timelines'),\n      overlays: userItems('overlays'),\n      rules: userItems('rules'),\n      routing: raw.routing,\n      active_profiles: raw.active_profiles,\n      hud: raw.hud\n    }\n  };\n  // Prune empty/null keys\n  Object.keys(out.msd).forEach(k => {\n    if (out.msd[k] == null) delete out.msd[k];\n    else if (Array.isArray(out.msd[k]) && !out.msd[k].length) delete out.msd[k];\n    else if (typeof out.msd[k] === 'object' && !Array.isArray(out.msd[k]) && !Object.keys(out.msd[k]).length) delete out.msd[k];\n  });\n  return out;\n}\n\nexport function exportCollapsedJson(merged, pretty = true) {\n  return pretty ? JSON.stringify(exportCollapsed(merged), null, 2) : stableStringify(exportCollapsed(merged));\n}\n","import { stableStringify } from '../util/stableStringify.js';\n\nfunction stripMeta(item, includeMeta) {\n  if (includeMeta) return item;\n  if (!item || typeof item !== 'object') return item;\n  const { __meta, ...rest } = item;\n  return rest;\n}\n\nexport function exportFullSnapshot(merged, opts = {}) {\n  const include_meta = !!opts.include_meta;\n  function all(col) {\n    return (merged[col] || [])\n      .filter(i => !i.__meta?.removed)\n      .map(i => stripMeta(i, include_meta));\n  }\n  return {\n    msd: {\n      version: (merged.__raw_msd && merged.__raw_msd.version) || 1,\n      base_svg: merged.__raw_msd?.base_svg,\n      view_box: merged.__raw_msd?.view_box,\n      use_packs: merged.__raw_msd?.use_packs,\n      anchors: merged.__raw_msd?.anchors,\n      palettes: merged.palettes,\n      remove: merged.__raw_msd?.remove,\n      profiles: all('profiles'),\n      animations: all('animations'),\n      timelines: all('timelines'),\n      overlays: all('overlays'),\n      rules: all('rules'),\n      routing: merged.routing,\n      active_profiles: merged.active_profiles,\n      hud: merged.hud,\n      __provenance: include_meta ? merged.__provenance : undefined,\n      __issues: include_meta ? merged.__issues : undefined\n    }\n  };\n}\n\nexport function exportFullSnapshotJson(merged, opts = {}, pretty = true) {\n  return pretty ? JSON.stringify(exportFullSnapshot(merged, opts), null, 2) : stableStringify(exportFullSnapshot(merged, opts));\n}\n","import { stableStringify } from '../util/stableStringify.js';\n\nexport function diffItem(merged, collection, id) {\n  const chain = merged.__provenance?.[collection]?.[id];\n  if (!chain) return { id, collection, chain: [], final: null, removed: false };\n  const items = (merged[collection] || []).filter(i => i.id === id);\n  const final = items.length ? items[items.length - 1] : null;\n  return {\n    id,\n    collection,\n    chain,\n    removed: chain.some(c => c.removed),\n    final_summary: final ? summarize(final) : null,\n    chain_summaries: chain.map(s => ({\n      layer: s.layer_id,\n      overridden: s.overridden,\n      removed: s.removed,\n      checksum: s.checksum,\n      diff: s.diff\n    }))\n  };\n}\n\nfunction summarize(item) {\n  if (!item) return null;\n  const copy = { ...item };\n  delete copy.__meta;\n  return JSON.parse(stableStringify(copy));\n}\n","export function stableStringify(value) {\n  const seen = new WeakSet();\n  function walk(v) {\n    if (v === null || typeof v !== 'object') return JSON.stringify(v);\n    if (seen.has(v)) return '\"[Circular]\"';\n    seen.add(v);\n    if (Array.isArray(v)) return '[' + v.map(walk).join(',') + ']';\n    const keys = Object.keys(v).sort();\n    return '{' + keys.map(k => JSON.stringify(k) + ':' + walk(v[k])).join(',') + '}';\n  }\n  return walk(value);\n}\n","import { processAndValidateConfig } from './ConfigProcessor.js';\nimport { SystemsManager } from './SystemsManager.js';\nimport { ModelBuilder } from './ModelBuilder.js';\nimport { setupDebugInterface } from '../debug/DebugInterface.js';\nimport { buildCardModel } from '../model/CardModel.js';\nimport { MsdApi } from '../api/MsdApi.js';\nimport { exportCollapsed, exportCollapsedJson } from '../export/exportCollapsed.js';\nimport { exportFullSnapshot, exportFullSnapshotJson } from '../export/exportFullSnapshot.js';\nimport { diffItem } from '../export/diffItem.js';\nimport { perfGetAll } from '../perf/PerfCounters.js';\n\n/**\n * Initialize the MSD processing/rendering pipeline.\n * Handles config merge/validation, system initialization, initial render,\n * debug interface binding, and exposes a unified pipeline API.\n *\n * @param {Object} userMsdConfig - User supplied MSD config.\n * @param {HTMLElement|ShadowRoot} mountEl - Mount/root element (may be a shadowRoot).\n * @param {Object|null} hass - Home Assistant instance (if available).\n * @returns {Promise<Object>} Pipeline API\n */\nexport async function initMsdPipeline(userMsdConfig, mountEl, hass = null) {\n  // Process and validate configuration\n  const { mergedConfig, issues, provenance } = await processAndValidateConfig(userMsdConfig);\n\n  // Handle validation errors\n  if (issues.errors.length) {\n    console.error('[MSD v1] Validation errors – pipeline disabled', issues.errors);\n    return createDisabledPipeline(mergedConfig, issues, provenance);\n  }\n\n  // Build card model\n  const cardModel = await buildCardModel(mergedConfig);\n\n  // Ensure anchors are available\n  if (!cardModel.anchors) cardModel.anchors = {};\n  if (!Object.keys(cardModel.anchors).length) {\n    if (mergedConfig.anchors && Object.keys(mergedConfig.anchors).length) {\n      cardModel.anchors = { ...mergedConfig.anchors };\n      console.info('[MSD v1] Adopted user anchors');\n    }\n  }\n\n  // Initialize all systems\n  const systemsManager = new SystemsManager();\n  await systemsManager.initializeSystems(mergedConfig, cardModel, mountEl, hass);\n\n  // ADDED: Set original HASS for clean controls separation\n  if (hass) {\n      systemsManager.setOriginalHass(hass);\n  }\n\n  // CRITICAL FIX: Ensure essential subsystems are available for overlay rendering\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.debugManager = systemsManager.debugManager;\n    window.__msdDebug.routing = systemsManager.router;\n\n    // Make core systems available BEFORE any overlay rendering\n    window.__msdDebug.pipelineInstance = {\n      systemsManager: systemsManager,\n      dataSourceManager: systemsManager.dataSourceManager\n    };\n\n    console.log('[MSD v1] Essential subsystems ready for overlay rendering:', {\n      hasSystemsManager: !!systemsManager,\n      hasDataSourceManager: !!systemsManager.dataSourceManager,\n      dataSourceCount: systemsManager.dataSourceManager?.listIds?.()?.length || 0\n    });\n  }\n\n  // VALIDATION: Don't proceed with overlay rendering if essential systems aren't ready\n  if (!systemsManager.dataSourceManager) {\n    console.warn('[MSD v1] DataSourceManager not available - overlay template processing will be limited');\n  }\n\n  // EARLY DEBUG BOOTSTRAP (Before first render):\n  // Provide a minimal __msdDebug object so debug renderers that run during the first render\n  // can access routing / perf safely. This prevents timing race warnings for routing guides.\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    // Only set if not already present to avoid clobbering previous instrumentation\n    if (!window.__msdDebug.routing) {\n      window.__msdDebug.routing = systemsManager.router;\n    }\n    if (!window.__msdDebug.getPerf) {\n      window.__msdDebug.getPerf = () => perfGetAll();\n    }\n    if (!window.__msdDebug.systemsManager) {\n      window.__msdDebug.systemsManager = systemsManager;\n    }\n    // Dispatch an event so listeners (e.g., MsdDebugRenderer) can react when routing is ready.\n    try {\n      window.dispatchEvent(new CustomEvent('msd-routing-ready'));\n    } catch (e) {\n      // Non-fatal; older browsers or sandbox contexts might block custom events.\n    }\n  }\n\n  // Initialize model builder\n  const modelBuilder = new ModelBuilder(mergedConfig, cardModel, systemsManager);\n\n  // ADDED: Store ModelBuilder reference in SystemsManager for accessibility\n  systemsManager.modelBuilder = modelBuilder;\n\n  /**\n   * Internal re-render function that recomputes the model\n   * and triggers the AdvancedRenderer + debug visualization pipeline.\n   * @returns {Object|undefined} Renderer result object\n   */\n  async function reRender() {\n    console.log('[MSD DEBUG] 🔄 reRender() ENTRY', {\n      timestamp: new Date().toISOString(),\n      renderInProgress: systemsManager._renderInProgress,\n      stackTrace: new Error().stack.split('\\n').slice(1, 4).join('\\n')\n    });\n\n    // IMPROVED: Queue renders instead of blocking them\n    if (systemsManager._renderInProgress) {\n      console.log('[MSD DEBUG] 🕐 Render in progress, queueing re-render');\n      systemsManager._queuedReRender = true;\n      return { success: false, reason: 'render_in_progress', queued: true };\n    }\n\n    systemsManager._renderInProgress = true;\n    systemsManager._queuedReRender = false;\n\n    try {\n      console.log('[MSD DEBUG] 📊 Computing resolved model...');\n      const startTime = performance.now();\n      const resolvedModel = modelBuilder.computeResolvedModel();\n\n      console.log('[MSD DEBUG] ✅ Resolved model computed:', {\n        overlayCount: resolvedModel.overlays.length,\n        controlOverlays: resolvedModel.overlays.filter(o => o.type === 'control').length,\n        hasAnchors: !!resolvedModel.anchors,\n        hasViewBox: !!resolvedModel.viewBox\n      });\n\n      console.log(`[MSD DEBUG] 🎨 Starting AdvancedRenderer.render() - overlays: ${resolvedModel.overlays.length}`);\n\n      // ADDED: Defensive rendering with error boundary\n      let renderResult;\n      try {\n        renderResult = systemsManager.renderer.render(resolvedModel);\n        console.log('[MSD DEBUG] ✅ AdvancedRenderer.render() completed successfully:', renderResult);\n      } catch (renderError) {\n        console.error('[MSD DEBUG] ❌ AdvancedRenderer.render() FAILED:', renderError);\n        console.error('[MSD DEBUG] ❌ Render error stack:', renderError.stack);\n        return { success: false, error: renderError.message, phase: 'advanced_renderer' };\n      }\n\n      console.log('[MSD DEBUG] 🎮 Starting renderDebugAndControls()...');\n      // CHANGED: Make debug and controls rendering more defensive\n      try {\n        await systemsManager.renderDebugAndControls(resolvedModel, mountEl);\n        console.log('[MSD DEBUG] ✅ renderDebugAndControls() completed successfully');\n      } catch (debugControlsError) {\n        console.error('[MSD DEBUG] ❌ renderDebugAndControls() FAILED:', debugControlsError);\n        console.error('[MSD DEBUG] ❌ Debug/Controls error stack:', debugControlsError.stack);\n        // Don't fail the entire render - just log the error\n        console.warn('[MSD DEBUG] ⚠️ Continuing without debug/controls rendering due to error');\n      }\n\n      const renderTime = performance.now() - startTime;\n      console.log(`[MSD DEBUG] ✅ reRender() COMPLETED in ${renderTime.toFixed(2)}ms`);\n\n      return renderResult || { success: true };\n\n    } catch (error) {\n      console.error('[MSD DEBUG] ❌ reRender() COMPLETELY FAILED:', error);\n      console.error('[MSD DEBUG] ❌ Complete failure stack:', error.stack);\n      return { success: false, error: error.message };\n    } finally {\n      systemsManager._renderInProgress = false;\n      console.log('[MSD DEBUG] 🏁 reRender() FINALLY block - _renderInProgress reset to false');\n\n      // IMPROVED: Execute queued re-render if one was requested\n      if (systemsManager._queuedReRender) {\n        console.log('[MSD DEBUG] 🔄 Executing queued re-render');\n        systemsManager._queuedReRender = false;\n        // Use setTimeout to avoid immediate recursion and allow stack to clear\n        setTimeout(() => reRender(), 50);\n      }\n    }\n  }\n\n  // Connect reRender callback to systems\n  systemsManager.setReRenderCallback(reRender);\n\n  // Initial render - CHANGED: Make async\n  console.log('[MSD v1] Computing initial resolved model');\n  console.log('[MSD v1] DataSourceManager status:', {\n    sourcesCount: systemsManager.dataSourceManager?.getAllSources?.()?.length || 0,\n    entityCount: systemsManager.dataSourceManager?.listIds?.()?.length || 0\n  });\n\n  const initialRenderResult = await reRender();\n\n  console.log('[MSD v1] Initial render completed:', {\n    overlayCount: initialRenderResult?.overlayCount || 0,\n    errors: initialRenderResult?.errors || 0\n  });\n\n  // Create pipeline API\n  const pipelineApi = createPipelineApi(\n    mergedConfig, cardModel, systemsManager, modelBuilder, reRender\n  );\n\n  // Setup debug interface with DebugManager integration\n  setupDebugInterface(pipelineApi, mergedConfig, provenance, systemsManager, modelBuilder);\n\n  // Initialize HUD service with mount element\n  if (typeof window !== 'undefined' && window.__msdDebug?.hud?.setMountElement) {\n    window.__msdDebug.hud.setMountElement(mountEl);\n  }\n\n  // Attach unified API\n  console.log('[MSD v1] Attaching unified API');\n  MsdApi.attach();\n\n  // Augment debug tracking (now that pipelineApi exists)\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.validation = { issues: () => mergedConfig.__issues };\n    window.__msdDebug.pipelineInstance = pipelineApi;\n    window.__msdDebug._provenance = provenance;\n\n    // Ensure routing reference is consistent (in case late changes happened)\n    if (!window.__msdDebug.routing) {\n      window.__msdDebug.routing = systemsManager.router;\n      try {\n        window.dispatchEvent(new CustomEvent('msd-routing-ready'));\n      } catch(_) {}\n    }\n  }\n\n  console.log('[MSD v1] Pipeline initialization complete');\n  return pipelineApi;\n}\n\nfunction createDisabledPipeline(mergedConfig, issues, provenance) {\n  const disabledPipeline = {\n    enabled: false,\n    errors: issues.errors,\n    warnings: issues.warnings,\n    getResolvedModel: () => null,\n    ingestHass: () => {},\n    updateEntities: () => {},\n    listEntities: () => [],\n    getEntity: () => null,\n    getActiveProfiles: () => [],\n    getAnchors: () => (mergedConfig.anchors || {}),\n    repairAnchorsFromMerged: () => false,\n    exportCollapsed: () => null,\n    exportCollapsedJson: () => 'null',\n    exportFullSnapshot: () => null,\n    exportFullSnapshotJson: () => 'null',\n    diffItem: () => null,\n    getPerf: () => ({})\n  };\n\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.validation = { issues: () => mergedConfig.__issues };\n    window.__msdDebug.pipelineInstance = disabledPipeline;\n    window.__msdDebug._provenance = provenance;\n  }\n  return disabledPipeline;\n}\n\n/**\n * Creates and returns the MSD pipeline external API.\n * @param {Object} mergedConfig\n * @param {Object} cardModel\n * @param {SystemsManager} systemsManager\n * @param {ModelBuilder} modelBuilder\n * @param {Function} reRender\n * @returns {Object} API\n */\nfunction createPipelineApi(mergedConfig, cardModel, systemsManager, modelBuilder, reRender) {\n  const api = {\n    enabled: true,\n    version: mergedConfig.version || 1,\n    config: mergedConfig,\n\n    // Core systems\n    systemsManager,\n    dataSourceManager: systemsManager.dataSourceManager,\n    rulesEngine: systemsManager.rulesEngine,\n    renderer: systemsManager.renderer,\n    router: systemsManager.router,\n\n    /**\n     * Inspect routing for a given overlay id and compute path data.\n     * @param {string} id\n     * @returns {Object|null}\n     */\n    routingInspect: (id) => {\n      const resolvedModel = modelBuilder.getResolvedModel();\n      const ov = (resolvedModel?.overlays || []).find(o => o.id === id);\n      if (!ov) return null;\n      const raw = ov._raw || ov.raw || {};\n      const a1 = cardModel.anchors[raw.anchor];\n      const a2 = cardModel.anchors[raw.attach_to] || cardModel.anchors[raw.attachTo];\n      if (!a1 || !a2) return null;\n      const req = systemsManager.router.buildRouteRequest(ov, a1, a2);\n      return systemsManager.router.computePath(req);\n    },\n\n    getResolvedModel: () => modelBuilder.getResolvedModel(),\n\n    /**\n     * Force a manual re-render.\n     */\n    reRender: () => {\n      try {\n        console.log('[MSD v1] Manual re-render triggered');\n        return reRender();\n      } catch (error) {\n        console.error('[MSD v1] Manual re-render failed:', error);\n        return { success: false, error: error.message };\n      }\n    },\n\n    /**\n     * Set or update an anchor point.\n     * @param {string} id\n     * @param {Array<number>} pt\n     * @returns {boolean}\n     */\n    setAnchor(id, pt) {\n      if (!id || !Array.isArray(pt) || pt.length !== 2) return false;\n      if (!cardModel.anchors) cardModel.anchors = {};\n      cardModel.anchors[id] = [Number(pt[0]), Number(pt[1])];\n      const resolvedModel = modelBuilder.getResolvedModel();\n      if (resolvedModel?.anchors) resolvedModel.anchors[id] = cardModel.anchors[id];\n      systemsManager.router.invalidate && systemsManager.router.invalidate('*');\n      try {\n        if (systemsManager.renderer && resolvedModel) {\n          systemsManager.renderer._routerOverlaySync = false;\n          systemsManager.renderer.render(resolvedModel);\n        }\n      } catch(_) {}\n      return true;\n    },\n\n    ingestHass: (hass) => systemsManager.ingestHass(hass),\n    updateEntities: (map) => systemsManager.updateEntities(map),\n    listEntities: () => systemsManager.entityRuntime.listIds(),\n    getEntity: (id) => systemsManager.entityRuntime.getEntity(id),\n    getActiveProfiles: () => modelBuilder.runtimeActiveProfiles.slice(),\n    getAnchors: () => ({ ...cardModel.anchors }),\n    exportCollapsed: () => exportCollapsed(userMsdConfig),\n    exportCollapsedJson: () => JSON.stringify(exportCollapsed(userMsdConfig)),\n    exportFullSnapshot: () => exportFullSnapshot(mergedConfig),\n    exportFullSnapshotJson: () => JSON.stringify(exportFullSnapshot(mergedConfig)),\n    diffItem: (item) => diffItem(item),\n    getPerf: () => perfGetAll(),\n\n    // Add debug API powered by DebugManager\n    debug: {\n      enable: (feature) => systemsManager.debugManager.enable(feature),\n      disable: (feature) => systemsManager.debugManager.disable(feature),\n      toggle: (feature) => systemsManager.debugManager.toggle(feature),\n      setScale: (scale) => systemsManager.debugManager.setScale(scale),\n      status: () => systemsManager.debugManager.getSnapshot(),\n      onChange: (callback) => systemsManager.debugManager.onChange(callback)\n    },\n\n    getDataSourceManager: () => systemsManager.dataSourceManager,\n    _reRenderCallback: reRender\n  };\n\n  return api;\n}\n\n","import { mergePacks } from '../packs/mergePacks.js';\nimport { validateMerged } from '../validation/validateMerged.js';\n\nexport { mergePacks, validateMerged };\n\nexport async function processAndValidateConfig(userMsdConfig) {\n  const mergedConfig = await mergePacks(userMsdConfig);\n  const provenance = mergedConfig.__provenance;\n\n  // Store original user config in debug namespace\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug._originalUserConfig = userMsdConfig;\n  }\n\n  // Validation pass\n  const t0 = performance.now();\n  const issues = validateMerged(mergedConfig);\n  mergedConfig.__issues = issues;\n  const t1 = performance.now();\n  try { window.__msdDebug && (window.__msdDebug._validationMs = (t1 - t0)); } catch {}\n\n  // Anchor validation - UPDATED to accept overlay IDs as virtual anchors\n  try {\n    const existingCodes = new Set(issues.errors.map(e=>e.code));\n    const anchorSet = new Set(Object.keys(mergedConfig.anchors || {}));\n\n    // Add overlay IDs as valid anchor targets (same as in validateMerged)\n    const overlayIds = new Set();\n    (mergedConfig.overlays || []).forEach(overlay => {\n      if (overlay && overlay.id) {\n        overlayIds.add(overlay.id);\n        anchorSet.add(overlay.id); // Make overlay IDs valid anchor targets\n      }\n    });\n\n    (mergedConfig.overlays || []).forEach(o=>{\n      if (!o || !o.id) return;\n      const aRefs = [];\n      if (typeof o.anchor === 'string') aRefs.push(o.anchor);\n      if (typeof o.attach_to === 'string') aRefs.push(o.attach_to);\n      if (typeof o.attachTo === 'string') aRefs.push(o.attachTo);\n      aRefs.forEach(ref=>{\n        if (ref && !anchorSet.has(ref)) {\n          const code = 'anchor.missing';\n          if (!existingCodes.has(`${code}:${ref}:${o.id}`)) {\n            issues.errors.push({ code, severity:'error', overlay:o.id, anchor:ref, msg:`Overlay ${o.id} references missing anchor '${ref}'` });\n            existingCodes.add(`${code}:${ref}:${o.id}`);\n          }\n        }\n      });\n    });\n  } catch(_) {}\n\n  return { mergedConfig, issues, provenance };\n}\n\nexport async function processMsdConfig(userMsdConfig) {\n  try {\n    const preValidation = validateMerged(userMsdConfig);\n    const mergedConfig = await mergePacks(userMsdConfig);\n    const postValidation = validateMerged(mergedConfig);\n\n    const issues = {\n      errors: [...preValidation.errors, ...postValidation.errors],\n      warnings: [...preValidation.warnings, ...postValidation.warnings]\n    };\n\n    if (issues.errors.length > 0) {\n      console.error('MSD validation errors:', issues.errors);\n    }\n\n    if (issues.warnings.length > 0) {\n      console.warn('MSD validation warnings:', issues.warnings);\n    }\n\n    return {\n      config: mergedConfig,\n      validation: issues\n    };\n\n  } catch (error) {\n    console.error('MSD processing failed:', error);\n    throw error;\n  }\n}\n","import { perfGetAll } from '../perf/PerfCounters.js';\nimport { MsdIntrospection } from '../introspection/MsdIntrospection.js';\n\nexport function setupDebugInterface(pipelineApi, mergedConfig, provenance, systemsManager, modelBuilder) {\n  if (typeof window === 'undefined') return;\n\n  const dbg = window.__msdDebug = window.__msdDebug || {};\n\n  // Extract debug config from mergedConfig\n  const debugConfig = mergedConfig?.debug || {};\n\n  // REDUCED: Minimal startup logging\n  console.log('[MSD v1] Debug interface ready - type window.__msdDebug.help() for usage');\n\n  // Core pipeline access - UNIFIED: Only set pipelineInstance\n  dbg.pipelineInstance = pipelineApi;\n\n  // Add backward compatibility getter with deprecation warning\n  if (!dbg.hasOwnProperty('pipeline')) {\n    Object.defineProperty(dbg, 'pipeline', {\n      get() {\n        console.warn('[MSD Debug] window.__msdDebug.pipeline is deprecated. Use window.__msdDebug.pipelineInstance instead.');\n        return this.pipelineInstance;\n      },\n      configurable: true\n    });\n  }\n\n  dbg._provenance = provenance;\n\n  // Routing system\n  setupRoutingDebugInterface(dbg, pipelineApi, systemsManager);\n\n  // Data sources - our current entity management system\n  setupDataSourceDebugInterface(dbg, systemsManager);\n\n  // Rendering and debug visualization - now with config control\n  setupRenderingDebugInterface(dbg, systemsManager, modelBuilder, pipelineApi, debugConfig);\n\n  // Performance and validation\n  setupUtilityDebugInterface(dbg, mergedConfig, systemsManager);\n\n  console.log('[MSD v1] Debug interface setup complete');\n  console.log('[MSD v1] Available methods:', Object.keys(dbg));\n\n  // Log debug config state (REDUCED)\n  if (debugConfig.enabled) {\n    console.log('[MSD v1] Debug mode enabled');\n  }\n}\n\n// ...existing code...\n\nfunction setupRoutingDebugInterface(dbg, pipelineApi, systemsManager) {\n  dbg.routing = {\n    inspect: (id) => pipelineApi.routingInspect(id),\n    invalidate: (id='*') => systemsManager.router.invalidate(id),\n    stats: () => {\n      try {\n        return systemsManager.router.stats?.() || { cacheHits: 0, pathsComputed: 0, invalidations: 0 };\n      } catch (e) {\n        console.warn('[MSD v1] routing.stats failed:', e);\n        return { cacheHits: 0, pathsComputed: 0, invalidations: 0, error: e.message };\n      }\n    },\n    inspectAs: (id, modeFull='smart') => {\n      try {\n        const model = pipelineApi.getResolvedModel?.();\n        if (!model) return null;\n        const ov = model.overlays.find(o => o.id === id);\n        if (!ov) return null;\n        ov._raw = ov._raw || {};\n        const original = ov._raw.route_mode_full;\n        ov._raw.route_mode_full = modeFull;\n        systemsManager.router.invalidate && systemsManager.router.invalidate('*');\n        const res = dbg.routing.inspect(id);\n        ov._raw.route_mode_full = original;\n        systemsManager.router.invalidate && systemsManager.router.invalidate('*');\n        return res;\n      } catch (e) {\n        console.warn('[MSD v1] inspectAs failed', e);\n        return null;\n      }\n    }\n  };\n}\n\nfunction setupDataSourceDebugInterface(dbg, systemsManager) {\n  // ENHANCED: Make this the primary entity access system\n  if (!dbg.hasOwnProperty('dataSources')) {\n    dbg.dataSources = {\n      stats: () => systemsManager.dataSourceManager?.getStats() || { error: 'DataSourceManager not initialized' },\n      list: () => systemsManager.dataSourceManager ? Array.from(systemsManager.dataSourceManager.sources.keys()) : [],\n      get: (name) => systemsManager.dataSourceManager?.getSource(name)?.getStats() || null,\n      dump: () => systemsManager.dataSourceManager?.debugDump() || { error: 'DataSourceManager not initialized' },\n      manager: () => systemsManager.dataSourceManager\n    };\n  } else {\n    // If dataSources already exists (from index.js getter), enhance it with additional methods\n    try {\n      Object.assign(dbg.dataSources, {\n        list: () => systemsManager.dataSourceManager ? Array.from(systemsManager.dataSourceManager.sources.keys()) : [],\n        get: (name) => systemsManager.dataSourceManager?.getSource(name)?.getStats() || null,\n        dump: () => systemsManager.dataSourceManager?.debugDump() || { error: 'DataSourceManager not initialized' }\n      });\n    } catch (error) {\n      // If we can't enhance it (getter-only), create alternative access\n      dbg.dataSourcesDebug = {\n        stats: () => systemsManager.dataSourceManager?.getStats() || { error: 'DataSourceManager not initialized' },\n        list: () => systemsManager.dataSourceManager ? Array.from(systemsManager.dataSourceManager.sources.keys()) : [],\n        get: (name) => systemsManager.dataSourceManager?.getSource(name)?.getStats() || null,\n        dump: () => systemsManager.dataSourceManager?.debugDump() || { error: 'DataSourceManager not initialized' },\n        manager: () => systemsManager.dataSourceManager\n      };\n      console.log('[DebugInterface] Created dataSourcesDebug as alternative access due to getter conflict');\n    }\n  }\n\n  // ADDED: Legacy compatibility layer for any remaining entity access patterns\n  // This provides entity-like access through DataSourceManager\n  dbg.entities = {\n    list: () => {\n      console.warn('[MSD Debug] entities.list() is deprecated. Use window.__msdDebug.dataSourceManager.listIds() instead.');\n      return systemsManager.dataSourceManager?.listIds() || [];\n    },\n    get: (id) => {\n      console.warn('[MSD Debug] entities.get() is deprecated. Use window.__msdDebug.dataSourceManager.getEntity() instead.');\n      return systemsManager.dataSourceManager?.getEntity(id) || null;\n    },\n    stats: () => {\n      console.warn('[MSD Debug] entities.stats() is deprecated. Use window.__msdDebug.dataSources.stats() instead.');\n      const dsStats = systemsManager.dataSourceManager?.getStats() || {};\n      const entityCount = systemsManager.dataSourceManager?.listIds()?.length || 0;\n\n      // Transform DataSourceManager stats to legacy format for compatibility\n      return {\n        count: entityCount,\n        subscribed: Object.keys(dsStats.sources || {}).length,\n        updated: Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.received || 0), 0),\n        cacheHits: Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.cacheHits || 0), 0)\n      };\n    }\n  };\n}\n\nfunction setupRenderingDebugInterface(dbg, systemsManager, modelBuilder, pipelineApi, debugConfig) {\n  // REDUCED: Minimal setup logging\n  const debugManager = systemsManager.debugManager;\n\n  // Enhanced debug object powered by DebugManager\n  dbg.debug = {\n    // Core feature control methods using DebugManager\n    enable: (feature) => {\n      if (feature === 'all') {\n        debugManager.enableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.enable(feature);\n      }\n\n      // FIXED: More aggressive re-render after enabling with proper timing\n      setTimeout(() => {\n        try {\n          const pipelineInstance = window.__msdDebug?.pipelineInstance;\n          if (pipelineInstance?.reRender) {\n            console.log('[MSD Debug] Force re-render after enable:', feature);\n            pipelineInstance.reRender();\n          }\n        } catch (error) {\n          console.warn('[MSD Debug] Failed to trigger re-render:', error);\n        }\n      }, 10);\n    },\n\n    disable: (feature) => {\n      if (feature === 'all') {\n        debugManager.disableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.disable(feature);\n      }\n\n      // FIXED: More aggressive re-render after disabling with proper timing\n      setTimeout(() => {\n        try {\n          const pipelineInstance = window.__msdDebug?.pipelineInstance;\n          if (pipelineInstance?.reRender) {\n            console.log('[MSD Debug] Force re-render after disable:', feature);\n            pipelineInstance.reRender();\n          }\n        } catch (error) {\n          console.warn('[MSD Debug] Failed to trigger re-render:', error);\n        }\n      }, 10);\n    },\n\n    // Manual debug render test\n    testRender: () => {\n      console.log('[MSD Debug] Testing debug render directly...');\n      try {\n        const debugState = debugManager.getSnapshot();\n        console.log('[MSD Debug] Current state:', debugState);\n\n        // Get pipeline instance to access the shadowRoot context\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (!pipelineInstance) {\n          console.warn('[MSD Debug] No pipeline instance available');\n          return;\n        }\n\n        // Try to get the shadowRoot from the systems manager\n        const systemsManager = pipelineInstance.systemsManager;\n        if (!systemsManager) {\n          console.warn('[MSD Debug] No systems manager available');\n          return;\n        }\n\n        // Use the renderer's mount element (shadowRoot)\n        const mountEl = systemsManager.renderer?.mountEl;\n        if (!mountEl) {\n          console.warn('[MSD Debug] No mount element found in renderer');\n          return;\n        }\n\n        console.log('[MSD Debug] Found mount element:', mountEl.constructor.name);\n\n        // Get resolved model for proper context\n        const resolvedModel = pipelineInstance.getResolvedModel();\n        if (!resolvedModel) {\n          console.warn('[MSD Debug] No resolved model available');\n          return;\n        }\n\n        console.log('[MSD Debug] Calling renderDebugAndControls with shadowRoot context');\n        systemsManager.renderDebugAndControls(resolvedModel, mountEl);\n\n      } catch (error) {\n        console.error('[MSD Debug] testRender failed:', error);\n      }\n    },\n\n    // Scale control via DebugManager\n    setScale: (scale) => debugManager.setScale(scale),\n\n    // Status from DebugManager - FIXED: Use silent method by default\n    status: () => {\n      const state = debugManager.getSnapshot();\n      console.table(state);\n      return state;\n    },\n\n    // ADDED: Silent status access for programmatic use\n    getStatus: () => debugManager.getSnapshot(),\n\n    // Subscribe to DebugManager changes\n    onChange: (callback) => debugManager.onChange(callback),\n\n    // Manual refresh triggers re-render\n    refresh: () => {\n      try {\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (pipelineInstance?.reRender) {\n          pipelineInstance.reRender();\n          console.log('[MSD Debug] Debug overlays refreshed');\n        }\n      } catch (error) {\n        console.warn('[MSD Debug] Failed to trigger pipeline re-render:', error);\n      }\n    },\n\n    // Convenient nested methods using DebugManager\n    anchors: {\n      show: () => debugManager.enable('anchors'),\n      hide: () => debugManager.disable('anchors'),\n      toggle: () => debugManager.toggle('anchors')\n    },\n\n    bounding: {\n      show: () => debugManager.enable('bounding_boxes'),\n      hide: () => debugManager.disable('bounding_boxes'),\n      toggle: () => debugManager.toggle('bounding_boxes'),\n      // ADDED: Test bounding box accuracy for specific overlay\n      test: (overlayId) => {\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (!pipelineInstance) {\n          console.warn('[MSD Debug] No pipeline instance available');\n          return null;\n        }\n\n        const model = pipelineInstance.getResolvedModel?.();\n        if (!model) {\n          console.warn('[MSD Debug] No resolved model available');\n          return null;\n        }\n\n        const overlay = model.overlays.find(o => o.id === overlayId);\n        if (!overlay) {\n          console.warn(`[MSD Debug] Overlay \"${overlayId}\" not found`);\n          return null;\n        }\n\n        // Get the debug renderer from systems manager\n        const debugRenderer = systemsManager.debugRenderer;\n        if (!debugRenderer) {\n          console.warn('[MSD Debug] Debug renderer not available');\n          return null;\n        }\n\n        const position = overlay.position;\n        if (!position || !Array.isArray(position)) {\n          console.warn(`[MSD Debug] Invalid position for overlay \"${overlayId}\"`);\n          return null;\n        }\n\n        const [x, y] = position;\n        const dimensions = debugRenderer._getOverlayDimensions(overlay, x, y);\n\n        console.log(`[MSD Debug] Bounding box test for \"${overlayId}\":`, {\n          overlay: {\n            id: overlay.id,\n            type: overlay.type,\n            position: [x, y]\n          },\n          calculatedDimensions: dimensions,\n          overlayConfig: {\n            text: overlay.text || overlay.content || overlay._raw?.content,\n            style: overlay.finalStyle || overlay.style\n          }\n        });\n\n        return dimensions;\n      },\n      // ADDED: Compare bounding box calculation methods\n      compare: (overlayId) => {\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (!pipelineInstance) {\n          console.warn('[MSD Debug] No pipeline instance available');\n          return null;\n        }\n\n        const model = pipelineInstance.getResolvedModel?.();\n        if (!model) {\n          console.warn('[MSD Debug] No resolved model available');\n          return null;\n        }\n\n        const overlay = model.overlays.find(o => o.id === overlayId);\n        if (!overlay || overlay.type !== 'text') {\n          console.warn(`[MSD Debug] Text overlay \"${overlayId}\" not found`);\n          return null;\n        }\n\n        const [x, y] = overlay.position || [0, 0];\n        const debugRenderer = systemsManager.debugRenderer;\n\n        const results = {\n          overlayId,\n          position: [x, y],\n          methods: {}\n        };\n\n        // Method 1: Debug renderer calculation\n        if (debugRenderer) {\n          try {\n            const debugDims = debugRenderer._getOverlayDimensions(overlay, x, y);\n            results.methods.debugRenderer = debugDims;\n          } catch (error) {\n            results.methods.debugRenderer = { error: error.message };\n          }\n        }\n\n        // Method 2: TextOverlayRenderer computation\n        try {\n          const container = systemsManager.renderer?.mountEl;\n          const attachmentData = window.cblcars?.TextOverlayRenderer?.computeAttachmentPoints?.(\n            overlay,\n            model.anchors || {},\n            container\n          );\n          if (attachmentData?.bbox) {\n            results.methods.textOverlayRenderer = {\n              x: attachmentData.bbox.left,\n              y: attachmentData.bbox.top,\n              width: attachmentData.bbox.width,\n              height: attachmentData.bbox.height\n            };\n          }\n        } catch (error) {\n          results.methods.textOverlayRenderer = { error: error.message };\n        }\n\n        // Method 3: DOM getBBox (if rendered)\n        try {\n          const container = systemsManager.renderer?.mountEl;\n          const svgElement = container?.querySelector('svg');\n          const renderedElement = svgElement?.querySelector(`[data-overlay-id=\"${overlayId}\"]`);\n          if (renderedElement) {\n            const bbox = renderedElement.getBBox();\n            results.methods.domGetBBox = {\n              x: bbox.x,\n              y: bbox.y,\n              width: bbox.width,\n              height: bbox.height\n            };\n          }\n        } catch (error) {\n          results.methods.domGetBBox = { error: error.message };\n        }\n\n        // Method 4: Data attributes (if set by TextOverlayRenderer)\n        try {\n          const container = systemsManager.renderer?.mountEl;\n          const svgElement = container?.querySelector('svg');\n          const renderedElement = svgElement?.querySelector(`[data-overlay-id=\"${overlayId}\"]`);\n          if (renderedElement) {\n            const width = renderedElement.getAttribute('data-text-width');\n            const height = renderedElement.getAttribute('data-text-height');\n            const fontSize = renderedElement.getAttribute('data-font-size');\n            const dominantBaseline = renderedElement.getAttribute('data-dominant-baseline');\n            const textAnchor = renderedElement.getAttribute('data-text-anchor');\n\n            if (width && height) {\n              // Use proper baseline calculation like the debug renderer\n              let adjustedY = y;\n              const textHeight = parseFloat(height);\n              const textFontSize = parseFloat(fontSize) || 16;\n              const actualBaseline = dominantBaseline || 'auto';\n\n              if (actualBaseline === 'hanging') {\n                adjustedY = y;\n              } else if (actualBaseline === 'middle' || actualBaseline === 'central') {\n                adjustedY = y - textHeight / 2;\n              } else if (actualBaseline === 'text-after-edge') {\n                adjustedY = y - textHeight;\n              } else {\n                const ascent = textFontSize * 0.7;\n                adjustedY = y - ascent;\n              }\n\n              // Also calculate X position based on text anchor\n              let adjustedX = x;\n              const textWidth = parseFloat(width);\n              const actualTextAnchor = textAnchor || 'start';\n\n              if (actualTextAnchor === 'middle') {\n                adjustedX = x - textWidth / 2;\n              } else if (actualTextAnchor === 'end') {\n                adjustedX = x - textWidth;\n              }\n\n              results.methods.dataAttributes = {\n                x: adjustedX,\n                y: adjustedY,\n                width: textWidth,\n                height: textHeight,\n                baseline: actualBaseline,\n                anchor: actualTextAnchor\n              };\n            }\n          }\n        } catch (error) {\n          results.methods.dataAttributes = { error: error.message };\n        }        console.table(results.methods);\n        return results;\n      }\n    },\n\n    routing: {\n      show: () => debugManager.enable('routing'),\n      hide: () => debugManager.disable('routing'),\n      toggle: () => debugManager.toggle('routing')\n    },\n\n    performance: {\n      show: () => debugManager.enable('performance'),\n      hide: () => debugManager.disable('performance'),\n      toggle: () => debugManager.toggle('performance')\n    }\n  };\n\n  /*\n  // Keep the shadowRoot tracking code - it's still used by testRender and other methods\n  let debugShadowRoot = null;\n  let lastUsedRoot = null;\n  */\n\n  /**\n   * Store the shadowRoot context from the render call\n   * This allows us to find elements within the correct scope later\n   */\n  /*\n  function setDebugContext(root) {\n    if (root && root.querySelector) {\n      debugShadowRoot = root;\n      lastUsedRoot = root;\n      console.log('[MSD Debug] Stored debug context:', root.constructor.name);\n    }\n  }\n  */\n  /**\n   * Find MSD wrapper element within the correct scope (shadowRoot)\n   */\n  /*\n  function findMsdWrapper() {\n    const searchRoots = [debugShadowRoot, lastUsedRoot].filter(Boolean);\n\n    for (const root of searchRoots) {\n      if (!root || !root.querySelector) continue;\n\n      // Try multiple selectors within this shadowRoot\n      const selectors = [\n        '#msd-v1-comprehensive-wrapper',\n        '[id*=\"msd-v1\"]',\n        '[id*=\"msd\"]',\n        '.msd-container',\n        'div[style*=\"border:2px solid cyan\"]'  // Fallback to the wrapper div style\n      ];\n\n      for (const selector of selectors) {\n        try {\n          const element = root.querySelector(selector);\n          if (element) {\n            console.log(`[MSD Debug] Found wrapper using selector '${selector}' in ${root.constructor.name}`);\n            return element;\n          }\n        } catch (e) {\n          // Continue to next selector\n        }\n      }\n    }\n\n    console.warn('[MSD Debug] Could not find MSD wrapper in any known shadowRoot');\n    return null;\n  }\n  */\n\n  dbg.renderAdvanced = (options) => {\n    try {\n      console.log('[MSD v1] renderAdvanced called - using AdvancedRenderer');\n      const model = modelBuilder.getResolvedModel();\n      if (model) {\n        return systemsManager.renderer.render(model);\n      }\n      console.warn('[MSD v1] renderAdvanced: No resolved model available');\n      return { svgMarkup: '' };\n    } catch (error) {\n      console.error('[MSD v1] renderAdvanced failed:', error);\n      return { svgMarkup: '', error: error.message };\n    }\n  };\n\n  // Rest of the function remains the same...\n  dbg.hud = {\n    show: () => systemsManager.hudManager.show(),\n    hide: () => systemsManager.hudManager.hide(),\n    toggle: () => systemsManager.hudManager.toggle(),\n    state: () => ({\n      visible: systemsManager.hudManager.state?.visible || false,\n      activePanel: systemsManager.hudManager.state?.activePanel || 'unknown',\n      refreshRate: systemsManager.hudManager.state?.refreshRate || 2000\n    }),\n\n    init: () => {\n      if (debugConfig?.hud?.auto_show) {\n        setTimeout(() => {\n          systemsManager.hudManager.show();\n          console.log('[MSD v1] HUD auto-shown based on config');\n        }, 2000);\n      }\n    }\n  };\n\n  setTimeout(() => dbg.hud.init(), 100);\n\n  dbg.introspection = {\n    listOverlays: (root) => MsdIntrospection.listOverlays(root),\n    getOverlayBBox: (id, root) => MsdIntrospection.getOverlayBBox(id, root),\n    highlight: (ids, opts) => MsdIntrospection.highlight(ids, opts)\n  };\n\n  dbg.controls = {\n    render: (overlays, model) => systemsManager.controlsRenderer.renderControls(overlays, model),\n    relayout: () => systemsManager.controlsRenderer.relayout()\n  };\n\n  // ADD: Help system\n  dbg.help = function() {\n    console.log(`\n╔══════════════════════════════════════════════════════════════════════════════╗\n║                          MSD Debug Interface Help                            ║\n╠══════════════════════════════════════════════════════════════════════════════╣\n║ Debug Features:                                                              ║\n║   __msdDebug.debug.enable('anchors')       - Show anchor point markers      ║\n║   __msdDebug.debug.enable('bounding_boxes') - Show overlay bounding boxes   ║\n║   __msdDebug.debug.enable('routing')       - Show routing path visualization║\n║   __msdDebug.debug.enable('performance')   - Show performance metrics       ║\n║   __msdDebug.debug.enable('all')           - Enable all features            ║\n║                                                                              ║\n║   __msdDebug.debug.disable('feature')      - Disable specific feature       ║\n║   __msdDebug.debug.status()                - Show current debug state       ║\n║   __msdDebug.debug.setScale(1.5)           - Set debug element scale        ║\n║   __msdDebug.debug.refresh()               - Force re-render debug overlays ║\n║                                                                              ║\n║ Quick Access:                                                                ║\n║   __msdDebug.debug.anchors.toggle()        - Toggle anchor markers          ║\n║   __msdDebug.debug.bounding.toggle()       - Toggle bounding boxes          ║\n║   __msdDebug.debug.bounding.test('id')     - Test bounding box accuracy     ║\n║   __msdDebug.debug.bounding.compare('id')  - Compare measurement methods    ║\n║   __msdDebug.debug.routing.toggle()        - Toggle routing guides          ║\n║   __msdDebug.debug.performance.toggle()    - Toggle performance overlay     ║\n║                                                                              ║\n║ Data & Entities:                                                             ║\n║   __msdDebug.dataSources.stats()           - Data source statistics         ║\n║   __msdDebug.dataSources.list()            - List all data sources          ║\n║   __msdDebug.dataSources.get('name')       - Get specific data source       ║\n║                                                                              ║\n║ Routing:                                                                     ║\n║   __msdDebug.routing.inspect('overlay_id') - Inspect routing path           ║\n║   __msdDebug.routing.stats()               - Routing system statistics      ║\n║   __msdDebug.routing.invalidate()          - Clear routing cache            ║\n║                                                                              ║\n║ Performance:                                                                 ║\n║   __msdDebug.getPerf()                     - Get performance metrics        ║\n║   __msdDebug.perf()                        - Alternative performance data   ║\n║                                                                              ║\n║ Other Tools:                                                                 ║\n║   __msdDebug.hud.toggle()                  - Toggle HUD overlay             ║\n║   __msdDebug.rules.trace()                 - Show rules engine trace        ║\n║   __msdDebug.validation.issues()           - Show configuration issues      ║\n║   __msdDebug.usage()                       - Show simplified usage examples ║\n║                                                                              ║\n║ Pipeline:                                                                    ║\n║   __msdDebug.pipelineInstance              - Direct pipeline access         ║\n╚══════════════════════════════════════════════════════════════════════════════╝\n    `);\n  };\n\n  // ADD: Simplified usage examples\n  dbg.usage = function() {\n    console.log(`\n🔧 Quick MSD Debug Commands:\n\nEnable debug features:\n  __msdDebug.debug.enable('anchors')      # Show anchor points\n  __msdDebug.debug.enable('bounding_boxes') # Show overlay bounds\n  __msdDebug.debug.enable('all')          # Enable everything\n\nCheck status:\n  __msdDebug.debug.status()               # Current debug state\n  __msdDebug.dataSources.stats()          # Data source info\n  __msdDebug.getPerf()                    # Performance metrics\n\nQuick toggles:\n  __msdDebug.debug.anchors.toggle()       # Toggle anchors\n  __msdDebug.debug.bounding.toggle()      # Toggle bounding boxes\n  __msdDebug.debug.bounding.test('id')    # Test bounding accuracy\n  __msdDebug.debug.routing.toggle()       # Toggle routing guides\n\nFor full help: __msdDebug.help()\n    `);\n  };\n\n  // Log debug config state (REDUCED)\n  if (debugConfig.enabled) {\n    console.log('[MSD v1] Debug mode enabled');\n  }\n}\n\nfunction setupUtilityDebugInterface(dbg, mergedConfig, systemsManager) {\n  // Rules system\n  dbg.rules = {\n    trace: () => systemsManager.rulesEngine.getTrace()\n  };\n\n  // Animations\n  dbg.animations = {\n    active: () => systemsManager.animRegistry.getActive()\n  };\n\n  // Performance monitoring\n  dbg.getPerf = () => {\n    const perfStore = dbg.__perfStore || {};\n    const result = {\n      timers: {},\n      counters: perfStore.counters || {}\n    };\n\n    if (perfStore.timings) {\n      Object.entries(perfStore.timings).forEach(([key, data]) => {\n        if (data && typeof data === 'object') {\n          result.timers[key] = {\n            count: data.count || 0,\n            total: data.total || 0,\n            avg: data.count > 0 ? (data.total / data.count) : 0,\n            last: data.last || 0,\n            max: data.max || 0\n          };\n        }\n      });\n    }\n\n    return result;\n  };\n\n  dbg.perf = () => perfGetAll();\n\n  // Validation\n  dbg.validation = {\n    issues: () => {\n      try {\n        return mergedConfig.__issues || { errors: [], warnings: [] };\n      } catch (e) {\n        console.warn('[MSD v1] validation.issues failed:', e);\n        return { errors: [], warnings: [] };\n      }\n    }\n  };\n\n  // Packs inspection\n  dbg.packs = {\n    list: (type) => {\n      if (!type) return {\n        animations: mergedConfig.animations?.length || 0,\n        overlays: mergedConfig.overlays?.length || 0,\n        rules: mergedConfig.rules?.length || 0,\n        profiles: mergedConfig.profiles?.length || 0,\n        timelines: mergedConfig.timelines?.length || 0\n      };\n      return mergedConfig[type] || [];\n    },\n    get: (type,id) => (mergedConfig[type]||[]).find(i=>i.id===id),\n    issues: () => mergedConfig.__issues\n  };\n\n  // Line debugging\n  dbg.lines = {\n    markersEnabled: false,\n    showMarkers(flag=true){\n      this.markersEnabled=!!flag;\n      console.info('[MSD v1] line endpoint markers', this.markersEnabled?'ENABLED':'DISABLED');\n    },\n    forceRedraw: () => {\n      // Connect to the reRender callback through systems manager\n      if (systemsManager._reRenderCallback) {\n        systemsManager._reRenderCallback();\n        return true;\n      }\n      return false;\n    }\n  };\n}","import * as anime from 'animejs';\n\nimport * as CBLCARS from './cb-lcars-vars.js'\nimport { cblcarsSetGlobalLogLevel, cblcarsGetGlobalLogLevel, cblcarsLog, cblcarsLogBanner} from './utils/cb-lcars-logging.js';\nimport { readYamlFile } from './utils/cb-lcars-fileutils.js';\nimport { preloadSVGs, loadSVGToCache, getSVGFromCache } from './utils/cb-lcars-fileutils.js';\n//import { CBLCARSDashboardStrategy, CBLCARSViewStrategy, CBLCARSViewStrategyAirlock } from './strategy/cb-lcars-strategy.js';\nimport { CBLCARSCardEditor } from './editor/cb-lcars-editor.js';\nimport { loadFont, loadCoreFonts, loadAllFontsFromConfig } from './utils/cb-lcars-theme.js';\nimport { getLovelace, checkLovelaceTemplates } from './utils/cb-helpers.js';\nimport { ButtonCard } from \"./cblcars-button-card.js\"\nimport { html } from 'lit';\n\nimport * as animHelpers from './utils/cb-lcars-anim-helpers.js';\nimport { animPresets } from './utils/cb-lcars-anim-presets.js';\nimport * as svgHelpers from './utils/cb-lcars-svg-helpers.js';\nimport * as anchorHelpers from './utils/cb-lcars-anchor-helpers.js';\n\n\n\n// CHANGED: Side-effect import that initializes the MSD v1 pipeline\nimport './msd/index.js';\n\n\n// Ensure global namespace\nwindow.cblcars = window.cblcars || {};\n\n// Promises for loading the templates and stub configuration\nlet templatesPromise;\nlet stubConfigPromise;\nlet themeColorsPromise;\n\n// Load the templates from our yaml file\nlet templates = {};\nlet stubConfig = {};\n\n// Ensure the cblcars object exists on the window object\n//window.cblcars = window.cblcars || {};\nwindow.cblcars.loadFont = loadFont;\n\n\n// DEBUGGING: Add immediate global debugging when CB-LCARS loads\nconsole.log('[CB-LCARS] File loaded, setting up debugging');\n\nasync function initializeCustomCard() {\n\n    // Call log banner function immediately when the script loads\n    cblcarsLogBanner();\n    window.cblcars.cblcarsLog = cblcarsLog; // Expose the logging function globally\n\n    // Expose debug helpers (the module already attaches API; this ensures references exist)\n    window.cblcars.debug = window.cblcars.debug || {};\n    window.cblcars.debug.setLevel = cblcarsSetGlobalLogLevel;\n\n    // Animation namespace organization\n    window.cblcars.anim = {\n        animejs: anime,                // full animejs module\n        anime: anime.animate,          // shortcut for anime.animate\n        utils: anime.utils,            // CENTRAL canonical utils reference\n        animateElement: animHelpers.animateElement,\n        animateWithRoot: animHelpers.animateWithRoot,\n        waitForElement: animHelpers.waitForElement,\n        presets: animPresets,\n        scopes: new Map(),\n    };\n\n    // Backward-compatible shortcuts (to be deprecated)\n    window.cblcars.animejs = window.cblcars.anim.animejs;\n    window.cblcars.anime = window.cblcars.anim.anime;\n    window.cblcars.animateElement = window.cblcars.anim.animateElement;\n    window.cblcars.animateWithRoot = window.cblcars.anim.animateWithRoot;\n    window.cblcars.waitForElement = window.cblcars.anim.waitForElement;\n\n\n    window.cblcars.svgHelpers = svgHelpers;\n    window.cblcars.anchorHelpers = anchorHelpers;\n    window.cblcars.findSvgAnchors = anchorHelpers.findSvgAnchors;\n    window.cblcars.getSvgContent = anchorHelpers.getSvgContent;\n    window.cblcars.getSvgViewBox = anchorHelpers.getSvgViewBox;\n    window.cblcars.getSvgAspectRatio = anchorHelpers.getSvgAspectRatio;\n\n\n    window.cblcars.loadFont = loadFont;\n    window.cblcars.loadUserSVG = async function(key, url) {\n        return await loadSVGToCache(key, url);\n    };\n    window.cblcars.getSVGFromCache = getSVGFromCache;\n\n    ///load yaml configs\n    // Await YAML configs\n    templatesPromise = loadTemplates(CBLCARS.templates_uri);\n    stubConfigPromise = loadStubConfig(CBLCARS.stub_config_uri);\n    themeColorsPromise = loadThemeColors(CBLCARS.theme_colors_uri);\n\n    // Await SVG preload\n    await preloadSVGs(CBLCARS.builtin_svg_keys, CBLCARS.builtin_svg_basepath)\n        .catch(error => cblcarsLog.error('[initializeCustomCard] Error preloading built-in SVGs:', error));\n\n    // Await card dependencies\n    const cardImports = [\n        customElements.whenDefined('cblcars-button-card'),\n        customElements.whenDefined('my-slider-v2')\n    ];\n    await Promise.all(cardImports);\n\n    // Await font loading if loadCoreFonts is async\n    await loadCoreFonts();\n\n    // Await YAML config loading\n    await Promise.all([templatesPromise, stubConfigPromise, themeColorsPromise]);\n\n    // Checks that custom element dependencies are defined for use in the cards\n    if (!customElements.get('cblcars-button-card')) {\n        cblcarsLog.error(`[initializeCustomCard] Custom Button Card for LCARS [cblcars-button-card] was not found!`);\n    }\n    if (!customElements.get('my-slider-v2')) {\n        cblcarsLog.error(`[initializeCustomCard] 'My Cards' MySliderV2 Custom Card [my-slider-v2] was not found!`);\n    }\n}\n\n\n// Initialize the custom card and register elements only after setup is complete\ninitializeCustomCard()\n    .then(() => {\n        defineCustomElement('cb-lcars-base-card', CBLCARSBaseCard, 'cb-lcars-base-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-label-card', CBLCARSLabelCard, 'cb-lcars-label-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-elbow-card', CBLCARSElbowCard, 'cb-lcars-elbow-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-double-elbow-card', CBLCARSDoubleElbowCard, 'cb-lcars-double-elbow-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-multimeter-card', CBLCARSMultimeterCard, 'cb-lcars-multimeter-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-dpad-card', CBLCARSDPADCard, 'cb-lcars-dpad-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-button-card', CBLCARSButtonCard, 'cb-lcars-button-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-msd-card', CBLCARSMSDCard, 'cb-lcars-msd-card-editor', CBLCARSCardEditor);\n    })\n    .catch(error => {\n        cblcarsLog.error('[initializeCustomCard.then()] Error initializing custom card:', error);\n    });\n\n\nasync function loadTemplates(filePath) {\n    try {\n        const yamlContent = await readYamlFile(filePath);\n\n        // Store the YAML content in window.cblcars_card_templates\n        window.cblcars_card_templates = yamlContent.cblcars_card_templates;\n\n        // Merge the cblcars stanza with the existing window.cblcars object\n        if (yamlContent.cblcars) {\n            window.cblcars = {\n                ...window.cblcars,\n                ...yamlContent.cblcars\n            };\n        }\n\n        templates = yamlContent || {};\n        cblcarsLog.debug(`[loadTemplates] CB-LCARS dashboard templates loaded from source file [${filePath}]`, templates);\n    } catch (error) {\n        cblcarsLog.error('[loadTemplates] Failed to get the CB-LCARS lovelace templates from source file.', error);\n    }\n}\n\nasync function loadThemeColors(filePath) {\n    try {\n        const yamlContent = await readYamlFile(filePath);\n\n        // Merge the cblcars stanza with the existing window.cblcars object\n        if (yamlContent.cblcars) {\n            window.cblcars = {\n                ...window.cblcars,\n                ...yamlContent.cblcars\n            };\n        }\n        cblcarsLog.info(`[loadThemeColors] CB-LCARS theme colors loaded from source file [${filePath}]`, yamlContent);\n        setThemeColors(window.cblcars.themes, 'green');\n    } catch (error) {\n        cblcarsLog.error('[loadThemeColors] Failed to get the CB-LCARS theme colors from source file.', error);\n    }\n}\n\nfunction setThemeColors(themes, alertCondition = 'green', clobber = false) {\n    const selectedTheme = themes[`${alertCondition}_alert`];\n    if (!selectedTheme) {\n        cblcarsLog.error(`[setThemeColors] Theme for alert condition ${alertCondition} is not defined.`, '', cblcarsGetGlobalLogLevel());\n        return;\n    }\n\n    const colors = selectedTheme.colors;\n\n    for (const [colorGroup, colorValues] of Object.entries(colors)) {\n        for (const [colorName, colorValue] of Object.entries(colorValues)) {\n            const cssVarName = `--${colorName}`;\n            const existingValue = getComputedStyle(document.documentElement).getPropertyValue(cssVarName).trim();\n\n            if (clobber || !existingValue) {\n                cblcarsLog.warn(`[setThemeColors] Color undefined or overridden - Setting ${cssVarName}=${colorValue}`, '', cblcarsGetGlobalLogLevel());\n                document.documentElement.style.setProperty(cssVarName, colorValue);\n            } else {\n                cblcarsLog.debug(`[setThemeColors] Skipping ${cssVarName} as it is already defined with value ${existingValue}`, '', cblcarsGetGlobalLogLevel());\n            }\n        }\n    }\n}\nfunction setAlertCondition(alertCondition) {\n    setThemeColors(window.cblcars.themes, alertCondition,true);\n}\nwindow.cblcars.setAlertCondition = setAlertCondition;\n\n// Load the stub configuration from our yaml file\nasync function loadStubConfig(filePath) {\n    try {\n        const yamlContent = await readYamlFile(filePath);\n        stubConfig = yamlContent || {};\n        cblcarsLog.debug(`[loadStubConfig] CB-LCARS stub configuration loaded from source file [${CBLCARS.stub_config_uri}]`, stubConfig);\n    } catch (error) {\n        cblcarsLog.error('[loadStubConfig] Failed to get the CB-LCARS stub configuration from source file.', error);\n    }\n}\n\n\n\n// --- Anime.js v4 Scopes Manager ---\nclass CBLCARSAnimationScope {\n    constructor(id) {\n        this.id = id;\n        this.scope = window.cblcars.animejs.createScope(); // anime.js v4 syntax\n        this.animations = []; // Array to hold animation instances for inspection\n        this._runningByTarget = new Map(); // Map<targetId, animation>\n    }\n\n    // Resolve the root for DOM operations\n    _getRoot(options) {\n        return (options && options.root) || document;\n    }\n\n    // Normalize targets into Element[]\n    _resolveTargets(options) {\n        const root = this._getRoot(options);\n        const t = options && options.targets;\n        if (!t) return [];\n        if (t instanceof Element) return [t];\n        if (Array.isArray(t)) return t.filter(Boolean);\n        if (typeof t === 'string') {\n            // Prefer ID fast-path\n            if (t.startsWith('#')) {\n                const el = root.querySelector(t);\n                return el ? [el] : [];\n            }\n            return Array.from(root.querySelectorAll(t));\n        }\n        return [];\n    }\n\n    // Remove artifacts created by previous animation runs for a given baseId\n    _cleanupArtifactsForTargetId(root, baseId) {\n        if (!baseId) return;\n        // Only remove preset-owned artifacts\n        const trails = root.querySelectorAll(`#${baseId}_trail[data-cblcars-owned]`);\n        trails.forEach(n => n.parentElement && n.parentElement.removeChild(n));\n        const tracers = root.querySelectorAll(`#${baseId}_tracer[data-cblcars-owned]`);\n        tracers.forEach(n => n.parentElement && n.parentElement.removeChild(n));\n\n        // Clear CSS animation residue on the base element (e.g., march)\n        const baseEl = root.getElementById(baseId);\n        if (baseEl) {\n            if (baseEl.style) baseEl.style.animation = '';\n            baseEl.removeAttribute('data-march-anim-id');\n        }\n    }\n    // Stop anime.js animations for the given targets and cleanup artifacts\n    _cancelAndCleanupTargets(options) {\n        const root = this._getRoot(options);\n        const targets = this._resolveTargets(options);\n        targets.forEach(el => {\n            const id = el && el.id;\n            if (!id) return;\n\n            // Stop prior animations on this element (if any)\n            if (this.scope && typeof this.scope.remove === 'function') {\n                try { this.scope.remove(el); } catch (_) {}\n            }\n\n            // Remove previously created artifacts for this target\n            this._cleanupArtifactsForTargetId(root, id);\n\n            // Clear inline CSS animation remnants\n            el.style && (el.style.animation = '');\n\n            // Forget previous tracking entry\n            this._runningByTarget.delete(id);\n        });\n        return targets;\n    }\n\n    /**\n     * Adds an animation to the scope using the v4 `scope.add()` pattern.\n     * De-duplicates by target: cancels prior animations and removes artifacts before starting a new one.\n     * @param {object} options - The animation options for animateElement.\n     * @param {object} hass - The Home Assistant hass object.\n     */\n    animate(options, hass = null) {\n        const targets = this._cancelAndCleanupTargets(options);\n\n        // Call the global animateElement helper, passing this instance as the scope.\n        const animation = window.cblcars.anim.animateElement(this, options, hass);\n        if (animation) {\n            this.animations.push({ config: options, animation: animation, targets });\n            // Track per-target so future runs can be canceled/cleaned deterministically\n            targets.forEach(el => el && el.id && this._runningByTarget.set(el.id, animation));\n        }\n    }\n\n    destroy() {\n        // Stop and remove all animations associated with this scope.\n        if (this.scope && typeof this.scope.remove === 'function') {\n            try {\n                const activeAnimations = window.cblcars.animejs.get(this.scope);\n                if (activeAnimations) {\n                    this.scope.remove(activeAnimations.map(anim => anim.targets).flat());\n                }\n            } catch (_) {}\n        }\n\n        // Cleanup artifacts for all tracked targets\n        try {\n            this.animations.forEach(entry => {\n                const root = this._getRoot(entry.config);\n                (entry.targets || []).forEach(el => {\n                    if (el && el.id) {\n                        this._cleanupArtifactsForTargetId(root, el.id);\n                        el.style && (el.style.animation = '');\n                    }\n                });\n            });\n        } catch (_) {}\n\n        // Clear internal tracking\n        this._runningByTarget.clear();\n        this.animations = [];\n    }\n}\n\n\nclass CBLCARSBaseCard extends ButtonCard {\n\n    _isResizeObserverEnabled = false;\n    _resizeObserver;\n    _logLevel = cblcarsGetGlobalLogLevel();\n    _resizeObserverTarget = 'this';\n    _lastWidth = 0;\n    _lastHeight = 0;\n    _resizeObserverTolerance = 16; // Default tolerance for resize observer.  16 settles infinite resize in preview mode.\n    _debounceWait = 100; // Default debounce wait time in milliseconds\n    _isUsingLovelaceTemplate = false;\n    _overrideTemplates = [];\n\n\n    constructor () {\n        super();\n        this._resizeObserverTolerance = window.cblcars.resizeObserverTolerance || this._resizeObserverTolerance;\n        this._debounceWait = window.cblcars.debounceWait || this._debounceWait;\n        this._resizeObserver = new ResizeObserver(() => {\n            cblcarsLog.debug('[CBLCARSBaseCard.constructor()] Resize observer fired', this, this._logLevel);\n            this._debouncedResizeHandler();\n        });\n        this._debouncedResizeHandler = this._debounce(() => this._updateCardSize(), this._debounceWait);\n    }\n\n\n    setHass(hass) {\n        console.log('[CBLCARSBaseCard.setHass()] 🎯 RECEIVED setHass call:', {\n            cardType: this.constructor.cardType,\n            entity: this._config?.entity,\n            oldState: this.hass?.states?.[this._config?.entity]?.state,\n            newState: hass?.states?.[this._config?.entity]?.state,\n            stateChanged: this.hass?.states?.[this._config?.entity]?.state !== hass?.states?.[this._config?.entity]?.state,\n            timestamp: new Date().toISOString(),\n            callerStack: new Error().stack.split('\\n').slice(1, 3).map(line => line.trim()).join(' → ')\n        });\n\n        // Store the old HASS for LitElement change detection\n        const oldHass = this.hass;\n\n        // CRITICAL: Update _stateObj BEFORE setting HASS property to maintain sync with custom-button-card\n        if (this._config?.entity && hass?.states?.[this._config.entity]) {\n            const newStateObj = hass.states[this._config.entity];\n            if (this._stateObj !== newStateObj) {\n                console.log('[CBLCARSBaseCard.setHass()] Updating _stateObj for entity:', this._config.entity, {\n                    oldState: this._stateObj?.state,\n                    newState: newStateObj?.state\n                });\n                this._stateObj = newStateObj;\n            }\n        }\n\n        // Use property assignment to trigger LitElement's reactive system\n        this.hass = hass;\n        this._hass = hass; // Also set internal property for compatibility\n\n        // Trigger LitElement's requestUpdate for proper change detection\n        if (typeof this.requestUpdate === 'function') {\n            this.requestUpdate('hass', oldHass);\n            this.requestUpdate('_hass', oldHass);\n\n            // Also trigger update for state object if it changed\n            if (this._config?.entity && this._stateObj) {\n                this.requestUpdate('_stateObj');\n            }\n        }\n\n        console.log('[CBLCARSBaseCard.setHass()] Completed with property assignment approach');\n    }\n\n\n    setConfig(config) {\n        if (!config) {\n            throw new Error(\"The 'cblcars_card_config' section is required in the configuration.\");\n        }\n\n        // DEBUGGING: Log the incoming config to see what MSD is passing\n        console.log('[CBLCARSBaseCard.setConfig()] Called with config:', {\n            type: config.type,\n            entity: config.entity,\n            triggersUpdate: config.triggers_update,\n            hasSetConfigFromMSD: config._msdGenerated || false,\n            fullConfig: config\n        });\n\n        // Handle merging of templates array\n        const defaultTemplates = ['cb-lcars-base'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        // Set the _logLevel property from the config\n        this._logLevel = config.cblcars_log_level || cblcarsGetGlobalLogLevel();\n\n        // ENHANCED: Skip entity collection entirely for MSD cards\n        let triggersUpdate = [];\n        const isMSDCard = config.type === 'cb-lcars-msd-card' ||\n                        this.constructor.cardType === 'cb-lcars-msd-card' ||\n                        mergedTemplates.includes('cb-lcars-msd');\n\n        if (isMSDCard) {\n            // MSD cards: NO entity tracking at all\n            triggersUpdate = [];\n            console.log(`[CBLCARSBaseCard.setConfig()] MSD card detected: Completely disabling triggers_update`);\n        } else {\n            // Non-MSD cards: Normal entity collection\n            const foundEntities = collectEntities(config);\n            triggersUpdate = Array.isArray(config.triggers_update) ? config.triggers_update : [];\n\n            if (config.triggers_update === 'all') {\n                triggersUpdate = 'all';\n            } else if (foundEntities.length > 0) {\n                triggersUpdate = Array.from(new Set([...triggersUpdate, ...foundEntities]));\n                console.log(`[CBLCARSBaseCard.setConfig()] Found entities for triggers_update:`, foundEntities);\n            }\n        }\n\n\n        // Create a new object to avoid modifying the original config\n        this._config = {\n            ...config,\n            template: mergedTemplates,\n            triggers_update: triggersUpdate  // FIXED: Re-enabled triggers_update\n        };\n\n        console.log('[CBLCARSBaseCard.setConfig()] Final config triggers_update:', this._config.triggers_update);\n\n        // Load all fonts from the config (dynamically loads fonts based on the config)\n        loadAllFontsFromConfig(this._config);\n\n        // Check if the card is using a template from the dashboard's yaml.\n        // this will override the card's configuration\n        // this could be on purpose for testing/customization - but more likely holdovers from the original version that used that method\n        const { isUsingLovelaceTemplate, overriddenTemplates } = checkLovelaceTemplates(this._config);\n        this._isUsingLovelaceTemplate = isUsingLovelaceTemplate;\n        this._overrideTemplates = overriddenTemplates;\n\n        // Log a warning if the card is using a template from the dashboard's yaml\n        // add the card to a list of tainted cards\n        if(isUsingLovelaceTemplate) {\n            cblcarsLog.warn(`[CBLCARSBaseCard.setConfig()] Card configuration templates are being overridden with local dashboard YAML configuration.  Templates: ${overriddenTemplates.join(', ')}`, this, this._logLevel);\n            window.cblcars.taintedCards = window.cblcars.taintedCards || [];\n            window.cblcars.taintedCards.push({card: this, templates: overriddenTemplates});\n        }\n\n\n        // Set up the resizeObserver properties\n        this._resizeObserverTarget = config.resize_observer_target || 'this';\n        this._isResizeObserverEnabled = (config.enable_resize_observer || (config.variables && config.variables.enable_resize_observer)) || false;\n        this._resizeObserverTolerance = config.resize_observer_tolerance || this._resizeObserverTolerance;\n        this._debounceWait = config.debounce_wait || this._debounceWait;\n        // Enable the resize observer if any merged template contains the word 'animation'\n        // this allows us to enable the observer for added animation templates without needed to explicity add it to the config\n        if (mergedTemplates.some(template => template.includes('animation') || template.includes('symbiont'))) {\n            this._isResizeObserverEnabled = true;\n        }\n\n        // Enable the resize observer if the configuration option is enabled\n        if (this._isResizeObserverEnabled) {\n            this.enableResizeObserver();\n        }\n\n        super.setConfig(this._config);\n        console.log('[CBLCARSBaseCard.setConfig()] Called super.setConfig with final config:', {\n            triggers_update: this._config.triggers_update,\n            entity: this._config.entity,\n            type: this._config.type\n        });\n\n        // ADDED: Force state re-evaluation for CB-LCARS cards after config change\n        if (this.hass && this._config.entity) {\n            console.log('[CBLCARSBaseCard.setConfig()] Forcing state re-evaluation after setConfig');\n\n            // Force the card to re-evaluate its state-based styling\n            setTimeout(() => {\n                try {\n                    console.log('[CBLCARSBaseCard.setConfig()] Skipping forced setHass - will rely on normal HA update cycle');\n\n                    // Method 2: Force render update (SAFE)\n                    if (typeof this.requestUpdate === 'function') {\n                        console.log('[CBLCARSBaseCard.setConfig()] Forcing requestUpdate');\n                        this.requestUpdate();\n                    }\n\n                    // Method 3: REMOVED - manual state manipulation can cause issues\n\n                } catch (e) {\n                    console.warn('[CBLCARSBaseCard.setConfig()] Failed to force state re-evaluation:', e);\n                }\n            }, 100);\n        }\n\n        cblcarsLog.debug(`[CBLCARSBaseCard.setConfig()] called with:`, this._config, this._logLevel);\n    }\n\n    static get editorType() {\n        return 'cb-lcars-base-card-editor';\n    }\n    static get cardType() {\n        return 'cb-lcars-base-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            label: \"CB-LCARS Base Card\",\n            show_label: true\n        };\n    }\n\n    static getConfigElement() {\n\n        const editorType = this.editorType;\n\n        try {\n            if (!customElements.get(editorType)) {\n                cblcarsLog.error(`[CBLCARSBaseCard.getConfigElement()] Graphical editor element [${editorType}] is not defined defined in Home Assistant!`, null, this._logLevel);\n                return null;\n            }\n            const element = document.createElement(editorType);\n            //console.log('Element created:', element);\n            return element;\n        } catch (error) {\n            cblcarsLog.error(`[CBLCARSBaseCard.getConfigElement()] Error creating element ${editorType}: `, error, this._logLevel);\n            return null;\n        }\n    }\n\n    static getStubConfig() {\n        const cardType = this.cardType;\n        if (stubConfig[cardType]) {\n            return stubConfig[cardType];\n        } else {\n            return this.defaultConfig;\n        }\n    }\n\n    getCardSize() {\n        //return this._card ? this._card.getCardSize() : 4;\n        super.getCardSize();\n    }\n\n    getLayoutOptions() {\n        return {\n          grid_rows: 1,\n          grid_columns: 4\n        };\n      }\n\n\n    connectedCallback() {\n        super.connectedCallback();\n        // --- Anime.js Scope creation ---\n        this._animationScopeId = `card-${this.id || this.cardType || Math.random().toString(36).slice(2)}`;\n        this._animationScope = new CBLCARSAnimationScope(this._animationScopeId);\n        window.cblcars.anim.scopes.set(this._animationScopeId, this._animationScope);\n\n        // CLEANUP: Stop previous timelines if any\n        if (this._timelines && Array.isArray(this._timelines)) {\n            this._timelines.forEach(tl => tl && typeof tl.pause === 'function' && tl.pause());\n            this._timelines = null;\n        }\n\n        // NEW: Timelines now live under this._config.variables.msd.timelines\n        // Build overlay config map from variables.msd.overlays for element-level merge\n        const msdVars = this._config?.variables?.msd || {};\n        const timelinesCfg = msdVars.timelines || null;\n        const overlaysArr = Array.isArray(msdVars.overlays) ? msdVars.overlays : [];\n        const overlayConfigsById = overlaysArr.reduce((acc, o) => {\n            if (o && o.id) acc[o.id] = o;\n            return acc;\n        }, {});\n\n        // Defer timeline creation until after the SVG/overlays have been stamped into the shadowRoot\n        if (timelinesCfg) {\n            requestAnimationFrame(() => {\n            requestAnimationFrame(async () => {\n                try {\n                this._timelines = await animHelpers.createTimelines(\n                    timelinesCfg,\n                    this._animationScopeId,\n                    this.shadowRoot,\n                    overlayConfigsById,\n                    this.hass || null,\n                    msdVars.presets || {}      // <-- pass presets for state_resolver in timeline steps\n                );\n                // Do not force play(); let autoplay govern start/paused state\n                } catch (e) {\n                cblcarsLog.error('[CBLCARSBaseCard.connectedCallback] Error creating timelines:', e);\n                }\n            });\n            });\n        }\n\n        // Check if the parent element has the class 'preview'\n        if (this.parentElement && this.parentElement.classList.contains('preview')) {\n            this.style.height = '60px';\n            this.style.minHeight = '60px';\n        } else {\n            this.style.height = '100%';\n\n            // Enable the resize observer when the card is connected to the DOM\n            // but only if not in preview mode\n            if (this._isResizeObserverEnabled) {\n            this.enableResizeObserver();\n            window.addEventListener('resize', this._debouncedResizeHandler);\n            }\n        }\n    }\n\n    disconnectedCallback() {\n        super.disconnectedCallback();\n        // --- Anime.js Scope cleanup ---\n        const animationScope = window.cblcars.anim.scopes.get(this._animationScopeId);\n        if (animationScope) {\n            //animationScope.destroy();\n            animationScope.destroy();\n            window.cblcars.anim.scopes.delete(this._animationScopeId);\n        }\n        this.disableResizeObserver();\n        window.removeEventListener('resize', this._debouncedResizeHandler)\n    }\n\n    _updateCardSize() {\n\n        //cblcarsLog('debug',`this.offset* dimensions: ${this.offsetWidth} x ${this.offsetHeight}`, this, this._logLevel);\n        //cblcarsLog('debug',`this.offsetParent.offset* dimensions: ${this.offsetParent.offsetWidth} x ${this.offsetParent.offsetHeight}`, this, this._logLevel);\n        //cblcarsLog('debug',`this.parentElement.offset* dimensions: ${this.parentElement.offsetWidth} x ${this.parentElement.offsetHeight}`, this, this._logLevel);\n\n        const parentWidth = this.parentElement.offsetWidth;\n        const parentHeight = this.parentElement.offsetHeight;\n        //cblcarsLog.debug(`Going with dimensions: ${parentWidth} x ${parentHeight}`, this, this._logLevel);\n\n        const significantChange = this._resizeObserverTolerance;\n        // Only update if there is a significant change\n        if (parentWidth > 0 && parentHeight > 0 && (Math.abs(parentWidth - this._lastWidth) > significantChange || Math.abs(parentHeight - this._lastHeight) > significantChange)) {\n            //if (Math.abs(parentWidth - this._lastWidth) > significantChange || Math.abs(parentHeight - this._lastHeight) > significantChange) {\n            this._lastWidth = parentWidth;\n            this._lastHeight = parentHeight;\n\n            // Set CSS variables for the child card's dimensions\n            this.style.setProperty('--button-card-width', `${parentWidth}px`);\n            this.style.setProperty('--button-card-height', `${parentHeight}px`);\n\n            if (!this._config) {\n                cblcarsLog.debug('[CBLCARSBaseCard._updateCardSize()] Config is not defined. Skipping resize handling.', this, this._logLevel);\n                return;\n            }\n\n            // Store the dimensions in the card's config\n            if (!this._config.variables) {\n                this._config.variables = { card: {} };\n            }\n            this._config.variables.card.width = `${parentWidth}px`;\n            this._config.variables.card.height = `${parentHeight}px`;\n\n            // Trigger an update if necessary\n            this.setConfig(this._config);\n        }\n    }\n\n    _updateResizeObserver() {\n        if (this._isResizeObserverEnabled) {\n            this.enableResizeObserver();\n        } else {\n            this.disableResizeObserver();\n        }\n    }\n\n    enableResizeObserver() {\n        const targetElement = this.resolveTargetElement(this._resizeObserverTarget);\n\n        if (targetElement && this.isConnected) {\n            this._resizeObserver.observe(targetElement);\n            cblcarsLog.debug(`[CBLCARSBaseCard.enableResizeObserver()] Resize observer enabled on [${this._resizeObserverTarget}]`, this, this._logLevel);\n        }\n    }\n\n    disableResizeObserver() {\n        if (this._resizeObserver) {\n            this._resizeObserver.disconnect();\n        }\n        cblcarsLog.debug(`[CBLCARSBaseCard.disableResizeObserver()] Resize observer disabled`, this._logLevel);\n    }\n\n    toggleResizeObserver() {\n        this._isResizeObserverEnabled = !this._isResizeObserverEnabled;\n        this._updateResizeObserver();\n    }\n\n    resolveTargetElement(target) {\n        const targetMapping = {\n            'this': () => this,\n            'this.parentElement': () => this.parentElement,\n            'this.offsetParent': () => this.offsetParent,\n            // Add more mappings as needed\n        };\n\n        return targetMapping[target] ? targetMapping[target]() : this;\n    }\n    _debounce(func, wait) {\n        let timeout;\n        return function(...args) {\n            clearTimeout(timeout);\n            timeout = setTimeout(() => func.apply(this, args), wait);\n        };\n    }\n\n    /**\n     * Rebuild timelines for this card instance.\n     * Safe to call after overlays have been stamped; uses double-rAF for DOM availability.\n     * @param {object} timelinesCfg\n     * @param {object} overlayConfigsById\n     * @param {object} presets\n     */\n    _rebuildTimelines(timelinesCfg, overlayConfigsById = {}, presets = {}) {\n        if (!timelinesCfg) return;\n\n        // Stop previous timelines\n        if (this._timelines && Array.isArray(this._timelines)) {\n        this._timelines.forEach(tl => tl && typeof tl.pause === 'function' && tl.pause());\n        this._timelines = null;\n        }\n\n        // Defer to next paints to ensure DOM is present\n        requestAnimationFrame(() => {\n        requestAnimationFrame(async () => {\n            try {\n            this._timelines = await window.cblcars.anim.createTimelines\n                ? window.cblcars.anim.createTimelines(\n                    timelinesCfg,\n                    this._animationScopeId,\n                    this.shadowRoot,\n                    overlayConfigsById,\n                    this.hass || null,\n                    presets || {}\n                )\n                : (await import('./utils/cb-lcars-anim-helpers.js')).createTimelines(\n                    timelinesCfg,\n                    this._animationScopeId,\n                    this.shadowRoot,\n                    overlayConfigsById,\n                    this.hass || null,\n                    presets || {}\n                );\n            } catch (e) {\n            cblcarsLog.error('[CBLCARSBaseCard._rebuildTimelines] Error creating timelines:', e);\n            }\n        });\n        });\n    }\n}\n\n// Helper: Recursively collect all 'entity' and 'entity_id' values in an object\nfunction collectEntities(obj, entities = []) {\n    if (Array.isArray(obj)) {\n        obj.forEach(item => collectEntities(item, entities));\n    } else if (obj && typeof obj === 'object') {\n        for (const [key, value] of Object.entries(obj)) {\n            if ((key === 'entity' || key === 'entity_id') && typeof value === 'string') {\n                entities.push(value);\n            } else {\n                collectEntities(value, entities);\n            }\n        }\n    }\n    return entities;\n}\n\nclass CBLCARSLabelCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-label-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-label-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            label: \"CB-LCARS Label\",\n            show_label: true\n        };\n    }\n\n    setConfig(config) {\n        const defaultCardType = 'cb-lcars-label';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n\n        super.setConfig(specialConfig);\n    }\n}\n\nclass CBLCARSElbowCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-elbow-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-elbow-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            variables: {\n                card: {\n                    border: {\n                        left: { size: 90 },\n                        top: { size: 20 }\n                    }\n                }\n            }\n        };\n    }\n\n    setConfig(config) {\n\n        const defaultCardType = 'cb-lcars-header';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 1,\n            grid_columns: 4\n        };\n      }\n}\n\n\nclass CBLCARSMSDCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-msd-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-msd-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            enable_resize_observer: true,\n            variables: {\n                card: {\n                    border: {\n                        left: { size: 0 },\n                        right: { size: 0 },\n                        top: { size: 0 },\n                        bottom: { size: 0 }\n                    }\n                }\n            }\n        };\n    }\n\n    setConfig(config) {\n\n        console.log('[MSD DEBUG] 🔧 CBLCARSMSDCard.setConfig() CALLED:', {\n            timestamp: new Date().toISOString(),\n            hasExistingConfig: !!this._config,\n            configType: config.type,\n            configEntity: config.entity,\n            msdAlreadyBooted: !!this._msdV1ComprehensiveBoot,\n            stackTrace: new Error().stack.split('\\n').slice(1, 6).map(line => line.trim()).join(' → ')\n        });\n\n        const defaultTemplates = ['cb-lcars-msd'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        // ENHANCED: Completely prevent any entity tracking for MSD cards\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n            // CRITICAL: Remove all entity references to prevent HA from tracking changes\n            entity: undefined,\n            entities: undefined,\n            triggers_update: [], // Force empty array\n            // Disable all button-card entity behaviors\n            show_state: false,\n            show_icon: false,\n            show_name: false,\n            show_label: false,\n            // Prevent any state-based interactions\n            state: undefined,\n            tap_action: { action: 'none' },\n            hold_action: { action: 'none' },\n            double_tap_action: { action: 'none' }\n        };\n\n        const msdConfig = specialConfig?.msd;\n\n        // Call parent setConfig with sanitized config\n        super.setConfig(specialConfig);\n\n        // ENHANCED: Initialize MSD v1 pipeline for this card instance\n        // This ensures the pipeline is ready when the card renders\n        try {\n            if (msdConfig && window.__msdDebug?.initMsdPipeline) {\n                // Store the MSD config for later pipeline initialization in the template\n                this._msdConfig = msdConfig;\n                console.log('[CBLCARSMSDCard] MSD v1 config prepared for pipeline initialization');\n            }\n        } catch (e) {\n            console.warn('[CBLCARSMSDCard] Failed to prepare MSD v1 pipeline:', e);\n        }\n\n        // PRESERVED: SVG handling logic for proper MSD initialization\n        console.log('[CBLCARSMSDCard] msdConfig:', msdConfig);\n        if (msdConfig && msdConfig.base_svg?.source) {\n            console.log('[CBLCARSMSDCard] Found base SVG:', msdConfig.base_svg.source);\n            let svgKey = null, svgUrl = null;\n\n            if (msdConfig.base_svg.source.startsWith('builtin:')) {\n                svgKey = msdConfig.base_svg.source.replace('builtin:', '');\n            } else if (msdConfig.base_svg.source.startsWith('/local/')) {\n                svgKey = msdConfig.base_svg.source.split('/').pop().replace('.svg','');\n                svgUrl = msdConfig.base_svg.source;\n\n                // Load user SVG if not already cached\n                if (!window.cblcars.getSVGFromCache(svgKey)) {\n                    window.cblcars.loadUserSVG(svgKey, svgUrl)\n                        .then(() => {\n                            // MODIFIED: Only request update if not blocked by our overrides\n                            console.log('[CBLCARSMSDCard] SVG loaded, scheduling safe update');\n                            // Use setTimeout to avoid immediate re-render during setConfig\n                            setTimeout(() => {\n                                if (this.requestUpdate && !this._blockUpdates) {\n                                    this.requestUpdate();\n                                }\n                            }, 100);\n                        })\n                        .catch((error) => {\n                            console.warn('[CBLCARSMSDCard] Failed to load user SVG:', error);\n                        });\n                }\n            }\n\n            this._svgKey = svgKey;\n            console.log('[CBLCARSMSDCard] SVG key stored:', svgKey);\n        }\n\n        console.log('[CBLCARSMSDCard] Config set with disabled entity tracking and SVG handling preserved');\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 4,\n            grid_columns: 4\n        };\n    }\n\n    /**\n     * Override setHass to prevent MSD system re-renders that cause disappearing\n     * MSD system manages its own HASS updates internally\n     */\n    setHass(hass) {\n        console.log('[MSD DEBUG] 🏠 CBLCARSMSDCard.setHass() CALLED:', {\n            timestamp: new Date().toISOString(),\n            hasHass: !!hass,\n            lightDeskState: hass?.states?.['light.desk']?.state,\n            callerStack: new Error().stack.split('\\n').slice(1, 4).map(line => line.trim()).join(' → ')\n        });\n\n        // Store HASS reference but don't call parent setHass which triggers re-renders\n        this.hass = hass;\n\n        // CRITICAL: ALWAYS update SystemsManager with the FRESHEST HASS immediately\n        // This ensures _originalHass is never stale\n        if (this._msdPipeline && this._msdPipeline.systemsManager) {\n            console.log('[MSD DEBUG] 📤 IMMEDIATELY updating SystemsManager with FRESH HASS');\n            console.log('[MSD DEBUG] 📊 Fresh HASS light.desk state being sent:', hass?.states?.['light.desk']?.state);\n\n            // ALSO: Forward fresh HASS directly to controls immediately\n            // This bypasses the entity change detection delay\n            if (this._msdPipeline.systemsManager.controlsRenderer) {\n                console.log('[MSD DEBUG] 📤 Immediately forwarding fresh HASS to controls');\n                this._msdPipeline.systemsManager.controlsRenderer.setHass(hass);\n            }\n        }\n\n        // Forward HASS to the MSD system directly instead of re-rendering the card\n        if (this._msdPipeline && typeof this._msdPipeline.ingestHass === 'function') {\n            console.log('[MSD DEBUG] 📤 Forwarding HASS to MSD pipeline via ingestHass');\n            this._msdPipeline.ingestHass(hass);\n        }\n\n        // CRITICAL: Call parent setHass to ensure Home Assistant's normal HASS flow continues\n        // This ensures the card gets updated when entities change outside of MSD system\n        console.log('[MSD DEBUG] 📤 Calling super.setHass() to maintain HA compatibility');\n        super.setHass(hass);\n\n        console.log('[MSD DEBUG] ✅ CBLCARSMSDCard.setHass() COMPLETED - SystemsManager should now have fresh HASS');\n    }\n\n    /**\n     * Override updated to prevent re-renders\n     */\n    updated(changedProperties) {\n        console.log('[MSD DEBUG] 🔄 CBLCARSMSDCard.updated() CALLED:', {\n            timestamp: new Date().toISOString(),\n            changedProperties: Array.from(changedProperties.keys()),\n            stackTrace: new Error().stack.split('\\n').slice(1, 4).map(line => line.trim()).join(' → ')\n        });\n\n        // Check if this is a control-triggered HASS change\n        if (changedProperties.has('hass') || changedProperties.has('_hass')) {\n            const isControlTriggered = this._isControlTriggeredUpdate();\n\n            if (isControlTriggered) {\n                console.log('[MSD DEBUG] ⏭️ BLOCKED super.updated() for control-triggered HASS change');\n                return;\n            } else {\n                console.log('[MSD DEBUG] 🔄 Allowing super.updated() for non-control HASS change');\n            }\n        }\n\n        console.log('[MSD DEBUG] 🔄 Calling super.updated() for changes:', Array.from(changedProperties.keys()));\n        super.updated(changedProperties);\n    }\n\n\n\n    requestUpdate(name, oldValue, options) {\n        console.log('[MSD DEBUG] 🔃 CBLCARSMSDCard.requestUpdate() CALLED:', {\n            timestamp: new Date().toISOString(),\n            name,\n            hasOldValue: oldValue !== undefined,\n            stackTrace: new Error().stack.split('\\n').slice(1, 4).map(line => line.trim()).join(' → ')\n        });\n\n        // ENHANCED: Block ALL HASS-related updates for MSD cards to prevent re-renders\n        if (name === 'hass' || name === '_hass') {\n            console.log('[MSD DEBUG] 🚫 BLOCKED requestUpdate() for HASS change:', name);\n            console.log('[MSD DEBUG] ⏭️ MSD system manages its own HASS updates internally');\n            return Promise.resolve(); // Block the MSD card from re-rendering\n        }\n\n        console.log('[MSD DEBUG] ✅ Allowing requestUpdate() for:', name);\n        return super.requestUpdate(name, oldValue, options);\n    }\n\n\n\n    /**\n     * Check if the current HASS update is from a control-triggered entity change\n     * @private\n     * @returns {boolean} True if this is a control-triggered update\n     */\n    _isControlTriggeredUpdate() {\n        // Access the MSD system's entity change analysis\n        if (window.__msdDebug?.systemsManager) {\n            const lastAnalysis = window.__msdDebug.systemsManager._lastEntityAnalysis;\n            if (lastAnalysis && lastAnalysis.isControlTriggered) {\n                const timeSinceAnalysis = Date.now() - lastAnalysis.timestamp;\n                // If analysis was recent (within 100ms), consider this a control-triggered update\n                return timeSinceAnalysis < 100;\n            }\n        }\n        return false;\n    }\n\n    connectedCallback() {\n        console.log('[CBLCARSMSDCard.connectedCallback] MSD card connected to DOM');\n        super.connectedCallback();\n    }\n\n    disconnectedCallback() {\n        console.log('[CBLCARSMSDCard.disconnectedCallback] MSD card disconnected from DOM');\n        if (this.msdSystem) {\n            console.log('[CBLCARSMSDCard.disconnectedCallback] Cleaning up MSD system');\n            // Don't destroy the MSD system here in case it's just a temporary disconnect\n        }\n        super.disconnectedCallback();\n    }\n}\n\nclass CBLCARSDoubleElbowCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-double-elbow-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-double-elbow-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            };\n    }\n\n    setConfig(config) {\n\n        const defaultCardType = 'cb-lcars-header-picard';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 1,\n            grid_columns: 4\n        };\n      }\n}\n\nclass CBLCARSMultimeterCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-multimeter-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-multimeter-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            variables: {\n                _mode: 'gauge'\n            }\n        };\n    }\n\n    constructor() {\n        super();\n        this._enableResizeObserver = true;\n    }\n\n    setConfig(config) {\n\n        const defaultTemplates = ['cb-lcars-multimeter'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 1,\n            grid_columns: 4\n        };\n      }\n\n    render() {\n        if (!customElements.get('my-slider-v2')) {\n            return html`<ha-alert alert-type=\"error\" title=\"CB-LCARS - Dependency Error\">Required 'my-slider-v2' card is not available - Please refer to the documentation.</ha-alert>`;\n        }\n\n        // Render the card normally\n        return super.render();\n    }\n}\n\nclass CBLCARSDPADCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-dpad-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-dpad-card';\n    }\n\n    static get defaultConfig() {\n        return {};\n    }\n\n    setConfig(config) {\n\n        const defaultTemplates = ['cb-lcars-dpad'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 4,\n            grid_columns: 2\n        };\n      }\n}\n\nclass CBLCARSButtonCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-button-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-button-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            label: \"CB-LCARS Button\",\n            show_label: true\n        };\n    }\n\n    setConfig(config) {\n\n        const defaultCardType = 'cb-lcars-button-lozenge';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_min_rows: 1,\n            grid_rows: 1,\n            grid_columns: 2,\n            grid_min_columns: 1\n        };\n      }\n}\n\n// Helper function to define custom elements and their editors\nfunction defineCustomElement(cardType, cardClass, editorType, editorClass) {\n    customElements.define(cardType, cardClass);\n    customElements.define(editorType, class extends editorClass {\n        constructor() {\n            super(cardType);\n        }\n    });\n}\n\n// Register the cards to be available in the GUI editor\nwindow.customCards = window.customCards || [];\nconst CBLCARSCardClasses = [\n    {\n        type: 'cb-lcars-base-card',\n        name: 'CB-LCARS Base Card',\n        description: 'For advanced use: the CB-LCARS base card for full manual configuration.',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-label-card',\n        name: 'CB-LCARS Label',\n        preview: true,\n        description: 'CB-LCARS label card for text.',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-elbow-card',\n        name: 'CB-LCARS Elbow',\n        preview: true,\n        description: 'CB-LCARS Elbow card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-double-elbow-card',\n        name: 'CB-LCARS Double Elbow',\n        preview: true,\n        description: 'CB-LCARS Double Elbow card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-multimeter-card',\n        name: 'CB-LCARS Multimeter',\n        preview: true,\n        description: 'CB-LCARS Multimeter card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-dpad-card',\n        name: 'CB-LCARS D-Pad',\n        preview: true,\n        description: 'CB-LCARS D-Pad card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-button-card',\n        name: 'CB-LCARS Button',\n        preview: true,\n        description: 'CB-LCARS Buttons [various styles]',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-msd-card',\n        name: 'CB-LCARS MSD',\n        preview: true,\n        description: 'CB-LCARS Master Systems Display (MSD) card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    }\n];\n\nwindow.customCards.push(...CBLCARSCardClasses);","import { initMsdPipeline, initMsdHud } from './pipeline/PipelineCore.js';\nimport { processMsdConfig } from './pipeline/ConfigProcessor.js';\nimport { mergePacks, validateMerged } from './pipeline/ConfigProcessor.js';\nimport { buildCardModel } from './model/CardModel.js';\n\n// Import tests and services\nimport \"./tests/routingScenarios.js\"\nimport \"./tests/smartRoutingScenarios.js\"\nimport \"./tests/channelsRoutingScenarios.js\"\nimport \"./tests/arcsRoutingScenarios.js\";\nimport \"./tests/smoothingRoutingScenarios.js\";\nimport \"./hud/hudService.js\";\n\n// Main exports\nexport { initMsdPipeline, processMsdConfig };\n\n// Utility exports\nexport { mergePacks, validateMerged };\n\n// Debug exposure\n(function attachDebug() {\n  if (typeof window === 'undefined') return;\n\n  window.__msdDebug = window.__msdDebug || {};\n  Object.assign(window.__msdDebug, {\n    mergePacks,\n    buildCardModel,\n    initMsdPipeline\n  });\n\n  // Enhanced debug interface\n  Object.assign(window.__msdDebug, {\n    // Authoritative pipeline instance\n    pipelineInstance: null,\n\n    // Initialize MSD pipeline\n    async initMsdPipeline(mergedConfig, mount, hass) {\n      try {\n        const pipelineApi = await initMsdPipeline(mergedConfig, mount, hass);\n\n        // Set the authoritative pipelineInstance property\n        this.pipelineInstance = pipelineApi;\n\n        return pipelineApi;\n      } catch (error) {\n        console.error('[MSD Debug] Pipeline initialization failed:', error);\n        throw error;\n      }\n    }\n  });\n\n  // DataSourceManager property with getter\n  Object.defineProperty(window.__msdDebug, 'dataSourceManager', {\n    get() {\n      // Simplified: Use pipelineInstance as single source of truth\n      return window.__msdDebug.pipelineInstance?.dataSourceManager ||\n             window.__msdDebug.pipelineInstance?.systemsManager?.dataSourceManager;\n    },\n    configurable: true  // Allow it to be redefined if needed\n  });\n})();\n\n\n","export function getLovelace() {\n    let root = document.querySelector('home-assistant');\n    root = root && root.shadowRoot;\n    root = root && root.querySelector('home-assistant-main');\n    root = root && root.shadowRoot;\n    root = root && root.querySelector('app-drawer-layout partial-panel-resolver, ha-drawer partial-panel-resolver');\n    root = (root && root.shadowRoot) || root;\n    root = root && root.querySelector('ha-panel-lovelace');\n    root = root && root.shadowRoot;\n    root = root && root.querySelector('hui-root');\n    if (root) {\n      const ll = root.lovelace;\n      ll.current_view = root.___curView;\n      return ll;\n    }\n    return null;\n  }\n\n  export function checkLovelaceTemplates(config) {\n    const ll = getLovelace();\n    const lovelaceTemplates = ll && ll.config && ll.config.cblcars_card_templates ? ll.config.cblcars_card_templates : {};\n    let isUsingLovelaceTemplate = false;\n    let overriddenTemplates = [];\n\n    let templates = config.template || [];\n\n    for (const template of templates) {\n        if (lovelaceTemplates.hasOwnProperty(template)) {\n            isUsingLovelaceTemplate = true;\n            overriddenTemplates.push(template);\n        }\n    }\n\n    // Remove duplicates and sort the array\n    overriddenTemplates = [...new Set(overriddenTemplates)].sort();\n\n    return { isUsingLovelaceTemplate, overriddenTemplates };\n}"],"names":["t","r","e","__assign","Object","assign","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","DEFAULT_THRESHOLDS","second","minute","hour","day","format","Intl","DateTimeFormat","language","weekday","month","a","o","year","u","c","m","l","d","f","g","h","system","comma_decimal","decimal_comma","space_comma","none","am_pm","twenty_four","b","time_format","Date","toLocaleString","includes","v","_","hour12","y","w","k","x","D","S","F","T","I","N","M","from","to","thresholds","now","resolvedThresholds","secs","Math","abs","value","round","unit","mins","hours","SECS_PER_MIN","days","SECS_PER_HOUR","fromDate","toDate","years","getFullYear","months","getMonth","weeks","SECS_PER_DAY","RelativeTimeFormat","numeric","NumberFormat","style","unitDisplay","C","attributes","remaining","split","map","Number","state","getTime","last_changed","max","O","q","_themes","default_theme","themes","keys","forEach","updateStyles","window","ShadyCSS","styleSubtree","document","querySelector","hasAttribute","setAttribute","getAttribute","A","getCardSize","E","substr","indexOf","j","R","locale","translationMetadata","translations","isRTL","z","L","entity_id","P","unit_of_measurement","state_class","U","number_format","B","pow","H","isNaN","V","console","error","maximumFractionDigits","toString","currency","minimumFractionDigits","W","device_class","has_date","has_time","setHours","join","toISOString","humidity","G","J","K","Q","X","Y","Z","$","Set","ee","te","re","ne","Event","bubbles","cancelable","Boolean","composed","detail","dispatchEvent","ie","ae","alert","automation","climate","cover","fan","group","input_boolean","input_number","input_select","input_text","light","lock","media_player","remote","scene","script","sensor","timer","switch","vacuum","water_heater","input_datetime","oe","type","config","createElement","setConfig","message","startsWith","has","entity","customElements","get","display","setTimeout","whenDefined","then","clearTimeout","ue","slice","ce","calendar","camera","configurator","conversation","device_tracker","history_graph","homeassistant","homekit","image_processing","mailbox","notify","person","plant","proximity","simple_alarm","sun","updater","weblink","me","warn","se","attribute","operator","match","le","de","history","replaceState","pushState","replace","fe","callService","ge","states","pe","action","confirmation","exemptions","some","user","id","confirm","text","camera_image","entityId","navigation_path","url_path","open","service","service_data","target","he","double_tap_action","hold_action","tap_action","be","haptic","ve","_e","hass","ye","we","push","ke","shadowRoot","lovelace","current_view","___curView","xe","illuminance","temperature","pressure","power","signal_strength","De","binary_sensor","Se","icon","defineProperty","exports","getNestedProperty","deepMerge","source","output","key","targetValue","sourceValue","Array","isArray","isObject","generateControl","control","card","context","_hass","isVisible","visibilityCondition","_evaluateCondition","isDisabled","disabledCondition","isRequired","requiredCondition","selector","select","optionsCondition","options","lit_1","html","configValue","_config","label","helper","_valueChanged","alertType","title","unsafe_html_js_1","unsafeHTML","displayText","colorValue","isCssVariable","computedColorValue","cssVariableNameMatch","cssVariableName","getComputedStyle","documentElement","getPropertyValue","trim","hexToRgb","hex","bigint","parseInt","textColor","nr","ng","nb","getLuminance","obj","path","reduce","acc","part","custom_card_helpers_1","interfaces_1","controls_1","EditorForm","LitElement","constructor","super","_selectedTab","_userStyles","css","_mergeUserStyles","requestUpdate","generateForm","cardConfigData","tabs","generateTabs","formControls","render_form","row","isSection","generateSection","generateRow","_handleTabActivated","event","name","visibleTabs","filter","tab","index","content","item","section","_a","cssClass","headerTag","headerLevel","headerContent","secondary","expanded","noCollapse","outlined","leftChevron","rows","controls","condition","Function","ev","_b","configPath","newValue","_getNewValue","tagName","_updateConfig","fireEvent","_c","checked","__checked","values","nestedConfig","lastKey","updated","changedProperties","adoptedStyleSheets","styles","styleSheet","isControlRow","CBLCARS_VERSION","version","project_url","core_fonts","templates_uri","stub_config_uri","theme_colors_uri","card_editor_uri","builtin_svg_keys","builtin_svg_basepath","DataSourceMixin","resolveContent","rendererName","_raw","data_source","processEnhancedTemplateStrings","dataSourceContent","resolveDataSourceContent","dataSourceRef","dataSourceManager","__msdDebug","pipelineInstance","systemsManager","sourceName","dataKey","isTransformation","isAggregation","parseDataSourceReference","dataSource","getSource","currentData","getCurrentData","transformations","aggregations","aggData","undefined","avg","last","JSON","stringify","formatDataSourceValue","parts","dataType","dataSourceData","value_format","formatSpec","applyNumberFormat","String","isInteger","toFixed","unitOfMeasurement","endsWith","precision","log","processEnhancedTemplateStringsWithFallback","processTemplateForInitialRender","processed","fallbackToOriginal","hasUnresolvedTemplates","processedContent","reference","cleanRef","nestedKeys","baseKey","nestedKey","baseData","getNestedValue","direction","current","getDataSourceManager","getAvailableDataSources","dsm","sources","PositionResolver","resolvePosition","position","anchors","anchorPos","RendererUtils","_getTextMeasureContext","cblcars","_textMeasureCanvas","_textMeasureContext","getContext","_textMeasureCache","Map","_getSvgTransformInfo","containerElement","svg","viewBox","baseVal","rect","getBoundingClientRect","scaleX","width","scaleY","height","screenRect","pixelToViewBox","pixelSize","measureText","font","useCache","ascent","descent","cacheKey","cache","cached","_transformTextMetrics","ctx","metrics","result","actualBoundingBoxAscent","actualBoundingBoxDescent","actualLeft","actualBoundingBoxLeft","actualRight","actualBoundingBoxRight","_pixelWidth","_pixelHeight","_pixelAscent","_pixelDescent","set","transformInfo","transformed","original","scaleInfo","measureMultilineText","lineHeight","lines","lineMetrics","line","maxWidth","fontSize","_parseFontSize","adjustedFontSize","adjustedLineHeight","_transformApplied","_adjustedFontSize","getTextBoundingBox","textAnchor","dominantBaseline","left","top","bbox","right","bottom","centerX","centerY","substring","inputPosition","hasContainer","getTextAttachmentPoints","padding","center","topLeft","topRight","bottomLeft","bottomRight","topPadded","bottomPadded","leftPadded","rightPadded","parseFloat","buildFontString","textStyle","fontStyle","fontWeight","fontFamily","resolveFontFamily","computed","buildMeasurementFontString","adjustedPx","screenPxPerViewBoxUnit","clearTextMeasureCache","clear","getTextMeasureCacheStats","size","parseGradientConfig","gradientConfig","colors","stops","color","offset","color1","color2","x1","y1","x2","y2","cx","cy","parsePatternConfig","patternConfig","dots","opacity","diagonal","grid","parseGlowConfig","glowConfig","blur","intensity","parseStandardTextStyles","font_size","font_family","font_weight","font_style","text_color","labelColor","label_color","valueColor","value_color","textAlign","text_align","verticalAlign","vertical_align","textShadow","parseTextShadowConfig","text_shadow","textStroke","parseTextStrokeConfig","text_stroke","line_height","letterSpacing","letter_spacing","parseStandardColorStyles","primaryColor","primary_color","backgroundColor","background_color","borderColor","border_color","hoverColor","hover_color","activeColor","active_color","focusColor","focus_color","disabledColor","disabled_color","successColor","success_color","warningColor","warning_color","errorColor","error_color","infoColor","info_color","parseStandardLayoutStyles","borderWidth","border_width","borderRadius","border_radius","borderStyle","border_style","parsePaddingConfig","margin","parseMarginConfig","visible","minWidth","min_width","max_width","minHeight","min_height","maxHeight","max_height","parseStandardInteractionStyles","hoverEnabled","hover_enabled","hoverScale","hover_scale","hoverOpacity","hover_opacity","hoverTransition","hover_transition","clickable","activeScale","active_scale","focusEnabled","focus_enabled","focusOutline","focus_outline","cursor","parseStandardAnimationStyles","animatable","transition","transitionDelay","transition_delay","transitionDuration","transition_duration","transitionTimingFunction","transition_timing_function","animationDuration","animation_duration","animationTimingFunction","animation_timing_function","animationDelay","animation_delay","animationIterationCount","animation_iteration_count","animationDirection","animation_direction","animationFillMode","animation_fill_mode","cascadeSpeed","cascade_speed","cascadeDirection","cascade_direction","revealAnimation","reveal_animation","pulseOnChange","pulse_on_change","parseAllStandardStyles","layout","interaction","animation","gradient","pattern","glow","shadow","parseShadowConfig","parseBlurConfig","shadowConfig","offsetX","offset_x","offsetY","offset_y","strokeConfig","vertical","horizontal","applyStandardTextStyles","textStyles","applyStandardLayoutStyles","layoutStyles","createTextShadowCSS","createAnimationDataAttributes","animationStyles","blurConfig","amount","createGradientDefinition","stop","getLinearGradientCoords","directions","createPatternDefinition","patternContent","createGlowFilter","createShadowFilter","createBlurFilter","createLcarsBracket","side","bracketWidth","cornerRadius","strokeWidth","pathData","createMarkerDefinition","marker","getMarkerSize","markerContent","refX","refY","rotate","small","medium","large","xlarge","escapeXml","generateId","prefix","suffix","random","parseColor","tempElement","body","appendChild","computedColor","removeChild","rgbMatch","rgb","rgbToHex","hsl","rgbToHsl","min","getContrastColor","interpolateColor","factor","c1","c2","createAnimationAttributes","animationConfig","toLowerCase","animation_ref","animationRef","ref","sanitizeStyles","sanitized","validators","isValidColor","isValidOpacity","isValidNumber","stroke","fill","isValidString","validator","camelToKebab","test","num","isFinite","str","getDomTextBBox","groupEl","textEl","bb","getBBox","StatusGridRenderer","gradientCache","patternCache","filterCache","render","overlay","renderStatusGrid","finalStyle","gridStyle","_resolveStatusGridStyles","animationAttributes","_prepareAnimationAttributes","cells","_resolveCellConfigurations","_renderEnhancedStatusGrid","_renderFallbackStatusGrid","overlayId","standardStyles","columns","cell_width","cellWidth","cell_height","cellHeight","cell_gap","cellGap","cell_color","cell_opacity","cell_radius","cell_border","cellBorder","show_labels","show_values","status_mode","statusMode","status_ranges","_parseStatusRanges","statusRanges","unknown_color","show_grid_lines","showGridLines","grid_line_color","gridLineColor","grid_line_opacity","gridLineOpacity","bracket_style","bracketStyle","bracket_color","bracketColor","status_indicator","statusIndicator","lcars_corners","lcarsCorners","update_throttle","updateThrottle","features","range","Infinity","gridAttributes","cellAttributes","hasAnimations","animationDataAttrs","gap","gridMarkup","cell","cellX","col","cellY","cellColor","_determineCellColor","labelX","labelY","_escapeXml","valueX","valueY","data","_resolveCellContent","cellContent","cellId","hasContent","hasRawContent","hasLabel","rawContent","resolvedContent","cellsConfig","raw","hasCells","cellCount","cellsData","checkedSources","cellConfig","floor","timestamp","lastUpdate","processedCell","_resolveCellContentForInitialRender","totalCells","fromCharCode","updateCellsWithData","newDataSourceData","_originalContent","_processConditionalWithDataSourceMixin","safeContent","_extractValueFromTemplate","_isConditional","numericValue","conditionalTemplate","updateDataSourceData","templateMatch","expression","conditionMatch","leftPath","rightValue","trueValue","falseValue","dataSourceTemplate","resolvedValue","_extractValueFromUpdateData","leftVal","rightVal","finalValue","updateData","pathParts","TextOverlayRenderer","svgContainer","instance","container","renderText","_resolveTextStyles","host","cs","px","textContent","_resolveTextContent","_cachedContent","measure","_measureTextBlock","svgParts","_buildDefinitions","_buildMainText","_buildTextDecorations","_buildEffects","_renderFallbackText","text_anchor","dominant_baseline","alignmentBaseline","alignment_baseline","wordSpacing","word_spacing","textDecoration","text_decoration","visibility","stroke_width","strokeOpacity","stroke_opacity","strokeLinecap","stroke_linecap","strokeLinejoin","stroke_linejoin","strokeDasharray","stroke_dasharray","strokeDashoffset","stroke_dashoffset","multiline","textWrapping","text_wrapping","pulseSpeed","pulse_speed","fadeSpeed","fade_speed","typewriterSpeed","typewriter_speed","status_indicator_position","statusIndicatorPosition","highlight","dsManager","_processEnhancedTemplateStrings","defs","_createGradientDefinition","_createPatternDefinition","_createGlowFilter","_createShadowFilter","_createBlurFilter","_buildMultilineText","_applyTextAttributes","textAttributes","escapedText","tspanElements","dy","escapedLine","filters","decorations","_buildBrackets","_buildHighlight","_buildStatusIndicator","multilineMetrics","leftX","rightX","topY","bottomY","highlight_opacity","indicatorSize","statusColor","containerTag","hasSvg","textMetrics","containerType","indicatorX","indicatorY","pixelPadding","gradientId","patternId","patternUnits","filterId","updateTextStyle","newStyle","getCapabilities","gradients","patterns","effects","animations","advancedTypography","strokeText","advanced","getAttachmentPoints","computeAttachmentPoints","points","mm","_resolveTextContentWithData","_processTemplateWithData","templateString","pi","enabled","Error","inspect","routing","invalidate","scope","__msdScenarios","targetLine","ensureRound","lineId","ov","getResolvedModel","overlays","find","corner_style","corner_radius","scenarios","arc_presence","res","ok","meta","arc","count","details","dSample","radius_clamp","trimPx","arc_cache_reuse","first","cache_hit","firstHit","secondHit","arcCount","miter_fallback","origStyle","hasArcMeta","api","list","run","runAll","allOk","every","arcs","info","scenarioPreferImprovesCost","origChannels","route_channels","origMode","route_channel_mode","base","preferred","cost","baseCost","preferCost","scenarioAvoidIncreasesCost","prefer","avoid","avoidCost","scenarioForcePenalty","forced","channel","forcedOutside","coveragePct","scenarioPreferShapingCoverage","save","channels","mode","modeFull","route_mode_full","setAnchor","anchorId","anchor","rm","coverageBefore","coverageAfter","prefer_improves_cost","avoid_increases_cost","force_penalty_or_full_coverage","prefer_shaping_coverage","force_downgrade_or_full","chan","shaping","downgraded","channel_acceptance","force","requirePipeline","getModel","lastRenderModel","findOverlay","listOverlays","grid_vs_manhattan","man","strategy","gridStrategy","manStrategy","avoid_creates_bend","targetId","before","originalAvoid","after","bends","bendsBefore","bendsAfter","mode_hint_yx","route_mode","yx","basePts","pts","yxPts","baseHorizontalFirst","yxVerticalFirst","clearance_shift","router","orig","clearance","raised","raisedCost","anchor_move","model","moved","fallback_impossible_grid","originalComputeGrid","_computeGrid","req","results","summaryOk","withMode","fn","smart_vs_grid_cost","smart","gridCost","smartCost","smart_refinement_attempt","smartMeta","detoursTried","smart_penalty_reduction","baseSmart","penaltyAfter","penaltyBefore","smart_cache_behavior","setMode","ensureBaseline","smoothing_increases_points","smoothing_mode","smoothing_iterations","sm","smooth","smoothPts","smoothing_cache_hit","smoothing_disabled_no_meta","hasSmoothMeta","smoothing_invalid_mode_fallback","smoothing","waitForElement","root","timeout","Promise","resolve","reject","found","observer","MutationObserver","el","disconnect","observe","childList","subtree","async","waitForElements","targets","items","Element","selectors","sel","allNow","querySelectorAll","animateWithRoot","scopeId","animOptions","elements","element","anim","scopes","scopeObj","anime","addAnimation","animateElement","debug","add","params","duration","easing","state_resolver","styleHelpers","resolveStateStyles","resolvedStyles","applyPresets","presetFn","morph_to_selector","morphTarget","animejs","morphTo","_cssAnimation","createTimeline","timelineConfig","timeline","step","vars","createTimelines","timelinesConfig","overlayConfigs","stylePresets","timelines","resolveAll","resolveAllDynamicValues","timelineName","entries","steps","timelineGlobals","resolvedGlobals","mergedParams","resolveStatePreset","overrides","transformOrigin","transformBox","__timeline","preset","deep","descendants","apply_to","animeParams","applyToDescendants","immediateKeys","immediateSet","userOnBegin","onBegin","nodes","utils","prop","val","autoplay","types","presetList","animPresets","draw","drawable","createDrawable","loop","alternate","drawCfg","drawValues","pulse","pulseCfg","maxScale","max_scale","minOpacity","min_opacity","scale","cssText","blink","max_opacity","fade","motionpath","tracerCfg","tracer","msg","pathSelector","path_selector","pathEl","catch","errorMsg","baseId","hasUsablePathD","pathLengthOk","getTotalLength","isPending","cleanupArtifacts","svgRoot","ownerSVGElement","closest","priorTracer","priorTrail","parentNode","trailPath","tracerNode","pathMutationObserver","alive","buildTrail","trailOpt","trail","cloneNode","sw","insertBefore","nextSibling","trailVars","buildTracer","tid","existing","getElementById","tracerMarkup","shape","attrs","temp","createElementNS","innerHTML","firstElementChild","bindTracerAnimation","translateX","translateY","createMotionPath","exclude","merged","__cblcars_motion","pause","rebindAll","reason","removeAttribute","initArtifacts","waitMaxMs","wait_max_ms","pollInterval","startTime","performance","waitForReady","tick","pending","usable","muts","needs","attributeName","attributeFilter","pathId","reattachPoll","SVGPathElement","__cblcars_motionpath_cleanup","march","dashArray","dashLength","gapLength","linecap","cycleLength","durationSec","reversed","animId","dataset","marchAnimId","offsetTarget","loopValue","iterationCount","targetDoc","getRootNode","isInShadowDOM","animationName","keyframesStr","effectiveDuration","playbackRate","sheet","marchAnimations","CSSStyleSheet","insertRule","cssRules","fallbackStyleInjection","styleId","styleEl","head","glowCfg","blurMin","blur_min","blurMax","blur_max","opacityMin","opacity_min","opacityMax","opacity_max","glowState","onUpdate","shimmer","strobe","cascade","delay","stagger","ripple","flicker","ignoreKeys","allParams","propsToSet","animeSetWorked","cblcarsGlobalLogLevel","cblcarsSetGlobalLogLevel","level","cblcarsLog","cblcarsGetGlobalLogLevel","baseLogger","args","levels","currentLevelIndex","levelStyles","default","logMessage","cblcarsLogBanner","url","baseString","spacesNeeded","spaces","repeat","paddedUrl","setGlobalLogLevel","getGlobalLogLevel","drawLine","attrsToString","styleToString","drawPolyline","pt","drawPath","drawText","drawCircle","drawRect","globalThis","trustedTypes","createPolicy","createHTML","createComment","Symbol","iterator","RegExp","_$litType$","strings","for","WeakMap","createTreeWalker","lastIndex","exec","currentNode","firstChild","replaceWith","childNodes","nextNode","nodeType","hasAttributes","getAttributeNames","ctor","emptyScript","append","_$Co","_$Cl","_$litDirective$","_$AO","_$AT","_$AS","_$AV","_$AN","_$AD","_$AM","_$AU","creationScope","importNode","_$AI","_$Cv","_$AH","_$AA","_$AB","isConnected","startNode","endNode","_$AR","createTextNode","_$AC","_$AP","remove","setConnected","toggleAttribute","capture","once","passive","removeEventListener","addEventListener","handleEvent","litHtmlPolyfillSupport","litHtmlVersions","renderBefore","_$litPart$","_$Ct","_$Ci","update","it","directiveName","_t","resultType","ShadowRoot","nativeShadow","Document","_$cssResult$","replaceSync","litNonce","is","getOwnPropertyDescriptor","getOwnPropertyNames","getOwnPropertySymbols","getPrototypeOf","reactiveElementPolyfillSupport","toAttribute","fromAttribute","parse","converter","reflect","useDefault","hasChanged","metadata","litPropertyMetadata","HTMLElement","addInitializer","_$Ei","observedAttributes","finalize","_$Eh","createProperty","create","wrapped","elementProperties","noAccessor","getPropertyDescriptor","configurable","enumerable","getPropertyOptions","finalized","properties","_$Eu","elementStyles","finalizeStyles","flat","reverse","unshift","_$Ep","isUpdatePending","hasUpdated","_$Em","_$Ev","_$ES","enableUpdating","_$AL","_$E_","addController","_$EO","renderRoot","hostConnected","removeController","delete","createRenderRoot","attachShadow","shadowRootOptions","connectedCallback","disconnectedCallback","hostDisconnected","attributeChangedCallback","_$AK","_$ET","_$Ej","_$EP","_$Eq","scheduleUpdate","performUpdate","shouldUpdate","willUpdate","hostUpdate","_$EM","_$AE","hostUpdated","firstUpdated","updateComplete","getUpdateComplete","ReactiveElement","reactiveElementVersions","renderOptions","_$Do","_$litElement$","litElementHydrateSupport","litElementPolyfillSupport","litElementVersions","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__","definition","toStringTag","isBrowser","win","doc","compositionTypes","blend","isRegisteredTargetSymbol","isDomSymbol","isSvgSymbol","transformsSymbol","morphPointsSymbol","proxyTargetSymbol","minValue","maxValue","emptyString","shortTransforms","validTransforms","transformsFragmentStrings","noop","hexTestRgx","rgbExecRgx","rgbaExecRgx","hslExecRgx","hslaExecRgx","digitWithExponentRgx","unitsExecRgx","lowerCaseRgx","transformsExecRgx","relativeValuesExecRgx","defaults","keyframes","playbackEase","frameRate","loopDelay","ease","composition","modifier","onBeforeUpdate","onLoop","onPause","onComplete","onRender","globals","timeScale","tickThreshold","globalVersions","engine","AnimeJS","stringStartsWith","sub","isArr","isObj","isNum","isStr","isFnc","isUnd","isNil","isSvg","SVGElement","isHex","isRgb","isHsl","isKey","parseNumber","sqrt","sin","cos","exp","ceil","asin","atan2","PI","_round","clamp","powCache","decimalLength","snap","increment","cv","interpolate","start","end","progress","clampInfinity","normalizeTime","cloneArray","mergeObjects","o1","o2","o1p","forEachChildren","parent","callback","prevProp","nextProp","next","_head","adjustedNextProp","_tail","currentNext","child","prev","addChild","sortMethod","Clock","initTime","deltaTime","_currentTime","_elapsedTime","_startTime","_lastTime","_scheduledTime","_frameDuration","_fps","_speed","_hasChildren","fps","previousFrameDuration","fr","frameDuration","speed","pbr","requestTick","time","scheduledTime","elapsedTime","frameDelta","computeDeltaTime","delta","tickable","muteCallbacks","internalRender","tickMode","completed","iterationDuration","_currentIteration","_loopDelay","_reversed","_alternate","tickableDelay","_delay","tickablePrevAbsoluteTime","tickableEndTime","tickableAbsoluteTime","tickablePrevTime","tickableCurrentTime","isCurrentTimeAboveZero","isCurrentTimeEqualOrAboveDuration","isSetter","forcedTick","isOdd","iterationElapsedTime","hasRendered","currentIteration","isReversed","_ease","iterationTime","isRunningBackwards","backwards","_iterationTime","began","forcedRender","absoluteTime","_offset","tweenTarget","tweenStyle","tweenTargetTransforms","tweenTargetTransformsProperties","tween","tweenTransformsNeedUpdate","tweenComposition","_composition","tweenCurrentTime","tweenChangeDuration","_changeDuration","tweenAbsEndTime","_absoluteStartTime","tweenNextRep","_nextRep","tweenPrevRep","_prevRep","tweenHasComposition","_isOverridden","_isOverlapped","tweenNewTime","tweenProgress","_updateDuration","tweenModifier","_modifier","tweenValueType","_valueType","tweenType","_tweenType","tweenIsObject","tweenIsNumber","tweenPrecision","number","_fromNumber","_toNumber","_unit","_fromNumbers","tn","_toNumbers","ns","_numbers","_strings","_number","_value","tweenProperty","property","setProperty","_renderTransforms","transform","_next","paused","_resolve","tl","tlIsRunningBackwards","tlChildrenTime","tlCildrenTickTime","tlChildrenHasRendered","tlChildrenHaveCompleted","tlIterationDuration","childDuration","childStartTime","childTime","childTickMode","additive","engineTickMethod","requestAnimationFrame","setImmediate","engineCancelMethod","cancelAnimationFrame","clearImmediate","Engine","useDefaultMainLoop","pauseOnDocumentHidden","hidden","reqId","engineSpeed","engineFps","activeTickable","nextTickable","_running","_cancelled","cancel","wake","tickEngine","killEngine","resume","resetTime","timeUnit","isSecond","newScale","scaleFactor","getNodeList","NodeList","HTMLCollection","parseTargets","flattened","parsed","nodeList","jl","subItem","isDuplicate","kl","registerTargets","parsedTargetsArray","parsedTargetsLength","isSvgType","getPath","$parsedSvg","getPathPoint","$path","lookup","getPointAtLength","getPathProgess","pathProperty","$el","totalLength","inSvg","ctm","getCTM","p0","p1","cssReservedProperties","path2","$path1","$path2","isPath","separator","previousPoints","v1","v2","length1","length2","maxPoints","pointOnPath1","pointOnPath2","pathLength","computedStyles","strokeLineCap","$scalled","vectorEffect","currentCap","proxy","Proxy","getScaleFactor","os","d1","d2","newCap","Reflect","createDrawableProxy","hue2rgb","setValue","defaultValue","getFunctionValue","total","store","func","getTweenType","propertyName","elParentNode","isValidSVGAttribute","getCSSValue","propName","animationInlineStyles","inlineStyles","getOriginalAnimatableValue","inlineTransforms","inlinedStylesPropertyValue","cachedTransforms","inlinePropertyName","inlinePropertyValue","parseInlineTransforms","trimStart","getRelativeValue","decomposeRawValue","rawValue","targetObject","unitMatch","isCol","colorString","rgbValue","rgba","rgbToRgba","hexValue","hexLength","isShort","hexToRgba","hslValue","hsla","hslToRgba","matchedNumbers","decomposeTweenValue","decomposedOriginalValue","lookups","_rep","_add","getTweenSiblings","lookupMap","targetLookup","addTweenSortMethod","overrideTween","composeTween","siblings","tweenCompositionType","tweenAbsStartTime","prevSibling","prevParent","prevAbsEndTime","prevPrevSibling","absoluteUpdateStartTime","prevChangeStartTime","prevTLOffset","pausePrevParentAnimation","prevParentTL","pausePrevParentTL","additiveTweenSiblings","additiveAnimation","propertyAnimation","tweens","lookupTween","valueType","additiveValues","additiveValue","_prevAdd","addAdditiveAnimation","_prev","toNumber","toNumbers","removeTweenSliblings","tweenReplaceSiblings","addTweensLookup","addTargetProps","shouldClean","resetTimerProperties","reviveTimer","timerId","Timer","parameters","parentPosition","revertibles","timerInitTime","timerDefaults","timerDelay","timerDuration","timerLoop","timerLoopDelay","timerIterationCount","offsetPosition","_autoplay","_reverse","cancelled","reset","play","currentTime","seek","iterationCurrentTime","iterationProgress","init","linked","link","restart","isPaused","iterations","stretch","newDuration","currentDuration","normlizedDuration","revert","ap","complete","onResolve","createTimer","calcBezier","aT","aA1","aA2","cubicBezier","mX1","mY1","mX2","mY2","aX","currentX","currentT","aA","aB","binarySubdivide","fromStart","roundMethod","linear","argsLength","totalPoints","firstArg","lastArg","xPoints","yPoints","arg","splitValue","percent","prevX","prevY","irregular","randomness","previousValue","spacing","randomValue","halfPI","doublePI","easeInPower","easeInFunctions","Quad","Cubic","Quart","Quint","Sine","Circ","Expo","Bounce","pow2","Back","overshoot","Elastic","amplitude","period","easeTypes","in","easeIn","out","inOut","outIn","parseEaseString","string","easesFunctions","easesLookups","parsedFn","eases","easeType","JSEasesLookups","parseEasings","propertyNamesCache","sanitizePropertyName","cachedPropertyName","lowerCaseName","angleUnitsMap","convertedValuesCache","convertValueUnit","decomposedValue","currentUnit","currentNumber","cachedKey","convertedValue","baseline","tempEl","parentEl","elStyle","currentUnitWidth","offsetWidth","cleanInlineStyles","renderable","targetStyle","originalInlinedValue","_inlineStyles","removeProperty","fromTargetObject","toTargetObject","toFunctionStore","keyframesTargetArray","fastSetValuesArray","keyObjectTarget","tweenId","JSAnimation","fastSet","parsedTargets","targetsLength","kfParams","propertyNames","concat","propArray","newKey","keyValue","totalDuration","sort","prevKey","keyObj","durProgress","prevEase","currentEase","shift","generateKeyframes","animDefaults","animaPlaybackEase","animEase","hasSpring","tEasing","tDuration","tDelay","tModifier","tComposition","animInlineStyles","absoluteOffsetTime","NaN","iterationDelay","animationAnimationLength","shouldTriggerRender","targetIndex","ti","lastTransformGroupIndex","lastTransformGroupLength","propValue","isPropValueArray","arrayLength","isNotObjectValue","prevTween","firstTweenChangeStartTime","lastTweenChangeEndTime","tweenIndex","keyframe","computedToValue","tweenToValue","tweenFromValue","keyEasing","tweenEasing","tweenDuration","tweenDelay","computedComposition","hasFromvalue","hasToValue","isFromToArray","isFromToValue","tweenStartTime","absoluteStartTime","complexValue","notComplexValue","unitValue","notUnitValue","notColorValue","valueToConvert","longestValue","shortestValue","tweenUpdateDuration","_func","_nextAdd","additiveTween","refresh","ogValue","animate","easingToLinear","samples","WAAPIEasesLookups","WAAPIeases","parseWAAPIEasing","parsedEase","transformsShorthands","commonDefaultPXProperties","validIndividualTransforms","axis","transformsPropertiesRegistered","CSS","WAAPIAnimationsLookups","removeWAAPIAnimation","nextLookup","matchTarget","matchProperty","matchParent","commitStyles","lookupParent","_completed","addWAAPIAnimation","animTotalDuration","controlAnimation","handleRemove","onremove","onfinish","normalizeTweenValue","parseIndividualTweenValue","tweenValue","computedTo","WAAPIAnimation","isSkew","isScale","isRotate","isTranslate","isAngle","syntax","registerProperty","inherits","initialValue","spring","scroll","hasIndividualTransforms","composite","tweenParams","propertyValue","individualTransformProperty","parsedPropertyValue","tweenOptions","tweenOptionsEase","tweenOptionsSpring","transforms","cb","waapi","convertEase","sync","getTargetValue","targetSelector","normalizePropName","originalValue","setTargetValues","removeTargetsFromAnimation","targetsArray","tweensMatchesTargets","tweenName","waapiAnimation","removeMatches","childDur","mapRange","inLow","inHigh","outLow","outHigh","lerp","dt","ticker","chain","__","nextArgs","nextResult","makeChainable","curry","randomPick","shuffle","wrap","roundPad","padStart","padString","padEnd","degToRad","degrees","radToDeg","radians","parseTimelinePosition","timePosition","tlDuration","timePosStr","tlLabels","labels","hasLabels","prevOffset","goToPrevAnimationOffset","prevAnimation","getPrevChildOffset","hasSibling","matchedRelativeOperator","fullOperator","labelOffset","parsedOffset","parsedNumericalOffset","addTlChild","childParams","adjustedPosition","tlChild","getTimelineTotalDuration","Timeline","defaultsParams","globalDefaults","tlPlaybackEase","a1","a2","a3","isAnim","isTimer","staggeredPosition","parsedLength","staggeredChildParams","synced","effect","getTiming","labelName","Animatable","globalParams","paramValue","isObjValue","propParams","animParams","numbers","createAnimatable","Spring","timeStep","restThreshold","restDuration","maxDuration","maxRestSteps","maxIterations","mass","stiffness","damping","velocity","w0","zeta","wd","solverDuration","compute","solve","solverTime","restSteps","createSpring","preventDefault","DOMProxy","zIndex","parentElement","classList","Transforms","point","DOMPoint","inversedMatrix","getMatrix","inverse","normalizePoint","matrixTransform","traverseUp","matrix","DOMMatrix","transformValue","elMatrix","preMultiplySelf","ct","parseDraggableFunctionParameter","draggable","Draggable","paramX","paramY","trigger","releaseEase","customEase","xProp","mapTo","yProp","containerArray","$container","useWin","$scrollContainer","$target","$trigger","fixed","isFinePointer","containerPadding","containerFriction","releaseContainerFriction","snapX","snapY","scrollSpeed","scrollThreshold","dragSpeed","maxVelocity","minVelocity","velocityMultiplier","releaseXSpring","releaseMass","releaseStiffness","releaseDamping","releaseYSpring","outQuint","hasReleaseSpring","onGrab","onDrag","onRelease","onSettle","onSnap","onResize","onAfterResize","disabled","animatableParams","paramXObject","animatableXParams","paramYObject","animatableYParams","destX","destY","deltaX","deltaY","coords","snapped","pointer","scrollView","dragArea","containerBounds","scrollBounds","targetBounds","velocityStack","velocityStackIndex","velocityTime","angle","cursorStyles","triggerStyles","bodyStyles","targetStyles","touchActionStyles","overshootCoords","overshootXTicker","overshootYTicker","updateTicker","manual","contained","grabbed","dragged","released","canScroll","initialized","activeProp","hasReleased","dx","computeVelocity","resizeTicker","resizeObserver","ResizeObserver","enable","prevTime","curTime","elapsed","vMul","minV","maxV","vi","setX","muteUpdateCallback","setY","progressX","progressY","updateScrollCoords","sx","scrollX","scrollLeft","sy","scrollY","scrollTop","cpt","cpr","cpb","cpl","threshold","updateBoundingValues","cx2","cy2","iw","innerWidth","ih","innerHeight","uw","scrollWidth","sh","scrollHeight","fx","transformContainerRect","containerOverflow","visibleOverflow","hiddenOverflow","targetRect","hiddenLeft","hiddenTop","hiddenRight","hiddenBottom","isOutOfBounds","bounds","bt","br","bl","obx","oby","cp","parsedCursorStyles","onHover","matchMedia","matches","daw","dah","csx","csy","nsw","nsh","csw","csh","swd","shd","st","sr","sb","sl","nx","ny","scrollBy","scrollTo","cr","cl","px1","py1","px2","py2","px3","py3","cf","nsx","nsy","scrollInView","inOutQuad","handleHover","animateInView","ob","disabledX","disabledY","dur","handleDown","$eTarget","stopPropagation","touches","changedTouches","eventX","clientX","eventY","clientY","handleMove","movedX","movedY","$parent","isAtTop","isAtBottom","canTouchScroll","overflowY","clientHeight","pointerEvents","handleUp","springX","springY","pv","pa","ds","bx","by","durationX","durationY","easeX","easeY","longestReleaseDuration","directionX","distanceX","directionY","distanceY","hasSnapped","touchAction","disable","createDraggable","Scope","rootParam","nativeElement","scopeDefaults","globalDefault","mediaQueries","constructors","revertConstructors","methods","mediaQueryLists","mq","_mq","execute","activeScope","activeRoot","activeDefaults","mqs","returned","revertConstructor","createScope","parseScrollObserverFunctionParameter","scroller","scrollContainers","ScrollContainer","winWidth","winHeight","prevScrollX","prevScrollY","backwardX","backwardY","scrollTicker","dataTimer","handleScroll","self","py","updateWindowBounds","refreshScrollObservers","wakeTicker","updateBounds","offsetHeight","getMaxViewHeight","marginLeft","marginRight","marginTop","marginBottom","elRect","_debug","removeDebug","unobserve","convertValueToPx","under","over","clampMin","clampMax","parseBoundValue","matchedOperator","splitter","splitted","valueAPx","valueBPx","getAnimationDomTarget","$linkedTarget","linkedTargets","scrollerIndex","debugColors","ScrollObserver","syncMode","isLinear","isEase","isSmooth","isMethods","syncMethods","biDirSync","scrollContainer","registerAndGetScrollContainer","enter","leave","syncEase","syncSmooth","onSyncEnter","onSyncLeave","onSyncEnterForward","onSyncLeaveForward","onSyncEnterBackward","onSyncLeaveBackward","onEnter","onLeave","onEnterForward","onLeaveForward","onEnterBackward","onLeaveBackward","onSyncComplete","reverted","isInView","forceEnter","hasEntered","offsets","offsetStart","offsetEnd","distance","prevProgress","debugStyles","$debug","_params","backward","isHori","$existingDebug","$thresholds","$triggers","containerWidth","containerHeight","offLeft","offTop","half","labelHeight","labelWidth","labelSize","gradientOffset","lineCSS","baseCSS","isView","isTail","isFirst","isOver","isFlip","$label","$text","dirProp","flipOffset","stickys","linkedTime","$offsetParent","isContainerStatic","isSticky","offsetLeft","offsetTop","offsetParent","targetSize","containerSize","maxScroll","enterTarget","leaveTarget","enterContainer","leaveContainer","parsedEnterTarget","parsedLeaveTarget","parsedEnterContainer","parsedLeaveContainer","scrollDelta","sticky","shouldSeek","isBefore","isAfter","isOnTheEdge","syncCompleted","lp","onScroll","hasEasing","staggerEase","fromFirst","fromCenter","fromLast","isRange","val1","val2","fromIndex","fromX","fromY","isNothing","subject","common","toArray","sequence","cycle","isNegativeZero","NEGATIVE_INFINITY","extend","sourceKeys","formatError","exception","compact","where","mark","column","snippet","YAMLException$1","captureStackTrace","stack","getLine","buffer","lineStart","lineEnd","maxLineLength","tail","maxHalfLength","pos","TYPE_CONSTRUCTOR_OPTIONS","YAML_NODE_KINDS","tag","kind","construct","instanceOf","predicate","represent","representName","defaultStyle","multi","styleAliases","alias","compileStyleAliases","compileList","schema","currentType","newIndex","previousType","previousIndex","Schema$1","implicit","explicit","type$1","loadKind","compiledImplicit","compiledExplicit","compiledTypeMap","scalar","mapping","fallback","collectType","compileMap","seq","failsafe","_null","object","canonical","lowercase","uppercase","camelcase","empty","bool","isHexCode","isOctCode","isDecCode","ch","hasDigits","charCodeAt","sign","binary","octal","decimal","hexadecimal","toUpperCase","YAML_FLOAT_PATTERN","SCIENTIFIC_WITHOUT_DOT","POSITIVE_INFINITY","json","core","YAML_DATE_REGEXP","YAML_TIMESTAMP_REGEXP","date","fraction","UTC","setTime","merge","BASE64_MAP","code","idx","bitlen","charAt","tailbits","input","bits","Uint8Array","_hasOwnProperty$3","_toString$2","omap","pair","pairKey","pairHasKey","objectKeys","_toString$1","pairs","_hasOwnProperty$2","_default","_hasOwnProperty$1","PATTERN_NON_PRINTABLE","PATTERN_NON_ASCII_LINE_BREAKS","PATTERN_FLOW_INDICATORS","PATTERN_TAG_HANDLE","PATTERN_TAG_URI","_class","is_EOL","is_WHITE_SPACE","is_WS_OR_EOL","is_FLOW_INDICATOR","fromHexCode","lc","escapedHexLen","fromDecimalCode","simpleEscapeSequence","charFromCodepoint","simpleEscapeCheck","simpleEscapeMap","State$1","filename","onWarning","legacy","listener","implicitTypes","typeMap","lineIndent","firstTabInLine","documents","generateError","maxLength","indent","linesBefore","linesAfter","lineStarts","lineEnds","foundLineNo","lineNoLength","throwError","throwWarning","directiveHandlers","YAML","major","minor","checkLineBreaks","TAG","handle","tagMap","decodeURIComponent","err","captureSegment","checkJson","_position","_length","_character","_result","mergeMappings","destination","overridableKeys","quantity","storeMappingPair","keyTag","keyNode","valueNode","startLine","startLineStart","startPos","writable","readLineBreak","skipSeparationSpace","allowComments","checkIndent","lineBreaks","testDocumentSeparator","writeFoldedLines","readBlockSequence","nodeIndent","_line","_tag","_anchor","detected","anchorMap","composeNode","readTagProperty","tagHandle","isVerbatim","isNamed","readAnchorProperty","parentIndent","nodeContext","allowToSeek","allowCompact","allowBlockStyles","allowBlockScalars","allowBlockCollections","typeIndex","typeQuantity","typeList","flowIndent","blockIndent","indentStatus","atNewLine","following","_keyLine","_keyLineStart","_keyPos","atExplicitKey","readBlockMapping","_lineStart","_pos","terminator","isPair","isExplicitPair","isMapping","readNext","readFlowCollection","captureStart","folding","tmp","chomping","didReadContent","detectedIndent","textIndent","emptyLines","atMoreIndented","readBlockScalar","captureEnd","readSingleQuotedScalar","hexResult","readDoubleQuotedScalar","readAlias","withinFlowCollection","hasPendingContent","_lineIndent","_kind","readPlainScalar","readDocument","directiveArgs","documentStart","hasDirectives","loadDocuments","nullpos","loader","loadAll","load","_toString","_hasOwnProperty","CHAR_BOM","ESCAPE_SEQUENCES","DEPRECATED_BOOLEANS_SYNTAX","DEPRECATED_BASE60_SYNTAX","encodeHex","character","State","noArrayIndent","skipInvalid","flowLevel","styleMap","compileStyleMap","sortKeys","lineWidth","noRefs","noCompatMode","condenseFlow","quotingType","forceQuotes","replacer","explicitTypes","duplicates","usedDuplicates","indentString","ind","generateNextLine","isWhitespace","isPrintable","isNsCharOrWhitespace","isPlainSafe","inblock","cIsNsCharOrWhitespace","cIsNsChar","codePointAt","needIndentIndicator","writeScalar","iskey","dump","singleLineOnly","indentPerLevel","testAmbiguousType","char","prevChar","hasLineBreak","hasFoldableLine","shouldTrackWidth","previousLineBreak","plain","isPlainSafeFirst","isPlainSafeLast","chooseScalarStyle","testImplicitResolving","blockHeader","dropEndingNewline","moreIndented","nextLF","lineRe","foldLine","prevMoreIndented","foldString","escapeSeq","escapeString","indentIndicator","clip","breakRe","curr","writeBlockSequence","writeNode","detectType","block","isblockseq","tagStr","duplicateIndex","duplicate","objectOrArray","objectKey","objectValue","explicitPair","pairBuffer","objectKeyList","writeBlockMapping","writeFlowMapping","writeFlowSequence","encodeURI","getDuplicateReferences","objects","duplicatesIndexes","inspectNode","renamed","Type","Schema","FAILSAFE_SCHEMA","JSON_SCHEMA","CORE_SCHEMA","DEFAULT_SCHEMA","YAMLException","float","null","int","safeLoad","safeLoadAll","safeDump","jsyaml","readYamlFile","response","fetch","fetchYAML","ensureSVGCache","msd","svg_templates","loadSVGToCache","status","statusText","svgText","getSVGFromCache","CBLCARSCardEditor","_formControls","_cardType","cardType","_initializationPromise","_initialize","unsafeCSS","mergeUserStyles","formContent","loadFont","fontInput","_loadedFonts","fontList","fontName","href","rel","fontKey","decorate","_$El","_$Eg","splice","_$EC","_$Ek","_$Cp","tt","et","nt","rt","descriptor","finisher","placement","originalKey","initializer","at","ot","lt","HTMLSlotElement","assignedElements","ht","startPress","endPress","startFocus","endFocus","startHover","endHover","ft","mt","gt","ut","vt","yt","wt","$t","ArrayBuffer","flags","valueOf","At","navigator","maxTouchPoints","msMaxTouchPoints","xt","holdTime","held","isRepeating","repeatCount","primary","stopAnimation","repeatTimeout","clearInterval","bind","actionHandler","handleEnter","cancelBubble","returnValue","hasHold","startAnimation","setInterval","repeatLimit","hasDoubleClick","dblClickTimeout","keyCode","currentTarget","unbounded","define","St","kt","Et","Ot","Tt","Ct","Mt","jt","Ht","Dt","Rt","Nt","Pt","zt","Lt","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","goldenrod","gold","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavenderblush","lavender","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","Ft","Vt","Ut","Bt","CSS_UNIT","hsv","hsva","hex3","hex6","hex4","hex8","Wt","qt","originalInput","It","roundA","gradientType","isValid","isDark","getBrightness","isLight","toRgb","getAlpha","setAlpha","isMonochrome","toHsl","toHsv","toHsvString","toHslString","toHex","toHexString","toHex8","toHex8String","toHexShortString","toRgbString","toPercentageRgb","toPercentageRgbString","toName","clone","lighten","brighten","darken","tint","mix","shade","desaturate","saturate","greyscale","spin","analogous","complement","monochromatic","splitcomplement","onBackground","triad","polyad","tetrad","equals","Zt","Gt","Yt","Kt","Jt","Xt","Qt","local","server","DMY","MDY","YMD","monday","tuesday","wednesday","thursday","friday","saturday","sunday","display_precision","log10","$e","Ae","Ee","ms","Te","Ce","Me","lastThis","lastArgs","lastResult","je","timeZone","time_zone","He","Re","Ne","date_format","formatToParts","Pe","ze","Le","Ie","Fe","Ve","Ue","Be","We","qe","Ze","Ge","Ye","Ke","Je","Xe","Qe","supported_features","ii","ni","Oe","units","numeric_precision","show_units","in_progress","ei","latest_version","skipped_version","translation_key","platform","ri","si","ai","oi","li","ci","hi","ui","di","fi","propertyIsEnumerable","mi","gi","_keys","_values","_i","__proto__","bi","yi","wi","$i","Ai","isStrict","realm","global","ignoreCase","unicode","Blob","Buffer","isBuffer","allocUnsafe","copy","WeakSet","strict","xi","ki","Ei","Si","Oi","cardHelpers","Ti","loadCardHelpers","Ci","_cards","_cardsConfig","_entities","_initialSetupComplete","_rippleHandlers","_ripple","_doIHaveEverything","_finishSetup","_clearInterval","_startTimerCountdown","_evaluateVariablesSkipError","_evaledVariables","variables","_objectEvalTemplate","_getTemplateOrValue","_stateObj","triggers_update","_expandTriggerGroups","_hasTemplate","_startInterval","_createCard","createCardElement","_cardHtml","origConfig","_interval","_calculateRemaining","_timeRemaining","_computeTimeDisplay","_getMatchingConfigState","_localize","localize","entities","_relativeTime","_getTemplateHelpers","formatDateTime","formatShortDateTimeWithYear","formatShortDateTime","formatDateTimeWithSeconds","formatDateTimeNumeric","relativeTime","formatTime","formatTimeWithSeconds","formatTimeWeekday","formatTime24h","formatDateWeekdayDay","formatDate","formatDateNumeric","formatDateShort","formatDateMonthYear","formatDateMonth","formatDateYear","formatDateWeekday","formatDateWeekdayShort","_evalTemplate","_getColorForLightEntity","rgb_color","color_temp","min_mireds","max_mireds","brightness","_buildCssColorAttribute","color_type","_buildIcon","show_icon","_buildEntityPicture","show_entity_picture","entity_picture","_buildStyleGeneric","_buildCustomStyleGeneric","custom_fields","_buildName","show_name","friendly_name","_buildStateString","show_state","_buildLastChanged","show_last_changed","_buildLabel","show_label","_buildCustomFields","do_not_eval","_unsafeHTMLorNot","_stopPropagation","_hasChildCards","_isClickable","_rotate","_blankCardColoredHtml","background","tooltip","aspect_ratio","extra_styles","_handleAction","handleRippleFocus","handleRippleBlur","handleRippleActivate","handleRippleDeactivate","repeat_limit","_buttonContent","_getLock","_handleUnlockType","unlock","state_display","_gridHtml","_getIconHtml","_buildLiveStream","show_live_stream","_configFromLLTemplates","template","cblcars_card_templates","group_expand","card_size","_loopGroup","_evalActions","_handleLock","username","createAttribute","setNamedItem","findSvgAnchors","svgContent","circleRegex","cxMatch","cyMatch","textRegex","xMatch","yMatch","groupRegex","getSvgContent","base_svg","svgKey","pop","getSvgViewBox","getSvgAspectRatio","stripMetaFields","cleaned","globalPerfTracker","counters","timings","sessionStart","addTiming","totalMs","timing","addCount","rate","counter","timeAsync","timeSync","getAll","sessionDuration","session","duration_ms","started_at","fromEntries","summary","getSummary","health","exportToCsv","minify","minifyData","minified","perfTime","perfTimeAsync","perfCount","debugNamespace","userConfig","layers","builtinPacks","use_packs","builtin","packName","pack","loadBuiltinPack","priority","external","externalResults","urls","retries","retryDelay","enableCaching","perfTracker","total_packs","successful","failed","retried","cached_hits","total_time_ms","packResult","loadSingleExternalPack","retryCount","_lastExternalPackPerf","loadExternalPacks","loadAllLayers","palettes","profiles","rules","data_sources","active_profiles","__provenance","merge_order","layer","processLayer","removals","collections","collection","removeIds","removeId","findIndex","removed","removal_source","applyRemovals","checksum","stable","crypto","subtle","TextEncoder","encode","hashBuffer","digest","hashArray","hashHex","hash","simpleHash","computeCanonicalChecksum","processSinglePass","config_overlays","config_rules","config_anchors","dbgPacks","packs","dbgSource","svg_bridge","svg_warp","_extracted_anchors","accent1","accent2","danger","externalPackCache","loadTime","lastError","attempt","attemptStart","race","fetchWithValidation","createTimeoutPromise","contentType","errorType","URL","headers","dataFields","field","validateExternalPackStructure","__msdPerf","export","existingIndex","cloned","structuredClone","origin_pack","overridden","override_layer","paletteName","tokens","tokenName","tokenExisted","current_value","previous_value","override_pack","override_history","last_modified_by","tokenCount","coordinates","existed","previousCoordinates","originType","determineAnchorOriginType","existingProvenance","origin_type","override_source","override_type","previous_coordinates","mergePacks","exportCollapsed","userMsd","_hudUserMsdConfig","validateCoordinateArray","issues","coord","errors","SparklineRenderer","pathCache","renderSparkline","dataResult","_getHistoricalDataForSparkline","sparklineStyle","_resolveSparklineStyles","_renderEnhancedSparkline","_renderEnhancedStatusIndicator","_renderFallbackSparkline","getHistoricalDataForSparkline","lineCap","line_cap","lineJoin","line_join","miterLimit","miter_limit","dash_array","dashOffset","dash_offset","smoothingMode","interpolation","path_precision","pathPrecision","fillOpacity","fill_opacity","fillGradient","_parseGradientConfig","fill_gradient","_parsePatternConfig","show_points","showPoints","point_size","pointSize","point_color","pointColor","show_last_value","showLastValue","valueFormat","_parseThresholds","zero_line","zeroLine","zero_line_color","zeroLineColor","min_value","max_value","auto_scale","_parseGlowConfig","_parseShadowConfig","_parseBlurConfig","bracket_width","bracket_gap","bracketGap","bracket_corner_radius","bracketCornerRadius","bracket_style_mode","bracketStyleMode","scan_line","scanLine","grid_lines","gridLines","grid_color","gridColor","grid_opacity","gridOpacity","grid_stroke_width","gridStrokeWidth","grid_horizontal_count","gridHorizontalCount","grid_vertical_count","gridVerticalCount","tracer_speed","tracerSpeed","decimation","max_points","_buildSparklineBackground","_buildGridLines","_buildThresholdLines","_buildZeroLine","_buildAreaFill","_buildMainSparklinePath","_buildDataPoints","_buildValueLabel","_buildScanLine","valueRange","thresholdLines","dash","zeroY","processedData","_processDataForRendering","areaPath","_createSparklinePath","fillColor","pathAttributes","_calculateDataPointPositions","lastValue","formattedValue","_formatValue","styleMode","leftBracketPath","rightBracketPath","_buildRoundedBracketPath","_buildLcarsBracketPath","_buildSquareBracketPath","gapOrWidth","gapOrHeight","heightOrRadius","radiusOrHeight","radius","minRadius","cutSize","_createChaikinPath","_createConstrainedSmoothPath","_createBezierPath","_createSplinePath","_createSteppedPath","_createLinearPath","pathSegments","targetWidth","smoothedPoints","iteration","newPoints","p2","minX","maxX","currentWidth","cp1x","cp1y","lastPoint","splinePoints","p3","segments","u2","u3","f1","f2","f3","f4","cp2x","cp2y","next2","prevSlope","nextSlope","indicatorColor","indicatorText","isLoading","animationProps","bufferSize","historyReady","started","historyLoaded","stats","hasTransformations","hasAggregations","requestedDataKey","getEnhancedDataSourceData","bufferData","historicalData","availableSources","requestedSource","updateSparklineData","sparklineElement","sourceData","hasBuffer","currentStatus","elementFound","currentValue","_updateSparklineElementSynchronized","_upgradeStatusIndicatorToSparkline","_extractHistoricalData","_updateSparklinePathAndMarkers","_updateSparklineFeatures","pathElement","newPathData","dataPointsGroup","pointElements","pointElement","areaElement","valueLabelElement","thresholdGroup","thresholdLine","children","zeroLineElement","pathSmoothing","dataVisualization","styling","lcarsFeatures","enhancedValue","aggregationData","slope","availableTransformations","availableAggregations","generateSyntheticHistoricalData","extractHistoricalFromObject","syntheticValue","ratio","synthetic","basedOnRawData","variance","aggregationObject","debugSparklineUpdates","getStats","debugDataSource","dataSourceName","LineOverlayRenderer","routerCore","markerCache","textAttachmentPoints","setTextAttachmentPoints","anchor1","anchor2","attach_to","attachMeta","_computeTextAttachPoint","routeRequest","buildRouteRequest","pathResult","computePath","lineStyle","_resolveLineStyles","_buildMainPath","_buildMarkers","_renderFallbackLine","markerStart","_parseMarkerConfig","marker_start","markerMid","marker_mid","markerEnd","marker_end","flowSpeed","flow_speed","segment_colors","_parseSegmentColors","markerConfig","segmentConfig","segment","markerType","_createMarkerDefinition","_getLinearGradientCoords","markerId","_getMarkerSize","groupAttributes","updateLineStyle","markers","segmentColors","dashPatterns","origin","sidePref","attach_side","attachSide","gapRaw","attach_gap","attachment_gap","line_gap","basePoint","outward","attachPoint","_attachComputed","targetOverlay","sideChosen","AdvancedRenderer","mountEl","overlayElements","lastRenderArgs","lineRenderer","overlayElementCache","_lineDeps","resolvedModel","hasResolvedModel","overlayCount","anchorCount","hasViewBox","mountElExists","stackTrace","svgMarkup","overlayTypes","mountElTagName","mountElChildren","overlayGroup","_ensureOverlayGroup","tov","earlyTypes","svgMarkupAccum","processedCount","renderOverlay","_cacheElementsFrom","_dynamicAnchors","_buildDynamicOverlayAnchors","insertAdjacentHTML","attachTo","sparklines","_scheduleDeferredLineRefresh","_scheduleFontStabilization","dest","tap","basePt","_resolveOverlayAttachmentPoint","gapPt","_applyAttachGap","srcAnchor","_updateDynamicAnchorsForOverlays","changedIds","dep","attachGap","gapX","attach_gap_x","attachGapX","gapY","attach_gap_y","attachGapY","anchorsRef","pass","changedTargets","anyUnstable","recordedW","recordedH","diffW","diffH","newGroup","_reRenderSingleTextOverlay","bb2","_updateStatusIndicatorPosition","_updateTextAttachmentPointsFromDom","_rerenderDependentLines","morePassesAllowed","passes","changed","fontAPI","fonts","ready","lineOverlays","existingEl","newMarkup","newEl","finalStyleColor","finalStyleStatusIndicator","injectSvgContent","texts","updateOverlayData","hasSourceData","sourceDataKeys","hasCachedElement","overlayElement","updateTextOverlay","updateStatusGridWithTemplates","handleDataSourceUpdate","sourceId","destroy","changedSet","toRerender","oldGroup","markup","textBBox","circle","textElement","rulesEngine","newContent","updateTextDecorations","updateStatusGrid","updatedCells","gridElement","renderer","cellContentElement","oldContent","_hasTemplateContentEnhanced","_initializeEnhancedTemplateDetection","overlayUpdater","_hasTemplateContent","MsdDebugRenderer","debugLayer","anchorMarkers","boundingBoxes","routingOverlays","performanceOverlays","debugManager","unsubscribeDebug","_lastRenderContext","onChange","_scheduleRerender","setScale","opts","debugState","getSnapshot","svgElement","integrateWithAdvancedRenderer","renderAnchorMarkers","bounding_boxes","renderOverlayBounds","canRenderRouting","renderRoutingGuides","renderPerformanceOverlays","routeCount","routeInfo","routeOverlay","createRoutingOverlay","ownerDocument","waypoint","startPt","markerCount","createAnchorMarker","crosshairSize","circleRadius","crosshair","bboxObj","bboxCount","dimensions","_getOverlayDimensions","createBoundingBox","perf","getPerf","perfEntries","timers","displayValue","perfGroup","baseX","baseY","bg","entryText","entry","ensureDebugLayer","toggle","toggleFeature","feature","getDebugState","hasDebugLayer","boundingBoxCount","routingOverlayCount","performanceOverlayCount","renderedOverlay","textHeight","textWidth","textFontSize","adjustedY","actualBaseline","adjustedX","actualTextAnchor","_calculateTextOverlayDimensions","_calculateLineOverlayDimensions","_calculateImageOverlayDimensions","_calculateRectOverlayDimensions","attachmentData","renderedElement","bboxError","charWidth","endpoints","end_points","startX","startY","endX","endY","minY","MsdControlsRenderer","controlElements","_isRendering","_lastSignature","_msdControlsRenderer","setHass","hasHass","entityCount","hasLightDesk","lightDeskState","previousHass","controlElementsCount","_updateAllControlsHass","wrapperElement","cardElement","_applyHassToCard","controlId","isCustomButtonCard","hasConfig","hasSetConfig","currentHass","hasSetHass","isCBLCARSCard","isStandardHACard","oldHass","newStateObj","oldState","newState","stateChanged","renderControls","controlOverlays","signature","ids","getSvgControlsContainer","renderControlOverlay","overlayError","existingForeignObject","controlElement","createControlElement","positionControlElement","resolveCardDefinition","card_config","cardConfig","_card","extension","_rawOverlayIndex","_msdRawOverlays","rawEntry","_normalizeCardType","cardDef","normalizedCardType","originalType","normalizedType","_createHomeAssistantCard","_createCustomCard","_createFallbackCard","_applyHassContext","_configureCard","wrapper","className","msdControlId","_setupEventIsolation","customCards","_waitForElementUpgrade","CardClass","tempParent","maxWait","upgrade","waitTime","_buildCardConfig","_applyCardConfig","_isCustomButtonCard","currentConfig","finalConfig","otherProps","isBuiltInCard","_msdGenerated","strategies","success","triggersUpdate","maxRetries","_pendingConfig","retryInterval","border","flexDirection","justifyContent","alignItems","subtitle","eventType","contains","resolveSize","foreignObject","createSvgForeignObject","configureControlForSvg","targetContainer","overflow","boxSizing","z_index","controlsGroup","overlayContainer","cleanup","svgControlsContainer","legacyContainer","PerformancePanel","previousSnapshot","setThreshold","avgMs","resetTimer","clearAllTimers","exportData","perfData","table","blob","createObjectURL","download","click","revokeObjectURL","captureData","alerts","regressions","getDebugStatusSilent","timerData","severity","previous","regression","previousAvg","currentAvg","renderHtml","severityColor","timerEntries","hasThreshold","avgColor","counterEntries","alertCount","regressionCount","ValidationPanel","warnings","debugStatus","validationData","validation","getValidationIssues","warning","totalIssues","DataSourcePanel","entityChangeHistory","maxHistoryLength","_setupGlobalHelpers","__msdInspectDataEntity","getEntity","groupEnd","_showEntityPopup","__msdInspectDataSubscription","subscribers","getSourceSubscribers","_showSubscriptionPopup","__msdRefreshDataSources","refreshSubscriptions","hud","popup","last_updated","truncatedValue","received","cacheHits","hitRate","subscriber","combinedData","_createEntityPopup","extras","subscriberName","transformName","calculations","calc","calcName","_showSubscriptionInspectionPopup","_currentData","subscriptions","_createSubscriptionPopup","clearHistory","recentChanges","entityIds","listIds","dsStats","healthCheck","getHealth","subscribed","sum","uptime","connectionCount","previousState","oldestKey","lastChanged","lastUpdated","domain","entityData","uptimeHours","shortName","hasErrors","change","shortId","timeAgo","entities_entries","byDomain","domainEntities","stateValue","shortState","RoutingPanel","minCost","maxCost","cacheHit","showArcs","inputStates","minCostFocused","maxCostFocused","__msdAnalyzeRoute","routeId","analysis","Strategy","Cost","Segments","Bends","Index","hint","_showRouteAnalysisPopup","sourceFirst","sourceLast","isLong","displayPath","compute_time_ms","cache_time_ms","additionalMeta","setFilter","updateCostFilter","finalizeCostFilter","setInputFocus","focused","highlightRoute","mountElement","routeElements","overlayGroups","originalFilter","outline","originalOutline","safeId","outlineOffset","showRouteHighlightFeedback","emit","analyzeRoute","showRouteAnalysisFeedback","feedback","routes","routingStats","getPerformanceMetrics","pipeline","startAnchor","endAnchor","computeTime","filterRoutes","route","routingData","selected","allRoutes","filteredRoutes","costColor","shouldSkipRefresh","ChannelTrendPanel","conflictThreshold","lastSnapshot","_occupancy","conflicts","trends","recommendations","channelId","channelHistory","recent","trend","average","calculateVariance","highVarianceChannels","unusedChannels","mean","sparkline","chars","channelData","conflict","rec","typeColor","sortedTrends","trendIndicator","trendColor","currentCount","totalUsage","historySize","FlagsPanel","debugFeatures","currentlyEnabled","reRender","adjustScale","currentScale","clampedScale","numScale","refreshDebug","_debugFlags","flagsData","isEnabled","displayName","scaleValue","isActive","enabledCount","IssuesPanel","issueCategories","handleIssueClick","bus","clickAction","issuesData","allIssues","categoryIssues","errorCount","warningCount","categoryKey","category","issue","PacksPanel","provenance","packsData","allEntries","chainStr","layer_id","badges","__meta","badgeHtml","RulesPanel","trace","engineTrace","getTrace","rulesList","_rules","rule","traceInfo","lastMatch","matched","matchCount","_matchCount","conditions","when","actions","totalRules","matchedRules","totalMatches","avgPriority","rulesData","sortedRules","matchStatus","matchColor","ExportPanel","exportCollapsedJson","downloadJson","updateTextarea","exportFull","includeMeta","exportFullSnapshotJson","include_meta","diffItem","clearTextarea","copyToClipboard","textarea","clipboard","writeText","showFeedback","setSelectionRange","jsonString","available","hasExportMethods","hasDiffMethod","globalHandlers","__msdExportPanel","HudEventBus","_listeners","on","off","payload","any","SelectionManager","ts","OverlaysPanel","byType","profileCount","_profiles","patchCount","_patches","styleSourceCount","_styleSources","fromPacks","highlightOverlay","mount","_ensureHighlightStyles","_findOverlayModel","isControlsType","roots","selectorExact","escape","selectorId","controlsSelectors","exactMatches","byIdMatch","_toast","node","_applyControlsHighlight","_applyElementHighlight","_msdCtrlHl","_msdPrevBoxShadow","boxShadow","_msdPrevZIndex","_msdPrevOutline","_msdPrevFilter","pulseStyle","isChild","_msdHl","_msdPrevStroke","_msdPrevStrokeW","_msdHlBox","analyzeOverlay","patches","styleSources","_showOverlayPopup","baseFontSize","manager","sectionFontSize","metricFontSize","controlsFontSize","stylePreview","ruleId","sourcesDetail","finalStyleProps","propertyMappings","sourceLabel","_highlightBoundingBoxFromModel","attachId","anchorEl","attachEl","_spawnBoundingBox","rects","maxR","maxB","box","overlayBoxFor","smallFontSize","badge","MsdHudManager","__msdHudBus","evt","panels","channelTrend","dataSources","activePanel","refreshRate","lastRefresh","panelVisibility","panelOrder","compactMode","autoPosition","panelManagerOpen","hudWidth","resizable","hudScale","hudElement","refreshInterval","dragState","isDragging","startLeft","startTop","_setupGlobalPanelControls","keyboardEnabled","_setupKeyboardShortcuts","_registerBusHandlers","selection","_registerSelectionHandlers","show","hide","setRefreshRate","__msdHudPanelControls","togglePanel","panelName","updateHudContent","setCompactMode","setAutoPosition","_autoPositionHud","resetPanelLayout","panel","movePanel","currentOrder","currentIndex","togglePanelManager","_attachPanelManagerEventListeners","closePanelManager","adjustFontSize","_fontSizeThrottle","newSize","_applyFontAndScale","setFontSize","adjustHudScale","_scaleThrottle","setHudScale","setFontFamily","family","validFamilies","normalizedFamily","normalized","scaledWidth","scaledHeight","currentLeft","currentTop","maxLeft","maxTop","viewportWidth","viewportHeight","visiblePanelCount","estimatedHeight","haHeader","haSidebar","headerHeight","sidebarWidth","_setupResizeHandler","_resizeSetup","resizeTimeout","_setupDebugStatusHelper","_state","focus","dir","inspectEntity","adjustWidth","_applySelectionHighlight","_updateSelectionBadge","togglePanelCollapse","collapsedPanels","_applyCollapseState","toggleFocusPanel","focusPanel","collapsed","h3","filterTerm","term","_updateFocusBadgeInFooter","_decoratePanelHeaders","enhanced","indicator","altKey","footerFocus","setFilterTerm","createHudElement","setupDragging","_attachDelegatedEvents","_delegatedEventsAttached","domEvent","busEvent","rest","wasManagerOpen","renderHudHtml","titleFontSize","compactTitleFontSize","tinyFontSize","_renderPanelControls","renderedPanelCount","hiddenClass","panelData","panelHtml","refreshAge","startRefresh","stopRefresh","numRate","handleDrag","newLeft","newTop","endDrag","compactBtn","onclick","resetBtn","closeBtn","btn","newWidth","_keyboardSetup","ctrlKey","metaKey","shiftKey","RollingBuffer","capacity","_timestamps","_size","_full","_stats","pushes","overwrites","queries","_lastPushTime","_coalescingThresholdMs","lastTimestamp","getArrays","bufferIndex","sliceSince","msWindow","cutoffTime","startIndex","firstIndex","utilization","overwriteRate","isFull","_validateConsistency","TransformationProcessor","totalTime","_doTransform","_getFallbackValue","avgTime","resetStats","UnitConversionProcessor","conversions","kw","kb","mb","fromUnit","toUnit","customFunction","conversionKeys","conversionKey","ScaleProcessor","inputRange","input_range","outputRange","output_range","inMin","inMax","outMin","outMax","SmoothingProcessor","method","alpha","windowSize","window_size","_lastSmoothed","_window","_exponentialSmooth","_movingAverage","_medianFilter","sorted","mid","ExpressionProcessor","_compiledFunction","AggregationProcessor","windowMs","_parseTimeWindow","maxAge","_lastUpdate","updates","resets","transformedData","_cleanOldValues","_calculate","getValue","valueCount","currentResult","currentTimestamp","originalLength","cleanedValues","MovingAverageAggregation","maxSamples","max_samples","MinMaxAggregation","trackMin","trackMax","trackAvg","RateOfChangeAggregation","timeDiff","SessionStatsAggregation","_firstValue","_sessionStart","timestamps","dataSpan","RecentTrendAggregation","strength","recentValues","sumX","sumY","sumXY","sumXX","isNode","MsdDataSource","cfg","wsSec","windowSeconds","_parseTimeWindowMs","minEmitMs","sampleMs","coalesceMs","maxDelayMs","emitOnSameValue","haUnsubscribe","_transformationData","_aggregationData","_lastEmitTime","_lastEmittedValue","_pendingRaf","_pending","_pendingFirstTs","_pendingCount","emits","coalesced","skipsSameValue","invalid","_started","_destroyed","_initializeProcessors","processor","createTransformationProcessor","createAggregationProcessor","_preloadHistory","historyConfig","endTime","_preloadWithHistoryService","_preloadWithStatistics","statError","_preloadStateHistory","entity_ids","start_time","end_time","statistic_ids","statistics","stat","_extractStatisticValue","currentState","connection","subscribeEvents","event_type","new_state","_handleStateChange","_emitInitialData","emitData","_getTransformationData","_getAggregationData","isInitialEmission","statisticsData","sendMessagePromise","_preloadStateHistoryWS","historyData","minimal_response","no_attributes","_preloadHistoryREST","auth","accessToken","eventData","hasEventData","hasNewState","newStateValue","subscriberCount","_lastOriginalState","originalState","_applyTransformations","_updateAggregations","_shouldEmit","_emit","_subscribeLive","_onRawEventValue","_ensureScheduleEmit","_frameEmitCheck","timeSinceLastEmit","timeSincePendingStart","shouldEmit","untilMinEmit","untilCoalesce","untilMaxDelay","nextCheck","subscribe","subscribeWithMetadata","_subscriberMetadata","overlayType","component","subscribedAt","lowerRaw","converted","windowStr","destroyed","getSubscriberInfo","isWrapped","DataSourceManager","overlaySubscriptions","entityIndex","globalEntityChangeListeners","sourcesCreated","subscriptionsActive","dataUpdates","initializeFromConfig","dataSourceConfigs","promises","createDataSource","all","_waitForHistoryPreloading","_notifyGlobalEntityChangeListeners","hassState","old_state","maxWaitMs","allReady","totalSources","readySources","data_path","source_type","raw_value","aggregation_data","_resolveDataPath","addEntityChangeListener","changedEntityIds","subscribeOverlay","unsubscribe","enhancedData","hasHistoricalData","historicalDataLength","immediateData","unsubscribeOverlay","getAllSources","getDataSource","_dataSources","sourceStats","activeSubscriptions","getAllSubscribers","stopPromises","debugDump","perfInc","t0","done","perfSet","RouterCore","routingConfig","_cache","_cacheOrder","_maxCache","_rev","_overlaysRef","_obstacles","_obsVersion","_gridCache","_channels","_normalizeChannels","_channelForcePenalty","channel_force_penalty","_channelAvoidMultiplier","channel_avoid_multiplier","_channelTargetCoverage","channel_target_coverage","_channelShapingMaxAttempts","channel_shaping_max_attempts","_channelShapingSpan","channel_shaping_span","_channelMinCoverageGain","channel_min_coverage_gain","setOverlays","obs","obstacle","ax","ay","rev","obstacles","obsVersion","fs","channelMode","routeChannelMode","channel_mode","corner_smoothing_mode","modeHint","modeHintLast","route_mode_last","hintSourceFirst","hintSourceLast","isDestinationOverlay","smoothingIterations","corner_smoothing_iterations","smoothingMaxPoints","smoothing_max_points","_hintSourceFirst","_hintSourceLast","avoidIds","routeChannels","cornerStyle","smart_proximity","detourSpan","smart_detour_span","maxExtraBends","smart_max_extra_bends","minImprovement","smart_min_improvement","maxDetoursPerElbow","smart_max_detours_per_elbow","_cacheKey","avoidKey","chanKey","gridBase","_refineSmart","_computeManhattan","arcApplied","_applyCornerRounding","smoothApplied","_applySmoothing","oldest","vb","baseRes","grid_resolution","cols","gridKey","occ","_buildOccupancy","w2c","h2c","c2x","c2y","goal","MinHeap","gScore","came","blocked","isEmpty","cur","gCur","dc","dr","nc","nk","gNew","pathCells","cc","lastDir","pc","pr","wx","wy","pcPrev","prPrev","tx","ty","bendW","cost_defaults","bend","proxW","penalty","proxPenalty","_segmentProximityPenalty","channelInfo","_channelDelta","shapingMeta","desired","coverage","shapeRes","_shapeForChannels","accepted","totalCost","_costComposite","_polylineToPath","resolution","insidePx","inside","outsidePx","outside","deltaCost","c0","r0","r1","lastMode","_costSimple","dist","bendsWeight","proximityWeight","proximityPenalty","channelDelta","proximityWeightRaw","band","segPenalty","_nearestObstacleBandOverlap","worst","weight","chanSet","chans","segLen","mx","my","inChan","weightAvg","bestPts","bestPenalty","bestCost","detoursAccepted","span","minImprove","min_improvement","elbow","verticalIn","horizontalOut","candidates","tries","newPts","_compactPolyline","cost2","newChan","newProx","baseMeta","desiredCoverage","attemptsMax","minGain","chanIds","coverage0","bestCoverage","attempts","coverageHistory","forceMode","midpoint","inAny","segsOutside","len","outsideSegs","seg","elbowIndices","improved","bestMove","bestMoveDist","mv","routeResult","radiusGlobal","totalTrim","lastOut","pPrev","pNext","vIn","vOut","lenIn","lenOut","pInTrim","pOutTrim","sweep","pEnd","iters","newMeta","addedPoints","_up","_down","computeObjectHash","normalizeForHashing","AnimationRegistry","instanceToHash","usageStats","maxCacheSize","cleanupThreshold","perfStats","cacheMisses","instancesCreated","instancesReused","cleanupRuns","getOrCreateInstance","computeInstanceHash","targetsCompatible","recordCacheHit","reuseInstance","createAnimationInstance","cacheInstance","semantic","normalizeParams","normalizeNumber","override","cachedTargets","newTargets","newOnes","cachedTarget","newTarget","cachedInstance","retarget","createdAt","lastUsed","cleanupCache","usage","toRemove","cacheSize","reuseRate","getCacheContents","contents","exportStats","includeCache","cacheContents","globalAnimationRegistry","__msdAnimRegistry","registry","globalTraceBuffer","maxSize","totalTraces","addTrace","evaluationTime","getRecentTraces","limit","matchesFilter","getRuleHistory","getMatchedRules","timeWindow","cutoff","avgEvalTime","bufferedTraces","recentMatched","recentTotal","matchRate","avgEvaluationTime","minTime","maxTime","minEvalTime","exportTraces","includeConditions","includeMetadata","exported","traces","__msdRuleTrace","getRecent","RulesEngine","rulesById","dependencyIndex","dirtyRules","lastEvaluation","traceBuffer","stopProcessing","evalCounts","dirty","skipped","buildRulesIndex","buildDependencyIndex","markAllDirty","entityToRules","ruleToEntities","extractEntityReferences","rulesDeps","totalEntities","entity_attr","map_range_cond","value_map","markEntitiesDirty","affectedRules","fullRef","ruleSet","evaluateDirty","resolveDataSourceValue","createEmptyResult","totalDirty","processedRules","dirtyRulesArray","evaluateRule","aggregateResults","evaluateConditions","determineMatch","conditionCount","countConditions","entityRefs","overlayPatches","profilesAdd","profiles_add","profilesRemove","profiles_remove","stopAfter","evaluateCondition","dataSourceValue","above","numValue","below","time_between","evaluateTimeBetween","toTimeString","evaluateMapRangeCondition","timeRange","getHours","getMinutes","startHour","startMin","endHour","endMin","mapRangeCondition","entityObj","mappedValue","allMatch","anyMatch","ruleResults","aggregated","patch","overlayPatch","processOverlayRules","shouldStop","stopped","stoppedBy","stopTriggered","affectedOverlay","baseTrace","lastEvaluations","dependencyStats","entitiesTracked","avgRulesPerEntity","traceStats","getRuleTrace","getRecentMatches","exportTrace","clearTrace","setDataSourceManager","getRuleDependencies","getEntityDependents","DebugManager","callbacks","routerReady","pendingRouterActions","pendingInitActions","_notifyTimeout","_pendingNotification","debugConfig","isAnyEnabled","_scheduleNotification","markRouterReady","_setFeature","_executeWhenReady","snapshot","enableMultiple","disableMultiple","getAvailableFeatures","_notifyChange","needsRouter","BaseOverlayUpdater","overlayUpdaters","_registerUpdaters","needsUpdate","_textNeedsUpdate","_updateTextOverlay","hasTemplates","_statusGridNeedsUpdate","_updateStatusGrid","_updateSparkline","_updateGenericOverlay","updateOverlaysForDataSourceChanges","modelBuilder","_overlayReferencesChangedDataSources","updatedDataSourceId","_findDataSourceForEntity","mainContent","hasReference","_contentReferencesChangedDataSources","SystemsManager","debugRenderer","controlsRenderer","hudManager","animRegistry","_renderTimeout","_reRenderCallback","_queuedReRender","_debugControlsRendering","mergedConfig","_originalHass","_currentHass","_previousRuleStates","_internalRenderInProgress","oldValue","initializeSystems","cardModel","_initializeDataSources","_instrumentRulesEngine","entityChangeHandler","_createEntityChangeHandler","_setupGlobalHudInterface","setReRenderCallback","hasEnhancedData","renderTimeout","renderInProgress","_renderInProgress","controlEntities","_extractControlEntities","controlChangedIds","workingHass","getCurrentHass","freshStates","user_id","convertedState","hasWorkingHass","hasDataSourceManager","dataSourceManagerIsNull","entitiesToMarkDirty","finalEntityList","isControlTriggered","hasDataSourceChanges","_lastEntityAnalysis","matchingEntities","_checkIfRulesNeedReRender","_scheduleFullReRender","setOriginalHass","hasStates","hasAuth","hasConnection","setupDirectHassSubscription","getOriginalHass","depIndex","ent","__hudDeps","perfStore","__perfStore","inc","__perfWrapped","configuredDataSources","allDataSources","configured","allDataSourceIds","sourceCount","renderDebugAndControls","anyEnabled","hasOverlays","debugOptions","showAnchors","showBoundingBoxes","showRouting","showPerformance","renderPromise","timeoutPromise","_shouldRenderDebugFromConfig","_getDebugFlags","_shouldRenderDebug","debugFlags","connectors","geometry","ingestHass","updateEntities","listEntities","_directHassSubscription","freshHass","affectedDataSources","mightCrossThresholds","_checkThresholdCrossing","entityInRule","dataSourceId","currentEntity","isAboveThreshold","isBelowThreshold","currentlyMatches","ruleKey","previouslyMatched","_updateTextOverlaysForDataSourceChanges","textOverlays","globalProfileResolver","profileIndex","activeProfiles","styleCache","lastActiveProfiles","profileLoads","styleMerges","invalidations","loadProfiles","profile","setActiveProfiles","newActiveProfiles","invalidateStyleCache","resolveOverlayStyles","resolved","resolvedOverlay","resolveOverlayStyle","buildStyleCacheKey","styleLayers","buildStyleLayers","mergedStyle","mergeStyleLayers","profileId","overlayStyle","getProfileOverlayStyle","precedence","getOverlayStyleHash","getProfile","getActiveProfiles","getAvailableProfiles","isProfileActive","activeProfileCount","getDebugInfo","availableProfiles","hasDefaults","defaultTypes","overlayIds","includeDebug","isPlain","sv","tv","__msdProfile","resolver","ModelBuilder","systems","animationIndex","timelineDefs","runtimeActiveProfiles","_resolvedModelRef","computeResolvedModel","_ensureAnchors","baseOverlays","_assembleBaseOverlays","_subscribeOverlaysToDataSources","ruleResult","_applyRules","_updateActiveProfiles","overlaysWithPatches","_applyOverlayPatches","_resolveValueMaps","activeAnimations","animDiff","tlDiff","_processAnimations","active","titleOverlay","overlaysBase","__styleProvenance","prov","subscriptionCount","pendingSubscriptions","isReady","sourceReady","hasValue","overlayConfig","_overlayUnsubscribers","_monitorPendingSubscriptions","_subscribeTextOverlaysToDataSources","pendingCount","checkCount","checkInterval","stillPending","styleKeys","patchMap","originalStyle","originalFinalStyle","patchedOverlay","newFinalStyle","applyOverlayPatches","resolveValueMaps","resolvedOverlays","entityRuntime","fail","walk","desc","inA","inB","outA","outB","mapped","linearMap","computeValueMap","desiredAnimations","ruleAnimations","ruleOverridesGrouped","ruleAnims","groupRuleAnimOverrides","animation_override","ruleList","def","resolveDesiredAnimations","desiredTimelines","resolveDesiredTimelines","animDef","overlayAnimByKey","animation_hash","unsubscribers","templateRefs","_extractDataSourceReferences","_subscribeTextOverlayToDataSource","references","templatePattern","MsdIntrospection","getOverlaysSvg","__msdResolvedModel","overlaysById","getOverlayBBox","hasWarnings","gbb","backdrop","resolvePointFromConfig","sz","resolveSizeFromConfig","idList","getViewBox","highlightLayer","viewBoxAttr","vw","vh","toDim","buildCardModel","__raw","MsdApi","attach","highlightOverlays","updateOverlay","listAnchors","getAnchor","dumpAnchors","enableDebugFeature","disableDebugFeature","toggleDebugFeature","setDebugScale","getDebugStatus","showOverlays","getPerformanceData","validate","getWindow","setDebugFlag","flag","clearDebugFlags","getDebugManager","stripMeta","__raw_msd","userItems","view_box","exportFullSnapshot","__issues","summarize","seen","initMsdPipeline","userMsdConfig","_originalUserConfig","validateStructure","anchor_id","validateAnchors","overlay_id","item_id","validateOverlays","rule_id","hasAll","hasAny","regex","validateRules","animation_id","validateAnimations","profileIds","profile_id","validateProfiles","palette_name","validatePalettes","validateRouting","seenIds","validateDuplicateIds","t1","_validationMs","existingCodes","anchorSet","aRefs","processAndValidateConfig","disabledPipeline","getAnchors","repairAnchorsFromMerged","_provenance","createDisabledPipeline","hasSystemsManager","dataSourceCount","CustomEvent","queued","renderResult","hasAnchors","renderError","phase","debugControlsError","renderTime","sourcesCount","initialRenderResult","pipelineApi","createPipelineApi","dbg","routingInspect","pathsComputed","inspectAs","setupRoutingDebugInterface","dataSourcesDebug","setupDataSourceDebugInterface","testRender","getStatus","bounding","calculatedDimensions","compare","debugDims","textOverlayRenderer","domGetBBox","dataAttributes","renderAdvanced","auto_show","introspection","relayout","help","setupRenderingDebugInterface","getActive","markersEnabled","showMarkers","forceRedraw","setupUtilityDebugInterface","setupDebugInterface","setMountElement","_routerOverlaySync","final","final_summary","chain_summaries","diff","templatesPromise","stubConfigPromise","themeColorsPromise","templates","stubConfig","setThemeColors","alertCondition","clobber","selectedTheme","colorGroup","colorValues","colorName","cssVarName","existingValue","setLevel","presets","svgHelpers","anchorHelpers","loadUserSVG","filePath","yamlContent","loadTemplates","loadStubConfig","loadThemeColors","svgList","basePath","preloadSVGs","cardImports","loadCoreFonts","initializeCustomCard","defineCustomElement","CBLCARSBaseCard","CBLCARSLabelCard","CBLCARSElbowCard","CBLCARSDoubleElbowCard","CBLCARSMultimeterCard","CBLCARSDPADCard","CBLCARSButtonCard","CBLCARSMSDCard","setAlertCondition","CBLCARSAnimationScope","_runningByTarget","_getRoot","_resolveTargets","_cleanupArtifactsForTargetId","baseEl","_cancelAndCleanupTargets","_isResizeObserverEnabled","_resizeObserver","_logLevel","_resizeObserverTarget","_lastWidth","_lastHeight","_resizeObserverTolerance","_debounceWait","_isUsingLovelaceTemplate","_overrideTemplates","resizeObserverTolerance","debounceWait","_debouncedResizeHandler","_debounce","_updateCardSize","callerStack","hasSetConfigFromMSD","fullConfig","mergedTemplates","cblcars_log_level","foundEntities","collectEntities","scan","loadAllFontsFromConfig","isUsingLovelaceTemplate","overriddenTemplates","ll","getLovelace","lovelaceTemplates","checkLovelaceTemplates","taintedCards","resize_observer_target","enable_resize_observer","resize_observer_tolerance","debounce_wait","enableResizeObserver","editorType","defaultConfig","getConfigElement","getStubConfig","getLayoutOptions","grid_rows","grid_columns","_animationScopeId","_animationScope","_timelines","msdVars","timelinesCfg","overlayConfigsById","animationScope","disableResizeObserver","parentWidth","parentHeight","significantChange","_updateResizeObserver","targetElement","resolveTargetElement","toggleResizeObserver","targetMapping","wait","_rebuildTimelines","cblcars_card_type","specialConfig","hasExistingConfig","configType","configEntity","msdAlreadyBooted","_msdV1ComprehensiveBoot","msdConfig","_msdConfig","svgUrl","_blockUpdates","_svgKey","_msdPipeline","_isControlTriggeredUpdate","hasOldValue","lastAnalysis","msdSystem","_mode","_enableResizeObserver","grid_min_rows","grid_min_columns","cardClass","editorClass","description","documentationURL","preview"],"sourceRoot":""}