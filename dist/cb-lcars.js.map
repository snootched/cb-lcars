{"version":3,"file":"cb-lcars.js","mappings":"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","sources":["webpack://cb-lcars/./node_modules/@formatjs/intl-utils/lib/src/diff.js","webpack://cb-lcars/./node_modules/custom-card-helpers/dist/index.m.js","webpack://cb-lcars/./node_modules/ha-editor-formbuilder-yaml/dist/controls.js","webpack://cb-lcars/./node_modules/ha-editor-formbuilder-yaml/dist/index.js","webpack://cb-lcars/./node_modules/ha-editor-formbuilder-yaml/dist/interfaces.js","webpack://cb-lcars/./src/cb-lcars-vars.js","webpack://cb-lcars/./src/msd/renderer/DataSourceMixin.js","webpack://cb-lcars/./src/msd/renderer/PositionResolver.js","webpack://cb-lcars/./src/msd/renderer/RendererUtils.js","webpack://cb-lcars/./src/msd/renderer/StatusGridRenderer.js","webpack://cb-lcars/./src/msd/renderer/TextOverlayRenderer.js","webpack://cb-lcars/./src/msd/tests/arcsRoutingScenarios.js","webpack://cb-lcars/./src/msd/tests/channelsRoutingScenarios.js","webpack://cb-lcars/./src/msd/tests/routingScenarios.js","webpack://cb-lcars/./src/msd/tests/smartRoutingScenarios.js","webpack://cb-lcars/./src/msd/tests/smoothingRoutingScenarios.js","webpack://cb-lcars/./src/utils/cb-lcars-anim-helpers.js","webpack://cb-lcars/./src/utils/cb-lcars-anim-presets.js","webpack://cb-lcars/./src/utils/cb-lcars-logging.js","webpack://cb-lcars/./src/utils/cb-lcars-svg-helpers.js","webpack://cb-lcars/./node_modules/lit-html/lit-html.js","webpack://cb-lcars/./node_modules/lit-html/directive.js","webpack://cb-lcars/./node_modules/lit-html/directives/unsafe-html.js","webpack://cb-lcars/./node_modules/@lit/reactive-element/css-tag.js","webpack://cb-lcars/./node_modules/@lit/reactive-element/reactive-element.js","webpack://cb-lcars/./node_modules/lit-element/lit-element.js","webpack://cb-lcars/./node_modules/lit-html/is-server.js","webpack://cb-lcars/webpack/bootstrap","webpack://cb-lcars/webpack/runtime/define property getters","webpack://cb-lcars/webpack/runtime/global","webpack://cb-lcars/webpack/runtime/hasOwnProperty shorthand","webpack://cb-lcars/webpack/runtime/make namespace object","webpack://cb-lcars/./node_modules/animejs/lib/anime.esm.js","webpack://cb-lcars/./node_modules/js-yaml/dist/js-yaml.mjs","webpack://cb-lcars/./src/utils/cb-lcars-fileutils.js","webpack://cb-lcars/./src/editor/cb-lcars-editor.js","webpack://cb-lcars/./src/utils/cb-lcars-theme.js","webpack://cb-lcars/./src/cblcars-button-card.js","webpack://cb-lcars/./src/utils/cb-lcars-anchor-helpers.js","webpack://cb-lcars/./src/msd/util/checksum.js","webpack://cb-lcars/./src/msd/util/performance.js","webpack://cb-lcars/./src/msd/packs/mergePacks.js","webpack://cb-lcars/./src/msd/validation/validateMerged.js","webpack://cb-lcars/./src/msd/renderer/SparklineRenderer.js","webpack://cb-lcars/./src/msd/renderer/LineOverlayRenderer.js","webpack://cb-lcars/./src/msd/renderer/AdvancedRenderer.js","webpack://cb-lcars/./src/msd/debug/MsdDebugRenderer.js","webpack://cb-lcars/./src/msd/controls/MsdControlsRenderer.js","webpack://cb-lcars/./src/msd/hud/panels/PerformancePanel.js","webpack://cb-lcars/./src/msd/hud/panels/ValidationPanel.js","webpack://cb-lcars/./src/msd/hud/panels/DataSourcePanel.js","webpack://cb-lcars/./src/msd/hud/panels/RoutingPanel.js","webpack://cb-lcars/./src/msd/hud/panels/ChannelTrendPanel.js","webpack://cb-lcars/./src/msd/hud/panels/FlagsPanel.js","webpack://cb-lcars/./src/msd/hud/panels/IssuesPanel.js","webpack://cb-lcars/./src/msd/hud/panels/PacksPanel.js","webpack://cb-lcars/./src/msd/hud/panels/RulesPanel.js","webpack://cb-lcars/./src/msd/hud/panels/ExportPanel.js","webpack://cb-lcars/./src/msd/hud/hudService.js","webpack://cb-lcars/./src/msd/hud/panels/OverlaysPanel.js","webpack://cb-lcars/./src/msd/hud/MsdHudManager.js","webpack://cb-lcars/./src/msd/data/RollingBuffer.js","webpack://cb-lcars/./src/msd/data/transformations/TransformationProcessor.js","webpack://cb-lcars/./src/msd/data/aggregations/AggregationProcessor.js","webpack://cb-lcars/./src/msd/data/MsdDataSource.js","webpack://cb-lcars/./src/msd/data/DataSourceManager.js","webpack://cb-lcars/./src/msd/perf/PerfCounters.js","webpack://cb-lcars/./src/msd/routing/RouterCore.js","webpack://cb-lcars/./src/msd/util/hashing.js","webpack://cb-lcars/./src/msd/animation/AnimationRegistry.js","webpack://cb-lcars/./src/msd/rules/RuleTraceBuffer.js","webpack://cb-lcars/./src/msd/rules/RulesEngine.js","webpack://cb-lcars/./src/msd/debug/DebugManager.js","webpack://cb-lcars/./src/msd/renderer/BaseOverlayUpdater.js","webpack://cb-lcars/./src/msd/pipeline/SystemsManager.js","webpack://cb-lcars/./src/msd/profile/ProfileResolver.js","webpack://cb-lcars/./src/msd/util/deepMerge.js","webpack://cb-lcars/./src/msd/pipeline/ModelBuilder.js","webpack://cb-lcars/./src/msd/valueMap/resolveValueMaps.js","webpack://cb-lcars/./src/msd/util/linearMap.js","webpack://cb-lcars/./src/msd/animation/resolveAnimations.js","webpack://cb-lcars/./src/msd/animation/resolveTimelines.js","webpack://cb-lcars/./src/msd/introspection/MsdIntrospection.js","webpack://cb-lcars/./src/msd/model/CardModel.js","webpack://cb-lcars/./src/msd/api/MsdApi.js","webpack://cb-lcars/./src/msd/export/exportCollapsed.js","webpack://cb-lcars/./src/msd/export/exportFullSnapshot.js","webpack://cb-lcars/./src/msd/export/diffItem.js","webpack://cb-lcars/./src/msd/util/stableStringify.js","webpack://cb-lcars/./src/msd/pipeline/PipelineCore.js","webpack://cb-lcars/./src/msd/pipeline/ConfigProcessor.js","webpack://cb-lcars/./src/msd/debug/DebugInterface.js","webpack://cb-lcars/./src/cb-lcars.js","webpack://cb-lcars/./src/msd/index.js","webpack://cb-lcars/./src/utils/cb-helpers.js"],"sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar MS_PER_SECOND = 1e3;\nvar SECS_PER_MIN = 60;\nvar SECS_PER_HOUR = SECS_PER_MIN * 60;\nvar SECS_PER_DAY = SECS_PER_HOUR * 24;\nvar SECS_PER_WEEK = SECS_PER_DAY * 7;\nexport function selectUnit(from, to, thresholds) {\n    if (to === void 0) { to = Date.now(); }\n    if (thresholds === void 0) { thresholds = {}; }\n    var resolvedThresholds = __assign(__assign({}, DEFAULT_THRESHOLDS), (thresholds || {}));\n    var secs = (+from - +to) / MS_PER_SECOND;\n    if (Math.abs(secs) < resolvedThresholds.second) {\n        return {\n            value: Math.round(secs),\n            unit: 'second',\n        };\n    }\n    var mins = secs / SECS_PER_MIN;\n    if (Math.abs(mins) < resolvedThresholds.minute) {\n        return {\n            value: Math.round(mins),\n            unit: 'minute',\n        };\n    }\n    var hours = secs / SECS_PER_HOUR;\n    if (Math.abs(hours) < resolvedThresholds.hour) {\n        return {\n            value: Math.round(hours),\n            unit: 'hour',\n        };\n    }\n    var days = secs / SECS_PER_DAY;\n    if (Math.abs(days) < resolvedThresholds.day) {\n        return {\n            value: Math.round(days),\n            unit: 'day',\n        };\n    }\n    var fromDate = new Date(from);\n    var toDate = new Date(to);\n    var years = fromDate.getFullYear() - toDate.getFullYear();\n    if (Math.round(Math.abs(years)) > 0) {\n        return {\n            value: Math.round(years),\n            unit: 'year',\n        };\n    }\n    var months = years * 12 + fromDate.getMonth() - toDate.getMonth();\n    if (Math.round(Math.abs(months)) > 0) {\n        return {\n            value: Math.round(months),\n            unit: 'month',\n        };\n    }\n    var weeks = secs / SECS_PER_WEEK;\n    return {\n        value: Math.round(weeks),\n        unit: 'week',\n    };\n}\nexport var DEFAULT_THRESHOLDS = {\n    second: 45,\n    minute: 45,\n    hour: 22,\n    day: 5,\n};\n","import{selectUnit as e}from\"@formatjs/intl-utils\";var t,r,n=function(e,t){return i(t).format(e)},i=function(e){return new Intl.DateTimeFormat(e.language,{weekday:\"long\",month:\"long\",day:\"numeric\"})},a=function(e,t){return o(t).format(e)},o=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"long\",day:\"numeric\"})},u=function(e,t){return c(t).format(e)},c=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"numeric\",day:\"numeric\"})},m=function(e,t){return s(t).format(e)},s=function(e){return new Intl.DateTimeFormat(e.language,{day:\"numeric\",month:\"short\"})},l=function(e,t){return d(t).format(e)},d=function(e){return new Intl.DateTimeFormat(e.language,{month:\"long\",year:\"numeric\"})},f=function(e,t){return g(t).format(e)},g=function(e){return new Intl.DateTimeFormat(e.language,{month:\"long\"})},p=function(e,t){return h(t).format(e)},h=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\"})};!function(e){e.language=\"language\",e.system=\"system\",e.comma_decimal=\"comma_decimal\",e.decimal_comma=\"decimal_comma\",e.space_comma=\"space_comma\",e.none=\"none\"}(t||(t={})),function(e){e.language=\"language\",e.system=\"system\",e.am_pm=\"12\",e.twenty_four=\"24\"}(r||(r={}));var b=function(e){if(e.time_format===r.language||e.time_format===r.system){var t=e.time_format===r.language?e.language:void 0,n=(new Date).toLocaleString(t);return n.includes(\"AM\")||n.includes(\"PM\")}return e.time_format===r.am_pm},v=function(e,t){return _(t).format(e)},_=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"long\",day:\"numeric\",hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:b(e)})},y=function(e,t){return w(t).format(e)},w=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"long\",day:\"numeric\",hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:b(e)})},k=function(e,t){return x(t).format(e)},x=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"numeric\",day:\"numeric\",hour:\"numeric\",minute:\"2-digit\",hour12:b(e)})},D=function(e,t){return S(t).format(e)},S=function(e){return new Intl.DateTimeFormat(e.language,{hour:\"numeric\",minute:\"2-digit\",hour12:b(e)})},F=function(e,t){return T(t).format(e)},T=function(e){return new Intl.DateTimeFormat(e.language,{hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:b(e)})},I=function(e,t){return N(t).format(e)},N=function(e){return new Intl.DateTimeFormat(e.language,{hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:b(e)})},M=function(t,r,n,i){void 0===i&&(i=!0);var a=e(t,n);return i?function(e){return new Intl.RelativeTimeFormat(e.language,{numeric:\"auto\"})}(r).format(a.value,a.unit):Intl.NumberFormat(r.language,{style:\"unit\",unit:a.unit,unitDisplay:\"long\"}).format(Math.abs(a.value))};function C(e){var t,r=3600*(t=e.attributes.remaining.split(\":\").map(Number))[0]+60*t[1]+t[2];if(\"active\"===e.state){var n=(new Date).getTime(),i=new Date(e.last_changed).getTime();r=Math.max(r-(n-i)/1e3,0)}return r}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var q=function(e,t,r,n){void 0===n&&(n=!1),e._themes||(e._themes={});var i=t.default_theme;(\"default\"===r||r&&t.themes[r])&&(i=r);var a=O({},e._themes);if(\"default\"!==i){var o=t.themes[i];Object.keys(o).forEach(function(t){var r=\"--\"+t;e._themes[r]=\"\",a[r]=o[t]})}if(e.updateStyles?e.updateStyles(a):window.ShadyCSS&&window.ShadyCSS.styleSubtree(e,a),n){var u=document.querySelector(\"meta[name=theme-color]\");if(u){u.hasAttribute(\"default-content\")||u.setAttribute(\"default-content\",u.getAttribute(\"content\"));var c=a[\"--primary-color\"]||u.getAttribute(\"default-content\");u.setAttribute(\"content\",c)}}},A=function(e){return\"function\"==typeof e.getCardSize?e.getCardSize():4};function E(e){return e.substr(0,e.indexOf(\".\"))}function j(e){return e.substr(e.indexOf(\".\")+1)}function R(e){var t,r=(null==e||null==(t=e.locale)?void 0:t.language)||\"en\";return e.translationMetadata.translations[r]&&e.translationMetadata.translations[r].isRTL||!1}function z(e){return R(e)?\"rtl\":\"ltr\"}function L(e){return E(e.entity_id)}var P=function(e){return!!e.attributes.unit_of_measurement||!!e.attributes.state_class},U=function(e){switch(e.number_format){case t.comma_decimal:return[\"en-US\",\"en\"];case t.decimal_comma:return[\"de\",\"es\",\"it\"];case t.space_comma:return[\"fr\",\"sv\",\"cs\"];case t.system:return;default:return e.language}},B=function(e,t){return void 0===t&&(t=2),Math.round(e*Math.pow(10,t))/Math.pow(10,t)},H=function(e,r,n){var i=r?U(r):void 0;if(Number.isNaN=Number.isNaN||function e(t){return\"number\"==typeof t&&e(t)},(null==r?void 0:r.number_format)!==t.none&&!Number.isNaN(Number(e))&&Intl)try{return new Intl.NumberFormat(i,V(e,n)).format(Number(e))}catch(t){return console.error(t),new Intl.NumberFormat(void 0,V(e,n)).format(Number(e))}return\"string\"==typeof e?e:B(e,null==n?void 0:n.maximumFractionDigits).toString()+(\"currency\"===(null==n?void 0:n.style)?\" \"+n.currency:\"\")},V=function(e,t){var r=O({maximumFractionDigits:2},t);if(\"string\"!=typeof e)return r;if(!t||!t.minimumFractionDigits&&!t.maximumFractionDigits){var n=e.indexOf(\".\")>-1?e.split(\".\")[1].length:0;r.minimumFractionDigits=n,r.maximumFractionDigits=n}return r},W=function(e,t,r,n){var i=void 0!==n?n:t.state;if(\"unknown\"===i||\"unavailable\"===i)return e(\"state.default.\"+i);if(P(t)){if(\"monetary\"===t.attributes.device_class)try{return H(i,r,{style:\"currency\",currency:t.attributes.unit_of_measurement})}catch(e){}return H(i,r)+(t.attributes.unit_of_measurement?\" \"+t.attributes.unit_of_measurement:\"\")}var o=L(t);if(\"input_datetime\"===o){var u;if(void 0===n)return t.attributes.has_date&&t.attributes.has_time?(u=new Date(t.attributes.year,t.attributes.month-1,t.attributes.day,t.attributes.hour,t.attributes.minute),v(u,r)):t.attributes.has_date?(u=new Date(t.attributes.year,t.attributes.month-1,t.attributes.day),a(u,r)):t.attributes.has_time?((u=new Date).setHours(t.attributes.hour,t.attributes.minute),D(u,r)):t.state;try{var c=n.split(\" \");if(2===c.length)return v(new Date(c.join(\"T\")),r);if(1===c.length){if(n.includes(\"-\"))return a(new Date(n+\"T00:00\"),r);if(n.includes(\":\")){var m=new Date;return D(new Date(m.toISOString().split(\"T\")[0]+\"T\"+n),r)}}return n}catch(e){return n}}return\"humidifier\"===o&&\"on\"===i&&t.attributes.humidity?t.attributes.humidity+\" %\":\"counter\"===o||\"number\"===o||\"input_number\"===o?H(i,r):t.attributes.device_class&&e(\"component.\"+o+\".state.\"+t.attributes.device_class+\".\"+i)||e(\"component.\"+o+\".state._.\"+i)||i},G=\"mdi:bookmark\",J=\"lovelace\",K=[\"climate\",\"cover\",\"configurator\",\"input_select\",\"input_number\",\"input_text\",\"lock\",\"media_player\",\"scene\",\"script\",\"timer\",\"vacuum\",\"water_heater\",\"weblink\"],Q=[\"alarm_control_panel\",\"automation\",\"camera\",\"climate\",\"configurator\",\"cover\",\"fan\",\"group\",\"history_graph\",\"input_datetime\",\"light\",\"lock\",\"media_player\",\"script\",\"sun\",\"updater\",\"vacuum\",\"water_heater\",\"weather\"],X=[\"input_number\",\"input_select\",\"input_text\",\"scene\",\"weblink\"],Y=[\"camera\",\"configurator\",\"history_graph\",\"scene\"],Z=[\"closed\",\"locked\",\"off\"],$=new Set([\"fan\",\"input_boolean\",\"light\",\"switch\",\"group\",\"automation\"]),ee=\"C\",te=\"F\",re=\"group.default_view\",ne=function(e,t,r,n){n=n||{},r=null==r?{}:r;var i=new Event(t,{bubbles:void 0===n.bubbles||n.bubbles,cancelable:Boolean(n.cancelable),composed:void 0===n.composed||n.composed});return i.detail=r,e.dispatchEvent(i),i},ie=new Set([\"call-service\",\"divider\",\"section\",\"weblink\",\"cast\",\"select\"]),ae={alert:\"toggle\",automation:\"toggle\",climate:\"climate\",cover:\"cover\",fan:\"toggle\",group:\"group\",input_boolean:\"toggle\",input_number:\"input-number\",input_select:\"input-select\",input_text:\"input-text\",light:\"toggle\",lock:\"lock\",media_player:\"media-player\",remote:\"toggle\",scene:\"scene\",script:\"script\",sensor:\"sensor\",timer:\"timer\",switch:\"toggle\",vacuum:\"toggle\",water_heater:\"climate\",input_datetime:\"input-datetime\"},oe=function(e,t){void 0===t&&(t=!1);var r=function(e,t){return n(\"hui-error-card\",{type:\"error\",error:e,config:t})},n=function(e,t){var n=window.document.createElement(e);try{if(!n.setConfig)return;n.setConfig(t)}catch(n){return console.error(e,n),r(n.message,t)}return n};if(!e||\"object\"!=typeof e||!t&&!e.type)return r(\"No type defined\",e);var i=e.type;if(i&&i.startsWith(\"custom:\"))i=i.substr(\"custom:\".length);else if(t)if(ie.has(i))i=\"hui-\"+i+\"-row\";else{if(!e.entity)return r(\"Invalid config given.\",e);var a=e.entity.split(\".\",1)[0];i=\"hui-\"+(ae[a]||\"text\")+\"-entity-row\"}else i=\"hui-\"+i+\"-card\";if(customElements.get(i))return n(i,e);var o=r(\"Custom element doesn't exist: \"+e.type+\".\",e);o.style.display=\"None\";var u=setTimeout(function(){o.style.display=\"\"},2e3);return customElements.whenDefined(e.type).then(function(){clearTimeout(u),ne(o,\"ll-rebuild\",{},o)}),o},ue=function(e,t,r){var n;return void 0===r&&(r=!1),function(){var i=[].slice.call(arguments),a=this,o=function(){n=null,r||e.apply(a,i)},u=r&&!n;clearTimeout(n),n=setTimeout(o,t),u&&e.apply(a,i)}},ce={alert:\"mdi:alert\",automation:\"mdi:playlist-play\",calendar:\"mdi:calendar\",camera:\"mdi:video\",climate:\"mdi:thermostat\",configurator:\"mdi:settings\",conversation:\"mdi:text-to-speech\",device_tracker:\"mdi:account\",fan:\"mdi:fan\",group:\"mdi:google-circles-communities\",history_graph:\"mdi:chart-line\",homeassistant:\"mdi:home-assistant\",homekit:\"mdi:home-automation\",image_processing:\"mdi:image-filter-frames\",input_boolean:\"mdi:drawing\",input_datetime:\"mdi:calendar-clock\",input_number:\"mdi:ray-vertex\",input_select:\"mdi:format-list-bulleted\",input_text:\"mdi:textbox\",light:\"mdi:lightbulb\",mailbox:\"mdi:mailbox\",notify:\"mdi:comment-alert\",person:\"mdi:account\",plant:\"mdi:flower\",proximity:\"mdi:apple-safari\",remote:\"mdi:remote\",scene:\"mdi:google-pages\",script:\"mdi:file-document\",sensor:\"mdi:eye\",simple_alarm:\"mdi:bell\",sun:\"mdi:white-balance-sunny\",switch:\"mdi:flash\",timer:\"mdi:timer\",updater:\"mdi:cloud-upload\",vacuum:\"mdi:robot-vacuum\",water_heater:\"mdi:thermometer\",weblink:\"mdi:open-in-new\"};function me(e,t){if(e in ce)return ce[e];switch(e){case\"alarm_control_panel\":switch(t){case\"armed_home\":return\"mdi:bell-plus\";case\"armed_night\":return\"mdi:bell-sleep\";case\"disarmed\":return\"mdi:bell-outline\";case\"triggered\":return\"mdi:bell-ring\";default:return\"mdi:bell\"}case\"binary_sensor\":return t&&\"off\"===t?\"mdi:radiobox-blank\":\"mdi:checkbox-marked-circle\";case\"cover\":return\"closed\"===t?\"mdi:window-closed\":\"mdi:window-open\";case\"lock\":return t&&\"unlocked\"===t?\"mdi:lock-open\":\"mdi:lock\";case\"media_player\":return t&&\"off\"!==t&&\"idle\"!==t?\"mdi:cast-connected\":\"mdi:cast\";case\"zwave\":switch(t){case\"dead\":return\"mdi:emoticon-dead\";case\"sleeping\":return\"mdi:sleep\";case\"initializing\":return\"mdi:timer-sand\";default:return\"mdi:z-wave\"}default:return console.warn(\"Unable to find icon for domain \"+e+\" (\"+t+\")\"),\"mdi:bookmark\"}}var se=function(e,t){var r=t.value||t,n=t.attribute?e.attributes[t.attribute]:e.state;switch(t.operator||\"==\"){case\"==\":return n===r;case\"<=\":return n<=r;case\"<\":return n<r;case\">=\":return n>=r;case\">\":return n>r;case\"!=\":return n!==r;case\"regex\":return n.match(r);default:return!1}},le=function(e){ne(window,\"haptic\",e)},de=function(e,t,r){void 0===r&&(r=!1),r?history.replaceState(null,\"\",t):history.pushState(null,\"\",t),ne(window,\"location-changed\",{replace:r})},fe=function(e,t,r){void 0===r&&(r=!0);var n,i=E(t),a=\"group\"===i?\"homeassistant\":i;switch(i){case\"lock\":n=r?\"unlock\":\"lock\";break;case\"cover\":n=r?\"open_cover\":\"close_cover\";break;default:n=r?\"turn_on\":\"turn_off\"}return e.callService(a,n,{entity_id:t})},ge=function(e,t){var r=Z.includes(e.states[t].state);return fe(e,t,r)},pe=function(e,t,r,n){if(n||(n={action:\"more-info\"}),!n.confirmation||n.confirmation.exemptions&&n.confirmation.exemptions.some(function(e){return e.user===t.user.id})||(le(\"warning\"),confirm(n.confirmation.text||\"Are you sure you want to \"+n.action+\"?\")))switch(n.action){case\"more-info\":(r.entity||r.camera_image)&&ne(e,\"hass-more-info\",{entityId:r.entity?r.entity:r.camera_image});break;case\"navigate\":n.navigation_path&&de(0,n.navigation_path);break;case\"url\":n.url_path&&window.open(n.url_path);break;case\"toggle\":r.entity&&(ge(t,r.entity),le(\"success\"));break;case\"call-service\":if(!n.service)return void le(\"failure\");var i=n.service.split(\".\",2);t.callService(i[0],i[1],n.service_data,n.target),le(\"success\");break;case\"fire-dom-event\":ne(e,\"ll-custom\",n)}},he=function(e,t,r,n){var i;\"double_tap\"===n&&r.double_tap_action?i=r.double_tap_action:\"hold\"===n&&r.hold_action?i=r.hold_action:\"tap\"===n&&r.tap_action&&(i=r.tap_action),pe(e,t,r,i)},be=function(e,t,r,n,i){var a;if(i&&r.double_tap_action?a=r.double_tap_action:n&&r.hold_action?a=r.hold_action:!n&&r.tap_action&&(a=r.tap_action),a||(a={action:\"more-info\"}),!a.confirmation||a.confirmation.exemptions&&a.confirmation.exemptions.some(function(e){return e.user===t.user.id})||confirm(a.confirmation.text||\"Are you sure you want to \"+a.action+\"?\"))switch(a.action){case\"more-info\":(a.entity||r.entity||r.camera_image)&&(ne(e,\"hass-more-info\",{entityId:a.entity?a.entity:r.entity?r.entity:r.camera_image}),a.haptic&&le(a.haptic));break;case\"navigate\":a.navigation_path&&(de(0,a.navigation_path),a.haptic&&le(a.haptic));break;case\"url\":a.url_path&&window.open(a.url_path),a.haptic&&le(a.haptic);break;case\"toggle\":r.entity&&(ge(t,r.entity),a.haptic&&le(a.haptic));break;case\"call-service\":if(!a.service)return;var o=a.service.split(\".\",2),u=o[0],c=o[1],m=O({},a.service_data);\"entity\"===m.entity_id&&(m.entity_id=r.entity),t.callService(u,c,m,a.target),a.haptic&&le(a.haptic);break;case\"fire-dom-event\":ne(e,\"ll-custom\",a),a.haptic&&le(a.haptic)}};function ve(e){return void 0!==e&&\"none\"!==e.action}function _e(e,t,r){if(t.has(\"config\")||r)return!0;if(e.config.entity){var n=t.get(\"hass\");return!n||n.states[e.config.entity]!==e.hass.states[e.config.entity]}return!1}function ye(e){return void 0!==e&&\"none\"!==e.action}var we=function(e,t,r){void 0===r&&(r=!0);var n={};t.forEach(function(t){if(Z.includes(e.states[t].state)===r){var i=E(t),a=[\"cover\",\"lock\"].includes(i)?i:\"homeassistant\";a in n||(n[a]=[]),n[a].push(t)}}),Object.keys(n).forEach(function(t){var i;switch(t){case\"lock\":i=r?\"unlock\":\"lock\";break;case\"cover\":i=r?\"open_cover\":\"close_cover\";break;default:i=r?\"turn_on\":\"turn_off\"}e.callService(t,i,{entity_id:n[t]})})},ke=function(){var e=document.querySelector(\"home-assistant\");if(e=(e=(e=(e=(e=(e=(e=(e=e&&e.shadowRoot)&&e.querySelector(\"home-assistant-main\"))&&e.shadowRoot)&&e.querySelector(\"app-drawer-layout partial-panel-resolver\"))&&e.shadowRoot||e)&&e.querySelector(\"ha-panel-lovelace\"))&&e.shadowRoot)&&e.querySelector(\"hui-root\")){var t=e.lovelace;return t.current_view=e.___curView,t}return null},xe={humidity:\"mdi:water-percent\",illuminance:\"mdi:brightness-5\",temperature:\"mdi:thermometer\",pressure:\"mdi:gauge\",power:\"mdi:flash\",signal_strength:\"mdi:wifi\"},De={binary_sensor:function(e,t){var r=\"off\"===e;switch(null==t?void 0:t.attributes.device_class){case\"battery\":return r?\"mdi:battery\":\"mdi:battery-outline\";case\"battery_charging\":return r?\"mdi:battery\":\"mdi:battery-charging\";case\"cold\":return r?\"mdi:thermometer\":\"mdi:snowflake\";case\"connectivity\":return r?\"mdi:server-network-off\":\"mdi:server-network\";case\"door\":return r?\"mdi:door-closed\":\"mdi:door-open\";case\"garage_door\":return r?\"mdi:garage\":\"mdi:garage-open\";case\"power\":return r?\"mdi:power-plug-off\":\"mdi:power-plug\";case\"gas\":case\"problem\":case\"safety\":case\"tamper\":return r?\"mdi:check-circle\":\"mdi:alert-circle\";case\"smoke\":return r?\"mdi:check-circle\":\"mdi:smoke\";case\"heat\":return r?\"mdi:thermometer\":\"mdi:fire\";case\"light\":return r?\"mdi:brightness-5\":\"mdi:brightness-7\";case\"lock\":return r?\"mdi:lock\":\"mdi:lock-open\";case\"moisture\":return r?\"mdi:water-off\":\"mdi:water\";case\"motion\":return r?\"mdi:walk\":\"mdi:run\";case\"occupancy\":return r?\"mdi:home-outline\":\"mdi:home\";case\"opening\":return r?\"mdi:square\":\"mdi:square-outline\";case\"plug\":return r?\"mdi:power-plug-off\":\"mdi:power-plug\";case\"presence\":return r?\"mdi:home-outline\":\"mdi:home\";case\"running\":return r?\"mdi:stop\":\"mdi:play\";case\"sound\":return r?\"mdi:music-note-off\":\"mdi:music-note\";case\"update\":return r?\"mdi:package\":\"mdi:package-up\";case\"vibration\":return r?\"mdi:crop-portrait\":\"mdi:vibrate\";case\"window\":return r?\"mdi:window-closed\":\"mdi:window-open\";default:return r?\"mdi:radiobox-blank\":\"mdi:checkbox-marked-circle\"}},cover:function(e){var t=\"closed\"!==e.state;switch(e.attributes.device_class){case\"garage\":return t?\"mdi:garage-open\":\"mdi:garage\";case\"door\":return t?\"mdi:door-open\":\"mdi:door-closed\";case\"shutter\":return t?\"mdi:window-shutter-open\":\"mdi:window-shutter\";case\"blind\":return t?\"mdi:blinds-open\":\"mdi:blinds\";case\"window\":return t?\"mdi:window-open\":\"mdi:window-closed\";default:return me(\"cover\",e.state)}},sensor:function(e){var t=e.attributes.device_class;if(t&&t in xe)return xe[t];if(\"battery\"===t){var r=Number(e.state);if(isNaN(r))return\"mdi:battery-unknown\";var n=10*Math.round(r/10);return n>=100?\"mdi:battery\":n<=0?\"mdi:battery-alert\":\"hass:battery-\"+n}var i=e.attributes.unit_of_measurement;return\"C\"===i||\"F\"===i?\"mdi:thermometer\":me(\"sensor\")},input_datetime:function(e){return e.attributes.has_date?e.attributes.has_time?me(\"input_datetime\"):\"mdi:calendar\":\"mdi:clock\"}},Se=function(e){if(!e)return\"mdi:bookmark\";if(e.attributes.icon)return e.attributes.icon;var t=E(e.entity_id);return t in De?De[t](e):me(t,e.state)};export{G as DEFAULT_DOMAIN_ICON,J as DEFAULT_PANEL,re as DEFAULT_VIEW_ENTITY_ID,X as DOMAINS_HIDE_MORE_INFO,Y as DOMAINS_MORE_INFO_NO_HISTORY,$ as DOMAINS_TOGGLE,K as DOMAINS_WITH_CARD,Q as DOMAINS_WITH_MORE_INFO,t as NumberFormat,Z as STATES_OFF,r as TimeFormat,ee as UNIT_C,te as UNIT_F,q as applyThemesOnElement,A as computeCardSize,E as computeDomain,j as computeEntity,R as computeRTL,z as computeRTLDirection,W as computeStateDisplay,L as computeStateDomain,oe as createThing,ue as debounce,me as domainIcon,se as evaluateFilter,ne as fireEvent,ce as fixedIcons,a as formatDate,f as formatDateMonth,l as formatDateMonthYear,u as formatDateNumeric,m as formatDateShort,v as formatDateTime,k as formatDateTimeNumeric,y as formatDateTimeWithSeconds,n as formatDateWeekday,p as formatDateYear,H as formatNumber,D as formatTime,I as formatTimeWeekday,F as formatTimeWithSeconds,le as forwardHaptic,ke as getLovelace,he as handleAction,pe as handleActionConfig,be as handleClick,ve as hasAction,_e as hasConfigOrEntityChanged,ye as hasDoubleClick,P as isNumericState,de as navigate,U as numberFormatToLocale,M as relativeTime,B as round,Se as stateIcon,C as timerTimeRemaining,ge as toggleEntity,we as turnOnOffEntities,fe as turnOnOffEntity};\n//# sourceMappingURL=index.m.js.map\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getNestedProperty = void 0;\nexports.deepMerge = deepMerge;\nexports.isObject = isObject;\nexports.generateControl = generateControl;\nconst lit_1 = require(\"lit\");\nconst unsafe_html_js_1 = require(\"lit/directives/unsafe-html.js\");\nconst getNestedProperty = (obj, path) => {\n    return path.split(\".\").reduce((acc, part) => acc && acc[part], obj);\n};\nexports.getNestedProperty = getNestedProperty;\nfunction deepMerge(target, source) {\n    const output = { ...target };\n    for (const key of Object.keys(source)) {\n        const targetValue = output[key];\n        const sourceValue = source[key];\n        if (key === \"type\") {\n            // Preserve the type property\n            output[key] = sourceValue;\n        }\n        else if (Array.isArray(targetValue) && Array.isArray(sourceValue)) {\n            // Replace arrays entirely\n            output[key] = sourceValue;\n        }\n        else if (isObject(targetValue) && isObject(sourceValue)) {\n            output[key] = deepMerge({ ...targetValue }, sourceValue);\n        }\n        else {\n            output[key] = sourceValue;\n        }\n    }\n    return output;\n}\n/*\nexport function deepMerge2<T>(target: T, source: T): T {\n    const output = { ...target } as any;\n\n    for (const key of Object.keys(source)) {\n        const targetValue = output[key];\n        const sourceValue = (source as any)[key];\n\n        if (key === \"type\") {\n            // Preserve the type property\n            output[key] = sourceValue;\n        } else if (Array.isArray(targetValue) && Array.isArray(sourceValue)) {\n            output[key] = [...new Set([...targetValue, ...sourceValue])]; // Merge arrays while removing duplicates\n        } else if (isObject(targetValue) && isObject(sourceValue)) {\n            output[key] = deepMerge({ ...targetValue }, sourceValue);\n        } else {\n            output[key] = sourceValue;\n        }\n    }\n\n    return output;\n}\n*/\nfunction isObject(obj) {\n    return obj !== null && typeof obj === \"object\";\n}\nfunction generateControl(control, card) {\n    /////put in the conditions for the new controls\n    ///// todo:  ?default val based on condition.. should only be set if set value doesn't exist. think about it..   const defaultValue = control.defaultValueCondition ? this._evaluateCondition(control.defaultValueCondition) : '';\n    //console.debug('generateControl:', control);\n    //pass in context to have access to the card's properties and window object\n    const context = { ...card, hass: card._hass, window };\n    // Evaluate visibility, disabled, and required conditions\n    // eg yaml:  isVisible: 'this._config.cblcars_card_config.show_icon === true'\n    //visible default is true\n    //disabled default is false\n    //required default is false\n    const isVisible = control.visibilityCondition ? card._evaluateCondition(control.visibilityCondition, context) : true;\n    const isDisabled = control.disabledCondition ? card._evaluateCondition(control.disabledCondition, context) : false;\n    const isRequired = control.requiredCondition ? card._evaluateCondition(control.requiredCondition, context) : false;\n    if (!isVisible) {\n        return null;\n    }\n    // Handle dynamic list creation for 'select' selector type\n    /*\n      eg yaml will pull in all css variables starting with '--picard-'\n  \n       - controls:\n          - label: \"options from vars\"\n            configValue: \"variables.card.color.background.inactive\"\n            type: Selector\n            selector:\n              select:\n                optionsCondition: |\n                    (() => {\n                      const styles = document.documentElement.style;\n                      const options = [];\n                      for (let i = 0; i < styles.length; i++) {\n                        const name = styles[i];\n                        if (name.startsWith('--picard-')) {\n                          const value = styles.getPropertyValue(name).trim();\n                          options.push({ value, label: name.replace('--', '') });\n                        }\n                      }\n                      return options;\n                    })()\n  \n    */\n    if ('selector' in control && control.selector && control.selector.select && control.selector.select.optionsCondition) {\n        const options = card._evaluateCondition(control.selector.select.optionsCondition, context);\n        control.selector.select.options = options;\n    }\n    switch (control.type) {\n        case 'Selector':\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                <ha-selector\n                    .hass=${card._hass}\n                    .selector=${control.selector}\n                    .configValue=${control.configValue}\n                    .value=${(0, exports.getNestedProperty)(card._config, control.configValue)}\n                    .label=${control.label}\n                    .helper=${control.helper}\n                    .disabled=${isDisabled}\n                    .required=${isRequired}\n                    @value-changed=${card._valueChanged}\n                ></ha-selector>\n                </div>\n                `;\n        case 'Filler':\n            return (0, lit_1.html) `<div class=\"form-control\"></div>`;\n        case 'Divider':\n            return (0, lit_1.html) `<hr>`;\n        case 'Message':\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    <ha-alert alert-type=${control.alertType || \"info\"} title=${control.title || \"\"}>\n                        ${control.message || \"\"}\n                    </ha-alert>\n                </div>\n            `;\n        case 'RawHTML':\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    ${(0, unsafe_html_js_1.unsafeHTML)(control.html || \"\")}\n                </div>\n            `;\n        case 'ColorPreview':\n            let colorValue = (0, exports.getNestedProperty)(card._config, control.configValue);\n            //console.log('colorValue:', colorValue);\n            // Provide a default color value if colorValue is not set\n            let displayText;\n            if (!colorValue) {\n                colorValue = '#1B1B249A';\n                displayText = 'Color Not Set';\n            }\n            else {\n                displayText = colorValue;\n            }\n            // Check if colorValue is a CSS variable or a hex color\n            const isCssVariable = colorValue.startsWith('var(');\n            let computedColorValue = colorValue;\n            if (isCssVariable) {\n                // Extract the CSS variable name from colorValue\n                const cssVariableNameMatch = colorValue.match(/var\\((--[^,)]+)\\)/);\n                const cssVariableName = cssVariableNameMatch ? cssVariableNameMatch[1] : colorValue;\n                //console.log('cssVariableName:', cssVariableName);\n                // Get the computed color value directly\n                computedColorValue = getComputedStyle(document.documentElement).getPropertyValue(cssVariableName).trim();\n                //console.log('computedColorValue:', computedColorValue);\n                // Check if computedColorValue is empty and provide a fallback\n                if (!computedColorValue) {\n                    console.warn(`CSS variable ${cssVariableName} is not defined. Using fallback color.`);\n                    computedColorValue = '#0000ff'; // Fallback to a nice blue color\n                }\n            }\n            else if (colorValue !== '#1B1B249A') {\n                displayText = 'User Defined Color';\n            }\n            // Function to convert hex color to RGB\n            const hexToRgb = (hex) => {\n                // Remove the hash at the start if it's there\n                hex = hex.replace(/^#/, '');\n                // Check if the hex includes an alpha channel\n                let bigint;\n                let r, g, b, a;\n                if (hex.length === 8) {\n                    // Parse the r, g, b, a values\n                    bigint = parseInt(hex, 16);\n                    r = (bigint >> 24) & 255;\n                    g = (bigint >> 16) & 255;\n                    b = (bigint >> 8) & 255;\n                    a = bigint & 255;\n                    return [r, g, b, a / 255]; // Return alpha as a normalized value (0 to 1)\n                }\n                else {\n                    // Parse the r, g, b values\n                    bigint = parseInt(hex, 16);\n                    r = (bigint >> 16) & 255;\n                    g = (bigint >> 8) & 255;\n                    b = bigint & 255;\n                    return [r, g, b];\n                }\n            };\n            // Function to convert RGB string to luminance\n            const getLuminance = (hex) => {\n                //console.log('Hex input to getLuminance:', hex);\n                const [r, g, b] = hexToRgb(hex);\n                //console.log('Parsed RGB values:', [r, g, b]);\n                const [nr, ng, nb] = [r, g, b].map(value => value / 255).map(value => {\n                    return value <= 0.03928 ? value / 12.92 : Math.pow((value + 0.055) / 1.055, 2.4);\n                });\n                //console.log('Normalized RGB values:', [nr, ng, nb]);\n                return 0.2126 * nr + 0.7152 * ng + 0.0722 * nb;\n            };\n            // Determine text color based on luminance\n            const luminance = getLuminance(computedColorValue);\n            //console.log('Luminance:', luminance);\n            const textColor = luminance > 0.5 ? '#000' : '#fff';\n            //console.log('textColor:', textColor);\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    <div style=\"-webkit-fill-available; height: 50px; background-color: ${colorValue}; border-radius: 25px; border: 1px solid #000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: ${textColor};\">\n                        <div>${displayText}</div>\n                        <div>${computedColorValue}</div>\n                    </div>\n                </div>\n            `;\n        default:\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    <ha-alert alert-type=\"error\" title=\"Unsupported Control Type\">\n                    The control type \"${control.type}\" is not supported.\n                </ha-alert>\n                </div>\n                `;\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst custom_card_helpers_1 = require(\"custom-card-helpers\");\nconst lit_1 = require(\"lit\");\nconst unsafe_html_js_1 = require(\"lit/directives/unsafe-html.js\");\nconst interfaces_1 = require(\"./interfaces\");\nconst controls_1 = require(\"./controls\");\nclass EditorForm extends lit_1.LitElement {\n    constructor() {\n        super(...arguments);\n        this._selectedTab = \"panel-0\"; // Default to first tab\n        this._userStyles = (0, lit_1.css) ``;\n        this._mergeUserStyles = true;\n    }\n    setConfig(config) {\n        this._config = config;\n        this.requestUpdate(\"_config\");\n    }\n    set hass(hass) {\n        this._hass = hass;\n    }\n    generateForm(cardConfigData) {\n        if (!cardConfigData) {\n            return (0, lit_1.html) ``;\n        }\n        if (cardConfigData.tabs) {\n            return this.generateTabs(cardConfigData.tabs);\n        }\n        else {\n            const formControls = cardConfigData.render_form.map((row) => {\n                if ((0, interfaces_1.isSection)(row)) {\n                    return this.generateSection(row);\n                }\n                else {\n                    return this.generateRow(row);\n                }\n            });\n            return (0, lit_1.html) `\n            <div class=\"card-form\">\n                ${formControls}\n            </div>\n        `;\n        }\n    }\n    _handleTabActivated(event) {\n        this._selectedTab = event.detail.name;\n        this.requestUpdate();\n    }\n    generateTabs(tabs) {\n        const visibleTabs = tabs.filter(tab => this._evaluateCondition(tab.visibilityCondition || \"true\"));\n        return (0, lit_1.html) `\n            <sl-tab-group @sl-tab-show=${this._handleTabActivated}>\n                ${visibleTabs.map((tab, index) => (0, lit_1.html) `\n                    <sl-tab slot=\"nav\" panel=\"panel-${index}\" ?active=${this._selectedTab === `panel-${index}`}>\n                        ${tab.label}\n                    </sl-tab>\n                `)}\n            </sl-tab-group>\n            <div class=\"tab-content\">\n                ${visibleTabs.map((tab, index) => (0, lit_1.html) `\n                    <sl-tab-panel name=\"panel-${index}\" ?hidden=${this._selectedTab !== `panel-${index}`}>\n                        ${tab.content.map(item => {\n            if (item.type === \"Section\") {\n                return this.generateSection(item);\n            }\n            else {\n                return this.generateRow(item);\n            }\n        })}\n                    </sl-tab-panel>\n                `)}\n            </div>\n        `;\n    }\n    generateSection(section) {\n        var _a;\n        if (section.visibilityCondition && !this._evaluateCondition(section.visibilityCondition)) {\n            return (0, lit_1.html) ``;\n        }\n        const cssClass = section.cssClass ? `form-row ${section.cssClass}` : \"form-row\";\n        // Create the header element programmatically\n        const headerLevel = section.headerLevel || 4;\n        const headerTag = `h${headerLevel}`;\n        const headerContent = `\n            <${headerTag} slot=\"header\">\n                ${section.icon ? `<ha-icon icon=\"${section.icon}\"></ha-icon>` : ''}\n                ${section.label}\n                ${section.secondary ? `<div slot=\"secondary\">${section.secondary}</div>` : ''}\n            </${headerTag}>\n        `;\n        return (0, lit_1.html) `\n            <div class=\"${cssClass}\">\n                <ha-expansion-panel\n                    .expanded=${section.expanded || false}\n                    .noCollapse=${section.noCollapse || false}\n                    .outlined=${section.outlined || true}\n                    .leftChevron=${section.leftChevron || false}\n                    .secondary=${section.secondary || ''}\n                >\n                    ${(0, unsafe_html_js_1.unsafeHTML)(headerContent)}\n                    <div>\n                        ${(_a = section.rows) === null || _a === void 0 ? void 0 : _a.map(row => (0, interfaces_1.isSection)(row) ? this.generateSection(row) : this.generateRow(row))}\n                    </div>\n                </ha-expansion-panel>\n            </div>\n        `;\n    }\n    generateRow(row) {\n        if (row.visibilityCondition && !this._evaluateCondition(row.visibilityCondition)) {\n            return (0, lit_1.html) ``;\n        }\n        const cssClass = row.cssClass ? `form-row ${row.cssClass}` : \"form-row\";\n        return (0, lit_1.html) `\n            <div class=\"${cssClass}\">\n                ${row.label ? (0, lit_1.html) `<label>${row.label}</label>` : ''}\n                ${row.controls.map(control => {\n            if (control.visibilityCondition && !this._evaluateCondition(control.visibilityCondition)) {\n                return (0, lit_1.html) ``;\n            }\n            return (0, controls_1.generateControl)(control, this);\n        })}\n            </div>\n        `;\n    }\n    _evaluateCondition(condition, context = {}) {\n        try {\n            return new Function('context', 'with(context) { return ' + condition + '; }').call(this, context);\n        }\n        catch (e) {\n            console.error('Error evaluating condition:', condition, e);\n            return false;\n        }\n    }\n    _valueChanged(ev) {\n        var _a, _b;\n        if (!this._config || !this._hass) {\n            return;\n        }\n        const target = ev.target; // Cast to a more specific type\n        //console.debug(\"target\", target);\n        //console.debug(\"ev.detail\", ev.detail);\n        // Extract the config path from the control\n        const configPath = (_b = (_a = target.configValue) === null || _a === void 0 ? void 0 : _a.split(\".\")) !== null && _b !== void 0 ? _b : [];\n        //console.debug(\"configPath: \", configPath);\n        // Get the new value based on the control type and event details\n        const newValue = this._getNewValue(target, ev.detail);\n        //console.debug(\"newValue: \", newValue);\n        // Determine if the control is a checkbox\n        // const isCheckbox = target.tagName === \"HA-CHECKBOX\";\n        // Determine if the control is handling an array\n        const isArray = target.tagName === \"HA-SELECTOR\" && Array.isArray(ev.detail.value);\n        // Update the config using a helper function\n        this._updateConfig(configPath, newValue, isArray);\n        // Fire the \"config-changed\" event\n        (0, custom_card_helpers_1.fireEvent)(this, \"config-changed\", { config: this._config }, { bubbles: true, composed: true });\n        // Request an update to reflect changes\n        this.requestUpdate();\n    }\n    // Helper function to extract the new value based on control type\n    _getNewValue(target, detail) {\n        var _a, _b, _c;\n        switch (target.tagName) {\n            case \"HA-SELECTOR\":\n                return detail === null || detail === void 0 ? void 0 : detail.value;\n            case \"HA-SWITCH\":\n                return (_a = target.checked) !== null && _a !== void 0 ? _a : target.__checked;\n            case \"HA-CHECKBOX\":\n                return target.value;\n            case \"HA-FORM\":\n                return Object.values((_b = detail === null || detail === void 0 ? void 0 : detail.value) !== null && _b !== void 0 ? _b : {})[0];\n            default:\n                return (_c = detail === null || detail === void 0 ? void 0 : detail.value) !== null && _c !== void 0 ? _c : target.value;\n        }\n    }\n    _updateConfig(configPath, newValue, isArray = false) {\n        if (!configPath.length) {\n            return;\n        }\n        const configPathString = configPath.join(\".\");\n        let config = { ...this._config };\n        let nestedConfig = config;\n        for (let i = 0; i < configPath.length - 1; i++) {\n            nestedConfig[configPath[i]] = nestedConfig[configPath[i]] || {};\n            nestedConfig = nestedConfig[configPath[i]];\n        }\n        const lastKey = configPath[configPath.length - 1];\n        // Handle single value or array case\n        if (newValue === \"\" || newValue === null || newValue === undefined) {\n            delete nestedConfig[lastKey];\n        }\n        else {\n            nestedConfig[lastKey] = newValue;\n        }\n        this._config = (0, controls_1.deepMerge)(this._config, config);\n    }\n    updated(changedProperties) {\n        super.updated(changedProperties);\n        const constructor = this.constructor;\n        //this.shadowRoot.adoptedStyleSheets = [constructor.styles.styleSheet, this._userStyles.styleSheet];\n        if (this._mergeUserStyles) {\n            this.shadowRoot.adoptedStyleSheets = [constructor.styles.styleSheet, this._userStyles.styleSheet];\n        }\n        else {\n            this.shadowRoot.adoptedStyleSheets = [this._userStyles.styleSheet];\n        }\n    }\n    static get styles() {\n        const baseStyles = (0, lit_1.css) `\n            /* Base styles for the form container */\n            .card-form {\n                display: grid;\n                grid-gap: 8px;\n            }\n\n             /* Styles for tabs */\n            mwc-tab-bar {\n                border-bottom: 1px solid var(--divider-color);\n            }\n            .tab-content {\n                padding: 10px;\n            }\n            .tab-panel {\n                display: none;\n            }\n            .tab-panel:not([hidden]) {\n                display: block;\n            }\n            /* Base styles for form rows */\n            .form-row {\n                display: grid;\n                grid-template-columns: 1fr;\n                grid-gap: 8px;\n                /* margin-bottom: 10px; */\n                border-radius: 10px;\n            }\n\n            /* Styles for form rows with two controls */\n            .form-row.two-controls {\n                grid-template-columns: 1fr 1fr;\n            }\n            /* Labels in form rows with two controls */\n            .form-row.two-controls label {\n                grid-column: span 2; /* Make the label span across both columns */\n                justify-self: start; /* Left-justify the label */\n                font-weight: bold;\n                height: auto;\n                margin-bottom: 5px; /* Add some space below the label */\n                padding-left: 8px;\n            }\n\n            /* ensure full width for form controls not in two-controls class */\n\n            .form-row:not(.two-controls) .form-control > * {\n                width: -webkit-fill-available;\n            }\n\n            /* Base styles for form controls */\n            .form-control {\n                display: flex; /* Use flexbox for internal alignment */\n                align-items: center;\n                padding: 8px;\n                border-radius: 10px;\n            }\n\n            /* Label styles within form controls */\n            .form-control label {\n                font-weight: bold;\n                padding-left: 8px;\n            }\n\n            /* Styles for expandable sections */\n            ha-expansion-panel {\n                margin-bottom: 10px;\n                border-radius: var(--ha-card-border-radius, 34px);\n            }\n            ha-expansion-panel[outlined] {\n                border: 2px solid var(--chip-background-color);\n            }\n            ha-expansion-panel[expanded] {\n                background-color: var(--chip-background-color);\n            }\n            h1 > ha-icon,\n            h2 > ha-icon,\n            h3 > ha-icon,\n            h4 > ha-icon,\n            h5 > ha-icon,\n            h6 > ha-icon {\n                margin: 0 8px;\n            }\n\n            hr {\n                width: 95%;\n                border: 1px solid var(--chip-background-color);\n            }\n\n            /* Styles for form errors */\n            .form-error {\n                color: var(--error-color); /* Home Assistant theme color */\n                font-size: 0.875em;\n                margin-top: 5px;\n            }\n        `;\n        return baseStyles;\n    }\n}\nexports.default = EditorForm;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isSection = isSection;\nexports.isControlRow = isControlRow;\nfunction isSection(row) {\n    return row.type === 'Section';\n}\nfunction isControlRow(row) {\n    return row.type === 'ControlRow';\n}\n","//CB-LCARS main verson from package.json\nconst packageJson = require('../package.json');\nexport const CBLCARS_VERSION = packageJson.version;\nexport const project_url = \"https://cb-lcars.unimatrix01.ca\";\n\n\nexport const core_fonts = [\n        'https://fonts.googleapis.com/css2?family=Antonio:wght@100;700&display=swap',\n        'cb-lcars_jeffries',\n        'cb-lcars_microgramma'\n    ];\n\n\n//CB-LARS yaml configuration files (templates, strategies, editor forms, etc.)\nexport const templates_uri = '/hacsfiles/cb-lcars/cb-lcars-lovelace.yaml';\nexport const stub_config_uri = '/hacsfiles/cb-lcars/cb-lcars-stub-config.yaml';\nexport const theme_colors_uri = '/hacsfiles/cb-lcars/cb-lcars-themes.yaml';\nexport const airlock_uri = '/hacsfiles/cb-lcars/cb-lcars-airlock.yaml';\nexport const gallery_uri = '/hacsfiles/cb-lcars/cb-lcars-gallery.yaml';\n//export const card_editor_uri = '/hacsfiles/cb-lcars/cb-lcars-card-editor-forms.yaml'\nexport const card_editor_uri = '/hacsfiles/cb-lcars/editor'\nexport const gallery_views_uris = [\n        '/hacsfiles/cb-lcars/cb-lcars-gallery.yaml',\n        '/hacsfiles/cb-lcars/cb-lcars-gallery-buttons.yaml',\n        '/hacsfiles/cb-lcars/cb-lcars-gallery-elbows.yaml',\n        '/hacsfiles/cb-lcars/cb-lcars-gallery-multimeter.yaml'\n    ]\n\nexport const builtin_svg_keys = [\n    'ncc-1701-a',\n    'ncc-1701-a-blue',\n    'enterprise-d-shuttlecraft15-anomaly',\n    // Add more built-in SVG keys here (without .svg extension)\n    ];\nexport const builtin_svg_basepath = '/hacsfiles/cb-lcars/msd/';\n","/**\n * DataSource Integration Mixin - Reusable DataSource integration methods\n * Provides consistent DataSource access, template processing, and value formatting\n * across all overlay renderers.\n */\n\nexport class DataSourceMixin {\n  /**\n   * Resolve content from various sources including DataSource integration\n   * @param {Object} source - Source object (overlay, cell, etc.)\n   * @param {Object} style - Style configuration\n   * @param {string} rendererName - Name of the renderer for logging\n   * @returns {string} Resolved content\n   */\n  static resolveContent(source, style, rendererName = 'Renderer') {\n    let content = style.value || source.text || source.content || source.label || '';\n\n    // Check raw configuration if content not found in standard properties\n    if (!content && source._raw?.content) {\n      content = source._raw.content;\n    }\n    if (!content && source._raw?.text) {\n      content = source._raw.text;\n    }\n    if (!content && source._raw?.label) {\n      content = source._raw.label;\n    }\n\n    // Check for data_source reference in raw if not found in main source\n    if (!source.data_source && source._raw?.data_source) {\n      source.data_source = source._raw.data_source;\n    }\n\n    // Enhanced template string processing for DataSource references (only if content has templates)\n    if (content && typeof content === 'string' && content.includes('{')) {\n      content = this.processEnhancedTemplateStrings(content, rendererName);\n      return content;\n    }\n\n    // If we have basic content, return it\n    if (content) {\n      return content;\n    }\n\n    // Direct DataSource integration for dynamic content (only as fallback when no basic content)\n    if (source.data_source || style.data_source) {\n      const dataSourceContent = this.resolveDataSourceContent(source.data_source || style.data_source, style, rendererName);\n      if (dataSourceContent !== null) {\n        return dataSourceContent;\n      }\n    }\n\n    return content; // Return whatever we found (might be empty string)\n  }\n\n  /**\n   * Resolve content directly from DataSource references\n   * @param {string} dataSourceRef - DataSource reference string\n   * @param {Object} style - Style configuration for formatting\n   * @param {string} rendererName - Name of the renderer for logging\n   * @returns {string|null} Resolved content or null if unavailable\n   */\n  static resolveDataSourceContent(dataSourceRef, style, rendererName = 'Renderer') {\n    try {\n      const dataSourceManager = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n      if (!dataSourceManager) {\n        // DataSourceManager not available - this is normal during initial rendering\n        return null;\n      }\n\n      // Parse DataSource reference (support dot notation)\n      const { sourceName, dataKey, isTransformation, isAggregation } = this.parseDataSourceReference(dataSourceRef);\n      const dataSource = dataSourceManager.getSource(sourceName);\n\n      if (!dataSource) {\n        console.warn(`[${rendererName}] DataSource '${sourceName}' not found`);\n        return `[Source: ${sourceName} not found]`;\n      }\n\n      const currentData = dataSource.getCurrentData();\n      let value = currentData?.v;\n\n      // Access enhanced data if specified\n      if (dataKey && isTransformation && currentData?.transformations) {\n        value = currentData.transformations[dataKey];\n      } else if (dataKey && isAggregation && currentData?.aggregations) {\n        const aggData = currentData.aggregations[dataKey];\n        // Handle complex aggregation objects\n        if (typeof aggData === 'object' && aggData !== null) {\n          if (aggData.avg !== undefined) value = aggData.avg;\n          else if (aggData.value !== undefined) value = aggData.value;\n          else if (aggData.last !== undefined) value = aggData.last;\n          else value = JSON.stringify(aggData);\n        } else {\n          value = aggData;\n        }\n      }\n\n      // Format the value\n      if (value !== null && value !== undefined) {\n        return this.formatDataSourceValue(value, style, currentData);\n      }\n\n      return `[${dataSourceRef}: no data]`;\n\n    } catch (error) {\n      console.error(`[${rendererName}] Error resolving DataSource content:`, error);\n      return `[DataSource Error: ${error.message}]`;\n    }\n  }\n\n  /**\n   * Parse DataSource reference to support dot notation\n   * @param {string} dataSourceRef - Reference like 'source_name' or 'source_name.transformations.key'\n   * @returns {Object} Parsed reference details\n   */\n  static parseDataSourceReference(dataSourceRef) {\n    const parts = dataSourceRef.split('.');\n    const sourceName = parts[0];\n\n    if (parts.length === 1) {\n      return { sourceName, dataKey: null, isTransformation: false, isAggregation: false };\n    }\n\n    if (parts.length >= 3) {\n      const dataType = parts[1];\n      const dataKey = parts.slice(2).join('.');\n      return {\n        sourceName,\n        dataKey,\n        isTransformation: dataType === 'transformations',\n        isAggregation: dataType === 'aggregations'\n      };\n    }\n\n    return { sourceName, dataKey: null, isTransformation: false, isAggregation: false };\n  }\n\n  /**\n   * Format DataSource values with optional formatting\n   * @param {any} value - Value to format\n   * @param {Object} style - Style configuration containing format options\n   * @param {Object} [dataSourceData] - Full DataSource data for unit context\n   * @returns {string} Formatted value\n   */\n  static formatDataSourceValue(value, style, dataSourceData = null) {\n    const format = style.value_format || style.format;\n\n    if (typeof format === 'function') {\n      return format(value);\n    }\n\n    if (typeof format === 'string') {\n      if (format.includes('{value')) {\n        return format.replace(/\\{value(?::([^}]+))?\\}/g, (match, formatSpec) => {\n          if (formatSpec) {\n            return this.applyNumberFormat(value, formatSpec, dataSourceData?.unit_of_measurement);\n          }\n          return String(value);\n        });\n      }\n      return format.replace('{value}', String(value));\n    }\n\n    // Default formatting based on value type\n    if (typeof value === 'number') {\n      if (Number.isInteger(value)) {\n        return String(value);\n      } else {\n        return value.toFixed(1);\n      }\n    }\n\n    return String(value);\n  }\n\n  /**\n   * Apply number formatting specifications with unit-aware intelligence\n   * @param {number} value - Numeric value to format\n   * @param {string} formatSpec - Format specification like \".1f\", \".2%\", \"d\"\n   * @param {string} [unitOfMeasurement] - Original entity's unit_of_measurement for intelligent formatting\n   * @returns {string} Formatted value\n   */\n  static applyNumberFormat(value, formatSpec, unitOfMeasurement) {\n    if (typeof value !== 'number') return String(value);\n\n    // Parse format specifications like \".1f\", \".2%\", \"d\", etc.\n    if (formatSpec.endsWith('%')) {\n      const precision = parseInt(formatSpec.slice(1, -1)) || 0;\n\n      // UNIT-AWARE: Check if the source entity already has % units\n      if (unitOfMeasurement === '%') {\n        // Already a percentage (0-100), don't multiply by 100\n        console.log(`[DataSourceMixin] Unit-aware formatting: ${value} with unit=\"${unitOfMeasurement}\"  ${value.toFixed(precision)}% (no conversion)`);\n        return `${value.toFixed(precision)}%`;\n      } else {\n        // Decimal value (0.0-1.0) or other unit, multiply by 100\n        console.log(`[DataSourceMixin] Unit-aware formatting: ${value} with unit=\"${unitOfMeasurement || 'none'}\"  ${(value * 100).toFixed(precision)}% (100 conversion)`);\n        return `${(value * 100).toFixed(precision)}%`;\n      }\n    }\n\n    if (formatSpec.endsWith('f')) {\n      const precision = parseInt(formatSpec.slice(1, -1)) || 1;\n      return value.toFixed(precision);\n    }\n\n    if (formatSpec === 'd') {\n      return Math.round(value).toString();\n    }\n\n    // Fallback\n    return String(value);\n  }\n\n  /**\n   * Enhanced template string processing with DataSource support\n   * @param {string} content - Template string with {references}\n   * @param {string} rendererName - Name of the renderer for logging\n   * @returns {string} Processed content with resolved references\n   */\n  static processEnhancedTemplateStrings(content, rendererName = 'Renderer') {\n    // Use the new unified method with fallback to original content for backwards compatibility\n    return this.processEnhancedTemplateStringsWithFallback(content, rendererName, true);\n  }\n\n  /**\n   * Process template for initial render with unified strategy\n   * @param {string} content - Template string with {references}\n   * @param {string} rendererName - Name of the renderer for logging\n   * @returns {string} Processed content, gracefully handling unavailable DataSources\n   */\n  static processTemplateForInitialRender(content, rendererName = 'Renderer') {\n    if (!content || typeof content !== 'string' || !content.includes('{')) {\n      return content;\n    }\n\n    console.log(`[${rendererName}] Processing template for initial render: \"${content}\"`);\n\n    // Try to process templates, but gracefully fall back to original content\n    const processed = this.processEnhancedTemplateStringsWithFallback(content, rendererName, true);\n\n    // If processing didn't change the content, DataSources might not be ready\n    if (processed === content) {\n      console.log(`[${rendererName}] Templates not resolved during initial render, will update when DataSources become available`);\n    }\n\n    return processed;\n  }\n\n  /**\n   * Enhanced template string processing with better fallback handling\n   * @param {string} content - Template string with {references}\n   * @param {string} rendererName - Name of the renderer for logging\n   * @param {boolean} fallbackToOriginal - Whether to return original content if DataSources unavailable\n   * @returns {string} Processed content with resolved references\n   */\n  static processEnhancedTemplateStringsWithFallback(content, rendererName = 'Renderer', fallbackToOriginal = true) {\n    try {\n      const dataSourceManager = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n      if (!dataSourceManager) {\n        // DataSourceManager not available - this is normal during initial rendering\n        console.log(`[${rendererName}] DataSourceManager not available, ${fallbackToOriginal ? 'returning original content' : 'returning null'}`);\n        return fallbackToOriginal ? content : null;\n      }\n\n      // Enhanced template pattern to capture DataSource references and formatting\n      let hasUnresolvedTemplates = false;\n      const processedContent = content.replace(/\\{([^}]+)\\}/g, (match, reference) => {\n        try {\n          // Parse reference and optional formatting: {source.transformations.key:.2f}\n          const [dataSourceRef, formatSpec] = reference.split(':');\n          const cleanRef = dataSourceRef.trim();\n\n          const { sourceName, dataKey, isTransformation, isAggregation } = this.parseDataSourceReference(cleanRef);\n          const dataSource = dataSourceManager.getSource(sourceName);\n\n          if (!dataSource) {\n            console.warn(`[${rendererName}] DataSource '${sourceName}' not found`);\n            hasUnresolvedTemplates = true;\n            return fallbackToOriginal ? match : `[Source: ${sourceName} not found]`;\n          }\n\n          const currentData = dataSource.getCurrentData();\n          let value = currentData?.v;\n\n          // Access enhanced data\n          if (dataKey && isTransformation && currentData?.transformations) {\n            value = currentData.transformations[dataKey];\n          } else if (dataKey && isAggregation && currentData?.aggregations) {\n            const aggData = currentData.aggregations[dataKey];\n            if (typeof aggData === 'object' && aggData !== null) {\n              // Handle nested object access\n              const nestedKeys = dataKey.split('.');\n              if (nestedKeys.length > 1) {\n                const baseKey = nestedKeys[0];\n                const nestedKey = nestedKeys.slice(1).join('.');\n                const baseData = currentData.aggregations[baseKey];\n                if (baseData && typeof baseData === 'object') {\n                  value = this.getNestedValue(baseData, nestedKey);\n                }\n              } else {\n                // Standard aggregation object handling\n                if (aggData.avg !== undefined) value = aggData.avg;\n                else if (aggData.value !== undefined) value = aggData.value;\n                else if (aggData.last !== undefined) value = aggData.last;\n                else if (aggData.direction !== undefined) value = aggData.direction;\n                else value = JSON.stringify(aggData);\n              }\n            } else {\n              value = aggData;\n            }\n          }\n\n          if (value === null || value === undefined) {\n            console.warn(`[${rendererName}] No value found for reference '${reference}'`);\n            hasUnresolvedTemplates = true;\n            return fallbackToOriginal ? match : `[No data: ${reference}]`;\n          }\n\n          // Apply formatting if specified\n          if (formatSpec) {\n            return this.applyNumberFormat(value, formatSpec.trim(), currentData?.unit_of_measurement);\n          }\n\n          return String(value);\n\n        } catch (error) {\n          console.error(`[${rendererName}] Template processing error for '${reference}':`, error);\n          hasUnresolvedTemplates = true;\n          return fallbackToOriginal ? match : `[Error: ${reference}]`;\n        }\n      });\n\n      // Log whether templates were successfully resolved\n      if (!hasUnresolvedTemplates && processedContent !== content) {\n        console.log(`[${rendererName}] Successfully resolved all templates in: \"${content}\"  \"${processedContent}\"`);\n      }\n\n      return processedContent;\n\n    } catch (error) {\n      console.error(`[${rendererName}] Enhanced template processing failed:`, error);\n      return fallbackToOriginal ? content : null;\n    }\n  }\n\n  /**\n   * Get nested value from object using dot notation\n   * @param {Object} obj - Object to traverse\n   * @param {string} path - Dot-separated path\n   * @returns {any} Nested value or undefined\n   */\n  static getNestedValue(obj, path) {\n    return path.split('.').reduce((current, key) => {\n      return current && current[key] !== undefined ? current[key] : undefined;\n    }, obj);\n  }\n\n  /**\n   * Check if DataSourceManager is available\n   * @returns {Object|null} DataSourceManager instance or null\n   */\n  static getDataSourceManager() {\n    return window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager || null;\n  }\n\n  /**\n   * Get available DataSource names\n   * @returns {Array<string>} Array of DataSource names\n   */\n  static getAvailableDataSources() {\n    const dsm = this.getDataSourceManager();\n    return dsm ? Array.from(dsm.sources.keys()) : [];\n  }\n}\n\n// Export for use in renderers\nexport default DataSourceMixin;","/**\n * Position Resolver - Utility for resolving positions and anchor points\n */\n\nexport class PositionResolver {\n  static resolvePosition(position, anchors) {\n    if (Array.isArray(position) && position.length >= 2) {\n      return [Number(position[0]), Number(position[1])];\n    }\n\n    if (typeof position === 'string' && anchors[position]) {\n      const anchorPos = anchors[position];\n      if (Array.isArray(anchorPos) && anchorPos.length >= 2) {\n        return [Number(anchorPos[0]), Number(anchorPos[1])];\n      }\n    }\n\n    console.warn('[PositionResolver] Could not resolve position:', position);\n    return null;\n  }\n}\n","/**\n * Shared Renderer Utilities - Common functionality for all renderers\n * Provides reusable components for gradients, patterns, filters, and effects\n */\n\nexport class RendererUtils {\n\n\n  /**\n   * Text measurement utilities using HTML Canvas\n   * Static methods for precise text dimension calculations\n   */\n\n  /**\n   * Get or create cached canvas context for text measurements\n   * @private\n   * @returns {CanvasRenderingContext2D}\n   */\n  static _getTextMeasureContext() {\n    if (!window.cblcars) window.cblcars = {};\n\n    if (!window.cblcars._textMeasureCanvas) {\n      window.cblcars._textMeasureCanvas = document.createElement(\"canvas\");\n      window.cblcars._textMeasureContext = window.cblcars._textMeasureCanvas.getContext(\"2d\");\n      window.cblcars._textMeasureCache = new Map();\n    }\n\n    return window.cblcars._textMeasureContext;\n  }\n\n  /**\n   * Get the SVG container and its current transformation matrix\n   * @param {Element} containerElement - The SVG container element\n   * @returns {Object|null} Object with svg element and transformation info\n   */\n  static _getSvgTransformInfo(containerElement) {\n    try {\n      const svg = containerElement?.querySelector('svg');\n      if (!svg) return null;\n\n      // Get the viewBox and current dimensions\n      const viewBox = svg.viewBox.baseVal;\n      const rect = svg.getBoundingClientRect();\n\n      // Calculate scale factors\n      const scaleX = viewBox.width / rect.width;\n      const scaleY = viewBox.height / rect.height;\n\n      return {\n        svg,\n        viewBox: [viewBox.x, viewBox.y, viewBox.width, viewBox.height],\n        screenRect: { width: rect.width, height: rect.height },\n        scaleX,\n        scaleY,\n        // For pixel-to-viewbox conversion\n        pixelToViewBox: (pixelSize) => pixelSize * Math.max(scaleX, scaleY)\n      };\n    } catch (error) {\n      console.warn('[RendererUtils] Failed to get SVG transform info:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Measure text dimensions using canvas context\n   * @param {string} text - Text to measure\n   * @param {string} font - CSS font string (e.g., \"bold 16px Arial\")\n   * @param {boolean} useCache - Whether to use cached measurements\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {{width: number, height: number, ascent: number, descent: number}}\n   */\n  static measureText(text, font = \"16px Arial\", useCache = true, containerElement = null) {\n    if (!text) return { width: 0, height: 0, ascent: 0, descent: 0 };\n\n    const cacheKey = `${text}::${font}`;\n    const cache = window.cblcars?._textMeasureCache;\n\n    if (useCache && cache && cache.has(cacheKey)) {\n      const cached = cache.get(cacheKey);\n\n      // Apply coordinate transformation if container provided\n      if (containerElement) {\n        return this._transformTextMetrics(cached, containerElement);\n      }\n\n      return cached;\n    }\n\n    const ctx = this._getTextMeasureContext();\n    ctx.font = font;\n    const metrics = ctx.measureText(text);\n\n    const result = {\n      width: metrics.width,\n      height: metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent,\n      ascent: metrics.actualBoundingBoxAscent,\n      descent: metrics.actualBoundingBoxDescent,\n      actualLeft: metrics.actualBoundingBoxLeft || 0,\n      actualRight: metrics.actualBoundingBoxRight || metrics.width,\n      // Store original pixel values for transformation\n      _pixelWidth: metrics.width,\n      _pixelHeight: metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent,\n      _pixelAscent: metrics.actualBoundingBoxAscent,\n      _pixelDescent: metrics.actualBoundingBoxDescent\n    };\n\n    if (useCache && cache) {\n      cache.set(cacheKey, result);\n    }\n\n    // Apply coordinate transformation if container provided\n    if (containerElement) {\n      return this._transformTextMetrics(result, containerElement);\n    }\n\n    return result;\n  }\n\n  /**\n   * Transform text metrics from pixel space to viewBox coordinate space\n   * @private\n   * @param {Object} metrics - Original pixel-based metrics\n   * @param {Element} containerElement - SVG container for transformation\n   * @returns {Object} Transformed metrics in viewBox coordinates\n   */\n  static _transformTextMetrics(metrics, containerElement) {\n    const transformInfo = this._getSvgTransformInfo(containerElement);\n    if (!transformInfo) {\n      // No transformation available - return original metrics\n      console.warn('[RendererUtils] No transform info available, using pixel metrics');\n      return metrics;\n    }\n\n    const { pixelToViewBox } = transformInfo;\n\n    const transformed = {\n      ...metrics,\n      width: pixelToViewBox(metrics._pixelWidth || metrics.width),\n      height: pixelToViewBox(metrics._pixelHeight || metrics.height),\n      ascent: pixelToViewBox(metrics._pixelAscent || metrics.ascent),\n      descent: pixelToViewBox(metrics._pixelDescent || metrics.descent),\n      actualLeft: pixelToViewBox(metrics.actualLeft),\n      actualRight: pixelToViewBox(metrics.actualRight)\n    };\n\n    console.log('[RendererUtils] Transformed text metrics:', {\n      original: {\n        width: metrics.width,\n        height: metrics.height\n      },\n      transformed: {\n        width: transformed.width,\n        height: transformed.height\n      },\n      scaleInfo: {\n        scaleX: transformInfo.scaleX,\n        scaleY: transformInfo.scaleY\n      }\n    });\n\n    return transformed;\n  }\n\n  /**\n   * Measure multiline text with proper line spacing and coordinate transformation\n   * @param {string} text - Multiline text (with \\n separators)\n   * @param {string} font - CSS font string\n   * @param {number} lineHeight - Line height multiplier (default 1.2)\n   * @param {boolean} useCache - Whether to use cached measurements\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {{width: number, height: number, lines: Array, lineMetrics: Array}}\n   */\n  static measureMultilineText(text, font = \"16px Arial\", lineHeight = 1.2, useCache = true, containerElement = null) {\n    if (!text) return { width: 0, height: 0, lines: [], lineMetrics: [] };\n\n    const lines = text.split('\\n');\n    const lineMetrics = lines.map(line => this.measureText(line, font, useCache, containerElement));\n\n    const maxWidth = Math.max(...lineMetrics.map(m => m.width));\n    const fontSize = this._parseFontSize(font);\n\n    // Apply transformation to fontSize if container provided\n    let adjustedFontSize = fontSize;\n    let adjustedLineHeight = lineHeight;\n\n    if (containerElement) {\n      const transformInfo = this._getSvgTransformInfo(containerElement);\n      if (transformInfo) {\n        adjustedFontSize = transformInfo.pixelToViewBox(fontSize);\n        // Line height is a multiplier, so we need to apply it to the transformed font size\n        adjustedLineHeight = lineHeight;\n      }\n    }\n\n    const totalHeight = lines.length > 1\n      ? lineMetrics[0].ascent + ((lines.length - 1) * adjustedFontSize * adjustedLineHeight) + lineMetrics[lineMetrics.length - 1].descent\n      : lineMetrics[0]?.height || 0;\n\n    return {\n      width: maxWidth,\n      height: totalHeight,\n      lines,\n      lineMetrics,\n      // Store transform info for debugging\n      _transformApplied: !!containerElement,\n      _adjustedFontSize: adjustedFontSize\n    };\n  }\n\n  /**\n   * Calculate text bounding box at specific position with proper coordinate transformation\n   * @param {string} text - Text content\n   * @param {number} x - X position in viewBox coordinates\n   * @param {number} y - Y position in viewBox coordinates\n   * @param {string} font - CSS font string\n   * @param {string} textAnchor - SVG text-anchor value ('start', 'middle', 'end')\n   * @param {string} dominantBaseline - SVG dominant-baseline value\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {{left: number, right: number, top: number, bottom: number, width: number, height: number}}\n   */\n  static getTextBoundingBox(text, x, y, font = \"16px Arial\", textAnchor = 'start', dominantBaseline = 'auto', containerElement = null) {\n    const metrics = this.measureText(text, font, true, containerElement);\n\n    // Adjust for text anchor (x, y are already in viewBox coordinates)\n    let left = x;\n    if (textAnchor === 'middle') {\n      left = x - metrics.width / 2;\n    } else if (textAnchor === 'end') {\n      left = x - metrics.width;\n    }\n\n    // Adjust for baseline (y is already in viewBox coordinates)\n    let top = y - metrics.ascent;\n    if (dominantBaseline === 'middle') {\n      top = y - metrics.height / 2;\n    } else if (dominantBaseline === 'hanging') {\n      top = y;\n    }\n\n    const bbox = {\n      left,\n      right: left + metrics.width,\n      top,\n      bottom: top + metrics.height,\n      width: metrics.width,\n      height: metrics.height,\n      centerX: left + metrics.width / 2,\n      centerY: top + metrics.height / 2\n    };\n\n    console.log('[RendererUtils] Text bounding box calculation:', {\n      text: text.substring(0, 20) + (text.length > 20 ? '...' : ''),\n      inputPosition: { x, y },\n      textAnchor,\n      dominantBaseline,\n      metrics: {\n        width: metrics.width,\n        height: metrics.height,\n        ascent: metrics.ascent,\n        descent: metrics.descent\n      },\n      bbox,\n      hasContainer: !!containerElement\n    });\n\n    return bbox;\n  }\n\n  /**\n   * Get attachment points for connecting lines to text with proper coordinate transformation\n   * @param {string} text - Text content\n   * @param {number} x - X position\n   * @param {number} y - Y position\n   * @param {string} font - CSS font string\n   * @param {string} textAnchor - SVG text-anchor value\n   * @param {string} dominantBaseline - SVG dominant-baseline value\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {Object} Object with attachment points (top, bottom, left, right, etc.)\n   */\n  static getTextAttachmentPoints(text, x, y, font = \"16px Arial\", textAnchor = 'start', dominantBaseline = 'auto', containerElement = null) {\n    const bbox = this.getTextBoundingBox(text, x, y, font, textAnchor, dominantBaseline, containerElement);\n\n    // Calculate padding in viewBox coordinates - don't double-transform\n    const transformInfo = this._getSvgTransformInfo(containerElement);\n    const basePadding = 4; // Base padding value\n    const padding = transformInfo ? transformInfo.pixelToViewBox(basePadding) : basePadding;\n\n    return {\n      // Cardinal directions\n      top: [bbox.centerX, bbox.top],\n      bottom: [bbox.centerX, bbox.bottom],\n      left: [bbox.left, bbox.centerY],\n      right: [bbox.right, bbox.centerY],\n      center: [bbox.centerX, bbox.centerY],\n\n      // Corners\n      topLeft: [bbox.left, bbox.top],\n      topRight: [bbox.right, bbox.top],\n      bottomLeft: [bbox.left, bbox.bottom],\n      bottomRight: [bbox.right, bbox.bottom],\n\n      // With padding for visual clearance (properly scaled)\n      topPadded: [bbox.centerX, bbox.top - padding],\n      bottomPadded: [bbox.centerX, bbox.bottom + padding],\n      leftPadded: [bbox.left - padding, bbox.centerY],\n      rightPadded: [bbox.right + padding, bbox.centerY]\n    };\n  }\n\n  /**\n   * Parse font size from CSS font string\n   * @private\n   * @param {string} font - CSS font string\n   * @returns {number} Font size in pixels\n   */\n  static _parseFontSize(font) {\n    const match = font.match(/(\\d+(?:\\.\\d+)?)px/);\n    return match ? parseFloat(match[1]) : 16;\n  }\n\n  /**\n   * Build CSS font string from text style object\n   * @param {Object} textStyle - Text style configuration\n   * @returns {string} CSS font string\n   */\n  static buildFontString(textStyle) {\n    const parts = [];\n\n    if (textStyle.fontStyle && textStyle.fontStyle !== 'normal') {\n      parts.push(textStyle.fontStyle);\n    }\n    if (textStyle.fontWeight && textStyle.fontWeight !== 'normal') {\n      parts.push(textStyle.fontWeight);\n    }\n\n    parts.push(`${textStyle.fontSize}px`);\n\n    if (textStyle.fontFamily && textStyle.fontFamily !== 'inherit') {\n      parts.push(textStyle.fontFamily);\n    } else {\n      parts.push('Arial, sans-serif');\n    }\n\n    return parts.join(' ');\n  }\n\n  /**\n   * Resolve effective font-family when textStyle uses 'inherit'.\n   * Tries: svg element -> container element -> documentElement -> fallback.\n   */\n  static resolveFontFamily(textStyle, containerElement) {\n    if (textStyle.fontFamily && textStyle.fontFamily !== 'inherit') {\n      return textStyle.fontFamily;\n    }\n    try {\n      const svg = containerElement?.querySelector?.('svg');\n      const target = svg || containerElement || document.documentElement;\n      const computed = window.getComputedStyle(target).fontFamily;\n      if (computed && computed !== 'inherit') return computed;\n    } catch (e) {\n      console.warn('[RendererUtils] resolveFontFamily failed:', e);\n    }\n    return 'Arial, sans-serif';\n  }\n\n  /**\n   * Build a font string adjusted for measurement so canvas uses the ACTUAL on-screen pixel size.\n   * Without this, we measure at raw user-unit size (too large when viewBox scales down),\n   * leading to overestimated widths and misplaced decorations (e.g., status indicator).\n   */\n  static buildMeasurementFontString(textStyle, containerElement) {\n    // Resolve actual inherited font-family instead of fallback\n    const fontFamily = this.resolveFontFamily(textStyle, containerElement);\n    const fontStyle = (textStyle.fontStyle && textStyle.fontStyle !== 'normal') ? `${textStyle.fontStyle} ` : '';\n    const fontWeight = (textStyle.fontWeight && textStyle.fontWeight !== 'normal') ? `${textStyle.fontWeight} ` : '';\n\n    let adjustedPx = textStyle.fontSize;\n    if (containerElement) {\n      const transformInfo = this._getSvgTransformInfo(containerElement);\n      if (transformInfo) {\n        const screenPxPerViewBoxUnit = transformInfo.screenRect.width / transformInfo.viewBox[2];\n        adjustedPx = textStyle.fontSize * screenPxPerViewBoxUnit;\n      }\n    }\n\n    return `${fontStyle}${fontWeight}${adjustedPx}px ${fontFamily}`;\n  }\n\n  /**\n   * Clear text measurement cache\n   */\n  static clearTextMeasureCache() {\n    if (window.cblcars?._textMeasureCache) {\n      window.cblcars._textMeasureCache.clear();\n    }\n  }\n\n  /**\n   * Get text measurement cache statistics\n   */\n  static getTextMeasureCacheStats() {\n    const cache = window.cblcars?._textMeasureCache;\n    return {\n      size: cache?.size || 0,\n      keys: cache ? Array.from(cache.keys()) : []\n    };\n  }\n\n  /**\n   * Parse gradient configuration from various formats\n   * @param {string|object} gradientConfig - Gradient configuration\n   * @returns {object|null} Parsed gradient configuration\n   */\n  static parseGradientConfig(gradientConfig) {\n    if (!gradientConfig) return null;\n\n    if (typeof gradientConfig === 'string') {\n      // Handle simple formats: \"red,blue\" or \"red-to-blue\"\n      if (gradientConfig.includes(',')) {\n        const colors = gradientConfig.split(',').map(c => c.trim());\n        return {\n          type: 'linear',\n          direction: 'horizontal',\n          stops: colors.map((color, index) => ({\n            offset: `${(index / (colors.length - 1)) * 100}%`,\n            color: color\n          }))\n        };\n      } else if (gradientConfig.includes('-to-')) {\n        const [color1, color2] = gradientConfig.split('-to-').map(c => c.trim());\n        return {\n          type: 'linear',\n          direction: 'horizontal',\n          stops: [\n            { offset: '0%', color: color1 },\n            { offset: '100%', color: color2 }\n          ]\n        };\n      }\n      return null;\n    }\n\n    if (typeof gradientConfig === 'object') {\n      return {\n        type: gradientConfig.type || 'linear',\n        direction: gradientConfig.direction || 'horizontal',\n        x1: gradientConfig.x1 || '0%',\n        y1: gradientConfig.y1 || '0%',\n        x2: gradientConfig.x2 || '100%',\n        y2: gradientConfig.y2 || '0%',\n        cx: gradientConfig.cx || '50%',\n        cy: gradientConfig.cy || '50%',\n        r: gradientConfig.r || '50%',\n        stops: gradientConfig.stops || [\n          { offset: '0%', color: gradientConfig.from || 'var(--lcars-orange)' },\n          { offset: '100%', color: gradientConfig.to || 'var(--lcars-red)' }\n        ]\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse pattern configuration from various formats\n   * @param {string|object} patternConfig - Pattern configuration\n   * @returns {object|null} Parsed pattern configuration\n   */\n  static parsePatternConfig(patternConfig) {\n    if (!patternConfig) return null;\n\n    if (typeof patternConfig === 'string') {\n      // Predefined patterns\n      const presets = {\n        dots: { type: 'dots', size: 8, color: 'currentColor', opacity: 0.5 },\n        lines: { type: 'lines', size: 4, color: 'currentColor', opacity: 0.5 },\n        diagonal: { type: 'diagonal', size: 8, color: 'currentColor', opacity: 0.5 },\n        grid: { type: 'grid', size: 10, color: 'currentColor', opacity: 0.3 }\n      };\n      return presets[patternConfig] || null;\n    }\n\n    if (typeof patternConfig === 'object') {\n      return {\n        type: patternConfig.type || 'dots',\n        size: Number(patternConfig.size || 8),\n        color: patternConfig.color || 'currentColor',\n        opacity: Number(patternConfig.opacity || 0.5),\n        content: patternConfig.content || null\n      };\n    }\n\n    return null;\n  }\n\n    /**\n   * Parse glow effect configuration\n   * @param {Object} glowConfig - Glow configuration object\n   * @returns {Object|null} Normalized glow configuration\n   */\n  static parseGlowConfig(glowConfig) {\n    if (!glowConfig) return null;\n\n    return {\n      color: glowConfig.color || 'var(--lcars-blue)',\n      blur: Number(glowConfig.blur || 3),\n      intensity: Number(glowConfig.intensity || 0.8)\n    };\n  }\n\n  // ========================\n  // UNIFIED STYLING SYSTEM\n  // ========================\n\n  /**\n   * Parse standardized text styling properties\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Normalized text style configuration\n   */\n  static parseStandardTextStyles(style) {\n    return {\n      // Core text properties\n      fontSize: Number(style.font_size || style.fontSize || 12),\n      fontFamily: style.font_family || style.fontFamily || 'monospace',\n      fontWeight: style.font_weight || style.fontWeight || 'normal',\n      fontStyle: style.font_style || style.fontStyle || 'normal',\n\n      // Text colors (with fallback chain)\n      textColor: style.text_color || style.textColor || style.color || 'var(--lcars-white)',\n      labelColor: style.label_color || style.labelColor || style.text_color || style.textColor || 'var(--lcars-white)',\n      valueColor: style.value_color || style.valueColor || style.text_color || style.textColor || 'var(--lcars-white)',\n\n      // Text alignment and positioning\n      textAlign: style.text_align || style.textAlign || 'left',\n      verticalAlign: style.vertical_align || style.verticalAlign || 'middle',\n\n      // Text effects\n      textShadow: this.parseTextShadowConfig(style.text_shadow || style.textShadow),\n      textStroke: this.parseTextStrokeConfig(style.text_stroke || style.textStroke),\n\n      // Line height and spacing\n      lineHeight: Number(style.line_height || style.lineHeight || 1.2),\n      letterSpacing: style.letter_spacing || style.letterSpacing || 'normal'\n    };\n  }\n\n  /**\n   * Parse standardized color properties\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Normalized color configuration\n   */\n  static parseStandardColorStyles(style) {\n    return {\n      // Primary colors\n      primaryColor: style.color || style.primary_color || style.primaryColor || 'var(--lcars-blue)',\n      backgroundColor: style.background_color || style.backgroundColor || 'transparent',\n      borderColor: style.border_color || style.borderColor || 'var(--lcars-gray)',\n\n      // Interactive states\n      hoverColor: style.hover_color || style.hoverColor || 'var(--lcars-yellow)',\n      activeColor: style.active_color || style.activeColor || 'var(--lcars-cyan)',\n      focusColor: style.focus_color || style.focusColor || 'var(--lcars-white)',\n      disabledColor: style.disabled_color || style.disabledColor || 'var(--lcars-gray)',\n\n      // Status colors\n      successColor: style.success_color || style.successColor || 'var(--lcars-green)',\n      warningColor: style.warning_color || style.warningColor || 'var(--lcars-yellow)',\n      errorColor: style.error_color || style.errorColor || 'var(--lcars-red)',\n      infoColor: style.info_color || style.infoColor || 'var(--lcars-cyan)'\n    };\n  }\n\n  /**\n   * Parse standardized layout and spacing properties\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Normalized layout configuration\n   */\n  static parseStandardLayoutStyles(style) {\n    return {\n      // Border properties\n      borderWidth: Number(style.border_width || style.borderWidth || 1),\n      borderRadius: Number(style.border_radius || style.borderRadius || 0),\n      borderStyle: style.border_style || style.borderStyle || 'solid',\n\n      // Spacing (supports both number and object formats)\n      padding: this.parsePaddingConfig(style.padding),\n      margin: this.parseMarginConfig(style.margin),\n\n      // Opacity and visibility\n      opacity: Number(style.opacity || 1),\n      visible: style.visible !== false,\n\n      // Size constraints\n      minWidth: style.min_width || style.minWidth || null,\n      maxWidth: style.max_width || style.maxWidth || null,\n      minHeight: style.min_height || style.minHeight || null,\n      maxHeight: style.max_height || style.maxHeight || null\n    };\n  }\n\n  /**\n   * Parse standardized interaction properties\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Normalized interaction configuration\n   */\n  static parseStandardInteractionStyles(style) {\n    return {\n      // Hover effects\n      hoverEnabled: style.hover_enabled !== false,\n      hoverScale: Number(style.hover_scale || style.hoverScale || 1.05),\n      hoverOpacity: Number(style.hover_opacity || style.hoverOpacity || 1),\n      hoverTransition: style.hover_transition || style.hoverTransition || 'all 0.2s ease',\n\n      // Click/touch effects\n      clickable: style.clickable !== false,\n      activeScale: Number(style.active_scale || style.activeScale || 0.95),\n\n      // Focus styles\n      focusEnabled: style.focus_enabled !== false,\n      focusOutline: style.focus_outline || style.focusOutline || true,\n\n      // Cursor\n      cursor: style.cursor || 'default'\n    };\n  }\n\n  /**\n   * Parse standardized animation properties\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Normalized animation configuration\n   */\n  static parseStandardAnimationStyles(style) {\n    return {\n      // Animation enablement\n      animatable: style.animatable !== false,\n\n      // Transition properties\n      transition: style.transition || 'all 0.3s ease',\n      transitionDelay: style.transition_delay || style.transitionDelay || '0s',\n      transitionDuration: style.transition_duration || style.transitionDuration || '0.3s',\n      transitionTimingFunction: style.transition_timing_function || style.transitionTimingFunction || 'ease',\n\n      // Animation properties\n      animationDuration: style.animation_duration || style.animationDuration || '1s',\n      animationTimingFunction: style.animation_timing_function || style.animationTimingFunction || 'ease',\n      animationDelay: style.animation_delay || style.animationDelay || '0s',\n      animationIterationCount: style.animation_iteration_count || style.animationIterationCount || '1',\n      animationDirection: style.animation_direction || style.animationDirection || 'normal',\n      animationFillMode: style.animation_fill_mode || style.animationFillMode || 'both',\n\n      // Custom animation properties\n      cascadeSpeed: Number(style.cascade_speed || style.cascadeSpeed || 0),\n      cascadeDirection: style.cascade_direction || style.cascadeDirection || 'row',\n      revealAnimation: style.reveal_animation || style.revealAnimation || false,\n      pulseOnChange: style.pulse_on_change || style.pulseOnChange || false\n    };\n  }\n\n  /**\n   * Parse all standard styles in one call\n   * @param {Object} style - Style configuration object\n   * @returns {Object} Complete normalized style configuration\n   */\n  static parseAllStandardStyles(style) {\n    return {\n      text: this.parseStandardTextStyles(style),\n      colors: this.parseStandardColorStyles(style),\n      layout: this.parseStandardLayoutStyles(style),\n      interaction: this.parseStandardInteractionStyles(style),\n      animation: this.parseStandardAnimationStyles(style),\n\n      // Effects (existing methods)\n      gradient: this.parseGradientConfig(style.gradient),\n      pattern: this.parsePatternConfig(style.pattern),\n      glow: this.parseGlowConfig(style.glow),\n      shadow: this.parseShadowConfig(style.shadow),\n      blur: this.parseBlurConfig(style.blur)\n    };\n  }\n\n  // ========================\n  // HELPER PARSING METHODS\n  // ========================\n\n  /**\n   * Parse text shadow configuration\n   * @param {Object} shadowConfig - Text shadow configuration\n   * @returns {Object|null} Normalized text shadow configuration\n   */\n  static parseTextShadowConfig(shadowConfig) {\n    if (!shadowConfig) return null;\n\n    return {\n      offsetX: Number(shadowConfig.offset_x || shadowConfig.offsetX || 1),\n      offsetY: Number(shadowConfig.offset_y || shadowConfig.offsetY || 1),\n      blur: Number(shadowConfig.blur || 2),\n      color: shadowConfig.color || 'rgba(0,0,0,0.5)'\n    };\n  }\n\n  /**\n   * Parse text stroke configuration\n   * @param {Object} strokeConfig - Text stroke configuration\n   * @returns {Object|null} Normalized text stroke configuration\n   */\n  static parseTextStrokeConfig(strokeConfig) {\n    if (!strokeConfig) return null;\n\n    return {\n      width: Number(strokeConfig.width || 1),\n      color: strokeConfig.color || 'var(--lcars-gray)',\n      opacity: Number(strokeConfig.opacity || 1)\n    };\n  }\n\n  /**\n   * Parse padding configuration (supports number or object)\n   * @param {number|Object} padding - Padding configuration\n   * @returns {Object} Normalized padding configuration\n   */\n  static parsePaddingConfig(padding) {\n    if (typeof padding === 'number') {\n      return { top: padding, right: padding, bottom: padding, left: padding };\n    }\n\n    if (typeof padding === 'object' && padding !== null) {\n      return {\n        top: Number(padding.top || padding.vertical || 0),\n        right: Number(padding.right || padding.horizontal || 0),\n        bottom: Number(padding.bottom || padding.vertical || 0),\n        left: Number(padding.left || padding.horizontal || 0)\n      };\n    }\n\n    return { top: 0, right: 0, bottom: 0, left: 0 };\n  }\n\n  /**\n   * Parse margin configuration (supports number or object)\n   * @param {number|Object} margin - Margin configuration\n   * @returns {Object} Normalized margin configuration\n   */\n  static parseMarginConfig(margin) {\n    if (typeof margin === 'number') {\n      return { top: margin, right: margin, bottom: margin, left: margin };\n    }\n\n    if (typeof margin === 'object' && margin !== null) {\n      return {\n        top: Number(margin.top || margin.vertical || 0),\n        right: Number(margin.right || margin.horizontal || 0),\n        bottom: Number(margin.bottom || margin.vertical || 0),\n        left: Number(margin.left || margin.horizontal || 0)\n      };\n    }\n\n    return { top: 0, right: 0, bottom: 0, left: 0 };\n  }\n\n  // ========================\n  // STYLE APPLICATION HELPERS\n  // ========================\n\n  /**\n   * Apply standard text styles to an SVG text element\n   * @param {Object} textStyles - Parsed text styles\n   * @returns {string} SVG text attributes string\n   */\n  static applyStandardTextStyles(textStyles) {\n    const attributes = [];\n\n    attributes.push(`font-family=\"${textStyles.fontFamily}\"`);\n    attributes.push(`font-size=\"${textStyles.fontSize}\"`);\n    attributes.push(`font-weight=\"${textStyles.fontWeight}\"`);\n    attributes.push(`font-style=\"${textStyles.fontStyle}\"`);\n    attributes.push(`fill=\"${textStyles.textColor}\"`);\n    attributes.push(`text-anchor=\"${textStyles.textAlign}\"`);\n    attributes.push(`dominant-baseline=\"${textStyles.verticalAlign}\"`);\n    attributes.push(`letter-spacing=\"${textStyles.letterSpacing}\"`);\n\n    if (textStyles.textStroke) {\n      attributes.push(`stroke=\"${textStyles.textStroke.color}\"`);\n      attributes.push(`stroke-width=\"${textStyles.textStroke.width}\"`);\n      attributes.push(`stroke-opacity=\"${textStyles.textStroke.opacity}\"`);\n    }\n\n    return attributes.join(' ');\n  }\n\n  /**\n   * Apply standard layout styles to an SVG element\n   * @param {Object} layoutStyles - Parsed layout styles\n   * @returns {string} SVG element attributes string\n   */\n  static applyStandardLayoutStyles(layoutStyles) {\n    const attributes = [];\n\n    if (layoutStyles.borderWidth > 0) {\n      attributes.push(`stroke-width=\"${layoutStyles.borderWidth}\"`);\n    }\n\n    if (layoutStyles.borderRadius > 0) {\n      attributes.push(`rx=\"${layoutStyles.borderRadius}\"`);\n      attributes.push(`ry=\"${layoutStyles.borderRadius}\"`);\n    }\n\n    attributes.push(`opacity=\"${layoutStyles.opacity}\"`);\n\n    if (!layoutStyles.visible) {\n      attributes.push(`style=\"display: none\"`);\n    }\n\n    return attributes.join(' ');\n  }\n\n  /**\n   * Create CSS text-shadow value from parsed config\n   * @param {Object} textShadow - Parsed text shadow configuration\n   * @returns {string} CSS text-shadow value\n   */\n  static createTextShadowCSS(textShadow) {\n    if (!textShadow) return '';\n    return `${textShadow.offsetX}px ${textShadow.offsetY}px ${textShadow.blur}px ${textShadow.color}`;\n  }\n\n  /**\n   * Generate data attributes for animation integration\n   * @param {Object} animationStyles - Parsed animation styles\n   * @returns {string} Data attributes string\n   */\n  static createAnimationDataAttributes(animationStyles) {\n    const attributes = [];\n\n    if (animationStyles.animatable) {\n      attributes.push(`data-animatable=\"true\"`);\n    }\n\n    if (animationStyles.cascadeSpeed > 0) {\n      attributes.push(`data-cascade-speed=\"${animationStyles.cascadeSpeed}\"`);\n      attributes.push(`data-cascade-direction=\"${animationStyles.cascadeDirection}\"`);\n    }\n\n    if (animationStyles.revealAnimation) {\n      attributes.push(`data-reveal-animation=\"true\"`);\n    }\n\n    if (animationStyles.pulseOnChange) {\n      attributes.push(`data-pulse-on-change=\"true\"`);\n    }\n\n    return attributes.join(' ');\n  }\n\n  /**\n   * Parse shadow effect configuration\n   * @param {string|object|boolean} shadowConfig - Shadow configuration\n   * @returns {object|null} Parsed shadow configuration\n   */\n  static parseShadowConfig(shadowConfig) {\n    if (!shadowConfig) return null;\n\n    if (shadowConfig === true) {\n      return { color: 'rgba(0,0,0,0.3)', offsetX: 2, offsetY: 2, blur: 3 };\n    }\n\n    if (typeof shadowConfig === 'string') {\n      // Parse \"2 2 3 rgba(0,0,0,0.3)\" format\n      const parts = shadowConfig.split(' ');\n      return {\n        offsetX: Number(parts[0]) || 2,\n        offsetY: Number(parts[1]) || 2,\n        blur: Number(parts[2]) || 3,\n        color: parts[3] || 'rgba(0,0,0,0.3)'\n      };\n    }\n\n    if (typeof shadowConfig === 'object') {\n      return {\n        color: shadowConfig.color || 'rgba(0,0,0,0.3)',\n        offsetX: Number(shadowConfig.offsetX || shadowConfig.offset?.[0] || 2),\n        offsetY: Number(shadowConfig.offsetY || shadowConfig.offset?.[1] || 2),\n        blur: Number(shadowConfig.blur || 3)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse blur effect configuration\n   * @param {number|string|object} blurConfig - Blur configuration\n   * @returns {object|null} Parsed blur configuration\n   */\n  static parseBlurConfig(blurConfig) {\n    if (!blurConfig) return null;\n\n    if (typeof blurConfig === 'number') {\n      return { amount: blurConfig };\n    }\n\n    if (typeof blurConfig === 'string') {\n      return { amount: Number(blurConfig) || 1 };\n    }\n\n    if (typeof blurConfig === 'object') {\n      return { amount: Number(blurConfig.amount || blurConfig.blur || 1) };\n    }\n\n    return null;\n  }\n\n  /**\n   * Create gradient definition SVG\n   * @param {object} gradient - Parsed gradient configuration\n   * @param {string} id - Unique ID for the gradient\n   * @returns {string} SVG gradient definition\n   */\n  static createGradientDefinition(gradient, id) {\n    if (gradient.type === 'radial') {\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<radialGradient id=\"${id}\" cx=\"${gradient.cx}\" cy=\"${gradient.cy}\" r=\"${gradient.r}\">\n                ${stops}\n              </radialGradient>`;\n    } else {\n      // Linear gradient\n      const coords = this.getLinearGradientCoords(gradient.direction, gradient);\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<linearGradient id=\"${id}\" ${coords}>\n                ${stops}\n              </linearGradient>`;\n    }\n  }\n\n  /**\n   * Get linear gradient coordinates based on direction\n   * @param {string} direction - Gradient direction\n   * @param {object} gradient - Gradient configuration (for custom coordinates)\n   * @returns {string} SVG coordinate attributes\n   */\n  static getLinearGradientCoords(direction, gradient = {}) {\n    // Use custom coordinates if provided\n    if (gradient.x1 !== undefined) {\n      return `x1=\"${gradient.x1}\" y1=\"${gradient.y1}\" x2=\"${gradient.x2}\" y2=\"${gradient.y2}\"`;\n    }\n\n    // Predefined directions\n    const directions = {\n      horizontal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"',\n      vertical: 'x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      diagonal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"',\n      'diagonal-reverse': 'x1=\"100%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      'to-right': 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"',\n      'to-left': 'x1=\"100%\" y1=\"0%\" x2=\"0%\" y2=\"0%\"',\n      'to-bottom': 'x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      'to-top': 'x1=\"0%\" y1=\"100%\" x2=\"0%\" y2=\"0%\"'\n    };\n\n    return directions[direction] || directions.horizontal;\n  }\n\n  /**\n   * Create pattern definition SVG\n   * @param {object} pattern - Parsed pattern configuration\n   * @param {string} id - Unique ID for the pattern\n   * @returns {string} SVG pattern definition\n   */\n  static createPatternDefinition(pattern, id) {\n    const size = pattern.size;\n    const color = pattern.color;\n    const opacity = pattern.opacity;\n\n    let patternContent = '';\n\n    switch (pattern.type) {\n      case 'dots':\n        patternContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"1\"\n                                  fill=\"${color}\" opacity=\"${opacity}\"/>`;\n        break;\n\n      case 'lines':\n        patternContent = `<path d=\"M 0,${size} l ${size},-${size} M -1,1 l 2,-2 M ${size-1},${size+1} l 2,-2\"\n                                stroke=\"${color}\" stroke-width=\"1\" opacity=\"${opacity}\"/>`;\n        break;\n\n      case 'diagonal':\n        patternContent = `<path d=\"M0,${size} L${size},0\"\n                                stroke=\"${color}\" stroke-width=\"1\" opacity=\"${opacity}\"/>`;\n        break;\n\n      case 'grid':\n        patternContent = `\n          <path d=\"M0,0 L0,${size}\" stroke=\"${color}\" stroke-width=\"0.5\" opacity=\"${opacity}\"/>\n          <path d=\"M0,0 L${size},0\" stroke=\"${color}\" stroke-width=\"0.5\" opacity=\"${opacity}\"/>\n        `;\n        break;\n\n      case 'custom':\n        patternContent = pattern.content || '';\n        break;\n\n      default:\n        // Default to dots\n        patternContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"1\"\n                                  fill=\"${color}\" opacity=\"${opacity}\"/>`;\n    }\n\n    return `<pattern id=\"${id}\" x=\"0\" y=\"0\" width=\"${size}\" height=\"${size}\"\n                     patternUnits=\"userSpaceOnUse\">\n              ${patternContent}\n            </pattern>`;\n  }\n\n  /**\n   * Create glow filter SVG\n   * @param {object} glow - Parsed glow configuration\n   * @param {string} id - Unique ID for the filter\n   * @returns {string} SVG filter definition\n   */\n  static createGlowFilter(glow, id) {\n    const size = glow.size || 4;\n    const color = glow.color || 'currentColor';\n    const intensity = glow.intensity || 1;\n\n    // Enhanced filter for better glow effect\n    return `<filter id=\"${id}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feGaussianBlur stdDeviation=\"${size}\" result=\"coloredBlur\"/>\n              <feFlood flood-color=\"${color}\" flood-opacity=\"${intensity}\"/>\n              <feComposite in=\"flood\" in2=\"coloredBlur\" operator=\"in\" result=\"glowColor\"/>\n              <feMerge>\n                <feMergeNode in=\"glowColor\"/>\n                <feMergeNode in=\"SourceGraphic\"/>\n              </feMerge>\n            </filter>`;\n  }\n\n  /**\n   * Create shadow filter SVG\n   * @param {object} shadow - Parsed shadow configuration\n   * @param {string} id - Unique ID for the filter\n   * @returns {string} SVG filter definition\n   */\n  static createShadowFilter(shadow, id) {\n    const offsetX = shadow.offsetX || 2;\n    const offsetY = shadow.offsetY || 2;\n    const blur = shadow.blur || 3;\n    const color = shadow.color || 'rgba(0,0,0,0.3)';\n\n    return `<filter id=\"${id}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feDropShadow dx=\"${offsetX}\" dy=\"${offsetY}\"\n                           stdDeviation=\"${blur}\"\n                           flood-color=\"${color}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Create blur filter SVG\n   * @param {object} blur - Parsed blur configuration\n   * @param {string} id - Unique ID for the filter\n   * @returns {string} SVG filter definition\n   */\n  static createBlurFilter(blur, id) {\n    const amount = blur.amount || 1;\n\n    return `<filter id=\"${id}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feGaussianBlur stdDeviation=\"${amount}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Create LCARS-style bracket path\n   * @param {number} width - Bracket width\n   * @param {number} height - Bracket height\n   * @param {string} side - 'left' or 'right'\n   * @param {object} options - Styling options\n   * @returns {string} SVG path for bracket\n   */\n  static createLcarsBracket(width, height, side = 'left', options = {}) {\n    const bracketWidth = options.bracketWidth || 8;\n    const cornerRadius = options.cornerRadius || 2;\n    const strokeWidth = options.strokeWidth || 2;\n    const color = options.color || 'var(--lcars-orange)';\n\n    let pathData = '';\n\n    if (side === 'left') {\n      pathData = `M ${width} 0 L ${cornerRadius} 0\n                  Q 0 0 0 ${cornerRadius}\n                  L 0 ${height - cornerRadius}\n                  Q 0 ${height} ${cornerRadius} ${height}\n                  L ${width} ${height}`;\n    } else {\n      pathData = `M 0 0 L ${width - cornerRadius} 0\n                  Q ${width} 0 ${width} ${cornerRadius}\n                  L ${width} ${height - cornerRadius}\n                  Q ${width} ${height} ${width - cornerRadius} ${height}\n                  L 0 ${height}`;\n    }\n\n    return `<path d=\"${pathData}\"\n                  stroke=\"${color}\"\n                  stroke-width=\"${strokeWidth}\"\n                  fill=\"none\"/>`;\n  }\n\n  /**\n   * Create marker definition for arrows, dots, etc.\n   * @param {object} marker - Marker configuration\n   * @param {string} id - Unique ID for the marker\n   * @returns {string} SVG marker definition\n   */\n  static createMarkerDefinition(marker, id) {\n    const size = this.getMarkerSize(marker.size || 'medium');\n    const color = marker.color === 'inherit' ? 'currentColor' : marker.color;\n\n    let markerContent = '';\n    let viewBox = `0 0 ${size} ${size}`;\n    let refX = size / 2;\n    let refY = size / 2;\n\n    switch (marker.type) {\n      case 'arrow':\n        viewBox = '0 0 10 10';\n        refX = 8;\n        refY = 5;\n        markerContent = `<path d=\"M2,2 L8,5 L2,8 z\" fill=\"${color}\"/>`;\n        break;\n\n      case 'dot':\n      case 'circle':\n        markerContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/4}\" fill=\"${color}\"/>`;\n        break;\n\n      case 'diamond':\n        markerContent = `<path d=\"M${size/2},2 L${size-2},${size/2} L${size/2},${size-2} L2,${size/2} z\" fill=\"${color}\"/>`;\n        break;\n\n      case 'square':\n        markerContent = `<rect x=\"2\" y=\"2\" width=\"${size-4}\" height=\"${size-4}\" fill=\"${color}\"/>`;\n        break;\n\n      case 'triangle':\n        markerContent = `<path d=\"M${size/2},2 L${size-2},${size-2} L2,${size-2} z\" fill=\"${color}\"/>`;\n        break;\n\n      default:\n        markerContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/4}\" fill=\"${color}\"/>`;\n    }\n\n    return `<marker id=\"${id}\"\n                    viewBox=\"${viewBox}\"\n                    refX=\"${refX}\" refY=\"${refY}\"\n                    markerWidth=\"${size}\" markerHeight=\"${size}\"\n                    markerUnits=\"strokeWidth\"\n                    orient=\"${marker.rotate !== false ? 'auto' : '0'}\">\n              ${markerContent}\n            </marker>`;\n  }\n\n  /**\n   * Get numeric marker size from size descriptor\n   * @param {string|number} size - Size descriptor\n   * @returns {number} Numeric size\n   */\n  static getMarkerSize(size) {\n    if (typeof size === 'number') return size;\n\n    const sizes = {\n      small: 6,\n      medium: 8,\n      large: 12,\n      xlarge: 16\n    };\n\n    return sizes[size] || 8;\n  }\n\n  /**\n   * Escape XML special characters\n   * @param {string} text - Text to escape\n   * @returns {string} Escaped text\n   */\n  static escapeXml(text) {\n    return String(text)\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n\n  /**\n   * Generate unique ID for elements\n   * @param {string} prefix - Prefix for the ID\n   * @param {string} suffix - Suffix for the ID\n   * @returns {string} Unique ID\n   */\n  static generateId(prefix = 'element', suffix = '') {\n    const timestamp = Date.now().toString(36);\n    const random = Math.random().toString(36).substr(2, 5);\n    return `${prefix}-${timestamp}-${random}${suffix ? '-' + suffix : ''}`;\n  }\n\n  /**\n   * Parse CSS color values and convert to various formats\n   * @param {string} color - CSS color value\n   * @returns {object} Color information\n   */\n  static parseColor(color) {\n    // Create a temporary element to leverage browser's color parsing\n    const tempElement = document.createElement('div');\n    tempElement.style.color = color;\n    document.body.appendChild(tempElement);\n\n    const computedColor = getComputedStyle(tempElement).color;\n    document.body.removeChild(tempElement);\n\n    // Parse RGB values\n    const rgbMatch = computedColor.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\n    if (rgbMatch) {\n      const r = parseInt(rgbMatch[1]);\n      const g = parseInt(rgbMatch[2]);\n      const b = parseInt(rgbMatch[3]);\n\n      return {\n        rgb: [r, g, b],\n        hex: this.rgbToHex(r, g, b),\n        hsl: this.rgbToHsl(r, g, b),\n        original: color,\n        computed: computedColor\n      };\n    }\n\n    return {\n      original: color,\n      computed: computedColor\n    };\n  }\n\n  /**\n   * Convert RGB to HEX\n   * @private\n   */\n  static rgbToHex(r, g, b) {\n    return \"#\" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\n  }\n\n  /**\n   * Convert RGB to HSL\n   * @private\n   */\n  static rgbToHsl(r, g, b) {\n    r /= 255;\n    g /= 255;\n    b /= 255;\n\n    const max = Math.max(r, g, b);\n    const min = Math.min(r, g, b);\n    let h, s, l = (max + min) / 2;\n\n    if (max === min) {\n      h = s = 0;\n    } else {\n      const d = max - min;\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n      switch (max) {\n        case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n        case g: h = (b - r) / d + 2; break;\n        case b: h = (r - g) / d + 4; break;\n      }\n      h /= 6;\n    }\n\n    return [Math.round(h * 360), Math.round(s * 100), Math.round(l * 100)];\n  }\n\n  /**\n   * Calculate optimal text contrast color\n   * @param {string} backgroundColor - Background color\n   * @returns {string} Optimal text color (black or white)\n   */\n  static getContrastColor(backgroundColor) {\n    const color = this.parseColor(backgroundColor);\n    if (!color.rgb) return '#ffffff';\n\n    const [r, g, b] = color.rgb;\n    const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;\n\n    return luminance > 0.5 ? '#000000' : '#ffffff';\n  }\n\n  /**\n   * Interpolate between two colors\n   * @param {string} color1 - Start color\n   * @param {string} color2 - End color\n   * @param {number} factor - Interpolation factor (0-1)\n   * @returns {string} Interpolated color\n   */\n  static interpolateColor(color1, color2, factor) {\n    const c1 = this.parseColor(color1);\n    const c2 = this.parseColor(color2);\n\n    if (!c1.rgb || !c2.rgb) return color1;\n\n    const r = Math.round(c1.rgb[0] + (c2.rgb[0] - c1.rgb[0]) * factor);\n    const g = Math.round(c1.rgb[1] + (c2.rgb[1] - c1.rgb[1]) * factor);\n    const b = Math.round(c1.rgb[2] + (c2.rgb[2] - c1.rgb[2]) * factor);\n\n    return `rgb(${r}, ${g}, ${b})`;\n  }\n\n  /**\n   * Create animation-ready attributes for future anime.js integration\n   * @param {object} animationConfig - Animation configuration\n   * @returns {array} Array of attribute strings\n   */\n  static createAnimationAttributes(animationConfig = {}) {\n    const attributes = [];\n\n    if (animationConfig.animatable !== false) {\n      attributes.push('data-animatable=\"true\"');\n    }\n\n    Object.keys(animationConfig).forEach(key => {\n      if (key.endsWith('_speed') || key.endsWith('Speed')) {\n        const value = animationConfig[key];\n        if (value > 0) {\n          const dataKey = key.replace(/([A-Z])/g, '-$1').toLowerCase().replace('_', '-');\n          attributes.push(`data-${dataKey}=\"${value}\"`);\n        }\n      }\n    });\n\n    if (animationConfig.animation_ref || animationConfig.animationRef) {\n      const ref = animationConfig.animation_ref || animationConfig.animationRef;\n      attributes.push(`data-animation-ref=\"${ref}\"`);\n    }\n\n    return attributes;\n  }\n\n  /**\n   * Validate and sanitize style values\n   * @param {object} styles - Style object to validate\n   * @returns {object} Sanitized styles\n   */\n  static sanitizeStyles(styles) {\n    const sanitized = {};\n\n    // Define allowed properties and their validation functions\n    const validators = {\n      color: (value) => this.isValidColor(value),\n      opacity: (value) => this.isValidOpacity(value),\n      width: (value) => this.isValidNumber(value),\n      height: (value) => this.isValidNumber(value),\n      stroke: (value) => this.isValidColor(value),\n      fill: (value) => this.isValidColor(value) || value === 'none',\n      fontSize: (value) => this.isValidNumber(value),\n      fontFamily: (value) => this.isValidString(value)\n    };\n\n    Object.keys(styles).forEach(key => {\n      const validator = validators[key] || validators[this.camelToKebab(key)];\n      if (validator && validator(styles[key])) {\n        sanitized[key] = styles[key];\n      }\n    });\n\n    return sanitized;\n  }\n\n  /**\n   * Check if value is a valid color\n   * @private\n   */\n  static isValidColor(value) {\n    if (typeof value !== 'string') return false;\n    return /^(#[0-9a-f]{3,8}|rgb\\(|rgba\\(|hsl\\(|hsla\\(|var\\(--|\\w+)/.test(value.toLowerCase());\n  }\n\n  /**\n   * Check if value is a valid opacity\n   * @private\n   */\n  static isValidOpacity(value) {\n    const num = Number(value);\n    return !isNaN(num) && num >= 0 && num <= 1;\n  }\n\n  /**\n   * Check if value is a valid number\n   * @private\n   */\n  static isValidNumber(value) {\n    return !isNaN(Number(value)) && isFinite(Number(value));\n  }\n\n  /**\n   * Check if value is a valid string\n   * @private\n   */\n  static isValidString(value) {\n    return typeof value === 'string' && value.length > 0;\n  }\n\n  /**\n   * Convert camelCase to kebab-case\n   * @private\n   */\n  static camelToKebab(str) {\n    return str.replace(/([A-Z])/g, '-$1').toLowerCase();\n  }\n\n  /**\n   * Get DOM text bounding box for glyphs (after font load)\n   * @param {Element} groupEl - SVG group element containing the text\n   * @returns {Object|null} Bounding box object with width, height, and position\n   */\n  static getDomTextBBox(groupEl) {\n    try {\n      if (!groupEl) return null;\n      const textEl = groupEl.querySelector('text');\n      if (!textEl) return null;\n      const bb = textEl.getBBox();\n      return {\n        width: bb.width,\n        height: bb.height,\n        left: bb.x,\n        top: bb.y,\n        right: bb.x + bb.width,\n        bottom: bb.y + bb.height,\n        centerX: bb.x + bb.width / 2,\n        centerY: bb.y + bb.height / 2\n      };\n    } catch(_) {\n      return null;\n    }\n  }\n}","/**\n * Status Grid Renderer - Grid-based multi-entity status visualization with LCARS theming\n * Provides compact status displays perfect for cascade animations and multi-sensor monitoring\n */\n\nimport { PositionResolver } from './PositionResolver.js';\nimport { RendererUtils } from './RendererUtils.js';\nimport { DataSourceMixin } from './DataSourceMixin.js';\n\nexport class StatusGridRenderer {\n  constructor() {\n    // Pre-defined caches for performance optimization\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n    this.filterCache = new Map();\n  }\n\n  /**\n   * Render a status grid overlay with comprehensive styling support\n   * @param {Object} overlay - Status grid overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled status grid\n   */\n  static render(overlay, anchors, viewBox) {\n    // Create instance for non-static methods\n    const instance = new StatusGridRenderer();\n    return instance.renderStatusGrid(overlay, anchors, viewBox);\n  }\n\n  /**\n   * Instance method for comprehensive status grid rendering\n   * @param {Object} overlay - Status grid overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled status grid\n   */\n  renderStatusGrid(overlay, anchors, viewBox) {\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) {\n      console.warn('[StatusGridRenderer] Status grid overlay position could not be resolved:', overlay.id);\n      return '';\n    }\n\n    const [x, y] = position;\n    const size = overlay.size || [200, 150];\n    const [width, height] = size;\n\n    try {\n      // Extract comprehensive styling\n      const style = overlay.finalStyle || overlay.style || {};\n      const gridStyle = this._resolveStatusGridStyles(style, overlay.id, overlay);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      // Get cell configurations\n      const cells = this._resolveCellConfigurations(overlay, gridStyle);\n      console.log(`[StatusGridRenderer] Rendering ${cells.length} cells for grid ${overlay.id}`);\n\n      // Render enhanced status grid\n      return this._renderEnhancedStatusGrid(\n        overlay, x, y, width, height, cells,\n        gridStyle, animationAttributes\n      );\n\n    } catch (error) {\n      console.error(`[StatusGridRenderer] Enhanced rendering failed for status grid ${overlay.id}:`, error);\n      return this._renderFallbackStatusGrid(overlay, x, y, width, height);\n    }\n  }\n\n  /**\n   * Resolve comprehensive status grid styling from configuration\n   * @private\n   */\n  _resolveStatusGridStyles(style, overlayId, overlay = null) {\n    // Parse all standard styles using unified system\n    const standardStyles = RendererUtils.parseAllStandardStyles(style);\n\n    const gridStyle = {\n      // Grid layout - Following documentation schema: rows/columns are in style\n      rows: Number(style.rows || 3),\n      columns: Number(style.columns || 4),\n      cell_width: Number(style.cell_width || style.cellWidth || 0), // 0 = auto\n      cell_height: Number(style.cell_height || style.cellHeight || 0), // 0 = auto\n      cell_gap: Number(style.cell_gap || style.cellGap || 2),\n\n      // Cell appearance (using standardized colors)\n      cell_color: standardStyles.colors.primaryColor,\n      cell_opacity: standardStyles.layout.opacity,\n      cell_radius: standardStyles.layout.borderRadius || 2,\n\n      // Border (using standardized layout)\n      cell_border: style.cell_border || style.cellBorder !== false,\n      border_color: standardStyles.colors.borderColor,\n      border_width: standardStyles.layout.borderWidth,\n\n      // Text (using standardized text styles)\n      show_labels: style.show_labels !== false,\n      show_values: style.show_values || false,\n      label_color: standardStyles.text.labelColor,\n      value_color: standardStyles.text.valueColor,\n      font_size: standardStyles.text.fontSize,\n      font_family: standardStyles.text.fontFamily,\n      font_weight: standardStyles.text.fontWeight,\n\n      // Status coloring\n      status_mode: (style.status_mode || style.statusMode || 'auto').toLowerCase(),\n      status_ranges: this._parseStatusRanges(style.status_ranges || style.statusRanges),\n      unknown_color: standardStyles.colors.disabledColor,\n\n      // Grid features\n      show_grid_lines: style.show_grid_lines || style.showGridLines || false,\n      grid_line_color: style.grid_line_color || style.gridLineColor || standardStyles.colors.borderColor,\n      grid_line_opacity: Number(style.grid_line_opacity || style.gridLineOpacity || 0.3),\n\n      // Effects (using standardized effect parsing)\n      gradient: standardStyles.gradient,\n      pattern: standardStyles.pattern,\n      glow: standardStyles.glow,\n      shadow: standardStyles.shadow,\n      blur: standardStyles.blur,\n\n      // LCARS-specific features\n      bracket_style: style.bracket_style || style.bracketStyle || false,\n      bracket_color: style.bracket_color || style.bracketColor || standardStyles.colors.primaryColor,\n      status_indicator: style.status_indicator || style.statusIndicator || false,\n      lcars_corners: style.lcars_corners || style.lcarsCorners || false,\n\n      // Interaction (using standardized interaction styles)\n      hover_enabled: standardStyles.interaction.hoverEnabled,\n      hover_color: standardStyles.colors.hoverColor,\n      hover_scale: standardStyles.interaction.hoverScale,\n\n      // Animation (using standardized animation styles)\n      animatable: standardStyles.animation.animatable,\n      cascade_speed: standardStyles.animation.cascadeSpeed,\n      cascade_direction: standardStyles.animation.cascadeDirection,\n      reveal_animation: standardStyles.animation.revealAnimation,\n      pulse_on_change: standardStyles.animation.pulseOnChange,\n\n      // Performance options\n      update_throttle: Number(style.update_throttle || style.updateThrottle || 100),\n\n      // Track enabled features for optimization\n      features: [],\n\n      // Store parsed standard styles for reference\n      standardStyles\n    };\n\n    // Build feature list for conditional rendering\n    if (gridStyle.gradient) gridStyle.features.push('gradient');\n    if (gridStyle.pattern) gridStyle.features.push('pattern');\n    if (gridStyle.status_ranges && gridStyle.status_ranges.length > 0) gridStyle.features.push('status-ranges');\n    if (gridStyle.glow) gridStyle.features.push('glow');\n    if (gridStyle.shadow) gridStyle.features.push('shadow');\n    if (gridStyle.blur) gridStyle.features.push('blur');\n    if (gridStyle.show_grid_lines) gridStyle.features.push('grid-lines');\n    if (gridStyle.show_labels) gridStyle.features.push('labels');\n    if (gridStyle.show_values) gridStyle.features.push('values');\n    if (gridStyle.bracket_style) gridStyle.features.push('brackets');\n    if (gridStyle.status_indicator) gridStyle.features.push('status');\n    if (gridStyle.lcars_corners) gridStyle.features.push('lcars-corners');\n    if (gridStyle.hover_enabled) gridStyle.features.push('hover');\n    if (gridStyle.cascade_speed > 0) gridStyle.features.push('cascade');\n    if (gridStyle.reveal_animation) gridStyle.features.push('reveal');\n    if (gridStyle.pulse_on_change) gridStyle.features.push('pulse');\n\n    return gridStyle;\n  }  /**\n   * Parse status ranges configuration\n   * @private\n   */\n  _parseStatusRanges(statusRanges) {\n    if (!statusRanges || !Array.isArray(statusRanges)) return [];\n\n    return statusRanges.map(range => ({\n      min: Number(range.min ?? -Infinity),\n      max: Number(range.max ?? Infinity),\n      color: range.color || 'var(--lcars-blue)',\n      label: range.label || null,\n      // Support string matching too\n      value: range.value || null,\n      state: range.state || null\n    }));\n  }\n\n  /**\n   * Prepare animation attributes for anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    const animationStyles = RendererUtils.parseStandardAnimationStyles(style);\n\n    const animationAttributes = {\n      gridAttributes: [],\n      cellAttributes: [],\n      hasAnimations: false\n    };\n\n    // Use standardized animation data attributes\n    const animationDataAttrs = RendererUtils.createAnimationDataAttributes(animationStyles);\n    if (animationDataAttrs) {\n      animationAttributes.gridAttributes.push(animationDataAttrs);\n      animationAttributes.hasAnimations = true;\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Enhanced rendering method with complete Status Grid implementation\n   * @private\n   */\n  _renderEnhancedStatusGrid(overlay, x, y, width, height, cells, gridStyle, animationAttributes) {\n    // Calculate cell dimensions\n    const cellWidth = gridStyle.cell_width || (width / gridStyle.columns);\n    const cellHeight = gridStyle.cell_height || (height / gridStyle.rows);\n    const gap = gridStyle.cell_gap;\n\n    // Start building the grid SVG\n    let gridMarkup = `<g data-overlay-id=\"${overlay.id}\"\n                data-overlay-type=\"status_grid\"\n                data-grid-rows=\"${gridStyle.rows}\"\n                data-grid-columns=\"${gridStyle.columns}\"\n                data-grid-features=\"${gridStyle.features.join(',')}\"\n                data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                data-cascade-direction=\"${gridStyle.cascade_direction}\"\n                transform=\"translate(${x}, ${y})\">`;\n\n    // Render grid background if enabled\n    if (gridStyle.show_grid_lines) {\n      gridMarkup += `<rect width=\"${width}\" height=\"${height}\"\n                     fill=\"none\" stroke=\"${gridStyle.grid_line_color}\"\n                     stroke-width=\"1\" opacity=\"${gridStyle.grid_line_opacity}\"/>`;\n    }\n\n    // Render each cell\n    cells.forEach(cell => {\n      const cellX = cell.col * (cellWidth + gap);\n      const cellY = cell.row * (cellHeight + gap);\n\n      // Determine cell color based on status\n      const cellColor = this._determineCellColor(cell, gridStyle);\n\n      // Render cell rectangle\n      gridMarkup += `<rect x=\"${cellX}\" y=\"${cellY}\"\n                     width=\"${cellWidth - gap}\" height=\"${cellHeight - gap}\"\n                     fill=\"${cellColor}\"\n                     stroke=\"${gridStyle.border_color}\"\n                     stroke-width=\"${gridStyle.border_width}\"\n                     rx=\"${gridStyle.cell_radius}\"\n                     data-cell-id=\"${cell.id}\"\n                     data-cell-row=\"${cell.row}\"\n                     data-cell-col=\"${cell.col}\"/>`;\n\n      // Render cell label if enabled\n      if (gridStyle.show_labels && cell.label) {\n        const labelX = cellX + (cellWidth - gap) / 2;\n        const labelY = cellY + (cellHeight - gap) / 2 - (gridStyle.font_size / 4);\n\n        gridMarkup += `<text x=\"${labelX}\" y=\"${labelY}\"\n                       text-anchor=\"middle\" dominant-baseline=\"middle\"\n                       fill=\"${gridStyle.label_color}\"\n                       font-size=\"${gridStyle.font_size * 0.7}\"\n                       font-family=\"${gridStyle.font_family}\"\n                       data-cell-label=\"${cell.id}\">\n                       ${this._escapeXml(cell.label)}\n                     </text>`;\n      }\n\n      // Render cell content/value if enabled\n      if (gridStyle.show_values && cell.content) {\n        const valueX = cellX + (cellWidth - gap) / 2;\n        const valueY = cellY + (cellHeight - gap) / 2 + (gridStyle.font_size / 4);\n\n        gridMarkup += `<text x=\"${valueX}\" y=\"${valueY}\"\n                       text-anchor=\"middle\" dominant-baseline=\"middle\"\n                       fill=\"${gridStyle.value_color}\"\n                       font-size=\"${gridStyle.font_size * 0.6}\"\n                       font-family=\"${gridStyle.font_family}\"\n                       data-cell-content=\"${cell.id}\">\n                       ${this._escapeXml(cell.content || String(cell.data.value))}\n                     </text>`;\n      }\n    });\n\n    gridMarkup += '</g>';\n    return gridMarkup;\n  }\n\n  /**\n   * Determine cell color based on status and configuration\n   * @private\n   */\n  _determineCellColor(cell, gridStyle) {\n    // Check status ranges first\n    if (gridStyle.status_ranges && gridStyle.status_ranges.length > 0) {\n      const value = typeof cell.data.value === 'number' ? cell.data.value : parseFloat(cell.data.value);\n\n      if (!isNaN(value)) {\n        for (const range of gridStyle.status_ranges) {\n          if (value >= range.min && value <= range.max) {\n            return range.color;\n          }\n        }\n      }\n\n      // Check string/state matching\n      for (const range of gridStyle.status_ranges) {\n        if (range.value && cell.data.value === range.value) {\n          return range.color;\n        }\n        if (range.state && cell.data.state === range.state) {\n          return range.color;\n        }\n      }\n    }\n\n    // Fallback to default cell color\n    return gridStyle.cell_color;\n  }\n\n  /**\n   * Escape XML special characters\n   * @private\n   */\n  _escapeXml(text) {\n    if (typeof text !== 'string') return String(text);\n    return text\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n\n  _renderFallbackStatusGrid(overlay, x, y, width, height) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const color = style.cell_color || style.color || 'var(--lcars-gray)';\n\n    console.warn(`[StatusGridRenderer] Using fallback rendering for status grid ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"status_grid\" data-fallback=\"true\">\n              <g transform=\"translate(${x}, ${y})\">\n                <rect width=\"${width}\" height=\"${height}\"\n                      fill=\"none\" stroke=\"${color}\" stroke-width=\"2\"/>\n                <text x=\"${width / 2}\" y=\"${height / 2}\" text-anchor=\"middle\"\n                      fill=\"${color}\" font-size=\"12\" dominant-baseline=\"middle\">\n                  Status Grid Error\n                </text>\n              </g>\n            </g>`;\n  }\n\n  /**\n   * Resolve cell content from various sources including DataSource integration\n   * @private\n   */\n  _resolveCellContent(cell, style) {\n    // ENHANCED: Handle conditional expressions locally before delegating to DataSourceMixin\n    const cellContent = cell.content || cell._raw?.content || cell.label || '';\n\n    console.log(`[StatusGridRenderer] Resolving content for cell:`, {\n      cellId: cell.id || 'unknown',\n      hasContent: !!cell.content,\n      hasRawContent: !!cell._raw?.content,\n      hasLabel: !!cell.label,\n      content: cellContent,\n      rawContent: cell._raw?.content,\n      label: cell.label\n    });\n\n    // Check if this is a conditional expression before delegating to DataSourceMixin\n    if (cellContent && typeof cellContent === 'string' && cellContent.includes('?') && cellContent.includes(':')) {\n      console.log(`[StatusGridRenderer] Detected conditional expression, handling locally: \"${cellContent}\"`);\n      return cellContent; // Return as-is, will be processed by our _processTemplateWithData\n    }\n\n    // Use DataSourceMixin's unified content resolution with template processing for simple templates\n    const resolvedContent = DataSourceMixin.resolveContent(cell, style, 'StatusGridRenderer');\n\n    console.log(`[StatusGridRenderer] Resolved content: \"${resolvedContent}\" for cell ${cell.id || 'unknown'}`);\n\n    return resolvedContent;\n  }\n\n  // Cell configuration resolution with DataSource integration\n  _resolveCellConfigurations(overlay, gridStyle) {\n    const cells = [];\n\n    // ENHANCED: Check multiple sources for cells configuration\n    const cellsConfig = overlay.cells || overlay._raw?.cells || overlay.raw?.cells;\n\n    console.log(`[StatusGridRenderer] Resolving cells for ${overlay.id}:`, {\n      hasCells: !!(cellsConfig && Array.isArray(cellsConfig)),\n      cellCount: cellsConfig?.length || 0,\n      cellsData: cellsConfig,\n      checkedSources: {\n        'overlay.cells': !!overlay.cells,\n        'overlay._raw?.cells': !!(overlay._raw?.cells),\n        'overlay.raw?.cells': !!(overlay.raw?.cells)\n      }\n    });\n\n    // Use explicit cell definitions if provided\n    if (cellsConfig && Array.isArray(cellsConfig)) {\n      cellsConfig.forEach((cellConfig, index) => {\n        console.log(`[StatusGridRenderer] Processing cell ${index}:`, cellConfig);\n\n        // UNIFIED: Use standardized content resolution following Text Overlay pattern\n        const cellContent = this._resolveCellContent(cellConfig, gridStyle);\n\n        const cell = {\n          id: cellConfig.id || `cell-${index}`,\n          row: cellConfig.position ? cellConfig.position[0] : Math.floor(index / gridStyle.columns),\n          col: cellConfig.position ? cellConfig.position[1] : index % gridStyle.columns,\n          index,\n          source: cellConfig.source || cellConfig.data_source,\n          label: cellConfig.label || `Cell ${index + 1}`,\n          content: cellContent, // Use unified content resolution\n          data: {\n            value: cellConfig.value || cellContent || null,\n            state: cellConfig.state || 'unknown',\n            timestamp: Date.now()\n          },\n          lastUpdate: Date.now(),\n          animationDelay: index * (gridStyle.cascade_speed || 50),\n          _raw: cellConfig._raw || cellConfig\n        };\n\n        // ENHANCED: Apply template processing for initial render if needed\n        const processedCell = this._resolveCellContentForInitialRender(cell, gridStyle);\n\n        console.log(`[StatusGridRenderer] Created cell:`, processedCell);\n        cells.push(processedCell);\n      });\n    } else {\n      console.log(`[StatusGridRenderer] No explicit cells found, generating ${gridStyle.rows}x${gridStyle.columns} grid`);\n\n      // Generate grid cells based on rows/columns\n      const totalCells = gridStyle.rows * gridStyle.columns;\n      for (let i = 0; i < totalCells; i++) {\n        const row = Math.floor(i / gridStyle.columns);\n        const col = i % gridStyle.columns;\n\n        cells.push({\n          id: `cell-${row}-${col}`,\n          row,\n          col,\n          index: i,\n          source: null,\n          label: `${String.fromCharCode(65 + row)}${col + 1}`,\n          content: null,\n          data: {\n            value: Math.random() > 0.5 ? 'ONLINE' : 'OFFLINE',\n            state: Math.random() > 0.5 ? 'good' : 'bad',\n            timestamp: Date.now()\n          },\n          lastUpdate: Date.now(),\n          animationDelay: i * (gridStyle.cascade_speed || 50)\n        });\n      }\n    }\n\n    console.log(`[StatusGridRenderer] Final cells array:`, cells);\n    return cells;\n  }\n\n  /**\n   * Resolve cell content with updated DataSource data (for dynamic updates)\n   * @public - Used by BaseOverlayUpdater for real-time status grid updates\n   * @param {Object} overlay - Overlay configuration\n   * @param {Object} style - Style configuration\n   * @param {Object} newDataSourceData - Updated DataSource data\n   * @returns {Array} Updated cell configurations with new data\n   */\n  updateCellsWithData(overlay, style, newDataSourceData) {\n    console.log(`[StatusGridRenderer] Updating cells with new DataSource data for ${overlay.id}`);\n\n    const gridStyle = this._resolveStatusGridStyles(style, overlay.id, overlay);\n    const cells = this._resolveCellConfigurations(overlay, gridStyle);\n\n    // Update cells that have template content\n    const updatedCells = cells.map(cell => {\n      const cellContent = cell._raw?.content || cell._raw?.label || cell.label || '';\n\n        if (cellContent && typeof cellContent === 'string' && cellContent.includes('{')) {\n        console.log(`[StatusGridRenderer] Processing template for cell ${cell.id}: \"${cellContent}\"`);\n\n        // SIMPLIFIED: Use DataSourceMixin for all template processing (including conditionals now)\n        const processedContent = cellContent.includes('?') && cellContent.includes(':') ?\n          this._processConditionalWithDataSourceMixin(cellContent) :\n          DataSourceMixin.processEnhancedTemplateStringsWithFallback(cellContent, 'StatusGridRenderer');          // Ensure we don't return [object Object]\n          const safeContent = (typeof processedContent === 'object') ?\n            JSON.stringify(processedContent) : String(processedContent);\n\n          return {\n            ...cell,\n            label: processedContent === cellContent ? cell.label : safeContent, // Only update label if content changed\n            content: safeContent,\n            data: {\n              ...cell.data,\n              value: this._extractValueFromTemplate(safeContent, newDataSourceData),\n              timestamp: Date.now()\n            },\n            lastUpdate: Date.now()\n          };\n        }      return cell;\n    });\n\n    return updatedCells;\n  }\n\n  /**\n   * Get the appropriate DataSource data for a specific cell template\n   * @private\n   * @param {string} cellContent - Cell template content\n   * @param {Object} changedDataSourceData - The DataSource data that changed\n   * @returns {Object} Appropriate DataSource data for this cell\n   */\n  _getDataSourceForCell(cellContent, changedDataSourceData) {\n    // Extract DataSource reference from template (e.g., \"test_cpu_temp\" from \"{test_cpu_temp:.1%}\")\n    const templateMatch = cellContent.match(/\\{([^}]+)\\}/);\n    if (!templateMatch) return changedDataSourceData;\n\n    const reference = templateMatch[1];\n    // Split by colon first to handle format specs, then by dot to get DataSource name\n    const [pathPart] = reference.split(':');\n    const dataSourceName = pathPart.split('.')[0]; // Get first part before dot\n\n    console.log(`[StatusGridRenderer] Cell needs DataSource: ${dataSourceName}`);\n\n    // Try to get the correct DataSource from the manager\n    if (typeof window !== 'undefined' && window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager) {\n      const dataSourceManager = window.__msdDebug.pipelineInstance.systemsManager.dataSourceManager;\n      const source = dataSourceManager.getSource(dataSourceName);\n\n      if (source) {\n        const sourceData = source.getCurrentData();\n        console.log(`[StatusGridRenderer] Found DataSource ${dataSourceName}: value=${sourceData?.v}, unit=\"${sourceData?.unit_of_measurement || 'none'}\"`);\n        return sourceData;\n      } else {\n        console.warn(`[StatusGridRenderer] DataSource ${dataSourceName} not found`);\n      }\n    }\n\n    // Fallback: return the changed data (might not work for this cell, but better than nothing)\n    return changedDataSourceData;\n  }  /**\n   * Resolve cell content with template processing for initial render\n   * @private\n   * @param {Object} cell - Cell configuration\n   * @param {Object} style - Style configuration\n   * @returns {Object} Cell with processed content if templates are present\n   */\n  _resolveCellContentForInitialRender(cell, style) {\n    const cellContent = cell._raw?.content || cell._raw?.label || cell.label || cell.content || '';\n\n    // If content contains templates, process them using the appropriate approach\n    if (cellContent && typeof cellContent === 'string' && cellContent.includes('{')) {\n      console.log(`[StatusGridRenderer] Processing template for initial render in cell ${cell.id}: \"${cellContent}\"`);\n\n      // SIMPLIFIED: Handle conditional expressions by extracting DataSource references and delegating to DataSourceMixin\n      if (cellContent.includes('?') && cellContent.includes(':')) {\n        console.log(`[StatusGridRenderer] Conditional expression detected, extracting DataSource references`);\n\n        const resolvedContent = this._processConditionalWithDataSourceMixin(cellContent);\n\n        if (resolvedContent !== cellContent) {\n          console.log(`[StatusGridRenderer] Conditional resolved for ${cell.id}: \"${cellContent}\"  \"${resolvedContent}\"`);\n          return {\n            ...cell,\n            content: resolvedContent,\n            _originalContent: cellContent\n          };\n        } else {\n          console.log(`[StatusGridRenderer] Conditional not resolved for ${cell.id}, will resolve during updates`);\n          return {\n            ...cell,\n            content: cellContent,\n            _originalContent: cellContent,\n            _isConditional: true\n          };\n        }\n      }\n\n      // For non-conditional templates, use DataSourceMixin (this works great now)\n      const processedContent = DataSourceMixin.processEnhancedTemplateStringsWithFallback(cellContent, 'StatusGridRenderer');\n\n      if (processedContent !== cellContent) {\n        console.log(`[StatusGridRenderer] Template resolved for ${cell.id}: \"${cellContent}\"  \"${processedContent}\"`);\n        return {\n          ...cell,\n          content: processedContent,\n          _originalContent: cellContent\n        };\n      } else {\n        console.log(`[StatusGridRenderer] Template not resolved for ${cell.id}, will resolve during updates`);\n      }\n    }\n\n    return cell;\n  }\n\n  /**\n   * Process conditional template during initial render by attempting to resolve DataSources\n   * @private\n   * @param {string} cellContent - Cell template content with conditional expression\n   * @returns {string} Processed content or original if not resolvable\n   */\n  /**\n   * Extract numeric value from processed template for status calculations\n   * @private\n   */\n  _extractValueFromTemplate(processedContent, dataSourceData) {\n    // If the processed content is purely numeric, return it\n    const numericValue = parseFloat(processedContent);\n    if (!isNaN(numericValue)) {\n      return numericValue;\n    }\n\n    // Otherwise try to extract the raw value from dataSourceData\n    if (dataSourceData && typeof dataSourceData.v === 'number') {\n      return dataSourceData.v;\n    }\n\n    // Fallback to processed content as string\n    return processedContent;\n  }\n\n  /**\n   * Process conditional expression by extracting DataSource references and using DataSourceMixin\n   * @private\n   * @param {string} conditionalTemplate - Template with conditional expression\n   * @returns {string} Resolved conditional or original template\n   */\n  _processConditionalWithDataSourceMixin(conditionalTemplate) {\n    try {\n      // Extract the conditional expression from the template\n      const templateMatch = conditionalTemplate.match(/\\{([^}]+)\\}/);\n      if (!templateMatch) return conditionalTemplate;\n\n      const expression = templateMatch[1];\n      console.log(`[StatusGridRenderer] Extracted conditional expression: \"${expression}\"`);\n\n      // Parse the conditional: \"path operator value ? trueValue : falseValue\"\n      const conditionMatch = expression.match(/^(.+?)\\s*([><=!]+)\\s*(.+?)\\s*\\?\\s*'(.+?)'\\s*:\\s*'(.+?)'$/);\n      if (!conditionMatch) {\n        console.warn(`[StatusGridRenderer] Could not parse conditional: ${expression}`);\n        return conditionalTemplate;\n      }\n\n      const [, leftPath, operator, rightValue, trueValue, falseValue] = conditionMatch;\n      console.log(`[StatusGridRenderer] Parsed conditional: \"${leftPath.trim()}\" ${operator} ${rightValue} ? \"${trueValue}\" : \"${falseValue}\"`);\n\n      // Create a simple template with just the DataSource reference\n      const dataSourceTemplate = `{${leftPath.trim()}}`;\n      console.log(`[StatusGridRenderer] Resolving DataSource template: \"${dataSourceTemplate}\"`);\n\n      // Let DataSourceMixin resolve the DataSource reference\n      const resolvedValue = DataSourceMixin.processEnhancedTemplateStringsWithFallback(dataSourceTemplate, 'StatusGridRenderer');\n      console.log(`[StatusGridRenderer] DataSourceMixin resolved: \"${dataSourceTemplate}\"  \"${resolvedValue}\"`);\n\n      // If DataSourceMixin couldn't resolve it, return original\n      if (resolvedValue === dataSourceTemplate) {\n        console.log(`[StatusGridRenderer] DataSource not resolved, returning original template`);\n        return conditionalTemplate;\n      }\n\n      // Parse the resolved value and apply conditional logic\n      const leftVal = parseFloat(resolvedValue);\n      const rightVal = parseFloat(rightValue.trim());\n\n      if (isNaN(leftVal) || isNaN(rightVal)) {\n        console.warn(`[StatusGridRenderer] Could not parse numeric values: left=\"${resolvedValue}\" (${leftVal}), right=\"${rightValue.trim()}\" (${rightVal})`);\n        return conditionalTemplate;\n      }\n\n      // Evaluate condition\n      let result = false;\n      switch (operator.trim()) {\n        case '>': result = leftVal > rightVal; break;\n        case '<': result = leftVal < rightVal; break;\n        case '>=': result = leftVal >= rightVal; break;\n        case '<=': result = leftVal <= rightVal; break;\n        case '==': result = leftVal == rightVal; break;\n        case '!=': result = leftVal != rightVal; break;\n        default:\n          console.warn(`[StatusGridRenderer] Unknown operator: ${operator}`);\n          return conditionalTemplate;\n      }\n\n      const finalValue = result ? trueValue : falseValue;\n      console.log(`[StatusGridRenderer] Conditional result: ${leftVal} ${operator} ${rightVal} = ${result}  \"${finalValue}\"`);\n      return finalValue;\n\n    } catch (error) {\n      console.error(`[StatusGridRenderer] Error processing conditional with DataSourceMixin:`, error);\n      return conditionalTemplate;\n    }\n  }\n}\n\n// Expose StatusGridRenderer to window for console debugging\nif (typeof window !== 'undefined') {\n  window.StatusGridRenderer = StatusGridRenderer;\n}","/**\n * Text Overlay Renderer - Advanced text rendering with comprehensive styling support\n * Provides rich text styling features similar to LineOverlayRenderer\n */\n\nimport { DataSourceMixin } from './DataSourceMixin.js';\n\nimport { PositionResolver } from './PositionResolver.js';\nimport { RendererUtils } from './RendererUtils.js';\n\nexport class TextOverlayRenderer {\n  constructor() {\n    // Pre-defined caches for performance optimization\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n    this.filterCache = new Map();\n  }\n\n  /**\n   * Render a text overlay with full styling support\n   * @param {Object} overlay - Text overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled text\n   */\n  static render(overlay, anchors, viewBox, svgContainer) {\n    // Create instance for non-static methods\n    const instance = new TextOverlayRenderer();\n    instance.container = svgContainer; // Set the container for the instance\n    instance.viewBox = viewBox; // Also store viewBox for reference\n    return instance.renderText(overlay, anchors, viewBox);\n  }\n\n  /**\n   * Instance method for comprehensive text rendering\n   * @param {Object} overlay - Text overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled text\n   */\n  renderText(overlay, anchors, viewBox) {\n    console.log(`[TextOverlayRenderer] DEBUG: renderText called for overlay \"${overlay.id}\"`);\n    console.log(`[TextOverlayRenderer] DEBUG: Full overlay object:`, overlay);\n    console.log(`[TextOverlayRenderer] DEBUG: Anchors:`, anchors);\n\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) {\n      console.warn('[TextOverlayRenderer] Text overlay position could not be resolved:', overlay.id);\n      console.log(`[TextOverlayRenderer] DEBUG: Position resolution failed for:`, {\n        overlayId: overlay.id,\n        position: overlay.position,\n        anchors: anchors\n      });\n      return '';\n    }\n    const [x, y] = position;\n\n    try {\n      const style = overlay.finalStyle || overlay.style || {};\n      console.log(`[TextOverlayRenderer] DEBUG: Style object for \"${overlay.id}\":`, style);\n\n      const textStyle = this._resolveTextStyles(style, overlay.id);\n\n      // NEW: adopt computed font when 'inherit' (prevents initial fallback mismatch)\n      if (this.container && typeof window !== 'undefined') {\n        try {\n          const host = this.container;\n          const cs = host ? getComputedStyle(host) : null;\n            if (cs) {\n              if (textStyle.fontFamily === 'inherit' && cs.fontFamily) {\n                textStyle.fontFamily = cs.fontFamily;\n              }\n              // Update fontSize if defaulted / unreasonable\n              if ((!style.font_size && !style.fontSize) && cs.fontSize) {\n                const px = parseFloat(cs.fontSize);\n                if (!isNaN(px) && px > 0) textStyle.fontSize = px;\n              }\n            }\n        } catch (_) {}\n      }\n\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n      const textContent = this._resolveTextContent(overlay, style);\n\n      console.log(`[TextOverlayRenderer] DEBUG: Final text content for \"${overlay.id}\": \"${textContent}\"`);\n\n      if (!textContent) {\n        console.warn(`[TextOverlayRenderer] No text content for overlay ${overlay.id}`);\n        console.log(`[TextOverlayRenderer] DEBUG: Content resolution chain failed - check the debug logs above`);\n        return '';\n      }\n      textStyle._cachedContent = textContent;\n\n      // NEW: single early measurement (width/height) used by decorations & emitted as attributes\n      const measure = this._measureTextBlock(textContent, x, y, textStyle);\n\n      const svgParts = [\n        this._buildDefinitions(textStyle, overlay.id),\n        this._buildMainText(textContent, x, y, textStyle, overlay.id, animationAttributes),\n        this._buildTextDecorations(textContent, x, y, textStyle, overlay.id),\n        this._buildEffects(textContent, x, y, textStyle, overlay.id)\n      ].filter(Boolean);\n\n      console.log(`[TextOverlayRenderer] Rendered enhanced text ${overlay.id} with ${textStyle.features.length} features`);\n\n      return `<g data-overlay-id=\"${overlay.id}\"\n                  data-overlay-type=\"text\"\n                  data-text-features=\"${textStyle.features.join(',')}\"\n                  data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                  data-text-width=\"${measure.width || 0}\"\n                  data-text-height=\"${measure.height || 0}\"\n                  data-font-family=\"${textStyle.fontFamily}\"\n                  data-font-size=\"${textStyle.fontSize}\"\n                  data-dominant-baseline=\"${textStyle.dominantBaseline}\"\n                  data-text-anchor=\"${textStyle.textAnchor}\"\n                  data-font-stabilized=\"0\">\n                ${svgParts.join('\\n')}\n              </g>`;\n    } catch (error) {\n      console.error(`[TextOverlayRenderer] Enhanced rendering failed for text ${overlay.id}:`, error);\n      return this._renderFallbackText(overlay, x, y);\n    }\n  }\n\n  /**\n   * Resolve comprehensive text styling from configuration using unified styling system\n   * @private\n   * @param {Object} style - Final resolved style object\n   * @param {string} overlayId - Overlay ID for unique identifiers\n   * @returns {Object} Complete text style configuration\n   */\n  _resolveTextStyles(style, overlayId) {\n    // Parse all standard styles using unified system\n    const standardStyles = RendererUtils.parseAllStandardStyles(style);\n\n    const textStyle = {\n      // Core text properties (enhanced with unified styling)\n      color: standardStyles.text.textColor || style.fill || 'var(--lcars-orange)',\n      fontSize: standardStyles.text.fontSize,\n      fontFamily: standardStyles.text.fontFamily !== 'monospace' ? standardStyles.text.fontFamily : (style.font_family || style.fontFamily || 'inherit'),\n      fontWeight: standardStyles.text.fontWeight,\n      fontStyle: standardStyles.text.fontStyle,\n\n      // Text positioning and alignment (enhanced with unified styling)\n      textAnchor: (standardStyles.text.textAlign === 'left' ? 'start' :\n                   standardStyles.text.textAlign === 'right' ? 'end' :\n                   standardStyles.text.textAlign === 'center' ? 'middle' :\n                   style.text_anchor || style.textAnchor || 'start').toLowerCase(),\n      dominantBaseline: (standardStyles.text.verticalAlign === 'top' ? 'hanging' :\n                        standardStyles.text.verticalAlign === 'bottom' ? 'text-after-edge' :\n                        standardStyles.text.verticalAlign === 'middle' ? 'central' :\n                        style.dominant_baseline || style.dominantBaseline || 'auto').toLowerCase(),\n      alignmentBaseline: (style.alignment_baseline || style.alignmentBaseline || 'auto').toLowerCase(),\n\n      // Advanced text styling (enhanced with unified styling)\n      letterSpacing: standardStyles.text.letterSpacing,\n      wordSpacing: style.word_spacing || style.wordSpacing || 'normal',\n      textDecoration: style.text_decoration || style.textDecoration || 'none',\n\n      // Opacity and visibility (using unified layout)\n      opacity: standardStyles.layout.opacity,\n      visibility: standardStyles.layout.visible ? 'visible' : 'hidden',\n\n      // Stroke properties for outlined text (enhanced with unified colors)\n      stroke: style.stroke || null,\n      strokeWidth: Number(style.stroke_width || style.strokeWidth || 0),\n      strokeOpacity: Number(style.stroke_opacity || style.strokeOpacity || 1),\n      strokeLinecap: (style.stroke_linecap || style.strokeLinecap || 'butt').toLowerCase(),\n      strokeLinejoin: (style.stroke_linejoin || style.strokeLinejoin || 'miter').toLowerCase(),\n      strokeDasharray: style.stroke_dasharray || style.strokeDasharray || null,\n      strokeDashoffset: Number(style.stroke_dashoffset || style.strokeDashoffset || 0),\n\n      // Advanced fill properties (using unified effects)\n      gradient: standardStyles.gradient,\n      pattern: standardStyles.pattern,\n\n      // Effects (using unified effects)\n      glow: standardStyles.glow,\n      shadow: standardStyles.shadow,\n      blur: standardStyles.blur,\n\n      // Multi-line text support (enhanced with unified styling)\n      multiline: style.multiline || false,\n      lineHeight: standardStyles.text.lineHeight,\n      maxWidth: standardStyles.layout.maxWidth || Number(style.max_width || style.maxWidth || 0),\n      textWrapping: style.text_wrapping || style.textWrapping || 'none',\n\n      // Animation states (using unified animation system)\n      animatable: standardStyles.animation.animatable,\n      pulseSpeed: Number(style.pulse_speed || standardStyles.animation.pulseOnChange ? 1 : 0),\n      fadeSpeed: Number(style.fade_speed || 0),\n      typewriterSpeed: Number(style.typewriter_speed || 0),\n\n      // LCARS-specific features (enhanced with unified colors)\n      status_indicator: style.status_indicator || null,\n      status_indicator_position: style.status_indicator_position || style.statusIndicatorPosition || 'left-center',\n      bracket_style: style.bracket_style || null,\n      highlight: style.highlight || false,\n\n      // Store reference to standard styles for access to additional features\n      standardStyles,\n\n      // Track enabled features for optimization\n      features: []\n    };\n\n    // Build feature list for conditional rendering\n    if (textStyle.gradient) textStyle.features.push('gradient');\n    if (textStyle.pattern) textStyle.features.push('pattern');\n    if (textStyle.stroke && textStyle.strokeWidth > 0) textStyle.features.push('stroke');\n    if (textStyle.glow) textStyle.features.push('glow');\n    if (textStyle.shadow) textStyle.features.push('shadow');\n    if (textStyle.blur) textStyle.features.push('blur');\n    if (textStyle.multiline) textStyle.features.push('multiline');\n    if (textStyle.pulseSpeed > 0) textStyle.features.push('pulse');\n    if (textStyle.fadeSpeed > 0) textStyle.features.push('fade');\n    if (textStyle.typewriterSpeed > 0) textStyle.features.push('typewriter');\n    if (textStyle.status_indicator) textStyle.features.push('status');\n    if (textStyle.bracket_style) textStyle.features.push('brackets');\n    if (textStyle.highlight) textStyle.features.push('highlight');\n\n    return textStyle;\n  }\n\n  /**\n   * Resolve text content from various sources including DataSource integration\n   * @private\n   */\n  _resolveTextContent(overlay, style) {\n    console.log(`[TextOverlayRenderer] DEBUG: Resolving text content for ${overlay.id}`);\n    console.log(`[TextOverlayRenderer] DEBUG: Available sources:`, {\n      'style.value': style.value,\n      'overlay.text': overlay.text,\n      'overlay.content': overlay.content,\n      '_raw.content': overlay._raw?.content,\n      '_raw.text': overlay._raw?.text\n    });\n\n    // Start with basic content resolution\n    let content = style.value || overlay.text || overlay.content || '';\n\n    // Check raw overlay configuration if content not found in standard properties\n    if (!content && overlay._raw?.content) {\n      content = overlay._raw.content;\n      console.log(`[TextOverlayRenderer] DEBUG: Found content in _raw.content: \"${content}\"`);\n    }\n    if (!content && overlay._raw?.text) {\n      content = overlay._raw.text;\n      console.log(`[TextOverlayRenderer] DEBUG: Found content in _raw.text: \"${content}\"`);\n    }\n\n      // Check if we have a value_format and a DataSource reference\n    let dataSourceRef = overlay.data_source || overlay._raw?.data_source || style.data_source;\n    if (!content && style.value_format && typeof style.value_format === 'string' && dataSourceRef) {\n      // Try to resolve the DataSource value\n      const dataSourceContent = DataSourceMixin.resolveDataSourceContent(dataSourceRef, style, 'TextOverlayRenderer');\n      if (dataSourceContent !== null) {\n        // Check if the DataSource content is already formatted or if it's a raw value\n        const numericValue = parseFloat(dataSourceContent);\n        if (!isNaN(numericValue) && String(numericValue) === String(dataSourceContent).trim()) {\n          // DataSource returned a raw numeric value, apply formatting using unified method\n          if (style.value_format.includes('{value')) {\n            content = style.value_format.replace(/\\{value(?::([^}]+))?\\}/g, (match, formatSpec) => {\n              if (formatSpec) {\n                // Use DataSourceMixin for unit-aware formatting\n                const dsManager = DataSourceMixin.getDataSourceManager();\n                const dataSource = dsManager?.getSource(dataSourceRef.split('.')[0]);\n                const unitOfMeasurement = dataSource?.getCurrentData()?.unit_of_measurement;\n                return DataSourceMixin.applyNumberFormat(numericValue, formatSpec, unitOfMeasurement);\n              }\n              return String(numericValue);\n            });\n          } else {\n            content = style.value_format.replace('{value}', String(numericValue));\n          }\n        } else {\n          // DataSource returned already formatted content, use it directly\n          content = dataSourceContent;\n        }\n        return content;\n      } else {\n        // DataSource not available, show loading state with format context\n        content = style.value_format.replace(/\\{value[^}]*\\}/g, '[Loading...]');\n        return content;\n      }\n    }    // Fallback: if we have a value_format but no DataSource, treat it as a template string\n    if (!content && style.value_format && typeof style.value_format === 'string') {\n      content = style.value_format;\n    }\n\n    // If we have basic content and it contains template strings, process them\n    if (content && typeof content === 'string' && content.includes('{')) {\n      content = DataSourceMixin.processTemplateForInitialRender(content, 'TextOverlayRenderer');\n      return content;\n    }\n\n    // If we have basic content without templates, return it\n    if (content) {\n      return content;\n    }\n\n    // No basic content found, try DataSource integration as fallback\n    if (!dataSourceRef) {\n      dataSourceRef = overlay.data_source || overlay._raw?.data_source || style.data_source;\n    }\n    if (dataSourceRef) {\n      const dataSourceContent = DataSourceMixin.resolveDataSourceContent(dataSourceRef, style, 'TextOverlayRenderer');\n      if (dataSourceContent !== null) {\n        return dataSourceContent;\n      } else {\n        // If we have a DataSource reference but it's not available, show loading state\n        return `[Loading: ${dataSourceRef}]`;\n      }\n    }\n\n    return content; // Return whatever we found (might be empty string)\n  }\n\n  /**\n   * Enhanced template string processing with better DataSource support\n   * @private\n   */\n  _processEnhancedTemplateStrings(content) {\n    return DataSourceMixin.processEnhancedTemplateStrings(content, 'TextOverlayRenderer');\n  }\n\n  /**\n   * Build SVG definitions for gradients, patterns, and effects\n   * @private\n   */\n  _buildDefinitions(textStyle, overlayId) {\n    const defs = [];\n\n    // Gradients\n    if (textStyle.gradient) {\n      defs.push(this._createGradientDefinition(textStyle.gradient, overlayId));\n    }\n\n    // Patterns\n    if (textStyle.pattern) {\n      defs.push(this._createPatternDefinition(textStyle.pattern, overlayId));\n    }\n\n    // Effects (filters)\n    if (textStyle.glow) {\n      defs.push(this._createGlowFilter(textStyle.glow, overlayId));\n    }\n\n    if (textStyle.shadow) {\n      defs.push(this._createShadowFilter(textStyle.shadow, overlayId));\n    }\n\n    if (textStyle.blur) {\n      defs.push(this._createBlurFilter(textStyle.blur, overlayId));\n    }\n\n    if (defs.length === 0) {\n      return '';\n    }\n\n    return `<defs>${defs.join('\\n')}</defs>`;\n  }\n\n  /**\n   * Build the main text element with all styling\n   * @private\n   */\n  _buildMainText(textContent, x, y, textStyle, overlayId, animationAttributes) {\n    if (textStyle.multiline) {\n      return this._buildMultilineText(textContent, x, y, textStyle, overlayId, animationAttributes);\n    }\n\n    const attributes = [];\n\n    // Position\n    attributes.push(`x=\"${x}\"`);\n    attributes.push(`y=\"${y}\"`);\n\n    // Core text styling\n    this._applyTextAttributes(attributes, textStyle, overlayId);\n\n    // Animation attributes (for future anime.js integration)\n    attributes.push(...animationAttributes.textAttributes);\n\n    const escapedText = this.escapeXml(textContent);\n    return `<text ${attributes.join(' ')}>${escapedText}</text>`;\n  }\n\n  /**\n   * Build multiline text with proper line spacing\n   * @private\n   */\n  _buildMultilineText(textContent, x, y, textStyle, overlayId, animationAttributes) {\n    const lines = textContent.split('\\n');\n    const lineHeight = textStyle.fontSize * textStyle.lineHeight;\n    const tspanElements = [];\n\n    lines.forEach((line, index) => {\n      const dy = index === 0 ? 0 : lineHeight;\n      const escapedLine = this.escapeXml(line);\n      tspanElements.push(`<tspan x=\"${x}\" dy=\"${dy}\">${escapedLine}</tspan>`);\n    });\n\n    const attributes = [];\n\n    // Position (y for first line)\n    attributes.push(`y=\"${y}\"`);\n\n    // Core text styling\n    this._applyTextAttributes(attributes, textStyle, overlayId);\n\n    // Animation attributes\n    attributes.push(...animationAttributes.textAttributes);\n\n    return `<text ${attributes.join(' ')}>${tspanElements.join('')}</text>`;\n  }\n\n  /**\n   * Apply common text attributes\n   * @private\n   */\n  _applyTextAttributes(attributes, textStyle, overlayId) {\n    // Fill styling\n    if (textStyle.gradient) {\n      attributes.push(`fill=\"url(#text-gradient-${overlayId})\"`);\n    } else if (textStyle.pattern) {\n      attributes.push(`fill=\"url(#text-pattern-${overlayId})\"`);\n    } else {\n      attributes.push(`fill=\"${textStyle.color}\"`);\n    }\n\n    attributes.push(`fill-opacity=\"${textStyle.opacity}\"`);\n\n    // Font styling\n    attributes.push(`font-size=\"${textStyle.fontSize}\"`);\n    if (textStyle.fontFamily !== 'inherit') {\n      attributes.push(`font-family=\"${textStyle.fontFamily}\"`);\n    }\n    if (textStyle.fontWeight !== 'normal') {\n      attributes.push(`font-weight=\"${textStyle.fontWeight}\"`);\n    }\n    if (textStyle.fontStyle !== 'normal') {\n      attributes.push(`font-style=\"${textStyle.fontStyle}\"`);\n    }\n\n    // Text alignment\n    if (textStyle.textAnchor !== 'start') {\n      attributes.push(`text-anchor=\"${textStyle.textAnchor}\"`);\n    }\n    if (textStyle.dominantBaseline !== 'auto') {\n      attributes.push(`dominant-baseline=\"${textStyle.dominantBaseline}\"`);\n    }\n    if (textStyle.alignmentBaseline !== 'auto') {\n      attributes.push(`alignment-baseline=\"${textStyle.alignmentBaseline}\"`);\n    }\n\n    // Spacing\n    if (textStyle.letterSpacing !== 'normal') {\n      attributes.push(`letter-spacing=\"${textStyle.letterSpacing}\"`);\n    }\n    if (textStyle.wordSpacing !== 'normal') {\n      attributes.push(`word-spacing=\"${textStyle.wordSpacing}\"`);\n    }\n\n    // Text decoration\n    if (textStyle.textDecoration !== 'none') {\n      attributes.push(`text-decoration=\"${textStyle.textDecoration}\"`);\n    }\n\n    // Stroke properties\n    if (textStyle.stroke && textStyle.strokeWidth > 0) {\n      attributes.push(`stroke=\"${textStyle.stroke}\"`);\n      attributes.push(`stroke-width=\"${textStyle.strokeWidth}\"`);\n      attributes.push(`stroke-opacity=\"${textStyle.strokeOpacity}\"`);\n      attributes.push(`stroke-linecap=\"${textStyle.strokeLinecap}\"`);\n      attributes.push(`stroke-linejoin=\"${textStyle.strokeLinejoin}\"`);\n\n      if (textStyle.strokeDasharray) {\n        attributes.push(`stroke-dasharray=\"${textStyle.strokeDasharray}\"`);\n        if (textStyle.strokeDashoffset !== 0) {\n          attributes.push(`stroke-dashoffset=\"${textStyle.strokeDashoffset}\"`);\n        }\n      }\n    }\n\n    // Visibility\n    if (textStyle.visibility !== 'visible') {\n      attributes.push(`visibility=\"${textStyle.visibility}\"`);\n    }\n\n    // Effects\n    const filters = [];\n    if (textStyle.glow) filters.push(`url(#text-glow-${overlayId})`);\n    if (textStyle.shadow) filters.push(`url(#text-shadow-${overlayId})`);\n    if (textStyle.blur) filters.push(`url(#text-blur-${overlayId})`);\n    if (filters.length > 0) {\n      attributes.push(`filter=\"${filters.join(' ')}\"`);\n    }\n  }\n\n  /**\n   * Build text decoration elements (brackets, highlights, etc.)\n   * @private\n   */\n  _buildTextDecorations(textContent, x, y, textStyle, overlayId) {\n    const decorations = [];\n\n    // LCARS-style brackets\n    if (textStyle.bracket_style) {\n      decorations.push(this._buildBrackets(textContent, x, y, textStyle, overlayId));\n    }\n\n    // Highlight background\n    if (textStyle.highlight) {\n      decorations.push(this._buildHighlight(textContent, x, y, textStyle, overlayId));\n    }\n\n    // Status indicator\n    if (textStyle.status_indicator) {\n      decorations.push(this._buildStatusIndicator(x, y, textStyle, overlayId));\n    }\n\n    return decorations.filter(Boolean).join('\\n');\n  }\n\n  /**\n   * Build special effects elements\n   * @private\n   */\n  _buildEffects(textContent, x, y, textStyle, overlayId) {\n    const effects = [];\n\n    // Future: Add text-specific animation elements\n    if (textStyle.features.includes('typewriter')) {\n      // Placeholder for typewriter animation elements\n    }\n\n    if (textStyle.features.includes('pulse')) {\n      // Placeholder for pulse animation elements\n    }\n\n    if (textStyle.features.includes('fade')) {\n      // Placeholder for fade animation elements\n    }\n\n    return effects.join('\\n');\n  }\n\n  /**\n   * Build LCARS-style brackets with precise measurements\n   * @private\n   * @param {string} textContent - Text content for measurement\n   * @param {number} x - Text x position\n   * @param {number} y - Text y position\n   * @param {Object} textStyle - Resolved text style configuration\n   * @param {string} overlayId - Overlay ID for unique identification\n   * @returns {string} SVG markup for LCARS brackets\n   */\n  _buildBrackets(textContent, x, y, textStyle, overlayId) {\n    // Use measurement-adjusted font (prevents width overestimation)\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n    let bbox;\n\n    if (textStyle.multiline) {\n      // For multiline text, get comprehensive measurements\n      const multilineMetrics = RendererUtils.measureMultilineText(textContent, font, textStyle.lineHeight);\n      // Create bbox-like object from multiline measurements\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - multilineMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - multilineMetrics.width;\n      }\n\n      let top = y - multilineMetrics.lineMetrics[0]?.ascent || 0;\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - multilineMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + multilineMetrics.width,\n        top,\n        bottom: top + multilineMetrics.height,\n        width: multilineMetrics.width,\n        height: multilineMetrics.height\n      };\n    } else {\n      // Single line text - use standard bounding box\n      bbox = RendererUtils.getTextBoundingBox(\n        textContent,\n        x,\n        y,\n        font,\n        textStyle.textAnchor,\n        textStyle.dominantBaseline\n      );\n    }\n\n    const bracketWidth = 8;\n    const padding = 4;\n    const extraHeight = 4; // Additional height for visual appeal\n\n    const leftX = bbox.left - bracketWidth - padding;\n    const rightX = bbox.right + padding;\n    const topY = bbox.top - extraHeight;\n    const bottomY = bbox.bottom + extraHeight;\n\n    const bracketColor = textStyle.color;\n    const strokeWidth = Math.max(1, textStyle.fontSize / 16);\n\n    return `<g data-decoration=\"brackets\">\n              <path d=\"M ${leftX + bracketWidth} ${topY} L ${leftX} ${topY} L ${leftX} ${bottomY} L ${leftX + bracketWidth} ${bottomY}\"\n                    stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n              <path d=\"M ${rightX - bracketWidth} ${topY} L ${rightX} ${topY} L ${rightX} ${bottomY} L ${rightX - bracketWidth} ${bottomY}\"\n                    stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n            </g>`;\n  }\n\n  /**\n   * Build highlight background with precise measurements and coordinate transformation\n   * @private\n   */\n  _buildHighlight(textContent, x, y, textStyle, overlayId) {\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n    let bbox;\n\n    if (textStyle.multiline) {\n      // For multiline text, get comprehensive measurements with coordinate transformation\n      const multilineMetrics = RendererUtils.measureMultilineText(\n        textContent,\n        font,\n        textStyle.lineHeight,\n        true,\n        this.container // Pass container for coordinate transformation\n      );\n\n      // Create bbox-like object from multiline measurements\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - multilineMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - multilineMetrics.width;\n      }\n\n      let top = y - multilineMetrics.lineMetrics[0]?.ascent || 0;\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - multilineMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + multilineMetrics.width,\n        top,\n        bottom: top + multilineMetrics.height,\n        width: multilineMetrics.width,\n        height: multilineMetrics.height\n      };\n    } else {\n      // Single line text - use standard bounding box with coordinate transformation\n      bbox = RendererUtils.getTextBoundingBox(\n        textContent,\n        x,\n        y,\n        font,\n        textStyle.textAnchor,\n        textStyle.dominantBaseline,\n        this.container // Pass container for coordinate transformation\n      );\n    }\n\n    // Get properly scaled padding\n    const transformInfo = RendererUtils._getSvgTransformInfo(this.container);\n    const padding = transformInfo ? transformInfo.pixelToViewBox(2) : 2;\n\n    const highlightX = bbox.left - padding;\n    const highlightY = bbox.top - padding;\n    const highlightWidth = bbox.width + (padding * 2);\n    const highlightHeight = bbox.height + (padding * 2);\n\n    const highlightColor = typeof textStyle.highlight === 'string' ?\n      textStyle.highlight : 'var(--lcars-blue-light)';\n    const highlightOpacity = typeof textStyle.highlight_opacity === 'number' ?\n      textStyle.highlight_opacity : 0.3;\n\n    return `<rect x=\"${highlightX}\" y=\"${highlightY}\"\n                  width=\"${highlightWidth}\" height=\"${highlightHeight}\"\n                  fill=\"${highlightColor}\" fill-opacity=\"${highlightOpacity}\"\n                  data-decoration=\"highlight\"/>`;\n  }\n\n  /**\n   * Build status indicator with precise positioning and proper coordinate transformation\n   * @private\n   * @param {number} x - Text x position\n   * @param {number} y - Text y position\n   * @param {Object} textStyle - Resolved text style configuration\n   * @param {string} overlayId - Overlay ID for unique identification\n   * @returns {string} SVG markup for status indicator\n   */\n  _buildStatusIndicator(x, y, textStyle, overlayId) {\n    const indicatorSize = textStyle.fontSize * 0.4;\n    const statusColor = typeof textStyle.status_indicator === 'string'\n      ? textStyle.status_indicator\n      : 'var(--lcars-green)';\n\n    const position = textStyle.status_indicator_position || 'left-center';\n\n    // Replace base font with measurement-adjusted font\n    const textContent = textStyle._cachedContent || textStyle.value || '';\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n\n    // Get the SVG transform info for debugging and padding calculation\n    const transformInfo = RendererUtils._getSvgTransformInfo(this.container);\n\n    console.log(`[TextOverlayRenderer] Transform info for ${overlayId}:`, {\n      transformInfo,\n      containerTag: this.container?.tagName,\n      hasSvg: !!this.container?.querySelector('svg')\n    });\n\n    let bbox;\n    if (textStyle.multiline) {\n      // For multiline text, get measurements and let RendererUtils handle coordinate transformation\n      const multilineMetrics = RendererUtils.measureMultilineText(\n        textContent,\n        font,\n        textStyle.lineHeight,\n        true,\n        this.container // Let RendererUtils handle the transformation\n      );\n\n      // Use the already-transformed measurements directly\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - multilineMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - multilineMetrics.width;\n      }\n\n      let top = y - (multilineMetrics.lineMetrics[0]?.ascent || 0);\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - multilineMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + multilineMetrics.width,\n        top,\n        bottom: top + multilineMetrics.height,\n        width: multilineMetrics.width,\n        height: multilineMetrics.height,\n        centerX: left + multilineMetrics.width / 2,\n        centerY: top + multilineMetrics.height / 2\n      };\n    } else {\n      // Single line text - get measurements and let RendererUtils handle coordinate transformation\n      const textMetrics = RendererUtils.measureText(textContent, font, true, this.container);\n\n      // Use the already-transformed measurements directly\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - textMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - textMetrics.width;\n      }\n\n      let top = y - textMetrics.ascent;\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - textMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + textMetrics.width,\n        top,\n        bottom: top + textMetrics.height,\n        width: textMetrics.width,\n        height: textMetrics.height,\n        centerX: left + textMetrics.width / 2,\n        centerY: top + textMetrics.height / 2\n      };\n    }\n\n    // Debug logging to trace coordinate issues\n    console.log(`[TextOverlayRenderer] Status indicator debug for ${overlayId}:`, {\n      textContent,\n      x, y,\n      textAnchor: textStyle.textAnchor,\n      dominantBaseline: textStyle.dominantBaseline,\n      position,\n      bbox,\n      fontSize: textStyle.fontSize,\n      hasContainer: !!this.container,\n      containerType: this.container?.tagName,\n      transformInfo: transformInfo ? {\n        scaleX: transformInfo.scaleX,\n        scaleY: transformInfo.scaleY,\n        viewBox: transformInfo.viewBox\n      } : null\n    });\n\n    // Calculate indicator position based on actual text bounds (already in correct coordinate space)\n    let indicatorX = x, indicatorY = y;\n\n    // Use a consistent padding value - transform pixel padding to viewBox coordinates only once\n    const pixelPadding = 8; // 8 pixel padding\n    const padding = transformInfo ?\n      transformInfo.pixelToViewBox(pixelPadding) :\n      indicatorSize; // Fallback to indicator size if no transform info\n\n    switch (position) {\n      case 'top-left':\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.top - padding;\n        break;\n      case 'top-right':\n        indicatorX = bbox.right + padding;\n        indicatorY = bbox.top - padding;\n        break;\n      case 'bottom-left':\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.bottom + padding;\n        break;\n      case 'bottom-right':\n        indicatorX = bbox.right + padding;\n        indicatorY = bbox.bottom + padding;\n        break;\n      case 'top':\n        indicatorX = bbox.centerX;\n        indicatorY = bbox.top - padding;\n        break;\n      case 'bottom':\n        indicatorX = bbox.centerX;\n        indicatorY = bbox.bottom + padding;\n        break;\n      case 'left-center':\n      case 'left':\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.centerY;\n        break;\n      case 'right-center':\n      case 'right':\n        indicatorX = bbox.right + padding;\n        indicatorY = bbox.centerY;\n        break;\n      case 'center':\n        indicatorX = bbox.centerX;\n        indicatorY = bbox.centerY;\n        break;\n      default:\n        // fallback to left-center\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.centerY;\n    }\n\n    console.log(`[TextOverlayRenderer] Status indicator final position for ${overlayId}:`, {\n      indicatorX,\n      indicatorY,\n      padding,\n      pixelPadding,\n      transformInfo: transformInfo ? 'present' : 'missing'\n    });\n\n    return `<circle cx=\"${indicatorX}\" cy=\"${indicatorY}\" r=\"${indicatorSize}\"\n                    fill=\"${statusColor}\"\n                    data-status-pos=\"${position}\"\n                    data-decoration=\"status-indicator\"/>`;\n  }\n\n\n  /**\n   * Create gradient definition for text\n   * @private\n   */\n  _createGradientDefinition(gradientConfig, overlayId) {\n    const gradientId = `text-gradient-${overlayId}`;\n\n    if (typeof gradientConfig === 'string') {\n      // Simple two-color gradient\n      const [color1, color2] = gradientConfig.split(',').map(c => c.trim());\n      return `<linearGradient id=\"${gradientId}\">\n                <stop offset=\"0%\" stop-color=\"${color1 || 'var(--lcars-orange)'}\"/>\n                <stop offset=\"100%\" stop-color=\"${color2 || 'var(--lcars-red)'}\"/>\n              </linearGradient>`;\n    }\n\n    // Advanced gradient configuration\n    const type = gradientConfig.type || 'linear';\n    const stops = gradientConfig.stops || [\n      { offset: '0%', color: 'var(--lcars-orange)' },\n      { offset: '100%', color: 'var(--lcars-red)' }\n    ];\n\n    if (type === 'radial') {\n      const cx = gradientConfig.cx || '50%';\n      const cy = gradientConfig.cy || '50%';\n      const r = gradientConfig.r || '50%';\n\n      const stopElements = stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<radialGradient id=\"${gradientId}\" cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\">\n                ${stopElements}\n              </radialGradient>`;\n    } else {\n      const x1 = gradientConfig.x1 || '0%';\n      const y1 = gradientConfig.y1 || '0%';\n      const x2 = gradientConfig.x2 || '100%';\n      const y2 = gradientConfig.y2 || '0%';\n\n      const stopElements = stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<linearGradient id=\"${gradientId}\" x1=\"${x1}\" y1=\"${y1}\" x2=\"${x2}\" y2=\"${y2}\">\n                ${stopElements}\n              </linearGradient>`;\n    }\n  }\n\n  /**\n   * Create pattern definition for text\n   * @private\n   */\n  _createPatternDefinition(patternConfig, overlayId) {\n    const patternId = `text-pattern-${overlayId}`;\n\n    if (typeof patternConfig === 'string') {\n      // Simple pattern types\n      switch (patternConfig) {\n        case 'dots':\n          return `<pattern id=\"${patternId}\" patternUnits=\"userSpaceOnUse\" width=\"8\" height=\"8\">\n                    <circle cx=\"4\" cy=\"4\" r=\"1\" fill=\"currentColor\"/>\n                  </pattern>`;\n        case 'lines':\n          return `<pattern id=\"${patternId}\" patternUnits=\"userSpaceOnUse\" width=\"4\" height=\"4\">\n                    <path d=\"M 0,4 l 4,-4 M -1,1 l 2,-2 M 3,5 l 2,-2\" stroke=\"currentColor\" stroke-width=\"1\"/>\n                  </pattern>`;\n        default:\n          return '';\n      }\n    }\n\n    // Advanced pattern configuration\n    const width = patternConfig.width || 10;\n    const height = patternConfig.height || 10;\n    const patternUnits = patternConfig.patternUnits || 'userSpaceOnUse';\n\n    return `<pattern id=\"${patternId}\" patternUnits=\"${patternUnits}\" width=\"${width}\" height=\"${height}\">\n              ${patternConfig.content || ''}\n            </pattern>`;\n  }\n\n  /**\n   * Create glow filter for text\n   * @private\n   */\n  _createGlowFilter(glowConfig, overlayId) {\n    const filterId = `text-glow-${overlayId}`;\n\n    let color, blur, intensity;\n    if (typeof glowConfig === 'string') {\n      color = glowConfig;\n      blur = 3;\n      intensity = 1;\n    } else {\n      color = glowConfig.color || 'var(--lcars-orange)';\n      blur = Number(glowConfig.blur || 3);\n      intensity = Number(glowConfig.intensity || 1);\n    }\n\n    return `<filter id=\"${filterId}\">\n              <feGaussianBlur stdDeviation=\"${blur}\" result=\"blur\"/>\n              <feFlood flood-color=\"${color}\" flood-opacity=\"${intensity}\" result=\"color\"/>\n              <feComposite in=\"color\" in2=\"blur\" operator=\"in\" result=\"coloredBlur\"/>\n              <feMerge>\n                <feMergeNode in=\"coloredBlur\"/>\n                <feMergeNode in=\"SourceGraphic\"/>\n              </feMerge>\n            </filter>`;\n  }\n\n  /**\n   * Create shadow filter for text\n   * @private\n   */\n  _createShadowFilter(shadowConfig, overlayId) {\n    const filterId = `text-shadow-${overlayId}`;\n\n    let offsetX, offsetY, blur, color;\n    if (typeof shadowConfig === 'string') {\n      [offsetX, offsetY, blur, color] = shadowConfig.split(' ');\n      offsetX = Number(offsetX) || 2;\n      offsetY = Number(offsetY) || 2;\n      blur = Number(blur) || 2;\n      color = color || 'rgba(0,0,0,0.5)';\n    } else {\n      offsetX = Number(shadowConfig.offsetX || 2);\n      offsetY = Number(shadowConfig.offsetY || 2);\n      blur = Number(shadowConfig.blur || 2);\n      color = shadowConfig.color || 'rgba(0,0,0,0.5)';\n    }\n\n    return `<filter id=\"${filterId}\">\n              <feDropShadow dx=\"${offsetX}\" dy=\"${offsetY}\" stdDeviation=\"${blur}\" flood-color=\"${color}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Create blur filter for text\n   * @private\n   */\n  _createBlurFilter(blurConfig, overlayId) {\n    const filterId = `text-blur-${overlayId}`;\n    const blur = typeof blurConfig === 'number' ? blurConfig : (Number(blurConfig) || 1);\n\n    return `<filter id=\"${filterId}\">\n              <feGaussianBlur stdDeviation=\"${blur}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Prepare animation attributes for future anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    // Use unified animation system\n    const standardStyles = RendererUtils.parseStandardAnimationStyles(style);\n\n    const animationAttributes = {\n      textAttributes: [],\n      hasAnimations: false\n    };\n\n    // Use standardized animation data attributes\n    const animationDataAttrs = RendererUtils.createAnimationDataAttributes(standardStyles);\n    if (animationDataAttrs) {\n      animationAttributes.textAttributes.push(animationDataAttrs);\n      animationAttributes.hasAnimations = true;\n    }\n\n    // Legacy support for existing animation properties\n    if (style.pulse_speed || style.pulseSpeed) {\n      animationAttributes.textAttributes.push(`data-pulse-speed=\"${style.pulse_speed || style.pulseSpeed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.fade_speed || style.fadeSpeed) {\n      animationAttributes.textAttributes.push(`data-fade-speed=\"${style.fade_speed || style.fadeSpeed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.typewriter_speed || style.typewriterSpeed) {\n      animationAttributes.textAttributes.push(`data-typewriter-speed=\"${style.typewriter_speed || style.typewriterSpeed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Render a simple fallback text when enhanced rendering fails\n   * @private\n   */\n  _renderFallbackText(overlay, x, y) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const text = style.value || overlay.text || '';\n    const color = style.color || 'var(--lcars-orange)';\n    const fontSize = style.font_size || style.fontSize || 16;\n\n    console.warn(`[TextOverlayRenderer] Using fallback rendering for text ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"text\" data-fallback=\"true\">\n              <text x=\"${x}\" y=\"${y}\"\n                    fill=\"${color}\"\n                    font-size=\"${fontSize}\"\n                    text-anchor=\"start\"\n                    dominant-baseline=\"auto\">\n                ${this.escapeXml(text)}\n              </text>\n            </g>`;\n  }\n\n  /**\n   * Update text styling dynamically (for future real-time updates)\n   * @public\n   */\n  updateTextStyle(overlayId, newStyle) {\n    // Future: Update existing text styles without full re-render\n    console.log(`[TextOverlayRenderer] Style update requested for text ${overlayId}`);\n  }\n\n  /**\n   * Get rendering capabilities and features supported\n   * @public\n   */\n  getCapabilities() {\n    return {\n      multiline: true,\n      gradients: true,\n      patterns: true,\n      effects: ['glow', 'shadow', 'blur'],\n      decorations: ['brackets', 'highlight', 'status'],\n      animations: ['pulse', 'fade', 'typewriter'], // Future implementation\n      textWrapping: true,\n      advancedTypography: true,\n      strokeText: true,\n      advanced: true\n    };\n  }\n\n  /**\n   * Escape XML special characters\n   * @private\n   */\n  static escapeXml(text) {\n    return String(text)\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n\n  /**\n   * Instance method for XML escaping\n   * @private\n   */\n  escapeXml(text) {\n    return TextOverlayRenderer.escapeXml(text);\n  }\n\n  /**\n   * Get attachment points for line connectors with proper coordinate transformation\n   * @public\n   */\n  getAttachmentPoints(overlay, x, y) {\n    const textContent = this._resolveTextContent(overlay, overlay.finalStyle || {});\n    const textStyle = this._resolveTextStyles(overlay.finalStyle || {}, overlay.id);\n    // Use adjusted font for consistent connector attachment\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n\n    return RendererUtils.getTextAttachmentPoints(\n      textContent,\n      x,\n      y,\n      font,\n      textStyle.textAnchor,\n      textStyle.dominantBaseline,\n      this.container\n    );\n  }\n\n  /**\n   * Compute attachment points & bbox for a text overlay without rendering (used by line routing).\n   * Returns null if position or content invalid.\n   */\n  static computeAttachmentPoints(overlay, anchors, container) {\n    if (!overlay || overlay.type !== 'text') return null;\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) return null;\n    const [x, y] = position;\n    const instance = new TextOverlayRenderer();\n    const style = overlay.finalStyle || overlay.style || {};\n    const textStyle = instance._resolveTextStyles(style, overlay.id);\n    const textContent = instance._resolveTextContent(overlay, style);\n    if (!textContent) return null;\n    // Measurement font (correct inherited font + scaling)\n    const font = RendererUtils.buildMeasurementFontString(textStyle, container);\n    const bbox = RendererUtils.getTextBoundingBox(\n      textContent,\n      x,\n      y,\n      font,\n      textStyle.textAnchor,\n      textStyle.dominantBaseline,\n      container\n    );\n    const points = RendererUtils.getTextAttachmentPoints(\n      textContent,\n      x,\n      y,\n      font,\n      textStyle.textAnchor,\n      textStyle.dominantBaseline,\n      container\n    );\n    return {\n      id: overlay.id,\n      center: points.center,\n      points,\n      bbox,\n      textStyle,\n      x,\n      y\n    };\n  }\n\n  // NEW: consolidated measurement helper (mirrors bracket/highlight logic)\n  _measureTextBlock(textContent, x, y, textStyle) {\n    try {\n      const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n      if (textStyle.multiline) {\n        const mm = RendererUtils.measureMultilineText(\n          textContent,\n          font,\n          textStyle.lineHeight,\n          true,\n          this.container\n        );\n        return {\n          width: mm.width,\n          height: mm.height\n        };\n      } else {\n        const m = RendererUtils.measureText(textContent, font, true, this.container);\n        return {\n          width: m.width,\n          height: m.height\n        };\n      }\n    } catch (_) {\n      return { width: 0, height: 0 };\n    }\n  }\n\n  /**\n   * Resolve text content with updated DataSource data (for dynamic updates)\n   * @public - Used by AdvancedRenderer for real-time text overlay updates\n   * @param {Object} overlay - Overlay configuration\n   * @param {Object} style - Style configuration\n   * @param {Object} newDataSourceData - Updated DataSource data\n   * @returns {string} Resolved text content with new data\n   */\n  _resolveTextContentWithData(overlay, style, newDataSourceData) {\n    console.log(`[TextOverlayRenderer] Resolving text content with updated data for ${overlay.id}`);\n\n    // Start with basic content resolution (same as original method)\n    let content = style.value || overlay.text || overlay.content || '';\n\n    // Check raw overlay configuration if content not found in standard properties\n    if (!content && overlay._raw?.content) {\n      content = overlay._raw.content;\n    }\n    if (!content && overlay._raw?.text) {\n      content = overlay._raw.text;\n    }\n\n    // ENHANCED: If we have template content and new DataSource data, process with new data\n    if (content && typeof content === 'string' && content.includes('{') && newDataSourceData) {\n      // CRITICAL FIX: The newDataSourceData might be for a specific source, not all sources\n      // We need to delegate to DataSourceMixin for proper template processing\n      console.log(`[TextOverlayRenderer] DEBUG: Processing template with DataSourceMixin for unified handling`);\n      content = DataSourceMixin.processEnhancedTemplateStringsWithFallback(content, 'TextOverlayRenderer');\n      return content;\n    }\n\n    // Fallback to original logic for other cases\n    return this._resolveTextContent(overlay, style);\n  }\n\n  /**\n   * Process template strings with specific DataSource data\n   * @private\n   * @param {string} templateString - Template string with placeholders\n   * @param {Object} dataSourceData - DataSource data to use for resolution\n   * @returns {string} Processed template string\n   */\n  _processTemplateWithData(templateString, dataSourceData) {\n    console.log(`[TextOverlayRenderer] DEBUG: Processing template: \"${templateString}\"`);\n    console.log(`[TextOverlayRenderer] DEBUG: With data:`, dataSourceData);\n\n    return templateString.replace(/\\{([^}]+)\\}/g, (match, reference) => {\n      console.log(`[TextOverlayRenderer] DEBUG: Processing reference: \"${reference}\"`);\n\n      // Parse the reference (e.g., \"temperature_enhanced.transformations.celsius:.1f\")\n      const [fullPath, formatSpec] = reference.split(':');\n      const pathParts = fullPath.split('.');\n\n      console.log(`[TextOverlayRenderer] DEBUG: Path parts:`, pathParts);\n      console.log(`[TextOverlayRenderer] DEBUG: Format spec:`, formatSpec);\n\n      // Navigate the data structure\n      let value = dataSourceData;\n\n      // FIXED: Handle simple DataSource references properly\n      if (pathParts.length === 1) {\n        // Simple DataSource reference like {test_cpu_temp}\n        // Extract the raw value from the DataSource object\n        if (dataSourceData && typeof dataSourceData === 'object' && 'v' in dataSourceData) {\n          value = dataSourceData.v;\n        } else if (dataSourceData && typeof dataSourceData === 'object' && 'value' in dataSourceData) {\n          value = dataSourceData.value;\n        } else {\n          value = dataSourceData;\n        }\n      } else {\n        // Complex path like {temperature_enhanced.transformations.celsius}\n        for (const part of pathParts.slice(1)) { // Skip the first part (source name)\n          if (value && typeof value === 'object' && part in value) {\n            value = value[part];\n          } else {\n            console.log(`[TextOverlayRenderer] DEBUG: Path navigation failed at \"${part}\"`);\n            return match; // Return original if path doesn't exist\n          }\n        }\n      }\n\n      console.log(`[TextOverlayRenderer] DEBUG: Resolved value:`, value);\n\n      // Apply formatting if specified\n      if (formatSpec && value !== undefined && value !== null) {\n        console.log(`[TextOverlayRenderer] DEBUG: Applying format spec: \"${formatSpec}\"`);\n        const formattedValue = DataSourceMixin.applyNumberFormat(value, formatSpec, dataSourceData?.unit_of_measurement);\n        console.log(`[TextOverlayRenderer] DEBUG: Formatted value: \"${formattedValue}\"`);\n        return formattedValue;\n      }\n\n      return String(value);\n    });\n  }\n}","/* MSD Corner Arc Scenario Harness (Wave 5 - M5.5)\n * Usage:\n *   window.__msdScenarios.arcs.list()\n *   window.__msdScenarios.arcs.runAll()\n */\n(function initArcScenarios(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi(){ const p=W.__msdDebug?.pipelineInstance; if(!p||!p.enabled) throw new Error('pipeline disabled'); return p; }\n  function inspect(id){ return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(scope='*'){ W.__msdDebug?.routing?.invalidate(scope); }\n\n  const targetLine = 'line_grid_forced'; // has corner_style: round with >1 bend after obstacles\n\n  function ensureRound(lineId){\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===lineId);\n    if (!ov) throw new Error('overlay not found');\n    ov._raw = ov._raw || {};\n    ov._raw.corner_style = 'round';\n    ov._raw.corner_radius = ov._raw.corner_radius || 40;\n  }\n\n  function scenarioArcPresence() {\n    ensureRound(targetLine);\n    invalidate('*');\n    const res = inspect(targetLine);\n    const ok = !!res && /A\\d+/.test(res.d) && res.meta.arc && res.meta.arc.count > 0;\n    return { ok, details: { dSample: res?.d?.slice(0,120)+'...', arc: res?.meta?.arc } };\n  }\n\n  function scenarioRadiusClamp() {\n    ensureRound(targetLine);\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===targetLine);\n    const original = ov._raw.corner_radius;\n    ov._raw.corner_radius = 1000; // absurdly large to trigger clamping\n    invalidate('*');\n    const res = inspect(targetLine);\n    ov._raw.corner_radius = original;\n    invalidate('*');\n    const ok = !!res && res.meta.arc && res.meta.arc.count > 0;\n    return { ok, details: { trimPx: res?.meta?.arc?.trimPx, count: res?.meta?.arc?.count } };\n  }\n\n  function scenarioArcCacheReuse() {\n    ensureRound(targetLine);\n    invalidate('*');\n    const first = inspect(targetLine);\n    const second = inspect(targetLine);\n    const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true && second.meta.arc?.count >= 0;\n    return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit, arcCount: second?.meta?.arc?.count } };\n  }\n\n  function scenarioMiterFallback() {\n    // Temporarily set corner_style:miter expect no arc meta\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===targetLine);\n    if (!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origStyle = ov._raw.corner_style;\n    ov._raw.corner_style = 'miter';\n    invalidate('*');\n    const res = inspect(targetLine);\n    ov._raw.corner_style = origStyle;\n    invalidate('*');\n    const ok = !!res && !res.meta.arc;\n    return { ok, details: { hasArcMeta: !!res.meta.arc } };\n  }\n\n  const scenarios = {\n    arc_presence: scenarioArcPresence,\n    radius_clamp: scenarioRadiusClamp,\n    arc_cache_reuse: scenarioArcCacheReuse,\n    miter_fallback: scenarioMiterFallback\n  };\n\n  const api = {\n    list: ()=>Object.keys(scenarios),\n    run: (n)=>{\n      if(!scenarios[n]) { console.warn('[MSD Arc Scenario] Unknown', n); return null; }\n      try {\n        const r = scenarios[n]();\n        console.log(`[MSD Arc Scenario] ${n}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e){\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Arc Scenario] ${n}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: ()=>{\n      const res={};\n      for (const k of Object.keys(scenarios)) res[k]=api.run(k);\n      const allOk = Object.values(res).every(r=>r&&r.ok);\n      console.log('[MSD Arc Scenario] Summary:', allOk?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.arcs = api;\n  console.info('[MSD v1] Arc routing scenario harness installed. Use: window.__msdScenarios.arcs.list()');\n})();\n","/* MSD Channel Routing Scenario Harness (Wave 5 - M5.4)\n * Usage:\n *   window.__msdScenarios.channels.list()\n *   window.__msdScenarios.channels.runAll()\n */\n(function initChannelScenarios(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi(){ const p=W.__msdDebug?.pipelineInstance; if(!p||!p.enabled) throw new Error('pipeline disabled'); return p; }\n  function inspect(id){ return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(scope='*'){ W.__msdDebug?.routing?.invalidate(scope); }\n\n  function setMode(id, modeFull, mode=null){\n    const model = pi().getResolvedModel();\n    const ov = model?.overlays.find(o=>o.id===id);\n    if(!ov) throw new Error('overlay not found '+id);\n    ov._raw = ov._raw || {};\n    if (modeFull !== undefined) ov._raw.route_mode_full = modeFull;\n    if (mode !== null) ov._raw.route_mode = mode;\n    return ov;\n  }\n\n  function scenarioPreferImprovesCost() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origChannels = ov._raw.route_channels ? ov._raw.route_channels.slice() : [];\n    const origMode = ov._raw.route_channel_mode;\n\n    // Baseline without channels\n    ov._raw.route_channels = [];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const base = inspect(id);\n\n    // With channels\n    ov._raw.route_channels = ['main_bus'];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const preferred = inspect(id);\n\n    // restore\n    ov._raw.route_channels = origChannels;\n    ov._raw.route_channel_mode = origMode;\n    invalidate('*');\n\n    const ok = !!base && !!preferred && preferred.meta.cost <= base.meta.cost;\n    return { ok, details: { baseCost: base?.meta.cost, preferCost: preferred?.meta.cost } };\n  }\n\n  function scenarioAvoidIncreasesCost() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origChannels = ov._raw.route_channels ? ov._raw.route_channels.slice() : [];\n    const origMode = ov._raw.route_channel_mode;\n\n    ov._raw.route_channels = ['main_bus'];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const prefer = inspect(id);\n\n    ov._raw.route_channel_mode = 'avoid';\n    invalidate('*');\n    const avoid = inspect(id);\n\n    ov._raw.route_channels = origChannels;\n    ov._raw.route_channel_mode = origMode;\n    invalidate('*');\n\n    const ok = !!prefer && !!avoid && avoid.meta.cost >= prefer.meta.cost;\n    return { ok, details: { preferCost: prefer?.meta.cost, avoidCost: avoid?.meta.cost } };\n  }\n\n  function scenarioForcePenalty() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origChannels = ov._raw.route_channels ? ov._raw.route_channels.slice() : [];\n    const origMode = ov._raw.route_channel_mode;\n\n    ov._raw.route_channels = ['main_bus','aux_bus']; // force across two channels (likely outside some)\n    ov._raw.route_channel_mode = 'force';\n    invalidate('*');\n    const forced = inspect(id);\n\n    ov._raw.route_channels = origChannels;\n    ov._raw.route_channel_mode = origMode;\n    invalidate('*');\n\n    const ok = !!forced && forced.meta.channel && (forced.meta.channel.forcedOutside === true || forced.meta.channel.coveragePct === 100);\n    return { ok, details: forced?.meta.channel || {} };\n  }\n\n  // NEW: attempt to increase coverage by shaping (forces low baseline by clearing channels first)\n  function scenarioPreferShapingCoverage() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const save = {\n      channels: ov._raw.route_channels ? ov._raw.route_channels.slice():[],\n      mode: ov._raw.route_channel_mode,\n      modeFull: ov._raw.route_mode_full\n    };\n    ov._raw.route_mode_full = 'grid';\n    ov._raw.route_channels = ['main_bus'];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const first = inspect(id);\n    // if already high coverage, skip shaping test as pass\n    if (!first || !first.meta.channel) {\n      // restore\n      ov._raw.route_channels = save.channels; ov._raw.route_channel_mode = save.mode; ov._raw.route_mode_full = save.modeFull; invalidate('*');\n      return { ok:false, details:'channel meta missing'};\n    }\n    const c1 = first.meta.channel.coveragePct;\n    // Artificially move elbow outside channel to force shaping attempt by tweaking anchor via API if available\n    try {\n      const anchorSet = pi().setAnchor && pi().setAnchor;\n      if (anchorSet) {\n        // nudge anchor horizontally away\n        const anchorId = ov._raw.anchor;\n        const rm = pi().getResolvedModel();\n        if (rm?.anchors?.[anchorId]) {\n          const a = rm.anchors[anchorId].slice();\n            pi().setAnchor(anchorId, [a[0]-120, a[1]]);\n          invalidate('*');\n        }\n      }\n    } catch {}\n    const second = inspect(id);\n    const c2 = second?.meta?.channel?.coveragePct ?? c1;\n    // restore\n    ov._raw.route_channels = save.channels;\n    ov._raw.route_channel_mode = save.mode;\n    ov._raw.route_mode_full = save.modeFull;\n    invalidate('*');\n    const ok = c2 >= c1;\n    return { ok, details: { coverageBefore: c1, coverageAfter: c2 } };\n  }\n\n  function scenarioForceDowngradeOrFull() {\n    const id='line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const save = {\n      channels: ov._raw.route_channels ? ov._raw.route_channels.slice():[],\n      mode: ov._raw.route_channel_mode\n    };\n    ov._raw.route_channels = ['main_bus','aux_bus'];\n    ov._raw.route_channel_mode = 'force';\n    invalidate('*');\n    const res = inspect(id);\n    const chan = res?.meta?.channel;\n    ov._raw.route_channels = save.channels;\n    ov._raw.route_channel_mode = save.mode;\n    invalidate('*');\n    if (!chan) return { ok:false, details:'no channel meta'};\n    const ok = (chan.coveragePct === 100) || (chan.shaping && chan.shaping.downgraded);\n    return { ok, details: chan };\n  }\n\n  function scenarioChannelAcceptance() {\n    // Re-run core scenarios & aggregate pass/fail\n    const prefer = scenarioPreferImprovesCost();\n    const avoid = scenarioAvoidIncreasesCost();\n    const force = scenarioForcePenalty();\n    const shaping = (typeof scenarioPreferShapingCoverage === 'function') ? scenarioPreferShapingCoverage() : { ok:true };\n    const summaryOk = [prefer, avoid, force, shaping].every(r => r && r.ok);\n    return {\n      ok: summaryOk,\n      details: {\n        prefer, avoid, force, shaping\n      }\n    };\n  }\n\n  const scenarios = {\n    prefer_improves_cost: scenarioPreferImprovesCost,\n    avoid_increases_cost: scenarioAvoidIncreasesCost,\n    force_penalty_or_full_coverage: scenarioForcePenalty,\n    prefer_shaping_coverage: scenarioPreferShapingCoverage,\n    force_downgrade_or_full: scenarioForceDowngradeOrFull,\n    channel_acceptance: scenarioChannelAcceptance    // NEW\n  };\n\n  const api = {\n    list: () => Object.keys(scenarios),\n    run: (n) => {\n      if(!scenarios[n]) { console.warn('[MSD Channel Scenario] Unknown', n); return null; }\n      try {\n        const r = scenarios[n]();\n        console.log(`[MSD Channel Scenario] ${n}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e) {\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Channel Scenario] ${n}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: () => {\n      const res = {};\n      for (const k of Object.keys(scenarios)) res[k] = api.run(k);\n      const ok = Object.values(res).every(r=>r&&r.ok);\n      console.log('[MSD Channel Scenario] Summary:', ok?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.channels = api;\n  console.info('[MSD v1] Channel routing scenario harness installed. Use: window.__msdScenarios.channels.list()');\n})();\n","/* MSD Routing Scenario Harness (Wave 5)\n * Paste/import this once after the pipeline loads (e.g. include in bundle or run in console).\n * Provides reproducible, code-driven tests without editing YAML.\n *\n * Usage (in browser console after card rendered):\n *   window.__msdScenarios.routing.list()\n *   window.__msdScenarios.routing.run('cache')\n *   window.__msdScenarios.routing.runAll()\n *\n * Each scenario returns { ok:boolean, details, warnings:[] } and logs a concise summary.\n */\n\n(function initRoutingHarness(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function requirePipeline() {\n    const pi = W.__msdDebug?.pipelineInstance;\n    if (!pi || pi.enabled === false) throw new Error('Pipeline disabled or missing.');\n    return pi;\n  }\n\n  function getModel() {\n    // Prefer live lastRenderModel if provided by renderer hook\n    return W.__msdDebug?.lastRenderModel || requirePipeline().getResolvedModel?.() || null;\n  }\n\n  function listOverlays() {\n    const m = getModel();\n    return m?.overlays || [];\n  }\n\n  function findOverlay(id) {\n    return listOverlays().find(o => o.id === id);\n  }\n\n  function inspect(id) {\n    return W.__msdDebug?.routing?.inspect(id);\n  }\n\n  function invalidate(scope='*') {\n    W.__msdDebug?.routing?.invalidate(scope);\n  }\n\n  function anchorClone() {\n    const model = getModel();\n    return model?.anchors ? { ...model.anchors } : {};\n  }\n\n  function log(name, result) {\n    const color = result.ok ? 'color:#4caf50' : 'color:#f44336';\n    console.log(`%c[MSD Scenario] ${name}: ${result.ok?'OK':'FAIL'}`, color, result);\n  }\n\n  // --- Scenarios ---\n\n  function scenarioCache() {\n    const lineId = 'line_grid_forced';\n    invalidate('*');\n    const first = inspect(lineId);\n    const second = inspect(lineId);\n    const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true;\n    return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit } };\n  }\n\n  function scenarioGridVsManhattan() {\n    const grid = inspect('line_grid_forced');\n    const man = inspect('line_manhattan_baseline');\n    const ok = !!grid && !!man && grid.meta.strategy.startsWith('grid') && man.meta.strategy.startsWith('manhattan');\n    return { ok, details: { gridStrategy: grid?.meta.strategy, manStrategy: man?.meta.strategy } };\n  }\n\n  function scenarioAvoidCreatesBend() {\n    const targetId = 'line_smart_clear';\n    const ov = findOverlay(targetId);\n    if (!ov) return { ok:false, details:'overlay not found' };\n    const before = inspect(targetId);\n    // monkey patch avoid list\n    ov._raw = ov._raw || {};\n    const originalAvoid = Array.isArray(ov._raw.avoid) ? ov._raw.avoid.slice() : undefined;\n    if (!ov._raw.avoid) ov._raw.avoid = [];\n    if (!ov._raw.avoid.includes('obstacle_vertical')) ov._raw.avoid.push('obstacle_vertical');\n    invalidate('*');\n    const after = inspect(targetId);\n    // restore\n    if (originalAvoid === undefined) delete ov._raw.avoid; else ov._raw.avoid = originalAvoid;\n    invalidate('*');\n    const ok = !!before && !!after && after.meta.bends >= before.meta.bends;\n    return { ok, details: { bendsBefore: before?.meta.bends, bendsAfter: after?.meta.bends } };\n  }\n\n  function scenarioModeHintYX() {\n    const id = 'line_grid_forced';\n    const ov = findOverlay(id);\n    if (!ov) return { ok:false, details:'overlay not found'};\n    ov._raw = ov._raw || {};\n    // Baseline (xy / default)\n    ov._raw.route_mode = 'xy';\n    invalidate('*');\n    const base = inspect(id);\n    // yx\n    ov._raw.route_mode = 'yx';\n    invalidate('*');\n    const yx = inspect(id);\n    // restore\n    delete ov._raw.route_mode;\n    invalidate('*');\n    const basePts = base?.pts || [];\n    const yxPts = yx?.pts || [];\n    // Expect both have an elbow (>=3 points). In xy, second point shares y1 (horizontal first). In yx, second shares x1 (vertical first).\n    const baseHorizontalFirst = basePts.length>=3 && basePts[1][1] === basePts[0][1];\n    const yxVerticalFirst = yxPts.length>=3 && yxPts[1][0] === yxPts[0][0];\n    const ok = baseHorizontalFirst && yxVerticalFirst;\n    return { ok, details: { basePts, yxPts, baseHorizontalFirst, yxVerticalFirst } };\n  }\n\n  function scenarioClearanceShift() {\n    const id = 'line_grid_forced';\n    const router = requirePipeline().router;\n    if (!router) return { ok:false, details:'router missing' };\n    invalidate('*');\n    const base = inspect(id);\n    const orig = router.config.clearance;\n    router.config.clearance = (orig || 8) + 24;\n    invalidate('*');\n    const raised = inspect(id);\n    router.config.clearance = orig;\n    invalidate('*');\n    const ok = !!base && !!raised && raised.meta.cost >= base.meta.cost;\n    return { ok, details: { baseCost: base?.meta.cost, raisedCost: raised?.meta.cost } };\n  }\n\n  function scenarioAnchorMove() {\n    const anchorId = 'smart_far_anchor';\n    const pi = requirePipeline();\n    const model = getModel();\n    if (!model?.anchors || !model.anchors[anchorId]) return { ok:false, details:'anchor not present' };\n    const lineId = 'line_smart_far_avoid';\n    invalidate('*');\n    const before = inspect(lineId);\n    const orig = model.anchors[anchorId].slice();\n    // Use pipeline API (updates cardModel + resolvedModel + rerender)\n    const moved = pi.setAnchor(anchorId, [orig[0] + 40, orig[1]]);\n    invalidate('*');\n    const after = inspect(lineId);\n    // revert\n    pi.setAnchor(anchorId, orig);\n    invalidate('*');\n    const ok = moved && !!before && !!after && before.pts[0][0] !== after.pts[0][0];\n    return { ok, details: { from: before?.pts[0], to: after?.pts[0], moved } };\n  }\n\n  function scenarioFallbackOnImpossibleGrid() {\n    const router = requirePipeline().router;\n    if (!router) return { ok:false, details:'router missing'};\n    const originalComputeGrid = router._computeGrid;\n    // Force failure for this call only by returning null\n    router._computeGrid = function(req){ if (req.id === 'line_grid_forced') return null; return originalComputeGrid.call(this, req); };\n    invalidate('*');\n    const res = inspect('line_grid_forced');\n    // restore\n    router._computeGrid = originalComputeGrid;\n    invalidate('*');\n    const ok = !!res && /manhattan|fallback/.test(res.meta.strategy);\n    return { ok, details: { strategy: res?.meta.strategy } };\n  }\n\n  const scenarios = {\n    cache: scenarioCache,\n    grid_vs_manhattan: scenarioGridVsManhattan,\n    avoid_creates_bend: scenarioAvoidCreatesBend,\n    mode_hint_yx: scenarioModeHintYX,\n    clearance_shift: scenarioClearanceShift,\n    anchor_move: scenarioAnchorMove,\n    fallback_impossible_grid: scenarioFallbackOnImpossibleGrid\n  };\n\n  const api = {\n    list: () => Object.keys(scenarios),\n    run: (name) => {\n      if (!scenarios[name]) { console.warn('[MSD Scenario] Unknown', name); return null; }\n      try {\n        const r = scenarios[name]();\n        log(name, r);\n        return r;\n      } catch(e) {\n        const r = { ok:false, details:String(e) };\n        log(name, r);\n        return r;\n      }\n    },\n    runAll: () => {\n      const results = {};\n      for (const k of Object.keys(scenarios)) results[k] = api.run(k);\n      const summaryOk = Object.values(results).every(r => r && r.ok);\n      console.log('[MSD Scenario] Summary:', summaryOk?'ALL PASS':'FAILURES', results);\n      return results;\n    }\n  };\n\n  W.__msdScenarios.routing = api;\n  console.info('[MSD v1] Routing scenario harness installed. Use: window.__msdScenarios.routing.list()');\n})();\n","/* MSD Smart Routing Scenario Harness (Wave 5 - M5.3)\n * Usage:\n *   window.__msdScenarios.smart.list()\n *   window.__msdScenarios.smart.run('smart_vs_grid_cost')\n *   window.__msdScenarios.smart.runAll()\n */\n\n(function initSmartRoutingHarness(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi() {\n    const p = W.__msdDebug?.pipelineInstance;\n    if (!p || p.enabled === false) throw new Error('Pipeline disabled or missing.');\n    return p;\n  }\n  function inspect(id) { return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(scope='*'){ W.__msdDebug?.routing?.invalidate(scope); }\n\n  function withMode(id, modeFull, fn) {\n    const model = W.__msdDebug?.lastRenderModel;\n    const ov = model?.overlays?.find(o=>o.id===id);\n    if (!ov) throw new Error('overlay not found: '+id);\n    ov._raw = ov._raw || {};\n    const orig = ov._raw.route_mode_full;\n    ov._raw.route_mode_full = modeFull;\n    try {\n      invalidate('*');\n      return fn();\n    } finally {\n      ov._raw.route_mode_full = orig;\n      invalidate('*');\n    }\n  }\n\n  // NEW: helper to set mode without auto-restore (caller restores after use)\n  function setMode(id, modeFull) {\n    const model = W.__msdDebug?.lastRenderModel;\n    const ov = model?.overlays?.find(o=>o.id===id);\n    if (!ov) throw new Error('overlay not found: '+id);\n    ov._raw = ov._raw || {};\n    ov._raw.route_mode_full = modeFull;\n  }\n\n  function scenarioSmartVsGridCost() {\n    // Reuse a grid candidate overlay id\n    const id = 'line_grid_forced';\n    const grid = withMode(id, 'grid', ()=>inspect(id));\n    const smart = withMode(id, 'smart', ()=>inspect(id));\n    const ok = !!grid && !!smart && smart.meta.strategy === 'smart' && smart.meta.cost <= grid.meta.cost + 40;\n    return { ok, details: { gridCost: grid?.meta.cost, smartCost: smart?.meta.cost } };\n  }\n\n  function scenarioSmartRefinementAttempt() {\n    const id = 'line_grid_forced';\n    const smart = withMode(id, 'smart', ()=>inspect(id));\n    const smartMeta = smart?.meta?.smart;\n    const ok = !!smartMeta && smartMeta.detoursTried >= 0; // Accept even zero (no need for forced detour)\n    return { ok, details: smartMeta };\n  }\n\n  function scenarioSmartPenaltyReduction() {\n    const id = 'line_smart_blocked';\n    const baseSmart = withMode(id, 'smart', ()=>inspect(id));\n    const meta = baseSmart?.meta;\n    if (!meta?.smart) return { ok:false, details:'no smart meta' };\n    const ok = meta.smart.penaltyAfter <= meta.smart.penaltyBefore;\n    return { ok, details: meta.smart };\n  }\n\n  // REPLACE scenarioSmartCacheBehavior implementation\n  function scenarioSmartCacheBehavior() {\n    const id = 'line_smart_forced_xy';\n    const model = W.__msdDebug?.lastRenderModel;\n    const ov = model?.overlays?.find(o=>o.id===id);\n    if (!ov) return { ok:false, details:'overlay not found' };\n    ov._raw = ov._raw || {};\n    const original = ov._raw.route_mode_full;\n\n    try {\n      setMode(id, 'smart');\n      invalidate('*');\n      const first = inspect(id);        // expect miss\n      const second = inspect(id);       // expect hit (same mode & unchanged env)\n      const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true;\n      return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit } };\n    } catch(e) {\n      return { ok:false, details:String(e) };\n    } finally {\n      ov._raw.route_mode_full = original;\n      invalidate('*');\n    }\n  }\n\n  const scenarios = {\n    smart_vs_grid_cost: scenarioSmartVsGridCost,\n    smart_refinement_attempt: scenarioSmartRefinementAttempt,\n    smart_penalty_reduction: scenarioSmartPenaltyReduction,\n    smart_cache_behavior: scenarioSmartCacheBehavior\n  };\n\n  const api = {\n    list: ()=>Object.keys(scenarios),\n    run: (name)=>{\n      if (!scenarios[name]) { console.warn('[MSD Smart Scenario] Unknown', name); return null; }\n      try {\n        const r = scenarios[name]();\n        console.log(`[MSD Smart Scenario] ${name}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e) {\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Smart Scenario] ${name}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: ()=>{\n      const res = {};\n      for (const k of Object.keys(scenarios)) res[k] = api.run(k);\n      const summaryOk = Object.values(res).every(r => r && r.ok);\n      console.log('[MSD Smart Scenario] Summary:', summaryOk?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.smart = api;\n  console.info('[MSD v1] Smart routing scenario harness installed. Use: window.__msdScenarios.smart.list()');\n})();\n","/* MSD Smoothing Scenario Harness (Wave 5 - M5.6)\n * Usage:\n *   window.__msdScenarios.smoothing.list()\n *   window.__msdScenarios.smoothing.runAll()\n */\n(function initSmoothingScenarios(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi(){ const p=W.__msdDebug?.pipelineInstance; if(!p||!p.enabled) throw new Error('pipeline disabled'); return p; }\n  function inspect(id){ return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(){ W.__msdDebug?.routing?.invalidate('*'); }\n\n  const target = 'line_grid_forced';\n\n  function ensureBaseline(){\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===target);\n    if (!ov) throw new Error('overlay not found');\n    ov._raw = ov._raw || {};\n    return ov;\n  }\n\n  function scenarioSmoothingIncreasesPoints(){\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'none';\n    ov._raw.smoothing_iterations = 0;\n    invalidate();\n    const base = inspect(target);\n    ov._raw.smoothing_mode = 'chaikin';\n    ov._raw.smoothing_iterations = 2;\n    invalidate();\n    const sm = inspect(target);\n    // restore\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    const ok = !!base && !!sm && sm.pts.length > base.pts.length && sm.meta.smooth;\n    return { ok, details: { basePts: base?.pts.length, smoothPts: sm?.pts.length, meta: sm?.meta?.smooth } };\n  }\n\n  function scenarioCacheHit(){\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'chaikin';\n    ov._raw.smoothing_iterations = 1;\n    invalidate();\n    const first = inspect(target);\n    const second = inspect(target);\n    // restore\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true;\n    return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit } };\n  }\n\n  function scenarioDisableNoSmoothMeta(){\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'none';\n    ov._raw.smoothing_iterations = 0;\n    invalidate();\n    const res = inspect(target);\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    const ok = !!res && !res.meta.smooth;\n    return { ok, details: { hasSmoothMeta: !!res.meta.smooth } };\n  }\n\n  function scenarioInvalidModeFallback() {\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'bogus_mode';\n    ov._raw.smoothing_iterations = 2;\n    invalidate();\n    const res = inspect(target);\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    // Expect no meta.smooth because mode invalid  coerced to none\n    const ok = !!res && !res.meta.smooth;\n    return { ok, details: { hasSmoothMeta: !!res.meta.smooth } };\n  }\n\n  const scenarios = {\n    smoothing_increases_points: scenarioSmoothingIncreasesPoints,\n    smoothing_cache_hit: scenarioCacheHit,\n    smoothing_disabled_no_meta: scenarioDisableNoSmoothMeta,\n    smoothing_invalid_mode_fallback: scenarioInvalidModeFallback   // NEW\n  };\n\n  const api = {\n    list: ()=>Object.keys(scenarios),\n    run: (n)=>{\n      if(!scenarios[n]) { console.warn('[MSD Smooth Scenario] Unknown', n); return null; }\n      try {\n        const r = scenarios[n]();\n        console.log(`[MSD Smooth Scenario] ${n}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e){\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Smooth Scenario] ${n}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: ()=>{\n      const res={};\n      for(const k of Object.keys(scenarios)) res[k]=api.run(k);\n      const ok = Object.values(res).every(r=>r && r.ok);\n      console.log('[MSD Smooth Scenario] Summary:', ok?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.smoothing = api;\n  console.info('[MSD v1] Smoothing scenario harness installed. Use: window.__msdScenarios.smoothing.list()');\n})();\n","import { cblcarsLog } from './cb-lcars-logging.js';\nimport { animPresets } from './cb-lcars-anim-presets.js';\n\n/**\n * Waits for an element to be present in the DOM.\n * @param {string} selector - The CSS selector for the element.\n * @param {Element|Document} root - The root element to search within.\n * @param {number} timeout - The maximum time to wait in milliseconds.\n * @returns {Promise<Element>}\n */\nexport function waitForElement(selector, root = document, timeout = 2000) {\n  return new Promise((resolve, reject) => {\n    const found = root.querySelector(selector);\n    if (found) return resolve(found);\n\n    const observer = new MutationObserver(() => {\n      const el = root.querySelector(selector);\n      if (el) {\n        try { observer.disconnect(); } catch(_) {}\n        clearTimeout(to);\n        resolve(el);\n      }\n    });\n    observer.observe(root, { childList: true, subtree: true });\n\n    const to = setTimeout(() => {\n      try { observer.disconnect(); } catch(_) {}\n      reject(new Error(`[CB-LCARS] Timeout waiting for element: ${selector}`));\n    }, timeout);\n  });\n}\n\n/**\n * Resolves one or many targets into an array of Elements.\n * Enhancements:\n * - Supports comma-separated selector strings: \"#a, .b, svg path\"\n * - Expands NodeList/HTMLCollection into elements\n * - For selector strings, resolves first match by waiting, and also includes any currently matching additional elements\n * @param {string|Element|Array<string|Element>|NodeList|HTMLCollection} targets\n * @param {Element|Document} root\n * @param {number} timeout\n * @returns {Promise<Element[]>}\n */\nexport async function waitForElements(targets, root = document, timeout = 2000) {\n  const toArray = (v) => Array.isArray(v)\n    ? v\n    : (v && typeof v.length === 'number' && typeof v.item === 'function')\n      ? Array.from(v) // NodeList/HTMLCollection\n      : [v];\n\n  const items = toArray(targets).filter(Boolean);\n  const results = [];\n\n  for (const item of items) {\n    try {\n      if (item instanceof Element) {\n        results.push(item);\n        continue;\n      }\n\n      if (typeof item === 'string') {\n        // Split comma-separated selector lists\n        const selectors = item.split(',').map(s => s.trim()).filter(Boolean);\n        for (const sel of selectors) {\n          // Wait for first appearance of this selector\n          const first = await waitForElement(sel, root, timeout);\n          if (first) results.push(first);\n          // Also include any additional matches that are already present\n          const allNow = root.querySelectorAll(sel);\n          for (const el of Array.from(allNow)) {\n            if (!results.includes(el)) results.push(el);\n          }\n        }\n        continue;\n      }\n\n      cblcarsLog.warn('[waitForElements] Unsupported target type, skipping.', { item });\n    } catch (e) {\n      cblcarsLog.error('[waitForElements] Failed to resolve target:', { item, error: e });\n    }\n  }\n  return results;\n}\n\n/**\n * A generic wrapper for anime.js that resolves targets within a given root element.\n * If scopeId is provided, add the animation to the scope.\n * @param {object} options - The anime.js animation options.\n * @param {string|Element|Array} options.targets - Selector(s) or element(s).\n * @param {Element} [options.root=document] - The root element for the selector query.\n * @param {string} [options.scopeId] - The scope ID to use.\n */\nexport async function animateWithRoot(options) {\n  const { targets, root = document, scopeId, ...animOptions } = options;\n  if (!targets) {\n    cblcarsLog.warn('[animateWithRoot] Animation missing targets.', { options });\n    return;\n  }\n  try {\n    const elements = await waitForElements(targets, root);\n    if (elements.length === 0) {\n      cblcarsLog.warn('[animateWithRoot] No targets resolved.', { targets });\n      return;\n    }\n\n    for (const element of elements) {\n      try {\n        let animation;\n        if (scopeId && window.cblcars.anim.scopes.has(scopeId)) {\n          const scopeObj = window.cblcars.anim.scopes.get(scopeId);\n          animation = window.cblcars.anime(element, { ...animOptions, scope: scopeObj.scope });\n          scopeObj.addAnimation(animation);\n        } else {\n          animation = window.cblcars.anime(element, animOptions);\n        }\n      } catch (e) {\n        cblcarsLog.error('[animateWithRoot] Failed to animate a resolved element.', { element: element?.id, error: e });\n      }\n    }\n  } catch (error) {\n    cblcarsLog.error('[animateWithRoot] Failed to animate element(s):', { targets, error });\n  }\n}\n\n/**\n * Animates element(s) using anime.js with special handling for SVG animations.\n * Unchanged behavior, v4-native through window.cblcars.anim.anime\n */\nexport async function animateElement(scope, options, hass = null) {\n  const { type, targets, root = document, ...animOptions } = options;\n  if (!type || !targets || !scope) {\n    cblcarsLog.warn('[animateElement] Animation missing type, targets, or scope.', { options, scope });\n    return;\n  }\n  cblcarsLog.debug('[animateElement] Received options:', { options });\n\n  scope.scope.add(async () => {\n    try {\n      const elements = await waitForElements(targets, root);\n      if (!elements || elements.length === 0) {\n        cblcarsLog.error('[animateElement] Target element(s) not found:', { targets });\n        return;\n      }\n\n      for (const element of elements) {\n        const params = {\n          duration: 1000,\n          easing: 'easeInOutQuad',\n          ...animOptions,\n        };\n\n        // state_resolver hook (left as-is)\n        if (options.state_resolver && options.entity && window.cblcars.styleHelpers?.resolveStateStyles) {\n          const resolvedStyles = window.cblcars.styleHelpers.resolveStateStyles(\n            options.state_resolver,\n            hass,\n            options.entity\n          );\n          Object.assign(params, resolvedStyles);\n        }\n\n        // Apply preset(s)\n        if (Array.isArray(type)) {\n          applyPresets(type, params, element, options);\n        } else {\n          const presetFn = animPresets[String(type).toLowerCase()];\n          if (presetFn) {\n            await presetFn(params, element, options);\n          } else if (String(type).toLowerCase() === 'morph') {\n            if (!options.morph_to_selector) {\n              cblcarsLog.error('[animateElement] morph animation requires a `morph_to_selector`.', { options });\n              continue;\n            }\n            const morphTarget = await waitForElement(options.morph_to_selector, root);\n            if (!morphTarget) {\n              cblcarsLog.error(`[animateElement] morph could not find target shape for selector: ${options.morph_to_selector}`);\n              continue;\n            }\n            const precision = options.precision ? parseInt(options.precision, 10) : undefined;\n            Object.assign(params, { d: window.cblcars.animejs.svg.morphTo(morphTarget, precision) });\n          } else {\n            cblcarsLog.debug(`[animateElement] Using standard animation for type: ${type}`, { params });\n          }\n        }\n\n        // Skip if preset handled via CSS or nulled targets\n        if (params._cssAnimation || params.targets === null) {\n          continue;\n        }\n\n        window.cblcars.anim.anime(element, params);\n        cblcarsLog.debug(`[animateElement] Animation constructor added to scope: ${scope.id}`, { params, element: element.id });\n      }\n    } catch (error) {\n      cblcarsLog.error('[animateElement] Failed to animate element(s):', { targets, type, error });\n    }\n  });\n}\n\n\n/**\n * v4: Create a single timeline from an array of steps.\n * Uses createTimeline consistently and add(targets, vars, offset).\n * @param {Array} timelineConfig - [{ targets, ...vars, offset? }]\n * @param {string} scopeId\n * @param {Element|Document} root\n */\nexport async function createTimeline(timelineConfig, scopeId, root = document) {\n  const scopeObj = window.cblcars.anim.scopes.get(scopeId);\n  const timeline = window.cblcars.anim.animejs.createTimeline({ scope: scopeObj?.scope });\n\n  if (!Array.isArray(timelineConfig)) return timeline;\n\n  for (const step of timelineConfig) {\n    const { targets, offset, ...vars } = step || {};\n    if (!targets) continue;\n    const element = await window.cblcars.anim.waitForElement(targets, root);\n    if (!element) continue;\n    timeline.add(element, vars, offset);\n  }\n  if (scopeObj) scopeObj.addAnimation?.(timeline);\n  return timeline;\n}\n\n/**\n * Creates multiple anime.js timelines from a config object, supporting global params and step merging.\n * Enhancements:\n * - Supports step.state_resolver using variables.msd.presets (stylePresets).\n * - Only strips 'direction' (v4 removed); keeps 'alternate' and 'loop'.\n * - Respects autoplay: does not force timeline.play() when autoplay === false.\n * - Marks preset calls with __timeline for timeline-friendly behavior.\n *\n * @param {object} timelinesConfig\n * @param {string} scopeId\n * @param {Element|Document} root\n * @param {object} overlayConfigs\n * @param {object|null} hass\n * @param {object} stylePresets - variables.msd.presets\n * @returns {Promise<object>} timelines by name\n */\nexport async function createTimelines(\n  timelinesConfig,\n  scopeId,\n  root = document,\n  overlayConfigs = {},\n  hass = null,\n  stylePresets = {}\n) {\n  const scopeObj = window.cblcars.anim.scopes.get(scopeId);\n  if (!scopeObj) {\n    cblcarsLog.error('[createTimelines] Scope not found:', scopeId);\n    return {};\n  }\n  const timelines = {};\n  const resolveAll = window.cblcars.styleHelpers?.resolveAllDynamicValues;\n\n  for (const [timelineName, timelineConfig] of Object.entries(timelinesConfig || {})) {\n    const { steps, ...timelineGlobals } = timelineConfig || {};\n    const resolvedGlobals = resolveAll ? resolveAll(timelineGlobals, hass) : timelineGlobals;\n\n    const timeline = window.cblcars.anim.animejs.createTimeline({\n      scope: scopeObj.scope,\n      ...resolvedGlobals\n    });\n\n    if (!steps || !Array.isArray(steps)) {\n      cblcarsLog.warn(`[createTimelines] Timeline \"${timelineName}\" has no steps array.`);\n      timelines[timelineName] = timeline;\n      continue;\n    }\n\n    for (const step of steps) {\n      let elements = [];\n      try {\n        elements = await waitForElements(step.targets, root);\n      } catch (error) {\n        cblcarsLog.error(`[createTimelines] Failed to find target(s) for \"${timelineName}\":`, { targets: step.targets, error });\n        continue;\n      }\n      if (!elements || elements.length === 0) {\n        cblcarsLog.warn(`[createTimelines] No elements found for timeline \"${timelineName}\" step:`, { targets: step.targets });\n        continue;\n      }\n\n      for (const element of elements) {\n        const elementAnim = overlayConfigs?.[element.id]?.animation || {};\n        let mergedParams = { ...elementAnim, ...resolvedGlobals, ...step };\n\n        // State resolver on steps\n        if (step?.state_resolver && window.cblcars.styleHelpers?.resolveStatePreset) {\n          try {\n            const overrides = window.cblcars.styleHelpers.resolveStatePreset(\n              { state_resolver: step.state_resolver, entity: step.entity, attribute: step.attribute },\n              stylePresets,\n              hass\n            );\n            if (overrides && typeof overrides === 'object') {\n              if (overrides.animation && typeof overrides.animation === 'object') {\n                mergedParams = { ...mergedParams, ...overrides.animation };\n              } else {\n                mergedParams = { ...mergedParams, ...overrides };\n              }\n            }\n          } catch (e) {\n            cblcarsLog.warn('[createTimelines] step.state_resolver failed', { timelineName, step, error: e });\n          }\n        }\n\n        // Resolve dynamic values\n        mergedParams = resolveAll ? resolveAll(mergedParams, hass) : mergedParams;\n\n        // Defaults for text transforms in some presets\n        if (\n          (mergedParams.type === 'pulse' || mergedParams.type === 'glow') &&\n          (element.tagName === 'text' || element.tagName === 'TEXT')\n        ) {\n          element.style.transformOrigin = 'center';\n          element.style.transformBox = 'fill-box';\n        }\n\n        // Apply preset, marking timeline context\n        if (mergedParams.type && animPresets[mergedParams.type]) {\n          mergedParams.__timeline = true;\n          await animPresets[mergedParams.type](mergedParams, element, mergedParams);\n        }\n\n        // Strip non-anime keys\n        const {\n          targets, offset, direction,\n          state_resolver, preset, entity, attribute, __timeline,\n          // NEW: strip these flags from anime params\n          deep, descendants, apply_to,\n          ...animeParams\n        } = mergedParams;\n\n        // Determine whether to apply immediate props to descendants\n        const applyToDescendants =\n          mergedParams.descendants === true ||\n          mergedParams.deep === true ||\n          mergedParams.apply_to === 'descendants';\n\n        // Ensure non-animated properties are applied at the step start\n        const immediateKeys = ['fill', 'stroke', 'stroke-width', 'filter', 'color', 'opacity'];\n        const immediateSet = {};\n        for (const k of immediateKeys) {\n          if (animeParams[k] !== undefined && !Array.isArray(animeParams[k]) && typeof animeParams[k] !== 'object') {\n            immediateSet[k] = animeParams[k];\n          }\n        }\n        if (Object.keys(immediateSet).length) {\n          const userOnBegin = animeParams.onBegin;\n          animeParams.onBegin = () => {\n            try {\n              const nodes = applyToDescendants ? element.querySelectorAll('*') : [element];\n              if (window.cblcars?.anim?.utils?.set) {\n                nodes.forEach((n) => window.cblcars.anim.utils.set(n, immediateSet));\n              } else {\n                nodes.forEach((n) => {\n                  for (const [prop, val] of Object.entries(immediateSet)) {\n                    if (prop in n.style) n.style[prop] = val;\n                    else n.setAttribute(prop, val);\n                  }\n                });\n              }\n            } catch (_) {}\n            if (typeof userOnBegin === 'function') userOnBegin();\n          };\n        }\n\n        // v4 add(targets, vars, offset)\n        timeline.add(element, animeParams, offset);\n      }\n    }\n\n    if (typeof scopeObj.addAnimation === 'function') {\n      scopeObj.addAnimation(timeline);\n    }\n    timelines[timelineName] = timeline;\n\n    if (resolvedGlobals?.autoplay === false) {\n      cblcarsLog.info(`[createTimelines] Timeline \"${timelineName}\" created with autoplay: false.`);\n    }\n  }\n  return timelines;\n}\n\n/**\n * Applies one or more animation presets to the anime.js params object.\n */\nexport function applyPresets(types, params, element, options) {\n  const presetList = Array.isArray(types) ? types : [types];\n  for (const type of presetList) {\n    const presetFn = animPresets[type.toLowerCase()];\n    if (presetFn) {\n      presetFn(params, element, options?.[type] || options);\n    }\n  }\n}\n\n\n","import { cblcarsLog } from './cb-lcars-logging.js';\nimport * as svgHelpers from './cb-lcars-svg-helpers.js';\n\n// legacy - svg errors logged to overlay need to be ported to v1 style\n//import { svgOverlayManager } from './cb-lcars-overlay-helpers.js';\n\n/**\n * Utility: test if a path 'd' string has drawable geometry beyond a single move.\n */\nfunction hasUsablePathD(d) {\n  if (!d || typeof d !== 'string') return false;\n  // Must contain at least one command beyond the initial M (e.g., L,C,Q,A,Z)\n  return /[MLCQAHVZmlcqahvz].*[MLCQAHVZmlcqahvz]/.test(d) || /[LCAHVQZlca hvqz]/.test(d);\n}\n\nexport const animPresets = {\n    /**\n     * @preset draw\n     * Animates the drawing of an SVG path.\n     * @param {object} params - Anime.js v4 params object.\n     * @param {Element} element - SVG path element.\n     * @param {object} options - Animation config.\n     */\n    draw: (params, element, options = {}) => {\n        // Use animejs v4 createDrawable for robust SVG path drawing\n        const [drawable] = window.cblcars.animejs.svg.createDrawable(element);\n\n        // Standard anime.js options\n        const duration = params.duration ?? options.duration ?? 1200;\n        const easing = params.easing ?? options.easing ?? 'easeInOutSine';\n        const loop = params.loop ?? options.loop ?? false;\n        const alternate = params.alternate ?? options.alternate ?? false;\n\n        // Draw-specific config: prefer params.draw, then options.draw, then default\n        const drawCfg = params.draw || options.draw || {};\n        let drawValues;\n        if (Array.isArray(drawCfg)) {\n            drawValues = drawCfg;\n        } else if (drawCfg && Array.isArray(drawCfg.values)) {\n            drawValues = drawCfg.values;\n        } else {\n            drawValues = ['0 0', '0 1'];\n        }\n\n        // Set the anime.js params for draw animation\n        Object.assign(params, {\n            targets: drawable,\n            draw: drawValues,\n            duration,\n            easing,\n            loop,\n            alternate\n        });\n\n        // Remove any conflicting opacity/stroke-width from params\n        delete params.opacity;\n        delete params['stroke-width'];\n    },\n    /* //stutters on loop with anime.js .. use css version for now\n    march: (params, element, options) => {\n        const dashArray = element.getAttribute('stroke-dasharray');\n        if (!dashArray || dashArray === 'none') return;\n        const patternLength = dashArray.split(/[\\s,]+/).reduce((acc, len) => acc + parseFloat(len), 0);\n        if (patternLength === 0) return;\n        element.style.strokeDashoffset = '0';\n        const endValue = params.direction === 'reverse' ? patternLength : -patternLength;\n        Object.assign(params, {\n            strokeDashoffset: [0, endValue],\n        });\n        if (params.loop === undefined) params.loop = true;\n        if (params.easing === 'easeInOutQuad') params.easing = 'linear';\n    },\n    fade: (params) => {\n        Object.assign(params, { opacity: [0, 1] });\n    },\n    */\n    /**\n     * @preset pulse\n     * Pulses scale and opacity for a \"breathing\" effect (text), or stroke-width and opacity for lines.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    pulse: (params, element, options = {}) => {\n        cblcarsLog.debug('[pulse preset] Before mutation:', { params, element, options });\n\n        // Prefer pulse config from params.pulse, then options.pulse, then options, then defaults\n        const pulseCfg = params.pulse || options.pulse || options || {};\n        const maxScale = pulseCfg.max_scale !== undefined\n            ? pulseCfg.max_scale\n            : (element.tagName === 'text' || element.tagName === 'TEXT' ? 1.1 : 1.5);\n        const minOpacity = pulseCfg.min_opacity !== undefined\n            ? pulseCfg.min_opacity\n            : 0.7;\n\n        // Remove any previous stroke-width/opacity assignments to avoid conflicts\n        delete params['stroke-width'];\n        delete params.opacity;\n\n        // Generic anime.js options from main animation key\n        const duration = params.duration ?? options.duration ?? 1200;\n        const easing = params.easing ?? options.easing ?? 'easeInOutSine';\n        const loop = params.loop ?? options.loop ?? true;\n        const alternate = params.alternate ?? options.alternate ?? true;\n\n        if (element.tagName === 'text' || element.tagName === 'TEXT') {\n            Object.assign(params, {\n                scale: [1, maxScale],\n                opacity: [1, minOpacity],\n                easing,\n                duration,\n                loop,\n                alternate\n            });\n            element.style.transformOrigin = 'center';\n            element.style.transformBox = 'fill-box';\n            cblcarsLog.debug('[pulse preset] Set transformOrigin/transformBox for text:', {\n                id: element.id,\n                style: element.style.cssText\n            });\n        } else if (element.hasAttribute('stroke-width')) {\n            // Pulse lines: animate stroke-width and opacity\n            const width = parseFloat(element.getAttribute('stroke-width')) || 4;\n            Object.assign(params, {\n                'stroke-width': [width, width * maxScale],\n                opacity: [1, minOpacity],\n                easing,\n                duration,\n                loop,\n                alternate\n            });\n            cblcarsLog.debug('[pulse preset] Pulsing line:', {\n                id: element.id,\n                strokeWidth: width,\n                maxScale\n            });\n        } else {\n            // Fallback: just animate opacity\n            Object.assign(params, {\n                opacity: [1, minOpacity],\n                easing,\n                duration,\n                loop,\n                alternate\n            });\n        }\n        cblcarsLog.debug('[pulse preset] After mutation:', { params, element });\n    },\n    /**\n     * @preset blink\n     * Blinks opacity between two values.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    blink: (params, element, options) => {\n        Object.assign(params, {\n            opacity: [options.max_opacity ?? 1, options.min_opacity ?? 0.3],\n            alternate: true,\n            loop: true,\n            easing: options.easing || 'linear', // or 'easeInOutSine'\n            duration: options.duration ?? 1200\n        });\n    },\n\n    fade: (params, element, options = {}) => {\n    const duration = params.duration ?? options.duration ?? 1000;\n    const easing = params.easing ?? options.easing ?? 'linear';\n    const loop = params.loop ?? options.loop ?? false;\n    const alternate = params.alternate ?? options.alternate ?? false;\n    Object.assign(params, {\n        opacity: [0, 1],\n        duration,\n        easing,\n        loop,\n        alternate\n    });\n    },\n\n    /**\n     * @preset motionpath\n     * Animates a tracer along a path, with optional trail.\n     * Contract:\n     *  - tracer is required; if missing, the preset aborts and surfaces an overlay error.\n     *  - Waits until the target <path> has a valid 'd' before building transforms.\n     *  - If the path has data-cblcars-pending=\"true\" (sparkline baseline), trail is hidden until real data arrives.\n     *  - Listens for 'd' and 'data-cblcars-pending' changes, re-binding tracer and syncing trail as the path updates.\n     *\n     * Anime.js v4 notes:\n     *  - Use window.cblcars.anim.anime(targets, vars)\n     *  - Use window.cblcars.animejs.svg.createMotionPath(pathEl)  { translateX, translateY, rotate }\n     *  - Use window.cblcars.animejs.svg.createDrawable(pathEl) for draw animations\n     *\n     * Required external helpers (already in this project):\n     *  - window.cblcars.waitForElement(selector, root)\n     *  - svgOverlayManager.push(msg) for user-visible overlay errors\n     */\n\n\n    /**\n     * @preset motionpath  (UPDATED MOTIONPATH PRESET  Option D)\n     * Robust wait for usable path + pending flag, tracer & trail support, auto rebind.\n     */\n    motionpath: async function motionpathPreset(params, element, options = {}) {\n        try {\n            const root = options.root ?? document;\n\n            // Provide waitForElement alias if missing\n            if (!window.cblcars.waitForElement && window.cblcars.anim?.waitForElement) {\n                window.cblcars.waitForElement = window.cblcars.anim.waitForElement;\n            }\n\n            const tracerCfg = options.tracer;\n            if (!tracerCfg) {\n                const msg = '[motionpath] tracer is required';\n                cblcarsLog.warn(msg, { element });\n                //svgOverlayManager.push(msg);\n                params.targets = null;\n                return;\n            }\n\n            const pathSelector = options.path_selector;\n            let pathEl = pathSelector\n                ? (await window.cblcars.waitForElement(pathSelector, root).catch(() => null))\n                : element;\n\n            if (!pathEl) {\n                const errorMsg = `Motionpath: path not found for selector \"${pathSelector || '(self)'}\"`;\n                cblcarsLog.error(errorMsg);\n                //svgOverlayManager.push(errorMsg);\n                params.targets = null;\n                return;\n            }\n            if (String(pathEl.tagName).toLowerCase() !== 'path') {\n                const msg = '[motionpath] Target is not an SVG <path>';\n                cblcarsLog.warn(msg, { id: pathEl.id });\n                //svgOverlayManager.push(msg);\n                params.targets = null;\n                return;\n            }\n\n            const baseId = pathEl.id || 'msd_path';\n\n            // Helper: determine if path 'd' is actually usable (not just single move or zero length)\n            const hasUsablePathD = (p) => {\n                if (!p || typeof p !== 'string') return false;\n                // Require at least one command beyond initial M and a second coordinate\n                // Simpler: must contain an 'L','C','Q','A','H','V','Z' (besides the opening M)\n                return /[LCHQAVZlchqavz]/.test(p);\n            };\n            const pathLengthOk = (el) => {\n                try {\n                    return el.getTotalLength() > 0.5;\n                } catch (_) {\n                    return false;\n                }\n            };\n            const isPending = (el) => el?.getAttribute('data-cblcars-pending') === 'true';\n\n            const cleanupArtifacts = () => {\n                const svgRoot = pathEl.ownerSVGElement || pathEl.closest('svg') || root;\n                if (!svgRoot) return;\n                const priorTracer = svgRoot.querySelector(`#${baseId}_tracer[data-cblcars-owned=\"motionpath\"]`);\n                const priorTrail = svgRoot.querySelector(`#${baseId}_trail[data-cblcars-owned=\"motionpath\"]`);\n                if (priorTracer?.parentNode) priorTracer.parentNode.removeChild(priorTracer);\n                if (priorTrail?.parentNode) priorTrail.parentNode.removeChild(priorTrail);\n            };\n\n            let trailPath = null;\n            let tracerNode = null;\n            let pathMutationObserver = null;\n            let alive = true;\n\n            // Build trail (draw effect) if configured\n            const buildTrail = () => {\n                const trailOpt = options.trail;\n                if (!trailOpt) return;\n                try {\n                    trailPath = pathEl.cloneNode(true);\n                    trailPath.id = `${baseId}_trail`;\n                    trailPath.setAttribute('data-cblcars-owned', 'motionpath');\n                    const stroke = trailOpt.stroke || pathEl.getAttribute('stroke') || 'var(--lcars-yellow)';\n                    const sw = trailOpt['stroke-width']\n                        ?? options['stroke-width']\n                        ?? pathEl.getAttribute('stroke-width')\n                        ?? 4;\n                    trailPath.setAttribute('stroke', stroke);\n                    trailPath.setAttribute('stroke-width', sw);\n                    if (trailOpt.opacity !== undefined) trailPath.setAttribute('opacity', trailOpt.opacity);\n\n                    const mode = trailOpt.mode || 'overlay';\n                    if (mode === 'single') {\n                        pathEl.setAttribute('opacity', '0');\n                        pathEl.setAttribute('stroke', 'none');\n                    }\n                    if (isPending(pathEl)) {\n                        trailPath.setAttribute('visibility', 'hidden');\n                    }\n\n                    pathEl.parentNode.insertBefore(trailPath, pathEl.nextSibling);\n\n                    const [drawable] = window.cblcars.animejs.svg.createDrawable(trailPath);\n                    const trailVars = {\n                        draw: '0 1',\n                        duration: trailOpt.duration ?? params.duration ?? 1000,\n                        easing: trailOpt.easing ?? params.easing ?? 'linear',\n                        loop: trailOpt.loop ?? params.loop ?? true\n                    };\n                    window.cblcars.anim.anime(drawable, trailVars);\n                } catch (e) {\n                    cblcarsLog.error('[motionpath] Trail setup failed:', e);\n                }\n            };\n\n            // Build tracer node (circle or rect)\n            const buildTracer = () => {\n                let tid = tracerCfg.id || `${baseId}_tracer`;\n                const svgRoot = pathEl.ownerSVGElement || pathEl.closest('svg') || pathEl.parentNode;\n                const existing = svgRoot ? svgRoot.getElementById?.(tid) : null;\n                if (existing && existing.getAttribute('data-cblcars-owned') !== 'motionpath') {\n                    tid = `${tid}_mptrc`;\n                }\n\n                let tracerMarkup;\n                if (tracerCfg.shape === 'rect') {\n                    tracerMarkup = svgHelpers.drawRect({\n                        x: -((tracerCfg.width || 8) / 2),\n                        y: -((tracerCfg.height || 8) / 2),\n                        width: tracerCfg.width || 8,\n                        height: tracerCfg.height || 8,\n                        id: tid,\n                        attrs: { fill: tracerCfg.fill || 'var(--lcars-orange)' },\n                        style: tracerCfg.style || {}\n                    });\n                } else {\n                    tracerMarkup = svgHelpers.drawCircle({\n                        cx: 0,\n                        cy: 0,\n                        r: tracerCfg.r || 4,\n                        id: tid,\n                        attrs: { fill: tracerCfg.fill || 'var(--lcars-orange)' },\n                        style: tracerCfg.style || {}\n                    });\n                }\n                const temp = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n                temp.innerHTML = tracerMarkup;\n                tracerNode = temp.firstElementChild;\n                tracerNode.setAttribute('data-cblcars-owned', 'motionpath');\n                (svgRoot || pathEl.parentNode).appendChild(tracerNode);\n            };\n\n            const bindTracerAnimation = () => {\n                if (!tracerNode || !pathEl) return;\n                const { translateX, translateY, rotate } = window.cblcars.animejs.svg.createMotionPath(pathEl);\n\n                const exclude = new Set([\n                    'tracer', 'trail', 'path_selector', 'root', 'targets', 'type', 'animation',\n                    'stroke', 'stroke-width', 'corner_style', 'corner_radius', 'waypoints',\n                    'steps', 'rounded', 'smooth', 'smooth_tension', 'id'\n                ]);\n                const merged = {};\n                Object.entries({ ...params, ...options }).forEach(([k, v]) => {\n                    if (!exclude.has(k)) merged[k] = v;\n                });\n\n                try {\n                    if (tracerNode.__cblcars_motion && typeof tracerNode.__cblcars_motion.pause === 'function') {\n                        tracerNode.__cblcars_motion.pause();\n                    }\n                } catch (_) {}\n\n                tracerNode.__cblcars_motion = window.cblcars.anim.anime(tracerNode, {\n                    ...merged,\n                    translateX,\n                    translateY,\n                    rotate\n                });\n            };\n\n            const rebindAll = (reason = '') => {\n                try {\n                    if (!hasUsablePathD(pathEl.getAttribute('d')) || !pathLengthOk(pathEl)) {\n                        return;\n                    }\n                    if (trailPath) {\n                        trailPath.setAttribute('d', pathEl.getAttribute('d') || '');\n                        if (isPending(pathEl)) {\n                            trailPath.setAttribute('visibility', 'hidden');\n                        } else {\n                            trailPath.removeAttribute('visibility');\n                        }\n                    }\n                    bindTracerAnimation();\n                } catch (e) {\n                    cblcarsLog.warn('[motionpath] rebind failed', { reason, e });\n                }\n            };\n\n            const initArtifacts = () => {\n                buildTrail();\n                buildTracer();\n                rebindAll('initial');\n            };\n\n            // Robust wait logic\n            const waitMaxMs = Number.isFinite(options.wait_max_ms) ? options.wait_max_ms : 12000;\n            const pollInterval = 120;\n            const startTime = performance.now();\n\n            const waitForReady = () => new Promise((resolve) => {\n                const tick = () => {\n                    // If path replaced externally, bail (outer loop handles reattach)\n                    if (!alive) return resolve(false);\n\n                    const d = pathEl.getAttribute('d') || '';\n                    const pending = isPending(pathEl);\n                    const usable = hasUsablePathD(d) && pathLengthOk(pathEl);\n\n                    if (!pending && usable) return resolve(true);\n\n                    // Only count timeout time AFTER pending cleared\n                    if (!pending && (performance.now() - startTime) >= waitMaxMs) {\n                        return resolve(false);\n                    }\n                    setTimeout(tick, pollInterval);\n                };\n                tick();\n            });\n\n            // Initial cleanup & wait\n            cleanupArtifacts();\n            const ready = await waitForReady();\n\n            if (!ready) {\n                const msg = `[motionpath] Timed out waiting for usable path geometry (id=${pathEl.id})`;\n                cblcarsLog.warn(msg);\n                //svgOverlayManager.push(msg);\n                params.targets = null;\n                return;\n            }\n\n            initArtifacts();\n\n            // Observe path for d / pending changes\n            try {\n                pathMutationObserver = new MutationObserver((muts) => {\n                    let needs = false;\n                    for (const m of muts) {\n                        if (m.type === 'attributes' &&\n                            (m.attributeName === 'd' || m.attributeName === 'data-cblcars-pending')) {\n                            needs = true;\n                            break;\n                        }\n                    }\n                    if (needs) {\n                        // If pending turned back on, hide trail again\n                        if (trailPath && isPending(pathEl)) {\n                            trailPath.setAttribute('visibility', 'hidden');\n                        }\n                        rebindAll('mutation');\n                    }\n                });\n                pathMutationObserver.observe(pathEl, { attributes: true, attributeFilter: ['d', 'data-cblcars-pending'] });\n            } catch (_) {}\n\n            // Lightweight poll for element replacement\n            const pathId = pathEl.id;\n            const reattachPoll = () => {\n                if (!alive) return;\n                const current = (root.getElementById && root.getElementById(pathId)) || pathEl;\n                if (current !== pathEl && current instanceof SVGPathElement) {\n                    cblcarsLog.debug('[motionpath] Path element replaced; reinitializing', { id: pathId });\n                    try { pathMutationObserver?.disconnect(); } catch (_) {}\n                    pathEl = current;\n                    cleanupArtifacts();\n                    trailPath = null;\n                    tracerNode = null;\n                    // Wait again for readiness of the new path\n                    waitForReady().then((ok) => {\n                        if (ok) {\n                            initArtifacts();\n                            try {\n                                pathMutationObserver = new MutationObserver((muts) => {\n                                    let needs = false;\n                                    for (const m of muts) {\n                                        if (m.type === 'attributes' &&\n                                            (m.attributeName === 'd' || m.attributeName === 'data-cblcars-pending')) {\n                                            needs = true;\n                                            break;\n                                        }\n                                    }\n                                    if (needs) rebindAll('mutation(replaced)');\n                                });\n                                pathMutationObserver.observe(pathEl, { attributes: true, attributeFilter: ['d', 'data-cblcars-pending'] });\n                            } catch (_) {}\n                        }\n                    });\n                }\n                setTimeout(reattachPoll, 2000);\n            };\n            setTimeout(reattachPoll, 2000);\n\n            // Prevent base animateElement from adding another animation\n            params.targets = null;\n\n            // Cleanup hook if needed later\n            element.__cblcars_motionpath_cleanup = () => {\n                alive = false;\n                try { pathMutationObserver?.disconnect(); } catch (_) {}\n                try {\n                    if (tracerNode?.__cblcars_motion?.pause) tracerNode.__cblcars_motion.pause();\n                } catch (_) {}\n                try { cleanupArtifacts(); } catch (_) {}\n            };\n\n        } catch (e) {\n            cblcarsLog.error('[motionpath] Unhandled error', e);\n            //svgOverlayManager.push(`[motionpath] ${e?.message || e}`);\n            params.targets = null;\n        }\n    },\n\n    /**\n     * @preset march\n     * CSS-based marching dashed line animation.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    march: (params, element, options = {}) => {\n        // Get dash pattern from stroke_dasharray\n        let dashArray = params.stroke_dasharray ?? options.stroke_dasharray ?? [25, 15];\n        if (!Array.isArray(dashArray) || dashArray.length < 2) {\n            dashArray = [25, 15];\n        }\n        const [dashLength, gapLength] = dashArray;\n\n        // Set the stroke-dasharray for the dashed pattern\n        element.style.strokeDasharray = `${dashLength} ${gapLength}`;\n        element.style.strokeDashoffset = 0;\n\n        // Apply ststroberoke linecap if specified\n        const linecap = params.stroke_linecap ?? options.stroke_linecap;\n        if (linecap) {\n            element.style.strokeLinecap = linecap;\n        }\n\n        // Calculate cycle length (sum of dash and gap)\n        const cycleLength = dashLength + gapLength;\n\n        // Get animation duration, default to 2s if not specified\n        let duration = params.duration ?? options.duration ?? 2000;\n\n        // Convert to seconds for CSS\n        const durationSec = duration / 1000;\n\n        // Get direction\n        let reversed = params.reversed ?? options.reversed ?? false;\n\n        // Create unique animation name using element id or a random string\n        const animId = element.id || `march_${Math.random().toString(36).substring(2, 9)}`;\n        element.dataset.marchAnimId = animId;\n\n        // Direction: offset moves negative for forward, positive for reverse\n        const offsetTarget = reversed ? cycleLength : -cycleLength;\n\n        // Handle loop parameter (like anime.js)\n        // - true or undefined: infinite loop (CSS: infinite)\n        // - false or 0: no loop (CSS: 1)\n        // - number > 0: specific iteration count\n        let loopValue = params.loop ?? options.loop ?? true;\n        const iterationCount = loopValue === true ? 'infinite' :\n                              (loopValue === false || loopValue === 0) ? '1' :\n                              typeof loopValue === 'number' ? Math.max(1, loopValue) : 'infinite';\n\n        // Find the appropriate document to inject styles into\n        const targetDoc = element.getRootNode();\n        const isInShadowDOM = targetDoc !== document;\n\n        // Apply animation directly to the element via inline style\n        // This avoids Shadow DOM style isolation issues\n        const animationName = `march_${animId}`;\n        const keyframesStr = `@keyframes ${animationName} { to { stroke-dashoffset: ${offsetTarget}px; } }`;\n\n        // Apply animation directly to the element\n        const playbackRate = params.playbackRate ?? options.playbackRate ?? 1;\n        const effectiveDuration = `${durationSec / playbackRate}s`;\n\n        // Set inline styles directly on the element - more reliable across shadow DOM boundaries\n        element.style.animation = `${animationName} ${effectiveDuration} linear ${iterationCount}`;\n\n        // Create keyframes for the animation and inject them\n        if (isInShadowDOM && targetDoc.adoptedStyleSheets) {\n            // Modern Shadow DOM with Constructable Stylesheets\n            try {\n                let styleSheet = Array.from(targetDoc.adoptedStyleSheets)\n                    .find(sheet => sheet.marchAnimations);\n\n                if (!styleSheet) {\n                    styleSheet = new CSSStyleSheet();\n                    styleSheet.marchAnimations = true;\n                    targetDoc.adoptedStyleSheets = [...targetDoc.adoptedStyleSheets, styleSheet];\n                }\n\n                styleSheet.insertRule(keyframesStr, styleSheet.cssRules.length);\n            } catch (e) {\n                cblcarsLog.error('Failed to add CSS animation to Shadow DOM:', e);\n                fallbackStyleInjection();\n            }\n        } else {\n            // Fallback: add <style> element to document/shadowRoot\n            fallbackStyleInjection();\n        }\n\n        function fallbackStyleInjection() {\n            const styleId = 'march-smooth-css-animations';\n            let styleEl = targetDoc.getElementById ? targetDoc.getElementById(styleId) : null;\n\n            if (!styleEl) {\n                styleEl = document.createElement('style');\n                styleEl.id = styleId;\n                const target = isInShadowDOM ? targetDoc : document.head;\n                target.appendChild(styleEl);\n            }\n\n            if (!styleEl.textContent.includes(animationName)) {\n                styleEl.textContent += keyframesStr;\n            }\n        }\n\n        // Fill params with dummy values so anime.js doesn't override our CSS animation\n        Object.assign(params, {\n            _cssAnimation: true, // flag to indicate we're using CSS animation\n            duration: 1,\n            loop: false,\n            autoplay: false\n        });\n    },\n\n    /**\n     * @preset glow\n     * Animates stroke color and drop-shadow for a glowing effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    glow: (params, element, options = {}) => {\n        cblcarsLog.debug('[glow preset] Before mutation:', { params, element, options });\n\n        // Configurable values with defaults\n        const glowCfg = options.glow || {};\n        const color = glowCfg.color || options.color || 'var(--picard-light-blue)';\n        const intensity = glowCfg.intensity ?? options.intensity ?? 0.8;\n        const blurMin = glowCfg.blur_min ?? 0;\n        const blurMax = glowCfg.blur_max ?? 12;\n        const opacityMin = glowCfg.opacity_min ?? 0.4;\n        const opacityMax = glowCfg.opacity_max ?? intensity;\n        const duration = options.duration ?? glowCfg.duration ?? 900;\n        const easing = options.easing ?? glowCfg.easing ?? 'easeInOutSine';\n        const loop = options.loop ?? glowCfg.loop ?? true;\n        const alternate = options.alternate ?? glowCfg.alternate ?? true;\n\n        const glowState = { blur: blurMin, opacity: opacityMin };\n\n        Object.assign(params, {\n            targets: glowState,\n            blur: [blurMin, blurMax, blurMin],\n            opacity: [opacityMin, opacityMax, opacityMin],\n            duration,\n            easing,\n            loop,\n            alternate,\n            onUpdate() {\n                if (element.tagName === 'text' || element.tagName === 'TEXT') {\n                    // For text, animate both blur and opacity\n                    element.style.filter = `drop-shadow(0 0 ${glowState.blur}px ${color}) opacity(${glowState.opacity})`;\n                } else {\n                    // For lines, only animate blur, do not affect element opacity\n                    element.style.filter = `drop-shadow(0 0 ${glowState.blur}px ${color})`;\n                }\n            }\n        });\n        // Remove fill/stroke animation\n        delete params.fill;\n        delete params.stroke;\n        element.style.transformOrigin = 'center';\n        element.style.transformBox = 'fill-box';\n        cblcarsLog.debug('[glow preset] Animating drop-shadow:', { color, intensity, blurMin, blurMax, opacityMin, opacityMax, duration, easing, loop, alternate });\n\n        cblcarsLog.debug('[glow preset] After mutation:', { params, element });\n    },\n\n    /**\n     * @preset shimmer\n     * Animates fill and opacity for a shimmering effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    shimmer: (params, element, options = {}) => {\n        const color = options.color || 'var(--lcars-yellow)';\n        Object.assign(params, {\n            opacity: [1, 0.5, 1],\n            fill: [element.getAttribute('fill') || color, color],\n            alternate: true,\n            loop: true,\n            easing: 'easeInOutSine',\n            duration: options.duration ?? 1200\n        });\n    },\n\n    /**\n     * @preset strobe\n     * Rapidly toggles opacity for a strobe effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    strobe: (params, element, options = {}) => {\n        Object.assign(params, {\n            opacity: [1, 0.1],\n            alternate: true,\n            loop: true,\n            easing: 'steps(2, end)',\n            duration: options.duration ?? 400\n        });\n    },\n\n    /**\n     * @preset cascade\n     * Staggers opacity animation for multiple elements.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    cascade: (params, element, options = {}) => {\n        Object.assign(params, {\n            opacity: [0, 1],\n            delay: window.cblcars.animejs.stagger(options.stagger ?? 100),\n            easing: 'easeOutQuad',\n            duration: options.duration ?? 800\n        });\n    },\n\n    /**\n     * @preset ripple\n     * Animates scale and opacity for a ripple effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    ripple: (params, element, options = {}) => {\n        Object.assign(params, {\n            scale: [1, options.max_scale ?? 2, 1],\n            opacity: [1, 0.3, 1],\n            alternate: true,\n            loop: true,\n            easing: 'easeInOutSine',\n            duration: options.duration ?? 1200\n        });\n    },\n\n    /**\n     * @preset flicker\n     * Randomizes opacity for a flicker effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    flicker: (params, element, options = {}) => {\n        Object.assign(params, {\n            opacity: [\n                1,\n                0.7 + Math.random() * 0.3,\n                0.4 + Math.random() * 0.3,\n                1\n            ],\n            //alternate: true,\n            alternate: false,\n            loop: true,\n            easing: 'steps(4, end)',\n            duration: options.duration ?? 600\n        });\n    },\n\n    /**\n     * @preset set\n     * Sets properties/attributes/styles.\n     * Behavior:\n     * - In timeline steps: leave params as-is so anime.js applies them at the step time (no immediate mutation).\n     * - Outside timelines (free/overlay animations): mutate immediately via utils.set() and skip scheduling.\n     */\n    set: (params, element, options = {}) => {\n        // Timeline context: do not immediately set; let the step apply at its offset.\n        if (options && options.__timeline) {\n        return; // no-op; keep params as-is for anime step\n        }\n\n        const ignoreKeys = ['type', 'targets', 'root', 'animation', 'id', 'offset', '__timeline'];\n        const allParams = { ...params, ...options };\n        const propsToSet = {};\n        Object.entries(allParams).forEach(([key, value]) => {\n        if (ignoreKeys.includes(key) || value === undefined) return;\n        propsToSet[key] = value;\n        });\n\n        let animeSetWorked = false;\n        try {\n        if (window.cblcars?.anim?.utils?.set) {\n            window.cblcars.anim.utils.set(element, propsToSet);\n            animeSetWorked = true;\n        }\n        } catch (e) {\n        cblcarsLog.warn('[set preset] animejs.utils.set() failed, will fallback to manual mutation.', { e });\n        }\n\n        if (!animeSetWorked) {\n        for (const [key, value] of Object.entries(propsToSet)) {\n            try {\n            if (key in element.style) {\n                element.style[key] = value;\n            } else {\n                element.setAttribute(key, value);\n            }\n            } catch (e) {\n            cblcarsLog.warn(`[set preset] Could not set \"${key}\"=\"${value}\" manually`, { e });\n            }\n        }\n        }\n\n        // Prevent anime scheduling for non-timeline set\n        params._cssAnimation = true;\n        params.targets = null;\n    },\n\n    // Add more presets as needed...\n};","import * as CBLCARS from '../cb-lcars-vars.js';\n\nlet cblcarsGlobalLogLevel = 'info';\n\nexport function cblcarsSetGlobalLogLevel(level) {\n  cblcarsGlobalLogLevel = level;\n  cblcarsLog.info(`Setting CBLCARS global log level set to: ${level}`, {}, 'info');\n}\nexport function cblcarsGetGlobalLogLevel() {\n  return cblcarsGlobalLogLevel;\n}\n\n// Ensure the cblcars object exists on the window object\nwindow.cblcars = window.cblcars || {};\n// Attach the functions to the cblcars object\nwindow.cblcars.setGlobalLogLevel = cblcarsSetGlobalLogLevel;\nwindow.cblcars.getGlobalLogLevel = cblcarsGetGlobalLogLevel;\n// Add shortcut properties for each log level\n['error', 'warn', 'info', 'debug'].forEach(level => {\n  window.cblcars.setGlobalLogLevel[level] = () => cblcarsSetGlobalLogLevel(level);\n});\n\nexport function baseLogger(level, ...args) {\n  const levels = ['error', 'warn', 'info', 'debug'];\n  const currentLevelIndex = levels.indexOf(cblcarsGlobalLogLevel);\n  const messageLevelIndex = levels.indexOf(level);\n\n  if (messageLevelIndex > currentLevelIndex) return;\n\n  const commonStyles = 'color: white; padding: 1px 4px; border-radius: 15px;';\n  const levelStyles = {\n    info: 'background-color: #37a6d1',\n    warn: 'background-color: #ff6753',\n    error: 'background-color: #ef1d10',\n    debug: 'background-color: #8e44ad',\n    default: 'background-color: #6d748c',\n  };\n\n  const logMessage = `%c    CB-LCARS | ${level} `;\n  const style = `${levelStyles[level] || levelStyles.default}; ${commonStyles}`;\n\n  // Use spread to pass all args after the styled prefix\n  switch (level) {\n    case 'info':\n      console.log(logMessage, style, ...args);\n      break;\n    case 'warn':\n      console.warn(logMessage, style, ...args);\n      break;\n    case 'error':\n      console.error(logMessage, style, ...args);\n      break;\n    case 'debug':\n      console.debug(logMessage, style, ...args);\n      break;\n    default:\n      console.log(logMessage, style, ...args);\n      break;\n  }\n}\n\n/**\n * Centralized CB-LCARS logging utility.\n *\n * Supports log level filtering and styled output.\n * Functions as a drop-in replacement for `console.log`, `console.warn`, etc.\n *\n * **Preferred usage:**\n *   `cblcarsLog.info('message');`\n *   `cblcarsLog.warn('message');`\n *   `cblcarsLog.error('message');`\n *   `cblcarsLog.debug('message');`\n *   `cblcarsLog.log('message');`\n *\n * *Legacy usage (not recommended):*\n *   `cblcarsLog('warn', 'message');`\n *\n * **Log level filtering:**\n *\n *   Only messages at or above the global log level are printed.\n *   For example, if the global log level is 'warn', only 'warn' and 'error' messages are shown.\n *\n * **Setting the global log level:**\n *\n *   Use the function `cblcarsSetGlobalLogLevel(level)`, or\n *   `window.cblcars.setGlobalLogLevel(level)`\n *   Valid levels: `'error'`, `'warn'`, `'info'`, `'debug'`\n *\n * @param {'error'|'warn'|'info'|'debug'} level - The log level.\n * @param {...any} args - Arguments to log.\n * @returns {void}\n *\n * @property {function(...any):void} log   - Log an info-level message.\n * @property {function(...any):void} info  - Log an info-level message.\n * @property {function(...any):void} warn  - Log a warning message.\n * @property {function(...any):void} error - Log an error message.\n * @property {function(...any):void} debug - Log a debug message.\n */\nfunction cblcarsLog(level, ...args) {\n  return baseLogger(level, ...args);\n}\ncblcarsLog.log   = (...args) => baseLogger('info', ...args);\ncblcarsLog.info  = (...args) => baseLogger('info', ...args);\ncblcarsLog.warn  = (...args) => baseLogger('warn', ...args);\ncblcarsLog.error = (...args) => baseLogger('error', ...args);\ncblcarsLog.debug = (...args) => baseLogger('debug', ...args);\nexport { cblcarsLog };\n\n\nexport function cblcarsLogGroup(level, title) {\n    console.groupCollapsed(); // Create a collapsed group\n    cblcarsLog(level, `Group: ${title}`);\n    }\n\nexport function logImportStatus(importName, importedValue) {\n    if (importedValue === undefined) {\n        cblcarsLog.error(`Import error: ${importName} is not imported correctly.`);\n    } else {\n        cblcarsLog.debug(`${importName} imported successfully.`);\n    }\n}\n\nexport function cblcarsLogBanner() {\n  let styles1 = [\n      'color: white',\n      'font-weight: bold',\n      'padding: 2px 4px',\n      'border-radius: 5em 5em 0 0', // Top left and right rounded, bottom left and right square\n      'background-color: #37a6d1' // Blue\n  ];\n\n  let styles2 = [\n      'color: white',\n      'padding: 2px 4px',\n      'border-radius: 0 0 5em 5em', // Top left and right square, bottom left and right rounded\n      'background-color: #37a6d1' // Blue\n  ];\n\n  let invisibleStyle = [\n      'color: transparent',\n      'padding: 0',\n      'border: none'\n  ];\n\n  const version = CBLCARS.CBLCARS_VERSION;\n  const url = CBLCARS.project_url;\n  const baseString = \"CB-LCARS v\" + version;\n  const padding = 4;\n\n  // Calculate the total length including padding\n  const totalLength = url.length + padding;\n  const spacesNeeded = totalLength - baseString.length;\n\n  // FIXED: Protect against negative repeat count\n  const spaces = spacesNeeded > 0 ? ' '.repeat(spacesNeeded) : '';\n  const paddedUrl = ' '.repeat(padding) + url;\n\n  console.info(`%c${spaces}${baseString}  %c\\n%c${paddedUrl}  `, styles1.join(';'), invisibleStyle.join(';'), styles2.join(';'));\n}\n","// --- SVG Helpers ---\n\nexport function drawLine({ x1, y1, x2, y2, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<line id=\"${id || ''}\" x1=\"${x1}\" y1=\"${y1}\" x2=\"${x2}\" y2=\"${y2}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawPolyline({ points, id, attrs = {}, style = {} }) {\n  const pts = points.map(pt => pt.join(',')).join(' ');\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<polyline id=\"${id || ''}\" points=\"${pts}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawPath({ d, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<path id=\"${id || ''}\" d=\"${d}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawText({ x, y, text, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<text id=\"${id || ''}\" x=\"${x}\" y=\"${y}\"${attrsStr}${styleStr}>${text}</text>`;\n}\n\nexport function drawCircle({ cx, cy, r, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<circle id=\"${id || ''}\" cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawRect({ x, y, width, height, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<rect id=\"${id || ''}\" x=\"${x}\" y=\"${y}\" width=\"${width}\" height=\"${height}\"${attrsStr}${styleStr} />`;\n}\n\n// --- Utility helpers ---\n\nexport function attrsToString(attrs) {\n  if (!attrs || typeof attrs !== \"object\") return '';\n  return Object.entries(attrs)\n    .map(([k, v]) => ` ${k.replace(/[A-Z]/g, m => '-' + m.toLowerCase())}=\"${v}\"`)\n    .join('');\n}\n\nexport function styleToString(style) {\n  if (!style || typeof style !== \"object\") return \"\";\n  const s = Object.entries(style)\n    .map(([k, v]) => `${k.replace(/[A-Z]/g, m => '-' + m.toLowerCase())}:${v}`)\n    .join(';');\n  return s ? ` style=\"${s}\"` : '';\n}","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,i=t.trustedTypes,s=i?i.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,e=\"$lit$\",h=`lit$${Math.random().toFixed(9).slice(2)}$`,o=\"?\"+h,n=`<${o}>`,r=document,l=()=>r.createComment(\"\"),c=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,a=Array.isArray,u=t=>a(t)||\"function\"==typeof t?.[Symbol.iterator],d=\"[ \\t\\n\\f\\r]\",f=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\\\s\"'>=/]+)(${d}*=${d}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),p=/'/g,g=/\"/g,$=/^(?:script|style|textarea|title)$/i,y=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),x=y(1),b=y(2),w=y(3),T=Symbol.for(\"lit-noChange\"),E=Symbol.for(\"lit-nothing\"),A=new WeakMap,C=r.createTreeWalker(r,129);function P(t,i){if(!a(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==s?s.createHTML(i):i}const V=(t,i)=>{const s=t.length-1,o=[];let r,l=2===i?\"<svg>\":3===i?\"<math>\":\"\",c=f;for(let i=0;i<s;i++){const s=t[i];let a,u,d=-1,y=0;for(;y<s.length&&(c.lastIndex=y,u=c.exec(s),null!==u);)y=c.lastIndex,c===f?\"!--\"===u[1]?c=v:void 0!==u[1]?c=_:void 0!==u[2]?($.test(u[2])&&(r=RegExp(\"</\"+u[2],\"g\")),c=m):void 0!==u[3]&&(c=m):c===m?\">\"===u[0]?(c=r??f,d=-1):void 0===u[1]?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=void 0===u[3]?m:'\"'===u[3]?g:p):c===g||c===p?c=m:c===v||c===_?c=f:(c=m,r=void 0);const x=c===m&&t[i+1].startsWith(\"/>\")?\" \":\"\";l+=c===f?s+n:d>=0?(o.push(a),s.slice(0,d)+e+s.slice(d)+h+x):s+h+(-2===d?i:x)}return[P(t,l+(t[s]||\"<?>\")+(2===i?\"</svg>\":3===i?\"</math>\":\"\")),o]};class N{constructor({strings:t,_$litType$:s},n){let r;this.parts=[];let c=0,a=0;const u=t.length-1,d=this.parts,[f,v]=V(t,s);if(this.el=N.createElement(f,n),C.currentNode=this.el.content,2===s||3===s){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(r=C.nextNode())&&d.length<u;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(e)){const i=v[a++],s=r.getAttribute(t).split(h),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:c,name:e[2],strings:s,ctor:\".\"===e[1]?H:\"?\"===e[1]?I:\"@\"===e[1]?L:k}),r.removeAttribute(t)}else t.startsWith(h)&&(d.push({type:6,index:c}),r.removeAttribute(t));if($.test(r.tagName)){const t=r.textContent.split(h),s=t.length-1;if(s>0){r.textContent=i?i.emptyScript:\"\";for(let i=0;i<s;i++)r.append(t[i],l()),C.nextNode(),d.push({type:2,index:++c});r.append(t[s],l())}}}else if(8===r.nodeType)if(r.data===o)d.push({type:2,index:c});else{let t=-1;for(;-1!==(t=r.data.indexOf(h,t+1));)d.push({type:7,index:c}),t+=h.length-1}c++}}static createElement(t,i){const s=r.createElement(\"template\");return s.innerHTML=t,s}}function S(t,i,s=t,e){if(i===T)return i;let h=void 0!==e?s._$Co?.[e]:s._$Cl;const o=c(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(!1),void 0===o?h=void 0:(h=new o(t),h._$AT(t,s,e)),void 0!==e?(s._$Co??=[])[e]=h:s._$Cl=h),void 0!==h&&(i=S(t,h._$AS(t,i.values),h,e)),i}class M{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??r).importNode(i,!0);C.currentNode=e;let h=C.nextNode(),o=0,n=0,l=s[0];for(;void 0!==l;){if(o===l.index){let i;2===l.type?i=new R(h,h.nextSibling,this,t):1===l.type?i=new l.ctor(h,l.name,l.strings,this,t):6===l.type&&(i=new z(h,this,t)),this._$AV.push(i),l=s[++n]}o!==l?.index&&(h=C.nextNode(),o++)}return C.currentNode=r,e}p(t){let i=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=S(this,t,i),c(t)?t===E||null==t||\"\"===t?(this._$AH!==E&&this._$AR(),this._$AH=E):t!==this._$AH&&t!==T&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):u(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==E&&c(this._$AH)?this._$AA.nextSibling.data=t:this.T(r.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:s}=t,e=\"number\"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=N.createElement(P(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else{const t=new M(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t}}_$AC(t){let i=A.get(t.strings);return void 0===i&&A.set(t.strings,i=new N(t)),i}k(t){a(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const h of t)e===i.length?i.push(s=new R(this.O(l()),this.O(l()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=E,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||\"\"!==s[0]||\"\"!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=E}_$AI(t,i=this,s,e){const h=this.strings;let o=!1;if(void 0===h)t=S(this,t,i,0),o=!c(t)||t!==this._$AH&&t!==T,o&&(this._$AH=t);else{const e=t;let n,r;for(t=h[0],n=0;n<h.length-1;n++)r=S(this,e[s+n],i,n),r===T&&(r=this._$AH[n]),o||=!c(r)||r!==this._$AH[n],r===E?t=E:t!==E&&(t+=(r??\"\")+h[n+1]),this._$AH[n]=r}o&&!e&&this.j(t)}j(t){t===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??\"\")}}class H extends k{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===E?void 0:t}}class I extends k{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==E)}}class L extends k{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5}_$AI(t,i=this){if((t=S(this,t,i,0)??E)===T)return;const s=this._$AH,e=t===E&&s!==E||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==E&&(s===E||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){\"function\"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t)}}const Z={M:e,P:h,A:o,C:1,L:V,R:M,D:u,V:S,I:R,H:k,N:I,U:L,B:H,F:z},j=t.litHtmlPolyfillSupport;j?.(N,R),(t.litHtmlVersions??=[]).push(\"3.3.0\");const B=(t,i,s)=>{const e=s?.renderBefore??i;let h=e._$litPart$;if(void 0===h){const t=s?.renderBefore??null;e._$litPart$=h=new R(i.insertBefore(l(),t),t,void 0,s??{})}return h._$AI(t),h};export{Z as _$LH,x as html,w as mathml,T as noChange,E as nothing,B as render,b as svg};\n//# sourceMappingURL=lit-html.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},e=t=>(...e)=>({_$litDirective$:t,values:e});class i{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}export{i as Directive,t as PartType,e as directive};\n//# sourceMappingURL=directive.js.map\n","import{nothing as t,noChange as i}from\"../lit-html.js\";import{Directive as r,PartType as s,directive as n}from\"../directive.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class e extends r{constructor(i){if(super(i),this.it=t,i.type!==s.CHILD)throw Error(this.constructor.directiveName+\"() can only be used in child bindings\")}render(r){if(r===t||null==r)return this._t=void 0,this.it=r;if(r===i)return r;if(\"string\"!=typeof r)throw Error(this.constructor.directiveName+\"() called with a non-string value\");if(r===this.it)return this._t;this.it=r;const s=[r];return s.raw=s,this._t={_$litType$:this.constructor.resultType,strings:s,values:[]}}}e.directiveName=\"unsafeHTML\",e.resultType=1;const o=n(e);export{e as UnsafeHTMLDirective,o as unsafeHTML};\n//# sourceMappingURL=unsafe-html.js.map\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,e=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class n{constructor(t,e,o){if(this._$cssResult$=!0,o!==s)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const s=this.t;if(e&&void 0===t){const e=void 0!==s&&1===s.length;e&&(t=o.get(s)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&o.set(s,t))}return t}toString(){return this.cssText}}const r=t=>new n(\"string\"==typeof t?t:t+\"\",void 0,s),i=(t,...e)=>{const o=1===t.length?t[0]:e.reduce(((e,s,o)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(s)+t[o+1]),t[0]);return new n(o,t,s)},S=(s,o)=>{if(e)s.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const e of o){const o=document.createElement(\"style\"),n=t.litNonce;void 0!==n&&o.setAttribute(\"nonce\",n),o.textContent=e.cssText,s.appendChild(o)}},c=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const s of t.cssRules)e+=s.cssText;return r(e)})(t):t;export{n as CSSResult,S as adoptStyles,i as css,c as getCompatibleStyle,e as supportsAdoptingStyleSheets,r as unsafeCSS};\n//# sourceMappingURL=css-tag.js.map\n","import{getCompatibleStyle as t,adoptStyles as s}from\"./css-tag.js\";export{CSSResult,css,supportsAdoptingStyleSheets,unsafeCSS}from\"./css-tag.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{is:i,defineProperty:e,getOwnPropertyDescriptor:h,getOwnPropertyNames:r,getOwnPropertySymbols:o,getPrototypeOf:n}=Object,a=globalThis,c=a.trustedTypes,l=c?c.emptyScript:\"\",p=a.reactiveElementPolyfillSupport,d=(t,s)=>t,u={toAttribute(t,s){switch(s){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,s)=>!i(t,s),b={attribute:!0,type:String,converter:u,reflect:!1,useDefault:!1,hasChanged:f};Symbol.metadata??=Symbol(\"metadata\"),a.litPropertyMetadata??=new WeakMap;class y extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,s=b){if(s.state&&(s.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),h=this.getPropertyDescriptor(t,i,s);void 0!==h&&e(this.prototype,t,h)}}static getPropertyDescriptor(t,s,i){const{get:e,set:r}=h(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t}};return{get:e,set(s){const h=e?.call(this);r?.call(this,s),this.requestUpdate(t,h,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(d(\"elementProperties\")))return;const t=n(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(d(\"finalized\")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d(\"properties\"))){const t=this.properties,s=[...r(t),...o(t)];for(const i of s)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const i=this._$Eu(t,s);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(s){const i=[];if(Array.isArray(s)){const e=new Set(s.flat(1/0).reverse());for(const s of e)i.unshift(t(s))}else void 0!==s&&i.push(t(s));return i}static _$Eu(t,s){const i=s.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return s(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,s,i){this._$AK(t,i)}_$ET(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor._$Eu(t,i);if(void 0!==e&&!0===i.reflect){const h=(void 0!==i.converter?.toAttribute?i.converter:u).toAttribute(s,i.type);this._$Em=t,null==h?this.removeAttribute(e):this.setAttribute(e,h),this._$Em=null}}_$AK(t,s){const i=this.constructor,e=i._$Eh.get(t);if(void 0!==e&&this._$Em!==e){const t=i.getPropertyOptions(e),h=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:u;this._$Em=e,this[e]=h.fromAttribute(s,t.type)??this._$Ej?.get(e)??null,this._$Em=null}}requestUpdate(t,s,i){if(void 0!==t){const e=this.constructor,h=this[t];if(i??=e.getPropertyOptions(t),!((i.hasChanged??f)(h,s)||i.useDefault&&i.reflect&&h===this._$Ej?.get(t)&&!this.hasAttribute(e._$Eu(t,i))))return;this.C(t,s,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,s,{useDefault:i,reflect:e,wrapped:h},r){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??s??this[t]),!0!==h||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),!0===e&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,s]of this._$Ep)this[t]=s;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];!0!==t||this._$AL.has(s)||void 0===e||this.C(s,void 0,i,e)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(s)):this._$EM()}catch(s){throw t=!1,this._$EM(),s}t&&this._$AE(s)}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((t=>this._$ET(t,this[t]))),this._$EM()}updated(t){}firstUpdated(t){}}y.elementStyles=[],y.shadowRootOptions={mode:\"open\"},y[d(\"elementProperties\")]=new Map,y[d(\"finalized\")]=new Map,p?.({ReactiveElement:y}),(a.reactiveElementVersions??=[]).push(\"2.1.0\");export{y as ReactiveElement,s as adoptStyles,u as defaultConverter,t as getCompatibleStyle,f as notEqual};\n//# sourceMappingURL=reactive-element.js.map\n","import{ReactiveElement as t}from\"@lit/reactive-element\";export*from\"@lit/reactive-element\";import{render as e,noChange as r}from\"lit-html\";export*from\"lit-html\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=globalThis;class i extends t{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=e(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return r}}i._$litElement$=!0,i[\"finalized\"]=!0,s.litElementHydrateSupport?.({LitElement:i});const o=s.litElementPolyfillSupport;o?.({LitElement:i});const n={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(s.litElementVersions??=[]).push(\"4.2.0\");export{i as LitElement,n as _$LE};\n//# sourceMappingURL=lit-element.js.map\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst o=!1;export{o as isServer};\n//# sourceMappingURL=is-server.js.map\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","/**\n * anime.js - ESM\n * @version v4.0.2\n * @author Julian Garnier\n * @license MIT\n * @copyright (c) 2025 Julian Garnier\n * @see https://animejs.com\n */\n\n/**\n * @typedef {Object} DefaultsParams\n * @property {Number|String} [id]\n * @property {PercentageKeyframes|DurationKeyframes} [keyframes]\n * @property {EasingParam} [playbackEase]\n * @property {Number} [playbackRate]\n * @property {Number} [frameRate]\n * @property {Number|Boolean} [loop]\n * @property {Boolean} [reversed]\n * @property {Boolean} [alternate]\n * @property {Boolean|ScrollObserver} [autoplay]\n * @property {Number|FunctionValue} [duration]\n * @property {Number|FunctionValue} [delay]\n * @property {Number} [loopDelay]\n * @property {EasingParam} [ease]\n * @property {'none'|'replace'|'blend'|compositionTypes} [composition]\n * @property {(v: any) => any} [modifier]\n * @property {(tickable: Tickable) => void} [onBegin]\n * @property {(tickable: Tickable) => void} [onBeforeUpdate]\n * @property {(tickable: Tickable) => void} [onUpdate]\n * @property {(tickable: Tickable) => void} [onLoop]\n * @property {(tickable: Tickable) => void} [onPause]\n * @property {(tickable: Tickable) => void} [onComplete]\n * @property {(renderable: Renderable) => void} [onRender]\n */\n\n/** @typedef {JSAnimation|Timeline} Renderable */\n/** @typedef {Timer|Renderable} Tickable */\n/** @typedef {Timer&JSAnimation&Timeline} CallbackArgument */\n/** @typedef {Animatable|Tickable|Draggable|ScrollObserver|Scope} Revertible */\n\n/**\n * @typedef {Object} DraggableAxisParam\n * @property {String} [mapTo]\n * @property {TweenModifier} [modifier]\n * @property {TweenComposition} [composition]\n * @property {Number|Array<Number>|((draggable: Draggable) => Number|Array<Number>)} [snap]\n */\n\n/**\n * @typedef {Object} DraggableCursorParams\n * @property {String} [onHover]\n * @property {String} [onGrab]\n */\n\n/**\n * @typedef {Object} DraggableParams\n * @property {DOMTargetSelector} [trigger]\n * @property {DOMTargetSelector|Array<Number>|((draggable: Draggable) => DOMTargetSelector|Array<Number>)} [container]\n * @property {Boolean|DraggableAxisParam} [x]\n * @property {Boolean|DraggableAxisParam} [y]\n * @property {TweenModifier} [modifier]\n * @property {Number|Array<Number>|((draggable: Draggable) => Number|Array<Number>)} [snap]\n * @property {Number|Array<Number>|((draggable: Draggable) => Number|Array<Number>)} [containerPadding]\n * @property {Number|((draggable: Draggable) => Number)} [containerFriction]\n * @property {Number|((draggable: Draggable) => Number)} [releaseContainerFriction]\n * @property {Number|((draggable: Draggable) => Number)} [dragSpeed]\n * @property {Number|((draggable: Draggable) => Number)} [scrollSpeed]\n * @property {Number|((draggable: Draggable) => Number)} [scrollThreshold]\n * @property {Number|((draggable: Draggable) => Number)} [minVelocity]\n * @property {Number|((draggable: Draggable) => Number)} [maxVelocity]\n * @property {Number|((draggable: Draggable) => Number)} [velocityMultiplier]\n * @property {Number} [releaseMass]\n * @property {Number} [releaseStiffness]\n * @property {Number} [releaseDamping]\n * @property {Boolean} [releaseDamping]\n * @property {EasingParam} [releaseEase]\n * @property {Boolean|DraggableCursorParams|((draggable: Draggable) => Boolean|DraggableCursorParams)} [cursor]\n * @property {Callback<Draggable>} [onGrab]\n * @property {Callback<Draggable>} [onDrag]\n * @property {Callback<Draggable>} [onRelease]\n * @property {Callback<Draggable>} [onUpdate]\n * @property {Callback<Draggable>} [onSettle]\n * @property {Callback<Draggable>} [onSnap]\n * @property {Callback<Draggable>} [onResize]\n * @property {Callback<Draggable>} [onAfterResize]\n */\n\n/**\n * @typedef {SVGGeometryElement & {\n *   setAttribute(name: 'draw', value: `${number} ${number}`): void;\n *   draw: `${number} ${number}`;\n * }} DrawableSVGGeometry\n */\n\n/**\n * @callback EasingFunction\n * @param {Number} time\n * @return {Number}\n */\n\n/**\n * @typedef {('linear'|'linear(x1, x2 25%, x3)'|'in'|'out'|'inOut'|'inQuad'|'outQuad'|'inOutQuad'|'inCubic'|'outCubic'|'inOutCubic'|'inQuart'|'outQuart'|'inOutQuart'|'inQuint'|'outQuint'|'inOutQuint'|'inSine'|'outSine'|'inOutSine'|'inCirc'|'outCirc'|'inOutCirc'|'inExpo'|'outExpo'|'inOutExpo'|'inBounce'|'outBounce'|'inOutBounce'|'inBack'|'outBack'|'inOutBack'|'inElastic'|'outElastic'|'inOutElastic'|'irregular'|'cubicBezier'|'steps'|'in(p = 1.675)'|'out(p = 1.675)'|'inOut(p = 1.675)'|'inBack(overshoot = 1.70158)'|'outBack(overshoot = 1.70158)'|'inOutBack(overshoot = 1.70158)'|'inElastic(amplitude = 1, period = .3)'|'outElastic(amplitude = 1, period = .3)'|'inOutElastic(amplitude = 1, period = .3)'|'irregular(length = 10, randomness = 1)'|'cubicBezier(x1, y1, x2, y2)'|'steps(steps = 10)')} EaseStringParamNames\n */\n\n// A hack to get both ease names suggestions AND allow any strings\n// https://github.com/microsoft/TypeScript/issues/29729#issuecomment-460346421\n/** @typedef {(String & {})|EaseStringParamNames|EasingFunction|Spring} EasingParam */\n\n/** @typedef {HTMLElement|SVGElement} DOMTarget */\n/** @typedef {Record<String, any>} JSTarget */\n/** @typedef {DOMTarget|JSTarget} Target */\n/** @typedef {Target|NodeList|String} TargetSelector */\n/** @typedef {DOMTarget|NodeList|String} DOMTargetSelector */\n/** @typedef {Array.<DOMTargetSelector>|DOMTargetSelector} DOMTargetsParam */\n/** @typedef {Array.<DOMTarget>} DOMTargetsArray */\n/** @typedef {Array.<JSTarget>|JSTarget} JSTargetsParam */\n/** @typedef {Array.<JSTarget>} JSTargetsArray */\n/** @typedef {Array.<TargetSelector>|TargetSelector} TargetsParam */\n/** @typedef {Array.<Target>} TargetsArray */\n\n/**\n * @callback FunctionValue\n * @param {Target} target - The animated target\n * @param {Number} index - The target index\n * @param {Number} length - The total number of animated targets\n * @return {Number|String|TweenObjectValue|Array.<Number|String|TweenObjectValue>}\n */\n\n/**\n * @callback TweenModifier\n * @param {Number} value - The animated value\n * @return {Number|String}\n */\n\n/** @typedef {[Number, Number, Number, Number]} ColorArray */\n\n/**\n * @template T\n * @callback Callback\n * @param {T} self - Returns itself\n * @param {PointerEvent} [e]\n * @return {*}\n */\n\n/**\n * @template {object} T\n * @typedef {Object} TickableCallbacks\n * @property {Callback<T>} [onBegin]\n * @property {Callback<T>} [onBeforeUpdate]\n * @property {Callback<T>} [onUpdate]\n * @property {Callback<T>} [onLoop]\n * @property {Callback<T>} [onPause]\n * @property {Callback<T>} [onComplete]\n */\n\n/**\n * @template {object} T\n * @typedef {Object} RenderableCallbacks\n * @property {Callback<T>} [onRender]\n */\n\n/**\n * @typedef {Object} Tween\n * @property {Number} id\n * @property {JSAnimation} parent\n * @property {String} property\n * @property {Target} target\n * @property {String|Number} _value\n * @property {Function|null} _func\n * @property {EasingFunction} _ease\n * @property {Array.<Number>} _fromNumbers\n * @property {Array.<Number>} _toNumbers\n * @property {Array.<String>} _strings\n * @property {Number} _fromNumber\n * @property {Number} _toNumber\n * @property {Array.<Number>} _numbers\n * @property {Number} _number\n * @property {String} _unit\n * @property {TweenModifier} _modifier\n * @property {Number} _currentTime\n * @property {Number} _delay\n * @property {Number} _updateDuration\n * @property {Number} _startTime\n * @property {Number} _changeDuration\n * @property {Number} _absoluteStartTime\n * @property {tweenTypes} _tweenType\n * @property {valueTypes} _valueType\n * @property {Number} _composition\n * @property {Number} _isOverlapped\n * @property {Number} _isOverridden\n * @property {Number} _renderTransforms\n * @property {Tween} _prevRep\n * @property {Tween} _nextRep\n * @property {Tween} _prevAdd\n * @property {Tween} _nextAdd\n * @property {Tween} _prev\n * @property {Tween} _next\n */\n\n/**\n * @typedef TweenDecomposedValue\n * @property {Number} t - Type\n * @property {Number} n - Single number value\n * @property {String} u - Value unit\n * @property {String} o - Value operator\n * @property {Array.<Number>} d - Array of Numbers (in case of complex value type)\n * @property {Array.<String>} s - Strings (in case of complex value type)\n */\n\n/** @typedef {{_head: null|Tween, _tail: null|Tween}} TweenPropertySiblings */\n/** @typedef {Record<String, TweenPropertySiblings>} TweenLookups */\n/** @typedef {WeakMap.<Target, TweenLookups>} TweenReplaceLookups */\n/** @typedef {Map.<Target, TweenLookups>} TweenAdditiveLookups */\n\n/**\n * @typedef {Object} TimerOptions\n * @property {Number|String} [id]\n * @property {TweenParamValue} [duration]\n * @property {TweenParamValue} [delay]\n * @property {Number} [loopDelay]\n * @property {Boolean} [reversed]\n * @property {Boolean} [alternate]\n * @property {Boolean|Number} [loop]\n * @property {Boolean|ScrollObserver} [autoplay]\n * @property {Number} [frameRate]\n * @property {Number} [playbackRate]\n */\n\n/**\n\n/**\n * @typedef {TimerOptions & TickableCallbacks<Timer>} TimerParams\n */\n\n/**\n * @typedef {Number|String|FunctionValue} TweenParamValue\n */\n\n/**\n * @typedef {TweenParamValue|[TweenParamValue, TweenParamValue]} TweenPropValue\n */\n\n/**\n * @typedef {(String & {})|'none'|'replace'|'blend'|compositionTypes} TweenComposition\n */\n\n/**\n * @typedef {Object} TweenParamsOptions\n * @property {TweenParamValue} [duration]\n * @property {TweenParamValue} [delay]\n * @property {EasingParam} [ease]\n * @property {TweenModifier} [modifier]\n * @property {TweenComposition} [composition]\n */\n\n/**\n * @typedef {Object} TweenValues\n * @property {TweenParamValue} [from]\n * @property {TweenPropValue} [to]\n * @property {TweenPropValue} [fromTo]\n */\n\n/**\n * @typedef {TweenParamsOptions & TweenValues} TweenKeyValue\n */\n\n/**\n * @typedef {Array.<TweenKeyValue|TweenPropValue>} ArraySyntaxValue\n */\n\n/**\n * @typedef {TweenParamValue|ArraySyntaxValue|TweenKeyValue} TweenOptions\n */\n\n/**\n * @typedef {Partial<{to: TweenParamValue|Array.<TweenParamValue>; from: TweenParamValue|Array.<TweenParamValue>; fromTo: TweenParamValue|Array.<TweenParamValue>;}>} TweenObjectValue\n */\n\n/**\n * @typedef {Object} PercentageKeyframeOptions\n * @property {EasingParam} [ease]\n */\n\n/**\n * @typedef {Record<String, TweenParamValue>} PercentageKeyframeParams\n */\n\n/**\n * @typedef {Record<String, PercentageKeyframeParams & PercentageKeyframeOptions>} PercentageKeyframes\n */\n\n/**\n * @typedef {Array<Record<String, TweenOptions | TweenModifier | boolean> & TweenParamsOptions>} DurationKeyframes\n */\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {PercentageKeyframes|DurationKeyframes} [keyframes]\n * @property {EasingParam} [playbackEase]\n */\n\n// TODO: Currently setting TweenModifier to the intersected Record<> makes the FunctionValue type target param any if only one parameter is set\n/**\n * @typedef {Record<String, TweenOptions | Callback<JSAnimation> | TweenModifier | boolean | PercentageKeyframes | DurationKeyframes | ScrollObserver> & TimerOptions & AnimationOptions & TweenParamsOptions & TickableCallbacks<JSAnimation> & RenderableCallbacks<JSAnimation>} AnimationParams\n */\n\n/**\n * @typedef {Object} TimelineOptions\n * @property {DefaultsParams} [defaults]\n * @property {EasingParam} [playbackEase]\n */\n\n/**\n * @typedef {TimerOptions & TimelineOptions & TickableCallbacks<Timeline> & RenderableCallbacks<Timeline>} TimelineParams\n */\n\n/**\n * @callback AnimatablePropertySetter\n * @param  {Number|Array.<Number>} to\n * @param  {Number} [duration]\n * @param  {EasingParam} [ease]\n * @return {AnimatableObject}\n */\n\n/**\n * @callback AnimatablePropertyGetter\n * @return {Number|Array.<Number>}\n */\n\n/**\n * @typedef {AnimatablePropertySetter & AnimatablePropertyGetter} AnimatableProperty\n */\n\n/**\n * @typedef {Animatable & Record<String, AnimatableProperty>} AnimatableObject\n */\n\n/**\n * @typedef {Object} AnimatablePropertyParamsOptions\n * @property {String} [unit]\n * @property {TweenParamValue} [duration]\n * @property {EasingParam} [ease]\n * @property {TweenModifier} [modifier]\n * @property {TweenComposition} [composition]\n */\n\n/**\n * @typedef {Record<String, TweenParamValue | EasingParam | TweenModifier | TweenComposition | AnimatablePropertyParamsOptions> & AnimatablePropertyParamsOptions} AnimatableParams\n */\n\n\n// Environments\n\n// TODO: Do we need to check if we're running inside a worker ?\nconst isBrowser = typeof window !== 'undefined';\n\n/** @type {Object|Null} */\nconst win = isBrowser ? window : null;\n\n/** @type {Document} */\nconst doc = isBrowser ? document : null;\n\n// Enums\n\n/** @enum {Number} */\nconst tweenTypes = {\n  OBJECT: 0,\n  ATTRIBUTE: 1,\n  CSS: 2,\n  TRANSFORM: 3,\n  CSS_VAR: 4,\n};\n\n/** @enum {Number} */\nconst valueTypes = {\n  NUMBER: 0,\n  UNIT: 1,\n  COLOR: 2,\n  COMPLEX: 3,\n};\n\n/** @enum {Number} */\nconst tickModes = {\n  NONE: 0,\n  AUTO: 1,\n  FORCE: 2,\n};\n\n/** @enum {Number} */\nconst compositionTypes = {\n  replace: 0,\n  none: 1,\n  blend: 2,\n};\n\n// Cache symbols\n\nconst isRegisteredTargetSymbol = Symbol();\nconst isDomSymbol = Symbol();\nconst isSvgSymbol = Symbol();\nconst transformsSymbol = Symbol();\nconst morphPointsSymbol = Symbol();\nconst proxyTargetSymbol = Symbol();\n\n// Numbers\n\nconst minValue = 1e-11;\nconst maxValue = 1e12;\nconst K = 1e3;\nconst maxFps = 120;\n\n// Strings\n\nconst emptyString = '';\nconst shortTransforms = new Map();\n\nshortTransforms.set('x', 'translateX');\nshortTransforms.set('y', 'translateY');\nshortTransforms.set('z', 'translateZ');\n\nconst validTransforms = [\n  'translateX',\n  'translateY',\n  'translateZ',\n  'rotate',\n  'rotateX',\n  'rotateY',\n  'rotateZ',\n  'scale',\n  'scaleX',\n  'scaleY',\n  'scaleZ',\n  'skew',\n  'skewX',\n  'skewY',\n  'perspective',\n  'matrix',\n  'matrix3d',\n];\n\nconst transformsFragmentStrings = validTransforms.reduce((a, v) => ({...a, [v]: v + '('}), {});\n\n// Functions\n\n/** @return {void} */\nconst noop = () => {};\n\n// Regex\n\nconst hexTestRgx = /(^#([\\da-f]{3}){1,2}$)|(^#([\\da-f]{4}){1,2}$)/i;\nconst rgbExecRgx = /rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/i;\nconst rgbaExecRgx = /rgba\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(-?\\d+|-?\\d*.\\d+)\\s*\\)/i;\nconst hslExecRgx = /hsl\\(\\s*(-?\\d+|-?\\d*.\\d+)\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*\\)/i;\nconst hslaExecRgx = /hsla\\(\\s*(-?\\d+|-?\\d*.\\d+)\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*,\\s*(-?\\d+|-?\\d*.\\d+)\\s*\\)/i;\n// export const digitWithExponentRgx = /[-+]?\\d*\\.?\\d+(?:[eE][-+]?\\d+)?/g;\nconst digitWithExponentRgx = /[-+]?\\d*\\.?\\d+(?:e[-+]?\\d)?/gi;\n// export const unitsExecRgx = /^([-+]?\\d*\\.?\\d+(?:[eE][-+]?\\d+)?)+([a-z]+|%)$/i;\nconst unitsExecRgx = /^([-+]?\\d*\\.?\\d+(?:e[-+]?\\d+)?)([a-z]+|%)$/i;\nconst lowerCaseRgx = /([a-z])([A-Z])/g;\nconst transformsExecRgx = /(\\w+)(\\([^)]+\\)+)/g; // Match inline transforms with cacl() values, returns the value wrapped in ()\nconst relativeValuesExecRgx = /(\\*=|\\+=|-=)/;\n\n\n\n\n/** @type {DefaultsParams} */\nconst defaults = {\n  id: null,\n  keyframes: null,\n  playbackEase: null,\n  playbackRate: 1,\n  frameRate: maxFps,\n  loop: 0,\n  reversed: false,\n  alternate: false,\n  autoplay: true,\n  duration: K,\n  delay: 0,\n  loopDelay: 0,\n  ease: 'out(2)',\n  composition: compositionTypes.replace,\n  modifier: v => v,\n  onBegin: noop,\n  onBeforeUpdate: noop,\n  onUpdate: noop,\n  onLoop: noop,\n  onPause: noop,\n  onComplete: noop,\n  onRender: noop,\n};\n\nconst globals = {\n  /** @type {DefaultsParams} */\n  defaults,\n  /** @type {Document|DOMTarget} */\n  root: doc,\n  /** @type {Scope} */\n  scope: null,\n  /** @type {Number} */\n  precision: 4,\n  /** @type {Number} */\n  timeScale: 1,\n  /** @type {Number} */\n  tickThreshold: 200,\n};\n\nconst globalVersions = { version: '4.0.2', engine: null };\n\nif (isBrowser) {\n  if (!win.AnimeJS) win.AnimeJS = [];\n  win.AnimeJS.push(globalVersions);\n}\n\n// Strings\n\n/**\n * @param  {String} str\n * @return {String}\n */\nconst toLowerCase = str => str.replace(lowerCaseRgx, '$1-$2').toLowerCase();\n\n/**\n * Prioritize this method instead of regex when possible\n * @param  {String} str\n * @param  {String} sub\n * @return {Boolean}\n */\nconst stringStartsWith = (str, sub) => str.indexOf(sub) === 0;\n\n// Time\n// Note: Date.now is used instead of performance.now since it is precise enough for timings calculations, performs slightly faster and works in Node.js environement.\nconst now = Date.now;\n\n// Types checkers\n\nconst isArr = Array.isArray;\n/**@param {any} a @return {a is Record<String, any>} */\nconst isObj = a => a && a.constructor === Object;\n/**@param {any} a @return {a is Number} */\nconst isNum = a => typeof a === 'number' && !isNaN(a);\n/**@param {any} a @return {a is String} */\nconst isStr = a => typeof a === 'string';\n/**@param {any} a @return {a is Function} */\nconst isFnc = a => typeof a === 'function';\n/**@param {any} a @return {a is undefined} */\nconst isUnd = a => typeof a === 'undefined';\n/**@param {any} a @return {a is null | undefined} */\nconst isNil = a => isUnd(a) || a === null;\n/**@param {any} a @return {a is SVGElement} */\nconst isSvg = a => isBrowser && a instanceof SVGElement;\n/**@param {any} a @return {Boolean} */\nconst isHex = a => hexTestRgx.test(a);\n/**@param {any} a @return {Boolean} */\nconst isRgb = a => stringStartsWith(a, 'rgb');\n/**@param {any} a @return {Boolean} */\nconst isHsl = a => stringStartsWith(a, 'hsl');\n/**@param {any} a @return {Boolean} */\nconst isCol = a => isHex(a) || isRgb(a) || isHsl(a);\n/**@param {any} a @return {Boolean} */\nconst isKey = a => !globals.defaults.hasOwnProperty(a);\n\n// Number\n\n/**\n * @param  {Number|String} str\n * @return {Number}\n */\nconst parseNumber = str => isStr(str) ?\n  parseFloat(/** @type {String} */(str)) :\n  /** @type {Number} */(str);\n\n// Math\n\nconst pow = Math.pow;\nconst sqrt = Math.sqrt;\nconst sin = Math.sin;\nconst cos = Math.cos;\nconst abs = Math.abs;\nconst exp = Math.exp;\nconst ceil = Math.ceil;\nconst floor = Math.floor;\nconst asin = Math.asin;\nconst max = Math.max;\nconst atan2 = Math.atan2;\nconst PI = Math.PI;\nconst _round = Math.round;\n\n/**\n * @param  {Number} v\n * @param  {Number} min\n * @param  {Number} max\n * @return {Number}\n */\nconst clamp = (v, min, max) => v < min ? min : v > max ? max : v;\n\nconst powCache = {};\n\n/**\n * @param  {Number} v\n * @param  {Number} decimalLength\n * @return {Number}\n */\nconst round = (v, decimalLength) => {\n  if (decimalLength < 0) return v;\n  if (!decimalLength) return _round(v);\n  let p = powCache[decimalLength];\n  if (!p) p = powCache[decimalLength] = 10 ** decimalLength;\n  return _round(v * p) / p;\n};\n\n/**\n * @param  {Number} v\n * @param  {Number|Array<Number>} increment\n * @return {Number}\n */\nconst snap = (v, increment) => isArr(increment) ? increment.reduce((closest, cv) => (abs(cv - v) < abs(closest - v) ? cv : closest)) : increment ? _round(v / increment) * increment : v;\n\n/**\n * @param  {Number} start\n * @param  {Number} end\n * @param  {Number} progress\n * @return {Number}\n */\nconst interpolate = (start, end, progress) => start + (end - start) * progress;\n\n/**\n * @param  {Number} v\n * @return {Number}\n */\nconst clampInfinity = v => v === Infinity ? maxValue : v === -Infinity ? -1e12 : v;\n\n/**\n * @param  {Number} v\n * @return {Number}\n */\nconst normalizeTime = v => v <= minValue ? minValue : clampInfinity(round(v, 11));\n\n// Arrays\n\n/**\n * @template T\n * @param {T[]} a\n * @return {T[]}\n */\nconst cloneArray = a => isArr(a) ? [ ...a ] : a;\n\n// Objects\n\n/**\n * @template T\n * @template U\n * @param {T} o1\n * @param {U} o2\n * @return {T & U}\n */\nconst mergeObjects = (o1, o2) => {\n  const merged = /** @type {T & U} */({ ...o1 });\n  for (let p in o2) {\n    const o1p = /** @type {T & U} */(o1)[p];\n    merged[p] = isUnd(o1p) ? /** @type {T & U} */(o2)[p] : o1p;\n  }  return merged;\n};\n\n// Linked lists\n\n/**\n * @param {Object} parent\n * @param {Function} callback\n * @param {Boolean} [reverse]\n * @param {String} [prevProp]\n * @param {String} [nextProp]\n * @return {void}\n */\nconst forEachChildren = (parent, callback, reverse, prevProp = '_prev', nextProp = '_next') => {\n  let next = parent._head;\n  let adjustedNextProp = nextProp;\n  if (reverse) {\n    next = parent._tail;\n    adjustedNextProp = prevProp;\n  }\n  while (next) {\n    const currentNext = next[adjustedNextProp];\n    callback(next);\n    next = currentNext;\n  }\n};\n\n/**\n * @param  {Object} parent\n * @param  {Object} child\n * @param  {String} [prevProp]\n * @param  {String} [nextProp]\n * @return {void}\n */\nconst removeChild = (parent, child, prevProp = '_prev', nextProp = '_next') => {\n  const prev = child[prevProp];\n  const next = child[nextProp];\n  prev ? prev[nextProp] = next : parent._head = next;\n  next ? next[prevProp] = prev : parent._tail = prev;\n  child[prevProp] = null;\n  child[nextProp] = null;\n};\n\n/**\n * @param  {Object} parent\n * @param  {Object} child\n * @param  {Function} [sortMethod]\n * @param  {String} prevProp\n * @param  {String} nextProp\n * @return {void}\n */\nconst addChild = (parent, child, sortMethod, prevProp = '_prev', nextProp = '_next') => {\n  let prev = parent._tail;\n  while (prev && sortMethod && sortMethod(prev, child)) prev = prev[prevProp];\n  const next = prev ? prev[nextProp] : parent._head;\n  prev ? prev[nextProp] = child : parent._head = child;\n  next ? next[prevProp] = child : parent._tail = child;\n  child[prevProp] = prev;\n  child[nextProp] = next;\n};\n\n/*\n * Base class to control framerate and playback rate.\n * Inherited by Engine, Timer, Animation and Timeline.\n */\nclass Clock {\n\n  /** @param {Number} [initTime] */\n  constructor(initTime = 0) {\n    /** @type {Number} */\n    this.deltaTime = 0;\n    /** @type {Number} */\n    this._currentTime = initTime;\n    /** @type {Number} */\n    this._elapsedTime = initTime;\n    /** @type {Number} */\n    this._startTime = initTime;\n    /** @type {Number} */\n    this._lastTime = initTime;\n    /** @type {Number} */\n    this._scheduledTime = 0;\n    /** @type {Number} */\n    this._frameDuration = round(K / maxFps, 0);\n    /** @type {Number} */\n    this._fps = maxFps;\n    /** @type {Number} */\n    this._speed = 1;\n    /** @type {Boolean} */\n    this._hasChildren = false;\n    /** @type {Tickable|Tween} */\n    this._head = null;\n    /** @type {Tickable|Tween} */\n    this._tail = null;\n  }\n\n  get fps() {\n    return this._fps;\n  }\n\n  set fps(frameRate) {\n    const previousFrameDuration = this._frameDuration;\n    const fr = +frameRate;\n    const fps = fr < minValue ? minValue : fr;\n    const frameDuration = round(K / fps, 0);\n    this._fps = fps;\n    this._frameDuration = frameDuration;\n    this._scheduledTime += frameDuration - previousFrameDuration;\n  }\n\n  get speed() {\n    return this._speed;\n  }\n\n  set speed(playbackRate) {\n    const pbr = +playbackRate;\n    this._speed = pbr < minValue ? minValue : pbr;\n  }\n\n  /**\n   * @param  {Number} time\n   * @return {tickModes}\n   */\n  requestTick(time) {\n    const scheduledTime = this._scheduledTime;\n    const elapsedTime = this._elapsedTime;\n    this._elapsedTime += (time - elapsedTime);\n    // If the elapsed time is lower than the scheduled time\n    // this means not enough time has passed to hit one frameDuration\n    // so skip that frame\n    if (elapsedTime < scheduledTime) return tickModes.NONE;\n    const frameDuration = this._frameDuration;\n    const frameDelta = elapsedTime - scheduledTime;\n    // Ensures that _scheduledTime progresses in steps of at least 1 frameDuration.\n    // Skips ahead if the actual elapsed time is higher.\n    this._scheduledTime += frameDelta < frameDuration ? frameDuration : frameDelta;\n    return tickModes.AUTO;\n  }\n\n  /**\n   * @param  {Number} time\n   * @return {Number}\n   */\n  computeDeltaTime(time) {\n    const delta = time - this._lastTime;\n    this.deltaTime = delta;\n    this._lastTime = time;\n    return delta;\n  }\n\n}\n\n\n\n\n/**\n * @param  {Tickable} tickable\n * @param  {Number} time\n * @param  {Number} muteCallbacks\n * @param  {Number} internalRender\n * @param  {tickModes} tickMode\n * @return {Number}\n */\nconst render = (tickable, time, muteCallbacks, internalRender, tickMode) => {\n\n  const parent = tickable.parent;\n  const duration = tickable.duration;\n  const completed = tickable.completed;\n  const iterationDuration = tickable.iterationDuration;\n  const iterationCount = tickable.iterationCount;\n  const _currentIteration = tickable._currentIteration;\n  const _loopDelay = tickable._loopDelay;\n  const _reversed = tickable._reversed;\n  const _alternate = tickable._alternate;\n  const _hasChildren = tickable._hasChildren;\n  const tickableDelay = tickable._delay;\n  const tickablePrevAbsoluteTime = tickable._currentTime; // TODO: rename ._currentTime to ._absoluteCurrentTime\n\n  const tickableEndTime = tickableDelay + iterationDuration;\n  const tickableAbsoluteTime = time - tickableDelay;\n  const tickablePrevTime = clamp(tickablePrevAbsoluteTime, -tickableDelay, duration);\n  const tickableCurrentTime = clamp(tickableAbsoluteTime, -tickableDelay, duration);\n  const deltaTime = tickableAbsoluteTime - tickablePrevAbsoluteTime;\n  const isCurrentTimeAboveZero = tickableCurrentTime > 0;\n  const isCurrentTimeEqualOrAboveDuration = tickableCurrentTime >= duration;\n  const isSetter = duration <= minValue;\n  const forcedTick = tickMode === tickModes.FORCE;\n\n  let isOdd = 0;\n  let iterationElapsedTime = tickableAbsoluteTime;\n  // Render checks\n  // Used to also check if the children have rendered in order to trigger the onRender callback on the parent timer\n  let hasRendered = 0;\n\n  // Execute the \"expensive\" iterations calculations only when necessary\n  if (iterationCount > 1) {\n    // bitwise NOT operator seems to be generally faster than Math.floor() across browsers\n    const currentIteration = ~~(tickableCurrentTime / (iterationDuration + (isCurrentTimeEqualOrAboveDuration ? 0 : _loopDelay)));\n    tickable._currentIteration = clamp(currentIteration, 0, iterationCount);\n    // Prevent the iteration count to go above the max iterations when reaching the end of the animation\n    if (isCurrentTimeEqualOrAboveDuration) tickable._currentIteration--;\n    isOdd = tickable._currentIteration % 2;\n    iterationElapsedTime = tickableCurrentTime % (iterationDuration + _loopDelay) || 0;\n  }\n\n  // Checks if exactly one of _reversed and (_alternate && isOdd) is true\n  const isReversed = _reversed ^ (_alternate && isOdd);\n  const _ease = /** @type {Renderable} */(tickable)._ease;\n  let iterationTime = isCurrentTimeEqualOrAboveDuration ? isReversed ? 0 : duration : isReversed ? iterationDuration - iterationElapsedTime : iterationElapsedTime;\n  if (_ease) iterationTime = iterationDuration * _ease(iterationTime / iterationDuration) || 0;\n  const isRunningBackwards = (parent ? parent.backwards : tickableAbsoluteTime < tickablePrevAbsoluteTime) ? !isReversed : !!isReversed;\n\n  tickable._currentTime = tickableAbsoluteTime;\n  tickable._iterationTime = iterationTime;\n  tickable.backwards = isRunningBackwards;\n\n  if (isCurrentTimeAboveZero && !tickable.began) {\n    tickable.began = true;\n    if (!muteCallbacks && !(parent && (isRunningBackwards || !parent.began))) {\n      tickable.onBegin(/** @type {CallbackArgument} */(tickable));\n    }\n  } else if (tickableAbsoluteTime <= 0) {\n    tickable.began = false;\n  }\n\n  // Only triggers onLoop for tickable without children, otherwise call the the onLoop callback in the tick function\n  // Make sure to trigger the onLoop before rendering to allow .refresh() to pickup the current values\n  if (!muteCallbacks && !_hasChildren && isCurrentTimeAboveZero && tickable._currentIteration !== _currentIteration) {\n    tickable.onLoop(/** @type {CallbackArgument} */(tickable));\n  }\n\n  if (\n    forcedTick ||\n    tickMode === tickModes.AUTO && (\n      time >= tickableDelay && time <= tickableEndTime || // Normal render\n      time <= tickableDelay && tickablePrevTime > tickableDelay || // Playhead is before the animation start time so make sure the animation is at its initial state\n      time >= tickableEndTime && tickablePrevTime !== duration // Playhead is after the animation end time so make sure the animation is at its end state\n    ) ||\n    iterationTime >= tickableEndTime && tickablePrevTime !== duration ||\n    iterationTime <= tickableDelay && tickablePrevTime > 0 ||\n    time <= tickablePrevTime && tickablePrevTime === duration && completed || // Force a render if a seek occurs on an completed animation\n    isCurrentTimeEqualOrAboveDuration && !completed && isSetter // This prevents 0 duration tickables to be skipped\n  ) {\n\n    if (isCurrentTimeAboveZero) {\n      // Trigger onUpdate callback before rendering\n      tickable.computeDeltaTime(tickablePrevTime);\n      if (!muteCallbacks) tickable.onBeforeUpdate(/** @type {CallbackArgument} */(tickable));\n    }\n\n    // Start tweens rendering\n    if (!_hasChildren) {\n\n      // Time has jumped more than globals.tickThreshold so consider this tick manual\n      const forcedRender = forcedTick || (isRunningBackwards ? deltaTime * -1 : deltaTime) >= globals.tickThreshold;\n      const absoluteTime = tickable._offset + (parent ? parent._offset : 0) + tickableDelay + iterationTime;\n\n      // Only Animation can have tweens, Timer returns undefined\n      let tween = /** @type {Tween} */(/** @type {JSAnimation} */(tickable)._head);\n      let tweenTarget;\n      let tweenStyle;\n      let tweenTargetTransforms;\n      let tweenTargetTransformsProperties;\n      let tweenTransformsNeedUpdate = 0;\n\n      while (tween) {\n\n        const tweenComposition = tween._composition;\n        const tweenCurrentTime = tween._currentTime;\n        const tweenChangeDuration = tween._changeDuration;\n        const tweenAbsEndTime = tween._absoluteStartTime + tween._changeDuration;\n        const tweenNextRep = tween._nextRep;\n        const tweenPrevRep = tween._prevRep;\n        const tweenHasComposition = tweenComposition !== compositionTypes.none;\n\n        if ((forcedRender || (\n            (tweenCurrentTime !== tweenChangeDuration || absoluteTime <= tweenAbsEndTime + (tweenNextRep ? tweenNextRep._delay : 0)) &&\n            (tweenCurrentTime !== 0 || absoluteTime >= tween._absoluteStartTime)\n          )) && (!tweenHasComposition || (\n            !tween._isOverridden &&\n            (!tween._isOverlapped || absoluteTime <= tweenAbsEndTime) &&\n            (!tweenNextRep || (tweenNextRep._isOverridden || absoluteTime <= tweenNextRep._absoluteStartTime)) &&\n            (!tweenPrevRep || (tweenPrevRep._isOverridden || (absoluteTime >= (tweenPrevRep._absoluteStartTime + tweenPrevRep._changeDuration) + tween._delay)))\n          ))\n        ) {\n\n          const tweenNewTime = tween._currentTime = clamp(iterationTime - tween._startTime, 0, tweenChangeDuration);\n          const tweenProgress = tween._ease(tweenNewTime / tween._updateDuration);\n          const tweenModifier = tween._modifier;\n          const tweenValueType = tween._valueType;\n          const tweenType = tween._tweenType;\n          const tweenIsObject = tweenType === tweenTypes.OBJECT;\n          const tweenIsNumber = tweenValueType === valueTypes.NUMBER;\n          // Only round the in-between frames values if the final value is a string\n          const tweenPrecision = (tweenIsNumber && tweenIsObject) || tweenProgress === 0 || tweenProgress === 1 ? -1 : globals.precision;\n\n          // Recompose tween value\n          /** @type {String|Number} */\n          let value;\n          /** @type {Number} */\n          let number;\n\n          if (tweenIsNumber) {\n            value = number = /** @type {Number} */(tweenModifier(round(interpolate(tween._fromNumber, tween._toNumber,  tweenProgress), tweenPrecision )));\n          } else if (tweenValueType === valueTypes.UNIT) {\n            // Rounding the values speed up string composition\n            number = /** @type {Number} */(tweenModifier(round(interpolate(tween._fromNumber, tween._toNumber,  tweenProgress), tweenPrecision)));\n            value = `${number}${tween._unit}`;\n          } else if (tweenValueType === valueTypes.COLOR) {\n            const fn = tween._fromNumbers;\n            const tn = tween._toNumbers;\n            const r = round(clamp(/** @type {Number} */(tweenModifier(interpolate(fn[0], tn[0], tweenProgress))), 0, 255), 0);\n            const g = round(clamp(/** @type {Number} */(tweenModifier(interpolate(fn[1], tn[1], tweenProgress))), 0, 255), 0);\n            const b = round(clamp(/** @type {Number} */(tweenModifier(interpolate(fn[2], tn[2], tweenProgress))), 0, 255), 0);\n            const a = clamp(/** @type {Number} */(tweenModifier(round(interpolate(fn[3], tn[3], tweenProgress), tweenPrecision))), 0, 1);\n            value = `rgba(${r},${g},${b},${a})`;\n            if (tweenHasComposition) {\n              const ns = tween._numbers;\n              ns[0] = r;\n              ns[1] = g;\n              ns[2] = b;\n              ns[3] = a;\n            }\n          } else if (tweenValueType === valueTypes.COMPLEX) {\n            value = tween._strings[0];\n            for (let j = 0, l = tween._toNumbers.length; j < l; j++) {\n              const n = /** @type {Number} */(tweenModifier(round(interpolate(tween._fromNumbers[j], tween._toNumbers[j], tweenProgress), tweenPrecision)));\n              const s = tween._strings[j + 1];\n              value += `${s ? n + s : n}`;\n              if (tweenHasComposition) {\n                tween._numbers[j] = n;\n              }\n            }\n          }\n\n          // For additive tweens and Animatables\n          if (tweenHasComposition) {\n            tween._number = number;\n          }\n\n          if (!internalRender && tweenComposition !== compositionTypes.blend) {\n\n            const tweenProperty = tween.property;\n            tweenTarget = tween.target;\n\n            if (tweenIsObject) {\n              tweenTarget[tweenProperty] = value;\n            } else if (tweenType === tweenTypes.ATTRIBUTE) {\n              /** @type {DOMTarget} */(tweenTarget).setAttribute(tweenProperty, /** @type {String} */(value));\n            } else {\n              tweenStyle = /** @type {DOMTarget} */(tweenTarget).style;\n              if (tweenType === tweenTypes.TRANSFORM) {\n                if (tweenTarget !== tweenTargetTransforms) {\n                  tweenTargetTransforms = tweenTarget;\n                  // NOTE: Referencing the cachedTransforms in the tween property directly can be a little bit faster but appears to increase memory usage.\n                  tweenTargetTransformsProperties = tweenTarget[transformsSymbol];\n                }\n                tweenTargetTransformsProperties[tweenProperty] = value;\n                tweenTransformsNeedUpdate = 1;\n              } else if (tweenType === tweenTypes.CSS) {\n                tweenStyle[tweenProperty] = value;\n              } else if (tweenType === tweenTypes.CSS_VAR) {\n                tweenStyle.setProperty(tweenProperty,/** @type {String} */(value));\n              }\n            }\n\n            if (isCurrentTimeAboveZero) hasRendered = 1;\n\n          } else {\n            // Used for composing timeline tweens without having to do a real render\n            tween._value = value;\n          }\n\n        }\n\n        // NOTE: Possible improvement: Use translate(x,y) / translate3d(x,y,z) syntax\n        // to reduce memory usage on string composition\n        if (tweenTransformsNeedUpdate && tween._renderTransforms) {\n          let str = emptyString;\n          for (let key in tweenTargetTransformsProperties) {\n            str += `${transformsFragmentStrings[key]}${tweenTargetTransformsProperties[key]}) `;\n          }\n          tweenStyle.transform = str;\n          tweenTransformsNeedUpdate = 0;\n        }\n\n        tween = tween._next;\n      }\n\n      if (!muteCallbacks && hasRendered) {\n        /** @type {JSAnimation} */(tickable).onRender(/** @type {JSAnimation} */(tickable));\n      }\n    }\n\n    if (!muteCallbacks && isCurrentTimeAboveZero) {\n      tickable.onUpdate(/** @type {CallbackArgument} */(tickable));\n    }\n\n  }\n\n  // End tweens rendering\n\n  // Handle setters on timeline differently and allow re-trigering the onComplete callback when seeking backwards\n  if (parent && isSetter) {\n    if (!muteCallbacks && (\n      (parent.began && !isRunningBackwards && tickableAbsoluteTime >= duration && !completed) ||\n      (isRunningBackwards && tickableAbsoluteTime <= minValue && completed)\n    )) {\n      tickable.onComplete(/** @type {CallbackArgument} */(tickable));\n      tickable.completed = !isRunningBackwards;\n    }\n  // If currentTime is both above 0 and at least equals to duration, handles normal onComplete or infinite loops\n  } else if (isCurrentTimeAboveZero && isCurrentTimeEqualOrAboveDuration) {\n    if (iterationCount === Infinity) {\n      // Offset the tickable _startTime with its duration to reset _currentTime to 0 and continue the infinite timer\n      tickable._startTime += tickable.duration;\n    } else if (tickable._currentIteration >= iterationCount - 1) {\n      // By setting paused to true, we tell the engine loop to not render this tickable and removes it from the list on the next tick\n      tickable.paused = true;\n      if (!completed && !_hasChildren) {\n        // If the tickable has children, triggers onComplete() only when all children have completed in the tick function\n        tickable.completed = true;\n        if (!muteCallbacks && !(parent && (isRunningBackwards || !parent.began))) {\n          tickable.onComplete(/** @type {CallbackArgument} */(tickable));\n          tickable._resolve(/** @type {CallbackArgument} */(tickable));\n        }\n      }\n    }\n  // Otherwise set the completed flag to false\n  } else {\n    tickable.completed = false;\n  }\n\n  // NOTE: hasRendered * direction (negative for backwards) this way we can remove the tickable.backwards property completly ?\n  return hasRendered;\n};\n\n/**\n * @param  {Tickable} tickable\n * @param  {Number} time\n * @param  {Number} muteCallbacks\n * @param  {Number} internalRender\n * @param  {Number} tickMode\n * @return {void}\n */\nconst tick = (tickable, time, muteCallbacks, internalRender, tickMode) => {\n  const _currentIteration = tickable._currentIteration;\n  render(tickable, time, muteCallbacks, internalRender, tickMode);\n  if (tickable._hasChildren) {\n    const tl = /** @type {Timeline} */(tickable);\n    const tlIsRunningBackwards = tl.backwards;\n    const tlChildrenTime = internalRender ? time : tl._iterationTime;\n    const tlCildrenTickTime = now();\n\n    let tlChildrenHasRendered = 0;\n    let tlChildrenHaveCompleted = true;\n\n    // If the timeline has looped forward, we need to manually triggers children skipped callbacks\n    if (!internalRender && tl._currentIteration !== _currentIteration) {\n      const tlIterationDuration = tl.iterationDuration;\n      forEachChildren(tl, (/** @type {JSAnimation} */child) => {\n        if (!tlIsRunningBackwards) {\n          // Force an internal render to trigger the callbacks if the child has not completed on loop\n          if (!child.completed && !child.backwards && child._currentTime < child.iterationDuration) {\n            render(child, tlIterationDuration, muteCallbacks, 1, tickModes.FORCE);\n          }\n          // Reset their began and completed flags to allow retrigering callbacks on the next iteration\n          child.began = false;\n          child.completed = false;\n        } else {\n          const childDuration = child.duration;\n          const childStartTime = child._offset + child._delay;\n          const childEndTime = childStartTime + childDuration;\n          // Triggers the onComplete callback on reverse for children on the edges of the timeline\n          if (!muteCallbacks && childDuration <= minValue && (!childStartTime || childEndTime === tlIterationDuration)) {\n            child.onComplete(child);\n          }\n        }\n      });\n      if (!muteCallbacks) tl.onLoop(/** @type {CallbackArgument} */(tl));\n    }\n\n    forEachChildren(tl, (/** @type {JSAnimation} */child) => {\n      const childTime = round((tlChildrenTime - child._offset) * child._speed, 12); // Rounding is needed when using seconds\n      const childTickMode = child._fps < tl._fps ? child.requestTick(tlCildrenTickTime) : tickMode;\n      tlChildrenHasRendered += render(child, childTime, muteCallbacks, internalRender, childTickMode);\n      if (!child.completed && tlChildrenHaveCompleted) tlChildrenHaveCompleted = false;\n    }, tlIsRunningBackwards);\n\n    // Renders on timeline are triggered by its children so it needs to be set after rendering the children\n    if (!muteCallbacks && tlChildrenHasRendered) tl.onRender(/** @type {CallbackArgument} */(tl));\n\n    // Triggers the timeline onComplete() once all chindren all completed and the current time has reached the end\n    if (tlChildrenHaveCompleted && tl._currentTime >= tl.duration) {\n      // Make sure the paused flag is false in case it has been skipped in the render function\n      tl.paused = true;\n      if (!tl.completed) {\n        tl.completed = true;\n        if (!muteCallbacks) {\n          tl.onComplete(/** @type {CallbackArgument} */(tl));\n          tl._resolve(/** @type {CallbackArgument} */(tl));\n        }\n      }\n    }\n  }\n};\n\n\n\n\nconst additive = {\n  animation: null,\n  update: noop,\n};\n\n/**\n * @typedef AdditiveAnimation\n * @property {Number} duration\n * @property {Number} _offset\n * @property {Number} _delay\n * @property {Tween} _head\n * @property {Tween} _tail\n */\n\n/**\n * @param  {TweenAdditiveLookups} lookups\n * @return {AdditiveAnimation}\n */\nconst addAdditiveAnimation = lookups => {\n  let animation = additive.animation;\n  if (!animation) {\n    animation = {\n      duration: minValue,\n      computeDeltaTime: noop,\n      _offset: 0,\n      _delay: 0,\n      _head: null,\n      _tail: null,\n    };\n    additive.animation = animation;\n    additive.update = () => {\n      lookups.forEach(propertyAnimation => {\n        for (let propertyName in propertyAnimation) {\n          const tweens = propertyAnimation[propertyName];\n          const lookupTween = tweens._head;\n          if (lookupTween) {\n            const valueType = lookupTween._valueType;\n            const additiveValues = valueType === valueTypes.COMPLEX || valueType === valueTypes.COLOR ? cloneArray(lookupTween._fromNumbers) : null;\n            let additiveValue = lookupTween._fromNumber;\n            let tween = tweens._tail;\n            while (tween && tween !== lookupTween) {\n              if (additiveValues) {\n                for (let i = 0, l = tween._numbers.length; i < l; i++) additiveValues[i] += tween._numbers[i];\n              } else {\n                additiveValue += tween._number;\n              }\n              tween = tween._prevAdd;\n            }\n            lookupTween._toNumber = additiveValue;\n            lookupTween._toNumbers = additiveValues;\n          }\n        }\n      });\n      // TODO: Avoid polymorphism here, idealy the additive animation should be a regular animation with a higher priority in the render loop\n      render(animation, 1, 1, 0, tickModes.FORCE);\n    };\n  }\n  return animation;\n};\n\nconst engineTickMethod = isBrowser ? requestAnimationFrame : setImmediate;\nconst engineCancelMethod = isBrowser ? cancelAnimationFrame : clearImmediate;\n\nclass Engine extends Clock {\n\n  /** @param {Number} [initTime] */\n  constructor(initTime) {\n    super(initTime);\n    this.useDefaultMainLoop = true;\n    this.pauseOnDocumentHidden = true;\n    /** @type {DefaultsParams} */\n    this.defaults = defaults;\n    this.paused = isBrowser && doc.hidden ? true  : false;\n    /** @type {Number|NodeJS.Immediate} */\n    this.reqId = null;\n  }\n\n  update() {\n    const time = this._currentTime = now();\n    if (this.requestTick(time)) {\n      this.computeDeltaTime(time);\n      const engineSpeed = this._speed;\n      const engineFps = this._fps;\n      let activeTickable = /** @type {Tickable} */(this._head);\n      while (activeTickable) {\n        const nextTickable = activeTickable._next;\n        if (!activeTickable.paused) {\n          tick(\n            activeTickable,\n            (time - activeTickable._startTime) * activeTickable._speed * engineSpeed,\n            0, // !muteCallbacks\n            0, // !internalRender\n            activeTickable._fps < engineFps ? activeTickable.requestTick(time) : tickModes.AUTO\n          );\n        } else {\n          removeChild(this, activeTickable);\n          this._hasChildren = !!this._tail;\n          activeTickable._running = false;\n          if (activeTickable.completed && !activeTickable._cancelled) {\n            activeTickable.cancel();\n          }\n        }\n        activeTickable = nextTickable;\n      }\n      additive.update();\n    }\n  }\n\n  wake() {\n    if (this.useDefaultMainLoop && !this.reqId && !this.paused) {\n      this.reqId = engineTickMethod(tickEngine);\n    }\n    return this;\n  }\n\n  pause() {\n    this.paused = true;\n    return killEngine();\n  }\n\n  resume() {\n    if (!this.paused) return;\n    this.paused = false;\n    forEachChildren(this, (/** @type {Tickable} */child) => child.resetTime());\n    return this.wake();\n  }\n\n  // Getter and setter for speed\n  get speed() {\n    return this._speed * (globals.timeScale === 1 ? 1 : K);\n  }\n\n  set speed(playbackRate) {\n    this._speed = playbackRate * globals.timeScale;\n    forEachChildren(this, (/** @type {Tickable} */child) => child.speed = child._speed);\n  }\n\n  // Getter and setter for timeUnit\n  get timeUnit() {\n    return globals.timeScale === 1 ? 'ms' : 's';\n  };\n\n  set timeUnit(unit) {\n    const secondsScale = 0.001;\n    const isSecond = unit === 's';\n    const newScale = isSecond ? secondsScale : 1;\n    if (globals.timeScale !== newScale) {\n      globals.timeScale = newScale;\n      globals.tickThreshold = 200 * newScale;\n      const scaleFactor = isSecond ? secondsScale : K;\n      /** @type {Number} */\n      (this.defaults.duration) *= scaleFactor;\n      this._speed *= scaleFactor;\n    }\n  }\n\n  // Getter and setter for precision\n  get precision() {\n    return globals.precision;\n  }\n\n  set precision(precision) {\n    globals.precision = precision;\n  }\n\n}\nconst engine = /*#__PURE__*/(() => {\n  const engine = new Engine(now());\n  if (isBrowser) {\n    globalVersions.engine = engine;\n    doc.addEventListener('visibilitychange', () => {\n      if (!engine.pauseOnDocumentHidden) return;\n      doc.hidden ? engine.pause() : engine.resume();\n    });\n  }\n  return engine;\n})();\n\n\nconst tickEngine = () => {\n  if (engine._head) {\n    engine.reqId = engineTickMethod(tickEngine);\n    engine.update();\n  } else {\n    engine.reqId = 0;\n  }\n};\n\nconst killEngine = () => {\n  engineCancelMethod(/** @type {NodeJS.Immediate & Number} */(engine.reqId));\n  engine.reqId = 0;\n  return engine;\n};\n\n\n\n\n/**\n * @param  {DOMTarget} target\n * @param  {String} propName\n * @param  {Object} animationInlineStyles\n * @return {String}\n */\nconst parseInlineTransforms = (target, propName, animationInlineStyles) => {\n  const inlineTransforms = target.style.transform;\n  let inlinedStylesPropertyValue;\n  if (inlineTransforms) {\n    const cachedTransforms = target[transformsSymbol];\n    let t; while (t = transformsExecRgx.exec(inlineTransforms)) {\n      const inlinePropertyName = t[1];\n      // const inlinePropertyValue = t[2];\n      const inlinePropertyValue = t[2].slice(1, -1);\n      cachedTransforms[inlinePropertyName] = inlinePropertyValue;\n      if (inlinePropertyName === propName) {\n        inlinedStylesPropertyValue = inlinePropertyValue;\n        // Store the new parsed inline styles if animationInlineStyles is provided\n        if (animationInlineStyles) {\n          animationInlineStyles[propName] = inlinePropertyValue;\n        }\n      }\n    }\n  }\n  return inlineTransforms && !isUnd(inlinedStylesPropertyValue) ? inlinedStylesPropertyValue :\n    stringStartsWith(propName, 'scale') ? '1' :\n    stringStartsWith(propName, 'rotate') || stringStartsWith(propName, 'skew') ? '0deg' : '0px';\n};\n\n\n\n\n/**\n * @param  {DOMTargetsParam|TargetsParam} v\n * @return {NodeList|HTMLCollection}\n */\nfunction getNodeList(v) {\n  const n = isStr(v) ? globals.root.querySelectorAll(v) : v;\n  if (n instanceof NodeList || n instanceof HTMLCollection) return n;\n}\n\n/**\n * @overload\n * @param  {DOMTargetsParam} targets\n * @return {DOMTargetsArray}\n *\n * @overload\n * @param  {JSTargetsParam} targets\n * @return {JSTargetsArray}\n *\n * @overload\n * @param  {TargetsParam} targets\n * @return {TargetsArray}\n *\n * @param  {DOMTargetsParam|JSTargetsParam|TargetsParam} targets\n */\nfunction parseTargets(targets) {\n  if (isNil(targets)) return /** @type {TargetsArray} */([]);\n  if (isArr(targets)) {\n    const flattened = targets.flat(Infinity);\n    /** @type {TargetsArray} */\n    const parsed = [];\n    for (let i = 0, l = flattened.length; i < l; i++) {\n      const item = flattened[i];\n      if (!isNil(item)) {\n        const nodeList = getNodeList(item);\n        if (nodeList) {\n          for (let j = 0, jl = nodeList.length; j < jl; j++) {\n            const subItem = nodeList[j];\n            if (!isNil(subItem)) {\n              let isDuplicate = false;\n              for (let k = 0, kl = parsed.length; k < kl; k++) {\n                if (parsed[k] === subItem) {\n                  isDuplicate = true;\n                  break;\n                }\n              }\n              if (!isDuplicate) {\n                parsed.push(subItem);\n              }\n            }\n          }\n        } else {\n          let isDuplicate = false;\n          for (let j = 0, jl = parsed.length; j < jl; j++) {\n            if (parsed[j] === item) {\n              isDuplicate = true;\n              break;\n            }\n          }\n          if (!isDuplicate) {\n            parsed.push(item);\n          }\n        }\n      }\n    }\n    return parsed;\n  }\n  if (!isBrowser) return /** @type {JSTargetsArray} */([targets]);\n  const nodeList = getNodeList(targets);\n  if (nodeList) return /** @type {DOMTargetsArray} */(Array.from(nodeList));\n  return /** @type {TargetsArray} */([targets]);\n}\n\n/**\n * @overload\n * @param  {DOMTargetsParam} targets\n * @return {DOMTargetsArray}\n *\n * @overload\n * @param  {JSTargetsParam} targets\n * @return {JSTargetsArray}\n *\n * @overload\n * @param  {TargetsParam} targets\n * @return {TargetsArray}\n *\n * @param  {DOMTargetsParam|JSTargetsParam|TargetsParam} targets\n */\nfunction registerTargets(targets) {\n  const parsedTargetsArray = parseTargets(targets);\n  const parsedTargetsLength = parsedTargetsArray.length;\n  if (parsedTargetsLength) {\n    for (let i = 0; i < parsedTargetsLength; i++) {\n      const target = parsedTargetsArray[i];\n      if (!target[isRegisteredTargetSymbol]) {\n        target[isRegisteredTargetSymbol] = true;\n        const isSvgType = isSvg(target);\n        const isDom = /** @type {DOMTarget} */(target).nodeType || isSvgType;\n        if (isDom) {\n          target[isDomSymbol] = true;\n          target[isSvgSymbol] = isSvgType;\n          target[transformsSymbol] = {};\n        }\n      }\n    }\n  }\n  return parsedTargetsArray;\n}\n\n\n\n\n/**\n * @param  {TargetsParam} path\n * @return {SVGGeometryElement|undefined}\n */\nconst getPath = path => {\n  const parsedTargets = parseTargets(path);\n  const $parsedSvg = /** @type {SVGGeometryElement} */(parsedTargets[0]);\n  if (!$parsedSvg || !isSvg($parsedSvg)) return;\n  return $parsedSvg;\n};\n\n/**\n * @param  {TargetsParam} path2\n * @param  {Number} [precision]\n * @return {FunctionValue}\n */\nconst morphTo = (path2, precision = .33) => ($path1) => {\n  const $path2 = /** @type {SVGGeometryElement} */(getPath(path2));\n  if (!$path2) return;\n  const isPath = $path1.tagName === 'path';\n  const separator = isPath ? ' ' : ',';\n  const previousPoints = $path1[morphPointsSymbol];\n  if (previousPoints) $path1.setAttribute(isPath ? 'd' : 'points', previousPoints);\n\n  let v1 = '', v2 = '';\n\n  if (!precision) {\n    v1 = $path1.getAttribute(isPath ? 'd' : 'points');\n    v2 = $path2.getAttribute(isPath ? 'd' : 'points');\n  } else {\n    const length1 = /** @type {SVGGeometryElement} */($path1).getTotalLength();\n    const length2 = $path2.getTotalLength();\n    const maxPoints = Math.max(Math.ceil(length1 * precision), Math.ceil(length2 * precision));\n    for (let i = 0; i < maxPoints; i++) {\n      const t = i / (maxPoints - 1);\n      const pointOnPath1 = /** @type {SVGGeometryElement} */($path1).getPointAtLength(length1 * t);\n      const pointOnPath2 = $path2.getPointAtLength(length2 * t);\n      const prefix = isPath ? (i === 0 ? 'M' : 'L') : '';\n      v1 += prefix + round(pointOnPath1.x, 3) + separator + pointOnPath1.y + ' ';\n      v2 += prefix + round(pointOnPath2.x, 3) + separator + pointOnPath2.y + ' ';\n    }\n  }\n\n  $path1[morphPointsSymbol] = v2;\n\n  return [v1, v2];\n};\n\n/**\n * @param {SVGGeometryElement} [$el]\n * @return {Number}\n */\nconst getScaleFactor = $el => {\n  let scaleFactor = 1;\n  if ($el && $el.getCTM) {\n    const ctm = $el.getCTM();\n    if (ctm) {\n      const scaleX = sqrt(ctm.a * ctm.a + ctm.b * ctm.b);\n      const scaleY = sqrt(ctm.c * ctm.c + ctm.d * ctm.d);\n      scaleFactor = (scaleX + scaleY) / 2;\n    }\n  }\n  return scaleFactor;\n};\n\n/**\n * Creates a proxy that wraps an SVGGeometryElement and adds drawing functionality.\n * @param {SVGGeometryElement} $el - The SVG element to transform into a drawable\n * @param {number} start - Starting position (0-1)\n * @param {number} end - Ending position (0-1)\n * @return {DrawableSVGGeometry} - Returns a proxy that preserves the original element's type with additional 'draw' attribute functionality\n */\nconst createDrawableProxy = ($el, start, end) => {\n  const pathLength = K;\n  const computedStyles = getComputedStyle($el);\n  const strokeLineCap = computedStyles.strokeLinecap;\n  // @ts-ignore\n  const $scalled = computedStyles.vectorEffect === 'non-scaling-stroke' ? $el : null;\n  let currentCap = strokeLineCap;\n\n  const proxy = new Proxy($el, {\n    get(target, property) {\n      const value = target[property];\n      if (property === proxyTargetSymbol) return target;\n      if (property === 'setAttribute') {\n        return (...args) => {\n          if (args[0] === 'draw') {\n            const value = args[1];\n            const values = value.split(' ');\n            const v1 = +values[0];\n            const v2 = +values[1];\n            // TOTO: Benchmark if performing two slices is more performant than one split\n            // const spaceIndex = value.indexOf(' ');\n            // const v1 = round(+value.slice(0, spaceIndex), precision);\n            // const v2 = round(+value.slice(spaceIndex + 1), precision);\n            const scaleFactor = getScaleFactor($scalled);\n            const os = v1 * -1e3 * scaleFactor;\n            const d1 = (v2 * pathLength * scaleFactor) + os;\n            const d2 = (pathLength * scaleFactor +\n                      ((v1 === 0 && v2 === 1) || (v1 === 1 && v2 === 0) ? 0 : 10 * scaleFactor) - d1);\n            if (strokeLineCap !== 'butt') {\n              const newCap = v1 === v2 ? 'butt' : strokeLineCap;\n              if (currentCap !== newCap) {\n                target.style.strokeLinecap = `${newCap}`;\n                currentCap = newCap;\n              }\n            }\n            target.setAttribute('stroke-dashoffset', `${os}`);\n            target.setAttribute('stroke-dasharray', `${d1} ${d2}`);\n          }\n          return Reflect.apply(value, target, args);\n        };\n      }\n\n      if (isFnc(value)) {\n        return (...args) => Reflect.apply(value, target, args);\n      } else {\n        return value;\n      }\n    }\n  });\n\n  if ($el.getAttribute('pathLength') !== `${pathLength}`) {\n    $el.setAttribute('pathLength', `${pathLength}`);\n    proxy.setAttribute('draw', `${start} ${end}`);\n  }\n\n  return /** @type {DrawableSVGGeometry} */(proxy);\n};\n\n/**\n * Creates drawable proxies for multiple SVG elements.\n * @param {TargetsParam} selector - CSS selector, SVG element, or array of elements and selectors\n * @param {number} [start=0] - Starting position (0-1)\n * @param {number} [end=0] - Ending position (0-1)\n * @return {Array<DrawableSVGGeometry>} - Array of proxied elements with drawing functionality\n */\nconst createDrawable = (selector, start = 0, end = 0) => {\n  const els = parseTargets(selector);\n  return els.map($el => createDrawableProxy(\n    /** @type {SVGGeometryElement} */($el),\n    start,\n    end\n  ));\n};\n\n// Motion path animation\n\n/**\n * @param {SVGGeometryElement} $path\n * @param {Number} progress\n * @param {Number}lookup\n * @return {DOMPoint}\n */\nconst getPathPoint = ($path, progress, lookup = 0) => {\n  return $path.getPointAtLength(progress + lookup >= 1 ? progress + lookup : 0);\n};\n\n/**\n * @param {SVGGeometryElement} $path\n * @param {String} pathProperty\n * @return {FunctionValue}\n */\nconst getPathProgess = ($path, pathProperty) => {\n  return $el => {\n    const totalLength = +($path.getTotalLength());\n    const inSvg = $el[isSvgSymbol];\n    const ctm = $path.getCTM();\n    /** @type {TweenObjectValue} */\n    return {\n      from: 0,\n      to: totalLength,\n      /** @type {TweenModifier} */\n      modifier: progress => {\n        if (pathProperty === 'a') {\n          const p0 = getPathPoint($path, progress, -1);\n          const p1 = getPathPoint($path, progress, 1);\n          return atan2(p1.y - p0.y, p1.x - p0.x) * 180 / PI;\n        } else {\n          const p = getPathPoint($path, progress, 0);\n          return pathProperty === 'x' ?\n            inSvg || !ctm ? p.x : p.x * ctm.a + p.y * ctm.c + ctm.e :\n            inSvg || !ctm ? p.y : p.x * ctm.b + p.y * ctm.d + ctm.f\n        }\n      }\n    }\n  }\n};\n\n/**\n * @param {TargetsParam} path\n */\nconst createMotionPath = path => {\n  const $path = getPath(path);\n  if (!$path) return;\n  return {\n    translateX: getPathProgess($path, 'x'),\n    translateY: getPathProgess($path, 'y'),\n    rotate: getPathProgess($path, 'a'),\n  }\n};\n\n// Check for valid SVG attribute\n\nconst cssReservedProperties = ['opacity', 'rotate', 'overflow', 'color'];\n\n/**\n * @param  {Target} el\n * @param  {String} propertyName\n * @return {Boolean}\n */\nconst isValidSVGAttribute = (el, propertyName) => {\n  // Return early and use CSS opacity animation instead (already better default values (opacity: 1 instead of 0)) and rotate should be considered a transform\n  if (cssReservedProperties.includes(propertyName)) return false;\n  if (el.getAttribute(propertyName) || propertyName in el) {\n    if (propertyName === 'scale') { // Scale\n      const elParentNode = /** @type {SVGGeometryElement} */(/** @type {DOMTarget} */(el).parentNode);\n      // Only consider scale as a valid SVG attribute on filter element\n      return elParentNode && elParentNode.tagName === 'filter';\n    }\n    return true;\n  }\n};\n\nconst svg = {\n  morphTo,\n  createMotionPath,\n  createDrawable,\n};\n\n\n\n\n/**\n * RGB / RGBA Color value string -> RGBA values array\n * @param  {String} rgbValue\n * @return {ColorArray}\n */\nconst rgbToRgba = rgbValue => {\n  const rgba = rgbExecRgx.exec(rgbValue) || rgbaExecRgx.exec(rgbValue);\n  const a = !isUnd(rgba[4]) ? +rgba[4] : 1;\n  return [\n    +rgba[1],\n    +rgba[2],\n    +rgba[3],\n    a\n  ]\n};\n\n/**\n * HEX3 / HEX3A / HEX6 / HEX6A Color value string -> RGBA values array\n * @param  {String} hexValue\n * @return {ColorArray}\n */\nconst hexToRgba = hexValue => {\n  const hexLength = hexValue.length;\n  const isShort = hexLength === 4 || hexLength === 5;\n  return [\n    +('0x' + hexValue[1] + hexValue[isShort ? 1 : 2]),\n    +('0x' + hexValue[isShort ? 2 : 3] + hexValue[isShort ? 2 : 4]),\n    +('0x' + hexValue[isShort ? 3 : 5] + hexValue[isShort ? 3 : 6]),\n    ((hexLength === 5 || hexLength === 9) ? +(+('0x' + hexValue[isShort ? 4 : 7] + hexValue[isShort ? 4 : 8]) / 255).toFixed(3) : 1)\n  ]\n};\n\n/**\n * @param  {Number} p\n * @param  {Number} q\n * @param  {Number} t\n * @return {Number}\n */\nconst hue2rgb = (p, q, t) => {\n  if (t < 0) t += 1;\n  if (t > 1) t -= 1;\n  return t < 1 / 6 ? p + (q - p) * 6 * t :\n         t < 1 / 2 ? q :\n         t < 2 / 3 ? p + (q - p) * (2 / 3 - t) * 6 :\n         p;\n};\n\n/**\n * HSL / HSLA Color value string -> RGBA values array\n * @param  {String} hslValue\n * @return {ColorArray}\n */\nconst hslToRgba = hslValue => {\n  const hsla = hslExecRgx.exec(hslValue) || hslaExecRgx.exec(hslValue);\n  const h = +hsla[1] / 360;\n  const s = +hsla[2] / 100;\n  const l = +hsla[3] / 100;\n  const a = !isUnd(hsla[4]) ? +hsla[4] : 1;\n  let r, g, b;\n  if (s === 0) {\n    r = g = b = l;\n  } else {\n    const q = l < .5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n    r = round(hue2rgb(p, q, h + 1 / 3) * 255, 0);\n    g = round(hue2rgb(p, q, h) * 255, 0);\n    b = round(hue2rgb(p, q, h - 1 / 3) * 255, 0);\n  }\n  return [r, g, b, a];\n};\n\n/**\n * All in one color converter that converts a color string value into an array of RGBA values\n * @param  {String} colorString\n * @return {ColorArray}\n */\nconst convertColorStringValuesToRgbaArray = colorString => {\n  return isRgb(colorString) ? rgbToRgba(colorString) :\n         isHex(colorString) ? hexToRgba(colorString) :\n         isHsl(colorString) ? hslToRgba(colorString) :\n         [0, 0, 0, 1];\n};\n\n\n\n\n/**\n * @template T, D\n * @param {T|undefined} targetValue\n * @param {D} defaultValue\n * @return {T|D}\n */\nconst setValue = (targetValue, defaultValue) => {\n  return isUnd(targetValue) ? defaultValue : targetValue;\n};\n\n/**\n * @param  {TweenPropValue} value\n * @param  {Target} target\n * @param  {Number} index\n * @param  {Number} total\n * @param  {Object} [store]\n * @return {any}\n */\nconst getFunctionValue = (value, target, index, total, store) => {\n  if (isFnc(value)) {\n    const func = () => {\n      const computed = /** @type {Function} */(value)(target, index, total);\n      // Fallback to 0 if the function returns undefined / NaN / null / false / 0\n      return !isNaN(+computed) ? +computed : computed || 0;\n    };\n    if (store) {\n      store.func = func;\n    }\n    return func();\n  } else {\n    return value;\n  }\n};\n\n/**\n * @param  {Target} target\n * @param  {String} prop\n * @return {tweenTypes}\n */\nconst getTweenType = (target, prop) => {\n  return !target[isDomSymbol] ? tweenTypes.OBJECT :\n    // Handle SVG attributes\n    target[isSvgSymbol] && isValidSVGAttribute(target, prop) ? tweenTypes.ATTRIBUTE :\n    // Handle CSS Transform properties differently than CSS to allow individual animations\n    validTransforms.includes(prop) || shortTransforms.get(prop) ? tweenTypes.TRANSFORM :\n    // CSS variables\n    stringStartsWith(prop, '--') ? tweenTypes.CSS_VAR :\n    // All other CSS properties\n    prop in /** @type {DOMTarget} */(target).style ? tweenTypes.CSS :\n    // Handle other DOM Attributes\n    prop in target ? tweenTypes.OBJECT :\n    tweenTypes.ATTRIBUTE;\n};\n\n/**\n * @param  {DOMTarget} target\n * @param  {String} propName\n * @param  {Object} animationInlineStyles\n * @return {String}\n */\nconst getCSSValue = (target, propName, animationInlineStyles) => {\n  const inlineStyles = target.style[propName];\n  if (inlineStyles && animationInlineStyles) {\n    animationInlineStyles[propName] = inlineStyles;\n  }\n  const value = inlineStyles || getComputedStyle(target[proxyTargetSymbol] || target).getPropertyValue(propName);\n  return value === 'auto' ? '0' : value;\n};\n\n/**\n * @param {Target} target\n * @param {String} propName\n * @param {tweenTypes} [tweenType]\n * @param {Object|void} [animationInlineStyles]\n * @return {String|Number}\n */\nconst getOriginalAnimatableValue = (target, propName, tweenType, animationInlineStyles) => {\n  const type = !isUnd(tweenType) ? tweenType : getTweenType(target, propName);\n  return type === tweenTypes.OBJECT ? target[propName] || 0 :\n         type === tweenTypes.ATTRIBUTE ? /** @type {DOMTarget} */(target).getAttribute(propName) :\n         type === tweenTypes.TRANSFORM ? parseInlineTransforms(/** @type {DOMTarget} */(target), propName, animationInlineStyles) :\n         type === tweenTypes.CSS_VAR ? getCSSValue(/** @type {DOMTarget} */(target), propName, animationInlineStyles).trimStart() :\n         getCSSValue(/** @type {DOMTarget} */(target), propName, animationInlineStyles);\n};\n\n/**\n * @param  {Number} x\n * @param  {Number} y\n * @param  {String} operator\n * @return {Number}\n */\nconst getRelativeValue = (x, y, operator) => {\n  return operator === '-' ? x - y :\n         operator === '+' ? x + y :\n         x * y;\n};\n\n/** @return {TweenDecomposedValue} */\nconst createDecomposedValueTargetObject = () => {\n  return {\n    /** @type {valueTypes} */\n    t: valueTypes.NUMBER,\n    n: 0,\n    u: null,\n    o: null,\n    d: null,\n    s: null,\n  }\n};\n\n/**\n * @param  {String|Number} rawValue\n * @param  {TweenDecomposedValue} targetObject\n * @return {TweenDecomposedValue}\n */\nconst decomposeRawValue = (rawValue, targetObject) => {\n  /** @type {valueTypes} */\n  targetObject.t = valueTypes.NUMBER;\n  targetObject.n = 0;\n  targetObject.u = null;\n  targetObject.o = null;\n  targetObject.d = null;\n  targetObject.s = null;\n  if (!rawValue) return targetObject;\n  const num = +rawValue;\n  if (!isNaN(num)) {\n    // It's a number\n    targetObject.n = num;\n    return targetObject;\n  } else {\n    // let str = /** @type {String} */(rawValue).trim();\n    let str = /** @type {String} */(rawValue);\n    // Parsing operators (+=, -=, *=) manually is much faster than using regex here\n    if (str[1] === '=') {\n      targetObject.o = str[0];\n      str = str.slice(2);\n    }\n    // Skip exec regex if the value type is complex or color to avoid long regex backtracking\n    const unitMatch = str.includes(' ') ? false : unitsExecRgx.exec(str);\n    if (unitMatch) {\n      // Has a number and a unit\n      targetObject.t = valueTypes.UNIT;\n      targetObject.n = +unitMatch[1];\n      targetObject.u = unitMatch[2];\n      return targetObject;\n    } else if (targetObject.o) {\n      // Has an operator (+=, -=, *=)\n      targetObject.n = +str;\n      return targetObject;\n    } else if (isCol(str)) {\n      // Is a color\n      targetObject.t = valueTypes.COLOR;\n      targetObject.d = convertColorStringValuesToRgbaArray(str);\n      return targetObject;\n    } else {\n      // Is a more complex string (generally svg coords, calc() or filters CSS values)\n      const matchedNumbers = str.match(digitWithExponentRgx);\n      targetObject.t = valueTypes.COMPLEX;\n      targetObject.d = matchedNumbers ? matchedNumbers.map(Number) : [];\n      targetObject.s = str.split(digitWithExponentRgx) || [];\n      return targetObject;\n    }\n  }\n};\n\n/**\n * @param  {Tween} tween\n * @param  {TweenDecomposedValue} targetObject\n * @return {TweenDecomposedValue}\n */\nconst decomposeTweenValue = (tween, targetObject) => {\n  targetObject.t = tween._valueType;\n  targetObject.n = tween._toNumber;\n  targetObject.u = tween._unit;\n  targetObject.o = null;\n  targetObject.d = cloneArray(tween._toNumbers);\n  targetObject.s = cloneArray(tween._strings);\n  return targetObject;\n};\n\nconst decomposedOriginalValue = createDecomposedValueTargetObject();\n\n\n\n\nconst lookups = {\n  /** @type {TweenReplaceLookups} */\n  _rep: new WeakMap(),\n  /** @type {TweenAdditiveLookups} */\n  _add: new Map(),\n};\n\n/**\n * @param  {Target} target\n * @param  {String} property\n * @param  {String} lookup\n * @return {TweenPropertySiblings}\n */\nconst getTweenSiblings = (target, property, lookup = '_rep') => {\n  const lookupMap = lookups[lookup];\n  let targetLookup = lookupMap.get(target);\n  if (!targetLookup) {\n    targetLookup = {};\n    lookupMap.set(target, targetLookup);\n  }\n  return targetLookup[property] ? targetLookup[property] : targetLookup[property] = {\n    _head: null,\n    _tail: null,\n  }\n};\n\n/**\n * @param  {Tween} p\n * @param  {Tween} c\n * @return {Number|Boolean}\n */\nconst addTweenSortMethod = (p, c) => {\n  return p._isOverridden || p._absoluteStartTime > c._absoluteStartTime;\n};\n\n/**\n * @param {Tween} tween\n */\nconst overrideTween = tween => {\n  tween._isOverlapped = 1;\n  tween._isOverridden = 1;\n  tween._changeDuration = minValue;\n  tween._currentTime = minValue;\n};\n\n/**\n * @param  {Tween} tween\n * @param  {TweenPropertySiblings} siblings\n * @return {Tween}\n */\nconst composeTween = (tween, siblings) => {\n\n  const tweenCompositionType = tween._composition;\n\n  // Handle replaced tweens\n\n  if (tweenCompositionType === compositionTypes.replace) {\n\n    const tweenAbsStartTime = tween._absoluteStartTime;\n\n    addChild(siblings, tween, addTweenSortMethod, '_prevRep', '_nextRep');\n\n    const prevSibling = tween._prevRep;\n\n    // Update the previous siblings for composition replace tweens\n\n    if (prevSibling) {\n\n      const prevParent = prevSibling.parent;\n      const prevAbsEndTime = prevSibling._absoluteStartTime + prevSibling._changeDuration;\n\n      // Handle looped animations tween\n\n      if (\n        // Check if the previous tween is from a different animation\n        tween.parent.id !== prevParent.id &&\n        // Check if the animation has loops\n        prevParent.iterationCount> 1 &&\n        // Check if _absoluteChangeEndTime of last loop overlaps the current tween\n        prevAbsEndTime + (prevParent.duration - prevParent.iterationDuration) > tweenAbsStartTime\n      ) {\n\n        // TODO: Find a way to only override the iterations overlapping with the tween\n        overrideTween(prevSibling);\n\n        let prevPrevSibling = prevSibling._prevRep;\n\n        // If the tween was part of a set of keyframes, override its siblings\n        while (prevPrevSibling && prevPrevSibling.parent.id === prevParent.id) {\n          overrideTween(prevPrevSibling);\n          prevPrevSibling = prevPrevSibling._prevRep;\n        }\n\n      }\n\n      const absoluteUpdateStartTime = tweenAbsStartTime - tween._delay;\n\n      if (prevAbsEndTime > absoluteUpdateStartTime) {\n\n        const prevChangeStartTime = prevSibling._startTime;\n        const prevTLOffset = prevAbsEndTime - (prevChangeStartTime + prevSibling._updateDuration);\n\n        prevSibling._changeDuration = absoluteUpdateStartTime - prevTLOffset - prevChangeStartTime;\n        prevSibling._currentTime = prevSibling._changeDuration;\n        prevSibling._isOverlapped = 1;\n\n        if (prevSibling._changeDuration < minValue) {\n          overrideTween(prevSibling);\n        }\n      }\n\n      // Pause (and cancel) the parent if it only contains overlapped tweens\n\n      let pausePrevParentAnimation = true;\n\n      forEachChildren(prevParent, (/** @type Tween */t) => {\n        if (!t._isOverlapped) pausePrevParentAnimation = false;\n      });\n\n      if (pausePrevParentAnimation) {\n        const prevParentTL = prevParent.parent;\n        if (prevParentTL) {\n          let pausePrevParentTL = true;\n          forEachChildren(prevParentTL, (/** @type JSAnimation */a) => {\n            if (a !== prevParent) {\n              forEachChildren(a, (/** @type Tween */t) => {\n                if (!t._isOverlapped) pausePrevParentTL = false;\n              });\n            }\n          });\n          if (pausePrevParentTL) {\n            prevParentTL.cancel();\n          }\n        } else {\n          prevParent.cancel();\n          // Previously, calling .cancel() on a timeline child would affect the render order of other children\n          // Worked around this by marking it as .completed and using .pause() for safe removal in the engine loop\n          // This is no longer needed since timeline tween composition is now handled separatly\n          // Keeping this here for reference\n          // prevParent.completed = true;\n          // prevParent.pause();\n        }\n      }\n\n    }\n\n    // let nextSibling = tween._nextRep;\n\n    // // All the next siblings are automatically overridden\n\n    // if (nextSibling && nextSibling._absoluteStartTime >= tweenAbsStartTime) {\n    //   while (nextSibling) {\n    //     overrideTween(nextSibling);\n    //     nextSibling = nextSibling._nextRep;\n    //   }\n    // }\n\n    // if (nextSibling && nextSibling._absoluteStartTime < tweenAbsStartTime) {\n    //   while (nextSibling) {\n    //     overrideTween(nextSibling);\n    //     console.log(tween.id, nextSibling.id);\n    //     nextSibling = nextSibling._nextRep;\n    //   }\n    // }\n\n  // Handle additive tweens composition\n\n  } else if (tweenCompositionType === compositionTypes.blend) {\n\n    const additiveTweenSiblings = getTweenSiblings(tween.target, tween.property, '_add');\n    const additiveAnimation = addAdditiveAnimation(lookups._add);\n\n    let lookupTween = additiveTweenSiblings._head;\n\n    if (!lookupTween) {\n      lookupTween = { ...tween };\n      lookupTween._composition = compositionTypes.replace;\n      lookupTween._updateDuration = minValue;\n      lookupTween._startTime = 0;\n      lookupTween._numbers = cloneArray(tween._fromNumbers);\n      lookupTween._number = 0;\n      lookupTween._next = null;\n      lookupTween._prev = null;\n      addChild(additiveTweenSiblings, lookupTween);\n      addChild(additiveAnimation, lookupTween);\n    }\n\n    // Convert the values of TO to FROM and set TO to 0\n\n    const toNumber = tween._toNumber;\n    tween._fromNumber = lookupTween._fromNumber - toNumber;\n    tween._toNumber = 0;\n    tween._numbers = cloneArray(tween._fromNumbers);\n    tween._number = 0;\n    lookupTween._fromNumber = toNumber;\n\n    if (tween._toNumbers) {\n      const toNumbers = cloneArray(tween._toNumbers);\n      if (toNumbers) {\n        toNumbers.forEach((value, i) => {\n          tween._fromNumbers[i] = lookupTween._fromNumbers[i] - value;\n          tween._toNumbers[i] = 0;\n        });\n      }\n      lookupTween._fromNumbers = toNumbers;\n    }\n\n    addChild(additiveTweenSiblings, tween, null, '_prevAdd', '_nextAdd');\n\n  }\n\n  return tween;\n\n};\n\n/**\n * @param  {Tween} tween\n * @return {Tween}\n */\nconst removeTweenSliblings = tween => {\n  const tweenComposition = tween._composition;\n  if (tweenComposition !== compositionTypes.none) {\n    const tweenTarget = tween.target;\n    const tweenProperty = tween.property;\n    const replaceTweensLookup = lookups._rep;\n    const replaceTargetProps = replaceTweensLookup.get(tweenTarget);\n    const tweenReplaceSiblings = replaceTargetProps[tweenProperty];\n    removeChild(tweenReplaceSiblings, tween, '_prevRep', '_nextRep');\n    if (tweenComposition === compositionTypes.blend) {\n      const addTweensLookup = lookups._add;\n      const addTargetProps = addTweensLookup.get(tweenTarget);\n      if (!addTargetProps) return;\n      const additiveTweenSiblings = addTargetProps[tweenProperty];\n      const additiveAnimation = additive.animation;\n      removeChild(additiveTweenSiblings, tween, '_prevAdd', '_nextAdd');\n      // If only one tween is left in the additive lookup, it's the tween lookup\n      const lookupTween = additiveTweenSiblings._head;\n      if (lookupTween && lookupTween === additiveTweenSiblings._tail) {\n        removeChild(additiveTweenSiblings, lookupTween, '_prevAdd', '_nextAdd');\n        removeChild(additiveAnimation, lookupTween);\n        let shouldClean = true;\n        for (let prop in addTargetProps) {\n          if (addTargetProps[prop]._head) {\n            shouldClean = false;\n            break;\n          }\n        }\n        if (shouldClean) {\n          addTweensLookup.delete(tweenTarget);\n        }\n      }\n    }\n  }\n  return tween;\n};\n\n\n\n\n/**\n * @param  {Timer} timer\n * @return {Timer}\n */\nconst resetTimerProperties = timer => {\n  timer.paused = true;\n  timer.began = false;\n  timer.completed = false;\n  return timer;\n};\n\n/**\n * @param  {Timer} timer\n * @return {Timer}\n */\nconst reviveTimer = timer => {\n  if (!timer._cancelled) return timer;\n  if (timer._hasChildren) {\n    forEachChildren(timer, reviveTimer);\n  } else {\n    forEachChildren(timer, (/** @type {Tween} tween*/tween) => {\n      if (tween._composition !== compositionTypes.none) {\n        composeTween(tween, getTweenSiblings(tween.target, tween.property));\n      }\n    });\n  }\n  timer._cancelled = 0;\n  return timer;\n};\n\nlet timerId = 0;\n\n/**\n * Base class used to create Timers, Animations and Timelines\n */\nclass Timer extends Clock {\n  /**\n   * @param {TimerParams} [parameters]\n   * @param {Timeline} [parent]\n   * @param {Number} [parentPosition]\n   */\n  constructor(parameters = {}, parent = null, parentPosition = 0) {\n\n    super(0);\n\n    const {\n      id,\n      delay,\n      duration,\n      reversed,\n      alternate,\n      loop,\n      loopDelay,\n      autoplay,\n      frameRate,\n      playbackRate,\n      onComplete,\n      onLoop,\n      onPause,\n      onBegin,\n      onBeforeUpdate,\n      onUpdate,\n    } = parameters;\n\n    if (globals.scope) globals.scope.revertibles.push(this);\n\n    const timerInitTime = parent ? 0 : engine._elapsedTime;\n    const timerDefaults = parent ? parent.defaults : globals.defaults;\n    const timerDelay = /** @type {Number} */(isFnc(delay) || isUnd(delay) ? timerDefaults.delay : +delay);\n    const timerDuration = isFnc(duration) || isUnd(duration) ? Infinity : +duration;\n    const timerLoop = setValue(loop, timerDefaults.loop);\n    const timerLoopDelay = setValue(loopDelay, timerDefaults.loopDelay);\n    const timerIterationCount = timerLoop === true ||\n                                timerLoop === Infinity ||\n                                /** @type {Number} */(timerLoop) < 0 ? Infinity :\n                                /** @type {Number} */(timerLoop) + 1;\n\n    let offsetPosition = 0;\n\n    if (parent) {\n      offsetPosition = parentPosition;\n    } else {\n      let startTime = now();\n      // Make sure to tick the engine once if suspended to avoid big gaps with the following offsetPosition calculation\n      if (engine.paused) {\n        engine.requestTick(startTime);\n        startTime = engine._elapsedTime;\n      }\n      offsetPosition = startTime - engine._startTime;\n    }\n\n    // Timer's parameters\n    this.id = !isUnd(id) ? id : ++timerId;\n    /** @type {Timeline} */\n    this.parent = parent;\n    // Total duration of the timer\n    this.duration = clampInfinity(((timerDuration + timerLoopDelay) * timerIterationCount) - timerLoopDelay) || minValue;\n    /** @type {Boolean} */\n    this.backwards = false;\n    /** @type {Boolean} */\n    this.paused = true;\n    /** @type {Boolean} */\n    this.began = false;\n    /** @type {Boolean} */\n    this.completed = false;\n    /** @type {Callback<this>} */\n    this.onBegin = onBegin || timerDefaults.onBegin;\n    /** @type {Callback<this>} */\n    this.onBeforeUpdate = onBeforeUpdate || timerDefaults.onBeforeUpdate;\n    /** @type {Callback<this>} */\n    this.onUpdate = onUpdate || timerDefaults.onUpdate;\n    /** @type {Callback<this>} */\n    this.onLoop = onLoop || timerDefaults.onLoop;\n    /** @type {Callback<this>} */\n    this.onPause = onPause || timerDefaults.onPause;\n    /** @type {Callback<this>} */\n    this.onComplete = onComplete || timerDefaults.onComplete;\n    /** @type {Number} */\n    this.iterationDuration = timerDuration; // Duration of one loop\n    /** @type {Number} */\n    this.iterationCount = timerIterationCount; // Number of loops\n    /** @type {Boolean|ScrollObserver} */\n    this._autoplay = parent ? false : setValue(autoplay, timerDefaults.autoplay);\n    /** @type {Number} */\n    this._offset = offsetPosition;\n    /** @type {Number} */\n    this._delay = timerDelay;\n    /** @type {Number} */\n    this._loopDelay = timerLoopDelay;\n    /** @type {Number} */\n    this._iterationTime = 0;\n    /** @type {Number} */\n    this._currentIteration = 0; // Current loop index\n    /** @type {Function} */\n    this._resolve = noop; // Used by .then()\n    /** @type {Boolean} */\n    this._running = false;\n    /** @type {Number} */\n    this._reversed = +setValue(reversed, timerDefaults.reversed);\n    /** @type {Number} */\n    this._reverse = this._reversed;\n    /** @type {Number} */\n    this._cancelled = 0;\n    /** @type {Boolean} */\n    this._alternate = setValue(alternate, timerDefaults.alternate);\n    /** @type {Renderable} */\n    this._prev = null;\n    /** @type {Renderable} */\n    this._next = null;\n\n    // Clock's parameters\n    /** @type {Number} */\n    this._elapsedTime = timerInitTime;\n    /** @type {Number} */\n    this._startTime = timerInitTime;\n    /** @type {Number} */\n    this._lastTime = timerInitTime;\n    /** @type {Number} */\n    this._fps = setValue(frameRate, timerDefaults.frameRate);\n    /** @type {Number} */\n    this._speed = setValue(playbackRate, timerDefaults.playbackRate);\n  }\n\n  get cancelled() {\n    return !!this._cancelled;\n  }\n\n  /** @param {Boolean} cancelled  */\n  set cancelled(cancelled) {\n    cancelled ? this.cancel() : this.reset(1).play();\n  }\n\n  get currentTime() {\n    return clamp(round(this._currentTime, globals.precision), -this._delay, this.duration);\n  }\n\n  /** @param {Number} time  */\n  set currentTime(time) {\n    const paused = this.paused;\n    // Pausing the timer is necessary to avoid time jumps on a running instance\n    this.pause().seek(+time);\n    if (!paused) this.resume();\n  }\n\n  get iterationCurrentTime() {\n    return round(this._iterationTime, globals.precision);\n  }\n\n  /** @param {Number} time  */\n  set iterationCurrentTime(time) {\n    this.currentTime = (this.iterationDuration * this._currentIteration) + time;\n  }\n\n  get progress() {\n    return clamp(round(this._currentTime / this.duration, 5), 0, 1);\n  }\n\n  /** @param {Number} progress  */\n  set progress(progress) {\n    this.currentTime = this.duration * progress;\n  }\n\n  get iterationProgress() {\n    return clamp(round(this._iterationTime / this.iterationDuration, 5), 0, 1);\n  }\n\n  /** @param {Number} progress  */\n  set iterationProgress(progress) {\n    const iterationDuration = this.iterationDuration;\n    this.currentTime = (iterationDuration * this._currentIteration) + (iterationDuration * progress);\n  }\n\n  get currentIteration() {\n    return this._currentIteration;\n  }\n\n  /** @param {Number} iterationCount  */\n  set currentIteration(iterationCount) {\n    this.currentTime = (this.iterationDuration * clamp(+iterationCount, 0, this.iterationCount - 1));\n  }\n\n  get reversed() {\n    return !!this._reversed;\n  }\n\n  /** @param {Boolean} reverse  */\n  set reversed(reverse) {\n    reverse ? this.reverse() : this.play();\n  }\n\n  get speed() {\n    return super.speed;\n  }\n\n  /** @param {Number} playbackRate  */\n  set speed(playbackRate) {\n    super.speed = playbackRate;\n    this.resetTime();\n  }\n\n  /**\n   * @param  {Number} internalRender\n   * @return {this}\n   */\n  reset(internalRender = 0) {\n    // If cancelled, revive the timer before rendering in order to have propertly composed tweens siblings\n    reviveTimer(this);\n    if (this._reversed && !this._reverse) this.reversed = false;\n    // Rendering before updating the completed flag to prevent skips and to make sure the properties are not overridden\n    // Setting the iterationTime at the end to force the rendering to happend backwards, otherwise calling .reset() on Timelines might not render children in the right order\n    // NOTE: This is only required for Timelines and might be better to move to the Timeline class?\n    this._iterationTime = this.iterationDuration;\n    // Set tickMode to tickModes.FORCE to force rendering\n    tick(this, 0, 1, internalRender, tickModes.FORCE);\n    // Reset timer properties after revive / render to make sure the props are not updated again\n    resetTimerProperties(this);\n    // Also reset children properties\n    if (this._hasChildren) {\n      forEachChildren(this, resetTimerProperties);\n    }\n    return this;\n  }\n\n  /**\n   * @param  {Number} internalRender\n   * @return {this}\n   */\n  init(internalRender = 0) {\n    this.fps = this._fps;\n    this.speed = this._speed;\n    // Manually calling .init() on timelines should render all children intial state\n    // Forces all children to render once then render to 0 when reseted\n    if (!internalRender && this._hasChildren) {\n      tick(this, this.duration, 1, internalRender, tickModes.FORCE);\n    }\n    this.reset(internalRender);\n    // Make sure to set autoplay to false to child timers so it doesn't attempt to autoplay / link\n    const autoplay = this._autoplay;\n    if (autoplay === true) {\n      this.resume();\n    } else if (autoplay && !isUnd(/** @type {ScrollObserver} */(autoplay).linked)) {\n      /** @type {ScrollObserver} */(autoplay).link(this);\n    }\n    return this;\n  }\n\n  /** @return {this} */\n  resetTime() {\n    const timeScale = 1 / (this._speed * engine._speed);\n    this._startTime = now() - (this._currentTime + this._delay) * timeScale;\n    return this;\n  }\n\n  /** @return {this} */\n  pause() {\n    if (this.paused) return this;\n    this.paused = true;\n    this.onPause(this);\n    return this;\n  }\n\n  /** @return {this} */\n  resume() {\n    if (!this.paused) return this;\n    this.paused = false;\n    // We can safely imediatly render a timer that has no duration and no children\n    if (this.duration <= minValue && !this._hasChildren) {\n      tick(this, minValue, 0, 0, tickModes.FORCE);\n    } else {\n      if (!this._running) {\n        addChild(engine, this);\n        engine._hasChildren = true;\n        this._running = true;\n      }\n      this.resetTime();\n      // Forces the timer to advance by at least one frame when the next tick occurs\n      this._startTime -= 12;\n      engine.wake();\n    }\n    return this;\n  }\n\n  /** @return {this} */\n  restart() {\n    return this.reset(0).resume();\n  }\n\n  /**\n   * @param  {Number} time\n   * @param  {Boolean|Number} [muteCallbacks]\n   * @param  {Boolean|Number} [internalRender]\n   * @return {this}\n   */\n  seek(time, muteCallbacks = 0, internalRender = 0) {\n    // Recompose the tween siblings in case the timer has been cancelled\n    reviveTimer(this);\n    // If you seek a completed animation, otherwise the next play will starts at 0\n    this.completed = false;\n    const isPaused = this.paused;\n    this.paused = true;\n    // timer, time, muteCallbacks, internalRender, tickMode\n    tick(this, time + this._delay, ~~muteCallbacks, ~~internalRender, tickModes.AUTO);\n    return isPaused ? this : this.resume();\n  }\n\n  /** @return {this} */\n  alternate() {\n    const reversed = this._reversed;\n    const count = this.iterationCount;\n    const duration = this.iterationDuration;\n    // Calculate the maximum iterations possible given the iteration duration\n    const iterations = count === Infinity ? floor(maxValue / duration) : count;\n    this._reversed = +(this._alternate && !(iterations % 2) ? reversed : !reversed);\n    if (count === Infinity) {\n      // Handle infinite loops to loop on themself\n      this.iterationProgress = this._reversed ? 1 - this.iterationProgress : this.iterationProgress;\n    } else {\n      this.seek((duration * iterations) - this._currentTime);\n    }\n    this.resetTime();\n    return this;\n  }\n\n  /** @return {this} */\n  play() {\n    if (this._reversed) this.alternate();\n    return this.resume();\n  }\n\n  /** @return {this} */\n  reverse() {\n    if (!this._reversed) this.alternate();\n    return this.resume();\n  }\n\n  // TODO: Move all the animation / tweens / children related code to Animation / Timeline\n\n  /** @return {this} */\n  cancel() {\n    if (this._hasChildren) {\n      forEachChildren(this, (/** @type {Renderable} */child) => child.cancel(), true);\n    } else {\n      forEachChildren(this, removeTweenSliblings);\n    }\n    this._cancelled = 1;\n    // Pausing the timer removes it from the engine\n    return this.pause();\n  }\n\n  /**\n   * @param  {Number} newDuration\n   * @return {this}\n   */\n  stretch(newDuration) {\n    const currentDuration = this.duration;\n    const normlizedDuration = normalizeTime(newDuration);\n    if (currentDuration === normlizedDuration) return this;\n    const timeScale = newDuration / currentDuration;\n    const isSetter = newDuration <= minValue;\n    this.duration = isSetter ? minValue : normlizedDuration;\n    this.iterationDuration = isSetter ? minValue : normalizeTime(this.iterationDuration * timeScale);\n    this._offset *= timeScale;\n    this._delay *= timeScale;\n    this._loopDelay *= timeScale;\n    return this;\n  }\n\n /**\n   * Cancels the timer by seeking it back to 0 and reverting the attached scroller if necessary\n   * @return {this}\n   */\n  revert() {\n    tick(this, 0, 1, 0, tickModes.AUTO);\n    const ap = /** @type {ScrollObserver} */(this._autoplay);\n    if (ap && ap.linked && ap.linked === this) ap.revert();\n    return this.cancel();\n  }\n\n /**\n   * Imediatly completes the timer, cancels it and triggers the onComplete callback\n   * @return {this}\n   */\n  complete() {\n    return this.seek(this.duration).cancel();\n  }\n\n  /**\n   * @param  {Callback<this>} [callback]\n   * @return {Promise}\n   */\n  then(callback = noop) {\n    const then = this.then;\n    const onResolve = () => {\n      // this.then = null prevents infinite recursion if returned by an async function\n      // https://github.com/juliangarnierorg/anime-beta/issues/26\n      this.then = null;\n      callback(this);\n      this.then = then;\n      this._resolve = noop;\n    };\n    return new Promise(r => {\n      this._resolve = () => r(onResolve());\n      // Make sure to resolve imediatly if the timer has already completed\n      if (this.completed) this._resolve();\n      return this;\n    });\n  }\n\n}\n\n\n/**\n * @param {TimerParams} [parameters]\n * @return {Timer}\n */\nconst createTimer = parameters => new Timer(parameters, null, 0).init();\n\n\n\n\n/** @type {EasingFunction} */\nconst none = t => t;\n\n// Cubic Bezier solver adapted from https://github.com/gre/bezier-ease  Gatan Renaudeau\n\n/**\n * @param  {Number} aT\n * @param  {Number} aA1\n * @param  {Number} aA2\n * @return {Number}\n */\nconst calcBezier = (aT, aA1, aA2) => (((1 - 3 * aA2 + 3 * aA1) * aT + (3 * aA2 - 6 * aA1)) * aT + (3 * aA1)) * aT;\n\n/**\n * @param  {Number} aX\n * @param  {Number} mX1\n * @param  {Number} mX2\n * @return {Number}\n */\nconst binarySubdivide = (aX, mX1, mX2) => {\n  let aA = 0, aB = 1, currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (abs(currentX) > .0000001 && ++i < 100);\n  return currentT;\n};\n\n/**\n * @param  {Number} [mX1]\n * @param  {Number} [mY1]\n * @param  {Number} [mX2]\n * @param  {Number} [mY2]\n * @return {EasingFunction}\n */\n\nconst cubicBezier = (mX1 = 0.5, mY1 = 0.0, mX2 = 0.5, mY2 = 1.0) => (mX1 === mY1 && mX2 === mY2) ? none :\n  t => t === 0 || t === 1 ? t :\n  calcBezier(binarySubdivide(t, mX1, mX2), mY1, mY2);\n\n/**\n * Steps ease implementation https://developer.mozilla.org/fr/docs/Web/CSS/transition-timing-function\n * Only covers 'end' and 'start' jumpterms\n * @param  {Number} steps\n * @param  {Boolean} [fromStart]\n * @return {EasingFunction}\n */\nconst steps = (steps = 10, fromStart) => {\n  const roundMethod = fromStart ? ceil : floor;\n  return t => roundMethod(clamp(t, 0, 1) * steps) * (1 / steps);\n};\n\n/**\n * Without parameters, the linear function creates a non-eased transition.\n * Parameters, if used, creates a piecewise linear easing by interpolating linearly between the specified points.\n * @param  {...String|Number} [args] - Points\n * @return {EasingFunction}\n */\nconst linear = (...args) => {\n  const argsLength = args.length;\n  if (!argsLength) return none;\n  const totalPoints = argsLength - 1;\n  const firstArg = args[0];\n  const lastArg = args[totalPoints];\n  const xPoints = [0];\n  const yPoints = [parseNumber(firstArg)];\n  for (let i = 1; i < totalPoints; i++) {\n    const arg = args[i];\n    const splitValue = isStr(arg) ?\n    /** @type {String} */(arg).trim().split(' ') :\n    [arg];\n    const value = splitValue[0];\n    const percent = splitValue[1];\n    xPoints.push(!isUnd(percent) ? parseNumber(percent) / 100 : i / totalPoints);\n    yPoints.push(parseNumber(value));\n  }\n  yPoints.push(parseNumber(lastArg));\n  xPoints.push(1);\n  return function easeLinear(t) {\n    for (let i = 1, l = xPoints.length; i < l; i++) {\n      const currentX = xPoints[i];\n      if (t <= currentX) {\n        const prevX = xPoints[i - 1];\n        const prevY = yPoints[i - 1];\n        return prevY + (yPoints[i] - prevY) * (t - prevX) / (currentX - prevX);\n      }\n    }\n    return yPoints[yPoints.length - 1];\n  }\n};\n\n/**\n * Generate random steps\n * @param  {Number} [length] - The number of steps\n * @param  {Number} [randomness] - How strong the randomness is\n * @return {EasingFunction}\n */\nconst irregular = (length = 10, randomness = 1) => {\n  const values = [0];\n  const total = length - 1;\n  for (let i = 1; i < total; i++) {\n    const previousValue = values[i - 1];\n    const spacing = i / total;\n    const segmentEnd = (i + 1) / total;\n    const randomVariation = spacing + (segmentEnd - spacing) * Math.random();\n    // Mix the even spacing and random variation based on the randomness parameter\n    const randomValue = spacing * (1 - randomness) + randomVariation * randomness;\n    values.push(clamp(randomValue, previousValue, 1));\n  }\n  values.push(1);\n  return linear(...values);\n};\n\n// Easing functions adapted from http://www.robertpenner.com/ease  Robert Penner\n\n/**\n * @callback PowerEasing\n * @param {Number|String} [power=1.675]\n * @return {EasingFunction}\n */\n\n/**\n * @callback BackEasing\n * @param {Number|String} [overshoot=1.70158]\n * @return {EasingFunction}\n */\n\n/**\n * @callback ElasticEasing\n * @param {Number|String} [amplitude=1]\n * @param {Number|String} [period=.3]\n * @return {EasingFunction}\n */\n\n/**\n * @callback EaseFactory\n * @param {Number|String} [paramA]\n * @param {Number|String} [paramB]\n * @return {EasingFunction|Number}\n */\n\n/** @typedef {PowerEasing|BackEasing|ElasticEasing} EasesFactory */\n\nconst halfPI = PI / 2;\nconst doublePI = PI * 2;\n/** @type {PowerEasing} */\nconst easeInPower = (p = 1.68) => t => pow(t, +p);\n\n/** @type {Record<String, EasesFactory|EasingFunction>} */\nconst easeInFunctions = {\n  [emptyString]: easeInPower,\n  Quad: easeInPower(2),\n  Cubic: easeInPower(3),\n  Quart: easeInPower(4),\n  Quint: easeInPower(5),\n  /** @type {EasingFunction} */\n  Sine: t => 1 - cos(t * halfPI),\n  /** @type {EasingFunction} */\n  Circ: t => 1 - sqrt(1 - t * t),\n  /** @type {EasingFunction} */\n  Expo: t => t ? pow(2, 10 * t - 10) : 0,\n  /** @type {EasingFunction} */\n  Bounce: t => {\n    let pow2, b = 4;\n    while (t < ((pow2 = pow(2, --b)) - 1) / 11);\n    return 1 / pow(4, 3 - b) - 7.5625 * pow((pow2 * 3 - 2) / 22 - t, 2);\n  },\n  /** @type {BackEasing} */\n  Back: (overshoot = 1.70158) => t => (+overshoot + 1) * t * t * t - +overshoot * t * t,\n  /** @type {ElasticEasing} */\n  Elastic: (amplitude = 1, period = .3) => {\n    const a = clamp(+amplitude, 1, 10);\n    const p = clamp(+period, minValue, 2);\n    const s = (p / doublePI) * asin(1 / a);\n    const e = doublePI / p;\n    return t => t === 0 || t === 1 ? t : -a * pow(2, -10 * (1 - t)) * sin(((1 - t) - s) * e);\n  }\n};\n\n/**\n * @callback EaseType\n * @param {EasingFunction} Ease\n * @return {EasingFunction}\n */\n\n/** @type {Record<String, EaseType>} */\nconst easeTypes = {\n  in: easeIn => t => easeIn(t),\n  out: easeIn => t => 1 - easeIn(1 - t),\n  inOut: easeIn => t => t < .5 ? easeIn(t * 2) / 2 : 1 - easeIn(t * -2 + 2) / 2,\n  outIn: easeIn => t => t < .5 ? (1 - easeIn(1 - t * 2)) / 2 : (easeIn(t * 2 - 1) + 1) / 2,\n};\n\n/**\n * @param  {String} string\n * @param  {Record<String, EasesFactory|EasingFunction>} easesFunctions\n * @param  {Object} easesLookups\n * @return {EasingFunction}\n */\nconst parseEaseString = (string, easesFunctions, easesLookups) => {\n  if (easesLookups[string]) return easesLookups[string];\n  if (string.indexOf('(') <= -1) {\n    const hasParams = easeTypes[string] || string.includes('Back') || string.includes('Elastic');\n    const parsedFn = /** @type {EasingFunction} */(hasParams ? /** @type {EasesFactory} */(easesFunctions[string])() : easesFunctions[string]);\n    return parsedFn ? easesLookups[string] = parsedFn : none;\n  } else {\n    const split = string.slice(0, -1).split('(');\n    const parsedFn = /** @type {EasesFactory} */(easesFunctions[split[0]]);\n    return parsedFn ? easesLookups[string] = parsedFn(...split[1].split(',')) : none;\n  }\n};\n\n/**\n * @typedef  {Object} EasesFunctions\n * @property {typeof linear} linear\n * @property {typeof irregular} irregular\n * @property {typeof steps} steps\n * @property {typeof cubicBezier} cubicBezier\n * @property {PowerEasing} in\n * @property {PowerEasing} out\n * @property {PowerEasing} inOut\n * @property {PowerEasing} outIn\n * @property {EasingFunction} inQuad\n * @property {EasingFunction} outQuad\n * @property {EasingFunction} inOutQuad\n * @property {EasingFunction} outInQuad\n * @property {EasingFunction} inCubic\n * @property {EasingFunction} outCubic\n * @property {EasingFunction} inOutCubic\n * @property {EasingFunction} outInCubic\n * @property {EasingFunction} inQuart\n * @property {EasingFunction} outQuart\n * @property {EasingFunction} inOutQuart\n * @property {EasingFunction} outInQuart\n * @property {EasingFunction} inQuint\n * @property {EasingFunction} outQuint\n * @property {EasingFunction} inOutQuint\n * @property {EasingFunction} outInQuint\n * @property {EasingFunction} inSine\n * @property {EasingFunction} outSine\n * @property {EasingFunction} inOutSine\n * @property {EasingFunction} outInSine\n * @property {EasingFunction} inCirc\n * @property {EasingFunction} outCirc\n * @property {EasingFunction} inOutCirc\n * @property {EasingFunction} outInCirc\n * @property {EasingFunction} inExpo\n * @property {EasingFunction} outExpo\n * @property {EasingFunction} inOutExpo\n * @property {EasingFunction} outInExpo\n * @property {EasingFunction} inBounce\n * @property {EasingFunction} outBounce\n * @property {EasingFunction} inOutBounce\n * @property {EasingFunction} outInBounce\n * @property {BackEasing} inBack\n * @property {BackEasing} outBack\n * @property {BackEasing} inOutBack\n * @property {BackEasing} outInBack\n * @property {ElasticEasing} inElastic\n * @property {ElasticEasing} outElastic\n * @property {ElasticEasing} inOutElastic\n * @property {ElasticEasing} outInElastic\n */\n\nconst eases = (/*#__PURE__*/ (() => {\n  const list = { linear, irregular, steps, cubicBezier };\n  for (let type in easeTypes) {\n    for (let name in easeInFunctions) {\n      const easeIn = easeInFunctions[name];\n      const easeType = easeTypes[type];\n      list[type + name] = /** @type {EasesFactory|EasingFunction} */(\n        name === emptyString || name === 'Back' || name === 'Elastic' ?\n        (a, b) => easeType(/** @type {EasesFactory} */(easeIn)(a, b)) :\n        easeType(/** @type {EasingFunction} */(easeIn))\n      );\n    }\n  }\n  return /** @type {EasesFunctions} */(list);\n})());\n\n/** @type {Record<String, EasingFunction>} */\nconst JSEasesLookups = { linear: none };\n\n/**\n * @param  {EasingParam} ease\n * @return {EasingFunction}\n */\nconst parseEasings = ease => isFnc(ease) ? ease :\n  isStr(ease) ? parseEaseString(/** @type {String} */(ease), eases, JSEasesLookups) :\n  none;\n\n\n\n\nconst propertyNamesCache = {};\n\n/**\n * @param  {String} propertyName\n * @param  {Target} target\n * @param  {tweenTypes} tweenType\n * @return {String}\n */\nconst sanitizePropertyName = (propertyName, target, tweenType) => {\n  if (tweenType === tweenTypes.TRANSFORM) {\n    const t = shortTransforms.get(propertyName);\n    return t ? t : propertyName;\n  } else if (\n    tweenType === tweenTypes.CSS ||\n    // Handle special cases where properties like \"strokeDashoffset\" needs to be set as \"stroke-dashoffset\"\n    // but properties like \"baseFrequency\" should stay in lowerCamelCase\n    (tweenType === tweenTypes.ATTRIBUTE && (isSvg(target) && propertyName in /** @type {DOMTarget} */(target).style))\n  ) {\n    const cachedPropertyName = propertyNamesCache[propertyName];\n    if (cachedPropertyName) {\n      return cachedPropertyName;\n    } else {\n      const lowerCaseName = propertyName ? toLowerCase(propertyName) : propertyName;\n      propertyNamesCache[propertyName] = lowerCaseName;\n      return lowerCaseName;\n    }\n  } else {\n    return propertyName;\n  }\n};\n\n\n\n\nconst angleUnitsMap = { 'deg': 1, 'rad': 180 / PI, 'turn': 360 };\nconst convertedValuesCache = {};\n\n/**\n * @param  {DOMTarget} el\n * @param  {TweenDecomposedValue} decomposedValue\n * @param  {String} unit\n * @param  {Boolean} [force]\n * @return {TweenDecomposedValue}\n */\nconst convertValueUnit = (el, decomposedValue, unit, force = false) => {\n  const currentUnit = decomposedValue.u;\n  const currentNumber = decomposedValue.n;\n  if (decomposedValue.t === valueTypes.UNIT && currentUnit === unit) { // TODO: Check if checking against the same unit string is necessary\n    return decomposedValue;\n  }\n  const cachedKey = currentNumber + currentUnit + unit;\n  const cached = convertedValuesCache[cachedKey];\n  if (!isUnd(cached) && !force) {\n    decomposedValue.n = cached;\n  } else {\n    let convertedValue;\n    if (currentUnit in angleUnitsMap) {\n      convertedValue = currentNumber * angleUnitsMap[currentUnit] / angleUnitsMap[unit];\n    } else {\n      const baseline = 100;\n      const tempEl = /** @type {DOMTarget} */(el.cloneNode());\n      const parentNode = el.parentNode;\n      const parentEl = (parentNode && (parentNode !== doc)) ? parentNode : doc.body;\n      parentEl.appendChild(tempEl);\n      const elStyle = tempEl.style;\n      elStyle.width = baseline + currentUnit;\n      const currentUnitWidth = /** @type {HTMLElement} */(tempEl).offsetWidth || baseline;\n      elStyle.width = baseline + unit;\n      const newUnitWidth = /** @type {HTMLElement} */(tempEl).offsetWidth || baseline;\n      const factor = currentUnitWidth / newUnitWidth;\n      parentEl.removeChild(tempEl);\n      convertedValue = factor * currentNumber;\n    }\n    decomposedValue.n = convertedValue;\n    convertedValuesCache[cachedKey] = convertedValue;\n  }\n  decomposedValue.t === valueTypes.UNIT;\n  decomposedValue.u = unit;\n  return decomposedValue;\n};\n\n\n\n\n/**\n * @template {Renderable} T\n * @param {T} renderable\n * @return {T}\n */\nconst cleanInlineStyles = renderable => {\n  // Allow cleanInlineStyles() to be called on timelines\n  if (renderable._hasChildren) {\n    forEachChildren(renderable, cleanInlineStyles, true);\n  } else {\n    const animation = /** @type {JSAnimation} */(renderable);\n    animation.pause();\n    forEachChildren(animation, (/** @type {Tween} */tween) => {\n      const tweenProperty = tween.property;\n      const tweenTarget = tween.target;\n      if (tweenTarget[isDomSymbol]) {\n        const targetStyle = /** @type {DOMTarget} */(tweenTarget).style;\n        const originalInlinedValue = animation._inlineStyles[tweenProperty];\n        if (tween._tweenType === tweenTypes.TRANSFORM) {\n          const cachedTransforms = tweenTarget[transformsSymbol];\n          if (isUnd(originalInlinedValue) || originalInlinedValue === emptyString) {\n            delete cachedTransforms[tweenProperty];\n          } else {\n            cachedTransforms[tweenProperty] = originalInlinedValue;\n          }\n          if (tween._renderTransforms) {\n            if (!Object.keys(cachedTransforms).length) {\n              targetStyle.removeProperty('transform');\n            } else {\n              let str = emptyString;\n              for (let key in cachedTransforms) {\n                str += transformsFragmentStrings[key] + cachedTransforms[key] + ') ';\n              }\n              targetStyle.transform = str;\n            }\n          }\n        } else {\n          if (isUnd(originalInlinedValue) || originalInlinedValue === emptyString) {\n            targetStyle.removeProperty(tweenProperty);\n          } else {\n            targetStyle[tweenProperty] = originalInlinedValue;\n          }\n        }\n        if (animation._tail === tween) {\n          animation.targets.forEach(t => {\n            if (t.getAttribute && t.getAttribute('style') === emptyString) {\n              t.removeAttribute('style');\n            }          });\n        }\n      }\n    });\n  }\n  return renderable;\n};\n\n// Defines decomposed values target objects only once and mutate their properties later to avoid GC\n// TODO: Maybe move the objects creation to values.js and use the decompose function to create the base object\nconst fromTargetObject = createDecomposedValueTargetObject();\nconst toTargetObject = createDecomposedValueTargetObject();\nconst toFunctionStore = { func: null };\nconst keyframesTargetArray = [null];\nconst fastSetValuesArray = [null, null];\n/** @type {TweenKeyValue} */\nconst keyObjectTarget = { to: null };\n\nlet tweenId = 0;\nlet keyframes;\n/** @type {TweenParamsOptions & TweenValues} */\nlet key;\n\n/**\n * @param {DurationKeyframes | PercentageKeyframes} keyframes\n * @param {AnimationParams} parameters\n * @return {AnimationParams}\n */\nconst generateKeyframes = (keyframes, parameters) => {\n  /** @type {AnimationParams} */\n  const properties = {};\n  if (isArr(keyframes)) {\n    const propertyNames = [].concat(.../** @type {DurationKeyframes} */(keyframes).map(key => Object.keys(key))).filter(isKey);\n    for (let i = 0, l = propertyNames.length; i < l; i++) {\n      const propName = propertyNames[i];\n      const propArray = /** @type {DurationKeyframes} */(keyframes).map(key => {\n        /** @type {TweenKeyValue} */\n        const newKey = {};\n        for (let p in key) {\n          const keyValue = /** @type {TweenPropValue} */(key[p]);\n          if (isKey(p)) {\n            if (p === propName) {\n              newKey.to = keyValue;\n            }\n          } else {\n            newKey[p] = keyValue;\n          }\n        }\n        return newKey;\n      });\n      properties[propName] = /** @type {ArraySyntaxValue} */(propArray);\n    }\n\n  } else {\n    const totalDuration = /** @type {Number} */(setValue(parameters.duration, globals.defaults.duration));\n    const keys = Object.keys(keyframes)\n    .map(key => { return {o: parseFloat(key) / 100, p: keyframes[key]} })\n    .sort((a, b) => a.o - b.o);\n    keys.forEach(key => {\n      const offset = key.o;\n      const prop = key.p;\n      for (let name in prop) {\n        if (isKey(name)) {\n          let propArray = /** @type {Array} */(properties[name]);\n          if (!propArray) propArray = properties[name] = [];\n          const duration = offset * totalDuration;\n          let length = propArray.length;\n          let prevKey = propArray[length - 1];\n          const keyObj = { to: prop[name] };\n          let durProgress = 0;\n          for (let i = 0; i < length; i++) {\n            durProgress += propArray[i].duration;\n          }\n          if (length === 1) {\n            keyObj.from = prevKey.to;\n          }\n          if (prop.ease) {\n            keyObj.ease = prop.ease;\n          }\n          keyObj.duration = duration - (length ? durProgress : 0);\n          propArray.push(keyObj);\n        }\n      }\n      return key;\n    });\n\n    for (let name in properties) {\n      const propArray = /** @type {Array} */(properties[name]);\n      let prevEase;\n      // let durProgress = 0\n      for (let i = 0, l = propArray.length; i < l; i++) {\n        const prop = propArray[i];\n        // Emulate WAPPI easing parameter position\n        const currentEase = prop.ease;\n        prop.ease = prevEase ? prevEase : undefined;\n        prevEase = currentEase;\n        // durProgress += prop.duration;\n        // if (i === l - 1 && durProgress !== totalDuration) {\n        //   propArray.push({ from: prop.to, ease: prop.ease, duration: totalDuration - durProgress })\n        // }\n      }\n      if (!propArray[0].duration) {\n        propArray.shift();\n      }\n    }\n\n  }\n\n  return properties;\n};\n\nclass JSAnimation extends Timer {\n  /**\n   * @param {TargetsParam} targets\n   * @param {AnimationParams} parameters\n   * @param {Timeline} [parent]\n   * @param {Number} [parentPosition]\n   * @param {Boolean} [fastSet=false]\n   * @param {Number} [index=0]\n   * @param {Number} [length=0]\n   */\n  constructor(\n    targets,\n    parameters,\n    parent,\n    parentPosition,\n    fastSet = false,\n    index = 0,\n    length = 0\n  ) {\n\n    super(/** @type {TimerParams&AnimationParams} */(parameters), parent, parentPosition);\n\n    const parsedTargets = registerTargets(targets);\n    const targetsLength = parsedTargets.length;\n\n    // If the parameters object contains a \"keyframes\" property, convert all the keyframes values to regular properties\n\n    const kfParams = /** @type {AnimationParams} */(parameters).keyframes;\n    const params = /** @type {AnimationParams} */(kfParams ? mergeObjects(generateKeyframes(/** @type {DurationKeyframes} */(kfParams), parameters), parameters) : parameters);\n\n    const {\n      delay,\n      duration,\n      ease,\n      playbackEase,\n      modifier,\n      composition,\n      onRender,\n    } = params;\n\n    const animDefaults = parent ? parent.defaults : globals.defaults;\n    const animaPlaybackEase = setValue(playbackEase, animDefaults.playbackEase);\n    const animEase = animaPlaybackEase ? parseEasings(animaPlaybackEase) : null;\n    const hasSpring = !isUnd(ease) && !isUnd(/** @type {Spring} */(ease).ease);\n    const tEasing = hasSpring ? /** @type {Spring} */(ease).ease : setValue(ease, animEase ? 'linear' : animDefaults.ease);\n    const tDuration = hasSpring ? /** @type {Spring} */(ease).duration : setValue(duration, animDefaults.duration);\n    const tDelay = setValue(delay, animDefaults.delay);\n    const tModifier = modifier || animDefaults.modifier;\n    // If no composition is defined and the targets length is high (>= 1000) set the composition to 'none' (0) for faster tween creation\n    const tComposition = isUnd(composition) && targetsLength >= K ? compositionTypes.none : !isUnd(composition) ? composition : animDefaults.composition;\n    // TODO: Do not create an empty object until we know the animation will generate inline styles\n    const animInlineStyles = {};\n    // const absoluteOffsetTime = this._offset;\n    const absoluteOffsetTime = this._offset + (parent ? parent._offset : 0);\n\n    let iterationDuration = NaN;\n    let iterationDelay = NaN;\n    let animationAnimationLength = 0;\n    let shouldTriggerRender = 0;\n\n    for (let targetIndex = 0; targetIndex < targetsLength; targetIndex++) {\n\n      const target = parsedTargets[targetIndex];\n      const ti = index || targetIndex;\n      const tl = length || targetsLength;\n\n      let lastTransformGroupIndex = NaN;\n      let lastTransformGroupLength = NaN;\n\n      for (let p in params) {\n\n        if (isKey(p)) {\n\n          const tweenType = getTweenType(target, p);\n\n          const propName = sanitizePropertyName(p, target, tweenType);\n\n          let propValue = params[p];\n\n          const isPropValueArray = isArr(propValue);\n\n          if (fastSet && !isPropValueArray) {\n            fastSetValuesArray[0] = propValue;\n            fastSetValuesArray[1] = propValue;\n            propValue = fastSetValuesArray;\n          }\n\n          // TODO: Allow nested keyframes inside ObjectValue value (prop: { to: [.5, 1, .75, 2, 3] })\n          // Normalize property values to valid keyframe syntax:\n          // [x, y] to [{to: [x, y]}] or {to: x} to [{to: x}] or keep keys syntax [{}, {}, {}...]\n          // const keyframes = isArr(propValue) ? propValue.length === 2 && !isObj(propValue[0]) ? [{ to: propValue }] : propValue : [propValue];\n          if (isPropValueArray) {\n            const arrayLength = /** @type {Array} */(propValue).length;\n            const isNotObjectValue = !isObj(propValue[0]);\n            // Convert [x, y] to [{to: [x, y]}]\n            if (arrayLength === 2 && isNotObjectValue) {\n              keyObjectTarget.to = /** @type {TweenParamValue} */(/** @type {unknown} */(propValue));\n              keyframesTargetArray[0] = keyObjectTarget;\n              keyframes = keyframesTargetArray;\n            // Convert [x, y, z] to [[x, y], z]\n            } else if (arrayLength > 2 && isNotObjectValue) {\n              keyframes = [];\n              /** @type {Array.<Number>} */(propValue).forEach((v, i) => {\n                if (!i) {\n                  fastSetValuesArray[0] = v;\n                } else if (i === 1) {\n                  fastSetValuesArray[1] = v;\n                  keyframes.push(fastSetValuesArray);\n                } else {\n                  keyframes.push(v);\n                }\n              });\n            } else {\n              keyframes = /** @type {Array.<TweenKeyValue>} */(propValue);\n            }\n          } else {\n            keyframesTargetArray[0] = propValue;\n            keyframes = keyframesTargetArray;\n          }\n\n          let siblings = null;\n          let prevTween = null;\n          let firstTweenChangeStartTime = NaN;\n          let lastTweenChangeEndTime = 0;\n          let tweenIndex = 0;\n\n          for (let l = keyframes.length; tweenIndex < l; tweenIndex++) {\n\n            const keyframe = keyframes[tweenIndex];\n\n            if (isObj(keyframe)) {\n              key = keyframe;\n            } else {\n              keyObjectTarget.to = /** @type {TweenParamValue} */(keyframe);\n              key = keyObjectTarget;\n            }\n\n            toFunctionStore.func = null;\n\n            const computedToValue = getFunctionValue(key.to, target, ti, tl, toFunctionStore);\n\n            let tweenToValue;\n            // Allows function based values to return an object syntax value ({to: v})\n            if (isObj(computedToValue) && !isUnd(computedToValue.to)) {\n              key = computedToValue;\n              tweenToValue = computedToValue.to;\n            } else {\n              tweenToValue = computedToValue;\n            }\n            const tweenFromValue = getFunctionValue(key.from, target, ti, tl);\n            const keyEasing = key.ease;\n            const hasSpring = !isUnd(keyEasing) && !isUnd(/** @type {Spring} */(keyEasing).ease);\n            // Easing are treated differently and don't accept function based value to prevent having to pass a function wrapper that returns an other function all the time\n            const tweenEasing = hasSpring ? /** @type {Spring} */(keyEasing).ease : keyEasing || tEasing;\n            // Calculate default individual keyframe duration by dividing the tl of keyframes\n            const tweenDuration = hasSpring ? /** @type {Spring} */(keyEasing).duration : getFunctionValue(setValue(key.duration, (l > 1 ? getFunctionValue(tDuration, target, ti, tl) / l : tDuration)), target, ti, tl);\n            // Default delay value should only be applied to the first tween\n            const tweenDelay = getFunctionValue(setValue(key.delay, (!tweenIndex ? tDelay : 0)), target, ti, tl);\n            const computedComposition = getFunctionValue(setValue(key.composition, tComposition), target, ti, tl);\n            const tweenComposition = isNum(computedComposition) ? computedComposition : compositionTypes[computedComposition];\n            // Modifiers are treated differently and don't accept function based value to prevent having to pass a function wrapper\n            const tweenModifier = key.modifier || tModifier;\n            const hasFromvalue = !isUnd(tweenFromValue);\n            const hasToValue = !isUnd(tweenToValue);\n            const isFromToArray = isArr(tweenToValue);\n            const isFromToValue = isFromToArray || (hasFromvalue && hasToValue);\n            const tweenStartTime = prevTween ? lastTweenChangeEndTime + tweenDelay : tweenDelay;\n            const absoluteStartTime = absoluteOffsetTime + tweenStartTime;\n\n            // Force a onRender callback if the animation contains at least one from value and autoplay is set to false\n            if (!shouldTriggerRender && (hasFromvalue || isFromToArray)) shouldTriggerRender = 1;\n\n            let prevSibling = prevTween;\n\n            if (tweenComposition !== compositionTypes.none) {\n              if (!siblings) siblings = getTweenSiblings(target, propName);\n              let nextSibling = siblings._head;\n              // Iterate trough all the next siblings until we find a sibling with an equal or inferior start time\n              while (nextSibling && !nextSibling._isOverridden && nextSibling._absoluteStartTime <= absoluteStartTime) {\n                prevSibling = nextSibling;\n                nextSibling = nextSibling._nextRep;\n                // Overrides all the next siblings if the next sibling starts at the same time of after as the new tween start time\n                if (nextSibling && nextSibling._absoluteStartTime >= absoluteStartTime) {\n                  while (nextSibling) {\n                    overrideTween(nextSibling);\n                    // This will ends both the current while loop and the upper one once all the next sibllings have been overriden\n                    nextSibling = nextSibling._nextRep;\n                  }\n                }\n              }\n            }\n\n            // Decompose values\n            if (isFromToValue) {\n              decomposeRawValue(isFromToArray ? getFunctionValue(tweenToValue[0], target, ti, tl) : tweenFromValue, fromTargetObject);\n              decomposeRawValue(isFromToArray ? getFunctionValue(tweenToValue[1], target, ti, tl, toFunctionStore) : tweenToValue, toTargetObject);\n              if (fromTargetObject.t === valueTypes.NUMBER) {\n                if (prevSibling) {\n                  if (prevSibling._valueType === valueTypes.UNIT) {\n                    fromTargetObject.t = valueTypes.UNIT;\n                    fromTargetObject.u = prevSibling._unit;\n                  }\n                } else {\n                  decomposeRawValue(\n                    getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles),\n                    decomposedOriginalValue\n                  );\n                  if (decomposedOriginalValue.t === valueTypes.UNIT) {\n                    fromTargetObject.t = valueTypes.UNIT;\n                    fromTargetObject.u = decomposedOriginalValue.u;\n                  }\n                }\n              }\n            } else {\n              if (hasToValue) {\n                decomposeRawValue(tweenToValue, toTargetObject);\n              } else {\n                if (prevTween) {\n                  decomposeTweenValue(prevTween, toTargetObject);\n                } else {\n                  // No need to get and parse the original value if the tween is part of a timeline and has a previous sibling part of the same timeline\n                  decomposeRawValue(parent && prevSibling && prevSibling.parent.parent === parent ? prevSibling._value :\n                  getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles), toTargetObject);\n                }\n              }\n              if (hasFromvalue) {\n                decomposeRawValue(tweenFromValue, fromTargetObject);\n              } else {\n                if (prevTween) {\n                  decomposeTweenValue(prevTween, fromTargetObject);\n                } else {\n                  decomposeRawValue(parent && prevSibling && prevSibling.parent.parent === parent ? prevSibling._value :\n                  // No need to get and parse the original value if the tween is part of a timeline and has a previous sibling part of the same timeline\n                  getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles), fromTargetObject);\n                }\n              }\n            }\n\n            // Apply operators\n            if (fromTargetObject.o) {\n              fromTargetObject.n = getRelativeValue(\n                !prevSibling ? decomposeRawValue(\n                  getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles),\n                  decomposedOriginalValue\n                ).n : prevSibling._toNumber,\n                fromTargetObject.n,\n                fromTargetObject.o\n              );\n            }\n\n            if (toTargetObject.o) {\n              toTargetObject.n = getRelativeValue(fromTargetObject.n, toTargetObject.n, toTargetObject.o);\n            }\n\n            // Values omogenisation in cases of type difference between \"from\" and \"to\"\n            if (fromTargetObject.t !== toTargetObject.t) {\n              if (fromTargetObject.t === valueTypes.COMPLEX || toTargetObject.t === valueTypes.COMPLEX) {\n                const complexValue = fromTargetObject.t === valueTypes.COMPLEX ? fromTargetObject : toTargetObject;\n                const notComplexValue = fromTargetObject.t === valueTypes.COMPLEX ? toTargetObject : fromTargetObject;\n                notComplexValue.t = valueTypes.COMPLEX;\n                notComplexValue.s = cloneArray(complexValue.s);\n                notComplexValue.d = complexValue.d.map(() => notComplexValue.n);\n              } else if (fromTargetObject.t === valueTypes.UNIT || toTargetObject.t === valueTypes.UNIT) {\n                const unitValue = fromTargetObject.t === valueTypes.UNIT ? fromTargetObject : toTargetObject;\n                const notUnitValue = fromTargetObject.t === valueTypes.UNIT ? toTargetObject : fromTargetObject;\n                notUnitValue.t = valueTypes.UNIT;\n                notUnitValue.u = unitValue.u;\n              } else if (fromTargetObject.t === valueTypes.COLOR || toTargetObject.t === valueTypes.COLOR) {\n                const colorValue = fromTargetObject.t === valueTypes.COLOR ? fromTargetObject : toTargetObject;\n                const notColorValue = fromTargetObject.t === valueTypes.COLOR ? toTargetObject : fromTargetObject;\n                notColorValue.t = valueTypes.COLOR;\n                notColorValue.s = colorValue.s;\n                notColorValue.d = [0, 0, 0, 1];\n              }\n            }\n\n            // Unit conversion\n            if (fromTargetObject.u !== toTargetObject.u) {\n              let valueToConvert = toTargetObject.u ? fromTargetObject : toTargetObject;\n              valueToConvert = convertValueUnit(/** @type {DOMTarget} */(target), valueToConvert, toTargetObject.u ? toTargetObject.u : fromTargetObject.u, false);\n              // TODO:\n              // convertValueUnit(target, to.u ? from : to, to.u ? to.u : from.u);\n            }\n\n            // Fill in non existing complex values\n            if (toTargetObject.d && fromTargetObject.d && (toTargetObject.d.length !== fromTargetObject.d.length)) {\n              const longestValue = fromTargetObject.d.length > toTargetObject.d.length ? fromTargetObject : toTargetObject;\n              const shortestValue = longestValue === fromTargetObject ? toTargetObject : fromTargetObject;\n              // TODO: Check if n should be used instead of 0 for default complex values\n              shortestValue.d = longestValue.d.map((_, i) => isUnd(shortestValue.d[i]) ? 0 : shortestValue.d[i]);\n              shortestValue.s = cloneArray(longestValue.s);\n            }\n\n            // Tween factory\n\n            // Rounding is necessary here to minimize floating point errors\n            const tweenUpdateDuration = round(+tweenDuration || minValue, 12);\n\n            /** @type {Tween} */\n            const tween = {\n              parent: this,\n              id: tweenId++,\n              property: propName,\n              target: target,\n              _value: null,\n              _func: toFunctionStore.func,\n              _ease: parseEasings(tweenEasing),\n              _fromNumbers: cloneArray(fromTargetObject.d),\n              _toNumbers: cloneArray(toTargetObject.d),\n              _strings: cloneArray(toTargetObject.s),\n              _fromNumber: fromTargetObject.n,\n              _toNumber: toTargetObject.n,\n              _numbers: cloneArray(fromTargetObject.d), // For additive tween and animatables\n              _number: fromTargetObject.n, // For additive tween and animatables\n              _unit: toTargetObject.u,\n              _modifier: tweenModifier,\n              _currentTime: 0,\n              _startTime: tweenStartTime,\n              _delay: +tweenDelay,\n              _updateDuration: tweenUpdateDuration,\n              _changeDuration: tweenUpdateDuration,\n              _absoluteStartTime: absoluteStartTime,\n              // NOTE: Investigate bit packing to stores ENUM / BOOL\n              _tweenType: tweenType,\n              _valueType: toTargetObject.t,\n              _composition: tweenComposition,\n              _isOverlapped: 0,\n              _isOverridden: 0,\n              _renderTransforms: 0,\n              _prevRep: null, // For replaced tween\n              _nextRep: null, // For replaced tween\n              _prevAdd: null, // For additive tween\n              _nextAdd: null, // For additive tween\n              _prev: null,\n              _next: null,\n            };\n\n            if (tweenComposition !== compositionTypes.none) {\n              composeTween(tween, siblings);\n            }\n\n            if (isNaN(firstTweenChangeStartTime)) {\n              firstTweenChangeStartTime = tween._startTime;\n            }\n            // Rounding is necessary here to minimize floating point errors\n            lastTweenChangeEndTime = round(tweenStartTime + tweenUpdateDuration, 12);\n            prevTween = tween;\n            animationAnimationLength++;\n\n            addChild(this, tween);\n\n          }\n\n          // Update animation timings with the added tweens properties\n\n          if (isNaN(iterationDelay) || firstTweenChangeStartTime < iterationDelay) {\n            iterationDelay = firstTweenChangeStartTime;\n          }\n\n          if (isNaN(iterationDuration) || lastTweenChangeEndTime > iterationDuration) {\n            iterationDuration = lastTweenChangeEndTime;\n          }\n\n          // TODO: Find a way to inline tween._renderTransforms = 1 here\n          if (tweenType === tweenTypes.TRANSFORM) {\n            lastTransformGroupIndex = animationAnimationLength - tweenIndex;\n            lastTransformGroupLength = animationAnimationLength;\n          }\n\n        }\n\n      }\n\n      // Set _renderTransforms to last transform property to correctly render the transforms list\n      if (!isNaN(lastTransformGroupIndex)) {\n        let i = 0;\n        forEachChildren(this, (/** @type {Tween} */tween) => {\n          if (i >= lastTransformGroupIndex && i < lastTransformGroupLength) {\n            tween._renderTransforms = 1;\n            if (tween._composition === compositionTypes.blend) {\n              forEachChildren(additive.animation, (/** @type {Tween} */additiveTween) => {\n                if (additiveTween.id === tween.id) {\n                  additiveTween._renderTransforms = 1;\n                }\n              });\n            }\n          }\n          i++;\n        });\n      }\n\n    }\n\n    if (!targetsLength) {\n      console.warn(`No target found. Make sure the element you're trying to animate is accessible before creating your animation.`);\n    }\n\n    if (iterationDelay) {\n      forEachChildren(this, (/** @type {Tween} */tween) => {\n        // If (startTime - delay) equals 0, this means the tween is at the begining of the animation so we need to trim the delay too\n        if (!(tween._startTime - tween._delay)) {\n          tween._delay -= iterationDelay;\n        }\n        tween._startTime -= iterationDelay;\n      });\n      iterationDuration -= iterationDelay;\n    } else {\n      iterationDelay = 0;\n    }\n\n    // Prevents iterationDuration to be NaN if no valid animatable props have been provided\n    // Prevents _iterationCount to be NaN if no valid animatable props have been provided\n    if (!iterationDuration) {\n      iterationDuration = minValue;\n      this.iterationCount = 0;\n    }\n    /** @type {TargetsArray} */\n    this.targets = parsedTargets;\n    /** @type {Number} */\n    this.duration = iterationDuration === minValue ? minValue : clampInfinity(((iterationDuration + this._loopDelay) * this.iterationCount) - this._loopDelay) || minValue;\n    /** @type {Callback<this>} */\n    this.onRender = onRender || animDefaults.onRender;\n    /** @type {EasingFunction} */\n    this._ease = animEase;\n    /** @type {Number} */\n    this._delay = iterationDelay;\n    // NOTE: I'm keeping delay values separated from offsets in timelines because delays can override previous tweens and it could be confusing to debug a timeline with overridden tweens and no associated visible delays.\n    // this._delay = parent ? 0 : iterationDelay;\n    // this._offset += parent ? iterationDelay : 0;\n    /** @type {Number} */\n    this.iterationDuration = iterationDuration;\n    /** @type {{}} */\n    this._inlineStyles = animInlineStyles;\n\n    if (!this._autoplay && shouldTriggerRender) this.onRender(this);\n  }\n\n  /**\n   * @param  {Number} newDuration\n   * @return {this}\n   */\n  stretch(newDuration) {\n    const currentDuration = this.duration;\n    if (currentDuration === normalizeTime(newDuration)) return this;\n    const timeScale = newDuration / currentDuration;\n    // NOTE: Find a better way to handle the stretch of an animation after stretch = 0\n    forEachChildren(this, (/** @type {Tween} */tween) => {\n      // Rounding is necessary here to minimize floating point errors\n      tween._updateDuration = normalizeTime(tween._updateDuration * timeScale);\n      tween._changeDuration = normalizeTime(tween._changeDuration * timeScale);\n      tween._currentTime *= timeScale;\n      tween._startTime *= timeScale;\n      tween._absoluteStartTime *= timeScale;\n    });\n    return super.stretch(newDuration);\n  }\n\n  /**\n   * @return {this}\n   */\n  refresh() {\n    forEachChildren(this, (/** @type {Tween} */tween) => {\n      const ogValue = getOriginalAnimatableValue(tween.target, tween.property, tween._tweenType);\n      decomposeRawValue(ogValue, decomposedOriginalValue);\n      tween._fromNumbers = cloneArray(decomposedOriginalValue.d);\n      tween._fromNumber = decomposedOriginalValue.n;\n      if (tween._func) {\n        decomposeRawValue(tween._func(), toTargetObject);\n        tween._toNumbers = cloneArray(toTargetObject.d);\n        tween._strings = cloneArray(toTargetObject.s);\n        tween._toNumber = toTargetObject.n;\n      }\n    });\n    return this;\n  }\n\n  /**\n   * Cancel the animation and revert all the values affected by this animation to their original state\n   * @return {this}\n   */\n  revert() {\n    super.revert();\n    return cleanInlineStyles(this);\n  }\n\n  /**\n   * @param  {Callback<this>} [callback]\n   * @return {Promise}\n   */\n  then(callback) {\n    return super.then(callback);\n  }\n\n}\n\n/**\n * @param {TargetsParam} targets\n * @param {AnimationParams} parameters\n * @return {JSAnimation}\n */\nconst animate = (targets, parameters) => new JSAnimation(targets, parameters, null, 0, false).init();\n\n\n\n\n/**\n * Converts an easing function into a valid CSS linear() timing function string\n * @param {EasingFunction} fn\n * @param {number} [samples=100]\n * @returns {string} CSS linear() timing function\n */\nconst easingToLinear = (fn, samples = 100) => {\n  const points = [];\n  for (let i = 0; i <= samples; i++) points.push(fn(i / samples));\n  return `linear(${points.join(', ')})`;\n};\n\nconst WAAPIEasesLookups = {\n  in: 'ease-in',\n  out: 'ease-out',\n  inOut: 'ease-in-out',\n};\n\nconst WAAPIeases = /*#__PURE__*/(() => {\n  const list = {};\n  for (let type in easeTypes) list[type] = a => easeTypes[type](easeInPower(a));\n  return /** @type {Record<String, EasingFunction>} */(list);\n})();\n\n/**\n * @param  {EasingParam} ease\n * @return {String}\n */\nconst parseWAAPIEasing = (ease) => {\n  let parsedEase = WAAPIEasesLookups[ease];\n  if (parsedEase) return parsedEase;\n  parsedEase = 'linear';\n  if (isStr(ease)) {\n    if (\n      stringStartsWith(ease, 'linear') ||\n      stringStartsWith(ease, 'cubic-') ||\n      stringStartsWith(ease, 'steps') ||\n      stringStartsWith(ease, 'ease')\n    ) {\n      parsedEase = ease;\n    } else if (stringStartsWith(ease, 'cubicB')) {\n      parsedEase = toLowerCase(ease);\n    } else {\n      const parsed = parseEaseString(ease, WAAPIeases, WAAPIEasesLookups);\n      if (isFnc(parsed)) parsedEase = parsed === none ? 'linear' : easingToLinear(parsed);\n    }\n    WAAPIEasesLookups[ease] = parsedEase;\n  } else if (isFnc(ease)) {\n    const easing = easingToLinear(ease);\n    if (easing) parsedEase = easing;\n  } else if (/** @type {Spring} */(ease).ease) {\n    parsedEase = easingToLinear(/** @type {Spring} */(ease).ease);\n  }\n  return parsedEase;\n};\n\n/**\n * @typedef {String|Number|Array<String>|Array<Number>} WAAPITweenValue\n */\n\n/**\n * @callback WAAPIFunctionvalue\n * @param {DOMTarget} target - The animated target\n * @param {Number} index - The target index\n * @param {Number} length - The total number of animated targets\n * @return {WAAPITweenValue}\n */\n\n/**\n * @typedef {WAAPITweenValue|WAAPIFunctionvalue|Array<String|Number|WAAPIFunctionvalue>} WAAPIKeyframeValue\n */\n\n/**\n * @typedef {(animation: WAAPIAnimation) => void} WAAPICallback\n */\n\n/**\n * @typedef {Object} WAAPITweenOptions\n * @property {WAAPIKeyframeValue} [to]\n * @property {WAAPIKeyframeValue} [from]\n * @property {Number|WAAPIFunctionvalue} [duration]\n * @property {Number|WAAPIFunctionvalue} [delay]\n * @property {EasingParam} [ease]\n * @property {CompositeOperation} [composition]\n */\n\n/**\n * @typedef {Object} WAAPIAnimationOptions\n * @property {Number|Boolean} [loop]\n * @property {Boolean} [Reversed]\n * @property {Boolean} [Alternate]\n * @property {Boolean|ScrollObserver} [autoplay]\n * @property {Number} [playbackRate]\n * @property {Number|WAAPIFunctionvalue} [duration]\n * @property {Number|WAAPIFunctionvalue} [delay]\n * @property {EasingParam} [ease]\n * @property {CompositeOperation} [composition]\n * @property {WAAPICallback} [onComplete]\n */\n\n/**\n * @typedef {Record<String, WAAPIKeyframeValue | WAAPIAnimationOptions | Boolean | ScrollObserver | WAAPICallback | EasingParam | WAAPITweenOptions> & WAAPIAnimationOptions} WAAPIAnimationParams\n */\n\nconst transformsShorthands = ['x', 'y', 'z'];\nconst commonDefaultPXProperties = [\n  'perspective',\n  'width',\n  'height',\n  'margin',\n  'padding',\n  'top',\n  'right',\n  'bottom',\n  'left',\n  'borderWidth',\n  'fontSize',\n  'borderRadius',\n  ...transformsShorthands\n];\n\nconst validIndividualTransforms = [...transformsShorthands, ...validTransforms.filter(t => ['X', 'Y', 'Z'].some(axis => t.endsWith(axis)))];\n\n// Setting it to true in case CSS.registerProperty is not supported will automatically skip the registration and fallback to no animation\nlet transformsPropertiesRegistered = isBrowser && (isUnd(CSS) || !Object.hasOwnProperty.call(CSS, 'registerProperty'));\n\nconst registerTransformsProperties = () => {\n  if (transformsPropertiesRegistered) return;\n  validTransforms.forEach(t => {\n    const isSkew = stringStartsWith(t, 'skew');\n    const isScale = stringStartsWith(t, 'scale');\n    const isRotate = stringStartsWith(t, 'rotate');\n    const isTranslate = stringStartsWith(t, 'translate');\n    const isAngle = isRotate || isSkew;\n    const syntax = isAngle ? '<angle>' : isScale ? \"<number>\" : isTranslate ? \"<length-percentage>\" : \"*\";\n    try {\n      CSS.registerProperty({\n        name: '--' + t,\n        syntax,\n        inherits: false,\n        initialValue: isTranslate ? '0px' : isAngle ? '0deg' : isScale ? '1' : '0',\n      });\n    } catch {}  });\n  transformsPropertiesRegistered = true;\n};\n\nconst WAAPIAnimationsLookups = {\n  _head: null,\n  _tail: null,\n};\n\n/**\n * @param {DOMTarget} $el\n * @param {String} [property]\n * @param {WAAPIAnimation} [parent]\n */\nconst removeWAAPIAnimation = ($el, property, parent) => {\n  let nextLookup = WAAPIAnimationsLookups._head;\n  while (nextLookup) {\n    const next = nextLookup._next;\n    const matchTarget = nextLookup.$el === $el;\n    const matchProperty = !property || nextLookup.property === property;\n    const matchParent = !parent || nextLookup.parent === parent;\n    if (matchTarget && matchProperty && matchParent) {\n      const anim = nextLookup.animation;\n      try { anim.commitStyles(); } catch {}      anim.cancel();\n      removeChild(WAAPIAnimationsLookups, nextLookup);\n      const lookupParent = nextLookup.parent;\n      if (lookupParent) {\n        lookupParent._completed++;\n        if (lookupParent.animations.length === lookupParent._completed) {\n          lookupParent.completed = true;\n          if (!lookupParent.muteCallbacks) {\n            lookupParent.paused = true;\n            lookupParent.onComplete(lookupParent);\n            lookupParent._resolve(lookupParent);\n          }\n        }\n      }\n    }\n    nextLookup = next;\n  }\n};\n\n/**\n * @param {WAAPIAnimation} parent\n * @param {DOMTarget} $el\n * @param {String} property\n * @param {PropertyIndexedKeyframes} keyframes\n * @param {KeyframeAnimationOptions} params\n * @retun {Animation}\n */\nconst addWAAPIAnimation = (parent, $el, property, keyframes, params) => {\n  const animation = $el.animate(keyframes, params);\n  const animTotalDuration = params.delay + (+params.duration * params.iterations);\n  animation.playbackRate = parent._speed;\n  if (parent.paused) animation.pause();\n  if (parent.duration < animTotalDuration) {\n    parent.duration = animTotalDuration;\n    parent.controlAnimation = animation;\n  }\n  parent.animations.push(animation);\n  removeWAAPIAnimation($el, property);\n  addChild(WAAPIAnimationsLookups, { parent, animation, $el, property, _next: null, _prev: null });\n  const handleRemove = () => { removeWAAPIAnimation($el, property, parent); };\n  animation.onremove = handleRemove;\n  animation.onfinish = handleRemove;\n  return animation;\n};\n\n/**\n * @param  {String} propName\n * @param  {WAAPIKeyframeValue} value\n * @param  {DOMTarget} $el\n * @param  {Number} i\n * @param  {Number} targetsLength\n * @return {String}\n */\nconst normalizeTweenValue = (propName, value, $el, i, targetsLength) => {\n  let v = getFunctionValue(/** @type {any} */(value), $el, i, targetsLength);\n  if (!isNum(v)) return v;\n  if (commonDefaultPXProperties.includes(propName) || stringStartsWith(propName, 'translate')) return `${v}px`;\n  if (stringStartsWith(propName, 'rotate') || stringStartsWith(propName, 'skew')) return `${v}deg`;\n  return `${v}`;\n};\n\n/**\n * @param  {DOMTarget} $el\n * @param  {String} propName\n * @param  {WAAPIKeyframeValue} from\n * @param  {WAAPIKeyframeValue} to\n * @param  {Number} i\n * @param  {Number} targetsLength\n * @return {WAAPITweenValue}\n */\nconst parseIndividualTweenValue = ($el, propName, from, to, i, targetsLength) => {\n  /** @type {WAAPITweenValue} */\n  let tweenValue = '0';\n  const computedTo = !isUnd(to) ? normalizeTweenValue(propName, to, $el, i, targetsLength) : getComputedStyle($el)[propName];\n  if (!isUnd(from)) {\n    const computedFrom = normalizeTweenValue(propName, from, $el, i, targetsLength);\n    tweenValue = [computedFrom, computedTo];\n  } else {\n    tweenValue = isArr(to) ? to.map((/** @type {any} */v) => normalizeTweenValue(propName, v, $el, i, targetsLength)) : computedTo;\n  }\n  return tweenValue;\n};\n\nclass WAAPIAnimation {\n/**\n * @param {DOMTargetsParam} targets\n * @param {WAAPIAnimationParams} params\n */\n  constructor(targets, params) {\n\n    if (globals.scope) globals.scope.revertibles.push(this);\n\n    registerTransformsProperties();\n\n    const parsedTargets = registerTargets(targets);\n    const targetsLength = parsedTargets.length;\n\n    if (!targetsLength) {\n      console.warn(`No target found. Make sure the element you're trying to animate is accessible before creating your animation.`);\n    }\n\n    const ease = setValue(params.ease, parseWAAPIEasing(globals.defaults.ease));\n    const spring = /** @type {Spring} */(ease).ease && ease;\n    const autoplay = setValue(params.autoplay, globals.defaults.autoplay);\n    const scroll = autoplay && /** @type {ScrollObserver} */(autoplay).link ? autoplay : false;\n    const alternate = params.alternate && /** @type {Boolean} */(params.alternate) === true;\n    const reversed = params.reversed && /** @type {Boolean} */(params.reversed) === true;\n    const loop = setValue(params.loop, globals.defaults.loop);\n    const iterations = /** @type {Number} */((loop === true || loop === Infinity) ? Infinity : isNum(loop) ? loop + 1 : 1);\n    /** @type {PlaybackDirection} */\n    const direction = alternate ? reversed ? 'alternate-reverse' : 'alternate' : reversed ? 'reverse' : 'normal';\n    /** @type {FillMode} */\n    const fill = 'forwards';\n    /** @type {String} */\n    const easing = parseWAAPIEasing(ease);\n    const timeScale = (globals.timeScale === 1 ? 1 : K);\n\n    /** @type {DOMTargetsArray}] */\n    this.targets = parsedTargets;\n    /** @type {Array<globalThis.Animation>}] */\n    this.animations = [];\n    /** @type {globalThis.Animation}] */\n    this.controlAnimation = null;\n    /** @type {Callback<this>} */\n    this.onComplete = params.onComplete || noop;\n    /** @type {Number} */\n    this.duration = 0;\n    /** @type {Boolean} */\n    this.muteCallbacks = false;\n    /** @type {Boolean} */\n    this.completed = false;\n    /** @type {Boolean} */\n    this.paused = !autoplay || scroll !== false;\n    /** @type {Boolean} */\n    this.reversed = reversed;\n    /** @type {Boolean|ScrollObserver} */\n    this.autoplay = autoplay;\n    /** @type {Number} */\n    this._speed = setValue(params.playbackRate, globals.defaults.playbackRate);\n    /** @type {Function} */\n    this._resolve = noop; // Used by .then()\n    /** @type {Number} */\n    this._completed = 0;\n    /** @type {Array<Object>}] */\n    this._inlineStyles = parsedTargets.map($el => $el.getAttribute('style'));\n\n    parsedTargets.forEach(($el, i) => {\n\n      const cachedTransforms = $el[transformsSymbol];\n\n      const hasIndividualTransforms = validIndividualTransforms.some(t => params.hasOwnProperty(t));\n\n      /** @type {Number} */\n      const duration = (spring ? /** @type {Spring} */(spring).duration : getFunctionValue(setValue(params.duration, globals.defaults.duration), $el, i, targetsLength)) * timeScale;\n      /** @type {Number} */\n      const delay = getFunctionValue(setValue(params.delay, globals.defaults.delay), $el, i, targetsLength) * timeScale;\n      /** @type {CompositeOperation} */\n      const composite = /** @type {CompositeOperation} */(setValue(params.composition, 'replace'));\n\n      for (let name in params) {\n        if (!isKey(name)) continue;\n        /** @type {PropertyIndexedKeyframes} */\n        const keyframes = {};\n        /** @type {KeyframeAnimationOptions} */\n        const tweenParams = { iterations, direction, fill, easing, duration, delay, composite };\n        const propertyValue = params[name];\n        const individualTransformProperty = hasIndividualTransforms ? validTransforms.includes(name) ? name : shortTransforms.get(name) : false;\n        let parsedPropertyValue;\n        if (isObj(propertyValue)) {\n          const tweenOptions = /** @type {WAAPITweenOptions} */(propertyValue);\n          const tweenOptionsEase = setValue(tweenOptions.ease, ease);\n          const tweenOptionsSpring = /** @type {Spring} */(tweenOptionsEase).ease && tweenOptionsEase;\n          const to = /** @type {WAAPITweenOptions} */(tweenOptions).to;\n          const from = /** @type {WAAPITweenOptions} */(tweenOptions).from;\n          /** @type {Number} */\n          tweenParams.duration = (tweenOptionsSpring ? /** @type {Spring} */(tweenOptionsSpring).duration : getFunctionValue(setValue(tweenOptions.duration, duration), $el, i, targetsLength)) * timeScale;\n          /** @type {Number} */\n          tweenParams.delay = getFunctionValue(setValue(tweenOptions.delay, delay), $el, i, targetsLength) * timeScale;\n          /** @type {CompositeOperation} */\n          tweenParams.composite = /** @type {CompositeOperation} */(setValue(tweenOptions.composition, composite));\n          /** @type {String} */\n          tweenParams.easing = parseWAAPIEasing(tweenOptionsEase);\n          parsedPropertyValue = parseIndividualTweenValue($el, name, from, to, i, targetsLength);\n          if (individualTransformProperty) {\n            keyframes[`--${individualTransformProperty}`] = parsedPropertyValue;\n            cachedTransforms[individualTransformProperty] = parsedPropertyValue;\n          } else {\n            keyframes[name] = parseIndividualTweenValue($el, name, from, to, i, targetsLength);\n          }\n          addWAAPIAnimation(this, $el, name, keyframes, tweenParams);\n          if (!isUnd(from)) {\n            if (!individualTransformProperty) {\n              $el.style[name] = keyframes[name][0];\n            } else {\n              const key = `--${individualTransformProperty}`;\n              $el.style.setProperty(key, keyframes[key][0]);\n            }\n          }\n        } else {\n          parsedPropertyValue = isArr(propertyValue) ?\n                                propertyValue.map((/** @type {any} */v) => normalizeTweenValue(name, v, $el, i, targetsLength)) :\n                                normalizeTweenValue(name, /** @type {any} */(propertyValue), $el, i, targetsLength);\n          if (individualTransformProperty) {\n            keyframes[`--${individualTransformProperty}`] = parsedPropertyValue;\n            cachedTransforms[individualTransformProperty] = parsedPropertyValue;\n          } else {\n            keyframes[name] = parsedPropertyValue;\n          }\n          addWAAPIAnimation(this, $el, name, keyframes, tweenParams);\n        }\n      }\n      if (hasIndividualTransforms) {\n        let transforms = emptyString;\n        for (let t in cachedTransforms) {\n          transforms += `${transformsFragmentStrings[t]}var(--${t})) `;\n        }\n        $el.style.transform = transforms;\n      }\n    });\n\n    if (scroll) {\n      /** @type {ScrollObserver} */(this.autoplay).link(this);\n    }\n  }\n\n  /**\n   * @callback forEachCallback\n   * @param {globalThis.Animation} animation\n   */\n\n  /**\n   * @param  {forEachCallback|String} callback\n   * @return {this}\n   */\n  forEach(callback) {\n    const cb = isStr(callback) ? a => a[callback]() : callback;\n    this.animations.forEach(cb);\n    return this;\n  }\n\n  get speed() {\n    return this._speed;\n  }\n\n  /** @param {Number} speed */\n  set speed(speed) {\n    this._speed = +speed;\n    this.forEach(anim => anim.playbackRate = speed);\n  }\n\n  get currentTime() {\n    const controlAnimation = this.controlAnimation;\n    const timeScale = globals.timeScale;\n    return this.completed ? this.duration : controlAnimation ? +controlAnimation.currentTime * (timeScale === 1 ? 1 : timeScale) : 0;\n  }\n\n  /** @param {Number} time */\n  set currentTime(time) {\n    const t = time * (globals.timeScale === 1 ? 1 : K);\n    this.forEach(anim => {\n      // Make sure the animation playState is not 'paused' in order to properly trigger an onfinish callback.\n      // The \"paused\" play state supersedes the \"finished\" play state; if the animation is both paused and finished, the \"paused\" state is the one that will be reported.\n      // https://developer.mozilla.org/en-US/docs/Web/API/Animation/finish_event\n      if (t >= this.duration) anim.play();\n      anim.currentTime = t;\n    });\n  }\n\n  get progress() {\n    return this.currentTime / this.duration;\n  }\n\n  /** @param {Number} progress */\n  set progress(progress) {\n    this.forEach(anim => anim.currentTime = progress * this.duration || 0);\n  }\n\n  resume() {\n    if (!this.paused) return this;\n    this.paused = false;\n    // TODO: Store the current time, and seek back to the last position\n    return this.forEach('play');\n  }\n\n  pause() {\n    if (this.paused) return this;\n    this.paused = true;\n    return this.forEach('pause');\n  }\n\n  alternate() {\n    this.reversed = !this.reversed;\n    this.forEach('reverse');\n    if (this.paused) this.forEach('pause');\n    return this;\n  }\n\n  play() {\n    if (this.reversed) this.alternate();\n    return this.resume();\n  }\n\n  reverse() {\n    if (!this.reversed) this.alternate();\n    return this.resume();\n  }\n\n /**\n  * @param {Number} time\n  * @param {Boolean} muteCallbacks\n  */\n  seek(time, muteCallbacks = false) {\n    if (muteCallbacks) this.muteCallbacks = true;\n    if (time < this.duration) this.completed = false;\n    this.currentTime = time;\n    this.muteCallbacks = false;\n    if (this.paused) this.pause();\n    return this;\n  }\n\n  restart() {\n    this.completed = false;\n    return this.seek(0, true).resume();\n  }\n\n  commitStyles() {\n    return this.forEach('commitStyles');\n  }\n\n  complete() {\n    return this.seek(this.duration);\n  }\n\n  cancel() {\n    this.forEach('cancel');\n    return this.pause();\n  }\n\n  revert() {\n    this.cancel();\n    this.targets.forEach(($el, i) => $el.setAttribute('style', this._inlineStyles[i]) );\n    return this;\n  }\n\n  /**\n   * @param  {WAAPICallback} [callback]\n   * @return {Promise}\n   */\n  then(callback = noop) {\n    const then = this.then;\n    const onResolve = () => {\n      this.then = null;\n      callback(this);\n      this.then = then;\n      this._resolve = noop;\n    };\n    return new Promise(r => {\n      this._resolve = () => r(onResolve());\n      if (this.completed) this._resolve();\n      return this;\n    });\n  }\n}\n\nconst waapi = {\n/**\n * @param {DOMTargetsParam} targets\n * @param {WAAPIAnimationParams} params\n * @return {WAAPIAnimation}\n */\n  animate: (targets, params) => new WAAPIAnimation(targets, params),\n  convertEase: easingToLinear\n};\n\n\n\n\n/**\n * @param  {Callback<Timer>} [callback]\n * @return {Timer}\n */\nconst sync = (callback = noop) => {\n  return new Timer({ duration: 1 * globals.timeScale, onComplete: callback }, null, 0).resume();\n};\n\n/**\n * @overload\n * @param  {DOMTargetSelector} targetSelector\n * @param  {String}            propName\n * @return {String}\n *\n * @overload\n * @param  {JSTargetsParam} targetSelector\n * @param  {String}         propName\n * @return {Number|String}\n *\n * @overload\n * @param  {DOMTargetsParam} targetSelector\n * @param  {String}          propName\n * @param  {String}          unit\n * @return {String}\n *\n * @overload\n * @param  {TargetsParam} targetSelector\n * @param  {String}       propName\n * @param  {Boolean}      unit\n * @return {Number}\n *\n * @param  {TargetsParam}   targetSelector\n * @param  {String}         propName\n * @param  {String|Boolean} [unit]\n */\nfunction getTargetValue(targetSelector, propName, unit) {\n  const targets = registerTargets(targetSelector);\n  if (!targets.length) return;\n  const [ target ] = targets;\n  const tweenType = getTweenType(target, propName);\n  const normalizePropName = sanitizePropertyName(propName, target, tweenType);\n  let originalValue = getOriginalAnimatableValue(target, normalizePropName);\n  if (isUnd(unit)) {\n    return originalValue;\n  } else {\n    decomposeRawValue(originalValue, decomposedOriginalValue);\n    if (decomposedOriginalValue.t === valueTypes.NUMBER || decomposedOriginalValue.t === valueTypes.UNIT) {\n      if (unit === false) {\n        return decomposedOriginalValue.n;\n      } else {\n        const convertedValue = convertValueUnit(/** @type {DOMTarget} */(target), decomposedOriginalValue, /** @type {String} */(unit), false);\n        return `${round(convertedValue.n, globals.precision)}${convertedValue.u}`;\n      }\n    }\n  }\n}\n\n/**\n * @param  {TargetsParam}    targets\n * @param  {AnimationParams} parameters\n * @return {JSAnimation}\n */\nconst setTargetValues = (targets, parameters) => {\n  if (isUnd(parameters)) return;\n  parameters.duration = minValue;\n  // Do not overrides currently active tweens by default\n  parameters.composition = setValue(parameters.composition, compositionTypes.none);\n  // Skip init() and force rendering by playing the animation\n  return new JSAnimation(targets, parameters, null, 0, true).resume();\n};\n\n/**\n * @param  {TargetsArray} targetsArray\n * @param  {JSAnimation}    animation\n * @param  {String}       [propertyName]\n * @return {Boolean}\n */\nconst removeTargetsFromAnimation = (targetsArray, animation, propertyName) => {\n  let tweensMatchesTargets = false;\n  forEachChildren(animation, (/**@type {Tween} */tween) => {\n    const tweenTarget = tween.target;\n    if (targetsArray.includes(tweenTarget)) {\n      const tweenName = tween.property;\n      const tweenType = tween._tweenType;\n      const normalizePropName = sanitizePropertyName(propertyName, tweenTarget, tweenType);\n      if (!normalizePropName || normalizePropName && normalizePropName === tweenName) {\n        // Make sure to flag the previous CSS transform tween to renderTransform\n        if (tween.parent._tail === tween &&\n            tween._tweenType === tweenTypes.TRANSFORM &&\n            tween._prev &&\n            tween._prev._tweenType === tweenTypes.TRANSFORM\n        ) {\n          tween._prev._renderTransforms = 1;\n        }\n        // Removes the tween from the selected animation\n        removeChild(animation, tween);\n        // Detach the tween from its siblings to make sure blended tweens are correctlly removed\n        removeTweenSliblings(tween);\n        tweensMatchesTargets = true;\n      }\n    }\n  }, true);\n  return tweensMatchesTargets;\n};\n\n/**\n * @param  {TargetsParam} targets\n * @param  {Renderable|WAAPIAnimation} [renderable]\n * @param  {String}                    [propertyName]\n * @return {TargetsArray}\n */\nconst remove = (targets, renderable, propertyName) => {\n  const targetsArray = parseTargets(targets);\n  const parent = /** @type {Renderable|typeof engine} **/(renderable ? renderable : engine);\n  const waapiAnimation = renderable && /** @type {WAAPIAnimation} */(renderable).controlAnimation && /** @type {WAAPIAnimation} */(renderable);\n  for (let i = 0, l = targetsArray.length; i < l; i++) {\n    const $el = /** @type {DOMTarget}  */(targetsArray[i]);\n    removeWAAPIAnimation($el, propertyName, waapiAnimation);\n  }\n  let removeMatches;\n  if (parent._hasChildren) {\n    let iterationDuration = 0;\n    forEachChildren(parent, (/** @type {Renderable} */child) => {\n      if (!child._hasChildren) {\n        removeMatches = removeTargetsFromAnimation(targetsArray, /** @type {JSAnimation} */(child), propertyName);\n        // Remove the child from its parent if no tweens and no children left after the removal\n        if (removeMatches && !child._head) {\n          child.cancel();\n          removeChild(parent, child);\n        } else {\n          // Calculate the new iterationDuration value to handle onComplete with last child in render()\n          const childTLOffset = child._offset + child._delay;\n          const childDur = childTLOffset + child.duration;\n          if (childDur > iterationDuration) {\n            iterationDuration = childDur;\n          }\n        }\n      }\n      // Make sure to also remove engine's children targets\n      // NOTE: Avoid recursion?\n      if (child._head) {\n        remove(targets, child, propertyName);\n      } else {\n        child._hasChildren = false;\n      }\n    }, true);\n    // Update iterationDuration value to handle onComplete with last child in render()\n    if (!isUnd(/** @type {Renderable} */(parent).iterationDuration)) {\n      /** @type {Renderable} */(parent).iterationDuration = iterationDuration;\n    }\n  } else {\n    removeMatches = removeTargetsFromAnimation(\n      targetsArray,\n      /** @type {JSAnimation} */(parent),\n      propertyName\n    );\n  }\n\n  if (removeMatches && !parent._head) {\n    parent._hasChildren = false;\n    // Cancel the parent if there are no tweens and no children left after the removal\n    // We have to check if the .cancel() method exist to handle cases where the parent is the engine itself\n    if (/** @type {Renderable} */(parent).cancel) /** @type {Renderable} */(parent).cancel();\n  }\n\n  return targetsArray;\n};\n\n/**\n * @param  {Number} min\n * @param  {Number} max\n * @param  {Number} [decimalLength]\n * @return {Number}\n */\nconst random = (min, max, decimalLength) => { const m = 10 ** (decimalLength || 0); return floor((Math.random() * (max - min + (1 / m)) + min) * m) / m };\n\n/**\n * @param  {String|Array} items\n * @return {any}\n */\nconst randomPick = items => items[random(0, items.length - 1)];\n\n/**\n * Adapted from https://bost.ocks.org/mike/shuffle/\n * @param  {Array} items\n * @return {Array}\n */\nconst shuffle = items => {\n  let m = items.length, t, i;\n  while (m) { i = random(0, --m); t = items[m]; items[m] = items[i]; items[i] = t; }\n  return items;\n};\n\n/**\n * @param  {Number|String} v\n * @param  {Number} decimalLength\n * @return {String}\n */\nconst roundPad = (v, decimalLength) => (+v).toFixed(decimalLength);\n\n/**\n * @param  {Number} v\n * @param  {Number} totalLength\n * @param  {String} padString\n * @return {String}\n */\nconst padStart = (v, totalLength, padString) => `${v}`.padStart(totalLength, padString);\n\n/**\n * @param  {Number} v\n * @param  {Number} totalLength\n * @param  {String} padString\n * @return {String}\n */\nconst padEnd = (v, totalLength, padString) => `${v}`.padEnd(totalLength, padString);\n\n/**\n * @param  {Number} v\n * @param  {Number} min\n * @param  {Number} max\n * @return {Number}\n */\nconst wrap = (v, min, max) => (((v - min) % (max - min) + (max - min)) % (max - min)) + min;\n\n/**\n * @param  {Number} value\n * @param  {Number} inLow\n * @param  {Number} inHigh\n * @param  {Number} outLow\n * @param  {Number} outHigh\n * @return {Number}\n */\nconst mapRange = (value, inLow, inHigh, outLow, outHigh) => outLow + ((value - inLow) / (inHigh - inLow)) * (outHigh - outLow);\n\n/**\n * @param  {Number} degrees\n * @return {Number}\n */\nconst degToRad = degrees => degrees * PI / 180;\n\n/**\n * @param  {Number} radians\n * @return {Number}\n */\nconst radToDeg = radians => radians * 180 / PI;\n\n/**\n * https://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\n * @param  {Number} start\n * @param  {Number} end\n * @param  {Number} amount\n * @param  {Renderable|Boolean} [renderable]\n * @return {Number}\n */\nconst lerp = (start, end, amount, renderable) => {\n  let dt = K / globals.defaults.frameRate;\n  if (renderable !== false) {\n    const ticker = /** @type Renderable */\n                   (renderable) ||\n                   (engine._hasChildren && engine);\n    if (ticker && ticker.deltaTime) {\n      dt = ticker.deltaTime;\n    }\n  }\n  const t = 1 - Math.exp(-amount * dt * .1);\n  return !amount ? start : amount === 1 ? end : (1 - t) * start + t * end;\n};\n\n// Chain-able utilities\n\n/**\n * @callback UtilityFunction\n * @param {...*} args\n * @return {Number|String}\n *\n * @param {UtilityFunction} fn\n * @param {Number} [last=0]\n * @return {function(...(Number|String)): function(Number|String): (Number|String)}\n */\nconst curry = (fn, last = 0) => (...args) => last ? v => fn(...args, v) : v => fn(v, ...args);\n\n/**\n * @param {Function} fn\n * @return {function(...(Number|String))}\n */\nconst chain = fn => {\n   return (...args) => {\n    const result = fn(...args);\n    return new Proxy(noop, {\n      apply: (_, __, [v]) => result(v),\n      get: (_, prop) => chain(/**@param {...Number|String} nextArgs */(...nextArgs) => {\n        const nextResult = utils[prop](...nextArgs);\n        return (/**@type {Number|String} */v) => nextResult(result(v));\n      })\n    });\n  }\n};\n\n/**\n * @param {UtilityFunction} fn\n * @param {Number} [right]\n * @return {function(...(Number|String)): UtilityFunction}\n */\nconst makeChainable = (fn, right = 0) => (...args) => (args.length < fn.length ? chain(curry(fn, right)) : fn)(...args);\n\n/**\n * @callback ChainedUtilsResult\n * @param {Number} value\n * @return {Number}\n *\n * @typedef {Object} ChainableUtils\n * @property {ChainedClamp} clamp\n * @property {ChainedRound} round\n * @property {ChainedSnap} snap\n * @property {ChainedWrap} wrap\n * @property {ChainedInterpolate} interpolate\n * @property {ChainedMapRange} mapRange\n * @property {ChainedRoundPad} roundPad\n * @property {ChainedPadStart} padStart\n * @property {ChainedPadEnd} padEnd\n * @property {ChainedDegToRad} degToRad\n * @property {ChainedRadToDeg} radToDeg\n *\n * @typedef {ChainableUtils & ChainedUtilsResult} ChainableUtil\n *\n * @callback ChainedClamp\n * @param {Number} min\n * @param {Number} max\n * @return {ChainableUtil}\n *\n * @callback ChainedRound\n * @param {Number} decimalLength\n * @return {ChainableUtil}\n *\n * @callback ChainedSnap\n * @param {Number} increment\n * @return {ChainableUtil}\n *\n * @callback ChainedWrap\n * @param {Number} min\n * @param {Number} max\n * @return {ChainableUtil}\n *\n * @callback ChainedInterpolate\n * @param {Number} start\n * @param {Number} end\n * @return {ChainableUtil}\n *\n * @callback ChainedMapRange\n * @param {Number} inLow\n * @param {Number} inHigh\n * @param {Number} outLow\n * @param {Number} outHigh\n * @return {ChainableUtil}\n *\n * @callback ChainedRoundPad\n * @param {Number} decimalLength\n * @return {ChainableUtil}\n *\n * @callback ChainedPadStart\n * @param {Number} totalLength\n * @param {String} padString\n * @return {ChainableUtil}\n *\n * @callback ChainedPadEnd\n * @param {Number} totalLength\n * @param {String} padString\n * @return {ChainableUtil}\n *\n * @callback ChainedDegToRad\n * @return {ChainableUtil}\n *\n * @callback ChainedRadToDeg\n * @return {ChainableUtil}\n */\n\nconst utils = {\n  $: registerTargets,\n  get: getTargetValue,\n  set: setTargetValues,\n  remove,\n  cleanInlineStyles,\n  random,\n  randomPick,\n  shuffle,\n  lerp,\n  sync,\n  clamp: /** @type {typeof clamp & ChainedClamp} */(makeChainable(clamp)),\n  round: /** @type {typeof round & ChainedRound} */(makeChainable(round)),\n  snap: /** @type {typeof snap & ChainedSnap} */(makeChainable(snap)),\n  wrap: /** @type {typeof wrap & ChainedWrap} */(makeChainable(wrap)),\n  interpolate: /** @type {typeof interpolate & ChainedInterpolate} */(makeChainable(interpolate, 1)),\n  mapRange: /** @type {typeof mapRange & ChainedMapRange} */(makeChainable(mapRange)),\n  roundPad: /** @type {typeof roundPad & ChainedRoundPad} */(makeChainable(roundPad)),\n  padStart: /** @type {typeof padStart & ChainedPadStart} */(makeChainable(padStart)),\n  padEnd: /** @type {typeof padEnd & ChainedPadEnd} */(makeChainable(padEnd)),\n  degToRad: /** @type {typeof degToRad & ChainedDegToRad} */(makeChainable(degToRad)),\n  radToDeg: /** @type {typeof radToDeg & ChainedRadToDeg} */(makeChainable(radToDeg)),\n};\n\n\n\n\n/**\n * @typedef {Number|String|Function} TimePosition\n */\n\n/**\n * Timeline's children offsets positions parser\n * @param  {Timeline} timeline\n * @param  {String} timePosition\n * @return {Number}\n */\nconst getPrevChildOffset = (timeline, timePosition) => {\n  if (stringStartsWith(timePosition, '<')) {\n    const goToPrevAnimationOffset = timePosition[1] === '<';\n    const prevAnimation = /** @type {Tickable} */(timeline._tail);\n    const prevOffset = prevAnimation ? prevAnimation._offset + prevAnimation._delay : 0;\n    return goToPrevAnimationOffset ? prevOffset : prevOffset + prevAnimation.duration;\n  }\n};\n\n/**\n * @param  {Timeline} timeline\n * @param  {TimePosition} [timePosition]\n * @return {Number}\n */\nconst parseTimelinePosition = (timeline, timePosition) => {\n  let tlDuration = timeline.iterationDuration;\n  if (tlDuration === minValue) tlDuration = 0;\n  if (isUnd(timePosition)) return tlDuration;\n  if (isNum(+timePosition)) return +timePosition;\n  const timePosStr = /** @type {String} */(timePosition);\n  const tlLabels = timeline ? timeline.labels : null;\n  const hasLabels = !isNil(tlLabels);\n  const prevOffset = getPrevChildOffset(timeline, timePosStr);\n  const hasSibling = !isUnd(prevOffset);\n  const matchedRelativeOperator = relativeValuesExecRgx.exec(timePosStr);\n  if (matchedRelativeOperator) {\n    const fullOperator = matchedRelativeOperator[0];\n    const split = timePosStr.split(fullOperator);\n    const labelOffset = hasLabels && split[0] ? tlLabels[split[0]] : tlDuration;\n    const parsedOffset = hasSibling ? prevOffset : hasLabels ? labelOffset : tlDuration;\n    const parsedNumericalOffset = +split[1];\n    return getRelativeValue(parsedOffset, parsedNumericalOffset, fullOperator[0]);\n  } else {\n    return hasSibling ? prevOffset :\n           hasLabels ? !isUnd(tlLabels[timePosStr]) ? tlLabels[timePosStr] :\n           tlDuration : tlDuration;\n  }\n};\n\n/**\n * @param {Timeline} tl\n * @return {Number}\n */\nfunction getTimelineTotalDuration(tl) {\n  return clampInfinity(((tl.iterationDuration + tl._loopDelay) * tl.iterationCount) - tl._loopDelay) || minValue;\n}\n\n/**\n * @overload\n * @param  {TimerParams} childParams\n * @param  {Timeline} tl\n * @param  {Number} timePosition\n * @return {Timeline}\n *\n * @overload\n * @param  {AnimationParams} childParams\n * @param  {Timeline} tl\n * @param  {Number} timePosition\n * @param  {TargetsParam} targets\n * @param  {Number} [index]\n * @param  {Number} [length]\n * @return {Timeline}\n *\n * @param  {TimerParams|AnimationParams} childParams\n * @param  {Timeline} tl\n * @param  {Number} timePosition\n * @param  {TargetsParam} [targets]\n * @param  {Number} [index]\n * @param  {Number} [length]\n */\nfunction addTlChild(childParams, tl, timePosition, targets, index, length) {\n  const isSetter = isNum(childParams.duration) && /** @type {Number} */(childParams.duration) <= minValue;\n  // Offset the tl position with -minValue for 0 duration animations or .set() calls in order to align their end value with the defined position\n  const adjustedPosition = isSetter ? timePosition - minValue : timePosition;\n  tick(tl, adjustedPosition, 1, 1, tickModes.AUTO);\n  const tlChild = targets ?\n    new JSAnimation(targets,/** @type {AnimationParams} */(childParams), tl, adjustedPosition, false, index, length) :\n    new Timer(/** @type {TimerParams} */(childParams), tl, adjustedPosition);\n  tlChild.init(1);\n  // TODO: Might be better to insert at a position relative to startTime?\n  addChild(tl, tlChild);\n  forEachChildren(tl, (/** @type {Renderable} */child) => {\n    const childTLOffset = child._offset + child._delay;\n    const childDur = childTLOffset + child.duration;\n    if (childDur > tl.iterationDuration) tl.iterationDuration = childDur;\n  });\n  tl.duration = getTimelineTotalDuration(tl);\n  return tl;\n}\n\nclass Timeline extends Timer {\n\n  /**\n   * @param {TimelineParams} [parameters]\n   */\n  constructor(parameters = {}) {\n    super(/** @type {TimerParams&TimelineParams} */(parameters), null, 0);\n    /** @type {Number} */\n    this.duration = 0; // TL duration starts at 0 and grows when adding children\n    /** @type {Record<String, Number>} */\n    this.labels = {};\n    const defaultsParams = parameters.defaults;\n    const globalDefaults = globals.defaults;\n    /** @type {DefaultsParams} */\n    this.defaults = defaultsParams ? mergeObjects(defaultsParams, globalDefaults) : globalDefaults;\n    /** @type {Callback<this>} */\n    this.onRender = parameters.onRender || globalDefaults.onRender;\n    const tlPlaybackEase = setValue(parameters.playbackEase, globalDefaults.playbackEase);\n    this._ease = tlPlaybackEase ? parseEasings(tlPlaybackEase) : null;\n    /** @type {Number} */\n    this.iterationDuration = 0;\n  }\n\n  /**\n   * @overload\n   * @param {TargetsParam} a1\n   * @param {AnimationParams} a2\n   * @param {TimePosition} [a3]\n   * @return {this}\n   *\n   * @overload\n   * @param {TimerParams} a1\n   * @param {TimePosition} [a2]\n   * @return {this}\n   *\n   * @param {TargetsParam|TimerParams} a1\n   * @param {AnimationParams|TimePosition} a2\n   * @param {TimePosition} [a3]\n   */\n  add(a1, a2, a3) {\n    const isAnim = isObj(a2);\n    const isTimer = isObj(a1);\n    if (isAnim || isTimer) {\n      this._hasChildren = true;\n      if (isAnim) {\n        const childParams = /** @type {AnimationParams} */(a2);\n        // Check for function for children stagger positions\n        if (isFnc(a3)) {\n          const staggeredPosition = /** @type {Function} */(a3);\n          const parsedTargetsArray = parseTargets(/** @type {TargetsParam} */(a1));\n          // Store initial duration before adding new children that will change the duration\n          const tlDuration = this.duration;\n          // Store initial _iterationDuration before adding new children that will change the duration\n          const tlIterationDuration = this.iterationDuration;\n          // Store the original id in order to add specific indexes to the new animations ids\n          const id = childParams.id;\n          let i = 0;\n          const parsedLength = parsedTargetsArray.length;\n          parsedTargetsArray.forEach((/** @type {Target} */target) => {\n            // Create a new parameter object for each staggered children\n            const staggeredChildParams = { ...childParams };\n            // Reset the duration of the timeline iteration before each stagger to prevent wrong start value calculation\n            this.duration = tlDuration;\n            this.iterationDuration = tlIterationDuration;\n            if (!isUnd(id)) staggeredChildParams.id = id + '-' + i;\n            addTlChild(\n              staggeredChildParams,\n              this,\n              staggeredPosition(target, i, parsedLength, this),\n              target,\n              i,\n              parsedLength\n            );\n            i++;\n          });\n        } else {\n          addTlChild(\n            childParams,\n            this,\n            parseTimelinePosition(this, a3),\n            /** @type {TargetsParam} */(a1),\n          );\n        }\n      } else {\n        // It's a Timer\n        addTlChild(\n          /** @type TimerParams */(a1),\n          this,\n          parseTimelinePosition(this,/** @type TimePosition */(a2)),\n        );\n      }\n      return this.init(1); // 1 = internalRender\n    }\n  }\n\n  /**\n   * @overload\n   * @param {Tickable} [synced]\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   * @overload\n   * @param {globalThis.Animation} [synced]\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   * @overload\n   * @param {WAAPIAnimation} [synced]\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   * @param {Tickable|WAAPIAnimation|globalThis.Animation} [synced]\n   * @param {TimePosition} [position]\n   */\n  sync(synced, position) {\n    if (isUnd(synced) || synced && isUnd(synced.pause)) return this;\n    synced.pause();\n    const duration = +(/** @type {globalThis.Animation} */(synced).effect ? /** @type {globalThis.Animation} */(synced).effect.getTiming().duration : /** @type {Tickable} */(synced).duration);\n    return this.add(synced, { currentTime: [0, duration], duration, ease: 'linear' }, position);\n  }\n\n  /**\n   * @param  {TargetsParam} targets\n   * @param  {AnimationParams} parameters\n   * @param  {TimePosition} [position]\n   * @return {this}\n   */\n  set(targets, parameters, position) {\n    if (isUnd(parameters)) return this;\n    parameters.duration = minValue;\n    parameters.composition = compositionTypes.replace;\n    return this.add(targets, parameters, position);\n  }\n\n  /**\n   * @param {Callback<Timer>} callback\n   * @param {TimePosition} [position]\n   * @return {this}\n   */\n  call(callback, position) {\n    if (isUnd(callback) || callback && !isFnc(callback)) return this;\n    return this.add({ duration: 0, onComplete: () => callback(this) }, position);\n  }\n\n  /**\n   * @param {String} labelName\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   */\n  label(labelName, position) {\n    if (isUnd(labelName) || labelName && !isStr(labelName)) return this;\n    this.labels[labelName] = parseTimelinePosition(this,/** @type TimePosition */(position));\n    return this;\n  }\n\n  /**\n   * @param  {TargetsParam} targets\n   * @param  {String} [propertyName]\n   * @return {this}\n   */\n  remove(targets, propertyName) {\n    remove(targets, this, propertyName);\n    return this;\n  }\n\n  /**\n   * @param  {Number} newDuration\n   * @return {this}\n   */\n  stretch(newDuration) {\n    const currentDuration = this.duration;\n    if (currentDuration === normalizeTime(newDuration)) return this;\n    const timeScale = newDuration / currentDuration;\n    const labels = this.labels;\n    forEachChildren(this, (/** @type {JSAnimation} */child) => child.stretch(child.duration * timeScale));\n    for (let labelName in labels) labels[labelName] *= timeScale;\n    return super.stretch(newDuration);\n  }\n\n  /**\n   * @return {this}\n   */\n  refresh() {\n    forEachChildren(this, (/** @type {JSAnimation} */child) => {\n      if (child.refresh) child.refresh();\n    });\n    return this;\n  }\n\n  /**\n   * @return {this}\n   */\n  revert() {\n    super.revert();\n    forEachChildren(this, (/** @type {JSAnimation} */child) => child.revert, true);\n    return cleanInlineStyles(this);\n  }\n\n  /**\n   * @param  {Callback<this>} [callback]\n   * @return {Promise}\n   */\n  then(callback) {\n    return super.then(callback);\n  }\n}\n\n/**\n * @param {TimelineParams} [parameters]\n * @return {Timeline}\n */\nconst createTimeline = parameters => new Timeline(parameters).init();\n\n\n\n\nclass Animatable {\n  /**\n   * @param {TargetsParam} targets\n   * @param {AnimatableParams} parameters\n   */\n  constructor(targets, parameters) {\n    if (globals.scope) globals.scope.revertibles.push(this);\n    /** @type {AnimationParams} */\n    const globalParams = {};\n    const properties = {};\n    this.targets = [];\n    this.animations = {};\n    if (isUnd(targets) || isUnd(parameters)) return;\n    for (let propName in parameters) {\n      const paramValue = parameters[propName];\n      if (isKey(propName)) {\n        properties[propName] = paramValue;\n      } else {\n        globalParams[propName] = paramValue;\n      }\n    }\n    for (let propName in properties) {\n      const propValue = properties[propName];\n      const isObjValue = isObj(propValue);\n      /** @type {TweenParamsOptions} */\n      let propParams = {};\n      let to = '+=0';\n      if (isObjValue) {\n        const unit = propValue.unit;\n        if (isStr(unit)) to += unit;\n      } else {\n        propParams.duration = propValue;\n      }\n      propParams[propName] = isObjValue ? mergeObjects({ to }, propValue) : to;\n      const animParams = mergeObjects(globalParams, propParams);\n      animParams.composition = compositionTypes.replace;\n      animParams.autoplay = false;\n      const animation = this.animations[propName] = new JSAnimation(targets, animParams, null, 0, false).init();\n      if (!this.targets.length) this.targets.push(...animation.targets);\n      /** @type {AnimatableProperty} */\n      this[propName] = (to, duration, ease) => {\n        const tween = /** @type {Tween} */(animation._head);\n        if (isUnd(to) && tween) {\n          const numbers = tween._numbers;\n          if (numbers && numbers.length) {\n            return numbers;\n          } else {\n            return tween._modifier(tween._number);\n          }\n        } else {\n          forEachChildren(animation, (/** @type {Tween} */tween) => {\n            if (isArr(to)) {\n              for (let i = 0, l = /** @type {Array} */(to).length; i < l; i++) {\n                if (!isUnd(tween._numbers[i])) {\n                  tween._fromNumbers[i] = /** @type {Number} */(tween._modifier(tween._numbers[i]));\n                  tween._toNumbers[i] = to[i];\n                }\n              }\n            } else {\n              tween._fromNumber = /** @type {Number} */(tween._modifier(tween._number));\n              tween._toNumber = /** @type {Number} */(to);\n            }\n            if (!isUnd(ease)) tween._ease = parseEasings(ease);\n            tween._currentTime = 0;\n          });\n          if (!isUnd(duration)) animation.stretch(duration);\n          animation.reset(1).resume();\n          return this;\n        }\n      };\n    }\n  }\n\n  revert() {\n    for (let propName in this.animations) {\n      this[propName] = noop;\n      this.animations[propName].revert();\n    }\n    this.animations = {};\n    this.targets.length = 0;\n    return this;\n  }\n}\n\n/**\n * @param {TargetsParam} targets\n * @param {AnimatableParams} parameters\n * @return {AnimatableObject}\n */\nconst createAnimatable = (targets, parameters) => /** @type {AnimatableObject} */(new Animatable(targets, parameters));\n\n\n\n\n/*\n * Spring ease solver adapted from https://webkit.org/demos/spring/spring.js\n * Webkit Copyright  2016 Apple Inc\n */\n\n/**\n * @typedef {Object} SpringParams\n * @property {Number} [mass=1] - Mass, default 1\n * @property {Number} [stiffness=100] - Stiffness, default 100\n * @property {Number} [damping=10] - Damping, default 10\n * @property {Number} [velocity=0] - Initial velocity, default 0\n */\n\nclass Spring {\n  /**\n   * @param {SpringParams} [parameters]\n   */\n  constructor(parameters = {}) {\n    this.timeStep = .02; // Interval fed to the solver to calculate duration\n    this.restThreshold = .0005; // Values below this threshold are considered resting position\n    this.restDuration = 200; // Duration in ms used to check if the spring is resting after reaching restThreshold\n    this.maxDuration = 60000; // The maximum allowed spring duration in ms (default 1 min)\n    this.maxRestSteps = this.restDuration / this.timeStep / K; // How many steps allowed after reaching restThreshold before stopping the duration calculation\n    this.maxIterations = this.maxDuration / this.timeStep / K; // Calculate the maximum iterations allowed based on maxDuration\n    this.m = clamp(setValue(parameters.mass, 1), 0, K);\n    this.s = clamp(setValue(parameters.stiffness, 100), 1, K);\n    this.d = clamp(setValue(parameters.damping, 10), .1, K);\n    this.v = clamp(setValue(parameters.velocity, 0), -1e3, K);\n    this.w0 = 0;\n    this.zeta = 0;\n    this.wd = 0;\n    this.b = 0;\n    this.solverDuration = 0;\n    this.duration = 0;\n    this.compute();\n    /** @type {EasingFunction} */\n    this.ease = t => t === 0 || t === 1 ? t : this.solve(t * this.solverDuration);\n  }\n\n  /** @type {EasingFunction} */\n  solve(time) {\n    const { zeta, w0, wd, b } = this;\n    let t = time;\n    if (zeta < 1) {\n      t = exp(-t * zeta * w0) * (1 * cos(wd * t) + b * sin(wd * t));\n    } else {\n      t = (1 + b * t) * exp(-t * w0);\n    }\n    return 1 - t;\n  }\n\n  compute() {\n    const { maxRestSteps, maxIterations, restThreshold, timeStep, m, d, s, v } = this;\n    const w0 = this.w0 = clamp(sqrt(s / m), minValue, K);\n    const zeta = this.zeta = d / (2 * sqrt(s * m));\n    const wd = this.wd = zeta < 1 ? w0 * sqrt(1 - zeta * zeta) : 0;\n    this.b = zeta < 1 ? (zeta * w0 + -v) / wd : -v + w0;\n    let solverTime = 0;\n    let restSteps = 0;\n    let iterations = 0;\n    while (restSteps < maxRestSteps && iterations < maxIterations) {\n      if (abs(1 - this.solve(solverTime)) < restThreshold) {\n        restSteps++;\n      } else {\n        restSteps = 0;\n      }\n      this.solverDuration = solverTime;\n      solverTime += timeStep;\n      iterations++;\n    }\n    this.duration = round(this.solverDuration * K, 0) * globals.timeScale;\n  }\n\n  get mass() {\n    return this.m;\n  }\n\n  set mass(v) {\n    this.m = clamp(setValue(v, 1), 0, K);\n    this.compute();\n  }\n\n  get stiffness() {\n    return this.s;\n  }\n\n  set stiffness(v) {\n    this.s = clamp(setValue(v, 100), 1, K);\n    this.compute();\n  }\n\n  get damping() {\n    return this.d;\n  }\n\n  set damping(v) {\n    this.d = clamp(setValue(v, 10), .1, K);\n    this.compute();\n  }\n\n  get velocity() {\n    return this.v;\n  }\n\n  set velocity(v) {\n    this.v = clamp(setValue(v, 0), -1e3, K);\n    this.compute();\n  }\n}\n\n/**\n * @param {SpringParams} [parameters]\n * @returns {Spring}\n */\nconst createSpring = (parameters) => new Spring(parameters);\n\n\n\n\n/**\n * @param {Event} e\n */\nconst preventDefault = e => {\n  if (e.cancelable) e.preventDefault();\n};\n\nclass DOMProxy {\n  /** @param {Object} el */\n  constructor(el) {\n    this.el = el;\n    this.zIndex = 0;\n    this.parentElement = null;\n    this.classList = {\n      add: noop,\n      remove: noop,\n    };\n  }\n\n  get x() { return this.el.x || 0 };\n  set x(v) { this.el.x = v; };\n\n  get y() { return this.el.y || 0 };\n  set y(v) { this.el.y = v; };\n\n  get width() { return this.el.width || 0 };\n  set width(v) { this.el.width = v; };\n\n  get height() { return this.el.height || 0 };\n  set height(v) { this.el.height = v; };\n\n  getBoundingClientRect() {\n    return {\n      top: this.y,\n      right: this.x,\n      bottom: this.y + this.height,\n      left: this.x + this.width,\n    }\n  }\n}\n\nclass Transforms {\n  /**\n   * @param {DOMTarget|DOMProxy} $el\n   */\n  constructor($el) {\n    this.$el = $el;\n    this.inlineTransforms = [];\n    this.point = new DOMPoint();\n    this.inversedMatrix = this.getMatrix().inverse();\n  }\n\n  /**\n   * @param {Number} x\n   * @param {Number} y\n   * @return {DOMPoint}\n   */\n  normalizePoint(x, y) {\n    this.point.x = x;\n    this.point.y = y;\n    return this.point.matrixTransform(this.inversedMatrix);\n  }\n\n  /**\n   * @callback TraverseParentsCallback\n   * @param {DOMTarget} $el\n   * @param {Number} i\n   */\n\n  /**\n   * @param {TraverseParentsCallback} cb\n   */\n  traverseUp(cb) {\n    let $el = /** @type {DOMTarget|Document} */(this.$el.parentElement), i = 0;\n    while ($el && $el !== doc) {\n      cb(/** @type {DOMTarget} */($el), i);\n      $el = /** @type {DOMTarget} */($el.parentElement);\n      i++;\n    }\n  }\n\n  getMatrix() {\n    const matrix = new DOMMatrix();\n    this.traverseUp($el => {\n      const transformValue = getComputedStyle($el).transform;\n      if (transformValue) {\n        const elMatrix = new DOMMatrix(transformValue);\n        matrix.preMultiplySelf(elMatrix);\n      }\n    });\n    return matrix;\n  }\n\n  remove() {\n    this.traverseUp(($el, i) => {\n      this.inlineTransforms[i] = $el.style.transform;\n      $el.style.transform = 'none';\n    });\n  }\n\n  revert() {\n    this.traverseUp(($el, i) => {\n      const ct = this.inlineTransforms[i];\n      if (ct === '') {\n        $el.style.removeProperty('transform');\n      } else {\n        $el.style.transform = ct;\n      }\n    });\n  }\n}\n\n/**\n * @template {Array<Number>|DOMTargetSelector|String|Number|Boolean|Function|DraggableCursorParams} T\n * @param {T | ((draggable: Draggable) => T)} value\n * @param {Draggable} draggable\n * @return {T}\n */\nconst parseDraggableFunctionParameter = (value, draggable) => value && isFnc(value) ? /** @type {Function} */(value)(draggable) : value;\n\nlet zIndex = 0;\n\nclass Draggable {\n  /**\n   * @param {TargetsParam} target\n   * @param {DraggableParams} [parameters]\n   */\n  constructor(target, parameters = {}) {\n    if (!target) return;\n    if (globals.scope) globals.scope.revertibles.push(this);\n    const paramX = parameters.x;\n    const paramY = parameters.y;\n    const trigger = parameters.trigger;\n    const modifier = parameters.modifier;\n    const ease = parameters.releaseEase;\n    const customEase = ease && parseEasings(ease);\n    const hasSpring = !isUnd(ease) && !isUnd(/** @type {Spring} */(ease).ease);\n    const xProp = /** @type {String} */(isObj(paramX) && !isUnd(/** @type {Object} */(paramX).mapTo) ? /** @type {Object} */(paramX).mapTo : 'translateX');\n    const yProp = /** @type {String} */(isObj(paramY) && !isUnd(/** @type {Object} */(paramY).mapTo) ? /** @type {Object} */(paramY).mapTo : 'translateY');\n    const container = parseDraggableFunctionParameter(parameters.container, this);\n    this.containerArray = isArr(container) ? container : null;\n    this.$container = /** @type {HTMLElement} */(container && !this.containerArray ? parseTargets(/** @type {DOMTarget} */(container))[0] : doc.body);\n    this.useWin = this.$container === doc.body;\n    /** @type {Window | HTMLElement} */\n    this.$scrollContainer = this.useWin ? win : this.$container;\n    this.$target = /** @type {HTMLElement} */(isObj(target) ? new DOMProxy(target) : parseTargets(target)[0]);\n    this.$trigger = /** @type {HTMLElement} */(parseTargets(trigger ? trigger : target)[0]);\n    this.fixed = getTargetValue(this.$target, 'position') === 'fixed';\n    // Refreshable parameters\n    this.isFinePointer = true;\n    /** @type {[Number, Number, Number, Number]} */\n    this.containerPadding = [0, 0, 0, 0];\n    /** @type {Number} */\n    this.containerFriction = 0;\n    /** @type {Number} */\n    this.releaseContainerFriction = 0;\n    /** @type {Number|Array<Number>} */\n    this.snapX = 0;\n    /** @type {Number|Array<Number>} */\n    this.snapY = 0;\n    /** @type {Number} */\n    this.scrollSpeed = 0;\n    /** @type {Number} */\n    this.scrollThreshold = 0;\n    /** @type {Number} */\n    this.dragSpeed = 0;\n    /** @type {Number} */\n    this.maxVelocity = 0;\n    /** @type {Number} */\n    this.minVelocity = 0;\n    /** @type {Number} */\n    this.velocityMultiplier = 0;\n    /** @type {Boolean|DraggableCursorParams} */\n    this.cursor = false;\n    /** @type {Spring} */\n    this.releaseXSpring = hasSpring ? /** @type {Spring} */(ease) : createSpring({\n      mass: setValue(parameters.releaseMass, 1),\n      stiffness: setValue(parameters.releaseStiffness, 80),\n      damping: setValue(parameters.releaseDamping, 20),\n    });\n    /** @type {Spring} */\n    this.releaseYSpring = hasSpring ? /** @type {Spring} */(ease) : createSpring({\n      mass: setValue(parameters.releaseMass, 1),\n      stiffness: setValue(parameters.releaseStiffness, 80),\n      damping: setValue(parameters.releaseDamping, 20),\n    });\n    /** @type {EasingFunction} */\n    this.releaseEase = customEase || eases.outQuint;\n    /** @type {Boolean} */\n    this.hasReleaseSpring = hasSpring;\n    /** @type {Callback<this>} */\n    this.onGrab = parameters.onGrab || noop;\n    /** @type {Callback<this>} */\n    this.onDrag = parameters.onDrag || noop;\n    /** @type {Callback<this>} */\n    this.onRelease = parameters.onRelease || noop;\n    /** @type {Callback<this>} */\n    this.onUpdate = parameters.onUpdate || noop;\n    /** @type {Callback<this>} */\n    this.onSettle = parameters.onSettle || noop;\n    /** @type {Callback<this>} */\n    this.onSnap = parameters.onSnap || noop;\n    /** @type {Callback<this>} */\n    this.onResize = parameters.onResize || noop;\n    /** @type {Callback<this>} */\n    this.onAfterResize = parameters.onAfterResize || noop;\n    /** @type {[Number, Number]} */\n    this.disabled = [0, 0];\n    /** @type {AnimatableParams} */\n    const animatableParams = {};\n    if (modifier) animatableParams.modifier = modifier;\n    if (isUnd(paramX) || paramX === true) {\n      animatableParams[xProp] = 0;\n    } else if (isObj(paramX)) {\n      const paramXObject = /** @type {DraggableAxisParam} */(paramX);\n      const animatableXParams = {};\n      if (paramXObject.modifier) animatableXParams.modifier = paramXObject.modifier;\n      if (paramXObject.composition) animatableXParams.composition = paramXObject.composition;\n      animatableParams[xProp] = animatableXParams;\n    } else if (paramX === false) {\n      animatableParams[xProp] = 0;\n      this.disabled[0] = 1;\n    }\n    if (isUnd(paramY) || paramY === true) {\n      animatableParams[yProp] = 0;\n    } else if (isObj(paramY)) {\n      const paramYObject = /** @type {DraggableAxisParam} */(paramY);\n      const animatableYParams = {};\n      if (paramYObject.modifier) animatableYParams.modifier = paramYObject.modifier;\n      if (paramYObject.composition) animatableYParams.composition = paramYObject.composition;\n      animatableParams[yProp] = animatableYParams;\n    } else if (paramY === false) {\n      animatableParams[yProp] = 0;\n      this.disabled[1] = 1;\n    }\n    /** @type {AnimatableObject} */\n    this.animate = /** @type {AnimatableObject} */(new Animatable(this.$target, animatableParams));\n    // Internal props\n    this.xProp = xProp;\n    this.yProp = yProp;\n    this.destX = 0;\n    this.destY = 0;\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.scroll = {x: 0, y: 0};\n    /** @type {[Number, Number, Number, Number]} */\n    this.coords = [this.x, this.y, 0, 0]; // x, y, temp x, temp y\n    /** @type {[Number, Number]} */\n    this.snapped = [0, 0]; // x, y\n    /** @type {[Number, Number, Number, Number, Number, Number, Number, Number]} */\n    this.pointer = [0, 0, 0, 0, 0, 0, 0, 0]; // x1, y1, x2, y2, temp x1, temp y1, temp x2, temp y2\n    /** @type {[Number, Number]} */\n    this.scrollView = [0, 0]; // w, h\n    /** @type {[Number, Number, Number, Number]} */\n    this.dragArea = [0, 0, 0, 0]; // x, y, w, h\n    /** @type {[Number, Number, Number, Number]} */\n    this.containerBounds = [-1e12, maxValue, maxValue, -1e12]; // t, r, b, l\n    /** @type {[Number, Number, Number, Number]} */\n    this.scrollBounds = [0, 0, 0, 0]; // t, r, b, l\n    /** @type {[Number, Number, Number, Number]} */\n    this.targetBounds = [0, 0, 0, 0]; // t, r, b, l\n    /** @type {[Number, Number]} */\n    this.window = [0, 0]; // w, h\n    /** @type {[Number, Number, Number]} */\n    this.velocityStack = [0, 0, 0];\n    /** @type {Number} */\n    this.velocityStackIndex = 0;\n    /** @type {Number} */\n    this.velocityTime = now();\n    /** @type {Number} */\n    this.velocity = 0;\n    /** @type {Number} */\n    this.angle = 0;\n    /** @type {JSAnimation} */\n    this.cursorStyles = null;\n    /** @type {JSAnimation} */\n    this.triggerStyles = null;\n    /** @type {JSAnimation} */\n    this.bodyStyles = null;\n    /** @type {JSAnimation} */\n    this.targetStyles = null;\n    /** @type {JSAnimation} */\n    this.touchActionStyles = null;\n    this.transforms = new Transforms(this.$target);\n    this.overshootCoords = { x: 0, y: 0 };\n    this.overshootXTicker = new Timer({ autoplay: false }, null, 0).init();\n    this.overshootYTicker = new Timer({ autoplay: false }, null, 0).init();\n    this.updateTicker = new Timer({ autoplay: false }, null, 0).init();\n    this.overshootXTicker.onUpdate = () => {\n      if (this.disabled[0]) return;\n      this.updated = true;\n      this.manual = true;\n      this.animate[this.xProp](this.overshootCoords.x, 0);\n    };\n    this.overshootXTicker.onComplete = () => {\n      if (this.disabled[0]) return;\n      this.manual = false;\n      this.animate[this.xProp](this.overshootCoords.x, 0);\n    };\n    this.overshootYTicker.onUpdate = () => {\n      if (this.disabled[1]) return;\n      this.updated = true;\n      this.manual = true;\n      this.animate[this.yProp](this.overshootCoords.y, 0);\n    };\n    this.overshootYTicker.onComplete = () => {\n      if (this.disabled[1]) return;\n      this.manual = false;\n      this.animate[this.yProp](this.overshootCoords.y, 0);\n    };\n    this.updateTicker.onUpdate = () => this.update();\n    this.contained = !isUnd(container);\n    this.manual = false;\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = false;\n    this.released = false;\n    this.canScroll = false;\n    this.enabled = false;\n    this.initialized = false;\n    this.activeProp = this.disabled[1] ? xProp : yProp;\n    this.animate.animations[this.activeProp].onRender = () => {\n      const hasUpdated = this.updated;\n      const hasMoved = this.grabbed && hasUpdated;\n      const hasReleased = !hasMoved && this.released;\n      const x = this.x;\n      const y = this.y;\n      const dx = x - this.coords[2];\n      const dy = y - this.coords[3];\n      this.deltaX = dx;\n      this.deltaY = dy;\n      this.coords[2] = x;\n      this.coords[3] = y;\n      if (hasUpdated) {\n        this.onUpdate(this);\n      }\n      if (!hasReleased) {\n        this.updated = false;\n      } else {\n        this.computeVelocity(dx, dy);\n        this.angle = atan2(dy, dx);\n      }\n    };\n    this.animate.animations[this.activeProp].onComplete = () => {\n      if ((!this.grabbed && this.released)) {\n        // Set eleased to false before calling onSettle to avoid recursion\n        this.released = false;\n      }\n      if (!this.manual) {\n        this.deltaX = 0;\n        this.deltaY = 0;\n        this.velocity = 0;\n        this.velocityStack[0] = 0;\n        this.velocityStack[1] = 0;\n        this.velocityStack[2] = 0;\n        this.velocityStackIndex = 0;\n        this.onSettle(this);\n      }\n    };\n    this.resizeTicker = new Timer({\n      autoplay: false,\n      duration: 150 * globals.timeScale,\n      onComplete: () => {\n        this.onResize(this);\n        this.refresh();\n        this.onAfterResize(this);\n      },\n    }).init();\n    this.parameters = parameters;\n    this.resizeObserver = new ResizeObserver(() => {\n      if (this.initialized) {\n        this.resizeTicker.restart();\n      } else {\n        this.initialized = true;\n      }\n    });\n    this.enable();\n    this.refresh();\n    this.resizeObserver.observe(this.$container);\n    if (!isObj(target)) this.resizeObserver.observe(this.$target);\n  }\n\n  /**\n   * @param  {Number} dx\n   * @param  {Number} dy\n   * @return {Number}\n   */\n  computeVelocity(dx, dy) {\n    const prevTime = this.velocityTime;\n    const curTime = now();\n    const elapsed = curTime - prevTime;\n    if (elapsed < 17) return this.velocity;\n    this.velocityTime = curTime;\n    const velocityStack = this.velocityStack;\n    const vMul = this.velocityMultiplier;\n    const minV = this.minVelocity;\n    const maxV = this.maxVelocity;\n    const vi = this.velocityStackIndex;\n    velocityStack[vi] = round(clamp((sqrt(dx * dx + dy * dy) / elapsed) * vMul, minV, maxV), 5);\n    const velocity = max(velocityStack[0], velocityStack[1], velocityStack[2]);\n    this.velocity = velocity;\n    this.velocityStackIndex = (vi + 1) % 3;\n    return velocity;\n  }\n\n  /**\n   * @param {Number}  x\n   * @param {Boolean} [muteUpdateCallback]\n   * @return {this}\n   */\n  setX(x, muteUpdateCallback = false) {\n    if (this.disabled[0]) return;\n    const v = round(x, 5);\n    this.overshootXTicker.pause();\n    this.manual = true;\n    this.updated = !muteUpdateCallback;\n    this.destX = v;\n    this.snapped[0] = snap(v, this.snapX);\n    this.animate[this.xProp](v, 0);\n    this.manual = false;\n    return this;\n  }\n\n  /**\n   * @param {Number}  y\n   * @param {Boolean} [muteUpdateCallback]\n   * @return {this}\n   */\n  setY(y, muteUpdateCallback = false) {\n    if (this.disabled[1]) return;\n    const v = round(y, 5);\n    this.overshootYTicker.pause();\n    this.manual = true;\n    this.updated = !muteUpdateCallback;\n    this.destY = v;\n    this.snapped[1] = snap(v, this.snapY);\n    this.animate[this.yProp](v, 0);\n    this.manual = false;\n    return this;\n  }\n\n  get x() {\n    return round(/** @type {Number} */(this.animate[this.xProp]()), globals.precision);\n  }\n\n  set x(x) {\n    this.setX(x, false);\n  }\n\n  get y() {\n    return round(/** @type {Number} */(this.animate[this.yProp]()), globals.precision);\n  }\n\n  set y(y) {\n    this.setY(y, false);\n  }\n\n  get progressX() {\n    return mapRange(this.x, this.containerBounds[3], this.containerBounds[1], 0, 1);\n  }\n\n  set progressX(x) {\n    this.setX(mapRange(x, 0, 1, this.containerBounds[3], this.containerBounds[1]), false);\n  }\n\n  get progressY() {\n    return mapRange(this.y, this.containerBounds[0], this.containerBounds[2], 0, 1);\n  }\n\n  set progressY(y) {\n    this.setY(mapRange(y, 0, 1, this.containerBounds[0], this.containerBounds[2]), false);\n  }\n\n  updateScrollCoords() {\n    const sx = round(this.useWin ? win.scrollX : this.$container.scrollLeft, 0);\n    const sy = round(this.useWin ? win.scrollY : this.$container.scrollTop, 0);\n    const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n    const threshold = this.scrollThreshold;\n    this.scroll.x = sx;\n    this.scroll.y = sy;\n    this.scrollBounds[0] = sy - this.targetBounds[0] + cpt - threshold;\n    this.scrollBounds[1] = sx - this.targetBounds[1] - cpr + threshold;\n    this.scrollBounds[2] = sy - this.targetBounds[2] - cpb + threshold;\n    this.scrollBounds[3] = sx - this.targetBounds[3] + cpl - threshold;\n  }\n\n  updateBoundingValues() {\n    const $container = this.$container;\n    const cx = this.x;\n    const cy = this.y;\n    const cx2 = this.coords[2];\n    const cy2 =  this.coords[3];\n    // Prevents interfering with the scroll area in cases the target is outside of the container\n    // Make sure the temp coords are also adjuset to prevents wrong delta calculation on updates\n    this.coords[2] = 0;\n    this.coords[3] = 0;\n    this.setX(0, true);\n    this.setY(0, true);\n    this.transforms.remove();\n    const iw = this.window[0] = win.innerWidth;\n    const ih = this.window[1] = win.innerHeight;\n    const uw = this.useWin;\n    const sw = $container.scrollWidth;\n    const sh = $container.scrollHeight;\n    const fx = this.fixed;\n    const transformContainerRect = $container.getBoundingClientRect();\n    const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n    this.dragArea[0] = uw ? 0 : transformContainerRect.left;\n    this.dragArea[1] = uw ? 0 : transformContainerRect.top;\n    this.scrollView[0] = uw ? clamp(sw, iw, sw) : sw;\n    this.scrollView[1] = uw ? clamp(sh, ih, sh) : sh;\n    this.updateScrollCoords();\n    const { width, height, left, top, right, bottom } = $container.getBoundingClientRect();\n    this.dragArea[2] = round(uw ? clamp(width, iw, iw) : width, 0);\n    this.dragArea[3] = round(uw ? clamp(height, ih, ih) : height, 0);\n    const containerOverflow = getTargetValue($container, 'overflow');\n    const visibleOverflow = containerOverflow === 'visible';\n    const hiddenOverflow = containerOverflow === 'hidden';\n    this.canScroll = fx ? false :\n      this.contained &&\n      (($container === doc.body && visibleOverflow) || (!hiddenOverflow && !visibleOverflow)) &&\n      (sw > this.dragArea[2] + cpl - cpr || sh > this.dragArea[3] + cpt - cpb) &&\n      (!this.containerArray || (this.containerArray && !isArr(this.containerArray)));\n    if (this.contained) {\n      const sx = this.scroll.x;\n      const sy = this.scroll.y;\n      const canScroll = this.canScroll;\n      const targetRect = this.$target.getBoundingClientRect();\n      const hiddenLeft = canScroll ? uw ? 0 : $container.scrollLeft : 0;\n      const hiddenTop = canScroll ? uw ? 0 : $container.scrollTop : 0;\n      const hiddenRight = canScroll ? this.scrollView[0] - hiddenLeft - width : 0;\n      const hiddenBottom = canScroll ? this.scrollView[1] - hiddenTop - height : 0;\n      this.targetBounds[0] = round((targetRect.top + sy) - (uw ? 0 : top), 0);\n      this.targetBounds[1] = round((targetRect.right + sx) - (uw ? iw : right), 0);\n      this.targetBounds[2] = round((targetRect.bottom + sy) - (uw ? ih : bottom), 0);\n      this.targetBounds[3] = round((targetRect.left + sx) - (uw ? 0 : left), 0);\n      if (this.containerArray) {\n        this.containerBounds[0] = this.containerArray[0] + cpt;\n        this.containerBounds[1] = this.containerArray[1] - cpr;\n        this.containerBounds[2] = this.containerArray[2] - cpb;\n        this.containerBounds[3] = this.containerArray[3] + cpl;\n      } else {\n        this.containerBounds[0] = -round(targetRect.top - (fx ? clamp(top, 0, ih) : top) + hiddenTop - cpt, 0);\n        this.containerBounds[1] = -round(targetRect.right - (fx ? clamp(right, 0, iw) : right) - hiddenRight + cpr, 0);\n        this.containerBounds[2] = -round(targetRect.bottom - (fx ? clamp(bottom, 0, ih) : bottom) - hiddenBottom + cpb, 0);\n        this.containerBounds[3] = -round(targetRect.left - (fx ? clamp(left, 0, iw) : left) + hiddenLeft - cpl, 0);\n      }\n    }\n    this.transforms.revert();\n    // Restore coordinates\n    this.coords[2] = cx2;\n    this.coords[3] = cy2;\n    this.setX(cx, true);\n    this.setY(cy, true);\n  }\n\n  /**\n   * Returns 0 if not OB, 1 if x is OB, 2 if y is OB, 3 if both x and y are OB\n   *\n   * @param  {Array} bounds\n   * @param  {Number} x\n   * @param  {Number} y\n   * @return {Number}\n   */\n  isOutOfBounds(bounds, x, y) {\n    if (!this.contained) return 0;\n    const [ bt, br, bb, bl ] = bounds;\n    const [ dx, dy ] = this.disabled;\n    const obx = !dx && x < bl || !dx && x > br;\n    const oby = !dy && y < bt || !dy && y > bb;\n    return obx && !oby ? 1 : !obx && oby ? 2 : obx && oby ? 3 : 0;\n  }\n\n  refresh() {\n    const params = this.parameters;\n    const paramX = params.x;\n    const paramY = params.y;\n    const container = parseDraggableFunctionParameter(params.container, this);\n    const cp = parseDraggableFunctionParameter(params.containerPadding, this) || 0;\n    const containerPadding = /** @type {[Number, Number, Number, Number]} */(isArr(cp) ? cp : [cp, cp, cp, cp]);\n    const cx = this.x;\n    const cy = this.y;\n    const parsedCursorStyles = parseDraggableFunctionParameter(params.cursor, this);\n    const cursorStyles = { onHover: 'grab', onGrab: 'grabbing' };\n    if (parsedCursorStyles) {\n      const { onHover, onGrab } = /** @type {DraggableCursorParams} */(parsedCursorStyles);\n      if (onHover) cursorStyles.onHover = onHover;\n      if (onGrab) cursorStyles.onGrab = onGrab;\n    }\n    this.containerArray = isArr(container) ? container : null;\n    this.$container = /** @type {HTMLElement} */(container && !this.containerArray ? parseTargets(/** @type {DOMTarget} */(container))[0] : doc.body);\n    this.useWin = this.$container === doc.body;\n    /** @type {Window | HTMLElement} */\n    this.$scrollContainer = this.useWin ? win : this.$container;\n    this.isFinePointer = matchMedia('(pointer:fine)').matches;\n    this.containerPadding = setValue(containerPadding, [0, 0, 0, 0]);\n    this.containerFriction = clamp(setValue(parseDraggableFunctionParameter(params.containerFriction, this), .8), 0, 1);\n    this.releaseContainerFriction = clamp(setValue(parseDraggableFunctionParameter(params.releaseContainerFriction, this), this.containerFriction), 0, 1);\n    this.snapX = parseDraggableFunctionParameter(isObj(paramX) && !isUnd(paramX.snap) ? paramX.snap : params.snap, this);\n    this.snapY = parseDraggableFunctionParameter(isObj(paramY) && !isUnd(paramY.snap) ? paramY.snap : params.snap, this);\n    this.scrollSpeed = setValue(parseDraggableFunctionParameter(params.scrollSpeed, this), 1.5);\n    this.scrollThreshold = setValue(parseDraggableFunctionParameter(params.scrollThreshold, this), 20);\n    this.dragSpeed = setValue(parseDraggableFunctionParameter(params.dragSpeed, this), 1);\n    this.minVelocity = setValue(parseDraggableFunctionParameter(params.minVelocity, this), 0);\n    this.maxVelocity = setValue(parseDraggableFunctionParameter(params.maxVelocity, this), 50);\n    this.velocityMultiplier = setValue(parseDraggableFunctionParameter(params.velocityMultiplier, this), 1);\n    this.cursor = parsedCursorStyles === false ? false : cursorStyles;\n    this.updateBoundingValues();\n\n    // const ob = this.isOutOfBounds(this.containerBounds, this.x, this.y);\n    // if (ob === 1 || ob === 3) this.progressX = px;\n    // if (ob === 2 || ob === 3) this.progressY = py;\n\n    // if (this.initialized && this.contained) {\n    //   if (this.progressX !== px) this.progressX = px;\n    //   if (this.progressY !== py) this.progressY = py;\n    // }\n\n    const [ bt, br, bb, bl ] = this.containerBounds;\n    this.setX(clamp(cx, bl, br), true);\n    this.setY(clamp(cy, bt, bb), true);\n  }\n\n  update() {\n    this.updateScrollCoords();\n    if (this.canScroll) {\n      const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n      const [ sw, sh ] = this.scrollView;\n      const daw = this.dragArea[2];\n      const dah = this.dragArea[3];\n      const csx = this.scroll.x;\n      const csy = this.scroll.y;\n      const nsw = this.$container.scrollWidth;\n      const nsh = this.$container.scrollHeight;\n      const csw = this.useWin ? clamp(nsw, this.window[0], nsw) : nsw;\n      const csh = this.useWin ? clamp(nsh, this.window[1], nsh) : nsh;\n      const swd = sw - csw;\n      const shd = sh - csh;\n      // Handle cases where the scrollarea dimensions changes during drag\n      if (this.dragged && swd > 0) {\n        this.coords[0] -= swd;\n        this.scrollView[0] = csw;\n      }\n      if (this.dragged && shd > 0) {\n        this.coords[1] -= shd;\n        this.scrollView[1] = csh;\n      }\n      // Handle autoscroll when target is at the edges of the scroll bounds\n      const s = this.scrollSpeed * 10;\n      const threshold = this.scrollThreshold;\n      const [ x, y ] = this.coords;\n      const [ st, sr, sb, sl ] = this.scrollBounds;\n      const t = round(clamp((y - st + cpt) / threshold, -1, 0) * s, 0);\n      const r = round(clamp((x - sr - cpr) / threshold, 0, 1) * s, 0);\n      const b = round(clamp((y - sb - cpb) / threshold, 0, 1) * s, 0);\n      const l = round(clamp((x - sl + cpl) / threshold, -1, 0) * s, 0);\n      if (t || b || l || r) {\n        const [nx, ny] = this.disabled;\n        let scrollX = csx;\n        let scrollY = csy;\n        if (!nx) {\n          scrollX = round(clamp(csx + (l || r), 0, sw - daw), 0);\n          this.coords[0] -= csx - scrollX;\n        }\n        if (!ny) {\n          scrollY = round(clamp(csy + (t || b), 0, sh - dah), 0);\n          this.coords[1] -= csy - scrollY;\n        }\n        // Note: Safari mobile requires to use different scroll methods depending if using the window or not\n        if (this.useWin) {\n          this.$scrollContainer.scrollBy(-(csx - scrollX), -(csy - scrollY));\n        } else {\n          this.$scrollContainer.scrollTo(scrollX, scrollY);\n        }\n      }\n    }\n    const [ ct, cr, cb, cl ] = this.containerBounds;\n    const [ px1, py1, px2, py2, px3, py3 ] = this.pointer;\n    this.coords[0] += (px1 - px3) * this.dragSpeed;\n    this.coords[1] += (py1 - py3) * this.dragSpeed;\n    this.pointer[4] = px1;\n    this.pointer[5] = py1;\n    const [ cx, cy ] = this.coords;\n    const [ sx, sy ] = this.snapped;\n    const cf = (1 - this.containerFriction) * this.dragSpeed;\n    this.setX(cx > cr ? cr + (cx - cr) * cf : cx < cl ? cl + (cx - cl) * cf : cx, false);\n    this.setY(cy > cb ? cb + (cy - cb) * cf : cy < ct ? ct + (cy - ct) * cf : cy, false);\n    this.computeVelocity(px1 - px3, py1 - py3);\n    this.angle = atan2(py1 - py2, px1 - px2);\n    const [ nsx, nsy ] = this.snapped;\n    if (nsx !== sx && this.snapX || nsy !== sy && this.snapY) {\n      this.onSnap(this);\n    }\n  }\n\n  stop() {\n    this.updateTicker.pause();\n    this.overshootXTicker.pause();\n    this.overshootYTicker.pause();\n    // Pauses the in bounds onRelease animations\n    for (let prop in this.animate.animations) this.animate.animations[prop].pause();\n    remove(this, null, 'x');\n    remove(this, null, 'y');\n    remove(this, null, 'progressX');\n    remove(this, null, 'progressY');\n    remove(this.scroll); // Removes any active animations on the container scroll\n    remove(this.overshootCoords); // Removes active overshoot animations\n    return this;\n  }\n\n  /**\n   * @param {Number} [duration]\n   * @param {Number} [gap]\n   * @param {EasingParam} [ease]\n   * @return {this}\n   */\n  scrollInView(duration, gap = 0, ease = eases.inOutQuad) {\n    this.updateScrollCoords();\n    const x = this.destX;\n    const y = this.destY;\n    const scroll = this.scroll;\n    const scrollBounds = this.scrollBounds;\n    const canScroll = this.canScroll;\n    if (!this.containerArray && this.isOutOfBounds(scrollBounds, x, y)) {\n      const [ st, sr, sb, sl ] = scrollBounds;\n      const t = round(clamp(y - st, -1e12, 0), 0);\n      const r = round(clamp(x - sr, 0, maxValue), 0);\n      const b = round(clamp(y - sb, 0, maxValue), 0);\n      const l = round(clamp(x - sl, -1e12, 0), 0);\n      new JSAnimation(scroll, {\n        x: round(scroll.x + (l ? l - gap : r ? r + gap : 0), 0),\n        y: round(scroll.y + (t ? t - gap : b ? b + gap : 0), 0),\n        duration: isUnd(duration) ? 350 * globals.timeScale : duration,\n        ease,\n        onUpdate: () => {\n          this.canScroll = false;\n          this.$scrollContainer.scrollTo(scroll.x, scroll.y);\n        }\n      }).init().then(() => {\n        this.canScroll = canScroll;\n      });\n    }\n    return this;\n  }\n\n  handleHover() {\n    if (this.isFinePointer && this.cursor && !this.cursorStyles) {\n      this.cursorStyles = setTargetValues(this.$trigger, {\n        cursor: /** @type {DraggableCursorParams} */(this.cursor).onHover\n      });\n    }\n  }\n\n  /**\n   * @param  {Number} [duration]\n   * @param  {Number} [gap]\n   * @param  {EasingParam} [ease]\n   * @return {this}\n   */\n  animateInView(duration, gap = 0, ease = eases.inOutQuad) {\n    this.stop();\n    this.updateBoundingValues();\n    const x = this.x;\n    const y = this.y;\n    const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n    const bt = this.scroll.y - this.targetBounds[0] + cpt + gap;\n    const br = this.scroll.x - this.targetBounds[1] - cpr - gap;\n    const bb = this.scroll.y - this.targetBounds[2] - cpb - gap;\n    const bl = this.scroll.x - this.targetBounds[3] + cpl + gap;\n    const ob = this.isOutOfBounds([bt, br, bb, bl], x, y);\n    if (ob) {\n      const [ disabledX, disabledY ] = this.disabled;\n      const destX = clamp(snap(x, this.snapX), bl, br);\n      const destY = clamp(snap(y, this.snapY), bt, bb);\n      const dur = isUnd(duration) ? 350 * globals.timeScale : duration;\n      if (!disabledX && (ob === 1 || ob === 3)) this.animate[this.xProp](destX, dur, ease);\n      if (!disabledY && (ob === 2 || ob === 3)) this.animate[this.yProp](destY, dur, ease);\n    }\n    return this;\n  }\n\n  /**\n   * @param {MouseEvent|TouchEvent} e\n   */\n  handleDown(e) {\n    const $eTarget = /** @type {HTMLElement} */(e.target);\n    if (this.grabbed || /** @type {HTMLInputElement}  */($eTarget).type === 'range') return;\n\n    e.stopPropagation();\n\n    this.grabbed = true;\n    this.released = false;\n    this.stop();\n    this.updateBoundingValues();\n    const touches = /** @type {TouchEvent} */(e).changedTouches;\n    const eventX = touches ? touches[0].clientX : /** @type {MouseEvent} */(e).clientX;\n    const eventY = touches ? touches[0].clientY : /** @type {MouseEvent} */(e).clientY;\n    const { x, y } = this.transforms.normalizePoint(eventX, eventY);\n    const [ ct, cr, cb, cl ] = this.containerBounds;\n    const cf = (1 - this.containerFriction) * this.dragSpeed;\n    const cx = this.x;\n    const cy = this.y;\n    this.coords[0] = this.coords[2] = !cf ? cx : cx > cr ? cr + (cx - cr) / cf : cx < cl ? cl + (cx - cl) / cf : cx;\n    this.coords[1] = this.coords[3] = !cf ? cy : cy > cb ? cb + (cy - cb) / cf : cy < ct ? ct + (cy - ct) / cf : cy;\n    this.pointer[0] = x;\n    this.pointer[1] = y;\n    this.pointer[2] = x;\n    this.pointer[3] = y;\n    this.pointer[4] = x;\n    this.pointer[5] = y;\n    this.pointer[6] = x;\n    this.pointer[7] = y;\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.velocity = 0;\n    this.velocityStack[0] = 0;\n    this.velocityStack[1] = 0;\n    this.velocityStack[2] = 0;\n    this.velocityStackIndex = 0;\n    this.angle = 0;\n    if (this.targetStyles) {\n      this.targetStyles.revert();\n      this.targetStyles = null;\n    }\n    const z = /** @type {Number} */(getTargetValue(this.$target, 'zIndex', false));\n    zIndex = (z > zIndex ? z : zIndex) + 1;\n    this.targetStyles = setTargetValues(this.$target, { zIndex });\n    if (this.triggerStyles) {\n      this.triggerStyles.revert();\n      this.triggerStyles = null;\n    }\n    if (this.cursorStyles) {\n      this.cursorStyles.revert();\n      this.cursorStyles = null;\n    }\n    if (this.isFinePointer && this.cursor) {\n      this.bodyStyles = setTargetValues(doc.body, {\n        cursor: /** @type {DraggableCursorParams} */(this.cursor).onGrab\n      });\n    }\n    this.scrollInView(100, 0, eases.out(3));\n    this.onGrab(this);\n\n    doc.addEventListener('touchmove', this);\n    doc.addEventListener('touchend', this);\n    doc.addEventListener('touchcancel', this);\n    doc.addEventListener('mousemove', this);\n    doc.addEventListener('mouseup', this);\n    doc.addEventListener('selectstart', this);\n  }\n\n  /**\n   * @param {MouseEvent|TouchEvent} e\n   */\n  handleMove(e) {\n    if (!this.grabbed) return;\n    const touches = /** @type {TouchEvent} */(e).changedTouches;\n    const eventX = touches ? touches[0].clientX : /** @type {MouseEvent} */(e).clientX;\n    const eventY = touches ? touches[0].clientY : /** @type {MouseEvent} */(e).clientY;\n    const { x, y } = this.transforms.normalizePoint(eventX, eventY);\n    const movedX = x - this.pointer[6];\n    const movedY = y - this.pointer[7];\n\n    let $parent = /** @type {HTMLElement} */(e.target);\n    let isAtTop = false;\n    let isAtBottom = false;\n    let canTouchScroll = false;\n\n    while (touches && $parent && $parent !== this.$trigger) {\n      const overflowY = getTargetValue($parent, 'overflow-y');\n      if (overflowY !== 'hidden' && overflowY !== 'visible') {\n        const { scrollTop, scrollHeight, clientHeight } = $parent;\n        if (scrollHeight > clientHeight) {\n          canTouchScroll = true;\n          isAtTop = scrollTop <= 3;\n          isAtBottom = scrollTop >= (scrollHeight - clientHeight) - 3;\n          break;\n        }\n      }\n      $parent = /** @type {HTMLElement} */($parent.parentNode);\n    }\n\n    if (canTouchScroll && ((!isAtTop && !isAtBottom) || (isAtTop && movedY < 0) || (isAtBottom && movedY > 0))) {\n\n      this.pointer[0] = x;\n      this.pointer[1] = y;\n      this.pointer[2] = x;\n      this.pointer[3] = y;\n      this.pointer[4] = x;\n      this.pointer[5] = y;\n      this.pointer[6] = x;\n      this.pointer[7] = y;\n\n    } else {\n\n      preventDefault(e);\n\n      // Needed to prevents click on handleUp\n      if (!this.triggerStyles) this.triggerStyles = setTargetValues(this.$trigger, { pointerEvents: 'none' });\n      // Needed to prevent page scroll while dragging on touch devvice\n      this.$trigger.addEventListener('touchstart', preventDefault, { passive: false });\n      this.$trigger.addEventListener('touchmove', preventDefault, { passive: false });\n      this.$trigger.addEventListener('touchend', preventDefault);\n\n\n      if ((!this.disabled[0] && abs(movedX) > 3) || (!this.disabled[1] && abs(movedY) > 3)) {\n\n        this.updateTicker.resume();\n        this.pointer[2] = this.pointer[0];\n        this.pointer[3] = this.pointer[1];\n        this.pointer[0] = x;\n        this.pointer[1] = y;\n        this.dragged = true;\n        this.released = false;\n        this.onDrag(this);\n      }\n    }\n  }\n\n  handleUp() {\n\n    if (!this.grabbed) return;\n\n    this.updateTicker.pause();\n\n    if (this.triggerStyles) {\n      this.triggerStyles.revert();\n      this.triggerStyles = null;\n    }\n\n    if (this.bodyStyles) {\n      this.bodyStyles.revert();\n      this.bodyStyles = null;\n    }\n\n    const [ disabledX, disabledY ] = this.disabled;\n    const [ px1, py1, px2, py2, px3, py3 ] = this.pointer;\n    const [ ct, cr, cb, cl ] = this.containerBounds;\n    const [ sx, sy ] = this.snapped;\n    const springX = this.releaseXSpring;\n    const springY = this.releaseYSpring;\n    const releaseEase = this.releaseEase;\n    const hasReleaseSpring = this.hasReleaseSpring;\n    const overshootCoords = this.overshootCoords;\n    const cx = this.x;\n    const cy = this.y;\n    const pv = this.computeVelocity(px1 - px3, py1 - py3);\n    const pa = this.angle = atan2(py1 - py2, px1 - px2);\n    const ds = pv * 150;\n    const cf = (1 - this.releaseContainerFriction) * this.dragSpeed;\n    const nx = cx + (cos(pa) * ds);\n    const ny = cy + (sin(pa) * ds);\n    const bx = nx > cr ? cr + (nx - cr) * cf : nx < cl ? cl + (nx - cl) * cf : nx;\n    const by = ny > cb ? cb + (ny - cb) * cf : ny < ct ? ct + (ny - ct) * cf : ny;\n    const dx = this.destX = clamp(round(snap(bx, this.snapX), 5), cl, cr);\n    const dy = this.destY = clamp(round(snap(by, this.snapY), 5), ct, cb);\n    const ob = this.isOutOfBounds(this.containerBounds, nx, ny);\n\n    let durationX = 0;\n    let durationY = 0;\n    let easeX = releaseEase;\n    let easeY = releaseEase;\n    let longestReleaseDuration = 0;\n\n    overshootCoords.x = cx;\n    overshootCoords.y = cy;\n\n    if (!disabledX) {\n      const directionX = dx === cr ? cx > cr ? -1 : 1 : cx < cl ? -1 : 1;\n      const distanceX = round(cx - dx, 0);\n      springX.velocity = disabledY && hasReleaseSpring ? distanceX ? (ds * directionX) / abs(distanceX) : 0 : pv;\n      const { ease, duration, restDuration } = springX;\n      durationX = cx === dx ? 0 : hasReleaseSpring ? duration : duration - (restDuration * globals.timeScale);\n      if (hasReleaseSpring) easeX = ease;\n      if (durationX > longestReleaseDuration) longestReleaseDuration = durationX;\n    }\n\n    if (!disabledY) {\n      const directionY = dy === cb ? cy > cb ? -1 : 1 : cy < ct ? -1 : 1;\n      const distanceY = round(cy - dy, 0);\n      springY.velocity = disabledX && hasReleaseSpring ? distanceY ? (ds * directionY) / abs(distanceY) : 0 : pv;\n      const { ease, duration, restDuration } = springY;\n      durationY = cy === dy ? 0 : hasReleaseSpring ? duration : duration - (restDuration * globals.timeScale);\n      if (hasReleaseSpring) easeY = ease;\n      if (durationY > longestReleaseDuration) longestReleaseDuration = durationY;\n    }\n\n    if (!hasReleaseSpring && ob && cf && (durationX || durationY)) {\n\n        const composition = compositionTypes.blend;\n\n        new JSAnimation(overshootCoords, {\n          x: { to: bx, duration: durationX * .65 },\n          y: { to: by, duration: durationY * .65 },\n          ease: releaseEase,\n          composition,\n        }).init();\n\n        new JSAnimation(overshootCoords, {\n          x: { to: dx, duration: durationX },\n          y: { to: dy, duration: durationY },\n          ease: releaseEase,\n          composition,\n        }).init();\n\n        this.overshootXTicker.stretch(durationX).restart();\n        this.overshootYTicker.stretch(durationY).restart();\n\n    } else {\n\n      if (!disabledX) this.animate[this.xProp](dx, durationX, easeX);\n      if (!disabledY) this.animate[this.yProp](dy, durationY, easeY);\n\n    }\n\n    this.scrollInView(longestReleaseDuration, this.scrollThreshold, releaseEase);\n\n    let hasSnapped = false;\n\n    if (dx !== sx) {\n      this.snapped[0] = dx;\n      if (this.snapX) hasSnapped = true;\n    }\n\n    if (dy !== sy && this.snapY) {\n      this.snapped[1] = dy;\n      if (this.snapY) hasSnapped = true;\n    }\n\n    if (hasSnapped) this.onSnap(this);\n\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = true;\n    this.released = true;\n\n    // It's important to trigger the callback after the release animations to be able to cancel them\n    this.onRelease(this);\n\n    this.$trigger.removeEventListener('touchstart', preventDefault);\n    this.$trigger.removeEventListener('touchmove', preventDefault);\n    this.$trigger.removeEventListener('touchend', preventDefault);\n\n    doc.removeEventListener('touchmove', this);\n    doc.removeEventListener('touchend', this);\n    doc.removeEventListener('touchcancel', this);\n    doc.removeEventListener('mousemove', this);\n    doc.removeEventListener('mouseup', this);\n    doc.removeEventListener('selectstart', this);\n  }\n\n  reset() {\n    this.stop();\n    this.resizeTicker.pause();\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = false;\n    this.released = false;\n    this.canScroll = false;\n    this.setX(0, true);\n    this.setY(0, true);\n    this.coords[0] = 0;\n    this.coords[1] = 0;\n    this.pointer[0] = 0;\n    this.pointer[1] = 0;\n    this.pointer[2] = 0;\n    this.pointer[3] = 0;\n    this.pointer[4] = 0;\n    this.pointer[5] = 0;\n    this.pointer[6] = 0;\n    this.pointer[7] = 0;\n    this.velocity = 0;\n    this.velocityStack[0] = 0;\n    this.velocityStack[1] = 0;\n    this.velocityStack[2] = 0;\n    this.velocityStackIndex = 0;\n    this.angle = 0;\n    return this;\n  }\n\n  enable() {\n    if (!this.enabled) {\n      this.enabled = true;\n      this.$target.classList.remove('is-disabled');\n      this.touchActionStyles = setTargetValues(this.$trigger, {\n        touchAction: this.disabled[0] ? 'pan-x' : this.disabled[1] ? 'pan-y' : 'none'\n      });\n      this.$trigger.addEventListener('touchstart', this, { passive: true });\n      this.$trigger.addEventListener('mousedown', this, { passive: true });\n      this.$trigger.addEventListener('mouseenter', this);\n    }\n    return this;\n  }\n\n  disable() {\n    this.enabled = false;\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = false;\n    this.released = false;\n    this.canScroll = false;\n    this.touchActionStyles.revert();\n    if (this.cursorStyles) {\n      this.cursorStyles.revert();\n      this.cursorStyles = null;\n    }\n    if (this.triggerStyles) {\n      this.triggerStyles.revert();\n      this.triggerStyles = null;\n    }\n    if (this.bodyStyles) {\n      this.bodyStyles.revert();\n      this.bodyStyles = null;\n    }\n    if (this.targetStyles) {\n      this.targetStyles.revert();\n      this.targetStyles = null;\n    }\n    this.stop();\n    this.$target.classList.add('is-disabled');\n    this.$trigger.removeEventListener('touchstart', this);\n    this.$trigger.removeEventListener('mousedown', this);\n    this.$trigger.removeEventListener('mouseenter', this);\n    doc.removeEventListener('touchmove', this);\n    doc.removeEventListener('touchend', this);\n    doc.removeEventListener('touchcancel', this);\n    doc.removeEventListener('mousemove', this);\n    doc.removeEventListener('mouseup', this);\n    doc.removeEventListener('selectstart', this);\n    return this;\n  }\n\n  revert() {\n    this.reset();\n    this.disable();\n    this.$target.classList.remove('is-disabled');\n    this.updateTicker.revert();\n    this.overshootXTicker.revert();\n    this.overshootYTicker.revert();\n    this.resizeTicker.revert();\n    this.animate.revert();\n    return this;\n  }\n\n  /**\n   * @param {Event} e\n   */\n  handleEvent(e) {\n    switch (e.type) {\n      case 'mousedown':\n        this.handleDown(/** @type {MouseEvent} */(e));\n        break;\n      case 'touchstart':\n        this.handleDown(/** @type {TouchEvent} */(e));\n        break;\n      case 'mousemove':\n        this.handleMove(/** @type {MouseEvent} */(e));\n        break;\n      case 'touchmove':\n        this.handleMove(/** @type {TouchEvent} */(e));\n        break;\n      case 'mouseup':\n        this.handleUp();\n        break;\n      case 'touchend':\n        this.handleUp();\n        break;\n      case 'touchcancel':\n        this.handleUp();\n        break;\n      case 'mouseenter':\n        this.handleHover();\n        break;\n      case 'selectstart':\n        preventDefault(e);\n        break;\n    }\n  }\n}\n\n/**\n * @param {TargetsParam} target\n * @param {DraggableParams} [parameters]\n * @return {Draggable}\n */\nconst createDraggable = (target, parameters) => new Draggable(target, parameters);\n\n\n\n\n/**\n * @typedef {Object} ReactRef\n * @property {HTMLElement|SVGElement|null} [current]\n */\n\n/**\n * @typedef {Object} AngularRef\n * @property {HTMLElement|SVGElement} [nativeElement]\n */\n\n/**\n * @typedef {Object} ScopeParams\n * @property {DOMTargetSelector|ReactRef|AngularRef} [root]\n * @property {DefaultsParams} [defaults]\n * @property {Record<String, String>} [mediaQueries]\n */\n\n/**\n * @callback ScopeCleanup\n * @param {Scope} [scope]\n */\n\n/**\n * @callback ScopeConstructor\n * @param {Scope} [scope]\n * @return {ScopeCleanup|void}\n */\n\n/**\n * @callback ScopeMethod\n * @param {...*} args\n * @return {ScopeCleanup|void}\n */\n\nclass Scope {\n  /** @param {ScopeParams} [parameters] */\n  constructor(parameters = {}) {\n    if (globals.scope) globals.scope.revertibles.push(this);\n    const rootParam = parameters.root;\n    /** @type {Document|DOMTarget} */\n    let root = doc;\n    if (rootParam) {\n      root = /** @type {ReactRef} */(rootParam).current ||\n             /** @type {AngularRef} */(rootParam).nativeElement ||\n             parseTargets(/** @type {DOMTargetSelector} */(rootParam))[0] ||\n             doc;\n    }\n    const scopeDefaults = parameters.defaults;\n    const globalDefault = globals.defaults;\n    const mediaQueries = parameters.mediaQueries;\n    /** @type {DefaultsParams} */\n    this.defaults = scopeDefaults ? mergeObjects(scopeDefaults, globalDefault) : globalDefault;\n    /** @type {Document|DOMTarget} */\n    this.root = root;\n    /** @type {Array<ScopeConstructor>} */\n    this.constructors = [];\n    /** @type {Array<Function>} */\n    this.revertConstructors = [];\n    /** @type {Array<Revertible>} */\n    this.revertibles = [];\n    /** @type {Record<String, Function>} */\n    this.methods = {};\n    /** @type {Record<String, Boolean>} */\n    this.matches = {};\n    /** @type {Record<String, MediaQueryList>} */\n    this.mediaQueryLists = {};\n    /** @type {Record<String, any>} */\n    this.data = {};\n    if (mediaQueries) {\n      for (let mq in mediaQueries) {\n        const _mq = win.matchMedia(mediaQueries[mq]);\n        this.mediaQueryLists[mq] = _mq;\n        _mq.addEventListener('change', this);\n      }\n    }\n  }\n\n  /**\n   * @callback ScoppedCallback\n   * @param {this} scope\n   * @return {any}\n   *\n   * @param {ScoppedCallback} cb\n   * @return {this}\n   */\n  execute(cb) {\n    let activeScope = globals.scope;\n    let activeRoot = globals.root;\n    let activeDefaults = globals.defaults;\n    globals.scope = this;\n    globals.root = this.root;\n    globals.defaults = this.defaults;\n    const mqs = this.mediaQueryLists;\n    for (let mq in mqs) this.matches[mq] = mqs[mq].matches;\n    const returned = cb(this);\n    globals.scope = activeScope;\n    globals.root = activeRoot;\n    globals.defaults = activeDefaults;\n    return returned;\n  }\n\n  /**\n   * @return {this}\n   */\n  refresh() {\n    this.execute(() => {\n      let i = this.revertibles.length;\n      let y = this.revertConstructors.length;\n      while (i--) this.revertibles[i].revert();\n      while (y--) this.revertConstructors[y](this);\n      this.revertibles.length = 0;\n      this.revertConstructors.length = 0;\n      this.constructors.forEach( constructor => {\n        const revertConstructor = constructor(this);\n        if (revertConstructor) {\n          this.revertConstructors.push(revertConstructor);\n        }\n      });\n    });\n    return this;\n  }\n\n  /**\n   * @callback contructorCallback\n   * @param {this} self\n   *\n   * @overload\n   * @param {String} a1\n   * @param {ScopeMethod} a2\n   * @return {this}\n   *\n   * @overload\n   * @param {contructorCallback} a1\n   * @return {this}\n   *\n   * @param {String|contructorCallback} a1\n   * @param {ScopeMethod} [a2]\n   */\n  add(a1, a2) {\n    if (isFnc(a1)) {\n      const constructor = /** @type {contructorCallback} */(a1);\n      this.constructors.push(constructor);\n      this.execute(() => {\n        const revertConstructor = constructor(this);\n        if (revertConstructor) {\n          this.revertConstructors.push(revertConstructor);\n        }\n      });\n    } else {\n      this.methods[/** @type {String} */(a1)] = (/** @type {any} */...args) => this.execute(() => a2(...args));\n    }\n    return this;\n  }\n\n  /**\n   * @param {Event} e\n   */\n  handleEvent(e) {\n    switch (e.type) {\n      case 'change':\n        this.refresh();\n        break;\n    }\n  }\n\n  revert() {\n    const revertibles = this.revertibles;\n    const revertConstructors = this.revertConstructors;\n    const mqs = this.mediaQueryLists;\n    let i = revertibles.length;\n    let y = revertConstructors.length;\n    while (i--) revertibles[i].revert();\n    while (y--) revertConstructors[y](this);\n    for (let mq in mqs) mqs[mq].removeEventListener('change', this);\n    revertibles.length = 0;\n    revertConstructors.length = 0;\n    this.constructors.length = 0;\n    this.matches = {};\n    this.methods = {};\n    this.mediaQueryLists = {};\n    this.data = {};\n  }\n}\n\n/**\n * @param {ScopeParams} [params]\n * @return {Scope}\n */\nconst createScope = params => new Scope(params);\n\n/**\n * @typedef {String|Number} ScrollThresholdValue\n */\n\n/**\n * @return {Number}\n */\nconst getMaxViewHeight = () => {\n  const $el = document.createElement('div');\n  doc.body.appendChild($el);\n  $el.style.height = '100lvh';\n  const height = $el.offsetHeight;\n  doc.body.removeChild($el);\n  return height;\n};\n\n/**\n * @template {ScrollThresholdValue|String|Number|Boolean|Function|Object} T\n * @param {T | ((observer: ScrollObserver) => T)} value\n * @param {ScrollObserver} scroller\n * @return {T}\n */\nconst parseScrollObserverFunctionParameter = (value, scroller) => value && isFnc(value) ? /** @type {Function} */(value)(scroller) : value;\n\nconst scrollContainers = new Map();\n\nclass ScrollContainer {\n  /**\n   * @param {HTMLElement} $el\n   */\n  constructor($el) {\n    /** @type {HTMLElement} */\n    this.element = $el;\n    /** @type {Boolean} */\n    this.useWin = this.element === doc.body;\n    /** @type {Number} */\n    this.winWidth = 0;\n    /** @type {Number} */\n    this.winHeight = 0;\n    /** @type {Number} */\n    this.width = 0;\n    /** @type {Number} */\n    this.height = 0;\n    /** @type {Number} */\n    this.left = 0;\n    /** @type {Number} */\n    this.top = 0;\n    /** @type {Number} */\n    this.zIndex = 0;\n    /** @type {Number} */\n    this.scrollX = 0;\n    /** @type {Number} */\n    this.scrollY = 0;\n    /** @type {Number} */\n    this.prevScrollX = 0;\n    /** @type {Number} */\n    this.prevScrollY = 0;\n    /** @type {Number} */\n    this.scrollWidth = 0;\n    /** @type {Number} */\n    this.scrollHeight = 0;\n    /** @type {Number} */\n    this.velocity = 0;\n    /** @type {Boolean} */\n    this.backwardX = false;\n    /** @type {Boolean} */\n    this.backwardY = false;\n    /** @type {Timer} */\n    this.scrollTicker = new Timer({\n      autoplay: false,\n      onBegin: () => this.dataTimer.resume(),\n      onUpdate: () => {\n        const backwards = this.backwardX || this.backwardY;\n        forEachChildren(this, (/** @type {ScrollObserver} */child) => child.handleScroll(), backwards);\n      },\n      onComplete: () => this.dataTimer.pause()\n    }).init();\n    /** @type {Timer} */\n    this.dataTimer = new Timer({\n      autoplay: false,\n      frameRate: 30,\n      onUpdate: self => {\n        const dt = self.deltaTime;\n        const px = this.prevScrollX;\n        const py = this.prevScrollY;\n        const nx = this.scrollX;\n        const ny = this.scrollY;\n        const dx = px - nx;\n        const dy = py - ny;\n        this.prevScrollX = nx;\n        this.prevScrollY = ny;\n        if (dx) this.backwardX = px > nx;\n        if (dy) this.backwardY = py > ny;\n        this.velocity = round(dt > 0 ? Math.sqrt(dx * dx + dy * dy) / dt : 0, 5);\n      }\n    }).init();\n    /** @type {Timer} */\n    this.resizeTicker = new Timer({\n      autoplay: false,\n      duration: 250 * globals.timeScale,\n      onComplete: () => {\n        this.updateWindowBounds();\n        this.refreshScrollObservers();\n        this.handleScroll();\n      }\n    }).init();\n    /** @type {Timer} */\n    this.wakeTicker = new Timer({\n      autoplay: false,\n      duration: 500 * globals.timeScale,\n      onBegin: () => {\n        this.scrollTicker.resume();\n      },\n      onComplete: () => {\n        this.scrollTicker.pause();\n      }\n    }).init();\n    /** @type {ScrollObserver} */\n    this._head = null;\n    /** @type {ScrollObserver} */\n    this._tail = null;\n    this.updateScrollCoords();\n    this.updateWindowBounds();\n    this.updateBounds();\n    this.refreshScrollObservers();\n    this.handleScroll();\n    this.resizeObserver = new ResizeObserver(() => this.resizeTicker.restart());\n    this.resizeObserver.observe(this.element);\n    (this.useWin ? win : this.element).addEventListener('scroll', this, false);\n  }\n\n  updateScrollCoords() {\n    const useWin = this.useWin;\n    const $el = this.element;\n    this.scrollX = round(useWin ? win.scrollX : $el.scrollLeft, 0);\n    this.scrollY = round(useWin ? win.scrollY : $el.scrollTop, 0);\n  }\n\n  updateWindowBounds() {\n    this.winWidth = win.innerWidth;\n    this.winHeight = getMaxViewHeight();\n  }\n\n  updateBounds() {\n    const style = getComputedStyle(this.element);\n    const $el = this.element;\n    this.scrollWidth = $el.scrollWidth + parseFloat(style.marginLeft) + parseFloat(style.marginRight);\n    this.scrollHeight = $el.scrollHeight + parseFloat(style.marginTop) + parseFloat(style.marginBottom);\n    this.updateWindowBounds();\n    let width, height;\n    if (this.useWin) {\n      width = this.winWidth;\n      height = this.winHeight;\n    } else {\n      const elRect = $el.getBoundingClientRect();\n      width = elRect.width;\n      height = elRect.height;\n      this.top = elRect.top;\n      this.left = elRect.left;\n    }\n    this.width = width;\n    this.height = height;\n  }\n\n  refreshScrollObservers() {\n    forEachChildren(this, (/** @type {ScrollObserver} */child) => {\n      if (child._debug) {\n        child.removeDebug();\n      }\n    });\n    this.updateBounds();\n    forEachChildren(this, (/** @type {ScrollObserver} */child) => {\n      child.refresh();\n      if (child._debug) {\n        child.debug();\n      }\n    });\n  }\n\n  refresh() {\n    this.updateWindowBounds();\n    this.updateBounds();\n    this.refreshScrollObservers();\n    this.handleScroll();\n  }\n\n  handleScroll() {\n    this.updateScrollCoords();\n    this.wakeTicker.restart();\n  }\n\n  /**\n   * @param {Event} e\n   */\n  handleEvent(e) {\n    switch (e.type) {\n      case 'scroll':\n        this.handleScroll();\n        break;\n    }\n  }\n\n  revert() {\n    this.scrollTicker.cancel();\n    this.dataTimer.cancel();\n    this.resizeTicker.cancel();\n    this.wakeTicker.cancel();\n    this.resizeObserver.unobserve(this.element);\n    (this.useWin ? win : this.element).removeEventListener('scroll', this);\n    scrollContainers.delete(this.element);\n  }\n}\n\n/**\n * @param {TargetsParam} target\n * @return {ScrollContainer}\n */\nconst registerAndGetScrollContainer = target => {\n  const $el = /** @type {HTMLElement} */(target ? parseTargets(target)[0] || doc.body : doc.body);\n  let scrollContainer = scrollContainers.get($el);\n  if (!scrollContainer) {\n    scrollContainer = new ScrollContainer($el);\n    scrollContainers.set($el, scrollContainer);\n  }\n  return scrollContainer;\n};\n\n/**\n * @param {HTMLElement} $el\n * @param {Number|string} v\n * @param {Number} size\n * @param {Number} [under]\n * @param {Number} [over]\n * @return {Number}\n */\nconst convertValueToPx = ($el, v, size, under, over) => {\n  const clampMin = v === 'min';\n  const clampMax = v === 'max';\n  const value = v === 'top' || v === 'left' || v === 'start' || clampMin ? 0 :\n                v === 'bottom' || v === 'right' || v === 'end' || clampMax ? '100%' :\n                v === 'center' ? '50%' :\n                v;\n  const { n, u } = decomposeRawValue(value, decomposedOriginalValue);\n  let px = n;\n  if (u === '%') {\n    px = (n / 100) * size;\n  } else if (u) {\n    px = convertValueUnit($el, decomposedOriginalValue, 'px', true).n;\n  }\n  if (clampMax && under < 0) px += under;\n  if (clampMin && over > 0) px += over;\n  return px;\n};\n\n/**\n * @param {HTMLElement} $el\n * @param {ScrollThresholdValue} v\n * @param {Number} size\n * @param {Number} [under]\n * @param {Number} [over]\n * @return {Number}\n */\nconst parseBoundValue = ($el, v, size, under, over) => {\n  /** @type {Number} */\n  let value;\n  if (isStr(v)) {\n    const matchedOperator = relativeValuesExecRgx.exec(/** @type {String} */(v));\n    if (matchedOperator) {\n      const splitter = matchedOperator[0];\n      const operator = splitter[0];\n      const splitted = /** @type {String} */(v).split(splitter);\n      const clampMin = splitted[0] === 'min';\n      const clampMax = splitted[0] === 'max';\n      const valueAPx = convertValueToPx($el, splitted[0], size, under, over);\n      const valueBPx = convertValueToPx($el, splitted[1], size, under, over);\n      if (clampMin) {\n        const min = getRelativeValue(convertValueToPx($el, 'min', size), valueBPx, operator);\n        value = min < valueAPx ? valueAPx : min;\n      } else if (clampMax) {\n        const max = getRelativeValue(convertValueToPx($el, 'max', size), valueBPx, operator);\n        value = max > valueAPx ? valueAPx : max;\n      } else {\n        value = getRelativeValue(valueAPx, valueBPx, operator);\n      }\n    } else {\n      value = convertValueToPx($el, v, size, under, over);\n    }\n  } else {\n    value = /** @type {Number} */(v);\n  }\n  return round(value, 0);\n};\n\n/**\n * @param {JSAnimation} linked\n * @return {HTMLElement}\n */\nconst getAnimationDomTarget = linked => {\n  let $linkedTarget;\n  const linkedTargets = linked.targets;\n  for (let i = 0, l = linkedTargets.length; i < l; i++) {\n    const target = linkedTargets[i];\n    if (target[isDomSymbol]) {\n      $linkedTarget = /** @type {HTMLElement} */(target);\n      break;\n    }\n  }\n  return $linkedTarget;\n};\n\nlet scrollerIndex = 0;\n\nconst debugColors = ['#FF4B4B','#FF971B','#FFC730','#F9F640','#7AFF5A','#18FF74','#17E09B','#3CFFEC','#05DBE9','#33B3F1','#638CF9','#C563FE','#FF4FCF','#F93F8A'];\n\n/**\n * @typedef {Object} ScrollThresholdParam\n * @property {ScrollThresholdValue} [target]\n * @property {ScrollThresholdValue} [container]\n */\n\n/**\n * @callback ScrollObserverAxisCallback\n * @param {ScrollObserver} self\n * @return {'x'|'y'}\n */\n\n/**\n * @callback ScrollThresholdCallback\n * @param {ScrollObserver} self\n * @return {ScrollThresholdValue|ScrollThresholdParam}\n */\n\n/**\n * @typedef {Object} ScrollObserverParams\n * @property {Number|String} [id]\n * @property {Boolean|Number|String|EasingParam} [sync]\n * @property {TargetsParam} [container]\n * @property {TargetsParam} [target]\n * @property {'x'|'y'|ScrollObserverAxisCallback|((observer: ScrollObserver) => 'x'|'y'|ScrollObserverAxisCallback)} [axis]\n * @property {ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback|((observer: ScrollObserver) => ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback)} [enter]\n * @property {ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback|((observer: ScrollObserver) => ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback)} [leave]\n * @property {Boolean|((observer: ScrollObserver) => Boolean)} [repeat]\n * @property {Boolean} [debug]\n * @property {Callback<ScrollObserver>} [onEnter]\n * @property {Callback<ScrollObserver>} [onLeave]\n * @property {Callback<ScrollObserver>} [onEnterForward]\n * @property {Callback<ScrollObserver>} [onLeaveForward]\n * @property {Callback<ScrollObserver>} [onEnterBackward]\n * @property {Callback<ScrollObserver>} [onLeaveBackward]\n * @property {Callback<ScrollObserver>} [onUpdate]\n * @property {Callback<ScrollObserver>} [onSyncComplete]\n */\n\nclass ScrollObserver {\n  /**\n   * @param {ScrollObserverParams} parameters\n   */\n  constructor(parameters = {}) {\n    if (globals.scope) globals.scope.revertibles.push(this);\n    const syncMode = setValue(parameters.sync, 'play pause');\n    const ease = syncMode ? parseEasings(/** @type {EasingParam} */(syncMode)) : null;\n    const isLinear = syncMode && (syncMode === 'linear' || syncMode === none);\n    const isEase = syncMode && !(ease === none && !isLinear);\n    const isSmooth = syncMode && (isNum(syncMode) || syncMode === true || isLinear);\n    const isMethods = syncMode && (isStr(syncMode) && !isEase && !isSmooth);\n    const syncMethods = isMethods ? /** @type {String} */(syncMode).split(' ').map(\n      (/** @type {String} */m) => () => {\n        const linked = this.linked;\n        return linked && linked[m] ? linked[m]() : null;\n      }\n    ) : null;\n    const biDirSync = isMethods && syncMethods.length > 2;\n    /** @type {Number} */\n    this.index = scrollerIndex++;\n    /** @type {String|Number} */\n    this.id = !isUnd(parameters.id) ? parameters.id : this.index;\n    /** @type {ScrollContainer} */\n    this.container = registerAndGetScrollContainer(parameters.container);\n    /** @type {HTMLElement} */\n    this.target = null;\n    /** @type {Tickable|WAAPIAnimation} */\n    this.linked = null;\n    /** @type {Boolean} */\n    this.repeat = null;\n    /** @type {Boolean} */\n    this.horizontal = null;\n    /** @type {ScrollThresholdParam|ScrollThresholdValue|ScrollThresholdCallback} */\n    this.enter = null;\n    /** @type {ScrollThresholdParam|ScrollThresholdValue|ScrollThresholdCallback} */\n    this.leave = null;\n    /** @type {Boolean} */\n    this.sync = isEase || isSmooth || !!syncMethods;\n    /** @type {EasingFunction} */\n    this.syncEase = isEase ? ease : null;\n    /** @type {Number} */\n    this.syncSmooth = isSmooth ? syncMode === true || isLinear ? 1 : /** @type {Number} */(syncMode) : null;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncEnter = syncMethods && !biDirSync && syncMethods[0] ? syncMethods[0] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncLeave = syncMethods && !biDirSync && syncMethods[1] ? syncMethods[1] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncEnterForward = syncMethods && biDirSync && syncMethods[0] ? syncMethods[0] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncLeaveForward = syncMethods && biDirSync && syncMethods[1] ? syncMethods[1] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncEnterBackward = syncMethods && biDirSync && syncMethods[2] ? syncMethods[2] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncLeaveBackward = syncMethods && biDirSync && syncMethods[3] ? syncMethods[3] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onEnter = parameters.onEnter || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onLeave = parameters.onLeave || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onEnterForward = parameters.onEnterForward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onLeaveForward = parameters.onLeaveForward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onEnterBackward = parameters.onEnterBackward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onLeaveBackward = parameters.onLeaveBackward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onUpdate = parameters.onUpdate || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncComplete = parameters.onSyncComplete || noop;\n    /** @type {Boolean} */\n    this.reverted = false;\n    /** @type {Boolean} */\n    this.completed = false;\n    /** @type {Boolean} */\n    this.began = false;\n    /** @type {Boolean} */\n    this.isInView = false;\n    /** @type {Boolean} */\n    this.forceEnter = false;\n    /** @type {Boolean} */\n    this.hasEntered = false;\n    /** @type {Array.<Number>} */\n    this.offsets = [];\n    /** @type {Number} */\n    this.offset = 0;\n    /** @type {Number} */\n    this.offsetStart = 0;\n    /** @type {Number} */\n    this.offsetEnd = 0;\n    /** @type {Number} */\n    this.distance = 0;\n    /** @type {Number} */\n    this.prevProgress = 0;\n    /** @type {Array} */\n    this.thresholds = ['start', 'end', 'end', 'start'];\n    /** @type {[Number, Number, Number, Number]} */\n    this.coords = [0, 0, 0, 0];\n    /** @type {JSAnimation} */\n    this.debugStyles = null;\n    /** @type {HTMLElement} */\n    this.$debug = null;\n    /** @type {ScrollObserverParams} */\n    this._params = parameters;\n    /** @type {Boolean} */\n    this._debug = setValue(parameters.debug, false);\n    /** @type {ScrollObserver} */\n    this._next = null;\n    /** @type {ScrollObserver} */\n    this._prev = null;\n    addChild(this.container, this);\n    // Wait for the next frame to add to the container in order to handle calls to link()\n    sync(() => {\n      if (this.reverted) return;\n      if (!this.target) {\n        const target = /** @type {HTMLElement} */(parseTargets(parameters.target)[0]);\n        this.target = target || doc.body;\n        this.refresh();\n      }\n      if (this._debug) this.debug();\n    });\n  }\n\n  /**\n   * @param {Tickable|WAAPIAnimation} linked\n   */\n  link(linked) {\n    if (linked) {\n      // Make sure to pause the linked object in case it's added later\n      linked.pause();\n      this.linked = linked;\n      // Try to use a target of the linked object if no target parameters specified\n      if (!this._params.target) {\n        /** @type {HTMLElement} */\n        let $linkedTarget;\n        if (!isUnd(/** @type {JSAnimation} */(linked).targets)) {\n          $linkedTarget = getAnimationDomTarget(/** @type {JSAnimation} */(linked));\n        } else {\n          forEachChildren(/** @type {Timeline} */(linked), (/** @type {JSAnimation} */child) => {\n            if (child.targets && !$linkedTarget) {\n              $linkedTarget = getAnimationDomTarget(/** @type {JSAnimation} */(child));\n            }\n          });\n        }\n        // Fallback to body if no target found\n        this.target = $linkedTarget || doc.body;\n        this.refresh();\n      }\n    }\n    return this;\n  }\n\n  get velocity() {\n    return this.container.velocity;\n  }\n\n  get backward() {\n    return this.horizontal ? this.container.backwardX : this.container.backwardY;\n  }\n\n  get scroll() {\n    return this.horizontal ? this.container.scrollX : this.container.scrollY;\n  }\n\n  get progress() {\n    const p = (this.scroll - this.offsetStart) / this.distance;\n    return p === Infinity || isNaN(p) ? 0 : round(clamp(p, 0, 1), 6);\n  }\n\n  refresh() {\n    this.reverted = false;\n    const params = this._params;\n    this.repeat = setValue(parseScrollObserverFunctionParameter(params.repeat, this), true);\n    this.horizontal = setValue(parseScrollObserverFunctionParameter(params.axis, this), 'y') === 'x';\n    this.enter = setValue(parseScrollObserverFunctionParameter(params.enter, this), 'end start');\n    this.leave = setValue(parseScrollObserverFunctionParameter(params.leave, this), 'start end');\n    this.updateBounds();\n    this.handleScroll();\n    return this;\n  }\n\n  removeDebug() {\n    if (this.$debug) {\n      this.$debug.parentNode.removeChild(this.$debug);\n      this.$debug = null;\n    }\n    if (this.debugStyles) {\n      this.debugStyles.revert();\n      this.$debug = null;\n    }\n    return this;\n  }\n\n  debug() {\n    this.removeDebug();\n    const container = this.container;\n    const isHori = this.horizontal;\n    const $existingDebug = container.element.querySelector(':scope > .animejs-onscroll-debug');\n    const $debug = doc.createElement('div');\n    const $thresholds = doc.createElement('div');\n    const $triggers = doc.createElement('div');\n    const color = debugColors[this.index % debugColors.length];\n    const useWin = container.useWin;\n    const containerWidth = useWin ? container.winWidth : container.width;\n    const containerHeight = useWin ? container.winHeight : container.height;\n    const scrollWidth = container.scrollWidth;\n    const scrollHeight = container.scrollHeight;\n    const size = this.container.width > 360 ? 320 : 260;\n    const offLeft = isHori ? 0 : 10;\n    const offTop = isHori ? 10 : 0;\n    const half = isHori ? 24 : size / 2;\n    const labelHeight = isHori ? half : 15;\n    const labelWidth = isHori ? 60 : half;\n    const labelSize = isHori ? labelWidth : labelHeight;\n    const repeat = isHori ? 'repeat-x' : 'repeat-y';\n    /**\n     * @param {Number} v\n     * @return {String}\n     */\n    const gradientOffset = v => isHori ? '0px '+(v)+'px' : (v)+'px'+' 2px';\n    /**\n     * @param {String} c\n     * @return {String}\n     */\n    const lineCSS = (c) => `linear-gradient(${isHori ? 90 : 0}deg, ${c} 2px, transparent 1px)`;\n    /**\n     * @param {String} p\n     * @param {Number} l\n     * @param {Number} t\n     * @param {Number} w\n     * @param {Number} h\n     * @return {String}\n     */\n    const baseCSS = (p, l, t, w, h) => `position:${p};left:${l}px;top:${t}px;width:${w}px;height:${h}px;`;\n    $debug.style.cssText = `${baseCSS('absolute', offLeft, offTop, isHori ? scrollWidth : size, isHori ? size : scrollHeight)}\n      pointer-events: none;\n      z-index: ${this.container.zIndex++};\n      display: flex;\n      flex-direction: ${isHori ? 'column' : 'row'};\n      filter: drop-shadow(0px 1px 0px rgba(0,0,0,.75));\n    `;\n    $thresholds.style.cssText = `${baseCSS('sticky', 0, 0, isHori ? containerWidth : half, isHori ? half : containerHeight)}`;\n    if (!$existingDebug) {\n      $thresholds.style.cssText += `background:\n        ${lineCSS('#FFFF')}${gradientOffset(half-10)} / ${isHori ? '100px 100px' : '100px 100px'} ${repeat},\n        ${lineCSS('#FFF8')}${gradientOffset(half-10)} / ${isHori ? '10px 10px' : '10px 10px'} ${repeat};\n      `;\n    }\n    $triggers.style.cssText = `${baseCSS('relative', 0, 0, isHori ? scrollWidth : half, isHori ? half : scrollHeight)}`;\n    if (!$existingDebug) {\n      $triggers.style.cssText += `background:\n        ${lineCSS('#FFFF')}${gradientOffset(0)} / ${isHori ? '100px 10px' : '10px 100px'} ${repeat},\n        ${lineCSS('#FFF8')}${gradientOffset(0)} / ${isHori ? '10px 0px' : '0px 10px'} ${repeat};\n      `;\n    }\n    const labels = [' enter: ', ' leave: '];\n    this.coords.forEach((v, i) => {\n      const isView = i > 1;\n      const value = (isView ? 0 : this.offset) + v;\n      const isTail = i % 2;\n      const isFirst = value < labelSize;\n      const isOver = value > (isView ? isHori ? containerWidth : containerHeight : isHori ? scrollWidth : scrollHeight) - labelSize;\n      const isFlip = (isView ? isTail && !isFirst : !isTail && !isFirst) || isOver;\n      const $label = doc.createElement('div');\n      const $text = doc.createElement('div');\n      const dirProp = isHori ? isFlip ? 'right' : 'left' : isFlip ? 'bottom' : 'top';\n      const flipOffset = isFlip ? (isHori ? labelWidth : labelHeight) + (!isView ? isHori ? -1 : -2 : isHori ? -1 : isOver ? 0 : -2) : !isView ? isHori ? 1 : 0 : isHori ? 1 : 0;\n      // $text.innerHTML = `${!isView ? '' : labels[isTail] + ' '}${this.id}: ${this.thresholds[i]} ${isView ? '' : labels[isTail]}`;\n      $text.innerHTML = `${this.id}${labels[isTail]}${this.thresholds[i]}`;\n      $label.style.cssText = `${baseCSS('absolute', 0, 0, labelWidth, labelHeight)}\n        display: flex;\n        flex-direction: ${isHori ? 'column' : 'row'};\n        justify-content: flex-${isView ? 'start' : 'end'};\n        align-items: flex-${isFlip ? 'end' : 'start'};\n        border-${dirProp}: 2px ${isTail ? 'solid' : 'solid'} ${color};\n      `;\n      $text.style.cssText = `\n        overflow: hidden;\n        max-width: ${(size / 2) - 10}px;\n        height: ${labelHeight};\n        margin-${isHori ? isFlip ? 'right' : 'left' : isFlip ? 'bottom' : 'top'}: -2px;\n        padding: 1px;\n        font-family: ui-monospace, monospace;\n        font-size: 10px;\n        letter-spacing: -.025em;\n        line-height: 9px;\n        font-weight: 600;\n        text-align: ${isHori && isFlip || !isHori && !isView ? 'right' : 'left'};\n        white-space: pre;\n        text-overflow: ellipsis;\n        color: ${isTail ? color : 'rgba(0,0,0,.75)'};\n        background-color: ${isTail ? 'rgba(0,0,0,.65)' : color};\n        border: 2px solid ${isTail ? color : 'transparent'};\n        border-${isHori ? isFlip ? 'top-left' : 'top-right' : isFlip ? 'top-left' : 'bottom-left'}-radius: 5px;\n        border-${isHori ? isFlip ? 'bottom-left' : 'bottom-right' : isFlip ? 'top-right' : 'bottom-right'}-radius: 5px;\n      `;\n      $label.appendChild($text);\n      let position = value - flipOffset + (isHori ? 1 : 0);\n      $label.style[isHori ? 'left' : 'top'] = `${position}px`;\n      // $label.style[isHori ? 'left' : 'top'] = value - flipOffset + (!isFlip && isFirst && !isView ? 1 : isFlip ? 0 : -2) + 'px';\n      (isView ? $thresholds : $triggers).appendChild($label);\n    });\n\n    $debug.appendChild($thresholds);\n    $debug.appendChild($triggers);\n    container.element.appendChild($debug);\n\n    if (!$existingDebug) $debug.classList.add('animejs-onscroll-debug');\n    this.$debug = $debug;\n    const containerPosition = getTargetValue(container.element, 'position');\n    if (containerPosition === 'static') {\n      this.debugStyles = setTargetValues(container.element, { position: 'relative '});\n    }\n\n  }\n\n  updateBounds() {\n    if (this._debug) {\n      this.removeDebug();\n    }\n    let stickys;\n    const $target = this.target;\n    const container = this.container;\n    const isHori = this.horizontal;\n    const linked = this.linked;\n    let linkedTime;\n    let $el = $target;\n    let offsetX = 0;\n    let offsetY = 0;\n    /** @type {Element} */\n    let $offsetParent = $el;\n    if (linked) {\n      linkedTime = linked.currentTime;\n      linked.seek(0, true);\n    }\n    const isContainerStatic = getTargetValue(container.element, 'position') === 'static' ? setTargetValues(container.element, { position: 'relative '}) : false;\n    while ($el && $el !== container.element && $el !== doc.body) {\n      const isSticky = getTargetValue($el, 'position') === 'sticky' ?\n                       setTargetValues($el, { position: 'static' }) :\n                       false;\n      if ($el === $offsetParent) {\n        offsetX += $el.offsetLeft || 0;\n        offsetY += $el.offsetTop || 0;\n        $offsetParent = $el.offsetParent;\n      }\n      $el = /** @type {HTMLElement} */($el.parentElement);\n      if (isSticky) {\n        if (!stickys) stickys = [];\n        stickys.push(isSticky);\n      }\n    }\n    if (isContainerStatic) isContainerStatic.revert();\n    const offset = isHori ? offsetX : offsetY;\n    const targetSize = isHori ? $target.offsetWidth : $target.offsetHeight;\n    const containerSize = isHori ? container.width : container.height;\n    const scrollSize = isHori ? container.scrollWidth : container.scrollHeight;\n    const maxScroll = scrollSize - containerSize;\n    const enter = this.enter;\n    const leave = this.leave;\n\n    /** @type {ScrollThresholdValue} */\n    let enterTarget = 'start';\n    /** @type {ScrollThresholdValue} */\n    let leaveTarget = 'end';\n    /** @type {ScrollThresholdValue} */\n    let enterContainer = 'end';\n    /** @type {ScrollThresholdValue} */\n    let leaveContainer = 'start';\n\n    if (isStr(enter)) {\n      const splitted = /** @type {String} */(enter).split(' ');\n      enterContainer = splitted[0];\n      enterTarget = splitted.length > 1 ? splitted[1] : enterTarget;\n    } else if (isObj(enter)) {\n      const e = /** @type {ScrollThresholdParam} */(enter);\n      if (!isUnd(e.container)) enterContainer = e.container;\n      if (!isUnd(e.target)) enterTarget = e.target;\n    } else if (isNum(enter)) {\n      enterContainer = /** @type {Number} */(enter);\n    }\n\n    if (isStr(leave)) {\n      const splitted = /** @type {String} */(leave).split(' ');\n      leaveContainer = splitted[0];\n      leaveTarget = splitted.length > 1 ? splitted[1] : leaveTarget;\n    } else if (isObj(leave)) {\n      const t = /** @type {ScrollThresholdParam} */(leave);\n      if (!isUnd(t.container)) leaveContainer = t.container;\n      if (!isUnd(t.target)) leaveTarget = t.target;\n    } else if (isNum(leave)) {\n      leaveContainer = /** @type {Number} */(leave);\n    }\n\n    const parsedEnterTarget = parseBoundValue($target, enterTarget, targetSize);\n    const parsedLeaveTarget = parseBoundValue($target, leaveTarget, targetSize);\n    const under = (parsedEnterTarget + offset) - containerSize;\n    const over = (parsedLeaveTarget + offset) - maxScroll;\n    const parsedEnterContainer = parseBoundValue($target, enterContainer, containerSize, under, over);\n    const parsedLeaveContainer = parseBoundValue($target, leaveContainer, containerSize, under, over);\n    const offsetStart = parsedEnterTarget + offset - parsedEnterContainer;\n    const offsetEnd = parsedLeaveTarget + offset - parsedLeaveContainer;\n    const scrollDelta = offsetEnd - offsetStart;\n    this.offsets[0] = offsetX;\n    this.offsets[1] = offsetY;\n    this.offset = offset;\n    this.offsetStart = offsetStart;\n    this.offsetEnd = offsetEnd;\n    this.distance = scrollDelta <= 0 ? 0 : scrollDelta;\n    this.thresholds = [enterTarget, leaveTarget, enterContainer, leaveContainer];\n    this.coords = [parsedEnterTarget, parsedLeaveTarget, parsedEnterContainer, parsedLeaveContainer];\n    if (stickys) {\n      stickys.forEach(sticky => sticky.revert());\n    }\n    if (linked) {\n      linked.seek(linkedTime, true);\n    }\n    if (this._debug) {\n      this.debug();\n    }\n  }\n\n  handleScroll() {\n    const linked = this.linked;\n    const sync = this.sync;\n    const syncEase = this.syncEase;\n    const syncSmooth = this.syncSmooth;\n    const shouldSeek = linked && (syncEase || syncSmooth);\n    const isHori = this.horizontal;\n    const container = this.container;\n    const scroll = this.scroll;\n    const isBefore = scroll <= this.offsetStart;\n    const isAfter = scroll >= this.offsetEnd;\n    const isInView = !isBefore && !isAfter;\n    const isOnTheEdge = scroll === this.offsetStart || scroll === this.offsetEnd;\n    const forceEnter = !this.hasEntered && isOnTheEdge;\n    const $debug = this._debug && this.$debug;\n    let hasUpdated = false;\n    let syncCompleted = false;\n    let p = this.progress;\n\n    if (isBefore && this.began) {\n      this.began = false;\n    }\n\n    if (p > 0 && !this.began) {\n      this.began = true;\n    }\n\n    if (shouldSeek) {\n      const lp = linked.progress;\n      if (syncSmooth && isNum(syncSmooth)) {\n        if (/** @type {Number} */(syncSmooth) < 1) {\n          const step = 0.0001;\n          const snap = lp < p && p === 1 ? step : lp > p && !p ? -1e-4 : 0;\n          p = round(lerp(lp, p, interpolate(.01, .2, /** @type {Number} */(syncSmooth)), false) + snap, 6);\n        }\n      } else if (syncEase) {\n        p = syncEase(p);\n      }\n      hasUpdated = p !== this.prevProgress;\n      syncCompleted = lp === 1;\n      if (hasUpdated && !syncCompleted && (syncSmooth && lp)) {\n        container.wakeTicker.restart();\n      }\n    }\n\n    if ($debug) {\n      const sticky = isHori ? container.scrollY : container.scrollX;\n      $debug.style[isHori ? 'top' : 'left'] = sticky + 10 + 'px';\n    }\n\n    // Trigger enter callbacks if already in view or when entering the view\n    if ((isInView && !this.isInView) || (forceEnter && !this.forceEnter && !this.hasEntered)) {\n      if (isInView) this.isInView = true;\n      if (!this.forceEnter || !this.hasEntered) {\n        if ($debug && isInView) $debug.style.zIndex = `${this.container.zIndex++}`;\n        this.onSyncEnter(this);\n        this.onEnter(this);\n        if (this.backward) {\n          this.onSyncEnterBackward(this);\n          this.onEnterBackward(this);\n        } else {\n          this.onSyncEnterForward(this);\n          this.onEnterForward(this);\n        }\n        this.hasEntered = true;\n        if (forceEnter) this.forceEnter = true;\n      } else if (isInView) {\n        this.forceEnter = false;\n      }\n    }\n\n    if (isInView || !isInView && this.isInView) {\n      hasUpdated = true;\n    }\n\n    if (hasUpdated) {\n      if (shouldSeek) linked.seek(linked.duration * p);\n      this.onUpdate(this);\n    }\n\n    if (!isInView && this.isInView) {\n      this.isInView = false;\n      this.onSyncLeave(this);\n      this.onLeave(this);\n      if (this.backward) {\n        this.onSyncLeaveBackward(this);\n        this.onLeaveBackward(this);\n      } else {\n        this.onSyncLeaveForward(this);\n        this.onLeaveForward(this);\n      }\n      if (sync && !syncSmooth) {\n        syncCompleted = true;\n      }\n    }\n\n    if (p >= 1 && this.began && !this.completed && (sync && syncCompleted || !sync)) {\n      if (sync) {\n        this.onSyncComplete(this);\n      }\n      this.completed = true;\n      if ((!this.repeat && !linked) || (!this.repeat && linked && linked.completed)) {\n        this.revert();\n      }\n    }\n\n    if (p < 1 && this.completed) {\n      this.completed = false;\n    }\n\n    this.prevProgress = p;\n  }\n\n  revert() {\n    if (this.reverted) return;\n    const container = this.container;\n    removeChild(container, this);\n    if (!container._head) {\n      container.revert();\n    }\n    if (this._debug) {\n      this.removeDebug();\n    }\n    this.reverted = true;\n    return this;\n  }\n\n}\n\n/**\n * @param {ScrollObserverParams} [parameters={}]\n * @return {ScrollObserver}\n */\nconst onScroll = (parameters = {}) => new ScrollObserver(parameters);\n\n\n\n\n/**\n * @typedef  {Object} StaggerParameters\n * @property {Number|String} [start]\n * @property {Number|'first'|'center'|'last'} [from]\n * @property {Boolean} [reversed]\n * @property {Array.<Number>} [grid]\n * @property {('x'|'y')} [axis]\n * @property {EasingParam} [ease]\n * @property {TweenModifier} [modifier]\n */\n\n/**\n * @callback StaggerFunction\n * @param {Target} [target]\n * @param {Number} [index]\n * @param {Number} [length]\n * @param {Timeline} [tl]\n * @return {Number|String}\n */\n\n/**\n * @param  {Number|String|[Number|String,Number|String]} val\n * @param  {StaggerParameters} params\n * @return {StaggerFunction}\n */\nconst stagger = (val, params = {}) => {\n  let values = [];\n  let maxValue = 0;\n  const from = params.from;\n  const reversed = params.reversed;\n  const ease = params.ease;\n  const hasEasing = !isUnd(ease);\n  const hasSpring = hasEasing && !isUnd(/** @type {Spring} */(ease).ease);\n  const staggerEase = hasSpring ? /** @type {Spring} */(ease).ease : hasEasing ? parseEasings(ease) : null;\n  const grid = params.grid;\n  const axis = params.axis;\n  const fromFirst = isUnd(from) || from === 0 || from === 'first';\n  const fromCenter = from === 'center';\n  const fromLast = from === 'last';\n  const isRange = isArr(val);\n  const val1 = isRange ? parseNumber(val[0]) : parseNumber(val);\n  const val2 = isRange ? parseNumber(val[1]) : 0;\n  const unitMatch = unitsExecRgx.exec((isRange ? val[1] : val) + emptyString);\n  const start = params.start || 0 + (isRange ? val1 : 0);\n  let fromIndex = fromFirst ? 0 : isNum(from) ? from : 0;\n  return (_, i, t, tl) => {\n    if (fromCenter) fromIndex = (t - 1) / 2;\n    if (fromLast) fromIndex = t - 1;\n    if (!values.length) {\n      for (let index = 0; index < t; index++) {\n        if (!grid) {\n          values.push(abs(fromIndex - index));\n        } else {\n          const fromX = !fromCenter ? fromIndex % grid[0] : (grid[0] - 1) / 2;\n          const fromY = !fromCenter ? floor(fromIndex / grid[0]) : (grid[1] - 1) / 2;\n          const toX = index % grid[0];\n          const toY = floor(index / grid[0]);\n          const distanceX = fromX - toX;\n          const distanceY = fromY - toY;\n          let value = sqrt(distanceX * distanceX + distanceY * distanceY);\n          if (axis === 'x') value = -distanceX;\n          if (axis === 'y') value = -distanceY;\n          values.push(value);\n        }\n        maxValue = max(...values);\n      }\n      if (staggerEase) values = values.map(val => staggerEase(val / maxValue) * maxValue);\n      if (reversed) values = values.map(val => axis ? (val < 0) ? val * -1 : -val : abs(maxValue - val));\n    }\n    const spacing = isRange ? (val2 - val1) / maxValue : val1;\n    const offset = tl ? parseTimelinePosition(tl, isUnd(params.start) ? tl.iterationDuration : start) : /** @type {Number} */(start);\n    /** @type {String|Number} */\n    let output = offset + ((spacing * round(values[i], 2)) || 0);\n    if (params.modifier) output = params.modifier(output);\n    if (unitMatch) output = `${output}${unitMatch[2]}`;\n    return output;\n  }\n};\n\nexport { Animatable, Draggable, JSAnimation, Scope, ScrollObserver, Spring, Timeline, Timer, WAAPIAnimation, animate, createAnimatable, createDraggable, createScope, createSpring, createTimeline, createTimer, eases, engine, onScroll, scrollContainers, stagger, svg, utils, waapi };\n","\n/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */\nfunction isNothing(subject) {\n  return (typeof subject === 'undefined') || (subject === null);\n}\n\n\nfunction isObject(subject) {\n  return (typeof subject === 'object') && (subject !== null);\n}\n\n\nfunction toArray(sequence) {\n  if (Array.isArray(sequence)) return sequence;\n  else if (isNothing(sequence)) return [];\n\n  return [ sequence ];\n}\n\n\nfunction extend(target, source) {\n  var index, length, key, sourceKeys;\n\n  if (source) {\n    sourceKeys = Object.keys(source);\n\n    for (index = 0, length = sourceKeys.length; index < length; index += 1) {\n      key = sourceKeys[index];\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\n\nfunction repeat(string, count) {\n  var result = '', cycle;\n\n  for (cycle = 0; cycle < count; cycle += 1) {\n    result += string;\n  }\n\n  return result;\n}\n\n\nfunction isNegativeZero(number) {\n  return (number === 0) && (Number.NEGATIVE_INFINITY === 1 / number);\n}\n\n\nvar isNothing_1      = isNothing;\nvar isObject_1       = isObject;\nvar toArray_1        = toArray;\nvar repeat_1         = repeat;\nvar isNegativeZero_1 = isNegativeZero;\nvar extend_1         = extend;\n\nvar common = {\n\tisNothing: isNothing_1,\n\tisObject: isObject_1,\n\ttoArray: toArray_1,\n\trepeat: repeat_1,\n\tisNegativeZero: isNegativeZero_1,\n\textend: extend_1\n};\n\n// YAML error class. http://stackoverflow.com/questions/8458984\n\n\nfunction formatError(exception, compact) {\n  var where = '', message = exception.reason || '(unknown reason)';\n\n  if (!exception.mark) return message;\n\n  if (exception.mark.name) {\n    where += 'in \"' + exception.mark.name + '\" ';\n  }\n\n  where += '(' + (exception.mark.line + 1) + ':' + (exception.mark.column + 1) + ')';\n\n  if (!compact && exception.mark.snippet) {\n    where += '\\n\\n' + exception.mark.snippet;\n  }\n\n  return message + ' ' + where;\n}\n\n\nfunction YAMLException$1(reason, mark) {\n  // Super constructor\n  Error.call(this);\n\n  this.name = 'YAMLException';\n  this.reason = reason;\n  this.mark = mark;\n  this.message = formatError(this, false);\n\n  // Include stack trace in error object\n  if (Error.captureStackTrace) {\n    // Chrome and NodeJS\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    // FF, IE 10+ and Safari 6+. Fallback for others\n    this.stack = (new Error()).stack || '';\n  }\n}\n\n\n// Inherit from Error\nYAMLException$1.prototype = Object.create(Error.prototype);\nYAMLException$1.prototype.constructor = YAMLException$1;\n\n\nYAMLException$1.prototype.toString = function toString(compact) {\n  return this.name + ': ' + formatError(this, compact);\n};\n\n\nvar exception = YAMLException$1;\n\n// get snippet for a single line, respecting maxLength\nfunction getLine(buffer, lineStart, lineEnd, position, maxLineLength) {\n  var head = '';\n  var tail = '';\n  var maxHalfLength = Math.floor(maxLineLength / 2) - 1;\n\n  if (position - lineStart > maxHalfLength) {\n    head = ' ... ';\n    lineStart = position - maxHalfLength + head.length;\n  }\n\n  if (lineEnd - position > maxHalfLength) {\n    tail = ' ...';\n    lineEnd = position + maxHalfLength - tail.length;\n  }\n\n  return {\n    str: head + buffer.slice(lineStart, lineEnd).replace(/\\t/g, '') + tail,\n    pos: position - lineStart + head.length // relative position\n  };\n}\n\n\nfunction padStart(string, max) {\n  return common.repeat(' ', max - string.length) + string;\n}\n\n\nfunction makeSnippet(mark, options) {\n  options = Object.create(options || null);\n\n  if (!mark.buffer) return null;\n\n  if (!options.maxLength) options.maxLength = 79;\n  if (typeof options.indent      !== 'number') options.indent      = 1;\n  if (typeof options.linesBefore !== 'number') options.linesBefore = 3;\n  if (typeof options.linesAfter  !== 'number') options.linesAfter  = 2;\n\n  var re = /\\r?\\n|\\r|\\0/g;\n  var lineStarts = [ 0 ];\n  var lineEnds = [];\n  var match;\n  var foundLineNo = -1;\n\n  while ((match = re.exec(mark.buffer))) {\n    lineEnds.push(match.index);\n    lineStarts.push(match.index + match[0].length);\n\n    if (mark.position <= match.index && foundLineNo < 0) {\n      foundLineNo = lineStarts.length - 2;\n    }\n  }\n\n  if (foundLineNo < 0) foundLineNo = lineStarts.length - 1;\n\n  var result = '', i, line;\n  var lineNoLength = Math.min(mark.line + options.linesAfter, lineEnds.length).toString().length;\n  var maxLineLength = options.maxLength - (options.indent + lineNoLength + 3);\n\n  for (i = 1; i <= options.linesBefore; i++) {\n    if (foundLineNo - i < 0) break;\n    line = getLine(\n      mark.buffer,\n      lineStarts[foundLineNo - i],\n      lineEnds[foundLineNo - i],\n      mark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo - i]),\n      maxLineLength\n    );\n    result = common.repeat(' ', options.indent) + padStart((mark.line - i + 1).toString(), lineNoLength) +\n      ' | ' + line.str + '\\n' + result;\n  }\n\n  line = getLine(mark.buffer, lineStarts[foundLineNo], lineEnds[foundLineNo], mark.position, maxLineLength);\n  result += common.repeat(' ', options.indent) + padStart((mark.line + 1).toString(), lineNoLength) +\n    ' | ' + line.str + '\\n';\n  result += common.repeat('-', options.indent + lineNoLength + 3 + line.pos) + '^' + '\\n';\n\n  for (i = 1; i <= options.linesAfter; i++) {\n    if (foundLineNo + i >= lineEnds.length) break;\n    line = getLine(\n      mark.buffer,\n      lineStarts[foundLineNo + i],\n      lineEnds[foundLineNo + i],\n      mark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo + i]),\n      maxLineLength\n    );\n    result += common.repeat(' ', options.indent) + padStart((mark.line + i + 1).toString(), lineNoLength) +\n      ' | ' + line.str + '\\n';\n  }\n\n  return result.replace(/\\n$/, '');\n}\n\n\nvar snippet = makeSnippet;\n\nvar TYPE_CONSTRUCTOR_OPTIONS = [\n  'kind',\n  'multi',\n  'resolve',\n  'construct',\n  'instanceOf',\n  'predicate',\n  'represent',\n  'representName',\n  'defaultStyle',\n  'styleAliases'\n];\n\nvar YAML_NODE_KINDS = [\n  'scalar',\n  'sequence',\n  'mapping'\n];\n\nfunction compileStyleAliases(map) {\n  var result = {};\n\n  if (map !== null) {\n    Object.keys(map).forEach(function (style) {\n      map[style].forEach(function (alias) {\n        result[String(alias)] = style;\n      });\n    });\n  }\n\n  return result;\n}\n\nfunction Type$1(tag, options) {\n  options = options || {};\n\n  Object.keys(options).forEach(function (name) {\n    if (TYPE_CONSTRUCTOR_OPTIONS.indexOf(name) === -1) {\n      throw new exception('Unknown option \"' + name + '\" is met in definition of \"' + tag + '\" YAML type.');\n    }\n  });\n\n  // TODO: Add tag format check.\n  this.options       = options; // keep original options in case user wants to extend this type later\n  this.tag           = tag;\n  this.kind          = options['kind']          || null;\n  this.resolve       = options['resolve']       || function () { return true; };\n  this.construct     = options['construct']     || function (data) { return data; };\n  this.instanceOf    = options['instanceOf']    || null;\n  this.predicate     = options['predicate']     || null;\n  this.represent     = options['represent']     || null;\n  this.representName = options['representName'] || null;\n  this.defaultStyle  = options['defaultStyle']  || null;\n  this.multi         = options['multi']         || false;\n  this.styleAliases  = compileStyleAliases(options['styleAliases'] || null);\n\n  if (YAML_NODE_KINDS.indexOf(this.kind) === -1) {\n    throw new exception('Unknown kind \"' + this.kind + '\" is specified for \"' + tag + '\" YAML type.');\n  }\n}\n\nvar type = Type$1;\n\n/*eslint-disable max-len*/\n\n\n\n\n\nfunction compileList(schema, name) {\n  var result = [];\n\n  schema[name].forEach(function (currentType) {\n    var newIndex = result.length;\n\n    result.forEach(function (previousType, previousIndex) {\n      if (previousType.tag === currentType.tag &&\n          previousType.kind === currentType.kind &&\n          previousType.multi === currentType.multi) {\n\n        newIndex = previousIndex;\n      }\n    });\n\n    result[newIndex] = currentType;\n  });\n\n  return result;\n}\n\n\nfunction compileMap(/* lists... */) {\n  var result = {\n        scalar: {},\n        sequence: {},\n        mapping: {},\n        fallback: {},\n        multi: {\n          scalar: [],\n          sequence: [],\n          mapping: [],\n          fallback: []\n        }\n      }, index, length;\n\n  function collectType(type) {\n    if (type.multi) {\n      result.multi[type.kind].push(type);\n      result.multi['fallback'].push(type);\n    } else {\n      result[type.kind][type.tag] = result['fallback'][type.tag] = type;\n    }\n  }\n\n  for (index = 0, length = arguments.length; index < length; index += 1) {\n    arguments[index].forEach(collectType);\n  }\n  return result;\n}\n\n\nfunction Schema$1(definition) {\n  return this.extend(definition);\n}\n\n\nSchema$1.prototype.extend = function extend(definition) {\n  var implicit = [];\n  var explicit = [];\n\n  if (definition instanceof type) {\n    // Schema.extend(type)\n    explicit.push(definition);\n\n  } else if (Array.isArray(definition)) {\n    // Schema.extend([ type1, type2, ... ])\n    explicit = explicit.concat(definition);\n\n  } else if (definition && (Array.isArray(definition.implicit) || Array.isArray(definition.explicit))) {\n    // Schema.extend({ explicit: [ type1, type2, ... ], implicit: [ type1, type2, ... ] })\n    if (definition.implicit) implicit = implicit.concat(definition.implicit);\n    if (definition.explicit) explicit = explicit.concat(definition.explicit);\n\n  } else {\n    throw new exception('Schema.extend argument should be a Type, [ Type ], ' +\n      'or a schema definition ({ implicit: [...], explicit: [...] })');\n  }\n\n  implicit.forEach(function (type$1) {\n    if (!(type$1 instanceof type)) {\n      throw new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n    }\n\n    if (type$1.loadKind && type$1.loadKind !== 'scalar') {\n      throw new exception('There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.');\n    }\n\n    if (type$1.multi) {\n      throw new exception('There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.');\n    }\n  });\n\n  explicit.forEach(function (type$1) {\n    if (!(type$1 instanceof type)) {\n      throw new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n    }\n  });\n\n  var result = Object.create(Schema$1.prototype);\n\n  result.implicit = (this.implicit || []).concat(implicit);\n  result.explicit = (this.explicit || []).concat(explicit);\n\n  result.compiledImplicit = compileList(result, 'implicit');\n  result.compiledExplicit = compileList(result, 'explicit');\n  result.compiledTypeMap  = compileMap(result.compiledImplicit, result.compiledExplicit);\n\n  return result;\n};\n\n\nvar schema = Schema$1;\n\nvar str = new type('tag:yaml.org,2002:str', {\n  kind: 'scalar',\n  construct: function (data) { return data !== null ? data : ''; }\n});\n\nvar seq = new type('tag:yaml.org,2002:seq', {\n  kind: 'sequence',\n  construct: function (data) { return data !== null ? data : []; }\n});\n\nvar map = new type('tag:yaml.org,2002:map', {\n  kind: 'mapping',\n  construct: function (data) { return data !== null ? data : {}; }\n});\n\nvar failsafe = new schema({\n  explicit: [\n    str,\n    seq,\n    map\n  ]\n});\n\nfunction resolveYamlNull(data) {\n  if (data === null) return true;\n\n  var max = data.length;\n\n  return (max === 1 && data === '~') ||\n         (max === 4 && (data === 'null' || data === 'Null' || data === 'NULL'));\n}\n\nfunction constructYamlNull() {\n  return null;\n}\n\nfunction isNull(object) {\n  return object === null;\n}\n\nvar _null = new type('tag:yaml.org,2002:null', {\n  kind: 'scalar',\n  resolve: resolveYamlNull,\n  construct: constructYamlNull,\n  predicate: isNull,\n  represent: {\n    canonical: function () { return '~';    },\n    lowercase: function () { return 'null'; },\n    uppercase: function () { return 'NULL'; },\n    camelcase: function () { return 'Null'; },\n    empty:     function () { return '';     }\n  },\n  defaultStyle: 'lowercase'\n});\n\nfunction resolveYamlBoolean(data) {\n  if (data === null) return false;\n\n  var max = data.length;\n\n  return (max === 4 && (data === 'true' || data === 'True' || data === 'TRUE')) ||\n         (max === 5 && (data === 'false' || data === 'False' || data === 'FALSE'));\n}\n\nfunction constructYamlBoolean(data) {\n  return data === 'true' ||\n         data === 'True' ||\n         data === 'TRUE';\n}\n\nfunction isBoolean(object) {\n  return Object.prototype.toString.call(object) === '[object Boolean]';\n}\n\nvar bool = new type('tag:yaml.org,2002:bool', {\n  kind: 'scalar',\n  resolve: resolveYamlBoolean,\n  construct: constructYamlBoolean,\n  predicate: isBoolean,\n  represent: {\n    lowercase: function (object) { return object ? 'true' : 'false'; },\n    uppercase: function (object) { return object ? 'TRUE' : 'FALSE'; },\n    camelcase: function (object) { return object ? 'True' : 'False'; }\n  },\n  defaultStyle: 'lowercase'\n});\n\nfunction isHexCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) ||\n         ((0x41/* A */ <= c) && (c <= 0x46/* F */)) ||\n         ((0x61/* a */ <= c) && (c <= 0x66/* f */));\n}\n\nfunction isOctCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x37/* 7 */));\n}\n\nfunction isDecCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */));\n}\n\nfunction resolveYamlInteger(data) {\n  if (data === null) return false;\n\n  var max = data.length,\n      index = 0,\n      hasDigits = false,\n      ch;\n\n  if (!max) return false;\n\n  ch = data[index];\n\n  // sign\n  if (ch === '-' || ch === '+') {\n    ch = data[++index];\n  }\n\n  if (ch === '0') {\n    // 0\n    if (index + 1 === max) return true;\n    ch = data[++index];\n\n    // base 2, base 8, base 16\n\n    if (ch === 'b') {\n      // base 2\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (ch !== '0' && ch !== '1') return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'x') {\n      // base 16\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isHexCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'o') {\n      // base 8\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isOctCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n  }\n\n  // base 10 (except 0)\n\n  // value should not start with `_`;\n  if (ch === '_') return false;\n\n  for (; index < max; index++) {\n    ch = data[index];\n    if (ch === '_') continue;\n    if (!isDecCode(data.charCodeAt(index))) {\n      return false;\n    }\n    hasDigits = true;\n  }\n\n  // Should have digits and should not end with `_`\n  if (!hasDigits || ch === '_') return false;\n\n  return true;\n}\n\nfunction constructYamlInteger(data) {\n  var value = data, sign = 1, ch;\n\n  if (value.indexOf('_') !== -1) {\n    value = value.replace(/_/g, '');\n  }\n\n  ch = value[0];\n\n  if (ch === '-' || ch === '+') {\n    if (ch === '-') sign = -1;\n    value = value.slice(1);\n    ch = value[0];\n  }\n\n  if (value === '0') return 0;\n\n  if (ch === '0') {\n    if (value[1] === 'b') return sign * parseInt(value.slice(2), 2);\n    if (value[1] === 'x') return sign * parseInt(value.slice(2), 16);\n    if (value[1] === 'o') return sign * parseInt(value.slice(2), 8);\n  }\n\n  return sign * parseInt(value, 10);\n}\n\nfunction isInteger(object) {\n  return (Object.prototype.toString.call(object)) === '[object Number]' &&\n         (object % 1 === 0 && !common.isNegativeZero(object));\n}\n\nvar int = new type('tag:yaml.org,2002:int', {\n  kind: 'scalar',\n  resolve: resolveYamlInteger,\n  construct: constructYamlInteger,\n  predicate: isInteger,\n  represent: {\n    binary:      function (obj) { return obj >= 0 ? '0b' + obj.toString(2) : '-0b' + obj.toString(2).slice(1); },\n    octal:       function (obj) { return obj >= 0 ? '0o'  + obj.toString(8) : '-0o'  + obj.toString(8).slice(1); },\n    decimal:     function (obj) { return obj.toString(10); },\n    /* eslint-disable max-len */\n    hexadecimal: function (obj) { return obj >= 0 ? '0x' + obj.toString(16).toUpperCase() :  '-0x' + obj.toString(16).toUpperCase().slice(1); }\n  },\n  defaultStyle: 'decimal',\n  styleAliases: {\n    binary:      [ 2,  'bin' ],\n    octal:       [ 8,  'oct' ],\n    decimal:     [ 10, 'dec' ],\n    hexadecimal: [ 16, 'hex' ]\n  }\n});\n\nvar YAML_FLOAT_PATTERN = new RegExp(\n  // 2.5e4, 2.5 and integers\n  '^(?:[-+]?(?:[0-9][0-9_]*)(?:\\\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?' +\n  // .2e4, .2\n  // special case, seems not from spec\n  '|\\\\.[0-9_]+(?:[eE][-+]?[0-9]+)?' +\n  // .inf\n  '|[-+]?\\\\.(?:inf|Inf|INF)' +\n  // .nan\n  '|\\\\.(?:nan|NaN|NAN))$');\n\nfunction resolveYamlFloat(data) {\n  if (data === null) return false;\n\n  if (!YAML_FLOAT_PATTERN.test(data) ||\n      // Quick hack to not allow integers end with `_`\n      // Probably should update regexp & check speed\n      data[data.length - 1] === '_') {\n    return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlFloat(data) {\n  var value, sign;\n\n  value  = data.replace(/_/g, '').toLowerCase();\n  sign   = value[0] === '-' ? -1 : 1;\n\n  if ('+-'.indexOf(value[0]) >= 0) {\n    value = value.slice(1);\n  }\n\n  if (value === '.inf') {\n    return (sign === 1) ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY;\n\n  } else if (value === '.nan') {\n    return NaN;\n  }\n  return sign * parseFloat(value, 10);\n}\n\n\nvar SCIENTIFIC_WITHOUT_DOT = /^[-+]?[0-9]+e/;\n\nfunction representYamlFloat(object, style) {\n  var res;\n\n  if (isNaN(object)) {\n    switch (style) {\n      case 'lowercase': return '.nan';\n      case 'uppercase': return '.NAN';\n      case 'camelcase': return '.NaN';\n    }\n  } else if (Number.POSITIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '.inf';\n      case 'uppercase': return '.INF';\n      case 'camelcase': return '.Inf';\n    }\n  } else if (Number.NEGATIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '-.inf';\n      case 'uppercase': return '-.INF';\n      case 'camelcase': return '-.Inf';\n    }\n  } else if (common.isNegativeZero(object)) {\n    return '-0.0';\n  }\n\n  res = object.toString(10);\n\n  // JS stringifier can build scientific format without dots: 5e-100,\n  // while YAML requres dot: 5.e-100. Fix it with simple hack\n\n  return SCIENTIFIC_WITHOUT_DOT.test(res) ? res.replace('e', '.e') : res;\n}\n\nfunction isFloat(object) {\n  return (Object.prototype.toString.call(object) === '[object Number]') &&\n         (object % 1 !== 0 || common.isNegativeZero(object));\n}\n\nvar float = new type('tag:yaml.org,2002:float', {\n  kind: 'scalar',\n  resolve: resolveYamlFloat,\n  construct: constructYamlFloat,\n  predicate: isFloat,\n  represent: representYamlFloat,\n  defaultStyle: 'lowercase'\n});\n\nvar json = failsafe.extend({\n  implicit: [\n    _null,\n    bool,\n    int,\n    float\n  ]\n});\n\nvar core = json;\n\nvar YAML_DATE_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9])'                    + // [2] month\n  '-([0-9][0-9])$');                   // [3] day\n\nvar YAML_TIMESTAMP_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9]?)'                   + // [2] month\n  '-([0-9][0-9]?)'                   + // [3] day\n  '(?:[Tt]|[ \\\\t]+)'                 + // ...\n  '([0-9][0-9]?)'                    + // [4] hour\n  ':([0-9][0-9])'                    + // [5] minute\n  ':([0-9][0-9])'                    + // [6] second\n  '(?:\\\\.([0-9]*))?'                 + // [7] fraction\n  '(?:[ \\\\t]*(Z|([-+])([0-9][0-9]?)' + // [8] tz [9] tz_sign [10] tz_hour\n  '(?::([0-9][0-9]))?))?$');           // [11] tz_minute\n\nfunction resolveYamlTimestamp(data) {\n  if (data === null) return false;\n  if (YAML_DATE_REGEXP.exec(data) !== null) return true;\n  if (YAML_TIMESTAMP_REGEXP.exec(data) !== null) return true;\n  return false;\n}\n\nfunction constructYamlTimestamp(data) {\n  var match, year, month, day, hour, minute, second, fraction = 0,\n      delta = null, tz_hour, tz_minute, date;\n\n  match = YAML_DATE_REGEXP.exec(data);\n  if (match === null) match = YAML_TIMESTAMP_REGEXP.exec(data);\n\n  if (match === null) throw new Error('Date resolve error');\n\n  // match: [1] year [2] month [3] day\n\n  year = +(match[1]);\n  month = +(match[2]) - 1; // JS month starts with 0\n  day = +(match[3]);\n\n  if (!match[4]) { // no hour\n    return new Date(Date.UTC(year, month, day));\n  }\n\n  // match: [4] hour [5] minute [6] second [7] fraction\n\n  hour = +(match[4]);\n  minute = +(match[5]);\n  second = +(match[6]);\n\n  if (match[7]) {\n    fraction = match[7].slice(0, 3);\n    while (fraction.length < 3) { // milli-seconds\n      fraction += '0';\n    }\n    fraction = +fraction;\n  }\n\n  // match: [8] tz [9] tz_sign [10] tz_hour [11] tz_minute\n\n  if (match[9]) {\n    tz_hour = +(match[10]);\n    tz_minute = +(match[11] || 0);\n    delta = (tz_hour * 60 + tz_minute) * 60000; // delta in mili-seconds\n    if (match[9] === '-') delta = -delta;\n  }\n\n  date = new Date(Date.UTC(year, month, day, hour, minute, second, fraction));\n\n  if (delta) date.setTime(date.getTime() - delta);\n\n  return date;\n}\n\nfunction representYamlTimestamp(object /*, style*/) {\n  return object.toISOString();\n}\n\nvar timestamp = new type('tag:yaml.org,2002:timestamp', {\n  kind: 'scalar',\n  resolve: resolveYamlTimestamp,\n  construct: constructYamlTimestamp,\n  instanceOf: Date,\n  represent: representYamlTimestamp\n});\n\nfunction resolveYamlMerge(data) {\n  return data === '<<' || data === null;\n}\n\nvar merge = new type('tag:yaml.org,2002:merge', {\n  kind: 'scalar',\n  resolve: resolveYamlMerge\n});\n\n/*eslint-disable no-bitwise*/\n\n\n\n\n\n// [ 64, 65, 66 ] -> [ padding, CR, LF ]\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\\n\\r';\n\n\nfunction resolveYamlBinary(data) {\n  if (data === null) return false;\n\n  var code, idx, bitlen = 0, max = data.length, map = BASE64_MAP;\n\n  // Convert one by one.\n  for (idx = 0; idx < max; idx++) {\n    code = map.indexOf(data.charAt(idx));\n\n    // Skip CR/LF\n    if (code > 64) continue;\n\n    // Fail on illegal characters\n    if (code < 0) return false;\n\n    bitlen += 6;\n  }\n\n  // If there are any bits left, source was corrupted\n  return (bitlen % 8) === 0;\n}\n\nfunction constructYamlBinary(data) {\n  var idx, tailbits,\n      input = data.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max = input.length,\n      map = BASE64_MAP,\n      bits = 0,\n      result = [];\n\n  // Collect by 6*4 bits (3 bytes)\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      result.push((bits >> 16) & 0xFF);\n      result.push((bits >> 8) & 0xFF);\n      result.push(bits & 0xFF);\n    }\n\n    bits = (bits << 6) | map.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    result.push((bits >> 16) & 0xFF);\n    result.push((bits >> 8) & 0xFF);\n    result.push(bits & 0xFF);\n  } else if (tailbits === 18) {\n    result.push((bits >> 10) & 0xFF);\n    result.push((bits >> 2) & 0xFF);\n  } else if (tailbits === 12) {\n    result.push((bits >> 4) & 0xFF);\n  }\n\n  return new Uint8Array(result);\n}\n\nfunction representYamlBinary(object /*, style*/) {\n  var result = '', bits = 0, idx, tail,\n      max = object.length,\n      map = BASE64_MAP;\n\n  // Convert every three bytes to 4 ASCII characters.\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 3 === 0) && idx) {\n      result += map[(bits >> 18) & 0x3F];\n      result += map[(bits >> 12) & 0x3F];\n      result += map[(bits >> 6) & 0x3F];\n      result += map[bits & 0x3F];\n    }\n\n    bits = (bits << 8) + object[idx];\n  }\n\n  // Dump tail\n\n  tail = max % 3;\n\n  if (tail === 0) {\n    result += map[(bits >> 18) & 0x3F];\n    result += map[(bits >> 12) & 0x3F];\n    result += map[(bits >> 6) & 0x3F];\n    result += map[bits & 0x3F];\n  } else if (tail === 2) {\n    result += map[(bits >> 10) & 0x3F];\n    result += map[(bits >> 4) & 0x3F];\n    result += map[(bits << 2) & 0x3F];\n    result += map[64];\n  } else if (tail === 1) {\n    result += map[(bits >> 2) & 0x3F];\n    result += map[(bits << 4) & 0x3F];\n    result += map[64];\n    result += map[64];\n  }\n\n  return result;\n}\n\nfunction isBinary(obj) {\n  return Object.prototype.toString.call(obj) ===  '[object Uint8Array]';\n}\n\nvar binary = new type('tag:yaml.org,2002:binary', {\n  kind: 'scalar',\n  resolve: resolveYamlBinary,\n  construct: constructYamlBinary,\n  predicate: isBinary,\n  represent: representYamlBinary\n});\n\nvar _hasOwnProperty$3 = Object.prototype.hasOwnProperty;\nvar _toString$2       = Object.prototype.toString;\n\nfunction resolveYamlOmap(data) {\n  if (data === null) return true;\n\n  var objectKeys = [], index, length, pair, pairKey, pairHasKey,\n      object = data;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n    pairHasKey = false;\n\n    if (_toString$2.call(pair) !== '[object Object]') return false;\n\n    for (pairKey in pair) {\n      if (_hasOwnProperty$3.call(pair, pairKey)) {\n        if (!pairHasKey) pairHasKey = true;\n        else return false;\n      }\n    }\n\n    if (!pairHasKey) return false;\n\n    if (objectKeys.indexOf(pairKey) === -1) objectKeys.push(pairKey);\n    else return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlOmap(data) {\n  return data !== null ? data : [];\n}\n\nvar omap = new type('tag:yaml.org,2002:omap', {\n  kind: 'sequence',\n  resolve: resolveYamlOmap,\n  construct: constructYamlOmap\n});\n\nvar _toString$1 = Object.prototype.toString;\n\nfunction resolveYamlPairs(data) {\n  if (data === null) return true;\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    if (_toString$1.call(pair) !== '[object Object]') return false;\n\n    keys = Object.keys(pair);\n\n    if (keys.length !== 1) return false;\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return true;\n}\n\nfunction constructYamlPairs(data) {\n  if (data === null) return [];\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    keys = Object.keys(pair);\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return result;\n}\n\nvar pairs = new type('tag:yaml.org,2002:pairs', {\n  kind: 'sequence',\n  resolve: resolveYamlPairs,\n  construct: constructYamlPairs\n});\n\nvar _hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n\nfunction resolveYamlSet(data) {\n  if (data === null) return true;\n\n  var key, object = data;\n\n  for (key in object) {\n    if (_hasOwnProperty$2.call(object, key)) {\n      if (object[key] !== null) return false;\n    }\n  }\n\n  return true;\n}\n\nfunction constructYamlSet(data) {\n  return data !== null ? data : {};\n}\n\nvar set = new type('tag:yaml.org,2002:set', {\n  kind: 'mapping',\n  resolve: resolveYamlSet,\n  construct: constructYamlSet\n});\n\nvar _default = core.extend({\n  implicit: [\n    timestamp,\n    merge\n  ],\n  explicit: [\n    binary,\n    omap,\n    pairs,\n    set\n  ]\n});\n\n/*eslint-disable max-len,no-use-before-define*/\n\n\n\n\n\n\n\nvar _hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n\n\nvar CONTEXT_FLOW_IN   = 1;\nvar CONTEXT_FLOW_OUT  = 2;\nvar CONTEXT_BLOCK_IN  = 3;\nvar CONTEXT_BLOCK_OUT = 4;\n\n\nvar CHOMPING_CLIP  = 1;\nvar CHOMPING_STRIP = 2;\nvar CHOMPING_KEEP  = 3;\n\n\nvar PATTERN_NON_PRINTABLE         = /[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x84\\x86-\\x9F\\uFFFE\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/;\nvar PATTERN_NON_ASCII_LINE_BREAKS = /[\\x85\\u2028\\u2029]/;\nvar PATTERN_FLOW_INDICATORS       = /[,\\[\\]\\{\\}]/;\nvar PATTERN_TAG_HANDLE            = /^(?:!|!!|![a-z\\-]+!)$/i;\nvar PATTERN_TAG_URI               = /^(?:!|[^,\\[\\]\\{\\}])(?:%[0-9a-f]{2}|[0-9a-z\\-#;\\/\\?:@&=\\+\\$,_\\.!~\\*'\\(\\)\\[\\]])*$/i;\n\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\n\nfunction is_EOL(c) {\n  return (c === 0x0A/* LF */) || (c === 0x0D/* CR */);\n}\n\nfunction is_WHITE_SPACE(c) {\n  return (c === 0x09/* Tab */) || (c === 0x20/* Space */);\n}\n\nfunction is_WS_OR_EOL(c) {\n  return (c === 0x09/* Tab */) ||\n         (c === 0x20/* Space */) ||\n         (c === 0x0A/* LF */) ||\n         (c === 0x0D/* CR */);\n}\n\nfunction is_FLOW_INDICATOR(c) {\n  return c === 0x2C/* , */ ||\n         c === 0x5B/* [ */ ||\n         c === 0x5D/* ] */ ||\n         c === 0x7B/* { */ ||\n         c === 0x7D/* } */;\n}\n\nfunction fromHexCode(c) {\n  var lc;\n\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  /*eslint-disable no-bitwise*/\n  lc = c | 0x20;\n\n  if ((0x61/* a */ <= lc) && (lc <= 0x66/* f */)) {\n    return lc - 0x61 + 10;\n  }\n\n  return -1;\n}\n\nfunction escapedHexLen(c) {\n  if (c === 0x78/* x */) { return 2; }\n  if (c === 0x75/* u */) { return 4; }\n  if (c === 0x55/* U */) { return 8; }\n  return 0;\n}\n\nfunction fromDecimalCode(c) {\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  return -1;\n}\n\nfunction simpleEscapeSequence(c) {\n  /* eslint-disable indent */\n  return (c === 0x30/* 0 */) ? '\\x00' :\n        (c === 0x61/* a */) ? '\\x07' :\n        (c === 0x62/* b */) ? '\\x08' :\n        (c === 0x74/* t */) ? '\\x09' :\n        (c === 0x09/* Tab */) ? '\\x09' :\n        (c === 0x6E/* n */) ? '\\x0A' :\n        (c === 0x76/* v */) ? '\\x0B' :\n        (c === 0x66/* f */) ? '\\x0C' :\n        (c === 0x72/* r */) ? '\\x0D' :\n        (c === 0x65/* e */) ? '\\x1B' :\n        (c === 0x20/* Space */) ? ' ' :\n        (c === 0x22/* \" */) ? '\\x22' :\n        (c === 0x2F/* / */) ? '/' :\n        (c === 0x5C/* \\ */) ? '\\x5C' :\n        (c === 0x4E/* N */) ? '\\x85' :\n        (c === 0x5F/* _ */) ? '\\xA0' :\n        (c === 0x4C/* L */) ? '\\u2028' :\n        (c === 0x50/* P */) ? '\\u2029' : '';\n}\n\nfunction charFromCodepoint(c) {\n  if (c <= 0xFFFF) {\n    return String.fromCharCode(c);\n  }\n  // Encode UTF-16 surrogate pair\n  // https://en.wikipedia.org/wiki/UTF-16#Code_points_U.2B010000_to_U.2B10FFFF\n  return String.fromCharCode(\n    ((c - 0x010000) >> 10) + 0xD800,\n    ((c - 0x010000) & 0x03FF) + 0xDC00\n  );\n}\n\nvar simpleEscapeCheck = new Array(256); // integer, for fast access\nvar simpleEscapeMap = new Array(256);\nfor (var i = 0; i < 256; i++) {\n  simpleEscapeCheck[i] = simpleEscapeSequence(i) ? 1 : 0;\n  simpleEscapeMap[i] = simpleEscapeSequence(i);\n}\n\n\nfunction State$1(input, options) {\n  this.input = input;\n\n  this.filename  = options['filename']  || null;\n  this.schema    = options['schema']    || _default;\n  this.onWarning = options['onWarning'] || null;\n  // (Hidden) Remove? makes the loader to expect YAML 1.1 documents\n  // if such documents have no explicit %YAML directive\n  this.legacy    = options['legacy']    || false;\n\n  this.json      = options['json']      || false;\n  this.listener  = options['listener']  || null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.typeMap       = this.schema.compiledTypeMap;\n\n  this.length     = input.length;\n  this.position   = 0;\n  this.line       = 0;\n  this.lineStart  = 0;\n  this.lineIndent = 0;\n\n  // position of first leading tab in the current line,\n  // used to make sure there are no tabs in the indentation\n  this.firstTabInLine = -1;\n\n  this.documents = [];\n\n  /*\n  this.version;\n  this.checkLineBreaks;\n  this.tagMap;\n  this.anchorMap;\n  this.tag;\n  this.anchor;\n  this.kind;\n  this.result;*/\n\n}\n\n\nfunction generateError(state, message) {\n  var mark = {\n    name:     state.filename,\n    buffer:   state.input.slice(0, -1), // omit trailing \\0\n    position: state.position,\n    line:     state.line,\n    column:   state.position - state.lineStart\n  };\n\n  mark.snippet = snippet(mark);\n\n  return new exception(message, mark);\n}\n\nfunction throwError(state, message) {\n  throw generateError(state, message);\n}\n\nfunction throwWarning(state, message) {\n  if (state.onWarning) {\n    state.onWarning.call(null, generateError(state, message));\n  }\n}\n\n\nvar directiveHandlers = {\n\n  YAML: function handleYamlDirective(state, name, args) {\n\n    var match, major, minor;\n\n    if (state.version !== null) {\n      throwError(state, 'duplication of %YAML directive');\n    }\n\n    if (args.length !== 1) {\n      throwError(state, 'YAML directive accepts exactly one argument');\n    }\n\n    match = /^([0-9]+)\\.([0-9]+)$/.exec(args[0]);\n\n    if (match === null) {\n      throwError(state, 'ill-formed argument of the YAML directive');\n    }\n\n    major = parseInt(match[1], 10);\n    minor = parseInt(match[2], 10);\n\n    if (major !== 1) {\n      throwError(state, 'unacceptable YAML version of the document');\n    }\n\n    state.version = args[0];\n    state.checkLineBreaks = (minor < 2);\n\n    if (minor !== 1 && minor !== 2) {\n      throwWarning(state, 'unsupported YAML version of the document');\n    }\n  },\n\n  TAG: function handleTagDirective(state, name, args) {\n\n    var handle, prefix;\n\n    if (args.length !== 2) {\n      throwError(state, 'TAG directive accepts exactly two arguments');\n    }\n\n    handle = args[0];\n    prefix = args[1];\n\n    if (!PATTERN_TAG_HANDLE.test(handle)) {\n      throwError(state, 'ill-formed tag handle (first argument) of the TAG directive');\n    }\n\n    if (_hasOwnProperty$1.call(state.tagMap, handle)) {\n      throwError(state, 'there is a previously declared suffix for \"' + handle + '\" tag handle');\n    }\n\n    if (!PATTERN_TAG_URI.test(prefix)) {\n      throwError(state, 'ill-formed tag prefix (second argument) of the TAG directive');\n    }\n\n    try {\n      prefix = decodeURIComponent(prefix);\n    } catch (err) {\n      throwError(state, 'tag prefix is malformed: ' + prefix);\n    }\n\n    state.tagMap[handle] = prefix;\n  }\n};\n\n\nfunction captureSegment(state, start, end, checkJson) {\n  var _position, _length, _character, _result;\n\n  if (start < end) {\n    _result = state.input.slice(start, end);\n\n    if (checkJson) {\n      for (_position = 0, _length = _result.length; _position < _length; _position += 1) {\n        _character = _result.charCodeAt(_position);\n        if (!(_character === 0x09 ||\n              (0x20 <= _character && _character <= 0x10FFFF))) {\n          throwError(state, 'expected valid JSON character');\n        }\n      }\n    } else if (PATTERN_NON_PRINTABLE.test(_result)) {\n      throwError(state, 'the stream contains non-printable characters');\n    }\n\n    state.result += _result;\n  }\n}\n\nfunction mergeMappings(state, destination, source, overridableKeys) {\n  var sourceKeys, key, index, quantity;\n\n  if (!common.isObject(source)) {\n    throwError(state, 'cannot merge mappings; the provided source object is unacceptable');\n  }\n\n  sourceKeys = Object.keys(source);\n\n  for (index = 0, quantity = sourceKeys.length; index < quantity; index += 1) {\n    key = sourceKeys[index];\n\n    if (!_hasOwnProperty$1.call(destination, key)) {\n      destination[key] = source[key];\n      overridableKeys[key] = true;\n    }\n  }\n}\n\nfunction storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode,\n  startLine, startLineStart, startPos) {\n\n  var index, quantity;\n\n  // The output is a plain object here, so keys can only be strings.\n  // We need to convert keyNode to a string, but doing so can hang the process\n  // (deeply nested arrays that explode exponentially using aliases).\n  if (Array.isArray(keyNode)) {\n    keyNode = Array.prototype.slice.call(keyNode);\n\n    for (index = 0, quantity = keyNode.length; index < quantity; index += 1) {\n      if (Array.isArray(keyNode[index])) {\n        throwError(state, 'nested arrays are not supported inside keys');\n      }\n\n      if (typeof keyNode === 'object' && _class(keyNode[index]) === '[object Object]') {\n        keyNode[index] = '[object Object]';\n      }\n    }\n  }\n\n  // Avoid code execution in load() via toString property\n  // (still use its own toString for arrays, timestamps,\n  // and whatever user schema extensions happen to have @@toStringTag)\n  if (typeof keyNode === 'object' && _class(keyNode) === '[object Object]') {\n    keyNode = '[object Object]';\n  }\n\n\n  keyNode = String(keyNode);\n\n  if (_result === null) {\n    _result = {};\n  }\n\n  if (keyTag === 'tag:yaml.org,2002:merge') {\n    if (Array.isArray(valueNode)) {\n      for (index = 0, quantity = valueNode.length; index < quantity; index += 1) {\n        mergeMappings(state, _result, valueNode[index], overridableKeys);\n      }\n    } else {\n      mergeMappings(state, _result, valueNode, overridableKeys);\n    }\n  } else {\n    if (!state.json &&\n        !_hasOwnProperty$1.call(overridableKeys, keyNode) &&\n        _hasOwnProperty$1.call(_result, keyNode)) {\n      state.line = startLine || state.line;\n      state.lineStart = startLineStart || state.lineStart;\n      state.position = startPos || state.position;\n      throwError(state, 'duplicated mapping key');\n    }\n\n    // used for this specific key only because Object.defineProperty is slow\n    if (keyNode === '__proto__') {\n      Object.defineProperty(_result, keyNode, {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value: valueNode\n      });\n    } else {\n      _result[keyNode] = valueNode;\n    }\n    delete overridableKeys[keyNode];\n  }\n\n  return _result;\n}\n\nfunction readLineBreak(state) {\n  var ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x0A/* LF */) {\n    state.position++;\n  } else if (ch === 0x0D/* CR */) {\n    state.position++;\n    if (state.input.charCodeAt(state.position) === 0x0A/* LF */) {\n      state.position++;\n    }\n  } else {\n    throwError(state, 'a line break is expected');\n  }\n\n  state.line += 1;\n  state.lineStart = state.position;\n  state.firstTabInLine = -1;\n}\n\nfunction skipSeparationSpace(state, allowComments, checkIndent) {\n  var lineBreaks = 0,\n      ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    while (is_WHITE_SPACE(ch)) {\n      if (ch === 0x09/* Tab */ && state.firstTabInLine === -1) {\n        state.firstTabInLine = state.position;\n      }\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (allowComments && ch === 0x23/* # */) {\n      do {\n        ch = state.input.charCodeAt(++state.position);\n      } while (ch !== 0x0A/* LF */ && ch !== 0x0D/* CR */ && ch !== 0);\n    }\n\n    if (is_EOL(ch)) {\n      readLineBreak(state);\n\n      ch = state.input.charCodeAt(state.position);\n      lineBreaks++;\n      state.lineIndent = 0;\n\n      while (ch === 0x20/* Space */) {\n        state.lineIndent++;\n        ch = state.input.charCodeAt(++state.position);\n      }\n    } else {\n      break;\n    }\n  }\n\n  if (checkIndent !== -1 && lineBreaks !== 0 && state.lineIndent < checkIndent) {\n    throwWarning(state, 'deficient indentation');\n  }\n\n  return lineBreaks;\n}\n\nfunction testDocumentSeparator(state) {\n  var _position = state.position,\n      ch;\n\n  ch = state.input.charCodeAt(_position);\n\n  // Condition state.position === state.lineStart is tested\n  // in parent on each call, for efficiency. No needs to test here again.\n  if ((ch === 0x2D/* - */ || ch === 0x2E/* . */) &&\n      ch === state.input.charCodeAt(_position + 1) &&\n      ch === state.input.charCodeAt(_position + 2)) {\n\n    _position += 3;\n\n    ch = state.input.charCodeAt(_position);\n\n    if (ch === 0 || is_WS_OR_EOL(ch)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction writeFoldedLines(state, count) {\n  if (count === 1) {\n    state.result += ' ';\n  } else if (count > 1) {\n    state.result += common.repeat('\\n', count - 1);\n  }\n}\n\n\nfunction readPlainScalar(state, nodeIndent, withinFlowCollection) {\n  var preceding,\n      following,\n      captureStart,\n      captureEnd,\n      hasPendingContent,\n      _line,\n      _lineStart,\n      _lineIndent,\n      _kind = state.kind,\n      _result = state.result,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (is_WS_OR_EOL(ch)      ||\n      is_FLOW_INDICATOR(ch) ||\n      ch === 0x23/* # */    ||\n      ch === 0x26/* & */    ||\n      ch === 0x2A/* * */    ||\n      ch === 0x21/* ! */    ||\n      ch === 0x7C/* | */    ||\n      ch === 0x3E/* > */    ||\n      ch === 0x27/* ' */    ||\n      ch === 0x22/* \" */    ||\n      ch === 0x25/* % */    ||\n      ch === 0x40/* @ */    ||\n      ch === 0x60/* ` */) {\n    return false;\n  }\n\n  if (ch === 0x3F/* ? */ || ch === 0x2D/* - */) {\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (is_WS_OR_EOL(following) ||\n        withinFlowCollection && is_FLOW_INDICATOR(following)) {\n      return false;\n    }\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  captureStart = captureEnd = state.position;\n  hasPendingContent = false;\n\n  while (ch !== 0) {\n    if (ch === 0x3A/* : */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following) ||\n          withinFlowCollection && is_FLOW_INDICATOR(following)) {\n        break;\n      }\n\n    } else if (ch === 0x23/* # */) {\n      preceding = state.input.charCodeAt(state.position - 1);\n\n      if (is_WS_OR_EOL(preceding)) {\n        break;\n      }\n\n    } else if ((state.position === state.lineStart && testDocumentSeparator(state)) ||\n               withinFlowCollection && is_FLOW_INDICATOR(ch)) {\n      break;\n\n    } else if (is_EOL(ch)) {\n      _line = state.line;\n      _lineStart = state.lineStart;\n      _lineIndent = state.lineIndent;\n      skipSeparationSpace(state, false, -1);\n\n      if (state.lineIndent >= nodeIndent) {\n        hasPendingContent = true;\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      } else {\n        state.position = captureEnd;\n        state.line = _line;\n        state.lineStart = _lineStart;\n        state.lineIndent = _lineIndent;\n        break;\n      }\n    }\n\n    if (hasPendingContent) {\n      captureSegment(state, captureStart, captureEnd, false);\n      writeFoldedLines(state, state.line - _line);\n      captureStart = captureEnd = state.position;\n      hasPendingContent = false;\n    }\n\n    if (!is_WHITE_SPACE(ch)) {\n      captureEnd = state.position + 1;\n    }\n\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  captureSegment(state, captureStart, captureEnd, false);\n\n  if (state.result) {\n    return true;\n  }\n\n  state.kind = _kind;\n  state.result = _result;\n  return false;\n}\n\nfunction readSingleQuotedScalar(state, nodeIndent) {\n  var ch,\n      captureStart, captureEnd;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x27/* ' */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x27/* ' */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (ch === 0x27/* ' */) {\n        captureStart = state.position;\n        state.position++;\n        captureEnd = state.position;\n      } else {\n        return true;\n      }\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a single quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a single quoted scalar');\n}\n\nfunction readDoubleQuotedScalar(state, nodeIndent) {\n  var captureStart,\n      captureEnd,\n      hexLength,\n      hexResult,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x22/* \" */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x22/* \" */) {\n      captureSegment(state, captureStart, state.position, true);\n      state.position++;\n      return true;\n\n    } else if (ch === 0x5C/* \\ */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (is_EOL(ch)) {\n        skipSeparationSpace(state, false, nodeIndent);\n\n        // TODO: rework to inline fn with no type cast?\n      } else if (ch < 256 && simpleEscapeCheck[ch]) {\n        state.result += simpleEscapeMap[ch];\n        state.position++;\n\n      } else if ((tmp = escapedHexLen(ch)) > 0) {\n        hexLength = tmp;\n        hexResult = 0;\n\n        for (; hexLength > 0; hexLength--) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if ((tmp = fromHexCode(ch)) >= 0) {\n            hexResult = (hexResult << 4) + tmp;\n\n          } else {\n            throwError(state, 'expected hexadecimal character');\n          }\n        }\n\n        state.result += charFromCodepoint(hexResult);\n\n        state.position++;\n\n      } else {\n        throwError(state, 'unknown escape sequence');\n      }\n\n      captureStart = captureEnd = state.position;\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a double quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a double quoted scalar');\n}\n\nfunction readFlowCollection(state, nodeIndent) {\n  var readNext = true,\n      _line,\n      _lineStart,\n      _pos,\n      _tag     = state.tag,\n      _result,\n      _anchor  = state.anchor,\n      following,\n      terminator,\n      isPair,\n      isExplicitPair,\n      isMapping,\n      overridableKeys = Object.create(null),\n      keyNode,\n      keyTag,\n      valueNode,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x5B/* [ */) {\n    terminator = 0x5D;/* ] */\n    isMapping = false;\n    _result = [];\n  } else if (ch === 0x7B/* { */) {\n    terminator = 0x7D;/* } */\n    isMapping = true;\n    _result = {};\n  } else {\n    return false;\n  }\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  while (ch !== 0) {\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === terminator) {\n      state.position++;\n      state.tag = _tag;\n      state.anchor = _anchor;\n      state.kind = isMapping ? 'mapping' : 'sequence';\n      state.result = _result;\n      return true;\n    } else if (!readNext) {\n      throwError(state, 'missed comma between flow collection entries');\n    } else if (ch === 0x2C/* , */) {\n      // \"flow collection entries can never be completely empty\", as per YAML 1.2, section 7.4\n      throwError(state, \"expected the node content, but found ','\");\n    }\n\n    keyTag = keyNode = valueNode = null;\n    isPair = isExplicitPair = false;\n\n    if (ch === 0x3F/* ? */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following)) {\n        isPair = isExplicitPair = true;\n        state.position++;\n        skipSeparationSpace(state, true, nodeIndent);\n      }\n    }\n\n    _line = state.line; // Save the current line.\n    _lineStart = state.lineStart;\n    _pos = state.position;\n    composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n    keyTag = state.tag;\n    keyNode = state.result;\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((isExplicitPair || state.line === _line) && ch === 0x3A/* : */) {\n      isPair = true;\n      ch = state.input.charCodeAt(++state.position);\n      skipSeparationSpace(state, true, nodeIndent);\n      composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n      valueNode = state.result;\n    }\n\n    if (isMapping) {\n      storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos);\n    } else if (isPair) {\n      _result.push(storeMappingPair(state, null, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos));\n    } else {\n      _result.push(keyNode);\n    }\n\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === 0x2C/* , */) {\n      readNext = true;\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      readNext = false;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a flow collection');\n}\n\nfunction readBlockScalar(state, nodeIndent) {\n  var captureStart,\n      folding,\n      chomping       = CHOMPING_CLIP,\n      didReadContent = false,\n      detectedIndent = false,\n      textIndent     = nodeIndent,\n      emptyLines     = 0,\n      atMoreIndented = false,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x7C/* | */) {\n    folding = false;\n  } else if (ch === 0x3E/* > */) {\n    folding = true;\n  } else {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n\n  while (ch !== 0) {\n    ch = state.input.charCodeAt(++state.position);\n\n    if (ch === 0x2B/* + */ || ch === 0x2D/* - */) {\n      if (CHOMPING_CLIP === chomping) {\n        chomping = (ch === 0x2B/* + */) ? CHOMPING_KEEP : CHOMPING_STRIP;\n      } else {\n        throwError(state, 'repeat of a chomping mode identifier');\n      }\n\n    } else if ((tmp = fromDecimalCode(ch)) >= 0) {\n      if (tmp === 0) {\n        throwError(state, 'bad explicit indentation width of a block scalar; it cannot be less than one');\n      } else if (!detectedIndent) {\n        textIndent = nodeIndent + tmp - 1;\n        detectedIndent = true;\n      } else {\n        throwError(state, 'repeat of an indentation width identifier');\n      }\n\n    } else {\n      break;\n    }\n  }\n\n  if (is_WHITE_SPACE(ch)) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (is_WHITE_SPACE(ch));\n\n    if (ch === 0x23/* # */) {\n      do { ch = state.input.charCodeAt(++state.position); }\n      while (!is_EOL(ch) && (ch !== 0));\n    }\n  }\n\n  while (ch !== 0) {\n    readLineBreak(state);\n    state.lineIndent = 0;\n\n    ch = state.input.charCodeAt(state.position);\n\n    while ((!detectedIndent || state.lineIndent < textIndent) &&\n           (ch === 0x20/* Space */)) {\n      state.lineIndent++;\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (!detectedIndent && state.lineIndent > textIndent) {\n      textIndent = state.lineIndent;\n    }\n\n    if (is_EOL(ch)) {\n      emptyLines++;\n      continue;\n    }\n\n    // End of the scalar.\n    if (state.lineIndent < textIndent) {\n\n      // Perform the chomping.\n      if (chomping === CHOMPING_KEEP) {\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n      } else if (chomping === CHOMPING_CLIP) {\n        if (didReadContent) { // i.e. only if the scalar is not empty.\n          state.result += '\\n';\n        }\n      }\n\n      // Break this `while` cycle and go to the funciton's epilogue.\n      break;\n    }\n\n    // Folded style: use fancy rules to handle line breaks.\n    if (folding) {\n\n      // Lines starting with white space characters (more-indented lines) are not folded.\n      if (is_WHITE_SPACE(ch)) {\n        atMoreIndented = true;\n        // except for the first content line (cf. Example 8.1)\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n\n      // End of more-indented block.\n      } else if (atMoreIndented) {\n        atMoreIndented = false;\n        state.result += common.repeat('\\n', emptyLines + 1);\n\n      // Just one line break - perceive as the same line.\n      } else if (emptyLines === 0) {\n        if (didReadContent) { // i.e. only if we have already read some scalar content.\n          state.result += ' ';\n        }\n\n      // Several line breaks - perceive as different lines.\n      } else {\n        state.result += common.repeat('\\n', emptyLines);\n      }\n\n    // Literal style: just add exact number of line breaks between content lines.\n    } else {\n      // Keep all line breaks except the header line break.\n      state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n    }\n\n    didReadContent = true;\n    detectedIndent = true;\n    emptyLines = 0;\n    captureStart = state.position;\n\n    while (!is_EOL(ch) && (ch !== 0)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    captureSegment(state, captureStart, state.position, false);\n  }\n\n  return true;\n}\n\nfunction readBlockSequence(state, nodeIndent) {\n  var _line,\n      _tag      = state.tag,\n      _anchor   = state.anchor,\n      _result   = [],\n      following,\n      detected  = false,\n      ch;\n\n  // there is a leading tab before this token, so it can't be a block sequence/mapping;\n  // it can still be flow sequence/mapping or a scalar\n  if (state.firstTabInLine !== -1) return false;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    if (state.firstTabInLine !== -1) {\n      state.position = state.firstTabInLine;\n      throwError(state, 'tab characters must not be used in indentation');\n    }\n\n    if (ch !== 0x2D/* - */) {\n      break;\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (!is_WS_OR_EOL(following)) {\n      break;\n    }\n\n    detected = true;\n    state.position++;\n\n    if (skipSeparationSpace(state, true, -1)) {\n      if (state.lineIndent <= nodeIndent) {\n        _result.push(null);\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      }\n    }\n\n    _line = state.line;\n    composeNode(state, nodeIndent, CONTEXT_BLOCK_IN, false, true);\n    _result.push(state.result);\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a sequence entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'sequence';\n    state.result = _result;\n    return true;\n  }\n  return false;\n}\n\nfunction readBlockMapping(state, nodeIndent, flowIndent) {\n  var following,\n      allowCompact,\n      _line,\n      _keyLine,\n      _keyLineStart,\n      _keyPos,\n      _tag          = state.tag,\n      _anchor       = state.anchor,\n      _result       = {},\n      overridableKeys = Object.create(null),\n      keyTag        = null,\n      keyNode       = null,\n      valueNode     = null,\n      atExplicitKey = false,\n      detected      = false,\n      ch;\n\n  // there is a leading tab before this token, so it can't be a block sequence/mapping;\n  // it can still be flow sequence/mapping or a scalar\n  if (state.firstTabInLine !== -1) return false;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    if (!atExplicitKey && state.firstTabInLine !== -1) {\n      state.position = state.firstTabInLine;\n      throwError(state, 'tab characters must not be used in indentation');\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n    _line = state.line; // Save the current line.\n\n    //\n    // Explicit notation case. There are two separate blocks:\n    // first for the key (denoted by \"?\") and second for the value (denoted by \":\")\n    //\n    if ((ch === 0x3F/* ? */ || ch === 0x3A/* : */) && is_WS_OR_EOL(following)) {\n\n      if (ch === 0x3F/* ? */) {\n        if (atExplicitKey) {\n          storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n          keyTag = keyNode = valueNode = null;\n        }\n\n        detected = true;\n        atExplicitKey = true;\n        allowCompact = true;\n\n      } else if (atExplicitKey) {\n        // i.e. 0x3A/* : */ === character after the explicit key.\n        atExplicitKey = false;\n        allowCompact = true;\n\n      } else {\n        throwError(state, 'incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line');\n      }\n\n      state.position += 1;\n      ch = following;\n\n    //\n    // Implicit notation case. Flow-style node as the key first, then \":\", and the value.\n    //\n    } else {\n      _keyLine = state.line;\n      _keyLineStart = state.lineStart;\n      _keyPos = state.position;\n\n      if (!composeNode(state, flowIndent, CONTEXT_FLOW_OUT, false, true)) {\n        // Neither implicit nor explicit notation.\n        // Reading is done. Go to the epilogue.\n        break;\n      }\n\n      if (state.line === _line) {\n        ch = state.input.charCodeAt(state.position);\n\n        while (is_WHITE_SPACE(ch)) {\n          ch = state.input.charCodeAt(++state.position);\n        }\n\n        if (ch === 0x3A/* : */) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if (!is_WS_OR_EOL(ch)) {\n            throwError(state, 'a whitespace character is expected after the key-value separator within a block mapping');\n          }\n\n          if (atExplicitKey) {\n            storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n            keyTag = keyNode = valueNode = null;\n          }\n\n          detected = true;\n          atExplicitKey = false;\n          allowCompact = false;\n          keyTag = state.tag;\n          keyNode = state.result;\n\n        } else if (detected) {\n          throwError(state, 'can not read an implicit mapping pair; a colon is missed');\n\n        } else {\n          state.tag = _tag;\n          state.anchor = _anchor;\n          return true; // Keep the result of `composeNode`.\n        }\n\n      } else if (detected) {\n        throwError(state, 'can not read a block mapping entry; a multiline key may not be an implicit key');\n\n      } else {\n        state.tag = _tag;\n        state.anchor = _anchor;\n        return true; // Keep the result of `composeNode`.\n      }\n    }\n\n    //\n    // Common reading code for both explicit and implicit notations.\n    //\n    if (state.line === _line || state.lineIndent > nodeIndent) {\n      if (atExplicitKey) {\n        _keyLine = state.line;\n        _keyLineStart = state.lineStart;\n        _keyPos = state.position;\n      }\n\n      if (composeNode(state, nodeIndent, CONTEXT_BLOCK_OUT, true, allowCompact)) {\n        if (atExplicitKey) {\n          keyNode = state.result;\n        } else {\n          valueNode = state.result;\n        }\n      }\n\n      if (!atExplicitKey) {\n        storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _keyLine, _keyLineStart, _keyPos);\n        keyTag = keyNode = valueNode = null;\n      }\n\n      skipSeparationSpace(state, true, -1);\n      ch = state.input.charCodeAt(state.position);\n    }\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a mapping entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  //\n  // Epilogue.\n  //\n\n  // Special case: last mapping's node contains only the key in explicit notation.\n  if (atExplicitKey) {\n    storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n  }\n\n  // Expose the resulting mapping.\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'mapping';\n    state.result = _result;\n  }\n\n  return detected;\n}\n\nfunction readTagProperty(state) {\n  var _position,\n      isVerbatim = false,\n      isNamed    = false,\n      tagHandle,\n      tagName,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x21/* ! */) return false;\n\n  if (state.tag !== null) {\n    throwError(state, 'duplication of a tag property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  if (ch === 0x3C/* < */) {\n    isVerbatim = true;\n    ch = state.input.charCodeAt(++state.position);\n\n  } else if (ch === 0x21/* ! */) {\n    isNamed = true;\n    tagHandle = '!!';\n    ch = state.input.charCodeAt(++state.position);\n\n  } else {\n    tagHandle = '!';\n  }\n\n  _position = state.position;\n\n  if (isVerbatim) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (ch !== 0 && ch !== 0x3E/* > */);\n\n    if (state.position < state.length) {\n      tagName = state.input.slice(_position, state.position);\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      throwError(state, 'unexpected end of the stream within a verbatim tag');\n    }\n  } else {\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n\n      if (ch === 0x21/* ! */) {\n        if (!isNamed) {\n          tagHandle = state.input.slice(_position - 1, state.position + 1);\n\n          if (!PATTERN_TAG_HANDLE.test(tagHandle)) {\n            throwError(state, 'named tag handle cannot contain such characters');\n          }\n\n          isNamed = true;\n          _position = state.position + 1;\n        } else {\n          throwError(state, 'tag suffix cannot contain exclamation marks');\n        }\n      }\n\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    tagName = state.input.slice(_position, state.position);\n\n    if (PATTERN_FLOW_INDICATORS.test(tagName)) {\n      throwError(state, 'tag suffix cannot contain flow indicator characters');\n    }\n  }\n\n  if (tagName && !PATTERN_TAG_URI.test(tagName)) {\n    throwError(state, 'tag name cannot contain such characters: ' + tagName);\n  }\n\n  try {\n    tagName = decodeURIComponent(tagName);\n  } catch (err) {\n    throwError(state, 'tag name is malformed: ' + tagName);\n  }\n\n  if (isVerbatim) {\n    state.tag = tagName;\n\n  } else if (_hasOwnProperty$1.call(state.tagMap, tagHandle)) {\n    state.tag = state.tagMap[tagHandle] + tagName;\n\n  } else if (tagHandle === '!') {\n    state.tag = '!' + tagName;\n\n  } else if (tagHandle === '!!') {\n    state.tag = 'tag:yaml.org,2002:' + tagName;\n\n  } else {\n    throwError(state, 'undeclared tag handle \"' + tagHandle + '\"');\n  }\n\n  return true;\n}\n\nfunction readAnchorProperty(state) {\n  var _position,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x26/* & */) return false;\n\n  if (state.anchor !== null) {\n    throwError(state, 'duplication of an anchor property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an anchor node must contain at least one character');\n  }\n\n  state.anchor = state.input.slice(_position, state.position);\n  return true;\n}\n\nfunction readAlias(state) {\n  var _position, alias,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x2A/* * */) return false;\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an alias node must contain at least one character');\n  }\n\n  alias = state.input.slice(_position, state.position);\n\n  if (!_hasOwnProperty$1.call(state.anchorMap, alias)) {\n    throwError(state, 'unidentified alias \"' + alias + '\"');\n  }\n\n  state.result = state.anchorMap[alias];\n  skipSeparationSpace(state, true, -1);\n  return true;\n}\n\nfunction composeNode(state, parentIndent, nodeContext, allowToSeek, allowCompact) {\n  var allowBlockStyles,\n      allowBlockScalars,\n      allowBlockCollections,\n      indentStatus = 1, // 1: this>parent, 0: this=parent, -1: this<parent\n      atNewLine  = false,\n      hasContent = false,\n      typeIndex,\n      typeQuantity,\n      typeList,\n      type,\n      flowIndent,\n      blockIndent;\n\n  if (state.listener !== null) {\n    state.listener('open', state);\n  }\n\n  state.tag    = null;\n  state.anchor = null;\n  state.kind   = null;\n  state.result = null;\n\n  allowBlockStyles = allowBlockScalars = allowBlockCollections =\n    CONTEXT_BLOCK_OUT === nodeContext ||\n    CONTEXT_BLOCK_IN  === nodeContext;\n\n  if (allowToSeek) {\n    if (skipSeparationSpace(state, true, -1)) {\n      atNewLine = true;\n\n      if (state.lineIndent > parentIndent) {\n        indentStatus = 1;\n      } else if (state.lineIndent === parentIndent) {\n        indentStatus = 0;\n      } else if (state.lineIndent < parentIndent) {\n        indentStatus = -1;\n      }\n    }\n  }\n\n  if (indentStatus === 1) {\n    while (readTagProperty(state) || readAnchorProperty(state)) {\n      if (skipSeparationSpace(state, true, -1)) {\n        atNewLine = true;\n        allowBlockCollections = allowBlockStyles;\n\n        if (state.lineIndent > parentIndent) {\n          indentStatus = 1;\n        } else if (state.lineIndent === parentIndent) {\n          indentStatus = 0;\n        } else if (state.lineIndent < parentIndent) {\n          indentStatus = -1;\n        }\n      } else {\n        allowBlockCollections = false;\n      }\n    }\n  }\n\n  if (allowBlockCollections) {\n    allowBlockCollections = atNewLine || allowCompact;\n  }\n\n  if (indentStatus === 1 || CONTEXT_BLOCK_OUT === nodeContext) {\n    if (CONTEXT_FLOW_IN === nodeContext || CONTEXT_FLOW_OUT === nodeContext) {\n      flowIndent = parentIndent;\n    } else {\n      flowIndent = parentIndent + 1;\n    }\n\n    blockIndent = state.position - state.lineStart;\n\n    if (indentStatus === 1) {\n      if (allowBlockCollections &&\n          (readBlockSequence(state, blockIndent) ||\n           readBlockMapping(state, blockIndent, flowIndent)) ||\n          readFlowCollection(state, flowIndent)) {\n        hasContent = true;\n      } else {\n        if ((allowBlockScalars && readBlockScalar(state, flowIndent)) ||\n            readSingleQuotedScalar(state, flowIndent) ||\n            readDoubleQuotedScalar(state, flowIndent)) {\n          hasContent = true;\n\n        } else if (readAlias(state)) {\n          hasContent = true;\n\n          if (state.tag !== null || state.anchor !== null) {\n            throwError(state, 'alias node should not have any properties');\n          }\n\n        } else if (readPlainScalar(state, flowIndent, CONTEXT_FLOW_IN === nodeContext)) {\n          hasContent = true;\n\n          if (state.tag === null) {\n            state.tag = '?';\n          }\n        }\n\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n      }\n    } else if (indentStatus === 0) {\n      // Special case: block sequences are allowed to have same indentation level as the parent.\n      // http://www.yaml.org/spec/1.2/spec.html#id2799784\n      hasContent = allowBlockCollections && readBlockSequence(state, blockIndent);\n    }\n  }\n\n  if (state.tag === null) {\n    if (state.anchor !== null) {\n      state.anchorMap[state.anchor] = state.result;\n    }\n\n  } else if (state.tag === '?') {\n    // Implicit resolving is not allowed for non-scalar types, and '?'\n    // non-specific tag is only automatically assigned to plain scalars.\n    //\n    // We only need to check kind conformity in case user explicitly assigns '?'\n    // tag, for example like this: \"!<?> [0]\"\n    //\n    if (state.result !== null && state.kind !== 'scalar') {\n      throwError(state, 'unacceptable node kind for !<?> tag; it should be \"scalar\", not \"' + state.kind + '\"');\n    }\n\n    for (typeIndex = 0, typeQuantity = state.implicitTypes.length; typeIndex < typeQuantity; typeIndex += 1) {\n      type = state.implicitTypes[typeIndex];\n\n      if (type.resolve(state.result)) { // `state.result` updated in resolver if matched\n        state.result = type.construct(state.result);\n        state.tag = type.tag;\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n        break;\n      }\n    }\n  } else if (state.tag !== '!') {\n    if (_hasOwnProperty$1.call(state.typeMap[state.kind || 'fallback'], state.tag)) {\n      type = state.typeMap[state.kind || 'fallback'][state.tag];\n    } else {\n      // looking for multi type\n      type = null;\n      typeList = state.typeMap.multi[state.kind || 'fallback'];\n\n      for (typeIndex = 0, typeQuantity = typeList.length; typeIndex < typeQuantity; typeIndex += 1) {\n        if (state.tag.slice(0, typeList[typeIndex].tag.length) === typeList[typeIndex].tag) {\n          type = typeList[typeIndex];\n          break;\n        }\n      }\n    }\n\n    if (!type) {\n      throwError(state, 'unknown tag !<' + state.tag + '>');\n    }\n\n    if (state.result !== null && type.kind !== state.kind) {\n      throwError(state, 'unacceptable node kind for !<' + state.tag + '> tag; it should be \"' + type.kind + '\", not \"' + state.kind + '\"');\n    }\n\n    if (!type.resolve(state.result, state.tag)) { // `state.result` updated in resolver if matched\n      throwError(state, 'cannot resolve a node with !<' + state.tag + '> explicit tag');\n    } else {\n      state.result = type.construct(state.result, state.tag);\n      if (state.anchor !== null) {\n        state.anchorMap[state.anchor] = state.result;\n      }\n    }\n  }\n\n  if (state.listener !== null) {\n    state.listener('close', state);\n  }\n  return state.tag !== null ||  state.anchor !== null || hasContent;\n}\n\nfunction readDocument(state) {\n  var documentStart = state.position,\n      _position,\n      directiveName,\n      directiveArgs,\n      hasDirectives = false,\n      ch;\n\n  state.version = null;\n  state.checkLineBreaks = state.legacy;\n  state.tagMap = Object.create(null);\n  state.anchorMap = Object.create(null);\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (state.lineIndent > 0 || ch !== 0x25/* % */) {\n      break;\n    }\n\n    hasDirectives = true;\n    ch = state.input.charCodeAt(++state.position);\n    _position = state.position;\n\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    directiveName = state.input.slice(_position, state.position);\n    directiveArgs = [];\n\n    if (directiveName.length < 1) {\n      throwError(state, 'directive name must not be less than one character in length');\n    }\n\n    while (ch !== 0) {\n      while (is_WHITE_SPACE(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      if (ch === 0x23/* # */) {\n        do { ch = state.input.charCodeAt(++state.position); }\n        while (ch !== 0 && !is_EOL(ch));\n        break;\n      }\n\n      if (is_EOL(ch)) break;\n\n      _position = state.position;\n\n      while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      directiveArgs.push(state.input.slice(_position, state.position));\n    }\n\n    if (ch !== 0) readLineBreak(state);\n\n    if (_hasOwnProperty$1.call(directiveHandlers, directiveName)) {\n      directiveHandlers[directiveName](state, directiveName, directiveArgs);\n    } else {\n      throwWarning(state, 'unknown document directive \"' + directiveName + '\"');\n    }\n  }\n\n  skipSeparationSpace(state, true, -1);\n\n  if (state.lineIndent === 0 &&\n      state.input.charCodeAt(state.position)     === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 1) === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 2) === 0x2D/* - */) {\n    state.position += 3;\n    skipSeparationSpace(state, true, -1);\n\n  } else if (hasDirectives) {\n    throwError(state, 'directives end mark is expected');\n  }\n\n  composeNode(state, state.lineIndent - 1, CONTEXT_BLOCK_OUT, false, true);\n  skipSeparationSpace(state, true, -1);\n\n  if (state.checkLineBreaks &&\n      PATTERN_NON_ASCII_LINE_BREAKS.test(state.input.slice(documentStart, state.position))) {\n    throwWarning(state, 'non-ASCII line breaks are interpreted as content');\n  }\n\n  state.documents.push(state.result);\n\n  if (state.position === state.lineStart && testDocumentSeparator(state)) {\n\n    if (state.input.charCodeAt(state.position) === 0x2E/* . */) {\n      state.position += 3;\n      skipSeparationSpace(state, true, -1);\n    }\n    return;\n  }\n\n  if (state.position < (state.length - 1)) {\n    throwError(state, 'end of the stream or a document separator is expected');\n  } else {\n    return;\n  }\n}\n\n\nfunction loadDocuments(input, options) {\n  input = String(input);\n  options = options || {};\n\n  if (input.length !== 0) {\n\n    // Add tailing `\\n` if not exists\n    if (input.charCodeAt(input.length - 1) !== 0x0A/* LF */ &&\n        input.charCodeAt(input.length - 1) !== 0x0D/* CR */) {\n      input += '\\n';\n    }\n\n    // Strip BOM\n    if (input.charCodeAt(0) === 0xFEFF) {\n      input = input.slice(1);\n    }\n  }\n\n  var state = new State$1(input, options);\n\n  var nullpos = input.indexOf('\\0');\n\n  if (nullpos !== -1) {\n    state.position = nullpos;\n    throwError(state, 'null byte is not allowed in input');\n  }\n\n  // Use 0 as string terminator. That significantly simplifies bounds check.\n  state.input += '\\0';\n\n  while (state.input.charCodeAt(state.position) === 0x20/* Space */) {\n    state.lineIndent += 1;\n    state.position += 1;\n  }\n\n  while (state.position < (state.length - 1)) {\n    readDocument(state);\n  }\n\n  return state.documents;\n}\n\n\nfunction loadAll$1(input, iterator, options) {\n  if (iterator !== null && typeof iterator === 'object' && typeof options === 'undefined') {\n    options = iterator;\n    iterator = null;\n  }\n\n  var documents = loadDocuments(input, options);\n\n  if (typeof iterator !== 'function') {\n    return documents;\n  }\n\n  for (var index = 0, length = documents.length; index < length; index += 1) {\n    iterator(documents[index]);\n  }\n}\n\n\nfunction load$1(input, options) {\n  var documents = loadDocuments(input, options);\n\n  if (documents.length === 0) {\n    /*eslint-disable no-undefined*/\n    return undefined;\n  } else if (documents.length === 1) {\n    return documents[0];\n  }\n  throw new exception('expected a single document in the stream, but found more');\n}\n\n\nvar loadAll_1 = loadAll$1;\nvar load_1    = load$1;\n\nvar loader = {\n\tloadAll: loadAll_1,\n\tload: load_1\n};\n\n/*eslint-disable no-use-before-define*/\n\n\n\n\n\nvar _toString       = Object.prototype.toString;\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar CHAR_BOM                  = 0xFEFF;\nvar CHAR_TAB                  = 0x09; /* Tab */\nvar CHAR_LINE_FEED            = 0x0A; /* LF */\nvar CHAR_CARRIAGE_RETURN      = 0x0D; /* CR */\nvar CHAR_SPACE                = 0x20; /* Space */\nvar CHAR_EXCLAMATION          = 0x21; /* ! */\nvar CHAR_DOUBLE_QUOTE         = 0x22; /* \" */\nvar CHAR_SHARP                = 0x23; /* # */\nvar CHAR_PERCENT              = 0x25; /* % */\nvar CHAR_AMPERSAND            = 0x26; /* & */\nvar CHAR_SINGLE_QUOTE         = 0x27; /* ' */\nvar CHAR_ASTERISK             = 0x2A; /* * */\nvar CHAR_COMMA                = 0x2C; /* , */\nvar CHAR_MINUS                = 0x2D; /* - */\nvar CHAR_COLON                = 0x3A; /* : */\nvar CHAR_EQUALS               = 0x3D; /* = */\nvar CHAR_GREATER_THAN         = 0x3E; /* > */\nvar CHAR_QUESTION             = 0x3F; /* ? */\nvar CHAR_COMMERCIAL_AT        = 0x40; /* @ */\nvar CHAR_LEFT_SQUARE_BRACKET  = 0x5B; /* [ */\nvar CHAR_RIGHT_SQUARE_BRACKET = 0x5D; /* ] */\nvar CHAR_GRAVE_ACCENT         = 0x60; /* ` */\nvar CHAR_LEFT_CURLY_BRACKET   = 0x7B; /* { */\nvar CHAR_VERTICAL_LINE        = 0x7C; /* | */\nvar CHAR_RIGHT_CURLY_BRACKET  = 0x7D; /* } */\n\nvar ESCAPE_SEQUENCES = {};\n\nESCAPE_SEQUENCES[0x00]   = '\\\\0';\nESCAPE_SEQUENCES[0x07]   = '\\\\a';\nESCAPE_SEQUENCES[0x08]   = '\\\\b';\nESCAPE_SEQUENCES[0x09]   = '\\\\t';\nESCAPE_SEQUENCES[0x0A]   = '\\\\n';\nESCAPE_SEQUENCES[0x0B]   = '\\\\v';\nESCAPE_SEQUENCES[0x0C]   = '\\\\f';\nESCAPE_SEQUENCES[0x0D]   = '\\\\r';\nESCAPE_SEQUENCES[0x1B]   = '\\\\e';\nESCAPE_SEQUENCES[0x22]   = '\\\\\"';\nESCAPE_SEQUENCES[0x5C]   = '\\\\\\\\';\nESCAPE_SEQUENCES[0x85]   = '\\\\N';\nESCAPE_SEQUENCES[0xA0]   = '\\\\_';\nESCAPE_SEQUENCES[0x2028] = '\\\\L';\nESCAPE_SEQUENCES[0x2029] = '\\\\P';\n\nvar DEPRECATED_BOOLEANS_SYNTAX = [\n  'y', 'Y', 'yes', 'Yes', 'YES', 'on', 'On', 'ON',\n  'n', 'N', 'no', 'No', 'NO', 'off', 'Off', 'OFF'\n];\n\nvar DEPRECATED_BASE60_SYNTAX = /^[-+]?[0-9_]+(?::[0-9_]+)+(?:\\.[0-9_]*)?$/;\n\nfunction compileStyleMap(schema, map) {\n  var result, keys, index, length, tag, style, type;\n\n  if (map === null) return {};\n\n  result = {};\n  keys = Object.keys(map);\n\n  for (index = 0, length = keys.length; index < length; index += 1) {\n    tag = keys[index];\n    style = String(map[tag]);\n\n    if (tag.slice(0, 2) === '!!') {\n      tag = 'tag:yaml.org,2002:' + tag.slice(2);\n    }\n    type = schema.compiledTypeMap['fallback'][tag];\n\n    if (type && _hasOwnProperty.call(type.styleAliases, style)) {\n      style = type.styleAliases[style];\n    }\n\n    result[tag] = style;\n  }\n\n  return result;\n}\n\nfunction encodeHex(character) {\n  var string, handle, length;\n\n  string = character.toString(16).toUpperCase();\n\n  if (character <= 0xFF) {\n    handle = 'x';\n    length = 2;\n  } else if (character <= 0xFFFF) {\n    handle = 'u';\n    length = 4;\n  } else if (character <= 0xFFFFFFFF) {\n    handle = 'U';\n    length = 8;\n  } else {\n    throw new exception('code point within a string may not be greater than 0xFFFFFFFF');\n  }\n\n  return '\\\\' + handle + common.repeat('0', length - string.length) + string;\n}\n\n\nvar QUOTING_TYPE_SINGLE = 1,\n    QUOTING_TYPE_DOUBLE = 2;\n\nfunction State(options) {\n  this.schema        = options['schema'] || _default;\n  this.indent        = Math.max(1, (options['indent'] || 2));\n  this.noArrayIndent = options['noArrayIndent'] || false;\n  this.skipInvalid   = options['skipInvalid'] || false;\n  this.flowLevel     = (common.isNothing(options['flowLevel']) ? -1 : options['flowLevel']);\n  this.styleMap      = compileStyleMap(this.schema, options['styles'] || null);\n  this.sortKeys      = options['sortKeys'] || false;\n  this.lineWidth     = options['lineWidth'] || 80;\n  this.noRefs        = options['noRefs'] || false;\n  this.noCompatMode  = options['noCompatMode'] || false;\n  this.condenseFlow  = options['condenseFlow'] || false;\n  this.quotingType   = options['quotingType'] === '\"' ? QUOTING_TYPE_DOUBLE : QUOTING_TYPE_SINGLE;\n  this.forceQuotes   = options['forceQuotes'] || false;\n  this.replacer      = typeof options['replacer'] === 'function' ? options['replacer'] : null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.explicitTypes = this.schema.compiledExplicit;\n\n  this.tag = null;\n  this.result = '';\n\n  this.duplicates = [];\n  this.usedDuplicates = null;\n}\n\n// Indents every line in a string. Empty lines (\\n only) are not indented.\nfunction indentString(string, spaces) {\n  var ind = common.repeat(' ', spaces),\n      position = 0,\n      next = -1,\n      result = '',\n      line,\n      length = string.length;\n\n  while (position < length) {\n    next = string.indexOf('\\n', position);\n    if (next === -1) {\n      line = string.slice(position);\n      position = length;\n    } else {\n      line = string.slice(position, next + 1);\n      position = next + 1;\n    }\n\n    if (line.length && line !== '\\n') result += ind;\n\n    result += line;\n  }\n\n  return result;\n}\n\nfunction generateNextLine(state, level) {\n  return '\\n' + common.repeat(' ', state.indent * level);\n}\n\nfunction testImplicitResolving(state, str) {\n  var index, length, type;\n\n  for (index = 0, length = state.implicitTypes.length; index < length; index += 1) {\n    type = state.implicitTypes[index];\n\n    if (type.resolve(str)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// [33] s-white ::= s-space | s-tab\nfunction isWhitespace(c) {\n  return c === CHAR_SPACE || c === CHAR_TAB;\n}\n\n// Returns true if the character can be printed without escaping.\n// From YAML 1.2: \"any allowed characters known to be non-printable\n// should also be escaped. [However,] This isnt mandatory\"\n// Derived from nb-char - \\t - #x85 - #xA0 - #x2028 - #x2029.\nfunction isPrintable(c) {\n  return  (0x00020 <= c && c <= 0x00007E)\n      || ((0x000A1 <= c && c <= 0x00D7FF) && c !== 0x2028 && c !== 0x2029)\n      || ((0x0E000 <= c && c <= 0x00FFFD) && c !== CHAR_BOM)\n      ||  (0x10000 <= c && c <= 0x10FFFF);\n}\n\n// [34] ns-char ::= nb-char - s-white\n// [27] nb-char ::= c-printable - b-char - c-byte-order-mark\n// [26] b-char  ::= b-line-feed | b-carriage-return\n// Including s-white (for some reason, examples doesn't match specs in this aspect)\n// ns-char ::= c-printable - b-line-feed - b-carriage-return - c-byte-order-mark\nfunction isNsCharOrWhitespace(c) {\n  return isPrintable(c)\n    && c !== CHAR_BOM\n    // - b-char\n    && c !== CHAR_CARRIAGE_RETURN\n    && c !== CHAR_LINE_FEED;\n}\n\n// [127]  ns-plain-safe(c) ::= c = flow-out   ns-plain-safe-out\n//                             c = flow-in    ns-plain-safe-in\n//                             c = block-key  ns-plain-safe-out\n//                             c = flow-key   ns-plain-safe-in\n// [128] ns-plain-safe-out ::= ns-char\n// [129]  ns-plain-safe-in ::= ns-char - c-flow-indicator\n// [130]  ns-plain-char(c) ::=  ( ns-plain-safe(c) - : - # )\n//                            | ( /* An ns-char preceding */ # )\n//                            | ( : /* Followed by an ns-plain-safe(c) */ )\nfunction isPlainSafe(c, prev, inblock) {\n  var cIsNsCharOrWhitespace = isNsCharOrWhitespace(c);\n  var cIsNsChar = cIsNsCharOrWhitespace && !isWhitespace(c);\n  return (\n    // ns-plain-safe\n    inblock ? // c = flow-in\n      cIsNsCharOrWhitespace\n      : cIsNsCharOrWhitespace\n        // - c-flow-indicator\n        && c !== CHAR_COMMA\n        && c !== CHAR_LEFT_SQUARE_BRACKET\n        && c !== CHAR_RIGHT_SQUARE_BRACKET\n        && c !== CHAR_LEFT_CURLY_BRACKET\n        && c !== CHAR_RIGHT_CURLY_BRACKET\n  )\n    // ns-plain-char\n    && c !== CHAR_SHARP // false on '#'\n    && !(prev === CHAR_COLON && !cIsNsChar) // false on ': '\n    || (isNsCharOrWhitespace(prev) && !isWhitespace(prev) && c === CHAR_SHARP) // change to true on '[^ ]#'\n    || (prev === CHAR_COLON && cIsNsChar); // change to true on ':[^ ]'\n}\n\n// Simplified test for values allowed as the first character in plain style.\nfunction isPlainSafeFirst(c) {\n  // Uses a subset of ns-char - c-indicator\n  // where ns-char = nb-char - s-white.\n  // No support of ( ( ? | : | - ) /* Followed by an ns-plain-safe(c)) */ ) part\n  return isPrintable(c) && c !== CHAR_BOM\n    && !isWhitespace(c) // - s-white\n    // - (c-indicator ::=\n    // - | ? | : | , | [ | ] | { | }\n    && c !== CHAR_MINUS\n    && c !== CHAR_QUESTION\n    && c !== CHAR_COLON\n    && c !== CHAR_COMMA\n    && c !== CHAR_LEFT_SQUARE_BRACKET\n    && c !== CHAR_RIGHT_SQUARE_BRACKET\n    && c !== CHAR_LEFT_CURLY_BRACKET\n    && c !== CHAR_RIGHT_CURLY_BRACKET\n    // | # | & | * | ! | | | = | > | ' | \"\n    && c !== CHAR_SHARP\n    && c !== CHAR_AMPERSAND\n    && c !== CHAR_ASTERISK\n    && c !== CHAR_EXCLAMATION\n    && c !== CHAR_VERTICAL_LINE\n    && c !== CHAR_EQUALS\n    && c !== CHAR_GREATER_THAN\n    && c !== CHAR_SINGLE_QUOTE\n    && c !== CHAR_DOUBLE_QUOTE\n    // | % | @ | `)\n    && c !== CHAR_PERCENT\n    && c !== CHAR_COMMERCIAL_AT\n    && c !== CHAR_GRAVE_ACCENT;\n}\n\n// Simplified test for values allowed as the last character in plain style.\nfunction isPlainSafeLast(c) {\n  // just not whitespace or colon, it will be checked to be plain character later\n  return !isWhitespace(c) && c !== CHAR_COLON;\n}\n\n// Same as 'string'.codePointAt(pos), but works in older browsers.\nfunction codePointAt(string, pos) {\n  var first = string.charCodeAt(pos), second;\n  if (first >= 0xD800 && first <= 0xDBFF && pos + 1 < string.length) {\n    second = string.charCodeAt(pos + 1);\n    if (second >= 0xDC00 && second <= 0xDFFF) {\n      // https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n      return (first - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n    }\n  }\n  return first;\n}\n\n// Determines whether block indentation indicator is required.\nfunction needIndentIndicator(string) {\n  var leadingSpaceRe = /^\\n* /;\n  return leadingSpaceRe.test(string);\n}\n\nvar STYLE_PLAIN   = 1,\n    STYLE_SINGLE  = 2,\n    STYLE_LITERAL = 3,\n    STYLE_FOLDED  = 4,\n    STYLE_DOUBLE  = 5;\n\n// Determines which scalar styles are possible and returns the preferred style.\n// lineWidth = -1 => no limit.\n// Pre-conditions: str.length > 0.\n// Post-conditions:\n//    STYLE_PLAIN or STYLE_SINGLE => no \\n are in the string.\n//    STYLE_LITERAL => no lines are suitable for folding (or lineWidth is -1).\n//    STYLE_FOLDED => a line > lineWidth and can be folded (and lineWidth != -1).\nfunction chooseScalarStyle(string, singleLineOnly, indentPerLevel, lineWidth,\n  testAmbiguousType, quotingType, forceQuotes, inblock) {\n\n  var i;\n  var char = 0;\n  var prevChar = null;\n  var hasLineBreak = false;\n  var hasFoldableLine = false; // only checked if shouldTrackWidth\n  var shouldTrackWidth = lineWidth !== -1;\n  var previousLineBreak = -1; // count the first line correctly\n  var plain = isPlainSafeFirst(codePointAt(string, 0))\n          && isPlainSafeLast(codePointAt(string, string.length - 1));\n\n  if (singleLineOnly || forceQuotes) {\n    // Case: no block styles.\n    // Check for disallowed characters to rule out plain and single.\n    for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n      char = codePointAt(string, i);\n      if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char, prevChar, inblock);\n      prevChar = char;\n    }\n  } else {\n    // Case: block styles permitted.\n    for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n      char = codePointAt(string, i);\n      if (char === CHAR_LINE_FEED) {\n        hasLineBreak = true;\n        // Check if any line can be folded.\n        if (shouldTrackWidth) {\n          hasFoldableLine = hasFoldableLine ||\n            // Foldable line = too long, and not more-indented.\n            (i - previousLineBreak - 1 > lineWidth &&\n             string[previousLineBreak + 1] !== ' ');\n          previousLineBreak = i;\n        }\n      } else if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char, prevChar, inblock);\n      prevChar = char;\n    }\n    // in case the end is missing a \\n\n    hasFoldableLine = hasFoldableLine || (shouldTrackWidth &&\n      (i - previousLineBreak - 1 > lineWidth &&\n       string[previousLineBreak + 1] !== ' '));\n  }\n  // Although every style can represent \\n without escaping, prefer block styles\n  // for multiline, since they're more readable and they don't add empty lines.\n  // Also prefer folding a super-long line.\n  if (!hasLineBreak && !hasFoldableLine) {\n    // Strings interpretable as another type have to be quoted;\n    // e.g. the string 'true' vs. the boolean true.\n    if (plain && !forceQuotes && !testAmbiguousType(string)) {\n      return STYLE_PLAIN;\n    }\n    return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n  }\n  // Edge case: block indentation indicator can only have one digit.\n  if (indentPerLevel > 9 && needIndentIndicator(string)) {\n    return STYLE_DOUBLE;\n  }\n  // At this point we know block styles are valid.\n  // Prefer literal style unless we want to fold.\n  if (!forceQuotes) {\n    return hasFoldableLine ? STYLE_FOLDED : STYLE_LITERAL;\n  }\n  return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n}\n\n// Note: line breaking/folding is implemented for only the folded style.\n// NB. We drop the last trailing newline (if any) of a returned block scalar\n//  since the dumper adds its own newline. This always works:\n//     No ending newline => unaffected; already using strip \"-\" chomping.\n//     Ending newline    => removed then restored.\n//  Importantly, this keeps the \"+\" chomp indicator from gaining an extra line.\nfunction writeScalar(state, string, level, iskey, inblock) {\n  state.dump = (function () {\n    if (string.length === 0) {\n      return state.quotingType === QUOTING_TYPE_DOUBLE ? '\"\"' : \"''\";\n    }\n    if (!state.noCompatMode) {\n      if (DEPRECATED_BOOLEANS_SYNTAX.indexOf(string) !== -1 || DEPRECATED_BASE60_SYNTAX.test(string)) {\n        return state.quotingType === QUOTING_TYPE_DOUBLE ? ('\"' + string + '\"') : (\"'\" + string + \"'\");\n      }\n    }\n\n    var indent = state.indent * Math.max(1, level); // no 0-indent scalars\n    // As indentation gets deeper, let the width decrease monotonically\n    // to the lower bound min(state.lineWidth, 40).\n    // Note that this implies\n    //  state.lineWidth  40 + state.indent: width is fixed at the lower bound.\n    //  state.lineWidth > 40 + state.indent: width decreases until the lower bound.\n    // This behaves better than a constant minimum width which disallows narrower options,\n    // or an indent threshold which causes the width to suddenly increase.\n    var lineWidth = state.lineWidth === -1\n      ? -1 : Math.max(Math.min(state.lineWidth, 40), state.lineWidth - indent);\n\n    // Without knowing if keys are implicit/explicit, assume implicit for safety.\n    var singleLineOnly = iskey\n      // No block styles in flow mode.\n      || (state.flowLevel > -1 && level >= state.flowLevel);\n    function testAmbiguity(string) {\n      return testImplicitResolving(state, string);\n    }\n\n    switch (chooseScalarStyle(string, singleLineOnly, state.indent, lineWidth,\n      testAmbiguity, state.quotingType, state.forceQuotes && !iskey, inblock)) {\n\n      case STYLE_PLAIN:\n        return string;\n      case STYLE_SINGLE:\n        return \"'\" + string.replace(/'/g, \"''\") + \"'\";\n      case STYLE_LITERAL:\n        return '|' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(string, indent));\n      case STYLE_FOLDED:\n        return '>' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(foldString(string, lineWidth), indent));\n      case STYLE_DOUBLE:\n        return '\"' + escapeString(string) + '\"';\n      default:\n        throw new exception('impossible error: invalid scalar style');\n    }\n  }());\n}\n\n// Pre-conditions: string is valid for a block scalar, 1 <= indentPerLevel <= 9.\nfunction blockHeader(string, indentPerLevel) {\n  var indentIndicator = needIndentIndicator(string) ? String(indentPerLevel) : '';\n\n  // note the special case: the string '\\n' counts as a \"trailing\" empty line.\n  var clip =          string[string.length - 1] === '\\n';\n  var keep = clip && (string[string.length - 2] === '\\n' || string === '\\n');\n  var chomp = keep ? '+' : (clip ? '' : '-');\n\n  return indentIndicator + chomp + '\\n';\n}\n\n// (See the note for writeScalar.)\nfunction dropEndingNewline(string) {\n  return string[string.length - 1] === '\\n' ? string.slice(0, -1) : string;\n}\n\n// Note: a long line without a suitable break point will exceed the width limit.\n// Pre-conditions: every char in str isPrintable, str.length > 0, width > 0.\nfunction foldString(string, width) {\n  // In folded style, $k$ consecutive newlines output as $k+1$ newlines\n  // unless they're before or after a more-indented line, or at the very\n  // beginning or end, in which case $k$ maps to $k$.\n  // Therefore, parse each chunk as newline(s) followed by a content line.\n  var lineRe = /(\\n+)([^\\n]*)/g;\n\n  // first line (possibly an empty line)\n  var result = (function () {\n    var nextLF = string.indexOf('\\n');\n    nextLF = nextLF !== -1 ? nextLF : string.length;\n    lineRe.lastIndex = nextLF;\n    return foldLine(string.slice(0, nextLF), width);\n  }());\n  // If we haven't reached the first content line yet, don't add an extra \\n.\n  var prevMoreIndented = string[0] === '\\n' || string[0] === ' ';\n  var moreIndented;\n\n  // rest of the lines\n  var match;\n  while ((match = lineRe.exec(string))) {\n    var prefix = match[1], line = match[2];\n    moreIndented = (line[0] === ' ');\n    result += prefix\n      + (!prevMoreIndented && !moreIndented && line !== ''\n        ? '\\n' : '')\n      + foldLine(line, width);\n    prevMoreIndented = moreIndented;\n  }\n\n  return result;\n}\n\n// Greedy line breaking.\n// Picks the longest line under the limit each time,\n// otherwise settles for the shortest line over the limit.\n// NB. More-indented lines *cannot* be folded, as that would add an extra \\n.\nfunction foldLine(line, width) {\n  if (line === '' || line[0] === ' ') return line;\n\n  // Since a more-indented line adds a \\n, breaks can't be followed by a space.\n  var breakRe = / [^ ]/g; // note: the match index will always be <= length-2.\n  var match;\n  // start is an inclusive index. end, curr, and next are exclusive.\n  var start = 0, end, curr = 0, next = 0;\n  var result = '';\n\n  // Invariants: 0 <= start <= length-1.\n  //   0 <= curr <= next <= max(0, length-2). curr - start <= width.\n  // Inside the loop:\n  //   A match implies length >= 2, so curr and next are <= length-2.\n  while ((match = breakRe.exec(line))) {\n    next = match.index;\n    // maintain invariant: curr - start <= width\n    if (next - start > width) {\n      end = (curr > start) ? curr : next; // derive end <= length-2\n      result += '\\n' + line.slice(start, end);\n      // skip the space that was output as \\n\n      start = end + 1;                    // derive start <= length-1\n    }\n    curr = next;\n  }\n\n  // By the invariants, start <= length-1, so there is something left over.\n  // It is either the whole string or a part starting from non-whitespace.\n  result += '\\n';\n  // Insert a break if the remainder is too long and there is a break available.\n  if (line.length - start > width && curr > start) {\n    result += line.slice(start, curr) + '\\n' + line.slice(curr + 1);\n  } else {\n    result += line.slice(start);\n  }\n\n  return result.slice(1); // drop extra \\n joiner\n}\n\n// Escapes a double-quoted string.\nfunction escapeString(string) {\n  var result = '';\n  var char = 0;\n  var escapeSeq;\n\n  for (var i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n    char = codePointAt(string, i);\n    escapeSeq = ESCAPE_SEQUENCES[char];\n\n    if (!escapeSeq && isPrintable(char)) {\n      result += string[i];\n      if (char >= 0x10000) result += string[i + 1];\n    } else {\n      result += escapeSeq || encodeHex(char);\n    }\n  }\n\n  return result;\n}\n\nfunction writeFlowSequence(state, level, object) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length,\n      value;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    value = object[index];\n\n    if (state.replacer) {\n      value = state.replacer.call(object, String(index), value);\n    }\n\n    // Write only valid elements, put null instead of invalid elements.\n    if (writeNode(state, level, value, false, false) ||\n        (typeof value === 'undefined' &&\n         writeNode(state, level, null, false, false))) {\n\n      if (_result !== '') _result += ',' + (!state.condenseFlow ? ' ' : '');\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = '[' + _result + ']';\n}\n\nfunction writeBlockSequence(state, level, object, compact) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length,\n      value;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    value = object[index];\n\n    if (state.replacer) {\n      value = state.replacer.call(object, String(index), value);\n    }\n\n    // Write only valid elements, put null instead of invalid elements.\n    if (writeNode(state, level + 1, value, true, true, false, true) ||\n        (typeof value === 'undefined' &&\n         writeNode(state, level + 1, null, true, true, false, true))) {\n\n      if (!compact || _result !== '') {\n        _result += generateNextLine(state, level);\n      }\n\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        _result += '-';\n      } else {\n        _result += '- ';\n      }\n\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '[]'; // Empty sequence if no valid values.\n}\n\nfunction writeFlowMapping(state, level, object) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      pairBuffer;\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n\n    pairBuffer = '';\n    if (_result !== '') pairBuffer += ', ';\n\n    if (state.condenseFlow) pairBuffer += '\"';\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (state.replacer) {\n      objectValue = state.replacer.call(object, objectKey, objectValue);\n    }\n\n    if (!writeNode(state, level, objectKey, false, false)) {\n      continue; // Skip this pair because of invalid key;\n    }\n\n    if (state.dump.length > 1024) pairBuffer += '? ';\n\n    pairBuffer += state.dump + (state.condenseFlow ? '\"' : '') + ':' + (state.condenseFlow ? '' : ' ');\n\n    if (!writeNode(state, level, objectValue, false, false)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = '{' + _result + '}';\n}\n\nfunction writeBlockMapping(state, level, object, compact) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      explicitPair,\n      pairBuffer;\n\n  // Allow sorting keys so that the output file is deterministic\n  if (state.sortKeys === true) {\n    // Default sorting\n    objectKeyList.sort();\n  } else if (typeof state.sortKeys === 'function') {\n    // Custom sort function\n    objectKeyList.sort(state.sortKeys);\n  } else if (state.sortKeys) {\n    // Something is wrong\n    throw new exception('sortKeys must be a boolean or a function');\n  }\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n    pairBuffer = '';\n\n    if (!compact || _result !== '') {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (state.replacer) {\n      objectValue = state.replacer.call(object, objectKey, objectValue);\n    }\n\n    if (!writeNode(state, level + 1, objectKey, true, true, true)) {\n      continue; // Skip this pair because of invalid key.\n    }\n\n    explicitPair = (state.tag !== null && state.tag !== '?') ||\n                   (state.dump && state.dump.length > 1024);\n\n    if (explicitPair) {\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        pairBuffer += '?';\n      } else {\n        pairBuffer += '? ';\n      }\n    }\n\n    pairBuffer += state.dump;\n\n    if (explicitPair) {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    if (!writeNode(state, level + 1, objectValue, true, explicitPair)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n      pairBuffer += ':';\n    } else {\n      pairBuffer += ': ';\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '{}'; // Empty mapping if no valid pairs.\n}\n\nfunction detectType(state, object, explicit) {\n  var _result, typeList, index, length, type, style;\n\n  typeList = explicit ? state.explicitTypes : state.implicitTypes;\n\n  for (index = 0, length = typeList.length; index < length; index += 1) {\n    type = typeList[index];\n\n    if ((type.instanceOf  || type.predicate) &&\n        (!type.instanceOf || ((typeof object === 'object') && (object instanceof type.instanceOf))) &&\n        (!type.predicate  || type.predicate(object))) {\n\n      if (explicit) {\n        if (type.multi && type.representName) {\n          state.tag = type.representName(object);\n        } else {\n          state.tag = type.tag;\n        }\n      } else {\n        state.tag = '?';\n      }\n\n      if (type.represent) {\n        style = state.styleMap[type.tag] || type.defaultStyle;\n\n        if (_toString.call(type.represent) === '[object Function]') {\n          _result = type.represent(object, style);\n        } else if (_hasOwnProperty.call(type.represent, style)) {\n          _result = type.represent[style](object, style);\n        } else {\n          throw new exception('!<' + type.tag + '> tag resolver accepts not \"' + style + '\" style');\n        }\n\n        state.dump = _result;\n      }\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// Serializes `object` and writes it to global `result`.\n// Returns true on success, or false on invalid object.\n//\nfunction writeNode(state, level, object, block, compact, iskey, isblockseq) {\n  state.tag = null;\n  state.dump = object;\n\n  if (!detectType(state, object, false)) {\n    detectType(state, object, true);\n  }\n\n  var type = _toString.call(state.dump);\n  var inblock = block;\n  var tagStr;\n\n  if (block) {\n    block = (state.flowLevel < 0 || state.flowLevel > level);\n  }\n\n  var objectOrArray = type === '[object Object]' || type === '[object Array]',\n      duplicateIndex,\n      duplicate;\n\n  if (objectOrArray) {\n    duplicateIndex = state.duplicates.indexOf(object);\n    duplicate = duplicateIndex !== -1;\n  }\n\n  if ((state.tag !== null && state.tag !== '?') || duplicate || (state.indent !== 2 && level > 0)) {\n    compact = false;\n  }\n\n  if (duplicate && state.usedDuplicates[duplicateIndex]) {\n    state.dump = '*ref_' + duplicateIndex;\n  } else {\n    if (objectOrArray && duplicate && !state.usedDuplicates[duplicateIndex]) {\n      state.usedDuplicates[duplicateIndex] = true;\n    }\n    if (type === '[object Object]') {\n      if (block && (Object.keys(state.dump).length !== 0)) {\n        writeBlockMapping(state, level, state.dump, compact);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowMapping(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object Array]') {\n      if (block && (state.dump.length !== 0)) {\n        if (state.noArrayIndent && !isblockseq && level > 0) {\n          writeBlockSequence(state, level - 1, state.dump, compact);\n        } else {\n          writeBlockSequence(state, level, state.dump, compact);\n        }\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowSequence(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object String]') {\n      if (state.tag !== '?') {\n        writeScalar(state, state.dump, level, iskey, inblock);\n      }\n    } else if (type === '[object Undefined]') {\n      return false;\n    } else {\n      if (state.skipInvalid) return false;\n      throw new exception('unacceptable kind of an object to dump ' + type);\n    }\n\n    if (state.tag !== null && state.tag !== '?') {\n      // Need to encode all characters except those allowed by the spec:\n      //\n      // [35] ns-dec-digit    ::=  [#x30-#x39] /* 0-9 */\n      // [36] ns-hex-digit    ::=  ns-dec-digit\n      //                         | [#x41-#x46] /* A-F */ | [#x61-#x66] /* a-f */\n      // [37] ns-ascii-letter ::=  [#x41-#x5A] /* A-Z */ | [#x61-#x7A] /* a-z */\n      // [38] ns-word-char    ::=  ns-dec-digit | ns-ascii-letter | -\n      // [39] ns-uri-char     ::=  % ns-hex-digit ns-hex-digit | ns-word-char | #\n      //                         | ; | / | ? | : | @ | & | = | + | $ | ,\n      //                         | _ | . | ! | ~ | * | ' | ( | ) | [ | ]\n      //\n      // Also need to encode '!' because it has special meaning (end of tag prefix).\n      //\n      tagStr = encodeURI(\n        state.tag[0] === '!' ? state.tag.slice(1) : state.tag\n      ).replace(/!/g, '%21');\n\n      if (state.tag[0] === '!') {\n        tagStr = '!' + tagStr;\n      } else if (tagStr.slice(0, 18) === 'tag:yaml.org,2002:') {\n        tagStr = '!!' + tagStr.slice(18);\n      } else {\n        tagStr = '!<' + tagStr + '>';\n      }\n\n      state.dump = tagStr + ' ' + state.dump;\n    }\n  }\n\n  return true;\n}\n\nfunction getDuplicateReferences(object, state) {\n  var objects = [],\n      duplicatesIndexes = [],\n      index,\n      length;\n\n  inspectNode(object, objects, duplicatesIndexes);\n\n  for (index = 0, length = duplicatesIndexes.length; index < length; index += 1) {\n    state.duplicates.push(objects[duplicatesIndexes[index]]);\n  }\n  state.usedDuplicates = new Array(length);\n}\n\nfunction inspectNode(object, objects, duplicatesIndexes) {\n  var objectKeyList,\n      index,\n      length;\n\n  if (object !== null && typeof object === 'object') {\n    index = objects.indexOf(object);\n    if (index !== -1) {\n      if (duplicatesIndexes.indexOf(index) === -1) {\n        duplicatesIndexes.push(index);\n      }\n    } else {\n      objects.push(object);\n\n      if (Array.isArray(object)) {\n        for (index = 0, length = object.length; index < length; index += 1) {\n          inspectNode(object[index], objects, duplicatesIndexes);\n        }\n      } else {\n        objectKeyList = Object.keys(object);\n\n        for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n          inspectNode(object[objectKeyList[index]], objects, duplicatesIndexes);\n        }\n      }\n    }\n  }\n}\n\nfunction dump$1(input, options) {\n  options = options || {};\n\n  var state = new State(options);\n\n  if (!state.noRefs) getDuplicateReferences(input, state);\n\n  var value = input;\n\n  if (state.replacer) {\n    value = state.replacer.call({ '': value }, '', value);\n  }\n\n  if (writeNode(state, 0, value, true, true)) return state.dump + '\\n';\n\n  return '';\n}\n\nvar dump_1 = dump$1;\n\nvar dumper = {\n\tdump: dump_1\n};\n\nfunction renamed(from, to) {\n  return function () {\n    throw new Error('Function yaml.' + from + ' is removed in js-yaml 4. ' +\n      'Use yaml.' + to + ' instead, which is now safe by default.');\n  };\n}\n\n\nvar Type                = type;\nvar Schema              = schema;\nvar FAILSAFE_SCHEMA     = failsafe;\nvar JSON_SCHEMA         = json;\nvar CORE_SCHEMA         = core;\nvar DEFAULT_SCHEMA      = _default;\nvar load                = loader.load;\nvar loadAll             = loader.loadAll;\nvar dump                = dumper.dump;\nvar YAMLException       = exception;\n\n// Re-export all types in case user wants to create custom schema\nvar types = {\n  binary:    binary,\n  float:     float,\n  map:       map,\n  null:      _null,\n  pairs:     pairs,\n  set:       set,\n  timestamp: timestamp,\n  bool:      bool,\n  int:       int,\n  merge:     merge,\n  omap:      omap,\n  seq:       seq,\n  str:       str\n};\n\n// Removed functions from JS-YAML 3.0.x\nvar safeLoad            = renamed('safeLoad', 'load');\nvar safeLoadAll         = renamed('safeLoadAll', 'loadAll');\nvar safeDump            = renamed('safeDump', 'dump');\n\nvar jsYaml = {\n\tType: Type,\n\tSchema: Schema,\n\tFAILSAFE_SCHEMA: FAILSAFE_SCHEMA,\n\tJSON_SCHEMA: JSON_SCHEMA,\n\tCORE_SCHEMA: CORE_SCHEMA,\n\tDEFAULT_SCHEMA: DEFAULT_SCHEMA,\n\tload: load,\n\tloadAll: loadAll,\n\tdump: dump,\n\tYAMLException: YAMLException,\n\ttypes: types,\n\tsafeLoad: safeLoad,\n\tsafeLoadAll: safeLoadAll,\n\tsafeDump: safeDump\n};\n\nexport default jsYaml;\nexport { CORE_SCHEMA, DEFAULT_SCHEMA, FAILSAFE_SCHEMA, JSON_SCHEMA, Schema, Type, YAMLException, dump, load, loadAll, safeDump, safeLoad, safeLoadAll, types };\n","//import * as CBLCARS from '../cb-lcars-vars.js';\nimport { cblcarsLog } from './cb-lcars-logging.js';\nimport jsyaml from 'js-yaml';\n\n// Ensure global fallback for legacy callers expecting window.jsyaml\ntry {\n  if (typeof window !== 'undefined' && !window.jsyaml) {\n    window.jsyaml = { load: jsyaml.load, dump: jsyaml.dump };\n  }\n} catch {}\n\n/**\n * Fetch YAML content from a given URL.\n * @param {string} url - The URL of the YAML file.\n * @returns {Promise<string>} - A promise that resolves to the YAML content as a string.\n */\nexport async function fetchYAML(url) {\n    try {\n        const response = await fetch(url);\n        if (response.ok) {\n            const yamlContent = await response.text();\n            //cblcarsLog.debug(`Fetched yaml file ${url}`);\n\n            return yamlContent;\n        } //else {\n          //  throw new Error(`Error fetching YAML: ${response.status} ${response.statusText}`);\n        //}\n    } catch (error) {\n        cblcarsLog.error('[fetchYAML] Error fetching YAML file ',error);\n        throw error;\n    }\n}\n\n// Function to read and parse the YAML file\nexport async function readYamlFile(url) {\n    try {\n        const response = await fetchYAML(url);\n        const jsObject = jsyaml.load(response);\n        //await cblcarsLog.info(`Processed YAML file: ${url}`);\n        //await cblcarsLog.debug(jsObject);\n        return jsObject;\n    } catch (error) {\n        cblcarsLog.error('[readYamlFile] Failed to parse YAML file',error.message);\n        throw error; // Re-throw the error after logging it\n    }\n}\n\n/**\n * Ensure the SVG cache exists on the window object.\n */\nfunction ensureSVGCache() {\n    window.cblcars = window.cblcars || {};\n    window.cblcars.msd = window.cblcars.msd || {};\n    window.cblcars.msd.svg_templates = window.cblcars.msd.svg_templates || {};\n    return window.cblcars.msd.svg_templates;\n}\n\n/**\n * Load an SVG from a URL and cache it under the given key.\n * Returns a promise that resolves to the SVG string.\n */\nexport async function loadSVGToCache(key, url) {\n    const cache = ensureSVGCache();\n    if (cache[key]) {\n        // Already cached\n        return cache[key];\n    }\n    try {\n        const response = await fetch(url);\n        if (!response.ok) {\n            cblcarsLog.error(`[loadSVGToCache] Failed to fetch SVG [${url}] for key [${key}]: ${response.status} ${response.statusText}`);\n            return undefined;\n        }\n        let svgText = await response.text();\n\n        // Find the opening <svg> tag and its attributes.\n        svgText = svgText.replace(/<svg([^>]*)>/i, (match, attributes) => {\n            // Remove existing width and height attributes.\n            let newAttributes = attributes.replace(/\\s(width|height)=[\"'][^\"']*[\"']/gi, '');\n            // Add width=\"100%\" and height=\"100%\".\n            return `<svg width=\"100%\" height=\"100%\"${newAttributes}>`;\n        });\n\n        cache[key] = svgText;\n        cblcarsLog.debug(`[loadSVGToCache] Loaded SVG [${key}] from [${url}]`);\n        return svgText;\n    } catch (error) {\n        cblcarsLog.error(`[loadSVGToCache] Error loading SVG [${key}] from [${url}]`, error);\n        return undefined;\n    }\n}\n\n/**\n * Get an SVG from the cache by key.\n */\nexport function getSVGFromCache(key) {\n    const cache = ensureSVGCache();\n    return cache[key];\n}\n\n/**\n * Preload a list of SVGs from a base path.\n * svgList: array of keys (filenames without .svg)\n * basePath: path to prepend (should end with /)\n * Returns a promise that resolves when all SVGs are loaded.\n */\nexport async function preloadSVGs(svgList, basePath) {\n    const promises = svgList.map(key => {\n        const url = `${basePath}${key}.svg`;\n        return loadSVGToCache(key, url);\n    });\n    await Promise.all(promises);\n    cblcarsLog.info(`[preloadSVGs] Preloaded SVGs: ${svgList.join(', ')} from ${basePath}`);\n}\n","import * as CBLCARS from '../cb-lcars-vars.js'\nimport { cblcarsLog } from '../utils/cb-lcars-logging.js';\n\nimport { html, css, unsafeCSS } from 'lit';\n\nimport EditorForm from 'ha-editor-formbuilder-yaml';\n\nexport class CBLCARSCardEditor extends EditorForm {\n\n    _formControls;\n    _cardType;\n\n    constructor(cardType) {\n        super();\n\n        this._formControls = {};\n        this._cardType = \"\";\n        this._cardType = cardType;\n\n        //cblcarsLog.debug(`Setting up editor for ${cardType}`);\n\n        this._initializationPromise = this._initialize();\n    }\n\n    async _initialize() {\n        try {\n            // Fetch only the relevant JSON file for this card type\n            const response = await fetch(`${CBLCARS.card_editor_uri}/${this._cardType}.json`);\n            if (!response.ok) throw new Error(`Form definition not found for card type: ${this._cardType}`);\n            const formControls = await response.json();\n            cblcarsLog.debug('Loaded formControls:', formControls);\n            this._formControls = formControls;\n\n            // Handle user styles if present\n            this._userStyles = css`${unsafeCSS((formControls.css && formControls.css.cssText) || '')}`;\n            this._mergeUserStyles = formControls?.css?.mergeUserStyles ?? true;\n\n            this.requestUpdate();\n        } catch(error) {\n            cblcarsLog.error('Error fetching editor form definition: ', error);\n        }\n    }\n\n    async setConfig(config) {\n\n        await this._initializationPromise;\n\n        super.setConfig(config);\n        this.requestUpdate();\n\n    }\n\n    render() {\n        if (!this._hass) {\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Home Assistant instance is missing.</ha-alert>`;\n        }\n\n        if (!this._config) {\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Card configuration is missing.</ha-alert>`;\n        }\n\n        if (!this._formControls) {\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Form controls are missing.</ha-alert>`;\n        }\n\n        try {\n            const formContent = this._formControls;\n            const returnForm = this.generateForm(formContent);\n            return returnForm;\n        } catch (error) {\n            cblcarsLog.error('Error rendering configuration form:', error);\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Error rendering form: ${error.message}</ha-alert>`;\n        }\n    }\n\n}\n","import { core_fonts, font_url } from '../cb-lcars-vars.js';\nimport { cblcarsLog } from './cb-lcars-logging.js';\n\n/**\n * Process card configurations to load all fonts.\n */\nexport function loadAllFontsFromConfig(config) {\n  const fonts = new Set();\n  function scan(obj) {\n    if (obj && typeof obj === 'object') {\n      for (const key in obj) {\n        if (key === 'font_family' && typeof obj[key] === 'string') {\n          fonts.add(obj[key]);\n        } else if (typeof obj[key] === 'object') {\n          scan(obj[key]);\n        }\n      }\n    }\n  }\n  scan(config);\n  fonts.forEach(font => window.cblcars.loadFont(font));\n}\n\n/**\n * Dynamically loads a CB-LCARS font based on font-family name.\n * Only loads if not already injected.\n */\nexport function loadFont(fontInput) {\n  window.cblcars._loadedFonts = window.cblcars._loadedFonts || new Set();\n\n  const fontList = fontInput.split(',').map(f =>\n    f.trim().replace(/^['\"]|['\"]$/g, '')\n  );\n\n  fontList.forEach(fontName => {\n    // If its a URL, inject directly\n    if (fontName.startsWith('http://') || fontName.startsWith('https://')) {\n      const href = fontName;\n      if (window.cblcars._loadedFonts.has(href)) return;\n      if (document.querySelector(`link[href=\"${href}\"]`)) {\n        window.cblcars._loadedFonts.add(href);\n        return;\n      }\n      const link = document.createElement('link');\n      link.rel = 'stylesheet';\n      link.href = href;\n      document.head.appendChild(link);\n      window.cblcars._loadedFonts.add(href);\n      cblcarsLog.info(`[loadFont] Loaded remote font from: ${href}`);\n      return;\n    }\n\n    // Else assume local CB-LCARS font\n    if (!fontName.startsWith('cb-lcars_')) return;\n\n    const href = `/hacsfiles/cb-lcars/fonts/${fontName}.css`;\n    const fontKey = fontName;\n\n    if (window.cblcars._loadedFonts.has(fontKey)) return;\n    if (document.querySelector(`link[href=\"${href}\"]`)) {\n      window.cblcars._loadedFonts.add(fontKey);\n      return;\n    }\n\n    const link = document.createElement('link');\n    link.rel = 'stylesheet';\n    link.href = href;\n    document.head.appendChild(link);\n    window.cblcars._loadedFonts.add(fontKey);\n    cblcarsLog.info(`[loadFont] Loaded local font: ${fontName}`);\n  });\n}\n\n\n/**\n * Loads all core CB-LCARS fonts using the shared dynamic loader.\n */\nexport async function loadCoreFonts() {\n  try {\n    const fonts = Array.isArray(core_fonts) ? core_fonts : [core_fonts];\n    for (const font of fonts) {\n      window.cblcars.loadFont(font);\n    }\n  } catch (error) {\n    cblcarsLog.error(`[loadCoreFonts] Failed to preload core fonts: ${error.message}`);\n  }\n}\n","function t(t,e,i,n){var r,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(s<3?r(a):s>3?r(e,i,a):r(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}const e=window,i=e.ShadowRoot&&(void 0===e.ShadyCSS||e.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,n=Symbol(),r=new WeakMap;class s{constructor(t,e,i){if(this._$cssResult$=!0,i!==n)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(i&&void 0===t){const i=void 0!==e&&1===e.length;i&&(t=r.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&r.set(e,t))}return t}toString(){return this.cssText}}const a=i?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const i of t.cssRules)e+=i.cssText;return(t=>new s(\"string\"==typeof t?t:t+\"\",void 0,n))(e)})(t):t;var o;const l=window,c=l.trustedTypes,h=c?c.emptyScript:\"\",u=l.reactiveElementPolyfillSupport,d={toAttribute(t,e){switch(e){case Boolean:t=t?h:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,e)=>e!==t&&(e==e||t==t),p={attribute:!0,type:String,converter:d,reflect:!1,hasChanged:f},m=\"finalized\";class g extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,i)=>{const n=this._$Ep(i,e);void 0!==n&&(this._$Ev.set(n,i),t.push(n))})),t}static createProperty(t,e=p){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const i=\"symbol\"==typeof t?Symbol():\"__\"+t,n=this.getPropertyDescriptor(t,i,e);void 0!==n&&Object.defineProperty(this.prototype,t,n)}}static getPropertyDescriptor(t,e,i){return{get(){return this[e]},set(n){const r=this[t];this[e]=n,this.requestUpdate(t,r,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||p}static finalize(){if(this.hasOwnProperty(m))return!1;this[m]=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty(\"properties\")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const i of e)this.createProperty(i,t[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift(a(t))}else void 0!==t&&e.push(a(t));return e}static _$Ep(t,e){const i=e.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,i;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(i=t.hostConnected)||void 0===i||i.call(t))}removeController(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t;const n=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,n)=>{i?t.adoptedStyleSheets=n.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):n.forEach((i=>{const n=document.createElement(\"style\"),r=e.litNonce;void 0!==r&&n.setAttribute(\"nonce\",r),n.textContent=i.cssText,t.appendChild(n)}))})(n,this.constructor.elementStyles),n}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EO(t,e,i=p){var n;const r=this.constructor._$Ep(t,i);if(void 0!==r&&!0===i.reflect){const s=(void 0!==(null===(n=i.converter)||void 0===n?void 0:n.toAttribute)?i.converter:d).toAttribute(e,i.type);this._$El=t,null==s?this.removeAttribute(r):this.setAttribute(r,s),this._$El=null}}_$AK(t,e){var i;const n=this.constructor,r=n._$Ev.get(t);if(void 0!==r&&this._$El!==r){const t=n.getPropertyOptions(r),s=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(i=t.converter)||void 0===i?void 0:i.fromAttribute)?t.converter:d;this._$El=r,this[r]=s.fromAttribute(e,t.type),this._$El=null}}requestUpdate(t,e,i){let n=!0;void 0!==t&&(((i=i||this.constructor.getPropertyOptions(t)).hasChanged||f)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===i.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,i))):n=!1),!this.isUpdatePending&&n&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,e)=>this[e]=t)),this._$Ei=void 0);let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(i)):this._$Ek()}catch(t){throw e=!1,this._$Ek(),t}e&&this._$AE(i)}willUpdate(t){}_$AE(t){var e;null===(e=this._$ES)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,e)=>this._$EO(e,this[e],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}var _;g[m]=!0,g.elementProperties=new Map,g.elementStyles=[],g.shadowRootOptions={mode:\"open\"},null==u||u({ReactiveElement:g}),(null!==(o=l.reactiveElementVersions)&&void 0!==o?o:l.reactiveElementVersions=[]).push(\"1.6.2\");const v=window,b=v.trustedTypes,y=b?b.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,w=\"$lit$\",$=`lit$${(Math.random()+\"\").slice(9)}$`,A=\"?\"+$,x=`<${A}>`,k=document,S=()=>k.createComment(\"\"),E=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,O=Array.isArray,T=\"[ \\t\\n\\f\\r]\",C=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,M=/-->/g,j=/>/g,H=RegExp(`>|${T}(?:([^\\\\s\"'>=/]+)(${T}*=${T}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),D=/'/g,R=/\"/g,N=/^(?:script|style|textarea|title)$/i,P=(t=>(e,...i)=>({_$litType$:t,strings:e,values:i}))(1),z=Symbol.for(\"lit-noChange\"),L=Symbol.for(\"lit-nothing\"),I=new WeakMap,F=k.createTreeWalker(k,129,null,!1);function V(t,e){if(!Array.isArray(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==y?y.createHTML(e):e}const U=(t,e)=>{const i=t.length-1,n=[];let r,s=2===e?\"<svg>\":\"\",a=C;for(let o=0;o<i;o++){const e=t[o];let i,l,c=-1,h=0;for(;h<e.length&&(a.lastIndex=h,l=a.exec(e),null!==l);)h=a.lastIndex,a===C?\"!--\"===l[1]?a=M:void 0!==l[1]?a=j:void 0!==l[2]?(N.test(l[2])&&(r=RegExp(\"</\"+l[2],\"g\")),a=H):void 0!==l[3]&&(a=H):a===H?\">\"===l[0]?(a=null!=r?r:C,c=-1):void 0===l[1]?c=-2:(c=a.lastIndex-l[2].length,i=l[1],a=void 0===l[3]?H:'\"'===l[3]?R:D):a===R||a===D?a=H:a===M||a===j?a=C:(a=H,r=void 0);const u=a===H&&t[o+1].startsWith(\"/>\")?\" \":\"\";s+=a===C?e+x:c>=0?(n.push(i),e.slice(0,c)+w+e.slice(c)+$+u):e+$+(-2===c?(n.push(void 0),o):u)}return[V(t,s+(t[i]||\"<?>\")+(2===e?\"</svg>\":\"\")),n]};class B{constructor({strings:t,_$litType$:e},i){let n;this.parts=[];let r=0,s=0;const a=t.length-1,o=this.parts,[l,c]=U(t,e);if(this.el=B.createElement(l,i),F.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(n=F.nextNode())&&o.length<a;){if(1===n.nodeType){if(n.hasAttributes()){const t=[];for(const e of n.getAttributeNames())if(e.endsWith(w)||e.startsWith($)){const i=c[s++];if(t.push(e),void 0!==i){const t=n.getAttribute(i.toLowerCase()+w).split($),e=/([.?@])?(.*)/.exec(i);o.push({type:1,index:r,name:e[2],strings:t,ctor:\".\"===e[1]?Y:\"?\"===e[1]?J:\"@\"===e[1]?X:G})}else o.push({type:6,index:r})}for(const e of t)n.removeAttribute(e)}if(N.test(n.tagName)){const t=n.textContent.split($),e=t.length-1;if(e>0){n.textContent=b?b.emptyScript:\"\";for(let i=0;i<e;i++)n.append(t[i],S()),F.nextNode(),o.push({type:2,index:++r});n.append(t[e],S())}}}else if(8===n.nodeType)if(n.data===A)o.push({type:2,index:r});else{let t=-1;for(;-1!==(t=n.data.indexOf($,t+1));)o.push({type:7,index:r}),t+=$.length-1}r++}}static createElement(t,e){const i=k.createElement(\"template\");return i.innerHTML=t,i}}function W(t,e,i=t,n){var r,s,a,o;if(e===z)return e;let l=void 0!==n?null===(r=i._$Co)||void 0===r?void 0:r[n]:i._$Cl;const c=E(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(s=null==l?void 0:l._$AO)||void 0===s||s.call(l,!1),void 0===c?l=void 0:(l=new c(t),l._$AT(t,i,n)),void 0!==n?(null!==(a=(o=i)._$Co)&&void 0!==a?a:o._$Co=[])[n]=l:i._$Cl=l),void 0!==l&&(e=W(t,l._$AS(t,e.values),l,n)),e}class q{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var e;const{el:{content:i},parts:n}=this._$AD,r=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:k).importNode(i,!0);F.currentNode=r;let s=F.nextNode(),a=0,o=0,l=n[0];for(;void 0!==l;){if(a===l.index){let e;2===l.type?e=new Z(s,s.nextSibling,this,t):1===l.type?e=new l.ctor(s,l.name,l.strings,this,t):6===l.type&&(e=new Q(s,this,t)),this._$AV.push(e),l=n[++o]}a!==(null==l?void 0:l.index)&&(s=F.nextNode(),a++)}return F.currentNode=k,r}v(t){let e=0;for(const i of this._$AV)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class Z{constructor(t,e,i,n){var r;this.type=2,this._$AH=L,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=n,this._$Cp=null===(r=null==n?void 0:n.isConnected)||void 0===r||r}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===(null==t?void 0:t.nodeType)&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=W(this,t,e),E(t)?t===L||null==t||\"\"===t?(this._$AH!==L&&this._$AR(),this._$AH=L):t!==this._$AH&&t!==z&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):(t=>O(t)||\"function\"==typeof(null==t?void 0:t[Symbol.iterator]))(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==L&&E(this._$AH)?this._$AA.nextSibling.data=t:this.$(k.createTextNode(t)),this._$AH=t}g(t){var e;const{values:i,_$litType$:n}=t,r=\"number\"==typeof n?this._$AC(t):(void 0===n.el&&(n.el=B.createElement(V(n.h,n.h[0]),this.options)),n);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===r)this._$AH.v(i);else{const t=new q(r,this),e=t.u(this.options);t.v(i),this.$(e),this._$AH=t}}_$AC(t){let e=I.get(t.strings);return void 0===e&&I.set(t.strings,e=new B(t)),e}T(t){O(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,n=0;for(const r of t)n===e.length?e.push(i=new Z(this.k(S()),this.k(S()),this,this.options)):i=e[n],i._$AI(r),n++;n<e.length&&(this._$AR(i&&i._$AB.nextSibling,n),e.length=n)}_$AR(t=this._$AA.nextSibling,e){var i;for(null===(i=this._$AP)||void 0===i||i.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cp=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class G{constructor(t,e,i,n,r){this.type=1,this._$AH=L,this._$AN=void 0,this.element=t,this.name=e,this._$AM=n,this.options=r,i.length>2||\"\"!==i[0]||\"\"!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=L}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,i,n){const r=this.strings;let s=!1;if(void 0===r)t=W(this,t,e,0),s=!E(t)||t!==this._$AH&&t!==z,s&&(this._$AH=t);else{const n=t;let a,o;for(t=r[0],a=0;a<r.length-1;a++)o=W(this,n[i+a],e,a),o===z&&(o=this._$AH[a]),s||(s=!E(o)||o!==this._$AH[a]),o===L?t=L:t!==L&&(t+=(null!=o?o:\"\")+r[a+1]),this._$AH[a]=o}s&&!n&&this.j(t)}j(t){t===L?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:\"\")}}class Y extends G{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===L?void 0:t}}const K=b?b.emptyScript:\"\";class J extends G{constructor(){super(...arguments),this.type=4}j(t){t&&t!==L?this.element.setAttribute(this.name,K):this.element.removeAttribute(this.name)}}class X extends G{constructor(t,e,i,n,r){super(t,e,i,n,r),this.type=5}_$AI(t,e=this){var i;if((t=null!==(i=W(this,t,e,0))&&void 0!==i?i:L)===z)return;const n=this._$AH,r=t===L&&n!==L||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,s=t!==L&&(n===L||r);r&&this.element.removeEventListener(this.name,this,n),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,i;\"function\"==typeof this._$AH?this._$AH.call(null!==(i=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==i?i:this.element,t):this._$AH.handleEvent(t)}}class Q{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){W(this,t)}}const tt=v.litHtmlPolyfillSupport;null==tt||tt(B,Z),(null!==(_=v.litHtmlVersions)&&void 0!==_?_:v.litHtmlVersions=[]).push(\"2.7.5\");var et,it;class nt extends g{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const i=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=i.firstChild),i}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,i)=>{var n,r;const s=null!==(n=null==i?void 0:i.renderBefore)&&void 0!==n?n:e;let a=s._$litPart$;if(void 0===a){const t=null!==(r=null==i?void 0:i.renderBefore)&&void 0!==r?r:null;s._$litPart$=a=new Z(e.insertBefore(S(),t),t,void 0,null!=i?i:{})}return a._$AI(t),a})(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return z}}nt.finalized=!0,nt._$litElement$=!0,null===(et=globalThis.litElementHydrateSupport)||void 0===et||et.call(globalThis,{LitElement:nt});const rt=globalThis.litElementPolyfillSupport;null==rt||rt({LitElement:nt}),(null!==(it=globalThis.litElementVersions)&&void 0!==it?it:globalThis.litElementVersions=[]).push(\"3.3.2\");const st=(t,e)=>\"method\"===e.kind&&e.descriptor&&!(\"value\"in e.descriptor)?{...e,finisher(i){i.createProperty(e.key,t)}}:{kind:\"field\",key:Symbol(),placement:\"own\",descriptor:{},originalKey:e.key,initializer(){\"function\"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(i){i.createProperty(e.key,t)}};function at(t){return(e,i)=>void 0!==i?((t,e,i)=>{e.constructor.createProperty(i,t)})(t,e,i):st(t,e)}const ot=({finisher:t,descriptor:e})=>(i,n)=>{var r;if(void 0===n){const n=null!==(r=i.originalKey)&&void 0!==r?r:i.key,s=null!=e?{kind:\"method\",placement:\"prototype\",key:n,descriptor:e(i.key)}:{...i,key:n};return null!=t&&(s.finisher=function(e){t(e,n)}),s}{const r=i.constructor;void 0!==e&&Object.defineProperty(i,n,e(n)),null==t||t(r,n)}};function lt(t){return ot({finisher:(e,i)=>{Object.assign(e.prototype[i],t)}})}var ct;null===(ct=window.HTMLSlotElement)||void 0===ct||ct.prototype.assignedElements;class ht{constructor(t){this.startPress=e=>{t().then((t=>{t&&t.startPress(e)}))},this.endPress=()=>{t().then((t=>{t&&t.endPress()}))},this.startFocus=()=>{t().then((t=>{t&&t.startFocus()}))},this.endFocus=()=>{t().then((t=>{t&&t.endFocus()}))},this.startHover=()=>{t().then((t=>{t&&t.startHover()}))},this.endHover=()=>{t().then((t=>{t&&t.endHover()}))}}}const ut=1,dt=2,ft=t=>(...e)=>({_$litDirective$:t,values:e});class pt{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}const mt=\"important\",gt=\" !\"+mt,_t=ft(class extends pt{constructor(t){var e;if(super(t),t.type!==ut||\"style\"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error(\"The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.\")}render(t){return Object.keys(t).reduce(((e,i)=>{const n=t[i];return null==n?e:e+`${i=i.includes(\"-\")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,\"-$&\").toLowerCase()}:${n};`}),\"\")}update(t,[e]){const{style:i}=t.element;if(void 0===this.ut){this.ut=new Set;for(const t in e)this.ut.add(t);return this.render(e)}this.ut.forEach((t=>{null==e[t]&&(this.ut.delete(t),t.includes(\"-\")?i.removeProperty(t):i[t]=\"\")}));for(const n in e){const t=e[n];if(null!=t){this.ut.add(n);const e=\"string\"==typeof t&&t.endsWith(gt);n.includes(\"-\")||e?i.setProperty(n,e?t.slice(0,-11):t,e?mt:\"\"):i[n]=t}}return z}});class vt extends pt{constructor(t){if(super(t),this.et=L,t.type!==dt)throw Error(this.constructor.directiveName+\"() can only be used in child bindings\")}render(t){if(t===L||null==t)return this.ft=void 0,this.et=t;if(t===z)return t;if(\"string\"!=typeof t)throw Error(this.constructor.directiveName+\"() called with a non-string value\");if(t===this.et)return this.ft;this.et=t;const e=[t];return e.raw=e,this.ft={_$litType$:this.constructor.resultType,strings:e,values:[]}}}vt.directiveName=\"unsafeHTML\",vt.resultType=1;const bt=ft(vt),yt=ft(class extends pt{constructor(t){var e;if(super(t),t.type!==ut||\"class\"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error(\"`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.\")}render(t){return\" \"+Object.keys(t).filter((e=>t[e])).join(\" \")+\" \"}update(t,[e]){var i,n;if(void 0===this.it){this.it=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(\" \").split(/\\s/).filter((t=>\"\"!==t))));for(const t in e)e[t]&&!(null===(i=this.nt)||void 0===i?void 0:i.has(t))&&this.it.add(t);return this.render(e)}const r=t.element.classList;this.it.forEach((t=>{t in e||(r.remove(t),this.it.delete(t))}));for(const s in e){const t=!!e[s];t===this.it.has(s)||(null===(n=this.nt)||void 0===n?void 0:n.has(s))||(t?(r.add(s),this.it.add(s)):(r.remove(s),this.it.delete(s)))}return z}}),wt=(t,e,i,n)=>{n=n||{},i=null==i?{}:i;const r=new Event(e,{bubbles:void 0===n.bubbles||n.bubbles,cancelable:Boolean(n.cancelable),composed:void 0===n.composed||n.composed});return r.detail=i,t.dispatchEvent(r),r},$t=(t,e)=>{if(t===e)return!0;if(t&&e&&\"object\"==typeof t&&\"object\"==typeof e){if(t.constructor!==e.constructor)return!1;let i,n;if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(i=n;0!=i--;)if(!$t(t[i],e[i]))return!1;return!0}if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(i of t.entries())if(!e.has(i[0]))return!1;for(i of t.entries())if(!$t(i[1],e.get(i[0])))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(i of t.entries())if(!e.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!==e.length)return!1;for(i=n;0!=i--;)if(t[i]!==e[i])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const r=Object.keys(t);if(n=r.length,n!==Object.keys(e).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(e,r[i]))return!1;for(i=n;0!=i--;){const n=r[i];if(!$t(t[n],e[n]))return!1}return!0}return t!=t&&e!=e},At=\"ontouchstart\"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;class xt extends HTMLElement{constructor(){super(),this.holdTime=500,this.held=!1,this.cancelled=!1,this.isRepeating=!1,this.repeatCount=0,this.ripple=document.createElement(\"mwc-ripple\")}connectedCallback(){Object.assign(this.style,{position:\"fixed\",width:At?\"100px\":\"50px\",height:At?\"100px\":\"50px\",transform:\"translate(-50%, -50%)\",pointerEvents:\"none\",zIndex:\"999\"}),this.appendChild(this.ripple),this.ripple.primary=!0,[\"touchcancel\",\"mouseout\",\"mouseup\",\"touchmove\",\"mousewheel\",\"wheel\",\"scroll\"].forEach((t=>{document.addEventListener(t,(()=>{this.cancelled=!0,this.timer&&(this.stopAnimation(),clearTimeout(this.timer),this.timer=void 0,this.isRepeating&&this.repeatTimeout&&(clearInterval(this.repeatTimeout),this.isRepeating=!1))}),{passive:!0})}))}bind(t,e){t.actionHandler&&$t(e,t.actionHandler.options)||(t.actionHandler?(t.removeEventListener(\"touchstart\",t.actionHandler.start),t.removeEventListener(\"touchend\",t.actionHandler.end),t.removeEventListener(\"touchcancel\",t.actionHandler.end),t.removeEventListener(\"mousedown\",t.actionHandler.start),t.removeEventListener(\"click\",t.actionHandler.end),t.removeEventListener(\"keyup\",t.actionHandler.handleEnter)):t.addEventListener(\"contextmenu\",(t=>{const e=t||window.event;return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,!1})),t.actionHandler={options:e},e.disabled||(t.actionHandler.start=i=>{let n,r;this.cancelled=!1,i.touches?(n=i.touches[0].clientX,r=i.touches[0].clientY):(n=i.clientX,r=i.clientY),e.hasHold&&(this.held=!1,this.timer=window.setTimeout((()=>{this.startAnimation(n,r),this.held=!0,e.repeat&&!this.isRepeating&&(this.repeatCount=0,this.isRepeating=!0,this.repeatTimeout=setInterval((()=>{wt(t,\"action\",{action:\"hold\"}),this.repeatCount++,this.repeatTimeout&&e.repeatLimit&&this.repeatCount>=e.repeatLimit&&(clearInterval(this.repeatTimeout),this.isRepeating=!1)}),e.repeat))}),this.holdTime))},t.actionHandler.end=t=>{if([\"touchend\",\"touchcancel\"].includes(t.type)&&this.cancelled)return void(this.isRepeating&&this.repeatTimeout&&(clearInterval(this.repeatTimeout),this.isRepeating=!1));const i=t.target;t.cancelable&&t.preventDefault(),e.hasHold&&(clearTimeout(this.timer),this.isRepeating&&this.repeatTimeout&&clearInterval(this.repeatTimeout),this.isRepeating=!1,this.stopAnimation(),this.timer=void 0),e.hasHold&&this.held?e.repeat||wt(i,\"action\",{action:\"hold\"}):e.hasDoubleClick?\"click\"===t.type&&t.detail<2||!this.dblClickTimeout?this.dblClickTimeout=window.setTimeout((()=>{this.dblClickTimeout=void 0,wt(i,\"action\",{action:\"tap\"})}),250):(clearTimeout(this.dblClickTimeout),this.dblClickTimeout=void 0,wt(i,\"action\",{action:\"double_tap\"})):wt(i,\"action\",{action:\"tap\"})},t.actionHandler.handleEnter=t=>{13===t.keyCode&&t.currentTarget.actionHandler.end(t)},t.addEventListener(\"touchstart\",t.actionHandler.start,{passive:!0}),t.addEventListener(\"touchend\",t.actionHandler.end),t.addEventListener(\"touchcancel\",t.actionHandler.end),t.addEventListener(\"mousedown\",t.actionHandler.start,{passive:!0}),t.addEventListener(\"click\",t.actionHandler.end),t.addEventListener(\"keyup\",t.actionHandler.handleEnter)))}startAnimation(t,e){Object.assign(this.style,{left:`${t}px`,top:`${e}px`,display:null}),this.ripple.disabled=!1,this.ripple.startPress(),this.ripple.unbounded=!0}stopAnimation(){this.ripple.endPress(),this.ripple.disabled=!0,this.style.display=\"none\"}}customElements.define(\"cblcars-button-card-action-handler\",xt);const kt=(t,e)=>{const i=(()=>{const t=document.body;if(t.querySelector(\"cblcars-button-card-action-handler\"))return t.querySelector(\"cblcars-button-card-action-handler\");const e=document.createElement(\"cblcars-button-card-action-handler\");return t.appendChild(e),e})();i&&i.bind(t,e)},St=ft(class extends pt{update(t,[e]){return kt(t.element,e),z}render(t){}});function Et(t,e){(function(t){return\"string\"==typeof t&&-1!==t.indexOf(\".\")&&1===parseFloat(t)})(t)&&(t=\"100%\");var i=function(t){return\"string\"==typeof t&&-1!==t.indexOf(\"%\")}(t);return t=360===e?t:Math.min(e,Math.max(0,parseFloat(t))),i&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:t=360===e?(t<0?t%e+e:t%e)/parseFloat(String(e)):t%e/parseFloat(String(e))}function Ot(t){return Math.min(1,Math.max(0,t))}function Tt(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Ct(t){return t<=1?\"\".concat(100*Number(t),\"%\"):t}function Mt(t){return 1===t.length?\"0\"+t:String(t)}function jt(t,e,i){t=Et(t,255),e=Et(e,255),i=Et(i,255);var n=Math.max(t,e,i),r=Math.min(t,e,i),s=0,a=0,o=(n+r)/2;if(n===r)a=0,s=0;else{var l=n-r;switch(a=o>.5?l/(2-n-r):l/(n+r),n){case t:s=(e-i)/l+(e<i?6:0);break;case e:s=(i-t)/l+2;break;case i:s=(t-e)/l+4}s/=6}return{h:s,s:a,l:o}}function Ht(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*i*(e-t):i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function Dt(t,e,i){t=Et(t,255),e=Et(e,255),i=Et(i,255);var n=Math.max(t,e,i),r=Math.min(t,e,i),s=0,a=n,o=n-r,l=0===n?0:o/n;if(n===r)s=0;else{switch(n){case t:s=(e-i)/o+(e<i?6:0);break;case e:s=(i-t)/o+2;break;case i:s=(t-e)/o+4}s/=6}return{h:s,s:l,v:a}}function Rt(t,e,i,n){var r=[Mt(Math.round(t).toString(16)),Mt(Math.round(e).toString(16)),Mt(Math.round(i).toString(16))];return n&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join(\"\")}function Nt(t){return Math.round(255*parseFloat(t)).toString(16)}function Pt(t){return zt(t)/255}function zt(t){return parseInt(t,16)}var Lt={aliceblue:\"#f0f8ff\",antiquewhite:\"#faebd7\",aqua:\"#00ffff\",aquamarine:\"#7fffd4\",azure:\"#f0ffff\",beige:\"#f5f5dc\",bisque:\"#ffe4c4\",black:\"#000000\",blanchedalmond:\"#ffebcd\",blue:\"#0000ff\",blueviolet:\"#8a2be2\",brown:\"#a52a2a\",burlywood:\"#deb887\",cadetblue:\"#5f9ea0\",chartreuse:\"#7fff00\",chocolate:\"#d2691e\",coral:\"#ff7f50\",cornflowerblue:\"#6495ed\",cornsilk:\"#fff8dc\",crimson:\"#dc143c\",cyan:\"#00ffff\",darkblue:\"#00008b\",darkcyan:\"#008b8b\",darkgoldenrod:\"#b8860b\",darkgray:\"#a9a9a9\",darkgreen:\"#006400\",darkgrey:\"#a9a9a9\",darkkhaki:\"#bdb76b\",darkmagenta:\"#8b008b\",darkolivegreen:\"#556b2f\",darkorange:\"#ff8c00\",darkorchid:\"#9932cc\",darkred:\"#8b0000\",darksalmon:\"#e9967a\",darkseagreen:\"#8fbc8f\",darkslateblue:\"#483d8b\",darkslategray:\"#2f4f4f\",darkslategrey:\"#2f4f4f\",darkturquoise:\"#00ced1\",darkviolet:\"#9400d3\",deeppink:\"#ff1493\",deepskyblue:\"#00bfff\",dimgray:\"#696969\",dimgrey:\"#696969\",dodgerblue:\"#1e90ff\",firebrick:\"#b22222\",floralwhite:\"#fffaf0\",forestgreen:\"#228b22\",fuchsia:\"#ff00ff\",gainsboro:\"#dcdcdc\",ghostwhite:\"#f8f8ff\",goldenrod:\"#daa520\",gold:\"#ffd700\",gray:\"#808080\",green:\"#008000\",greenyellow:\"#adff2f\",grey:\"#808080\",honeydew:\"#f0fff0\",hotpink:\"#ff69b4\",indianred:\"#cd5c5c\",indigo:\"#4b0082\",ivory:\"#fffff0\",khaki:\"#f0e68c\",lavenderblush:\"#fff0f5\",lavender:\"#e6e6fa\",lawngreen:\"#7cfc00\",lemonchiffon:\"#fffacd\",lightblue:\"#add8e6\",lightcoral:\"#f08080\",lightcyan:\"#e0ffff\",lightgoldenrodyellow:\"#fafad2\",lightgray:\"#d3d3d3\",lightgreen:\"#90ee90\",lightgrey:\"#d3d3d3\",lightpink:\"#ffb6c1\",lightsalmon:\"#ffa07a\",lightseagreen:\"#20b2aa\",lightskyblue:\"#87cefa\",lightslategray:\"#778899\",lightslategrey:\"#778899\",lightsteelblue:\"#b0c4de\",lightyellow:\"#ffffe0\",lime:\"#00ff00\",limegreen:\"#32cd32\",linen:\"#faf0e6\",magenta:\"#ff00ff\",maroon:\"#800000\",mediumaquamarine:\"#66cdaa\",mediumblue:\"#0000cd\",mediumorchid:\"#ba55d3\",mediumpurple:\"#9370db\",mediumseagreen:\"#3cb371\",mediumslateblue:\"#7b68ee\",mediumspringgreen:\"#00fa9a\",mediumturquoise:\"#48d1cc\",mediumvioletred:\"#c71585\",midnightblue:\"#191970\",mintcream:\"#f5fffa\",mistyrose:\"#ffe4e1\",moccasin:\"#ffe4b5\",navajowhite:\"#ffdead\",navy:\"#000080\",oldlace:\"#fdf5e6\",olive:\"#808000\",olivedrab:\"#6b8e23\",orange:\"#ffa500\",orangered:\"#ff4500\",orchid:\"#da70d6\",palegoldenrod:\"#eee8aa\",palegreen:\"#98fb98\",paleturquoise:\"#afeeee\",palevioletred:\"#db7093\",papayawhip:\"#ffefd5\",peachpuff:\"#ffdab9\",peru:\"#cd853f\",pink:\"#ffc0cb\",plum:\"#dda0dd\",powderblue:\"#b0e0e6\",purple:\"#800080\",rebeccapurple:\"#663399\",red:\"#ff0000\",rosybrown:\"#bc8f8f\",royalblue:\"#4169e1\",saddlebrown:\"#8b4513\",salmon:\"#fa8072\",sandybrown:\"#f4a460\",seagreen:\"#2e8b57\",seashell:\"#fff5ee\",sienna:\"#a0522d\",silver:\"#c0c0c0\",skyblue:\"#87ceeb\",slateblue:\"#6a5acd\",slategray:\"#708090\",slategrey:\"#708090\",snow:\"#fffafa\",springgreen:\"#00ff7f\",steelblue:\"#4682b4\",tan:\"#d2b48c\",teal:\"#008080\",thistle:\"#d8bfd8\",tomato:\"#ff6347\",turquoise:\"#40e0d0\",violet:\"#ee82ee\",wheat:\"#f5deb3\",white:\"#ffffff\",whitesmoke:\"#f5f5f5\",yellow:\"#ffff00\",yellowgreen:\"#9acd32\"};function It(t){var e={r:0,g:0,b:0},i=1,n=null,r=null,s=null,a=!1,o=!1;return\"string\"==typeof t&&(t=function(t){if(t=t.trim().toLowerCase(),0===t.length)return!1;var e=!1;if(Lt[t])t=Lt[t],e=!0;else if(\"transparent\"===t)return{r:0,g:0,b:0,a:0,format:\"name\"};var i=Bt.rgb.exec(t);if(i)return{r:i[1],g:i[2],b:i[3]};if(i=Bt.rgba.exec(t),i)return{r:i[1],g:i[2],b:i[3],a:i[4]};if(i=Bt.hsl.exec(t),i)return{h:i[1],s:i[2],l:i[3]};if(i=Bt.hsla.exec(t),i)return{h:i[1],s:i[2],l:i[3],a:i[4]};if(i=Bt.hsv.exec(t),i)return{h:i[1],s:i[2],v:i[3]};if(i=Bt.hsva.exec(t),i)return{h:i[1],s:i[2],v:i[3],a:i[4]};if(i=Bt.hex8.exec(t),i)return{r:zt(i[1]),g:zt(i[2]),b:zt(i[3]),a:Pt(i[4]),format:e?\"name\":\"hex8\"};if(i=Bt.hex6.exec(t),i)return{r:zt(i[1]),g:zt(i[2]),b:zt(i[3]),format:e?\"name\":\"hex\"};if(i=Bt.hex4.exec(t),i)return{r:zt(i[1]+i[1]),g:zt(i[2]+i[2]),b:zt(i[3]+i[3]),a:Pt(i[4]+i[4]),format:e?\"name\":\"hex8\"};if(i=Bt.hex3.exec(t),i)return{r:zt(i[1]+i[1]),g:zt(i[2]+i[2]),b:zt(i[3]+i[3]),format:e?\"name\":\"hex\"};return!1}(t)),\"object\"==typeof t&&(Wt(t.r)&&Wt(t.g)&&Wt(t.b)?(e=function(t,e,i){return{r:255*Et(t,255),g:255*Et(e,255),b:255*Et(i,255)}}(t.r,t.g,t.b),a=!0,o=\"%\"===String(t.r).substr(-1)?\"prgb\":\"rgb\"):Wt(t.h)&&Wt(t.s)&&Wt(t.v)?(n=Ct(t.s),r=Ct(t.v),e=function(t,e,i){t=6*Et(t,360),e=Et(e,100),i=Et(i,100);var n=Math.floor(t),r=t-n,s=i*(1-e),a=i*(1-r*e),o=i*(1-(1-r)*e),l=n%6;return{r:255*[i,a,s,s,o,i][l],g:255*[o,i,i,a,s,s][l],b:255*[s,s,o,i,i,a][l]}}(t.h,n,r),a=!0,o=\"hsv\"):Wt(t.h)&&Wt(t.s)&&Wt(t.l)&&(n=Ct(t.s),s=Ct(t.l),e=function(t,e,i){var n,r,s;if(t=Et(t,360),e=Et(e,100),i=Et(i,100),0===e)r=i,s=i,n=i;else{var a=i<.5?i*(1+e):i+e-i*e,o=2*i-a;n=Ht(o,a,t+1/3),r=Ht(o,a,t),s=Ht(o,a,t-1/3)}return{r:255*n,g:255*r,b:255*s}}(t.h,n,s),a=!0,o=\"hsl\"),Object.prototype.hasOwnProperty.call(t,\"a\")&&(i=t.a)),i=Tt(i),{ok:a,format:t.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:i}}var Ft=\"(?:\".concat(\"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\",\")|(?:\").concat(\"[-\\\\+]?\\\\d+%?\",\")\"),Vt=\"[\\\\s|\\\\(]+(\".concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")\\\\s*\\\\)?\"),Ut=\"[\\\\s|\\\\(]+(\".concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")\\\\s*\\\\)?\"),Bt={CSS_UNIT:new RegExp(Ft),rgb:new RegExp(\"rgb\"+Vt),rgba:new RegExp(\"rgba\"+Ut),hsl:new RegExp(\"hsl\"+Vt),hsla:new RegExp(\"hsla\"+Ut),hsv:new RegExp(\"hsv\"+Vt),hsva:new RegExp(\"hsva\"+Ut),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Wt(t){return Boolean(Bt.CSS_UNIT.exec(String(t)))}var qt=function(){function t(e,i){var n;if(void 0===e&&(e=\"\"),void 0===i&&(i={}),e instanceof t)return e;\"number\"==typeof e&&(e=function(t){return{r:t>>16,g:(65280&t)>>8,b:255&t}}(e)),this.originalInput=e;var r=It(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(n=i.format)&&void 0!==n?n:r.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},t.prototype.getLuminance=function(){var t=this.toRgb(),e=t.r/255,i=t.g/255,n=t.b/255;return.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(t){return this.a=Tt(t),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){return 0===this.toHsl().s},t.prototype.toHsv=function(){var t=Dt(this.r,this.g,this.b);return{h:360*t.h,s:t.s,v:t.v,a:this.a}},t.prototype.toHsvString=function(){var t=Dt(this.r,this.g,this.b),e=Math.round(360*t.h),i=Math.round(100*t.s),n=Math.round(100*t.v);return 1===this.a?\"hsv(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%)\"):\"hsva(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%, \").concat(this.roundA,\")\")},t.prototype.toHsl=function(){var t=jt(this.r,this.g,this.b);return{h:360*t.h,s:t.s,l:t.l,a:this.a}},t.prototype.toHslString=function(){var t=jt(this.r,this.g,this.b),e=Math.round(360*t.h),i=Math.round(100*t.s),n=Math.round(100*t.l);return 1===this.a?\"hsl(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%)\"):\"hsla(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%, \").concat(this.roundA,\")\")},t.prototype.toHex=function(t){return void 0===t&&(t=!1),Rt(this.r,this.g,this.b,t)},t.prototype.toHexString=function(t){return void 0===t&&(t=!1),\"#\"+this.toHex(t)},t.prototype.toHex8=function(t){return void 0===t&&(t=!1),function(t,e,i,n,r){var s=[Mt(Math.round(t).toString(16)),Mt(Math.round(e).toString(16)),Mt(Math.round(i).toString(16)),Mt(Nt(n))];return r&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join(\"\")}(this.r,this.g,this.b,this.a,t)},t.prototype.toHex8String=function(t){return void 0===t&&(t=!1),\"#\"+this.toHex8(t)},t.prototype.toHexShortString=function(t){return void 0===t&&(t=!1),1===this.a?this.toHexString(t):this.toHex8String(t)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var t=Math.round(this.r),e=Math.round(this.g),i=Math.round(this.b);return 1===this.a?\"rgb(\".concat(t,\", \").concat(e,\", \").concat(i,\")\"):\"rgba(\".concat(t,\", \").concat(e,\", \").concat(i,\", \").concat(this.roundA,\")\")},t.prototype.toPercentageRgb=function(){var t=function(t){return\"\".concat(Math.round(100*Et(t,255)),\"%\")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var t=function(t){return Math.round(100*Et(t,255))};return 1===this.a?\"rgb(\".concat(t(this.r),\"%, \").concat(t(this.g),\"%, \").concat(t(this.b),\"%)\"):\"rgba(\".concat(t(this.r),\"%, \").concat(t(this.g),\"%, \").concat(t(this.b),\"%, \").concat(this.roundA,\")\")},t.prototype.toName=function(){if(0===this.a)return\"transparent\";if(this.a<1)return!1;for(var t=\"#\"+Rt(this.r,this.g,this.b,!1),e=0,i=Object.entries(Lt);e<i.length;e++){var n=i[e],r=n[0];if(t===n[1])return r}return!1},t.prototype.toString=function(t){var e=Boolean(t);t=null!=t?t:this.format;var i=!1,n=this.a<1&&this.a>=0;return e||!n||!t.startsWith(\"hex\")&&\"name\"!==t?(\"rgb\"===t&&(i=this.toRgbString()),\"prgb\"===t&&(i=this.toPercentageRgbString()),\"hex\"!==t&&\"hex6\"!==t||(i=this.toHexString()),\"hex3\"===t&&(i=this.toHexString(!0)),\"hex4\"===t&&(i=this.toHex8String(!0)),\"hex8\"===t&&(i=this.toHex8String()),\"name\"===t&&(i=this.toName()),\"hsl\"===t&&(i=this.toHslString()),\"hsv\"===t&&(i=this.toHsvString()),i||this.toHexString()):\"name\"===t&&0===this.a?this.toName():this.toRgbString()},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.l+=e/100,i.l=Ot(i.l),new t(i)},t.prototype.brighten=function(e){void 0===e&&(e=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(-e/100*255))),i.g=Math.max(0,Math.min(255,i.g-Math.round(-e/100*255))),i.b=Math.max(0,Math.min(255,i.b-Math.round(-e/100*255))),new t(i)},t.prototype.darken=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.l-=e/100,i.l=Ot(i.l),new t(i)},t.prototype.tint=function(t){return void 0===t&&(t=10),this.mix(\"white\",t)},t.prototype.shade=function(t){return void 0===t&&(t=10),this.mix(\"black\",t)},t.prototype.desaturate=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.s-=e/100,i.s=Ot(i.s),new t(i)},t.prototype.saturate=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.s+=e/100,i.s=Ot(i.s),new t(i)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var i=this.toHsl(),n=(i.h+e)%360;return i.h=n<0?360+n:n,new t(i)},t.prototype.mix=function(e,i){void 0===i&&(i=50);var n=this.toRgb(),r=new t(e).toRgb(),s=i/100;return new t({r:(r.r-n.r)*s+n.r,g:(r.g-n.g)*s+n.g,b:(r.b-n.b)*s+n.b,a:(r.a-n.a)*s+n.a})},t.prototype.analogous=function(e,i){void 0===e&&(e=6),void 0===i&&(i=30);var n=this.toHsl(),r=360/i,s=[this];for(n.h=(n.h-(r*e>>1)+720)%360;--e;)n.h=(n.h+r)%360,s.push(new t(n));return s},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){void 0===e&&(e=6);for(var i=this.toHsv(),n=i.h,r=i.s,s=i.v,a=[],o=1/e;e--;)a.push(new t({h:n,s:r,v:s})),s=(s+o)%1;return a},t.prototype.splitcomplement=function(){var e=this.toHsl(),i=e.h;return[this,new t({h:(i+72)%360,s:e.s,l:e.l}),new t({h:(i+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var i=this.toRgb(),n=new t(e).toRgb(),r=i.a+n.a*(1-i.a);return new t({r:(i.r*i.a+n.r*n.a*(1-i.a))/r,g:(i.g*i.a+n.g*n.a*(1-i.a))/r,b:(i.b*i.a+n.b*n.a*(1-i.a))/r,a:r})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var i=this.toHsl(),n=i.h,r=[this],s=360/e,a=1;a<e;a++)r.push(new t({h:(n+a*s)%360,s:i.s,l:i.l}));return r},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}();function Zt(t,e){return void 0===t&&(t=\"\"),void 0===e&&(e={}),new qt(t,e)}const Gt=\"unavailable\",Yt=(Kt=[Gt,\"unknown\"],(t,e)=>Kt.includes(t,e));var Kt;const Jt=new Set([\"fan\",\"input_boolean\",\"light\",\"switch\",\"group\",\"automation\",\"humidifier\"]),Xt=[\"auto\",\"auto-no-temperature\"],Qt=[\"card\",\"label-card\"],te=[\"--ha-card-background\",\"--card-background-color\"],ee=\"var(--primary-text-color)\";function ie(t){return t.substr(0,t.indexOf(\".\"))}function ne(t,e){const i=[];let n=e;return\"var\"===e.trim().substring(0,3)&&(e.split(\",\").forEach((t=>{const e=t.match(/var\\(\\s*([a-zA-Z0-9-]*)/);e&&i.push(e[1])})),i.some((e=>{const i=window.getComputedStyle(t).getPropertyValue(e);return!!i&&(n=i,!0)}))),n}function re(...t){const e=t=>t&&\"object\"==typeof t;return t.reduce(((t,i)=>(Object.keys(i).forEach((n=>{const r=t[n],s=i[n];Array.isArray(r)&&Array.isArray(s)?t[n]=r.concat(...s):e(r)&&e(s)?t[n]=re(r,s):t[n]=s})),t)),{})}function se(t,e){let i=[];return t&&t.forEach((t=>{let n=t;e&&e.forEach((e=>{e.id&&t.id&&e.id==t.id&&(n=re(n,e))})),i.push(n)})),e&&(i=i.concat(e.filter((e=>!t||!t.find((t=>!(!t.id||!e.id)&&t.id==e.id)))))),i}function ae(t,e){if(void 0===t)return!1;const i=ie(t.entity_id),n=void 0!==e?e:null==t?void 0:t.state;if([\"button\",\"event\",\"input_button\",\"scene\"].includes(i))return n!==Gt;if(Yt(n))return!1;if(\"off\"===n&&\"alert\"!==i)return!1;switch(i){case\"alarm_control_panel\":return\"disarmed\"!==n;case\"alert\":return\"idle\"!==n;case\"cover\":return\"closed\"!==n;case\"device_tracker\":case\"person\":return\"not_home\"!==n;case\"lock\":return\"locked\"!==n;case\"media_player\":return\"standby\"!==n;case\"vacuum\":return![\"idle\",\"docked\",\"paused\"].includes(n);case\"plant\":return\"problem\"===n;case\"group\":return[\"on\",\"home\",\"open\",\"locked\",\"problem\"].includes(n);case\"timer\":return\"active\"===n;case\"camera\":return\"streaming\"===n}return!0}function oe(t){return Array.isArray(t)?t.reverse().reduce(((t,e)=>`var(${e}${t?`, ${t}`:\"\"})`),void 0):`var(${t})`}function le(t){const e=t.split(\":\").map(Number);return 3600*e[0]+60*e[1]+e[2]}const ce=t=>t<10?`0${t}`:t;const he=new Set([\"call-service\",\"divider\",\"section\",\"weblink\",\"cast\",\"select\"]),ue={alert:\"toggle\",automation:\"toggle\",climate:\"climate\",cover:\"cover\",fan:\"toggle\",group:\"group\",input_boolean:\"toggle\",input_number:\"input-number\",input_select:\"input-select\",input_text:\"input-text\",light:\"toggle\",lock:\"lock\",media_player:\"media-player\",remote:\"toggle\",scene:\"scene\",script:\"script\",sensor:\"sensor\",timer:\"timer\",switch:\"toggle\",vacuum:\"toggle\",water_heater:\"climate\",input_datetime:\"input-datetime\"},de=((t,...e)=>{const i=1===t.length?t[0]:e.reduce(((e,i,n)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(i)+t[n+1]),t[0]);return new s(i,t,n)})`\n  :host {\n    position: relative;\n    display: block;\n    --state-inactive-color: var(--paper-item-icon-color);\n  }\n  ha-card {\n    cursor: pointer;\n    overflow: hidden;\n    box-sizing: border-box;\n    position: relative;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    line-height: normal;\n\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n    -khtml-user-select: none; /* Konqueror HTML */\n    -moz-user-select: none; /* Old versions of Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none; /* Non-prefixed version, currently\n                          supported by Chrome, Opera and Firefox */\n  }\n  ha-card.disabled {\n    pointer-events: none;\n    cursor: default;\n  }\n  :host(.tooltip) .tooltiptext {\n    pointer-events: none;\n    opacity: 0;\n    text-align: center;\n    padding: 4px;\n    border-radius: var(--ha-card-border-radius, 4px);\n    box-shadow: var(\n      --ha-card-box-shadow,\n      0px 2px 1px -1px rgba(0, 0, 0, 0.2),\n      0px 1px 1px 0px rgba(0, 0, 0, 0.14),\n      0px 1px 3px 0px rgba(0, 0, 0, 0.12)\n    );\n    background: var(--ha-card-background, var(--card-background-color, white));\n    border: 1px solid var(--primary-text-color);\n    color: var(--primary-text-color);\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n  }\n  :host(.tooltip:hover) span.tooltiptext {\n    opacity: 1;\n    transition-delay: 1.5s;\n  }\n  :not(ha-state-icon) ha-icon,\n  ha-state-icon {\n    display: inline-block;\n    margin: auto;\n    --mdc-icon-size: 100%;\n    --iron-icon-width: 100%;\n    --iron-icon-height: 100%;\n  }\n  ha-card.button-card-main {\n    padding: 4% 0px;\n    text-transform: none;\n    font-weight: 400;\n    font-size: 1.2rem;\n    align-items: center;\n    text-align: center;\n    letter-spacing: normal;\n    width: 100%;\n  }\n  .ellipsis {\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n\n  #overlay {\n    align-items: flex-start;\n    justify-content: flex-end;\n    padding: 8px 7px;\n    opacity: 0.5;\n    /* DO NOT override items below */\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    display: flex;\n  }\n  #lock {\n    -webkit-animation-fill-mode: both;\n    animation-fill-mode: both;\n    margin: unset;\n    width: 24px;\n  }\n  .invalid {\n    animation: blink 1s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;\n  }\n  .hidden {\n    visibility: hidden;\n    opacity: 0;\n    transition: visibility 0s 1s, opacity 1s linear;\n  }\n  @keyframes blink {\n    0% {\n      opacity: 0;\n    }\n    50% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0;\n    }\n  }\n  @-webkit-keyframes rotating /* Safari and Chrome */ {\n    from {\n      -webkit-transform: rotate(0deg);\n      -o-transform: rotate(0deg);\n      transform: rotate(0deg);\n    }\n    to {\n      -webkit-transform: rotate(360deg);\n      -o-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n  @keyframes rotating {\n    from {\n      -ms-transform: rotate(0deg);\n      -moz-transform: rotate(0deg);\n      -webkit-transform: rotate(0deg);\n      -o-transform: rotate(0deg);\n      transform: rotate(0deg);\n    }\n    to {\n      -ms-transform: rotate(360deg);\n      -moz-transform: rotate(360deg);\n      -webkit-transform: rotate(360deg);\n      -o-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n  [rotating] {\n    -webkit-animation: rotating 2s linear infinite;\n    -moz-animation: rotating 2s linear infinite;\n    -ms-animation: rotating 2s linear infinite;\n    -o-animation: rotating 2s linear infinite;\n    animation: rotating 2s linear infinite;\n  }\n\n  #container {\n    display: grid;\n    width: 100%;\n    height: 100%;\n    text-align: center;\n    align-items: center;\n  }\n  #img-cell {\n    display: flex;\n    grid-area: i;\n    height: 100%;\n    width: 100%;\n    max-width: 100%;\n    max-height: 100%;\n    align-self: center;\n    justify-self: center;\n    overflow: hidden;\n    justify-content: center;\n    align-items: center;\n    position: relative;\n  }\n\n  ha-state-icon#icon {\n    height: 100%;\n    width: 100%;\n    max-height: 100%;\n    position: absolute;\n  }\n  img#icon {\n    display: block;\n    height: auto;\n    width: 100%;\n    position: absolute;\n  }\n  #name {\n    grid-area: n;\n    max-width: 100%;\n    align-self: center;\n    justify-self: center;\n    /* margin: auto; */\n  }\n  #state {\n    grid-area: s;\n    max-width: 100%;\n    align-self: center;\n    justify-self: center;\n    /* margin: auto; */\n  }\n\n  #label {\n    grid-area: l;\n    max-width: 100%;\n    align-self: center;\n    justify-self: center;\n  }\n\n  #container.vertical {\n    grid-template-areas: 'i' 'n' 's' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr min-content min-content min-content;\n  }\n  /* Vertical No Icon */\n  #container.vertical.no-icon {\n    grid-template-areas: 'n' 's' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr min-content 1fr;\n  }\n  #container.vertical.no-icon #state {\n    align-self: center;\n  }\n  #container.vertical.no-icon #name {\n    align-self: end;\n  }\n  #container.vertical.no-icon #label {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No Name */\n  #container.vertical.no-icon.no-name {\n    grid-template-areas: 's' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.vertical.no-icon.no-name #state {\n    align-self: end;\n  }\n  #container.vertical.no-icon.no-name #label {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No State */\n  #container.vertical.no-icon.no-state {\n    grid-template-areas: 'n' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.vertical.no-icon.no-state #name {\n    align-self: end;\n  }\n  #container.vertical.no-icon.no-state #label {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No Label */\n  #container.vertical.no-icon.no-label {\n    grid-template-areas: 'n' 's';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.vertical.no-icon.no-label #name {\n    align-self: end;\n  }\n  #container.vertical.no-icon.no-label #state {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No Label No Name */\n  #container.vertical.no-icon.no-label.no-name {\n    grid-template-areas: 's';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.vertical.no-icon.no-label.no-name #state {\n    align-self: center;\n  }\n  /* Vertical No Icon No Label No State */\n  #container.vertical.no-icon.no-label.no-state {\n    grid-template-areas: 'n';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.vertical.no-icon.no-label.no-state #name {\n    align-self: center;\n  }\n\n  /* Vertical No Icon No Name No State */\n  #container.vertical.no-icon.no-name.no-state {\n    grid-template-areas: 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.vertical.no-icon.no-name.no-state #label {\n    align-self: center;\n  }\n\n  #container.icon_name_state {\n    grid-template-areas: 'i n' 'l l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content;\n  }\n\n  #container.icon_name {\n    grid-template-areas: 'i n' 's s' 'l l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n\n  #container.icon_state {\n    grid-template-areas: 'i s' 'n n' 'l l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n\n  #container.name_state {\n    grid-template-areas: 'i' 'n' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n  #container.name_state.no-icon {\n    grid-template-areas: 'n' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.name_state.no-icon #name {\n    align-self: end;\n  }\n  #container.name_state.no-icon #label {\n    align-self: start;\n  }\n\n  #container.name_state.no-icon.no-label {\n    grid-template-areas: 'n';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.name_state.no-icon.no-label #name {\n    align-self: center;\n  }\n\n  /* icon_name_state2nd default */\n  #container.icon_name_state2nd {\n    grid-template-areas: 'i n' 'i s' 'i l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content 1fr;\n  }\n  #container.icon_name_state2nd #name {\n    align-self: end;\n  }\n  #container.icon_name_state2nd #state {\n    align-self: center;\n  }\n  #container.icon_name_state2nd #label {\n    align-self: start;\n  }\n\n  /* icon_name_state2nd No Label */\n  #container.icon_name_state2nd.no-label {\n    grid-template-areas: 'i n' 'i s';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.icon_name_state2nd #name {\n    align-self: end;\n  }\n  #container.icon_name_state2nd #state {\n    align-self: start;\n  }\n\n  /* icon_state_name2nd Default */\n  #container.icon_state_name2nd {\n    grid-template-areas: 'i s' 'i n' 'i l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content 1fr;\n  }\n  #container.icon_state_name2nd #state {\n    align-self: end;\n  }\n  #container.icon_state_name2nd #name {\n    align-self: center;\n  }\n  #container.icon_state_name2nd #label {\n    align-self: start;\n  }\n\n  /* icon_state_name2nd No Label */\n  #container.icon_state_name2nd.no-label {\n    grid-template-areas: 'i s' 'i n';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.icon_state_name2nd #state {\n    align-self: end;\n  }\n  #container.icon_state_name2nd #name {\n    align-self: start;\n  }\n\n  #container.icon_label {\n    grid-template-areas: 'i l' 'n n' 's s';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n\n  [style*='--aspect-ratio'] > :first-child {\n    width: 100%;\n  }\n  [style*='--aspect-ratio'] > img {\n    height: auto;\n  }\n  @supports (--custom: property) {\n    [style*='--aspect-ratio'] {\n      position: relative;\n    }\n    [style*='--aspect-ratio']::before {\n      content: '';\n      display: block;\n      padding-bottom: calc(100% / (var(--aspect-ratio)));\n    }\n    [style*='--aspect-ratio'] > :first-child {\n      position: absolute;\n      top: 0;\n      left: 0;\n      height: 100%;\n    }\n  }\n`;var fe,pe,me,ge,_e;!function(t){t.language=\"language\",t.system=\"system\",t.comma_decimal=\"comma_decimal\",t.decimal_comma=\"decimal_comma\",t.space_comma=\"space_comma\",t.none=\"none\"}(fe||(fe={})),function(t){t.language=\"language\",t.system=\"system\",t.am_pm=\"12\",t.twenty_four=\"24\"}(pe||(pe={})),function(t){t.local=\"local\",t.server=\"server\"}(me||(me={})),function(t){t.language=\"language\",t.system=\"system\",t.DMY=\"DMY\",t.MDY=\"MDY\",t.YMD=\"YMD\"}(ge||(ge={})),function(t){t.language=\"language\",t.monday=\"monday\",t.tuesday=\"tuesday\",t.wednesday=\"wednesday\",t.thursday=\"thursday\",t.friday=\"friday\",t.saturday=\"saturday\",t.sunday=\"sunday\"}(_e||(_e={}));const ve=(t,e,i)=>{const n=e?(t=>{switch(t.number_format){case fe.comma_decimal:return[\"en-US\",\"en\"];case fe.decimal_comma:return[\"de\",\"es\",\"it\"];case fe.space_comma:return[\"fr\",\"sv\",\"cs\"];case fe.system:return;default:return t.language}})(e):void 0;if(Number.isNaN=Number.isNaN||function t(e){return\"number\"==typeof e&&t(e)},(null==e?void 0:e.number_format)!==fe.none&&!Number.isNaN(Number(t))&&Intl)try{return new Intl.NumberFormat(n,ye(t,i)).format(Number(t))}catch(r){return console.error(r),new Intl.NumberFormat(void 0,ye(t,i)).format(Number(t))}return\"string\"==typeof t?t:`${((t,e=2)=>Math.round(t*10**e)/10**e)(t,null==i?void 0:i.maximumFractionDigits).toString()}${\"currency\"===(null==i?void 0:i.style)?` ${i.currency}`:\"\"}`},be=(t,e,i)=>{var n;let r=null==i?void 0:i.display_precision;return void 0!==e&&(r=e),null!=r?{maximumFractionDigits:r,minimumFractionDigits:r}:Number.isInteger(Number(null===(n=t.attributes)||void 0===n?void 0:n.step))&&Number.isInteger(Number(t.state))?{maximumFractionDigits:0}:null!=t.attributes.step?{maximumFractionDigits:Math.ceil(Math.log10(1/t.attributes.step))}:void 0},ye=(t,e)=>{const i=Object.assign({maximumFractionDigits:2},e);if(\"string\"!=typeof t)return i;if(!e||void 0===e.minimumFractionDigits&&void 0===e.maximumFractionDigits){const e=t.indexOf(\".\")>-1?t.split(\".\")[1].length:0;i.minimumFractionDigits=e,i.maximumFractionDigits=e}return i};var we,$e,Ae,xe,ke;!function(t){t.language=\"language\",t.system=\"system\",t.comma_decimal=\"comma_decimal\",t.decimal_comma=\"decimal_comma\",t.space_comma=\"space_comma\",t.none=\"none\"}(we||(we={})),function(t){t.language=\"language\",t.system=\"system\",t.am_pm=\"12\",t.twenty_four=\"24\"}($e||($e={})),function(t){t.local=\"local\",t.server=\"server\"}(Ae||(Ae={})),function(t){t.language=\"language\",t.system=\"system\",t.DMY=\"DMY\",t.MDY=\"MDY\",t.YMD=\"YMD\"}(xe||(xe={})),function(t){t.language=\"language\",t.monday=\"monday\",t.tuesday=\"tuesday\",t.wednesday=\"wednesday\",t.thursday=\"thursday\",t.friday=\"friday\",t.saturday=\"saturday\",t.sunday=\"sunday\"}(ke||(ke={}));const Se=(t,e=2)=>{let i=\"\"+t;for(let n=1;n<e;n++)i=parseInt(i)<10**n?`0${i}`:i;return i};const Ee={ms:1,s:1e3,min:6e4,h:36e5,d:864e5},Oe=(t,e)=>function(t){const e=Math.floor(t/1e3/3600),i=Math.floor(t/1e3%3600/60),n=Math.floor(t/1e3%3600%60),r=Math.floor(t%1e3);return e>0?`${e}:${Se(i)}:${Se(n)}`:i>0?`${i}:${Se(n)}`:n>0||r>0?`${n}${r>0?`.${Se(r,3)}`:\"\"}`:null}(parseFloat(t)*Ee[e])||\"0\";var Te=Number.isNaN||function(t){return\"number\"==typeof t&&t!=t};function Ce(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(n=t[i],r=e[i],!(n===r||Te(n)&&Te(r)))return!1;var n,r;return!0}function Me(t,e){void 0===e&&(e=Ce);var i=null;function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(i&&i.lastThis===this&&e(n,i.lastArgs))return i.lastResult;var s=t.apply(this,n);return i={lastResult:s,lastArgs:n,lastThis:this},s}return n.clear=function(){i=null},n}const je=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:\"long\",month:\"long\",day:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),He=(t,e,i)=>De(e,i.time_zone).format(t),De=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{year:\"numeric\",month:\"long\",day:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),Re=(t,e,i)=>{var n,r,s,a;const o=Ne(e,i.time_zone);if(e.date_format===ge.language||e.date_format===ge.system)return o.format(t);const l=o.formatToParts(t),c=null===(n=l.find((t=>\"literal\"===t.type)))||void 0===n?void 0:n.value,h=null===(r=l.find((t=>\"day\"===t.type)))||void 0===r?void 0:r.value,u=null===(s=l.find((t=>\"month\"===t.type)))||void 0===s?void 0:s.value,d=null===(a=l.find((t=>\"year\"===t.type)))||void 0===a?void 0:a.value,f=l[l.length-1];let p=\"literal\"===(null==f?void 0:f.type)?null==f?void 0:f.value:\"\";\"bg\"===e.language&&e.date_format===ge.YMD&&(p=\"\");return{[ge.DMY]:`${h}${c}${u}${c}${d}${p}`,[ge.MDY]:`${u}${c}${h}${c}${d}${p}`,[ge.YMD]:`${d}${c}${u}${c}${h}${p}`}[e.date_format]},Ne=Me(((t,e)=>{const i=t.date_format===ge.system?void 0:t.language;return t.date_format===ge.language||(t.date_format,ge.system),new Intl.DateTimeFormat(i,{year:\"numeric\",month:\"numeric\",day:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0})})),Pe=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{day:\"numeric\",month:\"short\",timeZone:\"server\"===t.time_zone?e:void 0}))),ze=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{month:\"long\",year:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),Le=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{month:\"long\",timeZone:\"server\"===t.time_zone?e:void 0}))),Ie=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{year:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),Fe=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:\"long\",timeZone:\"server\"===t.time_zone?e:void 0}))),Ve=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:\"short\",timeZone:\"server\"===t.time_zone?e:void 0}))),Ue=Me((t=>{if(t.time_format===pe.language||t.time_format===pe.system){const e=t.time_format===pe.language?t.language:void 0,i=(new Date).toLocaleString(e);return i.includes(\"AM\")||i.includes(\"PM\")}return t.time_format===pe.am_pm})),Be=(t,e,i)=>We(e,i.time_zone).format(t),We=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{hour:\"numeric\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),qe=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Ze=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{weekday:\"long\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Ge=Me(((t,e)=>new Intl.DateTimeFormat(\"en-GB\",{hour:\"numeric\",minute:\"2-digit\",hour12:!1,timeZone:\"server\"===t.time_zone?e:void 0}))),Ye=(t,e,i)=>Ke(e,i.time_zone).format(t),Ke=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{year:\"numeric\",month:\"long\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Je=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{year:\"numeric\",month:\"short\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Xe=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{month:\"short\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Qe=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{year:\"numeric\",month:\"long\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),ti=(t,e)=>0!=(t.supported_features&e),ei=t=>(t=>ti(t,4)&&\"number\"==typeof t.in_progress)(t)||!!t.in_progress,ii=(t,e,i,n,r,s,a)=>{const o=r[e.entity_id];return ni(t,i,n,o,e.entity_id,e.attributes,s,void 0!==a?a:e.state)},ni=(t,e,i,n,r,s,a,o)=>{var l;if(\"unknown\"===o||\"unavailable\"===o)return t(`state.default.${o}`);if(function(t){return!!t.unit_of_measurement||!!t.state_class}(s)){if(\"duration\"===s.device_class&&s.unit_of_measurement&&Ee[s.unit_of_measurement])try{return Oe(o,s.unit_of_measurement)}catch(h){}if(\"monetary\"===s.device_class)try{return ve(o,e,Object.assign({style:\"currency\",currency:(null==a?void 0:a.units)||s.unit_of_measurement,minimumFractionDigits:2},be({state:o,attributes:s},null==a?void 0:a.numeric_precision,n)))}catch(h){}const t=(null==a?void 0:a.show_units)?(null==a?void 0:a.units)?null==a?void 0:a.units:s.unit_of_measurement:void 0,i=t?\"%\"===t?(t=>{switch(t.language){case\"cz\":case\"de\":case\"fi\":case\"fr\":case\"sk\":case\"sv\":return\" \";default:return\"\"}})(e)+\"%\":` ${t}`:\"\";return`${ve(o,e,be({state:o,attributes:s},null==a?void 0:a.numeric_precision,n))}${i}`}const c=ie(r);if(\"datetime\"===c){const t=new Date(o);return Ye(t,e,i)}if([\"date\",\"input_datetime\",\"time\"].includes(c))try{const t=o.split(\" \");if(2===t.length)return Ye(new Date(t.join(\"T\")),Object.assign(Object.assign({},e),{time_zone:Ae.local}),i);if(1===t.length){if(o.includes(\"-\"))return He(new Date(`${o}T00:00`),Object.assign(Object.assign({},e),{time_zone:Ae.local}),i);if(o.includes(\":\")){const t=new Date;return Be(new Date(`${t.toISOString().split(\"T\")[0]}T${o}`),Object.assign(Object.assign({},e),{time_zone:Ae.local}),i)}}return o}catch(u){return o}if(\"counter\"===c||\"number\"===c||\"input_number\"===c)return ve(o,e,be({state:o,attributes:s},null==a?void 0:a.numeric_precision,n));if([\"button\",\"event\",\"input_button\",\"scene\",\"stt\",\"tts\"].includes(c)||\"sensor\"===c&&\"timestamp\"===s.device_class)try{return Ye(new Date(o),e,i)}catch(h){return o}return\"update\"===c?\"on\"===o?ei(s)?ti(s,4)&&\"number\"==typeof s.in_progress?t(\"ui.card.update.installing_with_progress\",{progress:s.in_progress}):t(\"ui.card.update.installing\"):s.latest_version:s.skipped_version===s.latest_version?null!==(l=s.latest_version)&&void 0!==l?l:t(\"state.default.unavailable\"):t(\"ui.card.update.up_to_date\"):(null==n?void 0:n.translation_key)&&t(`component.${n.platform}.entity.${c}.${n.translation_key}.state.${o}`)||s.device_class&&t(`component.${c}.entity_component.${s.device_class}.state.${o}`)||t(`component.${c}.entity_component._.state.${o}`)||o};var ri=Function.prototype.toString,si=Object.create,ai=Object.defineProperty,oi=Object.getOwnPropertyDescriptor,li=Object.getOwnPropertyNames,ci=Object.getOwnPropertySymbols,hi=Object.getPrototypeOf,ui=Object.prototype,di=ui.hasOwnProperty,fi=ui.propertyIsEnumerable,pi=\"function\"==typeof ci,mi=\"function\"==typeof WeakMap,gi=function(){if(mi)return function(){return new WeakMap};var t=function(){function t(){this._keys=[],this._values=[]}return t.prototype.has=function(t){return!!~this._keys.indexOf(t)},t.prototype.get=function(t){return this._values[this._keys.indexOf(t)]},t.prototype.set=function(t,e){this._keys.push(t),this._values.push(e)},t}();return function(){return new t}}(),_i=function(t,e){var i=t.__proto__||hi(t);if(!i)return si(null);var n=i.constructor;if(n===e.Object)return i===e.Object.prototype?{}:si(i);if(~ri.call(n).indexOf(\"[native code]\"))try{return new n}catch(ui){}return si(i)},vi=function(t,e,i,n){var r=_i(t,e);for(var s in n.set(t,r),t)di.call(t,s)&&(r[s]=i(t[s],n));if(pi)for(var a=ci(t),o=0,l=a.length,c=void 0;o<l;++o)c=a[o],fi.call(t,c)&&(r[c]=i(t[c],n));return r},bi=function(t,e,i,n){var r=_i(t,e);n.set(t,r);for(var s=pi?li(t).concat(ci(t)):li(t),a=0,o=s.length,l=void 0,c=void 0;a<o;++a)if(\"callee\"!==(l=s[a])&&\"caller\"!==l)if(c=oi(t,l)){c.get||c.set||(c.value=i(t[l],n));try{ai(r,l,c)}catch(h){r[l]=c.value}}else r[l]=i(t[l],n);return r},yi=Array.isArray,wi=Object.getPrototypeOf,$i=function(){return\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:(console&&console.error&&console.error('Unable to locate global object, returning \"this\".'),this)}();function Ai(t,e){var i=!(!e||!e.isStrict),n=e&&e.realm||$i,r=i?bi:vi,s=function(t,e){if(!t||\"object\"!=typeof t)return t;if(e.has(t))return e.get(t);var a,o,l,c=t.__proto__||wi(t),h=c&&c.constructor;if(!h||h===n.Object)return r(t,n,s,e);if(yi(t)){if(i)return bi(t,n,s,e);a=new h,e.set(t,a);for(var u=0,d=t.length;u<d;++u)a[u]=s(t[u],e);return a}if(t instanceof n.Date)return new h(t.getTime());if(t instanceof n.RegExp)return(a=new h(t.source,t.flags||(l=\"\",(o=t).global&&(l+=\"g\"),o.ignoreCase&&(l+=\"i\"),o.multiline&&(l+=\"m\"),o.unicode&&(l+=\"u\"),o.sticky&&(l+=\"y\"),l))).lastIndex=t.lastIndex,a;if(n.Map&&t instanceof n.Map)return a=new h,e.set(t,a),t.forEach((function(t,i){a.set(i,s(t,e))})),a;if(n.Set&&t instanceof n.Set)return a=new h,e.set(t,a),t.forEach((function(t){a.add(s(t,e))})),a;if(n.Blob&&t instanceof n.Blob)return t.slice(0,t.size,t.type);if(n.Buffer&&n.Buffer.isBuffer(t))return a=n.Buffer.allocUnsafe?n.Buffer.allocUnsafe(t.length):new h(t.length),e.set(t,a),t.copy(a),a;if(n.ArrayBuffer){if(n.ArrayBuffer.isView(t))return a=new h(t.buffer.slice(0)),e.set(t,a),a;if(t instanceof n.ArrayBuffer)return a=t.slice(0),e.set(t,a),a}return\"function\"==typeof t.then||t instanceof Error||n.WeakMap&&t instanceof n.WeakMap||n.WeakSet&&t instanceof n.WeakSet?t:r(t,n,s,e)};return s(t,gi())}Ai.default=Ai,Ai.strict=function(t,e){return Ai(t,{isStrict:!0,realm:e?e.realm:void 0})};const xi=new Set([\"alarm_control_panel\",\"alert\",\"automation\",\"binary_sensor\",\"calendar\",\"camera\",\"climate\",\"cover\",\"device_tracker\",\"fan\",\"group\",\"humidifier\",\"input_boolean\",\"light\",\"lock\",\"media_player\",\"person\",\"plant\",\"remote\",\"schedule\",\"script\",\"siren\",\"sun\",\"switch\",\"timer\",\"update\",\"vacuum\"]),ki=(t,e,i)=>{if((void 0!==e?e:null==t?void 0:t.state)===Gt)return\"var(--state-unavailable-color)\";const n=Ei(t,e,i);return n?oe(n):void 0},Si=(t,e,i,n)=>{const r=void 0!==i?i:e.state,s=ae(e,i),a=[],o=function(t,e=\"_\"){const i=\"/_,:;\",n=`aaaaaaaaacccddeeeeeeegghiiiiilmnnnnooooooprrsssssttuuuuuuuuuwxyyzzz${e}${e}${e}${e}${e}${e}`,r=new RegExp(i.split(\"\").join(\"|\"),\"g\");return t.toString().toLowerCase().replace(/\\s+/g,e).replace(r,(t=>n.charAt(i.indexOf(t)))).replace(/&/g,`${e}and${e}`).replace(/[^\\w-]+/g,\"\").replace(/-/g,e).replace(new RegExp(`(${e})\\\\1+`,\"g\"),\"$1\").replace(new RegExp(`^${e}+`),\"\").replace(new RegExp(`${e}+$`),\"\")}(r,\"_\"),l=s?\"active\":\"inactive\";if(n&&Qt.includes(n)&&\"inactive\"==l)return te;const c=e.attributes.device_class;return c&&a.push(`--state-${t}-${c}-${o}-color`),a.push(`--state-${t}-${o}-color`,`--state-${t}-${l}-color`,`--state-${l}-color`),a},Ei=(t,e,i)=>{const n=void 0!==e?e:null==t?void 0:t.state,r=ie(t.entity_id),s=t.attributes.device_class;if(\"sensor\"===r&&\"battery\"===s){const t=(t=>{const e=Number(t);if(!isNaN(e))return e>=70?\"--state-sensor-battery-high-color\":e>=30?\"--state-sensor-battery-medium-color\":\"--state-sensor-battery-low-color\"})(n);if(t)return[t]}if(\"group\"===r){const n=(t=>{const e=t.attributes.entity_id||[],i=[...new Set(e.map((t=>ie(t))))];return 1===i.length?i[0]:void 0})(t);if(n&&xi.has(n))return Si(n,t,e,i)}return xi.has(r)?Si(r,t,e,i):i&&Qt.includes(i)?te:void 0};let Oi=window.cardHelpers;const Ti=new Promise((async t=>{Oi&&t(),window.loadCardHelpers&&(Oi=await window.loadCardHelpers(),window.cardHelpers=Oi,t())}));console.info(\"%c  BUTTON-CARD (mod for CB-LCARS)  \\n%c Version 4.1.2-cblcars.3 \",\"color: white; font-weight: bold; background: #37a6d1\",\"color: white; font-weight: bold; background: #37a6d1\");let Ci=class extends nt{constructor(){super(...arguments),this._cards={},this._cardsConfig={},this._entities=[],this._initialSetupComplete=!1,this._rippleHandlers=new ht((()=>this._ripple))}get _doIHaveEverything(){return!!this._hass&&!!this._config&&this.isConnected}set hass(t){this._hass=t,Object.keys(this._cards).forEach((t=>{this._cards[t].hass=this._hass})),this._initialSetupComplete||this._finishSetup()}disconnectedCallback(){super.disconnectedCallback(),this._clearInterval()}connectedCallback(){super.connectedCallback(),this._initialSetupComplete?this._startTimerCountdown():this._finishSetup()}_evaluateVariablesSkipError(t){var e;if(this._evaledVariables={},null===(e=this._config)||void 0===e?void 0:e.variables){Object.keys(this._config.variables).sort().forEach((e=>{try{this._evaledVariables[e]=this._objectEvalTemplate(t,this._config.variables[e])}catch(vt){}}))}}_finishSetup(){if(!this._initialSetupComplete&&this._doIHaveEverything){if(this._evaluateVariablesSkipError(),this._config.entity){const t=this._getTemplateOrValue(void 0,this._config.entity);this._config.entity=t,this._stateObj=this._hass.states[t]}this._evaluateVariablesSkipError(this._stateObj),this._config.entity&&Jt.has(ie(this._config.entity))?this._config=Object.assign({tap_action:{action:\"toggle\"}},this._config):this._config.entity?this._config=Object.assign({tap_action:{action:\"more-info\"}},this._config):this._config=Object.assign({tap_action:{action:\"none\"}},this._config);const t=JSON.stringify(this._config);if(this._entities=[],Array.isArray(this._config.triggers_update))this._config.triggers_update.forEach((t=>{try{const e=this._getTemplateOrValue(this._stateObj,t);null==e||this._entities.includes(e)||this._entities.push(e)}catch(vt){}}));else if(\"string\"==typeof this._config.triggers_update){const t=this._getTemplateOrValue(this._stateObj,this._config.triggers_update);t&&\"all\"!==t?this._entities.push(t):this._config.triggers_update=t}if(\"all\"!==this._config.triggers_update){const e=new RegExp(/states\\[\\s*('|\\\\\")([a-zA-Z0-9_]+\\.[a-zA-Z0-9_]+)\\1\\s*\\]/,\"gm\"),i=new RegExp(/states\\[\\s*('|\\\\\")([a-zA-Z0-9_]+\\.[a-zA-Z0-9_]+)\\1\\s*\\]/,\"m\"),n=t.match(e);null==n||n.forEach((t=>{const e=t.match(i);e&&!this._entities.includes(e[2])&&this._entities.push(e[2])}))}this._config.entity&&!this._entities.includes(this._config.entity)&&this._entities.push(this._config.entity),this._expandTriggerGroups();const e=new RegExp(\"\\\\[\\\\[\\\\[.*\\\\]\\\\]\\\\]\",\"m\");this._hasTemplate=!(\"all\"!==this._config.triggers_update||!t.match(e)),this._startTimerCountdown(),this._initialSetupComplete=!0}}_startTimerCountdown(){if(this._config&&this._config.entity&&\"timer\"===ie(this._config.entity)){const t=this._hass.states[this._config.entity];this._startInterval(t)}}_createCard(t){if(Oi)return Oi.createCardElement(t);{const e=((t,e=!1)=>{const i=(t,e)=>n(\"hui-error-card\",{type:\"error\",error:t,config:e}),n=(t,e)=>{const n=window.document.createElement(t);try{if(!n.setConfig)return;n.setConfig(e)}catch(r){return console.error(t,r),i(r.message,e)}return n};if(!t||\"object\"!=typeof t||!e&&!t.type)return i(\"No type defined\",t);let r=t.type;if(r&&r.startsWith(\"custom:\"))r=r.substr(7);else if(e)if(he.has(r))r=`hui-${r}-row`;else{if(!t.entity)return i(\"Invalid config given.\",t);const e=t.entity.split(\".\",1)[0];r=`hui-${ue[e]||\"text\"}-entity-row`}else r=`hui-${r}-card`;if(customElements.get(r))return n(r,t);const s=i(`Custom element doesn't exist: ${t.type}.`,t);s.style.display=\"None\";const a=setTimeout((()=>{s.style.display=\"\"}),2e3);return customElements.whenDefined(t.type).then((()=>{clearTimeout(a),wt(s,\"ll-rebuild\",{},s)})),s})(t);return Ti.then((()=>{wt(e,\"ll-rebuild\",{})})),e}}static get styles(){return de}render(){var t;if(!this._config||!this._hass)return P``;this._stateObj=this._config.entity?this._hass.states[this._config.entity]:void 0;try{if(this._evaledVariables={},null===(t=this._config)||void 0===t?void 0:t.variables){Object.keys(this._config.variables).sort().forEach((t=>{this._evaledVariables[t]=this._objectEvalTemplate(this._stateObj,this._config.variables[t])}))}return this._cardHtml()}catch(vt){vt.stack?console.error(vt.stack):console.error(vt);const e=document.createElement(\"hui-error-card\");return e.setConfig({type:\"error\",error:vt.toString(),origConfig:this._config}),P` ${e} `}}shouldUpdate(t){return!(!this._hasTemplate&&!t.has(\"_timeRemaining\")&&!function(t,e){if(e.has(\"_config\"))return!0;const i=e.get(\"_hass\");if(i)return t._entities.some((function(e){return(null==i?void 0:i.states[e])!==t._hass.states[e]}));return!1}(this,t))&&(this._expandTriggerGroups(),!0)}updated(t){if(super.updated(t),this._config&&this._config.entity&&\"timer\"===ie(this._config.entity)&&t.has(\"_hass\")){const e=this._hass.states[this._config.entity],i=t.get(\"_hass\");(i?i.states[this._config.entity]:void 0)!==e?this._startInterval(e):e||this._clearInterval()}}_clearInterval(){this._interval&&(window.clearInterval(this._interval),this._interval=void 0)}_startInterval(t){this._clearInterval(),this._calculateRemaining(t),\"active\"===t.state&&(this._interval=window.setInterval((()=>this._calculateRemaining(t)),1e3))}_calculateRemaining(t){t.attributes.remaining&&(this._timeRemaining=(t=>{if(!t.attributes.remaining)return;let e=le(t.attributes.remaining);if(\"active\"===t.state){const i=(new Date).getTime(),n=new Date(t.last_changed).getTime();e=Math.max(e-(i-n)/1e3,0)}return e})(t))}_computeTimeDisplay(t){if(t)return function(t){const e=Math.floor(t/3600),i=Math.floor(t%3600/60),n=Math.floor(t%3600%60);return e>0?`${e}:${ce(i)}:${ce(n)}`:i>0?`${i}:${ce(n)}`:n>0?\"\"+n:null}(this._timeRemaining||le(t.attributes.duration))}_getMatchingConfigState(t){if(!this._config.state)return;const e=this._config.state.find((t=>\"template\"===t.operator));if(!t&&!e)return;let i;const n=this._config.state.find((e=>{if(!e.operator)return t&&this._getTemplateOrValue(t,e.value)==t.state;switch(e.operator){case\"==\":return t&&t.state==this._getTemplateOrValue(t,e.value);case\"<=\":return t&&t.state<=this._getTemplateOrValue(t,e.value);case\"<\":return t&&t.state<this._getTemplateOrValue(t,e.value);case\">=\":return t&&t.state>=this._getTemplateOrValue(t,e.value);case\">\":return t&&t.state>this._getTemplateOrValue(t,e.value);case\"!=\":return t&&t.state!=this._getTemplateOrValue(t,e.value);case\"regex\":return!(!t||!t.state.match(this._getTemplateOrValue(t,e.value)));case\"template\":return this._getTemplateOrValue(t,e.value);case\"default\":return i=e,!1;default:return!1}}));return!n&&i?i:n}_localize(t,e,i,n=!0,r){var s;return ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,{numeric_precision:\"card\"===i?null===(s=this._config)||void 0===s?void 0:s.numeric_precision:i,show_units:n,units:r},e)}_relativeTime(t,e=!1){return t?P`\n        <ha-relative-time\n          id=\"relative-time\"\n          class=\"ellipsis\"\n          .hass=\"${this._hass}\"\n          .datetime=\"${t}\"\n          .capitalize=\"${e}\"\n        ></ha-relative-time>\n      `:\"\"}_getTemplateHelpers(){return{localize:this._localize.bind(this),formatDateTime:t=>Ye(new Date(t),this._hass.locale,this._hass.config),formatShortDateTimeWithYear:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Je(i,n.time_zone).format(e);var e,i,n},formatShortDateTime:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Xe(i,n.time_zone).format(e);var e,i,n},formatDateTimeWithSeconds:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Qe(i,n.time_zone).format(e);var e,i,n},formatDateTimeNumeric:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,`${Re(e,i,n)}, ${Be(e,i,n)}`;var e,i,n},relativeTime:this._relativeTime.bind(this),formatTime:t=>Be(new Date(t),this._hass.locale,this._hass.config),formatTimeWithSeconds:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,qe(i,n.time_zone).format(e);var e,i,n},formatTimeWeekday:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ze(i,n.time_zone).format(e);var e,i,n},formatTime24h:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ge(i,n.time_zone).format(e);var e,i,n},formatDateWeekdayDay:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,je(i,n.time_zone).format(e);var e,i,n},formatDate:t=>He(new Date(t),this._hass.locale,this._hass.config),formatDateNumeric:t=>Re(new Date(t),this._hass.locale,this._hass.config),formatDateShort:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Pe(i,n.time_zone).format(e);var e,i,n},formatDateMonthYear:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,ze(i,n.time_zone).format(e);var e,i,n},formatDateMonth:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Le(i,n.time_zone).format(e);var e,i,n},formatDateYear:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ie(i,n.time_zone).format(e);var e,i,n},formatDateWeekday:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Fe(i,n.time_zone).format(e);var e,i,n},formatDateWeekdayShort:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ve(i,n.time_zone).format(e);var e,i,n}}}_evalTemplate(t,e){try{return new Function(\"states\",\"entity\",\"user\",\"hass\",\"variables\",\"html\",\"helpers\",`'use strict'; ${e}`).call(this,this._hass.states,t,this._hass.user,this._hass,this._evaledVariables,P,this._getTemplateHelpers())}catch(vt){const i=e.length<=100?e.trim():`${e.trim().substring(0,98)}...`;throw vt.message=`${vt.name}: ${vt.message} in '${i}'`,vt.name=\"ButtonCardJSTemplateError\",vt}}_objectEvalTemplate(t,e){const i=Ai(e);return this._getTemplateOrValue(t,i)}_getTemplateOrValue(t,e){if([\"number\",\"boolean\"].includes(typeof e))return e;if(!e)return e;if(\"object\"==typeof e)return Object.keys(e).forEach((i=>{e[i]=this._getTemplateOrValue(t,e[i])})),e;const i=e.trim();return\"[[[\"===i.substring(0,3)&&\"]]]\"===i.slice(-3)?this._evalTemplate(t,i.slice(3,-3)):e}_getColorForLightEntity(t,e,i){let n=ee;return Qt.includes(n)&&(n=oe(te)),t&&(ae(t)?(n=t.attributes.rgb_color?`rgb(${t.attributes.rgb_color.join(\",\")})`:e&&t.attributes.color_temp&&t.attributes.min_mireds&&t.attributes.max_mireds?function(t,e,i){const n=new qt(\"rgb(255, 160, 0)\"),r=new qt(\"rgb(166, 209, 255)\"),s=new qt(\"white\"),a=(t-e)/(i-e)*100;return a<50?Zt(r).mix(s,2*a).toRgbString():Zt(s).mix(n,2*(a-50)).toRgbString()}(t.attributes.color_temp,t.attributes.min_mireds,t.attributes.max_mireds):ki(t,t.state,i)||ee,t.attributes.brightness&&(n=function(t,e,i){const n=new qt(ne(t,e));if(n.isValid){const t=n.mix(\"black\",100-i).toString();if(t)return t}return e}(this,n,(t.attributes.brightness+245)/5))):n=ki(t,t.state,i)||ee),n}_buildCssColorAttribute(t,e){var i,n;let r,s=\"\";return(null==e?void 0:e.color)?s=e.color:this._config.color&&(s=this._config.color),Xt.includes(s)&&(!t||t&&\"light\"!==ie(t.entity_id))&&(s=\"\"),r=Xt.includes(s)?this._getColorForLightEntity(t,\"auto-no-temperature\"!==s,null===(i=this._config)||void 0===i?void 0:i.color_type):s||(t&&ki(t,t.state,null===(n=this._config)||void 0===n?void 0:n.color_type)||ee),r}_buildIcon(t,e){if(!this._config.show_icon)return;let i;if(null==e?void 0:e.icon)i=e.icon;else{if(!this._config.icon)return;i=this._config.icon}return this._getTemplateOrValue(t,i)}_buildEntityPicture(t,e){if(!this._config.show_entity_picture||!t&&!e&&!this._config.entity_picture)return;let i;return(null==e?void 0:e.entity_picture)?i=e.entity_picture:this._config.entity_picture?i=this._config.entity_picture:t&&(i=t.attributes&&t.attributes.entity_picture?t.attributes.entity_picture:void 0),this._getTemplateOrValue(t,i)}_buildStyleGeneric(t,e,i){var n,r;let s={};if((null===(n=this._config.styles)||void 0===n?void 0:n[i])&&(s=Object.assign(s,...this._config.styles[i])),null===(r=null==e?void 0:e.styles)||void 0===r?void 0:r[i]){let t={};t=Object.assign(t,...e.styles[i]),s=Object.assign(Object.assign({},s),t)}return Object.keys(s).forEach((e=>{s[e]=this._getTemplateOrValue(t,s[e])})),s}_buildCustomStyleGeneric(t,e,i){var n,r,s,a;let o={};if((null===(r=null===(n=this._config.styles)||void 0===n?void 0:n.custom_fields)||void 0===r?void 0:r[i])&&(o=Object.assign(o,...this._config.styles.custom_fields[i])),null===(a=null===(s=null==e?void 0:e.styles)||void 0===s?void 0:s.custom_fields)||void 0===a?void 0:a[i]){let t={};t=Object.assign(t,...e.styles.custom_fields[i]),o=Object.assign(Object.assign({},o),t)}return Object.keys(o).forEach((e=>{o[e]=this._getTemplateOrValue(t,o[e])})),o}_buildName(t,e){if(!1===this._config.show_name)return;let i;var n;return(null==e?void 0:e.name)?i=e.name:this._config.name?i=this._config.name:t&&(i=t.attributes&&t.attributes.friendly_name?t.attributes.friendly_name:(n=t.entity_id).substr(n.indexOf(\".\")+1)),this._getTemplateOrValue(t,i)}_buildStateString(t){let e;return this._config.show_state&&t&&t.state&&(\"timer\"===ie(t.entity_id)?\"idle\"===t.state||0===this._timeRemaining?e=ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,this._config):(e=this._computeTimeDisplay(t),\"paused\"===t.state&&(e+=` (${ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,this._config)})`)):e=ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,this._config)),e}_buildLastChanged(t,e){return this._config.show_last_changed&&t?P`\n          <ha-relative-time\n            id=\"label\"\n            class=\"ellipsis\"\n            .hass=\"${this._hass}\"\n            .datetime=\"${t.last_changed}\"\n            style=${_t(e)}\n          ></ha-relative-time>\n        `:void 0}_buildLabel(t,e){if(!this._config.show_label)return;let i;return i=(null==e?void 0:e.label)?e.label:this._config.label,this._getTemplateOrValue(t,i)}_buildCustomFields(t,e){let i=P``;const n={},r={};return this._config.custom_fields&&Object.keys(this._config.custom_fields).forEach((e=>{const i=this._config.custom_fields[e];i.card?i.do_not_eval?r[e]=Ai(i.card):r[e]=this._objectEvalTemplate(t,i.card):n[e]=this._getTemplateOrValue(t,i)})),(null==e?void 0:e.custom_fields)&&Object.keys(e.custom_fields).forEach((i=>{const s=e.custom_fields[i];s.card?s.do_not_eval?r[i]=Ai(s.card):r[i]=this._objectEvalTemplate(t,s.card):n[i]=this._getTemplateOrValue(t,s)})),Object.keys(n).forEach((r=>{if(null!=n[r]){const s=Object.assign(Object.assign({},this._buildCustomStyleGeneric(t,e,r)),{\"grid-area\":r});i=P`\n          ${i}\n          <div id=${r} class=\"ellipsis\" style=${_t(s)}>${this._unsafeHTMLorNot(n[r])}</div>\n        `}})),Object.keys(r).forEach((n=>{if(null!=r[n]){const s=Object.assign(Object.assign({},this._buildCustomStyleGeneric(t,e,n)),{\"grid-area\":n});let a;$t(this._cardsConfig[n],r[n])?a=this._cards[n]:(a=this._createCard(r[n]),this._cards[n]=a,this._cardsConfig[n]=Ai(r[n])),a.hass=this._hass,i=P`\n          ${i}\n          <div\n            id=${n}\n            @action=${this._stopPropagation}\n            @click=${this._stopPropagation}\n            @touchstart=${this._stopPropagation}\n            @mousedown=${this._stopPropagation}\n            @mouseup=${this._stopPropagation}\n            @touchend=${this._stopPropagation}\n            @touchcancel=${this._stopPropagation}\n            style=${_t(s)}\n          >\n            ${a}\n          </div>\n        `}})),i}_hasChildCards(t){return!!t&&Object.keys(t).some((e=>!!t[e].card))}_isClickable(t,e){const i=this._getTemplateOrValue(t,this._config.tap_action.action),n=this._getTemplateOrValue(t,this._config.hold_action.action),r=this._getTemplateOrValue(t,this._config.double_tap_action.action),s=this._hasChildCards(this._config.custom_fields)||!(!e||!this._hasChildCards(e.custom_fields));return\"none\"!=i||\"none\"!=n||\"none\"!=r||s}_rotate(t){return!!(null==t?void 0:t.spin)}_blankCardColoredHtml(t){const e=Object.assign({background:\"none\",\"box-shadow\":\"none\",\"border-style\":\"none\"},t);return P`\n      <ha-card class=\"disabled\" style=${_t(e)}>\n        <div></div>\n      </ha-card>\n    `}_cardHtml(){var t,e,i,n;const r=this._getMatchingConfigState(this._stateObj);let s=\"var(--state-inactive-color)\";(null==r?void 0:r.color)&&!Xt.includes(r.color)?s=r.color:(null===(t=this._config)||void 0===t?void 0:t.color)&&!Xt.includes(this._config.color)?this._stateObj?ae(this._stateObj)&&(s=(null===(e=this._config)||void 0===e?void 0:e.color)||s):s=this._config.color:s=this._buildCssColorAttribute(this._stateObj,r);let a=s,o={},l={};const c={},h=this._buildStyleGeneric(this._stateObj,r,\"lock\"),u=this._buildStyleGeneric(this._stateObj,r,\"card\"),d=this._buildStyleGeneric(this._stateObj,r,\"tooltip\"),f={\"button-card-main\":!0,disabled:!this._isClickable(this._stateObj,r)};switch((null===(i=this._config)||void 0===i?void 0:i.tooltip)&&this.classList.add(\"tooltip\"),u.width&&(this.style.setProperty(\"flex\",\"0 0 auto\"),this.style.setProperty(\"max-width\",\"fit-content\")),this._config.color_type){case\"blank-card\":return this._blankCardColoredHtml(u);case\"card\":case\"label-card\":{const t=function(t,e){const i=new qt(ne(t,e)).getLuminance(),n=new qt({r:225,g:225,b:225}),r=n.getLuminance(),s=new qt({r:28,g:28,b:28}),a=s.getLuminance();return 0===i||(Math.max(i,r)+.05)/Math.min(i,r+.05)>(Math.max(i,a)+.05)/Math.min(i,a+.05)?n.toRgbString():s.toRgbString()}(this,s);o.color=t,l.color=t,o[\"background-color\"]=s,o=Object.assign(Object.assign({},o),u),a=\"inherit\";break}default:o=u}this._config.aspect_ratio?(c[\"--aspect-ratio\"]=this._config.aspect_ratio,o.position=\"absolute\"):c.display=\"inline\",this.style.setProperty(\"--button-card-light-color\",this._getColorForLightEntity(this._stateObj,!0)),this.style.setProperty(\"--button-card-light-color-no-temperature\",this._getColorForLightEntity(this._stateObj,!1)),l=Object.assign(Object.assign({},l),h);const p=this._config.extra_styles?P`\n          <style>\n            ${this._getTemplateOrValue(this._stateObj,this._config.extra_styles)}\n          </style>\n        `:P``;return P`\n      ${p}\n      <div id=\"aspect-ratio\" style=${_t(c)}>\n        <ha-card\n          id=\"card\"\n          class=${yt(f)}\n          style=${_t(o)}\n          @action=${this._handleAction}\n          @focus=\"${this.handleRippleFocus}\"\n          @blur=\"${this.handleRippleBlur}\"\n          @mousedown=\"${this.handleRippleActivate}\"\n          @mouseup=\"${this.handleRippleDeactivate}\"\n          @touchstart=\"${this.handleRippleActivate}\"\n          @touchend=\"${this.handleRippleDeactivate}\"\n          @touchcancel=\"${this.handleRippleDeactivate}\"\n          .actionHandler=${St({hasDoubleClick:\"none\"!==this._config.double_tap_action.action,hasHold:\"none\"!==this._config.hold_action.action,repeat:this._config.hold_action.repeat,repeatLimit:this._config.hold_action.repeat_limit})}\n          .config=\"${this._config}\"\n        >\n          ${this._buttonContent(this._stateObj,r,a)}\n          <mwc-ripple id=\"ripple\"></mwc-ripple>\n        </ha-card>\n        ${this._getLock(l)}\n      </div>\n      ${(null===(n=this._config)||void 0===n?void 0:n.tooltip)?P`\n            <span class=\"tooltiptext\" style=${_t(d)}>\n              ${this._getTemplateOrValue(this._stateObj,this._config.tooltip)}\n            </span>\n          `:\"\"}\n    `}_getLock(t){return this._config.lock&&this._getTemplateOrValue(this._stateObj,this._config.lock.enabled)?P`\n        <div\n          id=\"overlay\"\n          style=${_t(t)}\n          @action=${this._handleUnlockType}\n          .actionHandler=${St({hasDoubleClick:\"double_tap\"===this._config.lock.unlock,hasHold:\"hold\"===this._config.lock.unlock})}\n          .config=\"${this._config}\"\n        >\n          <ha-icon id=\"lock\" icon=\"mdi:lock-outline\"></ha-icon>\n        </div>\n      `:P``}_buttonContent(t,e,i){const n=this._buildName(t,e),r=(null==e?void 0:e.state_display)||this._config.state_display||void 0,s=this._config.show_state&&r?this._getTemplateOrValue(t,r):void 0,a=s||this._buildStateString(t),o=function(t,e){if(!t&&!e)return;let i;return i=e?t?`${t}: ${e}`:e:t,i}(n,a);switch(this._config.layout){case\"icon_name_state\":case\"name_state\":return this._gridHtml(t,e,this._config.layout,i,o,void 0);default:return this._gridHtml(t,e,this._config.layout,i,n,a)}}_unsafeHTMLorNot(t){return t.strings||t.values?t:bt(`${t}`)}_gridHtml(t,e,i,n,r,s){const a=this._getIconHtml(t,e,n),o=[i],l=this._buildLabel(t,e),c=this._buildStyleGeneric(t,e,\"name\"),h=this._buildStyleGeneric(t,e,\"state\"),u=this._buildStyleGeneric(t,e,\"label\"),d=this._buildLastChanged(t,u),f=this._buildStyleGeneric(t,e,\"grid\");return a||o.push(\"no-icon\"),r||o.push(\"no-name\"),s||o.push(\"no-state\"),l||d||o.push(\"no-label\"),P`\n      <div id=\"container\" class=${o.join(\" \")} style=${_t(f)}>\n        ${a||\"\"}\n        ${r?P`\n              <div id=\"name\" class=\"ellipsis\" style=${_t(c)}>\n                ${this._unsafeHTMLorNot(r)}\n              </div>\n            `:\"\"}\n        ${s?P`\n              <div id=\"state\" class=\"ellipsis\" style=${_t(h)}>\n                ${this._unsafeHTMLorNot(s)}\n              </div>\n            `:\"\"}\n        ${l&&!d?P`\n              <div id=\"label\" class=\"ellipsis\" style=${_t(u)}>\n                ${this._unsafeHTMLorNot(l)}\n              </div>\n            `:\"\"}\n        ${d||\"\"} ${this._buildCustomFields(t,e)}\n      </div>\n    `}_getIconHtml(t,e,i){const n=this._buildIcon(t,e),r=this._buildEntityPicture(t,e),s=this._buildStyleGeneric(t,e,\"entity_picture\"),a=this._buildStyleGeneric(t,e,\"icon\"),o=this._buildStyleGeneric(t,e,\"img_cell\"),l=this._buildStyleGeneric(t,e,\"card\"),c=Object.assign({color:i,width:this._config.size,\"--ha-icon-display\":l.height?\"inline\":void 0,position:this._config.aspect_ratio||l.height?\"absolute\":\"relative\"},a),h=Object.assign(Object.assign({},c),s),u=this._buildLiveStream(h),d=this._config.show_icon&&(n||t);if(d||r){let i;return t&&(i=ie(t.entity_id)),P`\n        <div id=\"img-cell\" style=${_t(o)}>\n          ${!d||r||u?\"\":P`\n                <ha-state-icon\n                  .state=${t}\n                  .stateObj=${t}\n                  .hass=${this._hass}\n                  ?data-domain=${i}\n                  data-state=${(t=>null!=t?t:L)(null==t?void 0:t.state)}\n                  style=${_t(c)}\n                  .icon=\"${n}\"\n                  id=\"icon\"\n                  ?rotating=${this._rotate(e)}\n                ></ha-state-icon>\n              `}\n          ${u||\"\"}\n          ${r&&!u?P`\n                <img\n                  src=\"${r}\"\n                  style=${_t(h)}\n                  id=\"icon\"\n                  ?rotating=${this._rotate(e)}\n                />\n              `:\"\"}\n        </div>\n      `}}_buildLiveStream(t){return this._config.show_live_stream&&this._config.entity&&\"camera\"===ie(this._config.entity)?P`\n        <hui-image\n          .hass=${this._hass}\n          .cameraImage=${this._config.entity}\n          .entity=${this._config.entity}\n          cameraView=\"live\"\n          style=${_t(t)}\n        ></hui-image>\n      `:void 0}_configFromLLTemplates(t,e){const i=e.template;if(!i)return e;let n,r={};const s=i&&Array.isArray(i)?i:[i];return null==s||s.forEach((e=>{var i,s;let a;if(null===(i=t.config.cblcars_card_templates)||void 0===i?void 0:i[e])a=t.config.cblcars_card_templates[e];else{if(!(null===(s=window.cblcars_card_templates)||void 0===s?void 0:s[e]))throw new Error(`LCARS Button-card template '${e}' is missing!`);a=window.cblcars_card_templates[e]}const o=this._configFromLLTemplates(t,a);r=re(r,o),n=se(n,o.state)})),r=re(r,e),r.state=se(n,e.state),r}setConfig(t){if(!t)throw new Error(\"Invalid configuration\");this._initialSetupComplete&&(this._initialSetupComplete=!1),this._cards={},this._cardsConfig={};const e=function(){let t=document.querySelector(\"home-assistant\");if(t=t&&t.shadowRoot,t=t&&t.querySelector(\"home-assistant-main\"),t=t&&t.shadowRoot,t=t&&t.querySelector(\"app-drawer-layout partial-panel-resolver, ha-drawer partial-panel-resolver\"),t=t&&t.shadowRoot||t,t=t&&t.querySelector(\"ha-panel-lovelace\"),t=t&&t.shadowRoot,t=t&&t.querySelector(\"hui-root\"),t){const e=t.lovelace;return e.current_view=t.___curView,e}return null}()||function(){let t=document.querySelector(\"hc-main\");if(t=t&&t.shadowRoot,t=t&&t.querySelector(\"hc-lovelace\"),t=t&&t.shadowRoot,t=t&&(t.querySelector(\"hui-view\")||t.querySelector(\"hui-panel-view\")),t){const e=t.lovelace;return e.current_view=t.___curView,e}return null}();let i=Ai(t);i=this._configFromLLTemplates(e,i),this._config=Object.assign(Object.assign({type:\"custom:cblcars-button-card\",group_expand:!1,hold_action:{action:\"none\"},double_tap_action:{action:\"none\"},layout:\"vertical\",size:\"40%\",color_type:\"icon\",show_name:!0,show_state:!1,show_icon:!0,show_units:!0,show_label:!1,show_entity_picture:!1,show_live_stream:!1,card_size:3},i),{lock:Object.assign({enabled:!1,duration:5,unlock:\"tap\"},i.lock)}),this._initialSetupComplete||this._finishSetup()}_loopGroup(t){t&&t.forEach((t=>{var e,i;(null===(e=this._hass)||void 0===e?void 0:e.states[t])&&((null===(i=this._hass.states[t].attributes)||void 0===i?void 0:i.entity_id)?this._loopGroup(this._hass.states[t].attributes.entity_id):this._entities.includes(t)||this._entities.push(t))}))}_expandTriggerGroups(){var t;this._hass&&(null===(t=this._config)||void 0===t?void 0:t.group_expand)&&this._entities&&this._entities.forEach((t=>{var e,i,n,r,s;(null===(n=null===(i=null===(e=this._hass)||void 0===e?void 0:e.states[t])||void 0===i?void 0:i.attributes)||void 0===n?void 0:n.entity_id)&&this._loopGroup(null===(s=null===(r=this._hass)||void 0===r?void 0:r.states[t].attributes)||void 0===s?void 0:s.entity_id)}))}getCardSize(){var t;return(null===(t=this._config)||void 0===t?void 0:t.card_size)||3}_evalActions(t,e){var i,n,r,s,a;const o=Ai(t),l=t=>t?(Object.keys(t).forEach((e=>{\"object\"==typeof t[e]?t[e]=l(t[e]):t[e]=this._getTemplateOrValue(this._stateObj,t[e])})),t):t;return\"entity\"===(null===(n=null===(i=o[e])||void 0===i?void 0:i.service_data)||void 0===n?void 0:n.entity_id)&&(o[e].service_data.entity_id=t.entity),\"entity\"===(null===(s=null===(r=o[e])||void 0===r?void 0:r.data)||void 0===s?void 0:s.entity_id)&&(o[e].data.entity_id=t.entity),o[e]=l(o[e]),!o[e].confirmation&&o.confirmation&&(o[e].confirmation=l(o.confirmation)),(null===(a=o[e])||void 0===a?void 0:a.entity)&&(o.entity=o[e].entity),o}handleRippleActivate(t){this._ripple.then((e=>e&&\"function\"==typeof e.startPress&&this._rippleHandlers.startPress(t)))}handleRippleDeactivate(){this._ripple.then((t=>t&&\"function\"==typeof t.endPress&&this._rippleHandlers.endPress()))}handleRippleFocus(){this._ripple.then((t=>t&&\"function\"==typeof t.startFocus&&this._rippleHandlers.startFocus()))}handleRippleBlur(){this._ripple.then((t=>t&&\"function\"==typeof t.endFocus&&this._rippleHandlers.endFocus()))}_handleAction(t){var e;if(null===(e=t.detail)||void 0===e?void 0:e.action)switch(t.detail.action){case\"tap\":case\"hold\":case\"double_tap\":const e=this._config;if(!e)return;const i=t.detail.action,n=this._evalActions(e,`${i}_action`);(async(t,e,i,n)=>{wt(t,\"hass-action\",{config:i,action:n})})(this,this._hass,n,i)}}_handleUnlockType(t){const e=this._config;e&&e.lock.unlock===t.detail.action&&this._handleLock()}_handleLock(){var t;const e=this.shadowRoot.getElementById(\"lock\");if(!e)return;if(this._config.lock.exemptions){if(!(null===(t=this._hass.user)||void 0===t?void 0:t.name)||!this._hass.user.id)return;let i=!1;if(this._config.lock.exemptions.forEach((t=>{var e,n;(!i&&t.user===(null===(e=this._hass.user)||void 0===e?void 0:e.id)||t.username===(null===(n=this._hass.user)||void 0===n?void 0:n.name))&&(i=!0)})),!i)return e.classList.add(\"invalid\"),void window.setTimeout((()=>{e&&e.classList.remove(\"invalid\")}),3e3)}const i=this.shadowRoot.getElementById(\"overlay\");if(i.style.setProperty(\"pointer-events\",\"none\"),e){const t=document.createAttribute(\"icon\");t.value=\"mdi:lock-open-outline\",e.attributes.setNamedItem(t),e.classList.add(\"hidden\")}window.setTimeout((()=>{if(i.style.setProperty(\"pointer-events\",\"\"),e){e.classList.remove(\"hidden\");const t=document.createAttribute(\"icon\");t.value=\"mdi:lock-outline\",e.attributes.setNamedItem(t)}}),1e3*this._config.lock.duration)}_stopPropagation(t){t.stopPropagation()}};t([at()],Ci.prototype,\"_hass\",void 0),t([at()],Ci.prototype,\"_config\",void 0),t([at()],Ci.prototype,\"_timeRemaining\",void 0),t([function(t){return ot({descriptor:e=>({async get(){var e;return await this.updateComplete,null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t)},enumerable:!0,configurable:!0})})}(\"mwc-ripple\")],Ci.prototype,\"_ripple\",void 0),t([lt({passive:!0})],Ci.prototype,\"handleRippleActivate\",null),t([lt({passive:!0})],Ci.prototype,\"handleRippleDeactivate\",null),t([lt({passive:!0})],Ci.prototype,\"handleRippleFocus\",null),t([lt({passive:!0})],Ci.prototype,\"handleRippleBlur\",null),t([lt({passive:!0})],Ci.prototype,\"_handleAction\",null),t([lt({passive:!0})],Ci.prototype,\"_handleUnlockType\",null),t([lt({passive:!0})],Ci.prototype,\"_handleLock\",null),t([lt({passive:!0})],Ci.prototype,\"_stopPropagation\",null),Ci=t([(t=>e=>\"function\"==typeof e?((t,e)=>(customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:i,elements:n}=e;return{kind:i,elements:n,finisher(e){customElements.define(t,e)}}})(t,e))(\"cblcars-button-card\")],Ci);export{Ci as ButtonCard};\n","// Extract anchor points from SVG content\n\nexport function findSvgAnchors(svgContent) {\n  const anchors = {};\n  // Improved <circle> extraction: match cx/cy in any order\n  const circleRegex = /<circle[^>]*id=\"([^\"]+)\"[^>]*>/g;\n  let m;\n  while ((m = circleRegex.exec(svgContent)) !== null) {\n    const id = m[1];\n    const tag = m[0];\n    const cxMatch = tag.match(/\\scx=\"([^\"]+)\"/);\n    const cyMatch = tag.match(/\\scy=\"([^\"]+)\"/);\n    if (cxMatch && cyMatch) {\n      anchors[id] = [parseFloat(cxMatch[1]), parseFloat(cyMatch[1])];\n    }\n  }\n\n  // Improved <text> extraction: match x/y in any order\n  const textRegex = /<text[^>]*id=\"([^\"]+)\"[^>]*>/g;\n  while ((m = textRegex.exec(svgContent)) !== null) {\n    const id = m[1];\n    // Extract x and y attributes from the tag\n    const tag = m[0];\n    const xMatch = tag.match(/\\sx=\"([^\"]+)\"/);\n    const yMatch = tag.match(/\\sy=\"([^\"]+)\"/);\n    if (xMatch && yMatch) {\n      anchors[id] = [parseFloat(xMatch[1]), parseFloat(yMatch[1])];\n    }\n  }\n  // <g id=\"anchor\">\n  const groupRegex = /<g[^>]*id=\"([^\"]+)\"[^>]*>/g;\n  while ((m = groupRegex.exec(svgContent)) !== null) {\n    anchors[m[1]] = null; // Optionally: calculate centroid if needed\n  }\n  return anchors;\n}\n\nexport function getSvgContent(base_svg) {\n  let svgKey = null;\n  if (base_svg && base_svg.startsWith('builtin:')) {\n    svgKey = base_svg.replace('builtin:', '');\n  } else if (base_svg && base_svg.startsWith('/local/')) {\n    svgKey = base_svg.split('/').pop().replace('.svg','');\n  }\n  return svgKey && window.cblcars?.msd?.svg_templates?.[svgKey];\n}\n\nexport function getSvgViewBox(svgContent) {\n  const match = svgContent && svgContent.match(/viewBox=\"([0-9.\\-]+)\\s+([0-9.\\-]+)\\s+([0-9.\\-]+)\\s+([0-9.\\-]+)\"/);\n  if (match) {\n    return [parseFloat(match[1]), parseFloat(match[2]), parseFloat(match[3]), parseFloat(match[4])];\n  }\n  return [0, 0, 400, 200];\n}\n\nexport function getSvgAspectRatio(viewBox) {\n  return viewBox[2] && viewBox[3] ? (viewBox[2] / viewBox[3]) : 2;\n}\n\n\n","/**\n * Canonical checksum generation for MSD configurations\n * Uses Web Crypto API for browser compatibility\n */\n\nexport async function computeCanonicalChecksum(obj) {\n  const cleaned = stripMetaFields(obj);\n  const stable = stableStringify(cleaned);\n\n  // Check if we're in a secure context (HTTPS or localhost)\n  if (typeof crypto !== 'undefined' && crypto.subtle) {\n    // Use Web Crypto API (available in browsers and Node 16+)\n    const encoder = new TextEncoder();\n    const data = encoder.encode(stable);\n    const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n    const hashArray = new Uint8Array(hashBuffer);\n    const hashHex = Array.from(hashArray)\n      .map(b => b.toString(16).padStart(2, '0'))\n      .join('');\n\n    // Return first 10 characters for readability\n    return hashHex.substring(0, 10);\n  } else {\n    // Fallback for non-secure contexts (HTTP)\n    return simpleHash(stable).substring(0, 10);\n  }\n}\n\nfunction stripMetaFields(obj) {\n  if (obj === null || typeof obj !== 'object') {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    return obj.map(stripMetaFields);\n  }\n\n  const cleaned = {};\n\n  for (const [key, value] of Object.entries(obj)) {\n    // Skip metadata fields that don't affect semantic meaning\n    if (key.startsWith('__') ||\n        key === 'checksum' ||\n        key === 'origin_pack' ||\n        key === 'timestamp') {\n      continue;\n    }\n\n    cleaned[key] = stripMetaFields(value);\n  }\n\n  return cleaned;\n}\n\nfunction stableStringify(obj) {\n  if (obj === null || typeof obj !== 'object') {\n    return JSON.stringify(obj);\n  }\n\n  if (Array.isArray(obj)) {\n    const items = obj.map(stableStringify);\n    return `[${items.join(',')}]`;\n  }\n\n  // Sort object keys for deterministic output\n  const sortedKeys = Object.keys(obj).sort();\n  const pairs = sortedKeys.map(key => {\n    const value = stableStringify(obj[key]);\n    return `\"${key}\":${value}`;\n  });\n\n  return `{${pairs.join(',')}}`;\n}\n\n// Simple hash function for non-secure contexts\nfunction simpleHash(str) {\n  let hash = 0;\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // Convert to 32-bit integer\n  }\n  return Math.abs(hash).toString(16);\n}\n\n/**\n * Compare two objects for semantic equality (ignoring metadata)\n */\nexport function semanticEquals(obj1, obj2) {\n  const clean1 = stripMetaFields(obj1);\n  const clean2 = stripMetaFields(obj2);\n  return stableStringify(clean1) === stableStringify(clean2);\n}\n","/**\n * Performance tracking and instrumentation for MSD pipeline\n * Provides detailed timing and counter metrics for optimization\n */\n\nclass PerformanceTracker {\n  constructor() {\n    this.counters = new Map();\n    this.timings = new Map();\n    this.sessionStart = performance.now();\n  }\n\n  /**\n   * Add timing measurement\n   */\n  addTiming(key, ms, metadata = {}) {\n    if (!this.timings.has(key)) {\n      this.timings.set(key, {\n        last: 0,\n        totalMs: 0,\n        samples: 0,\n        avg: 0,\n        min: Infinity,\n        max: 0,\n        metadata: []\n      });\n    }\n\n    const timing = this.timings.get(key);\n    timing.last = ms;\n    timing.totalMs += ms;\n    timing.samples++;\n    timing.avg = timing.totalMs / timing.samples;\n    timing.min = Math.min(timing.min, ms);\n    timing.max = Math.max(timing.max, ms);\n\n    if (Object.keys(metadata).length > 0) {\n      timing.metadata.push({ ...metadata, ms, timestamp: Date.now() });\n      // Keep only last 10 metadata entries\n      if (timing.metadata.length > 10) {\n        timing.metadata = timing.metadata.slice(-10);\n      }\n    }\n  }\n\n  /**\n   * Add discrete counter\n   */\n  addCount(key, increment = 1, metadata = {}) {\n    if (!this.counters.has(key)) {\n      this.counters.set(key, {\n        count: 0,\n        rate: 0,\n        lastUpdate: performance.now(),\n        metadata: []\n      });\n    }\n\n    const counter = this.counters.get(key);\n    const now = performance.now();\n    const deltaTime = (now - counter.lastUpdate) / 1000; // seconds\n\n    counter.count += increment;\n    counter.rate = deltaTime > 0 ? increment / deltaTime : 0;\n    counter.lastUpdate = now;\n\n    if (Object.keys(metadata).length > 0) {\n      counter.metadata.push({ ...metadata, increment, timestamp: Date.now() });\n      // Keep only last 10 metadata entries\n      if (counter.metadata.length > 10) {\n        counter.metadata = counter.metadata.slice(-10);\n      }\n    }\n  }\n\n  /**\n   * Time a function execution\n   */\n  async timeAsync(key, fn, metadata = {}) {\n    const start = performance.now();\n    try {\n      const result = await fn();\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, metadata);\n      return result;\n    } catch (error) {\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, { ...metadata, error: error.message });\n      throw error;\n    }\n  }\n\n  /**\n   * Time a synchronous function execution\n   */\n  timeSync(key, fn, metadata = {}) {\n    const start = performance.now();\n    try {\n      const result = fn();\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, metadata);\n      return result;\n    } catch (error) {\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, { ...metadata, error: error.message });\n      throw error;\n    }\n  }\n\n  /**\n   * Get all performance data\n   */\n  getAll() {\n    const sessionDuration = performance.now() - this.sessionStart;\n\n    return {\n      session: {\n        duration_ms: sessionDuration,\n        started_at: Date.now() - sessionDuration\n      },\n      timings: Object.fromEntries(this.timings),\n      counters: Object.fromEntries(this.counters),\n      summary: this.getSummary()\n    };\n  }\n\n  /**\n   * Get performance summary for quick overview\n   */\n  getSummary() {\n    const criticalTimings = ['merge.total', 'validation.total', 'render.total'];\n    const criticalCounters = ['rules.eval.count', 'rules.match.count', 'animation.instance.reuse'];\n\n    const summary = {\n      timings: {},\n      counters: {},\n      health: 'good'\n    };\n\n    // Extract critical timing data\n    criticalTimings.forEach(key => {\n      if (this.timings.has(key)) {\n        const timing = this.timings.get(key);\n        summary.timings[key] = {\n          avg: timing.avg,\n          last: timing.last,\n          samples: timing.samples\n        };\n\n        // Health check: mark as warning if average is high\n        if (timing.avg > 50) { // 50ms threshold\n          summary.health = 'warning';\n        }\n        if (timing.avg > 100) { // 100ms threshold\n          summary.health = 'critical';\n        }\n      }\n    });\n\n    // Extract critical counter data\n    criticalCounters.forEach(key => {\n      if (this.counters.has(key)) {\n        const counter = this.counters.get(key);\n        summary.counters[key] = {\n          count: counter.count,\n          rate: counter.rate\n        };\n      }\n    });\n\n    return summary;\n  }\n\n  /**\n   * Reset all performance data\n   */\n  reset() {\n    this.counters.clear();\n    this.timings.clear();\n    this.sessionStart = performance.now();\n  }\n\n  /**\n   * Export performance data for analysis\n   */\n  export(options = {}) {\n    const data = this.getAll();\n\n    if (options.format === 'csv') {\n      return this.exportToCsv(data);\n    }\n\n    if (options.minify) {\n      return this.minifyData(data);\n    }\n\n    return data;\n  }\n\n  minifyData(data) {\n    // Remove metadata and keep only essential metrics\n    const minified = {\n      session: data.session,\n      timings: {},\n      counters: {},\n      summary: data.summary\n    };\n\n    for (const [key, timing] of Object.entries(data.timings)) {\n      minified.timings[key] = {\n        avg: timing.avg,\n        last: timing.last,\n        samples: timing.samples,\n        min: timing.min,\n        max: timing.max\n      };\n    }\n\n    for (const [key, counter] of Object.entries(data.counters)) {\n      minified.counters[key] = {\n        count: counter.count,\n        rate: counter.rate\n      };\n    }\n\n    return minified;\n  }\n}\n\n// Global instance\nconst globalPerfTracker = new PerformanceTracker();\n\n// Utility functions for common operations\nexport function perfTime(key, fn, metadata = {}) {\n  if (typeof fn === 'function') {\n    return globalPerfTracker.timeSync(key, fn, metadata);\n  }\n  // Return timing function for manual timing\n  return {\n    end: (metadata = {}) => {\n      const duration = performance.now() - perfTime.start;\n      globalPerfTracker.addTiming(key, duration, metadata);\n    }\n  };\n}\n\nexport async function perfTimeAsync(key, fn, metadata = {}) {\n  return globalPerfTracker.timeAsync(key, fn, metadata);\n}\n\nexport function perfCount(key, increment = 1, metadata = {}) {\n  globalPerfTracker.addCount(key, increment, metadata);\n}\n\nexport function perfGetAll() {\n  return globalPerfTracker.getAll();\n}\n\nexport function perfGetSummary() {\n  return globalPerfTracker.getSummary();\n}\n\nexport function perfReset() {\n  globalPerfTracker.reset();\n}\n\nexport function perfExport(options = {}) {\n  return globalPerfTracker.export(options);\n}\n\n// Node.js and browser compatibility\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdPerf = {\n    getAll: perfGetAll,\n    getSummary: perfGetSummary,\n    reset: perfReset,\n    export: perfExport\n  };\n}\n","import { computeCanonicalChecksum } from '../util/checksum.js';\nimport { perfTime, perfTimeAsync, perfCount } from '../util/performance.js';\n\n/**\n * Single consolidated merge algorithm - COMPLETE REPLACEMENT\n * Removes all legacy dual merge logic per Milestone 1.1\n */\nexport async function mergePacks(userConfig) {\n  return await perfTimeAsync('merge.total', async () => {\n    const layers = await perfTimeAsync('merge.loadLayers', () => loadAllLayers(userConfig));\n    const merged = await perfTimeAsync('merge.processSingle', () => processSinglePass(layers));\n\n    return merged;\n  }, {\n    config_overlays: userConfig.overlays?.length || 0,\n    config_rules: userConfig.rules?.length || 0,\n    config_anchors: Object.keys(userConfig.anchors || {}).length,\n    use_packs: userConfig.use_packs?.builtin?.length || 0\n  });\n}\n\nasync function loadAllLayers(userConfig) {\n  const layers = [];\n\n  // Load builtin packs first\n  const builtinPacks = userConfig.use_packs?.builtin || ['core'];\n  for (const packName of builtinPacks) {\n    const pack = await loadBuiltinPack(packName);\n    if (pack) {\n      layers.push({\n        type: 'builtin',\n        pack: packName,\n        data: pack,\n        priority: 100\n      });\n    }\n  }\n\n  // Load external packs with timeout\n  if (userConfig.use_packs?.external?.length > 0) {\n    const externalResults = await loadExternalPacks(userConfig.use_packs.external);\n    externalResults.forEach((result, index) => {\n      if (result.data && !result.error) {\n        layers.push({\n          type: 'external',\n          pack: result.url,\n          data: result.data,\n          priority: 200 + index\n        });\n      }\n    });\n  }\n\n  // User config layer (highest priority)\n  layers.push({\n    type: 'user',\n    pack: 'user_config',\n    data: userConfig,\n    priority: 1000\n  });\n\n  return layers.sort((a, b) => a.priority - b.priority);\n}\n\nasync function processSinglePass(layers) {\n  const merged = {\n    version: 1,\n    anchors: {},\n    palettes: {},\n    profiles: [],\n    overlays: [],\n    rules: [],\n    animations: [],\n    timelines: [],\n    routing: {},\n    data_sources: {},\n    active_profiles: ['normal'],\n    __provenance: {\n      anchors: {},\n      palettes: {},\n      overlays: {},\n      rules: {},\n      animations: {},\n      merge_order: []\n    }\n  };\n\n  // Process each layer in priority order\n  for (const layer of layers) {\n    perfTime('merge.processLayer', () => processLayer(merged, layer), {\n      layer: layer.pack,\n      type: layer.type\n    });\n\n    merged.__provenance.merge_order.push({\n      type: layer.type,\n      pack: layer.pack,\n      priority: layer.priority\n    });\n  }\n\n  // Apply removals after all merges\n  perfTime('merge.applyRemovals', () => applyRemovals(merged, layers[layers.length - 1]?.data?.remove));\n\n  // Generate canonical checksum\n  merged.checksum = await perfTimeAsync('merge.checksum', () => computeCanonicalChecksum(merged));\n\n  return merged;\n}\n\nasync function loadBuiltinPack(packName) {\n  // Try debug packs first (for development)\n  try {\n    const dbgPacks = window.__msdDebug?.packs;\n    if (dbgPacks) {\n      const dbgSource = packName === 'core'\n        ? dbgPacks.core\n        : dbgPacks.builtin?.[packName];\n\n      if (dbgSource && typeof dbgSource === 'object') {\n        return dbgSource;\n      }\n    }\n  } catch (e) {\n    // Fallback to normal loading\n  }\n\n  // Normal builtin pack loading would go here\n  // For now, return minimal core pack with simulated SVG anchors\n  if (packName === 'core') {\n    return {\n      version: 1,\n      // Simulate SVG-extracted anchors\n      anchors: {\n        svg_bridge: [200, 150],  // Simulated SVG extraction\n        svg_warp: [350, 200],    // Simulated SVG extraction\n      },\n      _extracted_anchors: ['svg_bridge', 'svg_warp'], // Mark as SVG-extracted\n      profiles: [\n        {\n          id: 'normal',\n          defaults: {\n            line: { color: 'var(--lcars-orange)', width: 2 },\n            text: { color: 'var(--lcars-orange)', font_size: 14 }\n          }\n        }\n      ],\n      palettes: {\n        default: {\n          accent1: 'var(--lcars-orange)',\n          accent2: 'var(--lcars-yellow)',\n          danger: 'var(--lcars-red)',\n          info: 'var(--lcars-cyan)'\n        }\n      }\n    };\n  }\n\n  return null;\n}\n\nasync function loadExternalPacks(urls, options = {}) {\n  const {\n    timeout = 5000,\n    retries = 2,\n    retryDelay = 1000,\n    enableCaching = true\n  } = options;\n\n  const results = [];\n  const perfTracker = {\n    total_packs: urls.length,\n    successful: 0,\n    failed: 0,\n    retried: 0,\n    cached_hits: 0,\n    total_time_ms: 0\n  };\n\n  const startTime = performance.now();\n\n  for (let i = 0; i < urls.length; i++) {\n    const url = urls[i];\n    const packResult = await loadSingleExternalPack(url, {\n      timeout,\n      retries,\n      retryDelay,\n      enableCaching,\n      index: i\n    });\n\n    results.push(packResult);\n\n    // Update performance tracking\n    if (packResult.error) {\n      perfTracker.failed++;\n    } else {\n      perfTracker.successful++;\n    }\n\n    if (packResult.retryCount > 0) {\n      perfTracker.retried++;\n    }\n\n    if (packResult.cached) {\n      perfTracker.cached_hits++;\n    }\n  }\n\n  perfTracker.total_time_ms = performance.now() - startTime;\n\n  // Store performance data for debugging - Node.js compatible\n  try {\n    const debugNamespace = (typeof window !== 'undefined') ? window : global;\n    debugNamespace.__msdDebug = debugNamespace.__msdDebug || {};\n    debugNamespace.__msdDebug._lastExternalPackPerf = perfTracker;\n  } catch (e) {}\n\n  return results;\n}\n\nasync function loadSingleExternalPack(url, options) {\n  const { timeout, retries, retryDelay, enableCaching, index } = options;\n\n  // Check cache first\n  if (enableCaching && externalPackCache.has(url)) {\n    const cached = externalPackCache.get(url);\n    if (Date.now() - cached.timestamp < 300000) { // 5 minute cache\n      return {\n        url,\n        data: cached.data,\n        error: cached.error,\n        cached: true,\n        loadTime: 0,\n        retryCount: 0,\n        index\n      };\n    }\n  }\n\n  let lastError = null;\n  let retryCount = 0;\n\n  for (let attempt = 0; attempt <= retries; attempt++) {\n    const attemptStart = performance.now();\n\n    try {\n      const result = await Promise.race([\n        fetchWithValidation(url),\n        createTimeoutPromise(timeout, url)\n      ]);\n\n      const loadTime = performance.now() - attemptStart;\n\n      // Cache successful result\n      if (enableCaching) {\n        externalPackCache.set(url, {\n          data: result.data,\n          error: null,\n          timestamp: Date.now()\n        });\n      }\n\n      return {\n        url,\n        data: result.data,\n        error: null,\n        cached: false,\n        loadTime,\n        retryCount,\n        index,\n        contentType: result.contentType,\n        size: result.size\n      };\n\n    } catch (error) {\n      lastError = error;\n      retryCount = attempt;\n\n      // Don't retry on certain error types\n      if (error.name === 'ValidationError' ||\n          error.name === 'SyntaxError' ||\n          error.message.includes('404')) {\n        break;\n      }\n\n      // Wait before retry\n      if (attempt < retries) {\n        await new Promise(resolve => setTimeout(resolve, retryDelay * (attempt + 1)));\n      }\n    }\n  }\n\n  // Cache failed result to avoid repeated failures\n  if (enableCaching) {\n    externalPackCache.set(url, {\n      data: null,\n      error: lastError.message,\n      timestamp: Date.now()\n    });\n  }\n\n  return {\n    url,\n    data: null,\n    error: lastError?.message || 'Unknown error',\n    errorType: classifyError(lastError),\n    cached: false,\n    loadTime: 0,\n    retryCount,\n    index\n  };\n}\n\nasync function fetchWithValidation(url) {\n  // Validate URL format\n  try {\n    new URL(url);\n  } catch (e) {\n    const error = new Error(`Invalid URL format: ${url}`);\n    error.name = 'ValidationError';\n    throw error;\n  }\n\n  // Perform fetch\n  const response = await fetch(url);\n\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status}: ${response.statusText} for ${url}`);\n  }\n\n  // Validate content type\n  const contentType = response.headers.get('content-type') || '';\n  if (!contentType.includes('application/json') && !contentType.includes('text/')) {\n    console.warn(`[MSD] External pack ${url} has unexpected content-type: ${contentType}`);\n  }\n\n  // Parse JSON with size limits\n  const text = await response.text();\n  if (text.length > 1024 * 1024) { // 1MB limit\n    throw new Error(`External pack ${url} too large: ${text.length} bytes (max 1MB)`);\n  }\n\n  let data;\n  try {\n    data = JSON.parse(text);\n  } catch (e) {\n    const error = new Error(`Invalid JSON in external pack ${url}: ${e.message}`);\n    error.name = 'SyntaxError';\n    throw error;\n  }\n\n  // Basic MSD structure validation\n  if (data && typeof data === 'object') {\n    validateExternalPackStructure(data, url);\n  }\n\n  return {\n    data,\n    contentType,\n    size: text.length\n  };\n}\n\nfunction createTimeoutPromise(timeout, url) {\n  return new Promise((_, reject) => {\n    setTimeout(() => {\n      const error = new Error(`Timeout loading external pack: ${url} (${timeout}ms)`);\n      error.name = 'TimeoutError';\n      reject(error);\n    }, timeout);\n  });\n}\n\nfunction validateExternalPackStructure(data, url) {\n  // Basic validation - ensure it looks like an MSD pack\n  const validFields = ['version', 'anchors', 'overlays', 'rules', 'animations', 'profiles', 'palettes', 'timelines'];\n  const dataFields = Object.keys(data);\n  const hasValidField = validFields.some(field => dataFields.includes(field));\n\n  if (!hasValidField) {\n    console.warn(`[MSD] External pack ${url} doesn't contain recognized MSD fields`);\n  }\n\n  // Check for required ID fields in collections\n  const collections = ['overlays', 'rules', 'animations', 'profiles'];\n  collections.forEach(collection => {\n    if (Array.isArray(data[collection])) {\n      data[collection].forEach((item, index) => {\n        if (!item.id) {\n          console.warn(`[MSD] External pack ${url} ${collection}[${index}] missing required 'id' field`);\n        }\n      });\n    }\n  });\n}\n\nfunction classifyError(error) {\n  if (!error) return 'unknown';\n\n  if (error.name === 'TimeoutError') return 'timeout';\n  if (error.name === 'ValidationError') return 'validation';\n  if (error.name === 'SyntaxError') return 'syntax';\n  if (error.message.includes('404')) return 'not_found';\n  if (error.message.includes('403')) return 'forbidden';\n  if (error.message.includes('network')) return 'network';\n\n  return 'unknown';\n}\n\n// Simple cache for external packs\nconst externalPackCache = new Map();\n\n// Export for testing\nexport { externalPackCache };\n\nasync function processLayer(merged, layer) {\n  const collections = ['overlays', 'rules', 'animations', 'profiles', 'timelines'];\n\n  // Process collections with ID-based merging\n  for (const collection of collections) {\n    if (layer.data[collection] && Array.isArray(layer.data[collection])) {\n      perfTime(`merge.collection.${collection}`, () => {\n        // Initialize provenance collection if missing\n        if (!merged.__provenance[collection]) {\n          merged.__provenance[collection] = {};\n        }\n\n        for (const item of layer.data[collection]) {\n          if (!item.id) continue;\n\n          // Handle inline removal\n          if (item.remove === true) {\n            const index = merged[collection].findIndex(existing => existing.id === item.id);\n            if (index >= 0) {\n              merged[collection].splice(index, 1);\n              merged.__provenance[collection][item.id] = {\n                ...(merged.__provenance[collection][item.id] || {}),\n                removed: true,\n                removal_source: layer.pack\n              };\n            }\n            continue;\n          }\n\n          // Normal merge\n          const existingIndex = merged[collection].findIndex(existing => existing.id === item.id);\n          const cloned = structuredClone(item);\n          delete cloned.remove;\n\n          if (existingIndex >= 0) {\n            // Override existing\n            merged[collection][existingIndex] = cloned;\n            merged.__provenance[collection][item.id] = {\n              origin_pack: merged.__provenance[collection][item.id]?.origin_pack || layer.pack,\n              overridden: true,\n              override_layer: layer.pack\n            };\n          } else {\n            // Add new\n            merged[collection].push(cloned);\n            merged.__provenance[collection][item.id] = {\n              origin_pack: layer.pack,\n              overridden: false\n            };\n          }\n        }\n\n        // Track items processed\n        perfCount(`merge.items.${collection}`, layer.data[collection].length);\n      });\n    }\n  }\n\n  // Enhanced token-level palette merging\n  if (layer.data.palettes) {\n    perfTime('merge.palettes', () => {\n      merged.palettes = merged.palettes || {};\n      // Initialize palette provenance if missing\n      if (!merged.__provenance.palettes) {\n        merged.__provenance.palettes = {};\n      }\n\n      for (const [paletteName, tokens] of Object.entries(layer.data.palettes)) {\n        if (typeof tokens === 'object' && !Array.isArray(tokens)) {\n          // Initialize palette if it doesn't exist\n          if (!merged.palettes[paletteName]) {\n            merged.palettes[paletteName] = {};\n            merged.__provenance.palettes[paletteName] = {\n              origin_pack: layer.pack,\n              tokens: {},\n              overridden: false\n            };\n          }\n\n          // Initialize token-level provenance tracking for this palette\n          if (!merged.__provenance.palettes[paletteName].tokens) {\n            merged.__provenance.palettes[paletteName].tokens = {};\n          }\n\n          // Process each token individually\n          for (const [tokenName, value] of Object.entries(tokens)) {\n            const tokenExisted = merged.palettes[paletteName][tokenName] !== undefined;\n            const previousValue = merged.palettes[paletteName][tokenName];\n\n            // Set the token value\n            merged.palettes[paletteName][tokenName] = value;\n\n            // Track token-level provenance\n            if (tokenExisted) {\n              // Token is being overridden\n              merged.__provenance.palettes[paletteName].tokens[tokenName] = {\n                origin_pack: merged.__provenance.palettes[paletteName].tokens[tokenName]?.origin_pack || 'unknown',\n                current_value: value,\n                previous_value: previousValue,\n                overridden: true,\n                override_pack: layer.pack,\n                override_history: [\n                  ...(merged.__provenance.palettes[paletteName].tokens[tokenName]?.override_history || []),\n                  {\n                    pack: layer.pack,\n                    value: value,\n                    timestamp: Date.now()\n                  }\n                ]\n              };\n            } else {\n              // New token\n              merged.__provenance.palettes[paletteName].tokens[tokenName] = {\n                origin_pack: layer.pack,\n                current_value: value,\n                overridden: false,\n                override_history: []\n              };\n            }\n          }\n\n          // Update palette-level provenance\n          if (merged.__provenance.palettes[paletteName].origin_pack !== layer.pack) {\n            merged.__provenance.palettes[paletteName].overridden = true;\n            merged.__provenance.palettes[paletteName].last_modified_by = layer.pack;\n          }\n        }\n      }\n\n      // Count processed palettes and tokens\n      let tokenCount = 0;\n      Object.values(layer.data.palettes).forEach(tokens => {\n        if (typeof tokens === 'object' && !Array.isArray(tokens)) {\n          tokenCount += Object.keys(tokens).length;\n        }\n      });\n\n      perfCount('merge.palette.tokens', tokenCount);\n      perfCount('merge.palettes', Object.keys(layer.data.palettes).length);\n    });\n  }\n\n  // Enhanced anchor processing with comprehensive provenance\n  if (layer.data.anchors) {\n    perfTime('merge.anchors', () => {\n      for (const [anchorId, coordinates] of Object.entries(layer.data.anchors)) {\n        const existed = anchorId in merged.anchors;\n        const previousCoordinates = merged.anchors[anchorId];\n\n        // Set the anchor coordinates\n        merged.anchors[anchorId] = coordinates;\n\n        // Determine origin type for this layer\n        const originType = determineAnchorOriginType(layer, anchorId);\n\n        if (existed) {\n          // Anchor is being overridden\n          const existingProvenance = merged.__provenance.anchors[anchorId];\n\n          merged.__provenance.anchors[anchorId] = {\n            origin_pack: existingProvenance?.origin_pack || 'unknown',\n            origin_type: existingProvenance?.origin_type || 'unknown',\n            coordinates: coordinates,\n            overridden: true,\n            override_source: layer.pack,\n            override_type: originType,\n            previous_coordinates: previousCoordinates,\n            override_history: [\n              ...(existingProvenance?.override_history || []),\n              {\n                pack: layer.pack,\n                type: originType,\n                coordinates: coordinates,\n                previous_coordinates: previousCoordinates,\n                timestamp: Date.now()\n              }\n            ]\n          };\n        } else {\n          // New anchor\n          merged.__provenance.anchors[anchorId] = {\n            origin_pack: layer.pack,\n            origin_type: originType,\n            coordinates: coordinates,\n            overridden: false,\n            override_history: []\n          };\n        }\n      }\n\n      perfCount('merge.anchors', Object.keys(layer.data.anchors).length);\n    });\n  }\n\n  // Process other top-level properties\n  if (layer.data.routing) {\n    merged.routing = { ...merged.routing, ...layer.data.routing };\n  }\n\n  if (layer.data.data_sources) {\n    merged.data_sources = { ...merged.data_sources, ...layer.data.data_sources };\n  }\n\n  // Process debug configuration\n  if (layer.data.debug) {\n    merged.debug = { ...merged.debug, ...layer.data.debug };\n\n    // Track debug config provenance\n    if (!merged.__provenance.debug) {\n      merged.__provenance.debug = {\n        origin_pack: layer.pack,\n        overridden: false\n      };\n    } else {\n      merged.__provenance.debug.overridden = true;\n      merged.__provenance.debug.override_layer = layer.pack;\n    }\n  }\n\n  if (Array.isArray(layer.data.active_profiles)) {\n    merged.active_profiles = [...layer.data.active_profiles];\n  }\n}\n\nfunction determineAnchorOriginType(layer, anchorId) {\n  // Determine the origin type based on layer characteristics\n  if (layer.type === 'builtin' || layer.type === 'external') {\n    // For builtin/external packs, check if this looks like an SVG-extracted anchor\n    if (layer.data._extracted_anchors && layer.data._extracted_anchors.includes(anchorId)) {\n      return 'svg';\n    }\n    return 'pack';\n  }\n\n  if (layer.type === 'user') {\n    // User-defined anchors\n    return 'user';\n  }\n\n  return 'unknown';\n}\n\nfunction applyRemovals(merged, removals) {\n  if (!removals || typeof removals !== 'object') return;\n\n  const collections = ['overlays', 'rules', 'animations', 'profiles', 'timelines'];\n\n  for (const collection of collections) {\n    const removeIds = removals[collection];\n    if (Array.isArray(removeIds)) {\n      for (const removeId of removeIds) {\n        const index = merged[collection].findIndex(item => item.id === removeId);\n        if (index >= 0) {\n          merged[collection].splice(index, 1);\n          merged.__provenance[collection][removeId] = {\n            ...(merged.__provenance[collection][removeId] || {}),\n            removed: true,\n            removal_source: 'global'\n          };\n        }\n      }\n    }\n  }\n}\n\n/**\n * Export collapsed user configuration\n */\nexport function exportCollapsed(userMsd) {\n  const out = {};\n  const keep = [\n    'version', 'use_packs', 'anchors', 'overlays', 'animations',\n    'rules', 'profiles', 'timelines', 'palettes', 'routing',\n    'active_profiles', 'remove', 'debug'\n  ];\n\n  keep.forEach(k => {\n    if (userMsd && userMsd[k] !== undefined) {\n      out[k] = userMsd[k];\n    }\n  });\n\n  return out;\n}\n\n// Attach debug helpers\ntry {\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.packs = window.__msdDebug.packs || {};\n    window.__msdDebug.packs.mergePacks = mergePacks;\n    window.__msdDebug.exportCollapsed = () => exportCollapsed(window.__msdDebug._hudUserMsdConfig || {});\n  }\n} catch (e) {\n  // Ignore in Node.js environments\n}\n","/**\n * MSD Configuration Validation - Following Ratified Schema V1\n * Validates merged configuration against schema requirements\n */\n\nexport function validateMerged(config) {\n  const issues = {\n    errors: [],\n    warnings: []\n  };\n\n  if (!config || typeof config !== 'object') {\n    issues.errors.push({\n      code: 'config.invalid',\n      message: 'Configuration must be an object'\n    });\n    return issues;\n  }\n\n  // Core validation functions\n  validateStructure(config, issues);\n  validateAnchors(config, issues);\n  validateOverlays(config, issues);\n  validateRules(config, issues);\n  validateAnimations(config, issues);\n  validateProfiles(config, issues);\n  validatePalettes(config, issues);\n  validateRouting(config, issues);\n  validateDuplicateIds(config, issues);\n\n  return issues;\n}\n\nfunction validateStructure(config, issues) {\n  // Version validation\n  if (!config.version) {\n    issues.warnings.push({\n      code: 'version.missing',\n      message: 'Missing version field - assuming version 1'\n    });\n  } else if (typeof config.version !== 'number' || config.version !== 1) {\n    issues.errors.push({\n      code: 'version.invalid',\n      message: 'Version must be 1 (only supported version)'\n    });\n  }\n\n  // View box validation\n  if (config.view_box !== undefined) {\n    const vb = config.view_box;\n    if (vb !== 'auto' && (!Array.isArray(vb) || vb.length !== 4 || !vb.every(n => typeof n === 'number'))) {\n      issues.errors.push({\n        code: 'view_box.invalid',\n        message: 'view_box must be \"auto\" or array of 4 numbers [x, y, width, height]'\n      });\n    }\n  }\n}\n\nfunction validateAnchors(config, issues) {\n  if (!config.anchors) return;\n\n  Object.entries(config.anchors).forEach(([anchorId, coordinates]) => {\n    if (!Array.isArray(coordinates) || coordinates.length !== 2) {\n      issues.errors.push({\n        code: 'anchor.coordinates.invalid',\n        anchor_id: anchorId,\n        message: `Anchor '${anchorId}' coordinates must be array of 2 elements [x, y]`\n      });\n      return;\n    }\n\n    coordinates.forEach((coord, index) => {\n      const axis = index === 0 ? 'x' : 'y';\n      if (typeof coord === 'string') {\n        // Percentage validation\n        if (!coord.endsWith('%') || isNaN(parseFloat(coord.slice(0, -1)))) {\n          issues.errors.push({\n            code: 'anchor.coordinates.invalid',\n            anchor_id: anchorId,\n            message: `Anchor '${anchorId}' ${axis}-coordinate '${coord}' must be number or percentage string`\n          });\n        }\n      } else if (typeof coord !== 'number') {\n        issues.errors.push({\n          code: 'anchor.coordinates.invalid',\n          anchor_id: anchorId,\n          message: `Anchor '${anchorId}' ${axis}-coordinate must be number or percentage string`\n        });\n      }\n    });\n  });\n}\n\nfunction validateOverlays(config, issues) {\n  if (!config.overlays) return;\n\n  const anchors = new Set(Object.keys(config.anchors || {}));\n\n  // Add overlay IDs as \"virtual anchors\" - any overlay can be an attachment target\n  config.overlays.forEach(overlay => {\n    if (overlay && overlay.id) {\n      anchors.add(overlay.id); // Make overlay IDs valid anchor targets\n    }\n  });\n\n  config.overlays.forEach(overlay => {\n    if (!overlay.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'overlays',\n        message: 'Overlay missing required id field'\n      });\n      return;\n    }\n\n    if (!overlay.type) {\n      issues.errors.push({\n        code: 'overlay.type.missing',\n        overlay_id: overlay.id,\n        message: `Overlay '${overlay.id}' missing required type field`\n      });\n    }\n\n    // Validate position/anchor references\n    ['anchor', 'attach_to'].forEach(field => {\n      if (overlay[field]) {\n        if (typeof overlay[field] === 'string' && !anchors.has(overlay[field])) {\n          issues.errors.push({\n            code: 'anchor.missing',\n            collection: 'overlays',\n            item_id: overlay.id,\n            anchor: overlay[field],\n            message: `Overlay '${overlay.id}' references missing anchor '${overlay[field]}'`\n          });\n        } else if (Array.isArray(overlay[field])) {\n          validateCoordinateArray(overlay[field], issues, `Overlay '${overlay.id}' ${field}`);\n        }\n      }\n    });\n\n    if (overlay.position && Array.isArray(overlay.position)) {\n      validateCoordinateArray(overlay.position, issues, `Overlay '${overlay.id}' position`);\n    }\n\n    // Validate animation references\n    if (overlay.animation_ref && config.animations) {\n      const animExists = config.animations.some(anim => anim.id === overlay.animation_ref);\n      if (!animExists) {\n        issues.errors.push({\n          code: 'animation.missing',\n          overlay_id: overlay.id,\n          animation_ref: overlay.animation_ref,\n          message: `Overlay '${overlay.id}' references missing animation '${overlay.animation_ref}'`\n        });\n      }\n    }\n  });\n}\n\nfunction validateRules(config, issues) {\n  if (!config.rules) return;\n\n  config.rules.forEach(rule => {\n    if (!rule.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'rules',\n        message: 'Rule missing required id field'\n      });\n      return;\n    }\n\n    if (!rule.when) {\n      issues.errors.push({\n        code: 'rule.when.missing',\n        rule_id: rule.id,\n        message: `Rule '${rule.id}' missing required when conditions`\n      });\n      return;\n    }\n\n    // Validate when conditions structure\n    const hasAll = Array.isArray(rule.when.all);\n    const hasAny = Array.isArray(rule.when.any);\n\n    if (!hasAll && !hasAny) {\n      issues.errors.push({\n        code: 'rule.when.invalid',\n        rule_id: rule.id,\n        message: `Rule '${rule.id}' when must have 'all' or 'any' array of conditions`\n      });\n    }\n\n    // Validate time_between format\n    [...(rule.when.all || []), ...(rule.when.any || [])].forEach(condition => {\n      if (condition.time_between) {\n        if (!/^\\d{2}:\\d{2}-\\d{2}:\\d{2}$/.test(condition.time_between)) {\n          issues.errors.push({\n            code: 'rule.time_between.invalid',\n            rule_id: rule.id,\n            message: `Rule '${rule.id}' time_between must be format \"HH:MM-HH:MM\"`\n          });\n        }\n      }\n\n      // Validate regex patterns\n      if (condition.regex) {\n        try {\n          new RegExp(condition.regex);\n        } catch (e) {\n          issues.warnings.push({\n            code: 'rule.regex.invalid',\n            rule_id: rule.id,\n            message: `Rule '${rule.id}' has invalid regex pattern - rule will be ignored`\n          });\n        }\n      }\n    });\n\n    // Validate priority\n    if (rule.priority !== undefined && (!Number.isInteger(rule.priority))) {\n      issues.errors.push({\n        code: 'rule.priority.invalid',\n        rule_id: rule.id,\n        message: `Rule '${rule.id}' priority must be an integer`\n      });\n    }\n  });\n}\n\nfunction validateAnimations(config, issues) {\n  if (!config.animations) return;\n\n  config.animations.forEach(animation => {\n    if (!animation.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'animations',\n        message: 'Animation missing required id field'\n      });\n      return;\n    }\n\n    if (!animation.preset) {\n      issues.errors.push({\n        code: 'animation.preset.missing',\n        animation_id: animation.id,\n        message: `Animation '${animation.id}' missing required preset field`\n      });\n    }\n\n    // Validate duration\n    if (animation.params?.duration && typeof animation.params.duration !== 'number') {\n      issues.errors.push({\n        code: 'animation.duration.invalid',\n        animation_id: animation.id,\n        message: `Animation '${animation.id}' duration must be a number (milliseconds)`\n      });\n    }\n  });\n}\n\nfunction validateProfiles(config, issues) {\n  if (!config.profiles) return;\n\n  config.profiles.forEach(profile => {\n    if (!profile.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'profiles',\n        message: 'Profile missing required id field'\n      });\n    }\n  });\n\n  // Validate active_profiles references\n  if (config.active_profiles) {\n    if (!Array.isArray(config.active_profiles)) {\n      issues.errors.push({\n        code: 'active_profiles.invalid',\n        message: 'active_profiles must be an array of profile IDs'\n      });\n    } else {\n      const profileIds = new Set((config.profiles || []).map(p => p.id));\n      config.active_profiles.forEach(profileId => {\n        if (!profileIds.has(profileId)) {\n          issues.warnings.push({\n            code: 'profile.missing',\n            profile_id: profileId,\n            message: `active_profiles references missing profile '${profileId}'`\n          });\n        }\n      });\n    }\n  }\n}\n\nfunction validatePalettes(config, issues) {\n  if (!config.palettes) return;\n\n  Object.entries(config.palettes).forEach(([paletteName, tokens]) => {\n    if (typeof tokens !== 'object' || Array.isArray(tokens)) {\n      issues.errors.push({\n        code: 'palette.tokens.invalid',\n        palette_name: paletteName,\n        message: `Palette '${paletteName}' tokens must be an object`\n      });\n    }\n  });\n}\n\nfunction validateRouting(config, issues) {\n  if (!config.routing) return;\n\n  const routing = config.routing;\n\n  // Validate clearance\n  if (routing.clearance !== undefined && typeof routing.clearance !== 'number') {\n    issues.errors.push({\n      code: 'routing.clearance.invalid',\n      message: 'routing.clearance must be a number'\n    });\n  }\n\n  // Validate grid_resolution\n  if (routing.grid_resolution !== undefined && typeof routing.grid_resolution !== 'number') {\n    issues.errors.push({\n      code: 'routing.grid_resolution.invalid',\n      message: 'routing.grid_resolution must be a number'\n    });\n  }\n\n  // Validate smoothing_mode\n  if (routing.smoothing_mode !== undefined) {\n    const validModes = ['none', 'chaikin'];\n    if (!validModes.includes(routing.smoothing_mode)) {\n      issues.warnings.push({\n        code: 'routing.smoothing_mode.invalid',\n        message: `routing.smoothing_mode '${routing.smoothing_mode}' invalid, using 'none'`\n      });\n    }\n  }\n}\n\nfunction validateDuplicateIds(config, issues) {\n  const collections = ['overlays', 'rules', 'animations', 'profiles', 'timelines'];\n\n  collections.forEach(collection => {\n    const items = config[collection] || [];\n    const seenIds = new Set();\n\n    items.forEach((item, index) => {\n      if (!item || !item.id) {\n        issues.errors.push({\n          code: 'id.missing',\n          collection,\n          index,\n          message: `Missing id in ${collection} item at index ${index}`\n        });\n        return;\n      }\n\n      if (seenIds.has(item.id)) {\n        issues.errors.push({\n          code: 'duplicate.id',\n          collection,\n          id: item.id,\n          message: `Duplicate ${collection} ID: ${item.id}`\n        });\n      } else {\n        seenIds.add(item.id);\n      }\n    });\n  });\n}\n\nfunction validateCoordinateArray(coords, issues, context) {\n  if (!Array.isArray(coords) || coords.length !== 2) {\n    issues.errors.push({\n      code: 'coordinates.invalid',\n      message: `${context} must be array of 2 elements [x, y]`\n    });\n    return;\n  }\n\n  coords.forEach((coord, index) => {\n    const axis = index === 0 ? 'x' : 'y';\n    if (typeof coord === 'string') {\n      if (!coord.endsWith('%') || isNaN(parseFloat(coord.slice(0, -1)))) {\n        issues.errors.push({\n          code: 'coordinates.invalid',\n          message: `${context} ${axis}-coordinate '${coord}' must be number or percentage string`\n        });\n      }\n    } else if (typeof coord !== 'number') {\n      issues.errors.push({\n        code: 'coordinates.invalid',\n        message: `${context} ${axis}-coordinate must be number or percentage string`\n      });\n    }\n  });\n}\n\n","/**\n * Enhanced Sparkline Renderer - Advanced sparkline rendering with comprehensive styling support\n * Provides rich sparkline styling features similar to LineOverlayRenderer and TextOverlayRenderer\n */\n\nimport { PositionResolver } from './PositionResolver.js';\nimport { RendererUtils } from './RendererUtils.js';\nimport { DataSourceMixin } from './DataSourceMixin.js';\n\nexport class SparklineRenderer {\n  constructor() {\n    // Pre-defined caches for performance optimization\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n    this.filterCache = new Map();\n    this.pathCache = new Map();\n  }\n\n  /**\n   * Render a sparkline overlay with comprehensive styling support\n   * @param {Object} overlay - Sparkline overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled sparkline\n   */\n  static render(overlay, anchors, viewBox) {\n    // Create instance for non-static methods\n    const instance = new SparklineRenderer();\n    return instance.renderSparkline(overlay, anchors, viewBox);\n  }\n\n  /**\n   * Instance method for comprehensive sparkline rendering\n   * @param {Object} overlay - Sparkline overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled sparkline\n   */\n  renderSparkline(overlay, anchors, viewBox) {\n\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) {\n      console.warn('[SparklineRenderer] Sparkline overlay position could not be resolved:', overlay.id);\n      return '';\n    }\n\n    const [x, y] = position;\n    const size = overlay.size || [200, 60];\n    const [width, height] = size;\n\n    try {\n      // Use unified DataSource access through DataSourceMixin\n      const dataResult = this._getHistoricalDataForSparkline(overlay.source);\n\n      // Extract comprehensive styling\n      const style = overlay.finalStyle || overlay.style || {};\n      const sparklineStyle = this._resolveSparklineStyles(style, overlay.id);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      console.log(`[SparklineRenderer] Data result for ${overlay.id}:`, dataResult.status, dataResult.data?.length);\n\n      if (dataResult.status === 'OK' && dataResult.data && dataResult.data.length >= 2) {\n        // Render real sparkline with advanced features\n        return this._renderEnhancedSparkline(\n          overlay, x, y, width, height, dataResult.data,\n          sparklineStyle, animationAttributes\n        );\n      } else {\n        // Render enhanced status indicator\n        return this._renderEnhancedStatusIndicator(\n          overlay, x, y, width, height, dataResult,\n          sparklineStyle, animationAttributes\n        );\n      }\n    } catch (error) {\n      console.error(`[SparklineRenderer] Enhanced rendering failed for sparkline ${overlay.id}:`, error);\n      return this._renderFallbackSparkline(overlay, x, y, width, height);\n    }\n  }\n\n  /**\n   * Instance method to get historical data using unified DataSource patterns\n   * @private\n   */\n  _getHistoricalDataForSparkline(dataSourceRef) {\n    return SparklineRenderer.getHistoricalDataForSparkline(dataSourceRef);\n  }\n\n  /**\n   * Resolve comprehensive sparkline styling from configuration\n   * @private\n   * @param {Object} style - Final resolved style object\n   * @param {string} overlayId - Overlay ID for unique identifiers\n   * @returns {Object} Complete sparkline style configuration\n   */\n  _resolveSparklineStyles(style, overlayId) {\n    const sparklineStyle = {\n      // Core line properties\n      color: style.color || style.stroke || 'var(--lcars-yellow)',\n      width: Number(style.width || style.stroke_width || style.strokeWidth || 2),\n      opacity: Number(style.opacity || 1),\n\n      // Advanced stroke styling\n      lineCap: (style.line_cap || style.lineCap || style.strokeLinecap || 'round').toLowerCase(),\n      lineJoin: (style.line_join || style.lineJoin || style.strokeLinejoin || 'round').toLowerCase(),\n      miterLimit: Number(style.miter_limit || style.miterLimit || 4),\n\n      // Dash patterns\n      dashArray: style.dash_array || style.dashArray || style.strokeDasharray || null,\n      dashOffset: Number(style.dash_offset || style.dashOffset || style.strokeDashoffset || 0),\n\n      // Path generation options\n      smoothing_mode: (style.smoothing_mode || style.smoothingMode || 'none').toLowerCase(),\n      interpolation: (style.interpolation || 'linear').toLowerCase(),\n      path_precision: Number(style.path_precision || style.pathPrecision || 2),\n\n      // Area fill properties\n      fill: style.fill || 'none',\n      fillOpacity: Number(style.fill_opacity || style.fillOpacity || 0.2),\n      fillGradient: this._parseGradientConfig(style.fill_gradient || style.fillGradient),\n\n      // Advanced styling\n      gradient: this._parseGradientConfig(style.gradient),\n      pattern: this._parsePatternConfig(style.pattern),\n\n      // Data visualization features\n      show_points: style.show_points || style.showPoints || false,\n      point_size: Number(style.point_size || style.pointSize || 3),\n      point_color: style.point_color || style.pointColor || null,\n      show_last_value: style.show_last_value || style.showLastValue || false,\n      value_format: style.value_format || style.valueFormat || null,\n\n      // Threshold and reference lines\n      thresholds: this._parseThresholds(style.thresholds),\n      zero_line: style.zero_line || style.zeroLine || false,\n      zero_line_color: style.zero_line_color || style.zeroLineColor || 'var(--lcars-gray)',\n\n      // Value range control\n      min_value: style.min_value !== undefined ? Number(style.min_value) : null,\n      max_value: style.max_value !== undefined ? Number(style.max_value) : null,\n      auto_scale: style.auto_scale !== false,\n\n      // Effects\n      glow: this._parseGlowConfig(style.glow),\n      shadow: this._parseShadowConfig(style.shadow),\n      blur: this._parseBlurConfig(style.blur),\n\n      // LCARS-specific features\n      bracket_style: style.bracket_style || style.bracketStyle || false,\n      bracket_width: Number(style.bracket_width || style.bracketWidth || 2), // Configurable bracket stroke width\n      bracket_color: style.bracket_color || style.bracketColor || null, // Separate bracket color\n      bracket_gap: Number(style.bracket_gap || style.bracketGap || 6), // Distance from sparkline\n      bracket_corner_radius: Number(style.bracket_corner_radius || style.bracketCornerRadius || 0),\n      bracket_style_mode: (style.bracket_style_mode || style.bracketStyleMode || 'square').toLowerCase(),\n\n      status_indicator: style.status_indicator || style.statusIndicator || false,\n      scan_line: style.scan_line || style.scanLine || false,\n\n      grid_lines: style.grid_lines || style.gridLines || false,\n      grid_color: style.grid_color || style.gridColor || 'var(--lcars-gray)',\n      grid_opacity: Number(style.grid_opacity || style.gridOpacity || 0.4), // Increased default opacity\n      grid_stroke_width: Number(style.grid_stroke_width || style.gridStrokeWidth || 1), // Configurable grid stroke width\n      grid_horizontal_count: Number(style.grid_horizontal_count || style.gridHorizontalCount || 3),\n      grid_vertical_count: Number(style.grid_vertical_count || style.gridVerticalCount || 5),\n\n      // Animation states (for future anime.js integration)\n      animatable: style.animatable !== false,\n      tracer_speed: Number(style.tracer_speed || style.tracerSpeed || 0),\n      pulse_speed: Number(style.pulse_speed || style.pulseSpeed || 0),\n\n      // Performance options\n      decimation: Number(style.decimation || 0), // 0 = no decimation\n      max_points: Number(style.max_points || style.maxPoints || 1000),\n\n      // Track enabled features for optimization\n      features: []\n    };\n\n    // Build feature list for conditional rendering\n    if (sparklineStyle.gradient) sparklineStyle.features.push('gradient');\n    if (sparklineStyle.pattern) sparklineStyle.features.push('pattern');\n    if (sparklineStyle.fill !== 'none') sparklineStyle.features.push('area-fill');\n    if (sparklineStyle.fillGradient) sparklineStyle.features.push('area-gradient');\n    if (sparklineStyle.show_points) sparklineStyle.features.push('data-points');\n    if (sparklineStyle.thresholds && sparklineStyle.thresholds.length > 0) sparklineStyle.features.push('thresholds');\n    if (sparklineStyle.zero_line) sparklineStyle.features.push('zero-line');\n    if (sparklineStyle.glow) sparklineStyle.features.push('glow');\n    if (sparklineStyle.shadow) sparklineStyle.features.push('shadow');\n    if (sparklineStyle.blur) sparklineStyle.features.push('blur');\n    if (sparklineStyle.bracket_style) sparklineStyle.features.push('brackets');\n    if (sparklineStyle.status_indicator) sparklineStyle.features.push('status');\n    if (sparklineStyle.scan_line) sparklineStyle.features.push('scan-line');\n    if (sparklineStyle.grid_lines) sparklineStyle.features.push('grid');\n    if (sparklineStyle.show_last_value) sparklineStyle.features.push('value-label');\n    if (sparklineStyle.smoothing_mode !== 'none') sparklineStyle.features.push('smoothing');\n    if (sparklineStyle.tracer_speed > 0) sparklineStyle.features.push('tracer');\n    if (sparklineStyle.pulse_speed > 0) sparklineStyle.features.push('pulse');\n\n    return sparklineStyle;\n  }\n\n  /**\n   * Render enhanced sparkline with all features\n   * @private\n   */\n  _renderEnhancedSparkline(overlay, x, y, width, height, data, sparklineStyle, animationAttributes) {\n    const svgParts = [\n      this._buildDefinitions(sparklineStyle, overlay.id),\n      this._buildSparklineBackground(width, height, sparklineStyle, overlay.id),\n      this._buildGridLines(width, height, sparklineStyle, overlay.id),\n      this._buildThresholdLines(data, width, height, sparklineStyle, overlay.id),\n      this._buildZeroLine(data, width, height, sparklineStyle, overlay.id),\n      this._buildAreaFill(data, width, height, sparklineStyle, overlay.id),\n      this._buildMainSparklinePath(data, width, height, sparklineStyle, overlay.id, animationAttributes),\n      this._buildDataPoints(data, width, height, sparklineStyle, overlay.id),\n      this._buildValueLabel(data, width, height, sparklineStyle, overlay.id),\n      this._buildBrackets(width, height, sparklineStyle, overlay.id),\n      this._buildStatusIndicator(width, height, sparklineStyle, overlay.id),\n      this._buildScanLine(width, height, sparklineStyle, overlay.id)\n    ].filter(Boolean);\n\n    console.log(`[SparklineRenderer] Rendered enhanced sparkline ${overlay.id} with ${sparklineStyle.features.length} features`);\n\n    return `<g data-overlay-id=\"${overlay.id}\"\n                data-overlay-type=\"sparkline\"\n                data-source=\"${overlay.source}\"\n                data-sparkline-features=\"${sparklineStyle.features.join(',')}\"\n                data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                transform=\"translate(${x}, ${y})\">\n              ${svgParts.join('\\n')}\n            </g>`;\n  }\n\n  /**\n   * Build SVG definitions for gradients, patterns, and effects\n   * @private\n   */\n  _buildDefinitions(sparklineStyle, overlayId) {\n    const defs = [];\n\n    // Line gradients\n    if (sparklineStyle.gradient) {\n      defs.push(RendererUtils.createGradientDefinition(sparklineStyle.gradient, `sparkline-gradient-${overlayId}`));\n    }\n\n    // Area fill gradients\n    if (sparklineStyle.fillGradient) {\n      defs.push(RendererUtils.createGradientDefinition(sparklineStyle.fillGradient, `sparkline-area-gradient-${overlayId}`));\n    }\n\n    // Patterns\n    if (sparklineStyle.pattern) {\n      defs.push(RendererUtils.createPatternDefinition(sparklineStyle.pattern, `sparkline-pattern-${overlayId}`));\n    }\n\n    // Effects (filters)\n    if (sparklineStyle.glow) {\n      defs.push(RendererUtils.createGlowFilter(sparklineStyle.glow, `sparkline-glow-${overlayId}`));\n    }\n\n    if (sparklineStyle.shadow) {\n      defs.push(RendererUtils.createShadowFilter(sparklineStyle.shadow, `sparkline-shadow-${overlayId}`));\n    }\n\n    if (sparklineStyle.blur) {\n      defs.push(RendererUtils.createBlurFilter(sparklineStyle.blur, `sparkline-blur-${overlayId}`));\n    }\n\n    return defs.length > 0 ? `<defs>${defs.join('\\n')}</defs>` : '';\n  }\n\n  /**\n   * Build background rectangle for contrast\n   * @private\n   */\n  _buildSparklineBackground(width, height, sparklineStyle, overlayId) {\n    // Only render background if explicitly configured\n    return '';\n  }\n\n  /**\n   * Build grid lines for technical appearance\n   * @private\n   */\n  _buildGridLines(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.grid_lines) return '';\n\n    const lines = [];\n\n    // Horizontal grid lines\n    for (let i = 1; i < sparklineStyle.grid_horizontal_count; i++) {\n      const y = (height / sparklineStyle.grid_horizontal_count) * i;\n      lines.push(`<line x1=\"0\" y1=\"${y}\" x2=\"${width}\" y2=\"${y}\"\n                        stroke=\"${sparklineStyle.grid_color}\"\n                        stroke-width=\"${sparklineStyle.grid_stroke_width}\"\n                        opacity=\"${sparklineStyle.grid_opacity}\"/>`);\n    }\n\n    // Vertical grid lines\n    for (let i = 1; i < sparklineStyle.grid_vertical_count; i++) {\n      const x = (width / sparklineStyle.grid_vertical_count) * i;\n      lines.push(`<line x1=\"${x}\" y1=\"0\" x2=\"${x}\" y2=\"${height}\"\n                        stroke=\"${sparklineStyle.grid_color}\"\n                        stroke-width=\"${sparklineStyle.grid_stroke_width}\"\n                        opacity=\"${sparklineStyle.grid_opacity}\"/>`);\n    }\n\n    return `<g data-feature=\"grid-lines\">${lines.join('\\n')}</g>`;\n  }\n\n  /**\n   * Build threshold reference lines\n   * @private\n   */\n  _buildThresholdLines(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.thresholds || sparklineStyle.thresholds.length === 0) return '';\n\n    const values = data.map(d => d.value);\n    const minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n    const maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n    const valueRange = maxValue - minValue || 1;\n\n    const thresholdLines = sparklineStyle.thresholds.map(threshold => {\n      const y = height - ((threshold.value - minValue) / valueRange) * height;\n      const color = threshold.color || 'var(--lcars-orange)';\n      const strokeWidth = threshold.width || 1;\n      const opacity = threshold.opacity || 0.7;\n      const dashArray = threshold.dash ? '4,2' : null;\n\n      return `<line x1=\"0\" y1=\"${y}\" x2=\"${width}\" y2=\"${y}\"\n                    stroke=\"${color}\" stroke-width=\"${strokeWidth}\" opacity=\"${opacity}\"\n                    ${dashArray ? `stroke-dasharray=\"${dashArray}\"` : ''}\n                    data-threshold=\"${threshold.value}\"/>`;\n    });\n\n    return `<g data-feature=\"threshold-lines\">${thresholdLines.join('\\n')}</g>`;\n  }\n\n  /**\n   * Build zero baseline reference\n   * @private\n   */\n  _buildZeroLine(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.zero_line) return '';\n\n    const values = data.map(d => d.value);\n    const minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n    const maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n\n    // Only show zero line if zero is within the data range\n    if (minValue > 0 || maxValue < 0) return '';\n\n    const valueRange = maxValue - minValue || 1;\n    const zeroY = height - ((0 - minValue) / valueRange) * height;\n\n    return `<line x1=\"0\" y1=\"${zeroY}\" x2=\"${width}\" y2=\"${zeroY}\"\n                  stroke=\"${sparklineStyle.zero_line_color}\" stroke-width=\"1\" opacity=\"0.5\"\n                  stroke-dasharray=\"2,2\"\n                  data-feature=\"zero-line\"/>`;\n  }\n\n  /**\n   * Build area fill under sparkline\n   * @private\n   */\n  _buildAreaFill(data, width, height, sparklineStyle, overlayId) {\n    if (sparklineStyle.fill === 'none' && !sparklineStyle.fillGradient) return '';\n\n    const processedData = this._processDataForRendering(data, sparklineStyle);\n    const pathData = this._createSparklinePath(processedData, { width, height }, sparklineStyle);\n\n    // Create area path by adding bottom edge\n    const areaPath = pathData + ` L ${width} ${height} L 0 ${height} Z`;\n\n    let fillColor = sparklineStyle.fill;\n    if (sparklineStyle.fillGradient) {\n      fillColor = `url(#sparkline-area-gradient-${overlayId})`;\n    } else if (fillColor === 'none') {\n      fillColor = sparklineStyle.color;\n    }\n\n    return `<path d=\"${areaPath}\"\n                  fill=\"${fillColor}\"\n                  fill-opacity=\"${sparklineStyle.fillOpacity}\"\n                  data-feature=\"area-fill\"/>`;\n  }\n\n  /**\n   * Build the main sparkline path with advanced styling\n   * @private\n   */\n  _buildMainSparklinePath(data, width, height, sparklineStyle, overlayId, animationAttributes) {\n    const processedData = this._processDataForRendering(data, sparklineStyle);\n    const pathData = this._createSparklinePath(processedData, { width, height }, sparklineStyle);\n\n    const attributes = [];\n\n    // Core path\n    attributes.push(`d=\"${pathData}\"`);\n    attributes.push(`fill=\"none\"`);\n\n    // Stroke styling\n    if (sparklineStyle.gradient) {\n      attributes.push(`stroke=\"url(#sparkline-gradient-${overlayId})\"`);\n    } else if (sparklineStyle.pattern) {\n      attributes.push(`stroke=\"url(#sparkline-pattern-${overlayId})\"`);\n    } else {\n      attributes.push(`stroke=\"${sparklineStyle.color}\"`);\n    }\n\n    attributes.push(`stroke-width=\"${sparklineStyle.width}\"`);\n    attributes.push(`stroke-opacity=\"${sparklineStyle.opacity}\"`);\n    attributes.push(`stroke-linecap=\"${sparklineStyle.lineCap}\"`);\n    attributes.push(`stroke-linejoin=\"${sparklineStyle.lineJoin}\"`);\n    attributes.push(`vector-effect=\"non-scaling-stroke\"`);\n\n    if (sparklineStyle.lineJoin === 'miter' && sparklineStyle.miterLimit !== 4) {\n      attributes.push(`stroke-miterlimit=\"${sparklineStyle.miterLimit}\"`);\n    }\n\n    if (sparklineStyle.dashArray) {\n      attributes.push(`stroke-dasharray=\"${sparklineStyle.dashArray}\"`);\n      if (sparklineStyle.dashOffset !== 0) {\n        attributes.push(`stroke-dashoffset=\"${sparklineStyle.dashOffset}\"`);\n      }\n    }\n\n    // Effects\n    const filters = [];\n    if (sparklineStyle.glow) filters.push(`url(#sparkline-glow-${overlayId})`);\n    if (sparklineStyle.shadow) filters.push(`url(#sparkline-shadow-${overlayId})`);\n    if (sparklineStyle.blur) filters.push(`url(#sparkline-blur-${overlayId})`);\n    if (filters.length > 0) {\n      attributes.push(`filter=\"${filters.join(' ')}\"`);\n    }\n\n    // Animation attributes\n    attributes.push(...animationAttributes.pathAttributes);\n\n    return `<path ${attributes.join(' ')} data-feature=\"main-path\"/>`;\n  }\n\n  /**\n   * Build data point markers\n   * @private\n   */\n  _buildDataPoints(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.show_points) return '';\n\n    const processedData = this._processDataForRendering(data, sparklineStyle);\n    const points = this._calculateDataPointPositions(processedData, { width, height }, sparklineStyle);\n\n    const pointColor = sparklineStyle.point_color || sparklineStyle.color;\n    const pointSize = sparklineStyle.point_size;\n\n    const pointElements = points.map((point, index) => {\n      return `<circle cx=\"${point.x.toFixed(sparklineStyle.path_precision)}\"\n                      cy=\"${point.y.toFixed(sparklineStyle.path_precision)}\"\n                      r=\"${pointSize}\"\n                      fill=\"${pointColor}\"\n                      opacity=\"${sparklineStyle.opacity}\"\n                      data-value=\"${point.value}\"\n                      data-timestamp=\"${point.timestamp}\"/>`;\n    });\n\n    return `<g data-feature=\"data-points\">${pointElements.join('\\n')}</g>`;\n  }\n\n  /**\n   * Build last value label\n   * @private\n   */\n  _buildValueLabel(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.show_last_value || data.length === 0) return '';\n\n    const lastValue = data[data.length - 1].value;\n    const formattedValue = sparklineStyle.value_format ?\n      this._formatValue(lastValue, sparklineStyle.value_format) :\n      lastValue.toFixed(1);\n\n    const fontSize = Math.min(width / 10, height / 3, 12);\n    const labelX = width + 4;\n    const labelY = height / 2;\n\n    return `<text x=\"${labelX}\" y=\"${labelY}\"\n                  fill=\"${sparklineStyle.color}\"\n                  font-size=\"${fontSize}\"\n                  text-anchor=\"start\"\n                  dominant-baseline=\"middle\"\n                  font-family=\"var(--lcars-font-family, monospace)\"\n                  data-feature=\"value-label\">\n              ${formattedValue}\n            </text>`;\n  }\n\n  /**\n   * Build LCARS-style brackets with proper orientation and corner styling\n   * @private\n   */\n  _buildBrackets(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.bracket_style) return '';\n\n    const bracketColor = sparklineStyle.bracket_color || sparklineStyle.color;\n    const strokeWidth = sparklineStyle.bracket_width;\n\n    let gap = sparklineStyle.bracket_gap;\n    if (sparklineStyle.smoothing_mode !== 'none') {\n      gap = Math.max(gap, 12);\n    }\n\n    const cornerRadius = sparklineStyle.bracket_corner_radius;\n    const styleMode = sparklineStyle.bracket_style_mode;\n\n    let leftBracketPath, rightBracketPath;\n    if (styleMode === 'rounded' && cornerRadius > 0) {\n      leftBracketPath = this._buildRoundedBracketPath('left', gap, height, cornerRadius);\n      rightBracketPath = this._buildRoundedBracketPath('right', width, gap, height, cornerRadius);\n    } else if (styleMode === 'lcars') {\n      leftBracketPath = this._buildLcarsBracketPath('left', gap, height);\n      rightBracketPath = this._buildLcarsBracketPath('right', width, gap, height);\n    } else {\n      leftBracketPath = this._buildSquareBracketPath('left', gap, height);\n      rightBracketPath = this._buildSquareBracketPath('right', width, gap, height);\n    }\n\n    return `<g data-feature=\"brackets\">\n              <path d=\"${leftBracketPath}\" stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n              <path d=\"${rightBracketPath}\" stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n            </g>`;\n  }\n\n  /**\n   * Build square corner bracket path\n   * @private\n   */\n  _buildSquareBracketPath(side, gapOrWidth, gapOrHeight, height) {\n    if (side === 'left') {\n      const gap = gapOrWidth;\n      const h = gapOrHeight;\n      return `M ${-gap - 4} 0 L ${-gap - 4} ${h} M ${-gap - 4} 0 L ${-gap/2} 0 M ${-gap - 4} ${h} L ${-gap/2} ${h}`;\n    } else {\n      const width = gapOrWidth;\n      const gap = gapOrHeight;\n      const h = height;\n      return `M ${width + gap/2} 0 L ${width + gap + 4} 0 M ${width + gap + 4} 0 L ${width + gap + 4} ${h} M ${width + gap/2} ${h} L ${width + gap + 4} ${h}`;\n    }\n  }\n\n  /**\n   * Build rounded corner bracket path\n   * @private\n   */\n  _buildRoundedBracketPath(side, gapOrWidth, gapOrHeight, heightOrRadius, radiusOrHeight) {\n    if (side === 'left') {\n      const gap = gapOrWidth;\n      const h = gapOrHeight;\n      const radius = heightOrRadius;\n      const minRadius = Math.min(radius, gap/4, h/6);\n      return `M ${-gap - 4} ${minRadius}\n              A ${minRadius} ${minRadius} 0 0 1 ${-gap - 4 + minRadius} 0\n              L ${-gap/2} 0\n              M ${-gap - 4} ${h - minRadius}\n              A ${minRadius} ${minRadius} 0 0 0 ${-gap - 4 + minRadius} ${h}\n              L ${-gap/2} ${h}\n              M ${-gap - 4} ${minRadius}\n              L ${-gap - 4} ${h - minRadius}`;\n    } else {\n      const width = gapOrWidth;\n      const gap = gapOrHeight;\n      const h = heightOrRadius;\n      const radius = radiusOrHeight;\n      const minRadius = Math.min(radius, gap/4, h/6);\n      return `M ${width + gap/2} 0\n              L ${width + gap + 4 - minRadius} 0\n              A ${minRadius} ${minRadius} 0 0 1 ${width + gap + 4} ${minRadius}\n              M ${width + gap/2} ${h}\n              L ${width + gap + 4 - minRadius} ${h}\n              A ${minRadius} ${minRadius} 0 0 0 ${width + gap + 4} ${h - minRadius}\n              M ${width + gap + 4} ${minRadius}\n              L ${width + gap + 4} ${h - minRadius}`;\n    }\n  }\n\n  /**\n   * Build LCARS-style bracket path with characteristic corner cuts\n   * @private\n   */\n  _buildLcarsBracketPath(side, gapOrWidth, gapOrHeight, height) {\n    if (side === 'left') {\n      const gap = gapOrWidth;\n      const h = gapOrHeight;\n      const cutSize = Math.min(4, gap/4, h/10);\n      return `M ${-gap - 4} ${cutSize}\n              L ${-gap - 4 + cutSize} 0\n              L ${-gap/2} 0\n              M ${-gap - 4} ${h - cutSize}\n              L ${-gap - 4 + cutSize} ${h}\n              L ${-gap/2} ${h}\n              M ${-gap - 4} ${cutSize}\n              L ${-gap - 4} ${h - cutSize}`;\n    } else {\n      const width = gapOrWidth;\n      const gap = gapOrHeight;\n      const h = height;\n      const cutSize = Math.min(4, gap/4, h/10);\n      return `M ${width + gap/2} 0\n              L ${width + gap + 4 - cutSize} 0\n              L ${width + gap + 4} ${cutSize}\n              M ${width + gap/2} ${h}\n              L ${width + gap + 4 - cutSize} ${h}\n              L ${width + gap + 4} ${h - cutSize}\n              M ${width + gap + 4} ${cutSize}\n              L ${width + gap + 4} ${h - cutSize}`;\n    }\n  }\n\n  /**\n   * Build status indicator\n   * @private\n   */\n  _buildStatusIndicator(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.status_indicator) return '';\n\n    const indicatorSize = 4;\n    const indicatorColor = typeof sparklineStyle.status_indicator === 'string' ?\n      sparklineStyle.status_indicator : 'var(--lcars-green)';\n\n    return `<circle cx=\"${-indicatorSize - 4}\" cy=\"${height / 2}\" r=\"${indicatorSize}\"\n                    fill=\"${indicatorColor}\"\n                    data-feature=\"status-indicator\"/>`;\n  }\n\n  /**\n   * Build scan line animation element\n   * @private\n   */\n  _buildScanLine(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.scan_line) return '';\n\n    return `<line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"${height}\"\n                  stroke=\"${sparklineStyle.color}\" stroke-width=\"1\" opacity=\"0.8\"\n                  data-feature=\"scan-line\"\n                  data-scan-speed=\"${sparklineStyle.tracer_speed || 2}\">\n              <animate attributeName=\"x1\" values=\"0;${width};0\" dur=\"3s\" repeatCount=\"indefinite\"/>\n              <animate attributeName=\"x2\" values=\"0;${width};0\" dur=\"3s\" repeatCount=\"indefinite\"/>\n            </line>`;\n  }\n\n  /**\n   * Create enhanced sparkline path with smoothing options\n   * @private\n   */\n  _createSparklinePath(data, bounds, sparklineStyle) {\n    if (!data || data.length < 2) {\n      return `M 0 ${bounds.height / 2} L ${bounds.width} ${bounds.height / 2}`;\n    }\n\n    const { width, height } = bounds;\n    const points = this._calculateDataPointPositions(data, bounds, sparklineStyle);\n\n    // Apply smoothing based on mode with proper width normalization\n    let path;\n    switch (sparklineStyle.smoothing_mode) {\n      case 'chaikin':\n        path = this._createChaikinPath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'constrained':\n        path = this._createConstrainedSmoothPath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'bezier':\n        path = this._createBezierPath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'spline':\n        path = this._createSplinePath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'stepped':\n        path = this._createSteppedPath(points, sparklineStyle.path_precision);\n        break;\n      default:\n        path = this._createLinearPath(points, sparklineStyle.path_precision);\n        break;\n    }\n\n    return path;\n  }\n\n  /**\n   * Calculate data point positions with scaling\n   * @private\n   */\n  _calculateDataPointPositions(data, bounds, sparklineStyle) {\n    const { width, height } = bounds;\n\n    // Find value range\n    const values = data.map(d => d.value);\n    let minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n    let maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n\n    // Handle edge cases\n    if (minValue === maxValue) {\n      minValue -= 0.5;\n      maxValue += 0.5;\n    }\n\n    const valueRange = maxValue - minValue;\n\n    return data.map((point, index) => ({\n      x: (index / (data.length - 1)) * width,\n      y: height - ((point.value - minValue) / valueRange) * height,\n      value: point.value,\n      timestamp: point.timestamp\n    }));\n  }\n\n  /**\n   * Create linear path (default)\n   * @private\n   */\n  _createLinearPath(points, precision) {\n    const pathSegments = [];\n\n    points.forEach((point, index) => {\n      const x = point.x.toFixed(precision);\n      const y = point.y.toFixed(precision);\n\n      if (index === 0) {\n        pathSegments.push(`M ${x} ${y}`);\n      } else {\n        pathSegments.push(`L ${x} ${y}`);\n      }\n    });\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Create stepped path\n   * @private\n   */\n  _createSteppedPath(points, precision) {\n    const pathSegments = [];\n\n    points.forEach((point, index) => {\n      const x = point.x.toFixed(precision);\n      const y = point.y.toFixed(precision);\n\n      if (index === 0) {\n        pathSegments.push(`M ${x} ${y}`);\n      } else {\n        const prevY = points[index - 1].y.toFixed(precision);\n        pathSegments.push(`L ${x} ${prevY}`);\n        pathSegments.push(`L ${x} ${y}`);\n      }\n    });\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Create Chaikin smoothed path with width normalization\n   * @private\n   */\n  _createChaikinPath(points, precision, targetWidth) {\n    if (points.length < 3) return this._createLinearPath(points, precision);\n\n    // Chaikin subdivision algorithm\n    let smoothedPoints = [...points];\n\n    // Apply Chaikin subdivision iterations\n    for (let iteration = 0; iteration < 2; iteration++) {\n      const newPoints = [];\n\n      for (let i = 0; i < smoothedPoints.length - 1; i++) {\n        const p1 = smoothedPoints[i];\n        const p2 = smoothedPoints[i + 1];\n\n        // Quarter point\n        newPoints.push({\n          x: p1.x * 0.75 + p2.x * 0.25,\n          y: p1.y * 0.75 + p2.y * 0.25\n        });\n\n        // Three-quarter point\n        newPoints.push({\n          x: p1.x * 0.25 + p2.x * 0.75,\n          y: p1.y * 0.25 + p2.y * 0.75\n        });\n      }\n\n      smoothedPoints = newPoints;\n    }\n\n    // Normalize X coordinates to span full width\n    if (smoothedPoints.length > 1) {\n      const minX = Math.min(...smoothedPoints.map(p => p.x));\n      const maxX = Math.max(...smoothedPoints.map(p => p.x));\n      const currentWidth = maxX - minX;\n\n      if (currentWidth > 0) {\n        smoothedPoints = smoothedPoints.map(point => ({\n          x: ((point.x - minX) / currentWidth) * targetWidth,\n          y: point.y\n        }));\n      }\n    }\n\n    return this._createLinearPath(smoothedPoints, precision);\n  }\n\n  /**\n   * Create Bezier curved path with width normalization\n   * @private\n   */\n  _createBezierPath(points, precision, targetWidth) {\n    if (points.length < 3) return this._createLinearPath(points, precision);\n\n    const pathSegments = [`M ${points[0].x.toFixed(precision)} ${points[0].y.toFixed(precision)}`];\n\n    for (let i = 1; i < points.length - 1; i++) {\n      const p0 = points[i - 1];\n      const p1 = points[i];\n      const p2 = points[i + 1];\n\n      // Control points for smooth curve\n      const cp1x = p0.x + (p1.x - p0.x) * 0.5;\n      const cp1y = p0.y + (p1.y - p0.y) * 0.5;\n      const cp2x = p1.x - (p2.x - p1.x) * 0.5;\n      const cp2y = p1.y - (p2.y - p1.y) * 0.5;\n\n      pathSegments.push(`Q ${cp1x.toFixed(precision)} ${cp1y.toFixed(precision)} ${p1.x.toFixed(precision)} ${p1.y.toFixed(precision)}`);\n    }\n\n    // Final point\n    const lastPoint = points[points.length - 1];\n    pathSegments.push(`L ${lastPoint.x.toFixed(precision)} ${lastPoint.y.toFixed(precision)}`);\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Create spline path with width normalization\n   * @private\n   */\n  _createSplinePath(points, precision, targetWidth) {\n    if (points.length < 4) return this._createBezierPath(points, precision, targetWidth);\n\n    // Generate spline points\n    const splinePoints = [];\n\n    // Start with first point\n    splinePoints.push(points[0]);\n\n    // Generate intermediate spline points\n    for (let i = 1; i < points.length - 2; i++) {\n      const p0 = points[i - 1];\n      const p1 = points[i];\n      const p2 = points[i + 1];\n      const p3 = points[i + 2];\n\n      // Catmull-Rom spline - generate multiple points along the curve\n      const segments = 10; // Number of segments between each pair of points\n      for (let t = 0; t <= segments; t++) {\n        const u = t / segments;\n        const u2 = u * u;\n        const u3 = u2 * u;\n\n        // Catmull-Rom basis functions\n        const f1 = -0.5 * u3 + u2 - 0.5 * u;\n        const f2 = 1.5 * u3 - 2.5 * u2 + 1;\n        const f3 = -1.5 * u3 + 2 * u2 + 0.5 * u;\n        const f4 = 0.5 * u3 - 0.5 * u2;\n\n        const x = f1 * p0.x + f2 * p1.x + f3 * p2.x + f4 * p3.x;\n        const y = f1 * p0.y + f2 * p1.y + f3 * p2.y + f4 * p3.y;\n\n        splinePoints.push({ x, y });\n      }\n    }\n\n    // Add final point\n    splinePoints.push(points[points.length - 1]);\n\n    // Normalize X coordinates to span full width\n    if (splinePoints.length > 1) {\n      const minX = Math.min(...splinePoints.map(p => p.x));\n      const maxX = Math.max(...splinePoints.map(p => p.x));\n      const currentWidth = maxX - minX;\n\n      if (currentWidth > 0) {\n        splinePoints.forEach(point => {\n          point.x = ((point.x - minX) / currentWidth) * targetWidth;\n        });\n      }\n    }\n\n    return this._createLinearPath(splinePoints, precision);\n  }\n\n  /**\n   * Create constrained smooth path that passes through all data points\n   * @private\n   */\n  _createConstrainedSmoothPath(points, precision, targetWidth) {\n    if (points.length < 3) return this._createLinearPath(points, precision);\n\n    const pathSegments = [];\n\n    // Start at first point\n    pathSegments.push(`M ${points[0].x.toFixed(precision)} ${points[0].y.toFixed(precision)}`);\n\n    // Create smooth curves between each pair of points\n    for (let i = 0; i < points.length - 1; i++) {\n      const current = points[i];\n      const next = points[i + 1];\n\n      // Calculate control points for smooth curve\n      let cp1x, cp1y, cp2x, cp2y;\n\n      if (i === 0) {\n        // First segment - use next point for direction\n        const next2 = points[i + 2] || next;\n        cp1x = current.x + (next.x - current.x) * 0.3;\n        cp1y = current.y + (next.y - current.y) * 0.2;\n        cp2x = next.x - (next2.x - current.x) * 0.2;\n        cp2y = next.y - (next2.y - current.y) * 0.1;\n      } else if (i === points.length - 2) {\n        // Last segment - use previous point for direction\n        const prev = points[i - 1];\n        cp1x = current.x + (next.x - prev.x) * 0.2;\n        cp1y = current.y + (next.y - prev.y) * 0.1;\n        cp2x = next.x - (next.x - current.x) * 0.3;\n        cp2y = next.y - (next.y - current.y) * 0.2;\n      } else {\n        // Middle segments - use surrounding points for smooth direction\n        const prev = points[i - 1];\n        const next2 = points[i + 2];\n\n        const prevSlope = {\n          x: next.x - prev.x,\n          y: next.y - prev.y\n        };\n        const nextSlope = {\n          x: next2.x - current.x,\n          y: next2.y - current.y\n        };\n\n        // Smooth the transition\n        cp1x = current.x + prevSlope.x * 0.25;\n        cp1y = current.y + prevSlope.y * 0.15;\n        cp2x = next.x - nextSlope.x * 0.25;\n        cp2y = next.y - nextSlope.y * 0.15;\n      }\n\n      // Clamp control points to reasonable bounds\n      cp1x = Math.max(current.x, Math.min(next.x, cp1x));\n      cp2x = Math.max(current.x, Math.min(next.x, cp2x));\n\n      pathSegments.push(`C ${cp1x.toFixed(precision)} ${cp1y.toFixed(precision)} ${cp2x.toFixed(precision)} ${cp2y.toFixed(precision)} ${next.x.toFixed(precision)} ${next.y.toFixed(precision)}`);\n    }\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Process data for rendering (decimation, filtering)\n   * @private\n   */\n  _processDataForRendering(data, sparklineStyle) {\n    let processedData = [...data];\n\n    // Apply decimation if needed\n    if (sparklineStyle.decimation > 0 && processedData.length > sparklineStyle.decimation) {\n      const step = Math.floor(processedData.length / sparklineStyle.decimation);\n      processedData = processedData.filter((_, index) => index % step === 0);\n\n      // Always include the last point\n      if (processedData[processedData.length - 1] !== data[data.length - 1]) {\n        processedData.push(data[data.length - 1]);\n      }\n    }\n\n    // Apply max_points limit\n    if (sparklineStyle.max_points > 0 && processedData.length > sparklineStyle.max_points) {\n      const step = Math.floor(processedData.length / sparklineStyle.max_points);\n      processedData = processedData.filter((_, index) => index % step === 0);\n\n      // Always include the last point\n      if (processedData[processedData.length - 1] !== data[data.length - 1]) {\n        processedData.push(data[data.length - 1]);\n      }\n    }\n\n    return processedData;\n  }\n\n  /**\n   * Render enhanced status indicator\n   * @private\n   */\n  _renderEnhancedStatusIndicator(overlay, x, y, width, height, dataResult, sparklineStyle, animationAttributes) {\n    const statusColors = {\n      'NO_SOURCE': 'var(--lcars-red)',\n      'MANAGER_NOT_AVAILABLE': 'var(--lcars-blue)',\n      'SOURCE_NOT_FOUND': 'var(--lcars-orange)',\n      'NO_BUFFER': 'var(--lcars-orange)',\n      'EMPTY_BUFFER': 'var(--lcars-blue)',\n      'INSUFFICIENT_DATA': 'var(--lcars-blue)',\n      'ERROR': 'var(--lcars-red)'\n    };\n\n    const statusMessages = {\n      'NO_SOURCE': 'NO SOURCE',\n      'MANAGER_NOT_AVAILABLE': 'LOADING',\n      'SOURCE_NOT_FOUND': 'NOT FOUND',\n      'NO_BUFFER': 'NO BUFFER',\n      'EMPTY_BUFFER': 'NO DATA',\n      'INSUFFICIENT_DATA': 'LOADING',\n      'ERROR': 'ERROR'\n    };\n\n    const indicatorColor = statusColors[dataResult.status] || sparklineStyle.color;\n    const indicatorText = statusMessages[dataResult.status] || 'UNKNOWN';\n    const fontSize = Math.min(width / 8, height / 3, 14);\n\n    // Enhanced status with LCARS styling\n    const loadingStates = ['MANAGER_NOT_AVAILABLE', 'INSUFFICIENT_DATA'];\n    const isLoading = loadingStates.includes(dataResult.status);\n\n    const animationProps = isLoading ? `\n      <animate attributeName=\"opacity\" values=\"0.3;1.0;0.3\" dur=\"1s\" repeatCount=\"indefinite\"/>\n    ` : `\n      <animate attributeName=\"opacity\" values=\"0.3;0.8;0.3\" dur=\"2s\" repeatCount=\"indefinite\"/>\n    `;\n\n    const svgParts = [\n      this._buildDefinitions(sparklineStyle, overlay.id),\n      sparklineStyle.bracket_style ? this._buildBrackets(width, height, { ...sparklineStyle, color: indicatorColor }, overlay.id) : '',\n      `<rect width=\"${width}\" height=\"${height}\"\n             fill=\"none\" stroke=\"${indicatorColor}\" stroke-width=\"2\"\n             stroke-dasharray=\"${isLoading ? '4,2' : '8,4'}\" opacity=\"0.6\">\n        ${animationProps}\n       </rect>`,\n      `<text x=\"${width / 2}\" y=\"${height / 2}\"\n             fill=\"${indicatorColor}\" text-anchor=\"middle\" dominant-baseline=\"middle\"\n             font-family=\"var(--lcars-font-family, monospace)\"\n             font-size=\"${fontSize}\" font-weight=\"bold\">\n        ${indicatorText}\n       </text>`,\n      width > 120 ? `<text x=\"${width / 2}\" y=\"${height / 2 + fontSize + 4}\"\n                           fill=\"${indicatorColor}\" text-anchor=\"middle\" dominant-baseline=\"middle\"\n                           font-family=\"var(--lcars-font-family, monospace)\"\n                           font-size=\"${Math.max(8, fontSize * 0.6)}\" opacity=\"0.7\">\n                      ${overlay.source || 'NO SOURCE ID'}\n                     </text>` : ''\n    ].filter(Boolean);\n\n    return `<g data-overlay-id=\"${overlay.id}\"\n                data-overlay-type=\"sparkline\"\n                data-source=\"${overlay.source || 'unknown'}\"\n                data-status=\"${dataResult.status}\"\n                data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                transform=\"translate(${x}, ${y})\">\n              ${svgParts.join('\\n')}\n            </g>`;\n  }\n\n  /**\n   * Parse various configuration formats\n   * @private\n   */\n  _parseGradientConfig(gradientConfig) {\n    return RendererUtils.parseGradientConfig(gradientConfig);\n  }\n\n  _parsePatternConfig(patternConfig) {\n    return RendererUtils.parsePatternConfig(patternConfig);\n  }\n\n  _parseGlowConfig(glowConfig) {\n    return RendererUtils.parseGlowConfig(glowConfig);\n  }\n\n  _parseShadowConfig(shadowConfig) {\n    return RendererUtils.parseShadowConfig(shadowConfig);\n  }\n\n  _parseBlurConfig(blurConfig) {\n    return RendererUtils.parseBlurConfig(blurConfig);\n  }\n\n  /**\n   * Parse threshold configuration\n   * @private\n   */\n  _parseThresholds(thresholds) {\n    if (!thresholds || !Array.isArray(thresholds)) return [];\n\n    return thresholds.map(threshold => ({\n      value: Number(threshold.value || threshold),\n      color: threshold.color || 'var(--lcars-orange)',\n      width: Number(threshold.width || 1),\n      opacity: Number(threshold.opacity || 0.7),\n      dash: threshold.dash || false,\n      label: threshold.label || null\n    }));\n  }\n\n  /**\n   * Format value for display\n   * @private\n   */\n  _formatValue(value, format) {\n    if (typeof format === 'function') {\n      return format(value);\n    }\n\n    if (typeof format === 'string') {\n      return format.replace('{value}', value.toFixed(1));\n    }\n\n    return value.toFixed(1);\n  }\n\n  /**\n   * Prepare animation attributes for future anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    const animationAttributes = {\n      pathAttributes: [],\n      hasAnimations: false\n    };\n\n    // Animation hooks for future implementation\n    if (style.animatable !== false) {\n      animationAttributes.pathAttributes.push(`data-animatable=\"true\"`);\n    }\n\n    if (style.tracer_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-tracer-speed=\"${style.tracer_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.pulse_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-pulse-speed=\"${style.pulse_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Render simple fallback sparkline\n   * @private\n   */\n  _renderFallbackSparkline(overlay, x, y, width, height) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const color = style.color || 'var(--lcars-yellow)';\n    const strokeWidth = style.width || 2;\n\n    console.warn(`[SparklineRenderer] Using fallback rendering for sparkline ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"sparkline\" data-fallback=\"true\">\n              <g transform=\"translate(${x}, ${y})\">\n                <path d=\"M 0 ${height / 2} L ${width} ${height / 2}\"\n                      fill=\"none\" stroke=\"${color}\" stroke-width=\"${strokeWidth}\"\n                      vector-effect=\"non-scaling-stroke\"/>\n              </g>\n            </g>`;\n  }\n\n  // === EXISTING DATA SOURCE METHODS (PRESERVED FROM ORIGINAL) ===\n\n  /**\n   * Get historical data with multiple fallback strategies and DataSource enhancement support\n   * @param {string} dataSourceRef - Data source reference (source_name or source_name.data_key)\n   * @returns {Object} {data: Array|null, status: string, message: string, metadata: Object}\n   */\n  static getHistoricalDataForSparkline(dataSourceRef) {\n    if (!dataSourceRef) {\n      return {\n        data: null,\n        status: 'NO_SOURCE',\n        message: 'No data source specified',\n        metadata: {}\n      };\n    }\n\n    try {\n      // Parse data source reference for enhanced data access\n      const { sourceName, dataKey, isTransformation, isAggregation } = SparklineRenderer.parseDataSourceReference(dataSourceRef);\n\n      const dataSourceManager = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n\n      if (dataSourceManager) {\n        console.log(`[SparklineRenderer]  Checking DataSourceManager for '${sourceName}' with data key: '${dataKey}'`);\n\n        const dataSource = dataSourceManager.getSource(sourceName);\n\n        if (dataSource) {\n          const currentData = dataSource.getCurrentData();\n          console.log(`[SparklineRenderer] Source data for '${sourceName}':`, {\n            bufferSize: currentData?.bufferSize || 0,\n            historyReady: currentData?.historyReady,\n            started: currentData?.started,\n            historyLoaded: currentData?.stats?.historyLoaded || 0,\n            hasTransformations: Object.keys(currentData?.transformations || {}).length,\n            hasAggregations: Object.keys(currentData?.aggregations || {}).length,\n            requestedDataKey: dataKey\n          });\n\n          // NEW: Support for enhanced data access\n          if (dataKey && (isTransformation || isAggregation)) {\n            return SparklineRenderer.getEnhancedDataSourceData(currentData, dataKey, isTransformation, isAggregation, sourceName);\n          }\n\n          // Original buffer-based data access\n          if (currentData?.buffer) {\n            const bufferData = currentData.buffer.getAll();\n            console.log(`[SparklineRenderer] Raw buffer data for '${sourceName}':`, bufferData);\n\n            if (bufferData && bufferData.length >= 2) {\n              const historicalData = bufferData.map(point => ({\n                timestamp: point.t,\n                value: point.v\n              }));\n\n              console.log(`[SparklineRenderer]  Found ${historicalData.length} data points for '${sourceName}'`);\n              return {\n                data: historicalData,\n                status: 'OK',\n                message: `${historicalData.length} data points`,\n                metadata: {\n                  sourceName,\n                  dataType: 'raw',\n                  transformations: currentData.transformations,\n                  aggregations: currentData.aggregations\n                }\n              };\n            } else if (bufferData && bufferData.length === 1) {\n              console.log(`[SparklineRenderer]  Only 1 data point available for '${sourceName}'`);\n              return {\n                data: null,\n                status: 'INSUFFICIENT_DATA',\n                message: 'Only 1 data point available (need 2+ for sparkline)',\n                metadata: { sourceName, dataType: 'raw' }\n              };\n            } else {\n              console.log(`[SparklineRenderer]  Buffer exists but is empty for '${sourceName}'`);\n              return {\n                data: null,\n                status: 'EMPTY_BUFFER',\n                message: 'Buffer exists but contains no data',\n                metadata: { sourceName, dataType: 'raw' }\n              };\n            }\n          }\n\n          console.log(`[SparklineRenderer]  Data source '${sourceName}' found but no buffer`);\n          return {\n            data: null,\n            status: 'NO_BUFFER',\n            message: 'Data source found but no buffer available',\n            metadata: { sourceName }\n          };\n        }\n\n        const availableSources = Array.from(dataSourceManager.sources.keys());\n        console.warn(`[SparklineRenderer]  Source '${sourceName}' not found in DataSourceManager`);\n        return {\n          data: null,\n          status: 'SOURCE_NOT_FOUND',\n          message: `Source '${sourceName}' not found. Available: ${availableSources.join(', ')}`,\n          metadata: { requestedSource: sourceName, availableSources }\n        };\n      }\n\n      return {\n        data: null,\n        status: 'MANAGER_NOT_AVAILABLE',\n        message: 'DataSourceManager not available',\n        metadata: {}\n      };\n\n    } catch (error) {\n      console.error(`[SparklineRenderer] Error getting data for '${dataSourceRef}':`, error);\n      return {\n        data: null,\n        status: 'ERROR',\n        message: `Error occurred: ${error.message}`,\n        metadata: { error: error.message }\n      };\n    }\n  }\n\n  /**\n   * Update sparkline data dynamically when data source changes with enhanced synchronization\n   * @param {Element} sparklineElement - The sparkline SVG element\n   * @param {Object} overlay - Overlay configuration\n   * @param {Object} sourceData - New data from the data source\n   */\n  static updateSparklineData(sparklineElement, overlay, sourceData) {\n    console.log(`[SparklineRenderer] updateSparklineData called for ${overlay.id}:`, {\n      hasBuffer: !!(sourceData?.buffer),\n      bufferSize: sourceData?.buffer?.size?.() || 0,\n      currentStatus: sparklineElement.getAttribute('data-status'),\n      elementFound: !!sparklineElement,\n      currentValue: sourceData?.v\n    });\n\n    if (!sparklineElement || !overlay || !sourceData) {\n      console.warn('[SparklineRenderer] updateSparklineData: Missing required parameters');\n      return;\n    }\n\n    // Create instance for update operations\n    const instance = new SparklineRenderer();\n    instance._updateSparklineElementSynchronized(sparklineElement, overlay, sourceData);\n  }\n\n  /**\n   * Enhanced synchronized update method that ensures markers and lines stay in sync\n   * @private\n   */\n  _updateSparklineElementSynchronized(sparklineElement, overlay, sourceData) {\n    const currentStatus = sparklineElement.getAttribute('data-status');\n    const isStatusIndicator = currentStatus !== null;\n\n    // If status indicator and data is now available, upgrade\n    if (isStatusIndicator && (sourceData.buffer || sourceData.historicalData)) {\n      this._upgradeStatusIndicatorToSparkline(sparklineElement, overlay, sourceData);\n      return;\n    }\n\n    // Extract current historical data\n    const historicalData = this._extractHistoricalData(sourceData);\n\n    if (historicalData.length < 2) {\n      console.warn(`[SparklineRenderer] Insufficient data for sparkline ${overlay.id}: ${historicalData.length} points`);\n      sparklineElement.setAttribute('data-status', historicalData.length === 0 ? 'NO_DATA' : 'INSUFFICIENT_DATA');\n      return;\n    }\n\n    try {\n      // Extract dimensions from overlay config\n      const bounds = {\n        width: overlay.size?.[0] || 200,\n        height: overlay.size?.[1] || 60\n      };\n\n      // Re-resolve styles for consistency\n      const style = overlay.finalStyle || overlay.style || {};\n      const sparklineStyle = this._resolveSparklineStyles(style, overlay.id);\n\n      // SYNCHRONIZED UPDATE: Update both path and markers together\n      this._updateSparklinePathAndMarkers(sparklineElement, historicalData, bounds, sparklineStyle, overlay.id);\n\n      // Update other features that might depend on data\n      this._updateSparklineFeatures(sparklineElement, historicalData, bounds, sparklineStyle, overlay.id);\n\n      // Update status attributes\n      sparklineElement.removeAttribute('data-status');\n      sparklineElement.setAttribute('data-last-update', Date.now());\n\n      console.log(`[SparklineRenderer]  Synchronized update for sparkline ${overlay.id} with ${historicalData.length} points`);\n\n    } catch (error) {\n      console.error(`[SparklineRenderer] Error in synchronized update for ${overlay.id}:`, error);\n      sparklineElement.setAttribute('data-status', 'ERROR');\n    }\n  }\n\n  /**\n   * Update both path and markers simultaneously to ensure synchronization\n   * @private\n   */\n  _updateSparklinePathAndMarkers(sparklineElement, historicalData, bounds, sparklineStyle, overlayId) {\n    // Generate processed data once\n    const processedData = this._processDataForRendering(historicalData, sparklineStyle);\n\n    // Update main path\n    const pathElement = sparklineElement.querySelector('path[data-feature=\"main-path\"]');\n    if (pathElement) {\n      const newPathData = this._createSparklinePath(processedData, bounds, sparklineStyle);\n      pathElement.setAttribute('d', newPathData);\n    }\n\n    // Update data points markers if they exist\n    const dataPointsGroup = sparklineElement.querySelector('g[data-feature=\"data-points\"]');\n    if (dataPointsGroup && sparklineStyle.show_points) {\n      const points = this._calculateDataPointPositions(processedData, bounds, sparklineStyle);\n      const pointElements = dataPointsGroup.querySelectorAll('circle');\n\n      // Update existing points or create new ones\n      points.forEach((point, index) => {\n        let pointElement = pointElements[index];\n        if (!pointElement) {\n          pointElement = document.createElementNS('http://www.w3.org/2000/svg', 'circle');\n          dataPointsGroup.appendChild(pointElement);\n        }\n\n        pointElement.setAttribute('cx', point.x.toFixed(sparklineStyle.path_precision));\n        pointElement.setAttribute('cy', point.y.toFixed(sparklineStyle.path_precision));\n        pointElement.setAttribute('r', sparklineStyle.point_size);\n        pointElement.setAttribute('data-value', point.value);\n        pointElement.setAttribute('data-timestamp', point.timestamp);\n      });\n\n      // Remove excess point elements\n      for (let i = points.length; i < pointElements.length; i++) {\n        pointElements[i].remove();\n      }\n    }\n\n    // Update area fill if it exists\n    const areaElement = sparklineElement.querySelector('path[data-feature=\"area-fill\"]');\n    if (areaElement && (sparklineStyle.fill !== 'none' || sparklineStyle.fillGradient)) {\n      const pathData = this._createSparklinePath(processedData, bounds, sparklineStyle);\n      const areaPath = pathData + ` L ${bounds.width} ${bounds.height} L 0 ${bounds.height} Z`;\n      areaElement.setAttribute('d', areaPath);\n    }\n  }\n\n  /**\n   * Update other sparkline features that might depend on data\n   * @private\n   */\n  _updateSparklineFeatures(sparklineElement, historicalData, bounds, sparklineStyle, overlayId) {\n    // Update value label if it exists\n    const valueLabelElement = sparklineElement.querySelector('text[data-feature=\"value-label\"]');\n    if (valueLabelElement && sparklineStyle.show_last_value && historicalData.length > 0) {\n      const lastValue = historicalData[historicalData.length - 1].value;\n      const formattedValue = sparklineStyle.value_format ?\n        this._formatValue(lastValue, sparklineStyle.value_format) :\n        lastValue.toFixed(1);\n      valueLabelElement.textContent = formattedValue;\n    }\n\n    // Update threshold lines if data range changed significantly\n    const thresholdGroup = sparklineElement.querySelector('g[data-feature=\"threshold-lines\"]');\n    if (thresholdGroup && sparklineStyle.thresholds && sparklineStyle.thresholds.length > 0) {\n      // Recalculate threshold positions based on new data range\n      const values = historicalData.map(d => d.value);\n      const minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n      const maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n      const valueRange = maxValue - minValue || 1;\n\n      sparklineStyle.thresholds.forEach((threshold, index) => {\n        const thresholdLine = thresholdGroup.children[index];\n        if (thresholdLine) {\n          const y = bounds.height - ((threshold.value - minValue) / valueRange) * bounds.height;\n          thresholdLine.setAttribute('y1', y);\n          thresholdLine.setAttribute('y2', y);\n        }\n      });\n    }\n\n    // Update zero line if it exists and data range changed\n    const zeroLineElement = sparklineElement.querySelector('line[data-feature=\"zero-line\"]');\n    if (zeroLineElement && sparklineStyle.zero_line) {\n      const values = historicalData.map(d => d.value);\n      const minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n      const maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n\n      if (minValue <= 0 && maxValue >= 0) {\n        const valueRange = maxValue - minValue || 1;\n        const zeroY = bounds.height - ((0 - minValue) / valueRange) * bounds.height;\n        zeroLineElement.setAttribute('y1', zeroY);\n        zeroLineElement.setAttribute('y2', zeroY);\n        zeroLineElement.style.display = '';\n      } else {\n        zeroLineElement.style.display = 'none';\n      }\n    }\n  }\n\n  /**\n   * Extract historical data from various source data formats\n   * @private\n   */\n  _upgradeStatusIndicatorToSparkline(sparklineElement, overlay, sourceData) {\n    const historicalData = this._extractHistoricalData(sourceData);\n\n    if (historicalData.length > 1) {\n      const size = overlay.size || [200, 60];\n      const [width, height] = size;\n      const style = overlay.finalStyle || overlay.style || {};\n      const sparklineStyle = this._resolveSparklineStyles(style, overlay.id);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      // Generate complete enhanced sparkline with ALL features\n      const svgParts = [\n        this._buildDefinitions(sparklineStyle, overlay.id),\n        this._buildSparklineBackground(width, height, sparklineStyle, overlay.id),\n        this._buildGridLines(width, height, sparklineStyle, overlay.id),\n        this._buildThresholdLines(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildZeroLine(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildAreaFill(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildMainSparklinePath(historicalData, width, height, sparklineStyle, overlay.id, animationAttributes),\n        this._buildDataPoints(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildValueLabel(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildBrackets(width, height, sparklineStyle, overlay.id),\n        this._buildStatusIndicator(width, height, sparklineStyle, overlay.id),\n        this._buildScanLine(width, height, sparklineStyle, overlay.id)\n      ].filter(Boolean);\n\n      // Replace entire innerHTML with complete sparkline content\n      sparklineElement.innerHTML = svgParts.join('\\n');\n\n      sparklineElement.removeAttribute('data-status');\n      sparklineElement.setAttribute('data-last-update', Date.now());\n      sparklineElement.setAttribute('data-sparkline-features', sparklineStyle.features.join(','));\n\n      console.log(`[SparklineRenderer]  Upgraded status indicator ${overlay.id} to full sparkline with ${sparklineStyle.features.length} features and ${historicalData.length} data points`);\n    } else {\n      sparklineElement.setAttribute('data-status', historicalData.length === 0 ? 'NO_DATA' : 'INSUFFICIENT_DATA');\n    }\n  }\n\n  /**\n   * Extract historical data from various source data formats\n   * @private\n   */\n  _extractHistoricalData(sourceData) {\n    let historicalData = [];\n\n    // Method 1: Use buffer data directly\n    if (sourceData.buffer && typeof sourceData.buffer.getAll === 'function') {\n      const bufferData = sourceData.buffer.getAll();\n      historicalData = bufferData.map(point => ({\n        timestamp: point.t,\n        value: point.v\n      }));\n      console.log('[SparklineRenderer] Using buffer data:', historicalData.length, 'points');\n    }\n    // Method 2: Use pre-formatted historical data\n    else if (sourceData.historicalData && Array.isArray(sourceData.historicalData)) {\n      historicalData = sourceData.historicalData;\n      console.log('[SparklineRenderer] Using pre-formatted historical data:', historicalData.length, 'points');\n    }\n    // Method 3: Generate from single current value (fallback for testing)\n    else if (sourceData.v !== undefined && sourceData.t !== undefined) {\n      console.log('[SparklineRenderer] Generating demo data from current value:', sourceData.v);\n      const now = Date.now();\n      for (let i = 0; i < 20; i++) {\n        historicalData.push({\n          timestamp: now - (19 - i) * 60000,\n          value: sourceData.v + (Math.random() - 0.5) * (sourceData.v * 0.1)\n        });\n      }\n    }\n\n    return historicalData;\n  }\n\n  /**\n   * Get rendering capabilities and features supported\n   * @public\n   */\n  getCapabilities() {\n    return {\n      pathSmoothing: ['none', 'constrained', 'chaikin', 'bezier', 'spline', 'stepped'],\n      dataVisualization: ['points', 'thresholds', 'zero-line', 'value-labels'],\n      styling: ['gradients', 'patterns', 'area-fill', 'dash-patterns'],\n      effects: ['glow', 'shadow', 'blur'],\n      lcarsFeatures: ['brackets', 'status-indicator', 'scan-line', 'grid-lines'],\n      animations: ['tracer', 'pulse'], // Future implementation\n      performance: ['decimation', 'max-points', 'viewport-optimization'],\n      advanced: true\n    };\n  }\n\n  // === DEBUG METHODS (PRESERVED FROM ORIGINAL) ===\n\n  /**\n   * Parse DataSource reference to support enhanced data access\n   * @param {string} dataSourceRef - Reference like 'source_name' or 'source_name.transformations.key'\n   * @returns {Object} Parsed reference details\n   */\n  static parseDataSourceReference(dataSourceRef) {\n    const parts = dataSourceRef.split('.');\n    const sourceName = parts[0];\n\n    if (parts.length === 1) {\n      // Simple source reference\n      return {\n        sourceName,\n        dataKey: null,\n        isTransformation: false,\n        isAggregation: false\n      };\n    }\n\n    if (parts.length >= 3) {\n      // Enhanced reference: source.transformations.key or source.aggregations.key\n      const dataType = parts[1];\n      const dataKey = parts.slice(2).join('.');\n\n      return {\n        sourceName,\n        dataKey,\n        isTransformation: dataType === 'transformations',\n        isAggregation: dataType === 'aggregations'\n      };\n    }\n\n    // Fallback for malformed references\n    return {\n      sourceName,\n      dataKey: null,\n      isTransformation: false,\n      isAggregation: false\n    };\n  }\n\n  /**\n   * Get enhanced DataSource data (transformations/aggregations) for sparklines\n   * @param {Object} currentData - Current data from DataSource\n   * @param {string} dataKey - Key for transformation or aggregation\n   * @param {boolean} isTransformation - Whether accessing transformation data\n   * @param {boolean} isAggregation - Whether accessing aggregation data\n   * @param {string} sourceName - Source name for logging\n   * @returns {Object} Data result for sparkline rendering\n   */\n  static getEnhancedDataSourceData(currentData, dataKey, isTransformation, isAggregation, sourceName) {\n    try {\n      let enhancedValue = null;\n      let dataType = 'unknown';\n\n      if (isTransformation && currentData.transformations) {\n        enhancedValue = currentData.transformations[dataKey];\n        dataType = 'transformation';\n        console.log(`[SparklineRenderer]  Accessing transformation '${dataKey}':`, enhancedValue);\n      } else if (isAggregation && currentData.aggregations) {\n        const aggregationData = currentData.aggregations[dataKey];\n        dataType = 'aggregation';\n\n        // Handle different aggregation result types\n        if (typeof aggregationData === 'object' && aggregationData !== null) {\n          // Complex aggregation (e.g., min/max/avg object, trend object)\n          if (aggregationData.avg !== undefined) {\n            enhancedValue = aggregationData.avg;\n          } else if (aggregationData.value !== undefined) {\n            enhancedValue = aggregationData.value;\n          } else if (aggregationData.slope !== undefined) {\n            enhancedValue = aggregationData.slope;\n          } else {\n            // Use the whole object - sparkline might handle it\n            enhancedValue = aggregationData;\n          }\n        } else {\n          // Simple aggregation value\n          enhancedValue = aggregationData;\n        }\n\n        console.log(`[SparklineRenderer]  Accessing aggregation '${dataKey}':`, aggregationData, '-> value:', enhancedValue);\n      }\n\n      if (enhancedValue === null || enhancedValue === undefined) {\n        return {\n          data: null,\n          status: 'ENHANCED_DATA_NOT_FOUND',\n          message: `${dataType} '${dataKey}' not found or has no data`,\n          metadata: {\n            sourceName,\n            dataKey,\n            dataType,\n            availableTransformations: Object.keys(currentData.transformations || {}),\n            availableAggregations: Object.keys(currentData.aggregations || {})\n          }\n        };\n      }\n\n      // For single values, generate synthetic historical data\n      if (typeof enhancedValue === 'number') {\n        return SparklineRenderer.generateSyntheticHistoricalData(enhancedValue, currentData, sourceName, dataKey, dataType);\n      }\n\n      // For complex objects, try to extract meaningful data\n      if (typeof enhancedValue === 'object') {\n        return SparklineRenderer.extractHistoricalFromObject(enhancedValue, currentData, sourceName, dataKey, dataType);\n      }\n\n      // Fallback for non-numeric data\n      return {\n        data: null,\n        status: 'ENHANCED_DATA_NOT_NUMERIC',\n        message: `${dataType} '${dataKey}' is not numeric: ${typeof enhancedValue}`,\n        metadata: { sourceName, dataKey, dataType, value: enhancedValue }\n      };\n\n    } catch (error) {\n      console.error(`[SparklineRenderer] Error accessing enhanced data:`, error);\n      return {\n        data: null,\n        status: 'ENHANCED_DATA_ERROR',\n        message: `Error accessing ${isTransformation ? 'transformation' : 'aggregation'} '${dataKey}': ${error.message}`,\n        metadata: { sourceName, dataKey, error: error.message }\n      };\n    }\n  }\n\n  /**\n   * Generate synthetic historical data for single enhanced values\n   * @param {number} currentValue - Current transformed/aggregated value\n   * @param {Object} currentData - Full DataSource data\n   * @param {string} sourceName - Source name\n   * @param {string} dataKey - Data key\n   * @param {string} dataType - Type of data (transformation/aggregation)\n   * @returns {Object} Data result with synthetic history\n   */\n  static generateSyntheticHistoricalData(currentValue, currentData, sourceName, dataKey, dataType) {\n    const historicalData = [];\n    const now = Date.now();\n\n    // Use buffer data if available for better synthetic generation\n    if (currentData.buffer) {\n      const bufferData = currentData.buffer.getAll();\n\n      if (bufferData.length > 1) {\n        // Apply transformation/aggregation logic to each historical point\n        bufferData.forEach(point => {\n          // This is a simplified approach - in reality, transformations should be applied to each point\n          // For now, we'll generate reasonable synthetic data based on the raw values\n          let syntheticValue = currentValue;\n\n          if (dataType === 'transformation') {\n            // Estimate transformation based on ratio to current raw value\n            const ratio = currentData.v ? currentValue / currentData.v : 1;\n            syntheticValue = point.v * ratio;\n          } else if (dataType === 'aggregation') {\n            // For aggregations, use a sliding calculation or approximation\n            syntheticValue = currentValue + (Math.random() - 0.5) * (currentValue * 0.1);\n          }\n\n          historicalData.push({\n            timestamp: point.t,\n            value: syntheticValue\n          });\n        });\n\n        console.log(`[SparklineRenderer]  Generated ${historicalData.length} synthetic ${dataType} points for '${dataKey}'`);\n        return {\n          data: historicalData,\n          status: 'OK_SYNTHETIC',\n          message: `${historicalData.length} synthetic ${dataType} points`,\n          metadata: {\n            sourceName,\n            dataKey,\n            dataType,\n            synthetic: true,\n            currentValue,\n            basedOnRawData: true\n          }\n        };\n      }\n    }\n\n    // Fallback: Generate simple synthetic data\n    for (let i = 19; i >= 0; i--) {\n      const timestamp = now - i * 30000; // 30-second intervals\n      const variance = (Math.random() - 0.5) * (currentValue * 0.05); // 5% variance\n      historicalData.push({\n        timestamp,\n        value: currentValue + variance\n      });\n    }\n\n    console.log(`[SparklineRenderer]  Generated ${historicalData.length} fallback synthetic ${dataType} points for '${dataKey}'`);\n    return {\n      data: historicalData,\n      status: 'OK_SYNTHETIC_FALLBACK',\n      message: `${historicalData.length} fallback synthetic ${dataType} points`,\n      metadata: {\n        sourceName,\n        dataKey,\n        dataType,\n        synthetic: true,\n        currentValue,\n        basedOnRawData: false\n      }\n    };\n  }\n\n  /**\n   * Extract historical data from complex aggregation objects\n   * @param {Object} aggregationObject - Complex aggregation result\n   * @param {Object} currentData - Full DataSource data\n   * @param {string} sourceName - Source name\n   * @param {string} dataKey - Data key\n   * @param {string} dataType - Type of data\n   * @returns {Object} Data result\n   */\n  static extractHistoricalFromObject(aggregationObject, currentData, sourceName, dataKey, dataType) {\n    // Handle trend objects\n    if (aggregationObject.direction && aggregationObject.slope !== undefined) {\n      return SparklineRenderer.generateSyntheticHistoricalData(\n        aggregationObject.slope,\n        currentData,\n        sourceName,\n        `${dataKey}.slope`,\n        'trend-slope'\n      );\n    }\n\n    // Handle min/max/avg objects\n    if (aggregationObject.avg !== undefined) {\n      return SparklineRenderer.generateSyntheticHistoricalData(\n        aggregationObject.avg,\n        currentData,\n        sourceName,\n        `${dataKey}.avg`,\n        'stats-average'\n      );\n    }\n\n    // Handle session stats objects\n    if (aggregationObject.count !== undefined && aggregationObject.last !== undefined) {\n      return SparklineRenderer.generateSyntheticHistoricalData(\n        aggregationObject.last,\n        currentData,\n        sourceName,\n        `${dataKey}.last`,\n        'session-last'\n      );\n    }\n\n    // Fallback for unknown object types\n    console.warn(`[SparklineRenderer] Unknown aggregation object structure for '${dataKey}':`, aggregationObject);\n    return {\n      data: null,\n      status: 'ENHANCED_OBJECT_UNKNOWN',\n      message: `Unknown aggregation object structure for '${dataKey}'`,\n      metadata: { sourceName, dataKey, dataType, objectKeys: Object.keys(aggregationObject) }\n    };\n  }\n\n  static debugSparklineUpdates() {\n    console.log(' Enhanced Sparkline Update Debug Report');\n    console.log('==========================================');\n\n    const dsm = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n    if (dsm) {\n      const stats = dsm.getStats();\n      console.log('DataSourceManager stats:', stats);\n    } else {\n      console.warn('DataSourceManager not accessible via debug interface');\n    }\n  }\n\n  static debugDataSource(dataSourceName) {\n    console.log(` Enhanced Debugging data source: ${dataSourceName}`);\n    console.log('====================================================');\n\n    const dsm = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n    if (!dsm) {\n      console.error(' DataSourceManager not available');\n      return;\n    }\n\n    const source = dsm.getSource(dataSourceName);\n    if (!source) {\n      console.error(` Source '${dataSourceName}' not found`);\n      console.log('Available sources:', Array.from(dsm.sources.keys()));\n      return;\n    }\n\n    // Detailed analysis as before...\n    return { source };\n  }\n}\n\n// Expose SparklineRenderer to window for console debugging\nif (typeof window !== 'undefined') {\n  window.SparklineRenderer = SparklineRenderer;\n}","/**\n * Line Overlay Renderer - Advanced line rendering with comprehensive styling support\n * Leverages RouterCore's sophisticated path computation and adds rich visual features\n */\n\nimport { PositionResolver } from './PositionResolver.js';\n\nexport class LineOverlayRenderer {\n  constructor(routerCore) {\n    this.routerCore = routerCore;\n\n    // Pre-defined marker templates for performance\n    this.markerCache = new Map();\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n\n    this.textAttachmentPoints = new Map();\n  }\n\n  setTextAttachmentPoints(map) {\n    this.textAttachmentPoints = map || new Map();\n  }\n\n  /**\n   * Render a line overlay with full styling support\n   * @param {Object} overlay - Line overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions for routing\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled line\n   */\n  render(overlay, anchors, viewBox) {\n    if (!this.routerCore) {\n      console.error('[LineOverlayRenderer] RouterCore not available for line rendering');\n      return '';\n    }\n\n    let anchor1 = PositionResolver.resolvePosition(overlay.anchor, anchors);\n    let anchor2 = PositionResolver.resolvePosition(overlay.attach_to, anchors);\n\n    // If attach_to not an anchor but matches a text overlay id we have attachment points\n    let attachMeta = null;\n    if (!anchor2 && overlay.attach_to && this.textAttachmentPoints.has(overlay.attach_to)) {\n      attachMeta = this.textAttachmentPoints.get(overlay.attach_to);\n      // Compute smart attachment point\n      anchor2 = this._computeTextAttachPoint(anchor1, attachMeta, overlay);\n    }\n\n    if (!anchor1 || !anchor2) {\n      console.warn(`[LineOverlayRenderer] Line ${overlay.id} missing anchor points`);\n      return '';\n    }\n\n    try {\n      // Get the computed path from RouterCore (includes all smart routing)\n      const routeRequest = this.routerCore.buildRouteRequest(overlay, anchor1, anchor2);\n      const pathResult = this.routerCore.computePath(routeRequest);\n\n      if (!pathResult?.d) {\n        console.warn(`[LineOverlayRenderer] No path computed for line ${overlay.id}`);\n        return '';\n      }\n\n      // Extract comprehensive styling\n      const style = overlay.finalStyle || overlay.style || {};\n      const lineStyle = this._resolveLineStyles(style, overlay.id);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      // Build SVG group with all features\n      const svgParts = [\n        this._buildDefinitions(lineStyle, overlay.id),\n        this._buildMainPath(pathResult.d, lineStyle, overlay.id, animationAttributes),\n        this._buildMarkers(pathResult, lineStyle, overlay.id),\n        this._buildEffects(pathResult, lineStyle, overlay.id)\n      ].filter(Boolean);\n\n      console.log(`[LineOverlayRenderer] Rendered enhanced line ${overlay.id} with ${lineStyle.features.length} features`);\n\n      return `<g data-overlay-id=\"${overlay.id}\"\n                  data-overlay-type=\"line\"\n                  data-routing-strategy=\"${pathResult.meta?.strategy || 'unknown'}\"\n                  data-animation-ready=\"${!!animationAttributes.hasAnimations}\">\n                ${svgParts.join('\\n')}\n              </g>`;\n\n    } catch (error) {\n      console.error(`[LineOverlayRenderer] Enhanced rendering failed for line ${overlay.id}:`, error);\n      return this._renderFallbackLine(overlay, anchor1, anchor2);\n    }\n  }\n\n  /**\n   * Resolve comprehensive line styling from configuration\n   * @private\n   * @param {Object} style - Final resolved style object\n   * @param {string} overlayId - Overlay ID for unique identifiers\n   * @returns {Object} Complete line style configuration\n   */\n  _resolveLineStyles(style, overlayId) {\n    const lineStyle = {\n      // Core stroke properties\n      color: style.color || style.stroke || 'var(--lcars-orange)',\n      width: Number(style.width || style.stroke_width || style.strokeWidth || 2),\n      opacity: Number(style.opacity || 1),\n\n      // Advanced stroke styling\n      lineCap: (style.line_cap || style.lineCap || style.strokeLinecap || 'round').toLowerCase(),\n      lineJoin: (style.line_join || style.lineJoin || style.strokeLinejoin || 'round').toLowerCase(),\n      miterLimit: Number(style.miter_limit || style.miterLimit || 4),\n\n      // Dash patterns\n      dashArray: style.dash_array || style.dashArray || style.strokeDasharray || null,\n      dashOffset: Number(style.dash_offset || style.dashOffset || style.strokeDashoffset || 0),\n\n      // Fill properties (for thick lines or special effects)\n      fill: style.fill || 'none',\n      fillOpacity: Number(style.fill_opacity || style.fillOpacity || 1),\n\n      // Gradient and pattern support\n      gradient: this._parseGradientConfig(style.gradient),\n      pattern: this._parsePatternConfig(style.pattern),\n\n      // Markers (arrowheads, dots, etc.)\n      markerStart: this._parseMarkerConfig(style.marker_start || style.markerStart),\n      markerMid: this._parseMarkerConfig(style.marker_mid || style.markerMid),\n      markerEnd: this._parseMarkerConfig(style.marker_end || style.markerEnd),\n\n      // Effects\n      glow: this._parseGlowConfig(style.glow),\n      shadow: this._parseShadowConfig(style.shadow),\n\n      // Animation states (for future anime.js integration)\n      animatable: style.animatable !== false,\n      pulseSpeed: Number(style.pulse_speed || 0),\n      flowSpeed: Number(style.flow_speed || 0),\n\n      // LCARS-specific features\n      segment_colors: this._parseSegmentColors(style.segment_colors),\n      status_indicator: style.status_indicator || null,\n\n      // Track enabled features for optimization\n      features: []\n    };\n\n    // Build feature list for conditional rendering\n    if (lineStyle.gradient) lineStyle.features.push('gradient');\n    if (lineStyle.pattern) lineStyle.features.push('pattern');\n    if (lineStyle.markerStart || lineStyle.markerMid || lineStyle.markerEnd) lineStyle.features.push('markers');\n    if (lineStyle.glow) lineStyle.features.push('glow');\n    if (lineStyle.shadow) lineStyle.features.push('shadow');\n    if (lineStyle.segment_colors) lineStyle.features.push('segments');\n    if (lineStyle.pulseSpeed > 0) lineStyle.features.push('pulse');\n    if (lineStyle.flowSpeed > 0) lineStyle.features.push('flow');\n\n    return lineStyle;\n  }\n\n  /**\n   * Parse gradient configuration\n   * @private\n   */\n  _parseGradientConfig(gradientConfig) {\n    if (!gradientConfig) return null;\n\n    if (typeof gradientConfig === 'string') {\n      // Simple gradient: \"red-to-blue\" or \"#ff0000-to-#0000ff\"\n      const match = gradientConfig.match(/^(.+?)-to-(.+)$/);\n      if (match) {\n        return {\n          type: 'linear',\n          direction: 'horizontal',\n          stops: [\n            { offset: '0%', color: match[1].trim() },\n            { offset: '100%', color: match[2].trim() }\n          ]\n        };\n      }\n      return null;\n    }\n\n    if (typeof gradientConfig === 'object') {\n      return {\n        type: gradientConfig.type || 'linear',\n        direction: gradientConfig.direction || 'horizontal',\n        stops: gradientConfig.stops || [\n          { offset: '0%', color: gradientConfig.from || '#ff6600' },\n          { offset: '100%', color: gradientConfig.to || '#ffcc00' }\n        ]\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse pattern configuration\n   * @private\n   */\n  _parsePatternConfig(patternConfig) {\n    if (!patternConfig) return null;\n\n    if (typeof patternConfig === 'string') {\n      // Predefined patterns: \"dots\", \"diagonal\", \"grid\"\n      return { type: patternConfig, size: 8, color: 'currentColor' };\n    }\n\n    if (typeof patternConfig === 'object') {\n      return {\n        type: patternConfig.type || 'dots',\n        size: Number(patternConfig.size || 8),\n        color: patternConfig.color || 'currentColor',\n        opacity: Number(patternConfig.opacity || 0.5)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse marker configuration (arrows, dots, etc.)\n   * @private\n   */\n  _parseMarkerConfig(markerConfig) {\n    if (!markerConfig) return null;\n\n    if (typeof markerConfig === 'string') {\n      // Predefined markers: \"arrow\", \"dot\", \"diamond\"\n      return { type: markerConfig, size: 'medium', color: 'inherit' };\n    }\n\n    if (typeof markerConfig === 'object') {\n      return {\n        type: markerConfig.type || 'arrow',\n        size: markerConfig.size || 'medium',\n        color: markerConfig.color || 'inherit',\n        rotate: markerConfig.rotate !== false\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse glow effect configuration\n   * @private\n   */\n  _parseGlowConfig(glowConfig) {\n    if (!glowConfig) return null;\n\n    if (glowConfig === true) {\n      return { color: 'currentColor', size: 4, opacity: 0.6 };\n    }\n\n    if (typeof glowConfig === 'object') {\n      return {\n        color: glowConfig.color || 'currentColor',\n        size: Number(glowConfig.size || 4),\n        opacity: Number(glowConfig.opacity || 0.6)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse shadow effect configuration\n   * @private\n   */\n  _parseShadowConfig(shadowConfig) {\n    if (!shadowConfig) return null;\n\n    if (shadowConfig === true) {\n      return { color: 'rgba(0,0,0,0.3)', offset: [2, 2], blur: 3 };\n    }\n\n    if (typeof shadowConfig === 'object') {\n      return {\n        color: shadowConfig.color || 'rgba(0,0,0,0.3)',\n        offset: shadowConfig.offset || [2, 2],\n        blur: Number(shadowConfig.blur || 3)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse segment colors configuration\n   * @private\n   */\n  _parseSegmentColors(segmentConfig) {\n    if (!segmentConfig || !Array.isArray(segmentConfig)) return null;\n\n    return segmentConfig.map(segment => ({\n      color: segment.color || 'var(--lcars-orange)',\n      start: Number(segment.start || 0),\n      end: Number(segment.end || 1)\n    }));\n  }\n\n  /**\n   * Build SVG definitions for gradients, patterns, markers, and effects\n   * @private\n   */\n  _buildDefinitions(lineStyle, overlayId) {\n    const defs = [];\n\n    // Gradients\n    if (lineStyle.gradient) {\n      defs.push(this._createGradientDefinition(lineStyle.gradient, overlayId));\n    }\n\n    // Patterns\n    if (lineStyle.pattern) {\n      defs.push(this._createPatternDefinition(lineStyle.pattern, overlayId));\n    }\n\n    // Markers\n    ['markerStart', 'markerMid', 'markerEnd'].forEach(markerType => {\n      if (lineStyle[markerType]) {\n        defs.push(this._createMarkerDefinition(lineStyle[markerType], overlayId, markerType));\n      }\n    });\n\n    // Effects (filters)\n    if (lineStyle.glow) {\n      defs.push(this._createGlowFilter(lineStyle.glow, overlayId));\n    }\n\n    if (lineStyle.shadow) {\n      defs.push(this._createShadowFilter(lineStyle.shadow, overlayId));\n    }\n\n    return defs.length > 0 ? `<defs>${defs.join('\\n')}</defs>` : '';\n  }\n\n  /**\n   * Create gradient definition\n   * @private\n   */\n  _createGradientDefinition(gradient, overlayId) {\n    const gradientId = `line-gradient-${overlayId}`;\n\n    if (gradient.type === 'radial') {\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<radialGradient id=\"${gradientId}\">${stops}</radialGradient>`;\n    } else {\n      // Linear gradient\n      const coords = this._getLinearGradientCoords(gradient.direction);\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<linearGradient id=\"${gradientId}\" ${coords}>${stops}</linearGradient>`;\n    }\n  }\n\n  /**\n   * Get linear gradient coordinates based on direction\n   * @private\n   */\n  _getLinearGradientCoords(direction) {\n    const directions = {\n      horizontal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"',\n      vertical: 'x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      diagonal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"',\n      'diagonal-reverse': 'x1=\"100%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"'\n    };\n    return directions[direction] || directions.horizontal;\n  }\n\n  /**\n   * Create pattern definition\n   * @private\n   */\n  _createPatternDefinition(pattern, overlayId) {\n    const patternId = `line-pattern-${overlayId}`;\n    const size = pattern.size;\n\n    let patternContent = '';\n\n    switch (pattern.type) {\n      case 'dots':\n        patternContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"1\" fill=\"${pattern.color}\" opacity=\"${pattern.opacity}\"/>`;\n        break;\n      case 'diagonal':\n        patternContent = `<path d=\"M0,${size} L${size},0\" stroke=\"${pattern.color}\" stroke-width=\"1\" opacity=\"${pattern.opacity}\"/>`;\n        break;\n      case 'grid':\n        patternContent = `\n          <path d=\"M0,0 L0,${size}\" stroke=\"${pattern.color}\" stroke-width=\"0.5\" opacity=\"${pattern.opacity}\"/>\n          <path d=\"M0,0 L${size},0\" stroke=\"${pattern.color}\" stroke-width=\"0.5\" opacity=\"${pattern.opacity}\"/>\n        `;\n        break;\n    }\n\n    return `<pattern id=\"${patternId}\" x=\"0\" y=\"0\" width=\"${size}\" height=\"${size}\" patternUnits=\"userSpaceOnUse\">\n              ${patternContent}\n            </pattern>`;\n  }\n\n  /**\n   * Create marker definition (arrows, dots, etc.)\n   * @private\n   */\n  _createMarkerDefinition(marker, overlayId, markerType) {\n    const markerId = `line-marker-${overlayId}-${markerType}`;\n    const size = this._getMarkerSize(marker.size);\n\n    let markerContent = '';\n    let viewBox = `0 0 ${size} ${size}`;\n    let refX = size / 2;\n    let refY = size / 2;\n\n    switch (marker.type) {\n      case 'arrow':\n        viewBox = '0 0 10 10';\n        refX = 8;\n        refY = 5;\n        markerContent = `<path d=\"M2,2 L8,5 L2,8 z\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n      case 'dot':\n        markerContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/4}\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n      case 'diamond':\n        markerContent = `<path d=\"M${size/2},2 L${size-2},${size/2} L${size/2},${size-2} L2,${size/2} z\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n      case 'square':\n        markerContent = `<rect x=\"2\" y=\"2\" width=\"${size-4}\" height=\"${size-4}\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n    }\n\n    return `<marker id=\"${markerId}\"\n                    viewBox=\"${viewBox}\"\n                    refX=\"${refX}\" refY=\"${refY}\"\n                    markerWidth=\"${size}\" markerHeight=\"${size}\"\n                    markerUnits=\"strokeWidth\"\n                    orient=\"${marker.rotate ? 'auto' : '0'}\">\n              ${markerContent}\n            </marker>`;\n  }\n\n  /**\n   * Get numeric marker size from size descriptor\n   * @private\n   */\n  _getMarkerSize(size) {\n    const sizes = { small: 6, medium: 8, large: 12, xlarge: 16 };\n    return sizes[size] || Number(size) || 8;\n  }\n\n  /**\n   * Create glow filter definition\n   * @private\n   */\n  _createGlowFilter(glow, overlayId) {\n    const filterId = `line-glow-${overlayId}`;\n\n    return `<filter id=\"${filterId}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feGaussianBlur stdDeviation=\"${glow.size}\" result=\"coloredBlur\"/>\n              <feMerge>\n                <feMergeNode in=\"coloredBlur\"/>\n                <feMergeNode in=\"SourceGraphic\"/>\n              </feMerge>\n            </filter>`;\n  }\n\n  /**\n   * Create drop shadow filter definition\n   * @private\n   */\n  _createShadowFilter(shadow, overlayId) {\n    const filterId = `line-shadow-${overlayId}`;\n    const [dx, dy] = shadow.offset;\n\n    return `<filter id=\"${filterId}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feDropShadow dx=\"${dx}\" dy=\"${dy}\"\n                           stdDeviation=\"${shadow.blur}\"\n                           flood-color=\"${shadow.color}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Build the main path element with all styling\n   * @private\n   */\n  _buildMainPath(pathData, lineStyle, overlayId, animationAttributes) {\n    const attributes = [];\n\n    // Core path and styling\n    attributes.push(`d=\"${pathData}\"`);\n    attributes.push(`fill=\"${lineStyle.fill}\"`);\n    attributes.push(`fill-opacity=\"${lineStyle.fillOpacity}\"`);\n\n    // Stroke styling\n    if (lineStyle.gradient) {\n      attributes.push(`stroke=\"url(#line-gradient-${overlayId})\"`);\n    } else if (lineStyle.pattern) {\n      attributes.push(`stroke=\"url(#line-pattern-${overlayId})\"`);\n    } else {\n      attributes.push(`stroke=\"${lineStyle.color}\"`);\n    }\n\n    attributes.push(`stroke-width=\"${lineStyle.width}\"`);\n    attributes.push(`stroke-opacity=\"${lineStyle.opacity}\"`);\n    attributes.push(`stroke-linecap=\"${lineStyle.lineCap}\"`);\n    attributes.push(`stroke-linejoin=\"${lineStyle.lineJoin}\"`);\n\n    if (lineStyle.lineJoin === 'miter' && lineStyle.miterLimit !== 4) {\n      attributes.push(`stroke-miterlimit=\"${lineStyle.miterLimit}\"`);\n    }\n\n    if (lineStyle.dashArray) {\n      attributes.push(`stroke-dasharray=\"${lineStyle.dashArray}\"`);\n      if (lineStyle.dashOffset !== 0) {\n        attributes.push(`stroke-dashoffset=\"${lineStyle.dashOffset}\"`);\n      }\n    }\n\n    // Markers\n    if (lineStyle.markerStart) {\n      attributes.push(`marker-start=\"url(#line-marker-${overlayId}-markerStart)\"`);\n    }\n    if (lineStyle.markerMid) {\n      attributes.push(`marker-mid=\"url(#line-marker-${overlayId}-markerMid)\"`);\n    }\n    if (lineStyle.markerEnd) {\n      attributes.push(`marker-end=\"url(#line-marker-${overlayId}-markerEnd)\"`);\n    }\n\n    // Effects\n    const filters = [];\n    if (lineStyle.glow) filters.push(`url(#line-glow-${overlayId})`);\n    if (lineStyle.shadow) filters.push(`url(#line-shadow-${overlayId})`);\n    if (filters.length > 0) {\n      attributes.push(`filter=\"${filters.join(' ')}\"`);\n    }\n\n    // Animation attributes (for future anime.js integration)\n    attributes.push(...animationAttributes.pathAttributes);\n\n    return `<path ${attributes.join(' ')}/>`;\n  }\n\n  /**\n   * Build additional marker elements (beyond standard markers)\n   * @private\n   */\n  _buildMarkers(pathResult, lineStyle, overlayId) {\n    // Future: Add custom markers along path at specific positions\n    return '';\n  }\n\n  /**\n   * Build special effects elements\n   * @private\n   */\n  _buildEffects(pathResult, lineStyle, overlayId) {\n    const effects = [];\n\n    // Future: Add flowing particles, pulse effects, etc.\n    if (lineStyle.features.includes('flow')) {\n      // Placeholder for flow animation elements\n    }\n\n    if (lineStyle.features.includes('pulse')) {\n      // Placeholder for pulse animation elements\n    }\n\n    return effects.join('\\n');\n  }\n\n  /**\n   * Prepare animation attributes for future anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    const animationAttributes = {\n      hasAnimations: false,\n      pathAttributes: [],\n      groupAttributes: []\n    };\n\n    // Animation hooks for future implementation\n    if (style.animatable !== false) {\n      animationAttributes.pathAttributes.push(`data-animatable=\"true\"`);\n    }\n\n    if (style.pulse_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-pulse-speed=\"${style.pulse_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.flow_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-flow-speed=\"${style.flow_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    // Add animation reference if specified\n    if (overlay._raw?.animation_ref) {\n      animationAttributes.groupAttributes.push(`data-animation-ref=\"${overlay._raw.animation_ref}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Render a simple fallback line when enhanced rendering fails\n   * @private\n   */\n  _renderFallbackLine(overlay, anchor1, anchor2) {\n    const [x1, y1] = anchor1;\n    const [x2, y2] = anchor2;\n    const style = overlay.finalStyle || overlay.style || {};\n    const color = style.color || 'var(--lcars-orange)';\n    const width = style.width || 2;\n\n    console.warn(`[LineOverlayRenderer] Using fallback rendering for line ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"line\" data-fallback=\"true\">\n              <line x1=\"${x1}\" y1=\"${y1}\" x2=\"${x2}\" y2=\"${y2}\"\n                    stroke=\"${color}\" stroke-width=\"${width}\"\n                    stroke-linecap=\"round\" fill=\"none\"/>\n            </g>`;\n  }\n\n  /**\n   * Update line styling dynamically (for future real-time updates)\n   * @public\n   */\n  updateLineStyle(overlayId, newStyle) {\n    // Future: Update existing line styles without full re-render\n    console.log(`[LineOverlayRenderer] Style update requested for line ${overlayId}`);\n  }\n\n  /**\n   * Get rendering capabilities and features supported\n   * @public\n   */\n  getCapabilities() {\n    return {\n      routing: true,\n      gradients: true,\n      patterns: true,\n      markers: ['arrow', 'dot', 'diamond', 'square'],\n      effects: ['glow', 'shadow'],\n      animations: ['pulse', 'flow'], // Future implementation\n      segmentColors: true,\n      dashPatterns: true,\n      advanced: true\n    };\n  }\n\n  /**\n   * Choose attachment point on target text overlay bbox, honoring attach_side or auto.\n   * Applies configurable gap (attach_gap | gap | line_gap) in outward normal direction.\n   */\n  _computeTextAttachPoint(origin, attachMeta, overlay) {\n    if (!origin || !attachMeta) return attachMeta?.center;\n\n    const raw = overlay._raw || overlay.raw || overlay;\n    const sidePref = (raw.attach_side || raw.attachSide || 'auto').toLowerCase();\n    const gapRaw = raw.attach_gap ?? raw.attachment_gap ?? raw.line_gap ?? raw.gap;\n    const gap = Number(gapRaw ?? 4);\n    const { bbox, points } = attachMeta;\n    const center = points.center;\n    let side = sidePref;\n\n    if (side === 'auto') {\n      const dx = origin[0] - center[0];\n      const dy = origin[1] - center[1];\n      if (Math.abs(dx) >= Math.abs(dy)) {\n        side = dx <= 0 ? 'left' : 'right';\n      } else {\n        side = dy <= 0 ? 'top' : 'bottom';\n      }\n    }\n\n    let basePoint;\n    let outward = [0,0];\n    switch (side) {\n      case 'left':\n      case 'left-center':\n        basePoint = [bbox.left, center[1]];\n        outward = [-1,0];\n        break;\n      case 'right':\n      case 'right-center':\n        basePoint = [bbox.right, center[1]];\n        outward = [1,0];\n        break;\n      case 'top':\n      case 'top-center':\n        basePoint = [center[0], bbox.top];\n        outward = [0,-1];\n        break;\n      case 'bottom':\n      case 'bottom-center':\n        basePoint = [center[0], bbox.bottom];\n        outward = [0,1];\n        break;\n      default:\n        basePoint = [bbox.left, center[1]];\n        outward = [-1,0];\n    }\n\n    // Apply gap outward\n    const attachPoint = [\n      basePoint[0] + outward[0] * gap,\n      basePoint[1] + outward[1] * gap\n    ];\n\n    // Store meta for potential debug / future features\n    overlay._attachComputed = {\n      targetOverlay: attachMeta.id,\n      sideChosen: side,\n      gap,\n      basePoint,\n      attachPoint\n    };\n\n    return attachPoint;\n  }\n}","/**\n * Advanced Renderer - Clean implementation for MSD v1\n * Main orchestrator that delegates to specialized renderers\n */\n\nimport { TextOverlayRenderer } from './TextOverlayRenderer.js';\nimport { SparklineRenderer } from './SparklineRenderer.js';\nimport { LineOverlayRenderer } from './LineOverlayRenderer.js';\nimport { StatusGridRenderer } from './StatusGridRenderer.js';\nimport { RendererUtils } from './RendererUtils.js';\n\nexport class AdvancedRenderer {\n  constructor(mountEl, routerCore, systemsManager = null) {\n    this.mountEl = mountEl;\n    this.routerCore = routerCore;\n    this.systemsManager = systemsManager; // ADDED: Store reference to systems manager\n    this.overlayElements = new Map();\n    this.lastRenderArgs = null;\n    this.lineRenderer = new LineOverlayRenderer(routerCore);\n\n    // Track overlay elements for efficient updates\n    this.overlayElementCache = new Map(); // overlayId -> DOM element\n    this.textAttachmentPoints = new Map();\n    this._lineDeps = new Map(); // targetOverlayId -> Set(lineOverlayId)\n  }\n\n  render(resolvedModel) {\n\n    console.log('[MSD DEBUG]  AdvancedRenderer.render() ENTRY:', {\n      timestamp: new Date().toISOString(),\n      hasResolvedModel: !!resolvedModel,\n      overlayCount: resolvedModel?.overlays?.length || 0,\n      anchorCount: resolvedModel?.anchors ? Object.keys(resolvedModel.anchors).length : 0,\n      hasViewBox: !!resolvedModel?.viewBox,\n      mountElExists: !!this.mountEl,\n      stackTrace: new Error().stack.split('\\n').slice(1, 3).join('\\n')\n    });\n\n    if (!resolvedModel) {\n      console.error('[MSD DEBUG]  AdvancedRenderer.render() - No resolved model provided');\n      return { svgMarkup: '', overlayCount: 0 };\n    }\n    const { overlays = [], anchors = {}, viewBox } = resolvedModel;\n    console.log(`[MSD DEBUG]  AdvancedRenderer processing:`, {\n      overlayCount: overlays.length,\n      overlayTypes: overlays.map(o => o.type),\n      anchorCount: Object.keys(anchors).length,\n      viewBox\n    });\n    this.overlayElements.clear();\n    // Phase rendering requires live SVG early\n    const svg = this.mountEl?.querySelector('svg');\n    if (!svg) {\n      console.error('[MSD DEBUG]  AdvancedRenderer.render() - SVG element not found in container:', {\n        mountEl: this.mountEl,\n        mountElTagName: this.mountEl?.tagName,\n        mountElChildren: this.mountEl?.children?.length || 0\n      });\n      return { svgMarkup: '', overlayCount: 0 };\n    }\n\n    console.log('[MSD DEBUG]  SVG element found, proceeding with overlay rendering');\n\n    // Prepare / clear overlay group\n    const overlayGroup = this._ensureOverlayGroup(svg);\n    overlayGroup.innerHTML = '';\n    this.overlayElementCache.clear();\n\n    // Precompute text attachment points (unchanged)\n    this.textAttachmentPoints.clear();\n    overlays.filter(o => o.type === 'text').forEach(tov => {\n      const ap = TextOverlayRenderer.computeAttachmentPoints(tov, anchors, this.mountEl);\n      if (ap) this.textAttachmentPoints.set(tov.id, ap);\n    });\n    this.lineRenderer.setTextAttachmentPoints(this.textAttachmentPoints);\n\n    // Phase 1: render overlays that others may depend on (text, sparkline)\n    const earlyTypes = new Set(['text', 'sparkline']);\n    let svgMarkupAccum = '';\n    let processedCount = 0;\n    overlays.filter(o => earlyTypes.has(o.type)).forEach(ov => {\n      try {\n        const html = this.renderOverlay(ov, anchors, viewBox);\n        if (html) {\n          svgMarkupAccum += html;\n        }\n        processedCount++;\n      } catch (e) {\n        console.warn('[AdvancedRenderer] Phase1 failed for', ov.id, e);\n      }\n    });\n    overlayGroup.innerHTML = svgMarkupAccum;\n    this._cacheElementsFrom(overlayGroup);\n\n    // Build dynamic anchors (overlay destinations)\n    this._dynamicAnchors = { ...anchors };\n    this._buildDynamicOverlayAnchors(overlays, this._dynamicAnchors);\n\n    // Phase 2: render line overlays (now DOM for targets exists)\n    overlays.filter(o => !earlyTypes.has(o.type)).forEach(ov => {\n      try {\n        const html = this.renderOverlay(ov, this._dynamicAnchors, viewBox); // pass dynamic anchors\n        if (html) {\n          overlayGroup.insertAdjacentHTML('beforeend', html);\n          svgMarkupAccum += html;\n          const el = overlayGroup.querySelector(`[data-overlay-id=\"${ov.id}\"]`);\n          if (el) this.overlayElementCache.set(ov.id, el);\n          const raw = ov._raw || ov.raw || {};\n          const targetId = raw.attach_to || raw.attachTo;\n          if (targetId) {\n            if (!this._lineDeps.has(targetId)) this._lineDeps.set(targetId, new Set());\n            this._lineDeps.get(targetId).add(ov.id);\n\n            // NEW: ensure RouterCore sees a route for overlay-destination line (HUD listing)\n            if (this.routerCore && raw.anchor && this._dynamicAnchors[raw.anchor] && this._dynamicAnchors[targetId]) {\n              try {\n                const req = this.routerCore.buildRouteRequest(\n                  ov,\n                  this._dynamicAnchors[raw.anchor],\n                  this._dynamicAnchors[targetId]\n                );\n                this.routerCore.computePath(req);\n              } catch (e) {\n                console.warn('[AdvancedRenderer] Overlay-destination route registration failed', ov.id, e);\n              }\n            }\n          }\n        }\n        processedCount++;\n      } catch (e) {\n        console.warn('[AdvancedRenderer] Phase2 failed for', ov.id, e);\n      }\n    });\n\n    console.log('[AdvancedRenderer] Injected elements (after phased render):', {\n      total: this.overlayElementCache.size,\n      text: overlayGroup.querySelectorAll('[data-overlay-type=\"text\"]').length,\n      lines: overlayGroup.querySelectorAll('[data-overlay-type=\"line\"]').length,\n      sparklines: overlayGroup.querySelectorAll('[data-overlay-type=\"sparkline\"]').length\n    });\n\n    // NEW: schedule deferred line refresh to fix first-load orientation/position\n    this._scheduleDeferredLineRefresh(overlays, this._dynamicAnchors, viewBox);\n\n    // NEW: schedule font stabilization pass (re-measure after real fonts load)\n    this._scheduleFontStabilization(overlays, this._dynamicAnchors, viewBox);\n\n    this.lastRenderArgs = { resolvedModel, overlays, svg };\n    return {\n      svgMarkup: svgMarkupAccum,\n      overlayCount: processedCount,\n      errors: overlays.length - processedCount\n    };\n  }\n\n  _ensureOverlayGroup(svg) {\n    let group = svg.querySelector('#msd-overlay-container');\n    if (!group) {\n      group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n      group.setAttribute('id', 'msd-overlay-container');\n      svg.appendChild(group);\n    }\n    return group;\n  }\n\n  _cacheElementsFrom(group) {\n    const nodes = group.querySelectorAll('[data-overlay-id]');\n    nodes.forEach(el => {\n      const id = el.getAttribute('data-overlay-id');\n      if (id) this.overlayElementCache.set(id, el);\n    });\n  }\n\n  // NEW: build virtual anchors for lines that attach to overlays\n  _buildDynamicOverlayAnchors(overlays, anchorMap) {\n    overlays.filter(o => o.type === 'line').forEach(line => {\n      const raw = line._raw || line.raw || {};\n      const dest = raw.attach_to || raw.attachTo;\n      if (!dest) return;\n      const tap = this.textAttachmentPoints.get(dest);\n      if (!tap || !tap.points) return;\n      const side = (raw.attach_side || raw.attachSide || '').toLowerCase();\n      const basePt = this._resolveOverlayAttachmentPoint(tap.points, side);\n      if (!basePt) return;\n      const gapPt = this._applyAttachGap(basePt, side, raw, tap.bbox);\n      anchorMap[dest] = gapPt;\n      // Register in routerCore so HUD sees it as an anchor\n      if (this.routerCore && this.routerCore.anchors) {\n        this.routerCore.anchors[dest] = gapPt;\n        try {\n          this.routerCore.invalidate(line.id);\n          const srcAnchor = anchorMap[raw.anchor] || this.routerCore.anchors[raw.anchor];\n          if (srcAnchor) {\n            const req = this.routerCore.buildRouteRequest(line, srcAnchor, gapPt);\n            this.routerCore.computePath(req);\n          }\n        } catch(e) {\n          console.warn('[AdvancedRenderer] Route registration (initial) failed', line.id, e);\n        }\n      }\n      // Track dependency\n      if (!this._lineDeps.has(dest)) this._lineDeps.set(dest, new Set());\n      this._lineDeps.get(dest).add(line.id);\n    });\n  }\n\n  // NEW: update dynamic anchors for changed text overlays\n  _updateDynamicAnchorsForOverlays(changedIds, overlays, anchorMap) {\n    if (!changedIds.size) return;\n    changedIds.forEach(id => {\n      const tap = this.textAttachmentPoints.get(id);\n      if (!tap || !tap.points) return;\n      const dep = this._lineDeps.get(id);\n      if (!dep) return;\n      dep.forEach(lineId => {\n        const line = overlays.find(o => o.id === lineId);\n        if (!line) return;\n        const raw = line._raw || line.raw || {};\n        const side = (raw.attach_side || raw.attachSide || '').toLowerCase();\n        const basePt = this._resolveOverlayAttachmentPoint(tap.points, side);\n        if (!basePt) return;\n        const gapPt = this._applyAttachGap(basePt, side, raw, tap.bbox);\n        anchorMap[id] = gapPt;\n        if (this.routerCore && this.routerCore.anchors) {\n          this.routerCore.anchors[id] = gapPt;\n          try {\n            this.routerCore.invalidate(line.id);\n            const srcAnchor = anchorMap[raw.anchor] || this.routerCore.anchors[raw.anchor];\n            if (srcAnchor) {\n              const req = this.routerCore.buildRouteRequest(line, srcAnchor, gapPt);\n              this.routerCore.computePath(req);\n            }\n          } catch(e) {\n            console.warn('[AdvancedRenderer] Route registration (update) failed', line.id, e);\n          }\n        }\n      });\n    });\n  }\n\n  // NEW: apply attach_gap offsets\n  _applyAttachGap(point, side, raw, bbox) {\n    const gap = Number(raw.attach_gap || raw.attachGap || 0);\n    const gapX = Number(raw.attach_gap_x || raw.attachGapX || gap || 0);\n    const gapY = Number(raw.attach_gap_y || raw.attachGapY || gap || 0);\n    if (!(gapX || gapY)) return point;\n    const [x, y] = point;\n    let dx = 0, dy = 0;\n    switch (side) {\n      case 'left': dx = -gapX; break;\n      case 'right': dx = gapX; break;\n      case 'top': dy = -gapY; break;\n      case 'bottom': dy = gapY; break;\n      case 'top-left': dx = -gapX; dy = -gapY; break;\n      case 'top-right': dx = gapX; dy = -gapY; break;\n      case 'bottom-left': dx = -gapX; dy = gapY; break;\n      case 'bottom-right': dx = gapX; dy = gapY; break;\n      default: break;\n    }\n    // Optional: ensure gap extends outward (based on bbox) if bbox provided\n    if (bbox) {\n      if (side.includes('left') && x > bbox.left) dx = -Math.abs(dx);\n      if (side.includes('right') && x < bbox.right) dx = Math.abs(dx);\n      if (side.includes('top') && y > bbox.top) dy = -Math.abs(dy);\n      if (side.includes('bottom') && y < bbox.bottom) dy = Math.abs(dy);\n    }\n    return [x + dx, y + dy];\n  }\n\n  // NEW: resolve which attachment point to use based on side keyword\n  _resolveOverlayAttachmentPoint(points, side) {\n    if (!points) return null;\n    switch (side) {\n      case 'left': return points.left || points.leftPadded || points.center;\n      case 'right': return points.right || points.rightPadded || points.center;\n      case 'top': return points.top || points.topPadded || points.center;\n      case 'bottom': return points.bottom || points.bottomPadded || points.center;\n      case 'top-left': return points.topLeft || points.left || points.top || points.center;\n      case 'top-right': return points.topRight || points.right || points.top || points.center;\n      case 'bottom-left': return points.bottomLeft || points.left || points.bottom || points.center;\n      case 'bottom-right': return points.bottomRight || points.right || points.bottom || points.center;\n      case 'center':\n      default:\n        return points.center;\n    }\n  }\n\n  // UPDATED: font stabilization pass using actual DOM glyph metrics (multi-pass) with better async handling\n  _scheduleFontStabilization(overlays, anchorsRef, viewBox) {\n    if (!overlays.some(o => o.type === 'text')) return;\n    const MAX_PASSES = 10;\n    const EXTRA_PASSES = 5; // safety extra passes after fonts load\n    const TOL = 0.01;\n    let pass = 0;\n    const run = () => {\n      const changedTargets = new Set();\n      let anyUnstable = false;\n      overlays.filter(o=>o.type==='text').forEach(ov => {\n        const group = this.overlayElementCache.get(ov.id);\n        if (!group) return;\n        const bb = RendererUtils.getDomTextBBox(group);\n        if (!bb) { anyUnstable = true; return; }\n        const recordedW = parseFloat(group.getAttribute('data-text-width')||'0')||0;\n        const recordedH = parseFloat(group.getAttribute('data-text-height')||'0')||0;\n        const diffW = Math.abs(bb.width - recordedW);\n        const diffH = Math.abs(bb.height - recordedH);\n        const needsRerender = (diffW > TOL) || (diffH > TOL);\n\n        if (needsRerender) {\n          const newGroup = this._reRenderSingleTextOverlay(ov, anchorsRef, viewBox);\n          if (newGroup) {\n            const bb2 = RendererUtils.getDomTextBBox(newGroup);\n            if (bb2) {\n              newGroup.setAttribute('data-text-width', String(bb2.width));\n              newGroup.setAttribute('data-text-height', String(bb2.height));\n              this._updateStatusIndicatorPosition(newGroup, bb2);\n            }\n            changedTargets.add(ov.id);\n            anyUnstable = true;\n          }\n        } else {\n          if (diffW > 0 || diffH > 0) {\n            group.setAttribute('data-text-width', String(bb.width));\n            group.setAttribute('data-text-height', String(bb.height));\n            changedTargets.add(ov.id);\n          }\n          if (group.getAttribute('data-font-stabilized') !== '1') {\n            group.setAttribute('data-font-stabilized','1');\n          }\n          this._updateTextAttachmentPointsFromDom(ov, group, bb);\n          // NEW: always update status indicator position even without re-render\n          this._updateStatusIndicatorPosition(group, bb);\n        }\n      });\n\n      this.lineRenderer.setTextAttachmentPoints(this.textAttachmentPoints);\n\n      if (changedTargets.size) {\n        this._updateDynamicAnchorsForOverlays(changedTargets, overlays, this._dynamicAnchors);\n        this._rerenderDependentLines(changedTargets, overlays, this._dynamicAnchors, viewBox);\n      }\n\n      pass++;\n      const morePassesAllowed = pass < (MAX_PASSES + EXTRA_PASSES);\n      if ((changedTargets.size || anyUnstable) && morePassesAllowed) {\n        requestAnimationFrame(run);\n      } else {\n        if (changedTargets.size) {\n          this._scheduleDeferredLineRefresh(overlays, this._dynamicAnchors, viewBox);\n        }\n        // Final safety delayed pass in case font finished loading just after loop\n        setTimeout(() => {\n          const remaining = overlays.filter(o=>o.type==='text')\n            .some(o => {\n              const g = this.overlayElementCache.get(o.id);\n              return g && g.getAttribute('data-font-stabilized') !== '1';\n            });\n          if (remaining) {\n            console.log('[AdvancedRenderer] Running safety stabilization pass');\n            pass = 0;\n            requestAnimationFrame(run);\n          }\n        }, 180);\n        console.log('[AdvancedRenderer] Font stabilization complete', { passes: pass, changed: Array.from(changedTargets) });\n      }\n    };\n\n    // Wait for font faces if still loading\n    const fontAPI = document.fonts;\n    if (fontAPI && fontAPI.status !== 'loaded') {\n      fontAPI.ready.then(() => requestAnimationFrame(run)).catch(() => requestAnimationFrame(run));\n    } else {\n      requestAnimationFrame(run);\n    }\n  }\n\n  // UPDATED signature usages for dynamic anchors\n  _scheduleDeferredLineRefresh(overlays, anchorsRef, viewBox) {\n    if (typeof requestAnimationFrame !== 'function') return;\n    const lineOverlays = overlays.filter(o =>\n      o.type === 'line' &&\n      ((o._raw || o.raw || {}).attach_side || (o._raw || o.raw || {}).attach_to)\n    );\n    if (!lineOverlays.length) return;\n    requestAnimationFrame(() => {\n      lineOverlays.forEach(ov => {\n        const existingEl = this.overlayElementCache.get(ov.id);\n        if (!existingEl) return;\n        try {\n          const newMarkup = this.lineRenderer.render(ov, anchorsRef, viewBox);\n          if (!newMarkup) return;\n          // Parse markup into element\n          const temp = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n          temp.innerHTML = newMarkup.trim();\n          const newEl = temp.firstElementChild;\n          if (!newEl) return;\n            existingEl.replaceWith(newEl);\n          this.overlayElementCache.set(ov.id, newEl);\n        } catch (e) {\n          console.warn('[AdvancedRenderer] Deferred line refresh failed', ov.id, e);\n        }\n      });\n      console.log('[AdvancedRenderer] Deferred line refresh pass complete');\n    });\n  }\n\n  renderOverlay(overlay, anchors, viewBox) {\n    if (!overlay || !overlay.type) {\n      console.warn('[AdvancedRenderer] Invalid overlay - missing type:', overlay);\n      return '';\n    }\n\n    // Ensure SVG container is available before rendering\n    const svgContainer = this.mountEl;\n    const svg = svgContainer?.querySelector('svg');\n\n    if (!svg) {\n      console.warn('[AdvancedRenderer] SVG element not found in container for overlay:', overlay.id);\n    }\n\n    // ADDED: Ensure SVG doesn't interfere with control events\n    if (svg) {\n      svg.style.pointerEvents = 'auto';\n      svg.style.zIndex = '0'; // Keep SVG in background\n    }\n\n    switch (overlay.type) {\n      case 'text':\n        // DEBUG: Check what overlay object is being passed to TextOverlayRenderer\n        if (overlay.id === 'title_overlay') {\n          console.log('[AdvancedRenderer]  Passing title_overlay to TextOverlayRenderer:', {\n            id: overlay.id,\n            color: overlay.style?.color,\n            status_indicator: overlay.style?.status_indicator,\n            finalStyleColor: overlay.finalStyle?.color,\n            finalStyleStatusIndicator: overlay.finalStyle?.status_indicator\n          });\n        }\n\n        // Update (in case dynamic overlays later): recompute & refresh map\n        const ap = TextOverlayRenderer.computeAttachmentPoints(overlay, anchors, svgContainer);\n        if (ap) this.textAttachmentPoints.set(overlay.id, ap);\n        return TextOverlayRenderer.render(overlay, anchors, viewBox, svgContainer);\n      case 'sparkline':\n        return SparklineRenderer.render(overlay, anchors, viewBox);\n      case 'line':\n        return this.lineRenderer.render(overlay, anchors, viewBox);\n      case 'control':\n        // ADDED: Control overlays are handled by MsdControlsRenderer, not SVG renderer\n        console.log('[AdvancedRenderer] Control overlay detected, skipping SVG rendering:', overlay.id);\n        return ''; // Return empty string - controls are rendered separately by MsdControlsRenderer\n      case 'status_grid':\n        return StatusGridRenderer.render(overlay, anchors, viewBox);\n      default:\n        console.warn(`[AdvancedRenderer] Unknown overlay type: ${overlay.type}`);\n        return '';\n    }\n  }\n\n    injectSvgContent(svgContent) {\n    const svg = this.mountEl.querySelector('svg');\n    if (!svg) {\n      console.warn('[AdvancedRenderer] No SVG element found for overlay injection');\n      return;\n    }\n\n    let overlayGroup = svg.querySelector('#msd-overlay-container');\n    if (!overlayGroup) {\n      overlayGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n      overlayGroup.setAttribute('id', 'msd-overlay-container');\n      svg.appendChild(overlayGroup);\n    } else {\n      overlayGroup.innerHTML = '';\n    }\n\n    try {\n      overlayGroup.innerHTML = svgContent;\n      console.log('[AdvancedRenderer] SVG content injected successfully');\n\n      // Build element cache after injection\n      this.overlayElementCache.clear();\n      const overlayElements = overlayGroup.querySelectorAll('[data-overlay-id]');\n      overlayElements.forEach(element => {\n        const overlayId = element.getAttribute('data-overlay-id');\n        if (overlayId) {\n          this.overlayElementCache.set(overlayId, element);\n          console.log(`[AdvancedRenderer] Cached element for overlay: ${overlayId}`);\n        }\n      });\n\n      // Verify injection\n      const sparklines = overlayGroup.querySelectorAll('[data-overlay-type=\"sparkline\"]');\n      const lines = overlayGroup.querySelectorAll('[data-overlay-type=\"line\"]');\n      const texts = overlayGroup.querySelectorAll('[data-overlay-type=\"text\"]');\n\n      console.log('[AdvancedRenderer] Injected elements:', {\n        sparklines: sparklines.length,\n        lines: lines.length,\n        texts: texts.length,\n        cached: this.overlayElementCache.size\n      });\n\n    } catch (error) {\n      console.error('[AdvancedRenderer] Failed to inject SVG content:', error);\n    }\n  }\n\n  // === DATA UPDATE METHODS ===\n\n  /**\n   * Update overlay data when data source changes\n   * @param {string} overlayId - ID of the overlay to update\n   * @param {Object} sourceData - Data from the data source\n   */\n  updateOverlayData(overlayId, sourceData) {\n    console.log('[AdvancedRenderer] updateOverlayData called:', {\n      overlayId,\n      hasSourceData: !!sourceData,\n      sourceDataKeys: sourceData ? Object.keys(sourceData) : 'none',\n      hasBuffer: !!(sourceData?.buffer),\n      bufferSize: sourceData?.buffer?.size?.() || 0,\n      hasCachedElement: this.overlayElementCache.has(overlayId)\n    });\n\n    if (!sourceData) {\n      console.warn('[AdvancedRenderer] updateOverlayData: Missing sourceData');\n      return;\n    }\n\n    // Use cached element - no DOM searching needed with subscription system\n    const overlayElement = this.overlayElementCache.get(overlayId);\n\n    if (!overlayElement) {\n      console.warn(`[AdvancedRenderer] Could not find cached overlay element: ${overlayId}. Element should be cached during render.`);\n      return;\n    }\n\n    const overlay = this.lastRenderArgs?.overlays?.find(o => o.id === overlayId);\n    if (!overlay) {\n      console.warn(`[AdvancedRenderer] Could not find overlay config: ${overlayId}`);\n      return;\n    }\n\n    // Delegate to type-specific renderer\n    switch (overlay.type) {\n      case 'sparkline':\n        SparklineRenderer.updateSparklineData(overlayElement, overlay, sourceData);\n        break;\n      case 'text':\n        console.log(`[AdvancedRenderer] Updating text overlay: ${overlayId}`);\n        this.updateTextOverlay(overlayId, sourceData);\n        break;\n      case 'status_grid':\n        console.log(`[AdvancedRenderer] Updating status grid overlay: ${overlayId}`);\n        this.updateStatusGridWithTemplates(overlayId, sourceData);\n        break;\n      default:\n        console.warn(`[AdvancedRenderer] Update not implemented for overlay type: ${overlay.type}`);\n    }\n  }\n\n  handleDataSourceUpdate(updateData) {\n    if (!this.mountEl) return;\n\n    // Find sparklines using cached elements instead of DOM search\n    const cachedElements = Array.from(this.overlayElementCache.values());\n    const sparklines = cachedElements.filter(el =>\n      el.getAttribute('data-source') === updateData.sourceId\n    );\n\n    if (sparklines.length === 0) {\n      console.log(`[AdvancedRenderer] No cached sparklines found for source: ${updateData.sourceId}`);\n      return;\n    }\n\n    sparklines.forEach(sparklineElement => {\n      const overlay = this.lastRenderArgs.overlays?.find(o =>\n        o.id === sparklineElement.getAttribute('data-overlay-id')\n      );\n      if (!overlay) return;\n\n      // Use SparklineRenderer's update method\n      SparklineRenderer.updateSparklineData(sparklineElement, overlay, updateData.data);\n    });\n  }\n\n  /**\n   * Clean up resources when renderer is destroyed\n   */\n  destroy() {\n    this.overlayElements.clear();\n    this.overlayElementCache.clear();\n    this.lastRenderArgs = null;\n  }\n\n  _updateTextAttachmentPointsFromDom(overlay, groupEl, bb) {\n    if (!overlay || !groupEl || !bb) return;\n    const ap = {\n      id: overlay.id,\n      center: [bb.centerX, bb.centerY],\n      bbox: {\n        left: bb.left, right: bb.right, top: bb.top, bottom: bb.bottom,\n        width: bb.width, height: bb.height\n      },\n      points: {\n        center: [bb.centerX, bb.centerY],\n        top: [bb.centerX, bb.top],\n        bottom: [bb.centerX, bb.bottom],\n        left: [bb.left, bb.centerY],\n        right: [bb.right, bb.centerY],\n        topLeft: [bb.left, bb.top],\n        topRight: [bb.right, bb.top],\n        bottomLeft: [bb.left, bb.bottom],\n        bottomRight: [bb.right, bb.bottom]\n      }\n    };\n    this.textAttachmentPoints.set(overlay.id, ap);\n  }\n\n  _rerenderDependentLines(changedSet, overlays, anchorsRef, viewBox) {\n    if (!changedSet || !changedSet.size) return;\n    const toRerender = new Set();\n    changedSet.forEach(tid => {\n      const dep = this._lineDeps.get(tid);\n      if (dep) dep.forEach(id => toRerender.add(id));\n    });\n    if (!toRerender.size) return;\n    requestAnimationFrame(() => {\n      toRerender.forEach(lineId => {\n        const overlay = overlays.find(o => o.id === lineId);\n        if (!overlay) return;\n        const existingEl = this.overlayElementCache.get(lineId);\n        if (!existingEl) return;\n        try {\n          const newMarkup = this.lineRenderer.render(overlay, anchorsRef, viewBox);\n          if (!newMarkup) return;\n          const temp = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n          temp.innerHTML = newMarkup.trim();\n          const newEl = temp.firstElementChild;\n          if (!newEl) return;\n          existingEl.replaceWith(newEl);\n          this.overlayElementCache.set(lineId, newEl);\n        } catch(e) {\n          console.warn('[AdvancedRenderer] Dep line re-render failed', lineId, e);\n        }\n      });\n      console.log('[AdvancedRenderer] Rerendered dependent lines after font stabilization', { count: toRerender.size });\n    });\n  }\n\n  _reRenderSingleTextOverlay(overlay, anchorsRef, viewBox) {\n    try {\n      const oldGroup = this.overlayElementCache.get(overlay.id);\n      if (!oldGroup) return null;\n      const markup = TextOverlayRenderer.render(overlay, anchorsRef, viewBox, this.mountEl);\n      if (!markup) return null;\n      const temp = document.createElementNS('http://www.w3.org/2000/svg','g');\n      temp.innerHTML = markup.trim();\n      const newGroup = temp.firstElementChild;\n      if (!newGroup) return null;\n      oldGroup.replaceWith(newGroup);\n      this.overlayElementCache.set(overlay.id, newGroup);\n      // Update DOM-based attachment points immediately\n      const bb = RendererUtils.getDomTextBBox(newGroup);\n      if (bb) this._updateTextAttachmentPointsFromDom(overlay, newGroup, bb);\n      return newGroup;\n    } catch(e) {\n      console.warn('[AdvancedRenderer] Re-render text overlay failed', overlay.id, e);\n      return null;\n    }\n  }\n\n  _updateStatusIndicatorPosition(groupEl, textBBox) {\n    try {\n      if (!groupEl) return;\n      const circle = groupEl.querySelector('circle[data-decoration=\"status-indicator\"]');\n      if (!circle) return;\n      // Read required data\n      const pos = circle.getAttribute('data-status-pos') || 'left-center';\n      const fontSize = Number(groupEl.getAttribute('data-font-size') || 16);\n      const indicatorSize = fontSize * 0.4;\n      // Padding calculation (mirror TextOverlayRenderer)\n      const transformInfo = RendererUtils._getSvgTransformInfo(this.mountEl);\n      const pixelPadding = 8;\n      const padding = transformInfo ? transformInfo.pixelToViewBox(pixelPadding) : indicatorSize;\n\n      const bbox = textBBox; // has left/right/top/bottom/centerX/centerY\n      let cx = bbox.centerX, cy = bbox.centerY;\n      switch (pos) {\n        case 'top-left':     cx = bbox.left - padding;  cy = bbox.top - padding; break;\n        case 'top-right':    cx = bbox.right + padding; cy = bbox.top - padding; break;\n        case 'bottom-left':  cx = bbox.left - padding;  cy = bbox.bottom + padding; break;\n        case 'bottom-right': cx = bbox.right + padding; cy = bbox.bottom + padding; break;\n        case 'top':          cx = bbox.centerX;         cy = bbox.top - padding; break;\n        case 'bottom':       cx = bbox.centerX;         cy = bbox.bottom + padding; break;\n        case 'left':\n        case 'left-center':  cx = bbox.left - padding;  cy = bbox.centerY; break;\n        case 'right':\n        case 'right-center': cx = bbox.right + padding; cy = bbox.centerY; break;\n        case 'center':       cx = bbox.centerX;         cy = bbox.centerY; break;\n        default:             cx = bbox.left - padding;  cy = bbox.centerY;\n      }\n      circle.setAttribute('cx', cx);\n      circle.setAttribute('cy', cy);\n      circle.setAttribute('r', indicatorSize);\n    } catch(_) {\n      // silent\n    }\n  }\n\n  /**\n   * Update text overlay content dynamically without full re-render\n   * @param {string} overlayId - ID of the text overlay to update\n   * @param {Object} sourceData - New DataSource data\n   */\n  updateTextOverlay(overlayId, sourceData) {\n    try {\n      // Find the text element in the DOM\n      const textElement = this.mountEl.querySelector(`[data-overlay-id=\"${overlayId}\"] text`);\n      if (!textElement) {\n        console.warn(`[AdvancedRenderer] Text element not found for overlay: ${overlayId}`);\n        return;\n      }\n\n      // Get the overlay configuration to resolve new content\n      const resolvedModel = this.systemsManager?.rulesEngine?.getResolvedModel?.() ||\n                           this.systemsManager?.getResolvedModel?.() ||\n                           window.__msdDebug?.pipelineInstance?.getResolvedModel?.();\n\n      const overlay = resolvedModel?.overlays?.find(o => o.id === overlayId);\n      if (!overlay) {\n        console.warn(`[AdvancedRenderer] Overlay configuration not found: ${overlayId}`);\n        return;\n      }\n\n      // Import the TextOverlayRenderer for content resolution\n      import('./TextOverlayRenderer.js').then(({ TextOverlayRenderer }) => {\n        const renderer = new TextOverlayRenderer();\n\n        // Resolve new text content using the same logic as initial rendering\n        const newContent = renderer._resolveTextContentWithData(overlay, overlay.finalStyle || {}, sourceData);\n\n        if (newContent && newContent !== textElement.textContent) {\n          console.log(`[AdvancedRenderer] Updating text overlay ${overlayId}: \"${textElement.textContent}\"  \"${newContent}\"`);\n\n          // Update the text content\n          textElement.textContent = TextOverlayRenderer.escapeXml(newContent);\n\n          // Update any status indicators that might depend on the content\n          this.updateTextDecorations(overlayId, newContent, overlay);\n\n          console.log(`[AdvancedRenderer]  Text overlay ${overlayId} updated successfully`);\n        } else {\n          console.log(`[AdvancedRenderer] Text overlay ${overlayId} content unchanged`);\n        }\n      }).catch(error => {\n        console.error(`[AdvancedRenderer] Failed to update text overlay ${overlayId}:`, error);\n      });\n\n    } catch (error) {\n      console.error(`[AdvancedRenderer] Error updating text overlay ${overlayId}:`, error);\n    }\n  }\n\n  /**\n   * Update text decorations (status indicators, etc.) when content changes\n   * @param {string} overlayId - ID of the text overlay\n   * @param {string} newContent - New text content\n   * @param {Object} overlay - Overlay configuration\n   */\n  updateTextDecorations(overlayId, newContent, overlay) {\n    try {\n      // Update status indicator position if needed (since text width may have changed)\n      const statusIndicator = this.mountEl.querySelector(`[data-overlay-id=\"${overlayId}\"] [data-decoration=\"status-indicator\"]`);\n      if (statusIndicator && overlay.finalStyle?.status_indicator) {\n        // Recalculate status indicator position\n        // This could be enhanced to recalculate based on new text metrics\n        console.log(`[AdvancedRenderer] Status indicator position may need updating for ${overlayId}`);\n      }\n    } catch (error) {\n      console.error(`[AdvancedRenderer] Error updating text decorations for ${overlayId}:`, error);\n    }\n  }\n\n  /**\n   * Update status grid cells with new data (similar to updateTextOverlay)\n   * @param {string} overlayId - Status grid overlay ID\n   * @param {Array} updatedCells - Updated cell configurations\n   * @public\n   */\n  updateStatusGrid(overlayId, updatedCells) {\n    console.log(`[AdvancedRenderer] Updating status grid ${overlayId} with ${updatedCells.length} cells`);\n\n    // Find the status grid element in the DOM\n    const gridElement = this.mountEl?.querySelector(`[data-overlay-id=\"${overlayId}\"]`);\n    if (!gridElement) {\n      console.warn(`[AdvancedRenderer] Status grid element not found: ${overlayId}`);\n      return;\n    }\n\n    // For now, log the update and add a simple visual indication\n    console.log(`[AdvancedRenderer] Status grid ${overlayId} cells updated:`, updatedCells);\n\n    // Add visual indication that the grid was updated\n    const timestamp = new Date().toISOString();\n    gridElement.setAttribute('data-last-update', timestamp);\n\n    // Future: Implement proper cell-by-cell updates\n    // This would involve updating individual cell elements within the grid\n    // For now, we'll trigger a re-render of the entire overlay if needed\n\n    console.log(`[AdvancedRenderer]  Status grid ${overlayId} update placeholder completed`);\n  }\n\n  /**\n   * Enhanced status grid update method with template processing\n   * @param {string} overlayId - Status grid overlay ID\n   * @param {Object} sourceData - New DataSource data\n   * @public\n   */\n  updateStatusGridWithTemplates(overlayId, sourceData) {\n    console.log(`[AdvancedRenderer] Updating status grid ${overlayId} with DataSource data`);\n\n    try {\n      // Get the overlay configuration to resolve new content\n      const resolvedModel = this.systemsManager?.rulesEngine?.getResolvedModel?.() ||\n                           this.systemsManager?.getResolvedModel?.() ||\n                           window.__msdDebug?.pipelineInstance?.getResolvedModel?.();\n\n      const overlay = resolvedModel?.overlays?.find(o => o.id === overlayId);\n      if (!overlay) {\n        console.warn(`[AdvancedRenderer] Status grid overlay configuration not found: ${overlayId}`);\n        return;\n      }\n\n      // Import the StatusGridRenderer for content resolution\n      import('./StatusGridRenderer.js').then(({ StatusGridRenderer }) => {\n        const renderer = new StatusGridRenderer();\n\n        // Get updated cells with processed template content\n        const style = overlay.finalStyle || overlay.style || {};\n        const updatedCells = renderer.updateCellsWithData(overlay, style, sourceData);\n\n        console.log(`[AdvancedRenderer] Processing ${updatedCells.length} updated cells for grid ${overlayId}`);\n\n        // Update each cell's content in the DOM\n        updatedCells.forEach(cell => {\n          const cellContentElement = this.mountEl?.querySelector(`[data-cell-content=\"${cell.id}\"]`);\n\n          if (cellContentElement && cell.content !== undefined) {\n            const oldContent = cellContentElement.textContent?.trim();\n            let newContent = cell.content;\n\n            // Handle [object Object] issue - ensure content is always a string\n            if (typeof newContent === 'object') {\n              console.warn(`[AdvancedRenderer] Cell ${cell.id} has object content, converting to string`);\n              newContent = newContent !== null ? String(newContent) : 'N/A';\n            }\n\n            // Ensure newContent is a string\n            newContent = String(newContent);\n\n            if (newContent !== oldContent) {\n              console.log(`[AdvancedRenderer] Updating cell ${cell.id}: \"${oldContent}\"  \"${newContent}\"`);\n              cellContentElement.textContent = newContent;\n            }\n          }\n        });\n\n        console.log(`[AdvancedRenderer]  Status grid ${overlayId} updated successfully`);\n\n      }).catch(error => {\n        console.error(`[AdvancedRenderer] Failed to update status grid ${overlayId}:`, error);\n      });\n\n    } catch (error) {\n      console.error(`[AdvancedRenderer] Error updating status grid ${overlayId}:`, error);\n    }\n  }\n\n  /**\n   * Enhanced template detection that supports multiple overlay types\n   * @param {Object} overlay - Overlay configuration\n   * @returns {boolean} True if overlay contains template content\n   * @private\n   */\n  _hasTemplateContentEnhanced(overlay) {\n    if (!overlay) return false;\n\n    // Handle different overlay types\n    switch (overlay.type) {\n      case 'text':\n        // Text overlays: check content property\n        const textContent = overlay.content || overlay._raw?.content || overlay.raw?.content;\n        return textContent && typeof textContent === 'string' && textContent.includes('{');\n\n      case 'status_grid':\n        // Status grids: check cells for template content\n        const cellsConfig = overlay.cells || overlay._raw?.cells || overlay.raw?.cells;\n        if (cellsConfig && Array.isArray(cellsConfig)) {\n          return cellsConfig.some(cell =>\n            (cell.content && typeof cell.content === 'string' && cell.content.includes('{')) ||\n            (cell.label && typeof cell.label === 'string' && cell.label.includes('{'))\n          );\n        }\n        return false;\n\n      default:\n        // Fallback: check common content properties\n        const content = overlay.content || overlay._raw?.content || overlay.raw?.content;\n        return content && typeof content === 'string' && content.includes('{');\n    }\n  }\n\n  /**\n   * Initialize enhanced template detection for status grids\n   * Called during renderer initialization\n   * @private\n   */\n  _initializeEnhancedTemplateDetection() {\n    // Monkey-patch BaseOverlayUpdater to support status grid template detection\n    const overlayUpdater = this.systemsManager?.overlayUpdater;\n\n    if (overlayUpdater && overlayUpdater._hasTemplateContent) {\n      console.log('[AdvancedRenderer] Enhancing BaseOverlayUpdater template detection for status grids');\n\n      // Store original method\n      const originalHasTemplateContent = overlayUpdater._hasTemplateContent.bind(overlayUpdater);\n\n      // Replace with enhanced version\n      overlayUpdater._hasTemplateContent = (overlay) => {\n        // Use our enhanced detection method\n        return this._hasTemplateContentEnhanced(overlay);\n      };\n\n      console.log('[AdvancedRenderer]  Enhanced template detection activated');\n    }\n  }\n}","/**\n * Phase 2: Debug visualization renderer\n * Shows anchor markers, overlay bounding boxes, routing guidelines, performance overlays.\n * Handles timing resilience for systems that may not be fully initialized at first render.\n */\nexport class MsdDebugRenderer {\n  constructor() {\n    this.enabled = false;\n    this.debugLayer = null;\n    this.anchorMarkers = new Map();\n    this.boundingBoxes = new Map();\n    this.routingOverlays = new Map();\n    this.performanceOverlays = new Map();\n\n    this.scale = 1.0;\n\n    // Remove old feature flags - now managed by DebugManager\n    this.debugManager = null;\n    this.unsubscribeDebug = null;\n\n    // Store last render context for reactive re-renders\n    this._lastRenderContext = null;\n\n    // Remove retry mechanism - no longer needed\n  }\n\n  /**\n   * Initialize with systems manager and subscribe to debug changes\n   * @param {SystemsManager} systemsManager - Systems manager instance\n   */\n  init(systemsManager) {\n    this.debugManager = systemsManager.debugManager;\n\n    // Subscribe to debug state changes for reactive rendering\n    this.unsubscribeDebug = this.debugManager.onChange((event) => {\n      // REDUCED: Only log significant events\n      if (event.type === 'feature' || event.type === 'scale' || event.type === 'router-ready') {\n        this._scheduleRerender();\n      }\n    });\n\n    // REDUCED: Minimal initialization logging\n  }\n\n  /**\n   * Set scale factor from debug configuration\n   * @param {number} scale - Scale multiplier (default 1.0)\n   */\n  setScale(scale = 1.0) {\n    this.scale = Math.max(0.3, Math.min(3.0, scale)); // Clamp between reasonable bounds\n    console.log(`[MsdDebugRenderer] Scale factor set to: ${this.scale}`);\n  }\n\n  /**\n   * Main render method - now powered by DebugManager state\n   * @param {Element} root - DOM root element\n   * @param {Array} viewBox - SVG viewBox [x, y, width, height]\n   * @param {Object} opts - Render options\n   */\n  render(root, viewBox, opts = {}) {\n    // REDUCED: Only log if debug is actually enabled\n    const debugState = this.debugManager?.getSnapshot();\n    if (!debugState?.enabled) {\n      return;\n    }\n\n    // Store context for reactive re-renders\n    this._lastRenderContext = { root, viewBox, opts };\n\n    if (!this.debugManager || !this.debugManager.initialized) {\n      return;\n    }\n\n    if (!root || typeof root.querySelector !== 'function') {\n      console.warn('[MsdDebugRenderer] Invalid root element');\n      return;\n    }\n\n    const svgElement = root.querySelector('svg');\n    if (!svgElement) {\n      console.warn('[MsdDebugRenderer] No SVG element found in root');\n      return;\n    }\n\n    // Update scale from DebugManager\n    this.setScale(debugState.scale);\n\n    // Setup debug layer\n    this.integrateWithAdvancedRenderer(svgElement, viewBox, opts.anchors);\n\n    // Clear existing debug content\n    if (this.debugLayer) {\n      this.debugLayer.innerHTML = '';\n    }\n\n    // Exit early if no features enabled\n    if (!debugState.enabled) {\n      if (this.debugLayer) {\n        this.debugLayer.style.display = 'none';\n      }\n      return;\n    }\n\n    // REDUCED: Only log when actually rendering features\n    console.log('[MsdDebugRenderer] Rendering debug features');\n\n    // Render enabled features using DebugManager state\n    if (debugState.anchors && opts.anchors) {\n      console.log('[MsdDebugRenderer] Rendering anchors...');\n      this.renderAnchorMarkers(opts.anchors);\n    }\n\n    if (debugState.bounding_boxes && opts.overlays) {\n      console.log('[MsdDebugRenderer] Rendering bounding boxes...');\n      this.renderOverlayBounds(opts.overlays);\n    }\n\n    if (debugState.routing && this.debugManager.canRenderRouting()) {\n      console.log('[MsdDebugRenderer] Rendering routing guides...');\n      this.renderRoutingGuides(opts);\n    }\n\n    if (debugState.performance) {\n      console.log('[MsdDebugRenderer] Rendering performance overlays...');\n      this.renderPerformanceOverlays(opts);\n    }\n\n    // Show debug layer\n    if (this.debugLayer) {\n      this.debugLayer.style.display = 'block';\n    }\n  }\n\n  /**\n   * Schedule a reactive re-render\n   * @private\n   */\n  _scheduleRerender() {\n    if (this._lastRenderContext) {\n      // Use requestAnimationFrame to avoid excessive re-renders\n      requestAnimationFrame(() => {\n        const { root, viewBox, opts } = this._lastRenderContext;\n        this.render(root, viewBox, opts);\n      });\n    }\n  }\n\n  /**\n   * Render routing guides - simplified without retry mechanism\n   * @param {Object} opts - Render options\n   */\n  renderRoutingGuides(opts) {\n    if (!this.debugLayer) return;\n\n    // Clear existing routes\n    this.routingOverlays.forEach(o => o.remove());\n    this.routingOverlays.clear();\n\n    // Get routing system from window.__msdDebug (set by pipeline)\n    const routing = opts.router || window.__msdDebug?.routing;\n\n    if (!routing || typeof routing.inspect !== 'function') {\n      console.log('[MsdDebugRenderer] Routing system not available for debug rendering');\n      return;\n    }\n\n    const overlays = opts.overlays || [];\n    const lineOverlays = overlays.filter(o => o.type === 'line');\n\n    if (lineOverlays.length === 0) {\n      console.log('[MsdDebugRenderer] No line overlays found for routing visualization');\n      return;\n    }\n\n    let routeCount = 0;\n    lineOverlays.forEach(overlay => {\n      try {\n        const routeInfo = routing.inspect(overlay.id);\n        if (routeInfo && routeInfo.pts && routeInfo.pts.length > 1) {\n          const routeOverlay = this.createRoutingOverlay(overlay.id, routeInfo);\n          this.debugLayer.appendChild(routeOverlay);\n          this.routingOverlays.set(overlay.id, routeOverlay);\n          routeCount++;\n        } else {\n          // Fine-grained debug, not necessarily an error\n          console.log(`[MsdDebugRenderer] No route info for overlay ${overlay.id}`);\n        }\n      } catch (error) {\n        console.warn(`[MsdDebugRenderer] Failed to render routing guide for ${overlay.id}:`, error);\n      }\n    });\n\n    console.log(`[MsdDebugRenderer] Rendered ${routeCount} routing guides`);\n  }\n\n  /**\n   * Create routing visualization overlay group.\n   * @param {string} overlayId\n   * @param {Object} routeInfo\n   * @returns {SVGGElement}\n   */\n  createRoutingOverlay(overlayId, routeInfo) {\n    const doc = this.debugLayer.ownerDocument;\n    const group = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n    group.setAttribute('class', 'msd-debug-routing');\n\n    const points = routeInfo.pts || [];\n    points.forEach((pt, index) => {\n      if (Array.isArray(pt) && pt.length >= 2) {\n        const [x, y] = pt;\n        const waypoint = doc.createElementNS('http://www.w3.org/2000/svg', 'circle');\n        waypoint.setAttribute('cx', x);\n        waypoint.setAttribute('cy', y);\n        waypoint.setAttribute('r', 2 * this.scale);\n        waypoint.setAttribute('fill', 'magenta');\n        waypoint.setAttribute('stroke', 'white');\n        waypoint.setAttribute('stroke-width', 1 * this.scale);\n        waypoint.setAttribute('opacity', '0.8');\n        group.appendChild(waypoint);\n\n        if (index === 0 || index === points.length - 1 || points.length <= 6) {\n          const label = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n            label.setAttribute('x', x + (4 * this.scale));\n            label.setAttribute('y', y - (4 * this.scale));\n            label.setAttribute('fill', 'magenta');\n            label.setAttribute('font-size', 8 * this.scale);\n            label.setAttribute('font-family', 'monospace');\n            label.setAttribute('opacity', '0.8');\n            label.textContent = index;\n            group.appendChild(label);\n        }\n      }\n    });\n\n    if (routeInfo.meta) {\n      const startPt = points[0];\n      if (startPt && Array.isArray(startPt) && startPt.length >= 2) {\n        const info = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n        info.setAttribute('x', startPt[0]);\n        info.setAttribute('y', startPt[1] - (12 * this.scale));\n        info.setAttribute('fill', 'magenta');\n        info.setAttribute('font-size', 9 * this.scale);\n        info.setAttribute('font-family', 'monospace');\n        info.setAttribute('opacity', '0.9');\n        info.textContent = `${routeInfo.meta.strategy || 'auto'} (${Math.round(routeInfo.meta.cost || 0)})`;\n        group.appendChild(info);\n      }\n    }\n\n    return group;\n  }\n\n  /**\n   * Render anchor markers\n   * @param {Object} anchors\n   */\n  renderAnchorMarkers(anchors) {\n    if (!anchors || !this.debugLayer) return;\n\n    this.anchorMarkers.forEach(marker => marker.remove());\n    this.anchorMarkers.clear();\n\n    let markerCount = 0;\n    for (const [name, pt] of Object.entries(anchors)) {\n      if (Array.isArray(pt) && pt.length >= 2) {\n        const marker = this.createAnchorMarker(name, pt[0], pt[1]);\n        this.debugLayer.appendChild(marker);\n        this.anchorMarkers.set(name, marker);\n        markerCount++;\n      }\n    }\n\n    console.log(`[MsdDebugRenderer] Rendered ${markerCount} anchor markers`);\n  }\n\n  /**\n   * Create individual anchor marker group element\n   * @param {string} name\n   * @param {number} x\n   * @param {number} y\n   * @returns {SVGGElement}\n   */\n  createAnchorMarker(name, x, y) {\n    const group = this.debugLayer.ownerDocument.createElementNS('http://www.w3.org/2000/svg', 'g');\n    group.setAttribute('transform', `translate(${x}, ${y})`);\n    group.setAttribute('class', 'msd-debug-anchor');\n\n    const crosshairSize = 8 * this.scale;\n    const strokeWidth = 2 * this.scale;\n    const circleRadius = 3 * this.scale;\n    const fontSize = 12 * this.scale;\n    const labelOffset = 12 * this.scale;\n\n    const crosshair = `\n      <line x1=\"${-crosshairSize}\" y1=\"0\" x2=\"${crosshairSize}\" y2=\"0\" stroke=\"cyan\" stroke-width=\"${strokeWidth}\" opacity=\"0.8\"/>\n      <line x1=\"0\" y1=\"${-crosshairSize}\" x2=\"0\" y2=\"${crosshairSize}\" stroke=\"cyan\" stroke-width=\"${strokeWidth}\" opacity=\"0.8\"/>\n      <circle cx=\"0\" cy=\"0\" r=\"${circleRadius}\" fill=\"cyan\" stroke=\"white\" stroke-width=\"${this.scale}\" opacity=\"0.9\"/>\n    `;\n    const label = `\n      <text x=\"${labelOffset}\" y=\"4\" fill=\"cyan\" font-size=\"${fontSize}\" font-family=\"monospace\" opacity=\"0.9\">\n        ${name} (${Math.round(x)}, ${Math.round(y)})\n      </text>\n    `;\n\n    group.innerHTML = crosshair + label;\n    return group;\n  }\n\n  /**\n   * Render overlay bounding boxes\n   * @param {Array<Object>} overlays\n   */\n  renderOverlayBounds(overlays = []) {\n    if (!this.debugLayer) return;\n\n    this.boundingBoxes.forEach((bboxObj) => {\n      bboxObj.rect?.remove();\n      bboxObj.label?.remove();\n    });\n    this.boundingBoxes.clear();\n\n    let bboxCount = 0;\n    overlays.forEach(overlay => {\n      if (overlay.position && Array.isArray(overlay.position)) {\n        const [x, y] = overlay.position;\n\n        // Get actual dimensions based on overlay type\n        const dimensions = this._getOverlayDimensions(overlay, x, y);\n        if (!dimensions) return;\n\n        const bboxObj = this.createBoundingBox(overlay.id, dimensions.x, dimensions.y, dimensions.width, dimensions.height);\n        this.debugLayer.appendChild(bboxObj.rect);\n        this.debugLayer.appendChild(bboxObj.label);\n        this.boundingBoxes.set(overlay.id, bboxObj);\n        bboxCount++;\n      }\n    });\n\n    console.log(`[MsdDebugRenderer] Rendered ${bboxCount} bounding boxes`);\n  }\n\n  /**\n   * Create bounding box visualization objects\n   * @param {string} id\n   * @param {number} x\n   * @param {number} y\n   * @param {number} width\n   * @param {number} height\n   * @returns {{rect: SVGRectElement, label: SVGTextElement}}\n   */\n  createBoundingBox(id, x, y, width, height) {\n    const doc = this.debugLayer.ownerDocument;\n    const rect = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    rect.setAttribute('x', x);\n    rect.setAttribute('y', y);\n    rect.setAttribute('width', width);\n    rect.setAttribute('height', height);\n    rect.setAttribute('fill', 'none');\n    rect.setAttribute('stroke', 'orange');\n    rect.setAttribute('stroke-width', 1 * this.scale);\n    rect.setAttribute('stroke-dasharray', `${3 * this.scale},${3 * this.scale}`);\n    rect.setAttribute('opacity', '0.7');\n    rect.setAttribute('class', 'msd-debug-bbox');\n\n    const label = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n    label.setAttribute('x', x + (2 * this.scale));\n    label.setAttribute('y', y + (12 * this.scale));\n    label.setAttribute('fill', 'orange');\n    label.setAttribute('font-size', 10 * this.scale);\n    label.setAttribute('font-family', 'monospace');\n    label.setAttribute('opacity', '0.9');\n    label.textContent = id || 'unknown';\n    label.setAttribute('class', 'msd-debug-bbox-label');\n\n    return { rect, label };\n  }\n\n  /**\n   * Render performance overlays - with proper value formatting\n   * @param {Object} opts\n   */\n  renderPerformanceOverlays(opts) {\n    if (!this.debugLayer) return;\n\n    this.performanceOverlays.forEach(o => o.remove());\n    this.performanceOverlays.clear();\n\n    const perf = window.__msdDebug?.getPerf?.() || {};\n    const perfEntries = [];\n\n    if (perf.timers) {\n      Object.entries(perf.timers).forEach(([key, data]) => {\n        if (data && typeof data === 'object') {\n          const avg = data.count > 0 ? (data.total / data.count) : 0;\n            perfEntries.push(`${key}: ${avg.toFixed(2)}ms avg`);\n        }\n      });\n    }\n\n    if (perf.counters) {\n      Object.entries(perf.counters).forEach(([key, value]) => {\n        perfEntries.push(`${key}: ${value}`);\n      });\n    }\n\n    if (perfEntries.length === 0) {\n      Object.entries(perf).slice(0, 10).forEach(([key, value]) => {\n        let displayValue;\n        if (typeof value === 'object' && value !== null) {\n          if (value.count !== undefined && value.total !== undefined) {\n            const avg = value.count > 0 ? (value.total / value.count) : 0;\n            displayValue = `${avg.toFixed(2)}ms avg`;\n          } else {\n            displayValue = JSON.stringify(value);\n          }\n        } else {\n          displayValue = String(value);\n        }\n        perfEntries.push(`${key}: ${displayValue}`);\n      });\n    }\n\n    if (perfEntries.length === 0) {\n      console.log('[MsdDebugRenderer] No performance data available');\n      return;\n    }\n\n    const doc = this.debugLayer.ownerDocument;\n    const perfGroup = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n    perfGroup.setAttribute('class', 'msd-debug-performance');\n\n    const baseX = 10 * this.scale;\n    const baseY = 10 * this.scale;\n    const width = 200 * this.scale;\n    const padding = 5 * this.scale;\n\n    const bg = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    bg.setAttribute('x', baseX);\n    bg.setAttribute('y', baseY);\n    bg.setAttribute('width', width);\n    bg.setAttribute('height', (20 + perfEntries.slice(0, 8).length * 15) * this.scale);\n    bg.setAttribute('fill', 'rgba(0,0,0,0.8)');\n    bg.setAttribute('stroke', 'yellow');\n    bg.setAttribute('stroke-width', 1 * this.scale);\n    bg.setAttribute('rx', 4 * this.scale);\n    perfGroup.appendChild(bg);\n\n    const title = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n    title.setAttribute('x', baseX + padding);\n    title.setAttribute('y', baseY + (15 * this.scale));\n    title.setAttribute('fill', 'yellow');\n    title.setAttribute('font-size', 12 * this.scale);\n    title.setAttribute('font-family', 'monospace');\n    title.setAttribute('font-weight', 'bold');\n    title.textContent = 'Performance';\n    perfGroup.appendChild(title);\n\n    perfEntries.slice(0, 8).forEach((entryText, index) => {\n      const entry = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n      entry.setAttribute('x', baseX + padding);\n      entry.setAttribute('y', baseY + (30 + index * 15) * this.scale);\n      entry.setAttribute('fill', 'yellow');\n      entry.setAttribute('font-size', 10 * this.scale);\n      entry.setAttribute('font-family', 'monospace');\n      entry.textContent = entryText;\n      perfGroup.appendChild(entry);\n    });\n\n    this.debugLayer.appendChild(perfGroup);\n    this.performanceOverlays.set('perf-info', perfGroup);\n\n    console.log(`[MsdDebugRenderer] Rendered performance overlay with ${perfEntries.length} metrics at scale ${this.scale}`);\n  }\n\n  /**\n   * Connect to AdvancedRenderer's SVG structure\n   * @param {SVGElement} svgElement\n   * @param {Array} viewBox\n   * @param {Object} anchors\n   */\n  integrateWithAdvancedRenderer(svgElement, viewBox, anchors = {}) {\n    if (!svgElement) return;\n    this.ensureDebugLayer(svgElement);\n    this.viewBox = viewBox;\n    this.anchors = anchors;\n  }\n\n  /**\n   * Setup debug layer container group inside the SVG.\n   * @param {SVGElement} svgElement\n   */\n  ensureDebugLayer(svgElement) {\n    if (!svgElement) {\n      console.warn('[MsdDebugRenderer] ensureDebugLayer: no SVG element provided');\n      return;\n    }\n\n    let debugLayer = svgElement.querySelector('#msd-debug-layer');\n    if (!debugLayer) {\n      console.log('[MsdDebugRenderer] Creating new debug layer');\n      const doc = svgElement.ownerDocument;\n      debugLayer = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n      debugLayer.id = 'msd-debug-layer';\n      debugLayer.style.pointerEvents = 'none';\n      debugLayer.style.zIndex = '1000';\n      svgElement.appendChild(debugLayer);\n    } else {\n      console.log('[MsdDebugRenderer] Using existing debug layer');\n    }\n\n    this.debugLayer = debugLayer;\n  }\n\n  /**\n   * Toggle debug visualization on/off.\n   * @param {boolean} enabled\n   * @returns {boolean}\n   */\n  toggle(enabled = !this.enabled) {\n    this.enabled = enabled;\n    if (this.debugLayer) {\n      this.debugLayer.style.display = enabled ? 'block' : 'none';\n    }\n    console.log(`[MsdDebugRenderer] Debug visualization ${enabled ? 'enabled' : 'disabled'}`);\n    return enabled;\n  }\n\n  /**\n   * Toggle a specific debug feature.\n   * @param {string} feature - Feature key\n   * @param {boolean} enabled - Desired state\n   */\n  toggleFeature(feature, enabled) {\n    if (this.features.hasOwnProperty(feature)) {\n      this.features[feature] = enabled;\n      console.log(`[MsdDebugRenderer] Feature '${feature}' ${enabled ? 'enabled' : 'disabled'}`);\n\n      // Optionally re-render (future HUD integration may call up-stream)\n      setTimeout(() => {\n        if (this._lastRenderContext) {\n          const { root, viewBox, opts } = this._lastRenderContext;\n          this.render(root, viewBox, opts);\n        }\n      }, 10);\n    }\n  }\n\n  /**\n   * Get current debug state summary.\n   * @returns {Object}\n   */\n  getDebugState() {\n    return {\n      enabled: this.enabled,\n      features: { ...this.features },\n      hasDebugLayer: Boolean(this.debugLayer),\n      markerCount: this.anchorMarkers.size,\n      boundingBoxCount: this.boundingBoxes.size,\n      routingOverlayCount: this.routingOverlays.size,\n      performanceOverlayCount: this.performanceOverlays.size\n    };\n  }\n\n  /**\n   * Get overlay dimensions based on overlay type and rendered content - ENHANCED for baseline accuracy\n   * @private\n   * @param {Object} overlay - Overlay configuration\n   * @param {number} x - X position\n   * @param {number} y - Y position\n   * @returns {Object|null} Dimensions object with x, y, width, height\n   */\n  _getOverlayDimensions(overlay, x, y) {\n    // First, check if the overlay has been rendered and has dimension data attributes\n    if (this.debugLayer) {\n      const svgElement = this.debugLayer.closest('svg');\n      if (svgElement) {\n        const renderedOverlay = svgElement.querySelector(`[data-overlay-id=\"${overlay.id}\"]`);\n        if (renderedOverlay) {\n          // Try to get dimensions from data attributes (set by TextOverlayRenderer)\n          const width = renderedOverlay.getAttribute('data-text-width');\n          const height = renderedOverlay.getAttribute('data-text-height');\n          const fontSize = renderedOverlay.getAttribute('data-font-size');\n          const dominantBaseline = renderedOverlay.getAttribute('data-dominant-baseline');\n          const textAnchor = renderedOverlay.getAttribute('data-text-anchor');\n\n          if (width && height && width !== '0' && height !== '0') {\n            console.log(`[MsdDebugRenderer] Using rendered dimensions for ${overlay.id}: ${width}x${height}, baseline: ${dominantBaseline}, anchor: ${textAnchor}`);\n\n            // Calculate proper positions based on actual rendered attributes\n            const textHeight = parseFloat(height);\n            const textWidth = parseFloat(width);\n            const textFontSize = parseFloat(fontSize) || 16;\n\n            // Y position calculation based on actual dominant baseline\n            let adjustedY = y;\n            const actualBaseline = dominantBaseline || 'auto';\n\n            if (actualBaseline === 'hanging') {\n              // Text starts at y, so bounding box starts at y\n              adjustedY = y;\n            } else if (actualBaseline === 'middle' || actualBaseline === 'central') {\n              // Text is centered on y, so bounding box starts at y - height/2\n              adjustedY = y - textHeight / 2;\n            } else if (actualBaseline === 'text-after-edge') {\n              // Text ends at y, so bounding box starts at y - height\n              adjustedY = y - textHeight;\n            } else {\n              // Default/auto baseline - estimate ascent position\n              const ascent = textFontSize * 0.7;\n              adjustedY = y - ascent;\n            }\n\n            // X position calculation based on actual text anchor\n            let adjustedX = x;\n            const actualTextAnchor = textAnchor || 'start';\n\n            if (actualTextAnchor === 'middle') {\n              adjustedX = x - textWidth / 2;\n            } else if (actualTextAnchor === 'end') {\n              adjustedX = x - textWidth;\n            }\n            // 'start' anchor keeps x as-is\n\n            console.log(`[MsdDebugRenderer] Calculated bbox for ${overlay.id}: x=${adjustedX}, y=${adjustedY}, baseline=${actualBaseline}, anchor=${actualTextAnchor}`);\n\n            return {\n              x: adjustedX,\n              y: adjustedY,\n              width: textWidth,\n              height: textHeight\n            };\n          }\n        }\n      }\n    }\n\n    // Fallback to overlay-specific dimension calculation\n    switch (overlay.type) {\n      case 'text':\n        return this._calculateTextOverlayDimensions(overlay, x, y);\n\n      case 'line':\n        return this._calculateLineOverlayDimensions(overlay, x, y);\n\n      case 'image':\n        return this._calculateImageOverlayDimensions(overlay, x, y);\n\n      case 'rect':\n      case 'rectangle':\n        return this._calculateRectOverlayDimensions(overlay, x, y);\n\n      default:\n        // Generic fallback using size property or default\n        const width = overlay.size ? overlay.size[0] : 100;\n        const height = overlay.size ? overlay.size[1] : 20;\n        return { x, y, width, height };\n    }\n  }\n\n  /**\n   * Calculate text overlay dimensions using similar logic to TextOverlayRenderer\n   * @private\n   */\n  _calculateTextOverlayDimensions(overlay, x, y) {\n    try {\n      // Get the SVG container for proper measurement context\n      const svgElement = this.debugLayer?.closest('svg');\n      const container = svgElement?.parentElement || this.debugLayer;\n\n      // Try to use TextOverlayRenderer's attachment point calculation\n      if (window.cblcars?.TextOverlayRenderer?.computeAttachmentPoints) {\n        const attachmentData = window.cblcars.TextOverlayRenderer.computeAttachmentPoints(\n          overlay,\n          this.anchors || {},\n          container\n        );\n\n        if (attachmentData && attachmentData.bbox) {\n          console.log(`[MsdDebugRenderer] Using TextOverlayRenderer bbox for ${overlay.id}`);\n          return {\n            x: attachmentData.bbox.left,\n            y: attachmentData.bbox.top,\n            width: attachmentData.bbox.width,\n            height: attachmentData.bbox.height\n          };\n        }\n      }\n\n      // Alternative: Try to get dimensions from already rendered overlay\n      if (svgElement) {\n        const renderedElement = svgElement.querySelector(`[data-overlay-id=\"${overlay.id}\"]`);\n        if (renderedElement) {\n          try {\n            const bbox = renderedElement.getBBox();\n            if (bbox.width > 0 && bbox.height > 0) {\n              console.log(`[MsdDebugRenderer] Using getBBox for ${overlay.id}: ${bbox.width}x${bbox.height}`);\n              return {\n                x: bbox.x,\n                y: bbox.y,\n                width: bbox.width,\n                height: bbox.height\n              };\n            }\n          } catch (bboxError) {\n            console.warn(`[MsdDebugRenderer] getBBox failed for ${overlay.id}:`, bboxError);\n          }\n        }\n      }\n\n      // Fallback to manual text measurement\n      const style = overlay.finalStyle || overlay.style || {};\n      const textContent = style.value || overlay.text || overlay.content ||\n                         overlay._raw?.content || overlay._raw?.text || '';\n\n      if (!textContent) {\n        return { x, y, width: 0, height: 0 };\n      }\n\n      // Basic text measurement fallback\n      const fontSize = style.font_size || style.fontSize || 16;\n      const fontFamily = style.font_family || style.fontFamily || 'monospace';\n\n      // Estimate dimensions (this is a rough approximation)\n      const charWidth = fontSize * 0.6; // Rough estimate for monospace\n      const lineHeight = fontSize * 1.2;\n\n      const lines = textContent.split('\\n');\n      const maxLineLength = Math.max(...lines.map(line => line.length));\n\n      const width = maxLineLength * charWidth;\n      const height = lines.length * lineHeight;\n\n      // Adjust position based on text anchor and baseline\n      const textAnchor = style.text_anchor || style.textAnchor || 'start';\n      const dominantBaseline = style.dominant_baseline || style.dominantBaseline || 'auto';\n\n      let adjustedX = x;\n      if (textAnchor === 'middle') {\n        adjustedX = x - width / 2;\n      } else if (textAnchor === 'end') {\n        adjustedX = x - width;\n      }\n\n      // Calculate proper Y position based on dominant baseline\n      let adjustedY = y;\n      const ascent = fontSize * 0.7; // Estimate ascent\n\n      if (dominantBaseline === 'hanging') {\n        // Text starts at y, so bounding box starts at y\n        adjustedY = y;\n      } else if (dominantBaseline === 'middle' || dominantBaseline === 'central') {\n        // Text is centered on y, so bounding box starts at y - height/2\n        adjustedY = y - height / 2;\n      } else if (dominantBaseline === 'text-after-edge') {\n        // Text ends at y, so bounding box starts at y - height\n        adjustedY = y - height;\n      } else {\n        // Default/auto baseline - text baseline is at y, so bounding box starts at y - ascent\n        adjustedY = y - ascent;\n      }\n\n      return {\n        x: adjustedX,\n        y: adjustedY,\n        width,\n        height\n      };    } catch (error) {\n      console.warn(`[MsdDebugRenderer] Failed to calculate text dimensions for ${overlay.id}:`, error);\n      return { x, y, width: 100, height: 20 };\n    }\n  }\n\n  /**\n   * Calculate line overlay dimensions\n   * @private\n   */\n  _calculateLineOverlayDimensions(overlay, x, y) {\n    const endpoints = overlay.endpoints || overlay.end_points;\n    if (!endpoints || !Array.isArray(endpoints) || endpoints.length < 2) {\n      return { x, y, width: 50, height: 2 };\n    }\n\n    const [start, end] = endpoints;\n    const startX = Array.isArray(start) ? start[0] : start.x || x;\n    const startY = Array.isArray(start) ? start[1] : start.y || y;\n    const endX = Array.isArray(end) ? end[0] : end.x || x + 50;\n    const endY = Array.isArray(end) ? end[1] : end.y || y;\n\n    const minX = Math.min(startX, endX);\n    const minY = Math.min(startY, endY);\n    const width = Math.abs(endX - startX);\n    const height = Math.abs(endY - startY);\n\n    return {\n      x: minX,\n      y: minY,\n      width: Math.max(width, 2), // Minimum width for visibility\n      height: Math.max(height, 2) // Minimum height for visibility\n    };\n  }\n\n  /**\n   * Calculate image overlay dimensions\n   * @private\n   */\n  _calculateImageOverlayDimensions(overlay, x, y) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const width = style.width || overlay.width || overlay.size?.[0] || 64;\n    const height = style.height || overlay.height || overlay.size?.[1] || 64;\n\n    return { x, y, width: parseFloat(width), height: parseFloat(height) };\n  }\n\n  /**\n   * Calculate rectangle overlay dimensions\n   * @private\n   */\n  _calculateRectOverlayDimensions(overlay, x, y) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const width = style.width || overlay.width || overlay.size?.[0] || 100;\n    const height = style.height || overlay.height || overlay.size?.[1] || 50;\n\n    return { x, y, width: parseFloat(width), height: parseFloat(height) };\n  }\n\n  /**\n   * Essential cleanup to prevent memory leaks\n   */\n  destroy() {\n    // Unsubscribe from debug manager changes\n    if (this.unsubscribeDebug) {\n      this.unsubscribeDebug();\n      this.unsubscribeDebug = null;\n    }\n\n    // Clear debug layer reference\n    this.debugLayer = null;\n    this._lastRenderContext = null;\n  }\n}\n\n// Keep browser fallback for direct script loading\nif (typeof window !== 'undefined') {\n  window.cblcars = window.cblcars || {};\n  window.cblcars.MsdDebugRenderer = MsdDebugRenderer;\n}","/**\n * Phase 4: Home Assistant card controls renderer\n * Handles HA card embedding with SVG foreignObject positioning for proper scaling\n */\n\nimport { PositionResolver } from '../renderer/PositionResolver.js';\n\nexport class MsdControlsRenderer {\n  constructor(renderer) {\n    this.renderer = renderer;\n    this.controlElements = new Map();\n    this.hass = null;\n    this.lastRenderArgs = null;\n    this._isRendering = false;\n    this._lastSignature = null;\n    if (typeof window !== 'undefined') {\n      window._msdControlsRenderer = this;\n    }\n\n    // DEBUGGING: Log when MsdControlsRenderer is created\n    console.log('[MsdControlsRenderer] Constructor called');\n  }\n\n  setHass(hass) {\n    console.log('[MsdControlsRenderer] setHass called with:', {\n      hasHass: !!hass,\n      entityCount: hass?.states ? Object.keys(hass.states).length : 0,\n      hasLightDesk: !!hass?.states?.['light.desk'],\n      lightDeskState: hass?.states?.['light.desk']?.state,\n      previousHass: !!this.hass,\n      controlElementsCount: this.controlElements.size\n    });\n\n    this.hass = hass;\n\n    // ADDED: Immediately update all existing control cards with new HASS context\n    if (this.controlElements.size > 0) {\n      console.log('[MsdControlsRenderer] Updating HASS context for', this.controlElements.size, 'control cards');\n      this._updateAllControlsHass(hass);\n    } else {\n      console.log('[MsdControlsRenderer] No control elements to update');\n\n      // Try to find and update any CB-LCARS cards that might exist but aren't tracked\n      //this._updateUnmanagedCards(hass);\n    }\n  }\n\n  // DEBUGGING: Try to update cards that exist but aren't managed by us\n  /*\n  _updateUnmanagedCards(hass) {\n    console.log('[MsdControlsRenderer] Looking for unmanaged CB-LCARS cards to update');\n\n    const unmanagedCards = document.querySelectorAll('cb-lcars-button-card, [data-card-type*=\"cb-lcars\"]');\n    console.log(`[MsdControlsRenderer] Found ${unmanagedCards.length} unmanaged cards`);\n\n    unmanagedCards.forEach((card, index) => {\n      try {\n        const entity = card._config?.entity || card.entity;\n        const currentState = card.hass?.states?.[entity]?.state;\n        const newState = hass?.states?.[entity]?.state;\n\n        console.log(`[MsdControlsRenderer] Unmanaged card ${index}:`, {\n          entity,\n          currentState,\n          newState,\n          stateChanged: currentState !== newState\n        });\n\n        this._applyHassToCard(card, hass, `unmanaged-${index}`);\n      } catch (e) {\n        console.warn(`[MsdControlsRenderer] Failed to update unmanaged card ${index}:`, e);\n      }\n    });\n  }\n  */\n\n  // ADDED: Update HASS context for all existing control cards\n  _updateAllControlsHass(hass) {\n    console.log(`[MsdControlsRenderer] Updating HASS for ${this.controlElements.size} control cards`);\n\n    for (const [overlayId, wrapperElement] of this.controlElements) {\n      try {\n        // Find the actual card element inside the wrapper\n        const cardElement = wrapperElement.querySelector('[class*=\"card\"], [data-card-type], cb-lcars-button-card, hui-light-card') ||\n                           wrapperElement.firstElementChild;\n\n        if (cardElement) {\n          this._applyHassToCard(cardElement, hass, overlayId);\n        }\n      } catch (error) {\n        console.warn('[MsdControlsRenderer] Failed to update HASS for control:', overlayId, error);\n      }\n    }\n  }\n\n\n  /**\n   * Apply HASS context to a specific control card\n   * @private\n   * @param {Element} card - The card element\n   * @param {Object} hass - Home Assistant object\n   * @param {string} controlId - Control identifier for logging\n   */\n  _applyHassToCard(card, hass, controlId) {\n      console.log(`[MsdControlsRenderer] Updating HASS for ${controlId}:`, {\n          tagName: card.tagName,\n          isCustomButtonCard: card.tagName.toLowerCase().includes('button-card'),\n          hasConfig: !!card._config,\n          hasSetConfig: typeof card.setConfig === 'function',\n          currentHass: !!card.hass,\n          hasSetHass: typeof card.setHass === 'function',\n          entity: card._config?.entity || 'none'\n      });\n\n      try {\n          const tagName = card.tagName ? card.tagName.toLowerCase() : '';\n\n          // FIXED: Only CB-LCARS cards use property assignment\n          const isCBLCARSCard = tagName.includes('cb-lcars');\n          const isStandardHACard = tagName.includes('hui-') || (tagName.includes('button-card') && !tagName.includes('cb-lcars'));\n\n          if (isCBLCARSCard) {\n              console.log(`[MsdControlsRenderer] Using property assignment for CB-LCARS card: ${controlId}`);\n\n              // Store old HASS for change detection\n              const oldHass = card.hass;\n\n              // CRITICAL: Update _stateObj BEFORE setting HASS to ensure proper state synchronization\n              if (card._config?.entity && hass.states?.[card._config.entity]) {\n                  const newStateObj = hass.states[card._config.entity];\n                  console.log(`[MsdControlsRenderer] Updating _stateObj for ${controlId} entity: ${card._config.entity}`, {\n                      oldState: card._stateObj?.state,\n                      newState: newStateObj?.state,\n                      stateChanged: card._stateObj?.state !== newStateObj?.state\n                  });\n                  card._stateObj = newStateObj;\n              }\n\n              // Use PROPERTY ASSIGNMENT (not method call) to trigger LitElement reactivity\n              card.hass = hass;\n              card._hass = hass;  // Also set internal property for compatibility\n\n              // Trigger LitElement's reactive property system\n              if (typeof card.requestUpdate === 'function') {\n                  console.log(`[MsdControlsRenderer] Triggering LitElement property update for ${controlId}`);\n                  card.requestUpdate('hass', oldHass);\n                  card.requestUpdate('_hass', oldHass);\n\n                  // Also trigger update for state object changes\n                  if (card._config?.entity) {\n                      card.requestUpdate('_stateObj');\n                  }\n              }\n          } else if (isStandardHACard) {\n              console.log(`[MsdControlsRenderer] Using setHass() method for standard HA card: ${controlId}`);\n\n              // Standard HA cards: Use setHass method (their preferred approach)\n              if (card.setHass && typeof card.setHass === 'function') {\n                  card.setHass(hass);\n              } else {\n                  console.warn(`[MsdControlsRenderer] Standard HA card ${controlId} has no setHass method`);\n\n                  // Fallback: property assignment\n                  const oldHass = card.hass;\n                  card.hass = hass;\n                  card._hass = hass;\n\n                  if (typeof card.requestUpdate === 'function') {\n                      card.requestUpdate('hass', oldHass);\n                  }\n              }\n          } else {\n              console.log(`[MsdControlsRenderer] Using fallback approach for unknown card type: ${controlId}`);\n\n              // Unknown card type: Try setHass first, then property assignment\n              if (card.setHass && typeof card.setHass === 'function') {\n                  card.setHass(hass);\n              } else {\n                  const oldHass = card.hass;\n                  card.hass = hass;\n                  card._hass = hass;\n\n                  if (typeof card.requestUpdate === 'function') {\n                      card.requestUpdate('hass', oldHass);\n                  }\n              }\n          }          return true;\n\n      } catch (error) {\n          console.error(`[MsdControlsRenderer]  Failed to update HASS for ${controlId}:`, error);\n          return false;\n      }\n  }\n\n\n  async renderControls(controlOverlays, resolvedModel) {\n    // ADDED: More comprehensive safety checks\n    if (this._isRendering) {\n      console.log('[MsdControlsRenderer] renderControls skipped (in progress)');\n      return;\n    }\n\n    if (!controlOverlays?.length) {\n      console.log('[MsdControlsRenderer] No control overlays to render');\n      return;\n    }\n\n    // ADDED: Validate resolved model\n    if (!resolvedModel) {\n      console.error('[MsdControlsRenderer] No resolved model provided');\n      return;\n    }\n\n    // ADDED: Validate DOM environment\n    if (typeof document === 'undefined') {\n      console.error('[MsdControlsRenderer] Document not available');\n      return;\n    }\n\n    const signature = controlOverlays.map(o => o.id).sort().join('|');\n    if (\n      this._lastSignature === signature &&\n      this.controlElements.size === controlOverlays.length\n    ) {\n      console.log('[MsdControlsRenderer] renderControls skipped (unchanged signature)', signature);\n      return;\n    }\n\n    this._isRendering = true;\n    try {\n      console.log('[MsdControlsRenderer] renderControls called', {\n        count: controlOverlays.length,\n        ids: controlOverlays.map(o => o.id),\n        signature,\n        hasHass: !!this.hass\n      });\n\n      // STEP 1: Ensure SVG container exists and clear existing controls\n      const svgContainer = this.getSvgControlsContainer();\n      if (!svgContainer) {\n        console.error('[MsdControlsRenderer] No SVG container available; abort render');\n        return;\n      }\n\n      console.log('[MsdControlsRenderer] SVG container found, clearing existing controls');\n      svgContainer.innerHTML = '';\n      this.controlElements.clear();\n\n      // ADDED: Render controls with individual error handling\n      for (const overlay of controlOverlays) {\n        try {\n          await this.renderControlOverlay(overlay, resolvedModel);\n        } catch (overlayError) {\n          console.error(`[MsdControlsRenderer] Failed to render control overlay ${overlay.id}:`, overlayError);\n          // Continue with other overlays\n        }\n      }\n\n      this.lastRenderArgs = { controlOverlays, resolvedModel };\n      this._lastSignature = signature;\n\n      console.log('[MsdControlsRenderer] renderControls completed successfully');\n\n    } catch (error) {\n      console.error('[MsdControlsRenderer] renderControls failed:', error);\n      throw error; // Re-throw so caller knows it failed\n    } finally {\n      this._isRendering = false;\n    }\n  }\n\n  async renderControlOverlay(overlay, resolvedModel) {\n    // Remove any existing foreignObject for this overlay\n    const existingForeignObject = document.querySelector(`#msd-control-foreign-${overlay.id}`);\n    if (existingForeignObject) {\n      console.log('[MsdControlsRenderer] Existing foreignObject found for', overlay.id, '- removing to avoid duplicates');\n      try { existingForeignObject.remove(); } catch(_) {}\n    }\n\n    // If we somehow already have a control element instance registered, drop it (fresh rebuild model)\n    if (this.controlElements.has(overlay.id)) {\n      this.controlElements.delete(overlay.id);\n    }\n\n    console.log('[MsdControlsRenderer] Creating control overlay', overlay.id);\n    const controlElement = await this.createControlElement(overlay);\n    if (!controlElement) return;\n\n    this.positionControlElement(controlElement, overlay, resolvedModel);\n    this.controlElements.set(overlay.id, controlElement);\n  }\n\n  // ADDED: recover original card definition even if pipeline stripped it\n  resolveCardDefinition(overlay) {\n    if (overlay.card) return overlay.card;\n    if (overlay.card_config) return overlay.card_config;\n    if (overlay.cardConfig) return overlay.cardConfig;\n    if (overlay._card) return overlay._card;\n    if (overlay.meta?.card) return overlay.meta.card;\n    if (overlay.extension?.card) return overlay.extension.card;\n\n    // Build raw overlay index once from global cache if available\n    if (!this._rawOverlayIndex) {\n      const raw = (window && window._msdRawOverlays) ? window._msdRawOverlays : [];\n      this._rawOverlayIndex = new Map(raw.map(o => [o.id, o]));\n    }\n    const rawEntry = this._rawOverlayIndex?.get(overlay.id);\n    if (rawEntry?.card) return rawEntry.card;\n\n    return null;\n  }\n\n  // ADDED: Build the final config object passed to setConfig\n  /* TO BE REMOVED - no longer needed\n  buildCardConfig(cardObj) {\n    if (!cardObj) return null;\n    // If nested config key provided, that is authoritative\n    if (cardObj.config && typeof cardObj.config === 'object') {\n      return { ...cardObj.config }; // shallow clone\n    }\n    // Otherwise treat the card object (minus wrapper-only keys) as config\n    const { type, config, ...rest } = cardObj;\n    // Include type too (some built-in cards ignore, harmless if present)\n    return { type, ...rest };\n  }\n  */\n\n  // ADDED: Normalize card type to handle HA built-in cards\n  _normalizeCardType(cardType) {\n    if (!cardType) return null;\n\n    // Handle custom cards\n    if (cardType.startsWith('custom:')) {\n      return cardType.slice(7); // Remove 'custom:' prefix\n    }\n\n    // ADDED: Map HA built-in card types to their actual element names\n    const builtInCardMap = {\n      'button': 'hui-button-card',\n      'light': 'hui-light-card',\n      'switch': 'hui-switch-card',\n      'sensor': 'hui-sensor-card',\n      'binary-sensor': 'hui-binary-sensor-card',\n      'cover': 'hui-cover-card',\n      'fan': 'hui-fan-card',\n      'climate': 'hui-climate-card',\n      'thermostat': 'hui-thermostat-card',\n      'media-player': 'hui-media-control-card',\n      'alarm-panel': 'hui-alarm-panel-card',\n      'input-number': 'hui-input-number-card',\n      'input-select': 'hui-input-select-card',\n      'input-text': 'hui-input-text-card',\n      'lock': 'hui-lock-card',\n      'vacuum': 'hui-vacuum-card',\n      'water-heater': 'hui-water-heater-card',\n      'weather': 'hui-weather-forecast-card'\n    };\n\n    return builtInCardMap[cardType] || cardType;\n  }\n\n  // ADDED: normalize card type to an actual custom element tag name\n  /* TO BE REMOVED - no longer needed\n  normalizeCardTag(cardType) {\n    if (!cardType) return null;\n    if (cardType.startsWith('custom:')) return cardType.slice(7); // HA style -> real tag\n    return cardType;\n  }\n  */\n\n  // ADDED: schedule retries for setConfig / hass once element upgrades\n  /* TO BE REMOVED - no longer needed\n  _scheduleDeferredConfig(cardElement, finalConfig, overlayId, attempt = 0) {\n    if (!finalConfig) return;\n    const maxAttempts = 8;\n    if (typeof cardElement.setConfig === 'function') {\n      try {\n        cardElement.setConfig(finalConfig);\n        cardElement._config = finalConfig;\n        if (this.hass) {\n          try { cardElement.hass = this.hass; } catch { cardElement._hass = this.hass; }\n        }\n        console.debug('[MSD Controls] Deferred setConfig applied', overlayId, { attempt });\n      } catch (e) {\n        console.warn('[MSD Controls] Deferred setConfig failed', overlayId, e);\n      }\n      return;\n    }\n    if (attempt >= maxAttempts) {\n      console.warn('[MSD Controls] Gave up waiting for setConfig', overlayId);\n      return;\n    }\n    const delay = 150 * (attempt + 1);\n    setTimeout(() => this._scheduleDeferredConfig(cardElement, finalConfig, overlayId, attempt + 1), delay);\n  }\n    */\n\n  async createControlElement(overlay) {\n    const cardDef = this.resolveCardDefinition(overlay);\n    if (!cardDef) {\n      console.warn('[MsdControlsRenderer] No card definition found for control overlay', overlay.id);\n      return null;\n    }\n\n    try {\n      // Browser environment - Fixed card creation and configuration\n      const cardType = cardDef.type;\n      let cardElement = null;\n\n      // FIXED: Use the new normalization method\n      const normalizedCardType = this._normalizeCardType(cardType);\n\n      console.log('[MsdControls] Creating card element:', {\n        originalType: cardType,\n        normalizedType: normalizedCardType,\n        overlayId: overlay.id\n      });\n\n      // ADDED: Special handling for HA built-in cards\n      if (normalizedCardType.startsWith('hui-')) {\n        cardElement = await this._createHomeAssistantCard(normalizedCardType, cardDef, overlay);\n      } else {\n        // Handle custom cards with existing logic\n        cardElement = await this._createCustomCard(normalizedCardType, cardDef, overlay);\n      }\n\n      // Fallback: Create a placeholder\n      if (!cardElement) {\n        console.warn(`Could not create card element for type: ${cardType}, creating fallback`);\n        cardElement = this._createFallbackCard(cardType, cardDef);\n      }\n\n      // FIXED: Apply HASS context BEFORE configuration\n      console.log('[MsdControls] Applying HASS and config:', {\n        overlayId: overlay.id,\n        hasHass: !!this.hass,\n        hasSetConfig: typeof cardElement.setConfig === 'function'\n      });\n\n      // Apply HASS context first\n      if (this.hass) {\n        await this._applyHassContext(cardElement, overlay.id);\n      }\n\n      // Then apply configuration\n      await this._configureCard(cardElement, cardDef, overlay);\n\n      // Create wrapper for positioning\n      const wrapper = document.createElement('div');\n      wrapper.className = 'msd-control-wrapper';\n      wrapper.dataset.msdControlId = overlay.id;\n      wrapper.style.position = 'absolute';\n      wrapper.style.pointerEvents = 'auto';\n      wrapper.style.touchAction = 'manipulation'; // ADDED: Better touch handling\n      wrapper.appendChild(cardElement);\n\n      // Event isolation\n      this._setupEventIsolation(wrapper, cardElement, overlay);\n\n      return wrapper;\n\n    } catch (error) {\n      console.error(`[MSD Controls] Failed to create card ${cardDef?.type}:`, error);\n      return this._createFallbackCard(cardDef?.type || 'unknown', cardDef);\n    }\n  }\n\n  // ADDED: Create Home Assistant built-in cards\n  async _createHomeAssistantCard(normalizedCardType, cardDef, overlay) {\n    console.log('[MsdControls] Creating HA built-in card:', normalizedCardType);\n\n    try {\n      // Wait for Home Assistant's card registry to be available\n      if (!window.customCards && !document.querySelector('home-assistant')) {\n        console.warn('[MsdControls] Home Assistant not fully loaded yet');\n        return null;\n      }\n\n      // Try to get the card constructor from HA's registry\n      let cardElement = null;\n\n      // Strategy 1: Use HA's card creation helper if available\n      if (window.customElements && window.customElements.get(normalizedCardType)) {\n        const CardClass = window.customElements.get(normalizedCardType);\n        cardElement = new CardClass();\n      } else {\n        // Strategy 2: Create via document and wait for upgrade\n        cardElement = document.createElement(normalizedCardType);\n        await this._waitForElementUpgrade(cardElement, 3000);\n      }\n\n      // ADDED: HA cards need different configuration approach\n      if (cardElement && typeof cardElement.setConfig !== 'function') {\n        // Some HA cards expose setConfig later or via different mechanism\n        console.log('[MsdControls] HA card created but setConfig not available, trying alternative approach');\n\n        // Wait a bit more for HA card to fully initialize\n        await new Promise(resolve => setTimeout(resolve, 500));\n\n        if (typeof cardElement.setConfig !== 'function') {\n          console.warn('[MsdControls] HA card does not have setConfig method:', normalizedCardType);\n          return null;\n        }\n      }\n\n      return cardElement;\n\n    } catch (error) {\n      console.warn('[MsdControls] HA card creation failed:', error);\n      return null;\n    }\n  }\n\n  // ADDED: Create custom cards (extracted from existing logic)\n  async _createCustomCard(normalizedCardType, cardDef, overlay) {\n    console.log('[MsdControls] Starting custom card creation strategies for:', normalizedCardType);\n    let cardElement = null;\n\n    // Strategy 1: Try direct custom element creation\n    console.log('[MsdControls] Strategy 1: Attempting direct custom element creation for:', normalizedCardType);\n    if (window.customElements && typeof window.customElements.get === 'function') {\n      try {\n        const CardClass = window.customElements.get(normalizedCardType);\n        if (CardClass) {\n          cardElement = new CardClass();\n          console.log('[MsdControls]  Strategy 1 SUCCESS: Created via constructor:', normalizedCardType);\n        } else {\n          console.log('[MsdControls]  Strategy 1 FAILED: No custom element found for:', normalizedCardType);\n        }\n      } catch (e) {\n        console.log('[MsdControls]  Strategy 1 FAILED: Constructor error for', normalizedCardType, ':', e.message);\n      }\n    } else {\n      console.log('[MsdControls]  Strategy 1 SKIPPED: customElements not available');\n    }\n\n    // Strategy 2: Try document.createElement with normalized type\n    if (!cardElement) {\n      console.log('[MsdControls] Strategy 2: Attempting createElement with upgrade for:', normalizedCardType);\n      try {\n        cardElement = document.createElement(normalizedCardType);\n\n        // Check if this is actually a custom element (not a generic div)\n        if (cardElement.tagName.toLowerCase() === normalizedCardType.toLowerCase()) {\n          console.log('[MsdControls] Strategy 2: Created element, waiting for upgrade:', normalizedCardType);\n          // Wait for potential custom element upgrade\n          await this._waitForElementUpgrade(cardElement);\n\n          if (typeof cardElement.setConfig === 'function') {\n            console.log('[MsdControls]  Strategy 2 SUCCESS: Created via createElement with upgrade:', normalizedCardType);\n          } else {\n            console.log('[MsdControls]  Strategy 2 FAILED: Element created but no setConfig after upgrade:', normalizedCardType);\n            cardElement = null;\n          }\n        } else {\n          console.log('[MsdControls]  Strategy 2 FAILED: Generic element created, not custom card:', normalizedCardType);\n          // Generic element created, not the custom card\n          cardElement = null;\n        }\n      } catch (e) {\n        console.log('[MsdControls]  Strategy 2 FAILED: createElement error for', normalizedCardType, ':', e.message);\n      }\n    }\n\n    // Strategy 3: Try creating in document body first (some cards need to be in DOM)\n    if (!cardElement) {\n      console.log('[MsdControls] Strategy 3: Attempting body attachment technique for:', normalizedCardType);\n      try {\n        cardElement = document.createElement(normalizedCardType);\n        // Temporarily attach to body to trigger upgrade\n        const tempParent = document.createElement('div');\n        tempParent.style.position = 'absolute';\n        tempParent.style.left = '-10000px';\n        document.body.appendChild(tempParent);\n        tempParent.appendChild(cardElement);\n\n        console.log('[MsdControls] Strategy 3: Element attached to body, waiting for upgrade:', normalizedCardType);\n        // Wait for upgrade\n        await this._waitForElementUpgrade(cardElement, 5000);\n\n        // Remove from temp parent\n        cardElement.remove();\n        tempParent.remove();\n\n        if (typeof cardElement.setConfig === 'function') {\n          console.log('[MsdControls]  Strategy 3 SUCCESS: Created via body attachment:', normalizedCardType);\n        } else {\n          console.log('[MsdControls]  Strategy 3 FAILED: Body attachment did not result in working card:', normalizedCardType);\n          cardElement = null;\n        }\n      } catch (e) {\n        console.log('[MsdControls]  Strategy 3 FAILED: Body attachment error for', normalizedCardType, ':', e.message);\n      }\n    }\n\n    if (cardElement) {\n      console.log('[MsdControls]  Custom card creation SUCCESSFUL for:', normalizedCardType);\n    } else {\n      console.log('[MsdControls]  ALL STRATEGIES FAILED for:', normalizedCardType);\n    }\n\n    return cardElement;\n  }\n\n  /**\n   * Wait for custom element to be fully upgraded\n   */\n  async _waitForElementUpgrade(element, maxWait = 5000) {\n    const startTime = Date.now();\n\n    console.log('[MsdControls] Waiting for element upgrade:', {\n      tagName: element.tagName,\n      hasSetConfig: typeof element.setConfig === 'function'\n    });\n\n    while (Date.now() - startTime < maxWait) {\n      // Check if element has been upgraded (has setConfig method)\n      if (typeof element.setConfig === 'function') {\n        console.log('[MsdControls] Element upgraded successfully:', element.tagName);\n        return element;\n      }\n\n      // Check if element has upgrade promise\n      if (element.updateComplete) {\n        try {\n          await element.updateComplete;\n          if (typeof element.setConfig === 'function') {\n            console.log('[MsdControls] Element upgraded via updateComplete:', element.tagName);\n            return element;\n          }\n        } catch (e) {\n          // Ignore update errors\n        }\n      }\n\n      // Force upgrade attempt\n      if (window.customElements && window.customElements.upgrade) {\n        try {\n          window.customElements.upgrade(element);\n        } catch (e) {\n          // Ignore upgrade errors\n        }\n      }\n\n      // Short wait before next check\n      await new Promise(resolve => setTimeout(resolve, 100));\n    }\n\n    console.warn('[MsdControls] Element upgrade timeout:', {\n      tagName: element.tagName,\n      hasSetConfig: typeof element.setConfig === 'function',\n      waitTime: Date.now() - startTime\n    });\n\n    return element;\n  }\n\n  /**\n   * Configure the card with config and HASS context\n   */\n  async _configureCard(cardElement, cardDef, overlay) {\n    // Build the final configuration\n    const config = this._buildCardConfig(cardDef);\n\n    console.log('[MsdControls] Configuring card:', {\n      overlayId: overlay.id,\n      cardType: cardDef.type,\n      hasSetConfig: typeof cardElement.setConfig === 'function',\n      hasHass: !!this.hass,\n      config: config\n    });\n\n    // Apply configuration with retries\n    if (config) {\n      const success = await this._applyCardConfig(cardElement, config, overlay.id);\n      if (!success) {\n        // Try one more time after a longer delay\n        setTimeout(async () => {\n          console.log('[MsdControls] Retrying config application after delay:', overlay.id);\n          await this._applyCardConfig(cardElement, config, overlay.id);\n        }, 1000);\n      }\n    }\n\n    // Force update if possible\n    if (typeof cardElement.requestUpdate === 'function') {\n      try {\n        await cardElement.requestUpdate();\n        console.log('[MsdControls] Requested update for:', overlay.id);\n      } catch (e) {\n        console.debug('[MsdControls] requestUpdate failed:', e);\n      }\n    }\n\n    // ENHANCED: Additional update strategies for different card types\n    if (cardElement.tagName) {\n      const tagName = cardElement.tagName.toLowerCase();\n      const isCustomButtonCard = tagName.includes('cb-lcars') ||\n                                 tagName.includes('button-card') ||\n                                 cardElement._isCustomButtonCard ||\n                                 cardElement.constructor?.name?.includes('Button');\n\n      if (isCustomButtonCard) {\n        // CB-LCARS and custom-button-card specific updates\n        console.log(`[MsdControls] Setting up custom-button-card updates for:`, overlay.id);\n\n        setTimeout(() => {\n          try {\n            // Ensure HASS is set\n            if (this.hass) {\n              cardElement.hass = this.hass;\n              cardElement._hass = this.hass;\n            }\n\n            // Force full re-evaluation to trigger state-based styling\n            if (cardElement._config && typeof cardElement.setConfig === 'function') {\n              const currentConfig = { ...cardElement._config };\n              cardElement.setConfig(currentConfig);\n\n              // Re-apply HASS after config\n              if (this.hass) {\n                cardElement.hass = this.hass;\n              }\n            }\n\n            // LitElement update if available\n            if (typeof cardElement.requestUpdate === 'function') {\n              cardElement.requestUpdate();\n            }\n\n            console.debug('[MsdControls]  Custom-button-card initial update completed for:', overlay.id);\n\n          } catch (e) {\n            console.debug('[MsdControls] Custom-button-card specific update failed:', e);\n          }\n        }, 100);\n\n      } else if (tagName.startsWith('hui-')) {\n        // Home Assistant built-in card updates\n        setTimeout(() => {\n          try {\n            if (typeof cardElement.requestUpdate === 'function') {\n              cardElement.requestUpdate();\n            }\n            // Force state update\n            if (this.hass) {\n              cardElement.hass = this.hass;\n            }\n          } catch (e) {\n            console.debug('[MsdControls] HA card specific update failed:', e);\n          }\n        }, 200);\n      }\n    }\n  }\n\n  /**\n   * Build card configuration from card definition\n   */\n  _buildCardConfig(cardDef) {\n    if (!cardDef) return null;\n\n    let finalConfig;\n\n    // Handle nested config structure: { type: \"light\", config: { entity: \"light.example\" } }\n    if (cardDef.config && typeof cardDef.config === 'object') {\n      finalConfig = {\n        type: cardDef.type,\n        ...cardDef.config\n      };\n    } else {\n      // Handle flat structure: { type: \"light\", entity: \"light.example\", name: \"My Light\" }\n      const { type, config, card, card_config, cardConfig, ...otherProps } = cardDef;\n      finalConfig = {\n        type,\n        ...otherProps\n      };\n    }\n\n    // FIXED: More precise detection for CB-LCARS and custom-button-card based cards\n    const cardType = finalConfig.type;\n    const isCustomButtonCard = cardType === 'custom:cb-lcars-button-card' ||\n                               cardType === 'cb-lcars-button-card' ||\n                               cardType === 'custom:button-card' ||\n                               cardType === 'button-card';\n\n    // Do NOT treat regular HA built-in cards as custom-button-cards\n    const isBuiltInCard = cardType === 'button' || cardType === 'light' || cardType === 'switch' ||\n                          cardType.startsWith('hui-');\n\n    if (isCustomButtonCard && !isBuiltInCard && finalConfig.entity) {\n      console.log(`[MsdControlsRenderer] Adding triggers_update for CB-LCARS card with entity: ${finalConfig.entity}`);\n\n      // Ensure triggers_update includes the entity\n      if (isCustomButtonCard && !isBuiltInCard) {\n        console.log(`[MsdControlsRenderer] Setting triggers_update to 'all' for CB-LCARS card: ${finalConfig.entity}`);\n\n        // FIXED: Use 'all' so the card sees ALL HASS updates, not just specific entities\n        finalConfig.triggers_update = 'all';\n\n        console.log(`[MsdControlsRenderer] CB-LCARS card configured with triggers_update: 'all'`);\n      }\n\n      console.log(`[MsdControlsRenderer] CB-LCARS card configured with triggers_update:`, finalConfig.triggers_update);\n    } else if (isBuiltInCard) {\n      console.log(`[MsdControlsRenderer] Skipping triggers_update for built-in HA card: ${cardType}`);\n    }    // Mark as MSD-generated\n    finalConfig._msdGenerated = true;\n\n    return finalConfig;\n  }\n\n  /**\n   * Apply HASS context to card element with multiple strategies\n   */\n  async _applyHassContext(cardElement, overlayId) {\n    if (!this.hass) {\n      console.warn('[MsdControls] No HASS context available for:', overlayId);\n      return false;\n    }\n\n    console.log('[MsdControls] Starting HASS application strategies for:', overlayId);\n\n    const strategies = [\n      // Strategy 1: Direct property assignment\n      () => {\n        console.log('[MsdControls] HASS Strategy 1: Attempting direct property assignment for:', overlayId);\n        try {\n          cardElement.hass = this.hass;\n          const success = cardElement.hass === this.hass;\n          if (success) {\n            console.log('[MsdControls]  HASS Strategy 1 SUCCESS: Direct property assignment for:', overlayId);\n          } else {\n            console.log('[MsdControls]  HASS Strategy 1 FAILED: Property assignment did not stick for:', overlayId);\n          }\n          return success;\n        } catch (e) {\n          console.log('[MsdControls]  HASS Strategy 1 FAILED: Property assignment error for', overlayId, ':', e.message);\n          return false;\n        }\n      },\n\n      // Strategy 2: Use property descriptor\n      () => {\n        console.log('[MsdControls] HASS Strategy 2: Attempting property descriptor for:', overlayId);\n        try {\n          Object.defineProperty(cardElement, 'hass', {\n            value: this.hass,\n            writable: true,\n            configurable: true\n          });\n          console.log('[MsdControls]  HASS Strategy 2 SUCCESS: Property descriptor applied for:', overlayId);\n          return true;\n        } catch (e) {\n          console.log('[MsdControls]  HASS Strategy 2 FAILED: Property descriptor error for', overlayId, ':', e.message);\n          return false;\n        }\n      },\n\n      // Strategy 3: Store in private property for later access\n      () => {\n        console.log('[MsdControls] HASS Strategy 3: Attempting private property fallback for:', overlayId);\n        try {\n          cardElement._hass = this.hass;\n          // Also try setting via property if it exists\n          if ('hass' in cardElement) {\n            cardElement.hass = this.hass;\n            console.log('[MsdControls] HASS Strategy 3: Also set public hass property for:', overlayId);\n          }\n          console.log('[MsdControls]  HASS Strategy 3 SUCCESS: Private property fallback for:', overlayId);\n          return true;\n        } catch (e) {\n          console.log('[MsdControls]  HASS Strategy 3 FAILED: Private property error for', overlayId, ':', e.message);\n          return false;\n        }\n      }\n    ];\n\n    for (const [index, strategy] of strategies.entries()) {\n      if (strategy()) {\n        console.log(`[MsdControls]  HASS application SUCCESSFUL via strategy ${index + 1} for:`, overlayId);\n        return true;\n      }\n    }\n\n    console.log('[MsdControls]  ALL HASS STRATEGIES FAILED for:', overlayId);\n    return false;\n  }\n\n  /**\n   * Apply card configuration with retry logic\n   */\n  async _applyCardConfig(cardElement, config, overlayId) {\n    if (!config) return false;\n\n    console.log('[MsdControls] Applying config:', {\n      overlayId: overlayId,\n      hasSetConfig: typeof cardElement.setConfig === 'function',\n      cardType: config.type,\n      entity: config.entity,\n      triggersUpdate: config.triggers_update,\n      config: config\n    });\n\n    const maxRetries = 8; // Increased retries\n\n    for (let attempt = 0; attempt < maxRetries; attempt++) {\n      try {\n        if (typeof cardElement.setConfig === 'function') {\n          cardElement.setConfig(config);\n          cardElement._config = config;\n\n          // ADDED: Verify the config was applied correctly\n          if (cardElement._config && cardElement._config.triggers_update) {\n            console.log(`[MsdControls]  Config applied with triggers_update:${cardElement._config.triggers_update} for:`, overlayId);\n          } else {\n            console.warn(`[MsdControls]  Config applied but no triggers_update found for:`, overlayId);\n          }\n\n          console.log(`[MsdControls]  Config applied on attempt ${attempt + 1} for:`, overlayId);\n          return true;\n        }\n\n        // If setConfig not available yet, wait and retry\n        if (attempt < maxRetries - 1) {\n          const delay = 200 * (attempt + 1); // Increased delay\n          console.log(`[MsdControls] Retrying config in ${delay}ms for:`, overlayId);\n          await new Promise(resolve => setTimeout(resolve, delay));\n        }\n\n      } catch (e) {\n        console.warn(`[MsdControls] setConfig attempt ${attempt + 1} failed for ${overlayId}:`, e);\n\n        if (attempt < maxRetries - 1) {\n          await new Promise(resolve => setTimeout(resolve, 200 * (attempt + 1)));\n        }\n      }\n    }\n\n    // Store config for later application\n    cardElement._pendingConfig = config;\n    console.warn('[MsdControls]  Config stored for deferred application:', overlayId);\n\n    // Set up a periodic retry\n    const retryInterval = setInterval(() => {\n      if (typeof cardElement.setConfig === 'function') {\n        try {\n          cardElement.setConfig(config);\n          cardElement._config = config;\n          console.log('[MsdControls]  Deferred config finally applied:', overlayId);\n          clearInterval(retryInterval);\n        } catch (e) {\n          console.warn('[MsdControls] Deferred config retry failed:', overlayId, e);\n        }\n      }\n    }, 1000);\n\n    // Clear interval after 10 seconds\n    setTimeout(() => clearInterval(retryInterval), 10000);\n\n    return false;\n  }\n\n  /**\n   * Create fallback card when creation fails\n   */\n  _createFallbackCard(cardType, cardDef) {\n    const fallback = document.createElement('div');\n    fallback.className = 'msd-control-fallback';\n\n    Object.assign(fallback.style, {\n      border: '2px dashed var(--primary-color, #ffa500)',\n      borderRadius: '8px',\n      padding: '16px',\n      background: 'var(--card-background-color, rgba(0,0,0,0.8))',\n      color: 'var(--primary-text-color, #ffffff)',\n      fontSize: '14px',\n      textAlign: 'center',\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n      alignItems: 'center',\n      minHeight: '80px'\n    });\n\n    const title = document.createElement('div');\n    title.textContent = `Card: ${cardType}`;\n    title.style.fontWeight = 'bold';\n    title.style.marginBottom = '8px';\n\n    const subtitle = document.createElement('div');\n    subtitle.textContent = '(Card failed to load)';\n    subtitle.style.fontSize = '12px';\n    subtitle.style.opacity = '0.7';\n\n    fallback.appendChild(title);\n    fallback.appendChild(subtitle);\n\n    // Make it interactive for debugging\n    fallback.addEventListener('click', () => {\n      console.log('[MsdControls] Fallback card clicked:', { cardType, cardDef });\n    });\n\n    return fallback;\n  }\n\n  /**\n   * Setup event isolation for control interactions\n   */\n  _setupEventIsolation(wrapper, cardElement, overlay) {\n    // FIXED: Less aggressive event isolation - allow events to reach card, but prevent bubbling to MSD\n    const events = [\n      'click', 'dblclick', 'contextmenu',\n      'pointerdown', 'pointerup', 'pointermove', 'pointercancel',\n      'touchstart', 'touchend', 'touchmove', 'touchcancel',\n      'mousedown', 'mouseup', 'mousemove', 'mouseenter', 'mouseleave',\n      'focus', 'blur', 'focusin', 'focusout',\n      'keydown', 'keyup', 'keypress'\n    ];\n\n    events.forEach(eventType => {\n      wrapper.addEventListener(eventType, (event) => {\n        // FIXED: Only stop propagation if the event originated from our card\n        // This prevents MSD from handling card events, but allows the card to work\n        if (event.target === cardElement || cardElement.contains(event.target)) {\n          // Allow the event to proceed to the card normally\n          // Only stop it from bubbling further up to MSD\n          event.stopPropagation();\n          /*\n          console.debug('[MsdControls] Event allowed to card but prevented from bubbling:', {\n            type: event.type,\n            overlayId: overlay.id,\n            target: event.target.tagName,\n            cardType: cardElement?.tagName\n          });\n          */\n        }\n      }, {\n        capture: false,  // CHANGED: Use bubble phase so card gets events first\n        passive: false   // Allow preventDefault if needed\n      });\n    });\n\n    // ADDED: Set higher z-index and pointer events\n    wrapper.style.pointerEvents = 'auto';\n    wrapper.style.position = 'absolute';\n    wrapper.style.zIndex = '1000'; // Ensure it's above other layers\n    wrapper.setAttribute('tabindex', '0');\n\n    // ADDED: Ensure the card element itself can receive events\n    if (cardElement) {\n      cardElement.style.pointerEvents = 'auto';\n      cardElement.style.position = 'relative';\n      cardElement.style.zIndex = '1';\n\n      // ADDED: Ensure card can receive all necessary events for hold actions\n      cardElement.style.touchAction = 'manipulation'; // Improves touch responsiveness\n    }\n  }\n\n  positionControlElement(element, overlay, resolvedModel) {\n    const position = this.resolvePosition(overlay.position, resolvedModel);\n    const size = this.resolveSize(overlay.size, resolvedModel);\n\n    if (!position || !size) {\n      console.warn('[MSD Controls] Invalid position or size for control:', overlay.id);\n      return;\n    }\n\n    // Create SVG foreignObject wrapper to live in viewBox coordinate space\n    const foreignObject = this.createSvgForeignObject(overlay.id, position, size);\n    if (!foreignObject) {\n      console.error('[MSD Controls] Failed to create SVG foreignObject for:', overlay.id);\n      return;\n    }\n\n    // Configure the control element for SVG embedding\n    this.configureControlForSvg(element, overlay, size);\n\n    // Insert control into foreignObject\n    foreignObject.appendChild(element);\n\n    // Add to SVG container (this will scale automatically with viewBox)\n    const svgContainer = this.getSvgControlsContainer();\n    if (svgContainer && foreignObject.parentNode !== svgContainer) {\n      svgContainer.appendChild(foreignObject);\n      console.debug('[MSD Controls] Control positioned in SVG coordinates:', overlay.id, { position, size });\n    }\n  }\n\n  /**\n   * Create an SVG foreignObject element to embed HTML controls in viewBox space\n   */\n  createSvgForeignObject(overlayId, position, size) {\n    const targetContainer = this.renderer.container || this.renderer.mountEl;\n    const svg = targetContainer?.querySelector('svg');\n\n    if (!svg) {\n      console.warn('[MSD Controls] No SVG element found for foreignObject creation');\n      return null;\n    }\n\n    try {\n      const foreignObject = document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject');\n\n      // Position in viewBox coordinates\n      foreignObject.setAttribute('x', position[0]);\n      foreignObject.setAttribute('y', position[1]);\n      foreignObject.setAttribute('width', size[0]);\n      foreignObject.setAttribute('height', size[1]);\n\n      // Add identification attributes\n      foreignObject.setAttribute('data-msd-control-id', overlayId);\n      foreignObject.setAttribute('id', `msd-control-foreign-${overlayId}`);\n\n      // Ensure proper event handling\n      foreignObject.style.pointerEvents = 'auto';\n      foreignObject.style.overflow = 'visible';\n\n      return foreignObject;\n\n    } catch (error) {\n      console.error('[MSD Controls] Failed to create foreignObject:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Configure control element for SVG embedding\n   */\n  configureControlForSvg(element, overlay, size) {\n    // Remove any absolute positioning that would interfere with foreignObject\n    element.style.position = 'relative';\n    element.style.left = 'auto';\n    element.style.top = 'auto';\n\n    // Size the element to fill the foreignObject\n    element.style.width = '100%';\n    element.style.height = '100%';\n    element.style.boxSizing = 'border-box';\n\n    // Ensure proper event handling\n    element.style.pointerEvents = 'auto';\n    element.style.zIndex = overlay.z_index || 'auto';\n\n    // Maintain background if needed\n    if (!element.style.background && !element.shadowRoot) {\n      element.style.background = 'none';\n    }\n\n    console.debug('[MSD Controls] Configured element for SVG embedding:', overlay.id);\n  }\n\n  /**\n   * Get or create the SVG controls container group\n   */\n  getSvgControlsContainer() {\n    const targetContainer = this.renderer.container || this.renderer.mountEl;\n    const svg = targetContainer?.querySelector('svg');\n\n    if (!svg) {\n      console.warn('[MSD Controls] No SVG element found for controls container');\n      return null;\n    }\n\n    // Look for existing controls group\n    let controlsGroup = svg.querySelector('#msd-controls-container');\n\n    if (!controlsGroup) {\n      // Create new controls group\n      controlsGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n      controlsGroup.setAttribute('id', 'msd-controls-container');\n      controlsGroup.style.pointerEvents = 'none'; // Group itself doesn't capture events\n\n      // Insert after overlay container but before debug layer\n      const overlayContainer = svg.querySelector('#msd-overlay-container');\n      const debugLayer = svg.querySelector('#msd-debug-layer');\n\n      if (debugLayer) {\n        svg.insertBefore(controlsGroup, debugLayer);\n      } else if (overlayContainer) {\n        svg.insertBefore(controlsGroup, overlayContainer.nextSibling);\n      } else {\n        svg.appendChild(controlsGroup);\n      }\n\n      console.log('[MSD Controls] Created SVG controls container group');\n    }\n\n    return controlsGroup;\n  }\n\n  // Helper methods for position and size resolution\n  resolvePosition(position, resolvedModel) {\n    // Use the PositionResolver for consistency with other overlays\n    const resolved = PositionResolver.resolvePosition(position, resolvedModel.anchors || {});\n    if (resolved) {\n      return resolved;\n    }\n\n    // Fallback: Return default position if resolution fails\n    console.warn('[MSD Controls] Position resolution failed, using default [0, 0]');\n    return [0, 0];\n  }\n\n  resolveSize(size, resolvedModel) {\n    if (!size || !Array.isArray(size) || size.length < 2) {\n      return [100, 100];\n    }\n    return [size[0], size[1]];\n  }\n\n  // Cleanup method\n  cleanup() {\n    console.log('[MsdControlsRenderer] Cleaning up controls renderer');\n\n    // Clear control elements (now foreignObjects in SVG)\n    for (const [id, element] of this.controlElements) {\n      try {\n        // Remove foreignObject wrapper from SVG\n        const foreignObject = element.closest('foreignObject') ||\n                             document.querySelector(`#msd-control-foreign-${id}`);\n        if (foreignObject && foreignObject.remove) {\n          foreignObject.remove();\n        } else if (element && element.remove) {\n          element.remove();\n        }\n      } catch (e) {\n        console.warn(`Failed to remove control element ${id}:`, e);\n      }\n    }\n    this.controlElements.clear();\n\n    // Remove SVG controls container\n    const targetContainer = this.renderer?.container || this.renderer?.mountEl;\n    const svg = targetContainer?.querySelector('svg');\n    const svgControlsContainer = svg?.querySelector('#msd-controls-container');\n    if (svgControlsContainer) {\n      try {\n        svgControlsContainer.remove();\n      } catch (e) {\n        console.warn('Failed to remove SVG controls container:', e);\n      }\n    }\n\n    // Clean up any legacy DOM container if it exists\n    const legacyContainer = targetContainer?.querySelector('#msd-controls-container');\n    if (legacyContainer && legacyContainer.tagName === 'DIV') {\n      try {\n        legacyContainer.remove();\n        console.log('[MsdControlsRenderer] Removed legacy DOM controls container');\n      } catch (e) {\n        console.warn('Failed to remove legacy controls container:', e);\n      }\n    }\n\n    // Clear HASS reference\n    this.hass = null;\n  }\n}\n\n","/**\n * Enhanced Performance monitoring panel for MSD HUD\n * Timer and counter data with threshold alerts and reset functionality\n */\n\nexport class PerformancePanel {\n  constructor() {\n    this.thresholds = new Map(); // timerId -> threshold config\n    this.previousSnapshot = {};\n  }\n\n  // Instance methods replacing global panel handlers\n  setThreshold(timerId, avgMs) {\n    const t = parseFloat(avgMs);\n    if (isNaN(t)) this.thresholds.delete(timerId);\n    else this.thresholds.set(timerId, { avgMs: t });\n  }\n  resetTimer(timerId) {\n    try { window.__msdDebug?.getPerf?.()?.resetTimer?.(timerId); } catch {}\n  }\n  clearAllTimers() {\n    try { window.__msdDebug?.getPerf?.()?.clear?.(); } catch {}\n    this.thresholds.clear();\n  }\n  exportData() {\n    const perfData = window.__msdDebug?.getPerf?.() || {};\n    const data = {\n      timestamp: Date.now(),\n      timers: perfData.timers || {},\n      counters: perfData.counters || {},\n      thresholds: Object.fromEntries(this.thresholds)\n    };\n\n    console.table(data.timers);\n    console.log('[PerformancePanel] Performance data:', data);\n\n    // Create downloadable export\n    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `msd-performance-${Date.now()}.json`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  }\n\n  captureData() {\n    const timers = {};\n    const counters = {};\n    const alerts = [];\n    const regressions = [];\n\n    try {\n      // FIXED: Use centralized debug status access for performance state\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n\n      // Get performance data using consistent approach\n      const perfData = window.__msdDebug?.getPerf?.() || {};\n\n      // Process timers\n      if (perfData.timers) {\n        Object.entries(perfData.timers).forEach(([key, data]) => {\n          const timerData = {\n            count: data.count || 0,\n            total: data.total || 0,\n            avg: data.count > 0 ? (data.total / data.count) : 0,\n            last: data.last || 0,\n            max: data.max || 0,\n            min: data.min || 0\n          };\n\n          timers[key] = timerData;\n\n          // Check thresholds\n          const threshold = this.thresholds.get(key);\n          if (threshold && timerData.avg > threshold.avgMs) {\n            alerts.push({\n              type: 'threshold',\n              timer: key,\n              current: timerData.avg,\n              threshold: threshold.avgMs,\n              severity: timerData.avg > threshold.avgMs * 2 ? 'high' : 'medium'\n            });\n          }\n\n          // Check for regressions\n          const previous = this.previousSnapshot[key];\n          if (previous && previous.avg > 0) {\n            const regression = ((timerData.avg - previous.avg) / previous.avg) * 100;\n            if (regression > 20) { // >20% increase\n              regressions.push({\n                timer: key,\n                previousAvg: previous.avg,\n                currentAvg: timerData.avg,\n                regression: regression\n              });\n            }\n          }\n        });\n      }\n\n      // Process counters\n      if (perfData.counters) {\n        Object.entries(perfData.counters).forEach(([key, value]) => {\n          counters[key] = Number(value) || 0;\n        });\n      }\n\n      // Store snapshot for regression detection\n      this.previousSnapshot = { ...timers };\n\n    } catch (e) {\n      console.warn('[PerformancePanel] Data capture failed:', e);\n    }\n\n    return { timers, counters, alerts, regressions };\n  }\n\n  renderHtml(performance) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Performance Monitor</h3>';\n\n    const { timers, counters, alerts, regressions } = performance;\n\n    // Controls section\n    html += '<div class=\"msd-hud-section\"><h4>Controls</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;\">';\n\n    html += `<button data-bus-event=\"performance:clear-all\" onclick=\"__msdHudBus('performance:clear-all')\"\n      style=\"font-size:10px;padding:2px 6px;background:#666;color:#fff;border:1px solid #888;border-radius:3px;cursor:pointer;\">\n      Clear All\n    </button>`;\n\n    html += `<button data-bus-event=\"performance:export\" onclick=\"__msdHudBus('performance:export')\"\n      style=\"font-size:10px;padding:2px 6px;background:#333;color:#fff;border:1px solid #555;border-radius:3px;cursor:pointer;\">\n      Export\n    </button>`;\n\n    html += '</div></div>';\n\n    // Alerts section\n    if (alerts && alerts.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-warning\"><h4>Threshold Alerts</h4>';\n      alerts.forEach(alert => {\n        const severityColor = alert.severity === 'high' ? '#ff4444' : '#ffaa00';\n        html += `<div class=\"msd-hud-metric msd-hud-warning\">\n          <span class=\"msd-hud-metric-name\" style=\"color:${severityColor};\">${alert.timer}</span>\n          <span class=\"msd-hud-metric-value\">${alert.current.toFixed(2)}ms > ${alert.threshold}ms</span>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Regressions section\n    if (regressions && regressions.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-error\"><h4>Performance Regressions</h4>';\n      regressions.forEach(regression => {\n        html += `<div class=\"msd-hud-metric msd-hud-error\">\n          <span class=\"msd-hud-metric-name\">${regression.timer}</span>\n          <span class=\"msd-hud-metric-value\">+${regression.regression.toFixed(1)}%</span>\n        </div>`;\n        html += `<div class=\"msd-hud-metric-detail\">\n          ${regression.previousAvg.toFixed(2)}ms  ${regression.currentAvg.toFixed(2)}ms\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Timers section\n    const timerEntries = Object.entries(timers || {}).slice(0, 10);\n    if (timerEntries.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Timers</h4>';\n\n      // Sort by average time descending\n      timerEntries.sort(([,a], [,b]) => b.avg - a.avg);\n\n      timerEntries.forEach(([key, data]) => {\n        const hasThreshold = this.thresholds.has(key);\n        const threshold = this.thresholds.get(key);\n        const isOverThreshold = hasThreshold && data.avg > threshold.avgMs;\n        const avgColor = isOverThreshold ? '#ff6666' : data.avg > 10 ? '#ffaa00' : '#66ff99';\n\n        html += `<div class=\"msd-hud-metric\" style=\"margin:4px 0;padding:4px;border:1px solid #333;border-radius:3px;\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${key}</span>\n            <span class=\"msd-hud-metric-value\" style=\"color:${avgColor};\">${data.avg.toFixed(2)}ms</span>\n          </div>\n          <div style=\"font-size:10px;color:#888;margin-top:2px;\">\n            Count: ${data.count}  Max: ${data.max.toFixed(1)}ms  Last: ${data.last.toFixed(1)}ms\n          </div>\n          <div style=\"display:flex;gap:4px;margin-top:4px;\">\n            <input type=\"number\" placeholder=\"Threshold (ms)\" value=\"${hasThreshold ? threshold.avgMs : ''}\"\n              id=\"perf-threshold-${key.replace(/[^a-z0-9_-]/gi,'-')}\"\n              name=\"perf-threshold-${key.replace(/[^a-z0-9_-]/gi,'-')}\"\n              data-bus-event=\"performance:set-threshold\" data-timer=\"${key}\"\n              onchange=\"__msdHudBus('performance:set-threshold',{timer:'${key}',value:this.value})\"\n              style=\"width:80px;font-size:9px;padding:1px 3px;\">\n            <button data-bus-event=\"performance:reset-timer\"\n              onclick=\"__msdHudBus('performance:reset-timer',{timer:'${key}'})\"\n              style=\"font-size:9px;padding:1px 4px;background:#555;color:#fff;border:1px solid #777;border-radius:2px;cursor:pointer;\">\n              Reset\n            </button>\n          </div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Counters section\n    const counterEntries = Object.entries(counters || {}).slice(0, 8);\n    if (counterEntries.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Counters</h4>';\n      counterEntries.forEach(([key, value]) => {\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">${key}</span>\n          <span class=\"msd-hud-metric-value\">${value}</span>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    if (timerEntries.length === 0 && counterEntries.length === 0) {\n      html += '<div class=\"msd-hud-section\">No performance data available</div>';\n    }\n\n    // Summary\n    const alertCount = alerts?.length || 0;\n    const regressionCount = regressions?.length || 0;\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${timerEntries.length} timers  ${counterEntries.length} counters\n      ${alertCount > 0 ? `  ${alertCount} alerts` : ''}\n      ${regressionCount > 0 ? `  ${regressionCount} regressions` : ''}\n    </div>`;\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Validation monitoring panel for MSD HUD\n * Displays validation errors and warnings with overlay highlighting\n */\n\nexport class ValidationPanel {\n  captureData() {\n    const errors = [];\n    const warnings = [];\n\n    try {\n      // FIXED: Use centralized silent debug status access\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n      let validationData = {};\n\n      if (debugStatus.enabled && window.__msdDebug?.validation?.issues) {\n        validationData = window.__msdDebug.validation.issues() || {};\n      } else {\n        // Fallback: try direct access without debug interface\n        validationData = window.__msdDebug?.pipelineInstance?.getValidationIssues?.() || {};\n      }\n\n      if (validationData.errors) {\n        validationData.errors.forEach(error => {\n          errors.push({\n            code: error.code || 'unknown',\n            severity: error.severity || 'error',\n            message: error.msg || error.message || 'Unknown error',\n            overlay: error.overlay,\n            anchor: error.anchor\n          });\n        });\n      }\n\n      if (validationData.warnings) {\n        validationData.warnings.forEach(warning => {\n          warnings.push({\n            code: warning.code || 'unknown',\n            severity: warning.severity || 'warning',\n            message: warning.msg || warning.message || 'Unknown warning',\n            overlay: warning.overlay,\n            anchor: warning.anchor\n          });\n        });\n      }\n    } catch (_) {}\n\n    return { errors, warnings };\n  }\n\n  renderHtml(validation) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Validation</h3>';\n\n    // Errors section\n    const errors = validation.errors || [];\n    if (errors.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-errors\"><h4>Errors</h4>';\n      errors.slice(0, 6).forEach(error => {\n        html += `<div class=\"msd-hud-metric msd-hud-error\"\n          data-select-type=\"${error.overlay ? 'overlay':'anchor'}\"\n          data-select-id=\"${error.overlay || error.anchor || error.code}\"\n          onclick=\"__msdHudBus('select:set',{type:'${error.overlay ? 'overlay':'anchor'}',id:'${error.overlay || error.anchor || error.code}',source:'validation'})\"\n        >\n          <span class=\"msd-hud-metric-name\">${error.code}</span>\n          <span class=\"msd-hud-metric-value\">${error.message}</span>\n        </div>`;\n        if (error.overlay) {\n          html += `<div class=\"msd-hud-metric-detail\">Overlay: ${error.overlay}</div>`;\n        }\n        if (error.anchor) {\n          html += `<div class=\"msd-hud-metric-detail\">Anchor: ${error.anchor}</div>`;\n        }\n      });\n      html += '</div>';\n    }\n\n    // Warnings section\n    const warnings = validation.warnings || [];\n    if (warnings.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-warnings\"><h4>Warnings</h4>';\n      warnings.slice(0, 6).forEach(warning => {\n        html += `<div class=\"msd-hud-metric msd-hud-warning\"\n          data-select-type=\"${warning.overlay ? 'overlay':'anchor'}\"\n          data-select-id=\"${warning.overlay || warning.anchor || warning.code}\"\n          onclick=\"__msdHudBus('select:set',{type:'${warning.overlay ? 'overlay':'anchor'}',id:'${warning.overlay || warning.anchor || warning.code}',source:'validation'})\"\n        >\n          <span class=\"msd-hud-metric-name\">${warning.code}</span>\n          <span class=\"msd-hud-metric-value\">${warning.message}</span>\n        </div>`;\n        if (warning.overlay) {\n          html += `<div class=\"msd-hud-metric-detail\">Overlay: ${warning.overlay}</div>`;\n        }\n      });\n      html += '</div>';\n    }\n\n    // Status section\n    const totalIssues = errors.length + warnings.length;\n    if (totalIssues === 0) {\n      html += '<div class=\"msd-hud-section msd-hud-success\"> No validation issues</div>';\n    } else {\n      html += `<div class=\"msd-hud-section msd-hud-summary\">\n        ${errors.length} errors, ${warnings.length} warnings\n      </div>`;\n    }\n\n    html += '</div>';\n    return html;\n\n}\n}\n","/**\n * Enhanced Data source monitoring panel for MSD HUD\n * DataSourceManager integration health checks and subscription diagnostics\n */\n\nexport class DataSourcePanel {\n  constructor() {\n    this.entityChangeHistory = new Map(); // entityId -> recent state changes\n    this.maxHistoryLength = 10;\n\n    // ADDED: Set up global helper functions\n    this._setupGlobalHelpers();\n  }\n\n  // ADDED: Setup simple global helper functions with direct access\n  _setupGlobalHelpers() {\n    // Global entity inspection function with direct DataSourceManager access\n    window.__msdInspectDataEntity = (entityId) => {\n      console.log('[DataSourcePanel] Inspecting entity:', entityId);\n\n      const dsManager = window.__msdDebug?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n\n      if (!dsManager?.getEntity) {\n        console.warn('[DataSourcePanel] DataSourceManager not available');\n        return;\n      }\n\n      const entity = dsManager.getEntity(entityId);\n      if (!entity) {\n        console.warn('[DataSourcePanel] Entity not found:', entityId);\n        return;\n      }\n\n      // Show available methods for debugging\n      console.log('[DataSourcePanel] Available dsManager methods:', Object.getOwnPropertyNames(dsManager).filter(name => typeof dsManager[name] === 'function'));\n\n      // Console logging\n      console.group(` Entity Inspection: ${entityId}`);\n      console.log('Entity Data:', entity);\n      console.table([entity]);\n      console.groupEnd();\n\n      // Show popup with the entity data we just retrieved\n      this._showEntityPopup(entityId, entity);\n    };\n\n    // Global subscription inspection function with direct DataSourceManager access\n    window.__msdInspectDataSubscription = (sourceName) => {\n      console.log('[DataSourcePanel] Inspecting subscription:', sourceName);\n\n      const dsManager = window.__msdDebug?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n\n      if (!dsManager?.getStats) {\n        console.warn('[DataSourcePanel] DataSourceManager not available');\n        return;\n      }\n\n      const stats = dsManager.getStats() || {};\n      const sourceData = stats.sources?.[sourceName] || {};\n\n      // ADDED: Get subscriber details using new API\n      let subscribers = [];\n      try {\n        subscribers = dsManager.getSourceSubscribers?.(sourceName) || [];\n        console.log('[DataSourcePanel] Found subscribers via API:', subscribers);\n      } catch (e) {\n        console.warn('[DataSourcePanel] Error getting subscribers:', e);\n      }\n\n      // Console logging\n      console.group(` Subscription Inspection: ${sourceName}`);\n      console.log('Source Stats:', sourceData);\n      console.log('Subscribers:', subscribers);\n      console.log('All Stats:', stats);\n      console.groupEnd();\n\n      // Show popup with the subscription data and subscriber details\n      this._showSubscriptionPopup(sourceName, sourceData, subscribers);\n    };    // Simple refresh function\n    window.__msdRefreshDataSources = () => {\n      const dsManager = window.__msdDebug?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.dataSourceManager ||\n                       window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n\n      if (dsManager?.refreshSubscriptions) {\n        dsManager.refreshSubscriptions();\n        console.log('[DataSourcePanel] Subscriptions refreshed');\n      } else {\n        console.warn('[DataSourcePanel] Refresh not available');\n      }\n\n      // Trigger HUD refresh\n      if (window.__msdDebug?.hud?.refresh) {\n        window.__msdDebug.hud.refresh();\n      }\n    };\n  }\n\n  // SIMPLE: Show entity popup using fresh DataSourceManager data\n  _showEntityPopup(entityId, entity) {\n    // Remove any existing popup\n    const existing = document.getElementById('msd-entity-inspection-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-entity-inspection-popup';\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #66ff99;\n      padding: 20px;\n      border: 2px solid #66ff99;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 700px;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 4px 20px rgba(102, 255, 153, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 16px;color:#ffaa00;\"> Entity Inspection: ${entityId}</h3>`;\n\n    // Basic entity information\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#88ffcc;\"> Entity State</h4>\n        <div style=\"display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px;\">\n          <div><strong>Current State:</strong> <span style=\"color:#ffcc88;\">${entity.state || 'N/A'}</span></div>\n          <div><strong>Domain:</strong> ${entityId.split('.')[0]}</div>\n          <div><strong>Last Changed:</strong> ${entity.last_changed ? new Date(entity.last_changed).toLocaleString() : 'N/A'}</div>\n          <div><strong>Last Updated:</strong> ${entity.last_updated ? new Date(entity.last_updated).toLocaleString() : 'N/A'}</div>\n        </div>\n      </div>\n    `;\n\n    // Entity attributes\n    if (entity.attributes && Object.keys(entity.attributes).length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\"> Attributes (${Object.keys(entity.attributes).length})</h4>\n          <div style=\"font-size:10px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;\">\n      `;\n\n      Object.entries(entity.attributes).forEach(([key, value]) => {\n        const displayValue = typeof value === 'object' ? JSON.stringify(value) : String(value);\n        const truncatedValue = displayValue.length > 60 ? displayValue.substring(0, 57) + '...' : displayValue;\n        content += `<div style=\"margin:2px 0;\"><strong style=\"color:#99ddff;\">${key}:</strong> <span style=\"color:#ccc;\">${truncatedValue}</span></div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Raw entity data\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#88ffcc;\"> Raw Entity Data</h4>\n        <div style=\"font-size:9px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;word-break:break-all;color:#aaa;\">\n          ${JSON.stringify(entity, null, 2)}\n        </div>\n      </div>\n    `;\n\n    // Action buttons\n    content += `\n      <div style=\"text-align:center;margin-top:20px;border-top:1px solid #333;padding-top:16px;\">\n        <button onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(entity)}, null, 2)); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy Entity', 2000);\"\n          style=\"background:#225522;color:#fff;border:1px solid #55aa55;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Copy Entity\n        </button>\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n  }\n\n  // UPDATED: Show subscription popup with basic subscriber details\n  _showSubscriptionPopup(sourceName, sourceData, subscribers = []) {\n    // Remove any existing popup\n    const existing = document.getElementById('msd-subscription-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-subscription-popup';\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #ffaa66;\n      padding: 20px;\n      border: 2px solid #ffaa66;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 600px;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 4px 20px rgba(255, 170, 102, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 16px;color:#ff9900;\"> Subscription: ${sourceName}</h3>`;\n\n    // Subscription statistics\n    if (sourceData && Object.keys(sourceData).length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#ffcc88;\"> Statistics</h4>\n          <div style=\"display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px;\">\n            <div><strong>Subscribers:</strong> <span style=\"color:#88ccff;\">${sourceData.subscribers || 0}</span></div>\n            <div><strong>Updates Received:</strong> <span style=\"color:#88ff88;\">${sourceData.received || 0}</span></div>\n            <div><strong>Cache Hits:</strong> <span style=\"color:#ffcc88;\">${sourceData.cacheHits || 0}</span></div>\n            <div><strong>Errors:</strong> <span style=\"color:${sourceData.errors > 0 ? '#ff6666' : '#888'};\">${sourceData.errors || 0}</span></div>\n            <div><strong>Last Update:</strong> ${sourceData.lastUpdate ? new Date(sourceData.lastUpdate).toLocaleString() : 'Never'}</div>\n          </div>\n        </div>\n      `;\n\n      // Cache hit rate\n      if (sourceData.received > 0) {\n        const hitRate = ((sourceData.cacheHits || 0) / sourceData.received * 100).toFixed(1);\n        content += `\n          <div style=\"margin-bottom:16px;\">\n            <h4 style=\"margin:0 0 8px;color:#ffcc88;\"> Performance</h4>\n            <div style=\"font-size:11px;\">\n              <div><strong>Cache Hit Rate:</strong> <span style=\"color:#88ff88;\">${hitRate}%</span></div>\n            </div>\n          </div>\n        `;\n      }\n    }\n\n    // ADDED: Basic subscriber details section\n    if (subscribers && subscribers.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#ffcc88;\"> Subscribers (${subscribers.length})</h4>\n          <div style=\"font-size:10px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:120px;overflow-y:auto;\">\n      `;\n\n      subscribers.forEach((subscriber, i) => {\n        const name = subscriber.name || subscriber.id || `Subscriber ${i + 1}`;\n        const type = subscriber.type || 'unknown';\n        content += `<div style=\"margin:2px 0;color:#ccc;\"> ${name} <span style=\"color:#888;\">(${type})</span></div>`;\n      });\n\n      content += `</div></div>`;\n    } else if (sourceData.subscribers > 0) {\n      // Show that we know there are subscribers but couldn't get details\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#ffcc88;\"> Subscribers</h4>\n          <div style=\"font-size:11px;color:#888;\">\n            ${sourceData.subscribers} active subscriber${sourceData.subscribers === 1 ? '' : 's'} (basic details available)\n          </div>\n        </div>\n      `;\n    }\n\n    // Raw data section\n    const combinedData = { stats: sourceData, subscribers };\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#ffcc88;\"> Raw Data</h4>\n        <div style=\"font-size:9px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;word-break:break-all;color:#aaa;\">\n          ${JSON.stringify(combinedData, null, 2)}\n        </div>\n      </div>\n    `;\n\n    // Action buttons\n    content += `\n      <div style=\"text-align:center;margin-top:20px;border-top:1px solid #333;padding-top:16px;\">\n        <button onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(combinedData)}, null, 2)); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy Data', 2000);\"\n          style=\"background:#552200;color:#fff;border:1px solid #aa5500;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Copy Data\n        </button>\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n  }\n\n  // NEW: Create detailed entity inspection popup\n  _createEntityPopup(entityId, entity, extras = {}) {\n    // Remove any existing popup\n    const existing = document.getElementById('msd-entity-inspection-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-entity-inspection-popup';\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #66ff99;\n      padding: 20px;\n      border: 2px solid #66ff99;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 700px;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 4px 20px rgba(102, 255, 153, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 16px;color:#ffaa00;\"> Entity Inspection: ${entityId}</h3>`;\n\n    // Basic entity information\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#88ffcc;\"> Entity State</h4>\n        <div style=\"display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px;\">\n          <div><strong>Current State:</strong> <span style=\"color:#ffcc88;\">${entity.state || 'N/A'}</span></div>\n          <div><strong>Domain:</strong> ${entityId.split('.')[0]}</div>\n          <div><strong>Last Changed:</strong> ${entity.last_changed ? new Date(entity.last_changed).toLocaleString() : 'N/A'}</div>\n          <div><strong>Last Updated:</strong> ${entity.last_updated ? new Date(entity.last_updated).toLocaleString() : 'N/A'}</div>\n        </div>\n      </div>\n    `;\n\n    // Entity attributes\n    if (entity.attributes && Object.keys(entity.attributes).length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\"> Attributes</h4>\n          <div style=\"font-size:10px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:150px;overflow-y:auto;\">\n      `;\n\n      Object.entries(entity.attributes).forEach(([key, value]) => {\n        const displayValue = typeof value === 'object' ? JSON.stringify(value) : String(value);\n        const truncatedValue = displayValue.length > 50 ? displayValue.substring(0, 47) + '...' : displayValue;\n        content += `<div style=\"margin:2px 0;\"><strong style=\"color:#99ddff;\">${key}:</strong> <span style=\"color:#ccc;\">${truncatedValue}</span></div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Change history\n    if (extras.history) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\"> Recent Activity</h4>\n          <div style=\"font-size:11px;color:#ccc;\">\n            <div><strong>Previous State:</strong> ${extras.history.state || 'N/A'}</div>\n            <div><strong>Changed:</strong> ${new Date(extras.history.timestamp).toLocaleString()}</div>\n          </div>\n        </div>\n      `;\n    }\n\n    // Subscribers\n    if (extras.subscribers && extras.subscribers.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\"> Subscribers (${extras.subscribers.length})</h4>\n          <div style=\"font-size:10px;color:#ccc;\">\n      `;\n\n      extras.subscribers.forEach((subscriber, i) => {\n        const subscriberName = typeof subscriber === 'string' ? subscriber : (subscriber.name || subscriber.id || `Subscriber ${i + 1}`);\n        content += `<div style=\"margin:2px 0;\"> ${subscriberName}</div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Transforms\n    if (extras.transforms && extras.transforms.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\"> Transforms (${extras.transforms.length})</h4>\n          <div style=\"font-size:10px;color:#ccc;\">\n      `;\n\n      extras.transforms.forEach((transform, i) => {\n        const transformName = typeof transform === 'string' ? transform : (transform.type || transform.name || `Transform ${i + 1}`);\n        content += `<div style=\"margin:2px 0;\"> ${transformName}</div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Calculations\n    if (extras.calculations && extras.calculations.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ffcc;\"> Calculations (${extras.calculations.length})</h4>\n          <div style=\"font-size:10px;color:#ccc;\">\n      `;\n\n      extras.calculations.forEach((calc, i) => {\n        const calcName = typeof calc === 'string' ? calc : (calc.type || calc.name || `Calculation ${i + 1}`);\n        content += `<div style=\"margin:2px 0;\"> ${calcName}</div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Raw entity data\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#88ffcc;\"> Raw Entity Data</h4>\n        <div style=\"font-size:9px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;word-break:break-all;color:#aaa;\">\n          ${JSON.stringify(entity, null, 2)}\n        </div>\n      </div>\n    `;\n\n    // Action buttons\n    content += `\n      <div style=\"text-align:center;margin-top:20px;border-top:1px solid #333;padding-top:16px;\">\n        <button onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(entity)}, null, 2)); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy Entity', 2000);\"\n          style=\"background:#225522;color:#fff;border:1px solid #55aa55;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Copy Entity\n        </button>\n        <button onclick=\"console.log('Entity ${entityId}:', ${JSON.stringify(entity)}); this.textContent='Logged!'; setTimeout(() => this.textContent='Log to Console', 2000);\"\n          style=\"background:#552255;color:#fff;border:1px solid #aa55aa;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Log to Console\n        </button>\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n  }\n\n  // NEW: Show subscription inspection popup using stored data\n  _showSubscriptionInspectionPopup(sourceName) {\n    try {\n      if (!this._currentData?.subscriptions) {\n        console.warn('[DataSourcePanel] No subscription data available');\n        return;\n      }\n\n      const sourceData = this._currentData.subscriptions[sourceName];\n      if (!sourceData) {\n        console.warn('[DataSourcePanel] Subscription not found:', sourceName);\n        return;\n      }\n\n      // Log to console\n      console.group(` Subscription Inspection: ${sourceName}`);\n      console.log('Source Stats:', sourceData);\n      console.groupEnd();\n\n      // Show detailed popup\n      this._createSubscriptionPopup(sourceName, sourceData, {});\n\n    } catch (e) {\n      console.warn('[DataSourcePanel] Subscription inspection failed:', e);\n    }\n  }\n\n  // NEW: Create subscription inspection popup\n  _createSubscriptionPopup(sourceName, sourceData, details) {\n    // Remove any existing popup\n    const existing = document.getElementById('msd-subscription-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-subscription-popup';\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #ffaa66;\n      padding: 20px;\n      border: 2px solid #ffaa66;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 600px;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 4px 20px rgba(255, 170, 102, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 16px;color:#ff9900;\"> Subscription: ${sourceName}</h3>`;\n\n    // Subscription statistics\n    if (sourceData && Object.keys(sourceData).length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#ffcc88;\"> Statistics</h4>\n          <div style=\"display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px;\">\n            <div><strong>Subscribers:</strong> <span style=\"color:#88ccff;\">${sourceData.subscribers || 0}</span></div>\n            <div><strong>Updates Received:</strong> <span style=\"color:#88ff88;\">${sourceData.received || 0}</span></div>\n            <div><strong>Cache Hits:</strong> <span style=\"color:#ffcc88;\">${sourceData.cacheHits || 0}</span></div>\n            <div><strong>Errors:</strong> <span style=\"color:${sourceData.errors > 0 ? '#ff6666' : '#888'};\">${sourceData.errors || 0}</span></div>\n            <div><strong>Last Update:</strong> ${sourceData.lastUpdate ? new Date(sourceData.lastUpdate).toLocaleString() : 'Never'}</div>\n          </div>\n        </div>\n      `;\n\n      // Cache hit rate\n      if (sourceData.received > 0) {\n        const hitRate = ((sourceData.cacheHits || 0) / sourceData.received * 100).toFixed(1);\n        content += `\n          <div style=\"margin-bottom:16px;\">\n            <h4 style=\"margin:0 0 8px;color:#ffcc88;\"> Performance</h4>\n            <div style=\"font-size:11px;\">\n              <div><strong>Cache Hit Rate:</strong> <span style=\"color:#88ff88;\">${hitRate}%</span></div>\n            </div>\n          </div>\n        `;\n      }\n    }\n\n    // Detailed subscription info\n    if (details && Object.keys(details).length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#ffcc88;\"> Details</h4>\n          <div style=\"font-size:10px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;\">\n      `;\n\n      Object.entries(details).forEach(([key, value]) => {\n        const displayValue = typeof value === 'object' ? JSON.stringify(value, null, 2) : String(value);\n        content += `<div style=\"margin:3px 0;\"><strong style=\"color:#ffaa88;\">${key}:</strong><br><span style=\"color:#ccc;margin-left:10px;\">${displayValue}</span></div>`;\n      });\n\n      content += `</div></div>`;\n    }\n\n    // Raw data section\n    const combinedData = { stats: sourceData, details };\n    content += `\n      <div style=\"margin-bottom:16px;\">\n        <h4 style=\"margin:0 0 8px;color:#ffcc88;\"> Raw Data</h4>\n        <div style=\"font-size:9px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;max-height:200px;overflow-y:auto;word-break:break-all;color:#aaa;\">\n          ${JSON.stringify(combinedData, null, 2)}\n        </div>\n      </div>\n    `;\n\n    // Action buttons\n    content += `\n      <div style=\"text-align:center;margin-top:20px;border-top:1px solid #333;padding-top:16px;\">\n        <button onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(combinedData)}, null, 2)); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy Data', 2000);\"\n          style=\"background:#552200;color:#fff;border:1px solid #aa5500;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Copy Data\n        </button>\n        <button onclick=\"console.log('Subscription ${sourceName}:', ${JSON.stringify(combinedData)}); this.textContent='Logged!'; setTimeout(() => this.textContent='Log to Console', 2000);\"\n          style=\"background:#552255;color:#fff;border:1px solid #aa55aa;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Log to Console\n        </button>\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n  }\n\n  refreshSubscriptions() {\n    // REMOVED: Not useful - DataSourceManager doesn't have refreshSubscriptions method\n    // and HUD auto-refreshes anyway\n    console.log('[DataSourcePanel] Refresh functionality removed - HUD auto-refreshes');\n  }\n\n  clearHistory() {\n    // REMOVED: Only clears internal panel history, rebuilds automatically\n    // this.entityChangeHistory.clear();\n    console.log('[DataSourcePanel] Clear history functionality removed - limited utility');\n  }\n\n  captureData() {\n    const entities = {};\n    const stats = {};\n    const health = {};\n    const subscriptions = {};\n    const recentChanges = [];\n\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      const dsManager = pipelineInstance?.dataSourceManager ||\n                       pipelineInstance?.systemsManager?.dataSourceManager ||\n                       window.__msdDebug?.dataSourceManager;\n\n      if (dsManager) {\n        // Get comprehensive stats\n        const entityIds = dsManager.listIds?.() || [];\n        const dsStats = dsManager.getStats?.() || {};\n        const healthCheck = dsManager.getHealth?.() || {};\n\n        // Transform stats\n        stats.count = entityIds.length;\n        stats.subscribed = Object.keys(dsStats.sources || {}).length;\n        stats.updated = Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.received || 0), 0);\n        stats.cacheHits = Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.cacheHits || 0), 0);\n        stats.errors = Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.errors || 0), 0);\n\n        // Health metrics\n        if (healthCheck.status) {\n          health.status = healthCheck.status;\n          health.uptime = healthCheck.uptime || 0;\n          health.lastError = healthCheck.lastError;\n          health.connectionCount = healthCheck.connectionCount || 0;\n        }\n\n        // Subscription details\n        if (dsStats.sources) {\n          Object.entries(dsStats.sources).forEach(([sourceName, sourceData]) => {\n            subscriptions[sourceName] = {\n              subscribers: sourceData.subscribers || 0,\n              received: sourceData.received || 0,\n              errors: sourceData.errors || 0,\n              lastUpdate: sourceData.lastUpdate,\n              cacheHits: sourceData.cacheHits || 0\n            };\n          });\n        }\n\n        // Sample recent entities and track changes\n        entityIds.slice(0, 15).forEach(id => {\n          const entity = dsManager.getEntity?.(id);\n          if (entity) {\n            // Track state changes\n            const previousState = this.entityChangeHistory.get(id);\n            if (previousState && previousState.state !== entity.state) {\n              recentChanges.push({\n                id: id,\n                from: previousState.state,\n                to: entity.state,\n                timestamp: Date.now()\n              });\n            }\n\n            // Store current state\n            this.entityChangeHistory.set(id, {\n              state: entity.state,\n              timestamp: Date.now()\n            });\n\n            // Trim history\n            if (this.entityChangeHistory.size > this.maxHistoryLength) {\n              const oldestKey = this.entityChangeHistory.keys().next().value;\n              this.entityChangeHistory.delete(oldestKey);\n            }\n\n            entities[id] = {\n              state: entity.state,\n              lastChanged: entity.last_changed,\n              lastUpdated: entity.last_updated,\n              attributes: entity.attributes || {},\n              domain: id.split('.')[0] // Extract domain for grouping\n            };\n          }\n        });\n\n      } else {\n        console.warn('[DataSourcePanel] DataSourceManager not available via consolidated interface');\n        stats.error = 'DataSourceManager not available';\n      }\n    } catch (e) {\n      console.warn('[DataSourcePanel] Data capture failed:', e);\n      stats.error = e.message;\n    }\n\n    return { entities, stats, health, subscriptions, recentChanges };\n  }\n\n  renderHtml(entityData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Data Sources</h3>';\n\n    const { entities, stats, health, subscriptions, recentChanges } = entityData;\n\n    // ADDED: Store data for popup access\n    this._currentData = entityData;\n\n    // Error handling\n    if (stats.error) {\n      html += `<div class=\"msd-hud-section msd-hud-error\">\n        <h4>Error</h4>\n        <div class=\"msd-hud-metric-value\">${stats.error}</div>\n      </div>`;\n      html += '</div>';\n      return html;\n    }\n\n    // Health section\n    if (health && health.status) {\n      const statusColor = health.status === 'healthy' ? '#66ff99' :\n                         health.status === 'warning' ? '#ffaa00' : '#ff6666';\n\n      html += '<div class=\"msd-hud-section\"><h4>Health Status</h4>';\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Status</span>\n        <span class=\"msd-hud-metric-value\" style=\"color:${statusColor};\">${health.status}</span>\n      </div>`;\n\n      if (health.uptime > 0) {\n        const uptimeHours = (health.uptime / (1000 * 60 * 60)).toFixed(1);\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">Uptime</span>\n          <span class=\"msd-hud-metric-value\">${uptimeHours}h</span>\n        </div>`;\n      }\n\n      if (health.connectionCount !== undefined) {\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">Connections</span>\n          <span class=\"msd-hud-metric-value\">${health.connectionCount}</span>\n        </div>`;\n      }\n\n      if (health.lastError) {\n        html += `<div class=\"msd-hud-metric msd-hud-warning\">\n          <span class=\"msd-hud-metric-name\">Last Error</span>\n          <span class=\"msd-hud-metric-value\">${health.lastError}</span>\n        </div>`;\n      }\n\n      html += '</div>';\n    }\n\n    // Enhanced statistics section\n    html += '<div class=\"msd-hud-section\"><h4>Statistics</h4>';\n    html += `<div class=\"msd-hud-metric\">\n      <span class=\"msd-hud-metric-name\">Total Entities</span>\n      <span class=\"msd-hud-metric-value\">${stats.count || 0}</span>\n    </div>`;\n    html += `<div class=\"msd-hud-metric\">\n      <span class=\"msd-hud-metric-name\">Data Sources</span>\n      <span class=\"msd-hud-metric-value\">${stats.subscribed || 0}</span>\n    </div>`;\n    html += `<div class=\"msd-hud-metric\">\n      <span class=\"msd-hud-metric-name\">Total Updates</span>\n      <span class=\"msd-hud-metric-value\">${stats.updated || 0}</span>\n    </div>`;\n    if (stats.cacheHits !== undefined) {\n      const hitRate = stats.updated > 0 ? ((stats.cacheHits / stats.updated) * 100).toFixed(1) : '0';\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Cache Hit Rate</span>\n        <span class=\"msd-hud-metric-value\">${hitRate}%</span>\n      </div>`;\n    }\n    if (stats.errors !== undefined && stats.errors > 0) {\n      html += `<div class=\"msd-hud-metric msd-hud-warning\">\n        <span class=\"msd-hud-metric-name\">Errors</span>\n        <span class=\"msd-hud-metric-value\">${stats.errors}</span>\n      </div>`;\n    }\n    html += '</div>';\n\n    // Subscription diagnostics\n    if (subscriptions && Object.keys(subscriptions).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Active Subscriptions</h4>';\n      Object.entries(subscriptions).slice(0, 6).forEach(([sourceName, sourceData]) => {\n        const shortName = sourceName.length > 18 ? sourceName.substring(0, 15) + '...' : sourceName;\n        const hasErrors = sourceData.errors > 0;\n        const errorClass = hasErrors ? 'msd-hud-warning' : '';\n\n        html += `<div class=\"msd-hud-metric ${errorClass}\" style=\"cursor:pointer;\"\n          onclick=\"window.__msdInspectDataSubscription('${sourceName}')\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortName}</span>\n            <span class=\"msd-hud-metric-value\">${sourceData.subscribers} subs</span>\n          </div>\n          <div style=\"font-size:10px;color:#888;margin-top:2px;\">\n            ${sourceData.received} updates  ${sourceData.cacheHits} cached\n            ${hasErrors ? `  ${sourceData.errors} errors` : ''}\n          </div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Recent state changes\n    if (recentChanges && recentChanges.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Recent Changes</h4>';\n      recentChanges.slice(-5).forEach(change => {\n        const shortId = change.id.length > 20 ? change.id.substring(0, 17) + '...' : change.id;\n        const timeAgo = Math.round((Date.now() - change.timestamp) / 1000);\n\n        html += `<div class=\"msd-hud-metric\" style=\"cursor:pointer;\"\n          onclick=\"window.__msdInspectDataEntity('${change.id}')\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span style=\"font-size:10px;color:#888;\">${timeAgo}s ago</span>\n          </div>\n          <div class=\"msd-hud-metric-value\" style=\"font-size:10px;color:#ccc;margin-top:1px;\">\n            ${change.from}  ${change.to}\n          </div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Entity samples by domain\n    const entities_entries = Object.entries(entities || {});\n    if (entities_entries.length > 0) {\n      // Group by domain\n      const byDomain = {};\n      entities_entries.forEach(([id, entity]) => {\n        const domain = entity.domain || 'unknown';\n        if (!byDomain[domain]) byDomain[domain] = [];\n        byDomain[domain].push([id, entity]);\n      });\n\n      html += '<div class=\"msd-hud-section\"><h4>Entity Samples</h4>';\n      Object.entries(byDomain).slice(0, 4).forEach(([domain, domainEntities]) => {\n        html += `<div style=\"margin-bottom:6px;\">\n          <div style=\"font-weight:bold;font-size:11px;color:#ffaa00;\">${domain} (${domainEntities.length})</div>`;\n\n        domainEntities.slice(0, 3).forEach(([id, entity]) => {\n          const shortId = id.length > 20 ? id.substring(0, 17) + '...' : id;\n          const stateValue = entity.state || 'N/A';\n          const shortState = stateValue.length > 12 ? stateValue.substring(0, 9) + '...' : stateValue;\n\n          html += `<div class=\"msd-hud-metric\" style=\"cursor:pointer;margin-left:10px;\"\n            onclick=\"window.__msdInspectDataEntity('${id}')\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span class=\"msd-hud-metric-value\">${shortState}</span>\n          </div>`;\n        });\n\n        html += '</div>';\n      });\n      html += '</div>';\n    } else if (stats.count > 0) {\n      html += '<div class=\"msd-hud-section\">Entities available but no recent data</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No entity data available</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n}\n\n","/**\n * Enhanced Routing diagnostics panel for MSD HUD\n * Displays routing statistics and path computation data with filtering and analysis\n */\n\nexport class RoutingPanel {\n  constructor() {\n    this.filters = {\n      strategy: 'all',\n      minCost: 0,\n      maxCost: 1500, // FIXED: Increased from 1000 to 1500\n      cacheHit: 'all',\n      showArcs: false\n    };\n\n    // FIXED: Track input focus to prevent refresh interference\n    this.inputStates = {\n      minCostFocused: false,\n      maxCostFocused: false\n    };\n\n    // ADDED: Set up global helper function for route analysis\n    this._setupGlobalHelpers();\n  }\n\n  // ADDED: Setup global helper functions\n  _setupGlobalHelpers() {\n    // Global route analysis function that includes both console and popup\n    window.__msdAnalyzeRoute = (routeId) => {\n      console.log('[RoutingPanel] Global analyze for:', routeId);\n\n      const routing = window.__msdDebug?.routing;\n      if (!routing?.inspect) {\n        console.warn('[RoutingPanel] No routing inspector available');\n        return;\n      }\n\n      const analysis = routing.inspect(routeId);\n\n      // Console logging (same as before)\n      console.group(` Route Analysis: ${routeId}`);\n\n      if (analysis.meta) {\n        console.table({\n          Strategy: analysis.meta.strategy || 'unknown',\n          Cost: analysis.meta.cost || 0,\n          Segments: analysis.meta.segments || 0,\n          Bends: analysis.meta.bends || 0,\n          'Cache Hit': analysis.meta.cache_hit ? ' Yes' : ' No'\n        });\n      }\n\n      if (analysis.pts && analysis.pts.length > 0) {\n        console.log(' Path Points:', analysis.pts.length, 'points');\n        console.table(analysis.pts.map((pt, i) => ({\n          Index: i,\n          X: pt[0],\n          Y: pt[1],\n          Type: i === 0 ? 'Start' : i === analysis.pts.length - 1 ? 'End' : 'Waypoint'\n        })));\n      }\n\n      if (analysis.meta?.hint) {\n        console.log(' Routing Hints:');\n        console.table(analysis.meta.hint);\n      }\n\n      if (analysis.d) {\n        const pathData = analysis.d.length > 100 ? analysis.d.substring(0, 97) + '...' : analysis.d;\n        console.log(' SVG Path:', pathData);\n      }\n\n      console.log(' Full Analysis Object:', analysis);\n      console.groupEnd();\n\n      // Show popup (same as showRouteAnalysisFeedback)\n      this._showRouteAnalysisPopup(routeId, analysis);\n    };\n  }\n\n  // ADDED: Show route analysis popup (extracted from showRouteAnalysisFeedback)\n  _showRouteAnalysisPopup(routeId, analysis) {\n    // Remove any existing popup\n    const existing = document.getElementById('msd-route-analysis-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-route-analysis-popup';\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #00ffff;\n      padding: 20px;\n      border: 2px solid #00ffff;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 600px;\n      max-height: 80vh;\n      overflow-y: auto;\n      box-shadow: 0 4px 20px rgba(0, 255, 255, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 16px;color:#ffaa00;\"> Route Analysis: ${routeId}</h3>`;\n\n    // Basic routing information\n    if (analysis.meta) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\"> Routing Metrics</h4>\n          <div style=\"display:grid;grid-template-columns:1fr 1fr;gap:8px;font-size:11px;\">\n            <div><strong>Strategy:</strong> ${analysis.meta.strategy || 'unknown'}</div>\n            <div><strong>Cost:</strong> <span style=\"color:#ffcc88;\">${analysis.meta.cost || 0}</span></div>\n            <div><strong>Segments:</strong> ${analysis.meta.segments || 0}</div>\n            <div><strong>Bends:</strong> <span style=\"color:#ff99cc;\">${analysis.meta.bends || 0}</span></div>\n            <div><strong>Cache Hit:</strong> ${analysis.meta.cache_hit ? '<span style=\"color:#66ff99;\"> Yes</span>' : '<span style=\"color:#ff6666;\"> No</span>'}</div>\n            <div><strong>Smooth:</strong> ${analysis.meta.smooth ? ' Yes' : ' No'}</div>\n          </div>\n        </div>\n      `;\n    }\n\n    // Path points detail\n    if (analysis.pts && analysis.pts.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\"> Path Points (${analysis.pts.length} total)</h4>\n          <div style=\"font-size:10px;margin-bottom:8px;\">\n            <strong>Start:</strong> (${analysis.pts[0][0]}, ${analysis.pts[0][1]})<br>\n            <strong>End:</strong> (${analysis.pts[analysis.pts.length-1][0]}, ${analysis.pts[analysis.pts.length-1][1]})\n          </div>\n      `;\n\n      // Show all points if not too many, otherwise show first few and last few\n      if (analysis.pts.length <= 8) {\n        content += `<div style=\"font-size:10px;color:#ccc;\">`;\n        analysis.pts.forEach((pt, i) => {\n          const type = i === 0 ? 'Start' : i === analysis.pts.length - 1 ? 'End' : 'Waypoint';\n          content += `<div>${i}: (${pt[0]}, ${pt[1]}) - ${type}</div>`;\n        });\n        content += `</div>`;\n      } else {\n        content += `<div style=\"font-size:10px;color:#ccc;\">`;\n        // Show first 3 points\n        for (let i = 0; i < 3; i++) {\n          const pt = analysis.pts[i];\n          const type = i === 0 ? 'Start' : 'Waypoint';\n          content += `<div>${i}: (${pt[0]}, ${pt[1]}) - ${type}</div>`;\n        }\n        content += `<div style=\"color:#888;\">... ${analysis.pts.length - 5} intermediate points ...</div>`;\n        // Show last 2 points\n        for (let i = analysis.pts.length - 2; i < analysis.pts.length; i++) {\n          const pt = analysis.pts[i];\n          const type = i === analysis.pts.length - 1 ? 'End' : 'Waypoint';\n          content += `<div>${i}: (${pt[0]}, ${pt[1]}) - ${type}</div>`;\n        }\n        content += `</div>`;\n      }\n      content += `</div>`;\n    }\n\n    // Routing hints\n    if (analysis.meta?.hint) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\"> Routing Hints</h4>\n          <div style=\"font-size:11px;color:#ccc;\">\n            <div><strong>First:</strong> ${analysis.meta.hint.first || 'n/a'}\n                 <span style=\"color:#888;\">(${analysis.meta.hint.sourceFirst || 'n/a'})</span></div>\n            <div><strong>Last:</strong> ${analysis.meta.hint.last || 'n/a'}\n                 <span style=\"color:#888;\">(${analysis.meta.hint.sourceLast || 'n/a'})</span></div>\n          </div>\n        </div>\n      `;\n    }\n\n    // SVG path data\n    if (analysis.d) {\n      const pathData = analysis.d;\n      const isLong = pathData.length > 200;\n      const displayPath = isLong ? pathData.substring(0, 197) + '...' : pathData;\n\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\"> SVG Path Data</h4>\n          <div style=\"font-size:10px;background:#111;padding:8px;border:1px solid #333;border-radius:4px;word-break:break-all;color:#ccc;font-family:monospace;\">\n            ${displayPath}\n          </div>\n          ${isLong ? '<div style=\"font-size:9px;color:#888;margin-top:4px;\">Path truncated for display</div>' : ''}\n        </div>\n      `;\n    }\n\n    // Performance metrics (if available)\n    if (analysis.meta?.compute_time_ms || analysis.meta?.cache_time_ms) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\"> Performance</h4>\n          <div style=\"font-size:11px;color:#ccc;\">\n            ${analysis.meta.compute_time_ms ? `<div><strong>Compute Time:</strong> ${analysis.meta.compute_time_ms}ms</div>` : ''}\n            ${analysis.meta.cache_time_ms ? `<div><strong>Cache Time:</strong> ${analysis.meta.cache_time_ms}ms</div>` : ''}\n          </div>\n        </div>\n      `;\n    }\n\n    // Additional metadata\n    const additionalMeta = Object.keys(analysis.meta || {}).filter(key =>\n      !['strategy', 'cost', 'segments', 'bends', 'cache_hit', 'smooth', 'hint', 'compute_time_ms', 'cache_time_ms'].includes(key)\n    );\n\n    if (additionalMeta.length > 0) {\n      content += `\n        <div style=\"margin-bottom:16px;\">\n          <h4 style=\"margin:0 0 8px;color:#88ccff;\"> Additional Metadata</h4>\n          <div style=\"font-size:10px;color:#ccc;\">\n      `;\n      additionalMeta.forEach(key => {\n        const value = analysis.meta[key];\n        const displayValue = typeof value === 'object' ? JSON.stringify(value) : value;\n        content += `<div><strong>${key}:</strong> ${displayValue}</div>`;\n      });\n      content += `</div></div>`;\n    }\n\n    // Action buttons\n    content += `\n      <div style=\"text-align:center;margin-top:20px;border-top:1px solid #333;padding-top:16px;\">\n        <button onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(analysis)}, null, 2)); this.textContent='Copied!'; setTimeout(() => this.textContent='Copy Analysis', 2000);\"\n          style=\"background:#552255;color:#fff;border:1px solid #aa55aa;border-radius:4px;padding:6px 12px;cursor:pointer;margin-right:8px;font-size:11px;\">\n          Copy Analysis\n        </button>\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:11px;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n\n    // REMOVED: Auto-close timeout - user must click close button\n  }\n\n  // ADDED: Former global handlers as instance methods\n  setFilter(key, value) { this.filters[key] = value; }\n  updateCostFilter(type, value) {\n    const n = parseFloat(value);\n    if (!isNaN(n)) this.filters[type] = n;\n  }\n  finalizeCostFilter() {}\n  setInputFocus(field, focused) { this.inputStates[field] = focused; }\n  highlightRoute(routeId) {\n    console.log('[RoutingPanel] Highlighting route:', routeId);\n\n    try {\n      // Get the mount element from the pipeline/debug interface\n      const mountElement = window.__msdDebug?.pipelineInstance?.mountElement ||\n                          window.__msdDebug?.mountElement ||\n                          document.querySelector('cb-lcars-msd-card')?.shadowRoot ||\n                          document;\n\n      if (!mountElement) {\n        console.warn('[RoutingPanel] No mount element found for route highlighting');\n        return;\n      }\n\n      // FIXED: Simpler, smaller glow effect with better cleanup\n      const routeElements = mountElement.querySelectorAll(`g[data-overlay-id=\"${routeId}\"], path[data-overlay-id=\"${routeId}\"], #${routeId}`);\n      const overlayGroups = mountElement.querySelectorAll(`g[data-overlay-id=\"${routeId}\"]`);\n\n      // Clear any existing highlights for this route first\n      const existingHighlights = mountElement.querySelectorAll(`.msd-route-highlight-${routeId.replace(/[^a-zA-Z0-9]/g, '_')}`);\n      existingHighlights.forEach(el => {\n        el.style.filter = el.dataset.originalFilter || '';\n        el.style.outline = el.dataset.originalOutline || '';\n        el.style.removeProperty('outline-offset');\n        el.classList.remove(`msd-route-highlight-${routeId.replace(/[^a-zA-Z0-9]/g, '_')}`);\n        delete el.dataset.originalFilter;\n        delete el.dataset.originalOutline;\n      });\n\n      // Apply highlight to route containers\n      routeElements.forEach(element => {\n        const safeId = routeId.replace(/[^a-zA-Z0-9]/g, '_');\n        element.dataset.originalOutline = element.style.outline || '';\n\n        // FIXED: Much smaller, subtler glow\n        element.style.outline = '2px solid #ff00ff';\n        element.style.outlineOffset = '1px';\n        element.classList.add(`msd-route-highlight-${safeId}`);\n      });\n\n      // Apply highlight to paths within groups\n      overlayGroups.forEach(group => {\n        const paths = group.querySelectorAll('path');\n        paths.forEach(path => {\n          const safeId = routeId.replace(/[^a-zA-Z0-9]/g, '_');\n          path.dataset.originalFilter = path.style.filter || '';\n\n          // FIXED: Single, subtle glow instead of multiple layers\n          path.style.filter = `drop-shadow(0 0 4px #ff00ff) ${path.dataset.originalFilter}`.trim();\n          path.classList.add(`msd-route-highlight-${safeId}`);\n        });\n      });\n\n      // Clean up after 3 seconds\n      setTimeout(() => {\n        const highlightedElements = mountElement.querySelectorAll(`.msd-route-highlight-${routeId.replace(/[^a-zA-Z0-9]/g, '_')}`);\n        highlightedElements.forEach(element => {\n          element.style.filter = element.dataset.originalFilter || '';\n          element.style.outline = element.dataset.originalOutline || '';\n          element.style.removeProperty('outline-offset');\n          element.classList.remove(`msd-route-highlight-${routeId.replace(/[^a-zA-Z0-9]/g, '_')}`);\n          delete element.dataset.originalFilter;\n          delete element.dataset.originalOutline;\n        });\n      }, 3000);\n\n      // Show user feedback\n      this.showRouteHighlightFeedback(routeId);\n\n    } catch (e) {\n      console.warn('[RoutingPanel] Route highlighting failed:', e);\n    }\n\n    // Emit routing focus event for other panels\n    if (window.__msdDebug?.hud?.emit) {\n      window.__msdDebug.hud.emit('routing:focus', { id: routeId });\n    }\n  }  analyzeRoute(routeId) {\n    console.log('[RoutingPanel] analyzeRoute called with:', routeId);\n\n    if (!routeId) {\n      console.warn('[RoutingPanel] No route ID provided for analysis');\n      return;\n    }\n\n    const routing = window.__msdDebug?.routing;\n    if (routing?.inspect) {\n      const analysis = routing.inspect(routeId);\n\n      // FIXED: Enhanced route analysis display\n      console.group(` Route Analysis: ${routeId}`);\n\n      // Basic info table\n      if (analysis.meta) {\n        console.table({\n          Strategy: analysis.meta.strategy || 'unknown',\n          Cost: analysis.meta.cost || 0,\n          Segments: analysis.meta.segments || 0,\n          Bends: analysis.meta.bends || 0,\n          'Cache Hit': analysis.meta.cache_hit ? ' Yes' : ' No'\n        });\n      }\n\n      // Path details\n      if (analysis.pts && analysis.pts.length > 0) {\n        console.log(' Path Points:', analysis.pts.length, 'points');\n        console.table(analysis.pts.map((pt, i) => ({\n          Index: i,\n          X: pt[0],\n          Y: pt[1],\n          Type: i === 0 ? 'Start' : i === analysis.pts.length - 1 ? 'End' : 'Waypoint'\n        })));\n      }\n\n      // Hint information\n      if (analysis.meta?.hint) {\n        console.log(' Routing Hints:');\n        console.table(analysis.meta.hint);\n      }\n\n      // SVG path data (truncated if long)\n      if (analysis.d) {\n        const pathData = analysis.d.length > 100 ? analysis.d.substring(0, 97) + '...' : analysis.d;\n        console.log(' SVG Path:', pathData);\n      }\n\n      // Raw object for developers who need it\n      console.log(' Full Analysis Object:', analysis);\n      console.groupEnd();\n\n      // FIXED: Also show visual feedback in HUD\n      this.showRouteAnalysisFeedback(routeId, analysis);\n    } else {\n      console.warn('[RoutingPanel] No routing inspector available');\n    }\n  }\n\n  // FIXED: Add visual feedback method\n  showRouteHighlightFeedback(routeId) {\n    // Create temporary feedback element\n    const feedback = document.createElement('div');\n    feedback.style.cssText = `\n      position: fixed;\n      top: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: rgba(255, 0, 255, 0.9);\n      color: white;\n      padding: 8px 16px;\n      border-radius: 4px;\n      font-size: 12px;\n      z-index: 1000001;\n      pointer-events: none;\n    `;\n    feedback.textContent = `Highlighting route: ${routeId}`;\n    document.body.appendChild(feedback);\n\n    setTimeout(() => {\n      feedback.remove();\n    }, 2000);\n  }\n\n  // FIXED: Add route analysis feedback method\n  showRouteAnalysisFeedback(routeId, analysis) {\n    // Create analysis popup\n    const popup = document.createElement('div');\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #00ffff;\n      padding: 16px;\n      border: 2px solid #00ffff;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 400px;\n      box-shadow: 0 4px 20px rgba(0, 255, 255, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 12px;color:#ffaa00;\">Route Analysis: ${routeId}</h3>`;\n\n    if (analysis.meta) {\n      content += `\n        <div style=\"margin-bottom:12px;\">\n          <div><strong>Strategy:</strong> ${analysis.meta.strategy || 'unknown'}</div>\n          <div><strong>Cost:</strong> ${analysis.meta.cost || 0}</div>\n          <div><strong>Segments:</strong> ${analysis.meta.segments || 0}</div>\n          <div><strong>Bends:</strong> ${analysis.meta.bends || 0}</div>\n          <div><strong>Cache Hit:</strong> ${analysis.meta.cache_hit ? ' Yes' : ' No'}</div>\n        </div>\n      `;\n    }\n\n    if (analysis.pts && analysis.pts.length > 0) {\n      content += `\n        <div style=\"margin-bottom:12px;\">\n          <strong>Path:</strong> ${analysis.pts.length} points<br>\n          <div style=\"font-size:10px;margin-top:4px;\">\n            Start: (${analysis.pts[0][0]}, ${analysis.pts[0][1]})<br>\n            End: (${analysis.pts[analysis.pts.length-1][0]}, ${analysis.pts[analysis.pts.length-1][1]})\n          </div>\n        </div>\n      `;\n    }\n\n    if (analysis.meta?.hint) {\n      content += `\n        <div style=\"margin-bottom:12px;\">\n          <strong>Hints:</strong><br>\n          <div style=\"font-size:10px;margin-top:4px;\">\n            First: ${analysis.meta.hint.first || 'n/a'} (${analysis.meta.hint.sourceFirst || 'n/a'})<br>\n            Last: ${analysis.meta.hint.last || 'n/a'} (${analysis.meta.hint.sourceLast || 'n/a'})\n          </div>\n        </div>\n      `;\n    }\n\n    content += `\n      <div style=\"text-align:center;margin-top:12px;\">\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:4px 12px;border-radius:4px;cursor:pointer;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n\n    // Auto-close after 10 seconds\n    setTimeout(() => {\n      if (popup.parentElement) {\n        popup.remove();\n      }\n    }, 25000);\n  }\n\n  captureData() {\n    const stats = {};\n    const routes = {};\n    const performance = {};\n\n    try {\n      const routing = window.__msdDebug?.routing;\n      if (routing) {\n        // Get routing statistics\n        const routingStats = routing.stats?.() || {};\n        Object.assign(stats, routingStats);\n\n        // Add performance metrics\n        if (routing.getPerformanceMetrics) {\n          performance.metrics = routing.getPerformanceMetrics();\n        }\n\n        // Get route inspections for line overlays\n        const pipeline = window.__msdDebug?.pipelineInstance;\n        if (pipeline) {\n          const model = pipeline.getResolvedModel?.();\n          if (model?.overlays) {\n            const lineOverlays = model.overlays\n              .filter(o => o.type === 'line' && o.anchor && o.attach_to)\n              .slice(0, 15); // More routes for filtering\n\n            lineOverlays.forEach(overlay => {\n              try {\n                const routeInfo = routing.inspect?.(overlay.id);\n                if (routeInfo && routeInfo.pts) {\n                  routes[overlay.id] = {\n                    id: overlay.id,\n                    strategy: routeInfo.meta?.strategy || 'auto',\n                    pathLength: routeInfo.pts?.length || 0,\n                    segments: routeInfo.meta?.segments || 0,\n                    bends: routeInfo.meta?.bends || 0,\n                    cost: routeInfo.meta?.cost || 0,\n                    cached: routeInfo.meta?.cache_hit || false,\n                    success: routeInfo.pts && routeInfo.pts.length > 0,\n                    arcCount: routeInfo.meta?.arc?.count || 0,\n                    // Enhanced data\n                    startAnchor: overlay.anchor,\n                    endAnchor: overlay.attach_to,\n                    smooth: routeInfo.meta?.smooth || false,\n                    channel: routeInfo.meta?.channel,\n                    computeTime: routeInfo.meta?.compute_time_ms || 0\n                  };\n                } else {\n                  routes[overlay.id] = {\n                    id: overlay.id,\n                    strategy: 'unknown',\n                    pathLength: 0,\n                    segments: 0,\n                    bends: 0,\n                    cost: 0,\n                    cached: false,\n                    success: false,\n                    arcCount: 0,\n                    startAnchor: overlay.anchor,\n                    endAnchor: overlay.attach_to,\n                    smooth: false,\n                    channel: null,\n                    computeTime: 0\n                  };\n                }\n              } catch (e) {\n                console.warn(`[RoutingPanel] Route inspection failed for ${overlay.id}:`, e);\n              }\n            });\n          }\n        }\n      }\n    } catch (e) {\n      console.warn('[RoutingPanel] Data capture failed:', e);\n    }\n\n    return { stats, routes, performance };\n  }\n\n  filterRoutes(routes) {\n    return Object.values(routes).filter(route => {\n      // Strategy filter\n      if (this.filters.strategy !== 'all' && route.strategy !== this.filters.strategy) {\n        return false;\n      }\n\n      // Cost range filter\n      if (route.cost < this.filters.minCost || route.cost > this.filters.maxCost) {\n        return false;\n      }\n\n      // Cache hit filter\n      if (this.filters.cacheHit === 'hit' && !route.cached) return false;\n      if (this.filters.cacheHit === 'miss' && route.cached) return false;\n\n      // Arc filter\n      if (this.filters.showArcs && route.arcCount === 0) return false;\n\n      return true;\n    });\n  }\n\n  renderHtml(routingData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Enhanced Routing</h3>';\n\n    // FIXED: Add CSS for route highlighting\n    html += `<style>\n      .msd-route-highlighted {\n        outline: 3px solid #ff00ff !important;\n        background: rgba(255, 0, 255, 0.1) !important;\n        box-shadow: 0 0 10px #ff00ff !important;\n      }\n    </style>`;\n\n    // Filters section\n    html += '<div class=\"msd-hud-section\"><h4>Filters</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;margin-bottom:6px;\">';\n\n    // Strategy filter\n    const strategies = ['all', 'auto', 'manhattan', 'smooth', 'direct'];\n    html += '<select id=\"hud-routing-strategy\" name=\"hud-routing-strategy\" data-bus-event=\"routing:set-filter\" data-key=\"strategy\" onchange=\"__msdHudBus(\\'routing:set-filter\\', {key:\\'strategy\\', value:this.value})\" style=\"font-size:10px;\">';\n    strategies.forEach(strategy => {\n      const selected = this.filters.strategy === strategy ? 'selected' : '';\n      html += `<option value=\"${strategy}\" ${selected}>${strategy}</option>`;\n    });\n    html += '</select>';\n\n    // FIXED: Cost range with better input handling\n    html += `<input type=\"number\" id=\"hud-routing-min-cost\" name=\"hud-routing-min-cost\"\n      data-bus-event=\"routing:update-cost\" data-key=\"minCost\"\n      onfocus=\"__msdHudBus('routing:focus-set',{field:'minCostFocused',focus:true})\"\n      onblur=\"__msdHudBus('routing:focus-set',{field:'minCostFocused',focus:false});__msdHudBus('routing:finalize-cost')\"\n      oninput=\"__msdHudBus('routing:update-cost',{key:'minCost',value:this.value})\"\n      placeholder=\"Min cost\" value=\"${this.filters.minCost}\" style=\"width:60px;font-size:10px;\">`;\n\n    html += `<input type=\"number\" id=\"hud-routing-max-cost\" name=\"hud-routing-max-cost\"\n      data-bus-event=\"routing:update-cost\" data-key=\"maxCost\"\n      onfocus=\"__msdHudBus('routing:focus-set',{field:'maxCostFocused',focus:true})\"\n      onblur=\"__msdHudBus('routing:focus-set',{field:'maxCostFocused',focus:false});__msdHudBus('routing:finalize-cost')\"\n      oninput=\"__msdHudBus('routing:update-cost',{key:'maxCost',value:this.value})\"\n      placeholder=\"Max cost\" value=\"${this.filters.maxCost}\" style=\"width:60px;font-size:10px;\">`;\n\n    // Cache filter\n    html += '<select id=\"hud-routing-cachehit\" name=\"hud-routing-cachehit\" data-bus-event=\"routing:set-filter\" data-key=\"cacheHit\" onchange=\"__msdHudBus(\\'routing:set-filter\\', {key:\\'cacheHit\\', value:this.value})\" style=\"font-size:10px;\">';\n    ['all', 'hit', 'miss'].forEach(cache => {\n      const selected = this.filters.cacheHit === cache ? 'selected' : '';\n      html += `<option value=\"${cache}\" ${selected}>Cache: ${cache}</option>`;\n    });\n    html += '</select>';\n\n    html += '</div></div>';\n\n    // Statistics section\n    const stats = routingData.stats || {};\n    if (Object.keys(stats).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Cache Statistics</h4>';\n\n      Object.entries(stats).forEach(([key, value]) => {\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">${key}</span>\n          <span class=\"msd-hud-metric-value\">${value}</span>\n        </div>`;\n      });\n\n      html += '</div>';\n    }\n\n    // Performance section\n    const performance = routingData.performance || {};\n    if (performance.metrics) {\n      html += '<div class=\"msd-hud-section\"><h4>Performance</h4>';\n\n      Object.entries(performance.metrics).forEach(([key, value]) => {\n        const displayValue = typeof value === 'number' ? value.toFixed(2) : value;\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">${key}</span>\n          <span class=\"msd-hud-metric-value\">${displayValue}</span>\n        </div>`;\n      });\n\n      html += '</div>';\n    }\n\n    // Filtered routes section\n    const allRoutes = routingData.routes || {};\n    const filteredRoutes = this.filterRoutes(allRoutes);\n\n    if (filteredRoutes.length > 0) {\n      html += `<div class=\"msd-hud-section\"><h4>Routes (${filteredRoutes.length}/${Object.keys(allRoutes).length})</h4>`;\n\n      // Sort by cost descending\n      filteredRoutes.sort((a, b) => b.cost - a.cost);\n\n      filteredRoutes.slice(0, 8).forEach(route => {\n        const shortId = route.id.length > 15 ? route.id.substring(0, 12) + '...' : route.id;\n        const statusClass = route.success ? 'msd-hud-success' : 'msd-hud-error';\n        const costColor = route.cost > 50 ? '#ff6666' : route.cost > 20 ? '#ffaa00' : '#66ff99';\n\n        // FIXED: Update data attribute for easier highlighting\n        html += `<div class=\"msd-hud-metric\"\n          data-overlay-id=\"${route.id}\"\n          data-select-type=\"route\"\n          data-select-id=\"${route.id}\"\n          style=\"cursor:pointer;border:1px solid #333;padding:4px;margin:2px 0;border-radius:3px;transition:all 0.3s;\"\n          onclick=\"__msdHudBus('select:set',{type:'route',id:'${route.id}',source:'routing'});__msdHudBus('routing:highlight',{id:'${route.id}'})\"\n          onmouseover=\"this.style.background='rgba(255,0,255,0.1)'\"\n          onmouseout=\"this.style.background=''\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span class=\"msd-hud-metric-value\" style=\"color:${costColor};\">${route.cost.toFixed(1)}</span>\n          </div>\n          <div style=\"font-size:11px;color:#aaa;margin-top:3px;line-height:1.3;\">\n            <span style=\"color:#88ccff;\">${route.strategy}</span> \n            <span style=\"color:#99dd99;\" title=\"Path points\">${route.pathLength} pts</span> \n            <span style=\"color:#ffcc88;\" title=\"Direction changes\">${route.bends} turns</span>\n            ${route.cached ? '  <span style=\"color:#66ddff;\" title=\"Cached result\"> cached</span>' : ''}\n            ${route.arcCount > 0 ? `  <span style=\"color:#ff99cc;\" title=\"Arc segments\">${route.arcCount} arcs</span>` : ''}\n          </div>\n        </div>`;\n\n        // Add analysis button - Simplified approach with global helper\n        html += `<div style=\"text-align:right;margin-top:2px;\">\n          <button\n            onclick=\"event.stopPropagation();window.__msdAnalyzeRoute('${route.id}');\"\n            style=\"font-size:9px;padding:1px 4px;background:#333;color:#ccc;border:1px solid #555;border-radius:2px;cursor:pointer;\">\n            Analyze\n          </button>\n        </div>`;\n      });\n\n      if (filteredRoutes.length > 8) {\n        html += `<div style=\"font-size:10px;text-align:center;color:#666;margin-top:4px;\">\n          ... ${filteredRoutes.length - 8} more routes\n        </div>`;\n      }\n\n      html += '</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No routes match current filters</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n\n  // FIXED: Add method to check if inputs are focused (prevents refresh interference)\n  shouldSkipRefresh() {\n    return this.inputStates.minCostFocused || this.inputStates.maxCostFocused;\n  }\n}\n","/**\n * Advanced Channel Trend Panel for MSD HUD\n * Historical channel usage analysis with conflict detection\n */\n\nexport class ChannelTrendPanel {\n  constructor() {\n    this.history = new Map(); // channelId -> array of usage counts\n    this.maxHistoryLength = 30;\n    this.conflictThreshold = 3; // channels with >3 simultaneous routes\n    this.lastSnapshot = null;\n  }\n\n  captureData() {\n    const routing = window.__msdDebug?.routing;\n    const current = routing?.channels?._occupancy || {};\n    const conflicts = [];\n    const trends = {};\n    const recommendations = [];\n\n    try {\n      // Update history\n      Object.entries(current).forEach(([channelId, count]) => {\n        if (!this.history.has(channelId)) {\n          this.history.set(channelId, []);\n        }\n\n        const channelHistory = this.history.get(channelId);\n        channelHistory.push(count);\n\n        // Trim history\n        if (channelHistory.length > this.maxHistoryLength) {\n          channelHistory.shift();\n        }\n      });\n\n      // Detect conflicts (channels with high usage)\n      Object.entries(current).forEach(([channelId, count]) => {\n        if (count >= this.conflictThreshold) {\n          conflicts.push({\n            channel: channelId,\n            count: count,\n            severity: count >= 5 ? 'high' : 'medium'\n          });\n        }\n      });\n\n      // Calculate trends\n      this.history.forEach((history, channelId) => {\n        if (history.length >= 3) {\n          const recent = history.slice(-3);\n          const avg = recent.reduce((sum, val) => sum + val, 0) / recent.length;\n          const trend = recent[recent.length - 1] - recent[0];\n\n          trends[channelId] = {\n            current: recent[recent.length - 1],\n            average: avg,\n            trend: trend, // positive = increasing usage\n            variance: this.calculateVariance(recent),\n            history: [...history] // copy for rendering\n          };\n        }\n      });\n\n      // Generate optimization recommendations\n      if (conflicts.length > 0) {\n        recommendations.push({\n          type: 'conflict',\n          message: `${conflicts.length} channel conflicts detected`,\n          action: 'Consider adjusting routing strategy'\n        });\n      }\n\n      const highVarianceChannels = Object.entries(trends)\n        .filter(([_, data]) => data.variance > 2)\n        .length;\n\n      if (highVarianceChannels > 0) {\n        recommendations.push({\n          type: 'variance',\n          message: `${highVarianceChannels} channels show high variance`,\n          action: 'Review routing stability'\n        });\n      }\n\n      // Check for unused optimization\n      const totalChannels = this.history.size;\n      const activeChannels = Object.keys(current).length;\n      const unusedChannels = totalChannels - activeChannels;\n\n      if (unusedChannels > 5) {\n        recommendations.push({\n          type: 'optimization',\n          message: `${unusedChannels} channels currently unused`,\n          action: 'Potential for route optimization'\n        });\n      }\n\n    } catch (e) {\n      console.warn('[ChannelTrendPanel] Data capture failed:', e);\n    }\n\n    return { current, conflicts, trends, recommendations };\n  }\n\n  calculateVariance(values) {\n    if (values.length === 0) return 0;\n    const mean = values.reduce((sum, val) => sum + val, 0) / values.length;\n    const squaredDiffs = values.map(val => Math.pow(val - mean, 2));\n    return squaredDiffs.reduce((sum, val) => sum + val, 0) / values.length;\n  }\n\n  renderSparkline(history, maxValue = null) {\n    if (!history || history.length === 0) return '';\n\n    const max = maxValue || Math.max(...history, 1);\n    const width = 40;\n    const chars = ' ';\n\n    let sparkline = '';\n    const step = Math.max(1, Math.floor(history.length / width));\n\n    for (let i = 0; i < history.length; i += step) {\n      const value = history[i];\n      const ratio = value / max;\n      const level = Math.min(chars.length - 1, Math.floor(ratio * (chars.length - 1)));\n      sparkline += chars[level];\n    }\n\n    return sparkline;\n  }\n\n  renderHtml(channelData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Channel Trends</h3>';\n\n    const { current, conflicts, trends, recommendations } = channelData;\n\n    // Conflicts section\n    if (conflicts && conflicts.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-warning\"><h4>Conflicts Detected</h4>';\n      conflicts.forEach(conflict => {\n        const severityColor = conflict.severity === 'high' ? '#ff4444' : '#ffaa00';\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\" style=\"color:${severityColor};\">${conflict.channel}</span>\n          <span class=\"msd-hud-metric-value\">${conflict.count} routes</span>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Recommendations section\n    if (recommendations && recommendations.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Recommendations</h4>';\n      recommendations.forEach(rec => {\n        const typeColor = rec.type === 'conflict' ? '#ff6666' :\n                         rec.type === 'variance' ? '#ffaa00' : '#66ff99';\n        html += `<div class=\"msd-hud-metric\">\n          <div style=\"color:${typeColor};font-size:10px;\">${rec.message}</div>\n          <div style=\"color:#888;font-size:9px;\">${rec.action}</div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Trends section with sparklines\n    if (trends && Object.keys(trends).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Usage Trends</h4>';\n\n      // Sort by current usage\n      const sortedTrends = Object.entries(trends)\n        .sort(([,a], [,b]) => b.current - a.current)\n        .slice(0, 8);\n\n      sortedTrends.forEach(([channelId, data]) => {\n        const shortId = channelId.length > 15 ? channelId.substring(0, 12) + '...' : channelId;\n        const trendIndicator = data.trend > 0 ? '' : data.trend < 0 ? '' : '';\n        const trendColor = data.trend > 0 ? '#ff6666' : data.trend < 0 ? '#66ff99' : '#888';\n        const sparkline = this.renderSparkline(data.history);\n\n        html += `<div class=\"msd-hud-metric\" style=\"margin:4px 0;\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span class=\"msd-hud-metric-value\">${data.current}</span>\n          </div>\n          <div style=\"display:flex;justify-content:space-between;font-size:10px;margin-top:2px;\">\n            <span style=\"font-family:monospace;color:#888;\">${sparkline}</span>\n            <span style=\"color:${trendColor};\">${trendIndicator} ${data.average.toFixed(1)}</span>\n          </div>\n        </div>`;\n      });\n\n      html += '</div>';\n    }\n\n    // Current status summary\n    const currentCount = Object.keys(current || {}).length;\n    const totalUsage = Object.values(current || {}).reduce((sum, count) => sum + count, 0);\n    const historySize = this.history.size;\n\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${currentCount} active channels  ${totalUsage} total routes  ${historySize} tracked\n    </div>`;\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Flags Panel for MSD HUD\n * Runtime debug feature management using actual MSD debug interface\n * Based on __msdDebug.debug.enable/disable API\n */\n\nexport class FlagsPanel {\n  constructor() {\n    // Actual MSD debug features\n    this.debugFeatures = [\n      'anchors', 'bounding_boxes', 'routing', 'performance'\n    ];\n  }\n\n  toggleFeature(feature) {\n    console.log('[FlagsPanel] toggleFeature called:', feature);\n\n    if (!window.__msdDebug?.debug) {\n      console.warn('[FlagsPanel] Debug interface not available');\n      return;\n    }\n\n    // FIXED: Use silent status access instead of status() which dumps to console\n    const debugManager = window.__msdDebug?.debugManager ||\n                         window.__msdDebug?.pipelineInstance?.systemsManager?.debugManager;\n\n    if (!debugManager) {\n      console.warn('[FlagsPanel] DebugManager not available');\n      return;\n    }\n\n    const currentStatus = debugManager.getSnapshot();\n    const currentlyEnabled = currentStatus[feature];\n\n    if (currentlyEnabled) {\n      window.__msdDebug.debug.disable(feature);\n    } else {\n      window.__msdDebug.debug.enable(feature);\n    }\n\n    // FIXED: Force immediate re-render after state change\n    setTimeout(() => {\n      try {\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (pipelineInstance?.reRender) {\n          console.log('[FlagsPanel] Triggering re-render after', feature, currentlyEnabled ? 'disable' : 'enable');\n          pipelineInstance.reRender();\n        } else {\n          console.warn('[FlagsPanel] No reRender method available on pipeline instance');\n        }\n      } catch (error) {\n        console.warn('[FlagsPanel] Failed to trigger re-render:', error);\n      }\n    }, 50);\n\n    // Refresh HUD after a delay to show updated state\n    setTimeout(() => {\n      if (window.__msdDebug?.hud?.refresh) {\n        window.__msdDebug.hud.refresh();\n      }\n    }, 100);\n  }\n\n  adjustScale(direction) {\n    if (!window.__msdDebug?.debug?.status) return;\n    const currentScale = window.__msdDebug.debug.status().scale || 1.0;\n    const step = 0.1;\n    const newScale = direction > 0 ? currentScale + step : currentScale - step;\n    const clampedScale = Math.max(0.5, Math.min(3.0, newScale));\n\n    if (window.__msdDebug.debug.setScale) {\n      window.__msdDebug.debug.setScale(clampedScale);\n    }\n  }\n\n  setScale(scale) {\n    const numScale = parseFloat(scale);\n    if (isNaN(numScale)) return;\n    const clampedScale = Math.max(0.5, Math.min(3.0, numScale));\n\n    if (window.__msdDebug?.debug?.setScale) {\n      window.__msdDebug.debug.setScale(clampedScale);\n    }\n  }\n\n  refreshDebug() {\n    window.__msdDebug?.debug?.refresh?.();\n  }\n\n  captureData() {\n    const flags = {};\n    const debugFeatures = {};\n\n    try {\n      // FIXED: Use centralized silent debug status access\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n\n      // FIXED: Properly capture debug features and readiness\n      Object.assign(debugFeatures, debugStatus);\n\n      // Get current debug flags (legacy support)\n      Object.assign(flags, window.__msdDebug?._debugFlags || {});\n    } catch (e) {\n      console.warn('[FlagsPanel] Data capture failed:', e);\n    }\n\n    return { flags, debugFeatures };\n  }\n\n  renderHtml(flagsData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Debug Features</h3>';\n\n    // FIXED: Use debugFeatures instead of separate features object\n    const debugFeatures = flagsData.debugFeatures || {};\n    const scale = debugFeatures.scale || 1.0;\n    const debugReady = debugFeatures.initialized || false;\n\n    // Debug status\n    if (!debugReady) {\n      html += '<div class=\"msd-hud-section msd-hud-warning\"><h4>Status</h4>';\n      html += '<div>Debug interface not ready</div></div>';\n    } else {\n      html += '<div class=\"msd-hud-section\"><h4>Status</h4>';\n      html += `<div>Debug ready  Scale: ${scale.toFixed(1)}x</div></div>`;\n    }\n\n    // Individual features section\n    html += '<div class=\"msd-hud-section\"><h4>Debug Features</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;margin-bottom:6px;\">';\n\n    this.debugFeatures.forEach(feature => {\n      // FIXED: Check debugFeatures instead of features\n      const isEnabled = Boolean(debugFeatures[feature]);\n      const displayName = feature.replace('_', ' ');\n      html += `<button data-bus-event=\"flags:toggle\" onclick=\"__msdHudBus('flags:toggle',{feature:'${feature}'})\"\n        style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n        background:${isEnabled ? '#ff00ff' : '#333'};color:${isEnabled ? '#000' : '#eee'};\">\n        ${displayName}\n      </button>`;\n    });\n\n    html += '</div></div>';\n\n    // Scale control\n    html += '<div class=\"msd-hud-section\"><h4>Scale Control</h4>';\n    html += '<div style=\"display:flex;gap:4px;align-items:center;margin-bottom:6px;\">';\n\n    // +/- buttons and input\n    html += `<button data-bus-event=\"flags:scale-adjust\" onclick=\"__msdHudBus('flags:scale-adjust',{dir:-1})\" style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n      background:#333;color:#eee;\">-</button>`;\n\n    html += `<input type=\"number\" id=\"hud-flags-scale\" name=\"hud-flags-scale\"\n      value=\"${scale.toFixed(1)}\" min=\"0.5\" max=\"3.0\" step=\"0.1\" data-bus-event=\"flags:scale-set\"\n      onchange=\"__msdHudBus('flags:scale-set',{scale:this.value})\"\n      style=\"width:60px;font-size:10px;padding:2px 4px;border:1px solid #444;border-radius:3px;\n      background:#222;color:#eee;text-align:center;\">`;\n\n    html += `<button data-bus-event=\"flags:scale-adjust\" onclick=\"__msdHudBus('flags:scale-adjust',{dir:1})\" style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n      background:#333;color:#eee;\">+</button>`;\n\n    html += '</div>';\n\n    // Preset scale buttons\n    html += '<div style=\"display:flex;gap:4px;align-items:center;\">';\n    [0.8, 1.0, 1.2, 1.5, 2.0].forEach(scaleValue => {\n      const isActive = Math.abs(scale - scaleValue) < 0.05;\n      html += `<button data-bus-event=\"flags:scale-set\"\n        onclick=\"__msdHudBus('flags:scale-set',{scale:${scaleValue}})\"\n        style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n        background:${isActive ? '#ffaa00' : '#333'};color:${isActive ? '#000' : '#eee'};\">\n        ${scaleValue}x\n      </button>`;\n    });\n\n    html += `<button data-bus-event=\"flags:refresh\" onclick=\"__msdHudBus('flags:refresh')\" style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n      background:#333;color:#eee;margin-left:8px;\">\n      Refresh\n    </button>`;\n    html += '</div></div>';\n\n    // Status section\n    // FIXED: Use debugFeatures to count enabled features\n    const enabledCount = this.debugFeatures.filter(feature => debugFeatures[feature]).length;\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${enabledCount}/${this.debugFeatures.length} features enabled\n    </div>`;\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Enhanced Issues Panel for MSD HUD\n * Unified issue aggregation with smart routing to editors/actions\n * Based on legacy HUD issues panel functionality\n */\n\nexport class IssuesPanel {\n  constructor() {\n    this.issueCategories = {\n      validation: { label: 'Validation', color: '#ff6666', icon: '' },\n      routing: { label: 'Routing', color: '#ffaa00', icon: '' },\n      performance: { label: 'Performance', color: '#ff9900', icon: '' },\n      debug: { label: 'Debug', color: '#66cfff', icon: '' }\n    };\n  }\n\n  handleIssueClick(action, id, overlay) {\n    console.log('[IssuesPanel] Issue clicked:', { action, id, overlay });\n\n    switch (action) {\n      case 'overlay':\n        if (overlay && window.__msdDebug?.debug) {\n          // Try to highlight the overlay\n          console.log(`[IssuesPanel] Highlighting overlay: ${overlay}`);\n          // Could integrate with overlay editor here\n        }\n        break;\n\n      case 'routing':\n        console.log('[IssuesPanel] Opening routing diagnostics');\n        // Could emit routing focus event\n        if (window.__msdDebug?.hud?.refresh) {\n          window.__msdDebug.hud.refresh();\n        }\n        break;\n\n      case 'performance':\n        console.log(`[IssuesPanel] Performance issue: ${id}`);\n        // Could open performance panel or set thresholds\n        break;\n\n      case 'debug':\n        console.log('[IssuesPanel] Debug issue clicked - attempting to initialize debug interface');\n        // Try to initialize debug interface\n        if (window.__msdDebug?.debug?.refresh) {\n          window.__msdDebug.debug.refresh();\n        }\n        break;\n\n      // ADDED: New action for enabling debug features\n      case 'enable-features':\n        console.log('[IssuesPanel] Enabling basic debug features');\n        if (window.__msdDebug?.debug) {\n          // Enable a basic set of debug features\n          window.__msdDebug.debug.enable('anchors');\n          window.__msdDebug.debug.enable('bounding_boxes');\n\n          // Show user feedback\n          const feedback = document.createElement('div');\n          feedback.style.cssText = `\n            position: fixed;\n            top: 20px;\n            left: 50%;\n            transform: translateX(-50%);\n            background: rgba(0, 255, 0, 0.9);\n            color: white;\n            padding: 8px 16px;\n            border-radius: 4px;\n            font-size: 12px;\n            z-index: 1000001;\n            pointer-events: none;\n          `;\n          feedback.textContent = 'Debug features enabled: anchors, bounding_boxes';\n          document.body.appendChild(feedback);\n\n          setTimeout(() => feedback.remove(), 3000);\n        }\n        break;\n    }\n\n    // ADDED: Selection heuristics\n    if (this.bus) {\n      if (action === 'overlay' && overlay) {\n        this.bus.emit('select:set', { type: 'overlay', id: overlay, source: 'issues' });\n      } else if (action === 'routing' && id) {\n        this.bus.emit('select:set', { type: 'route', id, source: 'issues' });\n      } else if (action === 'performance' && id) {\n        this.bus.emit('select:set', { type: 'timer', id, source: 'issues' });\n      }\n    }\n  }\n\n  captureData() {\n    const issues = {\n      validation: [],\n      routing: [],\n      performance: [],\n      debug: []\n    };\n\n    try {\n      // Validation issues\n      const validationData = window.__msdDebug?.validation?.issues?.() || {};\n      if (validationData.errors) {\n        validationData.errors.forEach(error => {\n          issues.validation.push({\n            id: error.overlay || error.anchor || 'unknown',\n            type: 'validation',\n            severity: 'error',\n            message: error.msg || error.message || 'Validation error',\n            code: error.code,\n            overlay: error.overlay,\n            anchor: error.anchor,\n            clickAction: 'overlay'\n          });\n        });\n      }\n      if (validationData.warnings) {\n        validationData.warnings.forEach(warning => {\n          issues.validation.push({\n            id: warning.overlay || warning.anchor || 'unknown',\n            type: 'validation',\n            severity: 'warning',\n            message: warning.msg || warning.message || 'Validation warning',\n            code: warning.code,\n            overlay: warning.overlay,\n            anchor: warning.anchor,\n            clickAction: 'overlay'\n          });\n        });\n      }\n\n      // Routing issues from debug features\n      // FIXED: Use centralized silent debug status access\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n      if (debugStatus.enabled) {\n        // Check for routing problems (this would need actual routing diagnostics)\n        const routing = window.__msdDebug?.routing;\n        if (routing?.stats) {\n          const stats = routing.stats();\n          if (stats.errors && stats.errors > 0) {\n            issues.routing.push({\n              id: 'routing-errors',\n              type: 'routing',\n              severity: 'error',\n              message: `${stats.errors} routing errors detected`,\n              code: 'routing_errors',\n              clickAction: 'routing'\n            });\n          }\n        }\n      }\n\n      // Performance issues from debug status\n      if (debugStatus.performance) {\n        // Could check for performance thresholds here\n        // This is a placeholder for actual performance monitoring\n        const perfData = window.__msdDebug?.getPerf?.() || {};\n        if (perfData.timers) {\n          Object.entries(perfData.timers).forEach(([key, timer]) => {\n            if (timer.avg > 50) { // Example threshold\n              issues.performance.push({\n                id: key,\n                type: 'performance',\n                severity: 'warning',\n                message: `Slow timer: ${key} (${timer.avg.toFixed(1)}ms avg)`,\n                code: 'slow_timer',\n                clickAction: 'performance'\n              });\n            }\n          });\n        }\n      }\n\n      // Debug feature issues\n      // FIXED: Better debug feature status detection\n      if (!debugStatus.initialized) {\n        // Actually not initialized\n        issues.debug.push({\n          id: 'debug-status',\n          type: 'debug',\n          severity: 'warning',\n          message: 'Debug interface not initialized',\n          code: 'debug_not_initialized',\n          clickAction: 'debug'\n        });\n      } else if (!debugStatus.enabled) {\n        // Initialized but no features enabled - this is not really an \"issue\"\n        // We could either skip this entirely or show an info message\n        issues.debug.push({\n          id: 'debug-features-disabled',\n          type: 'debug',\n          severity: 'info',\n          message: 'All debug features are disabled',\n          code: 'debug_features_off',\n          clickAction: 'enable-features'\n        });\n      }\n\n    } catch (e) {\n      console.warn('[IssuesPanel] Data capture failed:', e);\n      issues.debug.push({\n        id: 'capture-error',\n        type: 'debug',\n        severity: 'error',\n        message: `Issue capture failed: ${e.message}`,\n        code: 'capture_error',\n        clickAction: 'debug'\n      });\n    }\n\n    return issues;\n  }\n\n  renderHtml(issuesData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Issues</h3>';\n\n    // Count total issues\n    const allIssues = [];\n    Object.values(issuesData).forEach(categoryIssues => {\n      allIssues.push(...categoryIssues);\n    });\n\n    if (allIssues.length === 0) {\n      html += '<div class=\"msd-hud-section msd-hud-success\"> No issues detected</div>';\n      html += '</div>';\n      return html;\n    }\n\n    // Summary section\n    const errorCount = allIssues.filter(i => i.severity === 'error').length;\n    const warningCount = allIssues.filter(i => i.severity === 'warning').length;\n\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${errorCount} errors, ${warningCount} warnings  Click to fix\n    </div>`;\n\n    // Issues by category\n    Object.entries(issuesData).forEach(([categoryKey, categoryIssues]) => {\n      if (categoryIssues.length === 0) return;\n\n      const category = this.issueCategories[categoryKey];\n      html += `<div class=\"msd-hud-section\">\n        <h4 style=\"color: ${category.color};\">${category.icon} ${category.label} (${categoryIssues.length})</h4>\n      `;\n\n      categoryIssues.slice(0, 6).forEach((issue, index) => {\n        const severityColor = issue.severity === 'error' ? '#ff6666' : '#ffaa00';\n        const issueId = `issue-${categoryKey}-${index}`;\n\n        html += `<div class=\"msd-hud-metric msd-issue-row\"\n          data-bus-event=\"issues:action\"\n          data-action=\"${issue.clickAction}\"\n          data-id=\"${issue.id}\"\n          data-overlay=\"${issue.overlay || ''}\"\n          data-select-type=\"${issue.clickAction === 'overlay' ? 'overlay' : issue.clickAction === 'routing' ? 'route' : issue.clickAction === 'performance' ? 'timer' : 'issue'}\"\n          data-select-id=\"${issue.overlay || issue.id}\"\n          onclick=\"__msdHudBus('issues:action',{action:'${issue.clickAction}',id:'${issue.id}',overlay:'${issue.overlay || ''}'});__msdHudBus('select:set',{type:'${issue.clickAction === 'overlay' ? 'overlay' : issue.clickAction === 'routing' ? 'route' : issue.clickAction === 'performance' ? 'timer' : 'issue'}',id:'${issue.overlay || issue.id}',source:'issues'})\"\n          style=\"cursor:pointer; border-left:3px solid ${severityColor}; padding-left:6px; margin:2px 0;\">\n          <div style=\"display: flex; justify-content: space-between; align-items: center;\">\n            <span class=\"msd-hud-metric-name\">[${issue.code || issue.type}]</span>\n            <span style=\"color: ${severityColor}; font-size: 10px;\">${issue.severity.toUpperCase()}</span>\n          </div>\n          <div style=\"font-size: 10px; color: #ccc; margin-top: 2px;\">${issue.message}</div>\n        </div>`;\n      });\n\n      if (categoryIssues.length > 6) {\n        html += `<div style=\"font-size: 9px; opacity: 0.6; text-align: center;\">\n          ... ${categoryIssues.length - 6} more ${category.label.toLowerCase()} issues\n        </div>`;\n      }\n\n      html += '</div>';\n    });\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Packs Panel for MSD HUD\n * Shows pack collections and provenance information\n */\n\nexport class PacksPanel {\n  captureData() {\n    const collections = {};\n    const provenance = {};\n    const summary = {};\n\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      if (pipelineInstance) {\n        const resolvedModel = pipelineInstance.getResolvedModel?.();\n        if (resolvedModel) {\n          // Capture collections\n          const collectionTypes = ['animations', 'timelines', 'rules', 'profiles', 'overlays'];\n          collectionTypes.forEach(type => {\n            collections[type] = resolvedModel[type] || [];\n            summary[type] = collections[type].length;\n          });\n\n          // Capture provenance if available\n          if (resolvedModel.__provenance) {\n            Object.assign(provenance, resolvedModel.__provenance);\n          }\n        }\n\n        // Try to get merged config for additional info\n        const merged = pipelineInstance.merged;\n        if (merged) {\n          Object.keys(collections).forEach(type => {\n            if (merged[type]) {\n              collections[type] = merged[type];\n              summary[type] = merged[type].length;\n            }\n          });\n\n          if (merged.__provenance) {\n            Object.assign(provenance, merged.__provenance);\n          }\n        }\n      }\n    } catch (e) {\n      console.warn('[PacksPanel] Data capture failed:', e);\n    }\n\n    return { collections, provenance, summary };\n  }\n\n  renderHtml(packsData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Packs & Collections</h3>';\n\n    const { collections, provenance, summary } = packsData;\n\n    // Summary section\n    if (summary && Object.keys(summary).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Collection Summary</h4>';\n      html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;font-size:10px;\">';\n\n      Object.entries(summary).forEach(([type, count]) => {\n        const color = count > 0 ? '#66ff99' : '#666';\n        html += `<span style=\"background:#222;color:${color};padding:2px 4px;border:1px solid #444;border-radius:3px;\">\n          ${type}:${count}\n        </span>`;\n      });\n      html += '</div></div>';\n    }\n\n    // Provenance section (if available)\n    if (provenance && Object.keys(provenance).some(k => Object.keys(provenance[k] || {}).length > 0)) {\n      html += '<div class=\"msd-hud-section\"><h4>Provenance Sample</h4>';\n\n      const allEntries = [];\n      Object.entries(provenance).forEach(([collection, items]) => {\n        Object.entries(items || {}).forEach(([id, chain]) => {\n          allEntries.push({ collection, id, chain });\n        });\n      });\n\n      // Show first 8 entries\n      allEntries.slice(0, 8).forEach(entry => {\n        const shortId = entry.id.length > 15 ? entry.id.substring(0, 12) + '...' : entry.id;\n        const chainStr = (entry.chain || [])\n          .map(c => `${c.layer_id}${c.overridden ? '*' : ''}`)\n          .join('  ');\n\n        html += `<div class=\"msd-hud-metric\" style=\"margin:2px 0;\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${entry.collection}:${shortId}</span>\n          </div>\n          <div style=\"font-size:9px;color:#888;margin-top:1px;font-family:monospace;\">\n            ${chainStr || 'No chain data'}\n          </div>\n        </div>`;\n      });\n\n      if (allEntries.length > 8) {\n        html += `<div style=\"font-size:9px;opacity:0.6;text-align:center;\">\n          ... ${allEntries.length - 8} more items\n        </div>`;\n      }\n\n      html += '</div>';\n    }\n\n    // Collections detail section\n    if (collections && Object.keys(collections).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Collections Detail</h4>';\n\n      Object.entries(collections).forEach(([type, items]) => {\n        if (!Array.isArray(items) || items.length === 0) return;\n\n        html += `<div style=\"margin-bottom:6px;\">\n          <div style=\"font-weight:bold;font-size:11px;color:#ffaa00;\">${type} (${items.length})</div>`;\n\n        // Show first few items with badges\n        items.slice(0, 6).forEach(item => {\n          if (!item || !item.id) return;\n\n          const badges = [];\n          if (item.__meta?.origin_pack) {\n            const pack = item.__meta.origin_pack;\n            if (pack === 'builtin:core') badges.push({ text: 'core', color: '#555' });\n            else if (pack.startsWith('builtin:')) badges.push({ text: 'builtin', color: '#663399' });\n            else if (pack.startsWith('external:')) badges.push({ text: 'ext', color: '#cc6600' });\n            else badges.push({ text: 'user', color: '#996515' });\n          }\n\n          if (item.__meta?.overridden) badges.push({ text: 'mod', color: '#8a6d00' });\n          if (item.__meta?.removed) badges.push({ text: 'rm', color: '#702020' });\n\n          const badgeHtml = badges.map(b =>\n            `<span style=\"background:${b.color};color:#fff;padding:0 3px;margin-left:4px;border-radius:2px;font-size:8px;\">\n              ${b.text}\n            </span>`\n          ).join('');\n\n          const shortId = item.id.length > 20 ? item.id.substring(0, 17) + '...' : item.id;\n          html += `<div style=\"margin-left:10px;font-size:10px;margin:1px 0;\">\n            ${shortId}${badgeHtml}\n          </div>`;\n        });\n\n        if (items.length > 6) {\n          html += `<div style=\"margin-left:10px;font-size:9px;color:#666;\">\n            ... ${items.length - 6} more\n          </div>`;\n        }\n\n        html += '</div>';\n      });\n\n      html += '</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No pack data available</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Rules Panel for MSD HUD\n * Shows rules engine evaluation trace and rule activity\n */\n\nexport class RulesPanel {\n  captureData() {\n    const rules = [];\n    const trace = [];\n    const stats = {};\n\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      const rulesEngine = pipelineInstance?.systemsManager?.rulesEngine ||\n                         pipelineInstance?.rulesEngine;\n\n      if (rulesEngine) {\n        // Get trace information - FIXED: Handle non-array trace\n        const engineTrace = rulesEngine.getTrace?.() || [];\n        if (Array.isArray(engineTrace)) {\n          trace.push(...engineTrace);\n        } else if (engineTrace) {\n          // Handle case where trace might be a single object or other format\n          trace.push(engineTrace);\n        }\n\n        // Get rules list - FIXED: Handle non-array rules\n        const rulesList = rulesEngine.rules || rulesEngine._rules || [];\n        if (Array.isArray(rulesList)) {\n          rulesList.forEach(rule => {\n            const traceInfo = trace.find(t => t && t.id === rule.id);\n            rules.push({\n              id: rule.id,\n              priority: rule.priority || 0,\n              lastMatch: traceInfo?.matched || false,\n              matchCount: rule._matchCount || rule.matchCount || 0,\n              conditions: rule.when ? Object.keys(rule.when).length : 0,\n              actions: rule.apply ? Object.keys(rule.apply).length : 0\n            });\n          });\n        }\n\n        // Calculate stats\n        stats.totalRules = rules.length;\n        stats.matchedRules = rules.filter(r => r.lastMatch).length;\n        stats.totalMatches = rules.reduce((sum, r) => sum + r.matchCount, 0);\n        stats.avgPriority = rules.length > 0 ?\n          rules.reduce((sum, r) => sum + r.priority, 0) / rules.length : 0;\n      }\n    } catch (e) {\n      console.warn('[RulesPanel] Data capture failed:', e);\n      // ADDED: Provide fallback data structure to prevent rendering errors\n      return {\n        rules: [],\n        trace: [],\n        stats: {\n          totalRules: 0,\n          matchedRules: 0,\n          totalMatches: 0,\n          avgPriority: 0\n        }\n      };\n    }\n\n    return { rules, trace, stats };\n  }\n\n  renderHtml(rulesData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Rules Engine</h3>';\n\n    const { rules, trace, stats } = rulesData;\n\n    // Stats section\n    if (stats && Object.keys(stats).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Statistics</h4>';\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Total Rules</span>\n        <span class=\"msd-hud-metric-value\">${stats.totalRules}</span>\n      </div>`;\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Currently Matched</span>\n        <span class=\"msd-hud-metric-value\" style=\"color:${stats.matchedRules > 0 ? '#66ff99' : '#666'};\">\n          ${stats.matchedRules}\n        </span>\n      </div>`;\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Total Matches</span>\n        <span class=\"msd-hud-metric-value\">${stats.totalMatches}</span>\n      </div>`;\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Avg Priority</span>\n        <span class=\"msd-hud-metric-value\">${stats.avgPriority.toFixed(1)}</span>\n      </div>`;\n      html += '</div>';\n    }\n\n    // Rules list section\n    if (rules && rules.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Rules Activity</h4>';\n\n      // Sort by priority descending, then by match status\n      const sortedRules = [...rules].sort((a, b) => {\n        if (a.lastMatch !== b.lastMatch) return b.lastMatch - a.lastMatch; // matched first\n        return b.priority - a.priority; // then by priority\n      });\n\n      sortedRules.slice(0, 10).forEach(rule => {\n        const shortId = rule.id.length > 20 ? rule.id.substring(0, 17) + '...' : rule.id;\n        const matchStatus = rule.lastMatch ? '' : '';\n        const matchColor = rule.lastMatch ? '#66ff99' : '#666';\n\n        html += `<div class=\"msd-hud-metric\"\n          data-select-type=\"rule\"\n          data-select-id=\"${rule.id}\"\n          onclick=\"__msdHudBus('select:set',{type:'rule',id:'${rule.id}',source:'rules'})\"\n          style=\"margin:2px 0;padding:2px;${rule.lastMatch ? 'background:rgba(102,255,153,0.1);' : ''} border-radius:3px;\">\n          <div style=\"display:flex;justify-content:space-between;align-items:center;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <div style=\"display:flex;gap:8px;align-items:center;\">\n              <span style=\"font-size:10px;color:#888;\">p:${rule.priority}</span>\n              <span style=\"color:${matchColor};font-weight:bold;\">${matchStatus}</span>\n            </div>\n          </div>\n          <div style=\"font-size:10px;color:#888;margin-top:1px;\">\n            ${rule.conditions} conditions  ${rule.actions} actions  ${rule.matchCount} matches\n          </div>\n        </div>`;\n      });\n\n      if (sortedRules.length > 10) {\n        html += `<div style=\"font-size:10px;text-align:center;color:#666;margin-top:4px;\">\n          ... ${sortedRules.length - 10} more rules\n        </div>`;\n      }\n\n      html += '</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No rules engine data available</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Export Panel for MSD HUD\n * Interactive configuration export/import/diff tools\n * Based on legacy HudController export functionality\n */\n\nexport class ExportPanel {\n  constructor() {\n    // FIXED: Only log construction once, not on every refresh\n    console.log('[ExportPanel] Constructor called');\n    this.initialized = false;\n    this.initialized = true;\n  }\n\n  exportCollapsed() {\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      if (pipeline?.exportCollapsedJson) {\n        const json = pipeline.exportCollapsedJson(true);\n        this.downloadJson(json, 'msd-config-collapsed');\n        this.updateTextarea('collapsed', json);\n      }\n    } catch (e) {\n      console.error('[ExportPanel] Collapsed export failed:', e);\n    }\n  }\n\n  exportFull(includeMeta = false) {\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      if (pipeline?.exportFullSnapshotJson) {\n        const options = includeMeta ? { include_meta: true } : {};\n        const json = pipeline.exportFullSnapshotJson(options, true);\n        const filename = includeMeta ? 'msd-snapshot-with-meta' : 'msd-snapshot';\n        this.downloadJson(json, filename);\n        this.updateTextarea('full', json);\n      }\n    } catch (e) {\n      console.error('[ExportPanel] Full export failed:', e);\n    }\n  }\n\n  diffItem() {\n    // Future implementation\n  }\n\n  clearTextarea(type) {\n    this.updateTextarea(type, '');\n  }\n\n  copyToClipboard(type) {\n    const textarea = document.getElementById(`export-${type}-textarea`);\n    if (textarea && textarea.value) {\n      navigator.clipboard.writeText(textarea.value).then(() => {\n        this.showFeedback('Copied to clipboard!');\n      }).catch(e => {\n        console.warn('Clipboard copy failed:', e);\n        textarea.select();\n        textarea.setSelectionRange(0, 99999);\n      });\n    }\n  }\n\n  downloadJson(jsonString, filename) {\n    try {\n      const blob = new Blob([jsonString], { type: 'application/json' });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `${filename}-${Date.now()}.json`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n\n      this.showFeedback(`Downloaded: ${a.download}`);\n    } catch (e) {\n      console.error('[ExportPanel] Download failed:', e);\n    }\n  }\n\n  updateTextarea(type, content) {\n    const textarea = document.getElementById(`export-${type}-textarea`);\n    if (textarea) {\n      textarea.value = content;\n    }\n  }\n\n  showFeedback(message, type = 'info') {\n    const colors = {\n      info: '#00ffff',\n      success: '#00ff00',\n      warning: '#ffaa00',\n      error: '#ff6666'\n    };\n\n    const feedback = document.createElement('div');\n    feedback.style.cssText = `\n      position: fixed;\n      top: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: rgba(0, 0, 0, 0.9);\n      color: ${colors[type]};\n      padding: 8px 16px;\n      border: 1px solid ${colors[type]};\n      border-radius: 4px;\n      font-size: 12px;\n      z-index: 1000001;\n      pointer-events: none;\n    `;\n    feedback.textContent = message;\n    document.body.appendChild(feedback);\n\n    setTimeout(() => feedback.remove(), 3000);\n  }\n\n  captureData() {\n    const pipeline = window.__msdDebug?.pipelineInstance;\n\n    // FIXED: Add more detailed debugging for export panel visibility\n    const data = {\n      available: !!pipeline,\n      hasExportMethods: !!(pipeline?.exportCollapsedJson && pipeline?.exportFullSnapshotJson),\n      hasDiffMethod: !!pipeline?.diffItem,\n      collections: ['animations', 'timelines', 'rules', 'profiles', 'overlays'],\n      initialized: this.initialized,\n      globalHandlers: !!window.__msdExportPanel\n    };\n\n    // FIXED: Only log data capture issues, not every successful capture\n    if (!data.available) {\n      console.warn('[ExportPanel] Pipeline not available for export functionality');\n    }\n\n    return data;\n  }\n\n  renderHtml(exportData) {\n    // FIXED: Add debug info to help troubleshoot rendering\n    if (!exportData.available) {\n      return `<h3>Export & Config</h3>\n        <div class=\"msd-hud-section msd-hud-error\">\n          Pipeline instance not available\n          <div style=\"font-size: 10px; color: #888; margin-top: 4px;\">\n            Initialized: ${exportData.initialized} | Handlers: ${exportData.globalHandlers}\n          </div>\n        </div>`;\n    }\n\n    let html = '<h3>Export & Config</h3>';\n\n    // Export Controls Section\n    html += '<div class=\"msd-hud-section\"><h4>Export Configuration</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;margin-bottom:8px;\">';\n\n    html += `<button data-bus-event=\"export:collapsed\" onclick=\"__msdHudBus('export:collapsed')\"\n      style=\"font-size:10px;padding:2px 6px;background:#333;color:#fff;border:1px solid #555;border-radius:3px;cursor:pointer;\">\n      Collapsed JSON\n    </button>`;\n\n    html += `<button data-bus-event=\"export:full\" onclick=\"__msdHudBus('export:full')\"\n      style=\"font-size:10px;padding:2px 6px;background:#333;color:#fff;border:1px solid #555;border-radius:3px;cursor:pointer;\">\n      Full Snapshot\n    </button>`;\n\n    html += `<button data-bus-event=\"export:full-meta\" onclick=\"__msdHudBus('export:full-meta')\"\n      style=\"font-size:10px;padding:2px 6px;background:#666;color:#fff;border:1px solid #888;border-radius:3px;cursor:pointer;\">\n      +Metadata\n    </button>`;\n\n    html += '</div>';\n\n    // Collapsed JSON textarea\n    html += '<div style=\"margin-bottom:6px;\">';\n    html += '<div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:2px;\">';\n    html += '<span style=\"font-size:11px;color:#ffaa00;\">Collapsed JSON:</span>';\n    html += '<div style=\"display:flex;gap:2px;\">';\n    html += `<button data-bus-event=\"export:copy\" onclick=\"__msdHudBus('export:copy',{type:'collapsed'})\" style=\"font-size:9px;padding:1px 4px;background:#444;color:#fff;border:1px solid #666;border-radius:2px;cursor:pointer;\">Copy</button>`;\n    html += `<button data-bus-event=\"export:clear\" onclick=\"__msdHudBus('export:clear',{type:'collapsed'})\" style=\"font-size:9px;padding:1px 4px;background:#666;color:#fff;border:1px solid #888;border-radius:2px;cursor:pointer;\">Clear</button>`;\n    html += '</div></div>';\n    html += `<textarea id=\"export-collapsed-textarea\" name=\"export-collapsed\" readonly\n      style=\"width:100%;height:80px;font-size:9px;font-family:monospace;background:#111;color:#ccc;border:1px solid #444;border-radius:3px;padding:4px;resize:vertical;\"></textarea>`;\n    html += '</div>';\n\n    // Full JSON textarea\n    html += '<div style=\"margin-bottom:6px;\">';\n    html += '<div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:2px;\">';\n    html += '<span style=\"font-size:11px;color:#ffaa00;\">Full Snapshot:</span>';\n    html += '<div style=\"display:flex;gap:2px;\">';\n    html += `<button data-bus-event=\"export:copy\" onclick=\"__msdHudBus('export:copy',{type:'full'})\" style=\"font-size:9px;padding:1px 4px;background:#444;color:#fff;border:1px solid #666;border-radius:2px;cursor:pointer;\">Copy</button>`;\n    html += `<button data-bus-event=\"export:clear\" onclick=\"__msdHudBus('export:clear',{type:'full'})\" style=\"font-size:9px;padding:1px 4px;background:#666;color:#fff;border:1px solid #888;border-radius:2px;cursor:pointer;\">Clear</button>`;\n    html += '</div></div>';\n    html += `<textarea id=\"export-full-textarea\" name=\"export-full\" readonly\n      style=\"width:100%;height:100px;font-size:9px;font-family:monospace;background:#111;color:#ccc;border:1px solid #444;border-radius:3px;padding:4px;resize:vertical;\"></textarea>`;\n    html += '</div>';\n\n    html += '</div>';\n\n    // Status\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      Export: ${exportData.hasExportMethods ? '' : ''} \n      Diff: ${exportData.hasDiffMethod ? '' : ''} \n      Handlers: ${exportData.globalHandlers ? '' : ''} \n      Ready for config management\n    </div>`;\n\n    return html;\n  }\n}\n","// Lightweight HUD Event Bus\nexport class HudEventBus {\n  constructor() {\n    this._listeners = new Map(); // event -> Set<fn>\n  }\n  on(event, fn) {\n    if (!this._listeners.has(event)) this._listeners.set(event, new Set());\n    this._listeners.get(event).add(fn);\n    return () => this.off(event, fn);\n  }\n  once(event, fn) {\n    const off = this.on(event, (p) => { off(); fn(p); });\n  }\n  off(event, fn) {\n    this._listeners.get(event)?.delete(fn);\n  }\n  emit(event, payload) {\n    const list = this._listeners.get(event);\n    if (list) {\n      list.forEach(fn => {\n        try { fn(payload); } catch (e) { /* swallow */ }\n      });\n    }\n    // Wildcard listeners\n    const any = this._listeners.get('*');\n    if (any) {\n      any.forEach(fn => {\n        try { fn({ event, payload }); } catch (_) {}\n      });\n    }\n  }\n  clear() {\n    this._listeners.clear();\n  }\n}\n\nexport class SelectionManager {\n  constructor(bus) {\n    this.bus = bus;\n    this.current = null;\n  }\n  set(type, id, meta = {}) {\n    if (!type || !id) return;\n    this.current = {\n      type,\n      id,\n      meta,\n      ts: Date.now()\n    };\n    this.bus?.emit('select:changed', this.current);\n  }\n  clear() {\n    this.current = null;\n    this.bus?.emit('select:changed', null);\n  }\n  get() {\n    return this.current;\n  }\n}\n","/**\n * Overlays Inspection Panel\n * Lists resolved overlays with quick highlight and structural info.\n */\nexport class OverlaysPanel {\n  captureData() {\n    const overlays = [];\n    const stats = { total: 0, byType: {} };\n\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      const model = pipeline?.getResolvedModel?.();\n      if (model?.overlays) {\n        model.overlays.forEach(o => {\n          stats.total++;\n            stats.byType[o.type] = (stats.byType[o.type] || 0) + 1;\n          overlays.push({\n            id: o.id,\n            type: o.type || 'unknown',\n            anchor: o.anchor,\n            attach_to: o.attach_to,\n            profileCount: Array.isArray(o._profiles) ? o._profiles.length : 0,\n            patchCount: Array.isArray(o._patches) ? o._patches.length : 0,\n            styleSourceCount: Array.isArray(o._styleSources) ? o._styleSources.length : 0,\n            finalStyle: o.finalStyle || o.style || {},\n            smooth: o.smooth,\n            channel: o.channel,\n            meta: {\n              fromPacks: o.__meta?.origin_pack,\n              overridden: !!o.__meta?.overridden\n            }\n          });\n        });\n      }\n    } catch (e) {\n      console.warn('[OverlaysPanel] captureData failed:', e);\n    }\n\n    return { overlays, stats };\n  }\n\n  // REPLACED: Simplified, mount-scoped highlight with SVG-safe styling\n  highlightOverlay(id) {\n    try {\n      if (!id) return;\n      const mount = window.__msdDebug?.pipelineInstance?.mountElement ||\n                    window.__msdDebug?.mountElement;\n      if (!mount) {\n        console.warn('[OverlaysPanel] No mountElement available for highlight');\n        return;\n      }\n\n      this._ensureHighlightStyles();\n\n      // ADDED: Get overlay type to handle controls differently\n      const overlay = this._findOverlayModel(id);\n      const isControlsType = overlay?.type === 'control'; // FIXED: singular 'control' not 'controls'\n\n      console.log(`[OverlaysPanel] Overlay \"${id}\":`, overlay);\n      console.log(`[OverlaysPanel] Overlay type: \"${overlay?.type}\", isControlsType: ${isControlsType}`);\n\n      // Search only inside mount (and shadow root if present)\n      const roots = [mount];\n      if (mount.shadowRoot) roots.push(mount.shadowRoot);\n\n      const matches = [];\n      const selectorExact = `[data-overlay-id=\"${CSS.escape(id)}\"]`;\n      const selectorId = `#${CSS.escape(id)}`;\n\n      // ADDED: For controls type, search for the control containers (much simpler!)\n      const controlsSelectors = isControlsType ? [\n        `foreignObject[data-msd-control-id=\"${CSS.escape(id)}\"]`,\n        `div[data-msd-control-id=\"${CSS.escape(id)}\"]`,\n        `#msd-control-foreign-${CSS.escape(id)}`\n      ] : [];\n\n      roots.forEach(root => {\n        console.log(`[OverlaysPanel] Searching in root:`, root);\n\n        // Try standard selectors first\n        const exactMatches = root.querySelectorAll(selectorExact);\n        const byIdMatch = root.querySelector(selectorId);\n        console.log(`[OverlaysPanel] Standard selectors for \"${id}\":`, {\n          selectorExact: selectorExact,\n          exactMatches: exactMatches.length,\n          selectorId: selectorId,\n          byIdMatch: !!byIdMatch\n        });\n\n        exactMatches.forEach(el => matches.push(el));\n        if (byIdMatch && !matches.includes(byIdMatch)) matches.push(byIdMatch);\n\n        // ADDED: Search for controls-specific elements\n        if (isControlsType) {\n          console.log(`[OverlaysPanel] Searching for controls overlay: ${id}`);\n          console.log(`[OverlaysPanel] Controls selectors:`, controlsSelectors);\n          controlsSelectors.forEach(selector => {\n            try {\n              const found = root.querySelectorAll(selector);\n              console.log(`[OverlaysPanel] Selector \"${selector}\" found ${found.length} elements:`, found);\n              found.forEach(el => {\n                if (!matches.includes(el)) matches.push(el);\n              });\n            } catch (e) {\n              console.warn(`[OverlaysPanel] Invalid selector: ${selector}`, e);\n            }\n          });\n        } else {\n          console.log(`[OverlaysPanel] Not a controls type overlay, skipping controls selectors`);\n        }\n      });\n\n      console.log(`[OverlaysPanel] Total matches found: ${matches.length}`, matches);\n\n      if (matches.length === 0) {\n        console.warn('[OverlaysPanel] No nodes found for overlay', id);\n        this._toast(`Overlay not found: ${id}`, '#ff4444');\n        return;\n      }\n\n      // Apply highlight to each match\n      matches.forEach(node => {\n        if (isControlsType) {\n          // ADDED: Special highlighting for controls type\n          this._applyControlsHighlight(node, '#ff66ff');\n        } else {\n          this._applyElementHighlight(node, '#ff66ff');\n          // If group/container, highlight child paths too\n          if (node.tagName && node.tagName.toLowerCase() === 'g') {\n            node.querySelectorAll('path, line, polyline, polygon, rect, circle, ellipse').forEach(child => {\n              this._applyElementHighlight(child, '#ff66ff', true);\n            });\n          }\n        }\n      });\n\n      this._toast(`Overlay: ${id} (${overlay?.type || 'unknown'})`, '#ff66ff');\n    } catch (e) {\n      console.warn('[OverlaysPanel] highlightOverlay failed:', e);\n    }\n  }\n\n  // NEW: Special highlighting for controls type overlays (HA cards)\n  _applyControlsHighlight(node, color) {\n    const DURATION = 3000;\n\n    // Store originals for restoration\n    if (!node.dataset._msdCtrlHl) {\n      node.dataset._msdCtrlHl = '1';\n      node.dataset._msdPrevBoxShadow = node.style.boxShadow || '';\n      node.dataset._msdPrevZIndex = node.style.zIndex || '';\n      node.dataset._msdPrevOutline = node.style.outline || '';\n      node.dataset._msdPrevFilter = node.style.filter || '';\n    }\n\n    // FIXED: Apply glow/pulse highlighting without scaling to avoid position shifts\n    node.style.boxShadow = `0 0 15px ${color}, 0 0 30px ${color}, inset 0 0 15px rgba(255,102,255,0.2)`;\n    node.style.zIndex = '999999';\n    node.style.outline = `2px solid ${color}`;\n    node.style.outlineOffset = '2px';\n    node.style.filter = `drop-shadow(0 0 8px ${color}) brightness(1.1)`;\n    node.classList.add('msd-overlay-highlighted', 'msd-controls-highlighted');\n\n    // Enhanced pulsing animation without transform scaling\n    const pulseStyle = document.createElement('style');\n    pulseStyle.id = `msd-pulse-${node.dataset._msdCtrlHl}`;\n    pulseStyle.textContent = `\n      .msd-controls-highlighted {\n        animation: msdControlsPulse 1.2s ease-in-out infinite alternate;\n      }\n      @keyframes msdControlsPulse {\n        0% {\n          filter: drop-shadow(0 0 8px ${color}) brightness(1.1) saturate(1);\n          box-shadow: 0 0 15px ${color}, 0 0 30px ${color}, inset 0 0 15px rgba(255,102,255,0.2);\n        }\n        100% {\n          filter: drop-shadow(0 0 12px ${color}) brightness(1.3) saturate(1.2);\n          box-shadow: 0 0 20px ${color}, 0 0 40px ${color}, inset 0 0 20px rgba(255,102,255,0.3);\n        }\n      }\n    `;\n    document.head.appendChild(pulseStyle);\n\n    setTimeout(() => {\n      // Restore original styles\n      if (node.dataset._msdPrevBoxShadow !== undefined) {\n        if (node.dataset._msdPrevBoxShadow) node.style.boxShadow = node.dataset._msdPrevBoxShadow;\n        else node.style.removeProperty('box-shadow');\n      }\n      if (node.dataset._msdPrevZIndex !== undefined) {\n        if (node.dataset._msdPrevZIndex) node.style.zIndex = node.dataset._msdPrevZIndex;\n        else node.style.removeProperty('z-index');\n      }\n      if (node.dataset._msdPrevOutline !== undefined) {\n        if (node.dataset._msdPrevOutline) node.style.outline = node.dataset._msdPrevOutline;\n        else node.style.removeProperty('outline');\n      }\n      if (node.dataset._msdPrevFilter !== undefined) {\n        if (node.dataset._msdPrevFilter) node.style.filter = node.dataset._msdPrevFilter;\n        else node.style.removeProperty('filter');\n      }\n      node.style.removeProperty('outline-offset');\n      node.classList.remove('msd-overlay-highlighted', 'msd-controls-highlighted');\n\n      // Remove pulse animation\n      const pulse = document.getElementById(`msd-pulse-${node.dataset._msdCtrlHl}`);\n      if (pulse) pulse.remove();\n    }, DURATION);\n  }\n\n  // NEW: Apply highlight with restoration\n  _applyElementHighlight(node, color, isChild = false) {\n    const tag = (node.tagName || '').toLowerCase();\n    const isSvg =\n      ['path','g','line','polyline','polygon','rect','circle','ellipse'].includes(tag) ||\n      node instanceof SVGElement;\n\n    const DURATION = 3000;\n\n    if (isSvg) {\n      // Store originals only once\n      if (!node.dataset._msdHl) {\n        node.dataset._msdHl = '1';\n        node.dataset._msdPrevStroke = node.getAttribute('stroke') || node.style.stroke || '';\n        node.dataset._msdPrevStrokeW = node.getAttribute('stroke-width') || node.style.strokeWidth || '';\n        node.dataset._msdPrevFilter = node.style.filter || '';\n      }\n      // Emphasize\n      node.style.stroke = color;\n      if (tag !== 'g') {\n        node.style.strokeWidth = '4';\n      }\n      node.style.filter = 'drop-shadow(0 0 6px ' + color + ')';\n      node.classList.add('msd-overlay-highlighted');\n\n      setTimeout(() => {\n        // Restore\n        if (node.dataset._msdPrevStroke !== undefined) {\n          if (node.dataset._msdPrevStroke) node.style.stroke = node.dataset._msdPrevStroke;\n          else node.style.removeProperty('stroke');\n        }\n        if (node.dataset._msdPrevStrokeW !== undefined) {\n            if (node.dataset._msdPrevStrokeW) node.style.strokeWidth = node.dataset._msdPrevStrokeW;\n            else node.style.removeProperty('stroke-width');\n        }\n        if (node.dataset._msdPrevFilter !== undefined) {\n          if (node.dataset._msdPrevFilter) node.style.filter = node.dataset._msdPrevFilter;\n          else node.style.removeProperty('filter');\n        }\n        node.classList.remove('msd-overlay-highlighted');\n      }, DURATION);\n\n    } else {\n      // Non-SVG element highlight\n      if (!node.dataset._msdHlBox) {\n        node.dataset._msdHlBox = '1';\n        node.dataset._msdPrevOutline = node.style.outline || '';\n        node.dataset._msdPrevBoxShadow = node.style.boxShadow || '';\n        node.dataset._msdPrevFilter = node.style.filter || '';\n      }\n      node.style.outline = `3px solid ${color}`;\n      node.style.boxShadow = `0 0 10px ${color}`;\n      node.style.filter = `drop-shadow(0 0 6px ${color})`;\n      node.classList.add('msd-overlay-highlighted');\n\n      setTimeout(() => {\n        if (node.dataset._msdPrevOutline !== undefined) {\n          if (node.dataset._msdPrevOutline) node.style.outline = node.dataset._msdPrevOutline;\n          else node.style.removeProperty('outline');\n        }\n        if (node.dataset._msdPrevBoxShadow !== undefined) {\n          if (node.dataset._msdPrevBoxShadow) node.style.boxShadow = node.dataset._msdPrevBoxShadow;\n          else node.style.removeProperty('box-shadow');\n        }\n        if (node.dataset._msdPrevFilter !== undefined) {\n          if (node.dataset._msdPrevFilter) node.style.filter = node.dataset._msdPrevFilter;\n          else node.style.removeProperty('filter');\n        }\n        node.classList.remove('msd-overlay-highlighted');\n      }, DURATION);\n    }\n  }\n\n  // UPDATED: ensure styles (kept minimal)\n  _ensureHighlightStyles() {\n    if (document.getElementById('msd-overlay-highlight-style')) return;\n    const style = document.createElement('style');\n    style.id = 'msd-overlay-highlight-style';\n    style.textContent = `\n      .msd-overlay-highlighted {\n        transition: outline .15s, box-shadow .15s;\n      }\n    `;\n    document.head.appendChild(style);\n  }\n\n  analyzeOverlay(id) {\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      const model = pipeline?.getResolvedModel?.();\n      const overlay = model?.overlays?.find(o => o.id === id);\n      if (!overlay) {\n        console.warn('[OverlaysPanel] analyzeOverlay: overlay not found', id);\n        this._toast('Overlay not found', '#ff4444');\n        return;\n      }\n\n      // Console diagnostics\n      console.group(` Overlay Analysis: ${id}`);\n      console.table([{\n        id: overlay.id,\n        type: overlay.type,\n        anchor: overlay.anchor,\n        attach_to: overlay.attach_to,\n        channel: overlay.channel,\n        smooth: overlay.smooth,\n        profiles: (overlay._profiles || []).length,\n        patches: (overlay._patches || []).length,\n        styleSources: (overlay._styleSources || []).length\n      }]);\n      if (overlay.finalStyle || overlay.style) {\n        console.log('Final Style:', overlay.finalStyle || overlay.style);\n      }\n      if (overlay._styleSources) {\n        console.log('Style Sources (detailed):', overlay._styleSources);\n        // ADDED: Log each source individually for debugging\n        overlay._styleSources.forEach((source, i) => {\n          console.log(`Source ${i}:`, source);\n        });\n      }\n      if (overlay._patches) {\n        console.log('Rule Patches:', overlay._patches);\n      }\n      if (overlay.__meta) {\n        console.log('Metadata:', overlay.__meta);\n      }\n      // ADDED: Log full overlay object for debugging\n      console.log('Full Overlay Object:', overlay);\n      console.groupEnd();\n\n      // Popup\n      this._showOverlayPopup(overlay);\n    } catch (e) {\n      console.warn('[OverlaysPanel] analyzeOverlay failed:', e);\n    }\n  }\n\n  _showOverlayPopup(overlay) {\n    const existing = document.getElementById('msd-overlay-popup');\n    if (existing) existing.remove();\n\n    // ADDED: Get proportional font sizes for popup\n    const baseFontSize = window.__msdDebug?.hud?.manager?.state?.fontSize || 14;\n    const sectionFontSize = Math.round(baseFontSize * 1.0); // 12px when base is 12px\n    const metricFontSize = Math.round(baseFontSize * 0.92); // 11px when base is 12px\n    const controlsFontSize = Math.round(baseFontSize * 0.83); // 10px when base is 12px\n    const smallFontSize = Math.round(baseFontSize * 0.75); // 9px when base is 12px\n    const tinyFontSize = Math.round(baseFontSize * 0.67); // 8px when base is 12px\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-overlay-popup';\n    popup.style.cssText = `\n      position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);\n      background:rgba(0,0,0,0.95);color:#ff66ff;\n      border:2px solid #ff66ff;border-radius:8px;\n      padding:14px 16px;z-index:1000003;\n      font-family:monospace;font-size:${sectionFontSize}px;\n      max-width:480px;max-height:70vh;overflow:auto;\n      box-shadow:0 4px 18px rgba(255,102,255,0.4);\n    `;\n\n    const stylePreview = (() => {\n      try {\n        const s = JSON.stringify(overlay.finalStyle || overlay.style || {}, null, 2);\n        return s.length > 520 ? s.slice(0, 517) + '...' : s;\n      } catch { return '{}'; }\n    })();\n\n    const sources = (overlay._styleSources || []).map(s => `${s.kind}:${s.id}`).join(', ') || 'none';\n    const patches = (overlay._patches || []).map(p => p.ruleId || p.id).join(', ') || 'none';\n    const profiles = (overlay._profiles || []).map(p => p.id || p).join(', ') || 'none';\n\n    // ADDED: Enhanced sources breakdown showing properties from each source\n    const sourcesDetail = (() => {\n      if (!overlay._styleSources || overlay._styleSources.length === 0) return 'none';\n\n      try {\n        const finalStyleProps = overlay.finalStyle ? Object.keys(overlay.finalStyle) : [];\n        console.log('[OverlaysPanel] Final style properties:', finalStyleProps);\n        console.log('[OverlaysPanel] Number of sources:', overlay._styleSources.length);\n\n        // FIXED: Show each property individually with its source\n        const propertyMappings = [];\n\n        overlay._styleSources.forEach((source, index) => {\n          const sourceLabel = `${source.kind || 'unknown'}:${source.id || `source-${index}`}`;\n\n          // Match source index to property index\n          if (index < finalStyleProps.length) {\n            const property = finalStyleProps[index];\n            propertyMappings.push(`${property} <span style=\"color:#ffaa00;font-weight:bold;font-size:${Math.round(controlsFontSize * 1.3)}px;\">  </span> ${sourceLabel}`);\n            console.log(`[OverlaysPanel] Source ${index} (${sourceLabel})  ${property}`);\n          }\n        });\n\n        // If we have more properties than sources, the remaining might be from defaults\n        if (finalStyleProps.length > overlay._styleSources.length) {\n          const remainingProps = finalStyleProps.slice(overlay._styleSources.length);\n          remainingProps.forEach(prop => {\n            propertyMappings.push(`${prop} <span style=\"color:#ffaa00;font-weight:bold;font-size:${Math.round(controlsFontSize * 1.3)}px;\">  </span> default:computed`);\n          });\n        }\n\n        // Format as individual property lines\n        return propertyMappings.join('<br>') || 'none';\n      } catch (e) {\n        console.warn('[OverlaysPanel] Error processing sources:', e);\n        // Fallback to simple list\n        return overlay._styleSources.map((s, i) => `property${i} <span style=\"color:#ffaa00;font-weight:bold;font-size:${Math.round(controlsFontSize * 1.3)}px;\">  </span> ${s.kind || 'unknown'}:${s.id || 'unnamed'}`).join('<br>');\n      }\n    })();    popup.innerHTML = `\n      <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;\">\n        <h3 style=\"margin:0;color:#ffaaee;\">Overlay: ${overlay.id}</h3>\n        <button style=\"background:#331133;color:#fff;border:1px solid #553366;border-radius:4px;padding:2px 8px;cursor:pointer;font-size:${metricFontSize}px;\"\n          onclick=\"document.getElementById('msd-overlay-popup')?.remove()\">\n          Close\n        </button>\n      </div>\n      <div style=\"font-size:${metricFontSize}px;line-height:1.4;color:#ddd;\">\n        <strong>Type:</strong> ${overlay.type || 'n/a'}<br>\n        <strong>Anchor:</strong> ${overlay.anchor || 'none'}  <strong>Attach:</strong> ${overlay.attach_to || 'none'}<br>\n        <strong>Channel:</strong> ${overlay.channel || 'none'} | <strong>Smooth:</strong> ${overlay.smooth ? 'yes':'no'}<br>\n        <strong>Profiles:</strong> ${profiles}<br>\n        <strong>Sources:</strong><br>\n        <div style=\"margin-left:12px;font-size:${controlsFontSize}px;color:#bbb;line-height:1.3;\">\n          ${sourcesDetail}\n        </div>\n        <strong>Patches:</strong> ${patches}<br>\n        <strong>Meta:</strong> ${overlay.__meta ? Object.keys(overlay.__meta).join(', ') : 'none'}\n      </div>\n      <div style=\"margin-top:8px;\">\n        <div style=\"color:#ffaaee;font-size:${metricFontSize}px;margin-bottom:4px;\">Final Style</div>\n        <pre style=\"margin:0;background:#111;color:#ccc;padding:8px;border:1px solid #552255;border-radius:4px;font-size:${controlsFontSize}px;max-height:200px;overflow:auto;\">${stylePreview}</pre>\n      </div>\n      <div style=\"margin-top:8px;text-align:right;\">\n        <button\n          style=\"background:#552255;color:#fff;border:1px solid #aa55aa;border-radius:4px;padding:3px 10px;cursor:pointer;font-size:${metricFontSize}px;\"\n          onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(overlay.finalStyle || overlay.style || {})},null,2))\">\n          Copy Style\n        </button>\n        <button\n          style=\"background:#331133;color:#fff;border:1px solid #553366;border-radius:4px;padding:3px 10px;cursor:pointer;font-size:${metricFontSize}px;margin-left:6px;\"\n          onclick=\"document.getElementById('msd-overlay-popup')?.remove()\">\n          Done\n        </button>\n      </div>\n    `;\n\n    document.body.appendChild(popup);\n    setTimeout(() => {\n      if (popup.parentElement) popup.style.opacity = '1';\n    }, 10);\n\n    // REMOVED: Auto-close timeout - let users close manually\n    // setTimeout(() => popup.parentElement && popup.remove(), 25000);\n  }\n\n  // NEW: analyzeOverlay remains (unchanged) above/below if already present\n\n  // NEW helper: ensure CSS\n  _ensureHighlightStyles() {\n    if (document.getElementById('msd-overlay-highlight-style')) return;\n    const style = document.createElement('style');\n    style.id = 'msd-overlay-highlight-style';\n    style.textContent = `\n      .msd-overlay-highlighted {\n        transition: outline .15s, box-shadow .15s;\n      }\n    `;\n    document.head.appendChild(style);\n  }\n\n  // NEW helper: locate overlay model object\n  _findOverlayModel(id) {\n    try {\n      const model = window.__msdDebug?.pipelineInstance?.getResolvedModel?.();\n      return model?.overlays?.find(o => o.id === id);\n    } catch {\n      return null;\n    }\n  }\n\n  // NEW helper: create bounding box from overlay anchor + attach_to if anchors exist\n  _highlightBoundingBoxFromModel(overlay, id) {\n    try {\n      const anchorId = overlay.anchor;\n      const attachId = overlay.attach_to;\n      const mount =\n        window.__msdDebug?.pipelineInstance?.mountElement ||\n        window.__msdDebug?.mountElement ||\n        document;\n\n      const anchorEl = anchorId ? mount.querySelector(`[data-anchor-id=\"${CSS.escape(anchorId)}\"],#${CSS.escape(anchorId)}`) : null;\n      const attachEl = attachId ? mount.querySelector(`[data-anchor-id=\"${CSS.escape(attachId)}\"],#${CSS.escape(attachId)}`) : null;\n\n      if (!anchorEl && !attachEl) {\n        // fallback to mount bounding box\n        const rect = mount.getBoundingClientRect();\n        this._spawnBoundingBox(rect, id, '#ff66ff');\n        return;\n      }\n\n      // Compute combined rect\n      const rects = [];\n      if (anchorEl) rects.push(anchorEl.getBoundingClientRect());\n      if (attachEl) rects.push(attachEl.getBoundingClientRect());\n\n      const minX = Math.min(...rects.map(r => r.left));\n      const minY = Math.min(...rects.map(r => r.top));\n      const maxR = Math.max(...rects.map(r => r.right));\n      const maxB = Math.max(...rects.map(r => r.bottom));\n\n      this._spawnBoundingBox(\n        { left: minX, top: minY, width: maxR - minX, height: maxB - minY },\n        id,\n        '#ff66ff'\n      );\n    } catch (e) {\n      console.warn('[OverlaysPanel] _highlightBoundingBoxFromModel failed:', e);\n    }\n  }\n\n  // NEW helper: spawn absolute box\n  _spawnBoundingBox(rect, id, color) {\n    if (!rect) return;\n    const box = document.createElement('div');\n    box.className = 'msd-overlay-box-highlight';\n    box.style.left = rect.left + 'px';\n    box.style.top = rect.top + 'px';\n    box.style.width = rect.width + 'px';\n    box.style.height = rect.height + 'px';\n    box.dataset.overlayBoxFor = id;\n    document.body.appendChild(box);\n    setTimeout(() => box.remove(), 3000);\n    this._toast(`Overlay (bbox): ${id}`, color);\n  }\n\n  _toast(msg, color = '#ff66ff') {\n    // ADDED: Get proportional font size for toast\n    const baseFontSize = window.__msdDebug?.hud?.manager?.state?.fontSize || 14;\n    const controlsFontSize = Math.round(baseFontSize * 0.83); // 10px when base is 12px\n\n    const el = document.createElement('div');\n    el.style.cssText = `\n      position:fixed;top:18px;right:18px;\n      background:#000;padding:4px 10px;\n      border:1px solid ${color};color:${color};\n      font:${controlsFontSize}px monospace;z-index:1000002;\n      border-radius:4px;opacity:.95;\n    `;\n    el.textContent = msg;\n    document.body.appendChild(el);\n    setTimeout(() => el.remove(), 1600);\n  }\n\n  renderHtml(data) {\n    const { overlays = [], stats = {} } = data;\n\n    // ADDED: Get font size from HUD manager context for proportional scaling\n    const baseFontSize = window.__msdDebug?.hud?.manager?.state?.fontSize || 14;\n    const metricFontSize = Math.round(baseFontSize * 0.92); // 11px when base is 12px\n    const controlsFontSize = Math.round(baseFontSize * 0.83); // 10px when base is 12px\n    const smallFontSize = Math.round(baseFontSize * 0.75); // 9px when base is 12px\n    const tinyFontSize = Math.round(baseFontSize * 0.67); // 8px when base is 12px\n\n    let html = '<div class=\"msd-hud-panel\"><h3>Overlays</h3>';\n    html += `<style>\n      .msd-overlay-highlighted { outline:3px solid #ff66ff !important; }\n    </style>`;\n    html += '<div class=\"msd-hud-section\"><h4>Stats</h4>';\n    html += `<div class=\"msd-hud-metric\"><span class=\"msd-hud-metric-name\">Total</span><span class=\"msd-hud-metric-value\">${stats.total || 0}</span></div>`;\n    Object.entries(stats.byType || {}).slice(0,6).forEach(([type,count]) => {\n      html += `<div class=\"msd-hud-metric\" style=\"font-size:${controlsFontSize}px;\">\n        <span class=\"msd-hud-metric-name\">${type}</span>\n        <span class=\"msd-hud-metric-value\">${count}</span>\n      </div>`;\n    });\n    html += '</div>';\n\n    if (!overlays.length) {\n      html += '<div class=\"msd-hud-section\">No overlays</div></div>';\n      return html;\n    }\n\n    html += '<div class=\"msd-hud-section\"><h4>Overlay List</h4>';\n    overlays.slice(0,25).forEach(o => {\n      const shortId = o.id.length > 22 ? o.id.slice(0,19)+'...' : o.id;\n      const badge = o.meta.overridden ? '  mod' : '';\n      const stylePreview = (() => {\n        try {\n          const json = JSON.stringify(o.finalStyle);\n          return json.length > 50 ? json.slice(0,47)+'...' : json;\n        } catch { return ''; }\n      })();\n      html += `<div\n        data-select-type=\"overlay\"\n        data-select-id=\"${o.id}\"\n        style=\"cursor:pointer;border:1px solid #222;padding:4px;border-radius:4px;margin:4px 0;\"\n        onclick=\"__msdHudBus('select:set',{type:'overlay',id:'${o.id}',source:'overlays'});__msdHudBus('overlay:highlight',{id:'${o.id}'})\"\n      >\n        <div style=\"display:flex;justify-content:space-between;align-items:center;\">\n          <span style=\"color:#aaa;\">${shortId}${badge}</span>\n          <span style=\"color:#ff66ff;font-size:${metricFontSize}px;\">${o.type}</span>\n        </div>\n        <div style=\"font-size:${controlsFontSize}px;color:#888;margin-top:2px;\">\n          ${o.anchor ? `Anchor: ${o.anchor}` : 'No anchor'} ${o.attach_to ? `<span style=\"color:#ffaa00;font-weight:bold;font-size:${Math.round(controlsFontSize * 1.2)}px;\">  </span>${o.attach_to}` : ''} ${o.channel ? ` Channel: ${o.channel}` : ''} ${o.smooth ? ' Smooth' : ''}\n        </div>\n        <div style=\"font-size:${controlsFontSize}px;color:#666;margin-top:2px;\">\n          Sources: ${o.styleSourceCount}  Profiles: ${o.profileCount}  Patches: ${o.patchCount}\n        </div>\n        <div style=\"font-size:${smallFontSize}px;color:#555;overflow:hidden;text-overflow:ellipsis;margin-top:2px;\">\n          ${stylePreview}\n        </div>\n        <div style=\"margin-top:4px;text-align:right;\">\n          <button\n            onclick=\"event.stopPropagation();__msdHudBus('overlay:highlight',{id:'${o.id}'});__msdHudBus('overlay:analyze',{id:'${o.id}'})\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#331133;color:#ffccff;border:1px solid #553355;border-radius:3px;cursor:pointer;\">\n            Analyze\n          </button>\n        </div>\n      </div>`;\n    });\n    if (overlays.length > 25) {\n      html += `<div style=\"font-size:${smallFontSize}px;opacity:.6;text-align:center;margin-top:4px;\">... ${overlays.length - 25} more</div>`;\n    }\n    html += '</div></div>';\n    return html;\n  }\n}\n","/**\n * MSD HUD Manager - Coordinates all debug panels\n * Provides development interface for monitoring MSD v1 pipeline\n */\n\nimport { PerformancePanel } from './panels/PerformancePanel.js';\nimport { ValidationPanel } from './panels/ValidationPanel.js';\nimport { DataSourcePanel } from './panels/DataSourcePanel.js';\nimport { RoutingPanel } from './panels/RoutingPanel.js';\nimport { ChannelTrendPanel } from './panels/ChannelTrendPanel.js';\nimport { FlagsPanel } from './panels/FlagsPanel.js';\nimport { IssuesPanel } from './panels/IssuesPanel.js';\nimport { PacksPanel } from './panels/PacksPanel.js';\nimport { RulesPanel } from './panels/RulesPanel.js';\nimport { ExportPanel } from './panels/ExportPanel.js';\nimport { HudEventBus } from './hudService.js'; // existing\nimport { SelectionManager } from './hudService.js'; // ADDED\nimport { OverlaysPanel } from './panels/OverlaysPanel.js'; // ADDED\n\n// FIXED: Move debug verification to constructor only, not on every import\nconsole.log('[MsdHudManager] Importing ExportPanel class');\n\nexport class MsdHudManager {\n  constructor() {\n    // FIXED: Test ExportPanel instantiation only once during construction\n    console.log('[MsdHudManager] Testing ExportPanel instantiation...');\n    try {\n      const testExportPanel = new ExportPanel();\n      console.log('[MsdHudManager] ExportPanel test successful');\n    } catch (e) {\n      console.error('[MsdHudManager] ExportPanel instantiation failed:', e);\n    }\n\n    this.bus = new HudEventBus(); // ADDED\n    window.__msdHudBus = (evt, payload) => this.bus.emit(evt, payload || {}); // ADDED global helper\n\n    this.panels = {\n      issues: new IssuesPanel(),\n      flags: new FlagsPanel(),\n      performance: new PerformancePanel(),\n      export: new ExportPanel(),\n      rules: new RulesPanel(),\n      packs: new PacksPanel(),\n      overlays: new OverlaysPanel(), // ADDED\n      routing: new RoutingPanel(),\n      channelTrend: new ChannelTrendPanel(),\n      dataSources: new DataSourcePanel(),\n      validation: new ValidationPanel()\n    };\n\n    // FIXED: Only log panel creation once during construction\n    console.log('[MsdHudManager] Created panels:', Object.keys(this.panels));\n\n    this.state = {\n      visible: false,\n      activePanel: 'performance',\n      refreshRate: 2000,\n      lastRefresh: 0,\n      panelVisibility: {\n        issues: true,\n        flags: true,\n        performance: true,\n        export: true,\n        rules: true,\n        packs: true,\n        overlays: true, // ADDED (default visible)\n        routing: false,\n        channelTrend: false,\n        dataSources: false,\n        validation: false\n      },\n      panelOrder: ['issues','flags','performance','export','rules','packs','overlays','routing','channelTrend','dataSources','validation'], // UPDATED\n      compactMode: false,\n      autoPosition: true,\n      panelManagerOpen: false,\n      hudWidth: 420,\n      resizable: false,\n      // ADDED: Font and scaling options\n      fontSize: 14, // Base font size in pixels (default 14px)\n      hudScale: 1.0, // Overall HUD scale factor (0.8 - 1.5)\n      fontFamily: '\"Antonio\", monospace' // Font family with LCARS default + fallback\n    };\n\n    // FIXED: Only log state once during construction\n    console.log('[MsdHudManager] Initial panel order:', this.state.panelOrder);\n\n    this.hudElement = null;\n    this.refreshInterval = null;\n    this.mountElement = null;\n\n    this.dragState = {\n      isDragging: false,\n      startX: 0,\n      startY: 0,\n      startLeft: 0,\n      startTop: 0\n    };\n\n    this._setupGlobalPanelControls();\n    this.keyboardEnabled = true;\n    this._setupKeyboardShortcuts();\n\n    // ADDED: Provide bus to panels (optional future use)\n    Object.values(this.panels).forEach(p => { p.bus = this.bus; });\n\n    this._registerBusHandlers(); // ADDED\n    this.selection = new SelectionManager(this.bus); // ADDED\n    this._registerSelectionHandlers(); // ADDED\n\n    // ADDED: Bind core instance methods to prevent context loss in external handlers\n    this.show = this.show.bind(this);\n    this.hide = this.hide.bind(this);\n    this.toggle = this.toggle.bind(this);\n    this.refresh = this.refresh.bind(this);\n    this.setRefreshRate = this.setRefreshRate.bind(this);\n  }\n\n  // ADDED: Setup global panel control handlers\n  _setupGlobalPanelControls() {\n    if (window.__msdHudPanelControls) return;\n\n    const self = this;\n    window.__msdHudPanelControls = {\n      togglePanel: function(panelName) {\n        self.state.panelVisibility[panelName] = !self.state.panelVisibility[panelName];\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n      },\n\n      setCompactMode: function(enabled) {\n        self.state.compactMode = enabled;\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n      },\n\n      setAutoPosition: function(enabled) {\n        self.state.autoPosition = enabled;\n        if (enabled) {\n          self._autoPositionHud();\n        }\n      },\n\n      resetPanelLayout: function() {\n        // FIXED: Reset to default visibility including export panel\n        Object.keys(self.state.panelVisibility).forEach(panel => {\n          self.state.panelVisibility[panel] = ['issues', 'flags', 'performance', 'export'].includes(panel);\n        });\n        self.state.compactMode = false;\n        self.state.autoPosition = true;\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n        self._autoPositionHud();\n      },\n\n      movePanel: function(panelName, direction) {\n        const currentOrder = [...self.state.panelOrder];\n        const currentIndex = currentOrder.indexOf(panelName);\n\n        if (currentIndex === -1) return;\n\n        const newIndex = direction === 'up' ?\n          Math.max(0, currentIndex - 1) :\n          Math.min(currentOrder.length - 1, currentIndex + 1);\n\n        // Swap positions\n        [currentOrder[currentIndex], currentOrder[newIndex]] =\n        [currentOrder[newIndex], currentOrder[currentIndex]];\n\n        self.state.panelOrder = currentOrder;\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n      },\n\n      // ENHANCED: Set up panel manager toggle handler\n      togglePanelManager: function() {\n        self.state.panelManagerOpen = !self.state.panelManagerOpen;\n\n        const manager = document.getElementById('msd-panel-manager');\n        if (manager) {\n          manager.style.display = self.state.panelManagerOpen ? 'block' : 'none';\n\n          // FIXED: Always attach event listeners when toggling\n          if (self.state.panelManagerOpen) {\n            setTimeout(() => self._attachPanelManagerEventListeners(), 10);\n          }\n        }\n\n        console.log('[MsdHudManager] Panel manager toggled:', self.state.panelManagerOpen);\n      },\n\n      // ADDED: Close panel manager handler\n      closePanelManager: function() {\n        self.state.panelManagerOpen = false;\n\n        const manager = document.getElementById('msd-panel-manager');\n        if (manager) {\n          manager.style.display = 'none';\n        }\n\n        console.log('[MsdHudManager] Panel manager closed');\n      },\n\n      // ADDED: Font size controls\n      adjustFontSize: function(delta) {\n        // FIXED: Add throttling to prevent rapid multiple calls\n        if (self._fontSizeThrottle) return;\n        self._fontSizeThrottle = true;\n\n        setTimeout(() => {\n          self._fontSizeThrottle = false;\n        }, 200); // 200ms throttle\n\n        const newSize = Math.max(8, Math.min(20, self.state.fontSize + delta));\n        if (newSize !== self.state.fontSize) {\n          self.state.fontSize = newSize;\n          self._applyFontAndScale();\n          console.log(`[MsdHudManager] Font size adjusted to ${newSize}px`);\n        }\n      },\n\n      setFontSize: function(size) {\n        const newSize = Math.max(8, Math.min(20, parseInt(size) || 14));\n        if (newSize !== self.state.fontSize) {\n          self.state.fontSize = newSize;\n          self._applyFontAndScale();\n          console.log(`[MsdHudManager] Font size set to ${newSize}px`);\n        }\n      },\n\n      // ADDED: HUD scale controls\n      adjustHudScale: function(delta) {\n        // FIXED: Add throttling to prevent rapid multiple calls\n        if (self._scaleThrottle) return;\n        self._scaleThrottle = true;\n\n        setTimeout(() => {\n          self._scaleThrottle = false;\n        }, 200); // 200ms throttle\n\n        const newScale = Math.max(0.7, Math.min(2.0, self.state.hudScale + delta));\n        if (Math.abs(newScale - self.state.hudScale) > 0.05) {\n          self.state.hudScale = newScale;\n          self._applyFontAndScale();\n          console.log(`[MsdHudManager] HUD scale adjusted to ${newScale.toFixed(2)}x`);\n        }\n      },\n\n      setHudScale: function(scale) {\n        const newScale = Math.max(0.7, Math.min(2.0, parseFloat(scale) || 1.0));\n        if (Math.abs(newScale - self.state.hudScale) > 0.05) {\n          self.state.hudScale = newScale;\n          self._applyFontAndScale();\n          console.log(`[MsdHudManager] HUD scale set to ${newScale.toFixed(2)}x`);\n        }\n      },\n\n      // ADDED: Font family controls\n      setFontFamily: function(family) {\n        console.log(`[MsdHudManager] setFontFamily called with: \"${family}\"`);\n        const validFamilies = [\n          '\"Antonio\", monospace',\n          'monospace',\n          'sans-serif',\n          'serif',\n          '\"Courier New\", monospace',\n          '\"Roboto Mono\", monospace'\n        ];\n\n        // Handle HTML-encoded quotes and normalize\n        let normalizedFamily = family;\n        if (family.includes('&quot;')) {\n          normalizedFamily = family.replace(/&quot;/g, '\"');\n        }\n\n        console.log(`[MsdHudManager] Normalized font family: \"${normalizedFamily}\"`);\n\n        if (validFamilies.includes(normalizedFamily)) {\n          self.state.fontFamily = normalizedFamily;\n          self._applyFontAndScale();\n          // FIXED: Don't force a content update that might close dropdowns\n          // setTimeout(() => self.updateHudContent(), 50);\n          console.log(`[MsdHudManager] Font family successfully set to: ${normalizedFamily}`);\n        } else {\n          console.warn(`[MsdHudManager] Invalid font family: \"${family}\" (normalized: \"${normalizedFamily}\")`, {\n            validFamilies,\n            received: family,\n            normalized: normalizedFamily\n          });\n        }\n      }\n    };\n  }\n\n  // ADDED: Apply font size and scale changes\n  _applyFontAndScale() {\n    if (!this.hudElement) return;\n\n    const baseFontSize = this.state.fontSize;\n    const scale = this.state.hudScale;\n    const family = this.state.fontFamily;\n\n    // Apply transform and font changes to the main HUD element\n    this.hudElement.style.transform = `scale(${scale})`;\n    this.hudElement.style.transformOrigin = 'top left';\n    this.hudElement.style.fontFamily = family;\n    this.hudElement.style.fontSize = `${baseFontSize}px`;\n\n    // Adjust positioning if scaled to prevent clipping\n    if (scale !== 1.0) {\n      const rect = this.hudElement.getBoundingClientRect();\n      const scaledWidth = this.state.hudWidth * scale;\n      const scaledHeight = rect.height * scale;\n\n      // Ensure HUD doesn't go off-screen when scaled\n      const currentLeft = parseInt(this.hudElement.style.left) || 0;\n      const currentTop = parseInt(this.hudElement.style.top) || 0;\n\n      const maxLeft = window.innerWidth - scaledWidth - 10;\n      const maxTop = window.innerHeight - scaledHeight - 10;\n\n      if (currentLeft > maxLeft) {\n        this.hudElement.style.left = Math.max(10, maxLeft) + 'px';\n      }\n      if (currentTop > maxTop) {\n        this.hudElement.style.top = Math.max(10, maxTop) + 'px';\n      }\n    }\n\n    console.log(`[MsdHudManager] Applied font: ${baseFontSize}px ${family}, scale: ${scale}x`);\n  }\n\n  // ADDED: Auto-positioning logic\n  _autoPositionHud() {\n    if (!this.state.autoPosition || !this.hudElement) return;\n\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n    const hudWidth = this.state.hudWidth; // ENHANCED: Use configurable width\n\n    // Calculate optimal height based on visible panels\n    const visiblePanelCount = Object.values(this.state.panelVisibility).filter(Boolean).length;\n    const estimatedHeight = Math.min(\n      viewportHeight * 0.9, // ENHANCED: Increased from 0.85 to 0.9\n      200 + (visiblePanelCount * (this.state.compactMode ? 80 : 140)) // ENHANCED: Increased panel height estimate\n    );\n\n    // Check for Home Assistant header and sidebar\n    const haHeader = document.querySelector('app-header, ha-app-layout app-header');\n    const haSidebar = document.querySelector('ha-sidebar, app-drawer-layout ha-sidebar');\n\n    const headerHeight = haHeader ? haHeader.offsetHeight : 0;\n    const sidebarWidth = haSidebar && !haSidebar.hasAttribute('collapsed') ?\n      haSidebar.offsetWidth : 0;\n\n    // Smart positioning algorithm\n    let left, top;\n\n    // Try right side first (most common)\n    left = viewportWidth - hudWidth - 20;\n\n    // If sidebar takes up left space, ensure we don't overlap\n    if (sidebarWidth > 0 && left < sidebarWidth + 20) {\n      left = Math.max(sidebarWidth + 20, viewportWidth - hudWidth - 20);\n    }\n\n    // If still not enough space, try left side\n    if (left < 20) {\n      left = 20;\n    }\n\n    // Vertical positioning accounting for header\n    top = Math.max(headerHeight + 20, 20);\n\n    // Ensure bottom doesn't go off screen\n    if (top + estimatedHeight > viewportHeight - 20) {\n      top = Math.max(headerHeight + 20, viewportHeight - estimatedHeight - 20);\n    }\n\n    // ADDED: Smooth positioning transition\n    this.hudElement.style.transition = 'all 0.3s ease';\n    this.hudElement.style.left = left + 'px';\n    this.hudElement.style.top = top + 'px';\n    this.hudElement.style.right = 'auto';\n\n    // Remove transition after animation\n    setTimeout(() => {\n      this.hudElement.style.transition = '';\n    }, 300);\n\n    console.log(`[MsdHudManager] Auto-positioned to (${left}, ${top}) avoiding header:${headerHeight}px sidebar:${sidebarWidth}px`);\n  }\n\n  // ADDED: Handle window resize for auto-positioning\n  _setupResizeHandler() {\n    if (this._resizeSetup) return;\n    this._resizeSetup = true;\n\n    let resizeTimeout;\n    window.addEventListener('resize', () => {\n      if (this.state.autoPosition && this.state.visible) {\n        clearTimeout(resizeTimeout);\n        resizeTimeout = setTimeout(() => {\n          this._autoPositionHud();\n        }, 250);\n      }\n    });\n  }\n\n  /**\n   * Initialize with mount element from pipeline\n   * @param {HTMLElement} mountElement - Mount element from pipeline\n   */\n  init(mountElement) {\n    // Store mount element for pipeline context but don't use it for HUD mounting\n    this.mountElement = mountElement;\n\n    // ENHANCED: Store mount element in debug interface for panels to access\n    if (window.__msdDebug) {\n      window.__msdDebug.mountElement = mountElement;\n    }\n\n    // ADDED: Setup centralized debug status access for panels\n    this._setupDebugStatusHelper();\n\n    console.log('[MsdHudManager] Initialized with pipeline mount element reference');\n  }\n\n  // ADDED: Centralized debug status access for all panels\n  _setupDebugStatusHelper() {\n    if (window.__msdDebug?.getDebugStatusSilent) return; // Already setup\n\n    const W = typeof window !== 'undefined' ? window : {};\n    W.__msdDebug = W.__msdDebug || {};\n\n    W.__msdDebug.getDebugStatusSilent = function() {\n      try {\n        // Try debugManager first (preferred)\n        const pipelineInstance = W.__msdDebug?.pipelineInstance;\n        const debugManager = pipelineInstance?.systemsManager?.debugManager;\n        if (debugManager?.getSnapshot) {\n          return debugManager.getSnapshot();\n        }\n\n        // Fallback to debug._state directly (no console output)\n        const debug = W.__msdDebug?.debug;\n        if (debug?._state) {\n          return { ...debug._state };\n        }\n\n        // Last resort fallback\n        return { enabled: false, initialized: false };\n      } catch (e) {\n        return { enabled: false, initialized: false, error: e.message };\n      }\n    };\n  }\n\n  _registerBusHandlers() {\n    const { routing, performance, flags, export: exp, dataSources, issues, overlays } = this.panels;\n\n    // Routing\n    this.bus.on('routing:highlight', ({ id }) => routing?.highlightRoute?.(id));\n    this.bus.on('routing:analyze', ({ id }) => routing?.analyzeRoute?.(id));\n    this.bus.on('routing:set-filter', ({ key, value }) => routing?.setFilter?.(key, value));\n    this.bus.on('routing:update-cost', ({ key, value }) => routing?.updateCostFilter?.(key, value));\n    this.bus.on('routing:finalize-cost', () => routing?.finalizeCostFilter?.());\n    this.bus.on('routing:focus-set', ({ field, focus }) => routing?.setInputFocus?.(field, focus));\n\n    // Performance\n    this.bus.on('performance:clear-all', () => performance?.clearAllTimers?.());\n    this.bus.on('performance:export', () => performance?.exportData?.());\n    this.bus.on('performance:reset-timer', ({ timer }) => performance?.resetTimer?.(timer));\n    this.bus.on('performance:set-threshold', ({ timer, value }) => performance?.setThreshold?.(timer, value));\n\n    // Flags\n    this.bus.on('flags:toggle', ({ feature }) => flags?.toggleFeature?.(feature));\n    this.bus.on('flags:scale-adjust', ({ dir }) => flags?.adjustScale?.(dir));\n    this.bus.on('flags:scale-set', ({ scale }) => flags?.setScale?.(scale));\n    this.bus.on('flags:refresh', () => flags?.refreshDebug?.());\n\n    // Export\n    this.bus.on('export:collapsed', () => exp?.exportCollapsed?.());\n    this.bus.on('export:full', () => exp?.exportFull?.(false));\n    this.bus.on('export:full-meta', () => exp?.exportFull?.(true));\n    this.bus.on('export:copy', ({ type }) => exp?.copyToClipboard?.(type));\n    this.bus.on('export:clear', ({ type }) => exp?.clearTextarea?.(type));\n\n    // Data sources\n    this.bus.on('datasource:inspect', ({ id }) => dataSources?.inspectEntity?.(id));\n    this.bus.on('datasource:refresh-subs', () => dataSources?.refreshSubscriptions?.());\n    this.bus.on('datasource:clear-history', () => dataSources?.clearHistory?.());\n\n    // Issues\n    this.bus.on('issues:action', ({ action, id, overlay }) => issues?.handleIssueClick?.(action, id, overlay));\n\n    // ADDED: Overlay highlight bus\n    this.bus.on('overlay:highlight', ({ id }) => overlays?.highlightOverlay?.(id));\n    // ADDED: overlay analyze\n    this.bus.on('overlay:analyze', ({ id }) => overlays?.analyzeOverlay?.(id));\n\n    // Generic\n    this.bus.on('hud:refresh', () => this.refresh());\n\n    // ADDED: HUD settings controls\n    this.bus.on('refresh-rate:change', ({ value }) => {\n      console.log('[MsdHudManager] Refresh rate change event:', value);\n      const rate = parseInt(value);\n      if (!isNaN(rate) && rate > 0) {\n        this.setRefreshRate(rate);\n        console.log('[MsdHudManager] Refresh rate set to:', rate);\n      }\n    });\n\n    this.bus.on('width:adjust', ({ delta }) => {\n      console.log('[MsdHudManager] Width adjust event:', delta);\n      this.adjustWidth(parseInt(delta));\n    });\n\n    this.bus.on('font:adjust', ({ delta }) => {\n      console.log('[MsdHudManager] Font adjust event:', delta, 'throttled:', !!this._fontSizeThrottle);\n      window.__msdHudPanelControls?.adjustFontSize(parseInt(delta));\n    });\n\n    this.bus.on('scale:adjust', ({ delta }) => {\n      console.log('[MsdHudManager] Scale adjust event:', delta, 'throttled:', !!this._scaleThrottle);\n      window.__msdHudPanelControls?.adjustHudScale(parseFloat(delta));\n    });\n\n    this.bus.on('font-family:change', ({ value }) => {\n      console.log('[MsdHudManager] Font family change event:', value);\n      // FIXED: Add small delay to prevent event conflicts\n      setTimeout(() => {\n        window.__msdHudPanelControls?.setFontFamily(value);\n      }, 10);\n    });\n\n    this.bus.on('font:reset', () => {\n      console.log('[MsdHudManager] Font reset event');\n      this.state.fontSize = 14;\n      this.state.hudScale = 1.0;\n      this.state.fontFamily = '\"Antonio\", monospace';\n      this._applyFontAndScale();\n      this.updateHudContent();\n      console.log('[MsdHudManager] Font settings reset to defaults');\n    });\n  }\n\n  _registerSelectionHandlers() { // ADDED\n    this.bus.on('select:set', ({ type, id, source }) => {\n      this.selection.set(type, id, { source });\n      // Optional contextual highlight actions\n      if (type === 'route') {\n        this.bus.emit('routing:highlight', { id });\n      } else if (type === 'overlay') {\n        this.bus.emit('overlay:highlight', { id });\n      }\n      this.refresh();\n    });\n    this.bus.on('select:clear', () => {\n      this.selection.clear();\n      this.refresh();\n    });\n    // Passive listener to apply highlight after render\n    this.bus.on('select:changed', () => {\n      // If HUD already rendered, apply highlight without full refresh\n      this._applySelectionHighlight();\n      this._updateSelectionBadge();\n    });\n  }\n\n  _applySelectionHighlight() { // ADDED\n    if (!this.hudElement) return;\n    const sel = this.selection.get();\n    // Clear old\n    this.hudElement.querySelectorAll('.msd-selected').forEach(el => el.classList.remove('msd-selected'));\n    if (!sel) return;\n    // Match any element with matching data-select-type & id\n    const matches = this.hudElement.querySelectorAll(\n      `[data-select-type=\"${sel.type}\"][data-select-id=\"${CSS.escape(sel.id)}\"]`\n    );\n    matches.forEach(el => el.classList.add('msd-selected'));\n  }\n\n  _updateSelectionBadge() { // ADDED\n    if (!this.hudElement) return;\n    const badge = this.hudElement.querySelector('#msd-selection-badge');\n    if (!badge) return;\n    const sel = this.selection.get();\n    if (!sel) {\n      badge.innerHTML = '';\n      return;\n    }\n    badge.innerHTML = `\n      <span style=\"background:#222;border:1px solid #444;padding:2px 6px;border-radius:4px;font-size:10px;display:inline-flex;gap:6px;align-items:center;\">\n        <span style=\"color:#ffaa00;\">${sel.type}</span>\n        <span style=\"color:#00ffff;max-width:160px;overflow:hidden;text-overflow:ellipsis;\">${sel.id}</span>\n        <button data-bus-event=\"select:clear\"\n          onclick=\"__msdHudBus('select:clear')\"\n          style=\"background:#333;color:#ccc;border:1px solid #555;border-radius:3px;font-size:9px;cursor:pointer;padding:0 4px;\">\n          \n        </button>\n      </span>\n    `;\n  }\n\n  // ADDED: Toggle collapse\n  togglePanelCollapse(panelName) {\n    this.state.collapsedPanels[panelName] = !this.state.collapsedPanels[panelName];\n    // Lightweight re-render (no data recapture)\n    this._applyCollapseState();\n  }\n\n  // ADDED: Toggle focus (exclusive view)\n  toggleFocusPanel(panelName) {\n    if (this.state.focusPanel === panelName) {\n      this.state.focusPanel = null;\n    } else {\n      this.state.focusPanel = panelName;\n    }\n    this.updateHudContent();\n  }\n\n  // ADDED: Apply collapse styling post-render\n  _applyCollapseState() {\n    if (!this.hudElement) return;\n    const wrappers = this.hudElement.querySelectorAll('.msd-hud-panel[data-panel]');\n    wrappers.forEach(w => {\n      const name = w.getAttribute('data-panel');\n      const collapsed = this.state.collapsedPanels[name];\n      if (collapsed) {\n        w.classList.add('collapsed');\n      } else {\n        w.classList.remove('collapsed');\n      }\n      // Update indicator symbol\n      const h3 = w.querySelector(':scope h3');\n      const ind = h3?.querySelector('.msd-collapse-indicator');\n      if (ind) ind.textContent = collapsed ? '+' : '';\n      // Focus visibility\n      if (this.state.focusPanel && this.state.focusPanel !== name) {\n        w.classList.add('focus-hidden');\n      } else {\n        w.classList.remove('focus-hidden');\n      }\n      // Filter handling\n      if (this.state.filterTerm) {\n        const term = this.state.filterTerm.toLowerCase();\n        const matches = name.toLowerCase().includes(term);\n        if (!matches) {\n          w.classList.add('filter-hidden');\n        } else {\n          w.classList.remove('filter-hidden');\n        }\n      } else {\n        w.classList.remove('filter-hidden');\n      }\n    });\n    this._updateFocusBadgeInFooter();\n  }\n\n  // ADDED: Decorate panel headers after render\n  _decoratePanelHeaders() {\n    if (!this.hudElement) return;\n    const wrappers = this.hudElement.querySelectorAll('.msd-hud-panel[data-panel]');\n    wrappers.forEach(w => {\n      const name = w.getAttribute('data-panel');\n      const h3 = w.querySelector(':scope h3'); // first h3 inside nested structure\n      if (!h3 || h3.dataset.enhanced === '1') return;\n      h3.dataset.enhanced = '1';\n      h3.style.cursor = 'pointer';\n      // Insert collapse indicator\n      const indicator = document.createElement('span');\n      indicator.className = 'msd-collapse-indicator';\n      indicator.style.cssText = 'margin-left:6px;font-weight:bold;color:#ffaa00;';\n      indicator.textContent = this.state.collapsedPanels[name] ? '+' : '';\n      h3.appendChild(indicator);\n      h3.title = 'Click: Collapse/Expand  Alt+Click: Focus panel';\n      h3.addEventListener('click', (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (e.altKey) {\n          this.toggleFocusPanel(name);\n        } else {\n          this.togglePanelCollapse(name);\n        }\n      });\n    });\n    this._applyCollapseState();\n  }\n\n  // ADDED: Footer focus badge update\n  _updateFocusBadgeInFooter() {\n    if (!this.hudElement) return;\n    const footerFocus = this.hudElement.querySelector('#msd-focus-footer');\n    if (!footerFocus) return;\n    if (!this.state.focusPanel) {\n      footerFocus.innerHTML = '';\n      return;\n    }\n    footerFocus.innerHTML = `\n      <span style=\"background:#222;border:1px solid #444;padding:2px 6px;border-radius:4px;font-size:9px;\">\n        Focus: <strong style=\"color:#ffaa00;\">${this.state.focusPanel}</strong>\n        <button style=\"margin-left:6px;font-size:9px;background:#333;color:#ccc;border:1px solid #555;border-radius:3px;cursor:pointer;padding:0 4px;\"\n          onclick=\"__msdHudBus && window.__msdDebug?.hud?.manager?.toggleFocusPanel && window.__msdDebug.hud.manager.toggleFocusPanel('${this.state.focusPanel}')\">\n          Exit\n        </button>\n      </span>\n    `;\n  }\n\n  // ADDED: Quick filter apply (called on input)\n  setFilterTerm(term) {\n    this.state.filterTerm = term || '';\n    this._applyCollapseState();\n  }\n\n  createHudElement() {\n    if (this.hudElement) return;\n\n    // ENHANCED: Use configurable width and improved styling\n    this.hudElement = document.createElement('div');\n    this.hudElement.id = 'msd-debug-hud';\n    this.hudElement.style.cssText = `\n      position: fixed;\n      top: 10px;\n      right: 10px;\n      width: ${this.state.hudWidth}px;\n      max-height: 90vh;\n      background: rgba(0, 0, 0, 0.95);\n      border: 2px solid #00ffff;\n      border-radius: 8px;\n      color: #00ffff;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000000;\n      overflow-y: auto;\n      backdrop-filter: blur(10px);\n      box-shadow: 0 4px 20px rgba(0, 255, 255, 0.3);\n      cursor: move;\n      user-select: none;\n      ${this.state.resizable ? 'resize: horizontal; min-width: 300px; max-width: 600px;' : ''}\n    `;\n\n    // ADDED: Dragging functionality - only allow dragging from header\n    this.setupDragging();\n\n    // Mount to document.body for full screen access\n    document.body.appendChild(this.hudElement);\n    this.updateHudContent();\n\n    this._attachDelegatedEvents(); // ADDED\n  }\n\n  _attachDelegatedEvents() {\n    if (this._delegatedEventsAttached || !this.hudElement) return;\n    this._delegatedEventsAttached = true;\n\n    const mapEvent = (domEvent) => {\n      this.hudElement.addEventListener(domEvent, (e) => {\n        const target = e.target.closest('[data-bus-event]');\n        if (!target || !this.hudElement.contains(target)) return;\n\n        // FIXED: For select elements, only handle 'change' events, not 'click' or 'input'\n        if (target.tagName === 'SELECT' && domEvent !== 'change') {\n          return; // Don't handle click/input events on select elements\n        }\n\n        // FIXED: For buttons, only handle 'click' events to prevent multiple firing\n        if (target.tagName === 'BUTTON' && domEvent !== 'click') {\n          return; // Don't handle other events on buttons\n        }\n\n        // FIXED: Prevent multiple event handling\n        e.preventDefault();\n        e.stopPropagation();\n\n        // Build payload from data-* excluding busEvent\n        const { busEvent, ...rest } = Object.fromEntries(\n          Object.entries(target.dataset).map(([k, v]) => [k.replace(/-[a-z]/g, m => m[1].toUpperCase()), v])\n        );\n\n        // For select elements, add the selected value\n        if (target.tagName === 'SELECT') {\n          rest.value = target.value;\n        }\n\n        // Numeric coercion for simple numbers\n        Object.keys(rest).forEach(k => {\n          if (/^-?\\d+(\\.\\d+)?$/.test(rest[k])) rest[k] = Number(rest[k]);\n        });\n\n        console.log(`[MsdHudManager] Bus event: ${target.dataset.busEvent}`, rest);\n        this.bus.emit(target.dataset.busEvent, rest);\n      }, true);\n    };\n\n    ['click', 'change', 'input', 'blur', 'focus'].forEach(mapEvent);\n    // ADDED: Direct listener for filter input (outside data-bus-event)\n    this.hudElement.addEventListener('input', (e) => {\n      const el = e.target;\n      if (el && el.id === 'msd-hud-filter') {\n        this.setFilterTerm(el.value);\n      }\n    }, true);\n  }\n\n  updateHudContent() {\n    if (!this.hudElement) return;\n\n    // Skip update if routing panel inputs are focused to prevent refresh interference\n    if (this.panels.routing?.shouldSkipRefresh?.()) {\n      return;\n    }\n\n    // FIXED: Skip update if any dropdown is currently open\n    const openDropdowns = this.hudElement.querySelectorAll('select:focus, select:focus-within');\n    if (openDropdowns.length > 0) {\n      console.log('[MsdHudManager] Skipping refresh - dropdown is open');\n      return;\n    }\n\n    // FIXED: Preserve panel manager state without logging every refresh\n    const wasManagerOpen = this.state.panelManagerOpen;\n\n    const data = {};\n\n    // Capture data from all panels\n    Object.entries(this.panels).forEach(([panelName, panel]) => {\n      try {\n        if (panel.captureData) {\n          data[panelName] = panel.captureData();\n        }\n      } catch (error) {\n        console.warn(`[MsdHudManager] Panel ${panelName} data capture failed:`, error);\n        data[panelName] = { error: error.message };\n      }\n    });\n\n    // Update timestamp\n    this.state.lastRefresh = Date.now();\n\n    // Render HTML\n    try {\n      const html = this.renderHudHtml(data);\n      this.hudElement.innerHTML = html;\n\n      // Apply compact mode class\n      if (this.state.compactMode) {\n        this.hudElement.classList.add('msd-hud-compact');\n      } else {\n        this.hudElement.classList.remove('msd-hud-compact');\n      }\n\n      this._attachPanelManagerEventListeners();\n      // ADDED: Apply selection highlight & badge after render\n      this._updateSelectionBadge();\n      this._applySelectionHighlight();\n      // REMOVED: _decoratePanelHeaders(), filter value restore, collapse/focus logic\n      // Reset filter input value after render\n      const f = this.hudElement.querySelector('#msd-hud-filter');\n      if (f && f.value !== this.state.filterTerm) f.value = this.state.filterTerm;\n\n      // Restore panel manager state after render\n      if (wasManagerOpen) {\n        this.state.panelManagerOpen = true;\n        const manager = document.getElementById('msd-panel-manager');\n        if (manager) {\n          manager.style.display = 'block';\n        }\n      }\n    } catch (error) {\n      console.error('[MsdHudManager] HUD render failed:', error);\n      this.hudElement.innerHTML = `\n        <div class=\"msd-hud-header\">\n          <span class=\"msd-hud-title\">MSD Debug HUD - Error</span>\n          <span class=\"msd-hud-close\" onclick=\"window.__msdDebug?.hud?.hide?.()\" title=\"Close\"></span>\n        </div>\n        <div style=\"padding:8px;color:#ff6666;\">\n          Render failed: ${error.message}\n        </div>\n      `;\n    }\n  }\n\n  renderHudHtml(data) {\n    const compactClass = this.state.compactMode ? 'msd-hud-compact' : '';\n\n    // ADDED: Calculate proportional font sizes based on base font size\n    const baseFontSize = this.state.fontSize;\n    const titleFontSize = Math.round(baseFontSize * 1.17); // 14px when base is 12px\n    const compactTitleFontSize = Math.round(baseFontSize * 1.0); // 12px when base is 12px\n    const sectionFontSize = Math.round(baseFontSize * 1.0); // 12px when base is 12px\n    const metricFontSize = Math.round(baseFontSize * 0.92); // 11px when base is 12px\n    const controlsFontSize = Math.round(baseFontSize * 0.83); // 10px when base is 12px\n    const smallFontSize = Math.round(baseFontSize * 0.75); // 9px when base is 12px\n    const tinyFontSize = Math.round(baseFontSize * 0.67); // 8px when base is 12px\n\n    let html = `\n      <style>\n        #msd-debug-hud .msd-hud-header {\n          padding: 8px;\n          background: rgba(0,255,255,0.2);\n          border-bottom: 1px solid #00ffff;\n          display:flex;\n          justify-content:space-between;\n          align-items:center;\n          cursor:grab;\n        }\n        #msd-debug-hud .msd-hud-title { font-weight:bold; pointer-events:none; }\n        #msd-debug-hud .msd-hud-controls { font-size:${controlsFontSize}px; display:flex; gap:4px; }\n        #msd-debug-hud .msd-hud-close, #msd-debug-hud .msd-hud-refresh, #msd-debug-hud .msd-hud-menu {\n          cursor:pointer; padding:2px 6px; border-radius:3px; pointer-events:auto;\n        }\n        #msd-debug-hud .msd-hud-close { background:rgba(255,0,0,0.7); }\n        #msd-debug-hud .msd-hud-refresh { background:rgba(0,255,0,0.7); }\n        #msd-debug-hud .msd-hud-menu { background:rgba(255,170,0,0.7); }\n        #msd-debug-hud .msd-hud-panel { padding:${this.state.compactMode ? '4px':'8px'}; border-bottom:1px solid rgba(0,255,255,0.3); }\n        #msd-debug-hud .msd-hud-panel.hidden { display:none; }\n        #msd-debug-hud .msd-hud-panel h3 {\n          margin:0 0 ${this.state.compactMode ? '4px':'8px'} 0;\n          color:#ffaa00; font-size:${this.state.compactMode ? compactTitleFontSize : titleFontSize}px;\n        }\n        #msd-debug-hud .msd-hud-section h4 { margin:6px 0 4px 0; color:#fff; font-size:${sectionFontSize}px; }\n        #msd-debug-hud .msd-hud-metric { display:flex; justify-content:space-between; margin:2px 0; font-size:${metricFontSize}px; }\n        #msd-debug-hud .msd-hud-metric-name { color:#aaa; }\n        #msd-debug-hud .msd-hud-metric-value { color:#0ff; font-weight:bold; }\n        #msd-debug-hud .msd-hud-error { border-left:3px solid #ff0000; padding-left:6px; }\n        #msd-debug-hud .msd-hud-warning { border-left:3px solid #ffaa00; padding-left:6px; }\n        #msd-debug-hud .msd-hud-success { color:#00ff00; font-size:${metricFontSize}px; text-align:center; padding:4px; }\n        #msd-debug-hud .msd-hud-summary { text-align:center; font-size:${metricFontSize}px; padding:4px; background:rgba(255,170,0,0.2); }\n        #msd-debug-hud .msd-selected { outline:2px solid #ffaa00; background:rgba(255,170,0,0.12)!important; position:relative; }\n        #msd-debug-hud .msd-selected::after { content:''; position:absolute; top:2px; right:4px; font-size:${tinyFontSize}px; color:#ffaa00; }\n        #msd-debug-hud .msd-panel-controls {\n          padding:6px 8px;\n          background:rgba(0,0,0,0.35);\n          border-bottom:1px solid rgba(0,255,255,0.25);\n          font-size:${controlsFontSize}px;\n        }\n        #msd-debug-hud .msd-panel-controls h4 {\n          margin:4px 0 6px;\n          font-size:${metricFontSize}px;\n          color:#ffaa00;\n        }\n        #msd-debug-hud .msd-panel-toggle-buttons {\n          display:flex;\n          flex-wrap:wrap;\n          gap:6px;\n          margin:4px 0 8px;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn {\n          cursor:pointer;\n          padding:3px 8px;\n          font-size:${controlsFontSize}px;\n          border:1px solid #044;\n          background:linear-gradient(#022,#011);\n          color:#0ff;\n          border-radius:14px;\n          line-height:1;\n          letter-spacing:.5px;\n          transition:all .18s;\n          position:relative;\n          pointer-events:auto;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn.active {\n          background:linear-gradient(#0ff,#066);\n          color:#000;\n          font-weight:bold;\n          box-shadow:0 0 6px #0ff;\n          border-color:#0aa;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn.inactive {\n          opacity:.45;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn:not(.active):hover {\n          opacity:.8;\n          border-color:#088;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn:focus {\n          outline:1px solid #0ff;\n        }\n        #msd-debug-hud .msd-panel-controls .msd-panel-meta {\n          font-size:${smallFontSize}px;\n          opacity:.65;\n          margin-top:2px;\n        }\n        #msd-debug-hud select, #msd-debug-hud button, #msd-debug-hud input {\n          pointer-events: auto !important;\n          cursor: pointer !important;\n        }\n        #msd-debug-hud select:hover, #msd-debug-hud button:hover {\n          opacity: 0.9;\n        }\n        /* ADDED: Scale form elements proportionally */\n        #msd-debug-hud select, #msd-debug-hud input {\n          font-size: ${smallFontSize}px !important;\n        }\n        #msd-debug-hud button {\n          font-size: ${smallFontSize}px !important;\n        }\n        /* ADDED: Scale footer text */\n        #msd-debug-hud .msd-footer {\n          font-size: ${controlsFontSize}px;\n        }\n        #msd-debug-hud .msd-footer-shortcuts {\n          font-size: ${smallFontSize}px;\n        }\n        #msd-debug-hud .msd-footer-debug {\n          font-size: ${tinyFontSize}px;\n        }\n      </style>\n    `;\n    html += `\n      <div class=\"msd-hud-header\">\n        <span class=\"msd-hud-title\">MSD v1 Debug HUD</span>\n        <div id=\"msd-selection-badge\" style=\"flex:1;display:flex;justify-content:center;\"></div>\n        <div class=\"msd-hud-controls\">\n          <span class=\"msd-hud-menu\" onclick=\"window.__msdHudPanelControls?.togglePanelManager?.()\" title=\"Panel Settings\"></span>\n          <span class=\"msd-hud-refresh\" onclick=\"window.__msdDebug?.hud?.refresh?.()\" title=\"Refresh\"></span>\n          <span class=\"msd-hud-close\" onclick=\"window.__msdDebug?.hud?.hide?.()\" title=\"Close\"></span>\n        </div>\n      </div>\n    `;\n    // REMOVED: filter bar / focus exit button\n    html += this._renderPanelControls();\n\n    // FIXED: Debug panel rendering with detailed logging\n    let renderedPanelCount = 0;\n    let visiblePanelCount = 0;\n\n    this.state.panelOrder.forEach(panelName => {\n      const panel = this.panels[panelName];\n      if (!panel) {\n        console.warn(`[MsdHudManager] Panel '${panelName}' not found in panels object`);\n        return;\n      }\n\n      const isVisible = this.state.panelVisibility[panelName];\n      const hiddenClass = isVisible ? '' : 'hidden';\n\n      if (isVisible) {\n        visiblePanelCount++;\n      }\n\n      try {\n        const panelData = data[panelName] || {};\n\n        const panelHtml = panel.renderHtml(panelData);\n\n        // Wrap panel with visibility control\n        html += `<div class=\"msd-hud-panel ${hiddenClass}\" data-panel=\"${panelName}\">\n          ${panelHtml}\n        </div>`;\n\n        renderedPanelCount++;\n      } catch (error) {\n        console.error(`[MsdHudManager] Panel ${panelName} render failed:`, error);\n        html += `<div class=\"msd-hud-panel ${hiddenClass}\" data-panel=\"${panelName}\">\n          <h3>${panelName} (Error)</h3>\n          <div class=\"msd-hud-section\">Panel render failed: ${error.message}</div>\n        </div>`;\n\n        renderedPanelCount++;\n      }\n    });\n\n    const refreshAge = Math.round((Date.now() - this.state.lastRefresh) / 1000);\n\n    // FIXED: Correct panel counting in footer with scaled font sizes\n    html += `<div class=\"msd-footer\" style=\"padding: 4px; text-align: center; color: #666; font-size: ${controlsFontSize}px;\">\n      ${visiblePanelCount}/${renderedPanelCount} panels visible  Updated ${refreshAge}s ago  ${this.state.refreshRate / 1000}s\n      <div class=\"msd-footer-shortcuts\" style=\"margin-top: 2px; opacity: 0.7; font-size: ${smallFontSize}px;\">\n        Shortcuts: Ctrl+H toggle  Ctrl+R refresh  Ctrl+P panels  Ctrl+K compact  1-9 toggle panels\n      </div>\n      <div class=\"msd-footer-debug\" style=\"margin-top: 1px; opacity: 0.5; font-size: ${tinyFontSize}px;\">\n        Panels: [${this.state.panelOrder.join(', ')}] | Available: [${Object.keys(this.panels).join(', ')}]\n      </div>\n    </div>`;\n\n    return html;\n  }\n\n  // ADDED: Missing startRefresh method\n  startRefresh() {\n    this.stopRefresh(); // Clear any existing interval\n\n    if (this.state.refreshRate > 0) {\n      this.refreshInterval = setInterval(() => {\n        if (this.state.visible) {\n          this.updateHudContent();\n        }\n      }, this.state.refreshRate);\n    }\n  }\n\n  // ADDED: Missing stopRefresh method\n  stopRefresh() {\n    if (this.refreshInterval) {\n      clearInterval(this.refreshInterval);\n      this.refreshInterval = null;\n    }\n  }\n\n  // ADDED: Missing toggle method\n  toggle() {\n    // FIXED: Harden against lost context (runtime \"this.show is not a function\")\n    if (!this || !this.state) return;\n    const isVisible = !!this.state.visible;\n    if (isVisible) {\n      if (typeof this.hide === 'function') this.hide();\n    } else {\n      if (typeof this.show === 'function') this.show();\n    }\n  }\n\n  // ADDED: Missing setRefreshRate method\n  setRefreshRate(rate) {\n    const numRate = parseInt(rate);\n    if (isNaN(numRate) || numRate < 0) return;\n\n    this.state.refreshRate = numRate;\n\n    if (this.state.visible) {\n      this.startRefresh(); // Restart with new rate\n    }\n  }\n\n  // ADDED: Dragging implementation\n  setupDragging() {\n    const startDrag = (e) => {\n      // FIXED: Be very specific about dragging - only from header title area\n      const isValidDragArea = e.target.classList.contains('msd-hud-title') ||\n                             (e.target.closest('.msd-hud-header') &&\n                              !e.target.closest('.msd-hud-controls') &&\n                              !e.target.closest('select') &&\n                              !e.target.closest('button') &&\n                              !e.target.tagName === 'SELECT' &&\n                              !e.target.tagName === 'BUTTON');\n\n      if (!isValidDragArea) {\n        return; // Only allow dragging from the title or safe header areas\n      }\n\n      e.preventDefault();\n      e.stopPropagation(); // Prevent other event handlers\n\n      this.dragState.isDragging = true;\n      this.dragState.startX = e.clientX;\n      this.dragState.startY = e.clientY;\n\n      const rect = this.hudElement.getBoundingClientRect();\n      this.dragState.startLeft = rect.left;\n      this.dragState.startTop = rect.top;\n\n      this.hudElement.style.cursor = 'grabbing';\n      document.addEventListener('mousemove', handleDrag);\n      document.addEventListener('mouseup', endDrag);\n    };\n\n    const handleDrag = (e) => {\n      if (!this.dragState.isDragging) return;\n\n      const deltaX = e.clientX - this.dragState.startX;\n      const deltaY = e.clientY - this.dragState.startY;\n\n      let newLeft = this.dragState.startLeft + deltaX;\n      let newTop = this.dragState.startTop + deltaY;\n\n      // Constrain to viewport\n      const rect = this.hudElement.getBoundingClientRect();\n      newLeft = Math.max(0, Math.min(window.innerWidth - rect.width, newLeft));\n      newTop = Math.max(0, Math.min(window.innerHeight - rect.height, newTop));\n\n      this.hudElement.style.left = newLeft + 'px';\n      this.hudElement.style.top = newTop + 'px';\n      this.hudElement.style.right = 'auto'; // Remove right positioning\n    };\n\n    const endDrag = () => {\n      this.dragState.isDragging = false;\n      this.hudElement.style.cursor = 'move';\n      document.removeEventListener('mousemove', handleDrag);\n      document.removeEventListener('mouseup', endDrag);\n    };\n\n    this.hudElement.addEventListener('mousedown', startDrag);\n  }\n\n  // ADDED: Manual refresh capability\n  refresh() {\n    if (this.state.visible && this.hudElement) {\n      this.updateHudContent();\n      console.log('[MsdHudManager] Manual refresh triggered');\n    }\n  }\n\n  // ADDED: Render panel controls interface\n  _renderPanelControls() {\n    // ADDED: Calculate proportional font sizes for panel controls\n    const baseFontSize = this.state.fontSize;\n    const smallFontSize = Math.round(baseFontSize * 0.75); // 9px when base is 12px\n\n    let html = `<div class=\"msd-panel-controls\" id=\"msd-panel-manager\" style=\"display:${this.state.panelManagerOpen ? 'block':'none'};\">\n      <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;\">\n        <strong style=\"letter-spacing:.5px;\">Panel Settings</strong>\n        <div style=\"display:flex;gap:4px;\">\n          <button data-action=\"compact\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:${this.state.compactMode ? '#ffaa00':'#222'};color:${this.state.compactMode ? '#000':'#ccc'};border:1px solid #555;border-radius:4px;cursor:pointer;\">\n            Compact\n          </button>\n          <button data-action=\"reset\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#333;color:#ccc;border:1px solid #555;border-radius:4px;cursor:pointer;\">\n            Reset\n          </button>\n          <button data-action=\"close\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#ff4444;color:#fff;border:1px solid #a00;border-radius:4px;cursor:pointer;\">\n            \n          </button>\n        </div>\n      </div>\n      <div class=\"msd-panel-toggle-buttons\">`;\n\n    this.state.panelOrder.forEach(panelName => {\n      const enabled = !!this.state.panelVisibility[panelName];\n      html += `<button\n        class=\"msd-panel-toggle-btn ${enabled ? 'active':'inactive'}\"\n        data-panel-toggle=\"${panelName}\"\n        aria-pressed=\"${enabled}\"\n        title=\"Toggle ${panelName} panel\">\n        ${panelName}\n      </button>`;\n    });\n\n    html += `</div>\n      <div style=\"display:flex;align-items:center;gap:6px;margin-top:4px;\">\n        <label style=\"font-size:${smallFontSize}px;opacity:.75;\">Refresh:</label>\n        <select id=\"msd-hud-refresh-rate\" name=\"refresh-rate\" data-bus-event=\"refresh-rate:change\"\n          style=\"font-size:${smallFontSize}px;background:#111;color:#0ff;border:1px solid #044;padding:2px 4px;border-radius:4px;\">\n          <option value=\"1000\" ${this.state.refreshRate===1000?'selected':''}>1s</option>\n          <option value=\"2000\" ${this.state.refreshRate===2000?'selected':''}>2s</option>\n          <option value=\"5000\" ${this.state.refreshRate===5000?'selected':''}>5s</option>\n          <option value=\"10000\" ${this.state.refreshRate===10000?'selected':''}>10s</option>\n        </select>\n        <div style=\"margin-left:auto;display:flex;gap:4px;\">\n          <button data-bus-event=\"width:adjust\" data-delta=\"-20\" title=\"Narrower\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\"></button>\n          <button data-bus-event=\"width:adjust\" data-delta=\"20\" title=\"Wider\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\"></button>\n        </div>\n      </div>\n\n      <div style=\"display:flex;align-items:center;gap:6px;margin-top:6px;padding-top:4px;border-top:1px solid rgba(0,255,255,0.2);\">\n        <label style=\"font-size:${smallFontSize}px;opacity:.75;\">Font Size:</label>\n        <button data-bus-event=\"font:adjust\" data-delta=\"-1\" title=\"Smaller Font\"\n          style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">A-</button>\n        <span style=\"font-size:${smallFontSize}px;color:#ffaa00;min-width:28px;text-align:center;\">${this.state.fontSize}px</span>\n        <button data-bus-event=\"font:adjust\" data-delta=\"1\" title=\"Larger Font\"\n          style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">A+</button>\n\n        <div style=\"margin-left:8px;display:flex;align-items:center;gap:4px;\">\n          <label style=\"font-size:${smallFontSize}px;opacity:.75;\">Scale:</label>\n          <button data-bus-event=\"scale:adjust\" data-delta=\"-0.1\" title=\"Scale Down\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">-</button>\n          <span style=\"font-size:${smallFontSize}px;color:#ffaa00;min-width:32px;text-align:center;\">${this.state.hudScale.toFixed(1)}x</span>\n          <button data-bus-event=\"scale:adjust\" data-delta=\"0.1\" title=\"Scale Up\"\n            style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">+</button>\n        </div>\n      </div>\n\n      <div style=\"display:flex;align-items:center;gap:6px;margin-top:4px;\">\n        <label style=\"font-size:${smallFontSize}px;opacity:.75;\">Font:</label>\n        <select id=\"msd-hud-font-family\" name=\"font-family\" data-bus-event=\"font-family:change\"\n          style=\"font-size:${smallFontSize}px;background:#111;color:#0ff;border:1px solid #044;padding:2px 4px;border-radius:4px;flex:1;\">\n          <option value=\"&quot;Antonio&quot;, monospace\" ${this.state.fontFamily==='\"Antonio\", monospace'?'selected':''}>Antonio (LCARS)</option>\n          <option value=\"monospace\" ${this.state.fontFamily==='monospace'?'selected':''}>Monospace</option>\n          <option value=\"sans-serif\" ${this.state.fontFamily==='sans-serif'?'selected':''}>Sans-serif</option>\n          <option value=\"serif\" ${this.state.fontFamily==='serif'?'selected':''}>Serif</option>\n          <option value=\"&quot;Courier New&quot;, monospace\" ${this.state.fontFamily==='\"Courier New\", monospace'?'selected':''}>Courier New</option>\n          <option value=\"&quot;Roboto Mono&quot;, monospace\" ${this.state.fontFamily==='\"Roboto Mono\", monospace'?'selected':''}>Roboto Mono</option>\n        </select>\n        <button data-bus-event=\"font:reset\" title=\"Reset Font Settings\"\n          style=\"font-size:${smallFontSize}px;padding:2px 6px;background:#333;color:#ccc;border:1px solid #555;border-radius:4px;cursor:pointer;\">Reset</button>\n      </div>      <div class=\"msd-panel-meta\">\n        Click buttons to toggle panels  Order: ${this.state.panelOrder.join(', ')}\n      </div>\n    </div>`;\n    return html;\n  }\n\n  _attachPanelManagerEventListeners() {\n    try {\n      const manager = document.getElementById('msd-panel-manager');\n      if (!manager) return;\n\n      const compactBtn = manager.querySelector('[data-action=\"compact\"]');\n      if (compactBtn) {\n        compactBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          window.__msdHudPanelControls?.setCompactMode(!this.state.compactMode);\n        };\n      }\n\n      const resetBtn = manager.querySelector('[data-action=\"reset\"]');\n      if (resetBtn) {\n        resetBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          window.__msdHudPanelControls?.resetPanelLayout();\n        };\n      }\n\n      const closeBtn = manager.querySelector('[data-action=\"close\"]');\n      if (closeBtn) {\n        closeBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          window.__msdHudPanelControls?.closePanelManager();\n        };\n      }\n\n      const toggleBtns = manager.querySelectorAll('[data-panel-toggle]');\n      toggleBtns.forEach(btn => {\n        const panelName = btn.getAttribute('data-panel-toggle');\n        if (panelName) {\n          btn.onclick = (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            window.__msdHudPanelControls?.togglePanel(panelName);\n          };\n        }\n      });\n\n      // NOTE: Refresh rate, font controls, and width controls now use the event bus system\n      // No manual event listeners needed for dropdowns and buttons with data-bus-event\n    } catch (e) {\n      console.warn('[MsdHudManager] Failed to attach panel manager event listeners:', e);\n    }\n  }\n\n  adjustWidth(delta) {\n    const newWidth = Math.max(300, Math.min(600, this.state.hudWidth + delta));\n    if (newWidth !== this.state.hudWidth) {\n      this.state.hudWidth = newWidth;\n\n      if (this.hudElement) {\n        this.hudElement.style.width = newWidth + 'px';\n      }\n\n      console.log(`[MsdHudManager] HUD width adjusted to ${newWidth}px`);\n\n      setTimeout(() => this.updateHudContent(), 100);\n    }\n  }\n\n  // ADDED: Keyboard shortcut system\n  _setupKeyboardShortcuts() {\n    if (this._keyboardSetup) return;\n    this._keyboardSetup = true;\n\n    const self = this;\n    document.addEventListener('keydown', (e) => {\n      if (!self.keyboardEnabled || !self.state.visible) return;\n\n      // Only handle shortcuts when not in input fields\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;\n\n      // Ctrl/Cmd + specific keys for HUD control\n      if (e.ctrlKey || e.metaKey) {\n        switch (e.key.toLowerCase()) {\n          case 'h':\n            e.preventDefault();\n            self.toggle();\n            break;\n\n          case 'r':\n            if (self.state.visible) {\n              e.preventDefault();\n              self.refresh();\n            }\n            break;\n\n          case 'p':\n            if (self.state.visible) {\n              e.preventDefault();\n              window.__msdHudPanelControls?.togglePanelManager?.();\n            }\n            break;\n\n          case 'k':\n            if (self.state.visible) {\n              e.preventDefault();\n              self.state.compactMode = !self.state.compactMode;\n              self.updateHudContent();\n            }\n            break;\n        }\n      }\n\n      // Number keys to toggle panels (1-9)\n      if (self.state.visible && !e.ctrlKey && !e.metaKey) {\n        const num = parseInt(e.key);\n        if (num >= 1 && num <= 9) {\n          const panelName = self.state.panelOrder[num - 1];\n          if (panelName) {\n            e.preventDefault();\n            window.__msdHudPanelControls?.togglePanel(panelName);\n          }\n        }\n      }\n    });\n\n    // Global shortcut to show HUD (Ctrl+Shift+H)\n    document.addEventListener('keydown', (e) => {\n      if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'h') {\n        e.preventDefault();\n        self.toggle();\n      }\n    });\n  }\n\n  // ADDED: Previously removed show() method (needed before binding in constructor)\n  show() {\n    if (this.state.visible) return;\n    this.state.visible = true;\n    this.createHudElement();\n    this.startRefresh();\n    this._setupResizeHandler();\n\n    // ADDED: Apply font and scale settings after creating HUD element\n    this._applyFontAndScale();\n\n    if (window.__msdDebug) {\n      window.__msdDebug.hud = {\n        manager: this,\n        refresh: () => this.refresh(),\n        hide: () => this.hide(),\n        show: () => this.show(),\n        toggle: () => this.toggle(),\n        setRefreshRate: (rate) => this.setRefreshRate(rate),\n        bus: this.bus\n      };\n    }\n    if (this.state.autoPosition) {\n      setTimeout(() => this._autoPositionHud(), 100);\n    }\n    console.log('[MsdHudManager] HUD activated and exposed globally');\n  }\n\n  // ADDED: Previously removed hide() method\n  hide() {\n    if (!this.state.visible) return;\n    this.state.visible = false;\n    this.stopRefresh();\n    if (this.hudElement) {\n      this.hudElement.remove();\n      this.hudElement = null;\n    }\n    console.log('[MsdHudManager] HUD deactivated');\n  }\n}\n","/**\n * RollingBuffer - Efficient circular buffer for time-series data\n *\n * Features:\n * - Fixed capacity with automatic overflow handling\n * - Time-based slicing for windowed data access\n * - Optimized for sparkline/ribbon real-time updates\n * - Memory efficient - no array reallocations during normal operation\n */\nexport class RollingBuffer {\n  constructor(capacity = 100) {\n    if (capacity < 1) {\n      throw new Error('RollingBuffer capacity must be at least 1');\n    }\n\n    // Cap capacity at reasonable maximum for memory efficiency\n    this.capacity = Math.min(capacity, 1000);\n\n    // Pre-allocate arrays for performance\n    this._timestamps = new Array(capacity);\n    this._values = new Array(capacity);\n\n    // Circular buffer state\n    this._head = 0;      // Next write position\n    this._size = 0;      // Current number of items\n    this._full = false;  // Whether we've wrapped around\n\n    // Performance tracking\n    this._stats = {\n      pushes: 0,\n      overwrites: 0,\n      queries: 0\n    };\n\n    // Add coalescing state\n    this._lastPushTime = 0;\n    this._coalescingThresholdMs = 10; // Coalesce pushes within 10ms\n  }\n\n  /**\n   * Add a new data point (timestamp, value)\n   * Automatically handles capacity overflow by replacing oldest data\n   */\n  push(timestamp, value) {\n    // Enhanced timestamp validation\n    const now = Date.now();\n    const oneYearAgo = now - (365 * 24 * 60 * 60 * 1000);\n    const oneHourFromNow = now + (60 * 60 * 1000);\n\n    // Check for reasonable timestamp range\n    if (timestamp < oneYearAgo || timestamp > oneHourFromNow) {\n      console.warn(`[RollingBuffer] Suspicious timestamp: ${timestamp} (${new Date(timestamp).toISOString()}), current: ${now} (${new Date(now).toISOString()})`);\n      // Don't reject, but log for debugging\n    }\n\n    // Validate inputs\n    if (!Number.isFinite(timestamp) || timestamp < 0) {\n      console.warn('[RollingBuffer] Invalid timestamp:', timestamp);\n      return;\n    }\n\n    if (typeof value !== 'number' || !isFinite(value)) {\n      console.warn(`[RollingBuffer] Invalid value: ${value} for timestamp ${timestamp}`);\n      return;\n    }\n\n    // AGGRESSIVE COALESCING: Skip if very recent push with similar timestamp\n    if (this._size > 0 && (now - this._lastPushTime) < this._coalescingThresholdMs) {\n      // Check if timestamp is very close to last timestamp\n      const lastIndex = this._head === 0 ? this.capacity - 1 : this._head - 1;\n      const lastTimestamp = this._timestamps[lastIndex];\n\n      if (Math.abs(timestamp - lastTimestamp) < 1000) { // Within 1 second\n        // COALESCE: Just update the value, don't add new point\n        this._values[lastIndex] = value;\n        this._stats.overwrites++; // Count as coalescence\n        this._lastPushTime = now;\n        return;\n      }\n    }\n\n    // Store at current head position\n    this._timestamps[this._head] = timestamp;\n    this._values[this._head] = value;\n\n    // Update statistics\n    this._stats.pushes++;\n    if (this._full) {\n      this._stats.overwrites++;\n    }\n\n    // Advance head pointer (circular)\n    this._head = (this._head + 1) % this.capacity;\n\n    // Update size tracking\n    if (this._size < this.capacity) {\n      this._size++;\n    } else {\n      this._full = true;\n    }\n\n    this._lastPushTime = now;\n\n    console.log(`[RollingBuffer] Added point: ${value} at ${new Date(timestamp).toISOString()} (buffer size: ${this._size})`);\n  }\n\n  /**\n   * Get data as parallel arrays { t: timestamps[], v: values[] }\n   * Returns data in chronological order (oldest first)\n   */\n  getArrays() {\n    this._stats.queries++;\n\n    if (this._size === 0) {\n      return { t: [], v: [] };\n    }\n\n    const t = new Array(this._size);\n    const v = new Array(this._size);\n\n    // Calculate start position (oldest data)\n    const startPos = this._full ? this._head : 0;\n\n    // Copy data in chronological order\n    for (let i = 0; i < this._size; i++) {\n      const bufferIndex = (startPos + i) % this.capacity;\n      t[i] = this._timestamps[bufferIndex];\n      v[i] = this._values[bufferIndex];\n    }\n\n    return { t, v };\n  }\n\n  /**\n   * Get all data points in chronological order\n   * @returns {Array} Array of {t: timestamp, v: value} objects\n   */\n  getAll() {\n    this._stats.queries++;\n\n    if (this._size === 0) {\n      return [];\n    }\n\n    const result = new Array(this._size);\n\n    // Calculate start position (oldest data)\n    const startPos = this._full ? this._head : 0;\n\n    // Copy data in chronological order\n    for (let i = 0; i < this._size; i++) {\n      const bufferIndex = (startPos + i) % this.capacity;\n      result[i] = {\n        t: this._timestamps[bufferIndex],\n        v: this._values[bufferIndex]\n      };\n    }\n\n    return result;\n  }\n\n  /**\n   * Get data points newer than specified time window (in milliseconds)\n   * @param {number} msWindow - Time window in milliseconds from now\n   * @returns {object} { t: timestamps[], v: values[] }\n   */\n  sliceSince(msWindow) {\n    this._stats.queries++;\n\n    if (this._size === 0 || !Number.isFinite(msWindow) || msWindow <= 0) {\n      return { t: [], v: [] };\n    }\n\n    const cutoffTime = Date.now() - msWindow;\n    const { t, v } = this.getArrays();\n\n    // Find first index where timestamp >= cutoffTime\n    let startIndex = 0;\n    for (let i = 0; i < t.length; i++) {\n      if (t[i] >= cutoffTime) {\n        startIndex = i;\n        break;\n      }\n    }\n\n    // Return slice from startIndex to end\n    return {\n      t: t.slice(startIndex),\n      v: v.slice(startIndex)\n    };\n  }\n\n  /**\n   * Get the most recent data point\n   * @returns {object|null} { t: timestamp, v: value } or null if empty\n   */\n  last() {\n    if (this._size === 0) {\n      return null;\n    }\n\n    // Most recent item is just before current head position\n    const lastIndex = this._head === 0 ? this.capacity - 1 : this._head - 1;\n\n    return {\n      t: this._timestamps[lastIndex],\n      v: this._values[lastIndex]\n    };\n  }\n\n  /**\n   * Get the oldest data point\n   * @returns {object|null} { t: timestamp, v: value } or null if empty\n   */\n  first() {\n    if (this._size === 0) {\n      return null;\n    }\n\n    const firstIndex = this._full ? this._head : 0;\n\n    return {\n      t: this._timestamps[firstIndex],\n      v: this._values[firstIndex]\n    };\n  }\n\n  /**\n   * Clear all data while preserving capacity\n   */\n  clear() {\n    this._head = 0;\n    this._size = 0;\n    this._full = false;\n\n    // Performance: don't actually clear arrays, just reset pointers\n    // Data will be naturally overwritten as new data comes in\n  }\n\n  /**\n   * Get current buffer statistics\n   */\n  getStats() {\n    return {\n      capacity: this.capacity,\n      size: this._size,\n      utilization: this._size / this.capacity,\n      pushes: this._stats.pushes,\n      overwrites: this._stats.overwrites,\n      queries: this._stats.queries,\n      overwriteRate: this._stats.pushes > 0 ? this._stats.overwrites / this._stats.pushes : 0\n    };\n  }\n\n  /**\n   * Check if buffer is at full capacity\n   */\n  isFull() {\n    return this._full;\n  }\n\n  /**\n   * Get number of items currently stored\n   */\n  size() {\n    return this._size;\n  }\n\n  /**\n   * Debug method: validate internal consistency\n   * @returns {boolean} true if consistent\n   */\n  _validateConsistency() {\n    const issues = [];\n\n    // Check size bounds\n    if (this._size < 0 || this._size > this.capacity) {\n      issues.push(`Invalid size: ${this._size} (capacity: ${this.capacity})`);\n    }\n\n    // Check head bounds\n    if (this._head < 0 || this._head >= this.capacity) {\n      issues.push(`Invalid head: ${this._head} (capacity: ${this.capacity})`);\n    }\n\n    // Check full flag consistency\n    if (this._full && this._size !== this.capacity) {\n      issues.push(`Full flag inconsistent: full=${this._full}, size=${this._size}, capacity=${this.capacity}`);\n    }\n\n    // Check timestamp ordering (within stored data)\n    if (this._size > 1) {\n      const { t } = this.getArrays();\n      for (let i = 1; i < t.length; i++) {\n        if (t[i] < t[i-1]) {\n          issues.push(`Timestamp ordering violation at index ${i}: ${t[i-1]} -> ${t[i]}`);\n          break; // Only report first violation\n        }\n      }\n    }\n\n    if (issues.length > 0) {\n      console.warn('[RollingBuffer] Consistency issues:', issues);\n      return false;\n    }\n\n    return true;\n  }\n}\n","/**\n * TransformationProcessor - Base class for data transformations\n *\n * Features:\n * - Chainable transformations with configurable keys\n * - Type-safe transformation pipeline\n * - Error handling and fallback values\n * - Performance tracking\n */\n\nexport class TransformationProcessor {\n  constructor(config) {\n    this.config = { ...config };\n    this.key = config.key || this.constructor.name.toLowerCase();\n    this.enabled = config.enabled !== false;\n\n    // Performance tracking\n    this._stats = {\n      transformations: 0,\n      errors: 0,\n      totalTime: 0\n    };\n  }\n\n  /**\n   * Transform a value with timing and error handling\n   * @param {number} value - Input value\n   * @param {number} timestamp - Current timestamp\n   * @param {RollingBuffer} buffer - Historical data buffer\n   * @returns {number|null} Transformed value or null on error\n   */\n  transform(value, timestamp, buffer) {\n    if (!this.enabled) return value;\n\n    const startTime = performance.now();\n\n    try {\n      const result = this._doTransform(value, timestamp, buffer);\n\n      this._stats.transformations++;\n      this._stats.totalTime += performance.now() - startTime;\n\n      return result;\n    } catch (error) {\n      this._stats.errors++;\n      console.warn(`[${this.constructor.name}] Transform failed:`, error);\n      return this._getFallbackValue(value);\n    }\n  }\n\n  /**\n   * Override this method in subclasses to implement transformation logic\n   * @protected\n   * @param {number} value - Input value\n   * @param {number} timestamp - Current timestamp\n   * @param {RollingBuffer} buffer - Historical data buffer\n   * @returns {number} Transformed value\n   */\n  _doTransform(value, timestamp, buffer) {\n    throw new Error('_doTransform must be implemented by subclasses');\n  }\n\n  /**\n   * Get fallback value on transformation error\n   * @protected\n   * @param {number} originalValue - Original input value\n   * @returns {number|null} Fallback value\n   */\n  _getFallbackValue(originalValue) {\n    return originalValue; // Default: return original value\n  }\n\n  /**\n   * Get transformation statistics\n   * @returns {Object} Statistics object\n   */\n  getStats() {\n    return {\n      ...this._stats,\n      key: this.key,\n      enabled: this.enabled,\n      avgTime: this._stats.transformations > 0 ?\n        this._stats.totalTime / this._stats.transformations : 0\n    };\n  }\n\n  /**\n   * Reset statistics\n   */\n  resetStats() {\n    this._stats = {\n      transformations: 0,\n      errors: 0,\n      totalTime: 0\n    };\n  }\n}\n\n/**\n * Unit Conversion Processor\n * Converts between different units using configurable factors or functions\n */\nexport class UnitConversionProcessor extends TransformationProcessor {\n  constructor(config) {\n    super(config);\n\n    // Predefined conversion factors\n    this.conversions = {\n      'f_to_c': (f) => (f - 32) * 5/9,\n      'f_to_c': (f) => (f - 32) * 5/9,\n      'c_to_f': (c) => (c * 9/5) + 32,\n      'c_to_f': (c) => (c * 9/5) + 32,\n      'w_to_kw': (w) => w / 1000,\n      'kw_to_w': (kw) => kw * 1000,\n      'kb_to_mb': (kb) => kb / 1024,\n      'mb_to_gb': (mb) => mb / 1024\n    };\n\n    this.fromUnit = config.from?.toLowerCase();\n    this.toUnit = config.to?.toLowerCase();\n    this.factor = config.factor;\n    this.offset = config.offset || 0;\n    this.customFunction = config.customFunction;\n  }  _doTransform(value, timestamp, buffer) {\n    if (!Number.isFinite(value)) return null;\n\n    // Custom function takes precedence\n    if (this.customFunction && typeof this.customFunction === 'function') {\n      return this.customFunction(value);\n    }\n\n    // Try multiple conversion key formats\n    const conversionKeys = [\n      `${this.fromUnit}_to_${this.toUnit}`,\n      `${this.fromUnit.replace(//g, '')}_to_${this.toUnit.replace(//g, '')}`,\n      `${this.fromUnit.replace(/[\\s]/g, '')}_to_${this.toUnit.replace(/[\\s]/g, '')}`\n    ];\n\n    for (const conversionKey of conversionKeys) {\n      if (this.conversions[conversionKey]) {\n        return this.conversions[conversionKey](value);\n      }\n    }\n\n    // Simple factor conversion\n    if (Number.isFinite(this.factor)) {\n      return (value * this.factor) + this.offset;\n    }\n\n    throw new Error(`No conversion method available for ${this.fromUnit} to ${this.toUnit}. Available: ${Object.keys(this.conversions).join(', ')}`);\n  }\n}\n\n/**\n * Scale/Range Processor\n * Maps input values from one range to another range\n */\nexport class ScaleProcessor extends TransformationProcessor {\n  constructor(config) {\n    super(config);\n\n    this.inputRange = config.input_range || config.inputRange || [0, 100];\n    this.outputRange = config.output_range || config.outputRange || [0, 1];\n    this.clamp = config.clamp !== false; // Default to true\n\n    if (!Array.isArray(this.inputRange) || this.inputRange.length !== 2) {\n      throw new Error('input_range must be an array of 2 numbers');\n    }\n    if (!Array.isArray(this.outputRange) || this.outputRange.length !== 2) {\n      throw new Error('output_range must be an array of 2 numbers');\n    }\n  }\n\n  _doTransform(value, timestamp, buffer) {\n    if (!Number.isFinite(value)) return null;\n\n    const [inMin, inMax] = this.inputRange;\n    const [outMin, outMax] = this.outputRange;\n\n    // Clamp input if enabled\n    let inputValue = this.clamp ?\n      Math.max(inMin, Math.min(inMax, value)) : value;\n\n    // Linear interpolation\n    const ratio = (inputValue - inMin) / (inMax - inMin);\n    return outMin + ratio * (outMax - outMin);\n  }\n}\n\n/**\n * Smoothing Processor\n * Applies various smoothing algorithms to reduce noise\n */\nexport class SmoothingProcessor extends TransformationProcessor {\n  constructor(config) {\n    super(config);\n\n    this.method = config.method || 'exponential';\n    this.alpha = config.alpha || 0.3; // For exponential smoothing\n    this.windowSize = config.window_size || config.windowSize || 5; // For moving average\n\n    // State for smoothing algorithms\n    this._lastSmoothed = null;\n    this._window = [];\n  }\n\n  _doTransform(value, timestamp, buffer) {\n    if (!Number.isFinite(value)) return null;\n\n    switch (this.method) {\n      case 'exponential':\n        return this._exponentialSmooth(value);\n\n      case 'moving_average':\n        return this._movingAverage(value);\n\n      case 'median':\n        return this._medianFilter(value);\n\n      default:\n        throw new Error(`Unknown smoothing method: ${this.method}`);\n    }\n  }\n\n  _exponentialSmooth(value) {\n    if (this._lastSmoothed === null) {\n      this._lastSmoothed = value;\n      return value;\n    }\n\n    this._lastSmoothed = this.alpha * value + (1 - this.alpha) * this._lastSmoothed;\n    return this._lastSmoothed;\n  }\n\n  _movingAverage(value) {\n    this._window.push(value);\n\n    if (this._window.length > this.windowSize) {\n      this._window.shift();\n    }\n\n    const sum = this._window.reduce((acc, val) => acc + val, 0);\n    return sum / this._window.length;\n  }\n\n  _medianFilter(value) {\n    this._window.push(value);\n\n    if (this._window.length > this.windowSize) {\n      this._window.shift();\n    }\n\n    const sorted = [...this._window].sort((a, b) => a - b);\n    const mid = Math.floor(sorted.length / 2);\n\n    return sorted.length % 2 === 0 ?\n      (sorted[mid - 1] + sorted[mid]) / 2 :\n      sorted[mid];\n  }\n}\n\n/**\n * Expression Processor\n * Evaluates JavaScript expressions with context\n */\nexport class ExpressionProcessor extends TransformationProcessor {\n  constructor(config) {\n    super(config);\n\n    this.expression = config.expression;\n    if (!this.expression) {\n      throw new Error('Expression is required for ExpressionProcessor');\n    }\n\n    // Pre-compile the expression for performance\n    try {\n      this._compiledFunction = new Function('value', 'timestamp', 'buffer', 'Math', `\n        \"use strict\";\n        return (${this.expression});\n      `);\n    } catch (error) {\n      throw new Error(`Failed to compile expression: ${error.message}`);\n    }\n  }\n\n  _doTransform(value, timestamp, buffer) {\n    if (!Number.isFinite(value)) return null;\n\n    try {\n      const result = this._compiledFunction(value, timestamp, buffer, Math);\n      return Number.isFinite(result) ? result : null;\n    } catch (error) {\n      throw new Error(`Expression evaluation failed: ${error.message}`);\n    }\n  }\n}\n\n/**\n * Create a transformation processor from configuration\n * @param {Object} config - Transformation configuration\n * @returns {TransformationProcessor} Configured processor instance\n */\nexport function createTransformationProcessor(config) {\n  if (!config || !config.type) {\n    throw new Error('Transformation config must specify a type');\n  }\n\n  switch (config.type) {\n    case 'unit_conversion':\n      return new UnitConversionProcessor(config);\n\n    case 'scale':\n      return new ScaleProcessor(config);\n\n    case 'smooth':\n      return new SmoothingProcessor(config);\n\n    case 'expression':\n      return new ExpressionProcessor(config);\n\n    default:\n      throw new Error(`Unknown transformation type: ${config.type}`);\n  }\n}","/**\n * AggregationProcessor - Base class for data aggregations\n *\n * Features:\n * - Runtime-only aggregations (no persistence)\n * - Time-windowed calculations\n * - Memory-efficient for MSD page lifecycles\n * - Configurable reset behavior\n */\n\nexport class AggregationProcessor {\n  constructor(type, config) {\n    this.type = type;\n    this.config = { ...config };\n    this.key = config.key || type;\n    this.enabled = config.enabled !== false;\n\n    // Parse time window if specified\n    this.windowMs = this._parseTimeWindow(config.window);\n    this.maxAge = this.windowMs || (24 * 60 * 60 * 1000); // Default 24h max\n\n    // Internal state\n    this._values = [];\n    this._lastUpdate = 0;\n    this._result = null;\n\n    // Performance tracking\n    this._stats = {\n      updates: 0,\n      calculations: 0,\n      resets: 0\n    };\n  }\n\n  /**\n   * Update aggregation with new value\n   * @param {number} timestamp - Current timestamp\n   * @param {number} value - New value to aggregate\n   * @param {Object} transformedData - Any transformed values from the same update\n   */\n  update(timestamp, value, transformedData = {}) {\n    if (!this.enabled || !Number.isFinite(value)) return;\n\n    // Clean old values first\n    this._cleanOldValues(timestamp);\n\n    // Add new value\n    this._values.push({ timestamp, value, transformed: transformedData });\n    this._lastUpdate = timestamp;\n    this._stats.updates++;\n\n    // Recalculate result\n    this._calculate();\n  }\n\n  /**\n   * Get current aggregation result\n   * @returns {any} Current aggregated value\n   */\n  getValue() {\n    return this._result;\n  }\n\n  /**\n   * Get aggregation statistics and metadata\n   * @returns {Object} Statistics object\n   */\n  getStats() {\n    return {\n      ...this._stats,\n      type: this.type,\n      key: this.key,\n      enabled: this.enabled,\n      valueCount: this._values.length,\n      windowMs: this.windowMs,\n      lastUpdate: this._lastUpdate,\n      currentResult: this._result\n    };\n  }\n\n  /**\n   * Reset aggregation state\n   */\n  reset() {\n    this._values = [];\n    this._result = null;\n    this._stats.resets++;\n  }\n\n  /**\n   * Clean values older than the window\n   * @private\n   * @param {number} currentTimestamp - Current timestamp\n   */\n  _cleanOldValues(currentTimestamp) {\n    if (!this.windowMs) return; // No window limit\n\n    const cutoffTime = currentTimestamp - this.windowMs;\n    const originalLength = this._values.length;\n\n    this._values = this._values.filter(item => item.timestamp >= cutoffTime);\n\n    if (this._values.length !== originalLength) {\n      this._stats.cleanedValues = (this._stats.cleanedValues || 0) +\n        (originalLength - this._values.length);\n    }\n  }\n\n  /**\n   * Parse time window string to milliseconds\n   * @private\n   * @param {string|number} window - Time window specification\n   * @returns {number|null} Window in milliseconds or null if unlimited\n   */\n  _parseTimeWindow(window) {\n    if (typeof window === 'number') return window;\n    if (typeof window !== 'string') return null;\n\n    const match = window.match(/^(\\d+(?:\\.\\d+)?)\\s*(s|sec|m|min|h|hr|d|day)s?$/i);\n    if (!match) return null;\n\n    const value = parseFloat(match[1]);\n    const unit = match[2].toLowerCase();\n\n    switch (unit) {\n      case 's':\n      case 'sec':\n        return value * 1000;\n      case 'm':\n      case 'min':\n        return value * 60 * 1000;\n      case 'h':\n      case 'hr':\n        return value * 60 * 60 * 1000;\n      case 'd':\n      case 'day':\n        return value * 24 * 60 * 60 * 1000;\n      default:\n        return null;\n    }\n  }\n\n  /**\n   * Override this method in subclasses to implement aggregation logic\n   * @protected\n   */\n  _calculate() {\n    throw new Error('_calculate must be implemented by subclasses');\n  }\n}\n\n/**\n * Moving Average Aggregation\n * Calculates average over a time window or fixed number of samples\n */\nexport class MovingAverageAggregation extends AggregationProcessor {\n  constructor(config) {\n    super('moving_average', config);\n    this.maxSamples = config.max_samples || config.maxSamples;\n  }\n\n  _calculate() {\n    if (this._values.length === 0) {\n      this._result = null;\n      return;\n    }\n\n    // Limit by sample count if specified\n    let values = this._values;\n    if (this.maxSamples && values.length > this.maxSamples) {\n      values = values.slice(-this.maxSamples);\n    }\n\n    const sum = values.reduce((acc, item) => acc + item.value, 0);\n    this._result = sum / values.length;\n    this._stats.calculations++;\n  }\n}\n\n/**\n * Min/Max Aggregation\n * Tracks minimum and maximum values\n */\nexport class MinMaxAggregation extends AggregationProcessor {\n  constructor(config) {\n    super('min_max', config);\n    this.trackMin = config.min !== false;\n    this.trackMax = config.max !== false;\n    this.trackAvg = config.avg === true;\n  }\n\n  _calculate() {\n    if (this._values.length === 0) {\n      this._result = null;\n      return;\n    }\n\n    const values = this._values.map(item => item.value);\n    const result = {};\n\n    if (this.trackMin) {\n      result.min = Math.min(...values);\n    }\n\n    if (this.trackMax) {\n      result.max = Math.max(...values);\n    }\n\n    if (this.trackAvg) {\n      const sum = values.reduce((acc, val) => acc + val, 0);\n      result.avg = sum / values.length;\n    }\n\n    result.count = values.length;\n    this._result = result;\n    this._stats.calculations++;\n  }\n}\n\n/**\n * Rate of Change Aggregation\n * Calculates rate of change between values\n */\nexport class RateOfChangeAggregation extends AggregationProcessor {\n  constructor(config) {\n    super('rate_of_change', config);\n    this.unit = config.unit || 'per_second'; // per_second, per_minute, per_hour\n    this.smoothing = config.smoothing || false;\n  }\n\n  _calculate() {\n    if (this._values.length < 2) {\n      this._result = null;\n      return;\n    }\n\n    const recent = this._values.slice(-2);\n    const [prev, curr] = recent;\n\n    const timeDiff = (curr.timestamp - prev.timestamp) / 1000; // Convert to seconds\n    if (timeDiff <= 0) {\n      this._result = 0;\n      return;\n    }\n\n    const valueDiff = curr.value - prev.value;\n    let rate = valueDiff / timeDiff;\n\n    // Convert to requested unit\n    switch (this.unit) {\n      case 'per_minute':\n        rate *= 60;\n        break;\n      case 'per_hour':\n        rate *= 3600;\n        break;\n      // per_second is default, no conversion needed\n    }\n\n    this._result = rate;\n    this._stats.calculations++;\n  }\n}\n\n/**\n * Session Statistics Aggregation\n * Tracks statistics since page load/reset\n */\nexport class SessionStatsAggregation extends AggregationProcessor {\n  constructor(config) {\n    super('session_stats', config);\n    this._firstValue = null;\n    this._sessionStart = Date.now();\n  }\n\n  _calculate() {\n    if (this._values.length === 0) {\n      this._result = null;\n      return;\n    }\n\n    const values = this._values.map(item => item.value);\n    const timestamps = this._values.map(item => item.timestamp);\n\n    if (this._firstValue === null) {\n      this._firstValue = values[0];\n    }\n\n    const result = {\n      count: values.length,\n      min: Math.min(...values),\n      max: Math.max(...values),\n      avg: values.reduce((sum, val) => sum + val, 0) / values.length,\n      first: this._firstValue,\n      last: values[values.length - 1],\n      sessionDuration: (Date.now() - this._sessionStart) / 1000, // seconds\n      dataSpan: (timestamps[timestamps.length - 1] - timestamps[0]) / 1000 // seconds\n    };\n\n    this._result = result;\n    this._stats.calculations++;\n  }\n}\n\n/**\n * Recent Trend Aggregation\n * Analyzes recent trend direction\n */\nexport class RecentTrendAggregation extends AggregationProcessor {\n  constructor(config) {\n    super('recent_trend', config);\n    this.samples = config.samples || 5;\n    this.threshold = config.threshold || 0.01; // Minimum change to consider significant\n  }\n\n  _calculate() {\n    if (this._values.length < 2) {\n      this._result = { direction: 'unknown', strength: 0 };\n      return;\n    }\n\n    // Get recent samples\n    const recentValues = this._values.slice(-this.samples);\n    if (recentValues.length < 2) {\n      this._result = { direction: 'unknown', strength: 0 };\n      return;\n    }\n\n    // Simple linear regression\n    const n = recentValues.length;\n    const sumX = recentValues.reduce((sum, _, i) => sum + i, 0);\n    const sumY = recentValues.reduce((sum, item) => sum + item.value, 0);\n    const sumXY = recentValues.reduce((sum, item, i) => sum + i * item.value, 0);\n    const sumXX = recentValues.reduce((sum, _, i) => sum + i * i, 0);\n\n    const slope = (n * sumXY - sumX * sumY) / (n * sumXX - sumX * sumX);\n\n    let direction = 'stable';\n    if (Math.abs(slope) > this.threshold) {\n      direction = slope > 0 ? 'increasing' : 'decreasing';\n    }\n\n    this._result = {\n      direction,\n      strength: Math.abs(slope),\n      slope\n    };\n\n    this._stats.calculations++;\n  }\n}\n\n/**\n * Create aggregation processor from configuration\n * @param {string} type - Aggregation type\n * @param {Object} config - Aggregation configuration\n * @returns {AggregationProcessor} Configured processor instance\n */\nexport function createAggregationProcessor(type, config) {\n  switch (type) {\n    case 'moving_average':\n      return new MovingAverageAggregation(config);\n\n    case 'min_max':\n    case 'daily_stats':\n      return new MinMaxAggregation(config);\n\n    case 'rate_of_change':\n      return new RateOfChangeAggregation(config);\n\n    case 'session_stats':\n      return new SessionStatsAggregation(config);\n\n    case 'recent_trend':\n      return new RecentTrendAggregation(config);\n\n    default:\n      throw new Error(`Unknown aggregation type: ${type}`);\n  }\n}","/**\n * MsdDataSource - Complete port of cb-lcars-data.js DataSource functionality\n *\n * Provides real-time Home Assistant entity subscriptions with:\n * - Coalescing and throttling for performance\n * - History preload capability\n * - Rolling buffer management\n * - Identical API and behavior to original implementation\n */\n\nimport { RollingBuffer } from './RollingBuffer.js';\nimport { createTransformationProcessor } from './transformations/TransformationProcessor.js';\nimport { createAggregationProcessor } from './aggregations/AggregationProcessor.js';\n\n// Node.js polyfills for test environment\nconst isNode = typeof window === 'undefined';\nconst requestAnimationFrame = isNode\n  ? (callback) => setTimeout(callback, 16) // 60fps approximation\n  : window.requestAnimationFrame;\nconst cancelAnimationFrame = isNode\n  ? (id) => clearTimeout(id)\n  : window.cancelAnimationFrame;\n\nexport class MsdDataSource {\n  constructor(cfg, hass) {\n    this.cfg = { ...cfg };\n    this.hass = hass;\n\n    // Validate essential config\n    if (!this.cfg.entity) {\n      console.warn('[MsdDataSource] No entity specified in config');\n      this.cfg.entity = '';\n    }\n\n    // PORT: Complete buffer sizing logic from original\n    let wsSec = 60; // Default window\n    if (typeof cfg.windowSeconds === 'number' && isFinite(cfg.windowSeconds)) {\n      wsSec = Math.max(1, cfg.windowSeconds);\n    } else if (typeof cfg.windowSeconds === 'string') {\n      const ms = this._parseTimeWindowMs(cfg.windowSeconds);\n      if (Number.isFinite(ms)) {\n        wsSec = Math.max(1, Math.floor(ms / 1000));\n      }\n    }\n\n    // Buffer capacity: aim for ~10 points per second for the window\n    const capacity = Math.max(60, Math.floor(wsSec * 10));\n    this.buffer = new RollingBuffer(capacity);\n\n    // PORT: Complete timing configuration from original - MADE MORE AGGRESSIVE\n    const minEmitMs = Number.isFinite(cfg.minEmitMs) ? cfg.minEmitMs\n      : Number.isFinite(cfg.sampleMs) ? cfg.sampleMs : 100;\n\n    this.minEmitMs = Math.max(10, minEmitMs);\n\n    // MORE AGGRESSIVE coalescing by default\n    this.coalesceMs = Number.isFinite(cfg.coalesceMs)\n      ? Math.max(20, cfg.coalesceMs)  // Reduced from 30 to 20\n      : Math.max(20, Math.round(this.minEmitMs * 0.4));  // Reduced from 0.6 to 0.4\n\n    this.maxDelayMs = Number.isFinite(cfg.maxDelayMs)\n      ? Math.max(this.minEmitMs, cfg.maxDelayMs)\n      : Math.max(this.minEmitMs, this.coalesceMs * 3);  // Reduced from 4 to 3\n\n    this.emitOnSameValue = cfg.emitOnSameValue !== false; // Default true\n\n    // Subscription management\n    this.subscribers = new Set();\n    this.haUnsubscribe = null;\n\n    // NEW: Transformation and aggregation processors\n    this.transformations = new Map();\n    this.aggregations = new Map();\n    this._transformationData = new Map();\n    this._aggregationData = new Map();\n\n    // PORT: Complete internal timing state from original\n    this._lastEmitTime = 0;\n    this._lastEmittedValue = null;\n    this._pendingRaf = 0;\n    this._pending = false;\n    this._pendingFirstTs = 0;\n    this._pendingCount = 0;\n\n    // Performance statistics\n    this._stats = {\n      emits: 0,\n      coalesced: 0,\n      skipsSameValue: 0,\n      received: 0,\n      invalid: 0,\n      historyLoaded: 0\n    };\n\n    // Lifecycle state\n    this._started = false;\n    this._destroyed = false;\n\n    // Initialize processors from configuration\n    this._initializeProcessors(cfg);\n  }\n\n  /**\n   * Initialize transformation and aggregation processors from configuration\n   * @private\n   * @param {Object} cfg - Data source configuration\n   */\n  _initializeProcessors(cfg) {\n    // Initialize transformations\n    if (cfg.transformations && Array.isArray(cfg.transformations)) {\n      cfg.transformations.forEach((transform, index) => {\n        try {\n          const key = transform.key || `transform_${index}`;\n          const processor = createTransformationProcessor(transform);\n          this.transformations.set(key, processor);\n          console.log(`[MsdDataSource] Initialized transformation: ${key} (${transform.type})`);\n        } catch (error) {\n          console.warn(`[MsdDataSource] Failed to create transformation ${index}:`, error);\n        }\n      });\n    }\n\n    // Initialize aggregations\n    if (cfg.aggregations && typeof cfg.aggregations === 'object') {\n      Object.entries(cfg.aggregations).forEach(([type, config]) => {\n        try {\n          const key = config.key || type;\n          const processor = createAggregationProcessor(type, config);\n          this.aggregations.set(key, processor);\n          console.log(`[MsdDataSource] Initialized aggregation: ${key} (${type})`);\n        } catch (error) {\n          console.warn(`[MsdDataSource] Failed to create aggregation ${type}:`, error);\n        }\n      });\n    }\n\n    console.log(`[MsdDataSource] Processor initialization complete: ${this.transformations.size} transformations, ${this.aggregations.size} aggregations`);\n  }\n\n  /**\n   * ENHANCED: Preload historical data with multiple fallback strategies\n   * @private\n   */\n  async _preloadHistory() {\n    if (!this.hass?.callService || !this.cfg.entity) return;\n\n    // Check if history is enabled in config\n    const historyConfig = this.cfg.history || {};\n    if (historyConfig.enabled === false) return;\n\n    const hours = Math.max(1, Math.min(168, historyConfig.hours || 6));\n    const endTime = new Date();\n    const startTime = new Date(endTime.getTime() - hours * 3600000);\n\n    console.log(`[MsdDataSource]  Preloading ${hours}h history for ${this.cfg.entity}`);\n\n    try {\n      // Strategy 1: Try Home Assistant's history service (most reliable)\n      await this._preloadWithHistoryService(startTime, endTime);\n    } catch (error) {\n      console.warn(`[MsdDataSource] History service failed for ${this.cfg.entity}, trying statistics:`, error.message);\n\n      try {\n        // Strategy 2: Fall back to enhanced statistics\n        await this._preloadWithStatistics(startTime, endTime);\n      } catch (statError) {\n        console.warn(`[MsdDataSource] Statistics failed, trying state history:`, statError.message);\n        // Strategy 3: Final fallback (existing _preloadStateHistory method)\n        await this._preloadStateHistory(startTime, endTime);\n      }\n    }\n\n    console.log(`[MsdDataSource] History preload complete: ${this._stats.historyLoaded} points loaded`);\n  }\n\n  /**\n   * NEW: Primary history loading using HA history service\n   * @private\n   * @param {Date} startTime - Start time for history query\n   * @param {Date} endTime - End time for history query\n   */\n  async _preloadWithHistoryService(startTime, endTime) {\n    const response = await this.hass.callService('history', 'get_history', {\n      entity_ids: [this.cfg.entity],\n      start_time: startTime.toISOString(),\n      end_time: endTime.toISOString()\n    });\n\n    if (response && response[0]) {\n      const states = response[0];\n      console.log(`[MsdDataSource] History service returned ${states.length} states for ${this.cfg.entity}`);\n\n      for (const state of states) {\n        const timestamp = new Date(state.last_changed || state.last_updated).getTime();\n        const rawValue = this.cfg.attribute ? state.attributes?.[this.cfg.attribute] : state.state;\n        const value = this._toNumber(rawValue);\n\n        if (value !== null) {\n          this.buffer.push(timestamp, value);\n          this._stats.historyLoaded++;\n        }\n      }\n    }\n  }\n\n  /**\n   * ENHANCED: Statistics-based history loading with finer granularity\n   * @private\n   * @param {Date} startTime - Start time for history query\n   * @param {Date} endTime - End time for history query\n   */\n  async _preloadWithStatistics(startTime, endTime) {\n    // Use 5-minute periods for more granular data\n    const response = await this.hass.callService('recorder', 'get_statistics', {\n      statistic_ids: [this.cfg.entity],\n      start_time: startTime.toISOString(),\n      end_time: endTime.toISOString(),\n      period: '5minute'  // Changed from 'hour' to '5minute'\n    });\n\n    if (response && response[0]?.statistics) {\n      const statistics = response[0].statistics;\n      console.log(`[MsdDataSource] Statistics returned ${statistics.length} points for ${this.cfg.entity}`);\n\n      for (const stat of statistics) {\n        const timestamp = new Date(stat.start).getTime();\n        const value = this._extractStatisticValue(stat);\n\n        if (value !== null) {\n          this.buffer.push(timestamp, value);\n          this._stats.historyLoaded++;\n        }\n      }\n    }\n  }\n\n  /**\n   * Start the data source with proper initialization sequence\n   * @returns {Promise} Resolves when fully initialized\n   */\n  async start() {\n    if (this._started || this._destroyed) return;\n\n    try {\n      console.log(`[MsdDataSource]  Starting initialization for ${this.cfg.entity}`);\n\n      // STEP 1: Preload historical data FIRST\n      if (this.hass?.callService) {\n        await this._preloadHistory();\n      }\n\n      // STEP 2: Initialize with current HASS state if available\n      if (this.hass.states && this.hass.states[this.cfg.entity]) {\n        const currentState = this.hass.states[this.cfg.entity];\n        console.log(`[MsdDataSource]  Loading initial state for ${this.cfg.entity}:`, currentState.state);\n\n        // ENHANCED: Capture unit_of_measurement from initial state\n        if (currentState.attributes?.unit_of_measurement) {\n          this.cfg.unit_of_measurement = currentState.attributes.unit_of_measurement;\n          console.log(`[MsdDataSource]  Captured initial unit_of_measurement for ${this.cfg.entity}: \"${this.cfg.unit_of_measurement}\"`);\n        }\n\n        // FIXED: Use current timestamp for initial state\n        const currentTimestamp = Date.now();\n        const rawValue = this.cfg.attribute ? currentState.attributes?.[this.cfg.attribute] : currentState.state;\n        const value = this._toNumber(rawValue);\n\n        if (value !== null) {\n          console.log(`[MsdDataSource] Adding current state: ${value} at ${currentTimestamp}`);\n          this.buffer.push(currentTimestamp, value);\n          this._stats.currentValue = value;\n        }\n      }\n\n      // STEP 3: Setup real-time subscriptions\n      this.haUnsubscribe = await this.hass.connection.subscribeEvents((event) => {\n        if (event.event_type === 'state_changed' &&\n            event.data?.entity_id === this.cfg.entity) {\n          console.log(`[MsdDataSource]  HA event received for ${this.cfg.entity}:`, event.data.new_state?.state);\n          this._handleStateChange(event.data);\n        }\n      }, 'state_changed');\n\n      this._started = true;\n      console.log(`[MsdDataSource]  Full initialization complete for ${this.cfg.entity} - Buffer: ${this.buffer.size()} points`);\n\n      // STEP 4: Emit initial data to any existing subscribers\n      this._emitInitialData();\n\n    } catch (error) {\n      console.error(`[MsdDataSource]  Failed to initialize ${this.cfg.entity}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * NEW: Emit initial data to subscribers after full initialization\n   * @private\n   */\n  _emitInitialData() {\n    if (this.subscribers.size > 0) {\n      const lastPoint = this.buffer.last();\n      if (lastPoint) {\n        console.log(`[MsdDataSource]  Emitting initial data for ${this.cfg.entity} to ${this.subscribers.size} subscribers`);\n        const emitData = {\n          t: lastPoint.t,\n          v: lastPoint.v,\n          buffer: this.buffer,\n          stats: { ...this._stats },\n          transformations: this._getTransformationData(), // Convert Map to Object\n          aggregations: this._getAggregationData(),       // Convert Map to Object\n          entity: this.cfg.entity,\n          unit_of_measurement: this.cfg.unit_of_measurement,\n          historyReady: this._stats.historyLoaded > 0,\n          isInitialEmission: true // NEW: Flag to indicate this is initial data\n        };\n\n        this.subscribers.forEach(callback => {\n          try {\n            callback(emitData);\n          } catch (error) {\n            console.error(`[MsdDataSource] Initial callback error for ${this.cfg.entity}:`, error);\n          }\n        });\n      } else {\n        // Even if no buffer data, emit initial structure for consistency\n        console.log(`[MsdDataSource]  Emitting initial empty data structure for ${this.cfg.entity} to ${this.subscribers.size} subscribers`);\n        const emitData = {\n          t: null,\n          v: null,\n          buffer: this.buffer,\n          stats: { ...this._stats },\n          transformations: this._getTransformationData(),\n          aggregations: this._getAggregationData(),\n          entity: this.cfg.entity,\n          unit_of_measurement: this.cfg.unit_of_measurement,\n          historyReady: this._stats.historyLoaded > 0,\n          isInitialEmission: true\n        };\n\n        this.subscribers.forEach(callback => {\n          try {\n            callback(emitData);\n          } catch (error) {\n            console.error(`[MsdDataSource] Initial callback error for ${this.cfg.entity}:`, error);\n          }\n        });\n      }\n    }\n  }\n\n  async _preloadHistory() {\n    if (!this.hass?.connection || !this.cfg.entity) {\n      console.warn('[MsdDataSource] No HASS connection or entity for history preload');\n      return;\n    }\n\n    const hours = Math.max(1, Math.min(168, this.cfg.history?.hours || 6)); // 1-168 hours\n    const endTime = new Date();\n    const startTime = new Date(endTime.getTime() - hours * 3600000);\n\n    console.log(`[MsdDataSource]  Preloading ${hours}h history for ${this.cfg.entity}`);\n\n    try {\n      // Use modern WebSocket call for statistics (preferred)\n      const statisticsData = await this.hass.connection.sendMessagePromise({\n        type: 'recorder/statistics_during_period',\n        start_time: startTime.toISOString(),\n        end_time: endTime.toISOString(),\n        statistic_ids: [this.cfg.entity],\n        period: 'hour'\n      });\n\n      if (statisticsData && statisticsData[this.cfg.entity]) {\n        const statistics = statisticsData[this.cfg.entity];\n        console.log(`[MsdDataSource]  Got ${statistics.length} statistics points`);\n\n        for (const stat of statistics) {\n          const timestamp = new Date(stat.start).getTime();\n          const value = this._extractStatisticValue(stat);\n\n          if (value !== null) {\n            this.buffer.push(timestamp, value);\n            this._stats.historyLoaded++;\n          }\n        }\n\n        console.log(`[MsdDataSource]  Loaded ${this._stats.historyLoaded} statistics points`);\n        return; // Success with statistics\n      }\n    } catch (error) {\n      console.warn('[MsdDataSource] Statistics failed, trying state history:', error.message);\n    }\n\n    // Fallback: try state history via WebSocket\n    await this._preloadStateHistoryWS(startTime, endTime);\n  }\n\n  async _preloadStateHistoryWS(startTime, endTime) {\n    try {\n      console.log(`[MsdDataSource]  Trying WebSocket state history for ${this.cfg.entity}`);\n\n      // Use modern WebSocket call for history\n      const historyData = await this.hass.connection.sendMessagePromise({\n        type: 'history/history_during_period',\n        start_time: startTime.toISOString(),\n        end_time: endTime.toISOString(),\n        entity_ids: [this.cfg.entity],\n        minimal_response: true,\n        no_attributes: true\n      });\n\n      if (historyData && historyData[0]) {\n        const states = historyData[0];\n        console.log(`[MsdDataSource]  Got ${states.length} history states`);\n\n        for (const state of states) {\n          const timestamp = new Date(state.last_changed || state.last_updated).getTime();\n          const rawValue = this.cfg.attribute ? state.attributes?.[this.cfg.attribute] : state.state;\n          const value = this._toNumber(rawValue);\n\n          if (value !== null) {\n            this.buffer.push(timestamp, value);\n            this._stats.historyLoaded++;\n          }\n        }\n\n        console.log(`[MsdDataSource]  Loaded ${this._stats.historyLoaded} history points`);\n      } else {\n        console.warn('[MsdDataSource] No history data returned from WebSocket call');\n      }\n    } catch (error) {\n      console.error('[MsdDataSource] WebSocket state history also failed:', error);\n\n      // Final fallback: try direct REST API if available\n      await this._preloadHistoryREST(startTime, endTime);\n    }\n  }\n\n  async _preloadHistoryREST(startTime, endTime) {\n    try {\n      console.log(`[MsdDataSource]  Trying REST API history for ${this.cfg.entity}`);\n\n      const startParam = startTime.toISOString();\n      const url = `/api/history/period/${startParam}?filter_entity_id=${this.cfg.entity}&minimal_response&no_attributes`;\n\n      const response = await fetch(url, {\n        headers: {\n          'Authorization': `Bearer ${this.hass.auth?.accessToken}`,\n          'Content-Type': 'application/json'\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const historyData = await response.json();\n\n      if (historyData && historyData[0]) {\n        const states = historyData[0];\n        console.log(`[MsdDataSource]  Got ${states.length} REST history states`);\n\n        for (const state of states) {\n          const timestamp = new Date(state.last_changed || state.last_updated).getTime();\n          const rawValue = this.cfg.attribute ? state.attributes?.[this.cfg.attribute] : state.state;\n          const value = this._toNumber(rawValue);\n\n          if (value !== null) {\n            this.buffer.push(timestamp, value);\n            this._stats.historyLoaded++;\n          }\n        }\n\n        console.log(`[MsdDataSource]  Loaded ${this._stats.historyLoaded} REST history points`);\n      }\n    } catch (error) {\n      console.error('[MsdDataSource] REST history fallback also failed:', error);\n    }\n  }\n\n  /**\n   * Handle state change from Home Assistant\n   * @private\n   * @param {Object} eventData - State change event data\n   */\n  _handleStateChange(eventData) {\n\n    console.log('[MSD DEBUG]  MsdDataSource._handleStateChange() ENTRY:', {\n      entity: this.cfg.entity,\n      timestamp: new Date().toISOString(),\n      hasEventData: !!eventData,\n      hasNewState: !!eventData?.new_state,\n      newStateValue: eventData?.new_state?.state,\n      subscriberCount: this.subscribers.size,\n      stackTrace: new Error().stack.split('\\n').slice(1, 3).join('\\n')\n    });\n\n    if (!eventData?.new_state || this._destroyed) {\n      console.log('[MSD DEBUG]  Skipping state change - no new state or destroyed');\n      return;\n    }\n\n    // CRITICAL: Store the original state object before any conversion\n    this._lastOriginalState = eventData.new_state;\n\n    // ENHANCED: Capture and store unit_of_measurement from the entity\n    if (eventData.new_state.attributes?.unit_of_measurement) {\n      this.cfg.unit_of_measurement = eventData.new_state.attributes.unit_of_measurement;\n      console.log(`[MSD DEBUG]  Captured unit_of_measurement for ${this.cfg.entity}: \"${this.cfg.unit_of_measurement}\"`);\n    }\n\n    // FIXED: Use current timestamp instead of state timestamp\n    const timestamp = Date.now();\n    const rawValue = this.cfg.attribute\n      ? eventData.new_state.attributes?.[this.cfg.attribute]\n      : eventData.new_state.state;\n\n    const value = this._toNumber(rawValue);\n\n    if (value !== null) {\n      console.log(`[MSD DEBUG]  Processing state change for ${this.cfg.entity}:`, {\n        value,\n        timestamp,\n        subscriberCount: this.subscribers.size,\n        originalState: this._lastOriginalState.state,\n        unit_of_measurement: this.cfg.unit_of_measurement\n      });\n\n      // Add to buffer with proper timestamp\n      this.buffer.push(timestamp, value);\n      this._stats.updates++;\n      this._stats.currentValue = value;\n\n      // NEW: Apply transformations\n      const transformedData = this._applyTransformations(timestamp, value);\n\n      // NEW: Update aggregations\n      this._updateAggregations(timestamp, value, transformedData);\n\n      // Emit to subscribers\n      console.log(`[MSD DEBUG]  Emitting to ${this.subscribers.size} subscribers:`, value);\n\n      const emitData = {\n        t: timestamp,\n        v: value,\n        buffer: this.buffer,\n        stats: { ...this._stats },\n        transformations: this._getTransformationData(), // NEW\n        aggregations: this._getAggregationData(),       // NEW\n        entity: this.cfg.entity,\n        unit_of_measurement: this.cfg.unit_of_measurement, // NEW: Include unit info\n        historyReady: this._stats.historyLoaded > 0\n      };\n\n      this.subscribers.forEach((callback, index) => {\n        try {\n          console.log(`[MSD DEBUG]  Calling subscriber ${index} for ${this.cfg.entity}`);\n          callback(emitData);\n          console.log(`[MSD DEBUG]  Subscriber ${index} completed successfully`);\n        } catch (error) {\n          console.error(`[MSD DEBUG]  Subscriber ${index} callback FAILED for ${this.cfg.entity}:`, error);\n          console.error(`[MSD DEBUG]  Subscriber error stack:`, error.stack);\n        }\n      });\n    } else {\n      console.log(`[MSD DEBUG]  Skipping state change - invalid value:`, { rawValue, entity: this.cfg.entity });\n    }\n  }\n\n  /**\n   * Check if we should emit data to subscribers based on timing and value rules\n   */\n  _shouldEmit(value, timestamp) {\n    const now = Date.now();\n\n    // Respect minimum emit interval\n    if (this._lastEmitTime && (timestamp - this._lastEmitTime) < this.minEmitMs) {\n      this._stats.coalesced++;\n      return false;\n    }\n\n    // Skip if value hasn't changed (if configured)\n    if (!this.emitOnSameValue && value === this._lastEmittedValue) {\n      this._stats.skipsSameValue++;\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Emit data to all subscribers\n   */\n  _emit(data) {\n    const now = Date.now();\n    this._lastEmitTime = now;\n    this._lastEmittedValue = data.v;\n    this._stats.emits++;\n\n    console.log(`[MsdDataSource]  Emitting to ${this.subscribers.size} subscribers:`, data.v);\n\n    // Call all subscribers\n    this.subscribers.forEach(callback => {\n      try {\n        callback(data);\n      } catch (error) {\n        console.warn(`[MsdDataSource] Subscriber callback error:`, error);\n      }\n    });\n  }\n\n  async _subscribeLive() {\n    if (!this.hass?.connection?.subscribeEvents || !this.cfg.entity) return;\n\n    const entityId = this.cfg.entity;\n\n    try {\n      this.haUnsubscribe = await this.hass.connection.subscribeEvents((event) => {\n        const newState = event?.data?.new_state;\n        if (!newState || newState.entity_id !== entityId) return;\n\n        const timestamp = new Date(newState.last_changed || newState.last_updated || Date.now()).getTime();\n        const rawValue = this.cfg.attribute ? newState.attributes?.[this.cfg.attribute] : newState.state;\n        const value = this._toNumber(rawValue);\n\n        this._onRawEventValue(timestamp, value);\n      }, 'state_changed');\n\n    } catch (error) {\n      console.warn('[MsdDataSource] Failed to subscribe to HA events:', error.message);\n    }\n  }\n\n  _onRawEventValue(timestamp, value) {\n    if (value === null) {\n      this._stats.invalid++;\n      return;\n    }\n\n    // ENHANCED: Check for rapid-fire identical values and skip some\n    const now = isNode ? Date.now() : performance.now();\n\n    // Store in buffer - buffer now handles its own coalescing\n    this.buffer.push(timestamp, value);\n    this._stats.received++;\n\n    // FIXED: More aggressive coalescing logic for stress scenarios\n    if (!this._pending) {\n      this._pending = true;\n      this._pendingFirstTs = now;\n      this._pendingCount = 1;\n\n      // For stress tests: delay first emission slightly to allow coalescing\n      if (this._stats.received > 10) {\n        // High-frequency scenario - be more patient\n        setTimeout(() => this._ensureScheduleEmit(), 5);\n      } else {\n        // Normal scenario - immediate response for first subscription\n        if (this.subscribers.size > 0 && this._stats.emits === 0) {\n          this._emit();\n        } else {\n          this._ensureScheduleEmit();\n        }\n      }\n    } else {\n      this._pendingCount++;\n      const timeSinceFirst = now - this._pendingFirstTs;\n\n      if (timeSinceFirst >= this.coalesceMs) {\n        // Coalescing window expired - emit and start new window\n        this._emit();\n\n        // Start fresh coalescing window\n        this._pending = true;\n        this._pendingFirstTs = now;\n        this._pendingCount = 1;\n        this._ensureScheduleEmit();\n      } else {\n        // Still within coalescing window - increment coalesced counter\n        this._stats.coalesced++;\n      }\n    }\n  }\n\n  _ensureScheduleEmit() {\n    if (this._pendingRaf) return; // Already scheduled\n\n    this._pendingRaf = requestAnimationFrame(() => {\n      this._pendingRaf = 0;\n      this._frameEmitCheck();\n    });\n  }\n\n  _frameEmitCheck() {\n    if (!this._pending || this._destroyed) return;\n\n    const now = isNode ? Date.now() : performance.now();\n    const timeSinceLastEmit = now - this._lastEmitTime;\n    const timeSincePendingStart = now - this._pendingFirstTs;\n\n    // Should we emit now?\n    let shouldEmit = false;\n\n    // Check minimum emit interval\n    if (timeSinceLastEmit >= this.minEmitMs) {\n      // Minimum time passed - check coalescing window\n      if (timeSincePendingStart >= this.coalesceMs) {\n        shouldEmit = true;\n      }\n    }\n\n    // Max delay override - always emit if we've been pending too long\n    if (timeSincePendingStart >= this.maxDelayMs) {\n      shouldEmit = true;\n    }\n\n    if (shouldEmit) {\n      this._emit();\n    } else {\n      // IMPROVED: More precise next check timing\n      const untilMinEmit = Math.max(0, this.minEmitMs - timeSinceLastEmit);\n      const untilCoalesce = Math.max(0, this.coalesceMs - timeSincePendingStart);\n      const untilMaxDelay = Math.max(0, this.maxDelayMs - timeSincePendingStart);\n\n      const nextCheck = Math.min(\n        untilMinEmit || Infinity,\n        untilCoalesce || Infinity,\n        untilMaxDelay || Infinity\n      );\n\n      if (nextCheck < Infinity && nextCheck > 0) {\n        setTimeout(() => {\n          this._ensureScheduleEmit();\n        }, Math.max(1, Math.min(50, nextCheck)));\n      }\n    }\n  }\n\n  /* OLD\n  subscribe(callback) {\n    if (typeof callback !== 'function') {\n      console.warn('[MsdDataSource] Subscribe requires a function callback');\n      return () => {};\n    }\n\n    this.subscribers.add(callback);\n\n    // Immediate hydration with current data\n    const lastPoint = this.buffer.last();\n    if (lastPoint) {\n      try {\n        callback({\n          t: lastPoint.t,\n          v: lastPoint.v,\n          buffer: this.buffer,\n          stats: this._stats\n        });\n      } catch (error) {\n        console.warn('[MsdDataSource] Initial callback error:', error);\n      }\n    }\n\n    // Return unsubscribe function\n    return () => {\n      this.subscribers.delete(callback);\n    };\n  }\n  */\n\n\n  subscribe(callback) {\n    if (typeof callback !== 'function') {\n      console.warn('[MsdDataSource] Subscribe requires a function callback');\n      return () => {};\n    }\n\n    this.subscribers.add(callback);\n\n    // Enhanced immediate hydration with current data\n    const lastPoint = this.buffer.last();\n    if (lastPoint) {\n      try {\n        const currentData = {\n          t: lastPoint.t,\n          v: lastPoint.v,\n          buffer: this.buffer,\n          stats: { ...this._stats },\n          transformations: this._getTransformationData(), // Convert Map to Object\n          aggregations: this._getAggregationData(),       // Convert Map to Object\n          entity: this.cfg.entity,\n          historyReady: this._stats.historyLoaded > 0\n        };\n\n        console.log(`[MsdDataSource] Providing immediate hydration for new subscriber:`, {\n          entity: this.cfg.entity,\n          value: lastPoint.v,\n          bufferSize: this.buffer.size(),\n          timestamp: new Date(lastPoint.t).toISOString()\n        });\n\n        // Use setTimeout to avoid blocking the subscription\n        setTimeout(() => {\n          callback(currentData);\n        }, 0);\n\n      } catch (error) {\n        console.warn('[MsdDataSource] Initial callback error:', error);\n      }\n    } else {\n      console.log(`[MsdDataSource] No data available for immediate hydration:`, {\n        entity: this.cfg.entity,\n        bufferSize: this.buffer.size(),\n        started: this._started\n      });\n    }\n\n    // Return unsubscribe function\n    return () => {\n      this.subscribers.delete(callback);\n    };\n  }\n\n  // ENHANCED: Subscribe with metadata support\n  subscribeWithMetadata(callback, metadata = {}) {\n    if (typeof callback !== 'function') {\n      console.warn('[MsdDataSource] Subscribe requires a function callback');\n      return () => {};\n    }\n\n    // Store metadata on the callback function\n    callback._subscriberMetadata = {\n      overlayId: metadata.overlayId || 'unknown',\n      overlayType: metadata.overlayType || 'unknown',\n      component: metadata.component || 'unknown',\n      subscribedAt: Date.now()\n    };\n\n    return this.subscribe(callback);\n  }\n\n\n  /**\n   * Convert raw value to number with support for boolean states\n   * @param {*} raw - Raw value from HA state\n   * @returns {number|null} Converted number or null if invalid\n   */\n  _toNumber(raw) {\n    console.log('[MSD DEBUG]  _toNumber() converting:', {\n      raw,\n      type: typeof raw,\n      entity: this.cfg.entity\n    });\n\n    if (raw === null || raw === undefined) {\n      console.log('[MSD DEBUG]  _toNumber() - null/undefined value');\n      return null;\n    }\n\n    // Handle numeric values\n    if (typeof raw === 'number') {\n      const result = isNaN(raw) ? null : raw;\n      console.log('[MSD DEBUG]  _toNumber() - numeric:', { raw, result });\n      return result;\n    }\n\n    // Handle string values\n    if (typeof raw === 'string') {\n      // Try direct numeric conversion first\n      const num = parseFloat(raw);\n      if (!isNaN(num) && isFinite(num)) {\n        console.log('[MSD DEBUG]  _toNumber() - string numeric:', { raw, num });\n        return num;\n      }\n\n      // ADDED: Handle boolean-like string states\n      const lowerRaw = raw.toLowerCase().trim();\n      if (lowerRaw === 'on' || lowerRaw === 'true' || lowerRaw === 'active' || lowerRaw === 'open') {\n        console.log('[MSD DEBUG]  _toNumber() - boolean TRUE:', { raw, converted: 1 });\n        return 1;\n      }\n\n      if (lowerRaw === 'off' || lowerRaw === 'false' || lowerRaw === 'inactive' || lowerRaw === 'closed') {\n        console.log('[MSD DEBUG]  _toNumber() - boolean FALSE:', { raw, converted: 0 });\n        return 0;\n      }\n\n      // Handle unavailable/unknown states\n      if (lowerRaw === 'unavailable' || lowerRaw === 'unknown') {\n        console.log('[MSD DEBUG]  _toNumber() - unavailable state:', { raw, converted: null });\n        return null;\n      }\n\n      console.log('[MSD DEBUG]  _toNumber() - unhandled string:', { raw });\n      return null;\n    }\n\n    // Handle boolean values\n    if (typeof raw === 'boolean') {\n      const result = raw ? 1 : 0;\n      console.log('[MSD DEBUG]  _toNumber() - boolean:', { raw, result });\n      return result;\n    }\n\n    console.log('[MSD DEBUG]  _toNumber() - unsupported type:', { raw, type: typeof raw });\n    return null;\n  }\n\n  _parseTimeWindowMs(windowStr) {\n    if (typeof windowStr !== 'string') return NaN;\n\n    const match = windowStr.match(/^(\\d+(?:\\.\\d+)?)\\s*(s|sec|m|min|h|hr|d|day)s?$/i);\n    if (!match) return NaN;\n\n    const value = parseFloat(match[1]);\n    const unit = match[2].toLowerCase();\n\n    switch (unit) {\n      case 's':\n      case 'sec':\n        return value * 1000;\n      case 'm':\n      case 'min':\n        return value * 60 * 1000;\n      case 'h':\n      case 'hr':\n        return value * 60 * 60 * 1000;\n      case 'd':\n      case 'day':\n        return value * 24 * 60 * 60 * 1000;\n      default:\n        return NaN;\n    }\n  }\n\n  // Debug and introspection methods\n  getStats() {\n    return {\n      ...this._stats,\n      config: {\n        entity: this.cfg.entity,\n        windowSeconds: this.cfg.windowSeconds,\n        minEmitMs: this.minEmitMs,\n        coalesceMs: this.coalesceMs,\n        maxDelayMs: this.maxDelayMs\n      },\n      buffer: this.buffer.getStats(),\n      subscribers: this.subscribers.size,\n      state: {\n        started: this._started,\n        pending: this._pending,\n        destroyed: this._destroyed\n      }\n    };\n  }\n\n  // ENHANCED: Basic subscriber information with overlay metadata\n  getSubscriberInfo() {\n    return Array.from(this.subscribers).map((callback, index) => {\n      // Check if callback has stored metadata\n      const metadata = callback._subscriberMetadata;\n\n      if (metadata) {\n        return {\n          id: metadata.overlayId,\n          name: `${metadata.overlayType}_${metadata.overlayId}`,\n          type: metadata.overlayType,\n          component: metadata.component,\n          subscribedAt: metadata.subscribedAt,\n          index: index\n        };\n      }\n\n      // Fallback to basic detection for callbacks without metadata\n      const name = callback.name || 'anonymous';\n      const isWrapped = callback.toString().includes('overlay') || callback.toString().includes('callback');\n\n      return {\n        id: `subscriber_${index}`,\n        name: name === 'anonymous' && isWrapped ? 'overlay_callback' : name,\n        type: 'function',\n        component: 'unknown',\n        index: index\n      };\n    });\n  }  /**\n   * Get current data with enhanced metadata\n   * @returns {Object|null} Current data object or null\n   */\n  getCurrentData() {\n    const lastPoint = this.buffer.last();\n    if (!lastPoint) {\n      // Return minimal data structure even if no data points exist\n      return {\n        t: null,\n        v: null,\n        buffer: this.buffer,\n        stats: { ...this._stats },\n        transformations: this._getTransformationData(), // Convert Map to Object\n        aggregations: this._getAggregationData(),       // Convert Map to Object\n        entity: this.cfg.entity,\n        unit_of_measurement: this.cfg.unit_of_measurement, // NEW: Include unit info\n        historyReady: this._stats.historyLoaded > 0,\n        bufferSize: 0,\n        started: this._started\n      };\n    }\n\n    return {\n      t: lastPoint.t,\n      v: lastPoint.v,\n      buffer: this.buffer,\n      stats: { ...this._stats },\n      transformations: this._getTransformationData(), // Convert Map to Object\n      aggregations: this._getAggregationData(),       // Convert Map to Object\n      entity: this.cfg.entity,\n      unit_of_measurement: this.cfg.unit_of_measurement, // NEW: Include unit info\n      historyReady: this._stats.historyLoaded > 0,\n      bufferSize: this.buffer.size(),\n      started: this._started\n    };\n  }\n\n  // NEW: Add EntityRuntime-compatible method\n  getEntity() {\n    return this.currentState ? {\n      state: this.currentState.state,\n      attributes: this.currentState.attributes || {}\n    } : null;\n  }\n\n  /**\n   * Stop the data source and release resources\n   */\n  async stop() {\n    this._started = false;\n\n    if (this.haUnsubscribe) {\n      try {\n        this.haUnsubscribe();\n      } catch (error) {\n        console.warn('[MsdDataSource] HA unsubscribe error:', error);\n      }\n      this.haUnsubscribe = null;\n    }\n\n    if (this._pendingRaf) {\n      cancelAnimationFrame(this._pendingRaf);\n      this._pendingRaf = 0;\n    }\n\n    this._pending = false;\n  }\n\n  destroy() {\n    this._destroyed = true;\n    this.stop();\n    this.subscribers.clear();\n    this.buffer.clear();\n  }\n\n  _extractStatisticValue(stat) {\n    // Priority order for statistic values\n    if (Number.isFinite(stat.mean)) return stat.mean;\n    if (Number.isFinite(stat.state)) return stat.state;\n    if (Number.isFinite(stat.sum)) return stat.sum;\n    if (Number.isFinite(stat.max)) return stat.max;\n    if (Number.isFinite(stat.min)) return stat.min;\n    return null;\n  }\n\n  /**\n   * Apply all configured transformations to a value\n   * @private\n   * @param {number} timestamp - Current timestamp\n   * @param {number} value - Raw value to transform\n   * @returns {Object} Map of transformation keys to results\n   */\n  _applyTransformations(timestamp, value) {\n    const results = { original: value };\n\n    this.transformations.forEach((processor, key) => {\n      try {\n        results[key] = processor.transform(value, timestamp, this.buffer);\n        this._transformationData.set(key, results[key]);\n      } catch (error) {\n        console.warn(`[MsdDataSource] Transformation ${key} failed:`, error);\n        results[key] = null;\n        this._transformationData.set(key, null);\n      }\n    });\n\n    return results;\n  }\n\n  /**\n   * Update all configured aggregations with new data\n   * @private\n   * @param {number} timestamp - Current timestamp\n   * @param {number} value - Raw value\n   * @param {Object} transformedData - Transformed values from this update\n   */\n  _updateAggregations(timestamp, value, transformedData) {\n    this.aggregations.forEach((processor, key) => {\n      try {\n        processor.update(timestamp, value, transformedData);\n        this._aggregationData.set(key, processor.getValue());\n      } catch (error) {\n        console.warn(`[MsdDataSource] Aggregation ${key} failed:`, error);\n        this._aggregationData.set(key, null);\n      }\n    });\n  }\n\n  /**\n   * Get current transformation data for emission\n   * @private\n   * @returns {Object} Current transformation results\n   */\n  _getTransformationData() {\n    const data = {};\n    this._transformationData.forEach((value, key) => {\n      data[key] = value;\n    });\n    return data;\n  }\n\n  /**\n   * Get current aggregation data for emission\n   * @private\n   * @returns {Object} Current aggregation results\n   */\n  _getAggregationData() {\n    const data = {};\n    this._aggregationData.forEach((value, key) => {\n      data[key] = value;\n    });\n    return data;\n  }\n}\n","/**\n * DataSourceManager - Manages multiple data sources and overlay subscriptions\n *\n * Features:\n * - Multi-source lifecycle management\n * - Overlay subscription system\n * - Clean shutdown and resource management\n * - Performance monitoring and statistics\n * - EntityRuntime API compatibility for rules engine\n */\n\nimport { MsdDataSource } from './MsdDataSource.js';\n\nexport class DataSourceManager {\n  constructor(hass) {\n    this.hass = hass;\n    this.sources = new Map();\n    this.overlaySubscriptions = new Map();\n\n    // NEW: Entity runtime compatibility\n    this.entityIndex = new Map(); // entityId -> dataSource\n    this.globalEntityChangeListeners = new Set();\n\n    // Performance statistics\n    this._stats = {\n      sourcesCreated: 0,\n      subscriptionsActive: 0,\n      dataUpdates: 0,\n      errors: 0\n    };\n\n    // Lifecycle state\n    this._destroyed = false;\n  }\n\n  /**\n   * Initialize data sources from configuration with history preloading\n   * @param {Object} dataSourceConfigs - Configuration for data sources\n   * @returns {Promise<number>} Number of sources created\n   */\n  async initializeFromConfig(dataSourceConfigs) {\n    if (this._destroyed) {\n      throw new Error('DataSourceManager has been destroyed');\n    }\n\n    console.log(`[DataSourceManager]  Initializing ${Object.keys(dataSourceConfigs || {}).length} data sources`);\n\n    // Create all data sources from config\n    const promises = Object.entries(dataSourceConfigs || {}).map(async ([name, config]) => {\n      try {\n        const source = await this.createDataSource(name, config);\n        this._stats.sourcesCreated++;\n        return source;\n      } catch (error) {\n        console.warn(`[DataSourceManager] Failed to create source ${name}:`, error);\n        this._stats.errors++;\n        throw error;\n      }\n    });\n\n    await Promise.all(promises);\n\n    // NEW: Wait for history preloading to complete\n    if (this.sources.size > 0) {\n      await this._waitForHistoryPreloading();\n    }\n\n    const successful = this.sources.size;\n    const failed = Object.keys(dataSourceConfigs || {}).length - successful;\n    console.log(`[DataSourceManager]  Initialization complete: ${successful} successful, ${failed} failed`);\n\n    return successful;\n  }\n\n  async createDataSource(name, config) {\n    if (this.sources.has(name)) {\n      return this.sources.get(name);\n    }\n\n    const source = new MsdDataSource(config, this.hass);\n    this.sources.set(name, source);\n\n    // NEW: Index by entity for global lookups\n    if (config.entity) {\n      this.entityIndex.set(config.entity, source);\n\n      // Forward entity changes to global listeners\n      source.subscribe((data) => {\n        this._notifyGlobalEntityChangeListeners([config.entity]);\n      });\n    }\n\n    try {\n      await source.start();\n\n      // NEW: Preload initial state from HASS if available\n      if (config.entity && this.hass.states && this.hass.states[config.entity]) {\n        const hassState = this.hass.states[config.entity];\n\n        // Simulate initial state change to populate the data source\n        source._handleStateChange({\n          entity_id: config.entity,\n          new_state: hassState,\n          old_state: null\n        });\n      }\n\n    } catch (error) {\n      console.warn(`[DataSourceManager] Failed to start source ${name}:`, error);\n      this.sources.delete(name);\n      this.entityIndex.delete(config.entity);\n      this._stats.errors++;\n      throw error;\n    }\n\n    return source;\n  }\n\n  /**\n   * NEW: Wait for all sources to complete their history loading\n   * @private\n   * @param {number} maxWaitMs - Maximum wait time in milliseconds\n   */\n  async _waitForHistoryPreloading(maxWaitMs = 10000) {\n    const startTime = Date.now();\n    const checkInterval = 100;\n\n    console.log(`[DataSourceManager]  Waiting for history preloading...`);\n\n    while (Date.now() - startTime < maxWaitMs) {\n      let allReady = true;\n      let totalSources = 0;\n      let readySources = 0;\n\n      for (const [name, source] of this.sources) {\n        totalSources++;\n        const stats = source.getStats();\n        if (stats.historyLoaded > 0 || !source.cfg.history?.enabled) {\n          readySources++;\n        } else {\n          allReady = false;\n        }\n      }\n\n      if (readySources > 0) {\n        console.log(`[DataSourceManager] History loading progress: ${readySources}/${totalSources} sources ready`);\n      }\n\n      if (allReady || totalSources === 0) {\n        console.log(`[DataSourceManager]  History preloading complete in ${Date.now() - startTime}ms`);\n        break;\n      }\n\n      await new Promise(resolve => setTimeout(resolve, checkInterval));\n    }\n  }\n\n  // NEW: EntityRuntime compatibility methods\n  getEntity(entityId) {\n    // NEW: Support dot notation for datasource aggregations/transformations\n    if (entityId.includes('.')) {\n      const [sourceId, ...pathParts] = entityId.split('.');\n      const source = this.sources.get(sourceId);\n\n      if (source) {\n        const currentData = source.getCurrentData();\n        if (!currentData) return null;\n\n        // Handle dot notation paths\n        if (pathParts.length >= 2) {\n          const dataType = pathParts[0]; // 'aggregations' or 'transformations'\n          const dataKey = pathParts.slice(1).join('.'); // Support nested keys\n\n          if (dataType === 'transformations' && currentData.transformations) {\n            const value = currentData.transformations[dataKey];\n            if (value !== undefined && value !== null) {\n              return {\n                state: String(value), // Convert to string properly\n                attributes: {\n                  data_path: entityId,\n                  source_type: 'datasource_transformation',\n                  raw_value: value\n                }\n              };\n            }\n          } else if (dataType === 'aggregations' && currentData.aggregations) {\n            const aggData = currentData.aggregations[dataKey];\n\n            // Handle aggregation objects with multiple properties\n            if (typeof aggData === 'object' && aggData !== null) {\n              // Return the most relevant value from aggregation\n              let value = aggData.avg ?? aggData.value ?? aggData.last ?? aggData.current;\n              if (value !== undefined && value !== null) {\n                return {\n                  state: String(value),\n                  attributes: {\n                    data_path: entityId,\n                    source_type: 'datasource_aggregation',\n                    raw_value: value,\n                    aggregation_data: aggData\n                  }\n                };\n              }\n            } else if (aggData !== undefined && aggData !== null) {\n              return {\n                state: String(aggData),\n                attributes: {\n                  data_path: entityId,\n                  source_type: 'datasource_aggregation',\n                  raw_value: aggData\n                }\n              };\n            }\n          }\n        }\n\n        // Default to current value if no specific path found\n        return {\n          state: currentData.v?.toString() || 'unavailable',\n          attributes: {\n            timestamp: currentData.t,\n            source_type: 'datasource',\n            ...currentData.stats\n          }\n        };\n      }\n    }\n\n    // Check entity index for direct entity mappings\n    const source = this.entityIndex.get(entityId);\n    if (source) {\n      const currentData = source.getCurrentData();\n      if (currentData) {\n        return {\n          state: currentData.v?.toString() || 'unavailable',\n          attributes: {\n            timestamp: currentData.t,\n            source_type: 'datasource'\n          }\n        };\n      }\n    }\n\n    // Fallback to HASS states directly\n    if (this.hass.states && this.hass.states[entityId]) {\n      const hassState = this.hass.states[entityId];\n      return {\n        state: hassState.state,\n        attributes: hassState.attributes || {}\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Resolve dot notation paths in aggregation/transformation data\n   * @private\n   * @param {Object} data - Data object to traverse\n   * @param {string} path - Dot notation path\n   * @returns {Object|null} Entity-like object or null\n   */\n  _resolveDataPath(data, path) {\n    if (!data || typeof data !== 'object') return null;\n\n    const pathParts = path.split('.');\n    let current = data;\n\n    // Skip first part if it's the category (aggregations/transformations)\n    const startIndex = (pathParts[0] === 'aggregations' || pathParts[0] === 'transformations') ? 1 : 0;\n\n    for (let i = startIndex; i < pathParts.length; i++) {\n      if (current && typeof current === 'object') {\n        current = current[pathParts[i]];\n      } else {\n        return null;\n      }\n    }\n\n    // If we found a value, wrap it in entity-like format\n    if (current !== undefined && current !== null) {\n      return {\n        state: current.toString(),\n        attributes: {\n          data_path: path,\n          source_type: 'datasource_processed'\n        }\n      };\n    }\n\n    return null;\n  }\n\n  listIds() {\n    return Array.from(this.entityIndex.keys());\n  }\n\n  // NEW: Add global entity change listener for rules engine\n  addEntityChangeListener(callback) {\n    this.globalEntityChangeListeners.add(callback);\n    return () => this.globalEntityChangeListeners.delete(callback);\n  }\n\n  _notifyGlobalEntityChangeListeners(changedEntityIds) {\n    if (this.globalEntityChangeListeners.size === 0) return;\n\n    this.globalEntityChangeListeners.forEach(callback => {\n      try {\n        callback(changedEntityIds);\n      } catch (error) {\n        console.warn('[DataSourceManager] Global entity listener error:', error);\n      }\n    });\n  }\n\n  /**\n   * Subscribe an overlay to data source updates\n   * Enhanced for sparkline real-time updates\n   * @param {Object} overlay - Overlay configuration with source property\n   * @param {Function} callback - Callback function for updates\n   */\n  subscribeOverlay(overlay, callback) {\n    if (!overlay.source) {\n      console.warn('[DataSourceManager] subscribeOverlay: No source specified for overlay', overlay.id);\n      return;\n    }\n\n    const source = this.sources.get(overlay.source);\n    if (!source) {\n      console.warn('[DataSourceManager] subscribeOverlay: Source not found:', overlay.source);\n      return;\n    }\n\n    console.log(`[DataSourceManager]  Setting up subscription for ${overlay.id} to ${overlay.source}`);\n\n    // Subscribe to the data source with enhanced data for sparklines\n    const unsubscribe = source.subscribeWithMetadata?.((data) => {\n      // Enhanced callback data for sparklines\n      const enhancedData = {\n        ...data,\n        sourceId: overlay.source,\n        overlayId: overlay.id,\n        overlayType: overlay.type,\n        // Include buffer reference for sparklines\n        buffer: overlay.type === 'sparkline' ? data.buffer : undefined,\n        // Include historical data if available\n        historicalData: overlay.type === 'sparkline' && data.buffer ?\n          data.buffer.getAll().map(point => ({ timestamp: point.t, value: point.v })) : undefined\n      };\n\n      // DEBUG: Log what we're about to send\n      console.log(`[DataSourceManager]  Calling callback for ${overlay.id}:`, {\n        hasBuffer: !!enhancedData.buffer,\n        bufferSize: enhancedData.buffer?.size?.() || 0,\n        hasHistoricalData: !!enhancedData.historicalData,\n        historicalDataLength: enhancedData.historicalData?.length || 0,\n        currentValue: enhancedData.v\n      });\n\n      // Call the callback with overlay and enhanced update data\n      callback(overlay, enhancedData);\n    }, {\n      // ADDED: Pass overlay metadata to the subscription\n      overlayId: overlay.id,\n      overlayType: overlay.type,\n      component: 'OverlayManager'\n    }) || source.subscribe((data) => {\n      // Fallback if subscribeWithMetadata not available\n      const enhancedData = {\n        ...data,\n        sourceId: overlay.source,\n        overlayId: overlay.id,\n        overlayType: overlay.type,\n        buffer: overlay.type === 'sparkline' ? data.buffer : undefined,\n        historicalData: overlay.type === 'sparkline' && data.buffer ?\n          data.buffer.getAll().map(point => ({ timestamp: point.t, value: point.v })) : undefined\n      };\n\n      callback(overlay, enhancedData);\n    });\n\n    // CRITICAL: Provide immediate callback if data already exists\n    // This fixes the timing issue where overlays subscribe after data is ready\n    const currentData = source.getCurrentData();\n    if (currentData && (currentData.buffer?.size?.() > 0 || currentData.v !== undefined)) {\n      console.log(`[DataSourceManager]  Providing immediate data for ${overlay.id}`);\n\n      const immediateData = {\n        ...currentData,\n        sourceId: overlay.source,\n        overlayId: overlay.id,\n        overlayType: overlay.type,\n        buffer: overlay.type === 'sparkline' ? currentData.buffer : undefined,\n        historicalData: overlay.type === 'sparkline' && currentData.buffer ?\n          currentData.buffer.getAll().map(point => ({ timestamp: point.t, value: point.v })) : undefined\n      };\n\n      // Use setTimeout to avoid blocking the subscription setup\n      setTimeout(() => {\n        callback(overlay, immediateData);\n      }, 0);\n    }\n\n\n\n    // Store the unsubscribe function\n    if (!this.overlaySubscriptions.has(overlay.id)) {\n      this.overlaySubscriptions.set(overlay.id, []);\n    }\n    this.overlaySubscriptions.get(overlay.id).push(unsubscribe);\n    this._stats.subscriptionsActive++;\n\n    console.log(`[DataSourceManager]  Subscribed ${overlay.type} overlay ${overlay.id} to source ${overlay.source} (${source.subscribers?.size || 0} total subscribers)`);\n\n    return unsubscribe;\n  }\n\n  unsubscribeOverlay(overlayId) {\n    const subscriptions = this.overlaySubscriptions.get(overlayId);\n    if (subscriptions) {\n      subscriptions.forEach(unsubscribe => {\n        try {\n          unsubscribe();\n        } catch (error) {\n          console.warn(`[DataSourceManager] Error unsubscribing overlay ${overlayId}:`, error);\n          this._stats.errors++;\n        }\n      });\n      this.overlaySubscriptions.delete(overlayId);\n      this._stats.subscriptionsActive--;\n    }\n  }\n\n  getSource(name) {\n    return this.sources.get(name);\n  }\n\n  getAllSources() {\n    return Array.from(this.sources.values());\n  }\n\n  /**\n   * Get a specific data source by ID\n   * @param {string} id - Data source ID\n   * @returns {MsdDataSource|null} The data source or null if not found\n   */\n  getDataSource(id) {\n    return this._dataSources.get(id) || null;\n  }\n\n  getStats() {\n    const sourceStats = {};\n    for (const [name, source] of this.sources) {\n      sourceStats[name] = source.getStats ? source.getStats() : { error: 'No stats available' };\n    }\n\n    return {\n      manager: this._stats,\n      sources: sourceStats,\n      summary: {\n        totalSources: this.sources.size,\n        activeSubscriptions: this.overlaySubscriptions.size,\n        entityCount: this.entityIndex.size,\n        destroyed: this._destroyed\n      }\n    };\n  }\n\n  // ADDED: Basic subscriber information methods\n  getSourceSubscribers(sourceName) {\n    const source = this.sources.get(sourceName);\n    return source?.getSubscriberInfo?.() || [];\n  }\n\n  getAllSubscribers() {\n    const result = {};\n    this.sources.forEach((source, name) => {\n      result[name] = source.getSubscriberInfo?.() || [];\n    });\n    return result;\n  }\n\n  async destroy() {\n    if (this._destroyed) return;\n    this._destroyed = true;\n\n    // Unsubscribe all overlays\n    for (const overlayId of this.overlaySubscriptions.keys()) {\n      this.unsubscribeOverlay(overlayId);\n    }\n\n    // Stop all data sources\n    const stopPromises = [];\n    for (const [name, source] of this.sources) {\n      try {\n        if (source.stop) {\n          stopPromises.push(source.stop());\n        } else if (source.destroy) {\n          stopPromises.push(source.destroy());\n        }\n      } catch (error) {\n        console.warn(`[DataSourceManager] Error stopping source ${name}:`, error);\n      }\n    }\n\n    await Promise.all(stopPromises);\n\n    this.sources.clear();\n    this.overlaySubscriptions.clear();\n    this.entityIndex.clear();\n    this.globalEntityChangeListeners.clear();\n  }\n\n  // Debug and introspection methods\n  debugDump() {\n    return {\n      sources: Array.from(this.sources.keys()),\n      subscriptions: Array.from(this.overlaySubscriptions.keys()),\n      entities: Array.from(this.entityIndex.keys()),\n      stats: this.getStats()\n    };\n  }\n}\n","const counters = Object.create(null);\nexport function perfInc(key, delta = 1) {\n  counters[key] = (counters[key] || 0) + delta;\n}\nexport function perfSet(key, val) {\n  counters[key] = val;\n}\nexport function perfGetAll() {\n  return { ...counters };\n}\nexport function perfTime(key, fn) {\n  const t0 = performance.now();\n  const res = fn();\n  const done = () => {\n    const dt = performance.now() - t0;\n    perfInc(key + '.samples', 1);\n    perfInc(key + '.totalMs', dt);\n    perfSet(key + '.lastMs', dt);\n  };\n  if (res && typeof res.then === 'function') {\n    return res.then(r => { done(); return r; });\n  }\n  done();\n  return res;\n}\n","import { perfInc, perfTime } from '../perf/PerfCounters.js';\n\n/**\n * M5.1 RouterCore\n * - Manhattan basic routing\n * - Caching\n * - Placeholders for obstacles & channels\n */\nexport class RouterCore {\n  constructor(routingConfig, anchors, viewBox) {\n    this.config = routingConfig || {};\n    this.anchors = anchors || {};\n    this.viewBox = viewBox;\n    this._cache = new Map(); // key -> RouteResult\n    this._cacheOrder = [];\n    this._maxCache = 256;\n    this._rev = 0; // increment to invalidate globally\n    this._overlaysRef = null;\n    this._obstacles = [];\n    this._obsVersion = 0;\n    this._gridCache = new Map(); // resolution|obsVersion -> occupancy grid\n    this._channels = this._normalizeChannels(this.config.channels || []);\n    this._channelForcePenalty = Number(this.config.channel_force_penalty || 800);\n    this._channelAvoidMultiplier = Number(this.config.channel_avoid_multiplier || 1.0);\n    // NEW (M5.4 shaping config)\n    this._channelTargetCoverage = Number(this.config.channel_target_coverage ?? 0.6);\n    this._channelShapingMaxAttempts = Number(this.config.channel_shaping_max_attempts ?? 12);\n    this._channelShapingSpan = Number(this.config.channel_shaping_span ?? 32);\n    this._channelMinCoverageGain = Number(this.config.channel_min_coverage_gain ?? 0.04);\n  }\n\n  invalidate(id='*') {\n    if (id === '*' ) {\n      this._cache.clear();\n      this._cacheOrder.length = 0;\n      this._rev++;\n    } else {\n      // Cache key includes overlay id only indirectly; brute force purge by scan.\n      for (const k of Array.from(this._cache.keys())) {\n        if (k.includes(`@${id}|`)) {\n          this._cache.delete(k);\n          const i = this._cacheOrder.indexOf(k);\n          if (i >= 0) this._cacheOrder.splice(i,1);\n        }\n      }\n    }\n    perfInc('routing.invalidate.events', 1);\n  }\n\n  setOverlays(overlays) {\n    if (!Array.isArray(overlays)) return;\n    if (overlays === this._overlaysRef) return;\n    this._overlaysRef = overlays;\n    // Rebuild obstacle list (ribbon or obstacle:true)\n    const obs = [];\n    for (const ov of overlays) {\n      if (!ov || !ov.id) continue;\n      const raw = ov._raw || ov.raw || {};\n      const isObstacle = raw.obstacle === true || ov.type === 'ribbon';\n      if (!isObstacle) continue;\n      // Determine bounds. Prefer size+position (raw.position / raw.size) else anchor if available.\n      let x = 0, y = 0, w = 0, h = 0;\n      if (Array.isArray(raw.position) && Array.isArray(raw.size)) {\n        [x,y] = raw.position;\n        [w,h] = raw.size;\n      } else if (raw.anchor && this.anchors[raw.anchor]) {\n        const [ax,ay] = this.anchors[raw.anchor];\n        x = ax - 1; y = ay - 1; w = 2; h = 2;\n      } else continue;\n      if (!Number.isFinite(x+y+w+h) || w <= 0 || h <= 0) continue;\n      obs.push({ id: ov.id, x1: x, y1: y, x2: x + w, y2: y + h });\n    }\n    this._obstacles = obs;\n    this._obsVersion++;\n    // Invalidate grids & route cache referencing old obstacles\n    this._gridCache.clear();\n    this.invalidate('*');\n    perfInc('routing.obstacles.count', obs.length);\n  }\n\n  stats() {\n    return {\n      size: this._cache.size,\n      max: this._maxCache,\n      rev: this._rev,\n      obstacles: this._obstacles.length,\n      obsVersion: this._obsVersion\n    };\n  }\n\n\n  /**\n   * Build a route request object with both entry and exit direction hints.\n   * If route_mode_last is not specified and the destination is an overlay with attach_side,\n   * auto-set route_mode_last based on attach_side (left/right  xy; top/bottom  yx).\n   * If only route_mode_last is set, use it for the last segment, first segment is auto.\n   * If neither is set, fallback to geometry-based auto.\n   * @param {object} overlay - The overlay config object\n   * @param {number[]} a1 - Start anchor [x, y]\n   * @param {number[]} a2 - End anchor [x, y]\n   * @returns {object} Route request with modeHint and modeHintLast\n   */\n  buildRouteRequest(overlay, a1, a2) {\n    const raw = overlay._raw || overlay.raw || {};\n    const fs = overlay.finalStyle || {};\n    let channelMode = (raw.route_channel_mode || raw.routeChannelMode || raw.channel_mode || 'prefer').toLowerCase();\n    if (!['prefer','avoid','force'].includes(channelMode)) {\n      perfInc && perfInc('routing.channel.mode.invalid', 1);\n      channelMode = 'prefer';\n    }\n    let smoothingMode = (\n      raw.smoothing_mode ||\n      raw.corner_smoothing_mode ||\n      fs.smoothing_mode ||\n      this.config.smoothing_mode ||\n      (this.config.smoothing && this.config.smoothing.mode) ||\n      'none'\n    ).toLowerCase();\n    const allowedSmooth = ['none','chaikin'];\n    if (!allowedSmooth.includes(smoothingMode)) {\n      try { perfInc('routing.smooth.mode.invalid', 1); } catch(_) {}\n      smoothingMode = 'none';\n    }\n\n    // Parse both first and last segment hints\n    let modeHint = (raw.route_mode || '').toLowerCase();\n    let modeHintLast = (raw.route_mode_last || '').toLowerCase();\n    let hintSourceFirst = modeHint ? 'explicit' : 'auto';\n    let hintSourceLast = modeHintLast ? 'explicit' : null;\n\n    // Improved destination overlay detection:\n    // 1. If attach_side is present we treat destination as an overlay (even if anchor not yet resolved)\n    // 2. If attach_to is not an existing anchor id we assume it is an overlay id (will be resolved later)\n    let isDestinationOverlay = false;\n    if (raw.attach_side) {\n      isDestinationOverlay = true;\n    } else if (typeof raw.attach_to === 'string' && raw.attach_to) {\n      if (!this.anchors[raw.attach_to]) {\n        isDestinationOverlay = true;\n      }\n    }\n\n    // Auto-set modeHintLast based on attach_side when not explicitly provided\n    if (!modeHintLast && isDestinationOverlay) {\n      const attachSide = (raw.attach_side || '').toLowerCase();\n      if (attachSide === 'left' || attachSide === 'right') {\n        modeHintLast = 'yx'; // final horizontal\n        hintSourceLast = 'attach_side';\n        try { perfInc('routing.hint.attach_side.horizontal',1); } catch(_){}\n      } else if (attachSide === 'top' || attachSide === 'bottom') {\n        modeHintLast = 'xy'; // final vertical\n        hintSourceLast = 'attach_side';\n        try { perfInc('routing.hint.attach_side.vertical',1); } catch(_){}\n      }\n    }\n    // Geometry-based first segment if not provided\n    if (!modeHint) {\n      const [x1, y1] = a1;\n      const [x2, y2] = a2;\n      if (Number.isFinite(x1+y1+x2+y2)) {\n        const dx = Math.abs(x2 - x1);\n        const dy = Math.abs(y2 - y1);\n        modeHint = dx >= dy ? 'xy' : 'yx';\n      } else {\n        modeHint = 'xy'; // safe fallback\n      }\n      hintSourceFirst = 'geometry';\n    }\n    if (!modeHintLast) {\n      modeHintLast = modeHint;\n      if (!hintSourceLast) hintSourceLast = hintSourceFirst;\n    }\n\n    const smoothingIterations = Number(\n      raw.smoothing_iterations ||\n      raw.corner_smoothing_iterations ||\n      fs.smoothing_iterations ||\n      this.config.smoothing_iterations ||\n      (this.config.smoothing && this.config.smoothing.iterations) ||\n      0\n    );\n    const smoothingMaxPoints = Number(\n      raw.smoothing_max_points ||\n      fs.smoothing_max_points ||\n      this.config.smoothing_max_points ||\n      (this.config.smoothing && this.config.smoothing.max_points) ||\n      160\n    );\n    return {\n      id: overlay.id,\n      a: a1,\n      b: a2,\n      modeFull: (raw.route_mode_full || raw.route_mode || 'manhattan').toLowerCase(),\n      modeHint,\n      modeHintLast,\n      _hintSourceFirst: hintSourceFirst,\n      _hintSourceLast: hintSourceLast,\n      avoidIds: Array.isArray(raw.avoid) ? raw.avoid.slice() : [],\n      channels: (raw.route_channels || raw.routeChannels || []),\n      channelMode,\n      cornerRadius: Number(raw.corner_radius || raw.cornerRadius || fs.corner_radius || 0),\n      cornerStyle: (raw.corner_style || raw.cornerStyle || fs.corner_style || 'miter').toLowerCase(),\n      smoothingMode,\n      smoothingIterations,\n      smoothingMaxPoints,\n      clearance: Number(raw.clearance || this.config.clearance || 0),\n      proximity: Number(raw.smart_proximity || this.config.smart_proximity || 0),\n      smart: {\n        detourSpan: Number(this.config.smart_detour_span || 48),\n        maxExtraBends: Number(this.config.smart_max_extra_bends || 3),\n        minImprovement: Number(this.config.smart_min_improvement || 4),\n        maxDetoursPerElbow: Number(this.config.smart_max_detours_per_elbow || 4)\n      },\n      _rev: this._rev\n    };\n  }\n\n  _cacheKey(req) {\n    const [x1,y1] = req.a;\n    const [x2,y2] = req.b;\n    const avoidKey = req.avoidIds.sort().join(',');\n    const chanKey = req.channels.sort().join(',');\n    return `${req.id}@${x1},${y1}-${x2},${y2}|${req.modeFull}|${req.modeHint}|A:${avoidKey}|C:${chanKey}|${req.channelMode}|R:${req._rev}|O:${this._obsVersion}|P:${req.proximity}|CR:${req.cornerRadius}|CS:${req.cornerStyle}|SM:${req.smoothingMode}|SI:${req.smoothingIterations}`;\n  }\n\n  computePath(req) {\n    return perfTime('routing.compute.ms', () => {\n      const key = this._cacheKey(req);\n      const cached = this._cache.get(key);\n      if (cached) {\n        perfInc('routing.cache.hit', 1);\n        return { ...cached, meta: { ...cached.meta, cache_hit: true } };\n      }\n      perfInc('routing.cache.miss', 1);\n      let result;\n      const mode = req.modeFull;\n      try {\n        if (mode === 'grid') {\n          result = this._computeGrid(req);\n        } else if (mode === 'smart') {\n          perfInc('routing.strategy.smart', 1);\n          // Phase 1: base grid\n            const gridBase = this._computeGrid(req, { smart: true });\n          if (gridBase) {\n            result = this._refineSmart(req, gridBase);\n          }\n        }\n      } catch (e) {\n        console.warn('[MSD v1] smart/grid router error; fallback to manhattan', e);\n      }\n      if (!result) {\n        if (mode === 'smart') perfInc('routing.strategy.smart', 1);\n        result = this._computeManhattan(req);\n      }\n\n      if (result && req.cornerStyle === 'round' && req.cornerRadius > 0) {\n        const arcApplied = this._applyCornerRounding(result, req.cornerRadius);\n        if (arcApplied) result = arcApplied;\n      }\n      // NEW (M5.6) apply smoothing AFTER arcs (arcs preserved, path rebuilt as polyline if smoothing >0)\n      if (result && req.smoothingMode !== 'none' && req.smoothingIterations > 0) {\n        const smoothApplied = this._applySmoothing(result, req);\n        if (smoothApplied) result = smoothApplied;\n      }\n\n      this._cache.set(key, result);\n      this._cacheOrder.push(key);\n      if (this._cacheOrder.length > this._maxCache) {\n        const oldest = this._cacheOrder.shift();\n        if (oldest) this._cache.delete(oldest);\n      }\n      return { ...result, meta: { ...result.meta, cache_hit: false } };\n    });\n  }\n\n  _computeGrid(req, flags={}) {\n    perfInc('routing.strategy.grid', 1);\n    const vb = this.viewBox || [0,0,400,200];\n    const width = vb[2];\n    const height = vb[3];\n    const baseRes = Number(this.config.grid_resolution || 64);\n    const res = baseRes > 4 ? baseRes : 32;\n    const cols = Math.max(2, Math.ceil(width / res));\n    const rows = Math.max(2, Math.ceil(height / res));\n    const clearance = Math.max(0, req.clearance || this.config.clearance || 0);\n\n    const gridKey = `${res}|${this._obsVersion}|${clearance}`;\n    let occ = this._gridCache.get(gridKey);\n    if (!occ) {\n      occ = this._buildOccupancy(cols, rows, res, clearance);\n      this._gridCache.set(gridKey, occ);\n    }\n\n    const w2c = (x)=>Math.min(cols-1, Math.max(0, Math.round(x / res)));\n    const h2c = (y)=>Math.min(rows-1, Math.max(0, Math.round(y / res)));\n    const c2x = (c)=> c * res;\n    const c2y = (r)=> r * res;\n\n    const start = { c: w2c(req.a[0]), r: h2c(req.a[1]) };\n    const goal  = { c: w2c(req.b[0]), r: h2c(req.b[1]) };\n\n    // A* (4-direction)\n    const open = new MinHeap();\n    const key = (c,r)=>`${c},${r}`;\n    const gScore = new Map();\n    const came = new Map();\n    const h = (c,r)=> Math.abs(c-goal.c)+Math.abs(r-goal.r);\n\n    gScore.set(key(start.c,start.r),0);\n    open.push({ c:start.c, r:start.r, f:h(start.c,start.r) });\n\n    const blocked = (c,r)=> occ[r] && occ[r][c] === 1;\n\n    const maxIterations = cols*rows * 4; // guard\n    let iterations = 0;\n    let found = false;\n\n    while(!open.isEmpty() && iterations++ < maxIterations) {\n      const cur = open.pop();\n      if (cur.c === goal.c && cur.r === goal.r) { found = true; break; }\n      const gCur = gScore.get(key(cur.c,cur.r));\n      for (const [dc,dr] of [[1,0],[-1,0],[0,1],[0,-1]]) {\n        const nc = cur.c+dc, nr = cur.r+dr;\n        if (nc<0||nr<0||nc>=cols||nr>=rows) continue;\n        if (blocked(nc,nr)) continue;\n        const nk = key(nc,nr);\n        const gNew = gCur + 1;\n        if (gNew < (gScore.get(nk) ?? Infinity)) {\n            gScore.set(nk,gNew);\n            came.set(nk, [cur.c,cur.r]);\n            const f = gNew + h(nc,nr);\n            open.push({ c:nc, r:nr, f });\n        }\n      }\n    }\n\n    if (!found) {\n      return null; // caller will fallback\n    }\n\n    // Reconstruct\n    const pathCells = [];\n    let cc = goal.c, cr = goal.r;\n    while(true) {\n      pathCells.push([cc,cr]);\n      if (cc === start.c && cr === start.r) break;\n      const prev = came.get(key(cc,cr));\n      if (!prev) break;\n      [cc,cr] = prev;\n    }\n    pathCells.reverse();\n\n    // Compress straight runs into polyline world coords\n    const pts = [];\n    let lastDir = null;\n    for (let i=0;i<pathCells.length;i++) {\n      const [pc,pr] = pathCells[i];\n      const wx = c2x(pc);\n      const wy = c2y(pr);\n      if (i===0) { pts.push([wx,wy]); continue; }\n      const [pcPrev,prPrev] = pathCells[i-1];\n      const dir = [pc-pcPrev, pr-prPrev].join(',');\n      if (dir !== lastDir) {\n        // new direction, keep previous cell as corner (if not already added)\n        pts.push([wx,wy]);\n        lastDir = dir;\n      } else {\n        // same direction  update last point to current (extend segment)\n        pts[pts.length-1] = [wx,wy];\n      }\n    }\n    // Ensure final destination snapping\n    pts[0] = [req.a[0], req.a[1]];\n    pts[pts.length-1] = [req.b[0], req.b[1]];\n\n    // NEW (M5.2 fix): If compression produced a single diagonal segment, insert a Manhattan elbow.\n    if (pts.length === 2) {\n      const [sx, sy] = pts[0];\n      const [tx, ty] = pts[1];\n      if (sx !== tx && sy !== ty) {\n        const mode = (req.modeHint === 'yx') ? 'yx' : 'xy';\n        if (mode === 'yx') {\n          pts.splice(1, 0, [sx, ty]);\n        } else {\n          pts.splice(1, 0, [tx, sy]);\n        }\n      }\n    }\n\n    const bendW = (this.config?.cost_defaults?.bend ?? 10);\n    const proxW = (this.config?.cost_defaults?.proximity ?? 4);\n    const { penalty: proxPenalty } = this._segmentProximityPenalty(pts, req.clearance, req.proximity, proxW);\n    let channelInfo = this._channelDelta(pts, req);\n    let shapingMeta = null;\n    if (req.channels?.length && (req.channelMode === 'prefer' || req.channelMode === 'force')) {\n      const desired = (req.channelMode === 'force') ? 1.0 : this._channelTargetCoverage;\n      if (channelInfo.coverage < desired) {\n        const shapeRes = this._shapeForChannels(req, pts, channelInfo, desired);\n        if (shapeRes && shapeRes.accepted) {\n          pts = shapeRes.pts;\n          channelInfo = this._channelDelta(pts, req); // recompute\n          shapingMeta = shapeRes.meta;\n          perfInc('routing.channel.shape.accept', 1);\n        } else if (shapeRes) {\n          shapingMeta = shapeRes.meta;\n        }\n      }\n    }\n    const totalCost = this._costComposite(pts, bendW, proxW, proxPenalty, channelInfo.delta);\n    const d = this._polylineToPath(pts);\n    return {\n      d,\n      pts,\n      meta: {\n        strategy: flags.smart ? 'grid-smart-preface' : 'grid',\n        cost: totalCost,\n        segments: pts.length - 1,\n        bends: Math.max(0, pts.length - 2),\n        grid: { resolution: res, iterations },\n        ...(req.channels?.length ? {\n          channel: {\n            mode: channelInfo.mode,\n            insidePx: channelInfo.inside,\n            outsidePx: channelInfo.outside,\n            coveragePct: Number((channelInfo.coverage*100).toFixed(1)),\n            deltaCost: channelInfo.delta,\n            forcedOutside: channelInfo.forcedOutside,\n            ...(shapingMeta ? { shaping: shapingMeta } : {})\n          }\n        } : {})\n      }\n    };\n  }\n\n  _buildOccupancy(cols, rows, res, clearance) {\n    // 0 = free, 1 = blocked\n    const occ = Array.from({ length: rows }, () => new Uint8Array(cols));\n    if (!this._obstacles.length) return occ;\n    for (const ob of this._obstacles) {\n      const x1 = ob.x1 - clearance;\n      const y1 = ob.y1 - clearance;\n      const x2 = ob.x2 + clearance;\n      const y2 = ob.y2 + clearance;\n      const c0 = Math.max(0, Math.floor(x1 / res));\n      const r0 = Math.max(0, Math.floor(y1 / res));\n      const c1 = Math.min(cols-1, Math.ceil(x2 / res));\n      const r1 = Math.min(rows-1, Math.ceil(y2 / res));\n      for (let r=r0; r<=r1; r++) {\n        const row = occ[r];\n        for (let c=c0; c<=c1; c++) {\n          row[c] = 1;\n        }\n      }\n    }\n    return occ;\n  }\n\n  /**\n   * Manhattan routing supporting independent first and last segment hints.\n   * @param {object} req - Route request with modeHint and modeHintLast\n   */\n  _computeManhattan(req) {\n    const [x1, y1] = req.a;\n    const [x2, y2] = req.b;\n    const firstMode = (req.modeHint === 'yx') ? 'yx' : 'xy';\n    const lastMode  = (req.modeHintLast === 'yx') ? 'yx' : 'xy';\n    let pts;\n    if (x1 === x2 || y1 === y2) {\n      pts = [[x1,y1],[x2,y2]];\n    } else {\n      // We honor lastMode for the final segment orientation.\n      // lastMode = 'xy' => final segment is along Y (because order x then y)\n      // lastMode = 'yx' => final segment is along X.\n      if (lastMode === 'xy') {\n        // Final vertical => elbow shares x2, start y1\n        pts = [[x1,y1],[x2,y1],[x2,y2]];\n      } else {\n        // lastMode === 'yx' final horizontal => elbow shares y2, start x1\n        pts = [[x1,y1],[x1,y2],[x2,y2]];\n      }\n      // If explicit first hint conflicts, we could insert an intermediate elbow (optional)\n      // For now, we accept 3-point L shape determined by lastMode.\n    }\n    const d = this._polylineToPath(pts);\n    return {\n      d,\n      pts,\n      meta: {\n        strategy: 'manhattan-basic',\n        cost: this._costSimple(pts),\n        segments: pts.length - 1,\n        bends: Math.max(0, pts.length - 2),\n        hint: {\n          first: req.modeHint,\n            last: req.modeHintLast,\n          sourceFirst: req._hintSourceFirst,\n          sourceLast: req._hintSourceLast\n        }\n      }\n    };\n  }\n\n  _polylineToPath(pts) {\n    if (!pts.length) return '';\n    let p = `M${pts[0][0]},${pts[0][1]}`;\n    for (let i=1;i<pts.length;i++) {\n      p += ` L${pts[i][0]},${pts[i][1]}`;\n    }\n    return p;\n  }\n\n  _costSimple(pts) {\n    let dist = 0;\n    for (let i=1;i<pts.length;i++) {\n      const dx = pts[i][0]-pts[i-1][0];\n      const dy = pts[i][1]-pts[i-1][1];\n      dist += Math.abs(dx)+Math.abs(dy);\n    }\n    const bends = Math.max(0, pts.length-2);\n    const bendWeight = (this.config?.cost_defaults?.bend ?? 10);\n    return dist + bends * bendWeight;\n  }\n\n  _costComposite(pts, bendsWeight, proximityWeight, proximityPenalty, channelDelta = 0) {\n    // distance + bendsWeight*bends + proximityWeight*penalty\n    let dist = 0;\n    for (let i=1;i<pts.length;i++) {\n      dist += Math.abs(pts[i][0]-pts[i-1][0]) + Math.abs(pts[i][1]-pts[i-1][1]);\n    }\n    const bends = Math.max(0, pts.length - 2);\n    return dist + bends * bendsWeight + proximityPenalty * proximityWeight + channelDelta;\n  }\n\n  _segmentProximityPenalty(pts, clearance, proximity, proximityWeightRaw) {\n    if (!proximity || !this._obstacles.length) return { penalty: 0, detail: [] };\n    const band = clearance + proximity;\n    let total = 0;\n    const detail = [];\n    for (let i=1;i<pts.length;i++) {\n      const a = pts[i-1], b = pts[i];\n      const segPenalty = this._nearestObstacleBandOverlap(a, b, band);\n      if (segPenalty > 0) {\n        total += segPenalty;\n        detail.push({ i, segPenalty });\n      }\n    }\n    return { penalty: total, detail };\n  }\n\n  _nearestObstacleBandOverlap(a, b, band) {\n    // Axis-aligned segments only\n    const vertical = a[0] === b[0];\n    const x1 = Math.min(a[0], b[0]);\n    const x2 = Math.max(a[0], b[0]);\n    const y1 = Math.min(a[1], b[1]);\n    const y2 = Math.max(a[1], b[1]);\n    let worst = 0;\n    for (const ob of this._obstacles) {\n      // Quick reject bounding box enlarged by band\n      if (x2 < ob.x1 - band || x1 > ob.x2 + band || y2 < ob.y1 - band || y1 > ob.y2 + band) continue;\n      let d;\n      if (vertical) {\n        // Distance from line x=a.x to obstacle horizontal span\n        if (a[0] < ob.x1) d = ob.x1 - a[0];\n        else if (a[0] > ob.x2) d = a[0] - ob.x2;\n        else d = 0;\n      } else {\n        if (a[1] < ob.y1) d = ob.y1 - a[1];\n        else if (a[1] > ob.y2) d = a[1] - ob.y2;\n        else d = 0;\n      }\n      if (d < band) {\n        const p = (band - d); // linear penalty (could square later)\n        if (p > worst) worst = p;\n      }\n    }\n    return worst;\n  }\n\n  _normalizeChannels(list) {\n    if (!Array.isArray(list)) return [];\n    return list\n      .filter(c => c && Array.isArray(c.rect) && c.rect.length === 4)\n      .map(c => {\n        const [x,y,w,h] = c.rect;\n        return {\n          id: c.id || `chan_${x}_${y}`,\n          x1: x, y1: y, x2: x + w, y2: y + h,\n          weight: Number(c.weight || c.w || 0.5)\n        };\n      });\n  }\n\n  _channelDelta(pts, req) {\n    if (!this._channels.length || !req.channels || !req.channels.length) return { delta: 0, inside: 0, outside: 0, coverage: 0, forcedOutside: false, mode: req.channelMode };\n    // Filter to requested channel IDs (ignore unknown)\n    const chanSet = new Set(req.channels);\n    const chans = this._channels.filter(c => chanSet.has(c.id));\n    if (!chans.length) return { delta: 0, inside: 0, outside: 0, coverage: 0, forcedOutside: false };\n\n    let inside = 0;\n    let outside = 0;\n    // Forcing: a point is \"inside preferred set\" if midpoint is inside ANY requested channel rect.\n    for (let i=1;i<pts.length;i++) {\n      const a = pts[i-1], b = pts[i];\n      const segLen = Math.abs(a[0]-b[0]) + Math.abs(a[1]-b[1]);\n      if (segLen === 0) continue;\n      // Midpoint (orthogonal so pick center)\n      const mx = (a[0] + b[0]) / 2;\n      const my = (a[1] + b[1]) / 2;\n      const inChan = chans.some(c => mx >= c.x1 && mx <= c.x2 && my >= c.y1 && my <= c.y2);\n      if (inChan) inside += segLen;\n      else outside += segLen;\n    }\n    const coverage = inside / (inside + outside || 1);\n    let delta = 0;\n    const mode = (req.channelMode || 'prefer').toLowerCase();\n    let forcedOutside = false;\n    if (mode === 'prefer') {\n      // Reward inside (subtract)\n      const weightAvg = chans.reduce((s,c)=>s+c.weight,0)/chans.length;\n      delta -= inside * weightAvg;\n    } else if (mode === 'avoid') {\n      const weightAvg = chans.reduce((s,c)=>s+c.weight,0)/chans.length;\n      delta += inside * weightAvg * this._channelAvoidMultiplier;\n    } else if (mode === 'force') {\n      if (outside > 0) {\n        forcedOutside = true;\n        delta += this._channelForcePenalty;\n      } else {\n        const weightAvg = chans.reduce((s,c)=>s+c.weight,0)/chans.length;\n        delta -= inside * weightAvg; // full reward when fully inside\n      }\n    }\n    if (delta !== 0) perfInc('routing.channel.applied', 1);\n    if (forcedOutside) perfInc('routing.channel.force.penalty', 1);\n    return { delta, inside, outside, coverage, forcedOutside, mode: req.channelMode };\n  }\n\n  _refineSmart(req, gridBase) {\n    if (!gridBase || !Array.isArray(gridBase.pts) || gridBase.pts.length < 2) return gridBase;\n    const bendW = (this.config?.cost_defaults?.bend ?? 10);\n    const proxW = (this.config?.cost_defaults?.proximity ?? 4);\n    const { penalty: penaltyBefore } = this._segmentProximityPenalty(gridBase.pts, req.clearance, req.proximity, proxW);\n    let bestPts = gridBase.pts.slice();\n    let bestPenalty = penaltyBefore;\n    let bestCost = this._costComposite(bestPts, bendW, proxW, bestPenalty);\n    let detoursTried = 0;\n    let detoursAccepted = 0;\n\n    if (req.proximity > 0 && bestPts.length > 2) {\n      // Try shifting each elbow (not endpoints)\n      const span = req.smart.detourSpan;\n      const maxExtraBends = req.smart.maxExtraBends;\n      const minImprove = req.smart.min_improvement;\n      for (let i=1;i<bestPts.length-1;i++) {\n        const elbow = bestPts[i];\n        const prev = bestPts[i-1];\n        const next = bestPts[i+1];\n        const verticalIn = prev[0] === elbow[0]; // incoming dir\n        const horizontalOut = elbow[1] === next[1]; // outgoing dir\n        // Only elbows where both dirs present (true elbow)\n        if ((verticalIn && horizontalOut) || (!verticalIn && !horizontalOut)) {\n          // Determine orthogonal shift axis (shift elbow along one axis to widen clearance)\n          const candidates = [];\n          if (verticalIn && horizontalOut) {\n            // elbow shape  or  etc. shift in a box: along x and y\n            candidates.push([elbow[0] + span, elbow[1]]);\n            candidates.push([elbow[0] - span, elbow[1]]);\n            candidates.push([elbow[0], elbow[1] + span]);\n            candidates.push([elbow[0], elbow[1] - span]);\n          } else {\n            candidates.push([elbow[0] + span, elbow[1]]);\n            candidates.push([elbow[0] - span, elbow[1]]);\n            candidates.push([elbow[0], elbow[1] + span]);\n            candidates.push([elbow[0], elbow[1] - span]);\n          }\n          let tries = 0;\n          for (const c of candidates) {\n            if (tries++ >= req.smart.maxDetoursPerElbow) break;\n            detoursTried++;\n            const newPts = bestPts.slice();\n            newPts[i] = c;\n            // Prevent duplicate successive collinear points (basic)\n            const compact = this._compactPolyline(newPts);\n            if (compact.length - bestPts.length > maxExtraBends) continue;\n            const { penalty: p2 } = this._segmentProximityPenalty(compact, req.clearance, req.proximity, proxW);\n            const cost2 = this._costComposite(compact, bendW, proxW, p2);\n            if (cost2 + minImprove <= bestCost) {\n              bestCost = cost2;\n              bestPts = compact;\n              bestPenalty = p2;\n              detoursAccepted++;\n            }\n          }\n        }\n      }\n    }\n\n    const channelInfo = this._channelDelta(bestPts, req);\n    // Channel shaping (only prefer/force & if coverage below target)\n    let shapingMeta = null;\n    if (req.channels?.length && (req.channelMode === 'prefer' || req.channelMode === 'force')) {\n      const desired = (req.channelMode === 'force') ? 1.0 : this._channelTargetCoverage;\n      if (channelInfo.coverage < desired) {\n        const shapeRes = this._shapeForChannels(req, bestPts, channelInfo, desired);\n        if (shapeRes && shapeRes.accepted) {\n          bestPts = shapeRes.pts;\n          // recompute penalties\n          const newChan = this._channelDelta(bestPts, req);\n          const { penalty: newProx } = this._segmentProximityPenalty(bestPts, req.clearance, req.proximity, proxW);\n            bestPenalty = newProx; // proximity might change slightly (rare)  reassign\n          shapingMeta = shapeRes.meta;\n          // recompute cost with new channel delta\n          bestCost = this._costComposite(bestPts, bendW, proxW, bestPenalty, newChan.delta);\n          // overwrite channelInfo for meta\n          channelInfo.inside = newChan.inside;\n          channelInfo.outside = newChan.outside;\n          channelInfo.coverage = newChan.coverage;\n          channelInfo.delta = newChan.delta;\n          channelInfo.forcedOutside = newChan.forcedOutside;\n          perfInc('routing.channel.shape.accept', 1);\n        } else if (shapeRes) {\n          shapingMeta = shapeRes.meta;\n        }\n      }\n    }\n    // REPLACED duplicate const bestCost decl with in-place update earlier\n    bestCost = this._costComposite(bestPts, bendW, proxW, bestPenalty, channelInfo.delta);\n    const d = this._polylineToPath(bestPts);\n    const baseMeta = gridBase.meta || {};\n    baseMeta.strategy = 'smart';\n    baseMeta.cost = bestCost;\n    baseMeta.bends = Math.max(0, bestPts.length - 2);\n    baseMeta.segments = bestPts.length - 1;\n    baseMeta.smart = {\n      penaltyBefore,\n      penaltyAfter: bestPenalty,\n      detoursTried,\n      detoursAccepted\n    };\n    if (req.channels?.length) {\n      baseMeta.channel = {\n        mode: channelInfo.mode,\n        insidePx: channelInfo.inside,\n        outsidePx: channelInfo.outside,\n        coveragePct: Number((channelInfo.coverage*100).toFixed(1)),\n        deltaCost: channelInfo.delta,\n        forcedOutside: channelInfo.forcedOutside,\n        ...(shapingMeta ? { shaping: shapingMeta } : {})\n      };\n    }\n    perfInc('routing.smart.refine.attempt', detoursTried);\n    perfInc('routing.smart.refine.accept', detoursAccepted);\n    return { d, pts: bestPts, meta: baseMeta };\n  }\n\n  _compactPolyline(pts) {\n    if (pts.length <= 2) return pts;\n    const out = [pts[0]];\n    for (let i=1;i<pts.length-1;i++) {\n      const a = out[out.length-1];\n      const b = pts[i];\n      const c = pts[i+1];\n      // If a->b and b->c are collinear, skip b\n      if ((a[0] === b[0] && b[0] === c[0]) || (a[1] === b[1] && b[1] === c[1])) continue;\n      out.push(b);\n    }\n    out.push(pts[pts.length-1]);\n    return out;\n  }\n\n  _shapeForChannels(req, pts, channelInfo, desiredCoverage) {\n    perfInc('routing.channel.shape.attempt', 1);\n    const attemptsMax = this._channelShapingMaxAttempts;\n    const span = this._channelShapingSpan;\n    const minGain = this._channelMinCoverageGain;\n    const chanIds = new Set(req.channels);\n    const chans = this._channels.filter(c => chanIds.has(c.id));\n    if (!chans.length) return null;\n\n    const coverage0 = channelInfo.coverage;\n    let bestPts = pts.slice();\n    let bestCoverage = coverage0;\n    let accepted = false;\n    let attempts = 0;\n    let coverageHistory = [Number(coverage0.toFixed(4))];\n    const forceMode = (req.channelMode === 'force');\n\n    function midpoint(a,b){ return [(a[0]+b[0])/2,(a[1]+b[1])/2]; }\n    const inAny = (x,y)=>chans.some(c=> x>=c.x1 && x<=c.x2 && y>=c.y1 && y<=c.y2);\n\n    const segsOutside = () => {\n      const list = [];\n      for (let i=1;i<bestPts.length;i++){\n        const a=bestPts[i-1], b=bestPts[i];\n        const len=Math.abs(a[0]-b[0])+Math.abs(a[1]-b[1]);\n        if(!len) continue;\n        const [mx,my]=midpoint(a,b);\n        if(!inAny(mx,my)) list.push({i,len,a,b,mx,my});\n      }\n      return list.sort((x,y)=>y.len-x.len);\n    };\n\n    while (attempts < attemptsMax) {\n      attempts++;\n      const outsideSegs = segsOutside();\n      if (!outsideSegs.length) break; // fully inside\n      // pick the largest outside segment\n      const seg = outsideSegs[0];\n      // Try shifting its interior elbow(s) if any\n      // Identify candidate elbow indices around this segment\n      const elbowIndices = [];\n      if (seg.i-1 > 0) elbowIndices.push(seg.i-1);\n      if (seg.i < bestPts.length-1) elbowIndices.push(seg.i);\n\n      let improved = false;\n      for (const ei of elbowIndices) {\n        const copy = bestPts.map(p=>p.slice());\n        // shift target elbow towards nearest channel center\n        const e = copy[ei];\n        // Compute shortest move vector to enter any channel (axis aligned)\n        let bestMove = null;\n        let bestMoveDist = Infinity;\n        chans.forEach(c => {\n          // For a point outside, compute minimal axis step into rect\n            const dx = (e[0] < c.x1) ? (c.x1 - e[0]) :\n                       (e[0] > c.x2) ? (c.x2 - e[0]) : 0;\n            const dy = (e[1] < c.y1) ? (c.y1 - e[1]) :\n                       (e[1] > c.y2) ? (c.y2 - e[1]) : 0;\n          // Only consider moving along one axis per attempt (choose smaller non-zero)\n          if (dx !==0 && dy !==0) {\n            // pick smaller\n            if (Math.abs(dx) < Math.abs(dy)) {\n              if (Math.abs(dx) < bestMoveDist) { bestMoveDist = Math.abs(dx); bestMove = [dx,0]; }\n            } else {\n              if (Math.abs(dy) < bestMoveDist) { bestMoveDist = Math.abs(dy); bestMove = [0,dy]; }\n            }\n          } else if (dx !==0 || dy !==0) {\n            const d = Math.abs(dx||dy);\n            if (d < bestMoveDist) { bestMoveDist = d; bestMove = [dx,dy]; }\n          }\n        });\n        if (!bestMove) continue;\n        // scale move to span (limit)\n        const mv = [\n          bestMove[0] === 0 ? 0 : Math.sign(bestMove[0]) * Math.min(Math.abs(bestMove[0]), span),\n          bestMove[1] === 0 ? 0 : Math.sign(bestMove[1]) * Math.min(Math.abs(bestMove[1]), span)\n        ];\n        copy[ei] = [e[0] + mv[0], e[1] + mv[1]];\n        // Compact polyline if collinear introduced\n        const compact = this._compactPolyline(copy);\n        const newChan = this._channelDelta(compact, req);\n        const gain = newChan.coverage - bestCoverage;\n        if (gain >= minGain) {\n          bestPts = compact;\n          bestCoverage = newChan.coverage;\n          coverageHistory.push(Number(bestCoverage.toFixed(4)));\n          improved = true;\n          if (forceMode && bestCoverage >= 0.999) break;\n          if (!forceMode && bestCoverage >= desiredCoverage) break;\n        }\n      }\n      if (!improved) break;\n      if ((forceMode && bestCoverage >= 0.999) || (!forceMode && bestCoverage >= desiredCoverage)) {\n        accepted = true;\n        break;\n      }\n    }\n\n    // Force downgrade if still outside & force mode\n    let downgraded = false;\n    if (forceMode && bestCoverage < 0.999) {\n      downgraded = true;\n      // mark but caller meta will keep mode=force + forcedOutside flag (HUD can show downgrade)\n      perfInc('routing.channel.shape.downgrade', 1);\n    }\n\n    return {\n      accepted,\n      pts: bestPts,\n      meta: {\n        attempts,\n        coverageBefore: Number(coverage0.toFixed(4)),\n        coverageAfter: Number(bestCoverage.toFixed(4)),\n        coverageHistory,\n        accepted,\n        downgraded\n      }\n    };\n  }\n\n  _applyCornerRounding(routeResult, radiusGlobal) {\n    const pts = routeResult.pts;\n    if (!Array.isArray(pts) || pts.length < 3) {\n      perfInc('routing.arc.none', 1);\n      return null;\n    }\n    const arcMin = 1;\n    let arcCount = 0;\n    let totalTrim = 0;\n    const parts = [];\n    let lastOut = pts[0].slice();\n    parts.push(`M${lastOut[0]},${lastOut[1]}`);\n    for (let i = 1; i < pts.length - 1; i++) {\n      const pPrev = pts[i - 1];\n      const p = pts[i];\n      const pNext = pts[i + 1];\n      const vIn = [p[0] - pPrev[0], p[1] - pPrev[1]];\n      const vOut = [pNext[0] - p[0], pNext[1] - p[1]];\n      const isOrth = (vIn[0] === 0 || vIn[1] === 0) && (vOut[0] === 0 || vOut[1] === 0) && !(vIn[0] === 0 && vIn[1] === 0) && !(vOut[0] === 0 && vOut[1] === 0) && !(Math.sign(vIn[0]) === Math.sign(vOut[0]) && vIn[0] !== 0) && !(Math.sign(vIn[1]) === Math.sign(vOut[1]) && vIn[1] !== 0);\n      if (!isOrth) {\n        // Just connect full corner\n        if (p[0] !== lastOut[0] || p[1] !== lastOut[1]) {\n          parts.push(`L${p[0]},${p[1]}`);\n          lastOut = p.slice();\n        }\n        continue;\n      }\n      const lenIn = Math.abs(vIn[0]) + Math.abs(vIn[1]);\n      const lenOut = Math.abs(vOut[0]) + Math.abs(vOut[1]);\n      let r = Math.min(radiusGlobal, lenIn / 2, lenOut / 2);\n      if (r < arcMin) {\n        if (p[0] !== lastOut[0] || p[1] !== lastOut[1]) {\n          parts.push(`L${p[0]},${p[1]}`);\n          lastOut = p.slice();\n        }\n        continue;\n      }\n      // Trim points\n      let pInTrim = p.slice();\n      if (vIn[0] !== 0) {\n        pInTrim[0] = p[0] - Math.sign(vIn[0]) * r;\n      } else {\n        pInTrim[1] = p[1] - Math.sign(vIn[1]) * r;\n      }\n      let pOutTrim = p.slice();\n      if (vOut[0] !== 0) {\n        pOutTrim[0] = p[0] + Math.sign(vOut[0]) * r;\n      } else {\n        pOutTrim[1] = p[1] + Math.sign(vOut[1]) * r;\n      }\n      // Line to trimmed incoming point\n      if (pInTrim[0] !== lastOut[0] || pInTrim[1] !== lastOut[1]) {\n        parts.push(`L${pInTrim[0]},${pInTrim[1]}`);\n      }\n      // Determine sweep flag (clockwise vs counter-clockwise) using z of 2D cross\n      const cross = vIn[0] * vOut[1] - vIn[1] * vOut[0];\n      const sweep = cross < 0 ? 0 : 1;\n      // Use small arc (90) => large-arc-flag = 0\n      parts.push(`A${r},${r} 0 0 ${sweep} ${pOutTrim[0]},${pOutTrim[1]}`);\n      totalTrim += 2 * r;\n      arcCount++;\n      lastOut = pOutTrim;\n    }\n    // Last point\n    const pEnd = pts[pts.length - 1];\n    if (pEnd[0] !== lastOut[0] || pEnd[1] !== lastOut[1]) {\n      parts.push(`L${pEnd[0]},${pEnd[1]}`);\n    }\n    // If no arcs applied, skip\n    if (!arcCount) {\n      perfInc('routing.arc.none', 1);\n      return null;\n    }\n    perfInc('routing.arc.apply', 1);\n    const newResult = {\n      ...routeResult,\n      d: parts.join(' '),\n      meta: {\n        ...routeResult.meta,\n        arc: {\n          count: arcCount,\n          trimPx: Math.round(totalTrim)\n        }\n      }\n    };\n    return newResult;\n  }\n\n  _applySmoothing(routeResult, req) {\n    const mode = req.smoothingMode;\n    if (mode === 'none' || req.smoothingIterations <= 0) return null;\n    let iters = Math.min(5, Math.max(1, req.smoothingIterations|0));\n    if (!Array.isArray(routeResult.pts) || routeResult.pts.length < 3) return null;\n    if (mode !== 'chaikin') return null; // only mode supported now\n    let pts = routeResult.pts.map(p=>[p[0],p[1]]);\n    // If arcs already applied we try to reconstruct polyline from original pts (already available)\n    // Chaikin corner cutting\n    for (let k=0; k<iters; k++) {\n      const next = [pts[0]];\n      for (let i=0;i<pts.length-1;i++){\n        const p=pts[i], q=pts[i+1];\n        const Q=[0.75*p[0]+0.25*q[0], 0.75*p[1]+0.25*q[1]];\n        const R=[0.25*p[0]+0.75*q[0], 0.25*p[1]+0.75*q[1]];\n        next.push(Q,R);\n        if (next.length >= req.smoothingMaxPoints) break;\n      }\n      next.push(pts[pts.length-1]);\n      pts = next;\n      if (pts.length >= req.smoothingMaxPoints) break;\n    }\n    // Build path (polyline with many short segments)\n    const d = pts.reduce((acc,p,i)=> acc + (i?` L${p[0]},${p[1]}`:`M${p[0]},${p[1]}`),'');\n    const newMeta = {\n      ...routeResult.meta,\n      smooth: {\n        mode,\n        iterations: iters,\n        points: pts.length,\n        addedPoints: pts.length - routeResult.pts.length\n      }\n    };\n    perfInc('routing.smooth.apply',1);\n    return { ...routeResult, d, pts, meta: newMeta };\n  }\n}\n\n// Simple min-heap for A*\nclass MinHeap {\n  constructor(){ this.a=[]; }\n  push(n){ this.a.push(n); this._up(this.a.length-1); }\n  pop(){\n    if(!this.a.length) return null;\n    const top=this.a[0];\n    const last=this.a.pop();\n    if(this.a.length){ this.a[0]=last; this._down(0); }\n    return top;\n  }\n  isEmpty(){ return this.a.length===0; }\n  _up(i){\n    while(i>0){\n      const p=(i-1)>>1;\n      if(this.a[p].f <= this.a[i].f) break;\n      [this.a[p],this.a[i]]=[this.a[i],this.a[p]];\n      i=p;\n    }\n  }\n  _down(i){\n    const n=this.a.length;\n    while(true){\n      let l=i*2+1, r=l+1, m=i;\n      if(l<n && this.a[l].f < this.a[m].f) m=l;\n      if(r<n && this.a[r].f < this.a[m].f) m=r;\n      if(m===i) break;\n      [this.a[m],this.a[i]]=[this.a[i],this.a[m]];\n      i=m;\n    }\n  }\n}\n","/**\n * Object hashing utilities for semantic comparison\n * Used by animation registry and other caching systems\n */\n\n/**\n * Compute deterministic hash of an object\n */\nexport function computeObjectHash(obj) {\n  const normalized = normalizeForHashing(obj);\n  const serialized = stableStringify(normalized);\n  return simpleHash(serialized);\n}\n\n/**\n * Normalize object for consistent hashing\n */\nfunction normalizeForHashing(obj) {\n  if (obj === null || obj === undefined) return null;\n\n  if (typeof obj !== 'object') return obj;\n\n  if (Array.isArray(obj)) {\n    return obj.map(normalizeForHashing);\n  }\n\n  const normalized = {};\n  Object.keys(obj).sort().forEach(key => {\n    normalized[key] = normalizeForHashing(obj[key]);\n  });\n\n  return normalized;\n}\n\n/**\n * Stable JSON stringify with sorted keys\n */\nfunction stableStringify(obj) {\n  if (typeof obj !== 'object' || obj === null) {\n    return JSON.stringify(obj);\n  }\n\n  if (Array.isArray(obj)) {\n    return '[' + obj.map(stableStringify).join(',') + ']';\n  }\n\n  const keys = Object.keys(obj).sort();\n  const pairs = keys.map(key => `\"${key}\":${stableStringify(obj[key])}`);\n  return '{' + pairs.join(',') + '}';\n}\n\n/**\n * Simple but effective hash function\n */\nfunction simpleHash(str) {\n  let hash = 0;\n\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // Convert to 32bit integer\n  }\n\n  // Convert to positive string\n  return Math.abs(hash).toString(36);\n}\n\n/**\n * Compare two objects for semantic equality\n */\nexport function objectsEqual(a, b) {\n  return computeObjectHash(a) === computeObjectHash(b);\n}\n\n/**\n * Hash array of objects consistently\n */\nexport function hashArray(arr) {\n  if (!Array.isArray(arr)) return computeObjectHash(arr);\n\n  const hashes = arr.map(computeObjectHash);\n  return simpleHash(hashes.join('|'));\n}\n","import { perfTime, perfTimeAsync, perfCount } from '../util/performance.js';\nimport { computeObjectHash } from '../util/hashing.js';\n\n/**\n * Animation Registry for efficient animation reuse\n * Provides semantic comparison and intelligent caching\n */\nexport class AnimationRegistry {\n  constructor() {\n    this.cache = new Map(); // hash -> instance\n    this.instanceToHash = new WeakMap(); // instance -> hash\n    this.usageStats = new Map(); // hash -> { count, lastUsed }\n    this.maxCacheSize = 500;\n    this.cleanupThreshold = 600;\n\n    // Performance tracking\n    this.perfStats = {\n      cacheHits: 0,\n      cacheMisses: 0,\n      instancesCreated: 0,\n      instancesReused: 0,\n      cleanupRuns: 0\n    };\n  }\n\n  /**\n   * Get or create animation instance with intelligent reuse\n   */\n  getOrCreateInstance(definition, targets) {\n    return perfTime('animation.getInstance', () => {\n      const hash = this.computeInstanceHash(definition);\n\n      // Check cache first\n      if (this.cache.has(hash)) {\n        const cached = this.cache.get(hash);\n\n        // Verify targets compatibility\n        if (this.targetsCompatible(cached.targets, targets)) {\n          this.recordCacheHit(hash);\n          perfCount('animation.instance.reuse', 1);\n          this.perfStats.instancesReused++;\n\n          return this.reuseInstance(cached, targets);\n        } else {\n          // Targets incompatible, remove from cache\n          this.cache.delete(hash);\n          this.perfStats.cacheMisses++;\n        }\n      }\n\n      // Create new instance\n      const instance = this.createAnimationInstance(definition, targets);\n\n      // Cache the instance\n      this.cacheInstance(hash, instance, definition);\n\n      perfCount('animation.instance.new', 1);\n      this.perfStats.instancesCreated++;\n      this.perfStats.cacheMisses++;\n\n      return instance;\n    });\n  }\n\n  /**\n   * Compute semantic hash for animation definition\n   */\n  computeInstanceHash(definition) {\n    // Extract only semantic properties (exclude DOM references)\n    const semantic = {\n      preset: definition.preset,\n      params: this.normalizeParams(definition.params),\n      duration: this.normalizeNumber(definition.duration),\n      easing: definition.easing,\n      loop: definition.loop,\n      alternate: definition.alternate,\n      delay: this.normalizeNumber(definition.delay),\n      // Exclude: targets, callbacks, DOM-specific properties\n    };\n\n    // Handle animation_ref and overrides\n    if (definition.animation_ref) {\n      semantic.animation_ref = definition.animation_ref;\n      if (definition.override) {\n        semantic.override = this.normalizeParams(definition.override.params);\n      }\n    }\n\n    return computeObjectHash(semantic);\n  }\n\n  /**\n   * Normalize a single number to prevent precision churn\n   */\n  normalizeNumber(value) {\n    if (typeof value === 'number') {\n      return Math.round(value * 1000) / 1000;\n    }\n    return value;\n  }\n\n  /**\n   * Normalize parameters to reduce hash churn from floating point precision\n   */\n  normalizeParams(params) {\n    if (!params || typeof params !== 'object') return params;\n\n    const normalized = {};\n    Object.entries(params).forEach(([key, value]) => {\n      if (typeof value === 'number') {\n        // Round to 3 decimal places to prevent hash churn\n        normalized[key] = Math.round(value * 1000) / 1000;\n      } else if (Array.isArray(value)) {\n        normalized[key] = value.map(v =>\n          typeof v === 'number' ? Math.round(v * 1000) / 1000 : v\n        );\n      } else if (typeof value === 'object' && value !== null) {\n        normalized[key] = this.normalizeParams(value);\n      } else {\n        normalized[key] = value;\n      }\n    });\n\n    return normalized;\n  }\n\n  /**\n   * Check if animation targets are compatible for reuse\n   */\n  targetsCompatible(cachedTargets, newTargets) {\n    if (!cachedTargets || !newTargets) return false;\n\n    // Convert to arrays for comparison\n    const cached = Array.isArray(cachedTargets) ? cachedTargets : [cachedTargets];\n    const newOnes = Array.isArray(newTargets) ? newTargets : [newTargets];\n\n    if (cached.length !== newOnes.length) return false;\n\n    // For DOM elements, compare by id or selector\n    for (let i = 0; i < cached.length; i++) {\n      const cachedTarget = cached[i];\n      const newTarget = newOnes[i];\n\n      // String selectors must match exactly\n      if (typeof cachedTarget === 'string' && typeof newTarget === 'string') {\n        if (cachedTarget !== newTarget) return false;\n        continue;\n      }\n\n      // DOM elements - compare by id or position in DOM\n      if (cachedTarget?.id && newTarget?.id) {\n        if (cachedTarget.id !== newTarget.id) return false;\n        continue;\n      }\n\n      // If we can't determine compatibility, assume incompatible\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Create new animation instance using the runtime animation system\n   */\n  createAnimationInstance(definition, targets) {\n    try {\n      // Use the global animation system if available\n      if (typeof window !== 'undefined' && window.cblcars?.anim?.create) {\n        return window.cblcars.anim.create(definition, targets);\n      }\n\n      // Fallback mock for testing\n      return {\n        definition: { ...definition },\n        targets: Array.isArray(targets) ? [...targets] : [targets],\n        id: `anim_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        play: () => {},\n        pause: () => {},\n        stop: () => {},\n        restart: () => {}\n      };\n    } catch (error) {\n      console.warn('[AnimationRegistry] Failed to create animation instance:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Reuse existing animation instance with new targets\n   */\n  reuseInstance(cachedInstance, newTargets) {\n    try {\n      // If the animation system supports retargeting, use it\n      if (cachedInstance.retarget && typeof cachedInstance.retarget === 'function') {\n        return cachedInstance.retarget(newTargets);\n      }\n\n      // Otherwise, create a shallow copy with new targets\n      return {\n        ...cachedInstance,\n        targets: Array.isArray(newTargets) ? [...newTargets] : [newTargets],\n        id: `${cachedInstance.id}_reused_${Date.now()}`\n      };\n    } catch (error) {\n      console.warn('[AnimationRegistry] Failed to reuse animation instance:', error);\n      return this.createAnimationInstance(cachedInstance.definition, newTargets);\n    }\n  }\n\n  /**\n   * Cache animation instance with metadata\n   */\n  cacheInstance(hash, instance, definition) {\n    // Store in cache\n    this.cache.set(hash, {\n      instance,\n      definition,\n      targets: instance.targets,\n      createdAt: Date.now(),\n      hash\n    });\n\n    // Track usage\n    this.usageStats.set(hash, {\n      count: 1,\n      lastUsed: Date.now(),\n      hash\n    });\n\n    // Map instance back to hash for debugging\n    this.instanceToHash.set(instance, hash);\n\n    // Clean cache if needed AFTER adding the new item\n    if (this.cache.size > this.maxCacheSize) {\n      this.cleanupCache();\n    }\n  }\n\n  /**\n   * Record cache hit and update usage statistics\n   */\n  recordCacheHit(hash) {\n    const usage = this.usageStats.get(hash);\n    if (usage) {\n      usage.count++;\n      usage.lastUsed = Date.now();\n    }\n\n    this.perfStats.cacheHits++;\n  }\n\n  /**\n   * Clean up least recently used cache entries\n   */\n  cleanupCache() {\n    perfTime('animation.cache.cleanup', () => {\n      const entries = Array.from(this.usageStats.entries());\n\n      // Sort by last used time (oldest first)\n      entries.sort(([, a], [, b]) => a.lastUsed - b.lastUsed);\n\n      // Remove oldest entries until we're under max size\n      const toRemove = entries.slice(0, entries.length - this.maxCacheSize);\n\n      toRemove.forEach(([hash]) => {\n        this.cache.delete(hash);\n        this.usageStats.delete(hash);\n      });\n\n      this.perfStats.cleanupRuns++;\n      perfCount('animation.cache.cleanup', toRemove.length);\n    });\n  }\n\n  /**\n   * Get performance statistics\n   */\n  getStats() {\n    const stats = { ...this.perfStats };\n\n    stats.cacheSize = this.cache.size;\n    stats.hitRate = stats.cacheHits / (stats.cacheHits + stats.cacheMisses) || 0;\n    stats.reuseRate = stats.instancesReused / (stats.instancesReused + stats.instancesCreated) || 0;\n\n    return stats;\n  }\n\n  /**\n   * Get cache contents for debugging\n   */\n  getCacheContents() {\n    const contents = {};\n\n    this.cache.forEach((cached, hash) => {\n      const usage = this.usageStats.get(hash);\n      contents[hash] = {\n        definition: cached.definition,\n        createdAt: cached.createdAt,\n        usage: usage ? { count: usage.count, lastUsed: usage.lastUsed } : null\n      };\n    });\n\n    return contents;\n  }\n\n  /**\n   * Clear cache and reset statistics\n   */\n  clear() {\n    this.cache.clear();\n    this.usageStats.clear();\n    this.perfStats = {\n      cacheHits: 0,\n      cacheMisses: 0,\n      instancesCreated: 0,\n      instancesReused: 0,\n      cleanupRuns: 0\n    };\n\n    perfCount('animation.cache.cleared', 1);\n  }\n\n  /**\n   * Export cache statistics for analysis\n   */\n  exportStats(options = {}) {\n    const stats = this.getStats();\n\n    if (options.includeCache) {\n      stats.cacheContents = this.getCacheContents();\n    }\n\n    if (options.format === 'csv') {\n      return this.exportToCsv(stats);\n    }\n\n    return JSON.stringify(stats, null, 2);\n  }\n\n  exportToCsv(stats) {\n    const rows = [\n      'metric,value',\n      `cacheHits,${stats.cacheHits}`,\n      `cacheMisses,${stats.cacheMisses}`,\n      `instancesCreated,${stats.instancesCreated}`,\n      `instancesReused,${stats.instancesReused}`,\n      `cacheSize,${stats.cacheSize}`,\n      `hitRate,${stats.hitRate.toFixed(3)}`,\n      `reuseRate,${stats.reuseRate.toFixed(3)}`,\n      `cleanupRuns,${stats.cleanupRuns}`\n    ];\n\n    return rows.join('\\n');\n  }\n}\n\n// Create global registry instance\nconst globalAnimationRegistry = new AnimationRegistry();\n\n// Debug exposure\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdAnimRegistry = {\n    registry: globalAnimationRegistry,\n    getStats: () => globalAnimationRegistry.getStats(),\n    getCacheContents: () => globalAnimationRegistry.getCacheContents(),\n    clear: () => globalAnimationRegistry.clear(),\n    export: (options) => globalAnimationRegistry.exportStats(options)\n  };\n}\n\nexport { globalAnimationRegistry };\n","/**\n * Ring buffer for rule evaluation traces\n * Provides debugging capabilities and HUD integration\n */\n\nexport class RuleTraceBuffer {\n  constructor(maxSize = 1000) {\n    this.buffer = [];\n    this.maxSize = maxSize;\n    this.index = 0;\n    this.totalTraces = 0;\n  }\n\n  addTrace(ruleId, matched, conditions, evaluationTime, metadata = {}) {\n    const trace = {\n      ruleId,\n      matched,\n      conditions,\n      evaluationTime,\n      timestamp: Date.now(),\n      metadata: { ...metadata }\n    };\n\n    if (this.buffer.length < this.maxSize) {\n      this.buffer.push(trace);\n    } else {\n      this.buffer[this.index] = trace;\n      this.index = (this.index + 1) % this.maxSize;\n    }\n\n    this.totalTraces++;\n  }\n\n  getRecentTraces(limit = 50, filter = {}) {\n    const recent = [];\n    let idx = this.index - 1;\n\n    for (let i = 0; i < Math.min(limit, this.buffer.length); i++) {\n      if (idx < 0) idx = this.buffer.length - 1;\n\n      const trace = this.buffer[idx];\n      if (this.matchesFilter(trace, filter)) {\n        recent.unshift(trace);\n      }\n\n      idx--;\n    }\n\n    return recent;\n  }\n\n  getRuleHistory(ruleId, limit = 20) {\n    return this.getRecentTraces(this.buffer.length, { ruleId }).slice(0, limit);\n  }\n\n  getMatchedRules(timeWindow = 60000, limit = 100) {\n    const cutoff = Date.now() - timeWindow;\n    return this.getRecentTraces(this.buffer.length, { matched: true })\n      .filter(trace => trace.timestamp > cutoff)\n      .slice(0, limit);\n  }\n\n  getStats() {\n    const recent = this.getRecentTraces(this.buffer.length);\n    const matched = recent.filter(t => t.matched).length;\n    const avgEvalTime = recent.length > 0\n      ? recent.reduce((sum, t) => sum + t.evaluationTime, 0) / recent.length\n      : 0;\n\n    return {\n      totalTraces: this.totalTraces,\n      bufferedTraces: this.buffer.length,\n      recentMatched: matched,\n      recentTotal: recent.length,\n      matchRate: recent.length > 0 ? matched / recent.length : 0,\n      avgEvaluationTime: avgEvalTime\n    };\n  }\n\n  matchesFilter(trace, filter) {\n    if (filter.ruleId && trace.ruleId !== filter.ruleId) return false;\n    if (filter.matched !== undefined && trace.matched !== filter.matched) return false;\n    if (filter.minTime && trace.timestamp < filter.minTime) return false;\n    if (filter.maxTime && trace.timestamp > filter.maxTime) return false;\n    if (filter.minEvalTime && trace.evaluationTime < filter.minEvalTime) return false;\n\n    return true;\n  }\n\n  clear() {\n    this.buffer = [];\n    this.index = 0;\n    this.totalTraces = 0;\n  }\n\n  exportTraces(options = {}) {\n    const {\n      format = 'json',\n      limit = 100,\n      includeConditions = true,\n      includeMetadata = false\n    } = options;\n\n    const traces = this.getRecentTraces(limit);\n\n    const exported = traces.map(trace => {\n      const exported = {\n        ruleId: trace.ruleId,\n        matched: trace.matched,\n        evaluationTime: trace.evaluationTime,\n        timestamp: trace.timestamp\n      };\n\n      if (includeConditions) {\n        exported.conditions = trace.conditions;\n      }\n\n      if (includeMetadata) {\n        exported.metadata = trace.metadata;\n      }\n\n      return exported;\n    });\n\n    if (format === 'csv') {\n      return this.exportToCsv(exported);\n    }\n\n    return JSON.stringify(exported, null, 2);\n  }\n\n  exportToCsv(traces) {\n    if (traces.length === 0) return 'No traces available\\n';\n\n    const headers = ['ruleId', 'matched', 'evaluationTime', 'timestamp'];\n    const rows = traces.map(trace => [\n      trace.ruleId,\n      trace.matched,\n      trace.evaluationTime.toFixed(3),\n      new Date(trace.timestamp).toISOString()\n    ]);\n\n    return [\n      headers.join(','),\n      ...rows.map(row => row.join(','))\n    ].join('\\n');\n  }\n}\n\n// Global trace buffer instance\nconst globalTraceBuffer = new RuleTraceBuffer();\n\n// Node.js and browser compatibility\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdRuleTrace = {\n    buffer: globalTraceBuffer,\n    getRecent: (limit) => globalTraceBuffer.getRecentTraces(limit),\n    getStats: () => globalTraceBuffer.getStats(),\n    getRuleHistory: (ruleId) => globalTraceBuffer.getRuleHistory(ruleId),\n    export: (options) => globalTraceBuffer.exportTraces(options),\n    clear: () => globalTraceBuffer.clear()\n  };\n}\n\nexport { globalTraceBuffer };\n","import { perfTime, perfCount } from '../util/performance.js';\nimport { globalTraceBuffer } from './RuleTraceBuffer.js';\n\nexport class RulesEngine {\n  constructor(rules = [], dataSourceManager = null) {\n    this.rules = Array.isArray(rules) ? rules : [];\n    this.rulesById = new Map();\n    this.dependencyIndex = null;\n    this.dirtyRules = new Set();\n    this.lastEvaluation = new Map(); // ruleId -> evaluation result\n    this.traceBuffer = globalTraceBuffer;\n    this.stopProcessing = new Map(); // overlayId -> Set of stopped rule priorities\n\n    // NEW: DataSource integration\n    this.dataSourceManager = dataSourceManager;\n\n    // Performance tracking\n    this.evalCounts = {\n      total: 0,\n      dirty: 0,\n      matched: 0,\n      skipped: 0\n    };\n\n    this.buildRulesIndex();\n    this.buildDependencyIndex();\n    this.markAllDirty(); // Initial state\n  }\n\n  buildRulesIndex() {\n    this.rulesById.clear();\n    this.rules.forEach(rule => {\n      if (rule.id) {\n        this.rulesById.set(rule.id, rule);\n      }\n    });\n  }\n\n  buildDependencyIndex() {\n    const entityToRules = new Map();\n    const ruleToEntities = new Map();\n\n    this.rules.forEach(rule => {\n      const entities = this.extractEntityReferences(rule);\n      ruleToEntities.set(rule.id, entities);\n\n      entities.forEach(entityId => {\n        if (!entityToRules.has(entityId)) {\n          entityToRules.set(entityId, new Set());\n        }\n        entityToRules.get(entityId).add(rule.id);\n      });\n    });\n\n    this.dependencyIndex = { entityToRules, ruleToEntities };\n\n    // Debug exposure\n    try {\n      const debugNamespace = (typeof window !== 'undefined') ? window : global;\n      if (debugNamespace.__msdDebug) {\n        debugNamespace.__msdDebug.rulesDeps = {\n          entityToRules: Object.fromEntries(entityToRules),\n          ruleToEntities: Object.fromEntries(ruleToEntities),\n          totalEntities: entityToRules.size,\n          totalRules: this.rules.length\n        };\n      }\n    } catch (e) {}\n  }\n\n  extractEntityReferences(rule) {\n    const entities = new Set();\n\n    if (!rule.when) return Array.from(entities);\n\n    // Extract from all/any conditions\n    const conditions = [\n      ...(rule.when.all || []),\n      ...(rule.when.any || [])\n    ];\n\n    conditions.forEach(condition => {\n      // Direct entity reference\n      if (condition.entity) {\n        // Check if this is a DataSource reference\n        if (condition.entity.includes('.') && this.dataSourceManager) {\n          const sourceName = condition.entity.split('.')[0];\n          const dataSource = this.dataSourceManager.getSource(sourceName);\n          if (dataSource) {\n            // Add the DataSource itself to dependencies\n            entities.add(sourceName);\n            // Also add the full reference for more granular tracking\n            entities.add(condition.entity);\n          } else {\n            // Treat as regular entity if DataSource not found\n            entities.add(condition.entity);\n          }\n        } else {\n          // Regular Home Assistant entity\n          entities.add(condition.entity);\n        }\n      }\n\n      // Entity attribute reference (e.g., \"sensor.temp.state\")\n      if (condition.entity_attr) {\n        const entityId = condition.entity_attr.split('.')[0];\n        entities.add(entityId);\n      }\n\n      // Map range condition\n      if (condition.map_range_cond?.entity) {\n        entities.add(condition.map_range_cond.entity);\n      }\n\n      // Value map references in rule conditions\n      if (condition.value_map?.entity) {\n        entities.add(condition.value_map.entity);\n      }\n    });\n\n    return Array.from(entities);\n  }\n\n  markEntitiesDirty(changedEntityIds) {\n    if (!Array.isArray(changedEntityIds)) {\n      changedEntityIds = [changedEntityIds];\n    }\n\n    let affectedRules = 0;\n\n    changedEntityIds.forEach(entityId => {\n      // Direct entity/DataSource rule matches\n      const rules = this.dependencyIndex.entityToRules.get(entityId);\n      if (rules) {\n        rules.forEach(ruleId => {\n          if (!this.dirtyRules.has(ruleId)) {\n            this.dirtyRules.add(ruleId);\n            affectedRules++;\n          }\n        });\n      }\n\n      // Handle DataSource change propagation\n      // If a DataSource changes, mark rules that depend on its transformations/aggregations\n      if (this.dataSourceManager?.getSource(entityId)) {\n        // Find rules that depend on this DataSource's transformations/aggregations\n        for (const [fullRef, ruleSet] of this.dependencyIndex.entityToRules) {\n          if (fullRef.startsWith(`${entityId}.`)) {\n            ruleSet.forEach(ruleId => {\n              if (!this.dirtyRules.has(ruleId)) {\n                this.dirtyRules.add(ruleId);\n                affectedRules++;\n              }\n            });\n          }\n        }\n      }\n    });\n\n    perfCount('rules.dirty.entities', changedEntityIds.length);\n    perfCount('rules.dirty.affected', affectedRules);\n\n    return affectedRules;\n  }\n\n  markAllDirty() {\n    this.dirtyRules.clear();\n    this.rules.forEach(rule => {\n      if (rule.id) {\n        this.dirtyRules.add(rule.id);\n      }\n    });\n    perfCount('rules.dirty.all', this.dirtyRules.size);\n  }\n\n  evaluateDirty(context = {}) {\n    return perfTime('rules.evaluate', () => {\n      let { getEntity } = context;\n\n      // NEW: Use DataSourceManager's enhanced getEntity if available\n      if (!getEntity && this.dataSourceManager) {\n        getEntity = (entityId) => {\n          // Check if this is a DataSource reference\n          if (entityId.includes('.') && this.dataSourceManager) {\n            const value = this.resolveDataSourceValue(entityId);\n            if (value !== null) {\n              // Return entity-like object for DataSource values\n              return {\n                entity_id: entityId,\n                state: String(value),\n                attributes: {}\n              };\n            }\n          }\n\n          // Try DataSourceManager's getEntity method\n          if (this.dataSourceManager.getEntity) {\n            const entity = this.dataSourceManager.getEntity(entityId);\n            if (entity) return entity;\n          }\n\n          // Fallback: try entity index directly\n          if (this.dataSourceManager.entityIndex) {\n            const entity = this.dataSourceManager.entityIndex.get(entityId);\n            if (entity) return entity;\n          }\n\n          return null;\n        };\n      }\n\n      if (!getEntity || typeof getEntity !== 'function') {\n        console.warn('[RulesEngine] evaluateDirty called without getEntity function and no DataSourceManager available');\n        return this.createEmptyResult();\n      }\n\n      const totalDirty = this.dirtyRules.size;\n      const results = [];\n      const processedRules = new Set();\n\n      // Sort dirty rules by priority (higher first)\n      const dirtyRulesArray = Array.from(this.dirtyRules)\n        .map(ruleId => this.rulesById.get(ruleId))\n        .filter(rule => rule)\n        .sort((a, b) => (b.priority || 0) - (a.priority || 0));\n\n      dirtyRulesArray.forEach(rule => {\n        if (processedRules.has(rule.id)) return;\n\n        const result = this.evaluateRule(rule, getEntity);\n        processedRules.add(rule.id);\n\n        // Cache evaluation result\n        this.lastEvaluation.set(rule.id, {\n          matched: result.matched,\n          timestamp: Date.now(),\n          conditions: result.conditions\n        });\n\n        if (result.matched) {\n          results.push(result);\n          this.evalCounts.matched++;\n        }\n\n        // Remove from dirty set\n        this.dirtyRules.delete(rule.id);\n      });\n\n      // Performance tracking\n      this.evalCounts.total += totalDirty;\n      this.evalCounts.dirty += totalDirty;\n      this.evalCounts.skipped += (this.rules.length - totalDirty);\n\n      perfCount('rules.eval.total', totalDirty);\n      perfCount('rules.eval.matched', results.length);\n      perfCount('rules.eval.skipped', this.rules.length - totalDirty);\n\n      return this.aggregateResults(results);\n    });\n  }\n\n  evaluateRule(rule, getEntity) {\n    const startTime = performance.now();\n\n    try {\n      const conditions = this.evaluateConditions(rule.when, getEntity);\n      const matched = this.determineMatch(rule.when, conditions);\n      const evaluationTime = performance.now() - startTime;\n\n      const result = {\n        ruleId: rule.id,\n        priority: rule.priority || 0,\n        matched,\n        conditions,\n        rule,\n        evaluationTime\n      };\n\n      // Add trace entry\n      this.traceBuffer.addTrace(\n        rule.id,\n        matched,\n        conditions,\n        evaluationTime,\n        {\n          priority: rule.priority || 0,\n          conditionCount: this.countConditions(rule.when),\n          entityRefs: this.dependencyIndex?.ruleToEntities.get(rule.id) || []\n        }\n      );\n\n      if (matched && rule.apply) {\n        result.overlayPatches = rule.apply.overlays || [];\n        result.profilesAdd = rule.apply.profiles_add || [];\n        result.profilesRemove = rule.apply.profiles_remove || [];\n        result.animations = rule.apply.animations || [];\n        result.stopAfter = rule.stop === true;\n      }\n\n      return result;\n\n    } catch (error) {\n      const evaluationTime = performance.now() - startTime;\n\n      // Trace error\n      this.traceBuffer.addTrace(\n        rule.id,\n        false,\n        {},\n        evaluationTime,\n        { error: error.message }\n      );\n\n      console.warn(`[RulesEngine] Error evaluating rule ${rule.id}:`, error);\n      return {\n        ruleId: rule.id,\n        matched: false,\n        error: error.message,\n        evaluationTime\n      };\n    }\n  }\n\n  evaluateConditions(when, getEntity) {\n    if (!when) return {};\n\n    const results = {};\n\n    // Evaluate all conditions\n    if (when.all) {\n      results.all = when.all.map(condition => this.evaluateCondition(condition, getEntity));\n    }\n\n    // Evaluate any conditions\n    if (when.any) {\n      results.any = when.any.map(condition => this.evaluateCondition(condition, getEntity));\n    }\n\n    return results;\n  }\n\n  evaluateCondition(condition, getEntity) {\n    const result = {\n      condition,\n      matched: false,\n      value: null,\n      error: null\n    };\n\n    try {\n      // Entity state condition (supports both HA entities and DataSource references)\n      if (condition.entity) {\n        // Check if this is a DataSource reference (contains dots) - handle it directly\n        if (condition.entity.includes('.') && this.dataSourceManager) {\n          const dataSourceValue = this.resolveDataSourceValue(condition.entity);\n          if (dataSourceValue === null) {\n            result.error = `DataSource ${condition.entity} not found or no data`;\n            return result;\n          }\n\n          result.value = dataSourceValue;\n\n          // Numeric comparisons for DataSource values\n          if (condition.above !== undefined) {\n            const numValue = parseFloat(dataSourceValue);\n            result.matched = !isNaN(numValue) && numValue > condition.above;\n          } else if (condition.below !== undefined) {\n            const numValue = parseFloat(dataSourceValue);\n            result.matched = !isNaN(numValue) && numValue < condition.below;\n          } else if (condition.equals !== undefined) {\n            result.matched = dataSourceValue == condition.equals;\n          } else {\n            result.matched = true; // DataSource exists and has data\n          }\n\n          return result; // Return immediately for DataSource conditions\n        } else {\n          // Standard Home Assistant entity\n          const entity = getEntity(condition.entity);\n          if (!entity) {\n            result.error = `Entity ${condition.entity} not found`;\n            return result;\n          }\n\n          result.value = entity.state;\n\n          // Numeric comparisons for entity state\n          if (condition.above !== undefined) {\n            const numValue = parseFloat(entity.state);\n            result.matched = !isNaN(numValue) && numValue > condition.above;\n          } else if (condition.below !== undefined) {\n            const numValue = parseFloat(entity.state);\n            result.matched = !isNaN(numValue) && numValue < condition.below;\n          } else if (condition.equals !== undefined) {\n            result.matched = entity.state == condition.equals;\n          } else {\n            result.matched = true; // Entity exists\n          }\n        }\n      }\n\n      // Time between condition\n      if (condition.time_between) {\n        result.matched = this.evaluateTimeBetween(condition.time_between);\n        result.value = new Date().toTimeString().substring(0, 5);\n      }\n\n      // Map range condition\n      if (condition.map_range_cond) {\n        result.matched = this.evaluateMapRangeCondition(condition.map_range_cond, getEntity);\n      }\n\n    } catch (error) {\n      result.error = error.message;\n    }\n\n    return result;\n  }\n\n  evaluateTimeBetween(timeRange) {\n    const [startTime, endTime] = timeRange.split('-');\n    const now = new Date();\n    const currentTime = now.getHours() * 60 + now.getMinutes();\n\n    const [startHour, startMin] = startTime.split(':').map(Number);\n    const [endHour, endMin] = endTime.split(':').map(Number);\n\n    const start = startHour * 60 + startMin;\n    const end = endHour * 60 + endMin;\n\n    if (start <= end) {\n      return currentTime >= start && currentTime <= end;\n    } else {\n      // Crosses midnight\n      return currentTime >= start || currentTime <= end;\n    }\n  }\n\n  evaluateMapRangeCondition(mapRangeCondition, getEntity) {\n    const { entity, input, output, above, below, equals } = mapRangeCondition;\n\n    const entityObj = getEntity(entity);\n    if (!entityObj) return false;\n\n    const rawValue = parseFloat(entityObj.state);\n    if (isNaN(rawValue)) return false;\n\n    // Map the value\n    const mappedValue = this.mapRange(rawValue, input, output);\n\n    // Apply condition on mapped value\n    if (above !== undefined) return mappedValue > above;\n    if (below !== undefined) return mappedValue < below;\n    if (equals !== undefined) return Math.abs(mappedValue - equals) < 0.001;\n\n    return false;\n  }\n\n  mapRange(value, inputRange, outputRange) {\n    const [inMin, inMax] = inputRange;\n    const [outMin, outMax] = outputRange;\n\n    // Clamp input value\n    const clampedValue = Math.max(inMin, Math.min(inMax, value));\n\n    // Linear interpolation\n    const ratio = (clampedValue - inMin) / (inMax - inMin);\n    return outMin + ratio * (outMax - outMin);\n  }\n\n  /**\n   * Resolve a DataSource reference to its current value\n   * @param {string} dataSourceRef - Reference like 'source.transformations.key' or 'source.aggregations.key'\n   * @returns {any|null} Resolved value or null if not found\n   */\n  resolveDataSourceValue(dataSourceRef) {\n    try {\n      // Parse the DataSource reference\n      const parts = dataSourceRef.split('.');\n      const sourceName = parts[0];\n\n      // Get the DataSource\n      const dataSource = this.dataSourceManager.getSource(sourceName);\n      if (!dataSource) {\n        return null;\n      }\n\n      const currentData = dataSource.getCurrentData();\n      if (!currentData) {\n        return null;\n      }\n\n      // Handle simple DataSource reference (just the source name)\n      if (parts.length === 1) {\n        return currentData.v;\n      }\n\n      // Handle enhanced DataSource references\n      if (parts.length >= 3) {\n        const dataType = parts[1]; // 'transformations' or 'aggregations'\n        const dataKey = parts.slice(2).join('.'); // Support nested keys\n\n        if (dataType === 'transformations' && currentData.transformations) {\n          return currentData.transformations[dataKey];\n        } else if (dataType === 'aggregations' && currentData.aggregations) {\n          const aggData = currentData.aggregations[dataKey];\n\n          // Handle aggregation objects with multiple properties\n          if (typeof aggData === 'object' && aggData !== null) {\n            // Return the most relevant value from aggregation\n            if (aggData.avg !== undefined) return aggData.avg;\n            if (aggData.value !== undefined) return aggData.value;\n            if (aggData.last !== undefined) return aggData.last;\n            if (aggData.current !== undefined) return aggData.current;\n            return aggData; // Return the object itself if no standard property\n          }\n\n          return aggData;\n        }\n      }\n\n      return null;\n    } catch (error) {\n      console.warn(`[RulesEngine] Error resolving DataSource reference '${dataSourceRef}':`, error);\n      return null;\n    }\n  }  determineMatch(when, conditions) {\n    if (!when) return false;\n\n    let allMatch = true;\n    let anyMatch = false;\n\n    // Check all conditions\n    if (when.all && conditions.all) {\n      allMatch = conditions.all.every(result => result.matched);\n    }\n\n    // Check any conditions\n    if (when.any && conditions.any) {\n      anyMatch = conditions.any.some(result => result.matched);\n    }\n\n    // Determine final match\n    if (when.all && when.any) {\n      return allMatch && anyMatch;\n    } else if (when.all) {\n      return allMatch;\n    } else if (when.any) {\n      return anyMatch;\n    }\n\n    return false;\n  }\n\n  aggregateResults(ruleResults) {\n    const aggregated = {\n      overlayPatches: [],\n      profilesAdd: [],\n      profilesRemove: [],\n      animations: []\n    };\n\n    // Group results by target overlays for stop semantics\n    const overlayGroups = new Map();\n\n    ruleResults.forEach(result => {\n      if (result.overlayPatches) {\n        result.overlayPatches.forEach(patch => {\n          if (!overlayGroups.has(patch.id)) {\n            overlayGroups.set(patch.id, []);\n          }\n          overlayGroups.get(patch.id).push({\n            ...result,\n            overlayPatch: patch\n          });\n        });\n      }\n    });\n\n    // Process each overlay group with stop semantics\n    overlayGroups.forEach((rules, overlayId) => {\n      this.processOverlayRules(overlayId, rules, aggregated);\n    });\n\n    // Add non-overlay results (profiles, animations)\n    ruleResults\n      .sort((a, b) => (b.priority || 0) - (a.priority || 0))\n      .forEach(result => {\n        if (result.profilesAdd) {\n          aggregated.profilesAdd.push(...result.profilesAdd);\n        }\n        if (result.profilesRemove) {\n          aggregated.profilesRemove.push(...result.profilesRemove);\n        }\n        if (result.animations) {\n          aggregated.animations.push(...result.animations);\n        }\n      });\n\n    return aggregated;\n  }\n\n  processOverlayRules(overlayId, rules, aggregated) {\n    // Sort by priority (higher first)\n    const sortedRules = rules.sort((a, b) => (b.priority || 0) - (a.priority || 0));\n\n    let shouldStop = false;\n\n    sortedRules.forEach(result => {\n      if (shouldStop) {\n        // Rule was stopped, add to trace\n        this.traceBuffer.addTrace(\n          result.ruleId,\n          result.matched,\n          result.conditions,\n          result.evaluationTime,\n          {\n            stopped: true,\n            stoppedBy: overlayId,\n            reason: 'stop_semantics'\n          }\n        );\n\n        perfCount('rules.stopped', 1);\n        return;\n      }\n\n      // Apply the rule result\n      if (result.overlayPatch) {\n        aggregated.overlayPatches.push(result.overlayPatch);\n      }\n\n      // Check for stop condition\n      if (result.stopAfter) {\n        shouldStop = true;\n        perfCount('rules.stop.triggered', 1);\n\n        // Add stop trace\n        this.traceBuffer.addTrace(\n          result.ruleId,\n          result.matched,\n          result.conditions,\n          result.evaluationTime,\n          {\n            stopTriggered: true,\n            affectedOverlay: overlayId\n          }\n        );\n      }\n    });\n  }\n\n  countConditions(when) {\n    if (!when) return 0;\n    return (when.all?.length || 0) + (when.any?.length || 0);\n  }\n\n  createEmptyResult() {\n    return {\n      overlayPatches: [],\n      profilesAdd: [],\n      profilesRemove: [],\n      animations: []\n    };\n  }\n\n  // Enhanced debug and introspection methods\n  getTrace() {\n    const baseTrace = {\n      totalRules: this.rules.length,\n      dirtyRules: this.dirtyRules.size,\n      lastEvaluations: Object.fromEntries(this.lastEvaluation),\n      evalCounts: { ...this.evalCounts },\n      dependencyStats: {\n        entitiesTracked: this.dependencyIndex?.entityToRules.size || 0,\n        avgRulesPerEntity: this.dependencyIndex ?\n          Array.from(this.dependencyIndex.entityToRules.values()).reduce((sum, rules) => sum + rules.size, 0) / this.dependencyIndex.entityToRules.size : 0\n      }\n    };\n\n    // Add trace buffer stats\n    const traceStats = this.traceBuffer.getStats();\n    baseTrace.traceStats = traceStats;\n\n    return baseTrace;\n  }\n\n  getRuleTrace(ruleId, limit = 20) {\n    return this.traceBuffer.getRuleHistory(ruleId, limit);\n  }\n\n  getRecentMatches(timeWindow = 60000) {\n    return this.traceBuffer.getMatchedRules(timeWindow);\n  }\n\n  exportTrace(options = {}) {\n    return this.traceBuffer.exportTraces(options);\n  }\n\n  clearTrace() {\n    this.traceBuffer.clear();\n    perfCount('rules.trace.cleared', 1);\n  }\n\n  /**\n   * Set the DataSourceManager reference (for cases where it wasn't available during construction)\n   * @param {Object} dataSourceManager - DataSourceManager instance\n   */\n  setDataSourceManager(dataSourceManager) {\n    console.log(`[RulesEngine] Setting DataSourceManager:`, dataSourceManager);\n    this.dataSourceManager = dataSourceManager;\n\n    // Rebuild dependency index to include DataSource references\n    this.buildDependencyIndex();\n\n    // Mark all rules dirty since DataSource conditions might now be evaluable\n    this.markAllDirty();\n\n    console.log(`[RulesEngine] DataSourceManager set, rebuilding dependencies and marking rules dirty`);\n  }\n\n  getRuleDependencies(ruleId) {\n    return this.dependencyIndex?.ruleToEntities.get(ruleId) || [];\n  }\n\n  getEntityDependents(entityId) {\n    return Array.from(this.dependencyIndex?.entityToRules.get(entityId) || []);\n  }\n}\n\n// Helper function for applying overlay patches from rule results\nexport function applyOverlayPatches(overlays, patches) {\n  if (!patches || patches.length === 0) {\n    return overlays;\n  }\n\n  console.log('[RulesEngine]  Applying overlay patches:', {\n    overlayCount: overlays.length,\n    patchCount: patches.length,\n    patches: patches.map(p => ({ id: p.id, styleKeys: Object.keys(p.style || {}) }))\n  });\n\n  const patchMap = new Map(patches.map(patch => [patch.id, patch]));\n\n  return overlays.map(overlay => {\n    const patch = patchMap.get(overlay.id);\n    if (!patch) {\n      return overlay;\n    }\n\n    console.log('[RulesEngine]  Applying patch to overlay:', {\n      id: overlay.id,\n      originalStyle: overlay.style,\n      originalFinalStyle: overlay.finalStyle,\n      patch: patch.style\n    });\n\n    // FIXED: Apply patches to BOTH style and finalStyle\n    const patchedOverlay = {\n      ...overlay,\n      style: {\n        ...overlay.style,\n        ...patch.style\n      },\n      finalStyle: {\n        ...(overlay.finalStyle || overlay.style || {}),\n        ...patch.style\n      }\n    };\n\n    console.log('[RulesEngine]  Patched overlay result:', {\n      id: patchedOverlay.id,\n      newStyle: patchedOverlay.style,\n      newFinalStyle: patchedOverlay.finalStyle\n    });\n\n    return patchedOverlay;\n  });\n}\n","/**\n * @file DebugManager.js\n * @description Centralized debug state manager with proper initialization ordering\n */\nexport class DebugManager {\n  constructor() {\n    /** @type {Object} Debug feature states */\n    this.state = {\n      anchors: false,\n      bounding_boxes: false,\n      routing: false,\n      performance: false,\n      scale: 1.0\n    };\n\n    /** @type {Set<Function>} Change callbacks */\n    this.callbacks = new Set();\n\n    /** @type {boolean} Manager initialization state */\n    this.initialized = false;\n\n    /** @type {boolean} RouterCore readiness state */\n    this.routerReady = false;\n\n    /** @type {Array<Function>} Actions queued before router ready */\n    this.pendingRouterActions = [];\n\n    /** @type {Array<Function>} Actions queued before init */\n    this.pendingInitActions = [];\n\n    // Add debouncing properties\n    this._notifyTimeout = null;\n    this._pendingNotification = null;\n  }\n\n  /**\n   * Initialize debug manager with config\n   * @param {Object} debugConfig - Debug configuration from MSD config\n   */\n  init(debugConfig = {}) {\n    // REDUCED: Only log if debug is actually enabled\n    if (debugConfig && Object.keys(debugConfig).length > 0) {\n      console.log('[DebugManager] Initializing with config:', debugConfig);\n    }\n\n    // FIXED: Apply initial config - handle both flat and nested structures\n    if (debugConfig.overlays) {\n      // Handle nested structure: debug.overlays.anchors\n      Object.keys(this.state).forEach(key => {\n        if (key !== 'scale' && debugConfig.overlays[key] !== undefined) {\n          this.state[key] = debugConfig.overlays[key];\n        }\n      });\n    } else {\n      // Handle flat structure: debug.anchors\n      Object.keys(this.state).forEach(key => {\n        if (debugConfig[key] !== undefined) {\n          this.state[key] = debugConfig[key];\n        }\n      });\n    }\n\n    // Handle scale separately\n    if (debugConfig.scale !== undefined) {\n      this.state.scale = debugConfig.scale;\n    }\n\n    this.initialized = true;\n\n    // REDUCED: Only log state if features are enabled\n    const hasEnabledFeatures = this.isAnyEnabled();\n    if (hasEnabledFeatures) {\n      console.log('[DebugManager] State after config init:', this.state);\n    }\n\n    // Process pending init actions\n    this.pendingInitActions.forEach(action => action());\n    this.pendingInitActions = [];\n\n    // If router is already ready, process router actions too\n    if (this.routerReady) {\n      this.pendingRouterActions.forEach(action => action());\n      this.pendingRouterActions = [];\n    }\n\n    this._scheduleNotification('init');\n  }\n\n  /**\n   * Mark RouterCore as ready and process pending router-dependent actions\n   */\n  markRouterReady() {\n    this.routerReady = true;\n\n    // Process pending router actions if we're initialized\n    if (this.initialized) {\n      this.pendingRouterActions.forEach(action => action());\n      this.pendingRouterActions = [];\n      this._scheduleNotification('router-ready');\n    }\n  }\n\n  /**\n   * Enable a debug feature\n   * @param {string} feature - Feature name (anchors, bounding_boxes, routing, performance)\n   */\n  enable(feature) {\n    this._setFeature(feature, true);\n  }\n\n  /**\n   * Disable a debug feature\n   * @param {string} feature - Feature name\n   */\n  disable(feature) {\n    this._setFeature(feature, false);\n  }\n\n  /**\n   * Toggle a debug feature\n   * @param {string} feature - Feature name\n   */\n  toggle(feature) {\n    this._setFeature(feature, !this.state[feature]);\n  }\n\n  /**\n   * Set debug scale\n   * @param {number} scale - Scale multiplier (0.1 - 3.0)\n   */\n  setScale(scale) {\n    const action = () => {\n      const newScale = Math.max(0.1, Math.min(3.0, Number(scale) || 1));\n      if (newScale !== this.state.scale) {\n        this.state.scale = newScale;\n        this._scheduleNotification('scale', { scale: newScale });\n      }\n    };\n\n    this._executeWhenReady(action, false); // Scale doesn't need router\n  }\n\n  /**\n   * Get current debug state snapshot (silent - no console output)\n   * @returns {Object} Current state\n   */\n  getSnapshot() {\n    return {\n      ...this.state,\n      enabled: this.isAnyEnabled(),\n      initialized: this.initialized,\n      routerReady: this.routerReady\n    };\n  }\n\n  /**\n   * Get status with console output (for manual debugging)\n   * @returns {Object} Current state\n   */\n  status() {\n    const snapshot = this.getSnapshot();\n    console.table(snapshot);\n    return snapshot;\n  }\n\n  /**\n   * Check if any debug feature is enabled\n   * @returns {boolean} True if any feature enabled\n   */\n  isAnyEnabled() {\n    return ['anchors', 'bounding_boxes', 'routing', 'performance']\n      .some(feature => this.state[feature]);\n  }\n\n  /**\n   * Check if routing debug can be rendered\n   * @returns {boolean} True if routing debug is ready\n   */\n  canRenderRouting() {\n    return this.state.routing && this.routerReady;\n  }\n\n  /**\n   * Register callback for state changes\n   * @param {Function} callback - Change callback function\n   * @returns {Function} Unregister function\n   */\n  onChange(callback) {\n    this.callbacks.add(callback);\n    return () => this.callbacks.delete(callback);\n  }\n\n  /**\n   * Enable multiple features at once\n   * @param {string[]} features - Array of feature names\n   */\n  enableMultiple(features) {\n    features.forEach(feature => this.enable(feature));\n  }\n\n  /**\n   * Disable multiple features at once\n   * @param {string[]} features - Array of feature names\n   */\n  disableMultiple(features) {\n    features.forEach(feature => this.disable(feature));\n  }\n\n  /**\n   * Get available debug features\n   * @returns {string[]} Array of feature names\n   */\n  getAvailableFeatures() {\n    return Object.keys(this.state).filter(key => key !== 'scale');\n  }\n\n  /**\n   * Check if a specific feature is enabled\n   * @param {string} feature - Feature name\n   * @returns {boolean} True if enabled\n   */\n  isEnabled(feature) {\n    return Boolean(this.state[feature]);\n  }\n\n  /**\n   * Schedule debounced notification to prevent excessive callbacks\n   * @param {string} type - Change type\n   * @param {Object} details - Change details\n   * @private\n   */\n  _scheduleNotification(type, details) {\n    // Clear existing timeout\n    if (this._notifyTimeout) {\n      clearTimeout(this._notifyTimeout);\n    }\n\n    // Store pending notification\n    this._pendingNotification = { type, details };\n\n    // Schedule debounced notification (~60fps)\n    this._notifyTimeout = setTimeout(() => {\n      if (this._pendingNotification) {\n        this._notifyChange(this._pendingNotification.type, this._pendingNotification.details);\n        this._pendingNotification = null;\n      }\n      this._notifyTimeout = null;\n    }, 16);\n  }\n\n  /**\n   * Notify callbacks of state changes\n   * @param {string} type - Change type\n   * @param {Object} details - Change details\n   * @private\n   */\n  _notifyChange(type, details = {}) {\n    const event = {\n      type,\n      details,\n      snapshot: this.getSnapshot(),\n      timestamp: Date.now()\n    };\n\n    this.callbacks.forEach(callback => {\n      try {\n        callback(event);\n      } catch (error) {\n        console.warn('[DebugManager] Callback error:', error);\n      }\n    });\n  }\n\n  /**\n   * Set feature state with proper queuing\n   * @param {string} feature - Feature name\n   * @param {boolean} enabled - Enable state\n   * @private\n   */\n  _setFeature(feature, enabled) {\n    if (!this.state.hasOwnProperty(feature) || feature === 'scale') {\n      console.warn(`[DebugManager] Invalid debug feature: ${feature}`);\n      return;\n    }\n\n    const action = () => {\n      if (this.state[feature] !== enabled) {\n        console.log(`[DebugManager] Setting ${feature} to ${enabled}`);\n        this.state[feature] = enabled;\n        this._scheduleNotification('feature', { feature, enabled });\n\n        // FIXED: Trigger immediate re-render when feature state changes\n        setTimeout(() => {\n          try {\n            const pipelineInstance = window.__msdDebug?.pipelineInstance;\n            if (pipelineInstance?.reRender) {\n              console.log(`[DebugManager] Auto re-render after ${feature} ${enabled ? 'enable' : 'disable'}`);\n              pipelineInstance.reRender();\n            }\n          } catch (error) {\n            console.warn('[DebugManager] Auto re-render failed:', error);\n          }\n        }, 5);\n      }\n    };\n\n    // Routing feature needs router to be ready\n    const needsRouter = feature === 'routing';\n    this._executeWhenReady(action, needsRouter);\n  }\n\n  /**\n   * Execute action when dependencies are ready\n   * @param {Function} action - Action to execute\n   * @param {boolean} needsRouter - Whether action needs RouterCore\n   * @private\n   */\n  _executeWhenReady(action, needsRouter = false) {\n    if (!this.initialized) {\n      this.pendingInitActions.push(() => this._executeWhenReady(action, needsRouter));\n      return;\n    }\n\n    if (needsRouter && !this.routerReady) {\n      this.pendingRouterActions.push(action);\n      return;\n    }\n\n    action();\n  }\n}","/**\n * Base Overlay Update System - Unified interface for dynamic overlay updates\n * Provides consistent template processing and DataSource integration across all overlay types\n */\n\nexport class BaseOverlayUpdater {\n  constructor(systemsManager) {\n    this.systemsManager = systemsManager;\n    this.overlayUpdaters = new Map();\n\n    // Register overlay-specific updaters\n    this._registerUpdaters();\n  }\n\n  /**\n   * Register overlay-specific update handlers\n   * @private\n   */\n  _registerUpdaters() {\n    // Text overlay updater with template processing\n    this.overlayUpdaters.set('text', {\n      needsUpdate: (overlay, sourceData) => this._textNeedsUpdate(overlay, sourceData),\n      update: (overlayId, overlay, sourceData) => this._updateTextOverlay(overlayId, overlay, sourceData),\n      hasTemplates: (overlay) => this._hasTemplateContent(overlay)\n    });\n\n    // Status grid updater (future implementation)\n    this.overlayUpdaters.set('status_grid', {\n      needsUpdate: (overlay, sourceData) => this._statusGridNeedsUpdate(overlay, sourceData),\n      update: (overlayId, overlay, sourceData) => this._updateStatusGrid(overlayId, overlay, sourceData),\n      hasTemplates: (overlay) => this._hasTemplateContent(overlay)\n    });\n\n    // Sparkline updater with enhanced synchronization\n    this.overlayUpdaters.set('sparkline', {\n      needsUpdate: (overlay, sourceData) => true, // Always update sparklines for data synchronization\n      update: (overlayId, overlay, sourceData) => this._updateSparkline(overlayId, overlay, sourceData),\n      hasTemplates: () => false // Sparklines don't use templates\n    });\n\n    // Generic updater for future overlay types\n    this.overlayUpdaters.set('default', {\n      needsUpdate: (overlay, sourceData) => this._hasTemplateContent(overlay),\n      update: (overlayId, overlay, sourceData) => this._updateGenericOverlay(overlayId, overlay, sourceData),\n      hasTemplates: (overlay) => this._hasTemplateContent(overlay)\n    });\n  }\n\n  /**\n   * Main entry point for updating overlays when DataSource changes\n   * @param {Array} changedIds - Entity IDs that changed\n   * @public\n   */\n  updateOverlaysForDataSourceChanges(changedIds) {\n    console.log('[BaseOverlayUpdater] Checking overlays for DataSource changes:', changedIds);\n\n    const resolvedModel = this.systemsManager.modelBuilder?.getResolvedModel?.();\n    if (!resolvedModel?.overlays) {\n      return;\n    }\n\n    // Check each overlay type\n    resolvedModel.overlays.forEach(overlay => {\n      const updater = this.overlayUpdaters.get(overlay.type) || this.overlayUpdaters.get('default');\n\n      if (updater.hasTemplates(overlay)) {\n        const needsUpdate = this._overlayReferencesChangedDataSources(overlay, changedIds);\n\n        if (needsUpdate) {\n          const updatedDataSourceId = this._findDataSourceForEntity(changedIds[0]);\n          if (updatedDataSourceId) {\n            const dataSource = this.systemsManager.dataSourceManager.getSource(updatedDataSourceId);\n            if (dataSource) {\n              const currentData = dataSource.getCurrentData();\n\n              console.log(`[BaseOverlayUpdater] Updating ${overlay.type} overlay ${overlay.id}`);\n              updater.update(overlay.id, overlay, currentData);\n            }\n          }\n        }\n      }\n    });\n  }\n\n  /**\n   * Check if overlay content contains template references\n   * @private\n   */\n  _hasTemplateContent(overlay) {\n    // Check main overlay content\n    const mainContent = overlay._raw?.content || overlay.content || overlay.text ||\n                       overlay._raw?.value_format || overlay.value_format || '';\n\n    if (mainContent && typeof mainContent === 'string' && mainContent.includes('{')) {\n      return true;\n    }\n\n    // For status grids, also check cell configurations - ENHANCED to check multiple sources\n    if (overlay.type === 'status_grid') {\n      const cellsConfig = overlay.cells || overlay._raw?.cells || overlay.raw?.cells;\n      if (cellsConfig && Array.isArray(cellsConfig)) {\n        return cellsConfig.some(cell => {\n          const cellContent = cell.content || cell.label || cell.value_format || '';\n          return cellContent && typeof cellContent === 'string' && cellContent.includes('{');\n        });\n      }\n    }\n\n    return false;\n  }\n\n  /**\n   * Check if overlay references any of the changed DataSources\n   * @private\n   */\n  _overlayReferencesChangedDataSources(overlay, changedIds) {\n    // Check main overlay content\n    const mainContent = overlay._raw?.content || overlay.content || overlay.text || '';\n\n    let hasReference = false;\n\n    // Check main content\n    if (mainContent && this._contentReferencesChangedDataSources(mainContent, changedIds)) {\n      hasReference = true;\n    }\n\n    // For status grids, also check cell configurations - ENHANCED to check multiple sources\n    if (overlay.type === 'status_grid') {\n      const cellsConfig = overlay.cells || overlay._raw?.cells || overlay.raw?.cells;\n      if (cellsConfig && Array.isArray(cellsConfig)) {\n        hasReference = hasReference || cellsConfig.some(cell => {\n          const cellContent = cell.content || cell.label || cell.value_format || '';\n          return this._contentReferencesChangedDataSources(cellContent, changedIds);\n        });\n      }\n    }\n\n    return hasReference;\n  }\n\n  /**\n   * Check if content string references any of the changed DataSources\n   * @private\n   */\n  _contentReferencesChangedDataSources(content, changedIds) {\n    if (!content || typeof content !== 'string') return false;\n\n    return changedIds.some(entityId => {\n      if (this.systemsManager.dataSourceManager) {\n        for (const [sourceId, source] of this.systemsManager.dataSourceManager.sources || new Map()) {\n          if (source.cfg && source.cfg.entity === entityId && content.includes(sourceId)) {\n            return true;\n          }\n        }\n      }\n      return false;\n    });\n  }  /**\n   * Text overlay specific update logic\n   * @private\n   */\n  _updateTextOverlay(overlayId, overlay, sourceData) {\n    if (this.systemsManager.renderer && this.systemsManager.renderer.updateTextOverlay) {\n      this.systemsManager.renderer.updateTextOverlay(overlayId, sourceData);\n    }\n  }\n\n  /**\n   * Status grid update logic with template processing\n   * @private\n   */\n    /**\n   * Status grid update logic with template processing\n   * @private\n   */\n  _updateStatusGrid(overlayId, overlay, sourceData) {\n    console.log(`[BaseOverlayUpdater] Updating status grid ${overlayId} with template processing`);\n\n    // Import StatusGridRenderer for template processing\n    import('./StatusGridRenderer.js').then(({ StatusGridRenderer }) => {\n      const renderer = new StatusGridRenderer();\n\n      // Process cell templates with new DataSource data\n      const updatedCells = renderer.updateCellsWithData(overlay, overlay.finalStyle || {}, sourceData);\n\n      console.log(`[BaseOverlayUpdater] Processed ${updatedCells.length} cells for status grid ${overlayId}`);\n\n      // Update the status grid in the renderer\n      if (this.systemsManager.renderer && this.systemsManager.renderer.updateStatusGridWithTemplates) {\n        this.systemsManager.renderer.updateStatusGridWithTemplates(overlayId, sourceData);\n      } else if (this.systemsManager.renderer && this.systemsManager.renderer.updateStatusGrid) {\n        this.systemsManager.renderer.updateStatusGrid(overlayId, updatedCells);\n      } else {\n        console.log(`[BaseOverlayUpdater] Status grid update method not yet implemented in AdvancedRenderer`);\n        // For now, trigger a general overlay update\n        if (this.systemsManager.renderer && this.systemsManager.renderer.updateOverlayData) {\n          this.systemsManager.renderer.updateOverlayData(overlayId, sourceData);\n        }\n      }\n    }).catch(error => {\n      console.error(`[BaseOverlayUpdater] Failed to import StatusGridRenderer:`, error);\n    });\n  }\n\n  /**\n   * Sparkline update logic with enhanced synchronization\n   * @private\n   */\n  _updateSparkline(overlayId, overlay, sourceData) {\n    console.log(`[BaseOverlayUpdater] Updating sparkline ${overlayId} with enhanced synchronization`);\n\n    if (this.systemsManager.renderer && this.systemsManager.renderer.updateSparklineData) {\n      // Use the enhanced sparkline update method that handles synchronization\n      this.systemsManager.renderer.updateSparklineData(overlayId, sourceData);\n    } else if (this.systemsManager.renderer && this.systemsManager.renderer.updateOverlayData) {\n      this.systemsManager.renderer.updateOverlayData(overlayId, sourceData);\n    }\n  }\n\n  /**\n   * Generic overlay update logic\n   * @private\n   */\n  _updateGenericOverlay(overlayId, overlay, sourceData) {\n    console.log(`[BaseOverlayUpdater] Generic update for ${overlay.type} overlay ${overlayId}`);\n    // Could implement generic template processing here\n  }\n\n  /**\n   * Enhanced overlay update with initial data handling for Status Grid\n   * @private\n   * @param {Object} overlay - Overlay to update\n   * @param {Object} data - Data from DataSource\n   */\n  static _updateOverlayWithData(overlay, data) {\n    const currentTimestamp = Date.now();\n\n    // ENHANCED: Handle initial data differently than ongoing updates\n    const isInitialData = data.historyReady && (!overlay.lastUpdate || overlay.lastUpdate === 0);\n\n    if (isInitialData) {\n      console.log(`[BaseOverlayUpdater]  Processing INITIAL data for ${overlay.type} overlay ${overlay.id}`);\n    }\n\n    // ENHANCED: Update based on overlay type with initial data consideration\n    if (overlay.type === 'text') {\n      TextOverlayRenderer.updateTextOverlay(overlay, data.entity, data.v, currentTimestamp, data.unit_of_measurement);\n      console.log(`[BaseOverlayUpdater]  Updated TEXT overlay ${overlay.id} with value: ${data.v}`);\n\n    } else if (overlay.type === 'status_grid') {\n      // For Status Grid, ensure initial data triggers proper rendering\n      StatusGridRenderer.updateCellsWithData(overlay, data);\n\n      if (isInitialData) {\n        console.log(`[BaseOverlayUpdater]  STATUS GRID ${overlay.id} received initial data - forcing re-render if needed`);\n        // Trigger a re-render to ensure templates are processed with new data\n        overlay._needsRerender = true;\n      }\n\n      console.log(`[BaseOverlayUpdater]  Updated STATUS GRID overlay ${overlay.id} with data from entity: ${data.entity}`);\n\n    } else if (overlay.type === 'sparkline') {\n      SparklineRenderer.updateSparklineData(overlay, data);\n      console.log(`[BaseOverlayUpdater]  Updated SPARKLINE overlay ${overlay.id} with buffer data`);\n\n    } else {\n      // Fallback for other overlay types\n      overlay.data = data;\n      overlay.lastUpdate = currentTimestamp;\n      console.log(`[BaseOverlayUpdater]  Updated ${overlay.type} overlay ${overlay.id} with generic data`);\n    }\n\n    // Set lastUpdate timestamp\n    overlay.lastUpdate = currentTimestamp;\n  }\n\n  /**\n   * Helper methods\n   * @private\n   */\n  _textNeedsUpdate(overlay, sourceData) {\n    return this._hasTemplateContent(overlay);\n  }\n\n  _statusGridNeedsUpdate(overlay, sourceData) {\n    return this._hasTemplateContent(overlay);\n  }\n\n  _findDataSourceForEntity(entityId) {\n    if (this.systemsManager.dataSourceManager) {\n      for (const [sourceId, source] of this.systemsManager.dataSourceManager.sources || new Map()) {\n        if (source.cfg && source.cfg.entity === entityId) {\n          return sourceId;\n        }\n      }\n    }\n    return null;\n  }\n}\n\n// TODO: Replace the specific text overlay update logic in SystemsManager\n// with this generalized BaseOverlayUpdater","import { AdvancedRenderer } from '../renderer/AdvancedRenderer.js';\nimport { MsdDebugRenderer } from '../debug/MsdDebugRenderer.js';\nimport { MsdControlsRenderer } from '../controls/MsdControlsRenderer.js';\nimport { MsdHudManager } from '../hud/MsdHudManager.js';\nimport { DataSourceManager } from '../data/DataSourceManager.js';\nimport { RouterCore } from '../routing/RouterCore.js';\nimport { AnimationRegistry } from '../animation/AnimationRegistry.js';\nimport { RulesEngine } from '../rules/RulesEngine.js';\nimport { DebugManager } from '../debug/DebugManager.js';\nimport { BaseOverlayUpdater } from '../renderer/BaseOverlayUpdater.js';\n\nexport class SystemsManager {\n  constructor() {\n    this.dataSourceManager = null;\n    this.renderer = null;\n    this.debugRenderer = null;\n    this.controlsRenderer = null;\n    this.hudManager = null;\n    this.router = null;\n    this.animRegistry = null;\n    this.rulesEngine = null;\n    this.debugManager = new DebugManager();\n    this.overlayUpdater = null; // ADDED: Unified overlay update system\n    this._renderTimeout = null;\n    this._reRenderCallback = null;\n    this._queuedReRender = false; // ADDED: Flag for queued renders\n    this._debugControlsRendering = false;\n    this.mergedConfig = null; // Store for entity change handler\n    this._originalHass = null;  // Pristine copy for controls\n    this._currentHass = null;   // Working copy for MSD internal processing\n    this._previousRuleStates = new Map(); // ADDED: Track rule states for threshold crossing detection\n\n    // ADDED: Render progress tracking with automatic queue execution\n    this._internalRenderInProgress = false;\n    Object.defineProperty(this, '_renderInProgress', {\n      get() {\n        return this._internalRenderInProgress;\n      },\n      set(value) {\n        const oldValue = this._internalRenderInProgress;\n        this._internalRenderInProgress = value;\n\n        // CRITICAL FIX: Execute queued render when render completes (true  false)\n        if (oldValue === true && value === false && this._queuedReRender) {\n          console.log('[MSD DEBUG]  Executing queued re-render (render completed)');\n          this._queuedReRender = false;\n\n          setTimeout(() => {\n            if (!this._internalRenderInProgress && this._reRenderCallback) {\n              console.log('[MSD DEBUG]  Executing queued re-render callback');\n              try {\n                this._reRenderCallback();\n              } catch (error) {\n                console.error('[MSD DEBUG]  Queued re-render failed:', error);\n              }\n            }\n          }, 50);\n        }\n      }\n    });\n  }\n\n  async initializeSystems(mergedConfig, cardModel, mountEl, hass) {\n    console.log('[MSD v1] Initializing runtime systems');\n\n    // Store config for later use\n    this.mergedConfig = mergedConfig;\n\n    // ADDED: Store HASS context immediately\n    this._currentHass = hass;\n\n    // ENHANCED: Initialize debug manager early with config and better logging\n    const debugConfig = mergedConfig.debug || {};\n    console.log('[MSD v1] Raw debug config from mergedConfig:', debugConfig);\n\n    this.debugManager.init(debugConfig);\n    console.log('[MSD v1] DebugManager initialized with config:', debugConfig);\n\n    // Initialize data source manager FIRST\n    await this._initializeDataSources(hass, mergedConfig);\n\n    // Initialize rules engine AFTER DataSourceManager with proper connection\n    this.rulesEngine = new RulesEngine(mergedConfig.rules, this.dataSourceManager);\n    this.rulesEngine.markAllDirty();\n    this._instrumentRulesEngine(mergedConfig);\n\n    // Connect data source manager to rules engine for entity changes\n    if (this.dataSourceManager) {\n      const entityChangeHandler = this._createEntityChangeHandler();\n\n      // Add entity change listener\n      this.dataSourceManager.addEntityChangeListener(entityChangeHandler);\n      console.log('[MSD v1] DataSourceManager connected to rules engine with entity change handler');\n\n      console.log('[MSD v1] DataSourceManager entity count:', this.dataSourceManager.listIds().length);\n    } else {\n      console.warn('[MSD v1] DataSourceManager not initialized - no data sources configured or HASS unavailable');\n    }\n\n    // Initialize rendering systems\n    this.router = new RouterCore(mergedConfig.routing, cardModel.anchors, cardModel.viewBox);\n    this.renderer = new AdvancedRenderer(mountEl, this.router, this); // ADDED: Pass 'this' as systemsManager\n    this.debugRenderer = new MsdDebugRenderer();\n    this.controlsRenderer = new MsdControlsRenderer(this.renderer);\n\n    // ADDED: Set HASS context on controls renderer immediately if available\n    if (this._currentHass && this.controlsRenderer) {\n      console.log('[MSD v1] Setting initial HASS context on controls renderer');\n      this.controlsRenderer.setHass(this._currentHass);\n    }\n\n    // REPLACED: Initialize unified HUD manager with document.body mounting\n    this.hudManager = new MsdHudManager();\n    this.hudManager.init(mountEl); // Pass mount element for pipeline context, but HUD uses document.body\n\n    // ADDED: Integrate HUD into global debug interface immediately\n    this._setupGlobalHudInterface();\n\n    // Initialize debug renderer with systems manager reference\n    this.debugRenderer.init(this);\n\n    // Mark router as ready for debug system\n    this.debugManager.markRouterReady();\n    console.log('[MSD v1] RouterCore marked ready for debug system');\n\n    // Initialize animation registry\n    this.animRegistry = new AnimationRegistry();\n\n    // ADDED: Initialize unified overlay update system\n    this.overlayUpdater = new BaseOverlayUpdater(this);\n    console.log('[MSD v1] BaseOverlayUpdater initialized for unified overlay updates');\n\n    // CRITICAL FIX: Temporarily disable status indicators to prevent NaN coordinate SVG errors\n    // The TextOverlayRenderer calculates invalid coordinates causing SVG errors and MSD disappearing\n    if (this.mergedConfig && this.mergedConfig.overlays) {\n      console.log('[MSD v1] Applying status indicator fix to prevent NaN coordinate errors');\n      this.mergedConfig.overlays = this.mergedConfig.overlays.map(overlay => {\n        if (overlay && overlay.status_indicator) {\n          console.log(`[MSD v1] DISABLED status indicator for ${overlay.id} to prevent NaN coordinates`);\n          return { ...overlay, status_indicator: false };\n        }\n        return overlay;\n      });\n    }\n\n    console.log('[MSD v1] All systems initialized successfully');\n    return this;\n  }\n\n  setReRenderCallback(callback) {\n    this._reRenderCallback = callback;\n  }\n\n\n\n  _createEntityChangeHandler() {\n      return (changedIds, enhancedData = null) => {\n          const timestamp = Date.now();\n\n          console.log('[MSD DEBUG]  Entity change handler TRIGGERED:', {\n              timestamp: new Date().toISOString(),\n              changedIds,\n              hasEnhancedData: !!enhancedData,\n              stackTrace: new Error().stack.split('\\n').slice(1, 5).join('\\n'),\n              renderTimeout: !!this._renderTimeout,\n              renderInProgress: !!this._renderInProgress\n          });\n\n          // STEP 1: Handle controls with FRESH CURRENT HASS (restored logic)\n          const controlEntities = this._extractControlEntities(this.mergedConfig);\n          const controlChangedIds = changedIds.filter(id => controlEntities.includes(id));\n\n          if (controlChangedIds.length > 0 && this.controlsRenderer) {\n              // SIMPLIFIED: Direct subscription handles control updates automatically\n              console.log('[SystemsManager]  Control entities changed:', controlChangedIds);\n              console.log('[SystemsManager]  Direct subscription will handle these updates automatically');\n              // NOTE: The direct HASS subscription automatically handles control updates\n              // No need to manually forward HASS here as it causes duplicate/stale updates\n          }\n\n          // STEP 2: Update MSD internal HASS with converted data (existing logic)\n          const workingHass = this.getCurrentHass();\n          if (workingHass && this.dataSourceManager) {\n              console.log('[MSD DEBUG]  Refreshing MSD internal HASS context with converted entity states');\n\n              // Get converted state from data source manager for MSD internal use\n              const freshStates = {};\n              changedIds.forEach(entityId => {\n                  const entity = this.dataSourceManager.getEntity(entityId);\n                  if (entity && entity.state !== undefined) {\n                      // For MSD internal processing, use converted numeric values\n                      freshStates[entityId] = {\n                          state: entity.state.toString(), // MSD converted state\n                          last_changed: new Date().toISOString(),\n                          last_updated: new Date().toISOString(),\n                          attributes: entity.attributes || workingHass.states[entityId]?.attributes || {},\n                          entity_id: entityId,\n                          context: {\n                              id: Date.now().toString(),\n                              user_id: null\n                          }\n                      };\n\n                      console.log('[MSD DEBUG]  Updated MSD internal state for', entityId, {\n                          originalState: this._originalHass?.states[entityId]?.state,\n                          convertedState: freshStates[entityId].state,\n                          rawValue: entity.state\n                      });\n                  } else {\n                      console.log('[MSD DEBUG]  No data source found for entity:', entityId, '(entity will not be updated in MSD internal HASS)');\n                  }\n              });\n\n              // Only update HASS if we have fresh states from data sources\n              if (Object.keys(freshStates).length > 0) {\n                  // Update the working HASS states object with converted data\n                  this._currentHass = {\n                      ...workingHass,\n                      states: {\n                          ...workingHass.states,\n                          ...freshStates\n                      }\n                  };\n\n                  console.log('[MSD DEBUG]  MSD internal HASS context refreshed with', Object.keys(freshStates).length, 'converted entities');\n              } else {\n                  console.log('[MSD DEBUG]  No data source entities changed - MSD internal HASS unchanged');\n              }\n          } else {\n              console.log('[MSD DEBUG]  Skipping MSD internal HASS update:', {\n                  hasWorkingHass: !!workingHass,\n                  hasDataSourceManager: !!this.dataSourceManager,\n                  dataSourceManagerIsNull: this.dataSourceManager === null\n              });\n          }\n\n          // STEP 2.5: ENHANCED - Update overlays with DataSource changes using unified system\n          if (this.overlayUpdater) {\n              console.log('[MSD DEBUG]  Using BaseOverlayUpdater for overlay updates');\n              this.overlayUpdater.updateOverlaysForDataSourceChanges(changedIds);\n          } else {\n              console.log('[MSD DEBUG]  BaseOverlayUpdater not available, skipping overlay updates');\n          }\n\n          // Mark rules dirty for future renders\n          if (this.rulesEngine) {\n              // Enhanced: Map entity IDs to DataSource IDs for rules\n              const entitiesToMarkDirty = new Set();\n\n              changedIds.forEach(entityId => {\n                  // Add the original entity ID\n                  entitiesToMarkDirty.add(entityId);\n\n                  // Check if this entity ID corresponds to any DataSources\n                  if (this.dataSourceManager) {\n                      // Find DataSources that use this entity\n                      for (const [sourceId, source] of this.dataSourceManager.sources) {\n                          if (source.cfg && source.cfg.entity === entityId) {\n                              // Add the DataSource ID so rules can be triggered\n                              entitiesToMarkDirty.add(sourceId);\n                              console.log(`[MSD DEBUG]  Mapped entity \"${entityId}\" to DataSource \"${sourceId}\"`);\n                          }\n                      }\n                  }\n              });\n\n              const finalEntityList = Array.from(entitiesToMarkDirty);\n              this.rulesEngine.markEntitiesDirty(finalEntityList);\n              console.log('[MSD DEBUG]  Marked rules dirty for entities:', finalEntityList);\n          } else {\n              console.log('[MSD DEBUG]  No rules engine available to mark dirty');\n          }\n\n          if (this._renderTimeout) {\n              console.log('[MSD DEBUG]  Clearing existing render timeout');\n              clearTimeout(this._renderTimeout);\n          }\n\n          // SIMPLIFIED: Check if this is ONLY a control-triggered change with no data source implications\n          const isControlTriggered = changedIds.some(entityId => controlEntities.includes(entityId));\n          const hasDataSourceChanges = changedIds.some(entityId => {\n              return this.dataSourceManager && this.dataSourceManager.getEntity(entityId);\n          });\n\n          // Store analysis results\n          this._lastEntityAnalysis = {\n              isControlTriggered,\n              hasDataSourceChanges,\n              timestamp,\n              changedIds,\n              controlEntities,\n              matchingEntities: changedIds.filter(id => controlEntities.includes(id))\n          };\n\n          console.log('[MSD DEBUG]  Entity change analysis:', this._lastEntityAnalysis);\n\n          // IMPROVED: Only trigger re-render if rules might have actually changed\n          if (hasDataSourceChanges) {\n              console.log('[MSD DEBUG]  Checking if rules need re-evaluation for data source changes');\n\n              // Check if rule conditions might have changed\n              const needsRuleReRender = this._checkIfRulesNeedReRender(changedIds);\n\n              if (needsRuleReRender) {\n                  console.log('[MSD DEBUG]  Rule conditions may have changed - scheduling full re-render');\n                  this._scheduleFullReRender();\n              } else {\n                  console.log('[MSD DEBUG]  Only content changed - rules unchanged, skipping full re-render');\n                  // Content updates happen automatically via DataSource subscriptions\n                  // No full re-render needed for content-only changes\n              }\n          } else {\n              console.log('[MSD DEBUG]  SKIPPING re-render - no relevant entity changes for MSD');\n          }\n      };\n  }\n\n\n\n  /**\n   * Set the original HASS object and keep a pristine reference for controls\n   * @param {Object} hass - Original Home Assistant object\n   */\n  setOriginalHass(hass) {\n      console.log('[SystemsManager]  Setting original HASS reference:', {\n          hasStates: !!hass?.states,\n          entityCount: hass?.states ? Object.keys(hass.states).length : 0,\n          hasAuth: !!hass?.auth,\n          hasConnection: !!hass?.connection,\n          lightDeskState: hass?.states?.['light.desk']?.state,\n          timestamp: new Date().toISOString()\n      });\n\n      // ALWAYS update original HASS to keep it fresh - this should be the most current\n      this._originalHass = hass;\n\n      // If this is the first time setting HASS, also set working copy\n      if (!this._currentHass) {\n          this._currentHass = hass;\n          console.log('[SystemsManager]  Also setting _currentHass (first time)');\n      }\n\n      // ADDED: Set up direct subscription to ensure fresh HASS for controls\n      this.setupDirectHassSubscription(hass);\n\n      // Note: _currentHass will be modified separately in entity change handler with converted data\n  }\n\n  /**\n   * Get the current working HASS (for MSD internal use)\n   */\n  getCurrentHass() {\n      return this._currentHass;\n  }\n\n  /**\n   * Get the original pristine HASS (for controls)\n   */\n  getOriginalHass() {\n      return this._originalHass;\n  }\n\n\n  _instrumentRulesEngine(mergedConfig) {\n    try {\n      const depIndex = new Map();\n      (mergedConfig.rules||[]).forEach(r=>{\n        const condBlocks = (r.when && (r.when.all || r.when.any)) || [];\n        condBlocks.forEach(c=>{\n          const ent = c?.entity;\n            if (ent) {\n              if (!depIndex.has(ent)) depIndex.set(ent, new Set());\n              depIndex.get(ent).add(r.id);\n            }\n        });\n      });\n      this.rulesEngine.__hudDeps = depIndex;\n\n      const W = typeof window!=='undefined'?window:{};\n      W.__msdDebug = W.__msdDebug || {};\n      const perfStore = W.__msdDebug.__perfStore = W.__msdDebug.__perfStore || { counters:{}, timings:{} };\n      function perfCount(k,inc=1){ perfStore.counters[k]=(perfStore.counters[k]||0)+inc; }\n\n      if (!this.rulesEngine.__perfWrapped && typeof this.rulesEngine.evaluateDirty === 'function'){\n        const orig = this.rulesEngine.evaluateDirty;\n        this.rulesEngine.evaluateDirty = function(){\n          const ruleCount = (mergedConfig.rules||[]).length;\n          perfCount('rules.eval.count', ruleCount||0);\n          const res = orig.apply(this, arguments);\n          try {\n            const trace = (this.getTrace && this.getTrace()) || [];\n            const matched = Array.isArray(trace) ? trace.filter(t=>t && t.matched).length : 0;\n            perfCount('rules.match.count', matched);\n          } catch { /* ignore */ }\n          return res;\n        };\n        this.rulesEngine.__perfWrapped = true;\n      }\n    } catch(e){\n      console.warn('[MSD v1][rules instrumentation] failed', e);\n    }\n  }\n\n  async _initializeDataSources(hass, mergedConfig) {\n    this.dataSourceManager = null;\n\n    // ENHANCED: Better logging and error handling\n    if (!hass) {\n      console.warn('[MSD v1] No HASS provided - DataSourceManager will not be initialized');\n      return;\n    }\n\n    // ENHANCED: Explicit-only data sources - no auto-creation\n    const configuredDataSources = mergedConfig.data_sources || {};\n\n    console.log('[MSD v1]  Using explicit-only data sources mode');\n    console.log('[MSD v1]  Configured data sources:', Object.keys(configuredDataSources));\n\n    // Controls use direct HASS - no data sources needed\n    const controlEntities = this._extractControlEntities(mergedConfig);\n    console.log('[MSD v1]  Control entities (using direct HASS):', controlEntities);\n\n    // Use only explicitly configured data sources\n    const allDataSources = { ...configuredDataSources };\n\n    console.log('[MSD v1]  Data source summary:', {\n      configured: Object.keys(configuredDataSources).length,\n      total: Object.keys(allDataSources).length,\n      allDataSourceIds: Object.keys(allDataSources)\n    });\n\n    if (Object.keys(allDataSources).length === 0) {\n      console.log('[MSD v1] No explicit data sources configured - DataSourceManager will not be initialized');\n      console.log('[MSD v1] Note: Control overlays will use direct HASS (no data sources needed)');\n      return;\n    }\n\n    console.log('[MSD v1] Initializing DataSourceManager with', Object.keys(allDataSources).length, 'explicit data sources');\n\n    try {\n      this.dataSourceManager = new DataSourceManager(hass);\n      const sourceCount = await this.dataSourceManager.initializeFromConfig(allDataSources);\n      console.log('[MSD v1]  DataSourceManager initialized -', sourceCount, 'sources started');\n\n      // ADDED: Verify entities are available\n      const entityIds = this.dataSourceManager.listIds();\n      console.log('[MSD v1]  DataSourceManager entities available:', entityIds);\n\n    } catch (error) {\n      console.error('[MSD v1]  DataSourceManager initialization failed:', error);\n      console.error('[MSD v1] Error details:', error.stack);\n      this.dataSourceManager = null;\n    }\n  }\n\n  /**\n   * Extract entity IDs from control overlays for auto data source creation\n   */\n  _extractControlEntities(mergedConfig) {\n    const entities = new Set();\n\n    // Extract from overlays\n    const overlays = mergedConfig.overlays || [];\n    overlays.forEach(overlay => {\n      if (overlay.type === 'control' && overlay.card) {\n        // Check multiple possible entity locations\n        const entity = overlay.card.config?.entity ||\n                      overlay.card.config?.variables?.entity ||\n                      overlay.card.entity;\n\n        if (entity) {\n          entities.add(entity);\n        }\n      }\n    });\n\n    // Extract from any other control configurations\n    // (Add more extraction logic here as needed)\n\n    return Array.from(entities);\n  }\n\n  /**\n   * Essential cleanup method\n   */\n  destroy() {\n    if (this.debugRenderer) {\n      this.debugRenderer.destroy();\n    }\n\n    // Clear render timeout\n    if (this._renderTimeout) {\n      clearTimeout(this._renderTimeout);\n      this._renderTimeout = null;\n    }\n\n    // Clear re-render callback\n    this._reRenderCallback = null;\n  }\n\n  /**\n   * Render debug overlays and controls using DebugManager with basic performance tracking\n   * @param {Object} resolvedModel - The resolved model\n   * @param {Element} mountEl - The shadowRoot/mount element\n   */\n  async renderDebugAndControls(resolvedModel, mountEl = null) {\n    // ADDED: Early exit if already rendering\n    if (this._debugControlsRendering) {\n      console.log('[SystemsManager] renderDebugAndControls already in progress, skipping');\n      return;\n    }\n\n    this._debugControlsRendering = true;\n\n    try {\n      const debugState = this.debugManager.getSnapshot();\n\n      console.log('[SystemsManager] renderDebugAndControls called:', {\n        anyEnabled: this.debugManager.isAnyEnabled(),\n        controlOverlays: resolvedModel.overlays.filter(o => o.type === 'control').length,\n        hasHass: !!this._currentHass,\n        hasResolvedModel: !!resolvedModel,\n        hasOverlays: !!resolvedModel?.overlays\n      });\n\n      // ADDED: Validate resolved model\n      if (!resolvedModel || !resolvedModel.overlays) {\n        console.warn('[SystemsManager] Invalid resolved model for renderDebugAndControls');\n        return;\n      }\n\n      // Render debug visualizations with error boundary\n      if (this.debugManager.isAnyEnabled()) {\n        try {\n          const debugOptions = {\n            anchors: resolvedModel.anchors || {},\n            overlays: resolvedModel.overlays || [],\n            showAnchors: debugState.anchors,\n            showBoundingBoxes: debugState.bounding_boxes,\n            showRouting: this.debugManager.canRenderRouting(),\n            showPerformance: debugState.performance,\n            scale: debugState.scale\n          };\n\n          this.debugRenderer.render(mountEl || this.renderer?.mountEl, resolvedModel.viewBox, debugOptions);\n          console.log('[SystemsManager]  Debug renderer completed');\n        } catch (error) {\n          console.error('[SystemsManager]  Debug renderer failed:', error);\n          // Continue execution - don't fail the entire render\n        }\n      }\n\n      // FIXED: Render control overlays with comprehensive error handling\n      const controlOverlays = resolvedModel.overlays.filter(o => o.type === 'control');\n      if (controlOverlays.length > 0) {\n        console.log('[SystemsManager] Rendering control overlays:', controlOverlays.map(c => c.id));\n\n        try {\n          // ADDED: Validate controls renderer exists\n          if (!this.controlsRenderer) {\n            console.error('[SystemsManager] No controls renderer available');\n            return;\n          }\n\n          // Ensure controls renderer has current HASS context\n          if (this._currentHass && this.controlsRenderer) {\n            this.controlsRenderer.setHass(this._currentHass);\n            console.log('[SystemsManager] HASS context applied to controls renderer');\n          } else {\n            console.warn('[SystemsManager] No HASS context available for controls');\n          }\n\n          // REMOVED: Defensive container creation - not needed with SVG foreignObject approach\n          // The renderControls() method handles all necessary container creation internally\n\n          // ADDED: Defensive controls rendering with timeout\n          const renderPromise = this.controlsRenderer.renderControls(controlOverlays, resolvedModel);\n          const timeoutPromise = new Promise((_, reject) =>\n            setTimeout(() => reject(new Error('Controls render timeout')), 5000)\n          );\n\n          await Promise.race([renderPromise, timeoutPromise]);\n          console.log('[SystemsManager]  Controls rendered successfully');\n\n        } catch (error) {\n          console.error('[SystemsManager]  Controls rendering failed:', error);\n          console.error('[SystemsManager] Error stack:', error.stack);\n        }\n      }\n\n    } catch (error) {\n      console.error('[SystemsManager] renderDebugAndControls failed completely:', error);\n      console.error('[SystemsManager] Error stack:', error.stack);\n    } finally {\n      this._debugControlsRendering = false;\n    }\n  }\n\n  /**\n   * Check if debug should be rendered based on config\n   * @param {Object} debugConfig - Debug configuration\n   * @returns {boolean} Whether debug should be rendered\n   */\n  _shouldRenderDebugFromConfig(debugConfig) {\n    if (!debugConfig || !debugConfig.overlays) return false;\n\n    return debugConfig.overlays.anchors ||\n          debugConfig.overlays.bounding_boxes ||\n          debugConfig.overlays.routing ||\n          debugConfig.overlays.performance;\n  }\n\n  /**\n   * Legacy debug flag support (for backward compatibility)\n   * @returns {Object} Debug flags\n   */\n  _getDebugFlags() {\n    return window.cblcars?._debugFlags || {};\n  }\n\n  /**\n   * Legacy debug check (for backward compatibility)\n   * @param {Object} debugFlags - Debug flags\n   * @returns {boolean} Whether debug should be rendered\n   */\n  _shouldRenderDebug(debugFlags) {\n    return debugFlags && (debugFlags.overlay || debugFlags.connectors || debugFlags.geometry);\n  }\n\n  // Public API methods - now exclusively using DataSourceManager\n  ingestHass(hass) {\n    console.log('[SystemsManager] ingestHass called with:', {\n      hasHass: !!hass,\n      hasStates: !!hass?.states,\n      entityCount: hass?.states ? Object.keys(hass.states).length : 0,\n      hasLightDesk: !!hass?.states?.['light.desk'],\n      lightDeskState: hass?.states?.['light.desk']?.state,\n      timestamp: new Date().toISOString()\n    });\n\n    if (!hass || !hass.states) {\n      console.warn('[MSD v1] ingestHass called without valid hass.states');\n      return;\n    }\n\n    // CRITICAL: Update BOTH working copy AND original copy to keep them fresh\n    this._currentHass = hass;\n    this._originalHass = hass;  // ADDED: Keep original fresh too\n\n    console.log('[SystemsManager] Updated both _currentHass and _originalHass with fresh data');\n\n    // ENHANCED: Pass HASS to controls renderer EVERY time to ensure cards get updates\n    if (this.controlsRenderer) {\n      console.log('[SystemsManager] Updating HASS context in controls renderer immediately');\n      this.controlsRenderer.setHass(hass);\n    } else {\n      console.warn('[SystemsManager] No controls renderer available for HASS update');\n    }\n\n    // DataSources handle HASS updates automatically via their subscriptions\n    // No manual ingestion needed - handled by individual data sources\n    console.log('[MSD v1] HASS ingestion handled by individual data sources');\n  }\n\n  updateEntities(map) {\n    if (!map || typeof map !== 'object') return;\n\n    console.log('[MSD v1] Manual entity updates not supported in DataSources system');\n    console.warn('[MSD v1] Use direct HASS state updates instead of manual entity updates');\n  }\n\n  // Entity API methods using DataSourceManager\n  listEntities() {\n    return this.dataSourceManager ? this.dataSourceManager.listIds() : [];\n  }\n\n  getEntity(id) {\n    return this.dataSourceManager ? this.dataSourceManager.getEntity(id) : null;\n  }\n\n  /**\n   * Set up direct HASS subscription to ensure fresh HASS for controls\n   * @param {Object} hass - Home Assistant object with connection\n   */\n  setupDirectHassSubscription(hass) {\n    if (hass && hass.connection && !this._directHassSubscription) {\n      console.log('[SystemsManager]  Setting up direct HASS subscription for fresh control updates');\n\n      this._directHassSubscription = hass.connection.subscribeEvents((event) => {\n        if (event.event_type === 'state_changed' && event.data && event.data.entity_id) {\n          const entityId = event.data.entity_id;\n          const newState = event.data.new_state;\n\n          // Check if this is a control entity\n          const controlEntities = this._extractControlEntities(this.mergedConfig);\n          if (controlEntities.includes(entityId) && newState) {\n            console.log('[SystemsManager]  Direct HASS update for control entity:', entityId, 'new state:', newState.state);\n\n            // Update our HASS with the fresh state\n            if (this._originalHass && this._originalHass.states) {\n              const freshHass = {\n                ...this._originalHass,\n                states: {\n                  ...this._originalHass.states,\n                  [entityId]: newState\n                }\n              };\n\n              console.log('[SystemsManager]  Updated HASS with fresh state for', entityId, ':', newState.state);\n              this._originalHass = freshHass;\n              this._currentHass = freshHass;\n\n              // Forward fresh HASS to controls immediately\n              if (this.controlsRenderer) {\n                console.log('[SystemsManager]  Immediately forwarding fresh HASS to controls');\n                this.controlsRenderer.setHass(freshHass);\n              }\n            }\n          }\n        }\n      }, 'state_changed');\n\n            console.log('[SystemsManager]  Direct HASS subscription established');\n    }\n  }\n\n  /**\n   * Set up global HUD interface (placeholder for future implementation)\n   * @private\n   */\n  _setupGlobalHudInterface() {\n    console.log('[SystemsManager] Global HUD interface setup completed');\n    // This method is called during initialization\n    // Future HUD interface setup will go here\n  }\n\n  /**\n   * Check if entity changes might affect rule conditions (requiring full re-render)\n   * @param {Array} changedIds - Entity IDs that changed\n   * @returns {boolean} True if rules might need re-evaluation\n   * @private\n   */\n  _checkIfRulesNeedReRender(changedIds) {\n    if (!this.rulesEngine || !this.mergedConfig?.rules) {\n      return false; // No rules to evaluate\n    }\n\n    // For now, be conservative and assume any DataSource change might affect rules\n    // TODO: In the future, we could be more sophisticated and check specific rule conditions\n    const affectedDataSources = changedIds.filter(id => {\n      // Check if this entity maps to a DataSource used in rules\n      return this.dataSourceManager?.getEntity(id) ||\n             changedIds.some(entityId => this.dataSourceManager?.getSource(entityId));\n    });\n\n    if (affectedDataSources.length > 0) {\n      console.log('[MSD DEBUG]  DataSource entities affected by changes:', affectedDataSources);\n\n      // ADVANCED: Check if the specific rule thresholds might be crossed\n      // This is where we could add more sophisticated logic to detect actual rule changes\n      const mightCrossThresholds = this._checkThresholdCrossing(changedIds);\n\n      console.log('[MSD DEBUG]  Threshold crossing check:', mightCrossThresholds);\n      return mightCrossThresholds;\n    }\n\n    return false;\n  }\n\n  /**\n   * Check if entity changes might cross rule thresholds\n   * @param {Array} changedIds - Entity IDs that changed\n   * @returns {boolean} True if thresholds might be crossed\n   * @private\n   */\n  _checkThresholdCrossing(changedIds) {\n    // For temperature example: check if we're crossing the 70F threshold\n    const rules = this.mergedConfig.rules || [];\n\n    for (const rule of rules) {\n      const conditions = rule.when?.any || rule.when?.all || [];\n\n      for (const condition of conditions) {\n        if (condition.entity && (condition.above !== undefined || condition.below !== undefined)) {\n          // Check if this entity or its DataSource is in changedIds\n          const entityInRule = condition.entity;\n          const isDataSourceAffected = changedIds.some(id => {\n            // Check if changed entity maps to the DataSource used in the rule\n            const dataSourceId = entityInRule.split('.')[0]; // e.g., \"temperature_enhanced\"\n            const source = this.dataSourceManager?.getSource(dataSourceId);\n            return source && source.cfg?.entity === id;\n          });\n\n          if (isDataSourceAffected) {\n            console.log('[MSD DEBUG]  Rule condition potentially affected:', {\n              rule: rule.id,\n              entity: entityInRule,\n              threshold: condition.above || condition.below,\n              operator: condition.above ? 'above' : 'below'\n            });\n\n            // IMPROVED: Check actual threshold crossing instead of always returning true\n            const currentEntity = this.dataSourceManager?.getEntity(entityInRule);\n            if (currentEntity && currentEntity.state !== undefined) {\n              const currentValue = parseFloat(currentEntity.state);\n              const threshold = condition.above || condition.below;\n              const isAboveThreshold = currentValue > threshold;\n              const isBelowThreshold = currentValue < threshold;\n\n              // Check if current value satisfies the condition\n              const currentlyMatches = condition.above ? isAboveThreshold : isBelowThreshold;\n\n              console.log('[MSD DEBUG]  Detailed threshold analysis:', {\n                currentValue,\n                threshold,\n                operator: condition.above ? 'above' : 'below',\n                isAboveThreshold,\n                isBelowThreshold,\n                currentlyMatches,\n                ruleId: rule.id\n              });\n\n              // Store the current rule state for next comparison\n              if (!this._previousRuleStates) {\n                this._previousRuleStates = new Map();\n              }\n\n              const ruleKey = `${rule.id}_${condition.entity}`;\n              const previouslyMatched = this._previousRuleStates.get(ruleKey);\n\n              console.log('[MSD DEBUG]  Rule state comparison:', {\n                ruleKey,\n                previouslyMatched,\n                currentlyMatches,\n                stateChanged: previouslyMatched !== currentlyMatches\n              });\n\n              // Update the stored state\n              this._previousRuleStates.set(ruleKey, currentlyMatches);\n\n              // Only trigger re-render if the rule state actually changed\n              if (previouslyMatched !== undefined && previouslyMatched !== currentlyMatches) {\n                console.log('[MSD DEBUG]  Rule state CHANGED - threshold crossing detected!');\n                return true;\n              } else if (previouslyMatched === undefined) {\n                console.log('[MSD DEBUG]  First rule evaluation - storing state');\n                // First time seeing this rule, don't trigger re-render\n                return false;\n              } else {\n                console.log('[MSD DEBUG]  Rule state UNCHANGED - no threshold crossing');\n                return false;\n              }\n            }\n          }\n        }\n      }\n    }\n\n    console.log('[MSD DEBUG]  No threshold crossings detected');\n    return false;\n  }  /**\n   * Schedule a full re-render with proper queuing\n   * @private\n   */\n  _scheduleFullReRender() {\n    if (this._renderTimeout) {\n      console.log('[MSD DEBUG]  Clearing existing render timeout');\n      clearTimeout(this._renderTimeout);\n    }\n\n    // Safe re-render for data source changes\n    this._renderTimeout = setTimeout(() => {\n      if (this._reRenderCallback && !this._renderInProgress) {\n        try {\n          this._renderInProgress = true;\n          console.log('[MSD DEBUG]  TRIGGERING full re-render from rule change timeout');\n          this._reRenderCallback();\n        } catch (error) {\n          console.error('[MSD DEBUG]  Re-render FAILED in entity change handler:', error);\n        } finally {\n          this._renderInProgress = false;\n        }\n      }\n      this._renderTimeout = null;\n    }, 100);\n  }\n\n  /**\n   * Update text overlays when DataSource entities change\n   * @param {Array} changedIds - Entity IDs that changed\n   * @private\n   */\n  _updateTextOverlaysForDataSourceChanges(changedIds) {\n    console.log('[MSD DEBUG]  Checking for text overlays affected by DataSource changes:', changedIds);\n\n    // Get current resolved model to find text overlays\n    const resolvedModel = this.modelBuilder?.getResolvedModel?.();\n    if (!resolvedModel || !resolvedModel.overlays) {\n      console.log('[MSD DEBUG]  No resolved model available for text overlay updates');\n      return;\n    }\n\n    // Find text overlays that might be affected\n    const textOverlays = resolvedModel.overlays.filter(overlay => overlay.type === 'text');\n    console.log('[MSD DEBUG]  Found', textOverlays.length, 'text overlays to check');\n\n    textOverlays.forEach(overlay => {\n      // Check if this text overlay uses template strings that reference the changed DataSources\n      const content = overlay._raw?.content || overlay.content || overlay.text || '';\n\n      if (content && typeof content === 'string' && content.includes('{')) {\n        console.log(`[MSD DEBUG]  Checking text overlay ${overlay.id} with content: \"${content}\"`);\n\n        // Check if any of the changed entities map to DataSources referenced in the template\n        const needsUpdate = changedIds.some(entityId => {\n          // Find DataSources that use this entity\n          if (this.dataSourceManager) {\n            for (const [sourceId, source] of this.dataSourceManager.sources || new Map()) {\n              if (source.cfg && source.cfg.entity === entityId) {\n                console.log(`[MSD DEBUG]  Entity ${entityId} maps to DataSource ${sourceId}`);\n\n                // Check if the template content references this DataSource\n                if (content.includes(sourceId)) {\n                  console.log(`[MSD DEBUG]  Text overlay ${overlay.id} references DataSource ${sourceId} - needs update`);\n                  return true;\n                }\n              }\n            }\n          }\n          return false;\n        });\n\n        if (needsUpdate) {\n          console.log(`[MSD DEBUG]  Updating text overlay ${overlay.id} for DataSource changes`);\n\n          // Get the updated DataSource data for the first changed DataSource\n          const updatedDataSourceId = this._findDataSourceForEntity(changedIds[0]);\n          if (updatedDataSourceId) {\n            const dataSource = this.dataSourceManager.getSource(updatedDataSourceId);\n            if (dataSource) {\n              const currentData = dataSource.getCurrentData();\n              console.log(`[MSD DEBUG]  Using DataSource ${updatedDataSourceId} data:`, currentData);\n\n              // Update the text overlay with new data\n              if (this.renderer && this.renderer.updateTextOverlay) {\n                try {\n                  this.renderer.updateTextOverlay(overlay.id, currentData);\n                  console.log(`[MSD DEBUG]  Text overlay ${overlay.id} updated successfully`);\n                } catch (error) {\n                  console.error(`[MSD DEBUG]  Failed to update text overlay ${overlay.id}:`, error);\n                }\n              }\n            }\n          }\n        } else {\n          console.log(`[MSD DEBUG]  Text overlay ${overlay.id} not affected by these changes`);\n        }\n      }\n    });\n  }\n\n  /**\n   * Find DataSource ID for a given entity ID\n   * @param {string} entityId - Entity ID\n   * @returns {string|null} DataSource ID\n   * @private\n   */\n  _findDataSourceForEntity(entityId) {\n    if (this.dataSourceManager) {\n      for (const [sourceId, source] of this.dataSourceManager.sources || new Map()) {\n        if (source.cfg && source.cfg.entity === entityId) {\n          return sourceId;\n        }\n      }\n    }\n    return null;\n  }\n}\n\n// CLEANUP NOTE: The old text-specific overlay update methods have been removed\n  // and replaced with the unified BaseOverlayUpdater system in BaseOverlayUpdater.js\n  // This provides consistent template processing across all overlay types.\n\n","import { perfTime, perfCount } from '../util/performance.js';\n\n/**\n * Profile system for layered style resolution\n * Handles active_profiles precedence and profile-specific overrides\n *\n * FIXED: Overlay styles now have HIGHER precedence than profile styles\n */\nexport class ProfileResolver {\n  constructor() {\n    this.profileIndex = new Map(); // profileId -> profile data\n    this.activeProfiles = [];\n    this.styleCache = new Map(); // overlayId -> cached merged style\n    this.lastActiveProfiles = null; // For cache invalidation\n\n    // Performance tracking\n    this.perfStats = {\n      profileLoads: 0,\n      styleMerges: 0,\n      cacheHits: 0,\n      cacheMisses: 0,\n      invalidations: 0\n    };\n  }\n\n  /**\n   * Load profiles into the resolver index\n   */\n  loadProfiles(profiles) {\n    perfTime('profile.load', () => {\n      this.profileIndex.clear();\n\n      profiles.forEach(profile => {\n        if (profile.id) {\n          this.profileIndex.set(profile.id, profile);\n          this.perfStats.profileLoads++;\n        }\n      });\n\n      perfCount('profile.loaded', profiles.length);\n    });\n  }\n\n  /**\n   * Set active profiles and invalidate cache if changed\n   */\n  setActiveProfiles(activeProfiles) {\n    const newActiveProfiles = Array.isArray(activeProfiles) ? activeProfiles : [];\n\n    // Check if profiles changed\n    const changed = JSON.stringify(this.activeProfiles) !== JSON.stringify(newActiveProfiles);\n\n    if (changed) {\n      this.activeProfiles = [...newActiveProfiles];\n      this.invalidateStyleCache();\n      perfCount('profile.active.changed', 1);\n    }\n  }\n\n  /**\n   * Resolve styles for all overlays with profile layering\n   */\n  resolveOverlayStyles(overlays) {\n    return perfTime('profile.resolve.overlays', () => {\n      const resolved = overlays.map(overlay => {\n        const resolvedOverlay = { ...overlay };\n\n        // Get merged style with profile layers\n        resolvedOverlay.style = this.resolveOverlayStyle(overlay);\n\n        return resolvedOverlay;\n      });\n\n      perfCount('profile.overlays.processed', overlays.length);\n      return resolved;\n    });\n  }\n\n  /**\n   * Resolve style for a single overlay with profile layering\n   */\n  resolveOverlayStyle(overlay) {\n    return perfTime('profile.resolve.single', () => {\n      // Check cache first\n      const cacheKey = this.buildStyleCacheKey(overlay);\n\n      if (this.styleCache.has(cacheKey)) {\n        this.perfStats.cacheHits++;\n        perfCount('profile.cache.hits', 1);\n        return this.styleCache.get(cacheKey);\n      }\n\n      // Build style layers\n      const styleLayers = this.buildStyleLayers(overlay);\n\n      // Merge layers with precedence\n      const mergedStyle = this.mergeStyleLayers(styleLayers);\n\n      // Cache the result\n      this.styleCache.set(cacheKey, mergedStyle);\n      this.perfStats.cacheMisses++;\n      this.perfStats.styleMerges++;\n      perfCount('profile.cache.misses', 1);\n\n      return mergedStyle;\n    });\n  }\n\n  /**\n   * Build ordered style layers for an overlay\n   *\n   * FIXED: Corrected precedence order - overlays should override profiles\n   */\n  buildStyleLayers(overlay) {\n    const layers = [];\n\n    // Layer 1-N: Active profile styles (LOWEST precedence - applied first)\n    this.activeProfiles.forEach((profileId, index) => {\n      const profile = this.profileIndex.get(profileId);\n\n      if (profile) {\n        // Check for overlay-specific style in profile\n        const overlayStyle = this.getProfileOverlayStyle(profile, overlay.id, overlay.type);\n\n        if (overlayStyle) {\n          layers.push({\n            source: 'profile',\n            sourceId: profileId,\n            style: overlayStyle,\n            precedence: 100 + index // Earlier profiles have lower precedence\n          });\n        }\n      }\n    });\n\n    // Layer N+1: Base overlay style (HIGHEST precedence - applied last)\n    if (overlay.style) {\n      layers.push({\n        source: 'overlay',\n        sourceId: overlay.id,\n        style: overlay.style,\n        precedence: 1000 // Much higher than any profile\n      });\n    }\n\n    // Sort by precedence (lower numbers first, higher numbers override)\n    return layers.sort((a, b) => a.precedence - b.precedence);\n  }\n\n  /**\n   * Get profile style for a specific overlay\n   */\n  getProfileOverlayStyle(profile, overlayId, overlayType) {\n    // Check for direct overlay ID match\n    if (profile.overlays && profile.overlays[overlayId]) {\n      return profile.overlays[overlayId];\n    }\n\n    // Check for type-based defaults\n    if (profile.defaults && profile.defaults[overlayType]) {\n      return profile.defaults[overlayType];\n    }\n\n    return null;\n  }\n\n  /**\n   * Merge style layers with proper precedence\n   */\n  mergeStyleLayers(layers) {\n    const merged = {};\n    const provenance = {}; // Track which profile/source set each property\n\n    layers.forEach(layer => {\n      Object.entries(layer.style).forEach(([property, value]) => {\n        // Later layers override earlier ones\n        merged[property] = value;\n        provenance[property] = {\n          source: layer.source,\n          sourceId: layer.sourceId,\n          precedence: layer.precedence\n        };\n      });\n    });\n\n    // Attach provenance for debugging (non-enumerable)\n    Object.defineProperty(merged, '__styleProvenance', {\n      value: provenance,\n      enumerable: false,\n      writable: false\n    });\n\n    return merged;\n  }\n\n  /**\n   * Build cache key for overlay style\n   */\n  buildStyleCacheKey(overlay) {\n    const keyParts = [\n      overlay.id,\n      overlay.type || 'unknown',\n      this.getOverlayStyleHash(overlay.style),\n      this.activeProfiles.join(',')\n    ];\n\n    return keyParts.join('|');\n  }\n\n  /**\n   * Get simple hash of overlay style for cache key\n   */\n  getOverlayStyleHash(style) {\n    if (!style || typeof style !== 'object') return 'empty';\n\n    // Simple hash based on stringified style\n    return JSON.stringify(style).length.toString(36);\n  }\n\n  /**\n   * Invalidate style cache\n   */\n  invalidateStyleCache() {\n    this.styleCache.clear();\n    this.perfStats.invalidations++;\n    perfCount('profile.cache.invalidated', 1);\n  }\n\n  /**\n   * Get profile by ID\n   */\n  getProfile(profileId) {\n    return this.profileIndex.get(profileId);\n  }\n\n  /**\n   * Get all active profiles\n   */\n  getActiveProfiles() {\n    return [...this.activeProfiles];\n  }\n\n  /**\n   * Get available profile IDs\n   */\n  getAvailableProfiles() {\n    return Array.from(this.profileIndex.keys());\n  }\n\n  /**\n   * Check if a profile is active\n   */\n  isProfileActive(profileId) {\n    return this.activeProfiles.includes(profileId);\n  }\n\n  /**\n   * Get performance statistics\n   */\n  getStats() {\n    return {\n      ...this.perfStats,\n      profileCount: this.profileIndex.size,\n      activeProfileCount: this.activeProfiles.length,\n      cacheSize: this.styleCache.size,\n      hitRate: this.perfStats.cacheHits / (this.perfStats.cacheHits + this.perfStats.cacheMisses) || 0\n    };\n  }\n\n  /**\n   * Get detailed profile information for debugging\n   */\n  getDebugInfo() {\n    const info = {\n      availableProfiles: {},\n      activeProfiles: this.activeProfiles,\n      cacheSize: this.styleCache.size,\n      stats: this.getStats()\n    };\n\n    // Add profile details\n    this.profileIndex.forEach((profile, profileId) => {\n      info.availableProfiles[profileId] = {\n        hasDefaults: !!(profile.defaults && Object.keys(profile.defaults).length > 0),\n        hasOverlays: !!(profile.overlays && Object.keys(profile.overlays).length > 0),\n        defaultTypes: profile.defaults ? Object.keys(profile.defaults) : [],\n        overlayIds: profile.overlays ? Object.keys(profile.overlays) : []\n      };\n    });\n\n    return info;\n  }\n\n  /**\n   * Export resolver statistics for debugging\n   */\n  exportStats(options = {}) {\n    const stats = this.getStats();\n\n    if (options.includeDebug) {\n      stats.debug = this.getDebugInfo();\n    }\n\n    return options.format === 'json' ?\n      JSON.stringify(stats, null, 2) :\n      stats;\n  }\n}\n\n// Global resolver instance\nconst globalProfileResolver = new ProfileResolver();\n\n// Debug exposure\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdProfile = {\n    resolver: globalProfileResolver,\n    getStats: () => globalProfileResolver.getStats(),\n    getDebugInfo: () => globalProfileResolver.getDebugInfo(),\n    getActiveProfiles: () => globalProfileResolver.getActiveProfiles(),\n    getAvailableProfiles: () => globalProfileResolver.getAvailableProfiles(),\n    export: (options) => globalProfileResolver.exportStats(options)\n  };\n}\n\nexport { globalProfileResolver };","export function isPlain(o) {\n  return o && typeof o === 'object' && !Array.isArray(o);\n}\nexport function deepMerge(target, source) {\n  if (!isPlain(source)) return source;\n  if (!isPlain(target)) target = {};\n  for (const k of Object.keys(source)) {\n    const sv = source[k];\n    const tv = target[k];\n    if (isPlain(sv) && isPlain(tv)) {\n      target[k] = deepMerge(tv, sv);\n    } else {\n      // Arrays & scalars replace (per spec).\n      target[k] = sv;\n    }\n  }\n  return target;\n}\n","import { globalProfileResolver } from '../profile/ProfileResolver.js';\nimport { applyOverlayPatches } from '../rules/RulesEngine.js';\nimport { resolveValueMaps } from '../valueMap/resolveValueMaps.js';\nimport { resolveDesiredAnimations } from '../animation/resolveAnimations.js';\nimport { resolveDesiredTimelines } from '../animation/resolveTimelines.js';\nimport { perfTime } from '../perf/PerfCounters.js';\n\nexport class ModelBuilder {\n  constructor(mergedConfig, cardModel, systemsManager) {\n    this.mergedConfig = mergedConfig;\n    this.cardModel = cardModel;\n    this.systems = systemsManager;\n\n    // Replace profile index building with ProfileResolver\n    globalProfileResolver.loadProfiles(mergedConfig.profiles || []);\n\n    this.animationIndex = new Map((mergedConfig.animations || []).map(a => [a.id, a]));\n    this.timelineDefs = mergedConfig.timelines || [];\n    this.runtimeActiveProfiles = Array.isArray(mergedConfig.active_profiles)\n      ? mergedConfig.active_profiles.slice()\n      : [];\n    this._resolvedModelRef = null;\n  }\n\n  computeResolvedModel() {\n    // Anchor repair diagnostic\n    this._ensureAnchors();\n\n    // Assemble base overlays with profiles\n    const baseOverlays = this._assembleBaseOverlays();\n\n    // Subscribe overlays to data sources\n    this._subscribeOverlaysToDataSources(baseOverlays);\n\n    // Apply rules\n    const ruleResult = this._applyRules();\n\n    // Handle profile changes from rules\n    this._updateActiveProfiles(ruleResult);\n\n    // Apply overlay patches\n    const overlaysWithPatches = this._applyOverlayPatches(baseOverlays, ruleResult);\n\n    // Value map substitutions\n    this._resolveValueMaps(overlaysWithPatches);\n\n    // Process animations\n    const { activeAnimations, animDiff, tlDiff } = this._processAnimations(overlaysWithPatches, ruleResult);\n\n    // Build final resolved model\n    const resolved = {\n      viewBox: this.cardModel.viewBox,\n      anchors: { ...this.cardModel.anchors },\n      overlays: overlaysWithPatches,\n      animations: animDiff.active,\n      timelines: tlDiff.active,\n      config: this.mergedConfig,\n      active_profiles: this.runtimeActiveProfiles.slice()\n    };\n\n    // DEBUG: Check final overlay state before rendering\n    const titleOverlay = resolved.overlays.find(o => o.id === 'title_overlay');\n    if (titleOverlay) {\n      console.log('[ModelBuilder]  Final title_overlay state before rendering:', {\n        id: titleOverlay.id,\n        color: titleOverlay.style?.color,\n        status_indicator: titleOverlay.style?.status_indicator,\n        finalStyle: titleOverlay.finalStyle\n      });\n    }\n\n    // Update router\n    try {\n      this.systems.router.setOverlays && this.systems.router.setOverlays(resolved.overlays);\n    } catch(_) {}\n\n    this._resolvedModelRef = resolved;\n    return resolved;\n  }\n\n  getResolvedModel() {\n    return this._resolvedModelRef;\n  }\n\n  _ensureAnchors() {\n    if (!this.cardModel.anchors || Object.keys(this.cardModel.anchors).length === 0) {\n      if (this.mergedConfig.anchors && Object.keys(this.mergedConfig.anchors).length) {\n        console.warn('[MSD v1] computeResolvedModel: anchors missing  repairing from merged.anchors');\n        this.cardModel.anchors = { ...this.mergedConfig.anchors };\n      } else {\n        console.warn('[MSD v1] computeResolvedModel: anchors missing and no merged fallback available.');\n      }\n    }\n  }\n\n  _assembleBaseOverlays() {\n    return perfTime('profiles.assemble', () => {\n      // Set active profiles before resolving\n      globalProfileResolver.setActiveProfiles(this.runtimeActiveProfiles);\n\n      return this.cardModel.overlaysBase.map(o => {\n        // Replace assembleOverlayBaseStyle with ProfileResolver\n        const style = globalProfileResolver.resolveOverlayStyle(o);\n\n        // Get provenance from resolved style (if needed for debugging)\n        const sources = style.__styleProvenance ?\n          Object.entries(style.__styleProvenance).map(([prop, prov]) => ({\n            kind: prov.source,\n            id: prov.sourceId\n          })) : [];\n\n        // Preserve ALL properties from raw overlay config\n        const resolvedOverlay = {\n          id: o.id,\n          type: o.type,\n          style,\n          finalStyle: { ...style },\n          _styleSources: sources,\n          _raw: o.raw,\n          anchor: o.raw?.anchor,\n          attach_to: o.raw?.attach_to,\n          position: o.raw?.position,\n          size: o.raw?.size\n        };\n\n        // Preserve data source and routing properties\n        if (o.raw?.source) {\n          resolvedOverlay.source = o.raw.source;\n        }\n\n        if (o.raw?.route) {\n          resolvedOverlay.route = o.raw.route;\n        }\n\n        return resolvedOverlay;\n      });\n    });\n  }\n\n  /* OLD\n  _subscribeOverlaysToDataSources(baseOverlays) {\n    if (this.systems.dataSourceManager && baseOverlays) {\n      let subscriptionCount = 0;\n      baseOverlays.forEach(overlay => {\n        if ((overlay.type === 'sparkline' || overlay.type === 'ribbon') && overlay.source) {\n          try {\n            this.systems.dataSourceManager.subscribeOverlay(overlay, (overlay, updateData) => {\n              // FIX: updateData IS the source data, not updateData.sourceData\n              console.log('[MSD v1]  Data update for overlay', overlay.id, 'value:', updateData.v);\n\n              // Update the renderer with real data - pass updateData directly\n              if (this.systems.renderer && this.systems.renderer.updateOverlayData) {\n                this.systems.renderer.updateOverlayData(overlay.id, updateData);\n              }\n            });\n            subscriptionCount++;\n            console.log('[MSD v1]  Subscribed overlay', overlay.id, 'to data source', overlay.source);\n          } catch (error) {\n            console.warn('[MSD v1]  Failed to subscribe overlay', overlay.id, 'to source', overlay.source, ':', error.message);\n          }\n        }\n      });\n\n      if (subscriptionCount > 0) {\n        console.log('[MSD v1]  Established', subscriptionCount, 'overlay data subscriptions');\n      }\n    }\n  }\n  */\n\n\n\n  _subscribeOverlaysToDataSources(baseOverlays) {\n    if (!this.systems.dataSourceManager || !baseOverlays) {\n      console.log('[MSD v1] Skipping overlay subscriptions - no DataSourceManager or overlays');\n      return;\n    }\n\n    let subscriptionCount = 0;\n    let pendingSubscriptions = 0;\n\n    baseOverlays.forEach(overlay => {\n      if ((overlay.type === 'sparkline' || overlay.type === 'ribbon') && overlay.source) {\n        try {\n          // Check if data source exists and is ready\n          const dataSource = this.systems.dataSourceManager.getSource(overlay.source);\n          if (!dataSource) {\n            console.warn(`[MSD v1] Data source '${overlay.source}' not found for overlay ${overlay.id}`);\n            return;\n          }\n\n          // Check data source readiness\n          const currentData = dataSource.getCurrentData();\n          const isReady = currentData && (currentData.bufferSize > 0 || currentData.v !== undefined);\n\n          console.log(`[MSD v1] Subscribing overlay ${overlay.id} to source ${overlay.source}:`, {\n            sourceReady: isReady,\n            bufferSize: currentData?.bufferSize || 0,\n            hasValue: currentData?.v !== undefined\n          });\n\n          // Subscribe with enhanced callback\n          const unsubscribe = this.systems.dataSourceManager.subscribeOverlay(overlay, (overlayConfig, updateData) => {\n            console.log(`[MSD v1]  Data update for overlay ${overlayConfig.id}:`, {\n              value: updateData.v,\n              bufferSize: updateData.buffer?.size?.() || 0,\n              hasHistoricalData: !!(updateData.historicalData?.length),\n              sourceReady: true\n            });\n\n            // Update the renderer with real data\n            if (this.systems.renderer && this.systems.renderer.updateOverlayData) {\n              try {\n                this.systems.renderer.updateOverlayData(overlayConfig.id, updateData);\n              } catch (error) {\n                console.error(`[MSD v1] Error updating overlay ${overlayConfig.id}:`, error);\n              }\n            } else {\n              console.warn(`[MSD v1] Renderer not available for overlay update: ${overlayConfig.id}`);\n            }\n          });\n\n          if (unsubscribe) {\n            subscriptionCount++;\n            if (isReady) {\n              console.log(`[MSD v1]  Subscribed overlay ${overlay.id} to ready source ${overlay.source}`);\n            } else {\n              pendingSubscriptions++;\n              console.log(`[MSD v1]  Subscribed overlay ${overlay.id} to pending source ${overlay.source}`);\n            }\n\n            // Store unsubscribe function for cleanup\n            if (!this._overlayUnsubscribers) {\n              this._overlayUnsubscribers = new Map();\n            }\n            if (!this._overlayUnsubscribers.has(overlay.id)) {\n              this._overlayUnsubscribers.set(overlay.id, []);\n            }\n            this._overlayUnsubscribers.get(overlay.id).push(unsubscribe);\n          }\n\n        } catch (error) {\n          console.warn(`[MSD v1]  Failed to subscribe overlay ${overlay.id} to source ${overlay.source}:`, error.message);\n        }\n      }\n    });\n\n    if (subscriptionCount > 0) {\n      console.log(`[MSD v1]  Established ${subscriptionCount} overlay data subscriptions (${pendingSubscriptions} pending data)`);\n    }\n\n    // Monitor pending subscriptions and log when they become ready\n    if (pendingSubscriptions > 0) {\n      this._monitorPendingSubscriptions(baseOverlays, pendingSubscriptions);\n    }\n\n    // Subscribe to text overlays data sources\n    this._subscribeTextOverlaysToDataSources(baseOverlays);\n  }\n\n\n\n\n  /**\n   * Monitor pending subscriptions and report when data becomes available\n   * @private\n   * @param {Array} baseOverlays - Array of overlay configurations\n   * @param {number} pendingCount - Initial count of pending subscriptions\n   */\n  _monitorPendingSubscriptions(baseOverlays, pendingCount) {\n    let checkCount = 0;\n    const maxChecks = 50; // Maximum number of checks (5 seconds with 100ms intervals)\n\n    const checkInterval = setInterval(() => {\n      checkCount++;\n      let stillPending = 0;\n\n      baseOverlays.forEach(overlay => {\n        if ((overlay.type === 'sparkline' || overlay.type === 'ribbon') && overlay.source) {\n          const dataSource = this.systems.dataSourceManager.getSource(overlay.source);\n          if (dataSource) {\n            const currentData = dataSource.getCurrentData();\n            const isReady = currentData && (currentData.bufferSize > 0 || currentData.v !== undefined);\n            if (!isReady) {\n              stillPending++;\n            }\n          }\n        }\n      });\n\n      if (stillPending === 0) {\n        console.log(`[MSD v1]  All overlay data sources are now ready (checked ${checkCount} times)`);\n        clearInterval(checkInterval);\n      } else if (checkCount >= maxChecks) {\n        console.warn(`[MSD v1]  Timeout waiting for ${stillPending} data sources to become ready`);\n        clearInterval(checkInterval);\n      } else if (checkCount % 10 === 0) {\n        // Log progress every second (10 * 100ms)\n        console.log(`[MSD v1]  Still waiting for ${stillPending} data sources (${checkCount * 100}ms elapsed)`);\n      }\n    }, 100); // Check every 100ms\n  }\n\n\n\n\n  _applyRules() {\n    console.log('[ModelBuilder]  _applyRules() called');\n\n    // FIXED: Always evaluate rules during render, not just when dirty\n    // This ensures rule patches are generated even if rules weren't marked dirty externally\n    this.systems.rulesEngine.markAllDirty();\n    console.log('[ModelBuilder]  Marked all rules dirty');\n\n    // Use DataSourceManager's getEntity for comprehensive entity resolution\n    const getEntity = (entityId) => {\n      // Use DataSourceManager's getEntity which handles:\n      // - DataSource references with dot notation (temperature_enhanced.transformations.celsius)\n      // - Regular Home Assistant entities\n      // - Fallback to HASS states\n      if (this.systems.dataSourceManager && this.systems.dataSourceManager.getEntity) {\n        return this.systems.dataSourceManager.getEntity(entityId);\n      }\n\n      // Fallback to direct HASS access if no DataSourceManager\n      if (this.systems._currentHass?.states?.[entityId]) {\n        const hassState = this.systems._currentHass.states[entityId];\n        return {\n          state: hassState.state,\n          attributes: hassState.attributes || {}\n        };\n      }\n\n      return null;\n    };\n\n    const ruleResult = this.systems.rulesEngine.evaluateDirty({ getEntity });\n    console.log('[ModelBuilder]  Rule evaluation result:', {\n      overlayPatches: ruleResult.overlayPatches.length,\n      patches: ruleResult.overlayPatches\n    });\n\n    return ruleResult;\n  }  _updateActiveProfiles(ruleResult) {\n    if (ruleResult.profilesAdd?.length || ruleResult.profilesRemove?.length) {\n      const set = new Set(this.runtimeActiveProfiles);\n      ruleResult.profilesAdd.forEach(p => set.add(p));\n      ruleResult.profilesRemove.forEach(p => set.delete(p));\n      this.runtimeActiveProfiles = Array.from(set);\n\n      // Update ProfileResolver with new active profiles\n      globalProfileResolver.setActiveProfiles(this.runtimeActiveProfiles);\n    }\n  }\n\n  _applyOverlayPatches(baseOverlays, ruleResult) {\n    console.log('[ModelBuilder]  _applyOverlayPatches() called with:', {\n      overlayCount: baseOverlays.length,\n      patchCount: ruleResult.overlayPatches.length,\n      patches: ruleResult.overlayPatches\n    });\n\n    const result = perfTime('styles.patch', () =>\n      applyOverlayPatches(baseOverlays, ruleResult.overlayPatches)\n    );\n\n    console.log('[ModelBuilder]  Overlay patches applied. Checking title_overlay:');\n    const titleOverlay = result.find(o => o.id === 'title_overlay');\n    if (titleOverlay) {\n      console.log('[ModelBuilder]  Title overlay after patching:', {\n        id: titleOverlay.id,\n        color: titleOverlay.style?.color,\n        status_indicator: titleOverlay.style?.status_indicator\n      });\n    }\n\n    return result;\n  }\n\n  _resolveValueMaps(overlaysWithPatches) {\n    perfTime('value_map.subst', () =>\n      resolveValueMaps(overlaysWithPatches, {\n        getEntity: id => this.systems.entityRuntime.getEntity(id)\n      })\n    );\n  }\n\n  _processAnimations(overlaysWithPatches, ruleResult) {\n    const desiredAnimations = resolveDesiredAnimations(overlaysWithPatches, this.animationIndex, ruleResult.animations);\n    const desiredTimelines = resolveDesiredTimelines(this.timelineDefs);\n    const activeAnimations = [];\n\n    desiredAnimations.forEach(animDef => {\n      const instance = this.systems.animRegistry.getOrCreateInstance(animDef.definition, animDef.targets);\n      if (instance) {\n        activeAnimations.push({\n          id: animDef.id,\n          instance,\n          hash: this.systems.animRegistry.computeInstanceHash(animDef.definition)\n        });\n      }\n    });\n\n    const animDiff = { active: activeAnimations };\n    const tlDiff = { active: desiredTimelines };\n\n    // Assign animation hash to overlays\n    const overlayAnimByKey = new Map();\n    animDiff.active.forEach(a => {\n      if (a.overlayId) overlayAnimByKey.set(a.overlayId, a.hash);\n    });\n    overlaysWithPatches.forEach(o => {\n      const h = overlayAnimByKey.get(o.id);\n      if (h) o.animation_hash = h;\n    });\n\n    return { activeAnimations, animDiff, tlDiff };\n  }\n\n\n  /**\n   * Clean up overlay subscriptions\n   * @public\n   */\n  destroy() {\n    if (this._overlayUnsubscribers) {\n      console.log(`[MSD v1] Cleaning up ${this._overlayUnsubscribers.size} overlay subscriptions`);\n\n      for (const [overlayId, unsubscribers] of this._overlayUnsubscribers) {\n        unsubscribers.forEach(unsubscribe => {\n          try {\n            unsubscribe();\n          } catch (error) {\n            console.warn(`[MSD v1] Error unsubscribing overlay ${overlayId}:`, error);\n          }\n        });\n      }\n\n      this._overlayUnsubscribers.clear();\n    }\n  }\n\n  /**\n   * Set up DataSource subscriptions for text overlays that use template strings\n   * @param {Array} overlays - Array of overlay configurations\n   * @private\n   */\n  _subscribeTextOverlaysToDataSources(overlays) {\n    overlays.forEach(overlay => {\n      if (overlay.type === 'text') {\n        // Check if text content contains DataSource references\n        const textContent = overlay.text || overlay.content || overlay.finalStyle?.value || '';\n        const dataSourceRef = overlay.data_source || overlay._raw?.data_source || overlay.finalStyle?.data_source;\n\n        // Extract DataSource references from template strings like {temperature_enhanced.transformations.celsius}\n        const templateRefs = this._extractDataSourceReferences(textContent);\n\n        // Subscribe to direct DataSource references\n        if (dataSourceRef) {\n          this._subscribeTextOverlayToDataSource(overlay.id, dataSourceRef);\n        }\n\n        // Subscribe to template string DataSource references\n        templateRefs.forEach(ref => {\n          this._subscribeTextOverlayToDataSource(overlay.id, ref);\n        });\n      }\n    });\n  }\n\n  /**\n   * Subscribe a text overlay to a specific DataSource\n   * @param {string} overlayId - ID of the text overlay\n   * @param {string} dataSourceRef - DataSource reference (e.g., 'temperature_enhanced')\n   * @private\n   */\n  _subscribeTextOverlayToDataSource(overlayId, dataSourceRef) {\n    try {\n      const dataSourceManager = this.systems?.dataSourceManager;\n      if (!dataSourceManager) {\n        console.warn(`[ModelBuilder] DataSourceManager not available for text overlay subscription: ${overlayId}`);\n        return;\n      }\n\n      // Parse DataSource reference to get source name\n      const sourceName = dataSourceRef.split('.')[0];\n      const dataSource = dataSourceManager.getSource(sourceName);\n\n      if (!dataSource) {\n        console.warn(`[ModelBuilder] DataSource '${sourceName}' not found for text overlay: ${overlayId}`);\n        return;\n      }\n\n      // Create subscription callback\n      const callback = (data) => {\n        console.log(`[ModelBuilder]  Text overlay ${overlayId} received DataSource update from ${sourceName}`);\n\n        // Notify AdvancedRenderer to update the text overlay\n        if (this.systems.renderer && this.systems.renderer.updateOverlayData) {\n          this.systems.renderer.updateOverlayData(overlayId, data);\n        }\n      };\n\n      // Subscribe to the DataSource\n      dataSource.subscribe(overlayId, callback);\n\n      console.log(`[ModelBuilder]  Subscribed text overlay ${overlayId} to DataSource ${sourceName}`);\n\n    } catch (error) {\n      console.error(`[ModelBuilder] Failed to subscribe text overlay ${overlayId} to DataSource ${dataSourceRef}:`, error);\n    }\n  }\n\n  /**\n   * Extract DataSource references from template strings\n   * @param {string} content - Text content that may contain template strings\n   * @returns {Array<string>} Array of DataSource references\n   * @private\n   */\n  _extractDataSourceReferences(content) {\n    if (!content || typeof content !== 'string') {\n      return [];\n    }\n\n    const references = [];\n    const templatePattern = /\\{([^}]+)\\}/g;\n    let match;\n\n    while ((match = templatePattern.exec(content)) !== null) {\n      const reference = match[1].split(':')[0].trim(); // Remove formatting specs\n\n      // Only include if it looks like a DataSource reference (contains dots or is a simple identifier)\n      if (reference.includes('.') || /^[a-zA-Z_][a-zA-Z0-9_]*$/.test(reference)) {\n        const sourceName = reference.split('.')[0];\n        if (!references.includes(sourceName)) {\n          references.push(sourceName);\n        }\n      }\n    }\n\n    return references;\n  }\n}\n","import { perfInc, perfTime } from '../perf/PerfCounters.js';\nimport { linearMap } from '../util/linearMap.js';\n\nexport function resolveValueMaps(resolvedOverlays, ctx) {\n  return perfTime('value_map.resolve', () => {\n    let success = 0;\n    let fail = 0;\n\n    for (const ov of resolvedOverlays) {\n      if (!ov.finalStyle) continue;\n      ov.finalStyle = walk(ov.finalStyle);\n    }\n\n    perfInc('value_map.resolve.count', success);\n    perfInc('value_map.fail.count', fail);\n\n    function walk(node) {\n      if (!node || typeof node !== 'object') return node;\n      // value_map descriptor: exact shape { value_map: {...} } OR object with only that key\n      if (node.value_map && Object.keys(node).length === 1) {\n        const val = computeValueMap(node.value_map);\n        return val;\n      }\n      // Recurse\n      if (Array.isArray(node)) return node.map(walk);\n      const out = {};\n      for (const k of Object.keys(node)) {\n        out[k] = walk(node[k]);\n      }\n      return out;\n    }\n\n    function computeValueMap(desc) {\n      try {\n        const entityId = desc.entity;\n        if (!entityId) { fail++; return fallback(desc); }\n        const ent = ctx?.getEntity ? ctx.getEntity(entityId) : null;\n        if (!ent) { fail++; return fallback(desc); }\n        let raw = ent.state;\n        if (desc.attribute && ent.attributes) raw = ent.attributes[desc.attribute];\n        let num = Number(raw);\n        if (!Number.isFinite(num)) { fail++; return fallback(desc); }\n        const [inA, inB] = desc.input || [];\n        const [outA, outB] = desc.output || [];\n        if (![inA,inB,outA,outB].every(Number.isFinite)) { fail++; return fallback(desc); }\n        let mapped = linearMap(num, inA, inB, outA, outB, !!desc.clamp);\n        if (Number.isFinite(desc.round)) {\n          const pow = Math.pow(10, desc.round);\n          mapped = Math.round(mapped * pow) / pow;\n        }\n        success++;\n        return mapped;\n      } catch {\n        fail++;\n        return fallback(desc);\n      }\n    }\n    function fallback(desc) {\n      if (desc && Number.isFinite(desc.default)) return desc.default;\n      if (Array.isArray(desc?.output) && Number.isFinite(desc.output[0])) return desc.output[0];\n      return 1; // minimal visible default\n    }\n  });\n}\n","export function linearMap(val, inMin, inMax, outMin, outMax, clamp) {\n  if (inMax === inMin) return outMin;\n  let t = (val - inMin) / (inMax - inMin);\n  if (clamp) {\n    if (t < 0) t = 0;\n    else if (t > 1) t = 1;\n  }\n  return outMin + t * (outMax - outMin);\n}\n","import { deepMerge } from '../util/deepMerge.js';\n\n/**\n * Build desired animation instances.\n * @param {Array} overlays resolved overlays (with _raw for original)\n * @param {Object} animationIndex id -> animation def\n * @param {Array} ruleAnimations from rulesEngine (ref, override, priority)\n */\n// NOTE Wave 1: preset resolution deferred to AnimationRegistry (builders in presets.js)\nexport function resolveDesiredAnimations(overlays, animationIndex, ruleAnimations) {\n  const desired = [];\n  const ruleOverridesGrouped = groupRuleAnimOverrides(ruleAnimations);\n\n  // Overlay-level animations\n  for (const ov of overlays) {\n    const raw = ov._raw || ov.raw || {};\n    if (!raw.animation_ref) continue;\n    const base = animationIndex.get(raw.animation_ref);\n    if (!base) continue;\n    // Build merged params\n    let params = {};\n    if (base.params) params = deepMerge(params, base.params);\n    if (raw.animation_override?.params) params = deepMerge(params, raw.animation_override.params);\n\n    // Apply highest-priority rule override first (only first per ref used per overlay)\n    const ruleList = ruleOverridesGrouped.get(raw.animation_ref);\n    if (ruleList && ruleList.length) {\n      // Already sorted by priority desc\n      for (const r of ruleList) {\n        if (r.override?.params) params = deepMerge(params, r.override.params);\n        break; // only top-level override for now\n      }\n    }\n\n    desired.push({\n      key: `overlay:${ov.id}:${raw.animation_ref}`,\n      preset: base.preset,\n      params,\n      targets: [`#${ov.id}`],\n      ref: raw.animation_ref,\n      overlayId: ov.id\n    });\n  }\n\n  // Standalone animations (defs with explicit targets)\n  for (const [id, def] of animationIndex.entries()) {\n    if (!def.targets) continue;\n    desired.push({\n      key: `standalone:${id}`,\n      preset: def.preset,\n      params: def.params || {},\n      targets: Array.isArray(def.targets) ? def.targets.slice() : [def.targets],\n      ref: id\n    });\n  }\n\n  return desired;\n}\n\nfunction groupRuleAnimOverrides(ruleAnims) {\n  const map = new Map();\n  (ruleAnims || []).forEach(a => {\n    if (!a.ref) return;\n    if (!map.has(a.ref)) map.set(a.ref, []);\n    map.get(a.ref).push(a);\n  });\n  // Sort each list by priority desc\n  map.forEach(list => list.sort((a, b) => (b.priority || 0) - (a.priority || 0)));\n  return map;\n}\n","import { deepMerge } from '../util/deepMerge.js';\n\nexport function resolveDesiredTimelines(timelineDefs = []) {\n  return timelineDefs.map(tl => {\n    const globals = { ...(tl.globals || {}) };\n    const steps = (tl.steps || []).map(s => ({\n      targets: s.targets,\n      preset: s.preset,\n      params: deepMerge({}, s.params || {}),\n      offset: s.offset\n    }));\n    return {\n      id: tl.id,\n      globals,\n      steps\n    };\n  });\n}\n","/**\n * Phase 2: Overlay introspection utilities\n * Provides overlay listing, highlighting, and geometry utilities\n */\n\nexport class MsdIntrospection {\n  static getOverlaysSvg(root) {\n    return root?.querySelector?.('#msd_svg_overlays svg') ||\n           root?.querySelector?.('#cblcars-msd-wrapper svg') || null;\n  }\n\n  static listOverlays(root) {\n    const out = [];\n    const svg = this.getOverlaysSvg(root);\n    if (!svg) return out;\n\n    // Get resolved model from new pipeline\n    const resolvedModel = root.__msdResolvedModel || {};\n    const overlaysById = new Map((resolvedModel.overlays || []).map(o => [o.id, o]));\n\n    // Find overlay elements\n    let nodes = Array.from(svg.querySelectorAll('[id][data-cblcars-root=\"true\"]'));\n    if (!nodes.length) {\n      // Fallback: find any elements with IDs, excluding debug layers\n      nodes = Array.from(svg.querySelectorAll('[id]'))\n        .filter(n => n.id && n.id !== 'cblcars-debug-layer' && n.id !== 'cblcars-highlight-layer');\n    }\n\n    for (const node of nodes) {\n      const id = node.id;\n      const overlay = overlaysById.get(id);\n      const bbox = this.getOverlayBBox(id, root);\n\n      out.push({\n        id,\n        type: overlay?.type || node.getAttribute?.('data-cblcars-type') || node.tagName?.toLowerCase() || 'unknown',\n        bbox,\n        hasErrors: false, // TODO: Integration with validation system\n        hasWarnings: false,\n        element: node,\n        config: overlay\n      });\n    }\n\n    return out;\n  }\n\n  static getOverlayBBox(id, root) {\n    if (!id || !root) return null;\n\n    // 1) Try SVG element getBBox\n    let el = root.getElementById?.(id);\n    if (el && typeof el.getBBox === 'function') {\n      try {\n        const gbb = el.getBBox();\n        if (gbb && Number.isFinite(gbb.width) && Number.isFinite(gbb.height)) {\n          return { x: gbb.x, y: gbb.y, w: gbb.width, h: gbb.height };\n        }\n      } catch (_) {}\n    }\n\n    // 2) Ribbon fallback: backdrop element\n    const backdrop = root.getElementById?.(`${id}_backdrop`);\n    if (backdrop && typeof backdrop.getBBox === 'function') {\n      try {\n        const bb2 = backdrop.getBBox();\n        if (bb2 && (bb2.width > 0 || bb2.height > 0)) {\n          return { x: bb2.x, y: bb2.y, w: bb2.width, h: bb2.height };\n        }\n      } catch (_) {}\n    }\n\n    // 3) Config fallback: compute from overlay position + size\n    const resolvedModel = root.__msdResolvedModel || {};\n    const overlay = resolvedModel.overlays?.find(o => o.id === id);\n    if (overlay && overlay.position && overlay.size) {\n      const anchors = resolvedModel.anchors || {};\n      const vb = resolvedModel.viewBox || [0, 0, 100, 100];\n      const pos = this.resolvePointFromConfig(overlay.position, anchors, vb);\n      const sz = this.resolveSizeFromConfig(overlay.size, vb);\n      if (pos && sz) {\n        return { x: pos[0], y: pos[1], w: sz.w, h: sz.h };\n      }\n    }\n\n    return null;\n  }\n\n  static highlight(ids, opts = {}) {\n    const idList = Array.isArray(ids) ? ids : [ids];\n    const root = opts.root;\n\n    // Require explicit root element - no document fallback\n    if (!root) {\n      console.warn('[MsdIntrospection] Root element required for highlighting');\n      return;\n    }\n\n    const svg = this.getOverlaysSvg(root);\n    if (!svg) {\n      console.warn('[MsdIntrospection] No SVG found for highlighting');\n      return;\n    }\n\n    const viewBox = this.getViewBox(root, svg) || [0, 0, 400, 200];\n    const color = opts.color || '#ffcc00';\n    const strokeWidth = Number.isFinite(opts.strokeWidth)\n      ? opts.strokeWidth\n      : Math.max(1.5, Math.round(viewBox[3] * 0.004));\n    const duration = Math.max(250, opts.duration || 1500);\n\n    // Use proper createElementNS from root's document\n    const doc = root.ownerDocument || root.document;\n    if (!doc || !doc.createElementNS) {\n      console.warn('[MsdIntrospection] createElementNS not available');\n      return;\n    }\n\n    // Ensure highlight layer exists\n    let highlightLayer = svg.querySelector('#cblcars-highlight-layer');\n    if (!highlightLayer) {\n      highlightLayer = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n      highlightLayer.setAttribute('id', 'cblcars-highlight-layer');\n      highlightLayer.style.pointerEvents = 'none';\n      svg.appendChild(highlightLayer);\n    }\n\n    // Clear existing highlights\n    highlightLayer.innerHTML = '';\n\n    // Create highlight rectangles\n    for (const id of idList) {\n      const bbox = this.getOverlayBBox(id, root);\n      if (bbox) {\n        const rect = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\n        rect.setAttribute('x', bbox.x);\n        rect.setAttribute('y', bbox.y);\n        rect.setAttribute('width', bbox.w);\n        rect.setAttribute('height', bbox.h);\n        rect.setAttribute('fill', 'none');\n        rect.setAttribute('stroke', color);\n        rect.setAttribute('stroke-width', strokeWidth);\n        rect.setAttribute('opacity', '0.9');\n\n        highlightLayer.appendChild(rect);\n      }\n    }\n\n    // Auto-clear after duration\n    setTimeout(() => {\n      if (highlightLayer && highlightLayer.parentNode) {\n        highlightLayer.innerHTML = '';\n      }\n    }, duration);\n  }\n\n  static getViewBox(root, svg) {\n    if (!svg) return null;\n\n    const viewBoxAttr = svg.getAttribute('viewBox');\n    if (viewBoxAttr) {\n      const parts = viewBoxAttr.split(/\\s+/).map(Number);\n      if (parts.length === 4) {\n        return parts;\n      }\n    }\n\n    return [0, 0, 400, 200]; // fallback\n  }\n\n  // Helper methods for point/size resolution\n  static resolvePointFromConfig(position, anchors = {}, viewBox = [0, 0, 400, 200]) {\n    const [minX, minY, vw, vh] = viewBox;\n    if (!position) return null;\n    if (typeof position === 'string' && anchors[position]) return anchors[position];\n    if (Array.isArray(position) && position.length === 2) {\n      const r = (v, axis) =>\n        typeof v === 'string' && v.trim().endsWith('%')\n          ? axis === 'x'\n            ? minX + (parseFloat(v) / 100) * vw\n            : minY + (parseFloat(v) / 100) * vh\n          : Number(v);\n      const x = r(position[0], 'x');\n      const y = r(position[1], 'y');\n      if (Number.isFinite(x) && Number.isFinite(y)) return [x, y];\n    }\n    return null;\n  }\n\n  static resolveSizeFromConfig(size, viewBox = [0, 0, 400, 200]) {\n    if (!Array.isArray(size) || size.length !== 2) return null;\n    const [, , vw, vh] = viewBox;\n    const toDim = (val, max) =>\n      typeof val === 'string' && val.trim().endsWith('%') ? (parseFloat(val) / 100) * max : Number(val);\n    const w = toDim(size[0], vw);\n    const h = toDim(size[1], vh);\n    if (!Number.isFinite(w) || !Number.isFinite(h)) return null;\n    return { w, h };\n  }\n}\n","import { perfTime } from '../perf/PerfCounters.js';\n\nexport async function buildCardModel(mergedConfig) {\n  return perfTime('cardModel.build', () => {\n    // Phase A: implement viewBox:auto + SVG anchor extraction + percent resolution.\n    const viewBox = [0, 0, 400, 200];\n    const anchors = {}; // merged + normalized numeric\n    const overlaysBase = mergedConfig.overlays.map(o => ({ id: o.id, type: o.type, style: o.style || {}, raw: o }));\n\n    // Ensure status_grid overlays preserve cells configuration\n    // Status grid overlays need special handling to preserve cell definitions\n\n    return { viewBox, anchors, overlaysBase, __raw: mergedConfig };\n  });\n}\n","/**\n * Phase 4: Unified MSD API structure\n * Provides window.cblcars.msd.api namespace\n * MSD v1 is now the stable system - no feature flag needed\n */\n\nexport class MsdApi {\n  static attach() {\n    if (typeof window === 'undefined') return;\n\n    window.cblcars = window.cblcars || {};\n    window.cblcars.msd = window.cblcars.msd || {};\n\n    // Enhanced API structure with DebugManager integration\n    window.cblcars.msd.api = {\n      overlays: {\n        list: (root) => this.listOverlays(root),\n        highlight: (ids, opts) => this.highlightOverlays(ids, opts),\n        getBBox: (id, root) => this.getOverlayBBox(id, root),\n        update: (id, data) => this.updateOverlay(id, data)\n      },\n\n      anchors: {\n        list: () => this.listAnchors(),\n        get: (id) => this.getAnchor(id),\n        set: (id, x, y) => this.setAnchor(id, x, y),\n        dump: () => this.dumpAnchors()\n      },\n\n      debug: {\n        enable: (feature) => this.enableDebugFeature(feature),\n        disable: (feature) => this.disableDebugFeature(feature),\n        toggle: (feature) => this.toggleDebugFeature(feature),\n        setScale: (scale) => this.setDebugScale(scale),\n        status: () => this.getDebugStatus(),\n\n        // Legacy methods with deprecation warnings\n        showAnchors: () => {\n          console.warn('[MsdApi] debug.showAnchors deprecated, use debug.enable(\"anchors\")');\n          this.enableDebugFeature('anchors');\n        },\n        showOverlays: () => {\n          console.warn('[MsdApi] debug.showOverlays deprecated, use debug.enable(\"bounding_boxes\")');\n          this.enableDebugFeature('bounding_boxes');\n        },\n        clear: () => {\n          console.warn('[MsdApi] debug.clear deprecated, use debug.disable(\"all\")');\n          this.disableDebugFeature('all');\n        }\n      },\n\n      performance: {\n        dump: () => this.getPerformanceData(),\n        counters: () => this.getPerformanceData().counters || {},\n        timers: () => this.getPerformanceData().timers || {}\n      },\n\n      pipeline: {\n        getResolvedModel: () => this.getResolvedModel(),\n        reRender: () => this.reRender(),\n        validate: () => this.getValidationIssues()\n      }\n    };\n\n    // Backward compatibility aliases (temporary - remove after migration)\n    window.cblcars.msd.listOverlays = (root) => this.listOverlays(root);\n    window.cblcars.msd.listAnchors = () => this.listAnchors();\n    window.cblcars.msd.getOverlayBBox = (id, root) => this.getOverlayBBox(id, root);\n    window.cblcars.msd.highlight = (ids, opts) => this.highlightOverlays(ids, opts);\n  }\n\n  static getWindow() {\n    if (typeof window !== 'undefined') return window;\n    if (typeof global !== 'undefined' && global.window) return global.window;\n    return null;\n  }\n\n  static listOverlays(root) {\n    try {\n      // Try to use MsdIntrospection if available\n      const window = this.getWindow();\n      const MsdIntrospection = window?.MsdIntrospection;\n\n      if (MsdIntrospection && MsdIntrospection.listOverlays) {\n        return MsdIntrospection.listOverlays(root);\n      }\n\n      // Fallback implementation\n      const overlays = [];\n      const resolvedModel = this.getResolvedModel();\n\n      if (resolvedModel && resolvedModel.overlays) {\n        resolvedModel.overlays.forEach(overlay => {\n          overlays.push({\n            id: overlay.id,\n            type: overlay.type,\n            bbox: this.getOverlayBBox(overlay.id, root),\n            hasErrors: false,\n            hasWarnings: false\n          });\n        });\n      }\n\n      return overlays;\n    } catch (_) {\n      return [];\n    }\n  }\n\n  static listAnchors() {\n    try {\n      const resolvedModel = this.getResolvedModel();\n      return Object.keys(resolvedModel?.anchors || {});\n    } catch (_) {\n      return [];\n    }\n  }\n\n  static getAnchor(id) {\n    try {\n      const resolvedModel = this.getResolvedModel();\n      return resolvedModel?.anchors?.[id] || null;\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static dumpAnchors() {\n    try {\n      const resolvedModel = this.getResolvedModel();\n      return { ...resolvedModel?.anchors } || {};\n    } catch (_) {\n      return {};\n    }\n  }\n\n  static getOverlayBBox(id, root) {\n    try {\n      // Try to use MsdIntrospection if available\n      const window = this.getWindow();\n      const MsdIntrospection = window?.MsdIntrospection;\n\n      if (MsdIntrospection && MsdIntrospection.getOverlayBBox) {\n        return MsdIntrospection.getOverlayBBox(id, root);\n      }\n\n      // Fallback: basic bbox from config\n      const resolvedModel = this.getResolvedModel();\n      const overlay = resolvedModel?.overlays?.find(o => o.id === id);\n\n      if (overlay && overlay.position && overlay.size) {\n        const pos = Array.isArray(overlay.position) ? overlay.position : [0, 0];\n        const size = Array.isArray(overlay.size) ? overlay.size : [100, 50];\n\n        return {\n          x: Number(pos[0]) || 0,\n          y: Number(pos[1]) || 0,\n          w: Number(size[0]) || 100,\n          h: Number(size[1]) || 50\n        };\n      }\n\n      return null;\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static highlightOverlays(ids, opts) {\n    try {\n      // Try to use MsdIntrospection if available\n      const window = this.getWindow();\n      const MsdIntrospection = window?.MsdIntrospection;\n\n      if (MsdIntrospection && MsdIntrospection.highlight) {\n        return MsdIntrospection.highlight(ids, opts);\n      }\n\n      // Fallback: log highlight request\n      console.log('[MSD API] Highlight request:', ids, opts);\n    } catch (_) {}\n  }\n\n  static getResolvedModel() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.pipelineInstance?.getResolvedModel?.() || null;\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static getPerformanceData() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.getPerf?.() || { timers: {}, counters: {} };\n    } catch (_) {\n      return { timers: {}, counters: {} };\n    }\n  }\n\n  static getValidationIssues() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.validation?.issues?.() || [];\n    } catch (_) {\n      return [];\n    }\n  }\n\n  static setDebugFlag(flag, value) {\n    try {\n      const window = this.getWindow();\n      window.cblcars = window.cblcars || {};\n      window.cblcars._debugFlags = window.cblcars._debugFlags || {};\n      window.cblcars._debugFlags[flag] = value;\n    } catch (_) {}\n  }\n\n  static clearDebugFlags() {\n    try {\n      const window = this.getWindow();\n      window.cblcars = window.cblcars || {};\n      window.cblcars._debugFlags = {\n        overlay: false,\n        connectors: false,\n        geometry: false\n      };\n    } catch (_) {}\n  }\n\n  static updateOverlay(id, data) {\n    // Future: Dynamic overlay updates\n    console.warn('[MSD API] Dynamic overlay updates not yet implemented');\n    return false;\n  }\n\n  static setAnchor(id, x, y) {\n    try {\n      const window = this.getWindow();\n      const result = window?.__msdDebug?.pipelineInstance?.setAnchor?.(id, [x, y]);\n      return result || { id, position: [x, y] };\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static reRender() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.pipelineInstance?.reRender?.() || { success: false };\n    } catch (_) {\n      return { success: false };\n    }\n  }\n\n  static enableDebugFeature(feature) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      if (feature === 'all') {\n        debugManager.enableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.enable(feature);\n      }\n    }\n  }\n\n  static disableDebugFeature(feature) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      if (feature === 'all') {\n        debugManager.disableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.disable(feature);\n      }\n    }\n  }\n\n  static toggleDebugFeature(feature) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      debugManager.toggle(feature);\n    }\n  }\n\n  static setDebugScale(scale) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      debugManager.setScale(scale);\n    }\n  }\n\n  static getDebugStatus() {\n    const debugManager = this.getDebugManager();\n    return debugManager ? debugManager.getSnapshot() : { error: 'DebugManager not available' };\n  }\n\n  static getDebugManager() {\n    const window = this.getWindow();\n    return window?.__msdDebug?.debugManager ||\n           window?.__msdDebug?.pipelineInstance?.systemsManager?.debugManager;\n  }\n}\n\n","import { stableStringify } from '../util/stableStringify.js';\n\nfunction stripMeta(item) {\n  if (!item || typeof item !== 'object') return item;\n  const { __meta, ...rest } = item;\n  return rest;\n}\n\nexport function exportCollapsed(merged) {\n  const raw = merged.__raw_msd || {};\n  // User-origin items only (origin_pack === 'user')\n  function userItems(col) {\n    return (merged[col] || [])\n      .filter(i => i.__meta?.origin_pack === 'user' && !i.__meta.removed)\n      .map(stripMeta);\n  }\n  const out = {\n    msd: {\n      version: raw.version || 1,\n      base_svg: raw.base_svg,\n      view_box: raw.view_box,\n      use_packs: raw.use_packs,\n      anchors: raw.anchors,\n      palettes: raw.palettes,\n      remove: raw.remove,\n      profiles: userItems('profiles'),\n      animations: userItems('animations'),\n      timelines: userItems('timelines'),\n      overlays: userItems('overlays'),\n      rules: userItems('rules'),\n      routing: raw.routing,\n      active_profiles: raw.active_profiles,\n      hud: raw.hud\n    }\n  };\n  // Prune empty/null keys\n  Object.keys(out.msd).forEach(k => {\n    if (out.msd[k] == null) delete out.msd[k];\n    else if (Array.isArray(out.msd[k]) && !out.msd[k].length) delete out.msd[k];\n    else if (typeof out.msd[k] === 'object' && !Array.isArray(out.msd[k]) && !Object.keys(out.msd[k]).length) delete out.msd[k];\n  });\n  return out;\n}\n\nexport function exportCollapsedJson(merged, pretty = true) {\n  return pretty ? JSON.stringify(exportCollapsed(merged), null, 2) : stableStringify(exportCollapsed(merged));\n}\n","import { stableStringify } from '../util/stableStringify.js';\n\nfunction stripMeta(item, includeMeta) {\n  if (includeMeta) return item;\n  if (!item || typeof item !== 'object') return item;\n  const { __meta, ...rest } = item;\n  return rest;\n}\n\nexport function exportFullSnapshot(merged, opts = {}) {\n  const include_meta = !!opts.include_meta;\n  function all(col) {\n    return (merged[col] || [])\n      .filter(i => !i.__meta?.removed)\n      .map(i => stripMeta(i, include_meta));\n  }\n  return {\n    msd: {\n      version: (merged.__raw_msd && merged.__raw_msd.version) || 1,\n      base_svg: merged.__raw_msd?.base_svg,\n      view_box: merged.__raw_msd?.view_box,\n      use_packs: merged.__raw_msd?.use_packs,\n      anchors: merged.__raw_msd?.anchors,\n      palettes: merged.palettes,\n      remove: merged.__raw_msd?.remove,\n      profiles: all('profiles'),\n      animations: all('animations'),\n      timelines: all('timelines'),\n      overlays: all('overlays'),\n      rules: all('rules'),\n      routing: merged.routing,\n      active_profiles: merged.active_profiles,\n      hud: merged.hud,\n      __provenance: include_meta ? merged.__provenance : undefined,\n      __issues: include_meta ? merged.__issues : undefined\n    }\n  };\n}\n\nexport function exportFullSnapshotJson(merged, opts = {}, pretty = true) {\n  return pretty ? JSON.stringify(exportFullSnapshot(merged, opts), null, 2) : stableStringify(exportFullSnapshot(merged, opts));\n}\n","import { stableStringify } from '../util/stableStringify.js';\n\nexport function diffItem(merged, collection, id) {\n  const chain = merged.__provenance?.[collection]?.[id];\n  if (!chain) return { id, collection, chain: [], final: null, removed: false };\n  const items = (merged[collection] || []).filter(i => i.id === id);\n  const final = items.length ? items[items.length - 1] : null;\n  return {\n    id,\n    collection,\n    chain,\n    removed: chain.some(c => c.removed),\n    final_summary: final ? summarize(final) : null,\n    chain_summaries: chain.map(s => ({\n      layer: s.layer_id,\n      overridden: s.overridden,\n      removed: s.removed,\n      checksum: s.checksum,\n      diff: s.diff\n    }))\n  };\n}\n\nfunction summarize(item) {\n  if (!item) return null;\n  const copy = { ...item };\n  delete copy.__meta;\n  return JSON.parse(stableStringify(copy));\n}\n","export function stableStringify(value) {\n  const seen = new WeakSet();\n  function walk(v) {\n    if (v === null || typeof v !== 'object') return JSON.stringify(v);\n    if (seen.has(v)) return '\"[Circular]\"';\n    seen.add(v);\n    if (Array.isArray(v)) return '[' + v.map(walk).join(',') + ']';\n    const keys = Object.keys(v).sort();\n    return '{' + keys.map(k => JSON.stringify(k) + ':' + walk(v[k])).join(',') + '}';\n  }\n  return walk(value);\n}\n","import { processAndValidateConfig } from './ConfigProcessor.js';\nimport { SystemsManager } from './SystemsManager.js';\nimport { ModelBuilder } from './ModelBuilder.js';\nimport { setupDebugInterface } from '../debug/DebugInterface.js';\nimport { buildCardModel } from '../model/CardModel.js';\nimport { MsdApi } from '../api/MsdApi.js';\nimport { exportCollapsed, exportCollapsedJson } from '../export/exportCollapsed.js';\nimport { exportFullSnapshot, exportFullSnapshotJson } from '../export/exportFullSnapshot.js';\nimport { diffItem } from '../export/diffItem.js';\nimport { perfGetAll } from '../perf/PerfCounters.js';\n\n/**\n * Initialize the MSD processing/rendering pipeline.\n * Handles config merge/validation, system initialization, initial render,\n * debug interface binding, and exposes a unified pipeline API.\n *\n * @param {Object} userMsdConfig - User supplied MSD config.\n * @param {HTMLElement|ShadowRoot} mountEl - Mount/root element (may be a shadowRoot).\n * @param {Object|null} hass - Home Assistant instance (if available).\n * @returns {Promise<Object>} Pipeline API\n */\nexport async function initMsdPipeline(userMsdConfig, mountEl, hass = null) {\n  // Process and validate configuration\n  const { mergedConfig, issues, provenance } = await processAndValidateConfig(userMsdConfig);\n\n  // Handle validation errors\n  if (issues.errors.length) {\n    console.error('[MSD v1] Validation errors  pipeline disabled', issues.errors);\n    return createDisabledPipeline(mergedConfig, issues, provenance);\n  }\n\n  // Build card model\n  const cardModel = await buildCardModel(mergedConfig);\n\n  // Ensure anchors are available\n  if (!cardModel.anchors) cardModel.anchors = {};\n  if (!Object.keys(cardModel.anchors).length) {\n    if (mergedConfig.anchors && Object.keys(mergedConfig.anchors).length) {\n      cardModel.anchors = { ...mergedConfig.anchors };\n      console.info('[MSD v1] Adopted user anchors');\n    }\n  }\n\n  // Initialize all systems\n  const systemsManager = new SystemsManager();\n  await systemsManager.initializeSystems(mergedConfig, cardModel, mountEl, hass);\n\n  // ADDED: Set original HASS for clean controls separation\n  if (hass) {\n      systemsManager.setOriginalHass(hass);\n  }\n\n  // CRITICAL FIX: Ensure essential subsystems are available for overlay rendering\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.debugManager = systemsManager.debugManager;\n    window.__msdDebug.routing = systemsManager.router;\n\n    // Make core systems available BEFORE any overlay rendering\n    window.__msdDebug.pipelineInstance = {\n      systemsManager: systemsManager,\n      dataSourceManager: systemsManager.dataSourceManager\n    };\n\n    console.log('[MSD v1] Essential subsystems ready for overlay rendering:', {\n      hasSystemsManager: !!systemsManager,\n      hasDataSourceManager: !!systemsManager.dataSourceManager,\n      dataSourceCount: systemsManager.dataSourceManager?.listIds?.()?.length || 0\n    });\n  }\n\n  // VALIDATION: Don't proceed with overlay rendering if essential systems aren't ready\n  if (!systemsManager.dataSourceManager) {\n    console.warn('[MSD v1] DataSourceManager not available - overlay template processing will be limited');\n  }\n\n  // EARLY DEBUG BOOTSTRAP (Before first render):\n  // Provide a minimal __msdDebug object so debug renderers that run during the first render\n  // can access routing / perf safely. This prevents timing race warnings for routing guides.\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    // Only set if not already present to avoid clobbering previous instrumentation\n    if (!window.__msdDebug.routing) {\n      window.__msdDebug.routing = systemsManager.router;\n    }\n    if (!window.__msdDebug.getPerf) {\n      window.__msdDebug.getPerf = () => perfGetAll();\n    }\n    if (!window.__msdDebug.systemsManager) {\n      window.__msdDebug.systemsManager = systemsManager;\n    }\n    // Dispatch an event so listeners (e.g., MsdDebugRenderer) can react when routing is ready.\n    try {\n      window.dispatchEvent(new CustomEvent('msd-routing-ready'));\n    } catch (e) {\n      // Non-fatal; older browsers or sandbox contexts might block custom events.\n    }\n  }\n\n  // Initialize model builder\n  const modelBuilder = new ModelBuilder(mergedConfig, cardModel, systemsManager);\n\n  // ADDED: Store ModelBuilder reference in SystemsManager for accessibility\n  systemsManager.modelBuilder = modelBuilder;\n\n  /**\n   * Internal re-render function that recomputes the model\n   * and triggers the AdvancedRenderer + debug visualization pipeline.\n   * @returns {Object|undefined} Renderer result object\n   */\n  async function reRender() {\n    console.log('[MSD DEBUG]  reRender() ENTRY', {\n      timestamp: new Date().toISOString(),\n      renderInProgress: systemsManager._renderInProgress,\n      stackTrace: new Error().stack.split('\\n').slice(1, 4).join('\\n')\n    });\n\n    // IMPROVED: Queue renders instead of blocking them\n    if (systemsManager._renderInProgress) {\n      console.log('[MSD DEBUG]  Render in progress, queueing re-render');\n      systemsManager._queuedReRender = true;\n      return { success: false, reason: 'render_in_progress', queued: true };\n    }\n\n    systemsManager._renderInProgress = true;\n    systemsManager._queuedReRender = false;\n\n    try {\n      console.log('[MSD DEBUG]  Computing resolved model...');\n      const startTime = performance.now();\n      const resolvedModel = modelBuilder.computeResolvedModel();\n\n      console.log('[MSD DEBUG]  Resolved model computed:', {\n        overlayCount: resolvedModel.overlays.length,\n        controlOverlays: resolvedModel.overlays.filter(o => o.type === 'control').length,\n        hasAnchors: !!resolvedModel.anchors,\n        hasViewBox: !!resolvedModel.viewBox\n      });\n\n      console.log(`[MSD DEBUG]  Starting AdvancedRenderer.render() - overlays: ${resolvedModel.overlays.length}`);\n\n      // ADDED: Defensive rendering with error boundary\n      let renderResult;\n      try {\n        renderResult = systemsManager.renderer.render(resolvedModel);\n        console.log('[MSD DEBUG]  AdvancedRenderer.render() completed successfully:', renderResult);\n      } catch (renderError) {\n        console.error('[MSD DEBUG]  AdvancedRenderer.render() FAILED:', renderError);\n        console.error('[MSD DEBUG]  Render error stack:', renderError.stack);\n        return { success: false, error: renderError.message, phase: 'advanced_renderer' };\n      }\n\n      console.log('[MSD DEBUG]  Starting renderDebugAndControls()...');\n      // CHANGED: Make debug and controls rendering more defensive\n      try {\n        await systemsManager.renderDebugAndControls(resolvedModel, mountEl);\n        console.log('[MSD DEBUG]  renderDebugAndControls() completed successfully');\n      } catch (debugControlsError) {\n        console.error('[MSD DEBUG]  renderDebugAndControls() FAILED:', debugControlsError);\n        console.error('[MSD DEBUG]  Debug/Controls error stack:', debugControlsError.stack);\n        // Don't fail the entire render - just log the error\n        console.warn('[MSD DEBUG]  Continuing without debug/controls rendering due to error');\n      }\n\n      const renderTime = performance.now() - startTime;\n      console.log(`[MSD DEBUG]  reRender() COMPLETED in ${renderTime.toFixed(2)}ms`);\n\n      return renderResult || { success: true };\n\n    } catch (error) {\n      console.error('[MSD DEBUG]  reRender() COMPLETELY FAILED:', error);\n      console.error('[MSD DEBUG]  Complete failure stack:', error.stack);\n      return { success: false, error: error.message };\n    } finally {\n      systemsManager._renderInProgress = false;\n      console.log('[MSD DEBUG]  reRender() FINALLY block - _renderInProgress reset to false');\n\n      // IMPROVED: Execute queued re-render if one was requested\n      if (systemsManager._queuedReRender) {\n        console.log('[MSD DEBUG]  Executing queued re-render');\n        systemsManager._queuedReRender = false;\n        // Use setTimeout to avoid immediate recursion and allow stack to clear\n        setTimeout(() => reRender(), 50);\n      }\n    }\n  }\n\n  // Connect reRender callback to systems\n  systemsManager.setReRenderCallback(reRender);\n\n  // Initial render - CHANGED: Make async\n  console.log('[MSD v1] Computing initial resolved model');\n  console.log('[MSD v1] DataSourceManager status:', {\n    sourcesCount: systemsManager.dataSourceManager?.getAllSources?.()?.length || 0,\n    entityCount: systemsManager.dataSourceManager?.listIds?.()?.length || 0\n  });\n\n  const initialRenderResult = await reRender();\n\n  console.log('[MSD v1] Initial render completed:', {\n    overlayCount: initialRenderResult?.overlayCount || 0,\n    errors: initialRenderResult?.errors || 0\n  });\n\n  // Create pipeline API\n  const pipelineApi = createPipelineApi(\n    mergedConfig, cardModel, systemsManager, modelBuilder, reRender\n  );\n\n  // Setup debug interface with DebugManager integration\n  setupDebugInterface(pipelineApi, mergedConfig, provenance, systemsManager, modelBuilder);\n\n  // Initialize HUD service with mount element\n  if (typeof window !== 'undefined' && window.__msdDebug?.hud?.setMountElement) {\n    window.__msdDebug.hud.setMountElement(mountEl);\n  }\n\n  // Attach unified API\n  console.log('[MSD v1] Attaching unified API');\n  MsdApi.attach();\n\n  // Augment debug tracking (now that pipelineApi exists)\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.validation = { issues: () => mergedConfig.__issues };\n    window.__msdDebug.pipelineInstance = pipelineApi;\n    window.__msdDebug._provenance = provenance;\n\n    // Ensure routing reference is consistent (in case late changes happened)\n    if (!window.__msdDebug.routing) {\n      window.__msdDebug.routing = systemsManager.router;\n      try {\n        window.dispatchEvent(new CustomEvent('msd-routing-ready'));\n      } catch(_) {}\n    }\n  }\n\n  console.log('[MSD v1] Pipeline initialization complete');\n  return pipelineApi;\n}\n\nfunction createDisabledPipeline(mergedConfig, issues, provenance) {\n  const disabledPipeline = {\n    enabled: false,\n    errors: issues.errors,\n    warnings: issues.warnings,\n    getResolvedModel: () => null,\n    ingestHass: () => {},\n    updateEntities: () => {},\n    listEntities: () => [],\n    getEntity: () => null,\n    getActiveProfiles: () => [],\n    getAnchors: () => (mergedConfig.anchors || {}),\n    repairAnchorsFromMerged: () => false,\n    exportCollapsed: () => null,\n    exportCollapsedJson: () => 'null',\n    exportFullSnapshot: () => null,\n    exportFullSnapshotJson: () => 'null',\n    diffItem: () => null,\n    getPerf: () => ({})\n  };\n\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.validation = { issues: () => mergedConfig.__issues };\n    window.__msdDebug.pipelineInstance = disabledPipeline;\n    window.__msdDebug._provenance = provenance;\n  }\n  return disabledPipeline;\n}\n\n/**\n * Creates and returns the MSD pipeline external API.\n * @param {Object} mergedConfig\n * @param {Object} cardModel\n * @param {SystemsManager} systemsManager\n * @param {ModelBuilder} modelBuilder\n * @param {Function} reRender\n * @returns {Object} API\n */\nfunction createPipelineApi(mergedConfig, cardModel, systemsManager, modelBuilder, reRender) {\n  const api = {\n    enabled: true,\n    version: mergedConfig.version || 1,\n    config: mergedConfig,\n\n    // Core systems\n    systemsManager,\n    dataSourceManager: systemsManager.dataSourceManager,\n    rulesEngine: systemsManager.rulesEngine,\n    renderer: systemsManager.renderer,\n    router: systemsManager.router,\n\n    /**\n     * Inspect routing for a given overlay id and compute path data.\n     * @param {string} id\n     * @returns {Object|null}\n     */\n    routingInspect: (id) => {\n      const resolvedModel = modelBuilder.getResolvedModel();\n      const ov = (resolvedModel?.overlays || []).find(o => o.id === id);\n      if (!ov) return null;\n      const raw = ov._raw || ov.raw || {};\n      const a1 = cardModel.anchors[raw.anchor];\n      const a2 = cardModel.anchors[raw.attach_to] || cardModel.anchors[raw.attachTo];\n      if (!a1 || !a2) return null;\n      const req = systemsManager.router.buildRouteRequest(ov, a1, a2);\n      return systemsManager.router.computePath(req);\n    },\n\n    getResolvedModel: () => modelBuilder.getResolvedModel(),\n\n    /**\n     * Force a manual re-render.\n     */\n    reRender: () => {\n      try {\n        console.log('[MSD v1] Manual re-render triggered');\n        return reRender();\n      } catch (error) {\n        console.error('[MSD v1] Manual re-render failed:', error);\n        return { success: false, error: error.message };\n      }\n    },\n\n    /**\n     * Set or update an anchor point.\n     * @param {string} id\n     * @param {Array<number>} pt\n     * @returns {boolean}\n     */\n    setAnchor(id, pt) {\n      if (!id || !Array.isArray(pt) || pt.length !== 2) return false;\n      if (!cardModel.anchors) cardModel.anchors = {};\n      cardModel.anchors[id] = [Number(pt[0]), Number(pt[1])];\n      const resolvedModel = modelBuilder.getResolvedModel();\n      if (resolvedModel?.anchors) resolvedModel.anchors[id] = cardModel.anchors[id];\n      systemsManager.router.invalidate && systemsManager.router.invalidate('*');\n      try {\n        if (systemsManager.renderer && resolvedModel) {\n          systemsManager.renderer._routerOverlaySync = false;\n          systemsManager.renderer.render(resolvedModel);\n        }\n      } catch(_) {}\n      return true;\n    },\n\n    ingestHass: (hass) => systemsManager.ingestHass(hass),\n    updateEntities: (map) => systemsManager.updateEntities(map),\n    listEntities: () => systemsManager.entityRuntime.listIds(),\n    getEntity: (id) => systemsManager.entityRuntime.getEntity(id),\n    getActiveProfiles: () => modelBuilder.runtimeActiveProfiles.slice(),\n    getAnchors: () => ({ ...cardModel.anchors }),\n    exportCollapsed: () => exportCollapsed(userMsdConfig),\n    exportCollapsedJson: () => JSON.stringify(exportCollapsed(userMsdConfig)),\n    exportFullSnapshot: () => exportFullSnapshot(mergedConfig),\n    exportFullSnapshotJson: () => JSON.stringify(exportFullSnapshot(mergedConfig)),\n    diffItem: (item) => diffItem(item),\n    getPerf: () => perfGetAll(),\n\n    // Add debug API powered by DebugManager\n    debug: {\n      enable: (feature) => systemsManager.debugManager.enable(feature),\n      disable: (feature) => systemsManager.debugManager.disable(feature),\n      toggle: (feature) => systemsManager.debugManager.toggle(feature),\n      setScale: (scale) => systemsManager.debugManager.setScale(scale),\n      status: () => systemsManager.debugManager.getSnapshot(),\n      onChange: (callback) => systemsManager.debugManager.onChange(callback)\n    },\n\n    getDataSourceManager: () => systemsManager.dataSourceManager,\n    _reRenderCallback: reRender\n  };\n\n  return api;\n}\n\n","import { mergePacks } from '../packs/mergePacks.js';\nimport { validateMerged } from '../validation/validateMerged.js';\n\nexport { mergePacks, validateMerged };\n\nexport async function processAndValidateConfig(userMsdConfig) {\n  const mergedConfig = await mergePacks(userMsdConfig);\n  const provenance = mergedConfig.__provenance;\n\n  // Store original user config in debug namespace\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug._originalUserConfig = userMsdConfig;\n  }\n\n  // Validation pass\n  const t0 = performance.now();\n  const issues = validateMerged(mergedConfig);\n  mergedConfig.__issues = issues;\n  const t1 = performance.now();\n  try { window.__msdDebug && (window.__msdDebug._validationMs = (t1 - t0)); } catch {}\n\n  // Anchor validation - UPDATED to accept overlay IDs as virtual anchors\n  try {\n    const existingCodes = new Set(issues.errors.map(e=>e.code));\n    const anchorSet = new Set(Object.keys(mergedConfig.anchors || {}));\n\n    // Add overlay IDs as valid anchor targets (same as in validateMerged)\n    const overlayIds = new Set();\n    (mergedConfig.overlays || []).forEach(overlay => {\n      if (overlay && overlay.id) {\n        overlayIds.add(overlay.id);\n        anchorSet.add(overlay.id); // Make overlay IDs valid anchor targets\n      }\n    });\n\n    (mergedConfig.overlays || []).forEach(o=>{\n      if (!o || !o.id) return;\n      const aRefs = [];\n      if (typeof o.anchor === 'string') aRefs.push(o.anchor);\n      if (typeof o.attach_to === 'string') aRefs.push(o.attach_to);\n      if (typeof o.attachTo === 'string') aRefs.push(o.attachTo);\n      aRefs.forEach(ref=>{\n        if (ref && !anchorSet.has(ref)) {\n          const code = 'anchor.missing';\n          if (!existingCodes.has(`${code}:${ref}:${o.id}`)) {\n            issues.errors.push({ code, severity:'error', overlay:o.id, anchor:ref, msg:`Overlay ${o.id} references missing anchor '${ref}'` });\n            existingCodes.add(`${code}:${ref}:${o.id}`);\n          }\n        }\n      });\n    });\n  } catch(_) {}\n\n  return { mergedConfig, issues, provenance };\n}\n\nexport async function processMsdConfig(userMsdConfig) {\n  try {\n    const preValidation = validateMerged(userMsdConfig);\n    const mergedConfig = await mergePacks(userMsdConfig);\n    const postValidation = validateMerged(mergedConfig);\n\n    const issues = {\n      errors: [...preValidation.errors, ...postValidation.errors],\n      warnings: [...preValidation.warnings, ...postValidation.warnings]\n    };\n\n    if (issues.errors.length > 0) {\n      console.error('MSD validation errors:', issues.errors);\n    }\n\n    if (issues.warnings.length > 0) {\n      console.warn('MSD validation warnings:', issues.warnings);\n    }\n\n    return {\n      config: mergedConfig,\n      validation: issues\n    };\n\n  } catch (error) {\n    console.error('MSD processing failed:', error);\n    throw error;\n  }\n}\n","import { perfGetAll } from '../perf/PerfCounters.js';\nimport { MsdIntrospection } from '../introspection/MsdIntrospection.js';\n\nexport function setupDebugInterface(pipelineApi, mergedConfig, provenance, systemsManager, modelBuilder) {\n  if (typeof window === 'undefined') return;\n\n  const dbg = window.__msdDebug = window.__msdDebug || {};\n\n  // Extract debug config from mergedConfig\n  const debugConfig = mergedConfig?.debug || {};\n\n  // REDUCED: Minimal startup logging\n  console.log('[MSD v1] Debug interface ready - type window.__msdDebug.help() for usage');\n\n  // Core pipeline access - UNIFIED: Only set pipelineInstance\n  dbg.pipelineInstance = pipelineApi;\n\n  // Add backward compatibility getter with deprecation warning\n  if (!dbg.hasOwnProperty('pipeline')) {\n    Object.defineProperty(dbg, 'pipeline', {\n      get() {\n        console.warn('[MSD Debug] window.__msdDebug.pipeline is deprecated. Use window.__msdDebug.pipelineInstance instead.');\n        return this.pipelineInstance;\n      },\n      configurable: true\n    });\n  }\n\n  dbg._provenance = provenance;\n\n  // Routing system\n  setupRoutingDebugInterface(dbg, pipelineApi, systemsManager);\n\n  // Data sources - our current entity management system\n  setupDataSourceDebugInterface(dbg, systemsManager);\n\n  // Rendering and debug visualization - now with config control\n  setupRenderingDebugInterface(dbg, systemsManager, modelBuilder, pipelineApi, debugConfig);\n\n  // Performance and validation\n  setupUtilityDebugInterface(dbg, mergedConfig, systemsManager);\n\n  console.log('[MSD v1] Debug interface setup complete');\n  console.log('[MSD v1] Available methods:', Object.keys(dbg));\n\n  // Log debug config state (REDUCED)\n  if (debugConfig.enabled) {\n    console.log('[MSD v1] Debug mode enabled');\n  }\n}\n\n// ...existing code...\n\nfunction setupRoutingDebugInterface(dbg, pipelineApi, systemsManager) {\n  dbg.routing = {\n    inspect: (id) => pipelineApi.routingInspect(id),\n    invalidate: (id='*') => systemsManager.router.invalidate(id),\n    stats: () => {\n      try {\n        return systemsManager.router.stats?.() || { cacheHits: 0, pathsComputed: 0, invalidations: 0 };\n      } catch (e) {\n        console.warn('[MSD v1] routing.stats failed:', e);\n        return { cacheHits: 0, pathsComputed: 0, invalidations: 0, error: e.message };\n      }\n    },\n    inspectAs: (id, modeFull='smart') => {\n      try {\n        const model = pipelineApi.getResolvedModel?.();\n        if (!model) return null;\n        const ov = model.overlays.find(o => o.id === id);\n        if (!ov) return null;\n        ov._raw = ov._raw || {};\n        const original = ov._raw.route_mode_full;\n        ov._raw.route_mode_full = modeFull;\n        systemsManager.router.invalidate && systemsManager.router.invalidate('*');\n        const res = dbg.routing.inspect(id);\n        ov._raw.route_mode_full = original;\n        systemsManager.router.invalidate && systemsManager.router.invalidate('*');\n        return res;\n      } catch (e) {\n        console.warn('[MSD v1] inspectAs failed', e);\n        return null;\n      }\n    }\n  };\n}\n\nfunction setupDataSourceDebugInterface(dbg, systemsManager) {\n  // ENHANCED: Make this the primary entity access system\n  if (!dbg.hasOwnProperty('dataSources')) {\n    dbg.dataSources = {\n      stats: () => systemsManager.dataSourceManager?.getStats() || { error: 'DataSourceManager not initialized' },\n      list: () => systemsManager.dataSourceManager ? Array.from(systemsManager.dataSourceManager.sources.keys()) : [],\n      get: (name) => systemsManager.dataSourceManager?.getSource(name)?.getStats() || null,\n      dump: () => systemsManager.dataSourceManager?.debugDump() || { error: 'DataSourceManager not initialized' },\n      manager: () => systemsManager.dataSourceManager\n    };\n  } else {\n    // If dataSources already exists (from index.js getter), enhance it with additional methods\n    try {\n      Object.assign(dbg.dataSources, {\n        list: () => systemsManager.dataSourceManager ? Array.from(systemsManager.dataSourceManager.sources.keys()) : [],\n        get: (name) => systemsManager.dataSourceManager?.getSource(name)?.getStats() || null,\n        dump: () => systemsManager.dataSourceManager?.debugDump() || { error: 'DataSourceManager not initialized' }\n      });\n    } catch (error) {\n      // If we can't enhance it (getter-only), create alternative access\n      dbg.dataSourcesDebug = {\n        stats: () => systemsManager.dataSourceManager?.getStats() || { error: 'DataSourceManager not initialized' },\n        list: () => systemsManager.dataSourceManager ? Array.from(systemsManager.dataSourceManager.sources.keys()) : [],\n        get: (name) => systemsManager.dataSourceManager?.getSource(name)?.getStats() || null,\n        dump: () => systemsManager.dataSourceManager?.debugDump() || { error: 'DataSourceManager not initialized' },\n        manager: () => systemsManager.dataSourceManager\n      };\n      console.log('[DebugInterface] Created dataSourcesDebug as alternative access due to getter conflict');\n    }\n  }\n\n  // ADDED: Legacy compatibility layer for any remaining entity access patterns\n  // This provides entity-like access through DataSourceManager\n  dbg.entities = {\n    list: () => {\n      console.warn('[MSD Debug] entities.list() is deprecated. Use window.__msdDebug.dataSourceManager.listIds() instead.');\n      return systemsManager.dataSourceManager?.listIds() || [];\n    },\n    get: (id) => {\n      console.warn('[MSD Debug] entities.get() is deprecated. Use window.__msdDebug.dataSourceManager.getEntity() instead.');\n      return systemsManager.dataSourceManager?.getEntity(id) || null;\n    },\n    stats: () => {\n      console.warn('[MSD Debug] entities.stats() is deprecated. Use window.__msdDebug.dataSources.stats() instead.');\n      const dsStats = systemsManager.dataSourceManager?.getStats() || {};\n      const entityCount = systemsManager.dataSourceManager?.listIds()?.length || 0;\n\n      // Transform DataSourceManager stats to legacy format for compatibility\n      return {\n        count: entityCount,\n        subscribed: Object.keys(dsStats.sources || {}).length,\n        updated: Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.received || 0), 0),\n        cacheHits: Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.cacheHits || 0), 0)\n      };\n    }\n  };\n}\n\nfunction setupRenderingDebugInterface(dbg, systemsManager, modelBuilder, pipelineApi, debugConfig) {\n  // REDUCED: Minimal setup logging\n  const debugManager = systemsManager.debugManager;\n\n  // Enhanced debug object powered by DebugManager\n  dbg.debug = {\n    // Core feature control methods using DebugManager\n    enable: (feature) => {\n      if (feature === 'all') {\n        debugManager.enableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.enable(feature);\n      }\n\n      // FIXED: More aggressive re-render after enabling with proper timing\n      setTimeout(() => {\n        try {\n          const pipelineInstance = window.__msdDebug?.pipelineInstance;\n          if (pipelineInstance?.reRender) {\n            console.log('[MSD Debug] Force re-render after enable:', feature);\n            pipelineInstance.reRender();\n          }\n        } catch (error) {\n          console.warn('[MSD Debug] Failed to trigger re-render:', error);\n        }\n      }, 10);\n    },\n\n    disable: (feature) => {\n      if (feature === 'all') {\n        debugManager.disableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.disable(feature);\n      }\n\n      // FIXED: More aggressive re-render after disabling with proper timing\n      setTimeout(() => {\n        try {\n          const pipelineInstance = window.__msdDebug?.pipelineInstance;\n          if (pipelineInstance?.reRender) {\n            console.log('[MSD Debug] Force re-render after disable:', feature);\n            pipelineInstance.reRender();\n          }\n        } catch (error) {\n          console.warn('[MSD Debug] Failed to trigger re-render:', error);\n        }\n      }, 10);\n    },\n\n    // Manual debug render test\n    testRender: () => {\n      console.log('[MSD Debug] Testing debug render directly...');\n      try {\n        const debugState = debugManager.getSnapshot();\n        console.log('[MSD Debug] Current state:', debugState);\n\n        // Get pipeline instance to access the shadowRoot context\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (!pipelineInstance) {\n          console.warn('[MSD Debug] No pipeline instance available');\n          return;\n        }\n\n        // Try to get the shadowRoot from the systems manager\n        const systemsManager = pipelineInstance.systemsManager;\n        if (!systemsManager) {\n          console.warn('[MSD Debug] No systems manager available');\n          return;\n        }\n\n        // Use the renderer's mount element (shadowRoot)\n        const mountEl = systemsManager.renderer?.mountEl;\n        if (!mountEl) {\n          console.warn('[MSD Debug] No mount element found in renderer');\n          return;\n        }\n\n        console.log('[MSD Debug] Found mount element:', mountEl.constructor.name);\n\n        // Get resolved model for proper context\n        const resolvedModel = pipelineInstance.getResolvedModel();\n        if (!resolvedModel) {\n          console.warn('[MSD Debug] No resolved model available');\n          return;\n        }\n\n        console.log('[MSD Debug] Calling renderDebugAndControls with shadowRoot context');\n        systemsManager.renderDebugAndControls(resolvedModel, mountEl);\n\n      } catch (error) {\n        console.error('[MSD Debug] testRender failed:', error);\n      }\n    },\n\n    // Scale control via DebugManager\n    setScale: (scale) => debugManager.setScale(scale),\n\n    // Status from DebugManager - FIXED: Use silent method by default\n    status: () => {\n      const state = debugManager.getSnapshot();\n      console.table(state);\n      return state;\n    },\n\n    // ADDED: Silent status access for programmatic use\n    getStatus: () => debugManager.getSnapshot(),\n\n    // Subscribe to DebugManager changes\n    onChange: (callback) => debugManager.onChange(callback),\n\n    // Manual refresh triggers re-render\n    refresh: () => {\n      try {\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (pipelineInstance?.reRender) {\n          pipelineInstance.reRender();\n          console.log('[MSD Debug] Debug overlays refreshed');\n        }\n      } catch (error) {\n        console.warn('[MSD Debug] Failed to trigger pipeline re-render:', error);\n      }\n    },\n\n    // Convenient nested methods using DebugManager\n    anchors: {\n      show: () => debugManager.enable('anchors'),\n      hide: () => debugManager.disable('anchors'),\n      toggle: () => debugManager.toggle('anchors')\n    },\n\n    bounding: {\n      show: () => debugManager.enable('bounding_boxes'),\n      hide: () => debugManager.disable('bounding_boxes'),\n      toggle: () => debugManager.toggle('bounding_boxes'),\n      // ADDED: Test bounding box accuracy for specific overlay\n      test: (overlayId) => {\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (!pipelineInstance) {\n          console.warn('[MSD Debug] No pipeline instance available');\n          return null;\n        }\n\n        const model = pipelineInstance.getResolvedModel?.();\n        if (!model) {\n          console.warn('[MSD Debug] No resolved model available');\n          return null;\n        }\n\n        const overlay = model.overlays.find(o => o.id === overlayId);\n        if (!overlay) {\n          console.warn(`[MSD Debug] Overlay \"${overlayId}\" not found`);\n          return null;\n        }\n\n        // Get the debug renderer from systems manager\n        const debugRenderer = systemsManager.debugRenderer;\n        if (!debugRenderer) {\n          console.warn('[MSD Debug] Debug renderer not available');\n          return null;\n        }\n\n        const position = overlay.position;\n        if (!position || !Array.isArray(position)) {\n          console.warn(`[MSD Debug] Invalid position for overlay \"${overlayId}\"`);\n          return null;\n        }\n\n        const [x, y] = position;\n        const dimensions = debugRenderer._getOverlayDimensions(overlay, x, y);\n\n        console.log(`[MSD Debug] Bounding box test for \"${overlayId}\":`, {\n          overlay: {\n            id: overlay.id,\n            type: overlay.type,\n            position: [x, y]\n          },\n          calculatedDimensions: dimensions,\n          overlayConfig: {\n            text: overlay.text || overlay.content || overlay._raw?.content,\n            style: overlay.finalStyle || overlay.style\n          }\n        });\n\n        return dimensions;\n      },\n      // ADDED: Compare bounding box calculation methods\n      compare: (overlayId) => {\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (!pipelineInstance) {\n          console.warn('[MSD Debug] No pipeline instance available');\n          return null;\n        }\n\n        const model = pipelineInstance.getResolvedModel?.();\n        if (!model) {\n          console.warn('[MSD Debug] No resolved model available');\n          return null;\n        }\n\n        const overlay = model.overlays.find(o => o.id === overlayId);\n        if (!overlay || overlay.type !== 'text') {\n          console.warn(`[MSD Debug] Text overlay \"${overlayId}\" not found`);\n          return null;\n        }\n\n        const [x, y] = overlay.position || [0, 0];\n        const debugRenderer = systemsManager.debugRenderer;\n\n        const results = {\n          overlayId,\n          position: [x, y],\n          methods: {}\n        };\n\n        // Method 1: Debug renderer calculation\n        if (debugRenderer) {\n          try {\n            const debugDims = debugRenderer._getOverlayDimensions(overlay, x, y);\n            results.methods.debugRenderer = debugDims;\n          } catch (error) {\n            results.methods.debugRenderer = { error: error.message };\n          }\n        }\n\n        // Method 2: TextOverlayRenderer computation\n        try {\n          const container = systemsManager.renderer?.mountEl;\n          const attachmentData = window.cblcars?.TextOverlayRenderer?.computeAttachmentPoints?.(\n            overlay,\n            model.anchors || {},\n            container\n          );\n          if (attachmentData?.bbox) {\n            results.methods.textOverlayRenderer = {\n              x: attachmentData.bbox.left,\n              y: attachmentData.bbox.top,\n              width: attachmentData.bbox.width,\n              height: attachmentData.bbox.height\n            };\n          }\n        } catch (error) {\n          results.methods.textOverlayRenderer = { error: error.message };\n        }\n\n        // Method 3: DOM getBBox (if rendered)\n        try {\n          const container = systemsManager.renderer?.mountEl;\n          const svgElement = container?.querySelector('svg');\n          const renderedElement = svgElement?.querySelector(`[data-overlay-id=\"${overlayId}\"]`);\n          if (renderedElement) {\n            const bbox = renderedElement.getBBox();\n            results.methods.domGetBBox = {\n              x: bbox.x,\n              y: bbox.y,\n              width: bbox.width,\n              height: bbox.height\n            };\n          }\n        } catch (error) {\n          results.methods.domGetBBox = { error: error.message };\n        }\n\n        // Method 4: Data attributes (if set by TextOverlayRenderer)\n        try {\n          const container = systemsManager.renderer?.mountEl;\n          const svgElement = container?.querySelector('svg');\n          const renderedElement = svgElement?.querySelector(`[data-overlay-id=\"${overlayId}\"]`);\n          if (renderedElement) {\n            const width = renderedElement.getAttribute('data-text-width');\n            const height = renderedElement.getAttribute('data-text-height');\n            const fontSize = renderedElement.getAttribute('data-font-size');\n            const dominantBaseline = renderedElement.getAttribute('data-dominant-baseline');\n            const textAnchor = renderedElement.getAttribute('data-text-anchor');\n\n            if (width && height) {\n              // Use proper baseline calculation like the debug renderer\n              let adjustedY = y;\n              const textHeight = parseFloat(height);\n              const textFontSize = parseFloat(fontSize) || 16;\n              const actualBaseline = dominantBaseline || 'auto';\n\n              if (actualBaseline === 'hanging') {\n                adjustedY = y;\n              } else if (actualBaseline === 'middle' || actualBaseline === 'central') {\n                adjustedY = y - textHeight / 2;\n              } else if (actualBaseline === 'text-after-edge') {\n                adjustedY = y - textHeight;\n              } else {\n                const ascent = textFontSize * 0.7;\n                adjustedY = y - ascent;\n              }\n\n              // Also calculate X position based on text anchor\n              let adjustedX = x;\n              const textWidth = parseFloat(width);\n              const actualTextAnchor = textAnchor || 'start';\n\n              if (actualTextAnchor === 'middle') {\n                adjustedX = x - textWidth / 2;\n              } else if (actualTextAnchor === 'end') {\n                adjustedX = x - textWidth;\n              }\n\n              results.methods.dataAttributes = {\n                x: adjustedX,\n                y: adjustedY,\n                width: textWidth,\n                height: textHeight,\n                baseline: actualBaseline,\n                anchor: actualTextAnchor\n              };\n            }\n          }\n        } catch (error) {\n          results.methods.dataAttributes = { error: error.message };\n        }        console.table(results.methods);\n        return results;\n      }\n    },\n\n    routing: {\n      show: () => debugManager.enable('routing'),\n      hide: () => debugManager.disable('routing'),\n      toggle: () => debugManager.toggle('routing')\n    },\n\n    performance: {\n      show: () => debugManager.enable('performance'),\n      hide: () => debugManager.disable('performance'),\n      toggle: () => debugManager.toggle('performance')\n    }\n  };\n\n  /*\n  // Keep the shadowRoot tracking code - it's still used by testRender and other methods\n  let debugShadowRoot = null;\n  let lastUsedRoot = null;\n  */\n\n  /**\n   * Store the shadowRoot context from the render call\n   * This allows us to find elements within the correct scope later\n   */\n  /*\n  function setDebugContext(root) {\n    if (root && root.querySelector) {\n      debugShadowRoot = root;\n      lastUsedRoot = root;\n      console.log('[MSD Debug] Stored debug context:', root.constructor.name);\n    }\n  }\n  */\n  /**\n   * Find MSD wrapper element within the correct scope (shadowRoot)\n   */\n  /*\n  function findMsdWrapper() {\n    const searchRoots = [debugShadowRoot, lastUsedRoot].filter(Boolean);\n\n    for (const root of searchRoots) {\n      if (!root || !root.querySelector) continue;\n\n      // Try multiple selectors within this shadowRoot\n      const selectors = [\n        '#msd-v1-comprehensive-wrapper',\n        '[id*=\"msd-v1\"]',\n        '[id*=\"msd\"]',\n        '.msd-container',\n        'div[style*=\"border:2px solid cyan\"]'  // Fallback to the wrapper div style\n      ];\n\n      for (const selector of selectors) {\n        try {\n          const element = root.querySelector(selector);\n          if (element) {\n            console.log(`[MSD Debug] Found wrapper using selector '${selector}' in ${root.constructor.name}`);\n            return element;\n          }\n        } catch (e) {\n          // Continue to next selector\n        }\n      }\n    }\n\n    console.warn('[MSD Debug] Could not find MSD wrapper in any known shadowRoot');\n    return null;\n  }\n  */\n\n  dbg.renderAdvanced = (options) => {\n    try {\n      console.log('[MSD v1] renderAdvanced called - using AdvancedRenderer');\n      const model = modelBuilder.getResolvedModel();\n      if (model) {\n        return systemsManager.renderer.render(model);\n      }\n      console.warn('[MSD v1] renderAdvanced: No resolved model available');\n      return { svgMarkup: '' };\n    } catch (error) {\n      console.error('[MSD v1] renderAdvanced failed:', error);\n      return { svgMarkup: '', error: error.message };\n    }\n  };\n\n  // Rest of the function remains the same...\n  dbg.hud = {\n    show: () => systemsManager.hudManager.show(),\n    hide: () => systemsManager.hudManager.hide(),\n    toggle: () => systemsManager.hudManager.toggle(),\n    state: () => ({\n      visible: systemsManager.hudManager.state?.visible || false,\n      activePanel: systemsManager.hudManager.state?.activePanel || 'unknown',\n      refreshRate: systemsManager.hudManager.state?.refreshRate || 2000\n    }),\n\n    init: () => {\n      if (debugConfig?.hud?.auto_show) {\n        setTimeout(() => {\n          systemsManager.hudManager.show();\n          console.log('[MSD v1] HUD auto-shown based on config');\n        }, 2000);\n      }\n    }\n  };\n\n  setTimeout(() => dbg.hud.init(), 100);\n\n  dbg.introspection = {\n    listOverlays: (root) => MsdIntrospection.listOverlays(root),\n    getOverlayBBox: (id, root) => MsdIntrospection.getOverlayBBox(id, root),\n    highlight: (ids, opts) => MsdIntrospection.highlight(ids, opts)\n  };\n\n  dbg.controls = {\n    render: (overlays, model) => systemsManager.controlsRenderer.renderControls(overlays, model),\n    relayout: () => systemsManager.controlsRenderer.relayout()\n  };\n\n  // ADD: Help system\n  dbg.help = function() {\n    console.log(`\n\n                          MSD Debug Interface Help                            \n\n Debug Features:                                                              \n   __msdDebug.debug.enable('anchors')       - Show anchor point markers      \n   __msdDebug.debug.enable('bounding_boxes') - Show overlay bounding boxes   \n   __msdDebug.debug.enable('routing')       - Show routing path visualization\n   __msdDebug.debug.enable('performance')   - Show performance metrics       \n   __msdDebug.debug.enable('all')           - Enable all features            \n                                                                              \n   __msdDebug.debug.disable('feature')      - Disable specific feature       \n   __msdDebug.debug.status()                - Show current debug state       \n   __msdDebug.debug.setScale(1.5)           - Set debug element scale        \n   __msdDebug.debug.refresh()               - Force re-render debug overlays \n                                                                              \n Quick Access:                                                                \n   __msdDebug.debug.anchors.toggle()        - Toggle anchor markers          \n   __msdDebug.debug.bounding.toggle()       - Toggle bounding boxes          \n   __msdDebug.debug.bounding.test('id')     - Test bounding box accuracy     \n   __msdDebug.debug.bounding.compare('id')  - Compare measurement methods    \n   __msdDebug.debug.routing.toggle()        - Toggle routing guides          \n   __msdDebug.debug.performance.toggle()    - Toggle performance overlay     \n                                                                              \n Data & Entities:                                                             \n   __msdDebug.dataSources.stats()           - Data source statistics         \n   __msdDebug.dataSources.list()            - List all data sources          \n   __msdDebug.dataSources.get('name')       - Get specific data source       \n                                                                              \n Routing:                                                                     \n   __msdDebug.routing.inspect('overlay_id') - Inspect routing path           \n   __msdDebug.routing.stats()               - Routing system statistics      \n   __msdDebug.routing.invalidate()          - Clear routing cache            \n                                                                              \n Performance:                                                                 \n   __msdDebug.getPerf()                     - Get performance metrics        \n   __msdDebug.perf()                        - Alternative performance data   \n                                                                              \n Other Tools:                                                                 \n   __msdDebug.hud.toggle()                  - Toggle HUD overlay             \n   __msdDebug.rules.trace()                 - Show rules engine trace        \n   __msdDebug.validation.issues()           - Show configuration issues      \n   __msdDebug.usage()                       - Show simplified usage examples \n                                                                              \n Pipeline:                                                                    \n   __msdDebug.pipelineInstance              - Direct pipeline access         \n\n    `);\n  };\n\n  // ADD: Simplified usage examples\n  dbg.usage = function() {\n    console.log(`\n Quick MSD Debug Commands:\n\nEnable debug features:\n  __msdDebug.debug.enable('anchors')      # Show anchor points\n  __msdDebug.debug.enable('bounding_boxes') # Show overlay bounds\n  __msdDebug.debug.enable('all')          # Enable everything\n\nCheck status:\n  __msdDebug.debug.status()               # Current debug state\n  __msdDebug.dataSources.stats()          # Data source info\n  __msdDebug.getPerf()                    # Performance metrics\n\nQuick toggles:\n  __msdDebug.debug.anchors.toggle()       # Toggle anchors\n  __msdDebug.debug.bounding.toggle()      # Toggle bounding boxes\n  __msdDebug.debug.bounding.test('id')    # Test bounding accuracy\n  __msdDebug.debug.routing.toggle()       # Toggle routing guides\n\nFor full help: __msdDebug.help()\n    `);\n  };\n\n  // Log debug config state (REDUCED)\n  if (debugConfig.enabled) {\n    console.log('[MSD v1] Debug mode enabled');\n  }\n}\n\nfunction setupUtilityDebugInterface(dbg, mergedConfig, systemsManager) {\n  // Rules system\n  dbg.rules = {\n    trace: () => systemsManager.rulesEngine.getTrace()\n  };\n\n  // Animations\n  dbg.animations = {\n    active: () => systemsManager.animRegistry.getActive()\n  };\n\n  // Performance monitoring\n  dbg.getPerf = () => {\n    const perfStore = dbg.__perfStore || {};\n    const result = {\n      timers: {},\n      counters: perfStore.counters || {}\n    };\n\n    if (perfStore.timings) {\n      Object.entries(perfStore.timings).forEach(([key, data]) => {\n        if (data && typeof data === 'object') {\n          result.timers[key] = {\n            count: data.count || 0,\n            total: data.total || 0,\n            avg: data.count > 0 ? (data.total / data.count) : 0,\n            last: data.last || 0,\n            max: data.max || 0\n          };\n        }\n      });\n    }\n\n    return result;\n  };\n\n  dbg.perf = () => perfGetAll();\n\n  // Validation\n  dbg.validation = {\n    issues: () => {\n      try {\n        return mergedConfig.__issues || { errors: [], warnings: [] };\n      } catch (e) {\n        console.warn('[MSD v1] validation.issues failed:', e);\n        return { errors: [], warnings: [] };\n      }\n    }\n  };\n\n  // Packs inspection\n  dbg.packs = {\n    list: (type) => {\n      if (!type) return {\n        animations: mergedConfig.animations?.length || 0,\n        overlays: mergedConfig.overlays?.length || 0,\n        rules: mergedConfig.rules?.length || 0,\n        profiles: mergedConfig.profiles?.length || 0,\n        timelines: mergedConfig.timelines?.length || 0\n      };\n      return mergedConfig[type] || [];\n    },\n    get: (type,id) => (mergedConfig[type]||[]).find(i=>i.id===id),\n    issues: () => mergedConfig.__issues\n  };\n\n  // Line debugging\n  dbg.lines = {\n    markersEnabled: false,\n    showMarkers(flag=true){\n      this.markersEnabled=!!flag;\n      console.info('[MSD v1] line endpoint markers', this.markersEnabled?'ENABLED':'DISABLED');\n    },\n    forceRedraw: () => {\n      // Connect to the reRender callback through systems manager\n      if (systemsManager._reRenderCallback) {\n        systemsManager._reRenderCallback();\n        return true;\n      }\n      return false;\n    }\n  };\n}","import * as anime from 'animejs';\n\nimport * as CBLCARS from './cb-lcars-vars.js'\nimport { cblcarsSetGlobalLogLevel, cblcarsGetGlobalLogLevel, cblcarsLog, cblcarsLogBanner} from './utils/cb-lcars-logging.js';\nimport { readYamlFile } from './utils/cb-lcars-fileutils.js';\nimport { preloadSVGs, loadSVGToCache, getSVGFromCache } from './utils/cb-lcars-fileutils.js';\n//import { CBLCARSDashboardStrategy, CBLCARSViewStrategy, CBLCARSViewStrategyAirlock } from './strategy/cb-lcars-strategy.js';\nimport { CBLCARSCardEditor } from './editor/cb-lcars-editor.js';\nimport { loadFont, loadCoreFonts, loadAllFontsFromConfig } from './utils/cb-lcars-theme.js';\nimport { getLovelace, checkLovelaceTemplates } from './utils/cb-helpers.js';\nimport { ButtonCard } from \"./cblcars-button-card.js\"\nimport { html } from 'lit';\n\nimport * as animHelpers from './utils/cb-lcars-anim-helpers.js';\nimport { animPresets } from './utils/cb-lcars-anim-presets.js';\nimport * as svgHelpers from './utils/cb-lcars-svg-helpers.js';\nimport * as anchorHelpers from './utils/cb-lcars-anchor-helpers.js';\n\n\n\n// CHANGED: Side-effect import that initializes the MSD v1 pipeline\nimport './msd/index.js';\n\n\n// Ensure global namespace\nwindow.cblcars = window.cblcars || {};\n\n// Promises for loading the templates and stub configuration\nlet templatesPromise;\nlet stubConfigPromise;\nlet themeColorsPromise;\n\n// Load the templates from our yaml file\nlet templates = {};\nlet stubConfig = {};\n\n// Ensure the cblcars object exists on the window object\n//window.cblcars = window.cblcars || {};\nwindow.cblcars.loadFont = loadFont;\n\n\n// DEBUGGING: Add immediate global debugging when CB-LCARS loads\nconsole.log('[CB-LCARS] File loaded, setting up debugging');\n\nasync function initializeCustomCard() {\n\n    // Call log banner function immediately when the script loads\n    cblcarsLogBanner();\n    window.cblcars.cblcarsLog = cblcarsLog; // Expose the logging function globally\n\n    // Expose debug helpers (the module already attaches API; this ensures references exist)\n    window.cblcars.debug = window.cblcars.debug || {};\n    window.cblcars.debug.setLevel = cblcarsSetGlobalLogLevel;\n\n    // Animation namespace organization\n    window.cblcars.anim = {\n        animejs: anime,                // full animejs module\n        anime: anime.animate,          // shortcut for anime.animate\n        utils: anime.utils,            // CENTRAL canonical utils reference\n        animateElement: animHelpers.animateElement,\n        animateWithRoot: animHelpers.animateWithRoot,\n        waitForElement: animHelpers.waitForElement,\n        presets: animPresets,\n        scopes: new Map(),\n    };\n\n    // Backward-compatible shortcuts (to be deprecated)\n    window.cblcars.animejs = window.cblcars.anim.animejs;\n    window.cblcars.anime = window.cblcars.anim.anime;\n    window.cblcars.animateElement = window.cblcars.anim.animateElement;\n    window.cblcars.animateWithRoot = window.cblcars.anim.animateWithRoot;\n    window.cblcars.waitForElement = window.cblcars.anim.waitForElement;\n\n\n    window.cblcars.svgHelpers = svgHelpers;\n    window.cblcars.anchorHelpers = anchorHelpers;\n    window.cblcars.findSvgAnchors = anchorHelpers.findSvgAnchors;\n    window.cblcars.getSvgContent = anchorHelpers.getSvgContent;\n    window.cblcars.getSvgViewBox = anchorHelpers.getSvgViewBox;\n    window.cblcars.getSvgAspectRatio = anchorHelpers.getSvgAspectRatio;\n\n\n    window.cblcars.loadFont = loadFont;\n    window.cblcars.loadUserSVG = async function(key, url) {\n        return await loadSVGToCache(key, url);\n    };\n    window.cblcars.getSVGFromCache = getSVGFromCache;\n\n    ///load yaml configs\n    // Await YAML configs\n    templatesPromise = loadTemplates(CBLCARS.templates_uri);\n    stubConfigPromise = loadStubConfig(CBLCARS.stub_config_uri);\n    themeColorsPromise = loadThemeColors(CBLCARS.theme_colors_uri);\n\n    // Await SVG preload\n    await preloadSVGs(CBLCARS.builtin_svg_keys, CBLCARS.builtin_svg_basepath)\n        .catch(error => cblcarsLog.error('[initializeCustomCard] Error preloading built-in SVGs:', error));\n\n    // Await card dependencies\n    const cardImports = [\n        customElements.whenDefined('cblcars-button-card'),\n        customElements.whenDefined('my-slider-v2')\n    ];\n    await Promise.all(cardImports);\n\n    // Await font loading if loadCoreFonts is async\n    await loadCoreFonts();\n\n    // Await YAML config loading\n    await Promise.all([templatesPromise, stubConfigPromise, themeColorsPromise]);\n\n    // Checks that custom element dependencies are defined for use in the cards\n    if (!customElements.get('cblcars-button-card')) {\n        cblcarsLog.error(`[initializeCustomCard] Custom Button Card for LCARS [cblcars-button-card] was not found!`);\n    }\n    if (!customElements.get('my-slider-v2')) {\n        cblcarsLog.error(`[initializeCustomCard] 'My Cards' MySliderV2 Custom Card [my-slider-v2] was not found!`);\n    }\n}\n\n\n// Initialize the custom card and register elements only after setup is complete\ninitializeCustomCard()\n    .then(() => {\n        defineCustomElement('cb-lcars-base-card', CBLCARSBaseCard, 'cb-lcars-base-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-label-card', CBLCARSLabelCard, 'cb-lcars-label-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-elbow-card', CBLCARSElbowCard, 'cb-lcars-elbow-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-double-elbow-card', CBLCARSDoubleElbowCard, 'cb-lcars-double-elbow-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-multimeter-card', CBLCARSMultimeterCard, 'cb-lcars-multimeter-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-dpad-card', CBLCARSDPADCard, 'cb-lcars-dpad-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-button-card', CBLCARSButtonCard, 'cb-lcars-button-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-msd-card', CBLCARSMSDCard, 'cb-lcars-msd-card-editor', CBLCARSCardEditor);\n    })\n    .catch(error => {\n        cblcarsLog.error('[initializeCustomCard.then()] Error initializing custom card:', error);\n    });\n\n\nasync function loadTemplates(filePath) {\n    try {\n        const yamlContent = await readYamlFile(filePath);\n\n        // Store the YAML content in window.cblcars_card_templates\n        window.cblcars_card_templates = yamlContent.cblcars_card_templates;\n\n        // Merge the cblcars stanza with the existing window.cblcars object\n        if (yamlContent.cblcars) {\n            window.cblcars = {\n                ...window.cblcars,\n                ...yamlContent.cblcars\n            };\n        }\n\n        templates = yamlContent || {};\n        cblcarsLog.debug(`[loadTemplates] CB-LCARS dashboard templates loaded from source file [${filePath}]`, templates);\n    } catch (error) {\n        cblcarsLog.error('[loadTemplates] Failed to get the CB-LCARS lovelace templates from source file.', error);\n    }\n}\n\nasync function loadThemeColors(filePath) {\n    try {\n        const yamlContent = await readYamlFile(filePath);\n\n        // Merge the cblcars stanza with the existing window.cblcars object\n        if (yamlContent.cblcars) {\n            window.cblcars = {\n                ...window.cblcars,\n                ...yamlContent.cblcars\n            };\n        }\n        cblcarsLog.info(`[loadThemeColors] CB-LCARS theme colors loaded from source file [${filePath}]`, yamlContent);\n        setThemeColors(window.cblcars.themes, 'green');\n    } catch (error) {\n        cblcarsLog.error('[loadThemeColors] Failed to get the CB-LCARS theme colors from source file.', error);\n    }\n}\n\nfunction setThemeColors(themes, alertCondition = 'green', clobber = false) {\n    const selectedTheme = themes[`${alertCondition}_alert`];\n    if (!selectedTheme) {\n        cblcarsLog.error(`[setThemeColors] Theme for alert condition ${alertCondition} is not defined.`, '', cblcarsGetGlobalLogLevel());\n        return;\n    }\n\n    const colors = selectedTheme.colors;\n\n    for (const [colorGroup, colorValues] of Object.entries(colors)) {\n        for (const [colorName, colorValue] of Object.entries(colorValues)) {\n            const cssVarName = `--${colorName}`;\n            const existingValue = getComputedStyle(document.documentElement).getPropertyValue(cssVarName).trim();\n\n            if (clobber || !existingValue) {\n                cblcarsLog.warn(`[setThemeColors] Color undefined or overridden - Setting ${cssVarName}=${colorValue}`, '', cblcarsGetGlobalLogLevel());\n                document.documentElement.style.setProperty(cssVarName, colorValue);\n            } else {\n                cblcarsLog.debug(`[setThemeColors] Skipping ${cssVarName} as it is already defined with value ${existingValue}`, '', cblcarsGetGlobalLogLevel());\n            }\n        }\n    }\n}\nfunction setAlertCondition(alertCondition) {\n    setThemeColors(window.cblcars.themes, alertCondition,true);\n}\nwindow.cblcars.setAlertCondition = setAlertCondition;\n\n// Load the stub configuration from our yaml file\nasync function loadStubConfig(filePath) {\n    try {\n        const yamlContent = await readYamlFile(filePath);\n        stubConfig = yamlContent || {};\n        cblcarsLog.debug(`[loadStubConfig] CB-LCARS stub configuration loaded from source file [${CBLCARS.stub_config_uri}]`, stubConfig);\n    } catch (error) {\n        cblcarsLog.error('[loadStubConfig] Failed to get the CB-LCARS stub configuration from source file.', error);\n    }\n}\n\n\n\n// --- Anime.js v4 Scopes Manager ---\nclass CBLCARSAnimationScope {\n    constructor(id) {\n        this.id = id;\n        this.scope = window.cblcars.animejs.createScope(); // anime.js v4 syntax\n        this.animations = []; // Array to hold animation instances for inspection\n        this._runningByTarget = new Map(); // Map<targetId, animation>\n    }\n\n    // Resolve the root for DOM operations\n    _getRoot(options) {\n        return (options && options.root) || document;\n    }\n\n    // Normalize targets into Element[]\n    _resolveTargets(options) {\n        const root = this._getRoot(options);\n        const t = options && options.targets;\n        if (!t) return [];\n        if (t instanceof Element) return [t];\n        if (Array.isArray(t)) return t.filter(Boolean);\n        if (typeof t === 'string') {\n            // Prefer ID fast-path\n            if (t.startsWith('#')) {\n                const el = root.querySelector(t);\n                return el ? [el] : [];\n            }\n            return Array.from(root.querySelectorAll(t));\n        }\n        return [];\n    }\n\n    // Remove artifacts created by previous animation runs for a given baseId\n    _cleanupArtifactsForTargetId(root, baseId) {\n        if (!baseId) return;\n        // Only remove preset-owned artifacts\n        const trails = root.querySelectorAll(`#${baseId}_trail[data-cblcars-owned]`);\n        trails.forEach(n => n.parentElement && n.parentElement.removeChild(n));\n        const tracers = root.querySelectorAll(`#${baseId}_tracer[data-cblcars-owned]`);\n        tracers.forEach(n => n.parentElement && n.parentElement.removeChild(n));\n\n        // Clear CSS animation residue on the base element (e.g., march)\n        const baseEl = root.getElementById(baseId);\n        if (baseEl) {\n            if (baseEl.style) baseEl.style.animation = '';\n            baseEl.removeAttribute('data-march-anim-id');\n        }\n    }\n    // Stop anime.js animations for the given targets and cleanup artifacts\n    _cancelAndCleanupTargets(options) {\n        const root = this._getRoot(options);\n        const targets = this._resolveTargets(options);\n        targets.forEach(el => {\n            const id = el && el.id;\n            if (!id) return;\n\n            // Stop prior animations on this element (if any)\n            if (this.scope && typeof this.scope.remove === 'function') {\n                try { this.scope.remove(el); } catch (_) {}\n            }\n\n            // Remove previously created artifacts for this target\n            this._cleanupArtifactsForTargetId(root, id);\n\n            // Clear inline CSS animation remnants\n            el.style && (el.style.animation = '');\n\n            // Forget previous tracking entry\n            this._runningByTarget.delete(id);\n        });\n        return targets;\n    }\n\n    /**\n     * Adds an animation to the scope using the v4 `scope.add()` pattern.\n     * De-duplicates by target: cancels prior animations and removes artifacts before starting a new one.\n     * @param {object} options - The animation options for animateElement.\n     * @param {object} hass - The Home Assistant hass object.\n     */\n    animate(options, hass = null) {\n        const targets = this._cancelAndCleanupTargets(options);\n\n        // Call the global animateElement helper, passing this instance as the scope.\n        const animation = window.cblcars.anim.animateElement(this, options, hass);\n        if (animation) {\n            this.animations.push({ config: options, animation: animation, targets });\n            // Track per-target so future runs can be canceled/cleaned deterministically\n            targets.forEach(el => el && el.id && this._runningByTarget.set(el.id, animation));\n        }\n    }\n\n    destroy() {\n        // Stop and remove all animations associated with this scope.\n        if (this.scope && typeof this.scope.remove === 'function') {\n            try {\n                const activeAnimations = window.cblcars.animejs.get(this.scope);\n                if (activeAnimations) {\n                    this.scope.remove(activeAnimations.map(anim => anim.targets).flat());\n                }\n            } catch (_) {}\n        }\n\n        // Cleanup artifacts for all tracked targets\n        try {\n            this.animations.forEach(entry => {\n                const root = this._getRoot(entry.config);\n                (entry.targets || []).forEach(el => {\n                    if (el && el.id) {\n                        this._cleanupArtifactsForTargetId(root, el.id);\n                        el.style && (el.style.animation = '');\n                    }\n                });\n            });\n        } catch (_) {}\n\n        // Clear internal tracking\n        this._runningByTarget.clear();\n        this.animations = [];\n    }\n}\n\n\nclass CBLCARSBaseCard extends ButtonCard {\n\n    _isResizeObserverEnabled = false;\n    _resizeObserver;\n    _logLevel = cblcarsGetGlobalLogLevel();\n    _resizeObserverTarget = 'this';\n    _lastWidth = 0;\n    _lastHeight = 0;\n    _resizeObserverTolerance = 16; // Default tolerance for resize observer.  16 settles infinite resize in preview mode.\n    _debounceWait = 100; // Default debounce wait time in milliseconds\n    _isUsingLovelaceTemplate = false;\n    _overrideTemplates = [];\n\n\n    constructor () {\n        super();\n        this._resizeObserverTolerance = window.cblcars.resizeObserverTolerance || this._resizeObserverTolerance;\n        this._debounceWait = window.cblcars.debounceWait || this._debounceWait;\n        this._resizeObserver = new ResizeObserver(() => {\n            cblcarsLog.debug('[CBLCARSBaseCard.constructor()] Resize observer fired', this, this._logLevel);\n            this._debouncedResizeHandler();\n        });\n        this._debouncedResizeHandler = this._debounce(() => this._updateCardSize(), this._debounceWait);\n    }\n\n\n    setHass(hass) {\n        console.log('[CBLCARSBaseCard.setHass()]  RECEIVED setHass call:', {\n            cardType: this.constructor.cardType,\n            entity: this._config?.entity,\n            oldState: this.hass?.states?.[this._config?.entity]?.state,\n            newState: hass?.states?.[this._config?.entity]?.state,\n            stateChanged: this.hass?.states?.[this._config?.entity]?.state !== hass?.states?.[this._config?.entity]?.state,\n            timestamp: new Date().toISOString(),\n            callerStack: new Error().stack.split('\\n').slice(1, 3).map(line => line.trim()).join('  ')\n        });\n\n        // Store the old HASS for LitElement change detection\n        const oldHass = this.hass;\n\n        // CRITICAL: Update _stateObj BEFORE setting HASS property to maintain sync with custom-button-card\n        if (this._config?.entity && hass?.states?.[this._config.entity]) {\n            const newStateObj = hass.states[this._config.entity];\n            if (this._stateObj !== newStateObj) {\n                console.log('[CBLCARSBaseCard.setHass()] Updating _stateObj for entity:', this._config.entity, {\n                    oldState: this._stateObj?.state,\n                    newState: newStateObj?.state\n                });\n                this._stateObj = newStateObj;\n            }\n        }\n\n        // Use property assignment to trigger LitElement's reactive system\n        this.hass = hass;\n        this._hass = hass; // Also set internal property for compatibility\n\n        // Trigger LitElement's requestUpdate for proper change detection\n        if (typeof this.requestUpdate === 'function') {\n            this.requestUpdate('hass', oldHass);\n            this.requestUpdate('_hass', oldHass);\n\n            // Also trigger update for state object if it changed\n            if (this._config?.entity && this._stateObj) {\n                this.requestUpdate('_stateObj');\n            }\n        }\n\n        console.log('[CBLCARSBaseCard.setHass()] Completed with property assignment approach');\n    }\n\n\n    setConfig(config) {\n        if (!config) {\n            throw new Error(\"The 'cblcars_card_config' section is required in the configuration.\");\n        }\n\n        // DEBUGGING: Log the incoming config to see what MSD is passing\n        console.log('[CBLCARSBaseCard.setConfig()] Called with config:', {\n            type: config.type,\n            entity: config.entity,\n            triggersUpdate: config.triggers_update,\n            hasSetConfigFromMSD: config._msdGenerated || false,\n            fullConfig: config\n        });\n\n        // Handle merging of templates array\n        const defaultTemplates = ['cb-lcars-base'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        // Set the _logLevel property from the config\n        this._logLevel = config.cblcars_log_level || cblcarsGetGlobalLogLevel();\n\n        // ENHANCED: Skip entity collection entirely for MSD cards\n        let triggersUpdate = [];\n        const isMSDCard = config.type === 'cb-lcars-msd-card' ||\n                        this.constructor.cardType === 'cb-lcars-msd-card' ||\n                        mergedTemplates.includes('cb-lcars-msd');\n\n        if (isMSDCard) {\n            // MSD cards: NO entity tracking at all\n            triggersUpdate = [];\n            console.log(`[CBLCARSBaseCard.setConfig()] MSD card detected: Completely disabling triggers_update`);\n        } else {\n            // Non-MSD cards: Normal entity collection\n            const foundEntities = collectEntities(config);\n            triggersUpdate = Array.isArray(config.triggers_update) ? config.triggers_update : [];\n\n            if (config.triggers_update === 'all') {\n                triggersUpdate = 'all';\n            } else if (foundEntities.length > 0) {\n                triggersUpdate = Array.from(new Set([...triggersUpdate, ...foundEntities]));\n                console.log(`[CBLCARSBaseCard.setConfig()] Found entities for triggers_update:`, foundEntities);\n            }\n        }\n\n\n        // Create a new object to avoid modifying the original config\n        this._config = {\n            ...config,\n            template: mergedTemplates,\n            triggers_update: triggersUpdate  // FIXED: Re-enabled triggers_update\n        };\n\n        console.log('[CBLCARSBaseCard.setConfig()] Final config triggers_update:', this._config.triggers_update);\n\n        // Load all fonts from the config (dynamically loads fonts based on the config)\n        loadAllFontsFromConfig(this._config);\n\n        // Check if the card is using a template from the dashboard's yaml.\n        // this will override the card's configuration\n        // this could be on purpose for testing/customization - but more likely holdovers from the original version that used that method\n        const { isUsingLovelaceTemplate, overriddenTemplates } = checkLovelaceTemplates(this._config);\n        this._isUsingLovelaceTemplate = isUsingLovelaceTemplate;\n        this._overrideTemplates = overriddenTemplates;\n\n        // Log a warning if the card is using a template from the dashboard's yaml\n        // add the card to a list of tainted cards\n        if(isUsingLovelaceTemplate) {\n            cblcarsLog.warn(`[CBLCARSBaseCard.setConfig()] Card configuration templates are being overridden with local dashboard YAML configuration.  Templates: ${overriddenTemplates.join(', ')}`, this, this._logLevel);\n            window.cblcars.taintedCards = window.cblcars.taintedCards || [];\n            window.cblcars.taintedCards.push({card: this, templates: overriddenTemplates});\n        }\n\n\n        // Set up the resizeObserver properties\n        this._resizeObserverTarget = config.resize_observer_target || 'this';\n        this._isResizeObserverEnabled = (config.enable_resize_observer || (config.variables && config.variables.enable_resize_observer)) || false;\n        this._resizeObserverTolerance = config.resize_observer_tolerance || this._resizeObserverTolerance;\n        this._debounceWait = config.debounce_wait || this._debounceWait;\n        // Enable the resize observer if any merged template contains the word 'animation'\n        // this allows us to enable the observer for added animation templates without needed to explicity add it to the config\n        if (mergedTemplates.some(template => template.includes('animation') || template.includes('symbiont'))) {\n            this._isResizeObserverEnabled = true;\n        }\n\n        // Enable the resize observer if the configuration option is enabled\n        if (this._isResizeObserverEnabled) {\n            this.enableResizeObserver();\n        }\n\n        super.setConfig(this._config);\n        console.log('[CBLCARSBaseCard.setConfig()] Called super.setConfig with final config:', {\n            triggers_update: this._config.triggers_update,\n            entity: this._config.entity,\n            type: this._config.type\n        });\n\n        // ADDED: Force state re-evaluation for CB-LCARS cards after config change\n        if (this.hass && this._config.entity) {\n            console.log('[CBLCARSBaseCard.setConfig()] Forcing state re-evaluation after setConfig');\n\n            // Force the card to re-evaluate its state-based styling\n            setTimeout(() => {\n                try {\n                    console.log('[CBLCARSBaseCard.setConfig()] Skipping forced setHass - will rely on normal HA update cycle');\n\n                    // Method 2: Force render update (SAFE)\n                    if (typeof this.requestUpdate === 'function') {\n                        console.log('[CBLCARSBaseCard.setConfig()] Forcing requestUpdate');\n                        this.requestUpdate();\n                    }\n\n                    // Method 3: REMOVED - manual state manipulation can cause issues\n\n                } catch (e) {\n                    console.warn('[CBLCARSBaseCard.setConfig()] Failed to force state re-evaluation:', e);\n                }\n            }, 100);\n        }\n\n        cblcarsLog.debug(`[CBLCARSBaseCard.setConfig()] called with:`, this._config, this._logLevel);\n    }\n\n    static get editorType() {\n        return 'cb-lcars-base-card-editor';\n    }\n    static get cardType() {\n        return 'cb-lcars-base-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            label: \"CB-LCARS Base Card\",\n            show_label: true\n        };\n    }\n\n    static getConfigElement() {\n\n        const editorType = this.editorType;\n\n        try {\n            if (!customElements.get(editorType)) {\n                cblcarsLog.error(`[CBLCARSBaseCard.getConfigElement()] Graphical editor element [${editorType}] is not defined defined in Home Assistant!`, null, this._logLevel);\n                return null;\n            }\n            const element = document.createElement(editorType);\n            //console.log('Element created:', element);\n            return element;\n        } catch (error) {\n            cblcarsLog.error(`[CBLCARSBaseCard.getConfigElement()] Error creating element ${editorType}: `, error, this._logLevel);\n            return null;\n        }\n    }\n\n    static getStubConfig() {\n        const cardType = this.cardType;\n        if (stubConfig[cardType]) {\n            return stubConfig[cardType];\n        } else {\n            return this.defaultConfig;\n        }\n    }\n\n    getCardSize() {\n        //return this._card ? this._card.getCardSize() : 4;\n        super.getCardSize();\n    }\n\n    getLayoutOptions() {\n        return {\n          grid_rows: 1,\n          grid_columns: 4\n        };\n      }\n\n\n    connectedCallback() {\n        super.connectedCallback();\n        // --- Anime.js Scope creation ---\n        this._animationScopeId = `card-${this.id || this.cardType || Math.random().toString(36).slice(2)}`;\n        this._animationScope = new CBLCARSAnimationScope(this._animationScopeId);\n        window.cblcars.anim.scopes.set(this._animationScopeId, this._animationScope);\n\n        // CLEANUP: Stop previous timelines if any\n        if (this._timelines && Array.isArray(this._timelines)) {\n            this._timelines.forEach(tl => tl && typeof tl.pause === 'function' && tl.pause());\n            this._timelines = null;\n        }\n\n        // NEW: Timelines now live under this._config.variables.msd.timelines\n        // Build overlay config map from variables.msd.overlays for element-level merge\n        const msdVars = this._config?.variables?.msd || {};\n        const timelinesCfg = msdVars.timelines || null;\n        const overlaysArr = Array.isArray(msdVars.overlays) ? msdVars.overlays : [];\n        const overlayConfigsById = overlaysArr.reduce((acc, o) => {\n            if (o && o.id) acc[o.id] = o;\n            return acc;\n        }, {});\n\n        // Defer timeline creation until after the SVG/overlays have been stamped into the shadowRoot\n        if (timelinesCfg) {\n            requestAnimationFrame(() => {\n            requestAnimationFrame(async () => {\n                try {\n                this._timelines = await animHelpers.createTimelines(\n                    timelinesCfg,\n                    this._animationScopeId,\n                    this.shadowRoot,\n                    overlayConfigsById,\n                    this.hass || null,\n                    msdVars.presets || {}      // <-- pass presets for state_resolver in timeline steps\n                );\n                // Do not force play(); let autoplay govern start/paused state\n                } catch (e) {\n                cblcarsLog.error('[CBLCARSBaseCard.connectedCallback] Error creating timelines:', e);\n                }\n            });\n            });\n        }\n\n        // Check if the parent element has the class 'preview'\n        if (this.parentElement && this.parentElement.classList.contains('preview')) {\n            this.style.height = '60px';\n            this.style.minHeight = '60px';\n        } else {\n            this.style.height = '100%';\n\n            // Enable the resize observer when the card is connected to the DOM\n            // but only if not in preview mode\n            if (this._isResizeObserverEnabled) {\n            this.enableResizeObserver();\n            window.addEventListener('resize', this._debouncedResizeHandler);\n            }\n        }\n    }\n\n    disconnectedCallback() {\n        super.disconnectedCallback();\n        // --- Anime.js Scope cleanup ---\n        const animationScope = window.cblcars.anim.scopes.get(this._animationScopeId);\n        if (animationScope) {\n            //animationScope.destroy();\n            animationScope.destroy();\n            window.cblcars.anim.scopes.delete(this._animationScopeId);\n        }\n        this.disableResizeObserver();\n        window.removeEventListener('resize', this._debouncedResizeHandler)\n    }\n\n    _updateCardSize() {\n\n        //cblcarsLog('debug',`this.offset* dimensions: ${this.offsetWidth} x ${this.offsetHeight}`, this, this._logLevel);\n        //cblcarsLog('debug',`this.offsetParent.offset* dimensions: ${this.offsetParent.offsetWidth} x ${this.offsetParent.offsetHeight}`, this, this._logLevel);\n        //cblcarsLog('debug',`this.parentElement.offset* dimensions: ${this.parentElement.offsetWidth} x ${this.parentElement.offsetHeight}`, this, this._logLevel);\n\n        const parentWidth = this.parentElement.offsetWidth;\n        const parentHeight = this.parentElement.offsetHeight;\n        //cblcarsLog.debug(`Going with dimensions: ${parentWidth} x ${parentHeight}`, this, this._logLevel);\n\n        const significantChange = this._resizeObserverTolerance;\n        // Only update if there is a significant change\n        if (parentWidth > 0 && parentHeight > 0 && (Math.abs(parentWidth - this._lastWidth) > significantChange || Math.abs(parentHeight - this._lastHeight) > significantChange)) {\n            //if (Math.abs(parentWidth - this._lastWidth) > significantChange || Math.abs(parentHeight - this._lastHeight) > significantChange) {\n            this._lastWidth = parentWidth;\n            this._lastHeight = parentHeight;\n\n            // Set CSS variables for the child card's dimensions\n            this.style.setProperty('--button-card-width', `${parentWidth}px`);\n            this.style.setProperty('--button-card-height', `${parentHeight}px`);\n\n            if (!this._config) {\n                cblcarsLog.debug('[CBLCARSBaseCard._updateCardSize()] Config is not defined. Skipping resize handling.', this, this._logLevel);\n                return;\n            }\n\n            // Store the dimensions in the card's config\n            if (!this._config.variables) {\n                this._config.variables = { card: {} };\n            }\n            this._config.variables.card.width = `${parentWidth}px`;\n            this._config.variables.card.height = `${parentHeight}px`;\n\n            // Trigger an update if necessary\n            this.setConfig(this._config);\n        }\n    }\n\n    _updateResizeObserver() {\n        if (this._isResizeObserverEnabled) {\n            this.enableResizeObserver();\n        } else {\n            this.disableResizeObserver();\n        }\n    }\n\n    enableResizeObserver() {\n        const targetElement = this.resolveTargetElement(this._resizeObserverTarget);\n\n        if (targetElement && this.isConnected) {\n            this._resizeObserver.observe(targetElement);\n            cblcarsLog.debug(`[CBLCARSBaseCard.enableResizeObserver()] Resize observer enabled on [${this._resizeObserverTarget}]`, this, this._logLevel);\n        }\n    }\n\n    disableResizeObserver() {\n        if (this._resizeObserver) {\n            this._resizeObserver.disconnect();\n        }\n        cblcarsLog.debug(`[CBLCARSBaseCard.disableResizeObserver()] Resize observer disabled`, this._logLevel);\n    }\n\n    toggleResizeObserver() {\n        this._isResizeObserverEnabled = !this._isResizeObserverEnabled;\n        this._updateResizeObserver();\n    }\n\n    resolveTargetElement(target) {\n        const targetMapping = {\n            'this': () => this,\n            'this.parentElement': () => this.parentElement,\n            'this.offsetParent': () => this.offsetParent,\n            // Add more mappings as needed\n        };\n\n        return targetMapping[target] ? targetMapping[target]() : this;\n    }\n    _debounce(func, wait) {\n        let timeout;\n        return function(...args) {\n            clearTimeout(timeout);\n            timeout = setTimeout(() => func.apply(this, args), wait);\n        };\n    }\n\n    /**\n     * Rebuild timelines for this card instance.\n     * Safe to call after overlays have been stamped; uses double-rAF for DOM availability.\n     * @param {object} timelinesCfg\n     * @param {object} overlayConfigsById\n     * @param {object} presets\n     */\n    _rebuildTimelines(timelinesCfg, overlayConfigsById = {}, presets = {}) {\n        if (!timelinesCfg) return;\n\n        // Stop previous timelines\n        if (this._timelines && Array.isArray(this._timelines)) {\n        this._timelines.forEach(tl => tl && typeof tl.pause === 'function' && tl.pause());\n        this._timelines = null;\n        }\n\n        // Defer to next paints to ensure DOM is present\n        requestAnimationFrame(() => {\n        requestAnimationFrame(async () => {\n            try {\n            this._timelines = await window.cblcars.anim.createTimelines\n                ? window.cblcars.anim.createTimelines(\n                    timelinesCfg,\n                    this._animationScopeId,\n                    this.shadowRoot,\n                    overlayConfigsById,\n                    this.hass || null,\n                    presets || {}\n                )\n                : (await import('./utils/cb-lcars-anim-helpers.js')).createTimelines(\n                    timelinesCfg,\n                    this._animationScopeId,\n                    this.shadowRoot,\n                    overlayConfigsById,\n                    this.hass || null,\n                    presets || {}\n                );\n            } catch (e) {\n            cblcarsLog.error('[CBLCARSBaseCard._rebuildTimelines] Error creating timelines:', e);\n            }\n        });\n        });\n    }\n}\n\n// Helper: Recursively collect all 'entity' and 'entity_id' values in an object\nfunction collectEntities(obj, entities = []) {\n    if (Array.isArray(obj)) {\n        obj.forEach(item => collectEntities(item, entities));\n    } else if (obj && typeof obj === 'object') {\n        for (const [key, value] of Object.entries(obj)) {\n            if ((key === 'entity' || key === 'entity_id') && typeof value === 'string') {\n                entities.push(value);\n            } else {\n                collectEntities(value, entities);\n            }\n        }\n    }\n    return entities;\n}\n\nclass CBLCARSLabelCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-label-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-label-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            label: \"CB-LCARS Label\",\n            show_label: true\n        };\n    }\n\n    setConfig(config) {\n        const defaultCardType = 'cb-lcars-label';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n\n        super.setConfig(specialConfig);\n    }\n}\n\nclass CBLCARSElbowCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-elbow-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-elbow-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            variables: {\n                card: {\n                    border: {\n                        left: { size: 90 },\n                        top: { size: 20 }\n                    }\n                }\n            }\n        };\n    }\n\n    setConfig(config) {\n\n        const defaultCardType = 'cb-lcars-header';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 1,\n            grid_columns: 4\n        };\n      }\n}\n\n\nclass CBLCARSMSDCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-msd-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-msd-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            enable_resize_observer: true,\n            variables: {\n                card: {\n                    border: {\n                        left: { size: 0 },\n                        right: { size: 0 },\n                        top: { size: 0 },\n                        bottom: { size: 0 }\n                    }\n                }\n            }\n        };\n    }\n\n    setConfig(config) {\n\n        console.log('[MSD DEBUG]  CBLCARSMSDCard.setConfig() CALLED:', {\n            timestamp: new Date().toISOString(),\n            hasExistingConfig: !!this._config,\n            configType: config.type,\n            configEntity: config.entity,\n            msdAlreadyBooted: !!this._msdV1ComprehensiveBoot,\n            stackTrace: new Error().stack.split('\\n').slice(1, 6).map(line => line.trim()).join('  ')\n        });\n\n        const defaultTemplates = ['cb-lcars-msd'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        // ENHANCED: Completely prevent any entity tracking for MSD cards\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n            // CRITICAL: Remove all entity references to prevent HA from tracking changes\n            entity: undefined,\n            entities: undefined,\n            triggers_update: [], // Force empty array\n            // Disable all button-card entity behaviors\n            show_state: false,\n            show_icon: false,\n            show_name: false,\n            show_label: false,\n            // Prevent any state-based interactions\n            state: undefined,\n            tap_action: { action: 'none' },\n            hold_action: { action: 'none' },\n            double_tap_action: { action: 'none' }\n        };\n\n        const msdConfig = specialConfig?.msd;\n\n        // Call parent setConfig with sanitized config\n        super.setConfig(specialConfig);\n\n        // ENHANCED: Initialize MSD v1 pipeline for this card instance\n        // This ensures the pipeline is ready when the card renders\n        try {\n            if (msdConfig && window.__msdDebug?.initMsdPipeline) {\n                // Store the MSD config for later pipeline initialization in the template\n                this._msdConfig = msdConfig;\n                console.log('[CBLCARSMSDCard] MSD v1 config prepared for pipeline initialization');\n            }\n        } catch (e) {\n            console.warn('[CBLCARSMSDCard] Failed to prepare MSD v1 pipeline:', e);\n        }\n\n        // PRESERVED: SVG handling logic for proper MSD initialization\n        console.log('[CBLCARSMSDCard] msdConfig:', msdConfig);\n        if (msdConfig && msdConfig.base_svg?.source) {\n            console.log('[CBLCARSMSDCard] Found base SVG:', msdConfig.base_svg.source);\n            let svgKey = null, svgUrl = null;\n\n            if (msdConfig.base_svg.source.startsWith('builtin:')) {\n                svgKey = msdConfig.base_svg.source.replace('builtin:', '');\n            } else if (msdConfig.base_svg.source.startsWith('/local/')) {\n                svgKey = msdConfig.base_svg.source.split('/').pop().replace('.svg','');\n                svgUrl = msdConfig.base_svg.source;\n\n                // Load user SVG if not already cached\n                if (!window.cblcars.getSVGFromCache(svgKey)) {\n                    window.cblcars.loadUserSVG(svgKey, svgUrl)\n                        .then(() => {\n                            // MODIFIED: Only request update if not blocked by our overrides\n                            console.log('[CBLCARSMSDCard] SVG loaded, scheduling safe update');\n                            // Use setTimeout to avoid immediate re-render during setConfig\n                            setTimeout(() => {\n                                if (this.requestUpdate && !this._blockUpdates) {\n                                    this.requestUpdate();\n                                }\n                            }, 100);\n                        })\n                        .catch((error) => {\n                            console.warn('[CBLCARSMSDCard] Failed to load user SVG:', error);\n                        });\n                }\n            }\n\n            this._svgKey = svgKey;\n            console.log('[CBLCARSMSDCard] SVG key stored:', svgKey);\n        }\n\n        console.log('[CBLCARSMSDCard] Config set with disabled entity tracking and SVG handling preserved');\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 4,\n            grid_columns: 4\n        };\n    }\n\n    /**\n     * Override setHass to prevent MSD system re-renders that cause disappearing\n     * MSD system manages its own HASS updates internally\n     */\n    setHass(hass) {\n        console.log('[MSD DEBUG]  CBLCARSMSDCard.setHass() CALLED:', {\n            timestamp: new Date().toISOString(),\n            hasHass: !!hass,\n            lightDeskState: hass?.states?.['light.desk']?.state,\n            callerStack: new Error().stack.split('\\n').slice(1, 4).map(line => line.trim()).join('  ')\n        });\n\n        // Store HASS reference but don't call parent setHass which triggers re-renders\n        this.hass = hass;\n\n        // CRITICAL: ALWAYS update SystemsManager with the FRESHEST HASS immediately\n        // This ensures _originalHass is never stale\n        if (this._msdPipeline && this._msdPipeline.systemsManager) {\n            console.log('[MSD DEBUG]  IMMEDIATELY updating SystemsManager with FRESH HASS');\n            console.log('[MSD DEBUG]  Fresh HASS light.desk state being sent:', hass?.states?.['light.desk']?.state);\n\n            // ALSO: Forward fresh HASS directly to controls immediately\n            // This bypasses the entity change detection delay\n            if (this._msdPipeline.systemsManager.controlsRenderer) {\n                console.log('[MSD DEBUG]  Immediately forwarding fresh HASS to controls');\n                this._msdPipeline.systemsManager.controlsRenderer.setHass(hass);\n            }\n        }\n\n        // Forward HASS to the MSD system directly instead of re-rendering the card\n        if (this._msdPipeline && typeof this._msdPipeline.ingestHass === 'function') {\n            console.log('[MSD DEBUG]  Forwarding HASS to MSD pipeline via ingestHass');\n            this._msdPipeline.ingestHass(hass);\n        }\n\n        // CRITICAL: Call parent setHass to ensure Home Assistant's normal HASS flow continues\n        // This ensures the card gets updated when entities change outside of MSD system\n        console.log('[MSD DEBUG]  Calling super.setHass() to maintain HA compatibility');\n        super.setHass(hass);\n\n        console.log('[MSD DEBUG]  CBLCARSMSDCard.setHass() COMPLETED - SystemsManager should now have fresh HASS');\n    }\n\n    /**\n     * Override updated to prevent re-renders\n     */\n    updated(changedProperties) {\n        console.log('[MSD DEBUG]  CBLCARSMSDCard.updated() CALLED:', {\n            timestamp: new Date().toISOString(),\n            changedProperties: Array.from(changedProperties.keys()),\n            stackTrace: new Error().stack.split('\\n').slice(1, 4).map(line => line.trim()).join('  ')\n        });\n\n        // Check if this is a control-triggered HASS change\n        if (changedProperties.has('hass') || changedProperties.has('_hass')) {\n            const isControlTriggered = this._isControlTriggeredUpdate();\n\n            if (isControlTriggered) {\n                console.log('[MSD DEBUG]  BLOCKED super.updated() for control-triggered HASS change');\n                return;\n            } else {\n                console.log('[MSD DEBUG]  Allowing super.updated() for non-control HASS change');\n            }\n        }\n\n        console.log('[MSD DEBUG]  Calling super.updated() for changes:', Array.from(changedProperties.keys()));\n        super.updated(changedProperties);\n    }\n\n\n\n    requestUpdate(name, oldValue, options) {\n        console.log('[MSD DEBUG]  CBLCARSMSDCard.requestUpdate() CALLED:', {\n            timestamp: new Date().toISOString(),\n            name,\n            hasOldValue: oldValue !== undefined,\n            stackTrace: new Error().stack.split('\\n').slice(1, 4).map(line => line.trim()).join('  ')\n        });\n\n        // ENHANCED: Block ALL HASS-related updates for MSD cards to prevent re-renders\n        if (name === 'hass' || name === '_hass') {\n            console.log('[MSD DEBUG]  BLOCKED requestUpdate() for HASS change:', name);\n            console.log('[MSD DEBUG]  MSD system manages its own HASS updates internally');\n            return Promise.resolve(); // Block the MSD card from re-rendering\n        }\n\n        console.log('[MSD DEBUG]  Allowing requestUpdate() for:', name);\n        return super.requestUpdate(name, oldValue, options);\n    }\n\n\n\n    /**\n     * Check if the current HASS update is from a control-triggered entity change\n     * @private\n     * @returns {boolean} True if this is a control-triggered update\n     */\n    _isControlTriggeredUpdate() {\n        // Access the MSD system's entity change analysis\n        if (window.__msdDebug?.systemsManager) {\n            const lastAnalysis = window.__msdDebug.systemsManager._lastEntityAnalysis;\n            if (lastAnalysis && lastAnalysis.isControlTriggered) {\n                const timeSinceAnalysis = Date.now() - lastAnalysis.timestamp;\n                // If analysis was recent (within 100ms), consider this a control-triggered update\n                return timeSinceAnalysis < 100;\n            }\n        }\n        return false;\n    }\n\n    connectedCallback() {\n        console.log('[CBLCARSMSDCard.connectedCallback] MSD card connected to DOM');\n        super.connectedCallback();\n    }\n\n    disconnectedCallback() {\n        console.log('[CBLCARSMSDCard.disconnectedCallback] MSD card disconnected from DOM');\n        if (this.msdSystem) {\n            console.log('[CBLCARSMSDCard.disconnectedCallback] Cleaning up MSD system');\n            // Don't destroy the MSD system here in case it's just a temporary disconnect\n        }\n        super.disconnectedCallback();\n    }\n}\n\nclass CBLCARSDoubleElbowCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-double-elbow-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-double-elbow-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            };\n    }\n\n    setConfig(config) {\n\n        const defaultCardType = 'cb-lcars-header-picard';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 1,\n            grid_columns: 4\n        };\n      }\n}\n\nclass CBLCARSMultimeterCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-multimeter-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-multimeter-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            variables: {\n                _mode: 'gauge'\n            }\n        };\n    }\n\n    constructor() {\n        super();\n        this._enableResizeObserver = true;\n    }\n\n    setConfig(config) {\n\n        const defaultTemplates = ['cb-lcars-multimeter'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 1,\n            grid_columns: 4\n        };\n      }\n\n    render() {\n        if (!customElements.get('my-slider-v2')) {\n            return html`<ha-alert alert-type=\"error\" title=\"CB-LCARS - Dependency Error\">Required 'my-slider-v2' card is not available - Please refer to the documentation.</ha-alert>`;\n        }\n\n        // Render the card normally\n        return super.render();\n    }\n}\n\nclass CBLCARSDPADCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-dpad-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-dpad-card';\n    }\n\n    static get defaultConfig() {\n        return {};\n    }\n\n    setConfig(config) {\n\n        const defaultTemplates = ['cb-lcars-dpad'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 4,\n            grid_columns: 2\n        };\n      }\n}\n\nclass CBLCARSButtonCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-button-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-button-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            label: \"CB-LCARS Button\",\n            show_label: true\n        };\n    }\n\n    setConfig(config) {\n\n        const defaultCardType = 'cb-lcars-button-lozenge';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_min_rows: 1,\n            grid_rows: 1,\n            grid_columns: 2,\n            grid_min_columns: 1\n        };\n      }\n}\n\n// Helper function to define custom elements and their editors\nfunction defineCustomElement(cardType, cardClass, editorType, editorClass) {\n    customElements.define(cardType, cardClass);\n    customElements.define(editorType, class extends editorClass {\n        constructor() {\n            super(cardType);\n        }\n    });\n}\n\n// Register the cards to be available in the GUI editor\nwindow.customCards = window.customCards || [];\nconst CBLCARSCardClasses = [\n    {\n        type: 'cb-lcars-base-card',\n        name: 'CB-LCARS Base Card',\n        description: 'For advanced use: the CB-LCARS base card for full manual configuration.',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-label-card',\n        name: 'CB-LCARS Label',\n        preview: true,\n        description: 'CB-LCARS label card for text.',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-elbow-card',\n        name: 'CB-LCARS Elbow',\n        preview: true,\n        description: 'CB-LCARS Elbow card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-double-elbow-card',\n        name: 'CB-LCARS Double Elbow',\n        preview: true,\n        description: 'CB-LCARS Double Elbow card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-multimeter-card',\n        name: 'CB-LCARS Multimeter',\n        preview: true,\n        description: 'CB-LCARS Multimeter card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-dpad-card',\n        name: 'CB-LCARS D-Pad',\n        preview: true,\n        description: 'CB-LCARS D-Pad card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-button-card',\n        name: 'CB-LCARS Button',\n        preview: true,\n        description: 'CB-LCARS Buttons [various styles]',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-msd-card',\n        name: 'CB-LCARS MSD',\n        preview: true,\n        description: 'CB-LCARS Master Systems Display (MSD) card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    }\n];\n\nwindow.customCards.push(...CBLCARSCardClasses);","import { initMsdPipeline, initMsdHud } from './pipeline/PipelineCore.js';\nimport { processMsdConfig } from './pipeline/ConfigProcessor.js';\nimport { mergePacks, validateMerged } from './pipeline/ConfigProcessor.js';\nimport { buildCardModel } from './model/CardModel.js';\n\n// Import tests and services\nimport \"./tests/routingScenarios.js\"\nimport \"./tests/smartRoutingScenarios.js\"\nimport \"./tests/channelsRoutingScenarios.js\"\nimport \"./tests/arcsRoutingScenarios.js\";\nimport \"./tests/smoothingRoutingScenarios.js\";\nimport \"./hud/hudService.js\";\n\n// Main exports\nexport { initMsdPipeline, processMsdConfig };\n\n// Utility exports\nexport { mergePacks, validateMerged };\n\n// Debug exposure\n(function attachDebug() {\n  if (typeof window === 'undefined') return;\n\n  window.__msdDebug = window.__msdDebug || {};\n  Object.assign(window.__msdDebug, {\n    mergePacks,\n    buildCardModel,\n    initMsdPipeline\n  });\n\n  // Enhanced debug interface\n  Object.assign(window.__msdDebug, {\n    // Authoritative pipeline instance\n    pipelineInstance: null,\n\n    // Initialize MSD pipeline\n    async initMsdPipeline(mergedConfig, mount, hass) {\n      try {\n        const pipelineApi = await initMsdPipeline(mergedConfig, mount, hass);\n\n        // Set the authoritative pipelineInstance property\n        this.pipelineInstance = pipelineApi;\n\n        return pipelineApi;\n      } catch (error) {\n        console.error('[MSD Debug] Pipeline initialization failed:', error);\n        throw error;\n      }\n    }\n  });\n\n  // DataSourceManager property with getter\n  Object.defineProperty(window.__msdDebug, 'dataSourceManager', {\n    get() {\n      // Simplified: Use pipelineInstance as single source of truth\n      return window.__msdDebug.pipelineInstance?.dataSourceManager ||\n             window.__msdDebug.pipelineInstance?.systemsManager?.dataSourceManager;\n    },\n    configurable: true  // Allow it to be redefined if needed\n  });\n})();\n\n\n","export function getLovelace() {\n    let root = document.querySelector('home-assistant');\n    root = root && root.shadowRoot;\n    root = root && root.querySelector('home-assistant-main');\n    root = root && root.shadowRoot;\n    root = root && root.querySelector('app-drawer-layout partial-panel-resolver, ha-drawer partial-panel-resolver');\n    root = (root && root.shadowRoot) || root;\n    root = root && root.querySelector('ha-panel-lovelace');\n    root = root && root.shadowRoot;\n    root = root && root.querySelector('hui-root');\n    if (root) {\n      const ll = root.lovelace;\n      ll.current_view = root.___curView;\n      return ll;\n    }\n    return null;\n  }\n\n  export function checkLovelaceTemplates(config) {\n    const ll = getLovelace();\n    const lovelaceTemplates = ll && ll.config && ll.config.cblcars_card_templates ? ll.config.cblcars_card_templates : {};\n    let isUsingLovelaceTemplate = false;\n    let overriddenTemplates = [];\n\n    let templates = config.template || [];\n\n    for (const template of templates) {\n        if (lovelaceTemplates.hasOwnProperty(template)) {\n            isUsingLovelaceTemplate = true;\n            overriddenTemplates.push(template);\n        }\n    }\n\n    // Remove duplicates and sort the array\n    overriddenTemplates = [...new Set(overriddenTemplates)].sort();\n\n    return { isUsingLovelaceTemplate, overriddenTemplates };\n}"],"names":["t","r","e","__assign","Object","assign","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","DEFAULT_THRESHOLDS","second","minute","hour","day","format","Intl","DateTimeFormat","language","weekday","month","a","o","year","u","c","m","l","d","f","g","h","system","comma_decimal","decimal_comma","space_comma","none","am_pm","twenty_four","b","time_format","Date","toLocaleString","includes","v","_","hour12","y","w","k","x","D","S","F","T","I","N","M","from","to","thresholds","now","resolvedThresholds","secs","Math","abs","value","round","unit","mins","hours","SECS_PER_MIN","days","SECS_PER_HOUR","fromDate","toDate","years","getFullYear","months","getMonth","weeks","SECS_PER_DAY","RelativeTimeFormat","numeric","NumberFormat","style","unitDisplay","C","attributes","remaining","split","map","Number","state","getTime","last_changed","max","O","q","_themes","default_theme","themes","keys","forEach","updateStyles","window","ShadyCSS","styleSubtree","document","querySelector","hasAttribute","setAttribute","getAttribute","A","getCardSize","E","substr","indexOf","j","R","locale","translationMetadata","translations","isRTL","z","L","entity_id","P","unit_of_measurement","state_class","U","number_format","B","pow","H","isNaN","V","console","error","maximumFractionDigits","toString","currency","minimumFractionDigits","W","device_class","has_date","has_time","setHours","join","toISOString","humidity","G","J","K","Q","X","Y","Z","$","Set","ee","te","re","ne","Event","bubbles","cancelable","Boolean","composed","detail","dispatchEvent","ie","ae","alert","automation","climate","cover","fan","group","input_boolean","input_number","input_select","input_text","light","lock","media_player","remote","scene","script","sensor","timer","switch","vacuum","water_heater","input_datetime","oe","type","config","createElement","setConfig","message","startsWith","has","entity","customElements","get","display","setTimeout","whenDefined","then","clearTimeout","ue","slice","ce","calendar","camera","configurator","conversation","device_tracker","history_graph","homeassistant","homekit","image_processing","mailbox","notify","person","plant","proximity","simple_alarm","sun","updater","weblink","me","warn","se","attribute","operator","match","le","de","history","replaceState","pushState","replace","fe","callService","ge","states","pe","action","confirmation","exemptions","some","user","id","confirm","text","camera_image","entityId","navigation_path","url_path","open","service","service_data","target","he","double_tap_action","hold_action","tap_action","be","haptic","ve","_e","hass","ye","we","push","ke","shadowRoot","lovelace","current_view","___curView","xe","illuminance","temperature","pressure","power","signal_strength","De","binary_sensor","Se","icon","defineProperty","exports","getNestedProperty","deepMerge","source","output","key","targetValue","sourceValue","Array","isArray","isObject","generateControl","control","card","context","_hass","isVisible","visibilityCondition","_evaluateCondition","isDisabled","disabledCondition","isRequired","requiredCondition","selector","select","optionsCondition","options","lit_1","html","configValue","_config","label","helper","_valueChanged","alertType","title","unsafe_html_js_1","unsafeHTML","displayText","colorValue","isCssVariable","computedColorValue","cssVariableNameMatch","cssVariableName","getComputedStyle","documentElement","getPropertyValue","trim","hexToRgb","hex","bigint","parseInt","textColor","nr","ng","nb","getLuminance","obj","path","reduce","acc","part","custom_card_helpers_1","interfaces_1","controls_1","EditorForm","LitElement","constructor","super","_selectedTab","_userStyles","css","_mergeUserStyles","requestUpdate","generateForm","cardConfigData","tabs","generateTabs","formControls","render_form","row","isSection","generateSection","generateRow","_handleTabActivated","event","name","visibleTabs","filter","tab","index","content","item","section","_a","cssClass","headerTag","headerLevel","headerContent","secondary","expanded","noCollapse","outlined","leftChevron","rows","controls","condition","Function","ev","_b","configPath","newValue","_getNewValue","tagName","_updateConfig","fireEvent","_c","checked","__checked","values","nestedConfig","lastKey","updated","changedProperties","adoptedStyleSheets","styles","styleSheet","isControlRow","CBLCARS_VERSION","version","project_url","core_fonts","templates_uri","stub_config_uri","theme_colors_uri","card_editor_uri","builtin_svg_keys","builtin_svg_basepath","DataSourceMixin","resolveContent","rendererName","_raw","data_source","processEnhancedTemplateStrings","dataSourceContent","resolveDataSourceContent","dataSourceRef","dataSourceManager","__msdDebug","pipelineInstance","systemsManager","sourceName","dataKey","isTransformation","isAggregation","parseDataSourceReference","dataSource","getSource","currentData","getCurrentData","transformations","aggregations","aggData","undefined","avg","last","JSON","stringify","formatDataSourceValue","parts","dataType","dataSourceData","value_format","formatSpec","applyNumberFormat","String","isInteger","toFixed","unitOfMeasurement","endsWith","precision","log","processEnhancedTemplateStringsWithFallback","processTemplateForInitialRender","processed","fallbackToOriginal","hasUnresolvedTemplates","processedContent","reference","cleanRef","nestedKeys","baseKey","nestedKey","baseData","getNestedValue","direction","current","getDataSourceManager","getAvailableDataSources","dsm","sources","PositionResolver","resolvePosition","position","anchors","anchorPos","RendererUtils","_getTextMeasureContext","cblcars","_textMeasureCanvas","_textMeasureContext","getContext","_textMeasureCache","Map","_getSvgTransformInfo","containerElement","svg","viewBox","baseVal","rect","getBoundingClientRect","scaleX","width","scaleY","height","screenRect","pixelToViewBox","pixelSize","measureText","font","useCache","ascent","descent","cacheKey","cache","cached","_transformTextMetrics","ctx","metrics","result","actualBoundingBoxAscent","actualBoundingBoxDescent","actualLeft","actualBoundingBoxLeft","actualRight","actualBoundingBoxRight","_pixelWidth","_pixelHeight","_pixelAscent","_pixelDescent","set","transformInfo","transformed","original","scaleInfo","measureMultilineText","lineHeight","lines","lineMetrics","line","maxWidth","fontSize","_parseFontSize","adjustedFontSize","adjustedLineHeight","_transformApplied","_adjustedFontSize","getTextBoundingBox","textAnchor","dominantBaseline","left","top","bbox","right","bottom","centerX","centerY","substring","inputPosition","hasContainer","getTextAttachmentPoints","padding","center","topLeft","topRight","bottomLeft","bottomRight","topPadded","bottomPadded","leftPadded","rightPadded","parseFloat","buildFontString","textStyle","fontStyle","fontWeight","fontFamily","resolveFontFamily","computed","buildMeasurementFontString","adjustedPx","screenPxPerViewBoxUnit","clearTextMeasureCache","clear","getTextMeasureCacheStats","size","parseGradientConfig","gradientConfig","colors","stops","color","offset","color1","color2","x1","y1","x2","y2","cx","cy","parsePatternConfig","patternConfig","dots","opacity","diagonal","grid","parseGlowConfig","glowConfig","blur","intensity","parseStandardTextStyles","font_size","font_family","font_weight","font_style","text_color","labelColor","label_color","valueColor","value_color","textAlign","text_align","verticalAlign","vertical_align","textShadow","parseTextShadowConfig","text_shadow","textStroke","parseTextStrokeConfig","text_stroke","line_height","letterSpacing","letter_spacing","parseStandardColorStyles","primaryColor","primary_color","backgroundColor","background_color","borderColor","border_color","hoverColor","hover_color","activeColor","active_color","focusColor","focus_color","disabledColor","disabled_color","successColor","success_color","warningColor","warning_color","errorColor","error_color","infoColor","info_color","parseStandardLayoutStyles","borderWidth","border_width","borderRadius","border_radius","borderStyle","border_style","parsePaddingConfig","margin","parseMarginConfig","visible","minWidth","min_width","max_width","minHeight","min_height","maxHeight","max_height","parseStandardInteractionStyles","hoverEnabled","hover_enabled","hoverScale","hover_scale","hoverOpacity","hover_opacity","hoverTransition","hover_transition","clickable","activeScale","active_scale","focusEnabled","focus_enabled","focusOutline","focus_outline","cursor","parseStandardAnimationStyles","animatable","transition","transitionDelay","transition_delay","transitionDuration","transition_duration","transitionTimingFunction","transition_timing_function","animationDuration","animation_duration","animationTimingFunction","animation_timing_function","animationDelay","animation_delay","animationIterationCount","animation_iteration_count","animationDirection","animation_direction","animationFillMode","animation_fill_mode","cascadeSpeed","cascade_speed","cascadeDirection","cascade_direction","revealAnimation","reveal_animation","pulseOnChange","pulse_on_change","parseAllStandardStyles","layout","interaction","animation","gradient","pattern","glow","shadow","parseShadowConfig","parseBlurConfig","shadowConfig","offsetX","offset_x","offsetY","offset_y","strokeConfig","vertical","horizontal","applyStandardTextStyles","textStyles","applyStandardLayoutStyles","layoutStyles","createTextShadowCSS","createAnimationDataAttributes","animationStyles","blurConfig","amount","createGradientDefinition","stop","getLinearGradientCoords","directions","createPatternDefinition","patternContent","createGlowFilter","createShadowFilter","createBlurFilter","createLcarsBracket","side","bracketWidth","cornerRadius","strokeWidth","pathData","createMarkerDefinition","marker","getMarkerSize","markerContent","refX","refY","rotate","small","medium","large","xlarge","escapeXml","generateId","prefix","suffix","random","parseColor","tempElement","body","appendChild","computedColor","removeChild","rgbMatch","rgb","rgbToHex","hsl","rgbToHsl","min","getContrastColor","interpolateColor","factor","c1","c2","createAnimationAttributes","animationConfig","toLowerCase","animation_ref","animationRef","ref","sanitizeStyles","sanitized","validators","isValidColor","isValidOpacity","isValidNumber","stroke","fill","isValidString","validator","camelToKebab","test","num","isFinite","str","getDomTextBBox","groupEl","textEl","bb","getBBox","StatusGridRenderer","gradientCache","patternCache","filterCache","render","overlay","renderStatusGrid","finalStyle","gridStyle","_resolveStatusGridStyles","animationAttributes","_prepareAnimationAttributes","cells","_resolveCellConfigurations","_renderEnhancedStatusGrid","_renderFallbackStatusGrid","overlayId","standardStyles","columns","cell_width","cellWidth","cell_height","cellHeight","cell_gap","cellGap","cell_color","cell_opacity","cell_radius","cell_border","cellBorder","show_labels","show_values","status_mode","statusMode","status_ranges","_parseStatusRanges","statusRanges","unknown_color","show_grid_lines","showGridLines","grid_line_color","gridLineColor","grid_line_opacity","gridLineOpacity","bracket_style","bracketStyle","bracket_color","bracketColor","status_indicator","statusIndicator","lcars_corners","lcarsCorners","update_throttle","updateThrottle","features","range","Infinity","gridAttributes","cellAttributes","hasAnimations","animationDataAttrs","gap","gridMarkup","cell","cellX","col","cellY","cellColor","_determineCellColor","labelX","labelY","_escapeXml","valueX","valueY","data","_resolveCellContent","cellContent","cellId","hasContent","hasRawContent","hasLabel","rawContent","resolvedContent","cellsConfig","raw","hasCells","cellCount","cellsData","checkedSources","cellConfig","floor","timestamp","lastUpdate","processedCell","_resolveCellContentForInitialRender","totalCells","fromCharCode","updateCellsWithData","newDataSourceData","_processConditionalWithDataSourceMixin","safeContent","_extractValueFromTemplate","_getDataSourceForCell","changedDataSourceData","templateMatch","pathPart","dataSourceName","sourceData","_originalContent","_isConditional","numericValue","conditionalTemplate","expression","conditionMatch","leftPath","rightValue","trueValue","falseValue","dataSourceTemplate","resolvedValue","leftVal","rightVal","finalValue","TextOverlayRenderer","svgContainer","instance","container","renderText","_resolveTextStyles","host","cs","px","textContent","_resolveTextContent","_cachedContent","measure","_measureTextBlock","svgParts","_buildDefinitions","_buildMainText","_buildTextDecorations","_buildEffects","_renderFallbackText","text_anchor","dominant_baseline","alignmentBaseline","alignment_baseline","wordSpacing","word_spacing","textDecoration","text_decoration","visibility","stroke_width","strokeOpacity","stroke_opacity","strokeLinecap","stroke_linecap","strokeLinejoin","stroke_linejoin","strokeDasharray","stroke_dasharray","strokeDashoffset","stroke_dashoffset","multiline","textWrapping","text_wrapping","pulseSpeed","pulse_speed","fadeSpeed","fade_speed","typewriterSpeed","typewriter_speed","status_indicator_position","statusIndicatorPosition","highlight","dsManager","_processEnhancedTemplateStrings","defs","_createGradientDefinition","_createPatternDefinition","_createGlowFilter","_createShadowFilter","_createBlurFilter","_buildMultilineText","_applyTextAttributes","textAttributes","escapedText","tspanElements","dy","escapedLine","filters","decorations","_buildBrackets","_buildHighlight","_buildStatusIndicator","multilineMetrics","leftX","rightX","topY","bottomY","highlight_opacity","indicatorSize","statusColor","containerTag","hasSvg","textMetrics","containerType","indicatorX","indicatorY","pixelPadding","gradientId","patternId","patternUnits","filterId","updateTextStyle","newStyle","getCapabilities","gradients","patterns","effects","animations","advancedTypography","strokeText","advanced","getAttachmentPoints","computeAttachmentPoints","points","mm","_resolveTextContentWithData","_processTemplateWithData","templateString","fullPath","pathParts","formattedValue","pi","enabled","Error","inspect","routing","invalidate","scope","__msdScenarios","targetLine","ensureRound","lineId","ov","getResolvedModel","overlays","find","corner_style","corner_radius","scenarios","arc_presence","res","ok","meta","arc","count","details","dSample","radius_clamp","trimPx","arc_cache_reuse","first","cache_hit","firstHit","secondHit","arcCount","miter_fallback","origStyle","hasArcMeta","api","list","run","runAll","allOk","every","arcs","info","scenarioPreferImprovesCost","origChannels","route_channels","origMode","route_channel_mode","base","preferred","cost","baseCost","preferCost","scenarioAvoidIncreasesCost","prefer","avoid","avoidCost","scenarioForcePenalty","forced","channel","forcedOutside","coveragePct","scenarioPreferShapingCoverage","save","channels","mode","modeFull","route_mode_full","setAnchor","anchorId","anchor","rm","coverageBefore","coverageAfter","prefer_improves_cost","avoid_increases_cost","force_penalty_or_full_coverage","prefer_shaping_coverage","force_downgrade_or_full","chan","shaping","downgraded","channel_acceptance","force","requirePipeline","getModel","lastRenderModel","findOverlay","listOverlays","grid_vs_manhattan","man","strategy","gridStrategy","manStrategy","avoid_creates_bend","targetId","before","originalAvoid","after","bends","bendsBefore","bendsAfter","mode_hint_yx","route_mode","yx","basePts","pts","yxPts","baseHorizontalFirst","yxVerticalFirst","clearance_shift","router","orig","clearance","raised","raisedCost","anchor_move","model","moved","fallback_impossible_grid","originalComputeGrid","_computeGrid","req","results","summaryOk","withMode","fn","smart_vs_grid_cost","smart","gridCost","smartCost","smart_refinement_attempt","smartMeta","detoursTried","smart_penalty_reduction","baseSmart","penaltyAfter","penaltyBefore","smart_cache_behavior","setMode","ensureBaseline","smoothing_increases_points","smoothing_mode","smoothing_iterations","sm","smooth","smoothPts","smoothing_cache_hit","smoothing_disabled_no_meta","hasSmoothMeta","smoothing_invalid_mode_fallback","smoothing","waitForElement","root","timeout","Promise","resolve","reject","found","observer","MutationObserver","el","disconnect","observe","childList","subtree","async","waitForElements","targets","items","Element","selectors","sel","allNow","querySelectorAll","animateWithRoot","scopeId","animOptions","elements","element","anim","scopes","scopeObj","anime","addAnimation","animateElement","debug","add","params","duration","easing","state_resolver","styleHelpers","resolveStateStyles","resolvedStyles","applyPresets","presetFn","morph_to_selector","morphTarget","animejs","morphTo","_cssAnimation","createTimeline","timelineConfig","timeline","step","vars","createTimelines","timelinesConfig","overlayConfigs","stylePresets","timelines","resolveAll","resolveAllDynamicValues","timelineName","entries","steps","timelineGlobals","resolvedGlobals","mergedParams","resolveStatePreset","overrides","transformOrigin","transformBox","__timeline","preset","deep","descendants","apply_to","animeParams","applyToDescendants","immediateKeys","immediateSet","userOnBegin","onBegin","nodes","utils","prop","val","autoplay","types","presetList","animPresets","draw","drawable","createDrawable","loop","alternate","drawCfg","drawValues","pulse","pulseCfg","maxScale","max_scale","minOpacity","min_opacity","scale","cssText","blink","max_opacity","fade","motionpath","tracerCfg","tracer","msg","pathSelector","path_selector","pathEl","catch","errorMsg","baseId","hasUsablePathD","pathLengthOk","getTotalLength","isPending","cleanupArtifacts","svgRoot","ownerSVGElement","closest","priorTracer","priorTrail","parentNode","trailPath","tracerNode","pathMutationObserver","alive","buildTrail","trailOpt","trail","cloneNode","sw","insertBefore","nextSibling","trailVars","buildTracer","tid","existing","getElementById","tracerMarkup","shape","attrs","temp","createElementNS","innerHTML","firstElementChild","bindTracerAnimation","translateX","translateY","createMotionPath","exclude","merged","__cblcars_motion","pause","rebindAll","reason","removeAttribute","initArtifacts","waitMaxMs","wait_max_ms","pollInterval","startTime","performance","waitForReady","tick","pending","usable","muts","needs","attributeName","attributeFilter","pathId","reattachPoll","SVGPathElement","__cblcars_motionpath_cleanup","march","dashArray","dashLength","gapLength","linecap","cycleLength","durationSec","reversed","animId","dataset","marchAnimId","offsetTarget","loopValue","iterationCount","targetDoc","getRootNode","isInShadowDOM","animationName","keyframesStr","effectiveDuration","playbackRate","sheet","marchAnimations","CSSStyleSheet","insertRule","cssRules","fallbackStyleInjection","styleId","styleEl","head","glowCfg","blurMin","blur_min","blurMax","blur_max","opacityMin","opacity_min","opacityMax","opacity_max","glowState","onUpdate","shimmer","strobe","cascade","delay","stagger","ripple","flicker","ignoreKeys","allParams","propsToSet","animeSetWorked","cblcarsGlobalLogLevel","cblcarsSetGlobalLogLevel","level","cblcarsLog","cblcarsGetGlobalLogLevel","baseLogger","args","levels","currentLevelIndex","levelStyles","default","logMessage","cblcarsLogBanner","url","baseString","spacesNeeded","spaces","repeat","paddedUrl","setGlobalLogLevel","getGlobalLogLevel","drawLine","attrsToString","styleToString","drawPolyline","pt","drawPath","drawText","drawCircle","drawRect","globalThis","trustedTypes","createPolicy","createHTML","createComment","Symbol","iterator","RegExp","_$litType$","strings","for","WeakMap","createTreeWalker","lastIndex","exec","currentNode","firstChild","replaceWith","childNodes","nextNode","nodeType","hasAttributes","getAttributeNames","ctor","emptyScript","append","_$Co","_$Cl","_$litDirective$","_$AO","_$AT","_$AS","_$AV","_$AN","_$AD","_$AM","_$AU","creationScope","importNode","_$AI","_$Cv","_$AH","_$AA","_$AB","isConnected","startNode","endNode","_$AR","createTextNode","_$AC","_$AP","remove","setConnected","toggleAttribute","capture","once","passive","removeEventListener","addEventListener","handleEvent","litHtmlPolyfillSupport","litHtmlVersions","renderBefore","_$litPart$","_$Ct","_$Ci","update","it","directiveName","_t","resultType","ShadowRoot","nativeShadow","Document","_$cssResult$","replaceSync","litNonce","is","getOwnPropertyDescriptor","getOwnPropertyNames","getOwnPropertySymbols","getPrototypeOf","reactiveElementPolyfillSupport","toAttribute","fromAttribute","parse","converter","reflect","useDefault","hasChanged","metadata","litPropertyMetadata","HTMLElement","addInitializer","_$Ei","observedAttributes","finalize","_$Eh","createProperty","create","wrapped","elementProperties","noAccessor","getPropertyDescriptor","configurable","enumerable","getPropertyOptions","finalized","properties","_$Eu","elementStyles","finalizeStyles","flat","reverse","unshift","_$Ep","isUpdatePending","hasUpdated","_$Em","_$Ev","_$ES","enableUpdating","_$AL","_$E_","addController","_$EO","renderRoot","hostConnected","removeController","delete","createRenderRoot","attachShadow","shadowRootOptions","connectedCallback","disconnectedCallback","hostDisconnected","attributeChangedCallback","_$AK","_$ET","_$Ej","_$EP","_$Eq","scheduleUpdate","performUpdate","shouldUpdate","willUpdate","hostUpdate","_$EM","_$AE","hostUpdated","firstUpdated","updateComplete","getUpdateComplete","ReactiveElement","reactiveElementVersions","renderOptions","_$Do","_$litElement$","litElementHydrateSupport","litElementPolyfillSupport","litElementVersions","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__","definition","toStringTag","isBrowser","win","doc","compositionTypes","blend","isRegisteredTargetSymbol","isDomSymbol","isSvgSymbol","transformsSymbol","morphPointsSymbol","proxyTargetSymbol","minValue","maxValue","emptyString","shortTransforms","validTransforms","transformsFragmentStrings","noop","hexTestRgx","rgbExecRgx","rgbaExecRgx","hslExecRgx","hslaExecRgx","digitWithExponentRgx","unitsExecRgx","lowerCaseRgx","transformsExecRgx","relativeValuesExecRgx","defaults","keyframes","playbackEase","frameRate","loopDelay","ease","composition","modifier","onBeforeUpdate","onLoop","onPause","onComplete","onRender","globals","timeScale","tickThreshold","globalVersions","engine","AnimeJS","stringStartsWith","sub","isArr","isObj","isNum","isStr","isFnc","isUnd","isNil","isSvg","SVGElement","isHex","isRgb","isHsl","isKey","parseNumber","sqrt","sin","cos","exp","ceil","asin","atan2","PI","_round","clamp","powCache","decimalLength","snap","increment","cv","interpolate","start","end","progress","clampInfinity","normalizeTime","cloneArray","mergeObjects","o1","o2","o1p","forEachChildren","parent","callback","prevProp","nextProp","next","_head","adjustedNextProp","_tail","currentNext","child","prev","addChild","sortMethod","Clock","initTime","deltaTime","_currentTime","_elapsedTime","_startTime","_lastTime","_scheduledTime","_frameDuration","_fps","_speed","_hasChildren","fps","previousFrameDuration","fr","frameDuration","speed","pbr","requestTick","time","scheduledTime","elapsedTime","frameDelta","computeDeltaTime","delta","tickable","muteCallbacks","internalRender","tickMode","completed","iterationDuration","_currentIteration","_loopDelay","_reversed","_alternate","tickableDelay","_delay","tickablePrevAbsoluteTime","tickableEndTime","tickableAbsoluteTime","tickablePrevTime","tickableCurrentTime","isCurrentTimeAboveZero","isCurrentTimeEqualOrAboveDuration","isSetter","forcedTick","isOdd","iterationElapsedTime","hasRendered","currentIteration","isReversed","_ease","iterationTime","isRunningBackwards","backwards","_iterationTime","began","forcedRender","absoluteTime","_offset","tweenTarget","tweenStyle","tweenTargetTransforms","tweenTargetTransformsProperties","tween","tweenTransformsNeedUpdate","tweenComposition","_composition","tweenCurrentTime","tweenChangeDuration","_changeDuration","tweenAbsEndTime","_absoluteStartTime","tweenNextRep","_nextRep","tweenPrevRep","_prevRep","tweenHasComposition","_isOverridden","_isOverlapped","tweenNewTime","tweenProgress","_updateDuration","tweenModifier","_modifier","tweenValueType","_valueType","tweenType","_tweenType","tweenIsObject","tweenIsNumber","tweenPrecision","number","_fromNumber","_toNumber","_unit","_fromNumbers","tn","_toNumbers","ns","_numbers","_strings","_number","_value","tweenProperty","property","setProperty","_renderTransforms","transform","_next","paused","_resolve","tl","tlIsRunningBackwards","tlChildrenTime","tlCildrenTickTime","tlChildrenHasRendered","tlChildrenHaveCompleted","tlIterationDuration","childDuration","childStartTime","childTime","childTickMode","additive","engineTickMethod","requestAnimationFrame","setImmediate","engineCancelMethod","cancelAnimationFrame","clearImmediate","Engine","useDefaultMainLoop","pauseOnDocumentHidden","hidden","reqId","engineSpeed","engineFps","activeTickable","nextTickable","_running","_cancelled","cancel","wake","tickEngine","killEngine","resume","resetTime","timeUnit","isSecond","newScale","scaleFactor","getNodeList","NodeList","HTMLCollection","parseTargets","flattened","parsed","nodeList","jl","subItem","isDuplicate","kl","registerTargets","parsedTargetsArray","parsedTargetsLength","isSvgType","getPath","$parsedSvg","getPathPoint","$path","lookup","getPointAtLength","getPathProgess","pathProperty","$el","totalLength","inSvg","ctm","getCTM","p0","p1","cssReservedProperties","path2","$path1","$path2","isPath","separator","previousPoints","v1","v2","length1","length2","maxPoints","pointOnPath1","pointOnPath2","pathLength","computedStyles","strokeLineCap","$scalled","vectorEffect","currentCap","proxy","Proxy","getScaleFactor","os","d1","d2","newCap","Reflect","createDrawableProxy","hue2rgb","setValue","defaultValue","getFunctionValue","total","store","func","getTweenType","propertyName","elParentNode","isValidSVGAttribute","getCSSValue","propName","animationInlineStyles","inlineStyles","getOriginalAnimatableValue","inlineTransforms","inlinedStylesPropertyValue","cachedTransforms","inlinePropertyName","inlinePropertyValue","parseInlineTransforms","trimStart","getRelativeValue","decomposeRawValue","rawValue","targetObject","unitMatch","isCol","colorString","rgbValue","rgba","rgbToRgba","hexValue","hexLength","isShort","hexToRgba","hslValue","hsla","hslToRgba","matchedNumbers","decomposeTweenValue","decomposedOriginalValue","lookups","_rep","_add","getTweenSiblings","lookupMap","targetLookup","addTweenSortMethod","overrideTween","composeTween","siblings","tweenCompositionType","tweenAbsStartTime","prevSibling","prevParent","prevAbsEndTime","prevPrevSibling","absoluteUpdateStartTime","prevChangeStartTime","prevTLOffset","pausePrevParentAnimation","prevParentTL","pausePrevParentTL","additiveTweenSiblings","additiveAnimation","propertyAnimation","tweens","lookupTween","valueType","additiveValues","additiveValue","_prevAdd","addAdditiveAnimation","_prev","toNumber","toNumbers","removeTweenSliblings","tweenReplaceSiblings","addTweensLookup","addTargetProps","shouldClean","resetTimerProperties","reviveTimer","timerId","Timer","parameters","parentPosition","revertibles","timerInitTime","timerDefaults","timerDelay","timerDuration","timerLoop","timerLoopDelay","timerIterationCount","offsetPosition","_autoplay","_reverse","cancelled","reset","play","currentTime","seek","iterationCurrentTime","iterationProgress","init","linked","link","restart","isPaused","iterations","stretch","newDuration","currentDuration","normlizedDuration","revert","ap","complete","onResolve","createTimer","calcBezier","aT","aA1","aA2","cubicBezier","mX1","mY1","mX2","mY2","aX","currentX","currentT","aA","aB","binarySubdivide","fromStart","roundMethod","linear","argsLength","totalPoints","firstArg","lastArg","xPoints","yPoints","arg","splitValue","percent","prevX","prevY","irregular","randomness","previousValue","spacing","randomValue","halfPI","doublePI","easeInPower","easeInFunctions","Quad","Cubic","Quart","Quint","Sine","Circ","Expo","Bounce","pow2","Back","overshoot","Elastic","amplitude","period","easeTypes","in","easeIn","out","inOut","outIn","parseEaseString","string","easesFunctions","easesLookups","parsedFn","eases","easeType","JSEasesLookups","parseEasings","propertyNamesCache","sanitizePropertyName","cachedPropertyName","lowerCaseName","angleUnitsMap","convertedValuesCache","convertValueUnit","decomposedValue","currentUnit","currentNumber","cachedKey","convertedValue","baseline","tempEl","parentEl","elStyle","currentUnitWidth","offsetWidth","cleanInlineStyles","renderable","targetStyle","originalInlinedValue","_inlineStyles","removeProperty","fromTargetObject","toTargetObject","toFunctionStore","keyframesTargetArray","fastSetValuesArray","keyObjectTarget","tweenId","JSAnimation","fastSet","parsedTargets","targetsLength","kfParams","propertyNames","concat","propArray","newKey","keyValue","totalDuration","sort","prevKey","keyObj","durProgress","prevEase","currentEase","shift","generateKeyframes","animDefaults","animaPlaybackEase","animEase","hasSpring","tEasing","tDuration","tDelay","tModifier","tComposition","animInlineStyles","absoluteOffsetTime","NaN","iterationDelay","animationAnimationLength","shouldTriggerRender","targetIndex","ti","lastTransformGroupIndex","lastTransformGroupLength","propValue","isPropValueArray","arrayLength","isNotObjectValue","prevTween","firstTweenChangeStartTime","lastTweenChangeEndTime","tweenIndex","keyframe","computedToValue","tweenToValue","tweenFromValue","keyEasing","tweenEasing","tweenDuration","tweenDelay","computedComposition","hasFromvalue","hasToValue","isFromToArray","isFromToValue","tweenStartTime","absoluteStartTime","complexValue","notComplexValue","unitValue","notUnitValue","notColorValue","valueToConvert","longestValue","shortestValue","tweenUpdateDuration","_func","_nextAdd","additiveTween","refresh","ogValue","animate","easingToLinear","samples","WAAPIEasesLookups","WAAPIeases","parseWAAPIEasing","parsedEase","transformsShorthands","commonDefaultPXProperties","validIndividualTransforms","axis","transformsPropertiesRegistered","CSS","WAAPIAnimationsLookups","removeWAAPIAnimation","nextLookup","matchTarget","matchProperty","matchParent","commitStyles","lookupParent","_completed","addWAAPIAnimation","animTotalDuration","controlAnimation","handleRemove","onremove","onfinish","normalizeTweenValue","parseIndividualTweenValue","tweenValue","computedTo","WAAPIAnimation","isSkew","isScale","isRotate","isTranslate","isAngle","syntax","registerProperty","inherits","initialValue","spring","scroll","hasIndividualTransforms","composite","tweenParams","propertyValue","individualTransformProperty","parsedPropertyValue","tweenOptions","tweenOptionsEase","tweenOptionsSpring","transforms","cb","waapi","convertEase","sync","getTargetValue","targetSelector","normalizePropName","originalValue","setTargetValues","removeTargetsFromAnimation","targetsArray","tweensMatchesTargets","tweenName","waapiAnimation","removeMatches","childDur","mapRange","inLow","inHigh","outLow","outHigh","lerp","dt","ticker","chain","__","nextArgs","nextResult","makeChainable","curry","randomPick","shuffle","wrap","roundPad","padStart","padString","padEnd","degToRad","degrees","radToDeg","radians","parseTimelinePosition","timePosition","tlDuration","timePosStr","tlLabels","labels","hasLabels","prevOffset","goToPrevAnimationOffset","prevAnimation","getPrevChildOffset","hasSibling","matchedRelativeOperator","fullOperator","labelOffset","parsedOffset","parsedNumericalOffset","addTlChild","childParams","adjustedPosition","tlChild","getTimelineTotalDuration","Timeline","defaultsParams","globalDefaults","tlPlaybackEase","a1","a2","a3","isAnim","isTimer","staggeredPosition","parsedLength","staggeredChildParams","synced","effect","getTiming","labelName","Animatable","globalParams","paramValue","isObjValue","propParams","animParams","numbers","createAnimatable","Spring","timeStep","restThreshold","restDuration","maxDuration","maxRestSteps","maxIterations","mass","stiffness","damping","velocity","w0","zeta","wd","solverDuration","compute","solve","solverTime","restSteps","createSpring","preventDefault","DOMProxy","zIndex","parentElement","classList","Transforms","point","DOMPoint","inversedMatrix","getMatrix","inverse","normalizePoint","matrixTransform","traverseUp","matrix","DOMMatrix","transformValue","elMatrix","preMultiplySelf","ct","parseDraggableFunctionParameter","draggable","Draggable","paramX","paramY","trigger","releaseEase","customEase","xProp","mapTo","yProp","containerArray","$container","useWin","$scrollContainer","$target","$trigger","fixed","isFinePointer","containerPadding","containerFriction","releaseContainerFriction","snapX","snapY","scrollSpeed","scrollThreshold","dragSpeed","maxVelocity","minVelocity","velocityMultiplier","releaseXSpring","releaseMass","releaseStiffness","releaseDamping","releaseYSpring","outQuint","hasReleaseSpring","onGrab","onDrag","onRelease","onSettle","onSnap","onResize","onAfterResize","disabled","animatableParams","paramXObject","animatableXParams","paramYObject","animatableYParams","destX","destY","deltaX","deltaY","coords","snapped","pointer","scrollView","dragArea","containerBounds","scrollBounds","targetBounds","velocityStack","velocityStackIndex","velocityTime","angle","cursorStyles","triggerStyles","bodyStyles","targetStyles","touchActionStyles","overshootCoords","overshootXTicker","overshootYTicker","updateTicker","manual","contained","grabbed","dragged","released","canScroll","initialized","activeProp","hasReleased","dx","computeVelocity","resizeTicker","resizeObserver","ResizeObserver","enable","prevTime","curTime","elapsed","vMul","minV","maxV","vi","setX","muteUpdateCallback","setY","progressX","progressY","updateScrollCoords","sx","scrollX","scrollLeft","sy","scrollY","scrollTop","cpt","cpr","cpb","cpl","threshold","updateBoundingValues","cx2","cy2","iw","innerWidth","ih","innerHeight","uw","scrollWidth","sh","scrollHeight","fx","transformContainerRect","containerOverflow","visibleOverflow","hiddenOverflow","targetRect","hiddenLeft","hiddenTop","hiddenRight","hiddenBottom","isOutOfBounds","bounds","bt","br","bl","obx","oby","cp","parsedCursorStyles","onHover","matchMedia","matches","daw","dah","csx","csy","nsw","nsh","csw","csh","swd","shd","st","sr","sb","sl","nx","ny","scrollBy","scrollTo","cr","cl","px1","py1","px2","py2","px3","py3","cf","nsx","nsy","scrollInView","inOutQuad","handleHover","animateInView","ob","disabledX","disabledY","dur","handleDown","$eTarget","stopPropagation","touches","changedTouches","eventX","clientX","eventY","clientY","handleMove","movedX","movedY","$parent","isAtTop","isAtBottom","canTouchScroll","overflowY","clientHeight","pointerEvents","handleUp","springX","springY","pv","pa","ds","bx","by","durationX","durationY","easeX","easeY","longestReleaseDuration","directionX","distanceX","directionY","distanceY","hasSnapped","touchAction","disable","createDraggable","Scope","rootParam","nativeElement","scopeDefaults","globalDefault","mediaQueries","constructors","revertConstructors","methods","mediaQueryLists","mq","_mq","execute","activeScope","activeRoot","activeDefaults","mqs","returned","revertConstructor","createScope","parseScrollObserverFunctionParameter","scroller","scrollContainers","ScrollContainer","winWidth","winHeight","prevScrollX","prevScrollY","backwardX","backwardY","scrollTicker","dataTimer","handleScroll","self","py","updateWindowBounds","refreshScrollObservers","wakeTicker","updateBounds","offsetHeight","getMaxViewHeight","marginLeft","marginRight","marginTop","marginBottom","elRect","_debug","removeDebug","unobserve","convertValueToPx","under","over","clampMin","clampMax","parseBoundValue","matchedOperator","splitter","splitted","valueAPx","valueBPx","getAnimationDomTarget","$linkedTarget","linkedTargets","scrollerIndex","debugColors","ScrollObserver","syncMode","isLinear","isEase","isSmooth","isMethods","syncMethods","biDirSync","scrollContainer","registerAndGetScrollContainer","enter","leave","syncEase","syncSmooth","onSyncEnter","onSyncLeave","onSyncEnterForward","onSyncLeaveForward","onSyncEnterBackward","onSyncLeaveBackward","onEnter","onLeave","onEnterForward","onLeaveForward","onEnterBackward","onLeaveBackward","onSyncComplete","reverted","isInView","forceEnter","hasEntered","offsets","offsetStart","offsetEnd","distance","prevProgress","debugStyles","$debug","_params","backward","isHori","$existingDebug","$thresholds","$triggers","containerWidth","containerHeight","offLeft","offTop","half","labelHeight","labelWidth","labelSize","gradientOffset","lineCSS","baseCSS","isView","isTail","isFirst","isOver","isFlip","$label","$text","dirProp","flipOffset","stickys","linkedTime","$offsetParent","isContainerStatic","isSticky","offsetLeft","offsetTop","offsetParent","targetSize","containerSize","maxScroll","enterTarget","leaveTarget","enterContainer","leaveContainer","parsedEnterTarget","parsedLeaveTarget","parsedEnterContainer","parsedLeaveContainer","scrollDelta","sticky","shouldSeek","isBefore","isAfter","isOnTheEdge","syncCompleted","lp","onScroll","hasEasing","staggerEase","fromFirst","fromCenter","fromLast","isRange","val1","val2","fromIndex","fromX","fromY","isNothing","subject","common","toArray","sequence","cycle","isNegativeZero","NEGATIVE_INFINITY","extend","sourceKeys","formatError","exception","compact","where","mark","column","snippet","YAMLException$1","captureStackTrace","stack","getLine","buffer","lineStart","lineEnd","maxLineLength","tail","maxHalfLength","pos","TYPE_CONSTRUCTOR_OPTIONS","YAML_NODE_KINDS","tag","kind","construct","instanceOf","predicate","represent","representName","defaultStyle","multi","styleAliases","alias","compileStyleAliases","compileList","schema","currentType","newIndex","previousType","previousIndex","Schema$1","implicit","explicit","type$1","loadKind","compiledImplicit","compiledExplicit","compiledTypeMap","scalar","mapping","fallback","collectType","compileMap","seq","failsafe","_null","object","canonical","lowercase","uppercase","camelcase","empty","bool","isHexCode","isOctCode","isDecCode","ch","hasDigits","charCodeAt","sign","binary","octal","decimal","hexadecimal","toUpperCase","YAML_FLOAT_PATTERN","SCIENTIFIC_WITHOUT_DOT","POSITIVE_INFINITY","json","core","YAML_DATE_REGEXP","YAML_TIMESTAMP_REGEXP","date","fraction","UTC","setTime","merge","BASE64_MAP","code","idx","bitlen","charAt","tailbits","input","bits","Uint8Array","_hasOwnProperty$3","_toString$2","omap","pair","pairKey","pairHasKey","objectKeys","_toString$1","pairs","_hasOwnProperty$2","_default","_hasOwnProperty$1","PATTERN_NON_PRINTABLE","PATTERN_NON_ASCII_LINE_BREAKS","PATTERN_FLOW_INDICATORS","PATTERN_TAG_HANDLE","PATTERN_TAG_URI","_class","is_EOL","is_WHITE_SPACE","is_WS_OR_EOL","is_FLOW_INDICATOR","fromHexCode","lc","escapedHexLen","fromDecimalCode","simpleEscapeSequence","charFromCodepoint","simpleEscapeCheck","simpleEscapeMap","State$1","filename","onWarning","legacy","listener","implicitTypes","typeMap","lineIndent","firstTabInLine","documents","generateError","maxLength","indent","linesBefore","linesAfter","lineStarts","lineEnds","foundLineNo","lineNoLength","throwError","throwWarning","directiveHandlers","YAML","major","minor","checkLineBreaks","TAG","handle","tagMap","decodeURIComponent","err","captureSegment","checkJson","_position","_length","_character","_result","mergeMappings","destination","overridableKeys","quantity","storeMappingPair","keyTag","keyNode","valueNode","startLine","startLineStart","startPos","writable","readLineBreak","skipSeparationSpace","allowComments","checkIndent","lineBreaks","testDocumentSeparator","writeFoldedLines","readBlockSequence","nodeIndent","_line","_tag","_anchor","detected","anchorMap","composeNode","readTagProperty","tagHandle","isVerbatim","isNamed","readAnchorProperty","parentIndent","nodeContext","allowToSeek","allowCompact","allowBlockStyles","allowBlockScalars","allowBlockCollections","typeIndex","typeQuantity","typeList","flowIndent","blockIndent","indentStatus","atNewLine","following","_keyLine","_keyLineStart","_keyPos","atExplicitKey","readBlockMapping","_lineStart","_pos","terminator","isPair","isExplicitPair","isMapping","readNext","readFlowCollection","captureStart","folding","tmp","chomping","didReadContent","detectedIndent","textIndent","emptyLines","atMoreIndented","readBlockScalar","captureEnd","readSingleQuotedScalar","hexResult","readDoubleQuotedScalar","readAlias","withinFlowCollection","hasPendingContent","_lineIndent","_kind","readPlainScalar","readDocument","directiveArgs","documentStart","hasDirectives","loadDocuments","nullpos","loader","loadAll","load","_toString","_hasOwnProperty","CHAR_BOM","ESCAPE_SEQUENCES","DEPRECATED_BOOLEANS_SYNTAX","DEPRECATED_BASE60_SYNTAX","encodeHex","character","State","noArrayIndent","skipInvalid","flowLevel","styleMap","compileStyleMap","sortKeys","lineWidth","noRefs","noCompatMode","condenseFlow","quotingType","forceQuotes","replacer","explicitTypes","duplicates","usedDuplicates","indentString","ind","generateNextLine","isWhitespace","isPrintable","isNsCharOrWhitespace","isPlainSafe","inblock","cIsNsCharOrWhitespace","cIsNsChar","codePointAt","needIndentIndicator","writeScalar","iskey","dump","singleLineOnly","indentPerLevel","testAmbiguousType","char","prevChar","hasLineBreak","hasFoldableLine","shouldTrackWidth","previousLineBreak","plain","isPlainSafeFirst","isPlainSafeLast","chooseScalarStyle","testImplicitResolving","blockHeader","dropEndingNewline","moreIndented","nextLF","lineRe","foldLine","prevMoreIndented","foldString","escapeSeq","escapeString","indentIndicator","clip","breakRe","curr","writeBlockSequence","writeNode","detectType","block","isblockseq","tagStr","duplicateIndex","duplicate","objectOrArray","objectKey","objectValue","explicitPair","pairBuffer","objectKeyList","writeBlockMapping","writeFlowMapping","writeFlowSequence","encodeURI","getDuplicateReferences","objects","duplicatesIndexes","inspectNode","renamed","Type","Schema","FAILSAFE_SCHEMA","JSON_SCHEMA","CORE_SCHEMA","DEFAULT_SCHEMA","YAMLException","float","null","int","safeLoad","safeLoadAll","safeDump","jsyaml","readYamlFile","response","fetch","fetchYAML","ensureSVGCache","msd","svg_templates","loadSVGToCache","status","statusText","svgText","getSVGFromCache","CBLCARSCardEditor","_formControls","_cardType","cardType","_initializationPromise","_initialize","unsafeCSS","mergeUserStyles","formContent","loadFont","fontInput","_loadedFonts","fontList","fontName","href","rel","fontKey","decorate","_$El","_$Eg","splice","_$EC","_$Ek","_$Cp","tt","et","nt","rt","descriptor","finisher","placement","originalKey","initializer","at","ot","lt","HTMLSlotElement","assignedElements","ht","startPress","endPress","startFocus","endFocus","startHover","endHover","ft","mt","gt","ut","vt","yt","wt","$t","ArrayBuffer","flags","valueOf","At","navigator","maxTouchPoints","msMaxTouchPoints","xt","holdTime","held","isRepeating","repeatCount","primary","stopAnimation","repeatTimeout","clearInterval","bind","actionHandler","handleEnter","cancelBubble","returnValue","hasHold","startAnimation","setInterval","repeatLimit","hasDoubleClick","dblClickTimeout","keyCode","currentTarget","unbounded","define","St","kt","Et","Ot","Tt","Ct","Mt","jt","Ht","Dt","Rt","Nt","Pt","zt","Lt","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","goldenrod","gold","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavenderblush","lavender","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","Ft","Vt","Ut","Bt","CSS_UNIT","hsv","hsva","hex3","hex6","hex4","hex8","Wt","qt","originalInput","It","roundA","gradientType","isValid","isDark","getBrightness","isLight","toRgb","getAlpha","setAlpha","isMonochrome","toHsl","toHsv","toHsvString","toHslString","toHex","toHexString","toHex8","toHex8String","toHexShortString","toRgbString","toPercentageRgb","toPercentageRgbString","toName","clone","lighten","brighten","darken","tint","mix","shade","desaturate","saturate","greyscale","spin","analogous","complement","monochromatic","splitcomplement","onBackground","triad","polyad","tetrad","equals","Zt","Gt","Yt","Kt","Jt","Xt","Qt","local","server","DMY","MDY","YMD","monday","tuesday","wednesday","thursday","friday","saturday","sunday","display_precision","log10","$e","Ae","Ee","ms","Te","Ce","Me","lastThis","lastArgs","lastResult","je","timeZone","time_zone","He","Re","Ne","date_format","formatToParts","Pe","ze","Le","Ie","Fe","Ve","Ue","Be","We","qe","Ze","Ge","Ye","Ke","Je","Xe","Qe","supported_features","ii","ni","Oe","units","numeric_precision","show_units","in_progress","ei","latest_version","skipped_version","translation_key","platform","ri","si","ai","oi","li","ci","hi","ui","di","fi","propertyIsEnumerable","mi","gi","_keys","_values","_i","__proto__","bi","yi","wi","$i","Ai","isStrict","realm","global","ignoreCase","unicode","Blob","Buffer","isBuffer","allocUnsafe","copy","WeakSet","strict","xi","ki","Ei","Si","Oi","cardHelpers","Ti","loadCardHelpers","Ci","_cards","_cardsConfig","_entities","_initialSetupComplete","_rippleHandlers","_ripple","_doIHaveEverything","_finishSetup","_clearInterval","_startTimerCountdown","_evaluateVariablesSkipError","_evaledVariables","variables","_objectEvalTemplate","_getTemplateOrValue","_stateObj","triggers_update","_expandTriggerGroups","_hasTemplate","_startInterval","_createCard","createCardElement","_cardHtml","origConfig","_interval","_calculateRemaining","_timeRemaining","_computeTimeDisplay","_getMatchingConfigState","_localize","localize","entities","_relativeTime","_getTemplateHelpers","formatDateTime","formatShortDateTimeWithYear","formatShortDateTime","formatDateTimeWithSeconds","formatDateTimeNumeric","relativeTime","formatTime","formatTimeWithSeconds","formatTimeWeekday","formatTime24h","formatDateWeekdayDay","formatDate","formatDateNumeric","formatDateShort","formatDateMonthYear","formatDateMonth","formatDateYear","formatDateWeekday","formatDateWeekdayShort","_evalTemplate","_getColorForLightEntity","rgb_color","color_temp","min_mireds","max_mireds","brightness","_buildCssColorAttribute","color_type","_buildIcon","show_icon","_buildEntityPicture","show_entity_picture","entity_picture","_buildStyleGeneric","_buildCustomStyleGeneric","custom_fields","_buildName","show_name","friendly_name","_buildStateString","show_state","_buildLastChanged","show_last_changed","_buildLabel","show_label","_buildCustomFields","do_not_eval","_unsafeHTMLorNot","_stopPropagation","_hasChildCards","_isClickable","_rotate","_blankCardColoredHtml","background","tooltip","aspect_ratio","extra_styles","_handleAction","handleRippleFocus","handleRippleBlur","handleRippleActivate","handleRippleDeactivate","repeat_limit","_buttonContent","_getLock","_handleUnlockType","unlock","state_display","_gridHtml","_getIconHtml","_buildLiveStream","show_live_stream","_configFromLLTemplates","template","cblcars_card_templates","group_expand","card_size","_loopGroup","_evalActions","_handleLock","username","createAttribute","setNamedItem","findSvgAnchors","svgContent","circleRegex","cxMatch","cyMatch","textRegex","xMatch","yMatch","groupRegex","getSvgContent","base_svg","svgKey","pop","getSvgViewBox","getSvgAspectRatio","stripMetaFields","cleaned","globalPerfTracker","counters","timings","sessionStart","addTiming","totalMs","timing","addCount","rate","counter","timeAsync","timeSync","getAll","sessionDuration","session","duration_ms","started_at","fromEntries","summary","getSummary","health","exportToCsv","minify","minifyData","minified","perfTime","perfTimeAsync","perfCount","debugNamespace","userConfig","layers","builtinPacks","use_packs","builtin","packName","pack","loadBuiltinPack","priority","external","externalResults","urls","retries","retryDelay","enableCaching","perfTracker","total_packs","successful","failed","retried","cached_hits","total_time_ms","packResult","loadSingleExternalPack","retryCount","_lastExternalPackPerf","loadExternalPacks","loadAllLayers","palettes","profiles","rules","data_sources","active_profiles","__provenance","merge_order","layer","processLayer","removals","collections","collection","removeIds","removeId","findIndex","removed","removal_source","applyRemovals","checksum","stable","crypto","subtle","TextEncoder","encode","hashBuffer","digest","hashArray","hashHex","hash","simpleHash","computeCanonicalChecksum","processSinglePass","config_overlays","config_rules","config_anchors","dbgPacks","packs","dbgSource","svg_bridge","svg_warp","_extracted_anchors","accent1","accent2","danger","externalPackCache","loadTime","lastError","attempt","attemptStart","race","fetchWithValidation","createTimeoutPromise","contentType","errorType","URL","headers","dataFields","field","validateExternalPackStructure","__msdPerf","export","existingIndex","cloned","structuredClone","origin_pack","overridden","override_layer","paletteName","tokens","tokenName","tokenExisted","current_value","previous_value","override_pack","override_history","last_modified_by","tokenCount","coordinates","existed","previousCoordinates","originType","determineAnchorOriginType","existingProvenance","origin_type","override_source","override_type","previous_coordinates","mergePacks","exportCollapsed","userMsd","_hudUserMsdConfig","validateCoordinateArray","issues","coord","errors","pathCache","renderSparkline","dataResult","_getHistoricalDataForSparkline","sparklineStyle","_resolveSparklineStyles","_renderEnhancedSparkline","_renderEnhancedStatusIndicator","_renderFallbackSparkline","getHistoricalDataForSparkline","lineCap","line_cap","lineJoin","line_join","miterLimit","miter_limit","dash_array","dashOffset","dash_offset","smoothingMode","interpolation","path_precision","pathPrecision","fillOpacity","fill_opacity","fillGradient","_parseGradientConfig","fill_gradient","_parsePatternConfig","show_points","showPoints","point_size","pointSize","point_color","pointColor","show_last_value","showLastValue","valueFormat","_parseThresholds","zero_line","zeroLine","zero_line_color","zeroLineColor","min_value","max_value","auto_scale","_parseGlowConfig","_parseShadowConfig","_parseBlurConfig","bracket_width","bracket_gap","bracketGap","bracket_corner_radius","bracketCornerRadius","bracket_style_mode","bracketStyleMode","scan_line","scanLine","grid_lines","gridLines","grid_color","gridColor","grid_opacity","gridOpacity","grid_stroke_width","gridStrokeWidth","grid_horizontal_count","gridHorizontalCount","grid_vertical_count","gridVerticalCount","tracer_speed","tracerSpeed","decimation","max_points","_buildSparklineBackground","_buildGridLines","_buildThresholdLines","_buildZeroLine","_buildAreaFill","_buildMainSparklinePath","_buildDataPoints","_buildValueLabel","_buildScanLine","valueRange","thresholdLines","dash","zeroY","processedData","_processDataForRendering","areaPath","_createSparklinePath","fillColor","pathAttributes","_calculateDataPointPositions","lastValue","_formatValue","styleMode","leftBracketPath","rightBracketPath","_buildRoundedBracketPath","_buildLcarsBracketPath","_buildSquareBracketPath","gapOrWidth","gapOrHeight","heightOrRadius","radiusOrHeight","radius","minRadius","cutSize","_createChaikinPath","_createConstrainedSmoothPath","_createBezierPath","_createSplinePath","_createSteppedPath","_createLinearPath","pathSegments","targetWidth","smoothedPoints","iteration","newPoints","p2","minX","maxX","currentWidth","cp1x","cp1y","lastPoint","splinePoints","p3","segments","u2","u3","f1","f2","f3","f4","cp2x","cp2y","next2","prevSlope","nextSlope","indicatorColor","indicatorText","isLoading","animationProps","bufferSize","historyReady","started","historyLoaded","stats","hasTransformations","hasAggregations","requestedDataKey","getEnhancedDataSourceData","bufferData","historicalData","availableSources","requestedSource","updateSparklineData","sparklineElement","hasBuffer","currentStatus","elementFound","currentValue","_updateSparklineElementSynchronized","_upgradeStatusIndicatorToSparkline","_extractHistoricalData","_updateSparklinePathAndMarkers","_updateSparklineFeatures","pathElement","newPathData","dataPointsGroup","pointElements","pointElement","areaElement","valueLabelElement","thresholdGroup","thresholdLine","children","zeroLineElement","pathSmoothing","dataVisualization","styling","lcarsFeatures","enhancedValue","aggregationData","slope","availableTransformations","availableAggregations","generateSyntheticHistoricalData","extractHistoricalFromObject","syntheticValue","ratio","synthetic","basedOnRawData","variance","aggregationObject","debugSparklineUpdates","getStats","debugDataSource","SparklineRenderer","LineOverlayRenderer","routerCore","markerCache","textAttachmentPoints","setTextAttachmentPoints","anchor1","anchor2","attach_to","attachMeta","_computeTextAttachPoint","routeRequest","buildRouteRequest","pathResult","computePath","lineStyle","_resolveLineStyles","_buildMainPath","_buildMarkers","_renderFallbackLine","markerStart","_parseMarkerConfig","marker_start","markerMid","marker_mid","markerEnd","marker_end","flowSpeed","flow_speed","segment_colors","_parseSegmentColors","markerConfig","segmentConfig","segment","markerType","_createMarkerDefinition","_getLinearGradientCoords","markerId","_getMarkerSize","groupAttributes","updateLineStyle","markers","segmentColors","dashPatterns","origin","sidePref","attach_side","attachSide","gapRaw","attach_gap","attachment_gap","line_gap","basePoint","outward","attachPoint","_attachComputed","targetOverlay","sideChosen","AdvancedRenderer","mountEl","overlayElements","lastRenderArgs","lineRenderer","overlayElementCache","_lineDeps","resolvedModel","hasResolvedModel","overlayCount","anchorCount","hasViewBox","mountElExists","stackTrace","svgMarkup","overlayTypes","mountElTagName","mountElChildren","overlayGroup","_ensureOverlayGroup","tov","earlyTypes","svgMarkupAccum","processedCount","renderOverlay","_cacheElementsFrom","_dynamicAnchors","_buildDynamicOverlayAnchors","insertAdjacentHTML","attachTo","sparklines","_scheduleDeferredLineRefresh","_scheduleFontStabilization","dest","tap","basePt","_resolveOverlayAttachmentPoint","gapPt","_applyAttachGap","srcAnchor","_updateDynamicAnchorsForOverlays","changedIds","dep","attachGap","gapX","attach_gap_x","attachGapX","gapY","attach_gap_y","attachGapY","anchorsRef","pass","changedTargets","anyUnstable","recordedW","recordedH","diffW","diffH","newGroup","_reRenderSingleTextOverlay","bb2","_updateStatusIndicatorPosition","_updateTextAttachmentPointsFromDom","_rerenderDependentLines","morePassesAllowed","passes","changed","fontAPI","fonts","ready","lineOverlays","existingEl","newMarkup","newEl","finalStyleColor","finalStyleStatusIndicator","injectSvgContent","texts","updateOverlayData","hasSourceData","sourceDataKeys","hasCachedElement","overlayElement","updateTextOverlay","updateStatusGridWithTemplates","handleDataSourceUpdate","updateData","sourceId","destroy","changedSet","toRerender","oldGroup","markup","textBBox","circle","textElement","rulesEngine","newContent","updateTextDecorations","updateStatusGrid","updatedCells","gridElement","renderer","cellContentElement","oldContent","_hasTemplateContentEnhanced","_initializeEnhancedTemplateDetection","overlayUpdater","_hasTemplateContent","MsdDebugRenderer","debugLayer","anchorMarkers","boundingBoxes","routingOverlays","performanceOverlays","debugManager","unsubscribeDebug","_lastRenderContext","onChange","_scheduleRerender","setScale","opts","debugState","getSnapshot","svgElement","integrateWithAdvancedRenderer","renderAnchorMarkers","bounding_boxes","renderOverlayBounds","canRenderRouting","renderRoutingGuides","renderPerformanceOverlays","routeCount","routeInfo","routeOverlay","createRoutingOverlay","ownerDocument","waypoint","startPt","markerCount","createAnchorMarker","crosshairSize","circleRadius","crosshair","bboxObj","bboxCount","dimensions","_getOverlayDimensions","createBoundingBox","perf","getPerf","perfEntries","timers","displayValue","perfGroup","baseX","baseY","bg","entryText","entry","ensureDebugLayer","toggle","toggleFeature","feature","getDebugState","hasDebugLayer","boundingBoxCount","routingOverlayCount","performanceOverlayCount","renderedOverlay","textHeight","textWidth","textFontSize","adjustedY","actualBaseline","adjustedX","actualTextAnchor","_calculateTextOverlayDimensions","_calculateLineOverlayDimensions","_calculateImageOverlayDimensions","_calculateRectOverlayDimensions","attachmentData","renderedElement","bboxError","charWidth","endpoints","end_points","startX","startY","endX","endY","minY","MsdControlsRenderer","controlElements","_isRendering","_lastSignature","_msdControlsRenderer","setHass","hasHass","entityCount","hasLightDesk","lightDeskState","previousHass","controlElementsCount","_updateAllControlsHass","wrapperElement","cardElement","_applyHassToCard","controlId","isCustomButtonCard","hasConfig","hasSetConfig","currentHass","hasSetHass","isCBLCARSCard","isStandardHACard","oldHass","newStateObj","oldState","newState","stateChanged","renderControls","controlOverlays","signature","ids","getSvgControlsContainer","renderControlOverlay","overlayError","existingForeignObject","controlElement","createControlElement","positionControlElement","resolveCardDefinition","card_config","cardConfig","_card","extension","_rawOverlayIndex","_msdRawOverlays","rawEntry","_normalizeCardType","cardDef","normalizedCardType","originalType","normalizedType","_createHomeAssistantCard","_createCustomCard","_createFallbackCard","_applyHassContext","_configureCard","wrapper","className","msdControlId","_setupEventIsolation","customCards","_waitForElementUpgrade","CardClass","tempParent","maxWait","upgrade","waitTime","_buildCardConfig","_applyCardConfig","_isCustomButtonCard","currentConfig","finalConfig","otherProps","isBuiltInCard","_msdGenerated","strategies","success","triggersUpdate","maxRetries","_pendingConfig","retryInterval","border","flexDirection","justifyContent","alignItems","subtitle","eventType","contains","resolveSize","foreignObject","createSvgForeignObject","configureControlForSvg","targetContainer","overflow","boxSizing","z_index","controlsGroup","overlayContainer","cleanup","svgControlsContainer","legacyContainer","PerformancePanel","previousSnapshot","setThreshold","avgMs","resetTimer","clearAllTimers","exportData","perfData","table","blob","createObjectURL","download","click","revokeObjectURL","captureData","alerts","regressions","getDebugStatusSilent","timerData","severity","previous","regression","previousAvg","currentAvg","renderHtml","severityColor","timerEntries","hasThreshold","avgColor","counterEntries","alertCount","regressionCount","ValidationPanel","warnings","debugStatus","validationData","validation","getValidationIssues","warning","totalIssues","DataSourcePanel","entityChangeHistory","maxHistoryLength","_setupGlobalHelpers","__msdInspectDataEntity","getEntity","groupEnd","_showEntityPopup","__msdInspectDataSubscription","subscribers","getSourceSubscribers","_showSubscriptionPopup","__msdRefreshDataSources","refreshSubscriptions","hud","popup","last_updated","truncatedValue","received","cacheHits","hitRate","subscriber","combinedData","_createEntityPopup","extras","subscriberName","transformName","calculations","calc","calcName","_showSubscriptionInspectionPopup","_currentData","subscriptions","_createSubscriptionPopup","clearHistory","recentChanges","entityIds","listIds","dsStats","healthCheck","getHealth","subscribed","sum","uptime","connectionCount","previousState","oldestKey","lastChanged","lastUpdated","domain","entityData","uptimeHours","shortName","hasErrors","change","shortId","timeAgo","entities_entries","byDomain","domainEntities","stateValue","shortState","RoutingPanel","minCost","maxCost","cacheHit","showArcs","inputStates","minCostFocused","maxCostFocused","__msdAnalyzeRoute","routeId","analysis","Strategy","Cost","Segments","Bends","Index","hint","_showRouteAnalysisPopup","sourceFirst","sourceLast","isLong","displayPath","compute_time_ms","cache_time_ms","additionalMeta","setFilter","updateCostFilter","finalizeCostFilter","setInputFocus","focused","highlightRoute","mountElement","routeElements","overlayGroups","originalFilter","outline","originalOutline","safeId","outlineOffset","showRouteHighlightFeedback","emit","analyzeRoute","showRouteAnalysisFeedback","feedback","routes","routingStats","getPerformanceMetrics","pipeline","startAnchor","endAnchor","computeTime","filterRoutes","route","routingData","selected","allRoutes","filteredRoutes","costColor","shouldSkipRefresh","ChannelTrendPanel","conflictThreshold","lastSnapshot","_occupancy","conflicts","trends","recommendations","channelId","channelHistory","recent","trend","average","calculateVariance","highVarianceChannels","unusedChannels","mean","sparkline","chars","channelData","conflict","rec","typeColor","sortedTrends","trendIndicator","trendColor","currentCount","totalUsage","historySize","FlagsPanel","debugFeatures","currentlyEnabled","reRender","adjustScale","currentScale","clampedScale","numScale","refreshDebug","_debugFlags","flagsData","isEnabled","displayName","scaleValue","isActive","enabledCount","IssuesPanel","issueCategories","handleIssueClick","bus","clickAction","issuesData","allIssues","categoryIssues","errorCount","warningCount","categoryKey","category","issue","PacksPanel","provenance","packsData","allEntries","chainStr","layer_id","badges","__meta","badgeHtml","RulesPanel","trace","engineTrace","getTrace","rulesList","_rules","rule","traceInfo","lastMatch","matched","matchCount","_matchCount","conditions","when","actions","totalRules","matchedRules","totalMatches","avgPriority","rulesData","sortedRules","matchStatus","matchColor","ExportPanel","exportCollapsedJson","downloadJson","updateTextarea","exportFull","includeMeta","exportFullSnapshotJson","include_meta","diffItem","clearTextarea","copyToClipboard","textarea","clipboard","writeText","showFeedback","setSelectionRange","jsonString","available","hasExportMethods","hasDiffMethod","globalHandlers","__msdExportPanel","HudEventBus","_listeners","on","off","payload","any","SelectionManager","ts","OverlaysPanel","byType","profileCount","_profiles","patchCount","_patches","styleSourceCount","_styleSources","fromPacks","highlightOverlay","mount","_ensureHighlightStyles","_findOverlayModel","isControlsType","roots","selectorExact","escape","selectorId","controlsSelectors","exactMatches","byIdMatch","_toast","node","_applyControlsHighlight","_applyElementHighlight","_msdCtrlHl","_msdPrevBoxShadow","boxShadow","_msdPrevZIndex","_msdPrevOutline","_msdPrevFilter","pulseStyle","isChild","_msdHl","_msdPrevStroke","_msdPrevStrokeW","_msdHlBox","analyzeOverlay","patches","styleSources","_showOverlayPopup","baseFontSize","manager","sectionFontSize","metricFontSize","controlsFontSize","stylePreview","ruleId","sourcesDetail","finalStyleProps","propertyMappings","sourceLabel","_highlightBoundingBoxFromModel","attachId","anchorEl","attachEl","_spawnBoundingBox","rects","maxR","maxB","box","overlayBoxFor","smallFontSize","badge","MsdHudManager","__msdHudBus","evt","panels","channelTrend","dataSources","activePanel","refreshRate","lastRefresh","panelVisibility","panelOrder","compactMode","autoPosition","panelManagerOpen","hudWidth","resizable","hudScale","hudElement","refreshInterval","dragState","isDragging","startLeft","startTop","_setupGlobalPanelControls","keyboardEnabled","_setupKeyboardShortcuts","_registerBusHandlers","selection","_registerSelectionHandlers","show","hide","setRefreshRate","__msdHudPanelControls","togglePanel","panelName","updateHudContent","setCompactMode","setAutoPosition","_autoPositionHud","resetPanelLayout","panel","movePanel","currentOrder","currentIndex","togglePanelManager","_attachPanelManagerEventListeners","closePanelManager","adjustFontSize","_fontSizeThrottle","newSize","_applyFontAndScale","setFontSize","adjustHudScale","_scaleThrottle","setHudScale","setFontFamily","family","validFamilies","normalizedFamily","normalized","scaledWidth","scaledHeight","currentLeft","currentTop","maxLeft","maxTop","viewportWidth","viewportHeight","visiblePanelCount","estimatedHeight","haHeader","haSidebar","headerHeight","sidebarWidth","_setupResizeHandler","_resizeSetup","resizeTimeout","_setupDebugStatusHelper","_state","focus","dir","inspectEntity","adjustWidth","_applySelectionHighlight","_updateSelectionBadge","togglePanelCollapse","collapsedPanels","_applyCollapseState","toggleFocusPanel","focusPanel","collapsed","h3","filterTerm","term","_updateFocusBadgeInFooter","_decoratePanelHeaders","enhanced","indicator","altKey","footerFocus","setFilterTerm","createHudElement","setupDragging","_attachDelegatedEvents","_delegatedEventsAttached","domEvent","busEvent","rest","wasManagerOpen","renderHudHtml","titleFontSize","compactTitleFontSize","tinyFontSize","_renderPanelControls","renderedPanelCount","hiddenClass","panelData","panelHtml","refreshAge","startRefresh","stopRefresh","numRate","handleDrag","newLeft","newTop","endDrag","compactBtn","onclick","resetBtn","closeBtn","btn","newWidth","_keyboardSetup","ctrlKey","metaKey","shiftKey","RollingBuffer","capacity","_timestamps","_size","_full","_stats","pushes","overwrites","queries","_lastPushTime","_coalescingThresholdMs","lastTimestamp","getArrays","bufferIndex","sliceSince","msWindow","cutoffTime","startIndex","firstIndex","utilization","overwriteRate","isFull","_validateConsistency","TransformationProcessor","totalTime","_doTransform","_getFallbackValue","avgTime","resetStats","UnitConversionProcessor","conversions","kw","kb","mb","fromUnit","toUnit","customFunction","conversionKeys","conversionKey","ScaleProcessor","inputRange","input_range","outputRange","output_range","inMin","inMax","outMin","outMax","SmoothingProcessor","method","alpha","windowSize","window_size","_lastSmoothed","_window","_exponentialSmooth","_movingAverage","_medianFilter","sorted","mid","ExpressionProcessor","_compiledFunction","AggregationProcessor","windowMs","_parseTimeWindow","maxAge","_lastUpdate","updates","resets","transformedData","_cleanOldValues","_calculate","getValue","valueCount","currentResult","currentTimestamp","originalLength","cleanedValues","MovingAverageAggregation","maxSamples","max_samples","MinMaxAggregation","trackMin","trackMax","trackAvg","RateOfChangeAggregation","timeDiff","SessionStatsAggregation","_firstValue","_sessionStart","timestamps","dataSpan","RecentTrendAggregation","strength","recentValues","sumX","sumY","sumXY","sumXX","isNode","MsdDataSource","cfg","wsSec","windowSeconds","_parseTimeWindowMs","minEmitMs","sampleMs","coalesceMs","maxDelayMs","emitOnSameValue","haUnsubscribe","_transformationData","_aggregationData","_lastEmitTime","_lastEmittedValue","_pendingRaf","_pending","_pendingFirstTs","_pendingCount","emits","coalesced","skipsSameValue","invalid","_started","_destroyed","_initializeProcessors","processor","createTransformationProcessor","createAggregationProcessor","_preloadHistory","historyConfig","endTime","_preloadWithHistoryService","_preloadWithStatistics","statError","_preloadStateHistory","entity_ids","start_time","end_time","statistic_ids","statistics","stat","_extractStatisticValue","currentState","connection","subscribeEvents","event_type","new_state","_handleStateChange","_emitInitialData","emitData","_getTransformationData","_getAggregationData","isInitialEmission","statisticsData","sendMessagePromise","_preloadStateHistoryWS","historyData","minimal_response","no_attributes","_preloadHistoryREST","auth","accessToken","eventData","hasEventData","hasNewState","newStateValue","subscriberCount","_lastOriginalState","originalState","_applyTransformations","_updateAggregations","_shouldEmit","_emit","_subscribeLive","_onRawEventValue","_ensureScheduleEmit","_frameEmitCheck","timeSinceLastEmit","timeSincePendingStart","shouldEmit","untilMinEmit","untilCoalesce","untilMaxDelay","nextCheck","subscribe","subscribeWithMetadata","_subscriberMetadata","overlayType","component","subscribedAt","lowerRaw","converted","windowStr","destroyed","getSubscriberInfo","isWrapped","DataSourceManager","overlaySubscriptions","entityIndex","globalEntityChangeListeners","sourcesCreated","subscriptionsActive","dataUpdates","initializeFromConfig","dataSourceConfigs","promises","createDataSource","all","_waitForHistoryPreloading","_notifyGlobalEntityChangeListeners","hassState","old_state","maxWaitMs","allReady","totalSources","readySources","data_path","source_type","raw_value","aggregation_data","_resolveDataPath","addEntityChangeListener","changedEntityIds","subscribeOverlay","unsubscribe","enhancedData","hasHistoricalData","historicalDataLength","immediateData","unsubscribeOverlay","getAllSources","getDataSource","_dataSources","sourceStats","activeSubscriptions","getAllSubscribers","stopPromises","debugDump","perfInc","t0","done","perfSet","RouterCore","routingConfig","_cache","_cacheOrder","_maxCache","_rev","_overlaysRef","_obstacles","_obsVersion","_gridCache","_channels","_normalizeChannels","_channelForcePenalty","channel_force_penalty","_channelAvoidMultiplier","channel_avoid_multiplier","_channelTargetCoverage","channel_target_coverage","_channelShapingMaxAttempts","channel_shaping_max_attempts","_channelShapingSpan","channel_shaping_span","_channelMinCoverageGain","channel_min_coverage_gain","setOverlays","obs","obstacle","ax","ay","rev","obstacles","obsVersion","fs","channelMode","routeChannelMode","channel_mode","corner_smoothing_mode","modeHint","modeHintLast","route_mode_last","hintSourceFirst","hintSourceLast","isDestinationOverlay","smoothingIterations","corner_smoothing_iterations","smoothingMaxPoints","smoothing_max_points","_hintSourceFirst","_hintSourceLast","avoidIds","routeChannels","cornerStyle","smart_proximity","detourSpan","smart_detour_span","maxExtraBends","smart_max_extra_bends","minImprovement","smart_min_improvement","maxDetoursPerElbow","smart_max_detours_per_elbow","_cacheKey","avoidKey","chanKey","gridBase","_refineSmart","_computeManhattan","arcApplied","_applyCornerRounding","smoothApplied","_applySmoothing","oldest","vb","baseRes","grid_resolution","cols","gridKey","occ","_buildOccupancy","w2c","h2c","c2x","c2y","goal","MinHeap","gScore","came","blocked","isEmpty","cur","gCur","dc","dr","nc","nk","gNew","pathCells","cc","lastDir","pc","pr","wx","wy","pcPrev","prPrev","tx","ty","bendW","cost_defaults","bend","proxW","penalty","proxPenalty","_segmentProximityPenalty","channelInfo","_channelDelta","shapingMeta","desired","coverage","shapeRes","_shapeForChannels","accepted","totalCost","_costComposite","_polylineToPath","resolution","insidePx","inside","outsidePx","outside","deltaCost","c0","r0","r1","lastMode","_costSimple","dist","bendsWeight","proximityWeight","proximityPenalty","channelDelta","proximityWeightRaw","band","segPenalty","_nearestObstacleBandOverlap","worst","weight","chanSet","chans","segLen","mx","my","inChan","weightAvg","bestPts","bestPenalty","bestCost","detoursAccepted","span","minImprove","min_improvement","elbow","verticalIn","horizontalOut","candidates","tries","newPts","_compactPolyline","cost2","newChan","newProx","baseMeta","desiredCoverage","attemptsMax","minGain","chanIds","coverage0","bestCoverage","attempts","coverageHistory","forceMode","midpoint","inAny","segsOutside","len","outsideSegs","seg","elbowIndices","improved","bestMove","bestMoveDist","mv","routeResult","radiusGlobal","totalTrim","lastOut","pPrev","pNext","vIn","vOut","lenIn","lenOut","pInTrim","pOutTrim","sweep","pEnd","iters","newMeta","addedPoints","_up","_down","computeObjectHash","normalizeForHashing","AnimationRegistry","instanceToHash","usageStats","maxCacheSize","cleanupThreshold","perfStats","cacheMisses","instancesCreated","instancesReused","cleanupRuns","getOrCreateInstance","computeInstanceHash","targetsCompatible","recordCacheHit","reuseInstance","createAnimationInstance","cacheInstance","semantic","normalizeParams","normalizeNumber","override","cachedTargets","newTargets","newOnes","cachedTarget","newTarget","cachedInstance","retarget","createdAt","lastUsed","cleanupCache","usage","toRemove","cacheSize","reuseRate","getCacheContents","contents","exportStats","includeCache","cacheContents","globalAnimationRegistry","__msdAnimRegistry","registry","globalTraceBuffer","maxSize","totalTraces","addTrace","evaluationTime","getRecentTraces","limit","matchesFilter","getRuleHistory","getMatchedRules","timeWindow","cutoff","avgEvalTime","bufferedTraces","recentMatched","recentTotal","matchRate","avgEvaluationTime","minTime","maxTime","minEvalTime","exportTraces","includeConditions","includeMetadata","exported","traces","__msdRuleTrace","getRecent","RulesEngine","rulesById","dependencyIndex","dirtyRules","lastEvaluation","traceBuffer","stopProcessing","evalCounts","dirty","skipped","buildRulesIndex","buildDependencyIndex","markAllDirty","entityToRules","ruleToEntities","extractEntityReferences","rulesDeps","totalEntities","entity_attr","map_range_cond","value_map","markEntitiesDirty","affectedRules","fullRef","ruleSet","evaluateDirty","resolveDataSourceValue","createEmptyResult","totalDirty","processedRules","dirtyRulesArray","evaluateRule","aggregateResults","evaluateConditions","determineMatch","conditionCount","countConditions","entityRefs","overlayPatches","profilesAdd","profiles_add","profilesRemove","profiles_remove","stopAfter","evaluateCondition","dataSourceValue","above","numValue","below","time_between","evaluateTimeBetween","toTimeString","evaluateMapRangeCondition","timeRange","getHours","getMinutes","startHour","startMin","endHour","endMin","mapRangeCondition","entityObj","mappedValue","allMatch","anyMatch","ruleResults","aggregated","patch","overlayPatch","processOverlayRules","shouldStop","stopped","stoppedBy","stopTriggered","affectedOverlay","baseTrace","lastEvaluations","dependencyStats","entitiesTracked","avgRulesPerEntity","traceStats","getRuleTrace","getRecentMatches","exportTrace","clearTrace","setDataSourceManager","getRuleDependencies","getEntityDependents","DebugManager","callbacks","routerReady","pendingRouterActions","pendingInitActions","_notifyTimeout","_pendingNotification","debugConfig","isAnyEnabled","_scheduleNotification","markRouterReady","_setFeature","_executeWhenReady","snapshot","enableMultiple","disableMultiple","getAvailableFeatures","_notifyChange","needsRouter","BaseOverlayUpdater","overlayUpdaters","_registerUpdaters","needsUpdate","_textNeedsUpdate","_updateTextOverlay","hasTemplates","_statusGridNeedsUpdate","_updateStatusGrid","_updateSparkline","_updateGenericOverlay","updateOverlaysForDataSourceChanges","modelBuilder","_overlayReferencesChangedDataSources","updatedDataSourceId","_findDataSourceForEntity","mainContent","hasReference","_contentReferencesChangedDataSources","_updateOverlayWithData","isInitialData","_needsRerender","SystemsManager","debugRenderer","controlsRenderer","hudManager","animRegistry","_renderTimeout","_reRenderCallback","_queuedReRender","_debugControlsRendering","mergedConfig","_originalHass","_currentHass","_previousRuleStates","_internalRenderInProgress","oldValue","initializeSystems","cardModel","_initializeDataSources","_instrumentRulesEngine","entityChangeHandler","_createEntityChangeHandler","_setupGlobalHudInterface","setReRenderCallback","hasEnhancedData","renderTimeout","renderInProgress","_renderInProgress","controlEntities","_extractControlEntities","controlChangedIds","workingHass","getCurrentHass","freshStates","user_id","convertedState","hasWorkingHass","hasDataSourceManager","dataSourceManagerIsNull","entitiesToMarkDirty","finalEntityList","isControlTriggered","hasDataSourceChanges","_lastEntityAnalysis","matchingEntities","_checkIfRulesNeedReRender","_scheduleFullReRender","setOriginalHass","hasStates","hasAuth","hasConnection","setupDirectHassSubscription","getOriginalHass","depIndex","ent","__hudDeps","perfStore","__perfStore","inc","__perfWrapped","configuredDataSources","allDataSources","configured","allDataSourceIds","sourceCount","renderDebugAndControls","anyEnabled","hasOverlays","debugOptions","showAnchors","showBoundingBoxes","showRouting","showPerformance","renderPromise","timeoutPromise","_shouldRenderDebugFromConfig","_getDebugFlags","_shouldRenderDebug","debugFlags","connectors","geometry","ingestHass","updateEntities","listEntities","_directHassSubscription","freshHass","affectedDataSources","mightCrossThresholds","_checkThresholdCrossing","entityInRule","dataSourceId","currentEntity","isAboveThreshold","isBelowThreshold","currentlyMatches","ruleKey","previouslyMatched","_updateTextOverlaysForDataSourceChanges","textOverlays","globalProfileResolver","profileIndex","activeProfiles","styleCache","lastActiveProfiles","profileLoads","styleMerges","invalidations","loadProfiles","profile","setActiveProfiles","newActiveProfiles","invalidateStyleCache","resolveOverlayStyles","resolved","resolvedOverlay","resolveOverlayStyle","buildStyleCacheKey","styleLayers","buildStyleLayers","mergedStyle","mergeStyleLayers","profileId","overlayStyle","getProfileOverlayStyle","precedence","getOverlayStyleHash","getProfile","getActiveProfiles","getAvailableProfiles","isProfileActive","activeProfileCount","getDebugInfo","availableProfiles","hasDefaults","defaultTypes","overlayIds","includeDebug","isPlain","sv","tv","__msdProfile","resolver","ModelBuilder","systems","animationIndex","timelineDefs","runtimeActiveProfiles","_resolvedModelRef","computeResolvedModel","_ensureAnchors","baseOverlays","_assembleBaseOverlays","_subscribeOverlaysToDataSources","ruleResult","_applyRules","_updateActiveProfiles","overlaysWithPatches","_applyOverlayPatches","_resolveValueMaps","activeAnimations","animDiff","tlDiff","_processAnimations","active","titleOverlay","overlaysBase","__styleProvenance","prov","subscriptionCount","pendingSubscriptions","isReady","sourceReady","hasValue","overlayConfig","_overlayUnsubscribers","_monitorPendingSubscriptions","_subscribeTextOverlaysToDataSources","pendingCount","checkCount","checkInterval","stillPending","styleKeys","patchMap","originalStyle","originalFinalStyle","patchedOverlay","newFinalStyle","applyOverlayPatches","resolveValueMaps","resolvedOverlays","entityRuntime","fail","walk","desc","inA","inB","outA","outB","mapped","linearMap","computeValueMap","desiredAnimations","ruleAnimations","ruleOverridesGrouped","ruleAnims","groupRuleAnimOverrides","animation_override","ruleList","def","resolveDesiredAnimations","desiredTimelines","resolveDesiredTimelines","animDef","overlayAnimByKey","animation_hash","unsubscribers","templateRefs","_extractDataSourceReferences","_subscribeTextOverlayToDataSource","references","templatePattern","MsdIntrospection","getOverlaysSvg","__msdResolvedModel","overlaysById","getOverlayBBox","hasWarnings","gbb","backdrop","resolvePointFromConfig","sz","resolveSizeFromConfig","idList","getViewBox","highlightLayer","viewBoxAttr","vw","vh","toDim","buildCardModel","__raw","MsdApi","attach","highlightOverlays","updateOverlay","listAnchors","getAnchor","dumpAnchors","enableDebugFeature","disableDebugFeature","toggleDebugFeature","setDebugScale","getDebugStatus","showOverlays","getPerformanceData","validate","getWindow","setDebugFlag","flag","clearDebugFlags","getDebugManager","stripMeta","__raw_msd","userItems","view_box","exportFullSnapshot","__issues","summarize","seen","initMsdPipeline","userMsdConfig","_originalUserConfig","validateStructure","anchor_id","validateAnchors","overlay_id","item_id","validateOverlays","rule_id","hasAll","hasAny","regex","validateRules","animation_id","validateAnimations","profileIds","profile_id","validateProfiles","palette_name","validatePalettes","validateRouting","seenIds","validateDuplicateIds","t1","_validationMs","existingCodes","anchorSet","aRefs","processAndValidateConfig","disabledPipeline","getAnchors","repairAnchorsFromMerged","_provenance","createDisabledPipeline","hasSystemsManager","dataSourceCount","CustomEvent","queued","renderResult","hasAnchors","renderError","phase","debugControlsError","renderTime","sourcesCount","initialRenderResult","pipelineApi","createPipelineApi","dbg","routingInspect","pathsComputed","inspectAs","setupRoutingDebugInterface","dataSourcesDebug","setupDataSourceDebugInterface","testRender","getStatus","bounding","calculatedDimensions","compare","debugDims","textOverlayRenderer","domGetBBox","dataAttributes","renderAdvanced","auto_show","introspection","relayout","help","setupRenderingDebugInterface","getActive","markersEnabled","showMarkers","forceRedraw","setupUtilityDebugInterface","setupDebugInterface","setMountElement","_routerOverlaySync","final","final_summary","chain_summaries","diff","templatesPromise","stubConfigPromise","themeColorsPromise","templates","stubConfig","setThemeColors","alertCondition","clobber","selectedTheme","colorGroup","colorValues","colorName","cssVarName","existingValue","setLevel","presets","svgHelpers","anchorHelpers","loadUserSVG","filePath","yamlContent","loadTemplates","loadStubConfig","loadThemeColors","svgList","basePath","preloadSVGs","cardImports","loadCoreFonts","initializeCustomCard","defineCustomElement","CBLCARSBaseCard","CBLCARSLabelCard","CBLCARSElbowCard","CBLCARSDoubleElbowCard","CBLCARSMultimeterCard","CBLCARSDPADCard","CBLCARSButtonCard","CBLCARSMSDCard","setAlertCondition","CBLCARSAnimationScope","_runningByTarget","_getRoot","_resolveTargets","_cleanupArtifactsForTargetId","baseEl","_cancelAndCleanupTargets","_isResizeObserverEnabled","_resizeObserver","_logLevel","_resizeObserverTarget","_lastWidth","_lastHeight","_resizeObserverTolerance","_debounceWait","_isUsingLovelaceTemplate","_overrideTemplates","resizeObserverTolerance","debounceWait","_debouncedResizeHandler","_debounce","_updateCardSize","callerStack","hasSetConfigFromMSD","fullConfig","mergedTemplates","cblcars_log_level","foundEntities","collectEntities","scan","loadAllFontsFromConfig","isUsingLovelaceTemplate","overriddenTemplates","ll","getLovelace","lovelaceTemplates","checkLovelaceTemplates","taintedCards","resize_observer_target","enable_resize_observer","resize_observer_tolerance","debounce_wait","enableResizeObserver","editorType","defaultConfig","getConfigElement","getStubConfig","getLayoutOptions","grid_rows","grid_columns","_animationScopeId","_animationScope","_timelines","msdVars","timelinesCfg","overlayConfigsById","animationScope","disableResizeObserver","parentWidth","parentHeight","significantChange","_updateResizeObserver","targetElement","resolveTargetElement","toggleResizeObserver","targetMapping","wait","_rebuildTimelines","cblcars_card_type","specialConfig","hasExistingConfig","configType","configEntity","msdAlreadyBooted","_msdV1ComprehensiveBoot","msdConfig","_msdConfig","svgUrl","_blockUpdates","_svgKey","_msdPipeline","_isControlTriggeredUpdate","hasOldValue","lastAnalysis","msdSystem","_mode","_enableResizeObserver","grid_min_rows","grid_min_columns","cardClass","editorClass","description","documentationURL","preview"],"sourceRoot":""}