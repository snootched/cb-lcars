{"version":3,"file":"cb-lcars.js","mappings":"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C,SAAU,CACRwC,GACAK,IAEF5C,SAAU,CACR4B,GACA4B,GACAM,GACAjtD,MAYAotD,GAAoB34E,OAAOQ,UAAUC,eAcrCm4E,GAAgC,sIAChCC,GAAgC,qBAChCC,GAAgC,cAChCC,GAAgC,yBAChCC,GAAgC,mFAGpC,SAASC,GAAOhjE,GAAO,OAAOjW,OAAOQ,UAAUuI,SAASrI,KAAKuV,EAAM,CAEnE,SAASijE,GAAOt3E,GACd,OAAc,KAANA,GAA8B,KAANA,CAClC,CAEA,SAASu3E,GAAev3E,GACtB,OAAc,IAANA,GAA+B,KAANA,CACnC,CAEA,SAASw3E,GAAax3E,GACpB,OAAc,IAANA,GACM,KAANA,GACM,KAANA,GACM,KAANA,CACV,CAEA,SAASy3E,GAAkBz3E,GACzB,OAAa,KAANA,GACM,KAANA,GACM,KAANA,GACM,MAANA,GACM,MAANA,CACT,CAEA,SAAS03E,GAAY13E,GACnB,IAAI23E,EAEJ,OAAK,IAAe33E,GAAOA,GAAK,GACvBA,EAAI,GAMR,KAFL23E,EAAS,GAAJ33E,IAEuB23E,GAAM,IACzBA,EAAK,GAAO,IAGb,CACV,CAEA,SAASC,GAAc53E,GACrB,OAAU,MAANA,EAA4B,EACtB,MAANA,EAA4B,EACtB,KAANA,EAA4B,EACzB,CACT,CAEA,SAAS63E,GAAgB73E,GACvB,OAAK,IAAeA,GAAOA,GAAK,GACvBA,EAAI,IAGL,CACV,CAEA,SAAS83E,GAAqB93E,GAE5B,OAAc,KAANA,EAAqB,KAChB,KAANA,EAAqB,IACf,KAANA,EAAqB,KACf,MAANA,GACM,IAANA,EADqB,KAEf,MAANA,EAAqB,KACf,MAANA,EAAqB,KACf,MAANA,EAAqB,KACf,MAANA,EAAqB,KACf,MAANA,EAAqB,IACf,KAANA,EAAyB,IACnB,KAANA,EAAqB,IACf,KAANA,EAAqB,IACf,KAANA,EAAqB,KACf,KAANA,EAAqB,IACf,KAANA,EAAqB,IACf,KAANA,EAAqB,SACf,KAANA,EAAqB,SAAW,EACzC,CAEA,SAAS+3E,GAAkB/3E,GACzB,OAAIA,GAAK,MACAoc,OAAO47D,a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","sources":["webpack://cb-lcars/webpack/runtime/load script","webpack://cb-lcars/./node_modules/@formatjs/intl-utils/lib/src/diff.js","webpack://cb-lcars/./node_modules/custom-card-helpers/dist/index.m.js","webpack://cb-lcars/./node_modules/ha-editor-formbuilder-yaml/dist/controls.js","webpack://cb-lcars/./node_modules/ha-editor-formbuilder-yaml/dist/index.js","webpack://cb-lcars/./node_modules/ha-editor-formbuilder-yaml/dist/interfaces.js","webpack://cb-lcars/./src/cb-lcars-vars.js","webpack://cb-lcars/./src/msd/tests/arcsRoutingScenarios.js","webpack://cb-lcars/./src/msd/tests/channelsRoutingScenarios.js","webpack://cb-lcars/./src/msd/tests/routingScenarios.js","webpack://cb-lcars/./src/msd/tests/smartRoutingScenarios.js","webpack://cb-lcars/./src/msd/tests/smoothingRoutingScenarios.js","webpack://cb-lcars/./src/utils/cb-lcars-anim-helpers.js","webpack://cb-lcars/./src/utils/cb-lcars-anim-presets.js","webpack://cb-lcars/./src/utils/cb-lcars-logging.js","webpack://cb-lcars/./src/utils/cb-lcars-svg-helpers.js","webpack://cb-lcars/./node_modules/lit-html/lit-html.js","webpack://cb-lcars/./node_modules/lit-html/directive.js","webpack://cb-lcars/./node_modules/lit-html/directives/unsafe-html.js","webpack://cb-lcars/./node_modules/@lit/reactive-element/css-tag.js","webpack://cb-lcars/./node_modules/@lit/reactive-element/reactive-element.js","webpack://cb-lcars/./node_modules/lit-element/lit-element.js","webpack://cb-lcars/./node_modules/lit-html/is-server.js","webpack://cb-lcars/webpack/bootstrap","webpack://cb-lcars/webpack/runtime/define property getters","webpack://cb-lcars/webpack/runtime/ensure chunk","webpack://cb-lcars/webpack/runtime/get javascript chunk filename","webpack://cb-lcars/webpack/runtime/global","webpack://cb-lcars/webpack/runtime/hasOwnProperty shorthand","webpack://cb-lcars/webpack/runtime/make namespace object","webpack://cb-lcars/webpack/runtime/publicPath","webpack://cb-lcars/webpack/runtime/jsonp chunk loading","webpack://cb-lcars/./node_modules/animejs/lib/anime.esm.js","webpack://cb-lcars/./node_modules/js-yaml/dist/js-yaml.mjs","webpack://cb-lcars/./src/utils/cb-lcars-fileutils.js","webpack://cb-lcars/./src/editor/cb-lcars-editor.js","webpack://cb-lcars/./src/utils/cb-lcars-theme.js","webpack://cb-lcars/./src/cblcars-button-card.js","webpack://cb-lcars/./src/utils/cb-lcars-anchor-helpers.js","webpack://cb-lcars/./src/msd/util/checksum.js","webpack://cb-lcars/./src/msd/util/performance.js","webpack://cb-lcars/./src/msd/packs/mergePacks.js","webpack://cb-lcars/./src/msd/validation/validateMerged.js","webpack://cb-lcars/./src/msd/renderer/PositionResolver.js","webpack://cb-lcars/./src/msd/renderer/RendererUtils.js","webpack://cb-lcars/./src/msd/renderer/TextOverlayRenderer.js","webpack://cb-lcars/./src/msd/renderer/SparklineRenderer.js","webpack://cb-lcars/./src/msd/renderer/LineOverlayRenderer.js","webpack://cb-lcars/./src/msd/renderer/AdvancedRenderer.js","webpack://cb-lcars/./src/msd/debug/MsdDebugRenderer.js","webpack://cb-lcars/./src/msd/controls/MsdControlsRenderer.js","webpack://cb-lcars/./src/msd/hud/panels/PerformancePanel.js","webpack://cb-lcars/./src/msd/hud/panels/ValidationPanel.js","webpack://cb-lcars/./src/msd/hud/panels/DataSourcePanel.js","webpack://cb-lcars/./src/msd/hud/panels/RoutingPanel.js","webpack://cb-lcars/./src/msd/hud/panels/ChannelTrendPanel.js","webpack://cb-lcars/./src/msd/hud/panels/FlagsPanel.js","webpack://cb-lcars/./src/msd/hud/panels/IssuesPanel.js","webpack://cb-lcars/./src/msd/hud/panels/PacksPanel.js","webpack://cb-lcars/./src/msd/hud/panels/RulesPanel.js","webpack://cb-lcars/./src/msd/hud/panels/ExportPanel.js","webpack://cb-lcars/./src/msd/hud/hudService.js","webpack://cb-lcars/./src/msd/hud/panels/OverlaysPanel.js","webpack://cb-lcars/./src/msd/hud/MsdHudManager.js","webpack://cb-lcars/./src/msd/data/RollingBuffer.js","webpack://cb-lcars/./src/msd/data/MsdDataSource.js","webpack://cb-lcars/./src/msd/data/DataSourceManager.js","webpack://cb-lcars/./src/msd/perf/PerfCounters.js","webpack://cb-lcars/./src/msd/routing/RouterCore.js","webpack://cb-lcars/./src/msd/util/hashing.js","webpack://cb-lcars/./src/msd/animation/AnimationRegistry.js","webpack://cb-lcars/./src/msd/rules/RuleTraceBuffer.js","webpack://cb-lcars/./src/msd/rules/RulesEngine.js","webpack://cb-lcars/./src/msd/debug/DebugManager.js","webpack://cb-lcars/./src/msd/pipeline/SystemsManager.js","webpack://cb-lcars/./src/msd/profile/ProfileResolver.js","webpack://cb-lcars/./src/msd/util/deepMerge.js","webpack://cb-lcars/./src/msd/pipeline/ModelBuilder.js","webpack://cb-lcars/./src/msd/valueMap/resolveValueMaps.js","webpack://cb-lcars/./src/msd/util/linearMap.js","webpack://cb-lcars/./src/msd/animation/resolveAnimations.js","webpack://cb-lcars/./src/msd/animation/resolveTimelines.js","webpack://cb-lcars/./src/msd/introspection/MsdIntrospection.js","webpack://cb-lcars/./src/msd/model/CardModel.js","webpack://cb-lcars/./src/msd/api/MsdApi.js","webpack://cb-lcars/./src/msd/export/exportCollapsed.js","webpack://cb-lcars/./src/msd/export/exportFullSnapshot.js","webpack://cb-lcars/./src/msd/export/diffItem.js","webpack://cb-lcars/./src/msd/util/stableStringify.js","webpack://cb-lcars/./src/msd/pipeline/PipelineCore.js","webpack://cb-lcars/./src/msd/pipeline/ConfigProcessor.js","webpack://cb-lcars/./src/msd/debug/DebugInterface.js","webpack://cb-lcars/./src/cb-lcars.js","webpack://cb-lcars/./src/msd/index.js","webpack://cb-lcars/./src/utils/cb-helpers.js"],"sourcesContent":["var inProgress = {};\nvar dataWebpackPrefix = \"cb-lcars:\";\n// loadScript function to load a script via script tag\n__webpack_require__.l = (url, done, key, chunkId) => {\n\tif(inProgress[url]) { inProgress[url].push(done); return; }\n\tvar script, needAttach;\n\tif(key !== undefined) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tfor(var i = 0; i < scripts.length; i++) {\n\t\t\tvar s = scripts[i];\n\t\t\tif(s.getAttribute(\"src\") == url || s.getAttribute(\"data-webpack\") == dataWebpackPrefix + key) { script = s; break; }\n\t\t}\n\t}\n\tif(!script) {\n\t\tneedAttach = true;\n\t\tscript = document.createElement('script');\n\n\t\tscript.charset = 'utf-8';\n\t\tscript.timeout = 120;\n\t\tif (__webpack_require__.nc) {\n\t\t\tscript.setAttribute(\"nonce\", __webpack_require__.nc);\n\t\t}\n\t\tscript.setAttribute(\"data-webpack\", dataWebpackPrefix + key);\n\n\t\tscript.src = url;\n\t}\n\tinProgress[url] = [done];\n\tvar onScriptComplete = (prev, event) => {\n\t\t// avoid mem leaks in IE.\n\t\tscript.onerror = script.onload = null;\n\t\tclearTimeout(timeout);\n\t\tvar doneFns = inProgress[url];\n\t\tdelete inProgress[url];\n\t\tscript.parentNode && script.parentNode.removeChild(script);\n\t\tdoneFns && doneFns.forEach((fn) => (fn(event)));\n\t\tif(prev) return prev(event);\n\t}\n\tvar timeout = setTimeout(onScriptComplete.bind(null, undefined, { type: 'timeout', target: script }), 120000);\n\tscript.onerror = onScriptComplete.bind(null, script.onerror);\n\tscript.onload = onScriptComplete.bind(null, script.onload);\n\tneedAttach && document.head.appendChild(script);\n};","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar MS_PER_SECOND = 1e3;\nvar SECS_PER_MIN = 60;\nvar SECS_PER_HOUR = SECS_PER_MIN * 60;\nvar SECS_PER_DAY = SECS_PER_HOUR * 24;\nvar SECS_PER_WEEK = SECS_PER_DAY * 7;\nexport function selectUnit(from, to, thresholds) {\n    if (to === void 0) { to = Date.now(); }\n    if (thresholds === void 0) { thresholds = {}; }\n    var resolvedThresholds = __assign(__assign({}, DEFAULT_THRESHOLDS), (thresholds || {}));\n    var secs = (+from - +to) / MS_PER_SECOND;\n    if (Math.abs(secs) < resolvedThresholds.second) {\n        return {\n            value: Math.round(secs),\n            unit: 'second',\n        };\n    }\n    var mins = secs / SECS_PER_MIN;\n    if (Math.abs(mins) < resolvedThresholds.minute) {\n        return {\n            value: Math.round(mins),\n            unit: 'minute',\n        };\n    }\n    var hours = secs / SECS_PER_HOUR;\n    if (Math.abs(hours) < resolvedThresholds.hour) {\n        return {\n            value: Math.round(hours),\n            unit: 'hour',\n        };\n    }\n    var days = secs / SECS_PER_DAY;\n    if (Math.abs(days) < resolvedThresholds.day) {\n        return {\n            value: Math.round(days),\n            unit: 'day',\n        };\n    }\n    var fromDate = new Date(from);\n    var toDate = new Date(to);\n    var years = fromDate.getFullYear() - toDate.getFullYear();\n    if (Math.round(Math.abs(years)) > 0) {\n        return {\n            value: Math.round(years),\n            unit: 'year',\n        };\n    }\n    var months = years * 12 + fromDate.getMonth() - toDate.getMonth();\n    if (Math.round(Math.abs(months)) > 0) {\n        return {\n            value: Math.round(months),\n            unit: 'month',\n        };\n    }\n    var weeks = secs / SECS_PER_WEEK;\n    return {\n        value: Math.round(weeks),\n        unit: 'week',\n    };\n}\nexport var DEFAULT_THRESHOLDS = {\n    second: 45,\n    minute: 45,\n    hour: 22,\n    day: 5,\n};\n","import{selectUnit as e}from\"@formatjs/intl-utils\";var t,r,n=function(e,t){return i(t).format(e)},i=function(e){return new Intl.DateTimeFormat(e.language,{weekday:\"long\",month:\"long\",day:\"numeric\"})},a=function(e,t){return o(t).format(e)},o=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"long\",day:\"numeric\"})},u=function(e,t){return c(t).format(e)},c=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"numeric\",day:\"numeric\"})},m=function(e,t){return s(t).format(e)},s=function(e){return new Intl.DateTimeFormat(e.language,{day:\"numeric\",month:\"short\"})},l=function(e,t){return d(t).format(e)},d=function(e){return new Intl.DateTimeFormat(e.language,{month:\"long\",year:\"numeric\"})},f=function(e,t){return g(t).format(e)},g=function(e){return new Intl.DateTimeFormat(e.language,{month:\"long\"})},p=function(e,t){return h(t).format(e)},h=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\"})};!function(e){e.language=\"language\",e.system=\"system\",e.comma_decimal=\"comma_decimal\",e.decimal_comma=\"decimal_comma\",e.space_comma=\"space_comma\",e.none=\"none\"}(t||(t={})),function(e){e.language=\"language\",e.system=\"system\",e.am_pm=\"12\",e.twenty_four=\"24\"}(r||(r={}));var b=function(e){if(e.time_format===r.language||e.time_format===r.system){var t=e.time_format===r.language?e.language:void 0,n=(new Date).toLocaleString(t);return n.includes(\"AM\")||n.includes(\"PM\")}return e.time_format===r.am_pm},v=function(e,t){return _(t).format(e)},_=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"long\",day:\"numeric\",hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:b(e)})},y=function(e,t){return w(t).format(e)},w=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"long\",day:\"numeric\",hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:b(e)})},k=function(e,t){return x(t).format(e)},x=function(e){return new Intl.DateTimeFormat(e.language,{year:\"numeric\",month:\"numeric\",day:\"numeric\",hour:\"numeric\",minute:\"2-digit\",hour12:b(e)})},D=function(e,t){return S(t).format(e)},S=function(e){return new Intl.DateTimeFormat(e.language,{hour:\"numeric\",minute:\"2-digit\",hour12:b(e)})},F=function(e,t){return T(t).format(e)},T=function(e){return new Intl.DateTimeFormat(e.language,{hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:b(e)})},I=function(e,t){return N(t).format(e)},N=function(e){return new Intl.DateTimeFormat(e.language,{hour:b(e)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:b(e)})},M=function(t,r,n,i){void 0===i&&(i=!0);var a=e(t,n);return i?function(e){return new Intl.RelativeTimeFormat(e.language,{numeric:\"auto\"})}(r).format(a.value,a.unit):Intl.NumberFormat(r.language,{style:\"unit\",unit:a.unit,unitDisplay:\"long\"}).format(Math.abs(a.value))};function C(e){var t,r=3600*(t=e.attributes.remaining.split(\":\").map(Number))[0]+60*t[1]+t[2];if(\"active\"===e.state){var n=(new Date).getTime(),i=new Date(e.last_changed).getTime();r=Math.max(r-(n-i)/1e3,0)}return r}function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}var q=function(e,t,r,n){void 0===n&&(n=!1),e._themes||(e._themes={});var i=t.default_theme;(\"default\"===r||r&&t.themes[r])&&(i=r);var a=O({},e._themes);if(\"default\"!==i){var o=t.themes[i];Object.keys(o).forEach(function(t){var r=\"--\"+t;e._themes[r]=\"\",a[r]=o[t]})}if(e.updateStyles?e.updateStyles(a):window.ShadyCSS&&window.ShadyCSS.styleSubtree(e,a),n){var u=document.querySelector(\"meta[name=theme-color]\");if(u){u.hasAttribute(\"default-content\")||u.setAttribute(\"default-content\",u.getAttribute(\"content\"));var c=a[\"--primary-color\"]||u.getAttribute(\"default-content\");u.setAttribute(\"content\",c)}}},A=function(e){return\"function\"==typeof e.getCardSize?e.getCardSize():4};function E(e){return e.substr(0,e.indexOf(\".\"))}function j(e){return e.substr(e.indexOf(\".\")+1)}function R(e){var t,r=(null==e||null==(t=e.locale)?void 0:t.language)||\"en\";return e.translationMetadata.translations[r]&&e.translationMetadata.translations[r].isRTL||!1}function z(e){return R(e)?\"rtl\":\"ltr\"}function L(e){return E(e.entity_id)}var P=function(e){return!!e.attributes.unit_of_measurement||!!e.attributes.state_class},U=function(e){switch(e.number_format){case t.comma_decimal:return[\"en-US\",\"en\"];case t.decimal_comma:return[\"de\",\"es\",\"it\"];case t.space_comma:return[\"fr\",\"sv\",\"cs\"];case t.system:return;default:return e.language}},B=function(e,t){return void 0===t&&(t=2),Math.round(e*Math.pow(10,t))/Math.pow(10,t)},H=function(e,r,n){var i=r?U(r):void 0;if(Number.isNaN=Number.isNaN||function e(t){return\"number\"==typeof t&&e(t)},(null==r?void 0:r.number_format)!==t.none&&!Number.isNaN(Number(e))&&Intl)try{return new Intl.NumberFormat(i,V(e,n)).format(Number(e))}catch(t){return console.error(t),new Intl.NumberFormat(void 0,V(e,n)).format(Number(e))}return\"string\"==typeof e?e:B(e,null==n?void 0:n.maximumFractionDigits).toString()+(\"currency\"===(null==n?void 0:n.style)?\" \"+n.currency:\"\")},V=function(e,t){var r=O({maximumFractionDigits:2},t);if(\"string\"!=typeof e)return r;if(!t||!t.minimumFractionDigits&&!t.maximumFractionDigits){var n=e.indexOf(\".\")>-1?e.split(\".\")[1].length:0;r.minimumFractionDigits=n,r.maximumFractionDigits=n}return r},W=function(e,t,r,n){var i=void 0!==n?n:t.state;if(\"unknown\"===i||\"unavailable\"===i)return e(\"state.default.\"+i);if(P(t)){if(\"monetary\"===t.attributes.device_class)try{return H(i,r,{style:\"currency\",currency:t.attributes.unit_of_measurement})}catch(e){}return H(i,r)+(t.attributes.unit_of_measurement?\" \"+t.attributes.unit_of_measurement:\"\")}var o=L(t);if(\"input_datetime\"===o){var u;if(void 0===n)return t.attributes.has_date&&t.attributes.has_time?(u=new Date(t.attributes.year,t.attributes.month-1,t.attributes.day,t.attributes.hour,t.attributes.minute),v(u,r)):t.attributes.has_date?(u=new Date(t.attributes.year,t.attributes.month-1,t.attributes.day),a(u,r)):t.attributes.has_time?((u=new Date).setHours(t.attributes.hour,t.attributes.minute),D(u,r)):t.state;try{var c=n.split(\" \");if(2===c.length)return v(new Date(c.join(\"T\")),r);if(1===c.length){if(n.includes(\"-\"))return a(new Date(n+\"T00:00\"),r);if(n.includes(\":\")){var m=new Date;return D(new Date(m.toISOString().split(\"T\")[0]+\"T\"+n),r)}}return n}catch(e){return n}}return\"humidifier\"===o&&\"on\"===i&&t.attributes.humidity?t.attributes.humidity+\" %\":\"counter\"===o||\"number\"===o||\"input_number\"===o?H(i,r):t.attributes.device_class&&e(\"component.\"+o+\".state.\"+t.attributes.device_class+\".\"+i)||e(\"component.\"+o+\".state._.\"+i)||i},G=\"mdi:bookmark\",J=\"lovelace\",K=[\"climate\",\"cover\",\"configurator\",\"input_select\",\"input_number\",\"input_text\",\"lock\",\"media_player\",\"scene\",\"script\",\"timer\",\"vacuum\",\"water_heater\",\"weblink\"],Q=[\"alarm_control_panel\",\"automation\",\"camera\",\"climate\",\"configurator\",\"cover\",\"fan\",\"group\",\"history_graph\",\"input_datetime\",\"light\",\"lock\",\"media_player\",\"script\",\"sun\",\"updater\",\"vacuum\",\"water_heater\",\"weather\"],X=[\"input_number\",\"input_select\",\"input_text\",\"scene\",\"weblink\"],Y=[\"camera\",\"configurator\",\"history_graph\",\"scene\"],Z=[\"closed\",\"locked\",\"off\"],$=new Set([\"fan\",\"input_boolean\",\"light\",\"switch\",\"group\",\"automation\"]),ee=\"°C\",te=\"°F\",re=\"group.default_view\",ne=function(e,t,r,n){n=n||{},r=null==r?{}:r;var i=new Event(t,{bubbles:void 0===n.bubbles||n.bubbles,cancelable:Boolean(n.cancelable),composed:void 0===n.composed||n.composed});return i.detail=r,e.dispatchEvent(i),i},ie=new Set([\"call-service\",\"divider\",\"section\",\"weblink\",\"cast\",\"select\"]),ae={alert:\"toggle\",automation:\"toggle\",climate:\"climate\",cover:\"cover\",fan:\"toggle\",group:\"group\",input_boolean:\"toggle\",input_number:\"input-number\",input_select:\"input-select\",input_text:\"input-text\",light:\"toggle\",lock:\"lock\",media_player:\"media-player\",remote:\"toggle\",scene:\"scene\",script:\"script\",sensor:\"sensor\",timer:\"timer\",switch:\"toggle\",vacuum:\"toggle\",water_heater:\"climate\",input_datetime:\"input-datetime\"},oe=function(e,t){void 0===t&&(t=!1);var r=function(e,t){return n(\"hui-error-card\",{type:\"error\",error:e,config:t})},n=function(e,t){var n=window.document.createElement(e);try{if(!n.setConfig)return;n.setConfig(t)}catch(n){return console.error(e,n),r(n.message,t)}return n};if(!e||\"object\"!=typeof e||!t&&!e.type)return r(\"No type defined\",e);var i=e.type;if(i&&i.startsWith(\"custom:\"))i=i.substr(\"custom:\".length);else if(t)if(ie.has(i))i=\"hui-\"+i+\"-row\";else{if(!e.entity)return r(\"Invalid config given.\",e);var a=e.entity.split(\".\",1)[0];i=\"hui-\"+(ae[a]||\"text\")+\"-entity-row\"}else i=\"hui-\"+i+\"-card\";if(customElements.get(i))return n(i,e);var o=r(\"Custom element doesn't exist: \"+e.type+\".\",e);o.style.display=\"None\";var u=setTimeout(function(){o.style.display=\"\"},2e3);return customElements.whenDefined(e.type).then(function(){clearTimeout(u),ne(o,\"ll-rebuild\",{},o)}),o},ue=function(e,t,r){var n;return void 0===r&&(r=!1),function(){var i=[].slice.call(arguments),a=this,o=function(){n=null,r||e.apply(a,i)},u=r&&!n;clearTimeout(n),n=setTimeout(o,t),u&&e.apply(a,i)}},ce={alert:\"mdi:alert\",automation:\"mdi:playlist-play\",calendar:\"mdi:calendar\",camera:\"mdi:video\",climate:\"mdi:thermostat\",configurator:\"mdi:settings\",conversation:\"mdi:text-to-speech\",device_tracker:\"mdi:account\",fan:\"mdi:fan\",group:\"mdi:google-circles-communities\",history_graph:\"mdi:chart-line\",homeassistant:\"mdi:home-assistant\",homekit:\"mdi:home-automation\",image_processing:\"mdi:image-filter-frames\",input_boolean:\"mdi:drawing\",input_datetime:\"mdi:calendar-clock\",input_number:\"mdi:ray-vertex\",input_select:\"mdi:format-list-bulleted\",input_text:\"mdi:textbox\",light:\"mdi:lightbulb\",mailbox:\"mdi:mailbox\",notify:\"mdi:comment-alert\",person:\"mdi:account\",plant:\"mdi:flower\",proximity:\"mdi:apple-safari\",remote:\"mdi:remote\",scene:\"mdi:google-pages\",script:\"mdi:file-document\",sensor:\"mdi:eye\",simple_alarm:\"mdi:bell\",sun:\"mdi:white-balance-sunny\",switch:\"mdi:flash\",timer:\"mdi:timer\",updater:\"mdi:cloud-upload\",vacuum:\"mdi:robot-vacuum\",water_heater:\"mdi:thermometer\",weblink:\"mdi:open-in-new\"};function me(e,t){if(e in ce)return ce[e];switch(e){case\"alarm_control_panel\":switch(t){case\"armed_home\":return\"mdi:bell-plus\";case\"armed_night\":return\"mdi:bell-sleep\";case\"disarmed\":return\"mdi:bell-outline\";case\"triggered\":return\"mdi:bell-ring\";default:return\"mdi:bell\"}case\"binary_sensor\":return t&&\"off\"===t?\"mdi:radiobox-blank\":\"mdi:checkbox-marked-circle\";case\"cover\":return\"closed\"===t?\"mdi:window-closed\":\"mdi:window-open\";case\"lock\":return t&&\"unlocked\"===t?\"mdi:lock-open\":\"mdi:lock\";case\"media_player\":return t&&\"off\"!==t&&\"idle\"!==t?\"mdi:cast-connected\":\"mdi:cast\";case\"zwave\":switch(t){case\"dead\":return\"mdi:emoticon-dead\";case\"sleeping\":return\"mdi:sleep\";case\"initializing\":return\"mdi:timer-sand\";default:return\"mdi:z-wave\"}default:return console.warn(\"Unable to find icon for domain \"+e+\" (\"+t+\")\"),\"mdi:bookmark\"}}var se=function(e,t){var r=t.value||t,n=t.attribute?e.attributes[t.attribute]:e.state;switch(t.operator||\"==\"){case\"==\":return n===r;case\"<=\":return n<=r;case\"<\":return n<r;case\">=\":return n>=r;case\">\":return n>r;case\"!=\":return n!==r;case\"regex\":return n.match(r);default:return!1}},le=function(e){ne(window,\"haptic\",e)},de=function(e,t,r){void 0===r&&(r=!1),r?history.replaceState(null,\"\",t):history.pushState(null,\"\",t),ne(window,\"location-changed\",{replace:r})},fe=function(e,t,r){void 0===r&&(r=!0);var n,i=E(t),a=\"group\"===i?\"homeassistant\":i;switch(i){case\"lock\":n=r?\"unlock\":\"lock\";break;case\"cover\":n=r?\"open_cover\":\"close_cover\";break;default:n=r?\"turn_on\":\"turn_off\"}return e.callService(a,n,{entity_id:t})},ge=function(e,t){var r=Z.includes(e.states[t].state);return fe(e,t,r)},pe=function(e,t,r,n){if(n||(n={action:\"more-info\"}),!n.confirmation||n.confirmation.exemptions&&n.confirmation.exemptions.some(function(e){return e.user===t.user.id})||(le(\"warning\"),confirm(n.confirmation.text||\"Are you sure you want to \"+n.action+\"?\")))switch(n.action){case\"more-info\":(r.entity||r.camera_image)&&ne(e,\"hass-more-info\",{entityId:r.entity?r.entity:r.camera_image});break;case\"navigate\":n.navigation_path&&de(0,n.navigation_path);break;case\"url\":n.url_path&&window.open(n.url_path);break;case\"toggle\":r.entity&&(ge(t,r.entity),le(\"success\"));break;case\"call-service\":if(!n.service)return void le(\"failure\");var i=n.service.split(\".\",2);t.callService(i[0],i[1],n.service_data,n.target),le(\"success\");break;case\"fire-dom-event\":ne(e,\"ll-custom\",n)}},he=function(e,t,r,n){var i;\"double_tap\"===n&&r.double_tap_action?i=r.double_tap_action:\"hold\"===n&&r.hold_action?i=r.hold_action:\"tap\"===n&&r.tap_action&&(i=r.tap_action),pe(e,t,r,i)},be=function(e,t,r,n,i){var a;if(i&&r.double_tap_action?a=r.double_tap_action:n&&r.hold_action?a=r.hold_action:!n&&r.tap_action&&(a=r.tap_action),a||(a={action:\"more-info\"}),!a.confirmation||a.confirmation.exemptions&&a.confirmation.exemptions.some(function(e){return e.user===t.user.id})||confirm(a.confirmation.text||\"Are you sure you want to \"+a.action+\"?\"))switch(a.action){case\"more-info\":(a.entity||r.entity||r.camera_image)&&(ne(e,\"hass-more-info\",{entityId:a.entity?a.entity:r.entity?r.entity:r.camera_image}),a.haptic&&le(a.haptic));break;case\"navigate\":a.navigation_path&&(de(0,a.navigation_path),a.haptic&&le(a.haptic));break;case\"url\":a.url_path&&window.open(a.url_path),a.haptic&&le(a.haptic);break;case\"toggle\":r.entity&&(ge(t,r.entity),a.haptic&&le(a.haptic));break;case\"call-service\":if(!a.service)return;var o=a.service.split(\".\",2),u=o[0],c=o[1],m=O({},a.service_data);\"entity\"===m.entity_id&&(m.entity_id=r.entity),t.callService(u,c,m,a.target),a.haptic&&le(a.haptic);break;case\"fire-dom-event\":ne(e,\"ll-custom\",a),a.haptic&&le(a.haptic)}};function ve(e){return void 0!==e&&\"none\"!==e.action}function _e(e,t,r){if(t.has(\"config\")||r)return!0;if(e.config.entity){var n=t.get(\"hass\");return!n||n.states[e.config.entity]!==e.hass.states[e.config.entity]}return!1}function ye(e){return void 0!==e&&\"none\"!==e.action}var we=function(e,t,r){void 0===r&&(r=!0);var n={};t.forEach(function(t){if(Z.includes(e.states[t].state)===r){var i=E(t),a=[\"cover\",\"lock\"].includes(i)?i:\"homeassistant\";a in n||(n[a]=[]),n[a].push(t)}}),Object.keys(n).forEach(function(t){var i;switch(t){case\"lock\":i=r?\"unlock\":\"lock\";break;case\"cover\":i=r?\"open_cover\":\"close_cover\";break;default:i=r?\"turn_on\":\"turn_off\"}e.callService(t,i,{entity_id:n[t]})})},ke=function(){var e=document.querySelector(\"home-assistant\");if(e=(e=(e=(e=(e=(e=(e=(e=e&&e.shadowRoot)&&e.querySelector(\"home-assistant-main\"))&&e.shadowRoot)&&e.querySelector(\"app-drawer-layout partial-panel-resolver\"))&&e.shadowRoot||e)&&e.querySelector(\"ha-panel-lovelace\"))&&e.shadowRoot)&&e.querySelector(\"hui-root\")){var t=e.lovelace;return t.current_view=e.___curView,t}return null},xe={humidity:\"mdi:water-percent\",illuminance:\"mdi:brightness-5\",temperature:\"mdi:thermometer\",pressure:\"mdi:gauge\",power:\"mdi:flash\",signal_strength:\"mdi:wifi\"},De={binary_sensor:function(e,t){var r=\"off\"===e;switch(null==t?void 0:t.attributes.device_class){case\"battery\":return r?\"mdi:battery\":\"mdi:battery-outline\";case\"battery_charging\":return r?\"mdi:battery\":\"mdi:battery-charging\";case\"cold\":return r?\"mdi:thermometer\":\"mdi:snowflake\";case\"connectivity\":return r?\"mdi:server-network-off\":\"mdi:server-network\";case\"door\":return r?\"mdi:door-closed\":\"mdi:door-open\";case\"garage_door\":return r?\"mdi:garage\":\"mdi:garage-open\";case\"power\":return r?\"mdi:power-plug-off\":\"mdi:power-plug\";case\"gas\":case\"problem\":case\"safety\":case\"tamper\":return r?\"mdi:check-circle\":\"mdi:alert-circle\";case\"smoke\":return r?\"mdi:check-circle\":\"mdi:smoke\";case\"heat\":return r?\"mdi:thermometer\":\"mdi:fire\";case\"light\":return r?\"mdi:brightness-5\":\"mdi:brightness-7\";case\"lock\":return r?\"mdi:lock\":\"mdi:lock-open\";case\"moisture\":return r?\"mdi:water-off\":\"mdi:water\";case\"motion\":return r?\"mdi:walk\":\"mdi:run\";case\"occupancy\":return r?\"mdi:home-outline\":\"mdi:home\";case\"opening\":return r?\"mdi:square\":\"mdi:square-outline\";case\"plug\":return r?\"mdi:power-plug-off\":\"mdi:power-plug\";case\"presence\":return r?\"mdi:home-outline\":\"mdi:home\";case\"running\":return r?\"mdi:stop\":\"mdi:play\";case\"sound\":return r?\"mdi:music-note-off\":\"mdi:music-note\";case\"update\":return r?\"mdi:package\":\"mdi:package-up\";case\"vibration\":return r?\"mdi:crop-portrait\":\"mdi:vibrate\";case\"window\":return r?\"mdi:window-closed\":\"mdi:window-open\";default:return r?\"mdi:radiobox-blank\":\"mdi:checkbox-marked-circle\"}},cover:function(e){var t=\"closed\"!==e.state;switch(e.attributes.device_class){case\"garage\":return t?\"mdi:garage-open\":\"mdi:garage\";case\"door\":return t?\"mdi:door-open\":\"mdi:door-closed\";case\"shutter\":return t?\"mdi:window-shutter-open\":\"mdi:window-shutter\";case\"blind\":return t?\"mdi:blinds-open\":\"mdi:blinds\";case\"window\":return t?\"mdi:window-open\":\"mdi:window-closed\";default:return me(\"cover\",e.state)}},sensor:function(e){var t=e.attributes.device_class;if(t&&t in xe)return xe[t];if(\"battery\"===t){var r=Number(e.state);if(isNaN(r))return\"mdi:battery-unknown\";var n=10*Math.round(r/10);return n>=100?\"mdi:battery\":n<=0?\"mdi:battery-alert\":\"hass:battery-\"+n}var i=e.attributes.unit_of_measurement;return\"°C\"===i||\"°F\"===i?\"mdi:thermometer\":me(\"sensor\")},input_datetime:function(e){return e.attributes.has_date?e.attributes.has_time?me(\"input_datetime\"):\"mdi:calendar\":\"mdi:clock\"}},Se=function(e){if(!e)return\"mdi:bookmark\";if(e.attributes.icon)return e.attributes.icon;var t=E(e.entity_id);return t in De?De[t](e):me(t,e.state)};export{G as DEFAULT_DOMAIN_ICON,J as DEFAULT_PANEL,re as DEFAULT_VIEW_ENTITY_ID,X as DOMAINS_HIDE_MORE_INFO,Y as DOMAINS_MORE_INFO_NO_HISTORY,$ as DOMAINS_TOGGLE,K as DOMAINS_WITH_CARD,Q as DOMAINS_WITH_MORE_INFO,t as NumberFormat,Z as STATES_OFF,r as TimeFormat,ee as UNIT_C,te as UNIT_F,q as applyThemesOnElement,A as computeCardSize,E as computeDomain,j as computeEntity,R as computeRTL,z as computeRTLDirection,W as computeStateDisplay,L as computeStateDomain,oe as createThing,ue as debounce,me as domainIcon,se as evaluateFilter,ne as fireEvent,ce as fixedIcons,a as formatDate,f as formatDateMonth,l as formatDateMonthYear,u as formatDateNumeric,m as formatDateShort,v as formatDateTime,k as formatDateTimeNumeric,y as formatDateTimeWithSeconds,n as formatDateWeekday,p as formatDateYear,H as formatNumber,D as formatTime,I as formatTimeWeekday,F as formatTimeWithSeconds,le as forwardHaptic,ke as getLovelace,he as handleAction,pe as handleActionConfig,be as handleClick,ve as hasAction,_e as hasConfigOrEntityChanged,ye as hasDoubleClick,P as isNumericState,de as navigate,U as numberFormatToLocale,M as relativeTime,B as round,Se as stateIcon,C as timerTimeRemaining,ge as toggleEntity,we as turnOnOffEntities,fe as turnOnOffEntity};\n//# sourceMappingURL=index.m.js.map\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getNestedProperty = void 0;\nexports.deepMerge = deepMerge;\nexports.isObject = isObject;\nexports.generateControl = generateControl;\nconst lit_1 = require(\"lit\");\nconst unsafe_html_js_1 = require(\"lit/directives/unsafe-html.js\");\nconst getNestedProperty = (obj, path) => {\n    return path.split(\".\").reduce((acc, part) => acc && acc[part], obj);\n};\nexports.getNestedProperty = getNestedProperty;\nfunction deepMerge(target, source) {\n    const output = { ...target };\n    for (const key of Object.keys(source)) {\n        const targetValue = output[key];\n        const sourceValue = source[key];\n        if (key === \"type\") {\n            // Preserve the type property\n            output[key] = sourceValue;\n        }\n        else if (Array.isArray(targetValue) && Array.isArray(sourceValue)) {\n            // Replace arrays entirely\n            output[key] = sourceValue;\n        }\n        else if (isObject(targetValue) && isObject(sourceValue)) {\n            output[key] = deepMerge({ ...targetValue }, sourceValue);\n        }\n        else {\n            output[key] = sourceValue;\n        }\n    }\n    return output;\n}\n/*\nexport function deepMerge2<T>(target: T, source: T): T {\n    const output = { ...target } as any;\n\n    for (const key of Object.keys(source)) {\n        const targetValue = output[key];\n        const sourceValue = (source as any)[key];\n\n        if (key === \"type\") {\n            // Preserve the type property\n            output[key] = sourceValue;\n        } else if (Array.isArray(targetValue) && Array.isArray(sourceValue)) {\n            output[key] = [...new Set([...targetValue, ...sourceValue])]; // Merge arrays while removing duplicates\n        } else if (isObject(targetValue) && isObject(sourceValue)) {\n            output[key] = deepMerge({ ...targetValue }, sourceValue);\n        } else {\n            output[key] = sourceValue;\n        }\n    }\n\n    return output;\n}\n*/\nfunction isObject(obj) {\n    return obj !== null && typeof obj === \"object\";\n}\nfunction generateControl(control, card) {\n    /////put in the conditions for the new controls\n    ///// todo:  ?default val based on condition.. should only be set if set value doesn't exist. think about it..   const defaultValue = control.defaultValueCondition ? this._evaluateCondition(control.defaultValueCondition) : '';\n    //console.debug('generateControl:', control);\n    //pass in context to have access to the card's properties and window object\n    const context = { ...card, hass: card._hass, window };\n    // Evaluate visibility, disabled, and required conditions\n    // eg yaml:  isVisible: 'this._config.cblcars_card_config.show_icon === true'\n    //visible default is true\n    //disabled default is false\n    //required default is false\n    const isVisible = control.visibilityCondition ? card._evaluateCondition(control.visibilityCondition, context) : true;\n    const isDisabled = control.disabledCondition ? card._evaluateCondition(control.disabledCondition, context) : false;\n    const isRequired = control.requiredCondition ? card._evaluateCondition(control.requiredCondition, context) : false;\n    if (!isVisible) {\n        return null;\n    }\n    // Handle dynamic list creation for 'select' selector type\n    /*\n      eg yaml will pull in all css variables starting with '--picard-'\n  \n       - controls:\n          - label: \"options from vars\"\n            configValue: \"variables.card.color.background.inactive\"\n            type: Selector\n            selector:\n              select:\n                optionsCondition: |\n                    (() => {\n                      const styles = document.documentElement.style;\n                      const options = [];\n                      for (let i = 0; i < styles.length; i++) {\n                        const name = styles[i];\n                        if (name.startsWith('--picard-')) {\n                          const value = styles.getPropertyValue(name).trim();\n                          options.push({ value, label: name.replace('--', '') });\n                        }\n                      }\n                      return options;\n                    })()\n  \n    */\n    if ('selector' in control && control.selector && control.selector.select && control.selector.select.optionsCondition) {\n        const options = card._evaluateCondition(control.selector.select.optionsCondition, context);\n        control.selector.select.options = options;\n    }\n    switch (control.type) {\n        case 'Selector':\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                <ha-selector\n                    .hass=${card._hass}\n                    .selector=${control.selector}\n                    .configValue=${control.configValue}\n                    .value=${(0, exports.getNestedProperty)(card._config, control.configValue)}\n                    .label=${control.label}\n                    .helper=${control.helper}\n                    .disabled=${isDisabled}\n                    .required=${isRequired}\n                    @value-changed=${card._valueChanged}\n                ></ha-selector>\n                </div>\n                `;\n        case 'Filler':\n            return (0, lit_1.html) `<div class=\"form-control\"></div>`;\n        case 'Divider':\n            return (0, lit_1.html) `<hr>`;\n        case 'Message':\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    <ha-alert alert-type=${control.alertType || \"info\"} title=${control.title || \"\"}>\n                        ${control.message || \"\"}\n                    </ha-alert>\n                </div>\n            `;\n        case 'RawHTML':\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    ${(0, unsafe_html_js_1.unsafeHTML)(control.html || \"\")}\n                </div>\n            `;\n        case 'ColorPreview':\n            let colorValue = (0, exports.getNestedProperty)(card._config, control.configValue);\n            //console.log('colorValue:', colorValue);\n            // Provide a default color value if colorValue is not set\n            let displayText;\n            if (!colorValue) {\n                colorValue = '#1B1B249A';\n                displayText = 'Color Not Set';\n            }\n            else {\n                displayText = colorValue;\n            }\n            // Check if colorValue is a CSS variable or a hex color\n            const isCssVariable = colorValue.startsWith('var(');\n            let computedColorValue = colorValue;\n            if (isCssVariable) {\n                // Extract the CSS variable name from colorValue\n                const cssVariableNameMatch = colorValue.match(/var\\((--[^,)]+)\\)/);\n                const cssVariableName = cssVariableNameMatch ? cssVariableNameMatch[1] : colorValue;\n                //console.log('cssVariableName:', cssVariableName);\n                // Get the computed color value directly\n                computedColorValue = getComputedStyle(document.documentElement).getPropertyValue(cssVariableName).trim();\n                //console.log('computedColorValue:', computedColorValue);\n                // Check if computedColorValue is empty and provide a fallback\n                if (!computedColorValue) {\n                    console.warn(`CSS variable ${cssVariableName} is not defined. Using fallback color.`);\n                    computedColorValue = '#0000ff'; // Fallback to a nice blue color\n                }\n            }\n            else if (colorValue !== '#1B1B249A') {\n                displayText = 'User Defined Color';\n            }\n            // Function to convert hex color to RGB\n            const hexToRgb = (hex) => {\n                // Remove the hash at the start if it's there\n                hex = hex.replace(/^#/, '');\n                // Check if the hex includes an alpha channel\n                let bigint;\n                let r, g, b, a;\n                if (hex.length === 8) {\n                    // Parse the r, g, b, a values\n                    bigint = parseInt(hex, 16);\n                    r = (bigint >> 24) & 255;\n                    g = (bigint >> 16) & 255;\n                    b = (bigint >> 8) & 255;\n                    a = bigint & 255;\n                    return [r, g, b, a / 255]; // Return alpha as a normalized value (0 to 1)\n                }\n                else {\n                    // Parse the r, g, b values\n                    bigint = parseInt(hex, 16);\n                    r = (bigint >> 16) & 255;\n                    g = (bigint >> 8) & 255;\n                    b = bigint & 255;\n                    return [r, g, b];\n                }\n            };\n            // Function to convert RGB string to luminance\n            const getLuminance = (hex) => {\n                //console.log('Hex input to getLuminance:', hex);\n                const [r, g, b] = hexToRgb(hex);\n                //console.log('Parsed RGB values:', [r, g, b]);\n                const [nr, ng, nb] = [r, g, b].map(value => value / 255).map(value => {\n                    return value <= 0.03928 ? value / 12.92 : Math.pow((value + 0.055) / 1.055, 2.4);\n                });\n                //console.log('Normalized RGB values:', [nr, ng, nb]);\n                return 0.2126 * nr + 0.7152 * ng + 0.0722 * nb;\n            };\n            // Determine text color based on luminance\n            const luminance = getLuminance(computedColorValue);\n            //console.log('Luminance:', luminance);\n            const textColor = luminance > 0.5 ? '#000' : '#fff';\n            //console.log('textColor:', textColor);\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    <div style=\"-webkit-fill-available; height: 50px; background-color: ${colorValue}; border-radius: 25px; border: 1px solid #000; display: flex; flex-direction: column; align-items: center; justify-content: center; color: ${textColor};\">\n                        <div>${displayText}</div>\n                        <div>${computedColorValue}</div>\n                    </div>\n                </div>\n            `;\n        default:\n            return (0, lit_1.html) `\n                <div class=\"form-control\">\n                    <ha-alert alert-type=\"error\" title=\"Unsupported Control Type\">\n                    The control type \"${control.type}\" is not supported.\n                </ha-alert>\n                </div>\n                `;\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst custom_card_helpers_1 = require(\"custom-card-helpers\");\nconst lit_1 = require(\"lit\");\nconst unsafe_html_js_1 = require(\"lit/directives/unsafe-html.js\");\nconst interfaces_1 = require(\"./interfaces\");\nconst controls_1 = require(\"./controls\");\nclass EditorForm extends lit_1.LitElement {\n    constructor() {\n        super(...arguments);\n        this._selectedTab = \"panel-0\"; // Default to first tab\n        this._userStyles = (0, lit_1.css) ``;\n        this._mergeUserStyles = true;\n    }\n    setConfig(config) {\n        this._config = config;\n        this.requestUpdate(\"_config\");\n    }\n    set hass(hass) {\n        this._hass = hass;\n    }\n    generateForm(cardConfigData) {\n        if (!cardConfigData) {\n            return (0, lit_1.html) ``;\n        }\n        if (cardConfigData.tabs) {\n            return this.generateTabs(cardConfigData.tabs);\n        }\n        else {\n            const formControls = cardConfigData.render_form.map((row) => {\n                if ((0, interfaces_1.isSection)(row)) {\n                    return this.generateSection(row);\n                }\n                else {\n                    return this.generateRow(row);\n                }\n            });\n            return (0, lit_1.html) `\n            <div class=\"card-form\">\n                ${formControls}\n            </div>\n        `;\n        }\n    }\n    _handleTabActivated(event) {\n        this._selectedTab = event.detail.name;\n        this.requestUpdate();\n    }\n    generateTabs(tabs) {\n        const visibleTabs = tabs.filter(tab => this._evaluateCondition(tab.visibilityCondition || \"true\"));\n        return (0, lit_1.html) `\n            <sl-tab-group @sl-tab-show=${this._handleTabActivated}>\n                ${visibleTabs.map((tab, index) => (0, lit_1.html) `\n                    <sl-tab slot=\"nav\" panel=\"panel-${index}\" ?active=${this._selectedTab === `panel-${index}`}>\n                        ${tab.label}\n                    </sl-tab>\n                `)}\n            </sl-tab-group>\n            <div class=\"tab-content\">\n                ${visibleTabs.map((tab, index) => (0, lit_1.html) `\n                    <sl-tab-panel name=\"panel-${index}\" ?hidden=${this._selectedTab !== `panel-${index}`}>\n                        ${tab.content.map(item => {\n            if (item.type === \"Section\") {\n                return this.generateSection(item);\n            }\n            else {\n                return this.generateRow(item);\n            }\n        })}\n                    </sl-tab-panel>\n                `)}\n            </div>\n        `;\n    }\n    generateSection(section) {\n        var _a;\n        if (section.visibilityCondition && !this._evaluateCondition(section.visibilityCondition)) {\n            return (0, lit_1.html) ``;\n        }\n        const cssClass = section.cssClass ? `form-row ${section.cssClass}` : \"form-row\";\n        // Create the header element programmatically\n        const headerLevel = section.headerLevel || 4;\n        const headerTag = `h${headerLevel}`;\n        const headerContent = `\n            <${headerTag} slot=\"header\">\n                ${section.icon ? `<ha-icon icon=\"${section.icon}\"></ha-icon>` : ''}\n                ${section.label}\n                ${section.secondary ? `<div slot=\"secondary\">${section.secondary}</div>` : ''}\n            </${headerTag}>\n        `;\n        return (0, lit_1.html) `\n            <div class=\"${cssClass}\">\n                <ha-expansion-panel\n                    .expanded=${section.expanded || false}\n                    .noCollapse=${section.noCollapse || false}\n                    .outlined=${section.outlined || true}\n                    .leftChevron=${section.leftChevron || false}\n                    .secondary=${section.secondary || ''}\n                >\n                    ${(0, unsafe_html_js_1.unsafeHTML)(headerContent)}\n                    <div>\n                        ${(_a = section.rows) === null || _a === void 0 ? void 0 : _a.map(row => (0, interfaces_1.isSection)(row) ? this.generateSection(row) : this.generateRow(row))}\n                    </div>\n                </ha-expansion-panel>\n            </div>\n        `;\n    }\n    generateRow(row) {\n        if (row.visibilityCondition && !this._evaluateCondition(row.visibilityCondition)) {\n            return (0, lit_1.html) ``;\n        }\n        const cssClass = row.cssClass ? `form-row ${row.cssClass}` : \"form-row\";\n        return (0, lit_1.html) `\n            <div class=\"${cssClass}\">\n                ${row.label ? (0, lit_1.html) `<label>${row.label}</label>` : ''}\n                ${row.controls.map(control => {\n            if (control.visibilityCondition && !this._evaluateCondition(control.visibilityCondition)) {\n                return (0, lit_1.html) ``;\n            }\n            return (0, controls_1.generateControl)(control, this);\n        })}\n            </div>\n        `;\n    }\n    _evaluateCondition(condition, context = {}) {\n        try {\n            return new Function('context', 'with(context) { return ' + condition + '; }').call(this, context);\n        }\n        catch (e) {\n            console.error('Error evaluating condition:', condition, e);\n            return false;\n        }\n    }\n    _valueChanged(ev) {\n        var _a, _b;\n        if (!this._config || !this._hass) {\n            return;\n        }\n        const target = ev.target; // Cast to a more specific type\n        //console.debug(\"target\", target);\n        //console.debug(\"ev.detail\", ev.detail);\n        // Extract the config path from the control\n        const configPath = (_b = (_a = target.configValue) === null || _a === void 0 ? void 0 : _a.split(\".\")) !== null && _b !== void 0 ? _b : [];\n        //console.debug(\"configPath: \", configPath);\n        // Get the new value based on the control type and event details\n        const newValue = this._getNewValue(target, ev.detail);\n        //console.debug(\"newValue: \", newValue);\n        // Determine if the control is a checkbox\n        // const isCheckbox = target.tagName === \"HA-CHECKBOX\";\n        // Determine if the control is handling an array\n        const isArray = target.tagName === \"HA-SELECTOR\" && Array.isArray(ev.detail.value);\n        // Update the config using a helper function\n        this._updateConfig(configPath, newValue, isArray);\n        // Fire the \"config-changed\" event\n        (0, custom_card_helpers_1.fireEvent)(this, \"config-changed\", { config: this._config }, { bubbles: true, composed: true });\n        // Request an update to reflect changes\n        this.requestUpdate();\n    }\n    // Helper function to extract the new value based on control type\n    _getNewValue(target, detail) {\n        var _a, _b, _c;\n        switch (target.tagName) {\n            case \"HA-SELECTOR\":\n                return detail === null || detail === void 0 ? void 0 : detail.value;\n            case \"HA-SWITCH\":\n                return (_a = target.checked) !== null && _a !== void 0 ? _a : target.__checked;\n            case \"HA-CHECKBOX\":\n                return target.value;\n            case \"HA-FORM\":\n                return Object.values((_b = detail === null || detail === void 0 ? void 0 : detail.value) !== null && _b !== void 0 ? _b : {})[0];\n            default:\n                return (_c = detail === null || detail === void 0 ? void 0 : detail.value) !== null && _c !== void 0 ? _c : target.value;\n        }\n    }\n    _updateConfig(configPath, newValue, isArray = false) {\n        if (!configPath.length) {\n            return;\n        }\n        const configPathString = configPath.join(\".\");\n        let config = { ...this._config };\n        let nestedConfig = config;\n        for (let i = 0; i < configPath.length - 1; i++) {\n            nestedConfig[configPath[i]] = nestedConfig[configPath[i]] || {};\n            nestedConfig = nestedConfig[configPath[i]];\n        }\n        const lastKey = configPath[configPath.length - 1];\n        // Handle single value or array case\n        if (newValue === \"\" || newValue === null || newValue === undefined) {\n            delete nestedConfig[lastKey];\n        }\n        else {\n            nestedConfig[lastKey] = newValue;\n        }\n        this._config = (0, controls_1.deepMerge)(this._config, config);\n    }\n    updated(changedProperties) {\n        super.updated(changedProperties);\n        const constructor = this.constructor;\n        //this.shadowRoot.adoptedStyleSheets = [constructor.styles.styleSheet, this._userStyles.styleSheet];\n        if (this._mergeUserStyles) {\n            this.shadowRoot.adoptedStyleSheets = [constructor.styles.styleSheet, this._userStyles.styleSheet];\n        }\n        else {\n            this.shadowRoot.adoptedStyleSheets = [this._userStyles.styleSheet];\n        }\n    }\n    static get styles() {\n        const baseStyles = (0, lit_1.css) `\n            /* Base styles for the form container */\n            .card-form {\n                display: grid;\n                grid-gap: 8px;\n            }\n\n             /* Styles for tabs */\n            mwc-tab-bar {\n                border-bottom: 1px solid var(--divider-color);\n            }\n            .tab-content {\n                padding: 10px;\n            }\n            .tab-panel {\n                display: none;\n            }\n            .tab-panel:not([hidden]) {\n                display: block;\n            }\n            /* Base styles for form rows */\n            .form-row {\n                display: grid;\n                grid-template-columns: 1fr;\n                grid-gap: 8px;\n                /* margin-bottom: 10px; */\n                border-radius: 10px;\n            }\n\n            /* Styles for form rows with two controls */\n            .form-row.two-controls {\n                grid-template-columns: 1fr 1fr;\n            }\n            /* Labels in form rows with two controls */\n            .form-row.two-controls label {\n                grid-column: span 2; /* Make the label span across both columns */\n                justify-self: start; /* Left-justify the label */\n                font-weight: bold;\n                height: auto;\n                margin-bottom: 5px; /* Add some space below the label */\n                padding-left: 8px;\n            }\n\n            /* ensure full width for form controls not in two-controls class */\n\n            .form-row:not(.two-controls) .form-control > * {\n                width: -webkit-fill-available;\n            }\n\n            /* Base styles for form controls */\n            .form-control {\n                display: flex; /* Use flexbox for internal alignment */\n                align-items: center;\n                padding: 8px;\n                border-radius: 10px;\n            }\n\n            /* Label styles within form controls */\n            .form-control label {\n                font-weight: bold;\n                padding-left: 8px;\n            }\n\n            /* Styles for expandable sections */\n            ha-expansion-panel {\n                margin-bottom: 10px;\n                border-radius: var(--ha-card-border-radius, 34px);\n            }\n            ha-expansion-panel[outlined] {\n                border: 2px solid var(--chip-background-color);\n            }\n            ha-expansion-panel[expanded] {\n                background-color: var(--chip-background-color);\n            }\n            h1 > ha-icon,\n            h2 > ha-icon,\n            h3 > ha-icon,\n            h4 > ha-icon,\n            h5 > ha-icon,\n            h6 > ha-icon {\n                margin: 0 8px;\n            }\n\n            hr {\n                width: 95%;\n                border: 1px solid var(--chip-background-color);\n            }\n\n            /* Styles for form errors */\n            .form-error {\n                color: var(--error-color); /* Home Assistant theme color */\n                font-size: 0.875em;\n                margin-top: 5px;\n            }\n        `;\n        return baseStyles;\n    }\n}\nexports.default = EditorForm;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isSection = isSection;\nexports.isControlRow = isControlRow;\nfunction isSection(row) {\n    return row.type === 'Section';\n}\nfunction isControlRow(row) {\n    return row.type === 'ControlRow';\n}\n","//CB-LCARS main verson from package.json\nconst packageJson = require('../package.json');\nexport const CBLCARS_VERSION = packageJson.version;\nexport const project_url = \"https://cb-lcars.unimatrix01.ca\";\n\n\nexport const core_fonts = [\n        'https://fonts.googleapis.com/css2?family=Antonio:wght@100;700&display=swap',\n        'cb-lcars_jeffries',\n        'cb-lcars_microgramma'\n    ];\n\n\n//CB-LARS yaml configuration files (templates, strategies, editor forms, etc.)\nexport const templates_uri = '/hacsfiles/cb-lcars/cb-lcars-lovelace.yaml';\nexport const stub_config_uri = '/hacsfiles/cb-lcars/cb-lcars-stub-config.yaml';\nexport const theme_colors_uri = '/hacsfiles/cb-lcars/cb-lcars-themes.yaml';\nexport const airlock_uri = '/hacsfiles/cb-lcars/cb-lcars-airlock.yaml';\nexport const gallery_uri = '/hacsfiles/cb-lcars/cb-lcars-gallery.yaml';\n//export const card_editor_uri = '/hacsfiles/cb-lcars/cb-lcars-card-editor-forms.yaml'\nexport const card_editor_uri = '/hacsfiles/cb-lcars/editor'\nexport const gallery_views_uris = [\n        '/hacsfiles/cb-lcars/cb-lcars-gallery.yaml',\n        '/hacsfiles/cb-lcars/cb-lcars-gallery-buttons.yaml',\n        '/hacsfiles/cb-lcars/cb-lcars-gallery-elbows.yaml',\n        '/hacsfiles/cb-lcars/cb-lcars-gallery-multimeter.yaml'\n    ]\n\nexport const builtin_svg_keys = [\n    'ncc-1701-a',\n    'ncc-1701-a-blue',\n    'enterprise-d-shuttlecraft15-anomaly',\n    // Add more built-in SVG keys here (without .svg extension)\n    ];\nexport const builtin_svg_basepath = '/hacsfiles/cb-lcars/msd/';\n","/* MSD Corner Arc Scenario Harness (Wave 5 - M5.5)\n * Usage:\n *   window.__msdScenarios.arcs.list()\n *   window.__msdScenarios.arcs.runAll()\n */\n(function initArcScenarios(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi(){ const p=W.__msdDebug?.pipelineInstance; if(!p||!p.enabled) throw new Error('pipeline disabled'); return p; }\n  function inspect(id){ return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(scope='*'){ W.__msdDebug?.routing?.invalidate(scope); }\n\n  const targetLine = 'line_grid_forced'; // has corner_style: round with >1 bend after obstacles\n\n  function ensureRound(lineId){\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===lineId);\n    if (!ov) throw new Error('overlay not found');\n    ov._raw = ov._raw || {};\n    ov._raw.corner_style = 'round';\n    ov._raw.corner_radius = ov._raw.corner_radius || 40;\n  }\n\n  function scenarioArcPresence() {\n    ensureRound(targetLine);\n    invalidate('*');\n    const res = inspect(targetLine);\n    const ok = !!res && /A\\d+/.test(res.d) && res.meta.arc && res.meta.arc.count > 0;\n    return { ok, details: { dSample: res?.d?.slice(0,120)+'...', arc: res?.meta?.arc } };\n  }\n\n  function scenarioRadiusClamp() {\n    ensureRound(targetLine);\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===targetLine);\n    const original = ov._raw.corner_radius;\n    ov._raw.corner_radius = 1000; // absurdly large to trigger clamping\n    invalidate('*');\n    const res = inspect(targetLine);\n    ov._raw.corner_radius = original;\n    invalidate('*');\n    const ok = !!res && res.meta.arc && res.meta.arc.count > 0;\n    return { ok, details: { trimPx: res?.meta?.arc?.trimPx, count: res?.meta?.arc?.count } };\n  }\n\n  function scenarioArcCacheReuse() {\n    ensureRound(targetLine);\n    invalidate('*');\n    const first = inspect(targetLine);\n    const second = inspect(targetLine);\n    const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true && second.meta.arc?.count >= 0;\n    return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit, arcCount: second?.meta?.arc?.count } };\n  }\n\n  function scenarioMiterFallback() {\n    // Temporarily set corner_style:miter expect no arc meta\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===targetLine);\n    if (!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origStyle = ov._raw.corner_style;\n    ov._raw.corner_style = 'miter';\n    invalidate('*');\n    const res = inspect(targetLine);\n    ov._raw.corner_style = origStyle;\n    invalidate('*');\n    const ok = !!res && !res.meta.arc;\n    return { ok, details: { hasArcMeta: !!res.meta.arc } };\n  }\n\n  const scenarios = {\n    arc_presence: scenarioArcPresence,\n    radius_clamp: scenarioRadiusClamp,\n    arc_cache_reuse: scenarioArcCacheReuse,\n    miter_fallback: scenarioMiterFallback\n  };\n\n  const api = {\n    list: ()=>Object.keys(scenarios),\n    run: (n)=>{\n      if(!scenarios[n]) { console.warn('[MSD Arc Scenario] Unknown', n); return null; }\n      try {\n        const r = scenarios[n]();\n        console.log(`[MSD Arc Scenario] ${n}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e){\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Arc Scenario] ${n}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: ()=>{\n      const res={};\n      for (const k of Object.keys(scenarios)) res[k]=api.run(k);\n      const allOk = Object.values(res).every(r=>r&&r.ok);\n      console.log('[MSD Arc Scenario] Summary:', allOk?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.arcs = api;\n  console.info('[MSD v1] Arc routing scenario harness installed. Use: window.__msdScenarios.arcs.list()');\n})();\n","/* MSD Channel Routing Scenario Harness (Wave 5 - M5.4)\n * Usage:\n *   window.__msdScenarios.channels.list()\n *   window.__msdScenarios.channels.runAll()\n */\n(function initChannelScenarios(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi(){ const p=W.__msdDebug?.pipelineInstance; if(!p||!p.enabled) throw new Error('pipeline disabled'); return p; }\n  function inspect(id){ return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(scope='*'){ W.__msdDebug?.routing?.invalidate(scope); }\n\n  function setMode(id, modeFull, mode=null){\n    const model = pi().getResolvedModel();\n    const ov = model?.overlays.find(o=>o.id===id);\n    if(!ov) throw new Error('overlay not found '+id);\n    ov._raw = ov._raw || {};\n    if (modeFull !== undefined) ov._raw.route_mode_full = modeFull;\n    if (mode !== null) ov._raw.route_mode = mode;\n    return ov;\n  }\n\n  function scenarioPreferImprovesCost() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origChannels = ov._raw.route_channels ? ov._raw.route_channels.slice() : [];\n    const origMode = ov._raw.route_channel_mode;\n\n    // Baseline without channels\n    ov._raw.route_channels = [];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const base = inspect(id);\n\n    // With channels\n    ov._raw.route_channels = ['main_bus'];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const preferred = inspect(id);\n\n    // restore\n    ov._raw.route_channels = origChannels;\n    ov._raw.route_channel_mode = origMode;\n    invalidate('*');\n\n    const ok = !!base && !!preferred && preferred.meta.cost <= base.meta.cost;\n    return { ok, details: { baseCost: base?.meta.cost, preferCost: preferred?.meta.cost } };\n  }\n\n  function scenarioAvoidIncreasesCost() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origChannels = ov._raw.route_channels ? ov._raw.route_channels.slice() : [];\n    const origMode = ov._raw.route_channel_mode;\n\n    ov._raw.route_channels = ['main_bus'];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const prefer = inspect(id);\n\n    ov._raw.route_channel_mode = 'avoid';\n    invalidate('*');\n    const avoid = inspect(id);\n\n    ov._raw.route_channels = origChannels;\n    ov._raw.route_channel_mode = origMode;\n    invalidate('*');\n\n    const ok = !!prefer && !!avoid && avoid.meta.cost >= prefer.meta.cost;\n    return { ok, details: { preferCost: prefer?.meta.cost, avoidCost: avoid?.meta.cost } };\n  }\n\n  function scenarioForcePenalty() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const origChannels = ov._raw.route_channels ? ov._raw.route_channels.slice() : [];\n    const origMode = ov._raw.route_channel_mode;\n\n    ov._raw.route_channels = ['main_bus','aux_bus']; // force across two channels (likely outside some)\n    ov._raw.route_channel_mode = 'force';\n    invalidate('*');\n    const forced = inspect(id);\n\n    ov._raw.route_channels = origChannels;\n    ov._raw.route_channel_mode = origMode;\n    invalidate('*');\n\n    const ok = !!forced && forced.meta.channel && (forced.meta.channel.forcedOutside === true || forced.meta.channel.coveragePct === 100);\n    return { ok, details: forced?.meta.channel || {} };\n  }\n\n  // NEW: attempt to increase coverage by shaping (forces low baseline by clearing channels first)\n  function scenarioPreferShapingCoverage() {\n    const id = 'line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const save = {\n      channels: ov._raw.route_channels ? ov._raw.route_channels.slice():[],\n      mode: ov._raw.route_channel_mode,\n      modeFull: ov._raw.route_mode_full\n    };\n    ov._raw.route_mode_full = 'grid';\n    ov._raw.route_channels = ['main_bus'];\n    ov._raw.route_channel_mode = 'prefer';\n    invalidate('*');\n    const first = inspect(id);\n    // if already high coverage, skip shaping test as pass\n    if (!first || !first.meta.channel) {\n      // restore\n      ov._raw.route_channels = save.channels; ov._raw.route_channel_mode = save.mode; ov._raw.route_mode_full = save.modeFull; invalidate('*');\n      return { ok:false, details:'channel meta missing'};\n    }\n    const c1 = first.meta.channel.coveragePct;\n    // Artificially move elbow outside channel to force shaping attempt by tweaking anchor via API if available\n    try {\n      const anchorSet = pi().setAnchor && pi().setAnchor;\n      if (anchorSet) {\n        // nudge anchor horizontally away\n        const anchorId = ov._raw.anchor;\n        const rm = pi().getResolvedModel();\n        if (rm?.anchors?.[anchorId]) {\n          const a = rm.anchors[anchorId].slice();\n            pi().setAnchor(anchorId, [a[0]-120, a[1]]);\n          invalidate('*');\n        }\n      }\n    } catch {}\n    const second = inspect(id);\n    const c2 = second?.meta?.channel?.coveragePct ?? c1;\n    // restore\n    ov._raw.route_channels = save.channels;\n    ov._raw.route_channel_mode = save.mode;\n    ov._raw.route_mode_full = save.modeFull;\n    invalidate('*');\n    const ok = c2 >= c1;\n    return { ok, details: { coverageBefore: c1, coverageAfter: c2 } };\n  }\n\n  function scenarioForceDowngradeOrFull() {\n    const id='line_channel_demo';\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===id);\n    if(!ov) return { ok:false, details:'overlay missing'};\n    ov._raw = ov._raw || {};\n    const save = {\n      channels: ov._raw.route_channels ? ov._raw.route_channels.slice():[],\n      mode: ov._raw.route_channel_mode\n    };\n    ov._raw.route_channels = ['main_bus','aux_bus'];\n    ov._raw.route_channel_mode = 'force';\n    invalidate('*');\n    const res = inspect(id);\n    const chan = res?.meta?.channel;\n    ov._raw.route_channels = save.channels;\n    ov._raw.route_channel_mode = save.mode;\n    invalidate('*');\n    if (!chan) return { ok:false, details:'no channel meta'};\n    const ok = (chan.coveragePct === 100) || (chan.shaping && chan.shaping.downgraded);\n    return { ok, details: chan };\n  }\n\n  function scenarioChannelAcceptance() {\n    // Re-run core scenarios & aggregate pass/fail\n    const prefer = scenarioPreferImprovesCost();\n    const avoid = scenarioAvoidIncreasesCost();\n    const force = scenarioForcePenalty();\n    const shaping = (typeof scenarioPreferShapingCoverage === 'function') ? scenarioPreferShapingCoverage() : { ok:true };\n    const summaryOk = [prefer, avoid, force, shaping].every(r => r && r.ok);\n    return {\n      ok: summaryOk,\n      details: {\n        prefer, avoid, force, shaping\n      }\n    };\n  }\n\n  const scenarios = {\n    prefer_improves_cost: scenarioPreferImprovesCost,\n    avoid_increases_cost: scenarioAvoidIncreasesCost,\n    force_penalty_or_full_coverage: scenarioForcePenalty,\n    prefer_shaping_coverage: scenarioPreferShapingCoverage,\n    force_downgrade_or_full: scenarioForceDowngradeOrFull,\n    channel_acceptance: scenarioChannelAcceptance    // NEW\n  };\n\n  const api = {\n    list: () => Object.keys(scenarios),\n    run: (n) => {\n      if(!scenarios[n]) { console.warn('[MSD Channel Scenario] Unknown', n); return null; }\n      try {\n        const r = scenarios[n]();\n        console.log(`[MSD Channel Scenario] ${n}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e) {\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Channel Scenario] ${n}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: () => {\n      const res = {};\n      for (const k of Object.keys(scenarios)) res[k] = api.run(k);\n      const ok = Object.values(res).every(r=>r&&r.ok);\n      console.log('[MSD Channel Scenario] Summary:', ok?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.channels = api;\n  console.info('[MSD v1] Channel routing scenario harness installed. Use: window.__msdScenarios.channels.list()');\n})();\n","/* MSD Routing Scenario Harness (Wave 5)\n * Paste/import this once after the pipeline loads (e.g. include in bundle or run in console).\n * Provides reproducible, code-driven tests without editing YAML.\n *\n * Usage (in browser console after card rendered):\n *   window.__msdScenarios.routing.list()\n *   window.__msdScenarios.routing.run('cache')\n *   window.__msdScenarios.routing.runAll()\n *\n * Each scenario returns { ok:boolean, details, warnings:[] } and logs a concise summary.\n */\n\n(function initRoutingHarness(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function requirePipeline() {\n    const pi = W.__msdDebug?.pipelineInstance;\n    if (!pi || pi.enabled === false) throw new Error('Pipeline disabled or missing.');\n    return pi;\n  }\n\n  function getModel() {\n    // Prefer live lastRenderModel if provided by renderer hook\n    return W.__msdDebug?.lastRenderModel || requirePipeline().getResolvedModel?.() || null;\n  }\n\n  function listOverlays() {\n    const m = getModel();\n    return m?.overlays || [];\n  }\n\n  function findOverlay(id) {\n    return listOverlays().find(o => o.id === id);\n  }\n\n  function inspect(id) {\n    return W.__msdDebug?.routing?.inspect(id);\n  }\n\n  function invalidate(scope='*') {\n    W.__msdDebug?.routing?.invalidate(scope);\n  }\n\n  function anchorClone() {\n    const model = getModel();\n    return model?.anchors ? { ...model.anchors } : {};\n  }\n\n  function log(name, result) {\n    const color = result.ok ? 'color:#4caf50' : 'color:#f44336';\n    console.log(`%c[MSD Scenario] ${name}: ${result.ok?'OK':'FAIL'}`, color, result);\n  }\n\n  // --- Scenarios ---\n\n  function scenarioCache() {\n    const lineId = 'line_grid_forced';\n    invalidate('*');\n    const first = inspect(lineId);\n    const second = inspect(lineId);\n    const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true;\n    return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit } };\n  }\n\n  function scenarioGridVsManhattan() {\n    const grid = inspect('line_grid_forced');\n    const man = inspect('line_manhattan_baseline');\n    const ok = !!grid && !!man && grid.meta.strategy.startsWith('grid') && man.meta.strategy.startsWith('manhattan');\n    return { ok, details: { gridStrategy: grid?.meta.strategy, manStrategy: man?.meta.strategy } };\n  }\n\n  function scenarioAvoidCreatesBend() {\n    const targetId = 'line_smart_clear';\n    const ov = findOverlay(targetId);\n    if (!ov) return { ok:false, details:'overlay not found' };\n    const before = inspect(targetId);\n    // monkey patch avoid list\n    ov._raw = ov._raw || {};\n    const originalAvoid = Array.isArray(ov._raw.avoid) ? ov._raw.avoid.slice() : undefined;\n    if (!ov._raw.avoid) ov._raw.avoid = [];\n    if (!ov._raw.avoid.includes('obstacle_vertical')) ov._raw.avoid.push('obstacle_vertical');\n    invalidate('*');\n    const after = inspect(targetId);\n    // restore\n    if (originalAvoid === undefined) delete ov._raw.avoid; else ov._raw.avoid = originalAvoid;\n    invalidate('*');\n    const ok = !!before && !!after && after.meta.bends >= before.meta.bends;\n    return { ok, details: { bendsBefore: before?.meta.bends, bendsAfter: after?.meta.bends } };\n  }\n\n  function scenarioModeHintYX() {\n    const id = 'line_grid_forced';\n    const ov = findOverlay(id);\n    if (!ov) return { ok:false, details:'overlay not found'};\n    ov._raw = ov._raw || {};\n    // Baseline (xy / default)\n    ov._raw.route_mode = 'xy';\n    invalidate('*');\n    const base = inspect(id);\n    // yx\n    ov._raw.route_mode = 'yx';\n    invalidate('*');\n    const yx = inspect(id);\n    // restore\n    delete ov._raw.route_mode;\n    invalidate('*');\n    const basePts = base?.pts || [];\n    const yxPts = yx?.pts || [];\n    // Expect both have an elbow (>=3 points). In xy, second point shares y1 (horizontal first). In yx, second shares x1 (vertical first).\n    const baseHorizontalFirst = basePts.length>=3 && basePts[1][1] === basePts[0][1];\n    const yxVerticalFirst = yxPts.length>=3 && yxPts[1][0] === yxPts[0][0];\n    const ok = baseHorizontalFirst && yxVerticalFirst;\n    return { ok, details: { basePts, yxPts, baseHorizontalFirst, yxVerticalFirst } };\n  }\n\n  function scenarioClearanceShift() {\n    const id = 'line_grid_forced';\n    const router = requirePipeline().router;\n    if (!router) return { ok:false, details:'router missing' };\n    invalidate('*');\n    const base = inspect(id);\n    const orig = router.config.clearance;\n    router.config.clearance = (orig || 8) + 24;\n    invalidate('*');\n    const raised = inspect(id);\n    router.config.clearance = orig;\n    invalidate('*');\n    const ok = !!base && !!raised && raised.meta.cost >= base.meta.cost;\n    return { ok, details: { baseCost: base?.meta.cost, raisedCost: raised?.meta.cost } };\n  }\n\n  function scenarioAnchorMove() {\n    const anchorId = 'smart_far_anchor';\n    const pi = requirePipeline();\n    const model = getModel();\n    if (!model?.anchors || !model.anchors[anchorId]) return { ok:false, details:'anchor not present' };\n    const lineId = 'line_smart_far_avoid';\n    invalidate('*');\n    const before = inspect(lineId);\n    const orig = model.anchors[anchorId].slice();\n    // Use pipeline API (updates cardModel + resolvedModel + rerender)\n    const moved = pi.setAnchor(anchorId, [orig[0] + 40, orig[1]]);\n    invalidate('*');\n    const after = inspect(lineId);\n    // revert\n    pi.setAnchor(anchorId, orig);\n    invalidate('*');\n    const ok = moved && !!before && !!after && before.pts[0][0] !== after.pts[0][0];\n    return { ok, details: { from: before?.pts[0], to: after?.pts[0], moved } };\n  }\n\n  function scenarioFallbackOnImpossibleGrid() {\n    const router = requirePipeline().router;\n    if (!router) return { ok:false, details:'router missing'};\n    const originalComputeGrid = router._computeGrid;\n    // Force failure for this call only by returning null\n    router._computeGrid = function(req){ if (req.id === 'line_grid_forced') return null; return originalComputeGrid.call(this, req); };\n    invalidate('*');\n    const res = inspect('line_grid_forced');\n    // restore\n    router._computeGrid = originalComputeGrid;\n    invalidate('*');\n    const ok = !!res && /manhattan|fallback/.test(res.meta.strategy);\n    return { ok, details: { strategy: res?.meta.strategy } };\n  }\n\n  const scenarios = {\n    cache: scenarioCache,\n    grid_vs_manhattan: scenarioGridVsManhattan,\n    avoid_creates_bend: scenarioAvoidCreatesBend,\n    mode_hint_yx: scenarioModeHintYX,\n    clearance_shift: scenarioClearanceShift,\n    anchor_move: scenarioAnchorMove,\n    fallback_impossible_grid: scenarioFallbackOnImpossibleGrid\n  };\n\n  const api = {\n    list: () => Object.keys(scenarios),\n    run: (name) => {\n      if (!scenarios[name]) { console.warn('[MSD Scenario] Unknown', name); return null; }\n      try {\n        const r = scenarios[name]();\n        log(name, r);\n        return r;\n      } catch(e) {\n        const r = { ok:false, details:String(e) };\n        log(name, r);\n        return r;\n      }\n    },\n    runAll: () => {\n      const results = {};\n      for (const k of Object.keys(scenarios)) results[k] = api.run(k);\n      const summaryOk = Object.values(results).every(r => r && r.ok);\n      console.log('[MSD Scenario] Summary:', summaryOk?'ALL PASS':'FAILURES', results);\n      return results;\n    }\n  };\n\n  W.__msdScenarios.routing = api;\n  console.info('[MSD v1] Routing scenario harness installed. Use: window.__msdScenarios.routing.list()');\n})();\n","/* MSD Smart Routing Scenario Harness (Wave 5 - M5.3)\n * Usage:\n *   window.__msdScenarios.smart.list()\n *   window.__msdScenarios.smart.run('smart_vs_grid_cost')\n *   window.__msdScenarios.smart.runAll()\n */\n\n(function initSmartRoutingHarness(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi() {\n    const p = W.__msdDebug?.pipelineInstance;\n    if (!p || p.enabled === false) throw new Error('Pipeline disabled or missing.');\n    return p;\n  }\n  function inspect(id) { return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(scope='*'){ W.__msdDebug?.routing?.invalidate(scope); }\n\n  function withMode(id, modeFull, fn) {\n    const model = W.__msdDebug?.lastRenderModel;\n    const ov = model?.overlays?.find(o=>o.id===id);\n    if (!ov) throw new Error('overlay not found: '+id);\n    ov._raw = ov._raw || {};\n    const orig = ov._raw.route_mode_full;\n    ov._raw.route_mode_full = modeFull;\n    try {\n      invalidate('*');\n      return fn();\n    } finally {\n      ov._raw.route_mode_full = orig;\n      invalidate('*');\n    }\n  }\n\n  // NEW: helper to set mode without auto-restore (caller restores after use)\n  function setMode(id, modeFull) {\n    const model = W.__msdDebug?.lastRenderModel;\n    const ov = model?.overlays?.find(o=>o.id===id);\n    if (!ov) throw new Error('overlay not found: '+id);\n    ov._raw = ov._raw || {};\n    ov._raw.route_mode_full = modeFull;\n  }\n\n  function scenarioSmartVsGridCost() {\n    // Reuse a grid candidate overlay id\n    const id = 'line_grid_forced';\n    const grid = withMode(id, 'grid', ()=>inspect(id));\n    const smart = withMode(id, 'smart', ()=>inspect(id));\n    const ok = !!grid && !!smart && smart.meta.strategy === 'smart' && smart.meta.cost <= grid.meta.cost + 40;\n    return { ok, details: { gridCost: grid?.meta.cost, smartCost: smart?.meta.cost } };\n  }\n\n  function scenarioSmartRefinementAttempt() {\n    const id = 'line_grid_forced';\n    const smart = withMode(id, 'smart', ()=>inspect(id));\n    const smartMeta = smart?.meta?.smart;\n    const ok = !!smartMeta && smartMeta.detoursTried >= 0; // Accept even zero (no need for forced detour)\n    return { ok, details: smartMeta };\n  }\n\n  function scenarioSmartPenaltyReduction() {\n    const id = 'line_smart_blocked';\n    const baseSmart = withMode(id, 'smart', ()=>inspect(id));\n    const meta = baseSmart?.meta;\n    if (!meta?.smart) return { ok:false, details:'no smart meta' };\n    const ok = meta.smart.penaltyAfter <= meta.smart.penaltyBefore;\n    return { ok, details: meta.smart };\n  }\n\n  // REPLACE scenarioSmartCacheBehavior implementation\n  function scenarioSmartCacheBehavior() {\n    const id = 'line_smart_forced_xy';\n    const model = W.__msdDebug?.lastRenderModel;\n    const ov = model?.overlays?.find(o=>o.id===id);\n    if (!ov) return { ok:false, details:'overlay not found' };\n    ov._raw = ov._raw || {};\n    const original = ov._raw.route_mode_full;\n\n    try {\n      setMode(id, 'smart');\n      invalidate('*');\n      const first = inspect(id);        // expect miss\n      const second = inspect(id);       // expect hit (same mode & unchanged env)\n      const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true;\n      return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit } };\n    } catch(e) {\n      return { ok:false, details:String(e) };\n    } finally {\n      ov._raw.route_mode_full = original;\n      invalidate('*');\n    }\n  }\n\n  const scenarios = {\n    smart_vs_grid_cost: scenarioSmartVsGridCost,\n    smart_refinement_attempt: scenarioSmartRefinementAttempt,\n    smart_penalty_reduction: scenarioSmartPenaltyReduction,\n    smart_cache_behavior: scenarioSmartCacheBehavior\n  };\n\n  const api = {\n    list: ()=>Object.keys(scenarios),\n    run: (name)=>{\n      if (!scenarios[name]) { console.warn('[MSD Smart Scenario] Unknown', name); return null; }\n      try {\n        const r = scenarios[name]();\n        console.log(`[MSD Smart Scenario] ${name}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e) {\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Smart Scenario] ${name}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: ()=>{\n      const res = {};\n      for (const k of Object.keys(scenarios)) res[k] = api.run(k);\n      const summaryOk = Object.values(res).every(r => r && r.ok);\n      console.log('[MSD Smart Scenario] Summary:', summaryOk?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.smart = api;\n  console.info('[MSD v1] Smart routing scenario harness installed. Use: window.__msdScenarios.smart.list()');\n})();\n","/* MSD Smoothing Scenario Harness (Wave 5 - M5.6)\n * Usage:\n *   window.__msdScenarios.smoothing.list()\n *   window.__msdScenarios.smoothing.runAll()\n */\n(function initSmoothingScenarios(){\n  if (typeof window === 'undefined') return;\n  const W = window;\n  W.__msdScenarios = W.__msdScenarios || {};\n\n  function pi(){ const p=W.__msdDebug?.pipelineInstance; if(!p||!p.enabled) throw new Error('pipeline disabled'); return p; }\n  function inspect(id){ return W.__msdDebug?.routing?.inspect(id); }\n  function invalidate(){ W.__msdDebug?.routing?.invalidate('*'); }\n\n  const target = 'line_grid_forced';\n\n  function ensureBaseline(){\n    const model = pi().getResolvedModel();\n    const ov = model.overlays.find(o=>o.id===target);\n    if (!ov) throw new Error('overlay not found');\n    ov._raw = ov._raw || {};\n    return ov;\n  }\n\n  function scenarioSmoothingIncreasesPoints(){\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'none';\n    ov._raw.smoothing_iterations = 0;\n    invalidate();\n    const base = inspect(target);\n    ov._raw.smoothing_mode = 'chaikin';\n    ov._raw.smoothing_iterations = 2;\n    invalidate();\n    const sm = inspect(target);\n    // restore\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    const ok = !!base && !!sm && sm.pts.length > base.pts.length && sm.meta.smooth;\n    return { ok, details: { basePts: base?.pts.length, smoothPts: sm?.pts.length, meta: sm?.meta?.smooth } };\n  }\n\n  function scenarioCacheHit(){\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'chaikin';\n    ov._raw.smoothing_iterations = 1;\n    invalidate();\n    const first = inspect(target);\n    const second = inspect(target);\n    // restore\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    const ok = !!first && !!second && first.meta.cache_hit === false && second.meta.cache_hit === true;\n    return { ok, details: { firstHit: first?.meta.cache_hit, secondHit: second?.meta.cache_hit } };\n  }\n\n  function scenarioDisableNoSmoothMeta(){\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'none';\n    ov._raw.smoothing_iterations = 0;\n    invalidate();\n    const res = inspect(target);\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    const ok = !!res && !res.meta.smooth;\n    return { ok, details: { hasSmoothMeta: !!res.meta.smooth } };\n  }\n\n  function scenarioInvalidModeFallback() {\n    const ov = ensureBaseline();\n    ov._raw.smoothing_mode = 'bogus_mode';\n    ov._raw.smoothing_iterations = 2;\n    invalidate();\n    const res = inspect(target);\n    delete ov._raw.smoothing_mode;\n    delete ov._raw.smoothing_iterations;\n    invalidate();\n    // Expect no meta.smooth because mode invalid → coerced to none\n    const ok = !!res && !res.meta.smooth;\n    return { ok, details: { hasSmoothMeta: !!res.meta.smooth } };\n  }\n\n  const scenarios = {\n    smoothing_increases_points: scenarioSmoothingIncreasesPoints,\n    smoothing_cache_hit: scenarioCacheHit,\n    smoothing_disabled_no_meta: scenarioDisableNoSmoothMeta,\n    smoothing_invalid_mode_fallback: scenarioInvalidModeFallback   // NEW\n  };\n\n  const api = {\n    list: ()=>Object.keys(scenarios),\n    run: (n)=>{\n      if(!scenarios[n]) { console.warn('[MSD Smooth Scenario] Unknown', n); return null; }\n      try {\n        const r = scenarios[n]();\n        console.log(`[MSD Smooth Scenario] ${n}: ${r.ok?'OK':'FAIL'}`, r);\n        return r;\n      } catch(e){\n        const r = { ok:false, details:String(e) };\n        console.log(`[MSD Smooth Scenario] ${n}: FAIL`, r);\n        return r;\n      }\n    },\n    runAll: ()=>{\n      const res={};\n      for(const k of Object.keys(scenarios)) res[k]=api.run(k);\n      const ok = Object.values(res).every(r=>r && r.ok);\n      console.log('[MSD Smooth Scenario] Summary:', ok?'ALL PASS':'FAILURES', res);\n      return res;\n    }\n  };\n\n  W.__msdScenarios.smoothing = api;\n  console.info('[MSD v1] Smoothing scenario harness installed. Use: window.__msdScenarios.smoothing.list()');\n})();\n","import { cblcarsLog } from './cb-lcars-logging.js';\nimport { animPresets } from './cb-lcars-anim-presets.js';\n\n/**\n * Waits for an element to be present in the DOM.\n * @param {string} selector - The CSS selector for the element.\n * @param {Element|Document} root - The root element to search within.\n * @param {number} timeout - The maximum time to wait in milliseconds.\n * @returns {Promise<Element>}\n */\nexport function waitForElement(selector, root = document, timeout = 2000) {\n  return new Promise((resolve, reject) => {\n    const found = root.querySelector(selector);\n    if (found) return resolve(found);\n\n    const observer = new MutationObserver(() => {\n      const el = root.querySelector(selector);\n      if (el) {\n        try { observer.disconnect(); } catch(_) {}\n        clearTimeout(to);\n        resolve(el);\n      }\n    });\n    observer.observe(root, { childList: true, subtree: true });\n\n    const to = setTimeout(() => {\n      try { observer.disconnect(); } catch(_) {}\n      reject(new Error(`[CB-LCARS] Timeout waiting for element: ${selector}`));\n    }, timeout);\n  });\n}\n\n/**\n * Resolves one or many targets into an array of Elements.\n * Enhancements:\n * - Supports comma-separated selector strings: \"#a, .b, svg path\"\n * - Expands NodeList/HTMLCollection into elements\n * - For selector strings, resolves first match by waiting, and also includes any currently matching additional elements\n * @param {string|Element|Array<string|Element>|NodeList|HTMLCollection} targets\n * @param {Element|Document} root\n * @param {number} timeout\n * @returns {Promise<Element[]>}\n */\nexport async function waitForElements(targets, root = document, timeout = 2000) {\n  const toArray = (v) => Array.isArray(v)\n    ? v\n    : (v && typeof v.length === 'number' && typeof v.item === 'function')\n      ? Array.from(v) // NodeList/HTMLCollection\n      : [v];\n\n  const items = toArray(targets).filter(Boolean);\n  const results = [];\n\n  for (const item of items) {\n    try {\n      if (item instanceof Element) {\n        results.push(item);\n        continue;\n      }\n\n      if (typeof item === 'string') {\n        // Split comma-separated selector lists\n        const selectors = item.split(',').map(s => s.trim()).filter(Boolean);\n        for (const sel of selectors) {\n          // Wait for first appearance of this selector\n          const first = await waitForElement(sel, root, timeout);\n          if (first) results.push(first);\n          // Also include any additional matches that are already present\n          const allNow = root.querySelectorAll(sel);\n          for (const el of Array.from(allNow)) {\n            if (!results.includes(el)) results.push(el);\n          }\n        }\n        continue;\n      }\n\n      cblcarsLog.warn('[waitForElements] Unsupported target type, skipping.', { item });\n    } catch (e) {\n      cblcarsLog.error('[waitForElements] Failed to resolve target:', { item, error: e });\n    }\n  }\n  return results;\n}\n\n/**\n * A generic wrapper for anime.js that resolves targets within a given root element.\n * If scopeId is provided, add the animation to the scope.\n * @param {object} options - The anime.js animation options.\n * @param {string|Element|Array} options.targets - Selector(s) or element(s).\n * @param {Element} [options.root=document] - The root element for the selector query.\n * @param {string} [options.scopeId] - The scope ID to use.\n */\nexport async function animateWithRoot(options) {\n  const { targets, root = document, scopeId, ...animOptions } = options;\n  if (!targets) {\n    cblcarsLog.warn('[animateWithRoot] Animation missing targets.', { options });\n    return;\n  }\n  try {\n    const elements = await waitForElements(targets, root);\n    if (elements.length === 0) {\n      cblcarsLog.warn('[animateWithRoot] No targets resolved.', { targets });\n      return;\n    }\n\n    for (const element of elements) {\n      try {\n        let animation;\n        if (scopeId && window.cblcars.anim.scopes.has(scopeId)) {\n          const scopeObj = window.cblcars.anim.scopes.get(scopeId);\n          animation = window.cblcars.anime(element, { ...animOptions, scope: scopeObj.scope });\n          scopeObj.addAnimation(animation);\n        } else {\n          animation = window.cblcars.anime(element, animOptions);\n        }\n      } catch (e) {\n        cblcarsLog.error('[animateWithRoot] Failed to animate a resolved element.', { element: element?.id, error: e });\n      }\n    }\n  } catch (error) {\n    cblcarsLog.error('[animateWithRoot] Failed to animate element(s):', { targets, error });\n  }\n}\n\n/**\n * Animates element(s) using anime.js with special handling for SVG animations.\n * Unchanged behavior, v4-native through window.cblcars.anim.anime\n */\nexport async function animateElement(scope, options, hass = null) {\n  const { type, targets, root = document, ...animOptions } = options;\n  if (!type || !targets || !scope) {\n    cblcarsLog.warn('[animateElement] Animation missing type, targets, or scope.', { options, scope });\n    return;\n  }\n  cblcarsLog.debug('[animateElement] Received options:', { options });\n\n  scope.scope.add(async () => {\n    try {\n      const elements = await waitForElements(targets, root);\n      if (!elements || elements.length === 0) {\n        cblcarsLog.error('[animateElement] Target element(s) not found:', { targets });\n        return;\n      }\n\n      for (const element of elements) {\n        const params = {\n          duration: 1000,\n          easing: 'easeInOutQuad',\n          ...animOptions,\n        };\n\n        // state_resolver hook (left as-is)\n        if (options.state_resolver && options.entity && window.cblcars.styleHelpers?.resolveStateStyles) {\n          const resolvedStyles = window.cblcars.styleHelpers.resolveStateStyles(\n            options.state_resolver,\n            hass,\n            options.entity\n          );\n          Object.assign(params, resolvedStyles);\n        }\n\n        // Apply preset(s)\n        if (Array.isArray(type)) {\n          applyPresets(type, params, element, options);\n        } else {\n          const presetFn = animPresets[String(type).toLowerCase()];\n          if (presetFn) {\n            await presetFn(params, element, options);\n          } else if (String(type).toLowerCase() === 'morph') {\n            if (!options.morph_to_selector) {\n              cblcarsLog.error('[animateElement] morph animation requires a `morph_to_selector`.', { options });\n              continue;\n            }\n            const morphTarget = await waitForElement(options.morph_to_selector, root);\n            if (!morphTarget) {\n              cblcarsLog.error(`[animateElement] morph could not find target shape for selector: ${options.morph_to_selector}`);\n              continue;\n            }\n            const precision = options.precision ? parseInt(options.precision, 10) : undefined;\n            Object.assign(params, { d: window.cblcars.animejs.svg.morphTo(morphTarget, precision) });\n          } else {\n            cblcarsLog.debug(`[animateElement] Using standard animation for type: ${type}`, { params });\n          }\n        }\n\n        // Skip if preset handled via CSS or nulled targets\n        if (params._cssAnimation || params.targets === null) {\n          continue;\n        }\n\n        window.cblcars.anim.anime(element, params);\n        cblcarsLog.debug(`[animateElement] Animation constructor added to scope: ${scope.id}`, { params, element: element.id });\n      }\n    } catch (error) {\n      cblcarsLog.error('[animateElement] Failed to animate element(s):', { targets, type, error });\n    }\n  });\n}\n\n\n/**\n * v4: Create a single timeline from an array of steps.\n * Uses createTimeline consistently and add(targets, vars, offset).\n * @param {Array} timelineConfig - [{ targets, ...vars, offset? }]\n * @param {string} scopeId\n * @param {Element|Document} root\n */\nexport async function createTimeline(timelineConfig, scopeId, root = document) {\n  const scopeObj = window.cblcars.anim.scopes.get(scopeId);\n  const timeline = window.cblcars.anim.animejs.createTimeline({ scope: scopeObj?.scope });\n\n  if (!Array.isArray(timelineConfig)) return timeline;\n\n  for (const step of timelineConfig) {\n    const { targets, offset, ...vars } = step || {};\n    if (!targets) continue;\n    const element = await window.cblcars.anim.waitForElement(targets, root);\n    if (!element) continue;\n    timeline.add(element, vars, offset);\n  }\n  if (scopeObj) scopeObj.addAnimation?.(timeline);\n  return timeline;\n}\n\n/**\n * Creates multiple anime.js timelines from a config object, supporting global params and step merging.\n * Enhancements:\n * - Supports step.state_resolver using variables.msd.presets (stylePresets).\n * - Only strips 'direction' (v4 removed); keeps 'alternate' and 'loop'.\n * - Respects autoplay: does not force timeline.play() when autoplay === false.\n * - Marks preset calls with __timeline for timeline-friendly behavior.\n *\n * @param {object} timelinesConfig\n * @param {string} scopeId\n * @param {Element|Document} root\n * @param {object} overlayConfigs\n * @param {object|null} hass\n * @param {object} stylePresets - variables.msd.presets\n * @returns {Promise<object>} timelines by name\n */\nexport async function createTimelines(\n  timelinesConfig,\n  scopeId,\n  root = document,\n  overlayConfigs = {},\n  hass = null,\n  stylePresets = {}\n) {\n  const scopeObj = window.cblcars.anim.scopes.get(scopeId);\n  if (!scopeObj) {\n    cblcarsLog.error('[createTimelines] Scope not found:', scopeId);\n    return {};\n  }\n  const timelines = {};\n  const resolveAll = window.cblcars.styleHelpers?.resolveAllDynamicValues;\n\n  for (const [timelineName, timelineConfig] of Object.entries(timelinesConfig || {})) {\n    const { steps, ...timelineGlobals } = timelineConfig || {};\n    const resolvedGlobals = resolveAll ? resolveAll(timelineGlobals, hass) : timelineGlobals;\n\n    const timeline = window.cblcars.anim.animejs.createTimeline({\n      scope: scopeObj.scope,\n      ...resolvedGlobals\n    });\n\n    if (!steps || !Array.isArray(steps)) {\n      cblcarsLog.warn(`[createTimelines] Timeline \"${timelineName}\" has no steps array.`);\n      timelines[timelineName] = timeline;\n      continue;\n    }\n\n    for (const step of steps) {\n      let elements = [];\n      try {\n        elements = await waitForElements(step.targets, root);\n      } catch (error) {\n        cblcarsLog.error(`[createTimelines] Failed to find target(s) for \"${timelineName}\":`, { targets: step.targets, error });\n        continue;\n      }\n      if (!elements || elements.length === 0) {\n        cblcarsLog.warn(`[createTimelines] No elements found for timeline \"${timelineName}\" step:`, { targets: step.targets });\n        continue;\n      }\n\n      for (const element of elements) {\n        const elementAnim = overlayConfigs?.[element.id]?.animation || {};\n        let mergedParams = { ...elementAnim, ...resolvedGlobals, ...step };\n\n        // State resolver on steps\n        if (step?.state_resolver && window.cblcars.styleHelpers?.resolveStatePreset) {\n          try {\n            const overrides = window.cblcars.styleHelpers.resolveStatePreset(\n              { state_resolver: step.state_resolver, entity: step.entity, attribute: step.attribute },\n              stylePresets,\n              hass\n            );\n            if (overrides && typeof overrides === 'object') {\n              if (overrides.animation && typeof overrides.animation === 'object') {\n                mergedParams = { ...mergedParams, ...overrides.animation };\n              } else {\n                mergedParams = { ...mergedParams, ...overrides };\n              }\n            }\n          } catch (e) {\n            cblcarsLog.warn('[createTimelines] step.state_resolver failed', { timelineName, step, error: e });\n          }\n        }\n\n        // Resolve dynamic values\n        mergedParams = resolveAll ? resolveAll(mergedParams, hass) : mergedParams;\n\n        // Defaults for text transforms in some presets\n        if (\n          (mergedParams.type === 'pulse' || mergedParams.type === 'glow') &&\n          (element.tagName === 'text' || element.tagName === 'TEXT')\n        ) {\n          element.style.transformOrigin = 'center';\n          element.style.transformBox = 'fill-box';\n        }\n\n        // Apply preset, marking timeline context\n        if (mergedParams.type && animPresets[mergedParams.type]) {\n          mergedParams.__timeline = true;\n          await animPresets[mergedParams.type](mergedParams, element, mergedParams);\n        }\n\n        // Strip non-anime keys\n        const {\n          targets, offset, direction,\n          state_resolver, preset, entity, attribute, __timeline,\n          // NEW: strip these flags from anime params\n          deep, descendants, apply_to,\n          ...animeParams\n        } = mergedParams;\n\n        // Determine whether to apply immediate props to descendants\n        const applyToDescendants =\n          mergedParams.descendants === true ||\n          mergedParams.deep === true ||\n          mergedParams.apply_to === 'descendants';\n\n        // Ensure non-animated properties are applied at the step start\n        const immediateKeys = ['fill', 'stroke', 'stroke-width', 'filter', 'color', 'opacity'];\n        const immediateSet = {};\n        for (const k of immediateKeys) {\n          if (animeParams[k] !== undefined && !Array.isArray(animeParams[k]) && typeof animeParams[k] !== 'object') {\n            immediateSet[k] = animeParams[k];\n          }\n        }\n        if (Object.keys(immediateSet).length) {\n          const userOnBegin = animeParams.onBegin;\n          animeParams.onBegin = () => {\n            try {\n              const nodes = applyToDescendants ? element.querySelectorAll('*') : [element];\n              if (window.cblcars?.anim?.utils?.set) {\n                nodes.forEach((n) => window.cblcars.anim.utils.set(n, immediateSet));\n              } else {\n                nodes.forEach((n) => {\n                  for (const [prop, val] of Object.entries(immediateSet)) {\n                    if (prop in n.style) n.style[prop] = val;\n                    else n.setAttribute(prop, val);\n                  }\n                });\n              }\n            } catch (_) {}\n            if (typeof userOnBegin === 'function') userOnBegin();\n          };\n        }\n\n        // v4 add(targets, vars, offset)\n        timeline.add(element, animeParams, offset);\n      }\n    }\n\n    if (typeof scopeObj.addAnimation === 'function') {\n      scopeObj.addAnimation(timeline);\n    }\n    timelines[timelineName] = timeline;\n\n    if (resolvedGlobals?.autoplay === false) {\n      cblcarsLog.info(`[createTimelines] Timeline \"${timelineName}\" created with autoplay: false.`);\n    }\n  }\n  return timelines;\n}\n\n/**\n * Applies one or more animation presets to the anime.js params object.\n */\nexport function applyPresets(types, params, element, options) {\n  const presetList = Array.isArray(types) ? types : [types];\n  for (const type of presetList) {\n    const presetFn = animPresets[type.toLowerCase()];\n    if (presetFn) {\n      presetFn(params, element, options?.[type] || options);\n    }\n  }\n}\n\n\n","import { cblcarsLog } from './cb-lcars-logging.js';\nimport * as svgHelpers from './cb-lcars-svg-helpers.js';\n\n// legacy - svg errors logged to overlay need to be ported to v1 style\n//import { svgOverlayManager } from './cb-lcars-overlay-helpers.js';\n\n/**\n * Utility: test if a path 'd' string has drawable geometry beyond a single move.\n */\nfunction hasUsablePathD(d) {\n  if (!d || typeof d !== 'string') return false;\n  // Must contain at least one command beyond the initial M (e.g., L,C,Q,A,Z)\n  return /[MLCQAHVZmlcqahvz].*[MLCQAHVZmlcqahvz]/.test(d) || /[LCAHVQZlca hvqz]/.test(d);\n}\n\nexport const animPresets = {\n    /**\n     * @preset draw\n     * Animates the drawing of an SVG path.\n     * @param {object} params - Anime.js v4 params object.\n     * @param {Element} element - SVG path element.\n     * @param {object} options - Animation config.\n     */\n    draw: (params, element, options = {}) => {\n        // Use animejs v4 createDrawable for robust SVG path drawing\n        const [drawable] = window.cblcars.animejs.svg.createDrawable(element);\n\n        // Standard anime.js options\n        const duration = params.duration ?? options.duration ?? 1200;\n        const easing = params.easing ?? options.easing ?? 'easeInOutSine';\n        const loop = params.loop ?? options.loop ?? false;\n        const alternate = params.alternate ?? options.alternate ?? false;\n\n        // Draw-specific config: prefer params.draw, then options.draw, then default\n        const drawCfg = params.draw || options.draw || {};\n        let drawValues;\n        if (Array.isArray(drawCfg)) {\n            drawValues = drawCfg;\n        } else if (drawCfg && Array.isArray(drawCfg.values)) {\n            drawValues = drawCfg.values;\n        } else {\n            drawValues = ['0 0', '0 1'];\n        }\n\n        // Set the anime.js params for draw animation\n        Object.assign(params, {\n            targets: drawable,\n            draw: drawValues,\n            duration,\n            easing,\n            loop,\n            alternate\n        });\n\n        // Remove any conflicting opacity/stroke-width from params\n        delete params.opacity;\n        delete params['stroke-width'];\n    },\n    /* //stutters on loop with anime.js .. use css version for now\n    march: (params, element, options) => {\n        const dashArray = element.getAttribute('stroke-dasharray');\n        if (!dashArray || dashArray === 'none') return;\n        const patternLength = dashArray.split(/[\\s,]+/).reduce((acc, len) => acc + parseFloat(len), 0);\n        if (patternLength === 0) return;\n        element.style.strokeDashoffset = '0';\n        const endValue = params.direction === 'reverse' ? patternLength : -patternLength;\n        Object.assign(params, {\n            strokeDashoffset: [0, endValue],\n        });\n        if (params.loop === undefined) params.loop = true;\n        if (params.easing === 'easeInOutQuad') params.easing = 'linear';\n    },\n    fade: (params) => {\n        Object.assign(params, { opacity: [0, 1] });\n    },\n    */\n    /**\n     * @preset pulse\n     * Pulses scale and opacity for a \"breathing\" effect (text), or stroke-width and opacity for lines.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    pulse: (params, element, options = {}) => {\n        cblcarsLog.debug('[pulse preset] Before mutation:', { params, element, options });\n\n        // Prefer pulse config from params.pulse, then options.pulse, then options, then defaults\n        const pulseCfg = params.pulse || options.pulse || options || {};\n        const maxScale = pulseCfg.max_scale !== undefined\n            ? pulseCfg.max_scale\n            : (element.tagName === 'text' || element.tagName === 'TEXT' ? 1.1 : 1.5);\n        const minOpacity = pulseCfg.min_opacity !== undefined\n            ? pulseCfg.min_opacity\n            : 0.7;\n\n        // Remove any previous stroke-width/opacity assignments to avoid conflicts\n        delete params['stroke-width'];\n        delete params.opacity;\n\n        // Generic anime.js options from main animation key\n        const duration = params.duration ?? options.duration ?? 1200;\n        const easing = params.easing ?? options.easing ?? 'easeInOutSine';\n        const loop = params.loop ?? options.loop ?? true;\n        const alternate = params.alternate ?? options.alternate ?? true;\n\n        if (element.tagName === 'text' || element.tagName === 'TEXT') {\n            Object.assign(params, {\n                scale: [1, maxScale],\n                opacity: [1, minOpacity],\n                easing,\n                duration,\n                loop,\n                alternate\n            });\n            element.style.transformOrigin = 'center';\n            element.style.transformBox = 'fill-box';\n            cblcarsLog.debug('[pulse preset] Set transformOrigin/transformBox for text:', {\n                id: element.id,\n                style: element.style.cssText\n            });\n        } else if (element.hasAttribute('stroke-width')) {\n            // Pulse lines: animate stroke-width and opacity\n            const width = parseFloat(element.getAttribute('stroke-width')) || 4;\n            Object.assign(params, {\n                'stroke-width': [width, width * maxScale],\n                opacity: [1, minOpacity],\n                easing,\n                duration,\n                loop,\n                alternate\n            });\n            cblcarsLog.debug('[pulse preset] Pulsing line:', {\n                id: element.id,\n                strokeWidth: width,\n                maxScale\n            });\n        } else {\n            // Fallback: just animate opacity\n            Object.assign(params, {\n                opacity: [1, minOpacity],\n                easing,\n                duration,\n                loop,\n                alternate\n            });\n        }\n        cblcarsLog.debug('[pulse preset] After mutation:', { params, element });\n    },\n    /**\n     * @preset blink\n     * Blinks opacity between two values.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    blink: (params, element, options) => {\n        Object.assign(params, {\n            opacity: [options.max_opacity ?? 1, options.min_opacity ?? 0.3],\n            alternate: true,\n            loop: true,\n            easing: options.easing || 'linear', // or 'easeInOutSine'\n            duration: options.duration ?? 1200\n        });\n    },\n\n    fade: (params, element, options = {}) => {\n    const duration = params.duration ?? options.duration ?? 1000;\n    const easing = params.easing ?? options.easing ?? 'linear';\n    const loop = params.loop ?? options.loop ?? false;\n    const alternate = params.alternate ?? options.alternate ?? false;\n    Object.assign(params, {\n        opacity: [0, 1],\n        duration,\n        easing,\n        loop,\n        alternate\n    });\n    },\n\n    /**\n     * @preset motionpath\n     * Animates a tracer along a path, with optional trail.\n     * Contract:\n     *  - tracer is required; if missing, the preset aborts and surfaces an overlay error.\n     *  - Waits until the target <path> has a valid 'd' before building transforms.\n     *  - If the path has data-cblcars-pending=\"true\" (sparkline baseline), trail is hidden until real data arrives.\n     *  - Listens for 'd' and 'data-cblcars-pending' changes, re-binding tracer and syncing trail as the path updates.\n     *\n     * Anime.js v4 notes:\n     *  - Use window.cblcars.anim.anime(targets, vars)\n     *  - Use window.cblcars.animejs.svg.createMotionPath(pathEl) → { translateX, translateY, rotate }\n     *  - Use window.cblcars.animejs.svg.createDrawable(pathEl) for draw animations\n     *\n     * Required external helpers (already in this project):\n     *  - window.cblcars.waitForElement(selector, root)\n     *  - svgOverlayManager.push(msg) for user-visible overlay errors\n     */\n\n\n    /**\n     * @preset motionpath  (UPDATED MOTIONPATH PRESET – Option D)\n     * Robust wait for usable path + pending flag, tracer & trail support, auto rebind.\n     */\n    motionpath: async function motionpathPreset(params, element, options = {}) {\n        try {\n            const root = options.root ?? document;\n\n            // Provide waitForElement alias if missing\n            if (!window.cblcars.waitForElement && window.cblcars.anim?.waitForElement) {\n                window.cblcars.waitForElement = window.cblcars.anim.waitForElement;\n            }\n\n            const tracerCfg = options.tracer;\n            if (!tracerCfg) {\n                const msg = '[motionpath] tracer is required';\n                cblcarsLog.warn(msg, { element });\n                //svgOverlayManager.push(msg);\n                params.targets = null;\n                return;\n            }\n\n            const pathSelector = options.path_selector;\n            let pathEl = pathSelector\n                ? (await window.cblcars.waitForElement(pathSelector, root).catch(() => null))\n                : element;\n\n            if (!pathEl) {\n                const errorMsg = `Motionpath: path not found for selector \"${pathSelector || '(self)'}\"`;\n                cblcarsLog.error(errorMsg);\n                //svgOverlayManager.push(errorMsg);\n                params.targets = null;\n                return;\n            }\n            if (String(pathEl.tagName).toLowerCase() !== 'path') {\n                const msg = '[motionpath] Target is not an SVG <path>';\n                cblcarsLog.warn(msg, { id: pathEl.id });\n                //svgOverlayManager.push(msg);\n                params.targets = null;\n                return;\n            }\n\n            const baseId = pathEl.id || 'msd_path';\n\n            // Helper: determine if path 'd' is actually usable (not just single move or zero length)\n            const hasUsablePathD = (p) => {\n                if (!p || typeof p !== 'string') return false;\n                // Require at least one command beyond initial M and a second coordinate\n                // Simpler: must contain an 'L','C','Q','A','H','V','Z' (besides the opening M)\n                return /[LCHQAVZlchqavz]/.test(p);\n            };\n            const pathLengthOk = (el) => {\n                try {\n                    return el.getTotalLength() > 0.5;\n                } catch (_) {\n                    return false;\n                }\n            };\n            const isPending = (el) => el?.getAttribute('data-cblcars-pending') === 'true';\n\n            const cleanupArtifacts = () => {\n                const svgRoot = pathEl.ownerSVGElement || pathEl.closest('svg') || root;\n                if (!svgRoot) return;\n                const priorTracer = svgRoot.querySelector(`#${baseId}_tracer[data-cblcars-owned=\"motionpath\"]`);\n                const priorTrail = svgRoot.querySelector(`#${baseId}_trail[data-cblcars-owned=\"motionpath\"]`);\n                if (priorTracer?.parentNode) priorTracer.parentNode.removeChild(priorTracer);\n                if (priorTrail?.parentNode) priorTrail.parentNode.removeChild(priorTrail);\n            };\n\n            let trailPath = null;\n            let tracerNode = null;\n            let pathMutationObserver = null;\n            let alive = true;\n\n            // Build trail (draw effect) if configured\n            const buildTrail = () => {\n                const trailOpt = options.trail;\n                if (!trailOpt) return;\n                try {\n                    trailPath = pathEl.cloneNode(true);\n                    trailPath.id = `${baseId}_trail`;\n                    trailPath.setAttribute('data-cblcars-owned', 'motionpath');\n                    const stroke = trailOpt.stroke || pathEl.getAttribute('stroke') || 'var(--lcars-yellow)';\n                    const sw = trailOpt['stroke-width']\n                        ?? options['stroke-width']\n                        ?? pathEl.getAttribute('stroke-width')\n                        ?? 4;\n                    trailPath.setAttribute('stroke', stroke);\n                    trailPath.setAttribute('stroke-width', sw);\n                    if (trailOpt.opacity !== undefined) trailPath.setAttribute('opacity', trailOpt.opacity);\n\n                    const mode = trailOpt.mode || 'overlay';\n                    if (mode === 'single') {\n                        pathEl.setAttribute('opacity', '0');\n                        pathEl.setAttribute('stroke', 'none');\n                    }\n                    if (isPending(pathEl)) {\n                        trailPath.setAttribute('visibility', 'hidden');\n                    }\n\n                    pathEl.parentNode.insertBefore(trailPath, pathEl.nextSibling);\n\n                    const [drawable] = window.cblcars.animejs.svg.createDrawable(trailPath);\n                    const trailVars = {\n                        draw: '0 1',\n                        duration: trailOpt.duration ?? params.duration ?? 1000,\n                        easing: trailOpt.easing ?? params.easing ?? 'linear',\n                        loop: trailOpt.loop ?? params.loop ?? true\n                    };\n                    window.cblcars.anim.anime(drawable, trailVars);\n                } catch (e) {\n                    cblcarsLog.error('[motionpath] Trail setup failed:', e);\n                }\n            };\n\n            // Build tracer node (circle or rect)\n            const buildTracer = () => {\n                let tid = tracerCfg.id || `${baseId}_tracer`;\n                const svgRoot = pathEl.ownerSVGElement || pathEl.closest('svg') || pathEl.parentNode;\n                const existing = svgRoot ? svgRoot.getElementById?.(tid) : null;\n                if (existing && existing.getAttribute('data-cblcars-owned') !== 'motionpath') {\n                    tid = `${tid}_mptrc`;\n                }\n\n                let tracerMarkup;\n                if (tracerCfg.shape === 'rect') {\n                    tracerMarkup = svgHelpers.drawRect({\n                        x: -((tracerCfg.width || 8) / 2),\n                        y: -((tracerCfg.height || 8) / 2),\n                        width: tracerCfg.width || 8,\n                        height: tracerCfg.height || 8,\n                        id: tid,\n                        attrs: { fill: tracerCfg.fill || 'var(--lcars-orange)' },\n                        style: tracerCfg.style || {}\n                    });\n                } else {\n                    tracerMarkup = svgHelpers.drawCircle({\n                        cx: 0,\n                        cy: 0,\n                        r: tracerCfg.r || 4,\n                        id: tid,\n                        attrs: { fill: tracerCfg.fill || 'var(--lcars-orange)' },\n                        style: tracerCfg.style || {}\n                    });\n                }\n                const temp = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n                temp.innerHTML = tracerMarkup;\n                tracerNode = temp.firstElementChild;\n                tracerNode.setAttribute('data-cblcars-owned', 'motionpath');\n                (svgRoot || pathEl.parentNode).appendChild(tracerNode);\n            };\n\n            const bindTracerAnimation = () => {\n                if (!tracerNode || !pathEl) return;\n                const { translateX, translateY, rotate } = window.cblcars.animejs.svg.createMotionPath(pathEl);\n\n                const exclude = new Set([\n                    'tracer', 'trail', 'path_selector', 'root', 'targets', 'type', 'animation',\n                    'stroke', 'stroke-width', 'corner_style', 'corner_radius', 'waypoints',\n                    'steps', 'rounded', 'smooth', 'smooth_tension', 'id'\n                ]);\n                const merged = {};\n                Object.entries({ ...params, ...options }).forEach(([k, v]) => {\n                    if (!exclude.has(k)) merged[k] = v;\n                });\n\n                try {\n                    if (tracerNode.__cblcars_motion && typeof tracerNode.__cblcars_motion.pause === 'function') {\n                        tracerNode.__cblcars_motion.pause();\n                    }\n                } catch (_) {}\n\n                tracerNode.__cblcars_motion = window.cblcars.anim.anime(tracerNode, {\n                    ...merged,\n                    translateX,\n                    translateY,\n                    rotate\n                });\n            };\n\n            const rebindAll = (reason = '') => {\n                try {\n                    if (!hasUsablePathD(pathEl.getAttribute('d')) || !pathLengthOk(pathEl)) {\n                        return;\n                    }\n                    if (trailPath) {\n                        trailPath.setAttribute('d', pathEl.getAttribute('d') || '');\n                        if (isPending(pathEl)) {\n                            trailPath.setAttribute('visibility', 'hidden');\n                        } else {\n                            trailPath.removeAttribute('visibility');\n                        }\n                    }\n                    bindTracerAnimation();\n                } catch (e) {\n                    cblcarsLog.warn('[motionpath] rebind failed', { reason, e });\n                }\n            };\n\n            const initArtifacts = () => {\n                buildTrail();\n                buildTracer();\n                rebindAll('initial');\n            };\n\n            // Robust wait logic\n            const waitMaxMs = Number.isFinite(options.wait_max_ms) ? options.wait_max_ms : 12000;\n            const pollInterval = 120;\n            const startTime = performance.now();\n\n            const waitForReady = () => new Promise((resolve) => {\n                const tick = () => {\n                    // If path replaced externally, bail (outer loop handles reattach)\n                    if (!alive) return resolve(false);\n\n                    const d = pathEl.getAttribute('d') || '';\n                    const pending = isPending(pathEl);\n                    const usable = hasUsablePathD(d) && pathLengthOk(pathEl);\n\n                    if (!pending && usable) return resolve(true);\n\n                    // Only count timeout time AFTER pending cleared\n                    if (!pending && (performance.now() - startTime) >= waitMaxMs) {\n                        return resolve(false);\n                    }\n                    setTimeout(tick, pollInterval);\n                };\n                tick();\n            });\n\n            // Initial cleanup & wait\n            cleanupArtifacts();\n            const ready = await waitForReady();\n\n            if (!ready) {\n                const msg = `[motionpath] Timed out waiting for usable path geometry (id=${pathEl.id})`;\n                cblcarsLog.warn(msg);\n                //svgOverlayManager.push(msg);\n                params.targets = null;\n                return;\n            }\n\n            initArtifacts();\n\n            // Observe path for d / pending changes\n            try {\n                pathMutationObserver = new MutationObserver((muts) => {\n                    let needs = false;\n                    for (const m of muts) {\n                        if (m.type === 'attributes' &&\n                            (m.attributeName === 'd' || m.attributeName === 'data-cblcars-pending')) {\n                            needs = true;\n                            break;\n                        }\n                    }\n                    if (needs) {\n                        // If pending turned back on, hide trail again\n                        if (trailPath && isPending(pathEl)) {\n                            trailPath.setAttribute('visibility', 'hidden');\n                        }\n                        rebindAll('mutation');\n                    }\n                });\n                pathMutationObserver.observe(pathEl, { attributes: true, attributeFilter: ['d', 'data-cblcars-pending'] });\n            } catch (_) {}\n\n            // Lightweight poll for element replacement\n            const pathId = pathEl.id;\n            const reattachPoll = () => {\n                if (!alive) return;\n                const current = (root.getElementById && root.getElementById(pathId)) || pathEl;\n                if (current !== pathEl && current instanceof SVGPathElement) {\n                    cblcarsLog.debug('[motionpath] Path element replaced; reinitializing', { id: pathId });\n                    try { pathMutationObserver?.disconnect(); } catch (_) {}\n                    pathEl = current;\n                    cleanupArtifacts();\n                    trailPath = null;\n                    tracerNode = null;\n                    // Wait again for readiness of the new path\n                    waitForReady().then((ok) => {\n                        if (ok) {\n                            initArtifacts();\n                            try {\n                                pathMutationObserver = new MutationObserver((muts) => {\n                                    let needs = false;\n                                    for (const m of muts) {\n                                        if (m.type === 'attributes' &&\n                                            (m.attributeName === 'd' || m.attributeName === 'data-cblcars-pending')) {\n                                            needs = true;\n                                            break;\n                                        }\n                                    }\n                                    if (needs) rebindAll('mutation(replaced)');\n                                });\n                                pathMutationObserver.observe(pathEl, { attributes: true, attributeFilter: ['d', 'data-cblcars-pending'] });\n                            } catch (_) {}\n                        }\n                    });\n                }\n                setTimeout(reattachPoll, 2000);\n            };\n            setTimeout(reattachPoll, 2000);\n\n            // Prevent base animateElement from adding another animation\n            params.targets = null;\n\n            // Cleanup hook if needed later\n            element.__cblcars_motionpath_cleanup = () => {\n                alive = false;\n                try { pathMutationObserver?.disconnect(); } catch (_) {}\n                try {\n                    if (tracerNode?.__cblcars_motion?.pause) tracerNode.__cblcars_motion.pause();\n                } catch (_) {}\n                try { cleanupArtifacts(); } catch (_) {}\n            };\n\n        } catch (e) {\n            cblcarsLog.error('[motionpath] Unhandled error', e);\n            //svgOverlayManager.push(`[motionpath] ${e?.message || e}`);\n            params.targets = null;\n        }\n    },\n\n    /**\n     * @preset march\n     * CSS-based marching dashed line animation.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    march: (params, element, options = {}) => {\n        // Get dash pattern from stroke_dasharray\n        let dashArray = params.stroke_dasharray ?? options.stroke_dasharray ?? [25, 15];\n        if (!Array.isArray(dashArray) || dashArray.length < 2) {\n            dashArray = [25, 15];\n        }\n        const [dashLength, gapLength] = dashArray;\n\n        // Set the stroke-dasharray for the dashed pattern\n        element.style.strokeDasharray = `${dashLength} ${gapLength}`;\n        element.style.strokeDashoffset = 0;\n\n        // Apply ststroberoke linecap if specified\n        const linecap = params.stroke_linecap ?? options.stroke_linecap;\n        if (linecap) {\n            element.style.strokeLinecap = linecap;\n        }\n\n        // Calculate cycle length (sum of dash and gap)\n        const cycleLength = dashLength + gapLength;\n\n        // Get animation duration, default to 2s if not specified\n        let duration = params.duration ?? options.duration ?? 2000;\n\n        // Convert to seconds for CSS\n        const durationSec = duration / 1000;\n\n        // Get direction\n        let reversed = params.reversed ?? options.reversed ?? false;\n\n        // Create unique animation name using element id or a random string\n        const animId = element.id || `march_${Math.random().toString(36).substring(2, 9)}`;\n        element.dataset.marchAnimId = animId;\n\n        // Direction: offset moves negative for forward, positive for reverse\n        const offsetTarget = reversed ? cycleLength : -cycleLength;\n\n        // Handle loop parameter (like anime.js)\n        // - true or undefined: infinite loop (CSS: infinite)\n        // - false or 0: no loop (CSS: 1)\n        // - number > 0: specific iteration count\n        let loopValue = params.loop ?? options.loop ?? true;\n        const iterationCount = loopValue === true ? 'infinite' :\n                              (loopValue === false || loopValue === 0) ? '1' :\n                              typeof loopValue === 'number' ? Math.max(1, loopValue) : 'infinite';\n\n        // Find the appropriate document to inject styles into\n        const targetDoc = element.getRootNode();\n        const isInShadowDOM = targetDoc !== document;\n\n        // Apply animation directly to the element via inline style\n        // This avoids Shadow DOM style isolation issues\n        const animationName = `march_${animId}`;\n        const keyframesStr = `@keyframes ${animationName} { to { stroke-dashoffset: ${offsetTarget}px; } }`;\n\n        // Apply animation directly to the element\n        const playbackRate = params.playbackRate ?? options.playbackRate ?? 1;\n        const effectiveDuration = `${durationSec / playbackRate}s`;\n\n        // Set inline styles directly on the element - more reliable across shadow DOM boundaries\n        element.style.animation = `${animationName} ${effectiveDuration} linear ${iterationCount}`;\n\n        // Create keyframes for the animation and inject them\n        if (isInShadowDOM && targetDoc.adoptedStyleSheets) {\n            // Modern Shadow DOM with Constructable Stylesheets\n            try {\n                let styleSheet = Array.from(targetDoc.adoptedStyleSheets)\n                    .find(sheet => sheet.marchAnimations);\n\n                if (!styleSheet) {\n                    styleSheet = new CSSStyleSheet();\n                    styleSheet.marchAnimations = true;\n                    targetDoc.adoptedStyleSheets = [...targetDoc.adoptedStyleSheets, styleSheet];\n                }\n\n                styleSheet.insertRule(keyframesStr, styleSheet.cssRules.length);\n            } catch (e) {\n                cblcarsLog.error('Failed to add CSS animation to Shadow DOM:', e);\n                fallbackStyleInjection();\n            }\n        } else {\n            // Fallback: add <style> element to document/shadowRoot\n            fallbackStyleInjection();\n        }\n\n        function fallbackStyleInjection() {\n            const styleId = 'march-smooth-css-animations';\n            let styleEl = targetDoc.getElementById ? targetDoc.getElementById(styleId) : null;\n\n            if (!styleEl) {\n                styleEl = document.createElement('style');\n                styleEl.id = styleId;\n                const target = isInShadowDOM ? targetDoc : document.head;\n                target.appendChild(styleEl);\n            }\n\n            if (!styleEl.textContent.includes(animationName)) {\n                styleEl.textContent += keyframesStr;\n            }\n        }\n\n        // Fill params with dummy values so anime.js doesn't override our CSS animation\n        Object.assign(params, {\n            _cssAnimation: true, // flag to indicate we're using CSS animation\n            duration: 1,\n            loop: false,\n            autoplay: false\n        });\n    },\n\n    /**\n     * @preset glow\n     * Animates stroke color and drop-shadow for a glowing effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    glow: (params, element, options = {}) => {\n        cblcarsLog.debug('[glow preset] Before mutation:', { params, element, options });\n\n        // Configurable values with defaults\n        const glowCfg = options.glow || {};\n        const color = glowCfg.color || options.color || 'var(--picard-light-blue)';\n        const intensity = glowCfg.intensity ?? options.intensity ?? 0.8;\n        const blurMin = glowCfg.blur_min ?? 0;\n        const blurMax = glowCfg.blur_max ?? 12;\n        const opacityMin = glowCfg.opacity_min ?? 0.4;\n        const opacityMax = glowCfg.opacity_max ?? intensity;\n        const duration = options.duration ?? glowCfg.duration ?? 900;\n        const easing = options.easing ?? glowCfg.easing ?? 'easeInOutSine';\n        const loop = options.loop ?? glowCfg.loop ?? true;\n        const alternate = options.alternate ?? glowCfg.alternate ?? true;\n\n        const glowState = { blur: blurMin, opacity: opacityMin };\n\n        Object.assign(params, {\n            targets: glowState,\n            blur: [blurMin, blurMax, blurMin],\n            opacity: [opacityMin, opacityMax, opacityMin],\n            duration,\n            easing,\n            loop,\n            alternate,\n            onUpdate() {\n                if (element.tagName === 'text' || element.tagName === 'TEXT') {\n                    // For text, animate both blur and opacity\n                    element.style.filter = `drop-shadow(0 0 ${glowState.blur}px ${color}) opacity(${glowState.opacity})`;\n                } else {\n                    // For lines, only animate blur, do not affect element opacity\n                    element.style.filter = `drop-shadow(0 0 ${glowState.blur}px ${color})`;\n                }\n            }\n        });\n        // Remove fill/stroke animation\n        delete params.fill;\n        delete params.stroke;\n        element.style.transformOrigin = 'center';\n        element.style.transformBox = 'fill-box';\n        cblcarsLog.debug('[glow preset] Animating drop-shadow:', { color, intensity, blurMin, blurMax, opacityMin, opacityMax, duration, easing, loop, alternate });\n\n        cblcarsLog.debug('[glow preset] After mutation:', { params, element });\n    },\n\n    /**\n     * @preset shimmer\n     * Animates fill and opacity for a shimmering effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    shimmer: (params, element, options = {}) => {\n        const color = options.color || 'var(--lcars-yellow)';\n        Object.assign(params, {\n            opacity: [1, 0.5, 1],\n            fill: [element.getAttribute('fill') || color, color],\n            alternate: true,\n            loop: true,\n            easing: 'easeInOutSine',\n            duration: options.duration ?? 1200\n        });\n    },\n\n    /**\n     * @preset strobe\n     * Rapidly toggles opacity for a strobe effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    strobe: (params, element, options = {}) => {\n        Object.assign(params, {\n            opacity: [1, 0.1],\n            alternate: true,\n            loop: true,\n            easing: 'steps(2, end)',\n            duration: options.duration ?? 400\n        });\n    },\n\n    /**\n     * @preset cascade\n     * Staggers opacity animation for multiple elements.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    cascade: (params, element, options = {}) => {\n        Object.assign(params, {\n            opacity: [0, 1],\n            delay: window.cblcars.animejs.stagger(options.stagger ?? 100),\n            easing: 'easeOutQuad',\n            duration: options.duration ?? 800\n        });\n    },\n\n    /**\n     * @preset ripple\n     * Animates scale and opacity for a ripple effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    ripple: (params, element, options = {}) => {\n        Object.assign(params, {\n            scale: [1, options.max_scale ?? 2, 1],\n            opacity: [1, 0.3, 1],\n            alternate: true,\n            loop: true,\n            easing: 'easeInOutSine',\n            duration: options.duration ?? 1200\n        });\n    },\n\n    /**\n     * @preset flicker\n     * Randomizes opacity for a flicker effect.\n     * @param {object} params\n     * @param {Element} element\n     * @param {object} options\n     */\n    flicker: (params, element, options = {}) => {\n        Object.assign(params, {\n            opacity: [\n                1,\n                0.7 + Math.random() * 0.3,\n                0.4 + Math.random() * 0.3,\n                1\n            ],\n            //alternate: true,\n            alternate: false,\n            loop: true,\n            easing: 'steps(4, end)',\n            duration: options.duration ?? 600\n        });\n    },\n\n    /**\n     * @preset set\n     * Sets properties/attributes/styles.\n     * Behavior:\n     * - In timeline steps: leave params as-is so anime.js applies them at the step time (no immediate mutation).\n     * - Outside timelines (free/overlay animations): mutate immediately via utils.set() and skip scheduling.\n     */\n    set: (params, element, options = {}) => {\n        // Timeline context: do not immediately set; let the step apply at its offset.\n        if (options && options.__timeline) {\n        return; // no-op; keep params as-is for anime step\n        }\n\n        const ignoreKeys = ['type', 'targets', 'root', 'animation', 'id', 'offset', '__timeline'];\n        const allParams = { ...params, ...options };\n        const propsToSet = {};\n        Object.entries(allParams).forEach(([key, value]) => {\n        if (ignoreKeys.includes(key) || value === undefined) return;\n        propsToSet[key] = value;\n        });\n\n        let animeSetWorked = false;\n        try {\n        if (window.cblcars?.anim?.utils?.set) {\n            window.cblcars.anim.utils.set(element, propsToSet);\n            animeSetWorked = true;\n        }\n        } catch (e) {\n        cblcarsLog.warn('[set preset] animejs.utils.set() failed, will fallback to manual mutation.', { e });\n        }\n\n        if (!animeSetWorked) {\n        for (const [key, value] of Object.entries(propsToSet)) {\n            try {\n            if (key in element.style) {\n                element.style[key] = value;\n            } else {\n                element.setAttribute(key, value);\n            }\n            } catch (e) {\n            cblcarsLog.warn(`[set preset] Could not set \"${key}\"=\"${value}\" manually`, { e });\n            }\n        }\n        }\n\n        // Prevent anime scheduling for non-timeline set\n        params._cssAnimation = true;\n        params.targets = null;\n    },\n\n    // Add more presets as needed...\n};","import * as CBLCARS from '../cb-lcars-vars.js';\n\nlet cblcarsGlobalLogLevel = 'info';\n\nexport function cblcarsSetGlobalLogLevel(level) {\n  cblcarsGlobalLogLevel = level;\n  cblcarsLog.info(`Setting CBLCARS global log level set to: ${level}`, {}, 'info');\n}\nexport function cblcarsGetGlobalLogLevel() {\n  return cblcarsGlobalLogLevel;\n}\n\n// Ensure the cblcars object exists on the window object\nwindow.cblcars = window.cblcars || {};\n// Attach the functions to the cblcars object\nwindow.cblcars.setGlobalLogLevel = cblcarsSetGlobalLogLevel;\nwindow.cblcars.getGlobalLogLevel = cblcarsGetGlobalLogLevel;\n// Add shortcut properties for each log level\n['error', 'warn', 'info', 'debug'].forEach(level => {\n  window.cblcars.setGlobalLogLevel[level] = () => cblcarsSetGlobalLogLevel(level);\n});\n\nexport function baseLogger(level, ...args) {\n  const levels = ['error', 'warn', 'info', 'debug'];\n  const currentLevelIndex = levels.indexOf(cblcarsGlobalLogLevel);\n  const messageLevelIndex = levels.indexOf(level);\n\n  if (messageLevelIndex > currentLevelIndex) return;\n\n  const commonStyles = 'color: white; padding: 1px 4px; border-radius: 15px;';\n  const levelStyles = {\n    info: 'background-color: #37a6d1',\n    warn: 'background-color: #ff6753',\n    error: 'background-color: #ef1d10',\n    debug: 'background-color: #8e44ad',\n    default: 'background-color: #6d748c',\n  };\n\n  const logMessage = `%c    CB-LCARS | ${level} `;\n  const style = `${levelStyles[level] || levelStyles.default}; ${commonStyles}`;\n\n  // Use spread to pass all args after the styled prefix\n  switch (level) {\n    case 'info':\n      console.log(logMessage, style, ...args);\n      break;\n    case 'warn':\n      console.warn(logMessage, style, ...args);\n      break;\n    case 'error':\n      console.error(logMessage, style, ...args);\n      break;\n    case 'debug':\n      console.debug(logMessage, style, ...args);\n      break;\n    default:\n      console.log(logMessage, style, ...args);\n      break;\n  }\n}\n\n/**\n * Centralized CB-LCARS logging utility.\n *\n * Supports log level filtering and styled output.\n * Functions as a drop-in replacement for `console.log`, `console.warn`, etc.\n *\n * **Preferred usage:**\n *   `cblcarsLog.info('message');`\n *   `cblcarsLog.warn('message');`\n *   `cblcarsLog.error('message');`\n *   `cblcarsLog.debug('message');`\n *   `cblcarsLog.log('message');`\n *\n * *Legacy usage (not recommended):*\n *   `cblcarsLog('warn', 'message');`\n *\n * **Log level filtering:**\n *\n *   Only messages at or above the global log level are printed.\n *   For example, if the global log level is 'warn', only 'warn' and 'error' messages are shown.\n *\n * **Setting the global log level:**\n *\n *   Use the function `cblcarsSetGlobalLogLevel(level)`, or\n *   `window.cblcars.setGlobalLogLevel(level)`\n *   Valid levels: `'error'`, `'warn'`, `'info'`, `'debug'`\n *\n * @param {'error'|'warn'|'info'|'debug'} level - The log level.\n * @param {...any} args - Arguments to log.\n * @returns {void}\n *\n * @property {function(...any):void} log   - Log an info-level message.\n * @property {function(...any):void} info  - Log an info-level message.\n * @property {function(...any):void} warn  - Log a warning message.\n * @property {function(...any):void} error - Log an error message.\n * @property {function(...any):void} debug - Log a debug message.\n */\nfunction cblcarsLog(level, ...args) {\n  return baseLogger(level, ...args);\n}\ncblcarsLog.log   = (...args) => baseLogger('info', ...args);\ncblcarsLog.info  = (...args) => baseLogger('info', ...args);\ncblcarsLog.warn  = (...args) => baseLogger('warn', ...args);\ncblcarsLog.error = (...args) => baseLogger('error', ...args);\ncblcarsLog.debug = (...args) => baseLogger('debug', ...args);\nexport { cblcarsLog };\n\n\nexport function cblcarsLogGroup(level, title) {\n    console.groupCollapsed(); // Create a collapsed group\n    cblcarsLog(level, `Group: ${title}`);\n    }\n\nexport function logImportStatus(importName, importedValue) {\n    if (importedValue === undefined) {\n        cblcarsLog.error(`Import error: ${importName} is not imported correctly.`);\n    } else {\n        cblcarsLog.debug(`${importName} imported successfully.`);\n    }\n}\n\nexport function cblcarsLogBanner() {\n  let styles1 = [\n      'color: white',\n      'font-weight: bold',\n      'padding: 2px 4px',\n      'border-radius: 5em 5em 0 0', // Top left and right rounded, bottom left and right square\n      'background-color: #37a6d1' // Blue\n  ];\n\n  let styles2 = [\n      'color: white',\n      'padding: 2px 4px',\n      'border-radius: 0 0 5em 5em', // Top left and right square, bottom left and right rounded\n      'background-color: #37a6d1' // Blue\n  ];\n\n  let invisibleStyle = [\n      'color: transparent',\n      'padding: 0',\n      'border: none'\n  ];\n\n  const version = CBLCARS.CBLCARS_VERSION;\n  const url = CBLCARS.project_url;\n  const baseString = \"CB-LCARS v\" + version;\n  const padding = 4;\n\n  // Calculate the total length including padding\n  const totalLength = url.length + padding;\n  const spacesNeeded = totalLength - baseString.length;\n\n  // FIXED: Protect against negative repeat count\n  const spaces = spacesNeeded > 0 ? ' '.repeat(spacesNeeded) : '';\n  const paddedUrl = ' '.repeat(padding) + url;\n\n  console.info(`%c${spaces}${baseString}  %c\\n%c${paddedUrl}  `, styles1.join(';'), invisibleStyle.join(';'), styles2.join(';'));\n}\n","// --- SVG Helpers ---\n\nexport function drawLine({ x1, y1, x2, y2, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<line id=\"${id || ''}\" x1=\"${x1}\" y1=\"${y1}\" x2=\"${x2}\" y2=\"${y2}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawPolyline({ points, id, attrs = {}, style = {} }) {\n  const pts = points.map(pt => pt.join(',')).join(' ');\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<polyline id=\"${id || ''}\" points=\"${pts}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawPath({ d, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<path id=\"${id || ''}\" d=\"${d}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawText({ x, y, text, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<text id=\"${id || ''}\" x=\"${x}\" y=\"${y}\"${attrsStr}${styleStr}>${text}</text>`;\n}\n\nexport function drawCircle({ cx, cy, r, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<circle id=\"${id || ''}\" cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\"${attrsStr}${styleStr} />`;\n}\n\nexport function drawRect({ x, y, width, height, id, attrs = {}, style = {} }) {\n  const attrsStr = attrsToString(attrs);\n  const styleStr = styleToString(style);\n  return `<rect id=\"${id || ''}\" x=\"${x}\" y=\"${y}\" width=\"${width}\" height=\"${height}\"${attrsStr}${styleStr} />`;\n}\n\n// --- Utility helpers ---\n\nexport function attrsToString(attrs) {\n  if (!attrs || typeof attrs !== \"object\") return '';\n  return Object.entries(attrs)\n    .map(([k, v]) => ` ${k.replace(/[A-Z]/g, m => '-' + m.toLowerCase())}=\"${v}\"`)\n    .join('');\n}\n\nexport function styleToString(style) {\n  if (!style || typeof style !== \"object\") return \"\";\n  const s = Object.entries(style)\n    .map(([k, v]) => `${k.replace(/[A-Z]/g, m => '-' + m.toLowerCase())}:${v}`)\n    .join(';');\n  return s ? ` style=\"${s}\"` : '';\n}","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,i=t.trustedTypes,s=i?i.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,e=\"$lit$\",h=`lit$${Math.random().toFixed(9).slice(2)}$`,o=\"?\"+h,n=`<${o}>`,r=document,l=()=>r.createComment(\"\"),c=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,a=Array.isArray,u=t=>a(t)||\"function\"==typeof t?.[Symbol.iterator],d=\"[ \\t\\n\\f\\r]\",f=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\\\s\"'>=/]+)(${d}*=${d}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),p=/'/g,g=/\"/g,$=/^(?:script|style|textarea|title)$/i,y=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),x=y(1),b=y(2),w=y(3),T=Symbol.for(\"lit-noChange\"),E=Symbol.for(\"lit-nothing\"),A=new WeakMap,C=r.createTreeWalker(r,129);function P(t,i){if(!a(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==s?s.createHTML(i):i}const V=(t,i)=>{const s=t.length-1,o=[];let r,l=2===i?\"<svg>\":3===i?\"<math>\":\"\",c=f;for(let i=0;i<s;i++){const s=t[i];let a,u,d=-1,y=0;for(;y<s.length&&(c.lastIndex=y,u=c.exec(s),null!==u);)y=c.lastIndex,c===f?\"!--\"===u[1]?c=v:void 0!==u[1]?c=_:void 0!==u[2]?($.test(u[2])&&(r=RegExp(\"</\"+u[2],\"g\")),c=m):void 0!==u[3]&&(c=m):c===m?\">\"===u[0]?(c=r??f,d=-1):void 0===u[1]?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=void 0===u[3]?m:'\"'===u[3]?g:p):c===g||c===p?c=m:c===v||c===_?c=f:(c=m,r=void 0);const x=c===m&&t[i+1].startsWith(\"/>\")?\" \":\"\";l+=c===f?s+n:d>=0?(o.push(a),s.slice(0,d)+e+s.slice(d)+h+x):s+h+(-2===d?i:x)}return[P(t,l+(t[s]||\"<?>\")+(2===i?\"</svg>\":3===i?\"</math>\":\"\")),o]};class N{constructor({strings:t,_$litType$:s},n){let r;this.parts=[];let c=0,a=0;const u=t.length-1,d=this.parts,[f,v]=V(t,s);if(this.el=N.createElement(f,n),C.currentNode=this.el.content,2===s||3===s){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes)}for(;null!==(r=C.nextNode())&&d.length<u;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(e)){const i=v[a++],s=r.getAttribute(t).split(h),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:c,name:e[2],strings:s,ctor:\".\"===e[1]?H:\"?\"===e[1]?I:\"@\"===e[1]?L:k}),r.removeAttribute(t)}else t.startsWith(h)&&(d.push({type:6,index:c}),r.removeAttribute(t));if($.test(r.tagName)){const t=r.textContent.split(h),s=t.length-1;if(s>0){r.textContent=i?i.emptyScript:\"\";for(let i=0;i<s;i++)r.append(t[i],l()),C.nextNode(),d.push({type:2,index:++c});r.append(t[s],l())}}}else if(8===r.nodeType)if(r.data===o)d.push({type:2,index:c});else{let t=-1;for(;-1!==(t=r.data.indexOf(h,t+1));)d.push({type:7,index:c}),t+=h.length-1}c++}}static createElement(t,i){const s=r.createElement(\"template\");return s.innerHTML=t,s}}function S(t,i,s=t,e){if(i===T)return i;let h=void 0!==e?s._$Co?.[e]:s._$Cl;const o=c(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(!1),void 0===o?h=void 0:(h=new o(t),h._$AT(t,s,e)),void 0!==e?(s._$Co??=[])[e]=h:s._$Cl=h),void 0!==h&&(i=S(t,h._$AS(t,i.values),h,e)),i}class M{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??r).importNode(i,!0);C.currentNode=e;let h=C.nextNode(),o=0,n=0,l=s[0];for(;void 0!==l;){if(o===l.index){let i;2===l.type?i=new R(h,h.nextSibling,this,t):1===l.type?i=new l.ctor(h,l.name,l.strings,this,t):6===l.type&&(i=new z(h,this,t)),this._$AV.push(i),l=s[++n]}o!==l?.index&&(h=C.nextNode(),o++)}return C.currentNode=r,e}p(t){let i=0;for(const s of this._$AV)void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??!0}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=S(this,t,i),c(t)?t===E||null==t||\"\"===t?(this._$AH!==E&&this._$AR(),this._$AH=E):t!==this._$AH&&t!==T&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):u(t)?this.k(t):this._(t)}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t))}_(t){this._$AH!==E&&c(this._$AH)?this._$AA.nextSibling.data=t:this.T(r.createTextNode(t)),this._$AH=t}$(t){const{values:i,_$litType$:s}=t,e=\"number\"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=N.createElement(P(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else{const t=new M(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t}}_$AC(t){let i=A.get(t.strings);return void 0===i&&A.set(t.strings,i=new N(t)),i}k(t){a(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const h of t)e===i.length?i.push(s=new R(this.O(l()),this.O(l()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e)}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(!1,!0,i);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i}}setConnected(t){void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t))}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=E,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||\"\"!==s[0]||\"\"!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=E}_$AI(t,i=this,s,e){const h=this.strings;let o=!1;if(void 0===h)t=S(this,t,i,0),o=!c(t)||t!==this._$AH&&t!==T,o&&(this._$AH=t);else{const e=t;let n,r;for(t=h[0],n=0;n<h.length-1;n++)r=S(this,e[s+n],i,n),r===T&&(r=this._$AH[n]),o||=!c(r)||r!==this._$AH[n],r===E?t=E:t!==E&&(t+=(r??\"\")+h[n+1]),this._$AH[n]=r}o&&!e&&this.j(t)}j(t){t===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??\"\")}}class H extends k{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===E?void 0:t}}class I extends k{constructor(){super(...arguments),this.type=4}j(t){this.element.toggleAttribute(this.name,!!t&&t!==E)}}class L extends k{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5}_$AI(t,i=this){if((t=S(this,t,i,0)??E)===T)return;const s=this._$AH,e=t===E&&s!==E||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==E&&(s===E||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){\"function\"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t)}}class z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t)}}const Z={M:e,P:h,A:o,C:1,L:V,R:M,D:u,V:S,I:R,H:k,N:I,U:L,B:H,F:z},j=t.litHtmlPolyfillSupport;j?.(N,R),(t.litHtmlVersions??=[]).push(\"3.3.0\");const B=(t,i,s)=>{const e=s?.renderBefore??i;let h=e._$litPart$;if(void 0===h){const t=s?.renderBefore??null;e._$litPart$=h=new R(i.insertBefore(l(),t),t,void 0,s??{})}return h._$AI(t),h};export{Z as _$LH,x as html,w as mathml,T as noChange,E as nothing,B as render,b as svg};\n//# sourceMappingURL=lit-html.js.map\n","/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},e=t=>(...e)=>({_$litDirective$:t,values:e});class i{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}export{i as Directive,t as PartType,e as directive};\n//# sourceMappingURL=directive.js.map\n","import{nothing as t,noChange as i}from\"../lit-html.js\";import{Directive as r,PartType as s,directive as n}from\"../directive.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */class e extends r{constructor(i){if(super(i),this.it=t,i.type!==s.CHILD)throw Error(this.constructor.directiveName+\"() can only be used in child bindings\")}render(r){if(r===t||null==r)return this._t=void 0,this.it=r;if(r===i)return r;if(\"string\"!=typeof r)throw Error(this.constructor.directiveName+\"() called with a non-string value\");if(r===this.it)return this._t;this.it=r;const s=[r];return s.raw=s,this._t={_$litType$:this.constructor.resultType,strings:s,values:[]}}}e.directiveName=\"unsafeHTML\",e.resultType=1;const o=n(e);export{e as UnsafeHTMLDirective,o as unsafeHTML};\n//# sourceMappingURL=unsafe-html.js.map\n","/**\n * @license\n * Copyright 2019 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst t=globalThis,e=t.ShadowRoot&&(void 0===t.ShadyCSS||t.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,s=Symbol(),o=new WeakMap;class n{constructor(t,e,o){if(this._$cssResult$=!0,o!==s)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const s=this.t;if(e&&void 0===t){const e=void 0!==s&&1===s.length;e&&(t=o.get(s)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&o.set(s,t))}return t}toString(){return this.cssText}}const r=t=>new n(\"string\"==typeof t?t:t+\"\",void 0,s),i=(t,...e)=>{const o=1===t.length?t[0]:e.reduce(((e,s,o)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(s)+t[o+1]),t[0]);return new n(o,t,s)},S=(s,o)=>{if(e)s.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const e of o){const o=document.createElement(\"style\"),n=t.litNonce;void 0!==n&&o.setAttribute(\"nonce\",n),o.textContent=e.cssText,s.appendChild(o)}},c=e?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const s of t.cssRules)e+=s.cssText;return r(e)})(t):t;export{n as CSSResult,S as adoptStyles,i as css,c as getCompatibleStyle,e as supportsAdoptingStyleSheets,r as unsafeCSS};\n//# sourceMappingURL=css-tag.js.map\n","import{getCompatibleStyle as t,adoptStyles as s}from\"./css-tag.js\";export{CSSResult,css,supportsAdoptingStyleSheets,unsafeCSS}from\"./css-tag.js\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const{is:i,defineProperty:e,getOwnPropertyDescriptor:h,getOwnPropertyNames:r,getOwnPropertySymbols:o,getPrototypeOf:n}=Object,a=globalThis,c=a.trustedTypes,l=c?c.emptyScript:\"\",p=a.reactiveElementPolyfillSupport,d=(t,s)=>t,u={toAttribute(t,s){switch(s){case Boolean:t=t?l:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,s)=>!i(t,s),b={attribute:!0,type:String,converter:u,reflect:!1,useDefault:!1,hasChanged:f};Symbol.metadata??=Symbol(\"metadata\"),a.litPropertyMetadata??=new WeakMap;class y extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,s=b){if(s.state&&(s.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=!0),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),h=this.getPropertyDescriptor(t,i,s);void 0!==h&&e(this.prototype,t,h)}}static getPropertyDescriptor(t,s,i){const{get:e,set:r}=h(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t}};return{get:e,set(s){const h=e?.call(this);r?.call(this,s),this.requestUpdate(t,h,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(d(\"elementProperties\")))return;const t=n(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties)}static finalize(){if(this.hasOwnProperty(d(\"finalized\")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(d(\"properties\"))){const t=this.properties,s=[...r(t),...o(t)];for(const i of s)this.createProperty(i,t[i])}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i)}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const i=this._$Eu(t,s);void 0!==i&&this._$Eh.set(i,t)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(s){const i=[];if(Array.isArray(s)){const e=new Set(s.flat(1/0).reverse());for(const s of e)i.unshift(t(s))}else void 0!==s&&i.push(t(s));return i}static _$Eu(t,s){const i=s.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)))}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.()}removeController(t){this._$EO?.delete(t)}_$E_(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t)}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return s(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach((t=>t.hostConnected?.()))}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()))}attributeChangedCallback(t,s,i){this._$AK(t,i)}_$ET(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor._$Eu(t,i);if(void 0!==e&&!0===i.reflect){const h=(void 0!==i.converter?.toAttribute?i.converter:u).toAttribute(s,i.type);this._$Em=t,null==h?this.removeAttribute(e):this.setAttribute(e,h),this._$Em=null}}_$AK(t,s){const i=this.constructor,e=i._$Eh.get(t);if(void 0!==e&&this._$Em!==e){const t=i.getPropertyOptions(e),h=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:u;this._$Em=e,this[e]=h.fromAttribute(s,t.type)??this._$Ej?.get(e)??null,this._$Em=null}}requestUpdate(t,s,i){if(void 0!==t){const e=this.constructor,h=this[t];if(i??=e.getPropertyOptions(t),!((i.hasChanged??f)(h,s)||i.useDefault&&i.reflect&&h===this._$Ej?.get(t)&&!this.hasAttribute(e._$Eu(t,i))))return;this.C(t,s,i)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(t,s,{useDefault:i,reflect:e,wrapped:h},r){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??s??this[t]),!0!==h||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),!0===e&&this._$Em!==t&&(this._$Eq??=new Set).add(t))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,s]of this._$Ep)this[t]=s;this._$Ep=void 0}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];!0!==t||this._$AL.has(s)||void 0===e||this.C(s,void 0,i,e)}}let t=!1;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(s)):this._$EM()}catch(s){throw t=!1,this._$EM(),s}t&&this._$AE(s)}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return!0}update(t){this._$Eq&&=this._$Eq.forEach((t=>this._$ET(t,this[t]))),this._$EM()}updated(t){}firstUpdated(t){}}y.elementStyles=[],y.shadowRootOptions={mode:\"open\"},y[d(\"elementProperties\")]=new Map,y[d(\"finalized\")]=new Map,p?.({ReactiveElement:y}),(a.reactiveElementVersions??=[]).push(\"2.1.0\");export{y as ReactiveElement,s as adoptStyles,u as defaultConverter,t as getCompatibleStyle,f as notEqual};\n//# sourceMappingURL=reactive-element.js.map\n","import{ReactiveElement as t}from\"@lit/reactive-element\";export*from\"@lit/reactive-element\";import{render as e,noChange as r}from\"lit-html\";export*from\"lit-html\";\n/**\n * @license\n * Copyright 2017 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */const s=globalThis;class i extends t{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=e(r,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return r}}i._$litElement$=!0,i[\"finalized\"]=!0,s.litElementHydrateSupport?.({LitElement:i});const o=s.litElementPolyfillSupport;o?.({LitElement:i});const n={_$AK:(t,e,r)=>{t._$AK(e,r)},_$AL:t=>t._$AL};(s.litElementVersions??=[]).push(\"4.2.0\");export{i as LitElement,n as _$LE};\n//# sourceMappingURL=lit-element.js.map\n","/**\n * @license\n * Copyright 2022 Google LLC\n * SPDX-License-Identifier: BSD-3-Clause\n */\nconst o=!1;export{o as isServer};\n//# sourceMappingURL=is-server.js.map\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.f = {};\n// This file contains only the entry chunk.\n// The chunk loading function for additional chunks\n__webpack_require__.e = (chunkId) => {\n\treturn Promise.all(Object.keys(__webpack_require__.f).reduce((promises, key) => {\n\t\t__webpack_require__.f[key](chunkId, promises);\n\t\treturn promises;\n\t}, []));\n};","// This function allow to reference async chunks\n__webpack_require__.u = (chunkId) => {\n\t// return url for filenames based on template\n\treturn \"\" + chunkId + \".cb-lcars.js\";\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","var scriptUrl;\nif (__webpack_require__.g.importScripts) scriptUrl = __webpack_require__.g.location + \"\";\nvar document = __webpack_require__.g.document;\nif (!scriptUrl && document) {\n\tif (document.currentScript && document.currentScript.tagName.toUpperCase() === 'SCRIPT')\n\t\tscriptUrl = document.currentScript.src;\n\tif (!scriptUrl) {\n\t\tvar scripts = document.getElementsByTagName(\"script\");\n\t\tif(scripts.length) {\n\t\t\tvar i = scripts.length - 1;\n\t\t\twhile (i > -1 && (!scriptUrl || !/^http(s?):/.test(scriptUrl))) scriptUrl = scripts[i--].src;\n\t\t}\n\t}\n}\n// When supporting browsers where an automatic publicPath is not supported you must specify an output.publicPath manually via configuration\n// or pass an empty string (\"\") and set the __webpack_public_path__ variable from your code to use your own logic.\nif (!scriptUrl) throw new Error(\"Automatic publicPath is not supported in this browser\");\nscriptUrl = scriptUrl.replace(/#.*$/, \"\").replace(/\\?.*$/, \"\").replace(/\\/[^\\/]+$/, \"/\");\n__webpack_require__.p = scriptUrl;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t792: 0\n};\n\n__webpack_require__.f.j = (chunkId, promises) => {\n\t\t// JSONP chunk loading for javascript\n\t\tvar installedChunkData = __webpack_require__.o(installedChunks, chunkId) ? installedChunks[chunkId] : undefined;\n\t\tif(installedChunkData !== 0) { // 0 means \"already installed\".\n\n\t\t\t// a Promise means \"currently loading\".\n\t\t\tif(installedChunkData) {\n\t\t\t\tpromises.push(installedChunkData[2]);\n\t\t\t} else {\n\t\t\t\tif(true) { // all chunks have JS\n\t\t\t\t\t// setup Promise in chunk cache\n\t\t\t\t\tvar promise = new Promise((resolve, reject) => (installedChunkData = installedChunks[chunkId] = [resolve, reject]));\n\t\t\t\t\tpromises.push(installedChunkData[2] = promise);\n\n\t\t\t\t\t// start chunk loading\n\t\t\t\t\tvar url = __webpack_require__.p + __webpack_require__.u(chunkId);\n\t\t\t\t\t// create error before stack unwound to get useful stacktrace later\n\t\t\t\t\tvar error = new Error();\n\t\t\t\t\tvar loadingEnded = (event) => {\n\t\t\t\t\t\tif(__webpack_require__.o(installedChunks, chunkId)) {\n\t\t\t\t\t\t\tinstalledChunkData = installedChunks[chunkId];\n\t\t\t\t\t\t\tif(installedChunkData !== 0) installedChunks[chunkId] = undefined;\n\t\t\t\t\t\t\tif(installedChunkData) {\n\t\t\t\t\t\t\t\tvar errorType = event && (event.type === 'load' ? 'missing' : event.type);\n\t\t\t\t\t\t\t\tvar realSrc = event && event.target && event.target.src;\n\t\t\t\t\t\t\t\terror.message = 'Loading chunk ' + chunkId + ' failed.\\n(' + errorType + ': ' + realSrc + ')';\n\t\t\t\t\t\t\t\terror.name = 'ChunkLoadError';\n\t\t\t\t\t\t\t\terror.type = errorType;\n\t\t\t\t\t\t\t\terror.request = realSrc;\n\t\t\t\t\t\t\t\tinstalledChunkData[1](error);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t__webpack_require__.l(url, loadingEnded, \"chunk-\" + chunkId, chunkId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n};\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n// no on chunks loaded\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkcb_lcars\"] = self[\"webpackChunkcb_lcars\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","/**\n * anime.js - ESM\n * @version v4.0.2\n * @author Julian Garnier\n * @license MIT\n * @copyright (c) 2025 Julian Garnier\n * @see https://animejs.com\n */\n\n/**\n * @typedef {Object} DefaultsParams\n * @property {Number|String} [id]\n * @property {PercentageKeyframes|DurationKeyframes} [keyframes]\n * @property {EasingParam} [playbackEase]\n * @property {Number} [playbackRate]\n * @property {Number} [frameRate]\n * @property {Number|Boolean} [loop]\n * @property {Boolean} [reversed]\n * @property {Boolean} [alternate]\n * @property {Boolean|ScrollObserver} [autoplay]\n * @property {Number|FunctionValue} [duration]\n * @property {Number|FunctionValue} [delay]\n * @property {Number} [loopDelay]\n * @property {EasingParam} [ease]\n * @property {'none'|'replace'|'blend'|compositionTypes} [composition]\n * @property {(v: any) => any} [modifier]\n * @property {(tickable: Tickable) => void} [onBegin]\n * @property {(tickable: Tickable) => void} [onBeforeUpdate]\n * @property {(tickable: Tickable) => void} [onUpdate]\n * @property {(tickable: Tickable) => void} [onLoop]\n * @property {(tickable: Tickable) => void} [onPause]\n * @property {(tickable: Tickable) => void} [onComplete]\n * @property {(renderable: Renderable) => void} [onRender]\n */\n\n/** @typedef {JSAnimation|Timeline} Renderable */\n/** @typedef {Timer|Renderable} Tickable */\n/** @typedef {Timer&JSAnimation&Timeline} CallbackArgument */\n/** @typedef {Animatable|Tickable|Draggable|ScrollObserver|Scope} Revertible */\n\n/**\n * @typedef {Object} DraggableAxisParam\n * @property {String} [mapTo]\n * @property {TweenModifier} [modifier]\n * @property {TweenComposition} [composition]\n * @property {Number|Array<Number>|((draggable: Draggable) => Number|Array<Number>)} [snap]\n */\n\n/**\n * @typedef {Object} DraggableCursorParams\n * @property {String} [onHover]\n * @property {String} [onGrab]\n */\n\n/**\n * @typedef {Object} DraggableParams\n * @property {DOMTargetSelector} [trigger]\n * @property {DOMTargetSelector|Array<Number>|((draggable: Draggable) => DOMTargetSelector|Array<Number>)} [container]\n * @property {Boolean|DraggableAxisParam} [x]\n * @property {Boolean|DraggableAxisParam} [y]\n * @property {TweenModifier} [modifier]\n * @property {Number|Array<Number>|((draggable: Draggable) => Number|Array<Number>)} [snap]\n * @property {Number|Array<Number>|((draggable: Draggable) => Number|Array<Number>)} [containerPadding]\n * @property {Number|((draggable: Draggable) => Number)} [containerFriction]\n * @property {Number|((draggable: Draggable) => Number)} [releaseContainerFriction]\n * @property {Number|((draggable: Draggable) => Number)} [dragSpeed]\n * @property {Number|((draggable: Draggable) => Number)} [scrollSpeed]\n * @property {Number|((draggable: Draggable) => Number)} [scrollThreshold]\n * @property {Number|((draggable: Draggable) => Number)} [minVelocity]\n * @property {Number|((draggable: Draggable) => Number)} [maxVelocity]\n * @property {Number|((draggable: Draggable) => Number)} [velocityMultiplier]\n * @property {Number} [releaseMass]\n * @property {Number} [releaseStiffness]\n * @property {Number} [releaseDamping]\n * @property {Boolean} [releaseDamping]\n * @property {EasingParam} [releaseEase]\n * @property {Boolean|DraggableCursorParams|((draggable: Draggable) => Boolean|DraggableCursorParams)} [cursor]\n * @property {Callback<Draggable>} [onGrab]\n * @property {Callback<Draggable>} [onDrag]\n * @property {Callback<Draggable>} [onRelease]\n * @property {Callback<Draggable>} [onUpdate]\n * @property {Callback<Draggable>} [onSettle]\n * @property {Callback<Draggable>} [onSnap]\n * @property {Callback<Draggable>} [onResize]\n * @property {Callback<Draggable>} [onAfterResize]\n */\n\n/**\n * @typedef {SVGGeometryElement & {\n *   setAttribute(name: 'draw', value: `${number} ${number}`): void;\n *   draw: `${number} ${number}`;\n * }} DrawableSVGGeometry\n */\n\n/**\n * @callback EasingFunction\n * @param {Number} time\n * @return {Number}\n */\n\n/**\n * @typedef {('linear'|'linear(x1, x2 25%, x3)'|'in'|'out'|'inOut'|'inQuad'|'outQuad'|'inOutQuad'|'inCubic'|'outCubic'|'inOutCubic'|'inQuart'|'outQuart'|'inOutQuart'|'inQuint'|'outQuint'|'inOutQuint'|'inSine'|'outSine'|'inOutSine'|'inCirc'|'outCirc'|'inOutCirc'|'inExpo'|'outExpo'|'inOutExpo'|'inBounce'|'outBounce'|'inOutBounce'|'inBack'|'outBack'|'inOutBack'|'inElastic'|'outElastic'|'inOutElastic'|'irregular'|'cubicBezier'|'steps'|'in(p = 1.675)'|'out(p = 1.675)'|'inOut(p = 1.675)'|'inBack(overshoot = 1.70158)'|'outBack(overshoot = 1.70158)'|'inOutBack(overshoot = 1.70158)'|'inElastic(amplitude = 1, period = .3)'|'outElastic(amplitude = 1, period = .3)'|'inOutElastic(amplitude = 1, period = .3)'|'irregular(length = 10, randomness = 1)'|'cubicBezier(x1, y1, x2, y2)'|'steps(steps = 10)')} EaseStringParamNames\n */\n\n// A hack to get both ease names suggestions AND allow any strings\n// https://github.com/microsoft/TypeScript/issues/29729#issuecomment-460346421\n/** @typedef {(String & {})|EaseStringParamNames|EasingFunction|Spring} EasingParam */\n\n/** @typedef {HTMLElement|SVGElement} DOMTarget */\n/** @typedef {Record<String, any>} JSTarget */\n/** @typedef {DOMTarget|JSTarget} Target */\n/** @typedef {Target|NodeList|String} TargetSelector */\n/** @typedef {DOMTarget|NodeList|String} DOMTargetSelector */\n/** @typedef {Array.<DOMTargetSelector>|DOMTargetSelector} DOMTargetsParam */\n/** @typedef {Array.<DOMTarget>} DOMTargetsArray */\n/** @typedef {Array.<JSTarget>|JSTarget} JSTargetsParam */\n/** @typedef {Array.<JSTarget>} JSTargetsArray */\n/** @typedef {Array.<TargetSelector>|TargetSelector} TargetsParam */\n/** @typedef {Array.<Target>} TargetsArray */\n\n/**\n * @callback FunctionValue\n * @param {Target} target - The animated target\n * @param {Number} index - The target index\n * @param {Number} length - The total number of animated targets\n * @return {Number|String|TweenObjectValue|Array.<Number|String|TweenObjectValue>}\n */\n\n/**\n * @callback TweenModifier\n * @param {Number} value - The animated value\n * @return {Number|String}\n */\n\n/** @typedef {[Number, Number, Number, Number]} ColorArray */\n\n/**\n * @template T\n * @callback Callback\n * @param {T} self - Returns itself\n * @param {PointerEvent} [e]\n * @return {*}\n */\n\n/**\n * @template {object} T\n * @typedef {Object} TickableCallbacks\n * @property {Callback<T>} [onBegin]\n * @property {Callback<T>} [onBeforeUpdate]\n * @property {Callback<T>} [onUpdate]\n * @property {Callback<T>} [onLoop]\n * @property {Callback<T>} [onPause]\n * @property {Callback<T>} [onComplete]\n */\n\n/**\n * @template {object} T\n * @typedef {Object} RenderableCallbacks\n * @property {Callback<T>} [onRender]\n */\n\n/**\n * @typedef {Object} Tween\n * @property {Number} id\n * @property {JSAnimation} parent\n * @property {String} property\n * @property {Target} target\n * @property {String|Number} _value\n * @property {Function|null} _func\n * @property {EasingFunction} _ease\n * @property {Array.<Number>} _fromNumbers\n * @property {Array.<Number>} _toNumbers\n * @property {Array.<String>} _strings\n * @property {Number} _fromNumber\n * @property {Number} _toNumber\n * @property {Array.<Number>} _numbers\n * @property {Number} _number\n * @property {String} _unit\n * @property {TweenModifier} _modifier\n * @property {Number} _currentTime\n * @property {Number} _delay\n * @property {Number} _updateDuration\n * @property {Number} _startTime\n * @property {Number} _changeDuration\n * @property {Number} _absoluteStartTime\n * @property {tweenTypes} _tweenType\n * @property {valueTypes} _valueType\n * @property {Number} _composition\n * @property {Number} _isOverlapped\n * @property {Number} _isOverridden\n * @property {Number} _renderTransforms\n * @property {Tween} _prevRep\n * @property {Tween} _nextRep\n * @property {Tween} _prevAdd\n * @property {Tween} _nextAdd\n * @property {Tween} _prev\n * @property {Tween} _next\n */\n\n/**\n * @typedef TweenDecomposedValue\n * @property {Number} t - Type\n * @property {Number} n - Single number value\n * @property {String} u - Value unit\n * @property {String} o - Value operator\n * @property {Array.<Number>} d - Array of Numbers (in case of complex value type)\n * @property {Array.<String>} s - Strings (in case of complex value type)\n */\n\n/** @typedef {{_head: null|Tween, _tail: null|Tween}} TweenPropertySiblings */\n/** @typedef {Record<String, TweenPropertySiblings>} TweenLookups */\n/** @typedef {WeakMap.<Target, TweenLookups>} TweenReplaceLookups */\n/** @typedef {Map.<Target, TweenLookups>} TweenAdditiveLookups */\n\n/**\n * @typedef {Object} TimerOptions\n * @property {Number|String} [id]\n * @property {TweenParamValue} [duration]\n * @property {TweenParamValue} [delay]\n * @property {Number} [loopDelay]\n * @property {Boolean} [reversed]\n * @property {Boolean} [alternate]\n * @property {Boolean|Number} [loop]\n * @property {Boolean|ScrollObserver} [autoplay]\n * @property {Number} [frameRate]\n * @property {Number} [playbackRate]\n */\n\n/**\n\n/**\n * @typedef {TimerOptions & TickableCallbacks<Timer>} TimerParams\n */\n\n/**\n * @typedef {Number|String|FunctionValue} TweenParamValue\n */\n\n/**\n * @typedef {TweenParamValue|[TweenParamValue, TweenParamValue]} TweenPropValue\n */\n\n/**\n * @typedef {(String & {})|'none'|'replace'|'blend'|compositionTypes} TweenComposition\n */\n\n/**\n * @typedef {Object} TweenParamsOptions\n * @property {TweenParamValue} [duration]\n * @property {TweenParamValue} [delay]\n * @property {EasingParam} [ease]\n * @property {TweenModifier} [modifier]\n * @property {TweenComposition} [composition]\n */\n\n/**\n * @typedef {Object} TweenValues\n * @property {TweenParamValue} [from]\n * @property {TweenPropValue} [to]\n * @property {TweenPropValue} [fromTo]\n */\n\n/**\n * @typedef {TweenParamsOptions & TweenValues} TweenKeyValue\n */\n\n/**\n * @typedef {Array.<TweenKeyValue|TweenPropValue>} ArraySyntaxValue\n */\n\n/**\n * @typedef {TweenParamValue|ArraySyntaxValue|TweenKeyValue} TweenOptions\n */\n\n/**\n * @typedef {Partial<{to: TweenParamValue|Array.<TweenParamValue>; from: TweenParamValue|Array.<TweenParamValue>; fromTo: TweenParamValue|Array.<TweenParamValue>;}>} TweenObjectValue\n */\n\n/**\n * @typedef {Object} PercentageKeyframeOptions\n * @property {EasingParam} [ease]\n */\n\n/**\n * @typedef {Record<String, TweenParamValue>} PercentageKeyframeParams\n */\n\n/**\n * @typedef {Record<String, PercentageKeyframeParams & PercentageKeyframeOptions>} PercentageKeyframes\n */\n\n/**\n * @typedef {Array<Record<String, TweenOptions | TweenModifier | boolean> & TweenParamsOptions>} DurationKeyframes\n */\n\n/**\n * @typedef {Object} AnimationOptions\n * @property {PercentageKeyframes|DurationKeyframes} [keyframes]\n * @property {EasingParam} [playbackEase]\n */\n\n// TODO: Currently setting TweenModifier to the intersected Record<> makes the FunctionValue type target param any if only one parameter is set\n/**\n * @typedef {Record<String, TweenOptions | Callback<JSAnimation> | TweenModifier | boolean | PercentageKeyframes | DurationKeyframes | ScrollObserver> & TimerOptions & AnimationOptions & TweenParamsOptions & TickableCallbacks<JSAnimation> & RenderableCallbacks<JSAnimation>} AnimationParams\n */\n\n/**\n * @typedef {Object} TimelineOptions\n * @property {DefaultsParams} [defaults]\n * @property {EasingParam} [playbackEase]\n */\n\n/**\n * @typedef {TimerOptions & TimelineOptions & TickableCallbacks<Timeline> & RenderableCallbacks<Timeline>} TimelineParams\n */\n\n/**\n * @callback AnimatablePropertySetter\n * @param  {Number|Array.<Number>} to\n * @param  {Number} [duration]\n * @param  {EasingParam} [ease]\n * @return {AnimatableObject}\n */\n\n/**\n * @callback AnimatablePropertyGetter\n * @return {Number|Array.<Number>}\n */\n\n/**\n * @typedef {AnimatablePropertySetter & AnimatablePropertyGetter} AnimatableProperty\n */\n\n/**\n * @typedef {Animatable & Record<String, AnimatableProperty>} AnimatableObject\n */\n\n/**\n * @typedef {Object} AnimatablePropertyParamsOptions\n * @property {String} [unit]\n * @property {TweenParamValue} [duration]\n * @property {EasingParam} [ease]\n * @property {TweenModifier} [modifier]\n * @property {TweenComposition} [composition]\n */\n\n/**\n * @typedef {Record<String, TweenParamValue | EasingParam | TweenModifier | TweenComposition | AnimatablePropertyParamsOptions> & AnimatablePropertyParamsOptions} AnimatableParams\n */\n\n\n// Environments\n\n// TODO: Do we need to check if we're running inside a worker ?\nconst isBrowser = typeof window !== 'undefined';\n\n/** @type {Object|Null} */\nconst win = isBrowser ? window : null;\n\n/** @type {Document} */\nconst doc = isBrowser ? document : null;\n\n// Enums\n\n/** @enum {Number} */\nconst tweenTypes = {\n  OBJECT: 0,\n  ATTRIBUTE: 1,\n  CSS: 2,\n  TRANSFORM: 3,\n  CSS_VAR: 4,\n};\n\n/** @enum {Number} */\nconst valueTypes = {\n  NUMBER: 0,\n  UNIT: 1,\n  COLOR: 2,\n  COMPLEX: 3,\n};\n\n/** @enum {Number} */\nconst tickModes = {\n  NONE: 0,\n  AUTO: 1,\n  FORCE: 2,\n};\n\n/** @enum {Number} */\nconst compositionTypes = {\n  replace: 0,\n  none: 1,\n  blend: 2,\n};\n\n// Cache symbols\n\nconst isRegisteredTargetSymbol = Symbol();\nconst isDomSymbol = Symbol();\nconst isSvgSymbol = Symbol();\nconst transformsSymbol = Symbol();\nconst morphPointsSymbol = Symbol();\nconst proxyTargetSymbol = Symbol();\n\n// Numbers\n\nconst minValue = 1e-11;\nconst maxValue = 1e12;\nconst K = 1e3;\nconst maxFps = 120;\n\n// Strings\n\nconst emptyString = '';\nconst shortTransforms = new Map();\n\nshortTransforms.set('x', 'translateX');\nshortTransforms.set('y', 'translateY');\nshortTransforms.set('z', 'translateZ');\n\nconst validTransforms = [\n  'translateX',\n  'translateY',\n  'translateZ',\n  'rotate',\n  'rotateX',\n  'rotateY',\n  'rotateZ',\n  'scale',\n  'scaleX',\n  'scaleY',\n  'scaleZ',\n  'skew',\n  'skewX',\n  'skewY',\n  'perspective',\n  'matrix',\n  'matrix3d',\n];\n\nconst transformsFragmentStrings = validTransforms.reduce((a, v) => ({...a, [v]: v + '('}), {});\n\n// Functions\n\n/** @return {void} */\nconst noop = () => {};\n\n// Regex\n\nconst hexTestRgx = /(^#([\\da-f]{3}){1,2}$)|(^#([\\da-f]{4}){1,2}$)/i;\nconst rgbExecRgx = /rgb\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*\\)/i;\nconst rgbaExecRgx = /rgba\\(\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(\\d+)\\s*,\\s*(-?\\d+|-?\\d*.\\d+)\\s*\\)/i;\nconst hslExecRgx = /hsl\\(\\s*(-?\\d+|-?\\d*.\\d+)\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*\\)/i;\nconst hslaExecRgx = /hsla\\(\\s*(-?\\d+|-?\\d*.\\d+)\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*,\\s*(-?\\d+|-?\\d*.\\d+)%\\s*,\\s*(-?\\d+|-?\\d*.\\d+)\\s*\\)/i;\n// export const digitWithExponentRgx = /[-+]?\\d*\\.?\\d+(?:[eE][-+]?\\d+)?/g;\nconst digitWithExponentRgx = /[-+]?\\d*\\.?\\d+(?:e[-+]?\\d)?/gi;\n// export const unitsExecRgx = /^([-+]?\\d*\\.?\\d+(?:[eE][-+]?\\d+)?)+([a-z]+|%)$/i;\nconst unitsExecRgx = /^([-+]?\\d*\\.?\\d+(?:e[-+]?\\d+)?)([a-z]+|%)$/i;\nconst lowerCaseRgx = /([a-z])([A-Z])/g;\nconst transformsExecRgx = /(\\w+)(\\([^)]+\\)+)/g; // Match inline transforms with cacl() values, returns the value wrapped in ()\nconst relativeValuesExecRgx = /(\\*=|\\+=|-=)/;\n\n\n\n\n/** @type {DefaultsParams} */\nconst defaults = {\n  id: null,\n  keyframes: null,\n  playbackEase: null,\n  playbackRate: 1,\n  frameRate: maxFps,\n  loop: 0,\n  reversed: false,\n  alternate: false,\n  autoplay: true,\n  duration: K,\n  delay: 0,\n  loopDelay: 0,\n  ease: 'out(2)',\n  composition: compositionTypes.replace,\n  modifier: v => v,\n  onBegin: noop,\n  onBeforeUpdate: noop,\n  onUpdate: noop,\n  onLoop: noop,\n  onPause: noop,\n  onComplete: noop,\n  onRender: noop,\n};\n\nconst globals = {\n  /** @type {DefaultsParams} */\n  defaults,\n  /** @type {Document|DOMTarget} */\n  root: doc,\n  /** @type {Scope} */\n  scope: null,\n  /** @type {Number} */\n  precision: 4,\n  /** @type {Number} */\n  timeScale: 1,\n  /** @type {Number} */\n  tickThreshold: 200,\n};\n\nconst globalVersions = { version: '4.0.2', engine: null };\n\nif (isBrowser) {\n  if (!win.AnimeJS) win.AnimeJS = [];\n  win.AnimeJS.push(globalVersions);\n}\n\n// Strings\n\n/**\n * @param  {String} str\n * @return {String}\n */\nconst toLowerCase = str => str.replace(lowerCaseRgx, '$1-$2').toLowerCase();\n\n/**\n * Prioritize this method instead of regex when possible\n * @param  {String} str\n * @param  {String} sub\n * @return {Boolean}\n */\nconst stringStartsWith = (str, sub) => str.indexOf(sub) === 0;\n\n// Time\n// Note: Date.now is used instead of performance.now since it is precise enough for timings calculations, performs slightly faster and works in Node.js environement.\nconst now = Date.now;\n\n// Types checkers\n\nconst isArr = Array.isArray;\n/**@param {any} a @return {a is Record<String, any>} */\nconst isObj = a => a && a.constructor === Object;\n/**@param {any} a @return {a is Number} */\nconst isNum = a => typeof a === 'number' && !isNaN(a);\n/**@param {any} a @return {a is String} */\nconst isStr = a => typeof a === 'string';\n/**@param {any} a @return {a is Function} */\nconst isFnc = a => typeof a === 'function';\n/**@param {any} a @return {a is undefined} */\nconst isUnd = a => typeof a === 'undefined';\n/**@param {any} a @return {a is null | undefined} */\nconst isNil = a => isUnd(a) || a === null;\n/**@param {any} a @return {a is SVGElement} */\nconst isSvg = a => isBrowser && a instanceof SVGElement;\n/**@param {any} a @return {Boolean} */\nconst isHex = a => hexTestRgx.test(a);\n/**@param {any} a @return {Boolean} */\nconst isRgb = a => stringStartsWith(a, 'rgb');\n/**@param {any} a @return {Boolean} */\nconst isHsl = a => stringStartsWith(a, 'hsl');\n/**@param {any} a @return {Boolean} */\nconst isCol = a => isHex(a) || isRgb(a) || isHsl(a);\n/**@param {any} a @return {Boolean} */\nconst isKey = a => !globals.defaults.hasOwnProperty(a);\n\n// Number\n\n/**\n * @param  {Number|String} str\n * @return {Number}\n */\nconst parseNumber = str => isStr(str) ?\n  parseFloat(/** @type {String} */(str)) :\n  /** @type {Number} */(str);\n\n// Math\n\nconst pow = Math.pow;\nconst sqrt = Math.sqrt;\nconst sin = Math.sin;\nconst cos = Math.cos;\nconst abs = Math.abs;\nconst exp = Math.exp;\nconst ceil = Math.ceil;\nconst floor = Math.floor;\nconst asin = Math.asin;\nconst max = Math.max;\nconst atan2 = Math.atan2;\nconst PI = Math.PI;\nconst _round = Math.round;\n\n/**\n * @param  {Number} v\n * @param  {Number} min\n * @param  {Number} max\n * @return {Number}\n */\nconst clamp = (v, min, max) => v < min ? min : v > max ? max : v;\n\nconst powCache = {};\n\n/**\n * @param  {Number} v\n * @param  {Number} decimalLength\n * @return {Number}\n */\nconst round = (v, decimalLength) => {\n  if (decimalLength < 0) return v;\n  if (!decimalLength) return _round(v);\n  let p = powCache[decimalLength];\n  if (!p) p = powCache[decimalLength] = 10 ** decimalLength;\n  return _round(v * p) / p;\n};\n\n/**\n * @param  {Number} v\n * @param  {Number|Array<Number>} increment\n * @return {Number}\n */\nconst snap = (v, increment) => isArr(increment) ? increment.reduce((closest, cv) => (abs(cv - v) < abs(closest - v) ? cv : closest)) : increment ? _round(v / increment) * increment : v;\n\n/**\n * @param  {Number} start\n * @param  {Number} end\n * @param  {Number} progress\n * @return {Number}\n */\nconst interpolate = (start, end, progress) => start + (end - start) * progress;\n\n/**\n * @param  {Number} v\n * @return {Number}\n */\nconst clampInfinity = v => v === Infinity ? maxValue : v === -Infinity ? -1e12 : v;\n\n/**\n * @param  {Number} v\n * @return {Number}\n */\nconst normalizeTime = v => v <= minValue ? minValue : clampInfinity(round(v, 11));\n\n// Arrays\n\n/**\n * @template T\n * @param {T[]} a\n * @return {T[]}\n */\nconst cloneArray = a => isArr(a) ? [ ...a ] : a;\n\n// Objects\n\n/**\n * @template T\n * @template U\n * @param {T} o1\n * @param {U} o2\n * @return {T & U}\n */\nconst mergeObjects = (o1, o2) => {\n  const merged = /** @type {T & U} */({ ...o1 });\n  for (let p in o2) {\n    const o1p = /** @type {T & U} */(o1)[p];\n    merged[p] = isUnd(o1p) ? /** @type {T & U} */(o2)[p] : o1p;\n  }  return merged;\n};\n\n// Linked lists\n\n/**\n * @param {Object} parent\n * @param {Function} callback\n * @param {Boolean} [reverse]\n * @param {String} [prevProp]\n * @param {String} [nextProp]\n * @return {void}\n */\nconst forEachChildren = (parent, callback, reverse, prevProp = '_prev', nextProp = '_next') => {\n  let next = parent._head;\n  let adjustedNextProp = nextProp;\n  if (reverse) {\n    next = parent._tail;\n    adjustedNextProp = prevProp;\n  }\n  while (next) {\n    const currentNext = next[adjustedNextProp];\n    callback(next);\n    next = currentNext;\n  }\n};\n\n/**\n * @param  {Object} parent\n * @param  {Object} child\n * @param  {String} [prevProp]\n * @param  {String} [nextProp]\n * @return {void}\n */\nconst removeChild = (parent, child, prevProp = '_prev', nextProp = '_next') => {\n  const prev = child[prevProp];\n  const next = child[nextProp];\n  prev ? prev[nextProp] = next : parent._head = next;\n  next ? next[prevProp] = prev : parent._tail = prev;\n  child[prevProp] = null;\n  child[nextProp] = null;\n};\n\n/**\n * @param  {Object} parent\n * @param  {Object} child\n * @param  {Function} [sortMethod]\n * @param  {String} prevProp\n * @param  {String} nextProp\n * @return {void}\n */\nconst addChild = (parent, child, sortMethod, prevProp = '_prev', nextProp = '_next') => {\n  let prev = parent._tail;\n  while (prev && sortMethod && sortMethod(prev, child)) prev = prev[prevProp];\n  const next = prev ? prev[nextProp] : parent._head;\n  prev ? prev[nextProp] = child : parent._head = child;\n  next ? next[prevProp] = child : parent._tail = child;\n  child[prevProp] = prev;\n  child[nextProp] = next;\n};\n\n/*\n * Base class to control framerate and playback rate.\n * Inherited by Engine, Timer, Animation and Timeline.\n */\nclass Clock {\n\n  /** @param {Number} [initTime] */\n  constructor(initTime = 0) {\n    /** @type {Number} */\n    this.deltaTime = 0;\n    /** @type {Number} */\n    this._currentTime = initTime;\n    /** @type {Number} */\n    this._elapsedTime = initTime;\n    /** @type {Number} */\n    this._startTime = initTime;\n    /** @type {Number} */\n    this._lastTime = initTime;\n    /** @type {Number} */\n    this._scheduledTime = 0;\n    /** @type {Number} */\n    this._frameDuration = round(K / maxFps, 0);\n    /** @type {Number} */\n    this._fps = maxFps;\n    /** @type {Number} */\n    this._speed = 1;\n    /** @type {Boolean} */\n    this._hasChildren = false;\n    /** @type {Tickable|Tween} */\n    this._head = null;\n    /** @type {Tickable|Tween} */\n    this._tail = null;\n  }\n\n  get fps() {\n    return this._fps;\n  }\n\n  set fps(frameRate) {\n    const previousFrameDuration = this._frameDuration;\n    const fr = +frameRate;\n    const fps = fr < minValue ? minValue : fr;\n    const frameDuration = round(K / fps, 0);\n    this._fps = fps;\n    this._frameDuration = frameDuration;\n    this._scheduledTime += frameDuration - previousFrameDuration;\n  }\n\n  get speed() {\n    return this._speed;\n  }\n\n  set speed(playbackRate) {\n    const pbr = +playbackRate;\n    this._speed = pbr < minValue ? minValue : pbr;\n  }\n\n  /**\n   * @param  {Number} time\n   * @return {tickModes}\n   */\n  requestTick(time) {\n    const scheduledTime = this._scheduledTime;\n    const elapsedTime = this._elapsedTime;\n    this._elapsedTime += (time - elapsedTime);\n    // If the elapsed time is lower than the scheduled time\n    // this means not enough time has passed to hit one frameDuration\n    // so skip that frame\n    if (elapsedTime < scheduledTime) return tickModes.NONE;\n    const frameDuration = this._frameDuration;\n    const frameDelta = elapsedTime - scheduledTime;\n    // Ensures that _scheduledTime progresses in steps of at least 1 frameDuration.\n    // Skips ahead if the actual elapsed time is higher.\n    this._scheduledTime += frameDelta < frameDuration ? frameDuration : frameDelta;\n    return tickModes.AUTO;\n  }\n\n  /**\n   * @param  {Number} time\n   * @return {Number}\n   */\n  computeDeltaTime(time) {\n    const delta = time - this._lastTime;\n    this.deltaTime = delta;\n    this._lastTime = time;\n    return delta;\n  }\n\n}\n\n\n\n\n/**\n * @param  {Tickable} tickable\n * @param  {Number} time\n * @param  {Number} muteCallbacks\n * @param  {Number} internalRender\n * @param  {tickModes} tickMode\n * @return {Number}\n */\nconst render = (tickable, time, muteCallbacks, internalRender, tickMode) => {\n\n  const parent = tickable.parent;\n  const duration = tickable.duration;\n  const completed = tickable.completed;\n  const iterationDuration = tickable.iterationDuration;\n  const iterationCount = tickable.iterationCount;\n  const _currentIteration = tickable._currentIteration;\n  const _loopDelay = tickable._loopDelay;\n  const _reversed = tickable._reversed;\n  const _alternate = tickable._alternate;\n  const _hasChildren = tickable._hasChildren;\n  const tickableDelay = tickable._delay;\n  const tickablePrevAbsoluteTime = tickable._currentTime; // TODO: rename ._currentTime to ._absoluteCurrentTime\n\n  const tickableEndTime = tickableDelay + iterationDuration;\n  const tickableAbsoluteTime = time - tickableDelay;\n  const tickablePrevTime = clamp(tickablePrevAbsoluteTime, -tickableDelay, duration);\n  const tickableCurrentTime = clamp(tickableAbsoluteTime, -tickableDelay, duration);\n  const deltaTime = tickableAbsoluteTime - tickablePrevAbsoluteTime;\n  const isCurrentTimeAboveZero = tickableCurrentTime > 0;\n  const isCurrentTimeEqualOrAboveDuration = tickableCurrentTime >= duration;\n  const isSetter = duration <= minValue;\n  const forcedTick = tickMode === tickModes.FORCE;\n\n  let isOdd = 0;\n  let iterationElapsedTime = tickableAbsoluteTime;\n  // Render checks\n  // Used to also check if the children have rendered in order to trigger the onRender callback on the parent timer\n  let hasRendered = 0;\n\n  // Execute the \"expensive\" iterations calculations only when necessary\n  if (iterationCount > 1) {\n    // bitwise NOT operator seems to be generally faster than Math.floor() across browsers\n    const currentIteration = ~~(tickableCurrentTime / (iterationDuration + (isCurrentTimeEqualOrAboveDuration ? 0 : _loopDelay)));\n    tickable._currentIteration = clamp(currentIteration, 0, iterationCount);\n    // Prevent the iteration count to go above the max iterations when reaching the end of the animation\n    if (isCurrentTimeEqualOrAboveDuration) tickable._currentIteration--;\n    isOdd = tickable._currentIteration % 2;\n    iterationElapsedTime = tickableCurrentTime % (iterationDuration + _loopDelay) || 0;\n  }\n\n  // Checks if exactly one of _reversed and (_alternate && isOdd) is true\n  const isReversed = _reversed ^ (_alternate && isOdd);\n  const _ease = /** @type {Renderable} */(tickable)._ease;\n  let iterationTime = isCurrentTimeEqualOrAboveDuration ? isReversed ? 0 : duration : isReversed ? iterationDuration - iterationElapsedTime : iterationElapsedTime;\n  if (_ease) iterationTime = iterationDuration * _ease(iterationTime / iterationDuration) || 0;\n  const isRunningBackwards = (parent ? parent.backwards : tickableAbsoluteTime < tickablePrevAbsoluteTime) ? !isReversed : !!isReversed;\n\n  tickable._currentTime = tickableAbsoluteTime;\n  tickable._iterationTime = iterationTime;\n  tickable.backwards = isRunningBackwards;\n\n  if (isCurrentTimeAboveZero && !tickable.began) {\n    tickable.began = true;\n    if (!muteCallbacks && !(parent && (isRunningBackwards || !parent.began))) {\n      tickable.onBegin(/** @type {CallbackArgument} */(tickable));\n    }\n  } else if (tickableAbsoluteTime <= 0) {\n    tickable.began = false;\n  }\n\n  // Only triggers onLoop for tickable without children, otherwise call the the onLoop callback in the tick function\n  // Make sure to trigger the onLoop before rendering to allow .refresh() to pickup the current values\n  if (!muteCallbacks && !_hasChildren && isCurrentTimeAboveZero && tickable._currentIteration !== _currentIteration) {\n    tickable.onLoop(/** @type {CallbackArgument} */(tickable));\n  }\n\n  if (\n    forcedTick ||\n    tickMode === tickModes.AUTO && (\n      time >= tickableDelay && time <= tickableEndTime || // Normal render\n      time <= tickableDelay && tickablePrevTime > tickableDelay || // Playhead is before the animation start time so make sure the animation is at its initial state\n      time >= tickableEndTime && tickablePrevTime !== duration // Playhead is after the animation end time so make sure the animation is at its end state\n    ) ||\n    iterationTime >= tickableEndTime && tickablePrevTime !== duration ||\n    iterationTime <= tickableDelay && tickablePrevTime > 0 ||\n    time <= tickablePrevTime && tickablePrevTime === duration && completed || // Force a render if a seek occurs on an completed animation\n    isCurrentTimeEqualOrAboveDuration && !completed && isSetter // This prevents 0 duration tickables to be skipped\n  ) {\n\n    if (isCurrentTimeAboveZero) {\n      // Trigger onUpdate callback before rendering\n      tickable.computeDeltaTime(tickablePrevTime);\n      if (!muteCallbacks) tickable.onBeforeUpdate(/** @type {CallbackArgument} */(tickable));\n    }\n\n    // Start tweens rendering\n    if (!_hasChildren) {\n\n      // Time has jumped more than globals.tickThreshold so consider this tick manual\n      const forcedRender = forcedTick || (isRunningBackwards ? deltaTime * -1 : deltaTime) >= globals.tickThreshold;\n      const absoluteTime = tickable._offset + (parent ? parent._offset : 0) + tickableDelay + iterationTime;\n\n      // Only Animation can have tweens, Timer returns undefined\n      let tween = /** @type {Tween} */(/** @type {JSAnimation} */(tickable)._head);\n      let tweenTarget;\n      let tweenStyle;\n      let tweenTargetTransforms;\n      let tweenTargetTransformsProperties;\n      let tweenTransformsNeedUpdate = 0;\n\n      while (tween) {\n\n        const tweenComposition = tween._composition;\n        const tweenCurrentTime = tween._currentTime;\n        const tweenChangeDuration = tween._changeDuration;\n        const tweenAbsEndTime = tween._absoluteStartTime + tween._changeDuration;\n        const tweenNextRep = tween._nextRep;\n        const tweenPrevRep = tween._prevRep;\n        const tweenHasComposition = tweenComposition !== compositionTypes.none;\n\n        if ((forcedRender || (\n            (tweenCurrentTime !== tweenChangeDuration || absoluteTime <= tweenAbsEndTime + (tweenNextRep ? tweenNextRep._delay : 0)) &&\n            (tweenCurrentTime !== 0 || absoluteTime >= tween._absoluteStartTime)\n          )) && (!tweenHasComposition || (\n            !tween._isOverridden &&\n            (!tween._isOverlapped || absoluteTime <= tweenAbsEndTime) &&\n            (!tweenNextRep || (tweenNextRep._isOverridden || absoluteTime <= tweenNextRep._absoluteStartTime)) &&\n            (!tweenPrevRep || (tweenPrevRep._isOverridden || (absoluteTime >= (tweenPrevRep._absoluteStartTime + tweenPrevRep._changeDuration) + tween._delay)))\n          ))\n        ) {\n\n          const tweenNewTime = tween._currentTime = clamp(iterationTime - tween._startTime, 0, tweenChangeDuration);\n          const tweenProgress = tween._ease(tweenNewTime / tween._updateDuration);\n          const tweenModifier = tween._modifier;\n          const tweenValueType = tween._valueType;\n          const tweenType = tween._tweenType;\n          const tweenIsObject = tweenType === tweenTypes.OBJECT;\n          const tweenIsNumber = tweenValueType === valueTypes.NUMBER;\n          // Only round the in-between frames values if the final value is a string\n          const tweenPrecision = (tweenIsNumber && tweenIsObject) || tweenProgress === 0 || tweenProgress === 1 ? -1 : globals.precision;\n\n          // Recompose tween value\n          /** @type {String|Number} */\n          let value;\n          /** @type {Number} */\n          let number;\n\n          if (tweenIsNumber) {\n            value = number = /** @type {Number} */(tweenModifier(round(interpolate(tween._fromNumber, tween._toNumber,  tweenProgress), tweenPrecision )));\n          } else if (tweenValueType === valueTypes.UNIT) {\n            // Rounding the values speed up string composition\n            number = /** @type {Number} */(tweenModifier(round(interpolate(tween._fromNumber, tween._toNumber,  tweenProgress), tweenPrecision)));\n            value = `${number}${tween._unit}`;\n          } else if (tweenValueType === valueTypes.COLOR) {\n            const fn = tween._fromNumbers;\n            const tn = tween._toNumbers;\n            const r = round(clamp(/** @type {Number} */(tweenModifier(interpolate(fn[0], tn[0], tweenProgress))), 0, 255), 0);\n            const g = round(clamp(/** @type {Number} */(tweenModifier(interpolate(fn[1], tn[1], tweenProgress))), 0, 255), 0);\n            const b = round(clamp(/** @type {Number} */(tweenModifier(interpolate(fn[2], tn[2], tweenProgress))), 0, 255), 0);\n            const a = clamp(/** @type {Number} */(tweenModifier(round(interpolate(fn[3], tn[3], tweenProgress), tweenPrecision))), 0, 1);\n            value = `rgba(${r},${g},${b},${a})`;\n            if (tweenHasComposition) {\n              const ns = tween._numbers;\n              ns[0] = r;\n              ns[1] = g;\n              ns[2] = b;\n              ns[3] = a;\n            }\n          } else if (tweenValueType === valueTypes.COMPLEX) {\n            value = tween._strings[0];\n            for (let j = 0, l = tween._toNumbers.length; j < l; j++) {\n              const n = /** @type {Number} */(tweenModifier(round(interpolate(tween._fromNumbers[j], tween._toNumbers[j], tweenProgress), tweenPrecision)));\n              const s = tween._strings[j + 1];\n              value += `${s ? n + s : n}`;\n              if (tweenHasComposition) {\n                tween._numbers[j] = n;\n              }\n            }\n          }\n\n          // For additive tweens and Animatables\n          if (tweenHasComposition) {\n            tween._number = number;\n          }\n\n          if (!internalRender && tweenComposition !== compositionTypes.blend) {\n\n            const tweenProperty = tween.property;\n            tweenTarget = tween.target;\n\n            if (tweenIsObject) {\n              tweenTarget[tweenProperty] = value;\n            } else if (tweenType === tweenTypes.ATTRIBUTE) {\n              /** @type {DOMTarget} */(tweenTarget).setAttribute(tweenProperty, /** @type {String} */(value));\n            } else {\n              tweenStyle = /** @type {DOMTarget} */(tweenTarget).style;\n              if (tweenType === tweenTypes.TRANSFORM) {\n                if (tweenTarget !== tweenTargetTransforms) {\n                  tweenTargetTransforms = tweenTarget;\n                  // NOTE: Referencing the cachedTransforms in the tween property directly can be a little bit faster but appears to increase memory usage.\n                  tweenTargetTransformsProperties = tweenTarget[transformsSymbol];\n                }\n                tweenTargetTransformsProperties[tweenProperty] = value;\n                tweenTransformsNeedUpdate = 1;\n              } else if (tweenType === tweenTypes.CSS) {\n                tweenStyle[tweenProperty] = value;\n              } else if (tweenType === tweenTypes.CSS_VAR) {\n                tweenStyle.setProperty(tweenProperty,/** @type {String} */(value));\n              }\n            }\n\n            if (isCurrentTimeAboveZero) hasRendered = 1;\n\n          } else {\n            // Used for composing timeline tweens without having to do a real render\n            tween._value = value;\n          }\n\n        }\n\n        // NOTE: Possible improvement: Use translate(x,y) / translate3d(x,y,z) syntax\n        // to reduce memory usage on string composition\n        if (tweenTransformsNeedUpdate && tween._renderTransforms) {\n          let str = emptyString;\n          for (let key in tweenTargetTransformsProperties) {\n            str += `${transformsFragmentStrings[key]}${tweenTargetTransformsProperties[key]}) `;\n          }\n          tweenStyle.transform = str;\n          tweenTransformsNeedUpdate = 0;\n        }\n\n        tween = tween._next;\n      }\n\n      if (!muteCallbacks && hasRendered) {\n        /** @type {JSAnimation} */(tickable).onRender(/** @type {JSAnimation} */(tickable));\n      }\n    }\n\n    if (!muteCallbacks && isCurrentTimeAboveZero) {\n      tickable.onUpdate(/** @type {CallbackArgument} */(tickable));\n    }\n\n  }\n\n  // End tweens rendering\n\n  // Handle setters on timeline differently and allow re-trigering the onComplete callback when seeking backwards\n  if (parent && isSetter) {\n    if (!muteCallbacks && (\n      (parent.began && !isRunningBackwards && tickableAbsoluteTime >= duration && !completed) ||\n      (isRunningBackwards && tickableAbsoluteTime <= minValue && completed)\n    )) {\n      tickable.onComplete(/** @type {CallbackArgument} */(tickable));\n      tickable.completed = !isRunningBackwards;\n    }\n  // If currentTime is both above 0 and at least equals to duration, handles normal onComplete or infinite loops\n  } else if (isCurrentTimeAboveZero && isCurrentTimeEqualOrAboveDuration) {\n    if (iterationCount === Infinity) {\n      // Offset the tickable _startTime with its duration to reset _currentTime to 0 and continue the infinite timer\n      tickable._startTime += tickable.duration;\n    } else if (tickable._currentIteration >= iterationCount - 1) {\n      // By setting paused to true, we tell the engine loop to not render this tickable and removes it from the list on the next tick\n      tickable.paused = true;\n      if (!completed && !_hasChildren) {\n        // If the tickable has children, triggers onComplete() only when all children have completed in the tick function\n        tickable.completed = true;\n        if (!muteCallbacks && !(parent && (isRunningBackwards || !parent.began))) {\n          tickable.onComplete(/** @type {CallbackArgument} */(tickable));\n          tickable._resolve(/** @type {CallbackArgument} */(tickable));\n        }\n      }\n    }\n  // Otherwise set the completed flag to false\n  } else {\n    tickable.completed = false;\n  }\n\n  // NOTE: hasRendered * direction (negative for backwards) this way we can remove the tickable.backwards property completly ?\n  return hasRendered;\n};\n\n/**\n * @param  {Tickable} tickable\n * @param  {Number} time\n * @param  {Number} muteCallbacks\n * @param  {Number} internalRender\n * @param  {Number} tickMode\n * @return {void}\n */\nconst tick = (tickable, time, muteCallbacks, internalRender, tickMode) => {\n  const _currentIteration = tickable._currentIteration;\n  render(tickable, time, muteCallbacks, internalRender, tickMode);\n  if (tickable._hasChildren) {\n    const tl = /** @type {Timeline} */(tickable);\n    const tlIsRunningBackwards = tl.backwards;\n    const tlChildrenTime = internalRender ? time : tl._iterationTime;\n    const tlCildrenTickTime = now();\n\n    let tlChildrenHasRendered = 0;\n    let tlChildrenHaveCompleted = true;\n\n    // If the timeline has looped forward, we need to manually triggers children skipped callbacks\n    if (!internalRender && tl._currentIteration !== _currentIteration) {\n      const tlIterationDuration = tl.iterationDuration;\n      forEachChildren(tl, (/** @type {JSAnimation} */child) => {\n        if (!tlIsRunningBackwards) {\n          // Force an internal render to trigger the callbacks if the child has not completed on loop\n          if (!child.completed && !child.backwards && child._currentTime < child.iterationDuration) {\n            render(child, tlIterationDuration, muteCallbacks, 1, tickModes.FORCE);\n          }\n          // Reset their began and completed flags to allow retrigering callbacks on the next iteration\n          child.began = false;\n          child.completed = false;\n        } else {\n          const childDuration = child.duration;\n          const childStartTime = child._offset + child._delay;\n          const childEndTime = childStartTime + childDuration;\n          // Triggers the onComplete callback on reverse for children on the edges of the timeline\n          if (!muteCallbacks && childDuration <= minValue && (!childStartTime || childEndTime === tlIterationDuration)) {\n            child.onComplete(child);\n          }\n        }\n      });\n      if (!muteCallbacks) tl.onLoop(/** @type {CallbackArgument} */(tl));\n    }\n\n    forEachChildren(tl, (/** @type {JSAnimation} */child) => {\n      const childTime = round((tlChildrenTime - child._offset) * child._speed, 12); // Rounding is needed when using seconds\n      const childTickMode = child._fps < tl._fps ? child.requestTick(tlCildrenTickTime) : tickMode;\n      tlChildrenHasRendered += render(child, childTime, muteCallbacks, internalRender, childTickMode);\n      if (!child.completed && tlChildrenHaveCompleted) tlChildrenHaveCompleted = false;\n    }, tlIsRunningBackwards);\n\n    // Renders on timeline are triggered by its children so it needs to be set after rendering the children\n    if (!muteCallbacks && tlChildrenHasRendered) tl.onRender(/** @type {CallbackArgument} */(tl));\n\n    // Triggers the timeline onComplete() once all chindren all completed and the current time has reached the end\n    if (tlChildrenHaveCompleted && tl._currentTime >= tl.duration) {\n      // Make sure the paused flag is false in case it has been skipped in the render function\n      tl.paused = true;\n      if (!tl.completed) {\n        tl.completed = true;\n        if (!muteCallbacks) {\n          tl.onComplete(/** @type {CallbackArgument} */(tl));\n          tl._resolve(/** @type {CallbackArgument} */(tl));\n        }\n      }\n    }\n  }\n};\n\n\n\n\nconst additive = {\n  animation: null,\n  update: noop,\n};\n\n/**\n * @typedef AdditiveAnimation\n * @property {Number} duration\n * @property {Number} _offset\n * @property {Number} _delay\n * @property {Tween} _head\n * @property {Tween} _tail\n */\n\n/**\n * @param  {TweenAdditiveLookups} lookups\n * @return {AdditiveAnimation}\n */\nconst addAdditiveAnimation = lookups => {\n  let animation = additive.animation;\n  if (!animation) {\n    animation = {\n      duration: minValue,\n      computeDeltaTime: noop,\n      _offset: 0,\n      _delay: 0,\n      _head: null,\n      _tail: null,\n    };\n    additive.animation = animation;\n    additive.update = () => {\n      lookups.forEach(propertyAnimation => {\n        for (let propertyName in propertyAnimation) {\n          const tweens = propertyAnimation[propertyName];\n          const lookupTween = tweens._head;\n          if (lookupTween) {\n            const valueType = lookupTween._valueType;\n            const additiveValues = valueType === valueTypes.COMPLEX || valueType === valueTypes.COLOR ? cloneArray(lookupTween._fromNumbers) : null;\n            let additiveValue = lookupTween._fromNumber;\n            let tween = tweens._tail;\n            while (tween && tween !== lookupTween) {\n              if (additiveValues) {\n                for (let i = 0, l = tween._numbers.length; i < l; i++) additiveValues[i] += tween._numbers[i];\n              } else {\n                additiveValue += tween._number;\n              }\n              tween = tween._prevAdd;\n            }\n            lookupTween._toNumber = additiveValue;\n            lookupTween._toNumbers = additiveValues;\n          }\n        }\n      });\n      // TODO: Avoid polymorphism here, idealy the additive animation should be a regular animation with a higher priority in the render loop\n      render(animation, 1, 1, 0, tickModes.FORCE);\n    };\n  }\n  return animation;\n};\n\nconst engineTickMethod = isBrowser ? requestAnimationFrame : setImmediate;\nconst engineCancelMethod = isBrowser ? cancelAnimationFrame : clearImmediate;\n\nclass Engine extends Clock {\n\n  /** @param {Number} [initTime] */\n  constructor(initTime) {\n    super(initTime);\n    this.useDefaultMainLoop = true;\n    this.pauseOnDocumentHidden = true;\n    /** @type {DefaultsParams} */\n    this.defaults = defaults;\n    this.paused = isBrowser && doc.hidden ? true  : false;\n    /** @type {Number|NodeJS.Immediate} */\n    this.reqId = null;\n  }\n\n  update() {\n    const time = this._currentTime = now();\n    if (this.requestTick(time)) {\n      this.computeDeltaTime(time);\n      const engineSpeed = this._speed;\n      const engineFps = this._fps;\n      let activeTickable = /** @type {Tickable} */(this._head);\n      while (activeTickable) {\n        const nextTickable = activeTickable._next;\n        if (!activeTickable.paused) {\n          tick(\n            activeTickable,\n            (time - activeTickable._startTime) * activeTickable._speed * engineSpeed,\n            0, // !muteCallbacks\n            0, // !internalRender\n            activeTickable._fps < engineFps ? activeTickable.requestTick(time) : tickModes.AUTO\n          );\n        } else {\n          removeChild(this, activeTickable);\n          this._hasChildren = !!this._tail;\n          activeTickable._running = false;\n          if (activeTickable.completed && !activeTickable._cancelled) {\n            activeTickable.cancel();\n          }\n        }\n        activeTickable = nextTickable;\n      }\n      additive.update();\n    }\n  }\n\n  wake() {\n    if (this.useDefaultMainLoop && !this.reqId && !this.paused) {\n      this.reqId = engineTickMethod(tickEngine);\n    }\n    return this;\n  }\n\n  pause() {\n    this.paused = true;\n    return killEngine();\n  }\n\n  resume() {\n    if (!this.paused) return;\n    this.paused = false;\n    forEachChildren(this, (/** @type {Tickable} */child) => child.resetTime());\n    return this.wake();\n  }\n\n  // Getter and setter for speed\n  get speed() {\n    return this._speed * (globals.timeScale === 1 ? 1 : K);\n  }\n\n  set speed(playbackRate) {\n    this._speed = playbackRate * globals.timeScale;\n    forEachChildren(this, (/** @type {Tickable} */child) => child.speed = child._speed);\n  }\n\n  // Getter and setter for timeUnit\n  get timeUnit() {\n    return globals.timeScale === 1 ? 'ms' : 's';\n  };\n\n  set timeUnit(unit) {\n    const secondsScale = 0.001;\n    const isSecond = unit === 's';\n    const newScale = isSecond ? secondsScale : 1;\n    if (globals.timeScale !== newScale) {\n      globals.timeScale = newScale;\n      globals.tickThreshold = 200 * newScale;\n      const scaleFactor = isSecond ? secondsScale : K;\n      /** @type {Number} */\n      (this.defaults.duration) *= scaleFactor;\n      this._speed *= scaleFactor;\n    }\n  }\n\n  // Getter and setter for precision\n  get precision() {\n    return globals.precision;\n  }\n\n  set precision(precision) {\n    globals.precision = precision;\n  }\n\n}\nconst engine = /*#__PURE__*/(() => {\n  const engine = new Engine(now());\n  if (isBrowser) {\n    globalVersions.engine = engine;\n    doc.addEventListener('visibilitychange', () => {\n      if (!engine.pauseOnDocumentHidden) return;\n      doc.hidden ? engine.pause() : engine.resume();\n    });\n  }\n  return engine;\n})();\n\n\nconst tickEngine = () => {\n  if (engine._head) {\n    engine.reqId = engineTickMethod(tickEngine);\n    engine.update();\n  } else {\n    engine.reqId = 0;\n  }\n};\n\nconst killEngine = () => {\n  engineCancelMethod(/** @type {NodeJS.Immediate & Number} */(engine.reqId));\n  engine.reqId = 0;\n  return engine;\n};\n\n\n\n\n/**\n * @param  {DOMTarget} target\n * @param  {String} propName\n * @param  {Object} animationInlineStyles\n * @return {String}\n */\nconst parseInlineTransforms = (target, propName, animationInlineStyles) => {\n  const inlineTransforms = target.style.transform;\n  let inlinedStylesPropertyValue;\n  if (inlineTransforms) {\n    const cachedTransforms = target[transformsSymbol];\n    let t; while (t = transformsExecRgx.exec(inlineTransforms)) {\n      const inlinePropertyName = t[1];\n      // const inlinePropertyValue = t[2];\n      const inlinePropertyValue = t[2].slice(1, -1);\n      cachedTransforms[inlinePropertyName] = inlinePropertyValue;\n      if (inlinePropertyName === propName) {\n        inlinedStylesPropertyValue = inlinePropertyValue;\n        // Store the new parsed inline styles if animationInlineStyles is provided\n        if (animationInlineStyles) {\n          animationInlineStyles[propName] = inlinePropertyValue;\n        }\n      }\n    }\n  }\n  return inlineTransforms && !isUnd(inlinedStylesPropertyValue) ? inlinedStylesPropertyValue :\n    stringStartsWith(propName, 'scale') ? '1' :\n    stringStartsWith(propName, 'rotate') || stringStartsWith(propName, 'skew') ? '0deg' : '0px';\n};\n\n\n\n\n/**\n * @param  {DOMTargetsParam|TargetsParam} v\n * @return {NodeList|HTMLCollection}\n */\nfunction getNodeList(v) {\n  const n = isStr(v) ? globals.root.querySelectorAll(v) : v;\n  if (n instanceof NodeList || n instanceof HTMLCollection) return n;\n}\n\n/**\n * @overload\n * @param  {DOMTargetsParam} targets\n * @return {DOMTargetsArray}\n *\n * @overload\n * @param  {JSTargetsParam} targets\n * @return {JSTargetsArray}\n *\n * @overload\n * @param  {TargetsParam} targets\n * @return {TargetsArray}\n *\n * @param  {DOMTargetsParam|JSTargetsParam|TargetsParam} targets\n */\nfunction parseTargets(targets) {\n  if (isNil(targets)) return /** @type {TargetsArray} */([]);\n  if (isArr(targets)) {\n    const flattened = targets.flat(Infinity);\n    /** @type {TargetsArray} */\n    const parsed = [];\n    for (let i = 0, l = flattened.length; i < l; i++) {\n      const item = flattened[i];\n      if (!isNil(item)) {\n        const nodeList = getNodeList(item);\n        if (nodeList) {\n          for (let j = 0, jl = nodeList.length; j < jl; j++) {\n            const subItem = nodeList[j];\n            if (!isNil(subItem)) {\n              let isDuplicate = false;\n              for (let k = 0, kl = parsed.length; k < kl; k++) {\n                if (parsed[k] === subItem) {\n                  isDuplicate = true;\n                  break;\n                }\n              }\n              if (!isDuplicate) {\n                parsed.push(subItem);\n              }\n            }\n          }\n        } else {\n          let isDuplicate = false;\n          for (let j = 0, jl = parsed.length; j < jl; j++) {\n            if (parsed[j] === item) {\n              isDuplicate = true;\n              break;\n            }\n          }\n          if (!isDuplicate) {\n            parsed.push(item);\n          }\n        }\n      }\n    }\n    return parsed;\n  }\n  if (!isBrowser) return /** @type {JSTargetsArray} */([targets]);\n  const nodeList = getNodeList(targets);\n  if (nodeList) return /** @type {DOMTargetsArray} */(Array.from(nodeList));\n  return /** @type {TargetsArray} */([targets]);\n}\n\n/**\n * @overload\n * @param  {DOMTargetsParam} targets\n * @return {DOMTargetsArray}\n *\n * @overload\n * @param  {JSTargetsParam} targets\n * @return {JSTargetsArray}\n *\n * @overload\n * @param  {TargetsParam} targets\n * @return {TargetsArray}\n *\n * @param  {DOMTargetsParam|JSTargetsParam|TargetsParam} targets\n */\nfunction registerTargets(targets) {\n  const parsedTargetsArray = parseTargets(targets);\n  const parsedTargetsLength = parsedTargetsArray.length;\n  if (parsedTargetsLength) {\n    for (let i = 0; i < parsedTargetsLength; i++) {\n      const target = parsedTargetsArray[i];\n      if (!target[isRegisteredTargetSymbol]) {\n        target[isRegisteredTargetSymbol] = true;\n        const isSvgType = isSvg(target);\n        const isDom = /** @type {DOMTarget} */(target).nodeType || isSvgType;\n        if (isDom) {\n          target[isDomSymbol] = true;\n          target[isSvgSymbol] = isSvgType;\n          target[transformsSymbol] = {};\n        }\n      }\n    }\n  }\n  return parsedTargetsArray;\n}\n\n\n\n\n/**\n * @param  {TargetsParam} path\n * @return {SVGGeometryElement|undefined}\n */\nconst getPath = path => {\n  const parsedTargets = parseTargets(path);\n  const $parsedSvg = /** @type {SVGGeometryElement} */(parsedTargets[0]);\n  if (!$parsedSvg || !isSvg($parsedSvg)) return;\n  return $parsedSvg;\n};\n\n/**\n * @param  {TargetsParam} path2\n * @param  {Number} [precision]\n * @return {FunctionValue}\n */\nconst morphTo = (path2, precision = .33) => ($path1) => {\n  const $path2 = /** @type {SVGGeometryElement} */(getPath(path2));\n  if (!$path2) return;\n  const isPath = $path1.tagName === 'path';\n  const separator = isPath ? ' ' : ',';\n  const previousPoints = $path1[morphPointsSymbol];\n  if (previousPoints) $path1.setAttribute(isPath ? 'd' : 'points', previousPoints);\n\n  let v1 = '', v2 = '';\n\n  if (!precision) {\n    v1 = $path1.getAttribute(isPath ? 'd' : 'points');\n    v2 = $path2.getAttribute(isPath ? 'd' : 'points');\n  } else {\n    const length1 = /** @type {SVGGeometryElement} */($path1).getTotalLength();\n    const length2 = $path2.getTotalLength();\n    const maxPoints = Math.max(Math.ceil(length1 * precision), Math.ceil(length2 * precision));\n    for (let i = 0; i < maxPoints; i++) {\n      const t = i / (maxPoints - 1);\n      const pointOnPath1 = /** @type {SVGGeometryElement} */($path1).getPointAtLength(length1 * t);\n      const pointOnPath2 = $path2.getPointAtLength(length2 * t);\n      const prefix = isPath ? (i === 0 ? 'M' : 'L') : '';\n      v1 += prefix + round(pointOnPath1.x, 3) + separator + pointOnPath1.y + ' ';\n      v2 += prefix + round(pointOnPath2.x, 3) + separator + pointOnPath2.y + ' ';\n    }\n  }\n\n  $path1[morphPointsSymbol] = v2;\n\n  return [v1, v2];\n};\n\n/**\n * @param {SVGGeometryElement} [$el]\n * @return {Number}\n */\nconst getScaleFactor = $el => {\n  let scaleFactor = 1;\n  if ($el && $el.getCTM) {\n    const ctm = $el.getCTM();\n    if (ctm) {\n      const scaleX = sqrt(ctm.a * ctm.a + ctm.b * ctm.b);\n      const scaleY = sqrt(ctm.c * ctm.c + ctm.d * ctm.d);\n      scaleFactor = (scaleX + scaleY) / 2;\n    }\n  }\n  return scaleFactor;\n};\n\n/**\n * Creates a proxy that wraps an SVGGeometryElement and adds drawing functionality.\n * @param {SVGGeometryElement} $el - The SVG element to transform into a drawable\n * @param {number} start - Starting position (0-1)\n * @param {number} end - Ending position (0-1)\n * @return {DrawableSVGGeometry} - Returns a proxy that preserves the original element's type with additional 'draw' attribute functionality\n */\nconst createDrawableProxy = ($el, start, end) => {\n  const pathLength = K;\n  const computedStyles = getComputedStyle($el);\n  const strokeLineCap = computedStyles.strokeLinecap;\n  // @ts-ignore\n  const $scalled = computedStyles.vectorEffect === 'non-scaling-stroke' ? $el : null;\n  let currentCap = strokeLineCap;\n\n  const proxy = new Proxy($el, {\n    get(target, property) {\n      const value = target[property];\n      if (property === proxyTargetSymbol) return target;\n      if (property === 'setAttribute') {\n        return (...args) => {\n          if (args[0] === 'draw') {\n            const value = args[1];\n            const values = value.split(' ');\n            const v1 = +values[0];\n            const v2 = +values[1];\n            // TOTO: Benchmark if performing two slices is more performant than one split\n            // const spaceIndex = value.indexOf(' ');\n            // const v1 = round(+value.slice(0, spaceIndex), precision);\n            // const v2 = round(+value.slice(spaceIndex + 1), precision);\n            const scaleFactor = getScaleFactor($scalled);\n            const os = v1 * -1e3 * scaleFactor;\n            const d1 = (v2 * pathLength * scaleFactor) + os;\n            const d2 = (pathLength * scaleFactor +\n                      ((v1 === 0 && v2 === 1) || (v1 === 1 && v2 === 0) ? 0 : 10 * scaleFactor) - d1);\n            if (strokeLineCap !== 'butt') {\n              const newCap = v1 === v2 ? 'butt' : strokeLineCap;\n              if (currentCap !== newCap) {\n                target.style.strokeLinecap = `${newCap}`;\n                currentCap = newCap;\n              }\n            }\n            target.setAttribute('stroke-dashoffset', `${os}`);\n            target.setAttribute('stroke-dasharray', `${d1} ${d2}`);\n          }\n          return Reflect.apply(value, target, args);\n        };\n      }\n\n      if (isFnc(value)) {\n        return (...args) => Reflect.apply(value, target, args);\n      } else {\n        return value;\n      }\n    }\n  });\n\n  if ($el.getAttribute('pathLength') !== `${pathLength}`) {\n    $el.setAttribute('pathLength', `${pathLength}`);\n    proxy.setAttribute('draw', `${start} ${end}`);\n  }\n\n  return /** @type {DrawableSVGGeometry} */(proxy);\n};\n\n/**\n * Creates drawable proxies for multiple SVG elements.\n * @param {TargetsParam} selector - CSS selector, SVG element, or array of elements and selectors\n * @param {number} [start=0] - Starting position (0-1)\n * @param {number} [end=0] - Ending position (0-1)\n * @return {Array<DrawableSVGGeometry>} - Array of proxied elements with drawing functionality\n */\nconst createDrawable = (selector, start = 0, end = 0) => {\n  const els = parseTargets(selector);\n  return els.map($el => createDrawableProxy(\n    /** @type {SVGGeometryElement} */($el),\n    start,\n    end\n  ));\n};\n\n// Motion path animation\n\n/**\n * @param {SVGGeometryElement} $path\n * @param {Number} progress\n * @param {Number}lookup\n * @return {DOMPoint}\n */\nconst getPathPoint = ($path, progress, lookup = 0) => {\n  return $path.getPointAtLength(progress + lookup >= 1 ? progress + lookup : 0);\n};\n\n/**\n * @param {SVGGeometryElement} $path\n * @param {String} pathProperty\n * @return {FunctionValue}\n */\nconst getPathProgess = ($path, pathProperty) => {\n  return $el => {\n    const totalLength = +($path.getTotalLength());\n    const inSvg = $el[isSvgSymbol];\n    const ctm = $path.getCTM();\n    /** @type {TweenObjectValue} */\n    return {\n      from: 0,\n      to: totalLength,\n      /** @type {TweenModifier} */\n      modifier: progress => {\n        if (pathProperty === 'a') {\n          const p0 = getPathPoint($path, progress, -1);\n          const p1 = getPathPoint($path, progress, 1);\n          return atan2(p1.y - p0.y, p1.x - p0.x) * 180 / PI;\n        } else {\n          const p = getPathPoint($path, progress, 0);\n          return pathProperty === 'x' ?\n            inSvg || !ctm ? p.x : p.x * ctm.a + p.y * ctm.c + ctm.e :\n            inSvg || !ctm ? p.y : p.x * ctm.b + p.y * ctm.d + ctm.f\n        }\n      }\n    }\n  }\n};\n\n/**\n * @param {TargetsParam} path\n */\nconst createMotionPath = path => {\n  const $path = getPath(path);\n  if (!$path) return;\n  return {\n    translateX: getPathProgess($path, 'x'),\n    translateY: getPathProgess($path, 'y'),\n    rotate: getPathProgess($path, 'a'),\n  }\n};\n\n// Check for valid SVG attribute\n\nconst cssReservedProperties = ['opacity', 'rotate', 'overflow', 'color'];\n\n/**\n * @param  {Target} el\n * @param  {String} propertyName\n * @return {Boolean}\n */\nconst isValidSVGAttribute = (el, propertyName) => {\n  // Return early and use CSS opacity animation instead (already better default values (opacity: 1 instead of 0)) and rotate should be considered a transform\n  if (cssReservedProperties.includes(propertyName)) return false;\n  if (el.getAttribute(propertyName) || propertyName in el) {\n    if (propertyName === 'scale') { // Scale\n      const elParentNode = /** @type {SVGGeometryElement} */(/** @type {DOMTarget} */(el).parentNode);\n      // Only consider scale as a valid SVG attribute on filter element\n      return elParentNode && elParentNode.tagName === 'filter';\n    }\n    return true;\n  }\n};\n\nconst svg = {\n  morphTo,\n  createMotionPath,\n  createDrawable,\n};\n\n\n\n\n/**\n * RGB / RGBA Color value string -> RGBA values array\n * @param  {String} rgbValue\n * @return {ColorArray}\n */\nconst rgbToRgba = rgbValue => {\n  const rgba = rgbExecRgx.exec(rgbValue) || rgbaExecRgx.exec(rgbValue);\n  const a = !isUnd(rgba[4]) ? +rgba[4] : 1;\n  return [\n    +rgba[1],\n    +rgba[2],\n    +rgba[3],\n    a\n  ]\n};\n\n/**\n * HEX3 / HEX3A / HEX6 / HEX6A Color value string -> RGBA values array\n * @param  {String} hexValue\n * @return {ColorArray}\n */\nconst hexToRgba = hexValue => {\n  const hexLength = hexValue.length;\n  const isShort = hexLength === 4 || hexLength === 5;\n  return [\n    +('0x' + hexValue[1] + hexValue[isShort ? 1 : 2]),\n    +('0x' + hexValue[isShort ? 2 : 3] + hexValue[isShort ? 2 : 4]),\n    +('0x' + hexValue[isShort ? 3 : 5] + hexValue[isShort ? 3 : 6]),\n    ((hexLength === 5 || hexLength === 9) ? +(+('0x' + hexValue[isShort ? 4 : 7] + hexValue[isShort ? 4 : 8]) / 255).toFixed(3) : 1)\n  ]\n};\n\n/**\n * @param  {Number} p\n * @param  {Number} q\n * @param  {Number} t\n * @return {Number}\n */\nconst hue2rgb = (p, q, t) => {\n  if (t < 0) t += 1;\n  if (t > 1) t -= 1;\n  return t < 1 / 6 ? p + (q - p) * 6 * t :\n         t < 1 / 2 ? q :\n         t < 2 / 3 ? p + (q - p) * (2 / 3 - t) * 6 :\n         p;\n};\n\n/**\n * HSL / HSLA Color value string -> RGBA values array\n * @param  {String} hslValue\n * @return {ColorArray}\n */\nconst hslToRgba = hslValue => {\n  const hsla = hslExecRgx.exec(hslValue) || hslaExecRgx.exec(hslValue);\n  const h = +hsla[1] / 360;\n  const s = +hsla[2] / 100;\n  const l = +hsla[3] / 100;\n  const a = !isUnd(hsla[4]) ? +hsla[4] : 1;\n  let r, g, b;\n  if (s === 0) {\n    r = g = b = l;\n  } else {\n    const q = l < .5 ? l * (1 + s) : l + s - l * s;\n    const p = 2 * l - q;\n    r = round(hue2rgb(p, q, h + 1 / 3) * 255, 0);\n    g = round(hue2rgb(p, q, h) * 255, 0);\n    b = round(hue2rgb(p, q, h - 1 / 3) * 255, 0);\n  }\n  return [r, g, b, a];\n};\n\n/**\n * All in one color converter that converts a color string value into an array of RGBA values\n * @param  {String} colorString\n * @return {ColorArray}\n */\nconst convertColorStringValuesToRgbaArray = colorString => {\n  return isRgb(colorString) ? rgbToRgba(colorString) :\n         isHex(colorString) ? hexToRgba(colorString) :\n         isHsl(colorString) ? hslToRgba(colorString) :\n         [0, 0, 0, 1];\n};\n\n\n\n\n/**\n * @template T, D\n * @param {T|undefined} targetValue\n * @param {D} defaultValue\n * @return {T|D}\n */\nconst setValue = (targetValue, defaultValue) => {\n  return isUnd(targetValue) ? defaultValue : targetValue;\n};\n\n/**\n * @param  {TweenPropValue} value\n * @param  {Target} target\n * @param  {Number} index\n * @param  {Number} total\n * @param  {Object} [store]\n * @return {any}\n */\nconst getFunctionValue = (value, target, index, total, store) => {\n  if (isFnc(value)) {\n    const func = () => {\n      const computed = /** @type {Function} */(value)(target, index, total);\n      // Fallback to 0 if the function returns undefined / NaN / null / false / 0\n      return !isNaN(+computed) ? +computed : computed || 0;\n    };\n    if (store) {\n      store.func = func;\n    }\n    return func();\n  } else {\n    return value;\n  }\n};\n\n/**\n * @param  {Target} target\n * @param  {String} prop\n * @return {tweenTypes}\n */\nconst getTweenType = (target, prop) => {\n  return !target[isDomSymbol] ? tweenTypes.OBJECT :\n    // Handle SVG attributes\n    target[isSvgSymbol] && isValidSVGAttribute(target, prop) ? tweenTypes.ATTRIBUTE :\n    // Handle CSS Transform properties differently than CSS to allow individual animations\n    validTransforms.includes(prop) || shortTransforms.get(prop) ? tweenTypes.TRANSFORM :\n    // CSS variables\n    stringStartsWith(prop, '--') ? tweenTypes.CSS_VAR :\n    // All other CSS properties\n    prop in /** @type {DOMTarget} */(target).style ? tweenTypes.CSS :\n    // Handle other DOM Attributes\n    prop in target ? tweenTypes.OBJECT :\n    tweenTypes.ATTRIBUTE;\n};\n\n/**\n * @param  {DOMTarget} target\n * @param  {String} propName\n * @param  {Object} animationInlineStyles\n * @return {String}\n */\nconst getCSSValue = (target, propName, animationInlineStyles) => {\n  const inlineStyles = target.style[propName];\n  if (inlineStyles && animationInlineStyles) {\n    animationInlineStyles[propName] = inlineStyles;\n  }\n  const value = inlineStyles || getComputedStyle(target[proxyTargetSymbol] || target).getPropertyValue(propName);\n  return value === 'auto' ? '0' : value;\n};\n\n/**\n * @param {Target} target\n * @param {String} propName\n * @param {tweenTypes} [tweenType]\n * @param {Object|void} [animationInlineStyles]\n * @return {String|Number}\n */\nconst getOriginalAnimatableValue = (target, propName, tweenType, animationInlineStyles) => {\n  const type = !isUnd(tweenType) ? tweenType : getTweenType(target, propName);\n  return type === tweenTypes.OBJECT ? target[propName] || 0 :\n         type === tweenTypes.ATTRIBUTE ? /** @type {DOMTarget} */(target).getAttribute(propName) :\n         type === tweenTypes.TRANSFORM ? parseInlineTransforms(/** @type {DOMTarget} */(target), propName, animationInlineStyles) :\n         type === tweenTypes.CSS_VAR ? getCSSValue(/** @type {DOMTarget} */(target), propName, animationInlineStyles).trimStart() :\n         getCSSValue(/** @type {DOMTarget} */(target), propName, animationInlineStyles);\n};\n\n/**\n * @param  {Number} x\n * @param  {Number} y\n * @param  {String} operator\n * @return {Number}\n */\nconst getRelativeValue = (x, y, operator) => {\n  return operator === '-' ? x - y :\n         operator === '+' ? x + y :\n         x * y;\n};\n\n/** @return {TweenDecomposedValue} */\nconst createDecomposedValueTargetObject = () => {\n  return {\n    /** @type {valueTypes} */\n    t: valueTypes.NUMBER,\n    n: 0,\n    u: null,\n    o: null,\n    d: null,\n    s: null,\n  }\n};\n\n/**\n * @param  {String|Number} rawValue\n * @param  {TweenDecomposedValue} targetObject\n * @return {TweenDecomposedValue}\n */\nconst decomposeRawValue = (rawValue, targetObject) => {\n  /** @type {valueTypes} */\n  targetObject.t = valueTypes.NUMBER;\n  targetObject.n = 0;\n  targetObject.u = null;\n  targetObject.o = null;\n  targetObject.d = null;\n  targetObject.s = null;\n  if (!rawValue) return targetObject;\n  const num = +rawValue;\n  if (!isNaN(num)) {\n    // It's a number\n    targetObject.n = num;\n    return targetObject;\n  } else {\n    // let str = /** @type {String} */(rawValue).trim();\n    let str = /** @type {String} */(rawValue);\n    // Parsing operators (+=, -=, *=) manually is much faster than using regex here\n    if (str[1] === '=') {\n      targetObject.o = str[0];\n      str = str.slice(2);\n    }\n    // Skip exec regex if the value type is complex or color to avoid long regex backtracking\n    const unitMatch = str.includes(' ') ? false : unitsExecRgx.exec(str);\n    if (unitMatch) {\n      // Has a number and a unit\n      targetObject.t = valueTypes.UNIT;\n      targetObject.n = +unitMatch[1];\n      targetObject.u = unitMatch[2];\n      return targetObject;\n    } else if (targetObject.o) {\n      // Has an operator (+=, -=, *=)\n      targetObject.n = +str;\n      return targetObject;\n    } else if (isCol(str)) {\n      // Is a color\n      targetObject.t = valueTypes.COLOR;\n      targetObject.d = convertColorStringValuesToRgbaArray(str);\n      return targetObject;\n    } else {\n      // Is a more complex string (generally svg coords, calc() or filters CSS values)\n      const matchedNumbers = str.match(digitWithExponentRgx);\n      targetObject.t = valueTypes.COMPLEX;\n      targetObject.d = matchedNumbers ? matchedNumbers.map(Number) : [];\n      targetObject.s = str.split(digitWithExponentRgx) || [];\n      return targetObject;\n    }\n  }\n};\n\n/**\n * @param  {Tween} tween\n * @param  {TweenDecomposedValue} targetObject\n * @return {TweenDecomposedValue}\n */\nconst decomposeTweenValue = (tween, targetObject) => {\n  targetObject.t = tween._valueType;\n  targetObject.n = tween._toNumber;\n  targetObject.u = tween._unit;\n  targetObject.o = null;\n  targetObject.d = cloneArray(tween._toNumbers);\n  targetObject.s = cloneArray(tween._strings);\n  return targetObject;\n};\n\nconst decomposedOriginalValue = createDecomposedValueTargetObject();\n\n\n\n\nconst lookups = {\n  /** @type {TweenReplaceLookups} */\n  _rep: new WeakMap(),\n  /** @type {TweenAdditiveLookups} */\n  _add: new Map(),\n};\n\n/**\n * @param  {Target} target\n * @param  {String} property\n * @param  {String} lookup\n * @return {TweenPropertySiblings}\n */\nconst getTweenSiblings = (target, property, lookup = '_rep') => {\n  const lookupMap = lookups[lookup];\n  let targetLookup = lookupMap.get(target);\n  if (!targetLookup) {\n    targetLookup = {};\n    lookupMap.set(target, targetLookup);\n  }\n  return targetLookup[property] ? targetLookup[property] : targetLookup[property] = {\n    _head: null,\n    _tail: null,\n  }\n};\n\n/**\n * @param  {Tween} p\n * @param  {Tween} c\n * @return {Number|Boolean}\n */\nconst addTweenSortMethod = (p, c) => {\n  return p._isOverridden || p._absoluteStartTime > c._absoluteStartTime;\n};\n\n/**\n * @param {Tween} tween\n */\nconst overrideTween = tween => {\n  tween._isOverlapped = 1;\n  tween._isOverridden = 1;\n  tween._changeDuration = minValue;\n  tween._currentTime = minValue;\n};\n\n/**\n * @param  {Tween} tween\n * @param  {TweenPropertySiblings} siblings\n * @return {Tween}\n */\nconst composeTween = (tween, siblings) => {\n\n  const tweenCompositionType = tween._composition;\n\n  // Handle replaced tweens\n\n  if (tweenCompositionType === compositionTypes.replace) {\n\n    const tweenAbsStartTime = tween._absoluteStartTime;\n\n    addChild(siblings, tween, addTweenSortMethod, '_prevRep', '_nextRep');\n\n    const prevSibling = tween._prevRep;\n\n    // Update the previous siblings for composition replace tweens\n\n    if (prevSibling) {\n\n      const prevParent = prevSibling.parent;\n      const prevAbsEndTime = prevSibling._absoluteStartTime + prevSibling._changeDuration;\n\n      // Handle looped animations tween\n\n      if (\n        // Check if the previous tween is from a different animation\n        tween.parent.id !== prevParent.id &&\n        // Check if the animation has loops\n        prevParent.iterationCount> 1 &&\n        // Check if _absoluteChangeEndTime of last loop overlaps the current tween\n        prevAbsEndTime + (prevParent.duration - prevParent.iterationDuration) > tweenAbsStartTime\n      ) {\n\n        // TODO: Find a way to only override the iterations overlapping with the tween\n        overrideTween(prevSibling);\n\n        let prevPrevSibling = prevSibling._prevRep;\n\n        // If the tween was part of a set of keyframes, override its siblings\n        while (prevPrevSibling && prevPrevSibling.parent.id === prevParent.id) {\n          overrideTween(prevPrevSibling);\n          prevPrevSibling = prevPrevSibling._prevRep;\n        }\n\n      }\n\n      const absoluteUpdateStartTime = tweenAbsStartTime - tween._delay;\n\n      if (prevAbsEndTime > absoluteUpdateStartTime) {\n\n        const prevChangeStartTime = prevSibling._startTime;\n        const prevTLOffset = prevAbsEndTime - (prevChangeStartTime + prevSibling._updateDuration);\n\n        prevSibling._changeDuration = absoluteUpdateStartTime - prevTLOffset - prevChangeStartTime;\n        prevSibling._currentTime = prevSibling._changeDuration;\n        prevSibling._isOverlapped = 1;\n\n        if (prevSibling._changeDuration < minValue) {\n          overrideTween(prevSibling);\n        }\n      }\n\n      // Pause (and cancel) the parent if it only contains overlapped tweens\n\n      let pausePrevParentAnimation = true;\n\n      forEachChildren(prevParent, (/** @type Tween */t) => {\n        if (!t._isOverlapped) pausePrevParentAnimation = false;\n      });\n\n      if (pausePrevParentAnimation) {\n        const prevParentTL = prevParent.parent;\n        if (prevParentTL) {\n          let pausePrevParentTL = true;\n          forEachChildren(prevParentTL, (/** @type JSAnimation */a) => {\n            if (a !== prevParent) {\n              forEachChildren(a, (/** @type Tween */t) => {\n                if (!t._isOverlapped) pausePrevParentTL = false;\n              });\n            }\n          });\n          if (pausePrevParentTL) {\n            prevParentTL.cancel();\n          }\n        } else {\n          prevParent.cancel();\n          // Previously, calling .cancel() on a timeline child would affect the render order of other children\n          // Worked around this by marking it as .completed and using .pause() for safe removal in the engine loop\n          // This is no longer needed since timeline tween composition is now handled separatly\n          // Keeping this here for reference\n          // prevParent.completed = true;\n          // prevParent.pause();\n        }\n      }\n\n    }\n\n    // let nextSibling = tween._nextRep;\n\n    // // All the next siblings are automatically overridden\n\n    // if (nextSibling && nextSibling._absoluteStartTime >= tweenAbsStartTime) {\n    //   while (nextSibling) {\n    //     overrideTween(nextSibling);\n    //     nextSibling = nextSibling._nextRep;\n    //   }\n    // }\n\n    // if (nextSibling && nextSibling._absoluteStartTime < tweenAbsStartTime) {\n    //   while (nextSibling) {\n    //     overrideTween(nextSibling);\n    //     console.log(tween.id, nextSibling.id);\n    //     nextSibling = nextSibling._nextRep;\n    //   }\n    // }\n\n  // Handle additive tweens composition\n\n  } else if (tweenCompositionType === compositionTypes.blend) {\n\n    const additiveTweenSiblings = getTweenSiblings(tween.target, tween.property, '_add');\n    const additiveAnimation = addAdditiveAnimation(lookups._add);\n\n    let lookupTween = additiveTweenSiblings._head;\n\n    if (!lookupTween) {\n      lookupTween = { ...tween };\n      lookupTween._composition = compositionTypes.replace;\n      lookupTween._updateDuration = minValue;\n      lookupTween._startTime = 0;\n      lookupTween._numbers = cloneArray(tween._fromNumbers);\n      lookupTween._number = 0;\n      lookupTween._next = null;\n      lookupTween._prev = null;\n      addChild(additiveTweenSiblings, lookupTween);\n      addChild(additiveAnimation, lookupTween);\n    }\n\n    // Convert the values of TO to FROM and set TO to 0\n\n    const toNumber = tween._toNumber;\n    tween._fromNumber = lookupTween._fromNumber - toNumber;\n    tween._toNumber = 0;\n    tween._numbers = cloneArray(tween._fromNumbers);\n    tween._number = 0;\n    lookupTween._fromNumber = toNumber;\n\n    if (tween._toNumbers) {\n      const toNumbers = cloneArray(tween._toNumbers);\n      if (toNumbers) {\n        toNumbers.forEach((value, i) => {\n          tween._fromNumbers[i] = lookupTween._fromNumbers[i] - value;\n          tween._toNumbers[i] = 0;\n        });\n      }\n      lookupTween._fromNumbers = toNumbers;\n    }\n\n    addChild(additiveTweenSiblings, tween, null, '_prevAdd', '_nextAdd');\n\n  }\n\n  return tween;\n\n};\n\n/**\n * @param  {Tween} tween\n * @return {Tween}\n */\nconst removeTweenSliblings = tween => {\n  const tweenComposition = tween._composition;\n  if (tweenComposition !== compositionTypes.none) {\n    const tweenTarget = tween.target;\n    const tweenProperty = tween.property;\n    const replaceTweensLookup = lookups._rep;\n    const replaceTargetProps = replaceTweensLookup.get(tweenTarget);\n    const tweenReplaceSiblings = replaceTargetProps[tweenProperty];\n    removeChild(tweenReplaceSiblings, tween, '_prevRep', '_nextRep');\n    if (tweenComposition === compositionTypes.blend) {\n      const addTweensLookup = lookups._add;\n      const addTargetProps = addTweensLookup.get(tweenTarget);\n      if (!addTargetProps) return;\n      const additiveTweenSiblings = addTargetProps[tweenProperty];\n      const additiveAnimation = additive.animation;\n      removeChild(additiveTweenSiblings, tween, '_prevAdd', '_nextAdd');\n      // If only one tween is left in the additive lookup, it's the tween lookup\n      const lookupTween = additiveTweenSiblings._head;\n      if (lookupTween && lookupTween === additiveTweenSiblings._tail) {\n        removeChild(additiveTweenSiblings, lookupTween, '_prevAdd', '_nextAdd');\n        removeChild(additiveAnimation, lookupTween);\n        let shouldClean = true;\n        for (let prop in addTargetProps) {\n          if (addTargetProps[prop]._head) {\n            shouldClean = false;\n            break;\n          }\n        }\n        if (shouldClean) {\n          addTweensLookup.delete(tweenTarget);\n        }\n      }\n    }\n  }\n  return tween;\n};\n\n\n\n\n/**\n * @param  {Timer} timer\n * @return {Timer}\n */\nconst resetTimerProperties = timer => {\n  timer.paused = true;\n  timer.began = false;\n  timer.completed = false;\n  return timer;\n};\n\n/**\n * @param  {Timer} timer\n * @return {Timer}\n */\nconst reviveTimer = timer => {\n  if (!timer._cancelled) return timer;\n  if (timer._hasChildren) {\n    forEachChildren(timer, reviveTimer);\n  } else {\n    forEachChildren(timer, (/** @type {Tween} tween*/tween) => {\n      if (tween._composition !== compositionTypes.none) {\n        composeTween(tween, getTweenSiblings(tween.target, tween.property));\n      }\n    });\n  }\n  timer._cancelled = 0;\n  return timer;\n};\n\nlet timerId = 0;\n\n/**\n * Base class used to create Timers, Animations and Timelines\n */\nclass Timer extends Clock {\n  /**\n   * @param {TimerParams} [parameters]\n   * @param {Timeline} [parent]\n   * @param {Number} [parentPosition]\n   */\n  constructor(parameters = {}, parent = null, parentPosition = 0) {\n\n    super(0);\n\n    const {\n      id,\n      delay,\n      duration,\n      reversed,\n      alternate,\n      loop,\n      loopDelay,\n      autoplay,\n      frameRate,\n      playbackRate,\n      onComplete,\n      onLoop,\n      onPause,\n      onBegin,\n      onBeforeUpdate,\n      onUpdate,\n    } = parameters;\n\n    if (globals.scope) globals.scope.revertibles.push(this);\n\n    const timerInitTime = parent ? 0 : engine._elapsedTime;\n    const timerDefaults = parent ? parent.defaults : globals.defaults;\n    const timerDelay = /** @type {Number} */(isFnc(delay) || isUnd(delay) ? timerDefaults.delay : +delay);\n    const timerDuration = isFnc(duration) || isUnd(duration) ? Infinity : +duration;\n    const timerLoop = setValue(loop, timerDefaults.loop);\n    const timerLoopDelay = setValue(loopDelay, timerDefaults.loopDelay);\n    const timerIterationCount = timerLoop === true ||\n                                timerLoop === Infinity ||\n                                /** @type {Number} */(timerLoop) < 0 ? Infinity :\n                                /** @type {Number} */(timerLoop) + 1;\n\n    let offsetPosition = 0;\n\n    if (parent) {\n      offsetPosition = parentPosition;\n    } else {\n      let startTime = now();\n      // Make sure to tick the engine once if suspended to avoid big gaps with the following offsetPosition calculation\n      if (engine.paused) {\n        engine.requestTick(startTime);\n        startTime = engine._elapsedTime;\n      }\n      offsetPosition = startTime - engine._startTime;\n    }\n\n    // Timer's parameters\n    this.id = !isUnd(id) ? id : ++timerId;\n    /** @type {Timeline} */\n    this.parent = parent;\n    // Total duration of the timer\n    this.duration = clampInfinity(((timerDuration + timerLoopDelay) * timerIterationCount) - timerLoopDelay) || minValue;\n    /** @type {Boolean} */\n    this.backwards = false;\n    /** @type {Boolean} */\n    this.paused = true;\n    /** @type {Boolean} */\n    this.began = false;\n    /** @type {Boolean} */\n    this.completed = false;\n    /** @type {Callback<this>} */\n    this.onBegin = onBegin || timerDefaults.onBegin;\n    /** @type {Callback<this>} */\n    this.onBeforeUpdate = onBeforeUpdate || timerDefaults.onBeforeUpdate;\n    /** @type {Callback<this>} */\n    this.onUpdate = onUpdate || timerDefaults.onUpdate;\n    /** @type {Callback<this>} */\n    this.onLoop = onLoop || timerDefaults.onLoop;\n    /** @type {Callback<this>} */\n    this.onPause = onPause || timerDefaults.onPause;\n    /** @type {Callback<this>} */\n    this.onComplete = onComplete || timerDefaults.onComplete;\n    /** @type {Number} */\n    this.iterationDuration = timerDuration; // Duration of one loop\n    /** @type {Number} */\n    this.iterationCount = timerIterationCount; // Number of loops\n    /** @type {Boolean|ScrollObserver} */\n    this._autoplay = parent ? false : setValue(autoplay, timerDefaults.autoplay);\n    /** @type {Number} */\n    this._offset = offsetPosition;\n    /** @type {Number} */\n    this._delay = timerDelay;\n    /** @type {Number} */\n    this._loopDelay = timerLoopDelay;\n    /** @type {Number} */\n    this._iterationTime = 0;\n    /** @type {Number} */\n    this._currentIteration = 0; // Current loop index\n    /** @type {Function} */\n    this._resolve = noop; // Used by .then()\n    /** @type {Boolean} */\n    this._running = false;\n    /** @type {Number} */\n    this._reversed = +setValue(reversed, timerDefaults.reversed);\n    /** @type {Number} */\n    this._reverse = this._reversed;\n    /** @type {Number} */\n    this._cancelled = 0;\n    /** @type {Boolean} */\n    this._alternate = setValue(alternate, timerDefaults.alternate);\n    /** @type {Renderable} */\n    this._prev = null;\n    /** @type {Renderable} */\n    this._next = null;\n\n    // Clock's parameters\n    /** @type {Number} */\n    this._elapsedTime = timerInitTime;\n    /** @type {Number} */\n    this._startTime = timerInitTime;\n    /** @type {Number} */\n    this._lastTime = timerInitTime;\n    /** @type {Number} */\n    this._fps = setValue(frameRate, timerDefaults.frameRate);\n    /** @type {Number} */\n    this._speed = setValue(playbackRate, timerDefaults.playbackRate);\n  }\n\n  get cancelled() {\n    return !!this._cancelled;\n  }\n\n  /** @param {Boolean} cancelled  */\n  set cancelled(cancelled) {\n    cancelled ? this.cancel() : this.reset(1).play();\n  }\n\n  get currentTime() {\n    return clamp(round(this._currentTime, globals.precision), -this._delay, this.duration);\n  }\n\n  /** @param {Number} time  */\n  set currentTime(time) {\n    const paused = this.paused;\n    // Pausing the timer is necessary to avoid time jumps on a running instance\n    this.pause().seek(+time);\n    if (!paused) this.resume();\n  }\n\n  get iterationCurrentTime() {\n    return round(this._iterationTime, globals.precision);\n  }\n\n  /** @param {Number} time  */\n  set iterationCurrentTime(time) {\n    this.currentTime = (this.iterationDuration * this._currentIteration) + time;\n  }\n\n  get progress() {\n    return clamp(round(this._currentTime / this.duration, 5), 0, 1);\n  }\n\n  /** @param {Number} progress  */\n  set progress(progress) {\n    this.currentTime = this.duration * progress;\n  }\n\n  get iterationProgress() {\n    return clamp(round(this._iterationTime / this.iterationDuration, 5), 0, 1);\n  }\n\n  /** @param {Number} progress  */\n  set iterationProgress(progress) {\n    const iterationDuration = this.iterationDuration;\n    this.currentTime = (iterationDuration * this._currentIteration) + (iterationDuration * progress);\n  }\n\n  get currentIteration() {\n    return this._currentIteration;\n  }\n\n  /** @param {Number} iterationCount  */\n  set currentIteration(iterationCount) {\n    this.currentTime = (this.iterationDuration * clamp(+iterationCount, 0, this.iterationCount - 1));\n  }\n\n  get reversed() {\n    return !!this._reversed;\n  }\n\n  /** @param {Boolean} reverse  */\n  set reversed(reverse) {\n    reverse ? this.reverse() : this.play();\n  }\n\n  get speed() {\n    return super.speed;\n  }\n\n  /** @param {Number} playbackRate  */\n  set speed(playbackRate) {\n    super.speed = playbackRate;\n    this.resetTime();\n  }\n\n  /**\n   * @param  {Number} internalRender\n   * @return {this}\n   */\n  reset(internalRender = 0) {\n    // If cancelled, revive the timer before rendering in order to have propertly composed tweens siblings\n    reviveTimer(this);\n    if (this._reversed && !this._reverse) this.reversed = false;\n    // Rendering before updating the completed flag to prevent skips and to make sure the properties are not overridden\n    // Setting the iterationTime at the end to force the rendering to happend backwards, otherwise calling .reset() on Timelines might not render children in the right order\n    // NOTE: This is only required for Timelines and might be better to move to the Timeline class?\n    this._iterationTime = this.iterationDuration;\n    // Set tickMode to tickModes.FORCE to force rendering\n    tick(this, 0, 1, internalRender, tickModes.FORCE);\n    // Reset timer properties after revive / render to make sure the props are not updated again\n    resetTimerProperties(this);\n    // Also reset children properties\n    if (this._hasChildren) {\n      forEachChildren(this, resetTimerProperties);\n    }\n    return this;\n  }\n\n  /**\n   * @param  {Number} internalRender\n   * @return {this}\n   */\n  init(internalRender = 0) {\n    this.fps = this._fps;\n    this.speed = this._speed;\n    // Manually calling .init() on timelines should render all children intial state\n    // Forces all children to render once then render to 0 when reseted\n    if (!internalRender && this._hasChildren) {\n      tick(this, this.duration, 1, internalRender, tickModes.FORCE);\n    }\n    this.reset(internalRender);\n    // Make sure to set autoplay to false to child timers so it doesn't attempt to autoplay / link\n    const autoplay = this._autoplay;\n    if (autoplay === true) {\n      this.resume();\n    } else if (autoplay && !isUnd(/** @type {ScrollObserver} */(autoplay).linked)) {\n      /** @type {ScrollObserver} */(autoplay).link(this);\n    }\n    return this;\n  }\n\n  /** @return {this} */\n  resetTime() {\n    const timeScale = 1 / (this._speed * engine._speed);\n    this._startTime = now() - (this._currentTime + this._delay) * timeScale;\n    return this;\n  }\n\n  /** @return {this} */\n  pause() {\n    if (this.paused) return this;\n    this.paused = true;\n    this.onPause(this);\n    return this;\n  }\n\n  /** @return {this} */\n  resume() {\n    if (!this.paused) return this;\n    this.paused = false;\n    // We can safely imediatly render a timer that has no duration and no children\n    if (this.duration <= minValue && !this._hasChildren) {\n      tick(this, minValue, 0, 0, tickModes.FORCE);\n    } else {\n      if (!this._running) {\n        addChild(engine, this);\n        engine._hasChildren = true;\n        this._running = true;\n      }\n      this.resetTime();\n      // Forces the timer to advance by at least one frame when the next tick occurs\n      this._startTime -= 12;\n      engine.wake();\n    }\n    return this;\n  }\n\n  /** @return {this} */\n  restart() {\n    return this.reset(0).resume();\n  }\n\n  /**\n   * @param  {Number} time\n   * @param  {Boolean|Number} [muteCallbacks]\n   * @param  {Boolean|Number} [internalRender]\n   * @return {this}\n   */\n  seek(time, muteCallbacks = 0, internalRender = 0) {\n    // Recompose the tween siblings in case the timer has been cancelled\n    reviveTimer(this);\n    // If you seek a completed animation, otherwise the next play will starts at 0\n    this.completed = false;\n    const isPaused = this.paused;\n    this.paused = true;\n    // timer, time, muteCallbacks, internalRender, tickMode\n    tick(this, time + this._delay, ~~muteCallbacks, ~~internalRender, tickModes.AUTO);\n    return isPaused ? this : this.resume();\n  }\n\n  /** @return {this} */\n  alternate() {\n    const reversed = this._reversed;\n    const count = this.iterationCount;\n    const duration = this.iterationDuration;\n    // Calculate the maximum iterations possible given the iteration duration\n    const iterations = count === Infinity ? floor(maxValue / duration) : count;\n    this._reversed = +(this._alternate && !(iterations % 2) ? reversed : !reversed);\n    if (count === Infinity) {\n      // Handle infinite loops to loop on themself\n      this.iterationProgress = this._reversed ? 1 - this.iterationProgress : this.iterationProgress;\n    } else {\n      this.seek((duration * iterations) - this._currentTime);\n    }\n    this.resetTime();\n    return this;\n  }\n\n  /** @return {this} */\n  play() {\n    if (this._reversed) this.alternate();\n    return this.resume();\n  }\n\n  /** @return {this} */\n  reverse() {\n    if (!this._reversed) this.alternate();\n    return this.resume();\n  }\n\n  // TODO: Move all the animation / tweens / children related code to Animation / Timeline\n\n  /** @return {this} */\n  cancel() {\n    if (this._hasChildren) {\n      forEachChildren(this, (/** @type {Renderable} */child) => child.cancel(), true);\n    } else {\n      forEachChildren(this, removeTweenSliblings);\n    }\n    this._cancelled = 1;\n    // Pausing the timer removes it from the engine\n    return this.pause();\n  }\n\n  /**\n   * @param  {Number} newDuration\n   * @return {this}\n   */\n  stretch(newDuration) {\n    const currentDuration = this.duration;\n    const normlizedDuration = normalizeTime(newDuration);\n    if (currentDuration === normlizedDuration) return this;\n    const timeScale = newDuration / currentDuration;\n    const isSetter = newDuration <= minValue;\n    this.duration = isSetter ? minValue : normlizedDuration;\n    this.iterationDuration = isSetter ? minValue : normalizeTime(this.iterationDuration * timeScale);\n    this._offset *= timeScale;\n    this._delay *= timeScale;\n    this._loopDelay *= timeScale;\n    return this;\n  }\n\n /**\n   * Cancels the timer by seeking it back to 0 and reverting the attached scroller if necessary\n   * @return {this}\n   */\n  revert() {\n    tick(this, 0, 1, 0, tickModes.AUTO);\n    const ap = /** @type {ScrollObserver} */(this._autoplay);\n    if (ap && ap.linked && ap.linked === this) ap.revert();\n    return this.cancel();\n  }\n\n /**\n   * Imediatly completes the timer, cancels it and triggers the onComplete callback\n   * @return {this}\n   */\n  complete() {\n    return this.seek(this.duration).cancel();\n  }\n\n  /**\n   * @param  {Callback<this>} [callback]\n   * @return {Promise}\n   */\n  then(callback = noop) {\n    const then = this.then;\n    const onResolve = () => {\n      // this.then = null prevents infinite recursion if returned by an async function\n      // https://github.com/juliangarnierorg/anime-beta/issues/26\n      this.then = null;\n      callback(this);\n      this.then = then;\n      this._resolve = noop;\n    };\n    return new Promise(r => {\n      this._resolve = () => r(onResolve());\n      // Make sure to resolve imediatly if the timer has already completed\n      if (this.completed) this._resolve();\n      return this;\n    });\n  }\n\n}\n\n\n/**\n * @param {TimerParams} [parameters]\n * @return {Timer}\n */\nconst createTimer = parameters => new Timer(parameters, null, 0).init();\n\n\n\n\n/** @type {EasingFunction} */\nconst none = t => t;\n\n// Cubic Bezier solver adapted from https://github.com/gre/bezier-ease © Gaëtan Renaudeau\n\n/**\n * @param  {Number} aT\n * @param  {Number} aA1\n * @param  {Number} aA2\n * @return {Number}\n */\nconst calcBezier = (aT, aA1, aA2) => (((1 - 3 * aA2 + 3 * aA1) * aT + (3 * aA2 - 6 * aA1)) * aT + (3 * aA1)) * aT;\n\n/**\n * @param  {Number} aX\n * @param  {Number} mX1\n * @param  {Number} mX2\n * @return {Number}\n */\nconst binarySubdivide = (aX, mX1, mX2) => {\n  let aA = 0, aB = 1, currentX, currentT, i = 0;\n  do {\n    currentT = aA + (aB - aA) / 2;\n    currentX = calcBezier(currentT, mX1, mX2) - aX;\n    if (currentX > 0) {\n      aB = currentT;\n    } else {\n      aA = currentT;\n    }\n  } while (abs(currentX) > .0000001 && ++i < 100);\n  return currentT;\n};\n\n/**\n * @param  {Number} [mX1]\n * @param  {Number} [mY1]\n * @param  {Number} [mX2]\n * @param  {Number} [mY2]\n * @return {EasingFunction}\n */\n\nconst cubicBezier = (mX1 = 0.5, mY1 = 0.0, mX2 = 0.5, mY2 = 1.0) => (mX1 === mY1 && mX2 === mY2) ? none :\n  t => t === 0 || t === 1 ? t :\n  calcBezier(binarySubdivide(t, mX1, mX2), mY1, mY2);\n\n/**\n * Steps ease implementation https://developer.mozilla.org/fr/docs/Web/CSS/transition-timing-function\n * Only covers 'end' and 'start' jumpterms\n * @param  {Number} steps\n * @param  {Boolean} [fromStart]\n * @return {EasingFunction}\n */\nconst steps = (steps = 10, fromStart) => {\n  const roundMethod = fromStart ? ceil : floor;\n  return t => roundMethod(clamp(t, 0, 1) * steps) * (1 / steps);\n};\n\n/**\n * Without parameters, the linear function creates a non-eased transition.\n * Parameters, if used, creates a piecewise linear easing by interpolating linearly between the specified points.\n * @param  {...String|Number} [args] - Points\n * @return {EasingFunction}\n */\nconst linear = (...args) => {\n  const argsLength = args.length;\n  if (!argsLength) return none;\n  const totalPoints = argsLength - 1;\n  const firstArg = args[0];\n  const lastArg = args[totalPoints];\n  const xPoints = [0];\n  const yPoints = [parseNumber(firstArg)];\n  for (let i = 1; i < totalPoints; i++) {\n    const arg = args[i];\n    const splitValue = isStr(arg) ?\n    /** @type {String} */(arg).trim().split(' ') :\n    [arg];\n    const value = splitValue[0];\n    const percent = splitValue[1];\n    xPoints.push(!isUnd(percent) ? parseNumber(percent) / 100 : i / totalPoints);\n    yPoints.push(parseNumber(value));\n  }\n  yPoints.push(parseNumber(lastArg));\n  xPoints.push(1);\n  return function easeLinear(t) {\n    for (let i = 1, l = xPoints.length; i < l; i++) {\n      const currentX = xPoints[i];\n      if (t <= currentX) {\n        const prevX = xPoints[i - 1];\n        const prevY = yPoints[i - 1];\n        return prevY + (yPoints[i] - prevY) * (t - prevX) / (currentX - prevX);\n      }\n    }\n    return yPoints[yPoints.length - 1];\n  }\n};\n\n/**\n * Generate random steps\n * @param  {Number} [length] - The number of steps\n * @param  {Number} [randomness] - How strong the randomness is\n * @return {EasingFunction}\n */\nconst irregular = (length = 10, randomness = 1) => {\n  const values = [0];\n  const total = length - 1;\n  for (let i = 1; i < total; i++) {\n    const previousValue = values[i - 1];\n    const spacing = i / total;\n    const segmentEnd = (i + 1) / total;\n    const randomVariation = spacing + (segmentEnd - spacing) * Math.random();\n    // Mix the even spacing and random variation based on the randomness parameter\n    const randomValue = spacing * (1 - randomness) + randomVariation * randomness;\n    values.push(clamp(randomValue, previousValue, 1));\n  }\n  values.push(1);\n  return linear(...values);\n};\n\n// Easing functions adapted from http://www.robertpenner.com/ease © Robert Penner\n\n/**\n * @callback PowerEasing\n * @param {Number|String} [power=1.675]\n * @return {EasingFunction}\n */\n\n/**\n * @callback BackEasing\n * @param {Number|String} [overshoot=1.70158]\n * @return {EasingFunction}\n */\n\n/**\n * @callback ElasticEasing\n * @param {Number|String} [amplitude=1]\n * @param {Number|String} [period=.3]\n * @return {EasingFunction}\n */\n\n/**\n * @callback EaseFactory\n * @param {Number|String} [paramA]\n * @param {Number|String} [paramB]\n * @return {EasingFunction|Number}\n */\n\n/** @typedef {PowerEasing|BackEasing|ElasticEasing} EasesFactory */\n\nconst halfPI = PI / 2;\nconst doublePI = PI * 2;\n/** @type {PowerEasing} */\nconst easeInPower = (p = 1.68) => t => pow(t, +p);\n\n/** @type {Record<String, EasesFactory|EasingFunction>} */\nconst easeInFunctions = {\n  [emptyString]: easeInPower,\n  Quad: easeInPower(2),\n  Cubic: easeInPower(3),\n  Quart: easeInPower(4),\n  Quint: easeInPower(5),\n  /** @type {EasingFunction} */\n  Sine: t => 1 - cos(t * halfPI),\n  /** @type {EasingFunction} */\n  Circ: t => 1 - sqrt(1 - t * t),\n  /** @type {EasingFunction} */\n  Expo: t => t ? pow(2, 10 * t - 10) : 0,\n  /** @type {EasingFunction} */\n  Bounce: t => {\n    let pow2, b = 4;\n    while (t < ((pow2 = pow(2, --b)) - 1) / 11);\n    return 1 / pow(4, 3 - b) - 7.5625 * pow((pow2 * 3 - 2) / 22 - t, 2);\n  },\n  /** @type {BackEasing} */\n  Back: (overshoot = 1.70158) => t => (+overshoot + 1) * t * t * t - +overshoot * t * t,\n  /** @type {ElasticEasing} */\n  Elastic: (amplitude = 1, period = .3) => {\n    const a = clamp(+amplitude, 1, 10);\n    const p = clamp(+period, minValue, 2);\n    const s = (p / doublePI) * asin(1 / a);\n    const e = doublePI / p;\n    return t => t === 0 || t === 1 ? t : -a * pow(2, -10 * (1 - t)) * sin(((1 - t) - s) * e);\n  }\n};\n\n/**\n * @callback EaseType\n * @param {EasingFunction} Ease\n * @return {EasingFunction}\n */\n\n/** @type {Record<String, EaseType>} */\nconst easeTypes = {\n  in: easeIn => t => easeIn(t),\n  out: easeIn => t => 1 - easeIn(1 - t),\n  inOut: easeIn => t => t < .5 ? easeIn(t * 2) / 2 : 1 - easeIn(t * -2 + 2) / 2,\n  outIn: easeIn => t => t < .5 ? (1 - easeIn(1 - t * 2)) / 2 : (easeIn(t * 2 - 1) + 1) / 2,\n};\n\n/**\n * @param  {String} string\n * @param  {Record<String, EasesFactory|EasingFunction>} easesFunctions\n * @param  {Object} easesLookups\n * @return {EasingFunction}\n */\nconst parseEaseString = (string, easesFunctions, easesLookups) => {\n  if (easesLookups[string]) return easesLookups[string];\n  if (string.indexOf('(') <= -1) {\n    const hasParams = easeTypes[string] || string.includes('Back') || string.includes('Elastic');\n    const parsedFn = /** @type {EasingFunction} */(hasParams ? /** @type {EasesFactory} */(easesFunctions[string])() : easesFunctions[string]);\n    return parsedFn ? easesLookups[string] = parsedFn : none;\n  } else {\n    const split = string.slice(0, -1).split('(');\n    const parsedFn = /** @type {EasesFactory} */(easesFunctions[split[0]]);\n    return parsedFn ? easesLookups[string] = parsedFn(...split[1].split(',')) : none;\n  }\n};\n\n/**\n * @typedef  {Object} EasesFunctions\n * @property {typeof linear} linear\n * @property {typeof irregular} irregular\n * @property {typeof steps} steps\n * @property {typeof cubicBezier} cubicBezier\n * @property {PowerEasing} in\n * @property {PowerEasing} out\n * @property {PowerEasing} inOut\n * @property {PowerEasing} outIn\n * @property {EasingFunction} inQuad\n * @property {EasingFunction} outQuad\n * @property {EasingFunction} inOutQuad\n * @property {EasingFunction} outInQuad\n * @property {EasingFunction} inCubic\n * @property {EasingFunction} outCubic\n * @property {EasingFunction} inOutCubic\n * @property {EasingFunction} outInCubic\n * @property {EasingFunction} inQuart\n * @property {EasingFunction} outQuart\n * @property {EasingFunction} inOutQuart\n * @property {EasingFunction} outInQuart\n * @property {EasingFunction} inQuint\n * @property {EasingFunction} outQuint\n * @property {EasingFunction} inOutQuint\n * @property {EasingFunction} outInQuint\n * @property {EasingFunction} inSine\n * @property {EasingFunction} outSine\n * @property {EasingFunction} inOutSine\n * @property {EasingFunction} outInSine\n * @property {EasingFunction} inCirc\n * @property {EasingFunction} outCirc\n * @property {EasingFunction} inOutCirc\n * @property {EasingFunction} outInCirc\n * @property {EasingFunction} inExpo\n * @property {EasingFunction} outExpo\n * @property {EasingFunction} inOutExpo\n * @property {EasingFunction} outInExpo\n * @property {EasingFunction} inBounce\n * @property {EasingFunction} outBounce\n * @property {EasingFunction} inOutBounce\n * @property {EasingFunction} outInBounce\n * @property {BackEasing} inBack\n * @property {BackEasing} outBack\n * @property {BackEasing} inOutBack\n * @property {BackEasing} outInBack\n * @property {ElasticEasing} inElastic\n * @property {ElasticEasing} outElastic\n * @property {ElasticEasing} inOutElastic\n * @property {ElasticEasing} outInElastic\n */\n\nconst eases = (/*#__PURE__*/ (() => {\n  const list = { linear, irregular, steps, cubicBezier };\n  for (let type in easeTypes) {\n    for (let name in easeInFunctions) {\n      const easeIn = easeInFunctions[name];\n      const easeType = easeTypes[type];\n      list[type + name] = /** @type {EasesFactory|EasingFunction} */(\n        name === emptyString || name === 'Back' || name === 'Elastic' ?\n        (a, b) => easeType(/** @type {EasesFactory} */(easeIn)(a, b)) :\n        easeType(/** @type {EasingFunction} */(easeIn))\n      );\n    }\n  }\n  return /** @type {EasesFunctions} */(list);\n})());\n\n/** @type {Record<String, EasingFunction>} */\nconst JSEasesLookups = { linear: none };\n\n/**\n * @param  {EasingParam} ease\n * @return {EasingFunction}\n */\nconst parseEasings = ease => isFnc(ease) ? ease :\n  isStr(ease) ? parseEaseString(/** @type {String} */(ease), eases, JSEasesLookups) :\n  none;\n\n\n\n\nconst propertyNamesCache = {};\n\n/**\n * @param  {String} propertyName\n * @param  {Target} target\n * @param  {tweenTypes} tweenType\n * @return {String}\n */\nconst sanitizePropertyName = (propertyName, target, tweenType) => {\n  if (tweenType === tweenTypes.TRANSFORM) {\n    const t = shortTransforms.get(propertyName);\n    return t ? t : propertyName;\n  } else if (\n    tweenType === tweenTypes.CSS ||\n    // Handle special cases where properties like \"strokeDashoffset\" needs to be set as \"stroke-dashoffset\"\n    // but properties like \"baseFrequency\" should stay in lowerCamelCase\n    (tweenType === tweenTypes.ATTRIBUTE && (isSvg(target) && propertyName in /** @type {DOMTarget} */(target).style))\n  ) {\n    const cachedPropertyName = propertyNamesCache[propertyName];\n    if (cachedPropertyName) {\n      return cachedPropertyName;\n    } else {\n      const lowerCaseName = propertyName ? toLowerCase(propertyName) : propertyName;\n      propertyNamesCache[propertyName] = lowerCaseName;\n      return lowerCaseName;\n    }\n  } else {\n    return propertyName;\n  }\n};\n\n\n\n\nconst angleUnitsMap = { 'deg': 1, 'rad': 180 / PI, 'turn': 360 };\nconst convertedValuesCache = {};\n\n/**\n * @param  {DOMTarget} el\n * @param  {TweenDecomposedValue} decomposedValue\n * @param  {String} unit\n * @param  {Boolean} [force]\n * @return {TweenDecomposedValue}\n */\nconst convertValueUnit = (el, decomposedValue, unit, force = false) => {\n  const currentUnit = decomposedValue.u;\n  const currentNumber = decomposedValue.n;\n  if (decomposedValue.t === valueTypes.UNIT && currentUnit === unit) { // TODO: Check if checking against the same unit string is necessary\n    return decomposedValue;\n  }\n  const cachedKey = currentNumber + currentUnit + unit;\n  const cached = convertedValuesCache[cachedKey];\n  if (!isUnd(cached) && !force) {\n    decomposedValue.n = cached;\n  } else {\n    let convertedValue;\n    if (currentUnit in angleUnitsMap) {\n      convertedValue = currentNumber * angleUnitsMap[currentUnit] / angleUnitsMap[unit];\n    } else {\n      const baseline = 100;\n      const tempEl = /** @type {DOMTarget} */(el.cloneNode());\n      const parentNode = el.parentNode;\n      const parentEl = (parentNode && (parentNode !== doc)) ? parentNode : doc.body;\n      parentEl.appendChild(tempEl);\n      const elStyle = tempEl.style;\n      elStyle.width = baseline + currentUnit;\n      const currentUnitWidth = /** @type {HTMLElement} */(tempEl).offsetWidth || baseline;\n      elStyle.width = baseline + unit;\n      const newUnitWidth = /** @type {HTMLElement} */(tempEl).offsetWidth || baseline;\n      const factor = currentUnitWidth / newUnitWidth;\n      parentEl.removeChild(tempEl);\n      convertedValue = factor * currentNumber;\n    }\n    decomposedValue.n = convertedValue;\n    convertedValuesCache[cachedKey] = convertedValue;\n  }\n  decomposedValue.t === valueTypes.UNIT;\n  decomposedValue.u = unit;\n  return decomposedValue;\n};\n\n\n\n\n/**\n * @template {Renderable} T\n * @param {T} renderable\n * @return {T}\n */\nconst cleanInlineStyles = renderable => {\n  // Allow cleanInlineStyles() to be called on timelines\n  if (renderable._hasChildren) {\n    forEachChildren(renderable, cleanInlineStyles, true);\n  } else {\n    const animation = /** @type {JSAnimation} */(renderable);\n    animation.pause();\n    forEachChildren(animation, (/** @type {Tween} */tween) => {\n      const tweenProperty = tween.property;\n      const tweenTarget = tween.target;\n      if (tweenTarget[isDomSymbol]) {\n        const targetStyle = /** @type {DOMTarget} */(tweenTarget).style;\n        const originalInlinedValue = animation._inlineStyles[tweenProperty];\n        if (tween._tweenType === tweenTypes.TRANSFORM) {\n          const cachedTransforms = tweenTarget[transformsSymbol];\n          if (isUnd(originalInlinedValue) || originalInlinedValue === emptyString) {\n            delete cachedTransforms[tweenProperty];\n          } else {\n            cachedTransforms[tweenProperty] = originalInlinedValue;\n          }\n          if (tween._renderTransforms) {\n            if (!Object.keys(cachedTransforms).length) {\n              targetStyle.removeProperty('transform');\n            } else {\n              let str = emptyString;\n              for (let key in cachedTransforms) {\n                str += transformsFragmentStrings[key] + cachedTransforms[key] + ') ';\n              }\n              targetStyle.transform = str;\n            }\n          }\n        } else {\n          if (isUnd(originalInlinedValue) || originalInlinedValue === emptyString) {\n            targetStyle.removeProperty(tweenProperty);\n          } else {\n            targetStyle[tweenProperty] = originalInlinedValue;\n          }\n        }\n        if (animation._tail === tween) {\n          animation.targets.forEach(t => {\n            if (t.getAttribute && t.getAttribute('style') === emptyString) {\n              t.removeAttribute('style');\n            }          });\n        }\n      }\n    });\n  }\n  return renderable;\n};\n\n// Defines decomposed values target objects only once and mutate their properties later to avoid GC\n// TODO: Maybe move the objects creation to values.js and use the decompose function to create the base object\nconst fromTargetObject = createDecomposedValueTargetObject();\nconst toTargetObject = createDecomposedValueTargetObject();\nconst toFunctionStore = { func: null };\nconst keyframesTargetArray = [null];\nconst fastSetValuesArray = [null, null];\n/** @type {TweenKeyValue} */\nconst keyObjectTarget = { to: null };\n\nlet tweenId = 0;\nlet keyframes;\n/** @type {TweenParamsOptions & TweenValues} */\nlet key;\n\n/**\n * @param {DurationKeyframes | PercentageKeyframes} keyframes\n * @param {AnimationParams} parameters\n * @return {AnimationParams}\n */\nconst generateKeyframes = (keyframes, parameters) => {\n  /** @type {AnimationParams} */\n  const properties = {};\n  if (isArr(keyframes)) {\n    const propertyNames = [].concat(.../** @type {DurationKeyframes} */(keyframes).map(key => Object.keys(key))).filter(isKey);\n    for (let i = 0, l = propertyNames.length; i < l; i++) {\n      const propName = propertyNames[i];\n      const propArray = /** @type {DurationKeyframes} */(keyframes).map(key => {\n        /** @type {TweenKeyValue} */\n        const newKey = {};\n        for (let p in key) {\n          const keyValue = /** @type {TweenPropValue} */(key[p]);\n          if (isKey(p)) {\n            if (p === propName) {\n              newKey.to = keyValue;\n            }\n          } else {\n            newKey[p] = keyValue;\n          }\n        }\n        return newKey;\n      });\n      properties[propName] = /** @type {ArraySyntaxValue} */(propArray);\n    }\n\n  } else {\n    const totalDuration = /** @type {Number} */(setValue(parameters.duration, globals.defaults.duration));\n    const keys = Object.keys(keyframes)\n    .map(key => { return {o: parseFloat(key) / 100, p: keyframes[key]} })\n    .sort((a, b) => a.o - b.o);\n    keys.forEach(key => {\n      const offset = key.o;\n      const prop = key.p;\n      for (let name in prop) {\n        if (isKey(name)) {\n          let propArray = /** @type {Array} */(properties[name]);\n          if (!propArray) propArray = properties[name] = [];\n          const duration = offset * totalDuration;\n          let length = propArray.length;\n          let prevKey = propArray[length - 1];\n          const keyObj = { to: prop[name] };\n          let durProgress = 0;\n          for (let i = 0; i < length; i++) {\n            durProgress += propArray[i].duration;\n          }\n          if (length === 1) {\n            keyObj.from = prevKey.to;\n          }\n          if (prop.ease) {\n            keyObj.ease = prop.ease;\n          }\n          keyObj.duration = duration - (length ? durProgress : 0);\n          propArray.push(keyObj);\n        }\n      }\n      return key;\n    });\n\n    for (let name in properties) {\n      const propArray = /** @type {Array} */(properties[name]);\n      let prevEase;\n      // let durProgress = 0\n      for (let i = 0, l = propArray.length; i < l; i++) {\n        const prop = propArray[i];\n        // Emulate WAPPI easing parameter position\n        const currentEase = prop.ease;\n        prop.ease = prevEase ? prevEase : undefined;\n        prevEase = currentEase;\n        // durProgress += prop.duration;\n        // if (i === l - 1 && durProgress !== totalDuration) {\n        //   propArray.push({ from: prop.to, ease: prop.ease, duration: totalDuration - durProgress })\n        // }\n      }\n      if (!propArray[0].duration) {\n        propArray.shift();\n      }\n    }\n\n  }\n\n  return properties;\n};\n\nclass JSAnimation extends Timer {\n  /**\n   * @param {TargetsParam} targets\n   * @param {AnimationParams} parameters\n   * @param {Timeline} [parent]\n   * @param {Number} [parentPosition]\n   * @param {Boolean} [fastSet=false]\n   * @param {Number} [index=0]\n   * @param {Number} [length=0]\n   */\n  constructor(\n    targets,\n    parameters,\n    parent,\n    parentPosition,\n    fastSet = false,\n    index = 0,\n    length = 0\n  ) {\n\n    super(/** @type {TimerParams&AnimationParams} */(parameters), parent, parentPosition);\n\n    const parsedTargets = registerTargets(targets);\n    const targetsLength = parsedTargets.length;\n\n    // If the parameters object contains a \"keyframes\" property, convert all the keyframes values to regular properties\n\n    const kfParams = /** @type {AnimationParams} */(parameters).keyframes;\n    const params = /** @type {AnimationParams} */(kfParams ? mergeObjects(generateKeyframes(/** @type {DurationKeyframes} */(kfParams), parameters), parameters) : parameters);\n\n    const {\n      delay,\n      duration,\n      ease,\n      playbackEase,\n      modifier,\n      composition,\n      onRender,\n    } = params;\n\n    const animDefaults = parent ? parent.defaults : globals.defaults;\n    const animaPlaybackEase = setValue(playbackEase, animDefaults.playbackEase);\n    const animEase = animaPlaybackEase ? parseEasings(animaPlaybackEase) : null;\n    const hasSpring = !isUnd(ease) && !isUnd(/** @type {Spring} */(ease).ease);\n    const tEasing = hasSpring ? /** @type {Spring} */(ease).ease : setValue(ease, animEase ? 'linear' : animDefaults.ease);\n    const tDuration = hasSpring ? /** @type {Spring} */(ease).duration : setValue(duration, animDefaults.duration);\n    const tDelay = setValue(delay, animDefaults.delay);\n    const tModifier = modifier || animDefaults.modifier;\n    // If no composition is defined and the targets length is high (>= 1000) set the composition to 'none' (0) for faster tween creation\n    const tComposition = isUnd(composition) && targetsLength >= K ? compositionTypes.none : !isUnd(composition) ? composition : animDefaults.composition;\n    // TODO: Do not create an empty object until we know the animation will generate inline styles\n    const animInlineStyles = {};\n    // const absoluteOffsetTime = this._offset;\n    const absoluteOffsetTime = this._offset + (parent ? parent._offset : 0);\n\n    let iterationDuration = NaN;\n    let iterationDelay = NaN;\n    let animationAnimationLength = 0;\n    let shouldTriggerRender = 0;\n\n    for (let targetIndex = 0; targetIndex < targetsLength; targetIndex++) {\n\n      const target = parsedTargets[targetIndex];\n      const ti = index || targetIndex;\n      const tl = length || targetsLength;\n\n      let lastTransformGroupIndex = NaN;\n      let lastTransformGroupLength = NaN;\n\n      for (let p in params) {\n\n        if (isKey(p)) {\n\n          const tweenType = getTweenType(target, p);\n\n          const propName = sanitizePropertyName(p, target, tweenType);\n\n          let propValue = params[p];\n\n          const isPropValueArray = isArr(propValue);\n\n          if (fastSet && !isPropValueArray) {\n            fastSetValuesArray[0] = propValue;\n            fastSetValuesArray[1] = propValue;\n            propValue = fastSetValuesArray;\n          }\n\n          // TODO: Allow nested keyframes inside ObjectValue value (prop: { to: [.5, 1, .75, 2, 3] })\n          // Normalize property values to valid keyframe syntax:\n          // [x, y] to [{to: [x, y]}] or {to: x} to [{to: x}] or keep keys syntax [{}, {}, {}...]\n          // const keyframes = isArr(propValue) ? propValue.length === 2 && !isObj(propValue[0]) ? [{ to: propValue }] : propValue : [propValue];\n          if (isPropValueArray) {\n            const arrayLength = /** @type {Array} */(propValue).length;\n            const isNotObjectValue = !isObj(propValue[0]);\n            // Convert [x, y] to [{to: [x, y]}]\n            if (arrayLength === 2 && isNotObjectValue) {\n              keyObjectTarget.to = /** @type {TweenParamValue} */(/** @type {unknown} */(propValue));\n              keyframesTargetArray[0] = keyObjectTarget;\n              keyframes = keyframesTargetArray;\n            // Convert [x, y, z] to [[x, y], z]\n            } else if (arrayLength > 2 && isNotObjectValue) {\n              keyframes = [];\n              /** @type {Array.<Number>} */(propValue).forEach((v, i) => {\n                if (!i) {\n                  fastSetValuesArray[0] = v;\n                } else if (i === 1) {\n                  fastSetValuesArray[1] = v;\n                  keyframes.push(fastSetValuesArray);\n                } else {\n                  keyframes.push(v);\n                }\n              });\n            } else {\n              keyframes = /** @type {Array.<TweenKeyValue>} */(propValue);\n            }\n          } else {\n            keyframesTargetArray[0] = propValue;\n            keyframes = keyframesTargetArray;\n          }\n\n          let siblings = null;\n          let prevTween = null;\n          let firstTweenChangeStartTime = NaN;\n          let lastTweenChangeEndTime = 0;\n          let tweenIndex = 0;\n\n          for (let l = keyframes.length; tweenIndex < l; tweenIndex++) {\n\n            const keyframe = keyframes[tweenIndex];\n\n            if (isObj(keyframe)) {\n              key = keyframe;\n            } else {\n              keyObjectTarget.to = /** @type {TweenParamValue} */(keyframe);\n              key = keyObjectTarget;\n            }\n\n            toFunctionStore.func = null;\n\n            const computedToValue = getFunctionValue(key.to, target, ti, tl, toFunctionStore);\n\n            let tweenToValue;\n            // Allows function based values to return an object syntax value ({to: v})\n            if (isObj(computedToValue) && !isUnd(computedToValue.to)) {\n              key = computedToValue;\n              tweenToValue = computedToValue.to;\n            } else {\n              tweenToValue = computedToValue;\n            }\n            const tweenFromValue = getFunctionValue(key.from, target, ti, tl);\n            const keyEasing = key.ease;\n            const hasSpring = !isUnd(keyEasing) && !isUnd(/** @type {Spring} */(keyEasing).ease);\n            // Easing are treated differently and don't accept function based value to prevent having to pass a function wrapper that returns an other function all the time\n            const tweenEasing = hasSpring ? /** @type {Spring} */(keyEasing).ease : keyEasing || tEasing;\n            // Calculate default individual keyframe duration by dividing the tl of keyframes\n            const tweenDuration = hasSpring ? /** @type {Spring} */(keyEasing).duration : getFunctionValue(setValue(key.duration, (l > 1 ? getFunctionValue(tDuration, target, ti, tl) / l : tDuration)), target, ti, tl);\n            // Default delay value should only be applied to the first tween\n            const tweenDelay = getFunctionValue(setValue(key.delay, (!tweenIndex ? tDelay : 0)), target, ti, tl);\n            const computedComposition = getFunctionValue(setValue(key.composition, tComposition), target, ti, tl);\n            const tweenComposition = isNum(computedComposition) ? computedComposition : compositionTypes[computedComposition];\n            // Modifiers are treated differently and don't accept function based value to prevent having to pass a function wrapper\n            const tweenModifier = key.modifier || tModifier;\n            const hasFromvalue = !isUnd(tweenFromValue);\n            const hasToValue = !isUnd(tweenToValue);\n            const isFromToArray = isArr(tweenToValue);\n            const isFromToValue = isFromToArray || (hasFromvalue && hasToValue);\n            const tweenStartTime = prevTween ? lastTweenChangeEndTime + tweenDelay : tweenDelay;\n            const absoluteStartTime = absoluteOffsetTime + tweenStartTime;\n\n            // Force a onRender callback if the animation contains at least one from value and autoplay is set to false\n            if (!shouldTriggerRender && (hasFromvalue || isFromToArray)) shouldTriggerRender = 1;\n\n            let prevSibling = prevTween;\n\n            if (tweenComposition !== compositionTypes.none) {\n              if (!siblings) siblings = getTweenSiblings(target, propName);\n              let nextSibling = siblings._head;\n              // Iterate trough all the next siblings until we find a sibling with an equal or inferior start time\n              while (nextSibling && !nextSibling._isOverridden && nextSibling._absoluteStartTime <= absoluteStartTime) {\n                prevSibling = nextSibling;\n                nextSibling = nextSibling._nextRep;\n                // Overrides all the next siblings if the next sibling starts at the same time of after as the new tween start time\n                if (nextSibling && nextSibling._absoluteStartTime >= absoluteStartTime) {\n                  while (nextSibling) {\n                    overrideTween(nextSibling);\n                    // This will ends both the current while loop and the upper one once all the next sibllings have been overriden\n                    nextSibling = nextSibling._nextRep;\n                  }\n                }\n              }\n            }\n\n            // Decompose values\n            if (isFromToValue) {\n              decomposeRawValue(isFromToArray ? getFunctionValue(tweenToValue[0], target, ti, tl) : tweenFromValue, fromTargetObject);\n              decomposeRawValue(isFromToArray ? getFunctionValue(tweenToValue[1], target, ti, tl, toFunctionStore) : tweenToValue, toTargetObject);\n              if (fromTargetObject.t === valueTypes.NUMBER) {\n                if (prevSibling) {\n                  if (prevSibling._valueType === valueTypes.UNIT) {\n                    fromTargetObject.t = valueTypes.UNIT;\n                    fromTargetObject.u = prevSibling._unit;\n                  }\n                } else {\n                  decomposeRawValue(\n                    getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles),\n                    decomposedOriginalValue\n                  );\n                  if (decomposedOriginalValue.t === valueTypes.UNIT) {\n                    fromTargetObject.t = valueTypes.UNIT;\n                    fromTargetObject.u = decomposedOriginalValue.u;\n                  }\n                }\n              }\n            } else {\n              if (hasToValue) {\n                decomposeRawValue(tweenToValue, toTargetObject);\n              } else {\n                if (prevTween) {\n                  decomposeTweenValue(prevTween, toTargetObject);\n                } else {\n                  // No need to get and parse the original value if the tween is part of a timeline and has a previous sibling part of the same timeline\n                  decomposeRawValue(parent && prevSibling && prevSibling.parent.parent === parent ? prevSibling._value :\n                  getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles), toTargetObject);\n                }\n              }\n              if (hasFromvalue) {\n                decomposeRawValue(tweenFromValue, fromTargetObject);\n              } else {\n                if (prevTween) {\n                  decomposeTweenValue(prevTween, fromTargetObject);\n                } else {\n                  decomposeRawValue(parent && prevSibling && prevSibling.parent.parent === parent ? prevSibling._value :\n                  // No need to get and parse the original value if the tween is part of a timeline and has a previous sibling part of the same timeline\n                  getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles), fromTargetObject);\n                }\n              }\n            }\n\n            // Apply operators\n            if (fromTargetObject.o) {\n              fromTargetObject.n = getRelativeValue(\n                !prevSibling ? decomposeRawValue(\n                  getOriginalAnimatableValue(target, propName, tweenType, animInlineStyles),\n                  decomposedOriginalValue\n                ).n : prevSibling._toNumber,\n                fromTargetObject.n,\n                fromTargetObject.o\n              );\n            }\n\n            if (toTargetObject.o) {\n              toTargetObject.n = getRelativeValue(fromTargetObject.n, toTargetObject.n, toTargetObject.o);\n            }\n\n            // Values omogenisation in cases of type difference between \"from\" and \"to\"\n            if (fromTargetObject.t !== toTargetObject.t) {\n              if (fromTargetObject.t === valueTypes.COMPLEX || toTargetObject.t === valueTypes.COMPLEX) {\n                const complexValue = fromTargetObject.t === valueTypes.COMPLEX ? fromTargetObject : toTargetObject;\n                const notComplexValue = fromTargetObject.t === valueTypes.COMPLEX ? toTargetObject : fromTargetObject;\n                notComplexValue.t = valueTypes.COMPLEX;\n                notComplexValue.s = cloneArray(complexValue.s);\n                notComplexValue.d = complexValue.d.map(() => notComplexValue.n);\n              } else if (fromTargetObject.t === valueTypes.UNIT || toTargetObject.t === valueTypes.UNIT) {\n                const unitValue = fromTargetObject.t === valueTypes.UNIT ? fromTargetObject : toTargetObject;\n                const notUnitValue = fromTargetObject.t === valueTypes.UNIT ? toTargetObject : fromTargetObject;\n                notUnitValue.t = valueTypes.UNIT;\n                notUnitValue.u = unitValue.u;\n              } else if (fromTargetObject.t === valueTypes.COLOR || toTargetObject.t === valueTypes.COLOR) {\n                const colorValue = fromTargetObject.t === valueTypes.COLOR ? fromTargetObject : toTargetObject;\n                const notColorValue = fromTargetObject.t === valueTypes.COLOR ? toTargetObject : fromTargetObject;\n                notColorValue.t = valueTypes.COLOR;\n                notColorValue.s = colorValue.s;\n                notColorValue.d = [0, 0, 0, 1];\n              }\n            }\n\n            // Unit conversion\n            if (fromTargetObject.u !== toTargetObject.u) {\n              let valueToConvert = toTargetObject.u ? fromTargetObject : toTargetObject;\n              valueToConvert = convertValueUnit(/** @type {DOMTarget} */(target), valueToConvert, toTargetObject.u ? toTargetObject.u : fromTargetObject.u, false);\n              // TODO:\n              // convertValueUnit(target, to.u ? from : to, to.u ? to.u : from.u);\n            }\n\n            // Fill in non existing complex values\n            if (toTargetObject.d && fromTargetObject.d && (toTargetObject.d.length !== fromTargetObject.d.length)) {\n              const longestValue = fromTargetObject.d.length > toTargetObject.d.length ? fromTargetObject : toTargetObject;\n              const shortestValue = longestValue === fromTargetObject ? toTargetObject : fromTargetObject;\n              // TODO: Check if n should be used instead of 0 for default complex values\n              shortestValue.d = longestValue.d.map((_, i) => isUnd(shortestValue.d[i]) ? 0 : shortestValue.d[i]);\n              shortestValue.s = cloneArray(longestValue.s);\n            }\n\n            // Tween factory\n\n            // Rounding is necessary here to minimize floating point errors\n            const tweenUpdateDuration = round(+tweenDuration || minValue, 12);\n\n            /** @type {Tween} */\n            const tween = {\n              parent: this,\n              id: tweenId++,\n              property: propName,\n              target: target,\n              _value: null,\n              _func: toFunctionStore.func,\n              _ease: parseEasings(tweenEasing),\n              _fromNumbers: cloneArray(fromTargetObject.d),\n              _toNumbers: cloneArray(toTargetObject.d),\n              _strings: cloneArray(toTargetObject.s),\n              _fromNumber: fromTargetObject.n,\n              _toNumber: toTargetObject.n,\n              _numbers: cloneArray(fromTargetObject.d), // For additive tween and animatables\n              _number: fromTargetObject.n, // For additive tween and animatables\n              _unit: toTargetObject.u,\n              _modifier: tweenModifier,\n              _currentTime: 0,\n              _startTime: tweenStartTime,\n              _delay: +tweenDelay,\n              _updateDuration: tweenUpdateDuration,\n              _changeDuration: tweenUpdateDuration,\n              _absoluteStartTime: absoluteStartTime,\n              // NOTE: Investigate bit packing to stores ENUM / BOOL\n              _tweenType: tweenType,\n              _valueType: toTargetObject.t,\n              _composition: tweenComposition,\n              _isOverlapped: 0,\n              _isOverridden: 0,\n              _renderTransforms: 0,\n              _prevRep: null, // For replaced tween\n              _nextRep: null, // For replaced tween\n              _prevAdd: null, // For additive tween\n              _nextAdd: null, // For additive tween\n              _prev: null,\n              _next: null,\n            };\n\n            if (tweenComposition !== compositionTypes.none) {\n              composeTween(tween, siblings);\n            }\n\n            if (isNaN(firstTweenChangeStartTime)) {\n              firstTweenChangeStartTime = tween._startTime;\n            }\n            // Rounding is necessary here to minimize floating point errors\n            lastTweenChangeEndTime = round(tweenStartTime + tweenUpdateDuration, 12);\n            prevTween = tween;\n            animationAnimationLength++;\n\n            addChild(this, tween);\n\n          }\n\n          // Update animation timings with the added tweens properties\n\n          if (isNaN(iterationDelay) || firstTweenChangeStartTime < iterationDelay) {\n            iterationDelay = firstTweenChangeStartTime;\n          }\n\n          if (isNaN(iterationDuration) || lastTweenChangeEndTime > iterationDuration) {\n            iterationDuration = lastTweenChangeEndTime;\n          }\n\n          // TODO: Find a way to inline tween._renderTransforms = 1 here\n          if (tweenType === tweenTypes.TRANSFORM) {\n            lastTransformGroupIndex = animationAnimationLength - tweenIndex;\n            lastTransformGroupLength = animationAnimationLength;\n          }\n\n        }\n\n      }\n\n      // Set _renderTransforms to last transform property to correctly render the transforms list\n      if (!isNaN(lastTransformGroupIndex)) {\n        let i = 0;\n        forEachChildren(this, (/** @type {Tween} */tween) => {\n          if (i >= lastTransformGroupIndex && i < lastTransformGroupLength) {\n            tween._renderTransforms = 1;\n            if (tween._composition === compositionTypes.blend) {\n              forEachChildren(additive.animation, (/** @type {Tween} */additiveTween) => {\n                if (additiveTween.id === tween.id) {\n                  additiveTween._renderTransforms = 1;\n                }\n              });\n            }\n          }\n          i++;\n        });\n      }\n\n    }\n\n    if (!targetsLength) {\n      console.warn(`No target found. Make sure the element you're trying to animate is accessible before creating your animation.`);\n    }\n\n    if (iterationDelay) {\n      forEachChildren(this, (/** @type {Tween} */tween) => {\n        // If (startTime - delay) equals 0, this means the tween is at the begining of the animation so we need to trim the delay too\n        if (!(tween._startTime - tween._delay)) {\n          tween._delay -= iterationDelay;\n        }\n        tween._startTime -= iterationDelay;\n      });\n      iterationDuration -= iterationDelay;\n    } else {\n      iterationDelay = 0;\n    }\n\n    // Prevents iterationDuration to be NaN if no valid animatable props have been provided\n    // Prevents _iterationCount to be NaN if no valid animatable props have been provided\n    if (!iterationDuration) {\n      iterationDuration = minValue;\n      this.iterationCount = 0;\n    }\n    /** @type {TargetsArray} */\n    this.targets = parsedTargets;\n    /** @type {Number} */\n    this.duration = iterationDuration === minValue ? minValue : clampInfinity(((iterationDuration + this._loopDelay) * this.iterationCount) - this._loopDelay) || minValue;\n    /** @type {Callback<this>} */\n    this.onRender = onRender || animDefaults.onRender;\n    /** @type {EasingFunction} */\n    this._ease = animEase;\n    /** @type {Number} */\n    this._delay = iterationDelay;\n    // NOTE: I'm keeping delay values separated from offsets in timelines because delays can override previous tweens and it could be confusing to debug a timeline with overridden tweens and no associated visible delays.\n    // this._delay = parent ? 0 : iterationDelay;\n    // this._offset += parent ? iterationDelay : 0;\n    /** @type {Number} */\n    this.iterationDuration = iterationDuration;\n    /** @type {{}} */\n    this._inlineStyles = animInlineStyles;\n\n    if (!this._autoplay && shouldTriggerRender) this.onRender(this);\n  }\n\n  /**\n   * @param  {Number} newDuration\n   * @return {this}\n   */\n  stretch(newDuration) {\n    const currentDuration = this.duration;\n    if (currentDuration === normalizeTime(newDuration)) return this;\n    const timeScale = newDuration / currentDuration;\n    // NOTE: Find a better way to handle the stretch of an animation after stretch = 0\n    forEachChildren(this, (/** @type {Tween} */tween) => {\n      // Rounding is necessary here to minimize floating point errors\n      tween._updateDuration = normalizeTime(tween._updateDuration * timeScale);\n      tween._changeDuration = normalizeTime(tween._changeDuration * timeScale);\n      tween._currentTime *= timeScale;\n      tween._startTime *= timeScale;\n      tween._absoluteStartTime *= timeScale;\n    });\n    return super.stretch(newDuration);\n  }\n\n  /**\n   * @return {this}\n   */\n  refresh() {\n    forEachChildren(this, (/** @type {Tween} */tween) => {\n      const ogValue = getOriginalAnimatableValue(tween.target, tween.property, tween._tweenType);\n      decomposeRawValue(ogValue, decomposedOriginalValue);\n      tween._fromNumbers = cloneArray(decomposedOriginalValue.d);\n      tween._fromNumber = decomposedOriginalValue.n;\n      if (tween._func) {\n        decomposeRawValue(tween._func(), toTargetObject);\n        tween._toNumbers = cloneArray(toTargetObject.d);\n        tween._strings = cloneArray(toTargetObject.s);\n        tween._toNumber = toTargetObject.n;\n      }\n    });\n    return this;\n  }\n\n  /**\n   * Cancel the animation and revert all the values affected by this animation to their original state\n   * @return {this}\n   */\n  revert() {\n    super.revert();\n    return cleanInlineStyles(this);\n  }\n\n  /**\n   * @param  {Callback<this>} [callback]\n   * @return {Promise}\n   */\n  then(callback) {\n    return super.then(callback);\n  }\n\n}\n\n/**\n * @param {TargetsParam} targets\n * @param {AnimationParams} parameters\n * @return {JSAnimation}\n */\nconst animate = (targets, parameters) => new JSAnimation(targets, parameters, null, 0, false).init();\n\n\n\n\n/**\n * Converts an easing function into a valid CSS linear() timing function string\n * @param {EasingFunction} fn\n * @param {number} [samples=100]\n * @returns {string} CSS linear() timing function\n */\nconst easingToLinear = (fn, samples = 100) => {\n  const points = [];\n  for (let i = 0; i <= samples; i++) points.push(fn(i / samples));\n  return `linear(${points.join(', ')})`;\n};\n\nconst WAAPIEasesLookups = {\n  in: 'ease-in',\n  out: 'ease-out',\n  inOut: 'ease-in-out',\n};\n\nconst WAAPIeases = /*#__PURE__*/(() => {\n  const list = {};\n  for (let type in easeTypes) list[type] = a => easeTypes[type](easeInPower(a));\n  return /** @type {Record<String, EasingFunction>} */(list);\n})();\n\n/**\n * @param  {EasingParam} ease\n * @return {String}\n */\nconst parseWAAPIEasing = (ease) => {\n  let parsedEase = WAAPIEasesLookups[ease];\n  if (parsedEase) return parsedEase;\n  parsedEase = 'linear';\n  if (isStr(ease)) {\n    if (\n      stringStartsWith(ease, 'linear') ||\n      stringStartsWith(ease, 'cubic-') ||\n      stringStartsWith(ease, 'steps') ||\n      stringStartsWith(ease, 'ease')\n    ) {\n      parsedEase = ease;\n    } else if (stringStartsWith(ease, 'cubicB')) {\n      parsedEase = toLowerCase(ease);\n    } else {\n      const parsed = parseEaseString(ease, WAAPIeases, WAAPIEasesLookups);\n      if (isFnc(parsed)) parsedEase = parsed === none ? 'linear' : easingToLinear(parsed);\n    }\n    WAAPIEasesLookups[ease] = parsedEase;\n  } else if (isFnc(ease)) {\n    const easing = easingToLinear(ease);\n    if (easing) parsedEase = easing;\n  } else if (/** @type {Spring} */(ease).ease) {\n    parsedEase = easingToLinear(/** @type {Spring} */(ease).ease);\n  }\n  return parsedEase;\n};\n\n/**\n * @typedef {String|Number|Array<String>|Array<Number>} WAAPITweenValue\n */\n\n/**\n * @callback WAAPIFunctionvalue\n * @param {DOMTarget} target - The animated target\n * @param {Number} index - The target index\n * @param {Number} length - The total number of animated targets\n * @return {WAAPITweenValue}\n */\n\n/**\n * @typedef {WAAPITweenValue|WAAPIFunctionvalue|Array<String|Number|WAAPIFunctionvalue>} WAAPIKeyframeValue\n */\n\n/**\n * @typedef {(animation: WAAPIAnimation) => void} WAAPICallback\n */\n\n/**\n * @typedef {Object} WAAPITweenOptions\n * @property {WAAPIKeyframeValue} [to]\n * @property {WAAPIKeyframeValue} [from]\n * @property {Number|WAAPIFunctionvalue} [duration]\n * @property {Number|WAAPIFunctionvalue} [delay]\n * @property {EasingParam} [ease]\n * @property {CompositeOperation} [composition]\n */\n\n/**\n * @typedef {Object} WAAPIAnimationOptions\n * @property {Number|Boolean} [loop]\n * @property {Boolean} [Reversed]\n * @property {Boolean} [Alternate]\n * @property {Boolean|ScrollObserver} [autoplay]\n * @property {Number} [playbackRate]\n * @property {Number|WAAPIFunctionvalue} [duration]\n * @property {Number|WAAPIFunctionvalue} [delay]\n * @property {EasingParam} [ease]\n * @property {CompositeOperation} [composition]\n * @property {WAAPICallback} [onComplete]\n */\n\n/**\n * @typedef {Record<String, WAAPIKeyframeValue | WAAPIAnimationOptions | Boolean | ScrollObserver | WAAPICallback | EasingParam | WAAPITweenOptions> & WAAPIAnimationOptions} WAAPIAnimationParams\n */\n\nconst transformsShorthands = ['x', 'y', 'z'];\nconst commonDefaultPXProperties = [\n  'perspective',\n  'width',\n  'height',\n  'margin',\n  'padding',\n  'top',\n  'right',\n  'bottom',\n  'left',\n  'borderWidth',\n  'fontSize',\n  'borderRadius',\n  ...transformsShorthands\n];\n\nconst validIndividualTransforms = [...transformsShorthands, ...validTransforms.filter(t => ['X', 'Y', 'Z'].some(axis => t.endsWith(axis)))];\n\n// Setting it to true in case CSS.registerProperty is not supported will automatically skip the registration and fallback to no animation\nlet transformsPropertiesRegistered = isBrowser && (isUnd(CSS) || !Object.hasOwnProperty.call(CSS, 'registerProperty'));\n\nconst registerTransformsProperties = () => {\n  if (transformsPropertiesRegistered) return;\n  validTransforms.forEach(t => {\n    const isSkew = stringStartsWith(t, 'skew');\n    const isScale = stringStartsWith(t, 'scale');\n    const isRotate = stringStartsWith(t, 'rotate');\n    const isTranslate = stringStartsWith(t, 'translate');\n    const isAngle = isRotate || isSkew;\n    const syntax = isAngle ? '<angle>' : isScale ? \"<number>\" : isTranslate ? \"<length-percentage>\" : \"*\";\n    try {\n      CSS.registerProperty({\n        name: '--' + t,\n        syntax,\n        inherits: false,\n        initialValue: isTranslate ? '0px' : isAngle ? '0deg' : isScale ? '1' : '0',\n      });\n    } catch {}  });\n  transformsPropertiesRegistered = true;\n};\n\nconst WAAPIAnimationsLookups = {\n  _head: null,\n  _tail: null,\n};\n\n/**\n * @param {DOMTarget} $el\n * @param {String} [property]\n * @param {WAAPIAnimation} [parent]\n */\nconst removeWAAPIAnimation = ($el, property, parent) => {\n  let nextLookup = WAAPIAnimationsLookups._head;\n  while (nextLookup) {\n    const next = nextLookup._next;\n    const matchTarget = nextLookup.$el === $el;\n    const matchProperty = !property || nextLookup.property === property;\n    const matchParent = !parent || nextLookup.parent === parent;\n    if (matchTarget && matchProperty && matchParent) {\n      const anim = nextLookup.animation;\n      try { anim.commitStyles(); } catch {}      anim.cancel();\n      removeChild(WAAPIAnimationsLookups, nextLookup);\n      const lookupParent = nextLookup.parent;\n      if (lookupParent) {\n        lookupParent._completed++;\n        if (lookupParent.animations.length === lookupParent._completed) {\n          lookupParent.completed = true;\n          if (!lookupParent.muteCallbacks) {\n            lookupParent.paused = true;\n            lookupParent.onComplete(lookupParent);\n            lookupParent._resolve(lookupParent);\n          }\n        }\n      }\n    }\n    nextLookup = next;\n  }\n};\n\n/**\n * @param {WAAPIAnimation} parent\n * @param {DOMTarget} $el\n * @param {String} property\n * @param {PropertyIndexedKeyframes} keyframes\n * @param {KeyframeAnimationOptions} params\n * @retun {Animation}\n */\nconst addWAAPIAnimation = (parent, $el, property, keyframes, params) => {\n  const animation = $el.animate(keyframes, params);\n  const animTotalDuration = params.delay + (+params.duration * params.iterations);\n  animation.playbackRate = parent._speed;\n  if (parent.paused) animation.pause();\n  if (parent.duration < animTotalDuration) {\n    parent.duration = animTotalDuration;\n    parent.controlAnimation = animation;\n  }\n  parent.animations.push(animation);\n  removeWAAPIAnimation($el, property);\n  addChild(WAAPIAnimationsLookups, { parent, animation, $el, property, _next: null, _prev: null });\n  const handleRemove = () => { removeWAAPIAnimation($el, property, parent); };\n  animation.onremove = handleRemove;\n  animation.onfinish = handleRemove;\n  return animation;\n};\n\n/**\n * @param  {String} propName\n * @param  {WAAPIKeyframeValue} value\n * @param  {DOMTarget} $el\n * @param  {Number} i\n * @param  {Number} targetsLength\n * @return {String}\n */\nconst normalizeTweenValue = (propName, value, $el, i, targetsLength) => {\n  let v = getFunctionValue(/** @type {any} */(value), $el, i, targetsLength);\n  if (!isNum(v)) return v;\n  if (commonDefaultPXProperties.includes(propName) || stringStartsWith(propName, 'translate')) return `${v}px`;\n  if (stringStartsWith(propName, 'rotate') || stringStartsWith(propName, 'skew')) return `${v}deg`;\n  return `${v}`;\n};\n\n/**\n * @param  {DOMTarget} $el\n * @param  {String} propName\n * @param  {WAAPIKeyframeValue} from\n * @param  {WAAPIKeyframeValue} to\n * @param  {Number} i\n * @param  {Number} targetsLength\n * @return {WAAPITweenValue}\n */\nconst parseIndividualTweenValue = ($el, propName, from, to, i, targetsLength) => {\n  /** @type {WAAPITweenValue} */\n  let tweenValue = '0';\n  const computedTo = !isUnd(to) ? normalizeTweenValue(propName, to, $el, i, targetsLength) : getComputedStyle($el)[propName];\n  if (!isUnd(from)) {\n    const computedFrom = normalizeTweenValue(propName, from, $el, i, targetsLength);\n    tweenValue = [computedFrom, computedTo];\n  } else {\n    tweenValue = isArr(to) ? to.map((/** @type {any} */v) => normalizeTweenValue(propName, v, $el, i, targetsLength)) : computedTo;\n  }\n  return tweenValue;\n};\n\nclass WAAPIAnimation {\n/**\n * @param {DOMTargetsParam} targets\n * @param {WAAPIAnimationParams} params\n */\n  constructor(targets, params) {\n\n    if (globals.scope) globals.scope.revertibles.push(this);\n\n    registerTransformsProperties();\n\n    const parsedTargets = registerTargets(targets);\n    const targetsLength = parsedTargets.length;\n\n    if (!targetsLength) {\n      console.warn(`No target found. Make sure the element you're trying to animate is accessible before creating your animation.`);\n    }\n\n    const ease = setValue(params.ease, parseWAAPIEasing(globals.defaults.ease));\n    const spring = /** @type {Spring} */(ease).ease && ease;\n    const autoplay = setValue(params.autoplay, globals.defaults.autoplay);\n    const scroll = autoplay && /** @type {ScrollObserver} */(autoplay).link ? autoplay : false;\n    const alternate = params.alternate && /** @type {Boolean} */(params.alternate) === true;\n    const reversed = params.reversed && /** @type {Boolean} */(params.reversed) === true;\n    const loop = setValue(params.loop, globals.defaults.loop);\n    const iterations = /** @type {Number} */((loop === true || loop === Infinity) ? Infinity : isNum(loop) ? loop + 1 : 1);\n    /** @type {PlaybackDirection} */\n    const direction = alternate ? reversed ? 'alternate-reverse' : 'alternate' : reversed ? 'reverse' : 'normal';\n    /** @type {FillMode} */\n    const fill = 'forwards';\n    /** @type {String} */\n    const easing = parseWAAPIEasing(ease);\n    const timeScale = (globals.timeScale === 1 ? 1 : K);\n\n    /** @type {DOMTargetsArray}] */\n    this.targets = parsedTargets;\n    /** @type {Array<globalThis.Animation>}] */\n    this.animations = [];\n    /** @type {globalThis.Animation}] */\n    this.controlAnimation = null;\n    /** @type {Callback<this>} */\n    this.onComplete = params.onComplete || noop;\n    /** @type {Number} */\n    this.duration = 0;\n    /** @type {Boolean} */\n    this.muteCallbacks = false;\n    /** @type {Boolean} */\n    this.completed = false;\n    /** @type {Boolean} */\n    this.paused = !autoplay || scroll !== false;\n    /** @type {Boolean} */\n    this.reversed = reversed;\n    /** @type {Boolean|ScrollObserver} */\n    this.autoplay = autoplay;\n    /** @type {Number} */\n    this._speed = setValue(params.playbackRate, globals.defaults.playbackRate);\n    /** @type {Function} */\n    this._resolve = noop; // Used by .then()\n    /** @type {Number} */\n    this._completed = 0;\n    /** @type {Array<Object>}] */\n    this._inlineStyles = parsedTargets.map($el => $el.getAttribute('style'));\n\n    parsedTargets.forEach(($el, i) => {\n\n      const cachedTransforms = $el[transformsSymbol];\n\n      const hasIndividualTransforms = validIndividualTransforms.some(t => params.hasOwnProperty(t));\n\n      /** @type {Number} */\n      const duration = (spring ? /** @type {Spring} */(spring).duration : getFunctionValue(setValue(params.duration, globals.defaults.duration), $el, i, targetsLength)) * timeScale;\n      /** @type {Number} */\n      const delay = getFunctionValue(setValue(params.delay, globals.defaults.delay), $el, i, targetsLength) * timeScale;\n      /** @type {CompositeOperation} */\n      const composite = /** @type {CompositeOperation} */(setValue(params.composition, 'replace'));\n\n      for (let name in params) {\n        if (!isKey(name)) continue;\n        /** @type {PropertyIndexedKeyframes} */\n        const keyframes = {};\n        /** @type {KeyframeAnimationOptions} */\n        const tweenParams = { iterations, direction, fill, easing, duration, delay, composite };\n        const propertyValue = params[name];\n        const individualTransformProperty = hasIndividualTransforms ? validTransforms.includes(name) ? name : shortTransforms.get(name) : false;\n        let parsedPropertyValue;\n        if (isObj(propertyValue)) {\n          const tweenOptions = /** @type {WAAPITweenOptions} */(propertyValue);\n          const tweenOptionsEase = setValue(tweenOptions.ease, ease);\n          const tweenOptionsSpring = /** @type {Spring} */(tweenOptionsEase).ease && tweenOptionsEase;\n          const to = /** @type {WAAPITweenOptions} */(tweenOptions).to;\n          const from = /** @type {WAAPITweenOptions} */(tweenOptions).from;\n          /** @type {Number} */\n          tweenParams.duration = (tweenOptionsSpring ? /** @type {Spring} */(tweenOptionsSpring).duration : getFunctionValue(setValue(tweenOptions.duration, duration), $el, i, targetsLength)) * timeScale;\n          /** @type {Number} */\n          tweenParams.delay = getFunctionValue(setValue(tweenOptions.delay, delay), $el, i, targetsLength) * timeScale;\n          /** @type {CompositeOperation} */\n          tweenParams.composite = /** @type {CompositeOperation} */(setValue(tweenOptions.composition, composite));\n          /** @type {String} */\n          tweenParams.easing = parseWAAPIEasing(tweenOptionsEase);\n          parsedPropertyValue = parseIndividualTweenValue($el, name, from, to, i, targetsLength);\n          if (individualTransformProperty) {\n            keyframes[`--${individualTransformProperty}`] = parsedPropertyValue;\n            cachedTransforms[individualTransformProperty] = parsedPropertyValue;\n          } else {\n            keyframes[name] = parseIndividualTweenValue($el, name, from, to, i, targetsLength);\n          }\n          addWAAPIAnimation(this, $el, name, keyframes, tweenParams);\n          if (!isUnd(from)) {\n            if (!individualTransformProperty) {\n              $el.style[name] = keyframes[name][0];\n            } else {\n              const key = `--${individualTransformProperty}`;\n              $el.style.setProperty(key, keyframes[key][0]);\n            }\n          }\n        } else {\n          parsedPropertyValue = isArr(propertyValue) ?\n                                propertyValue.map((/** @type {any} */v) => normalizeTweenValue(name, v, $el, i, targetsLength)) :\n                                normalizeTweenValue(name, /** @type {any} */(propertyValue), $el, i, targetsLength);\n          if (individualTransformProperty) {\n            keyframes[`--${individualTransformProperty}`] = parsedPropertyValue;\n            cachedTransforms[individualTransformProperty] = parsedPropertyValue;\n          } else {\n            keyframes[name] = parsedPropertyValue;\n          }\n          addWAAPIAnimation(this, $el, name, keyframes, tweenParams);\n        }\n      }\n      if (hasIndividualTransforms) {\n        let transforms = emptyString;\n        for (let t in cachedTransforms) {\n          transforms += `${transformsFragmentStrings[t]}var(--${t})) `;\n        }\n        $el.style.transform = transforms;\n      }\n    });\n\n    if (scroll) {\n      /** @type {ScrollObserver} */(this.autoplay).link(this);\n    }\n  }\n\n  /**\n   * @callback forEachCallback\n   * @param {globalThis.Animation} animation\n   */\n\n  /**\n   * @param  {forEachCallback|String} callback\n   * @return {this}\n   */\n  forEach(callback) {\n    const cb = isStr(callback) ? a => a[callback]() : callback;\n    this.animations.forEach(cb);\n    return this;\n  }\n\n  get speed() {\n    return this._speed;\n  }\n\n  /** @param {Number} speed */\n  set speed(speed) {\n    this._speed = +speed;\n    this.forEach(anim => anim.playbackRate = speed);\n  }\n\n  get currentTime() {\n    const controlAnimation = this.controlAnimation;\n    const timeScale = globals.timeScale;\n    return this.completed ? this.duration : controlAnimation ? +controlAnimation.currentTime * (timeScale === 1 ? 1 : timeScale) : 0;\n  }\n\n  /** @param {Number} time */\n  set currentTime(time) {\n    const t = time * (globals.timeScale === 1 ? 1 : K);\n    this.forEach(anim => {\n      // Make sure the animation playState is not 'paused' in order to properly trigger an onfinish callback.\n      // The \"paused\" play state supersedes the \"finished\" play state; if the animation is both paused and finished, the \"paused\" state is the one that will be reported.\n      // https://developer.mozilla.org/en-US/docs/Web/API/Animation/finish_event\n      if (t >= this.duration) anim.play();\n      anim.currentTime = t;\n    });\n  }\n\n  get progress() {\n    return this.currentTime / this.duration;\n  }\n\n  /** @param {Number} progress */\n  set progress(progress) {\n    this.forEach(anim => anim.currentTime = progress * this.duration || 0);\n  }\n\n  resume() {\n    if (!this.paused) return this;\n    this.paused = false;\n    // TODO: Store the current time, and seek back to the last position\n    return this.forEach('play');\n  }\n\n  pause() {\n    if (this.paused) return this;\n    this.paused = true;\n    return this.forEach('pause');\n  }\n\n  alternate() {\n    this.reversed = !this.reversed;\n    this.forEach('reverse');\n    if (this.paused) this.forEach('pause');\n    return this;\n  }\n\n  play() {\n    if (this.reversed) this.alternate();\n    return this.resume();\n  }\n\n  reverse() {\n    if (!this.reversed) this.alternate();\n    return this.resume();\n  }\n\n /**\n  * @param {Number} time\n  * @param {Boolean} muteCallbacks\n  */\n  seek(time, muteCallbacks = false) {\n    if (muteCallbacks) this.muteCallbacks = true;\n    if (time < this.duration) this.completed = false;\n    this.currentTime = time;\n    this.muteCallbacks = false;\n    if (this.paused) this.pause();\n    return this;\n  }\n\n  restart() {\n    this.completed = false;\n    return this.seek(0, true).resume();\n  }\n\n  commitStyles() {\n    return this.forEach('commitStyles');\n  }\n\n  complete() {\n    return this.seek(this.duration);\n  }\n\n  cancel() {\n    this.forEach('cancel');\n    return this.pause();\n  }\n\n  revert() {\n    this.cancel();\n    this.targets.forEach(($el, i) => $el.setAttribute('style', this._inlineStyles[i]) );\n    return this;\n  }\n\n  /**\n   * @param  {WAAPICallback} [callback]\n   * @return {Promise}\n   */\n  then(callback = noop) {\n    const then = this.then;\n    const onResolve = () => {\n      this.then = null;\n      callback(this);\n      this.then = then;\n      this._resolve = noop;\n    };\n    return new Promise(r => {\n      this._resolve = () => r(onResolve());\n      if (this.completed) this._resolve();\n      return this;\n    });\n  }\n}\n\nconst waapi = {\n/**\n * @param {DOMTargetsParam} targets\n * @param {WAAPIAnimationParams} params\n * @return {WAAPIAnimation}\n */\n  animate: (targets, params) => new WAAPIAnimation(targets, params),\n  convertEase: easingToLinear\n};\n\n\n\n\n/**\n * @param  {Callback<Timer>} [callback]\n * @return {Timer}\n */\nconst sync = (callback = noop) => {\n  return new Timer({ duration: 1 * globals.timeScale, onComplete: callback }, null, 0).resume();\n};\n\n/**\n * @overload\n * @param  {DOMTargetSelector} targetSelector\n * @param  {String}            propName\n * @return {String}\n *\n * @overload\n * @param  {JSTargetsParam} targetSelector\n * @param  {String}         propName\n * @return {Number|String}\n *\n * @overload\n * @param  {DOMTargetsParam} targetSelector\n * @param  {String}          propName\n * @param  {String}          unit\n * @return {String}\n *\n * @overload\n * @param  {TargetsParam} targetSelector\n * @param  {String}       propName\n * @param  {Boolean}      unit\n * @return {Number}\n *\n * @param  {TargetsParam}   targetSelector\n * @param  {String}         propName\n * @param  {String|Boolean} [unit]\n */\nfunction getTargetValue(targetSelector, propName, unit) {\n  const targets = registerTargets(targetSelector);\n  if (!targets.length) return;\n  const [ target ] = targets;\n  const tweenType = getTweenType(target, propName);\n  const normalizePropName = sanitizePropertyName(propName, target, tweenType);\n  let originalValue = getOriginalAnimatableValue(target, normalizePropName);\n  if (isUnd(unit)) {\n    return originalValue;\n  } else {\n    decomposeRawValue(originalValue, decomposedOriginalValue);\n    if (decomposedOriginalValue.t === valueTypes.NUMBER || decomposedOriginalValue.t === valueTypes.UNIT) {\n      if (unit === false) {\n        return decomposedOriginalValue.n;\n      } else {\n        const convertedValue = convertValueUnit(/** @type {DOMTarget} */(target), decomposedOriginalValue, /** @type {String} */(unit), false);\n        return `${round(convertedValue.n, globals.precision)}${convertedValue.u}`;\n      }\n    }\n  }\n}\n\n/**\n * @param  {TargetsParam}    targets\n * @param  {AnimationParams} parameters\n * @return {JSAnimation}\n */\nconst setTargetValues = (targets, parameters) => {\n  if (isUnd(parameters)) return;\n  parameters.duration = minValue;\n  // Do not overrides currently active tweens by default\n  parameters.composition = setValue(parameters.composition, compositionTypes.none);\n  // Skip init() and force rendering by playing the animation\n  return new JSAnimation(targets, parameters, null, 0, true).resume();\n};\n\n/**\n * @param  {TargetsArray} targetsArray\n * @param  {JSAnimation}    animation\n * @param  {String}       [propertyName]\n * @return {Boolean}\n */\nconst removeTargetsFromAnimation = (targetsArray, animation, propertyName) => {\n  let tweensMatchesTargets = false;\n  forEachChildren(animation, (/**@type {Tween} */tween) => {\n    const tweenTarget = tween.target;\n    if (targetsArray.includes(tweenTarget)) {\n      const tweenName = tween.property;\n      const tweenType = tween._tweenType;\n      const normalizePropName = sanitizePropertyName(propertyName, tweenTarget, tweenType);\n      if (!normalizePropName || normalizePropName && normalizePropName === tweenName) {\n        // Make sure to flag the previous CSS transform tween to renderTransform\n        if (tween.parent._tail === tween &&\n            tween._tweenType === tweenTypes.TRANSFORM &&\n            tween._prev &&\n            tween._prev._tweenType === tweenTypes.TRANSFORM\n        ) {\n          tween._prev._renderTransforms = 1;\n        }\n        // Removes the tween from the selected animation\n        removeChild(animation, tween);\n        // Detach the tween from its siblings to make sure blended tweens are correctlly removed\n        removeTweenSliblings(tween);\n        tweensMatchesTargets = true;\n      }\n    }\n  }, true);\n  return tweensMatchesTargets;\n};\n\n/**\n * @param  {TargetsParam} targets\n * @param  {Renderable|WAAPIAnimation} [renderable]\n * @param  {String}                    [propertyName]\n * @return {TargetsArray}\n */\nconst remove = (targets, renderable, propertyName) => {\n  const targetsArray = parseTargets(targets);\n  const parent = /** @type {Renderable|typeof engine} **/(renderable ? renderable : engine);\n  const waapiAnimation = renderable && /** @type {WAAPIAnimation} */(renderable).controlAnimation && /** @type {WAAPIAnimation} */(renderable);\n  for (let i = 0, l = targetsArray.length; i < l; i++) {\n    const $el = /** @type {DOMTarget}  */(targetsArray[i]);\n    removeWAAPIAnimation($el, propertyName, waapiAnimation);\n  }\n  let removeMatches;\n  if (parent._hasChildren) {\n    let iterationDuration = 0;\n    forEachChildren(parent, (/** @type {Renderable} */child) => {\n      if (!child._hasChildren) {\n        removeMatches = removeTargetsFromAnimation(targetsArray, /** @type {JSAnimation} */(child), propertyName);\n        // Remove the child from its parent if no tweens and no children left after the removal\n        if (removeMatches && !child._head) {\n          child.cancel();\n          removeChild(parent, child);\n        } else {\n          // Calculate the new iterationDuration value to handle onComplete with last child in render()\n          const childTLOffset = child._offset + child._delay;\n          const childDur = childTLOffset + child.duration;\n          if (childDur > iterationDuration) {\n            iterationDuration = childDur;\n          }\n        }\n      }\n      // Make sure to also remove engine's children targets\n      // NOTE: Avoid recursion?\n      if (child._head) {\n        remove(targets, child, propertyName);\n      } else {\n        child._hasChildren = false;\n      }\n    }, true);\n    // Update iterationDuration value to handle onComplete with last child in render()\n    if (!isUnd(/** @type {Renderable} */(parent).iterationDuration)) {\n      /** @type {Renderable} */(parent).iterationDuration = iterationDuration;\n    }\n  } else {\n    removeMatches = removeTargetsFromAnimation(\n      targetsArray,\n      /** @type {JSAnimation} */(parent),\n      propertyName\n    );\n  }\n\n  if (removeMatches && !parent._head) {\n    parent._hasChildren = false;\n    // Cancel the parent if there are no tweens and no children left after the removal\n    // We have to check if the .cancel() method exist to handle cases where the parent is the engine itself\n    if (/** @type {Renderable} */(parent).cancel) /** @type {Renderable} */(parent).cancel();\n  }\n\n  return targetsArray;\n};\n\n/**\n * @param  {Number} min\n * @param  {Number} max\n * @param  {Number} [decimalLength]\n * @return {Number}\n */\nconst random = (min, max, decimalLength) => { const m = 10 ** (decimalLength || 0); return floor((Math.random() * (max - min + (1 / m)) + min) * m) / m };\n\n/**\n * @param  {String|Array} items\n * @return {any}\n */\nconst randomPick = items => items[random(0, items.length - 1)];\n\n/**\n * Adapted from https://bost.ocks.org/mike/shuffle/\n * @param  {Array} items\n * @return {Array}\n */\nconst shuffle = items => {\n  let m = items.length, t, i;\n  while (m) { i = random(0, --m); t = items[m]; items[m] = items[i]; items[i] = t; }\n  return items;\n};\n\n/**\n * @param  {Number|String} v\n * @param  {Number} decimalLength\n * @return {String}\n */\nconst roundPad = (v, decimalLength) => (+v).toFixed(decimalLength);\n\n/**\n * @param  {Number} v\n * @param  {Number} totalLength\n * @param  {String} padString\n * @return {String}\n */\nconst padStart = (v, totalLength, padString) => `${v}`.padStart(totalLength, padString);\n\n/**\n * @param  {Number} v\n * @param  {Number} totalLength\n * @param  {String} padString\n * @return {String}\n */\nconst padEnd = (v, totalLength, padString) => `${v}`.padEnd(totalLength, padString);\n\n/**\n * @param  {Number} v\n * @param  {Number} min\n * @param  {Number} max\n * @return {Number}\n */\nconst wrap = (v, min, max) => (((v - min) % (max - min) + (max - min)) % (max - min)) + min;\n\n/**\n * @param  {Number} value\n * @param  {Number} inLow\n * @param  {Number} inHigh\n * @param  {Number} outLow\n * @param  {Number} outHigh\n * @return {Number}\n */\nconst mapRange = (value, inLow, inHigh, outLow, outHigh) => outLow + ((value - inLow) / (inHigh - inLow)) * (outHigh - outLow);\n\n/**\n * @param  {Number} degrees\n * @return {Number}\n */\nconst degToRad = degrees => degrees * PI / 180;\n\n/**\n * @param  {Number} radians\n * @return {Number}\n */\nconst radToDeg = radians => radians * 180 / PI;\n\n/**\n * https://www.rorydriscoll.com/2016/03/07/frame-rate-independent-damping-using-lerp/\n * @param  {Number} start\n * @param  {Number} end\n * @param  {Number} amount\n * @param  {Renderable|Boolean} [renderable]\n * @return {Number}\n */\nconst lerp = (start, end, amount, renderable) => {\n  let dt = K / globals.defaults.frameRate;\n  if (renderable !== false) {\n    const ticker = /** @type Renderable */\n                   (renderable) ||\n                   (engine._hasChildren && engine);\n    if (ticker && ticker.deltaTime) {\n      dt = ticker.deltaTime;\n    }\n  }\n  const t = 1 - Math.exp(-amount * dt * .1);\n  return !amount ? start : amount === 1 ? end : (1 - t) * start + t * end;\n};\n\n// Chain-able utilities\n\n/**\n * @callback UtilityFunction\n * @param {...*} args\n * @return {Number|String}\n *\n * @param {UtilityFunction} fn\n * @param {Number} [last=0]\n * @return {function(...(Number|String)): function(Number|String): (Number|String)}\n */\nconst curry = (fn, last = 0) => (...args) => last ? v => fn(...args, v) : v => fn(v, ...args);\n\n/**\n * @param {Function} fn\n * @return {function(...(Number|String))}\n */\nconst chain = fn => {\n   return (...args) => {\n    const result = fn(...args);\n    return new Proxy(noop, {\n      apply: (_, __, [v]) => result(v),\n      get: (_, prop) => chain(/**@param {...Number|String} nextArgs */(...nextArgs) => {\n        const nextResult = utils[prop](...nextArgs);\n        return (/**@type {Number|String} */v) => nextResult(result(v));\n      })\n    });\n  }\n};\n\n/**\n * @param {UtilityFunction} fn\n * @param {Number} [right]\n * @return {function(...(Number|String)): UtilityFunction}\n */\nconst makeChainable = (fn, right = 0) => (...args) => (args.length < fn.length ? chain(curry(fn, right)) : fn)(...args);\n\n/**\n * @callback ChainedUtilsResult\n * @param {Number} value\n * @return {Number}\n *\n * @typedef {Object} ChainableUtils\n * @property {ChainedClamp} clamp\n * @property {ChainedRound} round\n * @property {ChainedSnap} snap\n * @property {ChainedWrap} wrap\n * @property {ChainedInterpolate} interpolate\n * @property {ChainedMapRange} mapRange\n * @property {ChainedRoundPad} roundPad\n * @property {ChainedPadStart} padStart\n * @property {ChainedPadEnd} padEnd\n * @property {ChainedDegToRad} degToRad\n * @property {ChainedRadToDeg} radToDeg\n *\n * @typedef {ChainableUtils & ChainedUtilsResult} ChainableUtil\n *\n * @callback ChainedClamp\n * @param {Number} min\n * @param {Number} max\n * @return {ChainableUtil}\n *\n * @callback ChainedRound\n * @param {Number} decimalLength\n * @return {ChainableUtil}\n *\n * @callback ChainedSnap\n * @param {Number} increment\n * @return {ChainableUtil}\n *\n * @callback ChainedWrap\n * @param {Number} min\n * @param {Number} max\n * @return {ChainableUtil}\n *\n * @callback ChainedInterpolate\n * @param {Number} start\n * @param {Number} end\n * @return {ChainableUtil}\n *\n * @callback ChainedMapRange\n * @param {Number} inLow\n * @param {Number} inHigh\n * @param {Number} outLow\n * @param {Number} outHigh\n * @return {ChainableUtil}\n *\n * @callback ChainedRoundPad\n * @param {Number} decimalLength\n * @return {ChainableUtil}\n *\n * @callback ChainedPadStart\n * @param {Number} totalLength\n * @param {String} padString\n * @return {ChainableUtil}\n *\n * @callback ChainedPadEnd\n * @param {Number} totalLength\n * @param {String} padString\n * @return {ChainableUtil}\n *\n * @callback ChainedDegToRad\n * @return {ChainableUtil}\n *\n * @callback ChainedRadToDeg\n * @return {ChainableUtil}\n */\n\nconst utils = {\n  $: registerTargets,\n  get: getTargetValue,\n  set: setTargetValues,\n  remove,\n  cleanInlineStyles,\n  random,\n  randomPick,\n  shuffle,\n  lerp,\n  sync,\n  clamp: /** @type {typeof clamp & ChainedClamp} */(makeChainable(clamp)),\n  round: /** @type {typeof round & ChainedRound} */(makeChainable(round)),\n  snap: /** @type {typeof snap & ChainedSnap} */(makeChainable(snap)),\n  wrap: /** @type {typeof wrap & ChainedWrap} */(makeChainable(wrap)),\n  interpolate: /** @type {typeof interpolate & ChainedInterpolate} */(makeChainable(interpolate, 1)),\n  mapRange: /** @type {typeof mapRange & ChainedMapRange} */(makeChainable(mapRange)),\n  roundPad: /** @type {typeof roundPad & ChainedRoundPad} */(makeChainable(roundPad)),\n  padStart: /** @type {typeof padStart & ChainedPadStart} */(makeChainable(padStart)),\n  padEnd: /** @type {typeof padEnd & ChainedPadEnd} */(makeChainable(padEnd)),\n  degToRad: /** @type {typeof degToRad & ChainedDegToRad} */(makeChainable(degToRad)),\n  radToDeg: /** @type {typeof radToDeg & ChainedRadToDeg} */(makeChainable(radToDeg)),\n};\n\n\n\n\n/**\n * @typedef {Number|String|Function} TimePosition\n */\n\n/**\n * Timeline's children offsets positions parser\n * @param  {Timeline} timeline\n * @param  {String} timePosition\n * @return {Number}\n */\nconst getPrevChildOffset = (timeline, timePosition) => {\n  if (stringStartsWith(timePosition, '<')) {\n    const goToPrevAnimationOffset = timePosition[1] === '<';\n    const prevAnimation = /** @type {Tickable} */(timeline._tail);\n    const prevOffset = prevAnimation ? prevAnimation._offset + prevAnimation._delay : 0;\n    return goToPrevAnimationOffset ? prevOffset : prevOffset + prevAnimation.duration;\n  }\n};\n\n/**\n * @param  {Timeline} timeline\n * @param  {TimePosition} [timePosition]\n * @return {Number}\n */\nconst parseTimelinePosition = (timeline, timePosition) => {\n  let tlDuration = timeline.iterationDuration;\n  if (tlDuration === minValue) tlDuration = 0;\n  if (isUnd(timePosition)) return tlDuration;\n  if (isNum(+timePosition)) return +timePosition;\n  const timePosStr = /** @type {String} */(timePosition);\n  const tlLabels = timeline ? timeline.labels : null;\n  const hasLabels = !isNil(tlLabels);\n  const prevOffset = getPrevChildOffset(timeline, timePosStr);\n  const hasSibling = !isUnd(prevOffset);\n  const matchedRelativeOperator = relativeValuesExecRgx.exec(timePosStr);\n  if (matchedRelativeOperator) {\n    const fullOperator = matchedRelativeOperator[0];\n    const split = timePosStr.split(fullOperator);\n    const labelOffset = hasLabels && split[0] ? tlLabels[split[0]] : tlDuration;\n    const parsedOffset = hasSibling ? prevOffset : hasLabels ? labelOffset : tlDuration;\n    const parsedNumericalOffset = +split[1];\n    return getRelativeValue(parsedOffset, parsedNumericalOffset, fullOperator[0]);\n  } else {\n    return hasSibling ? prevOffset :\n           hasLabels ? !isUnd(tlLabels[timePosStr]) ? tlLabels[timePosStr] :\n           tlDuration : tlDuration;\n  }\n};\n\n/**\n * @param {Timeline} tl\n * @return {Number}\n */\nfunction getTimelineTotalDuration(tl) {\n  return clampInfinity(((tl.iterationDuration + tl._loopDelay) * tl.iterationCount) - tl._loopDelay) || minValue;\n}\n\n/**\n * @overload\n * @param  {TimerParams} childParams\n * @param  {Timeline} tl\n * @param  {Number} timePosition\n * @return {Timeline}\n *\n * @overload\n * @param  {AnimationParams} childParams\n * @param  {Timeline} tl\n * @param  {Number} timePosition\n * @param  {TargetsParam} targets\n * @param  {Number} [index]\n * @param  {Number} [length]\n * @return {Timeline}\n *\n * @param  {TimerParams|AnimationParams} childParams\n * @param  {Timeline} tl\n * @param  {Number} timePosition\n * @param  {TargetsParam} [targets]\n * @param  {Number} [index]\n * @param  {Number} [length]\n */\nfunction addTlChild(childParams, tl, timePosition, targets, index, length) {\n  const isSetter = isNum(childParams.duration) && /** @type {Number} */(childParams.duration) <= minValue;\n  // Offset the tl position with -minValue for 0 duration animations or .set() calls in order to align their end value with the defined position\n  const adjustedPosition = isSetter ? timePosition - minValue : timePosition;\n  tick(tl, adjustedPosition, 1, 1, tickModes.AUTO);\n  const tlChild = targets ?\n    new JSAnimation(targets,/** @type {AnimationParams} */(childParams), tl, adjustedPosition, false, index, length) :\n    new Timer(/** @type {TimerParams} */(childParams), tl, adjustedPosition);\n  tlChild.init(1);\n  // TODO: Might be better to insert at a position relative to startTime?\n  addChild(tl, tlChild);\n  forEachChildren(tl, (/** @type {Renderable} */child) => {\n    const childTLOffset = child._offset + child._delay;\n    const childDur = childTLOffset + child.duration;\n    if (childDur > tl.iterationDuration) tl.iterationDuration = childDur;\n  });\n  tl.duration = getTimelineTotalDuration(tl);\n  return tl;\n}\n\nclass Timeline extends Timer {\n\n  /**\n   * @param {TimelineParams} [parameters]\n   */\n  constructor(parameters = {}) {\n    super(/** @type {TimerParams&TimelineParams} */(parameters), null, 0);\n    /** @type {Number} */\n    this.duration = 0; // TL duration starts at 0 and grows when adding children\n    /** @type {Record<String, Number>} */\n    this.labels = {};\n    const defaultsParams = parameters.defaults;\n    const globalDefaults = globals.defaults;\n    /** @type {DefaultsParams} */\n    this.defaults = defaultsParams ? mergeObjects(defaultsParams, globalDefaults) : globalDefaults;\n    /** @type {Callback<this>} */\n    this.onRender = parameters.onRender || globalDefaults.onRender;\n    const tlPlaybackEase = setValue(parameters.playbackEase, globalDefaults.playbackEase);\n    this._ease = tlPlaybackEase ? parseEasings(tlPlaybackEase) : null;\n    /** @type {Number} */\n    this.iterationDuration = 0;\n  }\n\n  /**\n   * @overload\n   * @param {TargetsParam} a1\n   * @param {AnimationParams} a2\n   * @param {TimePosition} [a3]\n   * @return {this}\n   *\n   * @overload\n   * @param {TimerParams} a1\n   * @param {TimePosition} [a2]\n   * @return {this}\n   *\n   * @param {TargetsParam|TimerParams} a1\n   * @param {AnimationParams|TimePosition} a2\n   * @param {TimePosition} [a3]\n   */\n  add(a1, a2, a3) {\n    const isAnim = isObj(a2);\n    const isTimer = isObj(a1);\n    if (isAnim || isTimer) {\n      this._hasChildren = true;\n      if (isAnim) {\n        const childParams = /** @type {AnimationParams} */(a2);\n        // Check for function for children stagger positions\n        if (isFnc(a3)) {\n          const staggeredPosition = /** @type {Function} */(a3);\n          const parsedTargetsArray = parseTargets(/** @type {TargetsParam} */(a1));\n          // Store initial duration before adding new children that will change the duration\n          const tlDuration = this.duration;\n          // Store initial _iterationDuration before adding new children that will change the duration\n          const tlIterationDuration = this.iterationDuration;\n          // Store the original id in order to add specific indexes to the new animations ids\n          const id = childParams.id;\n          let i = 0;\n          const parsedLength = parsedTargetsArray.length;\n          parsedTargetsArray.forEach((/** @type {Target} */target) => {\n            // Create a new parameter object for each staggered children\n            const staggeredChildParams = { ...childParams };\n            // Reset the duration of the timeline iteration before each stagger to prevent wrong start value calculation\n            this.duration = tlDuration;\n            this.iterationDuration = tlIterationDuration;\n            if (!isUnd(id)) staggeredChildParams.id = id + '-' + i;\n            addTlChild(\n              staggeredChildParams,\n              this,\n              staggeredPosition(target, i, parsedLength, this),\n              target,\n              i,\n              parsedLength\n            );\n            i++;\n          });\n        } else {\n          addTlChild(\n            childParams,\n            this,\n            parseTimelinePosition(this, a3),\n            /** @type {TargetsParam} */(a1),\n          );\n        }\n      } else {\n        // It's a Timer\n        addTlChild(\n          /** @type TimerParams */(a1),\n          this,\n          parseTimelinePosition(this,/** @type TimePosition */(a2)),\n        );\n      }\n      return this.init(1); // 1 = internalRender\n    }\n  }\n\n  /**\n   * @overload\n   * @param {Tickable} [synced]\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   * @overload\n   * @param {globalThis.Animation} [synced]\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   * @overload\n   * @param {WAAPIAnimation} [synced]\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   * @param {Tickable|WAAPIAnimation|globalThis.Animation} [synced]\n   * @param {TimePosition} [position]\n   */\n  sync(synced, position) {\n    if (isUnd(synced) || synced && isUnd(synced.pause)) return this;\n    synced.pause();\n    const duration = +(/** @type {globalThis.Animation} */(synced).effect ? /** @type {globalThis.Animation} */(synced).effect.getTiming().duration : /** @type {Tickable} */(synced).duration);\n    return this.add(synced, { currentTime: [0, duration], duration, ease: 'linear' }, position);\n  }\n\n  /**\n   * @param  {TargetsParam} targets\n   * @param  {AnimationParams} parameters\n   * @param  {TimePosition} [position]\n   * @return {this}\n   */\n  set(targets, parameters, position) {\n    if (isUnd(parameters)) return this;\n    parameters.duration = minValue;\n    parameters.composition = compositionTypes.replace;\n    return this.add(targets, parameters, position);\n  }\n\n  /**\n   * @param {Callback<Timer>} callback\n   * @param {TimePosition} [position]\n   * @return {this}\n   */\n  call(callback, position) {\n    if (isUnd(callback) || callback && !isFnc(callback)) return this;\n    return this.add({ duration: 0, onComplete: () => callback(this) }, position);\n  }\n\n  /**\n   * @param {String} labelName\n   * @param {TimePosition} [position]\n   * @return {this}\n   *\n   */\n  label(labelName, position) {\n    if (isUnd(labelName) || labelName && !isStr(labelName)) return this;\n    this.labels[labelName] = parseTimelinePosition(this,/** @type TimePosition */(position));\n    return this;\n  }\n\n  /**\n   * @param  {TargetsParam} targets\n   * @param  {String} [propertyName]\n   * @return {this}\n   */\n  remove(targets, propertyName) {\n    remove(targets, this, propertyName);\n    return this;\n  }\n\n  /**\n   * @param  {Number} newDuration\n   * @return {this}\n   */\n  stretch(newDuration) {\n    const currentDuration = this.duration;\n    if (currentDuration === normalizeTime(newDuration)) return this;\n    const timeScale = newDuration / currentDuration;\n    const labels = this.labels;\n    forEachChildren(this, (/** @type {JSAnimation} */child) => child.stretch(child.duration * timeScale));\n    for (let labelName in labels) labels[labelName] *= timeScale;\n    return super.stretch(newDuration);\n  }\n\n  /**\n   * @return {this}\n   */\n  refresh() {\n    forEachChildren(this, (/** @type {JSAnimation} */child) => {\n      if (child.refresh) child.refresh();\n    });\n    return this;\n  }\n\n  /**\n   * @return {this}\n   */\n  revert() {\n    super.revert();\n    forEachChildren(this, (/** @type {JSAnimation} */child) => child.revert, true);\n    return cleanInlineStyles(this);\n  }\n\n  /**\n   * @param  {Callback<this>} [callback]\n   * @return {Promise}\n   */\n  then(callback) {\n    return super.then(callback);\n  }\n}\n\n/**\n * @param {TimelineParams} [parameters]\n * @return {Timeline}\n */\nconst createTimeline = parameters => new Timeline(parameters).init();\n\n\n\n\nclass Animatable {\n  /**\n   * @param {TargetsParam} targets\n   * @param {AnimatableParams} parameters\n   */\n  constructor(targets, parameters) {\n    if (globals.scope) globals.scope.revertibles.push(this);\n    /** @type {AnimationParams} */\n    const globalParams = {};\n    const properties = {};\n    this.targets = [];\n    this.animations = {};\n    if (isUnd(targets) || isUnd(parameters)) return;\n    for (let propName in parameters) {\n      const paramValue = parameters[propName];\n      if (isKey(propName)) {\n        properties[propName] = paramValue;\n      } else {\n        globalParams[propName] = paramValue;\n      }\n    }\n    for (let propName in properties) {\n      const propValue = properties[propName];\n      const isObjValue = isObj(propValue);\n      /** @type {TweenParamsOptions} */\n      let propParams = {};\n      let to = '+=0';\n      if (isObjValue) {\n        const unit = propValue.unit;\n        if (isStr(unit)) to += unit;\n      } else {\n        propParams.duration = propValue;\n      }\n      propParams[propName] = isObjValue ? mergeObjects({ to }, propValue) : to;\n      const animParams = mergeObjects(globalParams, propParams);\n      animParams.composition = compositionTypes.replace;\n      animParams.autoplay = false;\n      const animation = this.animations[propName] = new JSAnimation(targets, animParams, null, 0, false).init();\n      if (!this.targets.length) this.targets.push(...animation.targets);\n      /** @type {AnimatableProperty} */\n      this[propName] = (to, duration, ease) => {\n        const tween = /** @type {Tween} */(animation._head);\n        if (isUnd(to) && tween) {\n          const numbers = tween._numbers;\n          if (numbers && numbers.length) {\n            return numbers;\n          } else {\n            return tween._modifier(tween._number);\n          }\n        } else {\n          forEachChildren(animation, (/** @type {Tween} */tween) => {\n            if (isArr(to)) {\n              for (let i = 0, l = /** @type {Array} */(to).length; i < l; i++) {\n                if (!isUnd(tween._numbers[i])) {\n                  tween._fromNumbers[i] = /** @type {Number} */(tween._modifier(tween._numbers[i]));\n                  tween._toNumbers[i] = to[i];\n                }\n              }\n            } else {\n              tween._fromNumber = /** @type {Number} */(tween._modifier(tween._number));\n              tween._toNumber = /** @type {Number} */(to);\n            }\n            if (!isUnd(ease)) tween._ease = parseEasings(ease);\n            tween._currentTime = 0;\n          });\n          if (!isUnd(duration)) animation.stretch(duration);\n          animation.reset(1).resume();\n          return this;\n        }\n      };\n    }\n  }\n\n  revert() {\n    for (let propName in this.animations) {\n      this[propName] = noop;\n      this.animations[propName].revert();\n    }\n    this.animations = {};\n    this.targets.length = 0;\n    return this;\n  }\n}\n\n/**\n * @param {TargetsParam} targets\n * @param {AnimatableParams} parameters\n * @return {AnimatableObject}\n */\nconst createAnimatable = (targets, parameters) => /** @type {AnimatableObject} */(new Animatable(targets, parameters));\n\n\n\n\n/*\n * Spring ease solver adapted from https://webkit.org/demos/spring/spring.js\n * Webkit Copyright © 2016 Apple Inc\n */\n\n/**\n * @typedef {Object} SpringParams\n * @property {Number} [mass=1] - Mass, default 1\n * @property {Number} [stiffness=100] - Stiffness, default 100\n * @property {Number} [damping=10] - Damping, default 10\n * @property {Number} [velocity=0] - Initial velocity, default 0\n */\n\nclass Spring {\n  /**\n   * @param {SpringParams} [parameters]\n   */\n  constructor(parameters = {}) {\n    this.timeStep = .02; // Interval fed to the solver to calculate duration\n    this.restThreshold = .0005; // Values below this threshold are considered resting position\n    this.restDuration = 200; // Duration in ms used to check if the spring is resting after reaching restThreshold\n    this.maxDuration = 60000; // The maximum allowed spring duration in ms (default 1 min)\n    this.maxRestSteps = this.restDuration / this.timeStep / K; // How many steps allowed after reaching restThreshold before stopping the duration calculation\n    this.maxIterations = this.maxDuration / this.timeStep / K; // Calculate the maximum iterations allowed based on maxDuration\n    this.m = clamp(setValue(parameters.mass, 1), 0, K);\n    this.s = clamp(setValue(parameters.stiffness, 100), 1, K);\n    this.d = clamp(setValue(parameters.damping, 10), .1, K);\n    this.v = clamp(setValue(parameters.velocity, 0), -1e3, K);\n    this.w0 = 0;\n    this.zeta = 0;\n    this.wd = 0;\n    this.b = 0;\n    this.solverDuration = 0;\n    this.duration = 0;\n    this.compute();\n    /** @type {EasingFunction} */\n    this.ease = t => t === 0 || t === 1 ? t : this.solve(t * this.solverDuration);\n  }\n\n  /** @type {EasingFunction} */\n  solve(time) {\n    const { zeta, w0, wd, b } = this;\n    let t = time;\n    if (zeta < 1) {\n      t = exp(-t * zeta * w0) * (1 * cos(wd * t) + b * sin(wd * t));\n    } else {\n      t = (1 + b * t) * exp(-t * w0);\n    }\n    return 1 - t;\n  }\n\n  compute() {\n    const { maxRestSteps, maxIterations, restThreshold, timeStep, m, d, s, v } = this;\n    const w0 = this.w0 = clamp(sqrt(s / m), minValue, K);\n    const zeta = this.zeta = d / (2 * sqrt(s * m));\n    const wd = this.wd = zeta < 1 ? w0 * sqrt(1 - zeta * zeta) : 0;\n    this.b = zeta < 1 ? (zeta * w0 + -v) / wd : -v + w0;\n    let solverTime = 0;\n    let restSteps = 0;\n    let iterations = 0;\n    while (restSteps < maxRestSteps && iterations < maxIterations) {\n      if (abs(1 - this.solve(solverTime)) < restThreshold) {\n        restSteps++;\n      } else {\n        restSteps = 0;\n      }\n      this.solverDuration = solverTime;\n      solverTime += timeStep;\n      iterations++;\n    }\n    this.duration = round(this.solverDuration * K, 0) * globals.timeScale;\n  }\n\n  get mass() {\n    return this.m;\n  }\n\n  set mass(v) {\n    this.m = clamp(setValue(v, 1), 0, K);\n    this.compute();\n  }\n\n  get stiffness() {\n    return this.s;\n  }\n\n  set stiffness(v) {\n    this.s = clamp(setValue(v, 100), 1, K);\n    this.compute();\n  }\n\n  get damping() {\n    return this.d;\n  }\n\n  set damping(v) {\n    this.d = clamp(setValue(v, 10), .1, K);\n    this.compute();\n  }\n\n  get velocity() {\n    return this.v;\n  }\n\n  set velocity(v) {\n    this.v = clamp(setValue(v, 0), -1e3, K);\n    this.compute();\n  }\n}\n\n/**\n * @param {SpringParams} [parameters]\n * @returns {Spring}\n */\nconst createSpring = (parameters) => new Spring(parameters);\n\n\n\n\n/**\n * @param {Event} e\n */\nconst preventDefault = e => {\n  if (e.cancelable) e.preventDefault();\n};\n\nclass DOMProxy {\n  /** @param {Object} el */\n  constructor(el) {\n    this.el = el;\n    this.zIndex = 0;\n    this.parentElement = null;\n    this.classList = {\n      add: noop,\n      remove: noop,\n    };\n  }\n\n  get x() { return this.el.x || 0 };\n  set x(v) { this.el.x = v; };\n\n  get y() { return this.el.y || 0 };\n  set y(v) { this.el.y = v; };\n\n  get width() { return this.el.width || 0 };\n  set width(v) { this.el.width = v; };\n\n  get height() { return this.el.height || 0 };\n  set height(v) { this.el.height = v; };\n\n  getBoundingClientRect() {\n    return {\n      top: this.y,\n      right: this.x,\n      bottom: this.y + this.height,\n      left: this.x + this.width,\n    }\n  }\n}\n\nclass Transforms {\n  /**\n   * @param {DOMTarget|DOMProxy} $el\n   */\n  constructor($el) {\n    this.$el = $el;\n    this.inlineTransforms = [];\n    this.point = new DOMPoint();\n    this.inversedMatrix = this.getMatrix().inverse();\n  }\n\n  /**\n   * @param {Number} x\n   * @param {Number} y\n   * @return {DOMPoint}\n   */\n  normalizePoint(x, y) {\n    this.point.x = x;\n    this.point.y = y;\n    return this.point.matrixTransform(this.inversedMatrix);\n  }\n\n  /**\n   * @callback TraverseParentsCallback\n   * @param {DOMTarget} $el\n   * @param {Number} i\n   */\n\n  /**\n   * @param {TraverseParentsCallback} cb\n   */\n  traverseUp(cb) {\n    let $el = /** @type {DOMTarget|Document} */(this.$el.parentElement), i = 0;\n    while ($el && $el !== doc) {\n      cb(/** @type {DOMTarget} */($el), i);\n      $el = /** @type {DOMTarget} */($el.parentElement);\n      i++;\n    }\n  }\n\n  getMatrix() {\n    const matrix = new DOMMatrix();\n    this.traverseUp($el => {\n      const transformValue = getComputedStyle($el).transform;\n      if (transformValue) {\n        const elMatrix = new DOMMatrix(transformValue);\n        matrix.preMultiplySelf(elMatrix);\n      }\n    });\n    return matrix;\n  }\n\n  remove() {\n    this.traverseUp(($el, i) => {\n      this.inlineTransforms[i] = $el.style.transform;\n      $el.style.transform = 'none';\n    });\n  }\n\n  revert() {\n    this.traverseUp(($el, i) => {\n      const ct = this.inlineTransforms[i];\n      if (ct === '') {\n        $el.style.removeProperty('transform');\n      } else {\n        $el.style.transform = ct;\n      }\n    });\n  }\n}\n\n/**\n * @template {Array<Number>|DOMTargetSelector|String|Number|Boolean|Function|DraggableCursorParams} T\n * @param {T | ((draggable: Draggable) => T)} value\n * @param {Draggable} draggable\n * @return {T}\n */\nconst parseDraggableFunctionParameter = (value, draggable) => value && isFnc(value) ? /** @type {Function} */(value)(draggable) : value;\n\nlet zIndex = 0;\n\nclass Draggable {\n  /**\n   * @param {TargetsParam} target\n   * @param {DraggableParams} [parameters]\n   */\n  constructor(target, parameters = {}) {\n    if (!target) return;\n    if (globals.scope) globals.scope.revertibles.push(this);\n    const paramX = parameters.x;\n    const paramY = parameters.y;\n    const trigger = parameters.trigger;\n    const modifier = parameters.modifier;\n    const ease = parameters.releaseEase;\n    const customEase = ease && parseEasings(ease);\n    const hasSpring = !isUnd(ease) && !isUnd(/** @type {Spring} */(ease).ease);\n    const xProp = /** @type {String} */(isObj(paramX) && !isUnd(/** @type {Object} */(paramX).mapTo) ? /** @type {Object} */(paramX).mapTo : 'translateX');\n    const yProp = /** @type {String} */(isObj(paramY) && !isUnd(/** @type {Object} */(paramY).mapTo) ? /** @type {Object} */(paramY).mapTo : 'translateY');\n    const container = parseDraggableFunctionParameter(parameters.container, this);\n    this.containerArray = isArr(container) ? container : null;\n    this.$container = /** @type {HTMLElement} */(container && !this.containerArray ? parseTargets(/** @type {DOMTarget} */(container))[0] : doc.body);\n    this.useWin = this.$container === doc.body;\n    /** @type {Window | HTMLElement} */\n    this.$scrollContainer = this.useWin ? win : this.$container;\n    this.$target = /** @type {HTMLElement} */(isObj(target) ? new DOMProxy(target) : parseTargets(target)[0]);\n    this.$trigger = /** @type {HTMLElement} */(parseTargets(trigger ? trigger : target)[0]);\n    this.fixed = getTargetValue(this.$target, 'position') === 'fixed';\n    // Refreshable parameters\n    this.isFinePointer = true;\n    /** @type {[Number, Number, Number, Number]} */\n    this.containerPadding = [0, 0, 0, 0];\n    /** @type {Number} */\n    this.containerFriction = 0;\n    /** @type {Number} */\n    this.releaseContainerFriction = 0;\n    /** @type {Number|Array<Number>} */\n    this.snapX = 0;\n    /** @type {Number|Array<Number>} */\n    this.snapY = 0;\n    /** @type {Number} */\n    this.scrollSpeed = 0;\n    /** @type {Number} */\n    this.scrollThreshold = 0;\n    /** @type {Number} */\n    this.dragSpeed = 0;\n    /** @type {Number} */\n    this.maxVelocity = 0;\n    /** @type {Number} */\n    this.minVelocity = 0;\n    /** @type {Number} */\n    this.velocityMultiplier = 0;\n    /** @type {Boolean|DraggableCursorParams} */\n    this.cursor = false;\n    /** @type {Spring} */\n    this.releaseXSpring = hasSpring ? /** @type {Spring} */(ease) : createSpring({\n      mass: setValue(parameters.releaseMass, 1),\n      stiffness: setValue(parameters.releaseStiffness, 80),\n      damping: setValue(parameters.releaseDamping, 20),\n    });\n    /** @type {Spring} */\n    this.releaseYSpring = hasSpring ? /** @type {Spring} */(ease) : createSpring({\n      mass: setValue(parameters.releaseMass, 1),\n      stiffness: setValue(parameters.releaseStiffness, 80),\n      damping: setValue(parameters.releaseDamping, 20),\n    });\n    /** @type {EasingFunction} */\n    this.releaseEase = customEase || eases.outQuint;\n    /** @type {Boolean} */\n    this.hasReleaseSpring = hasSpring;\n    /** @type {Callback<this>} */\n    this.onGrab = parameters.onGrab || noop;\n    /** @type {Callback<this>} */\n    this.onDrag = parameters.onDrag || noop;\n    /** @type {Callback<this>} */\n    this.onRelease = parameters.onRelease || noop;\n    /** @type {Callback<this>} */\n    this.onUpdate = parameters.onUpdate || noop;\n    /** @type {Callback<this>} */\n    this.onSettle = parameters.onSettle || noop;\n    /** @type {Callback<this>} */\n    this.onSnap = parameters.onSnap || noop;\n    /** @type {Callback<this>} */\n    this.onResize = parameters.onResize || noop;\n    /** @type {Callback<this>} */\n    this.onAfterResize = parameters.onAfterResize || noop;\n    /** @type {[Number, Number]} */\n    this.disabled = [0, 0];\n    /** @type {AnimatableParams} */\n    const animatableParams = {};\n    if (modifier) animatableParams.modifier = modifier;\n    if (isUnd(paramX) || paramX === true) {\n      animatableParams[xProp] = 0;\n    } else if (isObj(paramX)) {\n      const paramXObject = /** @type {DraggableAxisParam} */(paramX);\n      const animatableXParams = {};\n      if (paramXObject.modifier) animatableXParams.modifier = paramXObject.modifier;\n      if (paramXObject.composition) animatableXParams.composition = paramXObject.composition;\n      animatableParams[xProp] = animatableXParams;\n    } else if (paramX === false) {\n      animatableParams[xProp] = 0;\n      this.disabled[0] = 1;\n    }\n    if (isUnd(paramY) || paramY === true) {\n      animatableParams[yProp] = 0;\n    } else if (isObj(paramY)) {\n      const paramYObject = /** @type {DraggableAxisParam} */(paramY);\n      const animatableYParams = {};\n      if (paramYObject.modifier) animatableYParams.modifier = paramYObject.modifier;\n      if (paramYObject.composition) animatableYParams.composition = paramYObject.composition;\n      animatableParams[yProp] = animatableYParams;\n    } else if (paramY === false) {\n      animatableParams[yProp] = 0;\n      this.disabled[1] = 1;\n    }\n    /** @type {AnimatableObject} */\n    this.animate = /** @type {AnimatableObject} */(new Animatable(this.$target, animatableParams));\n    // Internal props\n    this.xProp = xProp;\n    this.yProp = yProp;\n    this.destX = 0;\n    this.destY = 0;\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.scroll = {x: 0, y: 0};\n    /** @type {[Number, Number, Number, Number]} */\n    this.coords = [this.x, this.y, 0, 0]; // x, y, temp x, temp y\n    /** @type {[Number, Number]} */\n    this.snapped = [0, 0]; // x, y\n    /** @type {[Number, Number, Number, Number, Number, Number, Number, Number]} */\n    this.pointer = [0, 0, 0, 0, 0, 0, 0, 0]; // x1, y1, x2, y2, temp x1, temp y1, temp x2, temp y2\n    /** @type {[Number, Number]} */\n    this.scrollView = [0, 0]; // w, h\n    /** @type {[Number, Number, Number, Number]} */\n    this.dragArea = [0, 0, 0, 0]; // x, y, w, h\n    /** @type {[Number, Number, Number, Number]} */\n    this.containerBounds = [-1e12, maxValue, maxValue, -1e12]; // t, r, b, l\n    /** @type {[Number, Number, Number, Number]} */\n    this.scrollBounds = [0, 0, 0, 0]; // t, r, b, l\n    /** @type {[Number, Number, Number, Number]} */\n    this.targetBounds = [0, 0, 0, 0]; // t, r, b, l\n    /** @type {[Number, Number]} */\n    this.window = [0, 0]; // w, h\n    /** @type {[Number, Number, Number]} */\n    this.velocityStack = [0, 0, 0];\n    /** @type {Number} */\n    this.velocityStackIndex = 0;\n    /** @type {Number} */\n    this.velocityTime = now();\n    /** @type {Number} */\n    this.velocity = 0;\n    /** @type {Number} */\n    this.angle = 0;\n    /** @type {JSAnimation} */\n    this.cursorStyles = null;\n    /** @type {JSAnimation} */\n    this.triggerStyles = null;\n    /** @type {JSAnimation} */\n    this.bodyStyles = null;\n    /** @type {JSAnimation} */\n    this.targetStyles = null;\n    /** @type {JSAnimation} */\n    this.touchActionStyles = null;\n    this.transforms = new Transforms(this.$target);\n    this.overshootCoords = { x: 0, y: 0 };\n    this.overshootXTicker = new Timer({ autoplay: false }, null, 0).init();\n    this.overshootYTicker = new Timer({ autoplay: false }, null, 0).init();\n    this.updateTicker = new Timer({ autoplay: false }, null, 0).init();\n    this.overshootXTicker.onUpdate = () => {\n      if (this.disabled[0]) return;\n      this.updated = true;\n      this.manual = true;\n      this.animate[this.xProp](this.overshootCoords.x, 0);\n    };\n    this.overshootXTicker.onComplete = () => {\n      if (this.disabled[0]) return;\n      this.manual = false;\n      this.animate[this.xProp](this.overshootCoords.x, 0);\n    };\n    this.overshootYTicker.onUpdate = () => {\n      if (this.disabled[1]) return;\n      this.updated = true;\n      this.manual = true;\n      this.animate[this.yProp](this.overshootCoords.y, 0);\n    };\n    this.overshootYTicker.onComplete = () => {\n      if (this.disabled[1]) return;\n      this.manual = false;\n      this.animate[this.yProp](this.overshootCoords.y, 0);\n    };\n    this.updateTicker.onUpdate = () => this.update();\n    this.contained = !isUnd(container);\n    this.manual = false;\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = false;\n    this.released = false;\n    this.canScroll = false;\n    this.enabled = false;\n    this.initialized = false;\n    this.activeProp = this.disabled[1] ? xProp : yProp;\n    this.animate.animations[this.activeProp].onRender = () => {\n      const hasUpdated = this.updated;\n      const hasMoved = this.grabbed && hasUpdated;\n      const hasReleased = !hasMoved && this.released;\n      const x = this.x;\n      const y = this.y;\n      const dx = x - this.coords[2];\n      const dy = y - this.coords[3];\n      this.deltaX = dx;\n      this.deltaY = dy;\n      this.coords[2] = x;\n      this.coords[3] = y;\n      if (hasUpdated) {\n        this.onUpdate(this);\n      }\n      if (!hasReleased) {\n        this.updated = false;\n      } else {\n        this.computeVelocity(dx, dy);\n        this.angle = atan2(dy, dx);\n      }\n    };\n    this.animate.animations[this.activeProp].onComplete = () => {\n      if ((!this.grabbed && this.released)) {\n        // Set eleased to false before calling onSettle to avoid recursion\n        this.released = false;\n      }\n      if (!this.manual) {\n        this.deltaX = 0;\n        this.deltaY = 0;\n        this.velocity = 0;\n        this.velocityStack[0] = 0;\n        this.velocityStack[1] = 0;\n        this.velocityStack[2] = 0;\n        this.velocityStackIndex = 0;\n        this.onSettle(this);\n      }\n    };\n    this.resizeTicker = new Timer({\n      autoplay: false,\n      duration: 150 * globals.timeScale,\n      onComplete: () => {\n        this.onResize(this);\n        this.refresh();\n        this.onAfterResize(this);\n      },\n    }).init();\n    this.parameters = parameters;\n    this.resizeObserver = new ResizeObserver(() => {\n      if (this.initialized) {\n        this.resizeTicker.restart();\n      } else {\n        this.initialized = true;\n      }\n    });\n    this.enable();\n    this.refresh();\n    this.resizeObserver.observe(this.$container);\n    if (!isObj(target)) this.resizeObserver.observe(this.$target);\n  }\n\n  /**\n   * @param  {Number} dx\n   * @param  {Number} dy\n   * @return {Number}\n   */\n  computeVelocity(dx, dy) {\n    const prevTime = this.velocityTime;\n    const curTime = now();\n    const elapsed = curTime - prevTime;\n    if (elapsed < 17) return this.velocity;\n    this.velocityTime = curTime;\n    const velocityStack = this.velocityStack;\n    const vMul = this.velocityMultiplier;\n    const minV = this.minVelocity;\n    const maxV = this.maxVelocity;\n    const vi = this.velocityStackIndex;\n    velocityStack[vi] = round(clamp((sqrt(dx * dx + dy * dy) / elapsed) * vMul, minV, maxV), 5);\n    const velocity = max(velocityStack[0], velocityStack[1], velocityStack[2]);\n    this.velocity = velocity;\n    this.velocityStackIndex = (vi + 1) % 3;\n    return velocity;\n  }\n\n  /**\n   * @param {Number}  x\n   * @param {Boolean} [muteUpdateCallback]\n   * @return {this}\n   */\n  setX(x, muteUpdateCallback = false) {\n    if (this.disabled[0]) return;\n    const v = round(x, 5);\n    this.overshootXTicker.pause();\n    this.manual = true;\n    this.updated = !muteUpdateCallback;\n    this.destX = v;\n    this.snapped[0] = snap(v, this.snapX);\n    this.animate[this.xProp](v, 0);\n    this.manual = false;\n    return this;\n  }\n\n  /**\n   * @param {Number}  y\n   * @param {Boolean} [muteUpdateCallback]\n   * @return {this}\n   */\n  setY(y, muteUpdateCallback = false) {\n    if (this.disabled[1]) return;\n    const v = round(y, 5);\n    this.overshootYTicker.pause();\n    this.manual = true;\n    this.updated = !muteUpdateCallback;\n    this.destY = v;\n    this.snapped[1] = snap(v, this.snapY);\n    this.animate[this.yProp](v, 0);\n    this.manual = false;\n    return this;\n  }\n\n  get x() {\n    return round(/** @type {Number} */(this.animate[this.xProp]()), globals.precision);\n  }\n\n  set x(x) {\n    this.setX(x, false);\n  }\n\n  get y() {\n    return round(/** @type {Number} */(this.animate[this.yProp]()), globals.precision);\n  }\n\n  set y(y) {\n    this.setY(y, false);\n  }\n\n  get progressX() {\n    return mapRange(this.x, this.containerBounds[3], this.containerBounds[1], 0, 1);\n  }\n\n  set progressX(x) {\n    this.setX(mapRange(x, 0, 1, this.containerBounds[3], this.containerBounds[1]), false);\n  }\n\n  get progressY() {\n    return mapRange(this.y, this.containerBounds[0], this.containerBounds[2], 0, 1);\n  }\n\n  set progressY(y) {\n    this.setY(mapRange(y, 0, 1, this.containerBounds[0], this.containerBounds[2]), false);\n  }\n\n  updateScrollCoords() {\n    const sx = round(this.useWin ? win.scrollX : this.$container.scrollLeft, 0);\n    const sy = round(this.useWin ? win.scrollY : this.$container.scrollTop, 0);\n    const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n    const threshold = this.scrollThreshold;\n    this.scroll.x = sx;\n    this.scroll.y = sy;\n    this.scrollBounds[0] = sy - this.targetBounds[0] + cpt - threshold;\n    this.scrollBounds[1] = sx - this.targetBounds[1] - cpr + threshold;\n    this.scrollBounds[2] = sy - this.targetBounds[2] - cpb + threshold;\n    this.scrollBounds[3] = sx - this.targetBounds[3] + cpl - threshold;\n  }\n\n  updateBoundingValues() {\n    const $container = this.$container;\n    const cx = this.x;\n    const cy = this.y;\n    const cx2 = this.coords[2];\n    const cy2 =  this.coords[3];\n    // Prevents interfering with the scroll area in cases the target is outside of the container\n    // Make sure the temp coords are also adjuset to prevents wrong delta calculation on updates\n    this.coords[2] = 0;\n    this.coords[3] = 0;\n    this.setX(0, true);\n    this.setY(0, true);\n    this.transforms.remove();\n    const iw = this.window[0] = win.innerWidth;\n    const ih = this.window[1] = win.innerHeight;\n    const uw = this.useWin;\n    const sw = $container.scrollWidth;\n    const sh = $container.scrollHeight;\n    const fx = this.fixed;\n    const transformContainerRect = $container.getBoundingClientRect();\n    const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n    this.dragArea[0] = uw ? 0 : transformContainerRect.left;\n    this.dragArea[1] = uw ? 0 : transformContainerRect.top;\n    this.scrollView[0] = uw ? clamp(sw, iw, sw) : sw;\n    this.scrollView[1] = uw ? clamp(sh, ih, sh) : sh;\n    this.updateScrollCoords();\n    const { width, height, left, top, right, bottom } = $container.getBoundingClientRect();\n    this.dragArea[2] = round(uw ? clamp(width, iw, iw) : width, 0);\n    this.dragArea[3] = round(uw ? clamp(height, ih, ih) : height, 0);\n    const containerOverflow = getTargetValue($container, 'overflow');\n    const visibleOverflow = containerOverflow === 'visible';\n    const hiddenOverflow = containerOverflow === 'hidden';\n    this.canScroll = fx ? false :\n      this.contained &&\n      (($container === doc.body && visibleOverflow) || (!hiddenOverflow && !visibleOverflow)) &&\n      (sw > this.dragArea[2] + cpl - cpr || sh > this.dragArea[3] + cpt - cpb) &&\n      (!this.containerArray || (this.containerArray && !isArr(this.containerArray)));\n    if (this.contained) {\n      const sx = this.scroll.x;\n      const sy = this.scroll.y;\n      const canScroll = this.canScroll;\n      const targetRect = this.$target.getBoundingClientRect();\n      const hiddenLeft = canScroll ? uw ? 0 : $container.scrollLeft : 0;\n      const hiddenTop = canScroll ? uw ? 0 : $container.scrollTop : 0;\n      const hiddenRight = canScroll ? this.scrollView[0] - hiddenLeft - width : 0;\n      const hiddenBottom = canScroll ? this.scrollView[1] - hiddenTop - height : 0;\n      this.targetBounds[0] = round((targetRect.top + sy) - (uw ? 0 : top), 0);\n      this.targetBounds[1] = round((targetRect.right + sx) - (uw ? iw : right), 0);\n      this.targetBounds[2] = round((targetRect.bottom + sy) - (uw ? ih : bottom), 0);\n      this.targetBounds[3] = round((targetRect.left + sx) - (uw ? 0 : left), 0);\n      if (this.containerArray) {\n        this.containerBounds[0] = this.containerArray[0] + cpt;\n        this.containerBounds[1] = this.containerArray[1] - cpr;\n        this.containerBounds[2] = this.containerArray[2] - cpb;\n        this.containerBounds[3] = this.containerArray[3] + cpl;\n      } else {\n        this.containerBounds[0] = -round(targetRect.top - (fx ? clamp(top, 0, ih) : top) + hiddenTop - cpt, 0);\n        this.containerBounds[1] = -round(targetRect.right - (fx ? clamp(right, 0, iw) : right) - hiddenRight + cpr, 0);\n        this.containerBounds[2] = -round(targetRect.bottom - (fx ? clamp(bottom, 0, ih) : bottom) - hiddenBottom + cpb, 0);\n        this.containerBounds[3] = -round(targetRect.left - (fx ? clamp(left, 0, iw) : left) + hiddenLeft - cpl, 0);\n      }\n    }\n    this.transforms.revert();\n    // Restore coordinates\n    this.coords[2] = cx2;\n    this.coords[3] = cy2;\n    this.setX(cx, true);\n    this.setY(cy, true);\n  }\n\n  /**\n   * Returns 0 if not OB, 1 if x is OB, 2 if y is OB, 3 if both x and y are OB\n   *\n   * @param  {Array} bounds\n   * @param  {Number} x\n   * @param  {Number} y\n   * @return {Number}\n   */\n  isOutOfBounds(bounds, x, y) {\n    if (!this.contained) return 0;\n    const [ bt, br, bb, bl ] = bounds;\n    const [ dx, dy ] = this.disabled;\n    const obx = !dx && x < bl || !dx && x > br;\n    const oby = !dy && y < bt || !dy && y > bb;\n    return obx && !oby ? 1 : !obx && oby ? 2 : obx && oby ? 3 : 0;\n  }\n\n  refresh() {\n    const params = this.parameters;\n    const paramX = params.x;\n    const paramY = params.y;\n    const container = parseDraggableFunctionParameter(params.container, this);\n    const cp = parseDraggableFunctionParameter(params.containerPadding, this) || 0;\n    const containerPadding = /** @type {[Number, Number, Number, Number]} */(isArr(cp) ? cp : [cp, cp, cp, cp]);\n    const cx = this.x;\n    const cy = this.y;\n    const parsedCursorStyles = parseDraggableFunctionParameter(params.cursor, this);\n    const cursorStyles = { onHover: 'grab', onGrab: 'grabbing' };\n    if (parsedCursorStyles) {\n      const { onHover, onGrab } = /** @type {DraggableCursorParams} */(parsedCursorStyles);\n      if (onHover) cursorStyles.onHover = onHover;\n      if (onGrab) cursorStyles.onGrab = onGrab;\n    }\n    this.containerArray = isArr(container) ? container : null;\n    this.$container = /** @type {HTMLElement} */(container && !this.containerArray ? parseTargets(/** @type {DOMTarget} */(container))[0] : doc.body);\n    this.useWin = this.$container === doc.body;\n    /** @type {Window | HTMLElement} */\n    this.$scrollContainer = this.useWin ? win : this.$container;\n    this.isFinePointer = matchMedia('(pointer:fine)').matches;\n    this.containerPadding = setValue(containerPadding, [0, 0, 0, 0]);\n    this.containerFriction = clamp(setValue(parseDraggableFunctionParameter(params.containerFriction, this), .8), 0, 1);\n    this.releaseContainerFriction = clamp(setValue(parseDraggableFunctionParameter(params.releaseContainerFriction, this), this.containerFriction), 0, 1);\n    this.snapX = parseDraggableFunctionParameter(isObj(paramX) && !isUnd(paramX.snap) ? paramX.snap : params.snap, this);\n    this.snapY = parseDraggableFunctionParameter(isObj(paramY) && !isUnd(paramY.snap) ? paramY.snap : params.snap, this);\n    this.scrollSpeed = setValue(parseDraggableFunctionParameter(params.scrollSpeed, this), 1.5);\n    this.scrollThreshold = setValue(parseDraggableFunctionParameter(params.scrollThreshold, this), 20);\n    this.dragSpeed = setValue(parseDraggableFunctionParameter(params.dragSpeed, this), 1);\n    this.minVelocity = setValue(parseDraggableFunctionParameter(params.minVelocity, this), 0);\n    this.maxVelocity = setValue(parseDraggableFunctionParameter(params.maxVelocity, this), 50);\n    this.velocityMultiplier = setValue(parseDraggableFunctionParameter(params.velocityMultiplier, this), 1);\n    this.cursor = parsedCursorStyles === false ? false : cursorStyles;\n    this.updateBoundingValues();\n\n    // const ob = this.isOutOfBounds(this.containerBounds, this.x, this.y);\n    // if (ob === 1 || ob === 3) this.progressX = px;\n    // if (ob === 2 || ob === 3) this.progressY = py;\n\n    // if (this.initialized && this.contained) {\n    //   if (this.progressX !== px) this.progressX = px;\n    //   if (this.progressY !== py) this.progressY = py;\n    // }\n\n    const [ bt, br, bb, bl ] = this.containerBounds;\n    this.setX(clamp(cx, bl, br), true);\n    this.setY(clamp(cy, bt, bb), true);\n  }\n\n  update() {\n    this.updateScrollCoords();\n    if (this.canScroll) {\n      const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n      const [ sw, sh ] = this.scrollView;\n      const daw = this.dragArea[2];\n      const dah = this.dragArea[3];\n      const csx = this.scroll.x;\n      const csy = this.scroll.y;\n      const nsw = this.$container.scrollWidth;\n      const nsh = this.$container.scrollHeight;\n      const csw = this.useWin ? clamp(nsw, this.window[0], nsw) : nsw;\n      const csh = this.useWin ? clamp(nsh, this.window[1], nsh) : nsh;\n      const swd = sw - csw;\n      const shd = sh - csh;\n      // Handle cases where the scrollarea dimensions changes during drag\n      if (this.dragged && swd > 0) {\n        this.coords[0] -= swd;\n        this.scrollView[0] = csw;\n      }\n      if (this.dragged && shd > 0) {\n        this.coords[1] -= shd;\n        this.scrollView[1] = csh;\n      }\n      // Handle autoscroll when target is at the edges of the scroll bounds\n      const s = this.scrollSpeed * 10;\n      const threshold = this.scrollThreshold;\n      const [ x, y ] = this.coords;\n      const [ st, sr, sb, sl ] = this.scrollBounds;\n      const t = round(clamp((y - st + cpt) / threshold, -1, 0) * s, 0);\n      const r = round(clamp((x - sr - cpr) / threshold, 0, 1) * s, 0);\n      const b = round(clamp((y - sb - cpb) / threshold, 0, 1) * s, 0);\n      const l = round(clamp((x - sl + cpl) / threshold, -1, 0) * s, 0);\n      if (t || b || l || r) {\n        const [nx, ny] = this.disabled;\n        let scrollX = csx;\n        let scrollY = csy;\n        if (!nx) {\n          scrollX = round(clamp(csx + (l || r), 0, sw - daw), 0);\n          this.coords[0] -= csx - scrollX;\n        }\n        if (!ny) {\n          scrollY = round(clamp(csy + (t || b), 0, sh - dah), 0);\n          this.coords[1] -= csy - scrollY;\n        }\n        // Note: Safari mobile requires to use different scroll methods depending if using the window or not\n        if (this.useWin) {\n          this.$scrollContainer.scrollBy(-(csx - scrollX), -(csy - scrollY));\n        } else {\n          this.$scrollContainer.scrollTo(scrollX, scrollY);\n        }\n      }\n    }\n    const [ ct, cr, cb, cl ] = this.containerBounds;\n    const [ px1, py1, px2, py2, px3, py3 ] = this.pointer;\n    this.coords[0] += (px1 - px3) * this.dragSpeed;\n    this.coords[1] += (py1 - py3) * this.dragSpeed;\n    this.pointer[4] = px1;\n    this.pointer[5] = py1;\n    const [ cx, cy ] = this.coords;\n    const [ sx, sy ] = this.snapped;\n    const cf = (1 - this.containerFriction) * this.dragSpeed;\n    this.setX(cx > cr ? cr + (cx - cr) * cf : cx < cl ? cl + (cx - cl) * cf : cx, false);\n    this.setY(cy > cb ? cb + (cy - cb) * cf : cy < ct ? ct + (cy - ct) * cf : cy, false);\n    this.computeVelocity(px1 - px3, py1 - py3);\n    this.angle = atan2(py1 - py2, px1 - px2);\n    const [ nsx, nsy ] = this.snapped;\n    if (nsx !== sx && this.snapX || nsy !== sy && this.snapY) {\n      this.onSnap(this);\n    }\n  }\n\n  stop() {\n    this.updateTicker.pause();\n    this.overshootXTicker.pause();\n    this.overshootYTicker.pause();\n    // Pauses the in bounds onRelease animations\n    for (let prop in this.animate.animations) this.animate.animations[prop].pause();\n    remove(this, null, 'x');\n    remove(this, null, 'y');\n    remove(this, null, 'progressX');\n    remove(this, null, 'progressY');\n    remove(this.scroll); // Removes any active animations on the container scroll\n    remove(this.overshootCoords); // Removes active overshoot animations\n    return this;\n  }\n\n  /**\n   * @param {Number} [duration]\n   * @param {Number} [gap]\n   * @param {EasingParam} [ease]\n   * @return {this}\n   */\n  scrollInView(duration, gap = 0, ease = eases.inOutQuad) {\n    this.updateScrollCoords();\n    const x = this.destX;\n    const y = this.destY;\n    const scroll = this.scroll;\n    const scrollBounds = this.scrollBounds;\n    const canScroll = this.canScroll;\n    if (!this.containerArray && this.isOutOfBounds(scrollBounds, x, y)) {\n      const [ st, sr, sb, sl ] = scrollBounds;\n      const t = round(clamp(y - st, -1e12, 0), 0);\n      const r = round(clamp(x - sr, 0, maxValue), 0);\n      const b = round(clamp(y - sb, 0, maxValue), 0);\n      const l = round(clamp(x - sl, -1e12, 0), 0);\n      new JSAnimation(scroll, {\n        x: round(scroll.x + (l ? l - gap : r ? r + gap : 0), 0),\n        y: round(scroll.y + (t ? t - gap : b ? b + gap : 0), 0),\n        duration: isUnd(duration) ? 350 * globals.timeScale : duration,\n        ease,\n        onUpdate: () => {\n          this.canScroll = false;\n          this.$scrollContainer.scrollTo(scroll.x, scroll.y);\n        }\n      }).init().then(() => {\n        this.canScroll = canScroll;\n      });\n    }\n    return this;\n  }\n\n  handleHover() {\n    if (this.isFinePointer && this.cursor && !this.cursorStyles) {\n      this.cursorStyles = setTargetValues(this.$trigger, {\n        cursor: /** @type {DraggableCursorParams} */(this.cursor).onHover\n      });\n    }\n  }\n\n  /**\n   * @param  {Number} [duration]\n   * @param  {Number} [gap]\n   * @param  {EasingParam} [ease]\n   * @return {this}\n   */\n  animateInView(duration, gap = 0, ease = eases.inOutQuad) {\n    this.stop();\n    this.updateBoundingValues();\n    const x = this.x;\n    const y = this.y;\n    const [ cpt, cpr, cpb, cpl ] = this.containerPadding;\n    const bt = this.scroll.y - this.targetBounds[0] + cpt + gap;\n    const br = this.scroll.x - this.targetBounds[1] - cpr - gap;\n    const bb = this.scroll.y - this.targetBounds[2] - cpb - gap;\n    const bl = this.scroll.x - this.targetBounds[3] + cpl + gap;\n    const ob = this.isOutOfBounds([bt, br, bb, bl], x, y);\n    if (ob) {\n      const [ disabledX, disabledY ] = this.disabled;\n      const destX = clamp(snap(x, this.snapX), bl, br);\n      const destY = clamp(snap(y, this.snapY), bt, bb);\n      const dur = isUnd(duration) ? 350 * globals.timeScale : duration;\n      if (!disabledX && (ob === 1 || ob === 3)) this.animate[this.xProp](destX, dur, ease);\n      if (!disabledY && (ob === 2 || ob === 3)) this.animate[this.yProp](destY, dur, ease);\n    }\n    return this;\n  }\n\n  /**\n   * @param {MouseEvent|TouchEvent} e\n   */\n  handleDown(e) {\n    const $eTarget = /** @type {HTMLElement} */(e.target);\n    if (this.grabbed || /** @type {HTMLInputElement}  */($eTarget).type === 'range') return;\n\n    e.stopPropagation();\n\n    this.grabbed = true;\n    this.released = false;\n    this.stop();\n    this.updateBoundingValues();\n    const touches = /** @type {TouchEvent} */(e).changedTouches;\n    const eventX = touches ? touches[0].clientX : /** @type {MouseEvent} */(e).clientX;\n    const eventY = touches ? touches[0].clientY : /** @type {MouseEvent} */(e).clientY;\n    const { x, y } = this.transforms.normalizePoint(eventX, eventY);\n    const [ ct, cr, cb, cl ] = this.containerBounds;\n    const cf = (1 - this.containerFriction) * this.dragSpeed;\n    const cx = this.x;\n    const cy = this.y;\n    this.coords[0] = this.coords[2] = !cf ? cx : cx > cr ? cr + (cx - cr) / cf : cx < cl ? cl + (cx - cl) / cf : cx;\n    this.coords[1] = this.coords[3] = !cf ? cy : cy > cb ? cb + (cy - cb) / cf : cy < ct ? ct + (cy - ct) / cf : cy;\n    this.pointer[0] = x;\n    this.pointer[1] = y;\n    this.pointer[2] = x;\n    this.pointer[3] = y;\n    this.pointer[4] = x;\n    this.pointer[5] = y;\n    this.pointer[6] = x;\n    this.pointer[7] = y;\n    this.deltaX = 0;\n    this.deltaY = 0;\n    this.velocity = 0;\n    this.velocityStack[0] = 0;\n    this.velocityStack[1] = 0;\n    this.velocityStack[2] = 0;\n    this.velocityStackIndex = 0;\n    this.angle = 0;\n    if (this.targetStyles) {\n      this.targetStyles.revert();\n      this.targetStyles = null;\n    }\n    const z = /** @type {Number} */(getTargetValue(this.$target, 'zIndex', false));\n    zIndex = (z > zIndex ? z : zIndex) + 1;\n    this.targetStyles = setTargetValues(this.$target, { zIndex });\n    if (this.triggerStyles) {\n      this.triggerStyles.revert();\n      this.triggerStyles = null;\n    }\n    if (this.cursorStyles) {\n      this.cursorStyles.revert();\n      this.cursorStyles = null;\n    }\n    if (this.isFinePointer && this.cursor) {\n      this.bodyStyles = setTargetValues(doc.body, {\n        cursor: /** @type {DraggableCursorParams} */(this.cursor).onGrab\n      });\n    }\n    this.scrollInView(100, 0, eases.out(3));\n    this.onGrab(this);\n\n    doc.addEventListener('touchmove', this);\n    doc.addEventListener('touchend', this);\n    doc.addEventListener('touchcancel', this);\n    doc.addEventListener('mousemove', this);\n    doc.addEventListener('mouseup', this);\n    doc.addEventListener('selectstart', this);\n  }\n\n  /**\n   * @param {MouseEvent|TouchEvent} e\n   */\n  handleMove(e) {\n    if (!this.grabbed) return;\n    const touches = /** @type {TouchEvent} */(e).changedTouches;\n    const eventX = touches ? touches[0].clientX : /** @type {MouseEvent} */(e).clientX;\n    const eventY = touches ? touches[0].clientY : /** @type {MouseEvent} */(e).clientY;\n    const { x, y } = this.transforms.normalizePoint(eventX, eventY);\n    const movedX = x - this.pointer[6];\n    const movedY = y - this.pointer[7];\n\n    let $parent = /** @type {HTMLElement} */(e.target);\n    let isAtTop = false;\n    let isAtBottom = false;\n    let canTouchScroll = false;\n\n    while (touches && $parent && $parent !== this.$trigger) {\n      const overflowY = getTargetValue($parent, 'overflow-y');\n      if (overflowY !== 'hidden' && overflowY !== 'visible') {\n        const { scrollTop, scrollHeight, clientHeight } = $parent;\n        if (scrollHeight > clientHeight) {\n          canTouchScroll = true;\n          isAtTop = scrollTop <= 3;\n          isAtBottom = scrollTop >= (scrollHeight - clientHeight) - 3;\n          break;\n        }\n      }\n      $parent = /** @type {HTMLElement} */($parent.parentNode);\n    }\n\n    if (canTouchScroll && ((!isAtTop && !isAtBottom) || (isAtTop && movedY < 0) || (isAtBottom && movedY > 0))) {\n\n      this.pointer[0] = x;\n      this.pointer[1] = y;\n      this.pointer[2] = x;\n      this.pointer[3] = y;\n      this.pointer[4] = x;\n      this.pointer[5] = y;\n      this.pointer[6] = x;\n      this.pointer[7] = y;\n\n    } else {\n\n      preventDefault(e);\n\n      // Needed to prevents click on handleUp\n      if (!this.triggerStyles) this.triggerStyles = setTargetValues(this.$trigger, { pointerEvents: 'none' });\n      // Needed to prevent page scroll while dragging on touch devvice\n      this.$trigger.addEventListener('touchstart', preventDefault, { passive: false });\n      this.$trigger.addEventListener('touchmove', preventDefault, { passive: false });\n      this.$trigger.addEventListener('touchend', preventDefault);\n\n\n      if ((!this.disabled[0] && abs(movedX) > 3) || (!this.disabled[1] && abs(movedY) > 3)) {\n\n        this.updateTicker.resume();\n        this.pointer[2] = this.pointer[0];\n        this.pointer[3] = this.pointer[1];\n        this.pointer[0] = x;\n        this.pointer[1] = y;\n        this.dragged = true;\n        this.released = false;\n        this.onDrag(this);\n      }\n    }\n  }\n\n  handleUp() {\n\n    if (!this.grabbed) return;\n\n    this.updateTicker.pause();\n\n    if (this.triggerStyles) {\n      this.triggerStyles.revert();\n      this.triggerStyles = null;\n    }\n\n    if (this.bodyStyles) {\n      this.bodyStyles.revert();\n      this.bodyStyles = null;\n    }\n\n    const [ disabledX, disabledY ] = this.disabled;\n    const [ px1, py1, px2, py2, px3, py3 ] = this.pointer;\n    const [ ct, cr, cb, cl ] = this.containerBounds;\n    const [ sx, sy ] = this.snapped;\n    const springX = this.releaseXSpring;\n    const springY = this.releaseYSpring;\n    const releaseEase = this.releaseEase;\n    const hasReleaseSpring = this.hasReleaseSpring;\n    const overshootCoords = this.overshootCoords;\n    const cx = this.x;\n    const cy = this.y;\n    const pv = this.computeVelocity(px1 - px3, py1 - py3);\n    const pa = this.angle = atan2(py1 - py2, px1 - px2);\n    const ds = pv * 150;\n    const cf = (1 - this.releaseContainerFriction) * this.dragSpeed;\n    const nx = cx + (cos(pa) * ds);\n    const ny = cy + (sin(pa) * ds);\n    const bx = nx > cr ? cr + (nx - cr) * cf : nx < cl ? cl + (nx - cl) * cf : nx;\n    const by = ny > cb ? cb + (ny - cb) * cf : ny < ct ? ct + (ny - ct) * cf : ny;\n    const dx = this.destX = clamp(round(snap(bx, this.snapX), 5), cl, cr);\n    const dy = this.destY = clamp(round(snap(by, this.snapY), 5), ct, cb);\n    const ob = this.isOutOfBounds(this.containerBounds, nx, ny);\n\n    let durationX = 0;\n    let durationY = 0;\n    let easeX = releaseEase;\n    let easeY = releaseEase;\n    let longestReleaseDuration = 0;\n\n    overshootCoords.x = cx;\n    overshootCoords.y = cy;\n\n    if (!disabledX) {\n      const directionX = dx === cr ? cx > cr ? -1 : 1 : cx < cl ? -1 : 1;\n      const distanceX = round(cx - dx, 0);\n      springX.velocity = disabledY && hasReleaseSpring ? distanceX ? (ds * directionX) / abs(distanceX) : 0 : pv;\n      const { ease, duration, restDuration } = springX;\n      durationX = cx === dx ? 0 : hasReleaseSpring ? duration : duration - (restDuration * globals.timeScale);\n      if (hasReleaseSpring) easeX = ease;\n      if (durationX > longestReleaseDuration) longestReleaseDuration = durationX;\n    }\n\n    if (!disabledY) {\n      const directionY = dy === cb ? cy > cb ? -1 : 1 : cy < ct ? -1 : 1;\n      const distanceY = round(cy - dy, 0);\n      springY.velocity = disabledX && hasReleaseSpring ? distanceY ? (ds * directionY) / abs(distanceY) : 0 : pv;\n      const { ease, duration, restDuration } = springY;\n      durationY = cy === dy ? 0 : hasReleaseSpring ? duration : duration - (restDuration * globals.timeScale);\n      if (hasReleaseSpring) easeY = ease;\n      if (durationY > longestReleaseDuration) longestReleaseDuration = durationY;\n    }\n\n    if (!hasReleaseSpring && ob && cf && (durationX || durationY)) {\n\n        const composition = compositionTypes.blend;\n\n        new JSAnimation(overshootCoords, {\n          x: { to: bx, duration: durationX * .65 },\n          y: { to: by, duration: durationY * .65 },\n          ease: releaseEase,\n          composition,\n        }).init();\n\n        new JSAnimation(overshootCoords, {\n          x: { to: dx, duration: durationX },\n          y: { to: dy, duration: durationY },\n          ease: releaseEase,\n          composition,\n        }).init();\n\n        this.overshootXTicker.stretch(durationX).restart();\n        this.overshootYTicker.stretch(durationY).restart();\n\n    } else {\n\n      if (!disabledX) this.animate[this.xProp](dx, durationX, easeX);\n      if (!disabledY) this.animate[this.yProp](dy, durationY, easeY);\n\n    }\n\n    this.scrollInView(longestReleaseDuration, this.scrollThreshold, releaseEase);\n\n    let hasSnapped = false;\n\n    if (dx !== sx) {\n      this.snapped[0] = dx;\n      if (this.snapX) hasSnapped = true;\n    }\n\n    if (dy !== sy && this.snapY) {\n      this.snapped[1] = dy;\n      if (this.snapY) hasSnapped = true;\n    }\n\n    if (hasSnapped) this.onSnap(this);\n\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = true;\n    this.released = true;\n\n    // It's important to trigger the callback after the release animations to be able to cancel them\n    this.onRelease(this);\n\n    this.$trigger.removeEventListener('touchstart', preventDefault);\n    this.$trigger.removeEventListener('touchmove', preventDefault);\n    this.$trigger.removeEventListener('touchend', preventDefault);\n\n    doc.removeEventListener('touchmove', this);\n    doc.removeEventListener('touchend', this);\n    doc.removeEventListener('touchcancel', this);\n    doc.removeEventListener('mousemove', this);\n    doc.removeEventListener('mouseup', this);\n    doc.removeEventListener('selectstart', this);\n  }\n\n  reset() {\n    this.stop();\n    this.resizeTicker.pause();\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = false;\n    this.released = false;\n    this.canScroll = false;\n    this.setX(0, true);\n    this.setY(0, true);\n    this.coords[0] = 0;\n    this.coords[1] = 0;\n    this.pointer[0] = 0;\n    this.pointer[1] = 0;\n    this.pointer[2] = 0;\n    this.pointer[3] = 0;\n    this.pointer[4] = 0;\n    this.pointer[5] = 0;\n    this.pointer[6] = 0;\n    this.pointer[7] = 0;\n    this.velocity = 0;\n    this.velocityStack[0] = 0;\n    this.velocityStack[1] = 0;\n    this.velocityStack[2] = 0;\n    this.velocityStackIndex = 0;\n    this.angle = 0;\n    return this;\n  }\n\n  enable() {\n    if (!this.enabled) {\n      this.enabled = true;\n      this.$target.classList.remove('is-disabled');\n      this.touchActionStyles = setTargetValues(this.$trigger, {\n        touchAction: this.disabled[0] ? 'pan-x' : this.disabled[1] ? 'pan-y' : 'none'\n      });\n      this.$trigger.addEventListener('touchstart', this, { passive: true });\n      this.$trigger.addEventListener('mousedown', this, { passive: true });\n      this.$trigger.addEventListener('mouseenter', this);\n    }\n    return this;\n  }\n\n  disable() {\n    this.enabled = false;\n    this.grabbed = false;\n    this.dragged = false;\n    this.updated = false;\n    this.released = false;\n    this.canScroll = false;\n    this.touchActionStyles.revert();\n    if (this.cursorStyles) {\n      this.cursorStyles.revert();\n      this.cursorStyles = null;\n    }\n    if (this.triggerStyles) {\n      this.triggerStyles.revert();\n      this.triggerStyles = null;\n    }\n    if (this.bodyStyles) {\n      this.bodyStyles.revert();\n      this.bodyStyles = null;\n    }\n    if (this.targetStyles) {\n      this.targetStyles.revert();\n      this.targetStyles = null;\n    }\n    this.stop();\n    this.$target.classList.add('is-disabled');\n    this.$trigger.removeEventListener('touchstart', this);\n    this.$trigger.removeEventListener('mousedown', this);\n    this.$trigger.removeEventListener('mouseenter', this);\n    doc.removeEventListener('touchmove', this);\n    doc.removeEventListener('touchend', this);\n    doc.removeEventListener('touchcancel', this);\n    doc.removeEventListener('mousemove', this);\n    doc.removeEventListener('mouseup', this);\n    doc.removeEventListener('selectstart', this);\n    return this;\n  }\n\n  revert() {\n    this.reset();\n    this.disable();\n    this.$target.classList.remove('is-disabled');\n    this.updateTicker.revert();\n    this.overshootXTicker.revert();\n    this.overshootYTicker.revert();\n    this.resizeTicker.revert();\n    this.animate.revert();\n    return this;\n  }\n\n  /**\n   * @param {Event} e\n   */\n  handleEvent(e) {\n    switch (e.type) {\n      case 'mousedown':\n        this.handleDown(/** @type {MouseEvent} */(e));\n        break;\n      case 'touchstart':\n        this.handleDown(/** @type {TouchEvent} */(e));\n        break;\n      case 'mousemove':\n        this.handleMove(/** @type {MouseEvent} */(e));\n        break;\n      case 'touchmove':\n        this.handleMove(/** @type {TouchEvent} */(e));\n        break;\n      case 'mouseup':\n        this.handleUp();\n        break;\n      case 'touchend':\n        this.handleUp();\n        break;\n      case 'touchcancel':\n        this.handleUp();\n        break;\n      case 'mouseenter':\n        this.handleHover();\n        break;\n      case 'selectstart':\n        preventDefault(e);\n        break;\n    }\n  }\n}\n\n/**\n * @param {TargetsParam} target\n * @param {DraggableParams} [parameters]\n * @return {Draggable}\n */\nconst createDraggable = (target, parameters) => new Draggable(target, parameters);\n\n\n\n\n/**\n * @typedef {Object} ReactRef\n * @property {HTMLElement|SVGElement|null} [current]\n */\n\n/**\n * @typedef {Object} AngularRef\n * @property {HTMLElement|SVGElement} [nativeElement]\n */\n\n/**\n * @typedef {Object} ScopeParams\n * @property {DOMTargetSelector|ReactRef|AngularRef} [root]\n * @property {DefaultsParams} [defaults]\n * @property {Record<String, String>} [mediaQueries]\n */\n\n/**\n * @callback ScopeCleanup\n * @param {Scope} [scope]\n */\n\n/**\n * @callback ScopeConstructor\n * @param {Scope} [scope]\n * @return {ScopeCleanup|void}\n */\n\n/**\n * @callback ScopeMethod\n * @param {...*} args\n * @return {ScopeCleanup|void}\n */\n\nclass Scope {\n  /** @param {ScopeParams} [parameters] */\n  constructor(parameters = {}) {\n    if (globals.scope) globals.scope.revertibles.push(this);\n    const rootParam = parameters.root;\n    /** @type {Document|DOMTarget} */\n    let root = doc;\n    if (rootParam) {\n      root = /** @type {ReactRef} */(rootParam).current ||\n             /** @type {AngularRef} */(rootParam).nativeElement ||\n             parseTargets(/** @type {DOMTargetSelector} */(rootParam))[0] ||\n             doc;\n    }\n    const scopeDefaults = parameters.defaults;\n    const globalDefault = globals.defaults;\n    const mediaQueries = parameters.mediaQueries;\n    /** @type {DefaultsParams} */\n    this.defaults = scopeDefaults ? mergeObjects(scopeDefaults, globalDefault) : globalDefault;\n    /** @type {Document|DOMTarget} */\n    this.root = root;\n    /** @type {Array<ScopeConstructor>} */\n    this.constructors = [];\n    /** @type {Array<Function>} */\n    this.revertConstructors = [];\n    /** @type {Array<Revertible>} */\n    this.revertibles = [];\n    /** @type {Record<String, Function>} */\n    this.methods = {};\n    /** @type {Record<String, Boolean>} */\n    this.matches = {};\n    /** @type {Record<String, MediaQueryList>} */\n    this.mediaQueryLists = {};\n    /** @type {Record<String, any>} */\n    this.data = {};\n    if (mediaQueries) {\n      for (let mq in mediaQueries) {\n        const _mq = win.matchMedia(mediaQueries[mq]);\n        this.mediaQueryLists[mq] = _mq;\n        _mq.addEventListener('change', this);\n      }\n    }\n  }\n\n  /**\n   * @callback ScoppedCallback\n   * @param {this} scope\n   * @return {any}\n   *\n   * @param {ScoppedCallback} cb\n   * @return {this}\n   */\n  execute(cb) {\n    let activeScope = globals.scope;\n    let activeRoot = globals.root;\n    let activeDefaults = globals.defaults;\n    globals.scope = this;\n    globals.root = this.root;\n    globals.defaults = this.defaults;\n    const mqs = this.mediaQueryLists;\n    for (let mq in mqs) this.matches[mq] = mqs[mq].matches;\n    const returned = cb(this);\n    globals.scope = activeScope;\n    globals.root = activeRoot;\n    globals.defaults = activeDefaults;\n    return returned;\n  }\n\n  /**\n   * @return {this}\n   */\n  refresh() {\n    this.execute(() => {\n      let i = this.revertibles.length;\n      let y = this.revertConstructors.length;\n      while (i--) this.revertibles[i].revert();\n      while (y--) this.revertConstructors[y](this);\n      this.revertibles.length = 0;\n      this.revertConstructors.length = 0;\n      this.constructors.forEach( constructor => {\n        const revertConstructor = constructor(this);\n        if (revertConstructor) {\n          this.revertConstructors.push(revertConstructor);\n        }\n      });\n    });\n    return this;\n  }\n\n  /**\n   * @callback contructorCallback\n   * @param {this} self\n   *\n   * @overload\n   * @param {String} a1\n   * @param {ScopeMethod} a2\n   * @return {this}\n   *\n   * @overload\n   * @param {contructorCallback} a1\n   * @return {this}\n   *\n   * @param {String|contructorCallback} a1\n   * @param {ScopeMethod} [a2]\n   */\n  add(a1, a2) {\n    if (isFnc(a1)) {\n      const constructor = /** @type {contructorCallback} */(a1);\n      this.constructors.push(constructor);\n      this.execute(() => {\n        const revertConstructor = constructor(this);\n        if (revertConstructor) {\n          this.revertConstructors.push(revertConstructor);\n        }\n      });\n    } else {\n      this.methods[/** @type {String} */(a1)] = (/** @type {any} */...args) => this.execute(() => a2(...args));\n    }\n    return this;\n  }\n\n  /**\n   * @param {Event} e\n   */\n  handleEvent(e) {\n    switch (e.type) {\n      case 'change':\n        this.refresh();\n        break;\n    }\n  }\n\n  revert() {\n    const revertibles = this.revertibles;\n    const revertConstructors = this.revertConstructors;\n    const mqs = this.mediaQueryLists;\n    let i = revertibles.length;\n    let y = revertConstructors.length;\n    while (i--) revertibles[i].revert();\n    while (y--) revertConstructors[y](this);\n    for (let mq in mqs) mqs[mq].removeEventListener('change', this);\n    revertibles.length = 0;\n    revertConstructors.length = 0;\n    this.constructors.length = 0;\n    this.matches = {};\n    this.methods = {};\n    this.mediaQueryLists = {};\n    this.data = {};\n  }\n}\n\n/**\n * @param {ScopeParams} [params]\n * @return {Scope}\n */\nconst createScope = params => new Scope(params);\n\n/**\n * @typedef {String|Number} ScrollThresholdValue\n */\n\n/**\n * @return {Number}\n */\nconst getMaxViewHeight = () => {\n  const $el = document.createElement('div');\n  doc.body.appendChild($el);\n  $el.style.height = '100lvh';\n  const height = $el.offsetHeight;\n  doc.body.removeChild($el);\n  return height;\n};\n\n/**\n * @template {ScrollThresholdValue|String|Number|Boolean|Function|Object} T\n * @param {T | ((observer: ScrollObserver) => T)} value\n * @param {ScrollObserver} scroller\n * @return {T}\n */\nconst parseScrollObserverFunctionParameter = (value, scroller) => value && isFnc(value) ? /** @type {Function} */(value)(scroller) : value;\n\nconst scrollContainers = new Map();\n\nclass ScrollContainer {\n  /**\n   * @param {HTMLElement} $el\n   */\n  constructor($el) {\n    /** @type {HTMLElement} */\n    this.element = $el;\n    /** @type {Boolean} */\n    this.useWin = this.element === doc.body;\n    /** @type {Number} */\n    this.winWidth = 0;\n    /** @type {Number} */\n    this.winHeight = 0;\n    /** @type {Number} */\n    this.width = 0;\n    /** @type {Number} */\n    this.height = 0;\n    /** @type {Number} */\n    this.left = 0;\n    /** @type {Number} */\n    this.top = 0;\n    /** @type {Number} */\n    this.zIndex = 0;\n    /** @type {Number} */\n    this.scrollX = 0;\n    /** @type {Number} */\n    this.scrollY = 0;\n    /** @type {Number} */\n    this.prevScrollX = 0;\n    /** @type {Number} */\n    this.prevScrollY = 0;\n    /** @type {Number} */\n    this.scrollWidth = 0;\n    /** @type {Number} */\n    this.scrollHeight = 0;\n    /** @type {Number} */\n    this.velocity = 0;\n    /** @type {Boolean} */\n    this.backwardX = false;\n    /** @type {Boolean} */\n    this.backwardY = false;\n    /** @type {Timer} */\n    this.scrollTicker = new Timer({\n      autoplay: false,\n      onBegin: () => this.dataTimer.resume(),\n      onUpdate: () => {\n        const backwards = this.backwardX || this.backwardY;\n        forEachChildren(this, (/** @type {ScrollObserver} */child) => child.handleScroll(), backwards);\n      },\n      onComplete: () => this.dataTimer.pause()\n    }).init();\n    /** @type {Timer} */\n    this.dataTimer = new Timer({\n      autoplay: false,\n      frameRate: 30,\n      onUpdate: self => {\n        const dt = self.deltaTime;\n        const px = this.prevScrollX;\n        const py = this.prevScrollY;\n        const nx = this.scrollX;\n        const ny = this.scrollY;\n        const dx = px - nx;\n        const dy = py - ny;\n        this.prevScrollX = nx;\n        this.prevScrollY = ny;\n        if (dx) this.backwardX = px > nx;\n        if (dy) this.backwardY = py > ny;\n        this.velocity = round(dt > 0 ? Math.sqrt(dx * dx + dy * dy) / dt : 0, 5);\n      }\n    }).init();\n    /** @type {Timer} */\n    this.resizeTicker = new Timer({\n      autoplay: false,\n      duration: 250 * globals.timeScale,\n      onComplete: () => {\n        this.updateWindowBounds();\n        this.refreshScrollObservers();\n        this.handleScroll();\n      }\n    }).init();\n    /** @type {Timer} */\n    this.wakeTicker = new Timer({\n      autoplay: false,\n      duration: 500 * globals.timeScale,\n      onBegin: () => {\n        this.scrollTicker.resume();\n      },\n      onComplete: () => {\n        this.scrollTicker.pause();\n      }\n    }).init();\n    /** @type {ScrollObserver} */\n    this._head = null;\n    /** @type {ScrollObserver} */\n    this._tail = null;\n    this.updateScrollCoords();\n    this.updateWindowBounds();\n    this.updateBounds();\n    this.refreshScrollObservers();\n    this.handleScroll();\n    this.resizeObserver = new ResizeObserver(() => this.resizeTicker.restart());\n    this.resizeObserver.observe(this.element);\n    (this.useWin ? win : this.element).addEventListener('scroll', this, false);\n  }\n\n  updateScrollCoords() {\n    const useWin = this.useWin;\n    const $el = this.element;\n    this.scrollX = round(useWin ? win.scrollX : $el.scrollLeft, 0);\n    this.scrollY = round(useWin ? win.scrollY : $el.scrollTop, 0);\n  }\n\n  updateWindowBounds() {\n    this.winWidth = win.innerWidth;\n    this.winHeight = getMaxViewHeight();\n  }\n\n  updateBounds() {\n    const style = getComputedStyle(this.element);\n    const $el = this.element;\n    this.scrollWidth = $el.scrollWidth + parseFloat(style.marginLeft) + parseFloat(style.marginRight);\n    this.scrollHeight = $el.scrollHeight + parseFloat(style.marginTop) + parseFloat(style.marginBottom);\n    this.updateWindowBounds();\n    let width, height;\n    if (this.useWin) {\n      width = this.winWidth;\n      height = this.winHeight;\n    } else {\n      const elRect = $el.getBoundingClientRect();\n      width = elRect.width;\n      height = elRect.height;\n      this.top = elRect.top;\n      this.left = elRect.left;\n    }\n    this.width = width;\n    this.height = height;\n  }\n\n  refreshScrollObservers() {\n    forEachChildren(this, (/** @type {ScrollObserver} */child) => {\n      if (child._debug) {\n        child.removeDebug();\n      }\n    });\n    this.updateBounds();\n    forEachChildren(this, (/** @type {ScrollObserver} */child) => {\n      child.refresh();\n      if (child._debug) {\n        child.debug();\n      }\n    });\n  }\n\n  refresh() {\n    this.updateWindowBounds();\n    this.updateBounds();\n    this.refreshScrollObservers();\n    this.handleScroll();\n  }\n\n  handleScroll() {\n    this.updateScrollCoords();\n    this.wakeTicker.restart();\n  }\n\n  /**\n   * @param {Event} e\n   */\n  handleEvent(e) {\n    switch (e.type) {\n      case 'scroll':\n        this.handleScroll();\n        break;\n    }\n  }\n\n  revert() {\n    this.scrollTicker.cancel();\n    this.dataTimer.cancel();\n    this.resizeTicker.cancel();\n    this.wakeTicker.cancel();\n    this.resizeObserver.unobserve(this.element);\n    (this.useWin ? win : this.element).removeEventListener('scroll', this);\n    scrollContainers.delete(this.element);\n  }\n}\n\n/**\n * @param {TargetsParam} target\n * @return {ScrollContainer}\n */\nconst registerAndGetScrollContainer = target => {\n  const $el = /** @type {HTMLElement} */(target ? parseTargets(target)[0] || doc.body : doc.body);\n  let scrollContainer = scrollContainers.get($el);\n  if (!scrollContainer) {\n    scrollContainer = new ScrollContainer($el);\n    scrollContainers.set($el, scrollContainer);\n  }\n  return scrollContainer;\n};\n\n/**\n * @param {HTMLElement} $el\n * @param {Number|string} v\n * @param {Number} size\n * @param {Number} [under]\n * @param {Number} [over]\n * @return {Number}\n */\nconst convertValueToPx = ($el, v, size, under, over) => {\n  const clampMin = v === 'min';\n  const clampMax = v === 'max';\n  const value = v === 'top' || v === 'left' || v === 'start' || clampMin ? 0 :\n                v === 'bottom' || v === 'right' || v === 'end' || clampMax ? '100%' :\n                v === 'center' ? '50%' :\n                v;\n  const { n, u } = decomposeRawValue(value, decomposedOriginalValue);\n  let px = n;\n  if (u === '%') {\n    px = (n / 100) * size;\n  } else if (u) {\n    px = convertValueUnit($el, decomposedOriginalValue, 'px', true).n;\n  }\n  if (clampMax && under < 0) px += under;\n  if (clampMin && over > 0) px += over;\n  return px;\n};\n\n/**\n * @param {HTMLElement} $el\n * @param {ScrollThresholdValue} v\n * @param {Number} size\n * @param {Number} [under]\n * @param {Number} [over]\n * @return {Number}\n */\nconst parseBoundValue = ($el, v, size, under, over) => {\n  /** @type {Number} */\n  let value;\n  if (isStr(v)) {\n    const matchedOperator = relativeValuesExecRgx.exec(/** @type {String} */(v));\n    if (matchedOperator) {\n      const splitter = matchedOperator[0];\n      const operator = splitter[0];\n      const splitted = /** @type {String} */(v).split(splitter);\n      const clampMin = splitted[0] === 'min';\n      const clampMax = splitted[0] === 'max';\n      const valueAPx = convertValueToPx($el, splitted[0], size, under, over);\n      const valueBPx = convertValueToPx($el, splitted[1], size, under, over);\n      if (clampMin) {\n        const min = getRelativeValue(convertValueToPx($el, 'min', size), valueBPx, operator);\n        value = min < valueAPx ? valueAPx : min;\n      } else if (clampMax) {\n        const max = getRelativeValue(convertValueToPx($el, 'max', size), valueBPx, operator);\n        value = max > valueAPx ? valueAPx : max;\n      } else {\n        value = getRelativeValue(valueAPx, valueBPx, operator);\n      }\n    } else {\n      value = convertValueToPx($el, v, size, under, over);\n    }\n  } else {\n    value = /** @type {Number} */(v);\n  }\n  return round(value, 0);\n};\n\n/**\n * @param {JSAnimation} linked\n * @return {HTMLElement}\n */\nconst getAnimationDomTarget = linked => {\n  let $linkedTarget;\n  const linkedTargets = linked.targets;\n  for (let i = 0, l = linkedTargets.length; i < l; i++) {\n    const target = linkedTargets[i];\n    if (target[isDomSymbol]) {\n      $linkedTarget = /** @type {HTMLElement} */(target);\n      break;\n    }\n  }\n  return $linkedTarget;\n};\n\nlet scrollerIndex = 0;\n\nconst debugColors = ['#FF4B4B','#FF971B','#FFC730','#F9F640','#7AFF5A','#18FF74','#17E09B','#3CFFEC','#05DBE9','#33B3F1','#638CF9','#C563FE','#FF4FCF','#F93F8A'];\n\n/**\n * @typedef {Object} ScrollThresholdParam\n * @property {ScrollThresholdValue} [target]\n * @property {ScrollThresholdValue} [container]\n */\n\n/**\n * @callback ScrollObserverAxisCallback\n * @param {ScrollObserver} self\n * @return {'x'|'y'}\n */\n\n/**\n * @callback ScrollThresholdCallback\n * @param {ScrollObserver} self\n * @return {ScrollThresholdValue|ScrollThresholdParam}\n */\n\n/**\n * @typedef {Object} ScrollObserverParams\n * @property {Number|String} [id]\n * @property {Boolean|Number|String|EasingParam} [sync]\n * @property {TargetsParam} [container]\n * @property {TargetsParam} [target]\n * @property {'x'|'y'|ScrollObserverAxisCallback|((observer: ScrollObserver) => 'x'|'y'|ScrollObserverAxisCallback)} [axis]\n * @property {ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback|((observer: ScrollObserver) => ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback)} [enter]\n * @property {ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback|((observer: ScrollObserver) => ScrollThresholdValue|ScrollThresholdParam|ScrollThresholdCallback)} [leave]\n * @property {Boolean|((observer: ScrollObserver) => Boolean)} [repeat]\n * @property {Boolean} [debug]\n * @property {Callback<ScrollObserver>} [onEnter]\n * @property {Callback<ScrollObserver>} [onLeave]\n * @property {Callback<ScrollObserver>} [onEnterForward]\n * @property {Callback<ScrollObserver>} [onLeaveForward]\n * @property {Callback<ScrollObserver>} [onEnterBackward]\n * @property {Callback<ScrollObserver>} [onLeaveBackward]\n * @property {Callback<ScrollObserver>} [onUpdate]\n * @property {Callback<ScrollObserver>} [onSyncComplete]\n */\n\nclass ScrollObserver {\n  /**\n   * @param {ScrollObserverParams} parameters\n   */\n  constructor(parameters = {}) {\n    if (globals.scope) globals.scope.revertibles.push(this);\n    const syncMode = setValue(parameters.sync, 'play pause');\n    const ease = syncMode ? parseEasings(/** @type {EasingParam} */(syncMode)) : null;\n    const isLinear = syncMode && (syncMode === 'linear' || syncMode === none);\n    const isEase = syncMode && !(ease === none && !isLinear);\n    const isSmooth = syncMode && (isNum(syncMode) || syncMode === true || isLinear);\n    const isMethods = syncMode && (isStr(syncMode) && !isEase && !isSmooth);\n    const syncMethods = isMethods ? /** @type {String} */(syncMode).split(' ').map(\n      (/** @type {String} */m) => () => {\n        const linked = this.linked;\n        return linked && linked[m] ? linked[m]() : null;\n      }\n    ) : null;\n    const biDirSync = isMethods && syncMethods.length > 2;\n    /** @type {Number} */\n    this.index = scrollerIndex++;\n    /** @type {String|Number} */\n    this.id = !isUnd(parameters.id) ? parameters.id : this.index;\n    /** @type {ScrollContainer} */\n    this.container = registerAndGetScrollContainer(parameters.container);\n    /** @type {HTMLElement} */\n    this.target = null;\n    /** @type {Tickable|WAAPIAnimation} */\n    this.linked = null;\n    /** @type {Boolean} */\n    this.repeat = null;\n    /** @type {Boolean} */\n    this.horizontal = null;\n    /** @type {ScrollThresholdParam|ScrollThresholdValue|ScrollThresholdCallback} */\n    this.enter = null;\n    /** @type {ScrollThresholdParam|ScrollThresholdValue|ScrollThresholdCallback} */\n    this.leave = null;\n    /** @type {Boolean} */\n    this.sync = isEase || isSmooth || !!syncMethods;\n    /** @type {EasingFunction} */\n    this.syncEase = isEase ? ease : null;\n    /** @type {Number} */\n    this.syncSmooth = isSmooth ? syncMode === true || isLinear ? 1 : /** @type {Number} */(syncMode) : null;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncEnter = syncMethods && !biDirSync && syncMethods[0] ? syncMethods[0] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncLeave = syncMethods && !biDirSync && syncMethods[1] ? syncMethods[1] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncEnterForward = syncMethods && biDirSync && syncMethods[0] ? syncMethods[0] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncLeaveForward = syncMethods && biDirSync && syncMethods[1] ? syncMethods[1] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncEnterBackward = syncMethods && biDirSync && syncMethods[2] ? syncMethods[2] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncLeaveBackward = syncMethods && biDirSync && syncMethods[3] ? syncMethods[3] : noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onEnter = parameters.onEnter || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onLeave = parameters.onLeave || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onEnterForward = parameters.onEnterForward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onLeaveForward = parameters.onLeaveForward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onEnterBackward = parameters.onEnterBackward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onLeaveBackward = parameters.onLeaveBackward || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onUpdate = parameters.onUpdate || noop;\n    /** @type {Callback<ScrollObserver>} */\n    this.onSyncComplete = parameters.onSyncComplete || noop;\n    /** @type {Boolean} */\n    this.reverted = false;\n    /** @type {Boolean} */\n    this.completed = false;\n    /** @type {Boolean} */\n    this.began = false;\n    /** @type {Boolean} */\n    this.isInView = false;\n    /** @type {Boolean} */\n    this.forceEnter = false;\n    /** @type {Boolean} */\n    this.hasEntered = false;\n    /** @type {Array.<Number>} */\n    this.offsets = [];\n    /** @type {Number} */\n    this.offset = 0;\n    /** @type {Number} */\n    this.offsetStart = 0;\n    /** @type {Number} */\n    this.offsetEnd = 0;\n    /** @type {Number} */\n    this.distance = 0;\n    /** @type {Number} */\n    this.prevProgress = 0;\n    /** @type {Array} */\n    this.thresholds = ['start', 'end', 'end', 'start'];\n    /** @type {[Number, Number, Number, Number]} */\n    this.coords = [0, 0, 0, 0];\n    /** @type {JSAnimation} */\n    this.debugStyles = null;\n    /** @type {HTMLElement} */\n    this.$debug = null;\n    /** @type {ScrollObserverParams} */\n    this._params = parameters;\n    /** @type {Boolean} */\n    this._debug = setValue(parameters.debug, false);\n    /** @type {ScrollObserver} */\n    this._next = null;\n    /** @type {ScrollObserver} */\n    this._prev = null;\n    addChild(this.container, this);\n    // Wait for the next frame to add to the container in order to handle calls to link()\n    sync(() => {\n      if (this.reverted) return;\n      if (!this.target) {\n        const target = /** @type {HTMLElement} */(parseTargets(parameters.target)[0]);\n        this.target = target || doc.body;\n        this.refresh();\n      }\n      if (this._debug) this.debug();\n    });\n  }\n\n  /**\n   * @param {Tickable|WAAPIAnimation} linked\n   */\n  link(linked) {\n    if (linked) {\n      // Make sure to pause the linked object in case it's added later\n      linked.pause();\n      this.linked = linked;\n      // Try to use a target of the linked object if no target parameters specified\n      if (!this._params.target) {\n        /** @type {HTMLElement} */\n        let $linkedTarget;\n        if (!isUnd(/** @type {JSAnimation} */(linked).targets)) {\n          $linkedTarget = getAnimationDomTarget(/** @type {JSAnimation} */(linked));\n        } else {\n          forEachChildren(/** @type {Timeline} */(linked), (/** @type {JSAnimation} */child) => {\n            if (child.targets && !$linkedTarget) {\n              $linkedTarget = getAnimationDomTarget(/** @type {JSAnimation} */(child));\n            }\n          });\n        }\n        // Fallback to body if no target found\n        this.target = $linkedTarget || doc.body;\n        this.refresh();\n      }\n    }\n    return this;\n  }\n\n  get velocity() {\n    return this.container.velocity;\n  }\n\n  get backward() {\n    return this.horizontal ? this.container.backwardX : this.container.backwardY;\n  }\n\n  get scroll() {\n    return this.horizontal ? this.container.scrollX : this.container.scrollY;\n  }\n\n  get progress() {\n    const p = (this.scroll - this.offsetStart) / this.distance;\n    return p === Infinity || isNaN(p) ? 0 : round(clamp(p, 0, 1), 6);\n  }\n\n  refresh() {\n    this.reverted = false;\n    const params = this._params;\n    this.repeat = setValue(parseScrollObserverFunctionParameter(params.repeat, this), true);\n    this.horizontal = setValue(parseScrollObserverFunctionParameter(params.axis, this), 'y') === 'x';\n    this.enter = setValue(parseScrollObserverFunctionParameter(params.enter, this), 'end start');\n    this.leave = setValue(parseScrollObserverFunctionParameter(params.leave, this), 'start end');\n    this.updateBounds();\n    this.handleScroll();\n    return this;\n  }\n\n  removeDebug() {\n    if (this.$debug) {\n      this.$debug.parentNode.removeChild(this.$debug);\n      this.$debug = null;\n    }\n    if (this.debugStyles) {\n      this.debugStyles.revert();\n      this.$debug = null;\n    }\n    return this;\n  }\n\n  debug() {\n    this.removeDebug();\n    const container = this.container;\n    const isHori = this.horizontal;\n    const $existingDebug = container.element.querySelector(':scope > .animejs-onscroll-debug');\n    const $debug = doc.createElement('div');\n    const $thresholds = doc.createElement('div');\n    const $triggers = doc.createElement('div');\n    const color = debugColors[this.index % debugColors.length];\n    const useWin = container.useWin;\n    const containerWidth = useWin ? container.winWidth : container.width;\n    const containerHeight = useWin ? container.winHeight : container.height;\n    const scrollWidth = container.scrollWidth;\n    const scrollHeight = container.scrollHeight;\n    const size = this.container.width > 360 ? 320 : 260;\n    const offLeft = isHori ? 0 : 10;\n    const offTop = isHori ? 10 : 0;\n    const half = isHori ? 24 : size / 2;\n    const labelHeight = isHori ? half : 15;\n    const labelWidth = isHori ? 60 : half;\n    const labelSize = isHori ? labelWidth : labelHeight;\n    const repeat = isHori ? 'repeat-x' : 'repeat-y';\n    /**\n     * @param {Number} v\n     * @return {String}\n     */\n    const gradientOffset = v => isHori ? '0px '+(v)+'px' : (v)+'px'+' 2px';\n    /**\n     * @param {String} c\n     * @return {String}\n     */\n    const lineCSS = (c) => `linear-gradient(${isHori ? 90 : 0}deg, ${c} 2px, transparent 1px)`;\n    /**\n     * @param {String} p\n     * @param {Number} l\n     * @param {Number} t\n     * @param {Number} w\n     * @param {Number} h\n     * @return {String}\n     */\n    const baseCSS = (p, l, t, w, h) => `position:${p};left:${l}px;top:${t}px;width:${w}px;height:${h}px;`;\n    $debug.style.cssText = `${baseCSS('absolute', offLeft, offTop, isHori ? scrollWidth : size, isHori ? size : scrollHeight)}\n      pointer-events: none;\n      z-index: ${this.container.zIndex++};\n      display: flex;\n      flex-direction: ${isHori ? 'column' : 'row'};\n      filter: drop-shadow(0px 1px 0px rgba(0,0,0,.75));\n    `;\n    $thresholds.style.cssText = `${baseCSS('sticky', 0, 0, isHori ? containerWidth : half, isHori ? half : containerHeight)}`;\n    if (!$existingDebug) {\n      $thresholds.style.cssText += `background:\n        ${lineCSS('#FFFF')}${gradientOffset(half-10)} / ${isHori ? '100px 100px' : '100px 100px'} ${repeat},\n        ${lineCSS('#FFF8')}${gradientOffset(half-10)} / ${isHori ? '10px 10px' : '10px 10px'} ${repeat};\n      `;\n    }\n    $triggers.style.cssText = `${baseCSS('relative', 0, 0, isHori ? scrollWidth : half, isHori ? half : scrollHeight)}`;\n    if (!$existingDebug) {\n      $triggers.style.cssText += `background:\n        ${lineCSS('#FFFF')}${gradientOffset(0)} / ${isHori ? '100px 10px' : '10px 100px'} ${repeat},\n        ${lineCSS('#FFF8')}${gradientOffset(0)} / ${isHori ? '10px 0px' : '0px 10px'} ${repeat};\n      `;\n    }\n    const labels = [' enter: ', ' leave: '];\n    this.coords.forEach((v, i) => {\n      const isView = i > 1;\n      const value = (isView ? 0 : this.offset) + v;\n      const isTail = i % 2;\n      const isFirst = value < labelSize;\n      const isOver = value > (isView ? isHori ? containerWidth : containerHeight : isHori ? scrollWidth : scrollHeight) - labelSize;\n      const isFlip = (isView ? isTail && !isFirst : !isTail && !isFirst) || isOver;\n      const $label = doc.createElement('div');\n      const $text = doc.createElement('div');\n      const dirProp = isHori ? isFlip ? 'right' : 'left' : isFlip ? 'bottom' : 'top';\n      const flipOffset = isFlip ? (isHori ? labelWidth : labelHeight) + (!isView ? isHori ? -1 : -2 : isHori ? -1 : isOver ? 0 : -2) : !isView ? isHori ? 1 : 0 : isHori ? 1 : 0;\n      // $text.innerHTML = `${!isView ? '' : labels[isTail] + ' '}${this.id}: ${this.thresholds[i]} ${isView ? '' : labels[isTail]}`;\n      $text.innerHTML = `${this.id}${labels[isTail]}${this.thresholds[i]}`;\n      $label.style.cssText = `${baseCSS('absolute', 0, 0, labelWidth, labelHeight)}\n        display: flex;\n        flex-direction: ${isHori ? 'column' : 'row'};\n        justify-content: flex-${isView ? 'start' : 'end'};\n        align-items: flex-${isFlip ? 'end' : 'start'};\n        border-${dirProp}: 2px ${isTail ? 'solid' : 'solid'} ${color};\n      `;\n      $text.style.cssText = `\n        overflow: hidden;\n        max-width: ${(size / 2) - 10}px;\n        height: ${labelHeight};\n        margin-${isHori ? isFlip ? 'right' : 'left' : isFlip ? 'bottom' : 'top'}: -2px;\n        padding: 1px;\n        font-family: ui-monospace, monospace;\n        font-size: 10px;\n        letter-spacing: -.025em;\n        line-height: 9px;\n        font-weight: 600;\n        text-align: ${isHori && isFlip || !isHori && !isView ? 'right' : 'left'};\n        white-space: pre;\n        text-overflow: ellipsis;\n        color: ${isTail ? color : 'rgba(0,0,0,.75)'};\n        background-color: ${isTail ? 'rgba(0,0,0,.65)' : color};\n        border: 2px solid ${isTail ? color : 'transparent'};\n        border-${isHori ? isFlip ? 'top-left' : 'top-right' : isFlip ? 'top-left' : 'bottom-left'}-radius: 5px;\n        border-${isHori ? isFlip ? 'bottom-left' : 'bottom-right' : isFlip ? 'top-right' : 'bottom-right'}-radius: 5px;\n      `;\n      $label.appendChild($text);\n      let position = value - flipOffset + (isHori ? 1 : 0);\n      $label.style[isHori ? 'left' : 'top'] = `${position}px`;\n      // $label.style[isHori ? 'left' : 'top'] = value - flipOffset + (!isFlip && isFirst && !isView ? 1 : isFlip ? 0 : -2) + 'px';\n      (isView ? $thresholds : $triggers).appendChild($label);\n    });\n\n    $debug.appendChild($thresholds);\n    $debug.appendChild($triggers);\n    container.element.appendChild($debug);\n\n    if (!$existingDebug) $debug.classList.add('animejs-onscroll-debug');\n    this.$debug = $debug;\n    const containerPosition = getTargetValue(container.element, 'position');\n    if (containerPosition === 'static') {\n      this.debugStyles = setTargetValues(container.element, { position: 'relative '});\n    }\n\n  }\n\n  updateBounds() {\n    if (this._debug) {\n      this.removeDebug();\n    }\n    let stickys;\n    const $target = this.target;\n    const container = this.container;\n    const isHori = this.horizontal;\n    const linked = this.linked;\n    let linkedTime;\n    let $el = $target;\n    let offsetX = 0;\n    let offsetY = 0;\n    /** @type {Element} */\n    let $offsetParent = $el;\n    if (linked) {\n      linkedTime = linked.currentTime;\n      linked.seek(0, true);\n    }\n    const isContainerStatic = getTargetValue(container.element, 'position') === 'static' ? setTargetValues(container.element, { position: 'relative '}) : false;\n    while ($el && $el !== container.element && $el !== doc.body) {\n      const isSticky = getTargetValue($el, 'position') === 'sticky' ?\n                       setTargetValues($el, { position: 'static' }) :\n                       false;\n      if ($el === $offsetParent) {\n        offsetX += $el.offsetLeft || 0;\n        offsetY += $el.offsetTop || 0;\n        $offsetParent = $el.offsetParent;\n      }\n      $el = /** @type {HTMLElement} */($el.parentElement);\n      if (isSticky) {\n        if (!stickys) stickys = [];\n        stickys.push(isSticky);\n      }\n    }\n    if (isContainerStatic) isContainerStatic.revert();\n    const offset = isHori ? offsetX : offsetY;\n    const targetSize = isHori ? $target.offsetWidth : $target.offsetHeight;\n    const containerSize = isHori ? container.width : container.height;\n    const scrollSize = isHori ? container.scrollWidth : container.scrollHeight;\n    const maxScroll = scrollSize - containerSize;\n    const enter = this.enter;\n    const leave = this.leave;\n\n    /** @type {ScrollThresholdValue} */\n    let enterTarget = 'start';\n    /** @type {ScrollThresholdValue} */\n    let leaveTarget = 'end';\n    /** @type {ScrollThresholdValue} */\n    let enterContainer = 'end';\n    /** @type {ScrollThresholdValue} */\n    let leaveContainer = 'start';\n\n    if (isStr(enter)) {\n      const splitted = /** @type {String} */(enter).split(' ');\n      enterContainer = splitted[0];\n      enterTarget = splitted.length > 1 ? splitted[1] : enterTarget;\n    } else if (isObj(enter)) {\n      const e = /** @type {ScrollThresholdParam} */(enter);\n      if (!isUnd(e.container)) enterContainer = e.container;\n      if (!isUnd(e.target)) enterTarget = e.target;\n    } else if (isNum(enter)) {\n      enterContainer = /** @type {Number} */(enter);\n    }\n\n    if (isStr(leave)) {\n      const splitted = /** @type {String} */(leave).split(' ');\n      leaveContainer = splitted[0];\n      leaveTarget = splitted.length > 1 ? splitted[1] : leaveTarget;\n    } else if (isObj(leave)) {\n      const t = /** @type {ScrollThresholdParam} */(leave);\n      if (!isUnd(t.container)) leaveContainer = t.container;\n      if (!isUnd(t.target)) leaveTarget = t.target;\n    } else if (isNum(leave)) {\n      leaveContainer = /** @type {Number} */(leave);\n    }\n\n    const parsedEnterTarget = parseBoundValue($target, enterTarget, targetSize);\n    const parsedLeaveTarget = parseBoundValue($target, leaveTarget, targetSize);\n    const under = (parsedEnterTarget + offset) - containerSize;\n    const over = (parsedLeaveTarget + offset) - maxScroll;\n    const parsedEnterContainer = parseBoundValue($target, enterContainer, containerSize, under, over);\n    const parsedLeaveContainer = parseBoundValue($target, leaveContainer, containerSize, under, over);\n    const offsetStart = parsedEnterTarget + offset - parsedEnterContainer;\n    const offsetEnd = parsedLeaveTarget + offset - parsedLeaveContainer;\n    const scrollDelta = offsetEnd - offsetStart;\n    this.offsets[0] = offsetX;\n    this.offsets[1] = offsetY;\n    this.offset = offset;\n    this.offsetStart = offsetStart;\n    this.offsetEnd = offsetEnd;\n    this.distance = scrollDelta <= 0 ? 0 : scrollDelta;\n    this.thresholds = [enterTarget, leaveTarget, enterContainer, leaveContainer];\n    this.coords = [parsedEnterTarget, parsedLeaveTarget, parsedEnterContainer, parsedLeaveContainer];\n    if (stickys) {\n      stickys.forEach(sticky => sticky.revert());\n    }\n    if (linked) {\n      linked.seek(linkedTime, true);\n    }\n    if (this._debug) {\n      this.debug();\n    }\n  }\n\n  handleScroll() {\n    const linked = this.linked;\n    const sync = this.sync;\n    const syncEase = this.syncEase;\n    const syncSmooth = this.syncSmooth;\n    const shouldSeek = linked && (syncEase || syncSmooth);\n    const isHori = this.horizontal;\n    const container = this.container;\n    const scroll = this.scroll;\n    const isBefore = scroll <= this.offsetStart;\n    const isAfter = scroll >= this.offsetEnd;\n    const isInView = !isBefore && !isAfter;\n    const isOnTheEdge = scroll === this.offsetStart || scroll === this.offsetEnd;\n    const forceEnter = !this.hasEntered && isOnTheEdge;\n    const $debug = this._debug && this.$debug;\n    let hasUpdated = false;\n    let syncCompleted = false;\n    let p = this.progress;\n\n    if (isBefore && this.began) {\n      this.began = false;\n    }\n\n    if (p > 0 && !this.began) {\n      this.began = true;\n    }\n\n    if (shouldSeek) {\n      const lp = linked.progress;\n      if (syncSmooth && isNum(syncSmooth)) {\n        if (/** @type {Number} */(syncSmooth) < 1) {\n          const step = 0.0001;\n          const snap = lp < p && p === 1 ? step : lp > p && !p ? -1e-4 : 0;\n          p = round(lerp(lp, p, interpolate(.01, .2, /** @type {Number} */(syncSmooth)), false) + snap, 6);\n        }\n      } else if (syncEase) {\n        p = syncEase(p);\n      }\n      hasUpdated = p !== this.prevProgress;\n      syncCompleted = lp === 1;\n      if (hasUpdated && !syncCompleted && (syncSmooth && lp)) {\n        container.wakeTicker.restart();\n      }\n    }\n\n    if ($debug) {\n      const sticky = isHori ? container.scrollY : container.scrollX;\n      $debug.style[isHori ? 'top' : 'left'] = sticky + 10 + 'px';\n    }\n\n    // Trigger enter callbacks if already in view or when entering the view\n    if ((isInView && !this.isInView) || (forceEnter && !this.forceEnter && !this.hasEntered)) {\n      if (isInView) this.isInView = true;\n      if (!this.forceEnter || !this.hasEntered) {\n        if ($debug && isInView) $debug.style.zIndex = `${this.container.zIndex++}`;\n        this.onSyncEnter(this);\n        this.onEnter(this);\n        if (this.backward) {\n          this.onSyncEnterBackward(this);\n          this.onEnterBackward(this);\n        } else {\n          this.onSyncEnterForward(this);\n          this.onEnterForward(this);\n        }\n        this.hasEntered = true;\n        if (forceEnter) this.forceEnter = true;\n      } else if (isInView) {\n        this.forceEnter = false;\n      }\n    }\n\n    if (isInView || !isInView && this.isInView) {\n      hasUpdated = true;\n    }\n\n    if (hasUpdated) {\n      if (shouldSeek) linked.seek(linked.duration * p);\n      this.onUpdate(this);\n    }\n\n    if (!isInView && this.isInView) {\n      this.isInView = false;\n      this.onSyncLeave(this);\n      this.onLeave(this);\n      if (this.backward) {\n        this.onSyncLeaveBackward(this);\n        this.onLeaveBackward(this);\n      } else {\n        this.onSyncLeaveForward(this);\n        this.onLeaveForward(this);\n      }\n      if (sync && !syncSmooth) {\n        syncCompleted = true;\n      }\n    }\n\n    if (p >= 1 && this.began && !this.completed && (sync && syncCompleted || !sync)) {\n      if (sync) {\n        this.onSyncComplete(this);\n      }\n      this.completed = true;\n      if ((!this.repeat && !linked) || (!this.repeat && linked && linked.completed)) {\n        this.revert();\n      }\n    }\n\n    if (p < 1 && this.completed) {\n      this.completed = false;\n    }\n\n    this.prevProgress = p;\n  }\n\n  revert() {\n    if (this.reverted) return;\n    const container = this.container;\n    removeChild(container, this);\n    if (!container._head) {\n      container.revert();\n    }\n    if (this._debug) {\n      this.removeDebug();\n    }\n    this.reverted = true;\n    return this;\n  }\n\n}\n\n/**\n * @param {ScrollObserverParams} [parameters={}]\n * @return {ScrollObserver}\n */\nconst onScroll = (parameters = {}) => new ScrollObserver(parameters);\n\n\n\n\n/**\n * @typedef  {Object} StaggerParameters\n * @property {Number|String} [start]\n * @property {Number|'first'|'center'|'last'} [from]\n * @property {Boolean} [reversed]\n * @property {Array.<Number>} [grid]\n * @property {('x'|'y')} [axis]\n * @property {EasingParam} [ease]\n * @property {TweenModifier} [modifier]\n */\n\n/**\n * @callback StaggerFunction\n * @param {Target} [target]\n * @param {Number} [index]\n * @param {Number} [length]\n * @param {Timeline} [tl]\n * @return {Number|String}\n */\n\n/**\n * @param  {Number|String|[Number|String,Number|String]} val\n * @param  {StaggerParameters} params\n * @return {StaggerFunction}\n */\nconst stagger = (val, params = {}) => {\n  let values = [];\n  let maxValue = 0;\n  const from = params.from;\n  const reversed = params.reversed;\n  const ease = params.ease;\n  const hasEasing = !isUnd(ease);\n  const hasSpring = hasEasing && !isUnd(/** @type {Spring} */(ease).ease);\n  const staggerEase = hasSpring ? /** @type {Spring} */(ease).ease : hasEasing ? parseEasings(ease) : null;\n  const grid = params.grid;\n  const axis = params.axis;\n  const fromFirst = isUnd(from) || from === 0 || from === 'first';\n  const fromCenter = from === 'center';\n  const fromLast = from === 'last';\n  const isRange = isArr(val);\n  const val1 = isRange ? parseNumber(val[0]) : parseNumber(val);\n  const val2 = isRange ? parseNumber(val[1]) : 0;\n  const unitMatch = unitsExecRgx.exec((isRange ? val[1] : val) + emptyString);\n  const start = params.start || 0 + (isRange ? val1 : 0);\n  let fromIndex = fromFirst ? 0 : isNum(from) ? from : 0;\n  return (_, i, t, tl) => {\n    if (fromCenter) fromIndex = (t - 1) / 2;\n    if (fromLast) fromIndex = t - 1;\n    if (!values.length) {\n      for (let index = 0; index < t; index++) {\n        if (!grid) {\n          values.push(abs(fromIndex - index));\n        } else {\n          const fromX = !fromCenter ? fromIndex % grid[0] : (grid[0] - 1) / 2;\n          const fromY = !fromCenter ? floor(fromIndex / grid[0]) : (grid[1] - 1) / 2;\n          const toX = index % grid[0];\n          const toY = floor(index / grid[0]);\n          const distanceX = fromX - toX;\n          const distanceY = fromY - toY;\n          let value = sqrt(distanceX * distanceX + distanceY * distanceY);\n          if (axis === 'x') value = -distanceX;\n          if (axis === 'y') value = -distanceY;\n          values.push(value);\n        }\n        maxValue = max(...values);\n      }\n      if (staggerEase) values = values.map(val => staggerEase(val / maxValue) * maxValue);\n      if (reversed) values = values.map(val => axis ? (val < 0) ? val * -1 : -val : abs(maxValue - val));\n    }\n    const spacing = isRange ? (val2 - val1) / maxValue : val1;\n    const offset = tl ? parseTimelinePosition(tl, isUnd(params.start) ? tl.iterationDuration : start) : /** @type {Number} */(start);\n    /** @type {String|Number} */\n    let output = offset + ((spacing * round(values[i], 2)) || 0);\n    if (params.modifier) output = params.modifier(output);\n    if (unitMatch) output = `${output}${unitMatch[2]}`;\n    return output;\n  }\n};\n\nexport { Animatable, Draggable, JSAnimation, Scope, ScrollObserver, Spring, Timeline, Timer, WAAPIAnimation, animate, createAnimatable, createDraggable, createScope, createSpring, createTimeline, createTimer, eases, engine, onScroll, scrollContainers, stagger, svg, utils, waapi };\n","\n/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */\nfunction isNothing(subject) {\n  return (typeof subject === 'undefined') || (subject === null);\n}\n\n\nfunction isObject(subject) {\n  return (typeof subject === 'object') && (subject !== null);\n}\n\n\nfunction toArray(sequence) {\n  if (Array.isArray(sequence)) return sequence;\n  else if (isNothing(sequence)) return [];\n\n  return [ sequence ];\n}\n\n\nfunction extend(target, source) {\n  var index, length, key, sourceKeys;\n\n  if (source) {\n    sourceKeys = Object.keys(source);\n\n    for (index = 0, length = sourceKeys.length; index < length; index += 1) {\n      key = sourceKeys[index];\n      target[key] = source[key];\n    }\n  }\n\n  return target;\n}\n\n\nfunction repeat(string, count) {\n  var result = '', cycle;\n\n  for (cycle = 0; cycle < count; cycle += 1) {\n    result += string;\n  }\n\n  return result;\n}\n\n\nfunction isNegativeZero(number) {\n  return (number === 0) && (Number.NEGATIVE_INFINITY === 1 / number);\n}\n\n\nvar isNothing_1      = isNothing;\nvar isObject_1       = isObject;\nvar toArray_1        = toArray;\nvar repeat_1         = repeat;\nvar isNegativeZero_1 = isNegativeZero;\nvar extend_1         = extend;\n\nvar common = {\n\tisNothing: isNothing_1,\n\tisObject: isObject_1,\n\ttoArray: toArray_1,\n\trepeat: repeat_1,\n\tisNegativeZero: isNegativeZero_1,\n\textend: extend_1\n};\n\n// YAML error class. http://stackoverflow.com/questions/8458984\n\n\nfunction formatError(exception, compact) {\n  var where = '', message = exception.reason || '(unknown reason)';\n\n  if (!exception.mark) return message;\n\n  if (exception.mark.name) {\n    where += 'in \"' + exception.mark.name + '\" ';\n  }\n\n  where += '(' + (exception.mark.line + 1) + ':' + (exception.mark.column + 1) + ')';\n\n  if (!compact && exception.mark.snippet) {\n    where += '\\n\\n' + exception.mark.snippet;\n  }\n\n  return message + ' ' + where;\n}\n\n\nfunction YAMLException$1(reason, mark) {\n  // Super constructor\n  Error.call(this);\n\n  this.name = 'YAMLException';\n  this.reason = reason;\n  this.mark = mark;\n  this.message = formatError(this, false);\n\n  // Include stack trace in error object\n  if (Error.captureStackTrace) {\n    // Chrome and NodeJS\n    Error.captureStackTrace(this, this.constructor);\n  } else {\n    // FF, IE 10+ and Safari 6+. Fallback for others\n    this.stack = (new Error()).stack || '';\n  }\n}\n\n\n// Inherit from Error\nYAMLException$1.prototype = Object.create(Error.prototype);\nYAMLException$1.prototype.constructor = YAMLException$1;\n\n\nYAMLException$1.prototype.toString = function toString(compact) {\n  return this.name + ': ' + formatError(this, compact);\n};\n\n\nvar exception = YAMLException$1;\n\n// get snippet for a single line, respecting maxLength\nfunction getLine(buffer, lineStart, lineEnd, position, maxLineLength) {\n  var head = '';\n  var tail = '';\n  var maxHalfLength = Math.floor(maxLineLength / 2) - 1;\n\n  if (position - lineStart > maxHalfLength) {\n    head = ' ... ';\n    lineStart = position - maxHalfLength + head.length;\n  }\n\n  if (lineEnd - position > maxHalfLength) {\n    tail = ' ...';\n    lineEnd = position + maxHalfLength - tail.length;\n  }\n\n  return {\n    str: head + buffer.slice(lineStart, lineEnd).replace(/\\t/g, '→') + tail,\n    pos: position - lineStart + head.length // relative position\n  };\n}\n\n\nfunction padStart(string, max) {\n  return common.repeat(' ', max - string.length) + string;\n}\n\n\nfunction makeSnippet(mark, options) {\n  options = Object.create(options || null);\n\n  if (!mark.buffer) return null;\n\n  if (!options.maxLength) options.maxLength = 79;\n  if (typeof options.indent      !== 'number') options.indent      = 1;\n  if (typeof options.linesBefore !== 'number') options.linesBefore = 3;\n  if (typeof options.linesAfter  !== 'number') options.linesAfter  = 2;\n\n  var re = /\\r?\\n|\\r|\\0/g;\n  var lineStarts = [ 0 ];\n  var lineEnds = [];\n  var match;\n  var foundLineNo = -1;\n\n  while ((match = re.exec(mark.buffer))) {\n    lineEnds.push(match.index);\n    lineStarts.push(match.index + match[0].length);\n\n    if (mark.position <= match.index && foundLineNo < 0) {\n      foundLineNo = lineStarts.length - 2;\n    }\n  }\n\n  if (foundLineNo < 0) foundLineNo = lineStarts.length - 1;\n\n  var result = '', i, line;\n  var lineNoLength = Math.min(mark.line + options.linesAfter, lineEnds.length).toString().length;\n  var maxLineLength = options.maxLength - (options.indent + lineNoLength + 3);\n\n  for (i = 1; i <= options.linesBefore; i++) {\n    if (foundLineNo - i < 0) break;\n    line = getLine(\n      mark.buffer,\n      lineStarts[foundLineNo - i],\n      lineEnds[foundLineNo - i],\n      mark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo - i]),\n      maxLineLength\n    );\n    result = common.repeat(' ', options.indent) + padStart((mark.line - i + 1).toString(), lineNoLength) +\n      ' | ' + line.str + '\\n' + result;\n  }\n\n  line = getLine(mark.buffer, lineStarts[foundLineNo], lineEnds[foundLineNo], mark.position, maxLineLength);\n  result += common.repeat(' ', options.indent) + padStart((mark.line + 1).toString(), lineNoLength) +\n    ' | ' + line.str + '\\n';\n  result += common.repeat('-', options.indent + lineNoLength + 3 + line.pos) + '^' + '\\n';\n\n  for (i = 1; i <= options.linesAfter; i++) {\n    if (foundLineNo + i >= lineEnds.length) break;\n    line = getLine(\n      mark.buffer,\n      lineStarts[foundLineNo + i],\n      lineEnds[foundLineNo + i],\n      mark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo + i]),\n      maxLineLength\n    );\n    result += common.repeat(' ', options.indent) + padStart((mark.line + i + 1).toString(), lineNoLength) +\n      ' | ' + line.str + '\\n';\n  }\n\n  return result.replace(/\\n$/, '');\n}\n\n\nvar snippet = makeSnippet;\n\nvar TYPE_CONSTRUCTOR_OPTIONS = [\n  'kind',\n  'multi',\n  'resolve',\n  'construct',\n  'instanceOf',\n  'predicate',\n  'represent',\n  'representName',\n  'defaultStyle',\n  'styleAliases'\n];\n\nvar YAML_NODE_KINDS = [\n  'scalar',\n  'sequence',\n  'mapping'\n];\n\nfunction compileStyleAliases(map) {\n  var result = {};\n\n  if (map !== null) {\n    Object.keys(map).forEach(function (style) {\n      map[style].forEach(function (alias) {\n        result[String(alias)] = style;\n      });\n    });\n  }\n\n  return result;\n}\n\nfunction Type$1(tag, options) {\n  options = options || {};\n\n  Object.keys(options).forEach(function (name) {\n    if (TYPE_CONSTRUCTOR_OPTIONS.indexOf(name) === -1) {\n      throw new exception('Unknown option \"' + name + '\" is met in definition of \"' + tag + '\" YAML type.');\n    }\n  });\n\n  // TODO: Add tag format check.\n  this.options       = options; // keep original options in case user wants to extend this type later\n  this.tag           = tag;\n  this.kind          = options['kind']          || null;\n  this.resolve       = options['resolve']       || function () { return true; };\n  this.construct     = options['construct']     || function (data) { return data; };\n  this.instanceOf    = options['instanceOf']    || null;\n  this.predicate     = options['predicate']     || null;\n  this.represent     = options['represent']     || null;\n  this.representName = options['representName'] || null;\n  this.defaultStyle  = options['defaultStyle']  || null;\n  this.multi         = options['multi']         || false;\n  this.styleAliases  = compileStyleAliases(options['styleAliases'] || null);\n\n  if (YAML_NODE_KINDS.indexOf(this.kind) === -1) {\n    throw new exception('Unknown kind \"' + this.kind + '\" is specified for \"' + tag + '\" YAML type.');\n  }\n}\n\nvar type = Type$1;\n\n/*eslint-disable max-len*/\n\n\n\n\n\nfunction compileList(schema, name) {\n  var result = [];\n\n  schema[name].forEach(function (currentType) {\n    var newIndex = result.length;\n\n    result.forEach(function (previousType, previousIndex) {\n      if (previousType.tag === currentType.tag &&\n          previousType.kind === currentType.kind &&\n          previousType.multi === currentType.multi) {\n\n        newIndex = previousIndex;\n      }\n    });\n\n    result[newIndex] = currentType;\n  });\n\n  return result;\n}\n\n\nfunction compileMap(/* lists... */) {\n  var result = {\n        scalar: {},\n        sequence: {},\n        mapping: {},\n        fallback: {},\n        multi: {\n          scalar: [],\n          sequence: [],\n          mapping: [],\n          fallback: []\n        }\n      }, index, length;\n\n  function collectType(type) {\n    if (type.multi) {\n      result.multi[type.kind].push(type);\n      result.multi['fallback'].push(type);\n    } else {\n      result[type.kind][type.tag] = result['fallback'][type.tag] = type;\n    }\n  }\n\n  for (index = 0, length = arguments.length; index < length; index += 1) {\n    arguments[index].forEach(collectType);\n  }\n  return result;\n}\n\n\nfunction Schema$1(definition) {\n  return this.extend(definition);\n}\n\n\nSchema$1.prototype.extend = function extend(definition) {\n  var implicit = [];\n  var explicit = [];\n\n  if (definition instanceof type) {\n    // Schema.extend(type)\n    explicit.push(definition);\n\n  } else if (Array.isArray(definition)) {\n    // Schema.extend([ type1, type2, ... ])\n    explicit = explicit.concat(definition);\n\n  } else if (definition && (Array.isArray(definition.implicit) || Array.isArray(definition.explicit))) {\n    // Schema.extend({ explicit: [ type1, type2, ... ], implicit: [ type1, type2, ... ] })\n    if (definition.implicit) implicit = implicit.concat(definition.implicit);\n    if (definition.explicit) explicit = explicit.concat(definition.explicit);\n\n  } else {\n    throw new exception('Schema.extend argument should be a Type, [ Type ], ' +\n      'or a schema definition ({ implicit: [...], explicit: [...] })');\n  }\n\n  implicit.forEach(function (type$1) {\n    if (!(type$1 instanceof type)) {\n      throw new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n    }\n\n    if (type$1.loadKind && type$1.loadKind !== 'scalar') {\n      throw new exception('There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.');\n    }\n\n    if (type$1.multi) {\n      throw new exception('There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.');\n    }\n  });\n\n  explicit.forEach(function (type$1) {\n    if (!(type$1 instanceof type)) {\n      throw new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n    }\n  });\n\n  var result = Object.create(Schema$1.prototype);\n\n  result.implicit = (this.implicit || []).concat(implicit);\n  result.explicit = (this.explicit || []).concat(explicit);\n\n  result.compiledImplicit = compileList(result, 'implicit');\n  result.compiledExplicit = compileList(result, 'explicit');\n  result.compiledTypeMap  = compileMap(result.compiledImplicit, result.compiledExplicit);\n\n  return result;\n};\n\n\nvar schema = Schema$1;\n\nvar str = new type('tag:yaml.org,2002:str', {\n  kind: 'scalar',\n  construct: function (data) { return data !== null ? data : ''; }\n});\n\nvar seq = new type('tag:yaml.org,2002:seq', {\n  kind: 'sequence',\n  construct: function (data) { return data !== null ? data : []; }\n});\n\nvar map = new type('tag:yaml.org,2002:map', {\n  kind: 'mapping',\n  construct: function (data) { return data !== null ? data : {}; }\n});\n\nvar failsafe = new schema({\n  explicit: [\n    str,\n    seq,\n    map\n  ]\n});\n\nfunction resolveYamlNull(data) {\n  if (data === null) return true;\n\n  var max = data.length;\n\n  return (max === 1 && data === '~') ||\n         (max === 4 && (data === 'null' || data === 'Null' || data === 'NULL'));\n}\n\nfunction constructYamlNull() {\n  return null;\n}\n\nfunction isNull(object) {\n  return object === null;\n}\n\nvar _null = new type('tag:yaml.org,2002:null', {\n  kind: 'scalar',\n  resolve: resolveYamlNull,\n  construct: constructYamlNull,\n  predicate: isNull,\n  represent: {\n    canonical: function () { return '~';    },\n    lowercase: function () { return 'null'; },\n    uppercase: function () { return 'NULL'; },\n    camelcase: function () { return 'Null'; },\n    empty:     function () { return '';     }\n  },\n  defaultStyle: 'lowercase'\n});\n\nfunction resolveYamlBoolean(data) {\n  if (data === null) return false;\n\n  var max = data.length;\n\n  return (max === 4 && (data === 'true' || data === 'True' || data === 'TRUE')) ||\n         (max === 5 && (data === 'false' || data === 'False' || data === 'FALSE'));\n}\n\nfunction constructYamlBoolean(data) {\n  return data === 'true' ||\n         data === 'True' ||\n         data === 'TRUE';\n}\n\nfunction isBoolean(object) {\n  return Object.prototype.toString.call(object) === '[object Boolean]';\n}\n\nvar bool = new type('tag:yaml.org,2002:bool', {\n  kind: 'scalar',\n  resolve: resolveYamlBoolean,\n  construct: constructYamlBoolean,\n  predicate: isBoolean,\n  represent: {\n    lowercase: function (object) { return object ? 'true' : 'false'; },\n    uppercase: function (object) { return object ? 'TRUE' : 'FALSE'; },\n    camelcase: function (object) { return object ? 'True' : 'False'; }\n  },\n  defaultStyle: 'lowercase'\n});\n\nfunction isHexCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) ||\n         ((0x41/* A */ <= c) && (c <= 0x46/* F */)) ||\n         ((0x61/* a */ <= c) && (c <= 0x66/* f */));\n}\n\nfunction isOctCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x37/* 7 */));\n}\n\nfunction isDecCode(c) {\n  return ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */));\n}\n\nfunction resolveYamlInteger(data) {\n  if (data === null) return false;\n\n  var max = data.length,\n      index = 0,\n      hasDigits = false,\n      ch;\n\n  if (!max) return false;\n\n  ch = data[index];\n\n  // sign\n  if (ch === '-' || ch === '+') {\n    ch = data[++index];\n  }\n\n  if (ch === '0') {\n    // 0\n    if (index + 1 === max) return true;\n    ch = data[++index];\n\n    // base 2, base 8, base 16\n\n    if (ch === 'b') {\n      // base 2\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (ch !== '0' && ch !== '1') return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'x') {\n      // base 16\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isHexCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n\n\n    if (ch === 'o') {\n      // base 8\n      index++;\n\n      for (; index < max; index++) {\n        ch = data[index];\n        if (ch === '_') continue;\n        if (!isOctCode(data.charCodeAt(index))) return false;\n        hasDigits = true;\n      }\n      return hasDigits && ch !== '_';\n    }\n  }\n\n  // base 10 (except 0)\n\n  // value should not start with `_`;\n  if (ch === '_') return false;\n\n  for (; index < max; index++) {\n    ch = data[index];\n    if (ch === '_') continue;\n    if (!isDecCode(data.charCodeAt(index))) {\n      return false;\n    }\n    hasDigits = true;\n  }\n\n  // Should have digits and should not end with `_`\n  if (!hasDigits || ch === '_') return false;\n\n  return true;\n}\n\nfunction constructYamlInteger(data) {\n  var value = data, sign = 1, ch;\n\n  if (value.indexOf('_') !== -1) {\n    value = value.replace(/_/g, '');\n  }\n\n  ch = value[0];\n\n  if (ch === '-' || ch === '+') {\n    if (ch === '-') sign = -1;\n    value = value.slice(1);\n    ch = value[0];\n  }\n\n  if (value === '0') return 0;\n\n  if (ch === '0') {\n    if (value[1] === 'b') return sign * parseInt(value.slice(2), 2);\n    if (value[1] === 'x') return sign * parseInt(value.slice(2), 16);\n    if (value[1] === 'o') return sign * parseInt(value.slice(2), 8);\n  }\n\n  return sign * parseInt(value, 10);\n}\n\nfunction isInteger(object) {\n  return (Object.prototype.toString.call(object)) === '[object Number]' &&\n         (object % 1 === 0 && !common.isNegativeZero(object));\n}\n\nvar int = new type('tag:yaml.org,2002:int', {\n  kind: 'scalar',\n  resolve: resolveYamlInteger,\n  construct: constructYamlInteger,\n  predicate: isInteger,\n  represent: {\n    binary:      function (obj) { return obj >= 0 ? '0b' + obj.toString(2) : '-0b' + obj.toString(2).slice(1); },\n    octal:       function (obj) { return obj >= 0 ? '0o'  + obj.toString(8) : '-0o'  + obj.toString(8).slice(1); },\n    decimal:     function (obj) { return obj.toString(10); },\n    /* eslint-disable max-len */\n    hexadecimal: function (obj) { return obj >= 0 ? '0x' + obj.toString(16).toUpperCase() :  '-0x' + obj.toString(16).toUpperCase().slice(1); }\n  },\n  defaultStyle: 'decimal',\n  styleAliases: {\n    binary:      [ 2,  'bin' ],\n    octal:       [ 8,  'oct' ],\n    decimal:     [ 10, 'dec' ],\n    hexadecimal: [ 16, 'hex' ]\n  }\n});\n\nvar YAML_FLOAT_PATTERN = new RegExp(\n  // 2.5e4, 2.5 and integers\n  '^(?:[-+]?(?:[0-9][0-9_]*)(?:\\\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?' +\n  // .2e4, .2\n  // special case, seems not from spec\n  '|\\\\.[0-9_]+(?:[eE][-+]?[0-9]+)?' +\n  // .inf\n  '|[-+]?\\\\.(?:inf|Inf|INF)' +\n  // .nan\n  '|\\\\.(?:nan|NaN|NAN))$');\n\nfunction resolveYamlFloat(data) {\n  if (data === null) return false;\n\n  if (!YAML_FLOAT_PATTERN.test(data) ||\n      // Quick hack to not allow integers end with `_`\n      // Probably should update regexp & check speed\n      data[data.length - 1] === '_') {\n    return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlFloat(data) {\n  var value, sign;\n\n  value  = data.replace(/_/g, '').toLowerCase();\n  sign   = value[0] === '-' ? -1 : 1;\n\n  if ('+-'.indexOf(value[0]) >= 0) {\n    value = value.slice(1);\n  }\n\n  if (value === '.inf') {\n    return (sign === 1) ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY;\n\n  } else if (value === '.nan') {\n    return NaN;\n  }\n  return sign * parseFloat(value, 10);\n}\n\n\nvar SCIENTIFIC_WITHOUT_DOT = /^[-+]?[0-9]+e/;\n\nfunction representYamlFloat(object, style) {\n  var res;\n\n  if (isNaN(object)) {\n    switch (style) {\n      case 'lowercase': return '.nan';\n      case 'uppercase': return '.NAN';\n      case 'camelcase': return '.NaN';\n    }\n  } else if (Number.POSITIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '.inf';\n      case 'uppercase': return '.INF';\n      case 'camelcase': return '.Inf';\n    }\n  } else if (Number.NEGATIVE_INFINITY === object) {\n    switch (style) {\n      case 'lowercase': return '-.inf';\n      case 'uppercase': return '-.INF';\n      case 'camelcase': return '-.Inf';\n    }\n  } else if (common.isNegativeZero(object)) {\n    return '-0.0';\n  }\n\n  res = object.toString(10);\n\n  // JS stringifier can build scientific format without dots: 5e-100,\n  // while YAML requres dot: 5.e-100. Fix it with simple hack\n\n  return SCIENTIFIC_WITHOUT_DOT.test(res) ? res.replace('e', '.e') : res;\n}\n\nfunction isFloat(object) {\n  return (Object.prototype.toString.call(object) === '[object Number]') &&\n         (object % 1 !== 0 || common.isNegativeZero(object));\n}\n\nvar float = new type('tag:yaml.org,2002:float', {\n  kind: 'scalar',\n  resolve: resolveYamlFloat,\n  construct: constructYamlFloat,\n  predicate: isFloat,\n  represent: representYamlFloat,\n  defaultStyle: 'lowercase'\n});\n\nvar json = failsafe.extend({\n  implicit: [\n    _null,\n    bool,\n    int,\n    float\n  ]\n});\n\nvar core = json;\n\nvar YAML_DATE_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9])'                    + // [2] month\n  '-([0-9][0-9])$');                   // [3] day\n\nvar YAML_TIMESTAMP_REGEXP = new RegExp(\n  '^([0-9][0-9][0-9][0-9])'          + // [1] year\n  '-([0-9][0-9]?)'                   + // [2] month\n  '-([0-9][0-9]?)'                   + // [3] day\n  '(?:[Tt]|[ \\\\t]+)'                 + // ...\n  '([0-9][0-9]?)'                    + // [4] hour\n  ':([0-9][0-9])'                    + // [5] minute\n  ':([0-9][0-9])'                    + // [6] second\n  '(?:\\\\.([0-9]*))?'                 + // [7] fraction\n  '(?:[ \\\\t]*(Z|([-+])([0-9][0-9]?)' + // [8] tz [9] tz_sign [10] tz_hour\n  '(?::([0-9][0-9]))?))?$');           // [11] tz_minute\n\nfunction resolveYamlTimestamp(data) {\n  if (data === null) return false;\n  if (YAML_DATE_REGEXP.exec(data) !== null) return true;\n  if (YAML_TIMESTAMP_REGEXP.exec(data) !== null) return true;\n  return false;\n}\n\nfunction constructYamlTimestamp(data) {\n  var match, year, month, day, hour, minute, second, fraction = 0,\n      delta = null, tz_hour, tz_minute, date;\n\n  match = YAML_DATE_REGEXP.exec(data);\n  if (match === null) match = YAML_TIMESTAMP_REGEXP.exec(data);\n\n  if (match === null) throw new Error('Date resolve error');\n\n  // match: [1] year [2] month [3] day\n\n  year = +(match[1]);\n  month = +(match[2]) - 1; // JS month starts with 0\n  day = +(match[3]);\n\n  if (!match[4]) { // no hour\n    return new Date(Date.UTC(year, month, day));\n  }\n\n  // match: [4] hour [5] minute [6] second [7] fraction\n\n  hour = +(match[4]);\n  minute = +(match[5]);\n  second = +(match[6]);\n\n  if (match[7]) {\n    fraction = match[7].slice(0, 3);\n    while (fraction.length < 3) { // milli-seconds\n      fraction += '0';\n    }\n    fraction = +fraction;\n  }\n\n  // match: [8] tz [9] tz_sign [10] tz_hour [11] tz_minute\n\n  if (match[9]) {\n    tz_hour = +(match[10]);\n    tz_minute = +(match[11] || 0);\n    delta = (tz_hour * 60 + tz_minute) * 60000; // delta in mili-seconds\n    if (match[9] === '-') delta = -delta;\n  }\n\n  date = new Date(Date.UTC(year, month, day, hour, minute, second, fraction));\n\n  if (delta) date.setTime(date.getTime() - delta);\n\n  return date;\n}\n\nfunction representYamlTimestamp(object /*, style*/) {\n  return object.toISOString();\n}\n\nvar timestamp = new type('tag:yaml.org,2002:timestamp', {\n  kind: 'scalar',\n  resolve: resolveYamlTimestamp,\n  construct: constructYamlTimestamp,\n  instanceOf: Date,\n  represent: representYamlTimestamp\n});\n\nfunction resolveYamlMerge(data) {\n  return data === '<<' || data === null;\n}\n\nvar merge = new type('tag:yaml.org,2002:merge', {\n  kind: 'scalar',\n  resolve: resolveYamlMerge\n});\n\n/*eslint-disable no-bitwise*/\n\n\n\n\n\n// [ 64, 65, 66 ] -> [ padding, CR, LF ]\nvar BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\\n\\r';\n\n\nfunction resolveYamlBinary(data) {\n  if (data === null) return false;\n\n  var code, idx, bitlen = 0, max = data.length, map = BASE64_MAP;\n\n  // Convert one by one.\n  for (idx = 0; idx < max; idx++) {\n    code = map.indexOf(data.charAt(idx));\n\n    // Skip CR/LF\n    if (code > 64) continue;\n\n    // Fail on illegal characters\n    if (code < 0) return false;\n\n    bitlen += 6;\n  }\n\n  // If there are any bits left, source was corrupted\n  return (bitlen % 8) === 0;\n}\n\nfunction constructYamlBinary(data) {\n  var idx, tailbits,\n      input = data.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n      max = input.length,\n      map = BASE64_MAP,\n      bits = 0,\n      result = [];\n\n  // Collect by 6*4 bits (3 bytes)\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 4 === 0) && idx) {\n      result.push((bits >> 16) & 0xFF);\n      result.push((bits >> 8) & 0xFF);\n      result.push(bits & 0xFF);\n    }\n\n    bits = (bits << 6) | map.indexOf(input.charAt(idx));\n  }\n\n  // Dump tail\n\n  tailbits = (max % 4) * 6;\n\n  if (tailbits === 0) {\n    result.push((bits >> 16) & 0xFF);\n    result.push((bits >> 8) & 0xFF);\n    result.push(bits & 0xFF);\n  } else if (tailbits === 18) {\n    result.push((bits >> 10) & 0xFF);\n    result.push((bits >> 2) & 0xFF);\n  } else if (tailbits === 12) {\n    result.push((bits >> 4) & 0xFF);\n  }\n\n  return new Uint8Array(result);\n}\n\nfunction representYamlBinary(object /*, style*/) {\n  var result = '', bits = 0, idx, tail,\n      max = object.length,\n      map = BASE64_MAP;\n\n  // Convert every three bytes to 4 ASCII characters.\n\n  for (idx = 0; idx < max; idx++) {\n    if ((idx % 3 === 0) && idx) {\n      result += map[(bits >> 18) & 0x3F];\n      result += map[(bits >> 12) & 0x3F];\n      result += map[(bits >> 6) & 0x3F];\n      result += map[bits & 0x3F];\n    }\n\n    bits = (bits << 8) + object[idx];\n  }\n\n  // Dump tail\n\n  tail = max % 3;\n\n  if (tail === 0) {\n    result += map[(bits >> 18) & 0x3F];\n    result += map[(bits >> 12) & 0x3F];\n    result += map[(bits >> 6) & 0x3F];\n    result += map[bits & 0x3F];\n  } else if (tail === 2) {\n    result += map[(bits >> 10) & 0x3F];\n    result += map[(bits >> 4) & 0x3F];\n    result += map[(bits << 2) & 0x3F];\n    result += map[64];\n  } else if (tail === 1) {\n    result += map[(bits >> 2) & 0x3F];\n    result += map[(bits << 4) & 0x3F];\n    result += map[64];\n    result += map[64];\n  }\n\n  return result;\n}\n\nfunction isBinary(obj) {\n  return Object.prototype.toString.call(obj) ===  '[object Uint8Array]';\n}\n\nvar binary = new type('tag:yaml.org,2002:binary', {\n  kind: 'scalar',\n  resolve: resolveYamlBinary,\n  construct: constructYamlBinary,\n  predicate: isBinary,\n  represent: representYamlBinary\n});\n\nvar _hasOwnProperty$3 = Object.prototype.hasOwnProperty;\nvar _toString$2       = Object.prototype.toString;\n\nfunction resolveYamlOmap(data) {\n  if (data === null) return true;\n\n  var objectKeys = [], index, length, pair, pairKey, pairHasKey,\n      object = data;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n    pairHasKey = false;\n\n    if (_toString$2.call(pair) !== '[object Object]') return false;\n\n    for (pairKey in pair) {\n      if (_hasOwnProperty$3.call(pair, pairKey)) {\n        if (!pairHasKey) pairHasKey = true;\n        else return false;\n      }\n    }\n\n    if (!pairHasKey) return false;\n\n    if (objectKeys.indexOf(pairKey) === -1) objectKeys.push(pairKey);\n    else return false;\n  }\n\n  return true;\n}\n\nfunction constructYamlOmap(data) {\n  return data !== null ? data : [];\n}\n\nvar omap = new type('tag:yaml.org,2002:omap', {\n  kind: 'sequence',\n  resolve: resolveYamlOmap,\n  construct: constructYamlOmap\n});\n\nvar _toString$1 = Object.prototype.toString;\n\nfunction resolveYamlPairs(data) {\n  if (data === null) return true;\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    if (_toString$1.call(pair) !== '[object Object]') return false;\n\n    keys = Object.keys(pair);\n\n    if (keys.length !== 1) return false;\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return true;\n}\n\nfunction constructYamlPairs(data) {\n  if (data === null) return [];\n\n  var index, length, pair, keys, result,\n      object = data;\n\n  result = new Array(object.length);\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    pair = object[index];\n\n    keys = Object.keys(pair);\n\n    result[index] = [ keys[0], pair[keys[0]] ];\n  }\n\n  return result;\n}\n\nvar pairs = new type('tag:yaml.org,2002:pairs', {\n  kind: 'sequence',\n  resolve: resolveYamlPairs,\n  construct: constructYamlPairs\n});\n\nvar _hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n\nfunction resolveYamlSet(data) {\n  if (data === null) return true;\n\n  var key, object = data;\n\n  for (key in object) {\n    if (_hasOwnProperty$2.call(object, key)) {\n      if (object[key] !== null) return false;\n    }\n  }\n\n  return true;\n}\n\nfunction constructYamlSet(data) {\n  return data !== null ? data : {};\n}\n\nvar set = new type('tag:yaml.org,2002:set', {\n  kind: 'mapping',\n  resolve: resolveYamlSet,\n  construct: constructYamlSet\n});\n\nvar _default = core.extend({\n  implicit: [\n    timestamp,\n    merge\n  ],\n  explicit: [\n    binary,\n    omap,\n    pairs,\n    set\n  ]\n});\n\n/*eslint-disable max-len,no-use-before-define*/\n\n\n\n\n\n\n\nvar _hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n\n\nvar CONTEXT_FLOW_IN   = 1;\nvar CONTEXT_FLOW_OUT  = 2;\nvar CONTEXT_BLOCK_IN  = 3;\nvar CONTEXT_BLOCK_OUT = 4;\n\n\nvar CHOMPING_CLIP  = 1;\nvar CHOMPING_STRIP = 2;\nvar CHOMPING_KEEP  = 3;\n\n\nvar PATTERN_NON_PRINTABLE         = /[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x84\\x86-\\x9F\\uFFFE\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/;\nvar PATTERN_NON_ASCII_LINE_BREAKS = /[\\x85\\u2028\\u2029]/;\nvar PATTERN_FLOW_INDICATORS       = /[,\\[\\]\\{\\}]/;\nvar PATTERN_TAG_HANDLE            = /^(?:!|!!|![a-z\\-]+!)$/i;\nvar PATTERN_TAG_URI               = /^(?:!|[^,\\[\\]\\{\\}])(?:%[0-9a-f]{2}|[0-9a-z\\-#;\\/\\?:@&=\\+\\$,_\\.!~\\*'\\(\\)\\[\\]])*$/i;\n\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\n\nfunction is_EOL(c) {\n  return (c === 0x0A/* LF */) || (c === 0x0D/* CR */);\n}\n\nfunction is_WHITE_SPACE(c) {\n  return (c === 0x09/* Tab */) || (c === 0x20/* Space */);\n}\n\nfunction is_WS_OR_EOL(c) {\n  return (c === 0x09/* Tab */) ||\n         (c === 0x20/* Space */) ||\n         (c === 0x0A/* LF */) ||\n         (c === 0x0D/* CR */);\n}\n\nfunction is_FLOW_INDICATOR(c) {\n  return c === 0x2C/* , */ ||\n         c === 0x5B/* [ */ ||\n         c === 0x5D/* ] */ ||\n         c === 0x7B/* { */ ||\n         c === 0x7D/* } */;\n}\n\nfunction fromHexCode(c) {\n  var lc;\n\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  /*eslint-disable no-bitwise*/\n  lc = c | 0x20;\n\n  if ((0x61/* a */ <= lc) && (lc <= 0x66/* f */)) {\n    return lc - 0x61 + 10;\n  }\n\n  return -1;\n}\n\nfunction escapedHexLen(c) {\n  if (c === 0x78/* x */) { return 2; }\n  if (c === 0x75/* u */) { return 4; }\n  if (c === 0x55/* U */) { return 8; }\n  return 0;\n}\n\nfunction fromDecimalCode(c) {\n  if ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n    return c - 0x30;\n  }\n\n  return -1;\n}\n\nfunction simpleEscapeSequence(c) {\n  /* eslint-disable indent */\n  return (c === 0x30/* 0 */) ? '\\x00' :\n        (c === 0x61/* a */) ? '\\x07' :\n        (c === 0x62/* b */) ? '\\x08' :\n        (c === 0x74/* t */) ? '\\x09' :\n        (c === 0x09/* Tab */) ? '\\x09' :\n        (c === 0x6E/* n */) ? '\\x0A' :\n        (c === 0x76/* v */) ? '\\x0B' :\n        (c === 0x66/* f */) ? '\\x0C' :\n        (c === 0x72/* r */) ? '\\x0D' :\n        (c === 0x65/* e */) ? '\\x1B' :\n        (c === 0x20/* Space */) ? ' ' :\n        (c === 0x22/* \" */) ? '\\x22' :\n        (c === 0x2F/* / */) ? '/' :\n        (c === 0x5C/* \\ */) ? '\\x5C' :\n        (c === 0x4E/* N */) ? '\\x85' :\n        (c === 0x5F/* _ */) ? '\\xA0' :\n        (c === 0x4C/* L */) ? '\\u2028' :\n        (c === 0x50/* P */) ? '\\u2029' : '';\n}\n\nfunction charFromCodepoint(c) {\n  if (c <= 0xFFFF) {\n    return String.fromCharCode(c);\n  }\n  // Encode UTF-16 surrogate pair\n  // https://en.wikipedia.org/wiki/UTF-16#Code_points_U.2B010000_to_U.2B10FFFF\n  return String.fromCharCode(\n    ((c - 0x010000) >> 10) + 0xD800,\n    ((c - 0x010000) & 0x03FF) + 0xDC00\n  );\n}\n\nvar simpleEscapeCheck = new Array(256); // integer, for fast access\nvar simpleEscapeMap = new Array(256);\nfor (var i = 0; i < 256; i++) {\n  simpleEscapeCheck[i] = simpleEscapeSequence(i) ? 1 : 0;\n  simpleEscapeMap[i] = simpleEscapeSequence(i);\n}\n\n\nfunction State$1(input, options) {\n  this.input = input;\n\n  this.filename  = options['filename']  || null;\n  this.schema    = options['schema']    || _default;\n  this.onWarning = options['onWarning'] || null;\n  // (Hidden) Remove? makes the loader to expect YAML 1.1 documents\n  // if such documents have no explicit %YAML directive\n  this.legacy    = options['legacy']    || false;\n\n  this.json      = options['json']      || false;\n  this.listener  = options['listener']  || null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.typeMap       = this.schema.compiledTypeMap;\n\n  this.length     = input.length;\n  this.position   = 0;\n  this.line       = 0;\n  this.lineStart  = 0;\n  this.lineIndent = 0;\n\n  // position of first leading tab in the current line,\n  // used to make sure there are no tabs in the indentation\n  this.firstTabInLine = -1;\n\n  this.documents = [];\n\n  /*\n  this.version;\n  this.checkLineBreaks;\n  this.tagMap;\n  this.anchorMap;\n  this.tag;\n  this.anchor;\n  this.kind;\n  this.result;*/\n\n}\n\n\nfunction generateError(state, message) {\n  var mark = {\n    name:     state.filename,\n    buffer:   state.input.slice(0, -1), // omit trailing \\0\n    position: state.position,\n    line:     state.line,\n    column:   state.position - state.lineStart\n  };\n\n  mark.snippet = snippet(mark);\n\n  return new exception(message, mark);\n}\n\nfunction throwError(state, message) {\n  throw generateError(state, message);\n}\n\nfunction throwWarning(state, message) {\n  if (state.onWarning) {\n    state.onWarning.call(null, generateError(state, message));\n  }\n}\n\n\nvar directiveHandlers = {\n\n  YAML: function handleYamlDirective(state, name, args) {\n\n    var match, major, minor;\n\n    if (state.version !== null) {\n      throwError(state, 'duplication of %YAML directive');\n    }\n\n    if (args.length !== 1) {\n      throwError(state, 'YAML directive accepts exactly one argument');\n    }\n\n    match = /^([0-9]+)\\.([0-9]+)$/.exec(args[0]);\n\n    if (match === null) {\n      throwError(state, 'ill-formed argument of the YAML directive');\n    }\n\n    major = parseInt(match[1], 10);\n    minor = parseInt(match[2], 10);\n\n    if (major !== 1) {\n      throwError(state, 'unacceptable YAML version of the document');\n    }\n\n    state.version = args[0];\n    state.checkLineBreaks = (minor < 2);\n\n    if (minor !== 1 && minor !== 2) {\n      throwWarning(state, 'unsupported YAML version of the document');\n    }\n  },\n\n  TAG: function handleTagDirective(state, name, args) {\n\n    var handle, prefix;\n\n    if (args.length !== 2) {\n      throwError(state, 'TAG directive accepts exactly two arguments');\n    }\n\n    handle = args[0];\n    prefix = args[1];\n\n    if (!PATTERN_TAG_HANDLE.test(handle)) {\n      throwError(state, 'ill-formed tag handle (first argument) of the TAG directive');\n    }\n\n    if (_hasOwnProperty$1.call(state.tagMap, handle)) {\n      throwError(state, 'there is a previously declared suffix for \"' + handle + '\" tag handle');\n    }\n\n    if (!PATTERN_TAG_URI.test(prefix)) {\n      throwError(state, 'ill-formed tag prefix (second argument) of the TAG directive');\n    }\n\n    try {\n      prefix = decodeURIComponent(prefix);\n    } catch (err) {\n      throwError(state, 'tag prefix is malformed: ' + prefix);\n    }\n\n    state.tagMap[handle] = prefix;\n  }\n};\n\n\nfunction captureSegment(state, start, end, checkJson) {\n  var _position, _length, _character, _result;\n\n  if (start < end) {\n    _result = state.input.slice(start, end);\n\n    if (checkJson) {\n      for (_position = 0, _length = _result.length; _position < _length; _position += 1) {\n        _character = _result.charCodeAt(_position);\n        if (!(_character === 0x09 ||\n              (0x20 <= _character && _character <= 0x10FFFF))) {\n          throwError(state, 'expected valid JSON character');\n        }\n      }\n    } else if (PATTERN_NON_PRINTABLE.test(_result)) {\n      throwError(state, 'the stream contains non-printable characters');\n    }\n\n    state.result += _result;\n  }\n}\n\nfunction mergeMappings(state, destination, source, overridableKeys) {\n  var sourceKeys, key, index, quantity;\n\n  if (!common.isObject(source)) {\n    throwError(state, 'cannot merge mappings; the provided source object is unacceptable');\n  }\n\n  sourceKeys = Object.keys(source);\n\n  for (index = 0, quantity = sourceKeys.length; index < quantity; index += 1) {\n    key = sourceKeys[index];\n\n    if (!_hasOwnProperty$1.call(destination, key)) {\n      destination[key] = source[key];\n      overridableKeys[key] = true;\n    }\n  }\n}\n\nfunction storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode,\n  startLine, startLineStart, startPos) {\n\n  var index, quantity;\n\n  // The output is a plain object here, so keys can only be strings.\n  // We need to convert keyNode to a string, but doing so can hang the process\n  // (deeply nested arrays that explode exponentially using aliases).\n  if (Array.isArray(keyNode)) {\n    keyNode = Array.prototype.slice.call(keyNode);\n\n    for (index = 0, quantity = keyNode.length; index < quantity; index += 1) {\n      if (Array.isArray(keyNode[index])) {\n        throwError(state, 'nested arrays are not supported inside keys');\n      }\n\n      if (typeof keyNode === 'object' && _class(keyNode[index]) === '[object Object]') {\n        keyNode[index] = '[object Object]';\n      }\n    }\n  }\n\n  // Avoid code execution in load() via toString property\n  // (still use its own toString for arrays, timestamps,\n  // and whatever user schema extensions happen to have @@toStringTag)\n  if (typeof keyNode === 'object' && _class(keyNode) === '[object Object]') {\n    keyNode = '[object Object]';\n  }\n\n\n  keyNode = String(keyNode);\n\n  if (_result === null) {\n    _result = {};\n  }\n\n  if (keyTag === 'tag:yaml.org,2002:merge') {\n    if (Array.isArray(valueNode)) {\n      for (index = 0, quantity = valueNode.length; index < quantity; index += 1) {\n        mergeMappings(state, _result, valueNode[index], overridableKeys);\n      }\n    } else {\n      mergeMappings(state, _result, valueNode, overridableKeys);\n    }\n  } else {\n    if (!state.json &&\n        !_hasOwnProperty$1.call(overridableKeys, keyNode) &&\n        _hasOwnProperty$1.call(_result, keyNode)) {\n      state.line = startLine || state.line;\n      state.lineStart = startLineStart || state.lineStart;\n      state.position = startPos || state.position;\n      throwError(state, 'duplicated mapping key');\n    }\n\n    // used for this specific key only because Object.defineProperty is slow\n    if (keyNode === '__proto__') {\n      Object.defineProperty(_result, keyNode, {\n        configurable: true,\n        enumerable: true,\n        writable: true,\n        value: valueNode\n      });\n    } else {\n      _result[keyNode] = valueNode;\n    }\n    delete overridableKeys[keyNode];\n  }\n\n  return _result;\n}\n\nfunction readLineBreak(state) {\n  var ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x0A/* LF */) {\n    state.position++;\n  } else if (ch === 0x0D/* CR */) {\n    state.position++;\n    if (state.input.charCodeAt(state.position) === 0x0A/* LF */) {\n      state.position++;\n    }\n  } else {\n    throwError(state, 'a line break is expected');\n  }\n\n  state.line += 1;\n  state.lineStart = state.position;\n  state.firstTabInLine = -1;\n}\n\nfunction skipSeparationSpace(state, allowComments, checkIndent) {\n  var lineBreaks = 0,\n      ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    while (is_WHITE_SPACE(ch)) {\n      if (ch === 0x09/* Tab */ && state.firstTabInLine === -1) {\n        state.firstTabInLine = state.position;\n      }\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (allowComments && ch === 0x23/* # */) {\n      do {\n        ch = state.input.charCodeAt(++state.position);\n      } while (ch !== 0x0A/* LF */ && ch !== 0x0D/* CR */ && ch !== 0);\n    }\n\n    if (is_EOL(ch)) {\n      readLineBreak(state);\n\n      ch = state.input.charCodeAt(state.position);\n      lineBreaks++;\n      state.lineIndent = 0;\n\n      while (ch === 0x20/* Space */) {\n        state.lineIndent++;\n        ch = state.input.charCodeAt(++state.position);\n      }\n    } else {\n      break;\n    }\n  }\n\n  if (checkIndent !== -1 && lineBreaks !== 0 && state.lineIndent < checkIndent) {\n    throwWarning(state, 'deficient indentation');\n  }\n\n  return lineBreaks;\n}\n\nfunction testDocumentSeparator(state) {\n  var _position = state.position,\n      ch;\n\n  ch = state.input.charCodeAt(_position);\n\n  // Condition state.position === state.lineStart is tested\n  // in parent on each call, for efficiency. No needs to test here again.\n  if ((ch === 0x2D/* - */ || ch === 0x2E/* . */) &&\n      ch === state.input.charCodeAt(_position + 1) &&\n      ch === state.input.charCodeAt(_position + 2)) {\n\n    _position += 3;\n\n    ch = state.input.charCodeAt(_position);\n\n    if (ch === 0 || is_WS_OR_EOL(ch)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction writeFoldedLines(state, count) {\n  if (count === 1) {\n    state.result += ' ';\n  } else if (count > 1) {\n    state.result += common.repeat('\\n', count - 1);\n  }\n}\n\n\nfunction readPlainScalar(state, nodeIndent, withinFlowCollection) {\n  var preceding,\n      following,\n      captureStart,\n      captureEnd,\n      hasPendingContent,\n      _line,\n      _lineStart,\n      _lineIndent,\n      _kind = state.kind,\n      _result = state.result,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (is_WS_OR_EOL(ch)      ||\n      is_FLOW_INDICATOR(ch) ||\n      ch === 0x23/* # */    ||\n      ch === 0x26/* & */    ||\n      ch === 0x2A/* * */    ||\n      ch === 0x21/* ! */    ||\n      ch === 0x7C/* | */    ||\n      ch === 0x3E/* > */    ||\n      ch === 0x27/* ' */    ||\n      ch === 0x22/* \" */    ||\n      ch === 0x25/* % */    ||\n      ch === 0x40/* @ */    ||\n      ch === 0x60/* ` */) {\n    return false;\n  }\n\n  if (ch === 0x3F/* ? */ || ch === 0x2D/* - */) {\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (is_WS_OR_EOL(following) ||\n        withinFlowCollection && is_FLOW_INDICATOR(following)) {\n      return false;\n    }\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  captureStart = captureEnd = state.position;\n  hasPendingContent = false;\n\n  while (ch !== 0) {\n    if (ch === 0x3A/* : */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following) ||\n          withinFlowCollection && is_FLOW_INDICATOR(following)) {\n        break;\n      }\n\n    } else if (ch === 0x23/* # */) {\n      preceding = state.input.charCodeAt(state.position - 1);\n\n      if (is_WS_OR_EOL(preceding)) {\n        break;\n      }\n\n    } else if ((state.position === state.lineStart && testDocumentSeparator(state)) ||\n               withinFlowCollection && is_FLOW_INDICATOR(ch)) {\n      break;\n\n    } else if (is_EOL(ch)) {\n      _line = state.line;\n      _lineStart = state.lineStart;\n      _lineIndent = state.lineIndent;\n      skipSeparationSpace(state, false, -1);\n\n      if (state.lineIndent >= nodeIndent) {\n        hasPendingContent = true;\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      } else {\n        state.position = captureEnd;\n        state.line = _line;\n        state.lineStart = _lineStart;\n        state.lineIndent = _lineIndent;\n        break;\n      }\n    }\n\n    if (hasPendingContent) {\n      captureSegment(state, captureStart, captureEnd, false);\n      writeFoldedLines(state, state.line - _line);\n      captureStart = captureEnd = state.position;\n      hasPendingContent = false;\n    }\n\n    if (!is_WHITE_SPACE(ch)) {\n      captureEnd = state.position + 1;\n    }\n\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  captureSegment(state, captureStart, captureEnd, false);\n\n  if (state.result) {\n    return true;\n  }\n\n  state.kind = _kind;\n  state.result = _result;\n  return false;\n}\n\nfunction readSingleQuotedScalar(state, nodeIndent) {\n  var ch,\n      captureStart, captureEnd;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x27/* ' */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x27/* ' */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (ch === 0x27/* ' */) {\n        captureStart = state.position;\n        state.position++;\n        captureEnd = state.position;\n      } else {\n        return true;\n      }\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a single quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a single quoted scalar');\n}\n\nfunction readDoubleQuotedScalar(state, nodeIndent) {\n  var captureStart,\n      captureEnd,\n      hexLength,\n      hexResult,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x22/* \" */) {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n  state.position++;\n  captureStart = captureEnd = state.position;\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    if (ch === 0x22/* \" */) {\n      captureSegment(state, captureStart, state.position, true);\n      state.position++;\n      return true;\n\n    } else if (ch === 0x5C/* \\ */) {\n      captureSegment(state, captureStart, state.position, true);\n      ch = state.input.charCodeAt(++state.position);\n\n      if (is_EOL(ch)) {\n        skipSeparationSpace(state, false, nodeIndent);\n\n        // TODO: rework to inline fn with no type cast?\n      } else if (ch < 256 && simpleEscapeCheck[ch]) {\n        state.result += simpleEscapeMap[ch];\n        state.position++;\n\n      } else if ((tmp = escapedHexLen(ch)) > 0) {\n        hexLength = tmp;\n        hexResult = 0;\n\n        for (; hexLength > 0; hexLength--) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if ((tmp = fromHexCode(ch)) >= 0) {\n            hexResult = (hexResult << 4) + tmp;\n\n          } else {\n            throwError(state, 'expected hexadecimal character');\n          }\n        }\n\n        state.result += charFromCodepoint(hexResult);\n\n        state.position++;\n\n      } else {\n        throwError(state, 'unknown escape sequence');\n      }\n\n      captureStart = captureEnd = state.position;\n\n    } else if (is_EOL(ch)) {\n      captureSegment(state, captureStart, captureEnd, true);\n      writeFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n      captureStart = captureEnd = state.position;\n\n    } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n      throwError(state, 'unexpected end of the document within a double quoted scalar');\n\n    } else {\n      state.position++;\n      captureEnd = state.position;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a double quoted scalar');\n}\n\nfunction readFlowCollection(state, nodeIndent) {\n  var readNext = true,\n      _line,\n      _lineStart,\n      _pos,\n      _tag     = state.tag,\n      _result,\n      _anchor  = state.anchor,\n      following,\n      terminator,\n      isPair,\n      isExplicitPair,\n      isMapping,\n      overridableKeys = Object.create(null),\n      keyNode,\n      keyTag,\n      valueNode,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x5B/* [ */) {\n    terminator = 0x5D;/* ] */\n    isMapping = false;\n    _result = [];\n  } else if (ch === 0x7B/* { */) {\n    terminator = 0x7D;/* } */\n    isMapping = true;\n    _result = {};\n  } else {\n    return false;\n  }\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  while (ch !== 0) {\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === terminator) {\n      state.position++;\n      state.tag = _tag;\n      state.anchor = _anchor;\n      state.kind = isMapping ? 'mapping' : 'sequence';\n      state.result = _result;\n      return true;\n    } else if (!readNext) {\n      throwError(state, 'missed comma between flow collection entries');\n    } else if (ch === 0x2C/* , */) {\n      // \"flow collection entries can never be completely empty\", as per YAML 1.2, section 7.4\n      throwError(state, \"expected the node content, but found ','\");\n    }\n\n    keyTag = keyNode = valueNode = null;\n    isPair = isExplicitPair = false;\n\n    if (ch === 0x3F/* ? */) {\n      following = state.input.charCodeAt(state.position + 1);\n\n      if (is_WS_OR_EOL(following)) {\n        isPair = isExplicitPair = true;\n        state.position++;\n        skipSeparationSpace(state, true, nodeIndent);\n      }\n    }\n\n    _line = state.line; // Save the current line.\n    _lineStart = state.lineStart;\n    _pos = state.position;\n    composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n    keyTag = state.tag;\n    keyNode = state.result;\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((isExplicitPair || state.line === _line) && ch === 0x3A/* : */) {\n      isPair = true;\n      ch = state.input.charCodeAt(++state.position);\n      skipSeparationSpace(state, true, nodeIndent);\n      composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n      valueNode = state.result;\n    }\n\n    if (isMapping) {\n      storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos);\n    } else if (isPair) {\n      _result.push(storeMappingPair(state, null, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos));\n    } else {\n      _result.push(keyNode);\n    }\n\n    skipSeparationSpace(state, true, nodeIndent);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (ch === 0x2C/* , */) {\n      readNext = true;\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      readNext = false;\n    }\n  }\n\n  throwError(state, 'unexpected end of the stream within a flow collection');\n}\n\nfunction readBlockScalar(state, nodeIndent) {\n  var captureStart,\n      folding,\n      chomping       = CHOMPING_CLIP,\n      didReadContent = false,\n      detectedIndent = false,\n      textIndent     = nodeIndent,\n      emptyLines     = 0,\n      atMoreIndented = false,\n      tmp,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch === 0x7C/* | */) {\n    folding = false;\n  } else if (ch === 0x3E/* > */) {\n    folding = true;\n  } else {\n    return false;\n  }\n\n  state.kind = 'scalar';\n  state.result = '';\n\n  while (ch !== 0) {\n    ch = state.input.charCodeAt(++state.position);\n\n    if (ch === 0x2B/* + */ || ch === 0x2D/* - */) {\n      if (CHOMPING_CLIP === chomping) {\n        chomping = (ch === 0x2B/* + */) ? CHOMPING_KEEP : CHOMPING_STRIP;\n      } else {\n        throwError(state, 'repeat of a chomping mode identifier');\n      }\n\n    } else if ((tmp = fromDecimalCode(ch)) >= 0) {\n      if (tmp === 0) {\n        throwError(state, 'bad explicit indentation width of a block scalar; it cannot be less than one');\n      } else if (!detectedIndent) {\n        textIndent = nodeIndent + tmp - 1;\n        detectedIndent = true;\n      } else {\n        throwError(state, 'repeat of an indentation width identifier');\n      }\n\n    } else {\n      break;\n    }\n  }\n\n  if (is_WHITE_SPACE(ch)) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (is_WHITE_SPACE(ch));\n\n    if (ch === 0x23/* # */) {\n      do { ch = state.input.charCodeAt(++state.position); }\n      while (!is_EOL(ch) && (ch !== 0));\n    }\n  }\n\n  while (ch !== 0) {\n    readLineBreak(state);\n    state.lineIndent = 0;\n\n    ch = state.input.charCodeAt(state.position);\n\n    while ((!detectedIndent || state.lineIndent < textIndent) &&\n           (ch === 0x20/* Space */)) {\n      state.lineIndent++;\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    if (!detectedIndent && state.lineIndent > textIndent) {\n      textIndent = state.lineIndent;\n    }\n\n    if (is_EOL(ch)) {\n      emptyLines++;\n      continue;\n    }\n\n    // End of the scalar.\n    if (state.lineIndent < textIndent) {\n\n      // Perform the chomping.\n      if (chomping === CHOMPING_KEEP) {\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n      } else if (chomping === CHOMPING_CLIP) {\n        if (didReadContent) { // i.e. only if the scalar is not empty.\n          state.result += '\\n';\n        }\n      }\n\n      // Break this `while` cycle and go to the funciton's epilogue.\n      break;\n    }\n\n    // Folded style: use fancy rules to handle line breaks.\n    if (folding) {\n\n      // Lines starting with white space characters (more-indented lines) are not folded.\n      if (is_WHITE_SPACE(ch)) {\n        atMoreIndented = true;\n        // except for the first content line (cf. Example 8.1)\n        state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n\n      // End of more-indented block.\n      } else if (atMoreIndented) {\n        atMoreIndented = false;\n        state.result += common.repeat('\\n', emptyLines + 1);\n\n      // Just one line break - perceive as the same line.\n      } else if (emptyLines === 0) {\n        if (didReadContent) { // i.e. only if we have already read some scalar content.\n          state.result += ' ';\n        }\n\n      // Several line breaks - perceive as different lines.\n      } else {\n        state.result += common.repeat('\\n', emptyLines);\n      }\n\n    // Literal style: just add exact number of line breaks between content lines.\n    } else {\n      // Keep all line breaks except the header line break.\n      state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n    }\n\n    didReadContent = true;\n    detectedIndent = true;\n    emptyLines = 0;\n    captureStart = state.position;\n\n    while (!is_EOL(ch) && (ch !== 0)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    captureSegment(state, captureStart, state.position, false);\n  }\n\n  return true;\n}\n\nfunction readBlockSequence(state, nodeIndent) {\n  var _line,\n      _tag      = state.tag,\n      _anchor   = state.anchor,\n      _result   = [],\n      following,\n      detected  = false,\n      ch;\n\n  // there is a leading tab before this token, so it can't be a block sequence/mapping;\n  // it can still be flow sequence/mapping or a scalar\n  if (state.firstTabInLine !== -1) return false;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    if (state.firstTabInLine !== -1) {\n      state.position = state.firstTabInLine;\n      throwError(state, 'tab characters must not be used in indentation');\n    }\n\n    if (ch !== 0x2D/* - */) {\n      break;\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n\n    if (!is_WS_OR_EOL(following)) {\n      break;\n    }\n\n    detected = true;\n    state.position++;\n\n    if (skipSeparationSpace(state, true, -1)) {\n      if (state.lineIndent <= nodeIndent) {\n        _result.push(null);\n        ch = state.input.charCodeAt(state.position);\n        continue;\n      }\n    }\n\n    _line = state.line;\n    composeNode(state, nodeIndent, CONTEXT_BLOCK_IN, false, true);\n    _result.push(state.result);\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a sequence entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'sequence';\n    state.result = _result;\n    return true;\n  }\n  return false;\n}\n\nfunction readBlockMapping(state, nodeIndent, flowIndent) {\n  var following,\n      allowCompact,\n      _line,\n      _keyLine,\n      _keyLineStart,\n      _keyPos,\n      _tag          = state.tag,\n      _anchor       = state.anchor,\n      _result       = {},\n      overridableKeys = Object.create(null),\n      keyTag        = null,\n      keyNode       = null,\n      valueNode     = null,\n      atExplicitKey = false,\n      detected      = false,\n      ch;\n\n  // there is a leading tab before this token, so it can't be a block sequence/mapping;\n  // it can still be flow sequence/mapping or a scalar\n  if (state.firstTabInLine !== -1) return false;\n\n  if (state.anchor !== null) {\n    state.anchorMap[state.anchor] = _result;\n  }\n\n  ch = state.input.charCodeAt(state.position);\n\n  while (ch !== 0) {\n    if (!atExplicitKey && state.firstTabInLine !== -1) {\n      state.position = state.firstTabInLine;\n      throwError(state, 'tab characters must not be used in indentation');\n    }\n\n    following = state.input.charCodeAt(state.position + 1);\n    _line = state.line; // Save the current line.\n\n    //\n    // Explicit notation case. There are two separate blocks:\n    // first for the key (denoted by \"?\") and second for the value (denoted by \":\")\n    //\n    if ((ch === 0x3F/* ? */ || ch === 0x3A/* : */) && is_WS_OR_EOL(following)) {\n\n      if (ch === 0x3F/* ? */) {\n        if (atExplicitKey) {\n          storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n          keyTag = keyNode = valueNode = null;\n        }\n\n        detected = true;\n        atExplicitKey = true;\n        allowCompact = true;\n\n      } else if (atExplicitKey) {\n        // i.e. 0x3A/* : */ === character after the explicit key.\n        atExplicitKey = false;\n        allowCompact = true;\n\n      } else {\n        throwError(state, 'incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line');\n      }\n\n      state.position += 1;\n      ch = following;\n\n    //\n    // Implicit notation case. Flow-style node as the key first, then \":\", and the value.\n    //\n    } else {\n      _keyLine = state.line;\n      _keyLineStart = state.lineStart;\n      _keyPos = state.position;\n\n      if (!composeNode(state, flowIndent, CONTEXT_FLOW_OUT, false, true)) {\n        // Neither implicit nor explicit notation.\n        // Reading is done. Go to the epilogue.\n        break;\n      }\n\n      if (state.line === _line) {\n        ch = state.input.charCodeAt(state.position);\n\n        while (is_WHITE_SPACE(ch)) {\n          ch = state.input.charCodeAt(++state.position);\n        }\n\n        if (ch === 0x3A/* : */) {\n          ch = state.input.charCodeAt(++state.position);\n\n          if (!is_WS_OR_EOL(ch)) {\n            throwError(state, 'a whitespace character is expected after the key-value separator within a block mapping');\n          }\n\n          if (atExplicitKey) {\n            storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n            keyTag = keyNode = valueNode = null;\n          }\n\n          detected = true;\n          atExplicitKey = false;\n          allowCompact = false;\n          keyTag = state.tag;\n          keyNode = state.result;\n\n        } else if (detected) {\n          throwError(state, 'can not read an implicit mapping pair; a colon is missed');\n\n        } else {\n          state.tag = _tag;\n          state.anchor = _anchor;\n          return true; // Keep the result of `composeNode`.\n        }\n\n      } else if (detected) {\n        throwError(state, 'can not read a block mapping entry; a multiline key may not be an implicit key');\n\n      } else {\n        state.tag = _tag;\n        state.anchor = _anchor;\n        return true; // Keep the result of `composeNode`.\n      }\n    }\n\n    //\n    // Common reading code for both explicit and implicit notations.\n    //\n    if (state.line === _line || state.lineIndent > nodeIndent) {\n      if (atExplicitKey) {\n        _keyLine = state.line;\n        _keyLineStart = state.lineStart;\n        _keyPos = state.position;\n      }\n\n      if (composeNode(state, nodeIndent, CONTEXT_BLOCK_OUT, true, allowCompact)) {\n        if (atExplicitKey) {\n          keyNode = state.result;\n        } else {\n          valueNode = state.result;\n        }\n      }\n\n      if (!atExplicitKey) {\n        storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _keyLine, _keyLineStart, _keyPos);\n        keyTag = keyNode = valueNode = null;\n      }\n\n      skipSeparationSpace(state, true, -1);\n      ch = state.input.charCodeAt(state.position);\n    }\n\n    if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n      throwError(state, 'bad indentation of a mapping entry');\n    } else if (state.lineIndent < nodeIndent) {\n      break;\n    }\n  }\n\n  //\n  // Epilogue.\n  //\n\n  // Special case: last mapping's node contains only the key in explicit notation.\n  if (atExplicitKey) {\n    storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n  }\n\n  // Expose the resulting mapping.\n  if (detected) {\n    state.tag = _tag;\n    state.anchor = _anchor;\n    state.kind = 'mapping';\n    state.result = _result;\n  }\n\n  return detected;\n}\n\nfunction readTagProperty(state) {\n  var _position,\n      isVerbatim = false,\n      isNamed    = false,\n      tagHandle,\n      tagName,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x21/* ! */) return false;\n\n  if (state.tag !== null) {\n    throwError(state, 'duplication of a tag property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n\n  if (ch === 0x3C/* < */) {\n    isVerbatim = true;\n    ch = state.input.charCodeAt(++state.position);\n\n  } else if (ch === 0x21/* ! */) {\n    isNamed = true;\n    tagHandle = '!!';\n    ch = state.input.charCodeAt(++state.position);\n\n  } else {\n    tagHandle = '!';\n  }\n\n  _position = state.position;\n\n  if (isVerbatim) {\n    do { ch = state.input.charCodeAt(++state.position); }\n    while (ch !== 0 && ch !== 0x3E/* > */);\n\n    if (state.position < state.length) {\n      tagName = state.input.slice(_position, state.position);\n      ch = state.input.charCodeAt(++state.position);\n    } else {\n      throwError(state, 'unexpected end of the stream within a verbatim tag');\n    }\n  } else {\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n\n      if (ch === 0x21/* ! */) {\n        if (!isNamed) {\n          tagHandle = state.input.slice(_position - 1, state.position + 1);\n\n          if (!PATTERN_TAG_HANDLE.test(tagHandle)) {\n            throwError(state, 'named tag handle cannot contain such characters');\n          }\n\n          isNamed = true;\n          _position = state.position + 1;\n        } else {\n          throwError(state, 'tag suffix cannot contain exclamation marks');\n        }\n      }\n\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    tagName = state.input.slice(_position, state.position);\n\n    if (PATTERN_FLOW_INDICATORS.test(tagName)) {\n      throwError(state, 'tag suffix cannot contain flow indicator characters');\n    }\n  }\n\n  if (tagName && !PATTERN_TAG_URI.test(tagName)) {\n    throwError(state, 'tag name cannot contain such characters: ' + tagName);\n  }\n\n  try {\n    tagName = decodeURIComponent(tagName);\n  } catch (err) {\n    throwError(state, 'tag name is malformed: ' + tagName);\n  }\n\n  if (isVerbatim) {\n    state.tag = tagName;\n\n  } else if (_hasOwnProperty$1.call(state.tagMap, tagHandle)) {\n    state.tag = state.tagMap[tagHandle] + tagName;\n\n  } else if (tagHandle === '!') {\n    state.tag = '!' + tagName;\n\n  } else if (tagHandle === '!!') {\n    state.tag = 'tag:yaml.org,2002:' + tagName;\n\n  } else {\n    throwError(state, 'undeclared tag handle \"' + tagHandle + '\"');\n  }\n\n  return true;\n}\n\nfunction readAnchorProperty(state) {\n  var _position,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x26/* & */) return false;\n\n  if (state.anchor !== null) {\n    throwError(state, 'duplication of an anchor property');\n  }\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an anchor node must contain at least one character');\n  }\n\n  state.anchor = state.input.slice(_position, state.position);\n  return true;\n}\n\nfunction readAlias(state) {\n  var _position, alias,\n      ch;\n\n  ch = state.input.charCodeAt(state.position);\n\n  if (ch !== 0x2A/* * */) return false;\n\n  ch = state.input.charCodeAt(++state.position);\n  _position = state.position;\n\n  while (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n    ch = state.input.charCodeAt(++state.position);\n  }\n\n  if (state.position === _position) {\n    throwError(state, 'name of an alias node must contain at least one character');\n  }\n\n  alias = state.input.slice(_position, state.position);\n\n  if (!_hasOwnProperty$1.call(state.anchorMap, alias)) {\n    throwError(state, 'unidentified alias \"' + alias + '\"');\n  }\n\n  state.result = state.anchorMap[alias];\n  skipSeparationSpace(state, true, -1);\n  return true;\n}\n\nfunction composeNode(state, parentIndent, nodeContext, allowToSeek, allowCompact) {\n  var allowBlockStyles,\n      allowBlockScalars,\n      allowBlockCollections,\n      indentStatus = 1, // 1: this>parent, 0: this=parent, -1: this<parent\n      atNewLine  = false,\n      hasContent = false,\n      typeIndex,\n      typeQuantity,\n      typeList,\n      type,\n      flowIndent,\n      blockIndent;\n\n  if (state.listener !== null) {\n    state.listener('open', state);\n  }\n\n  state.tag    = null;\n  state.anchor = null;\n  state.kind   = null;\n  state.result = null;\n\n  allowBlockStyles = allowBlockScalars = allowBlockCollections =\n    CONTEXT_BLOCK_OUT === nodeContext ||\n    CONTEXT_BLOCK_IN  === nodeContext;\n\n  if (allowToSeek) {\n    if (skipSeparationSpace(state, true, -1)) {\n      atNewLine = true;\n\n      if (state.lineIndent > parentIndent) {\n        indentStatus = 1;\n      } else if (state.lineIndent === parentIndent) {\n        indentStatus = 0;\n      } else if (state.lineIndent < parentIndent) {\n        indentStatus = -1;\n      }\n    }\n  }\n\n  if (indentStatus === 1) {\n    while (readTagProperty(state) || readAnchorProperty(state)) {\n      if (skipSeparationSpace(state, true, -1)) {\n        atNewLine = true;\n        allowBlockCollections = allowBlockStyles;\n\n        if (state.lineIndent > parentIndent) {\n          indentStatus = 1;\n        } else if (state.lineIndent === parentIndent) {\n          indentStatus = 0;\n        } else if (state.lineIndent < parentIndent) {\n          indentStatus = -1;\n        }\n      } else {\n        allowBlockCollections = false;\n      }\n    }\n  }\n\n  if (allowBlockCollections) {\n    allowBlockCollections = atNewLine || allowCompact;\n  }\n\n  if (indentStatus === 1 || CONTEXT_BLOCK_OUT === nodeContext) {\n    if (CONTEXT_FLOW_IN === nodeContext || CONTEXT_FLOW_OUT === nodeContext) {\n      flowIndent = parentIndent;\n    } else {\n      flowIndent = parentIndent + 1;\n    }\n\n    blockIndent = state.position - state.lineStart;\n\n    if (indentStatus === 1) {\n      if (allowBlockCollections &&\n          (readBlockSequence(state, blockIndent) ||\n           readBlockMapping(state, blockIndent, flowIndent)) ||\n          readFlowCollection(state, flowIndent)) {\n        hasContent = true;\n      } else {\n        if ((allowBlockScalars && readBlockScalar(state, flowIndent)) ||\n            readSingleQuotedScalar(state, flowIndent) ||\n            readDoubleQuotedScalar(state, flowIndent)) {\n          hasContent = true;\n\n        } else if (readAlias(state)) {\n          hasContent = true;\n\n          if (state.tag !== null || state.anchor !== null) {\n            throwError(state, 'alias node should not have any properties');\n          }\n\n        } else if (readPlainScalar(state, flowIndent, CONTEXT_FLOW_IN === nodeContext)) {\n          hasContent = true;\n\n          if (state.tag === null) {\n            state.tag = '?';\n          }\n        }\n\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n      }\n    } else if (indentStatus === 0) {\n      // Special case: block sequences are allowed to have same indentation level as the parent.\n      // http://www.yaml.org/spec/1.2/spec.html#id2799784\n      hasContent = allowBlockCollections && readBlockSequence(state, blockIndent);\n    }\n  }\n\n  if (state.tag === null) {\n    if (state.anchor !== null) {\n      state.anchorMap[state.anchor] = state.result;\n    }\n\n  } else if (state.tag === '?') {\n    // Implicit resolving is not allowed for non-scalar types, and '?'\n    // non-specific tag is only automatically assigned to plain scalars.\n    //\n    // We only need to check kind conformity in case user explicitly assigns '?'\n    // tag, for example like this: \"!<?> [0]\"\n    //\n    if (state.result !== null && state.kind !== 'scalar') {\n      throwError(state, 'unacceptable node kind for !<?> tag; it should be \"scalar\", not \"' + state.kind + '\"');\n    }\n\n    for (typeIndex = 0, typeQuantity = state.implicitTypes.length; typeIndex < typeQuantity; typeIndex += 1) {\n      type = state.implicitTypes[typeIndex];\n\n      if (type.resolve(state.result)) { // `state.result` updated in resolver if matched\n        state.result = type.construct(state.result);\n        state.tag = type.tag;\n        if (state.anchor !== null) {\n          state.anchorMap[state.anchor] = state.result;\n        }\n        break;\n      }\n    }\n  } else if (state.tag !== '!') {\n    if (_hasOwnProperty$1.call(state.typeMap[state.kind || 'fallback'], state.tag)) {\n      type = state.typeMap[state.kind || 'fallback'][state.tag];\n    } else {\n      // looking for multi type\n      type = null;\n      typeList = state.typeMap.multi[state.kind || 'fallback'];\n\n      for (typeIndex = 0, typeQuantity = typeList.length; typeIndex < typeQuantity; typeIndex += 1) {\n        if (state.tag.slice(0, typeList[typeIndex].tag.length) === typeList[typeIndex].tag) {\n          type = typeList[typeIndex];\n          break;\n        }\n      }\n    }\n\n    if (!type) {\n      throwError(state, 'unknown tag !<' + state.tag + '>');\n    }\n\n    if (state.result !== null && type.kind !== state.kind) {\n      throwError(state, 'unacceptable node kind for !<' + state.tag + '> tag; it should be \"' + type.kind + '\", not \"' + state.kind + '\"');\n    }\n\n    if (!type.resolve(state.result, state.tag)) { // `state.result` updated in resolver if matched\n      throwError(state, 'cannot resolve a node with !<' + state.tag + '> explicit tag');\n    } else {\n      state.result = type.construct(state.result, state.tag);\n      if (state.anchor !== null) {\n        state.anchorMap[state.anchor] = state.result;\n      }\n    }\n  }\n\n  if (state.listener !== null) {\n    state.listener('close', state);\n  }\n  return state.tag !== null ||  state.anchor !== null || hasContent;\n}\n\nfunction readDocument(state) {\n  var documentStart = state.position,\n      _position,\n      directiveName,\n      directiveArgs,\n      hasDirectives = false,\n      ch;\n\n  state.version = null;\n  state.checkLineBreaks = state.legacy;\n  state.tagMap = Object.create(null);\n  state.anchorMap = Object.create(null);\n\n  while ((ch = state.input.charCodeAt(state.position)) !== 0) {\n    skipSeparationSpace(state, true, -1);\n\n    ch = state.input.charCodeAt(state.position);\n\n    if (state.lineIndent > 0 || ch !== 0x25/* % */) {\n      break;\n    }\n\n    hasDirectives = true;\n    ch = state.input.charCodeAt(++state.position);\n    _position = state.position;\n\n    while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n      ch = state.input.charCodeAt(++state.position);\n    }\n\n    directiveName = state.input.slice(_position, state.position);\n    directiveArgs = [];\n\n    if (directiveName.length < 1) {\n      throwError(state, 'directive name must not be less than one character in length');\n    }\n\n    while (ch !== 0) {\n      while (is_WHITE_SPACE(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      if (ch === 0x23/* # */) {\n        do { ch = state.input.charCodeAt(++state.position); }\n        while (ch !== 0 && !is_EOL(ch));\n        break;\n      }\n\n      if (is_EOL(ch)) break;\n\n      _position = state.position;\n\n      while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n        ch = state.input.charCodeAt(++state.position);\n      }\n\n      directiveArgs.push(state.input.slice(_position, state.position));\n    }\n\n    if (ch !== 0) readLineBreak(state);\n\n    if (_hasOwnProperty$1.call(directiveHandlers, directiveName)) {\n      directiveHandlers[directiveName](state, directiveName, directiveArgs);\n    } else {\n      throwWarning(state, 'unknown document directive \"' + directiveName + '\"');\n    }\n  }\n\n  skipSeparationSpace(state, true, -1);\n\n  if (state.lineIndent === 0 &&\n      state.input.charCodeAt(state.position)     === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 1) === 0x2D/* - */ &&\n      state.input.charCodeAt(state.position + 2) === 0x2D/* - */) {\n    state.position += 3;\n    skipSeparationSpace(state, true, -1);\n\n  } else if (hasDirectives) {\n    throwError(state, 'directives end mark is expected');\n  }\n\n  composeNode(state, state.lineIndent - 1, CONTEXT_BLOCK_OUT, false, true);\n  skipSeparationSpace(state, true, -1);\n\n  if (state.checkLineBreaks &&\n      PATTERN_NON_ASCII_LINE_BREAKS.test(state.input.slice(documentStart, state.position))) {\n    throwWarning(state, 'non-ASCII line breaks are interpreted as content');\n  }\n\n  state.documents.push(state.result);\n\n  if (state.position === state.lineStart && testDocumentSeparator(state)) {\n\n    if (state.input.charCodeAt(state.position) === 0x2E/* . */) {\n      state.position += 3;\n      skipSeparationSpace(state, true, -1);\n    }\n    return;\n  }\n\n  if (state.position < (state.length - 1)) {\n    throwError(state, 'end of the stream or a document separator is expected');\n  } else {\n    return;\n  }\n}\n\n\nfunction loadDocuments(input, options) {\n  input = String(input);\n  options = options || {};\n\n  if (input.length !== 0) {\n\n    // Add tailing `\\n` if not exists\n    if (input.charCodeAt(input.length - 1) !== 0x0A/* LF */ &&\n        input.charCodeAt(input.length - 1) !== 0x0D/* CR */) {\n      input += '\\n';\n    }\n\n    // Strip BOM\n    if (input.charCodeAt(0) === 0xFEFF) {\n      input = input.slice(1);\n    }\n  }\n\n  var state = new State$1(input, options);\n\n  var nullpos = input.indexOf('\\0');\n\n  if (nullpos !== -1) {\n    state.position = nullpos;\n    throwError(state, 'null byte is not allowed in input');\n  }\n\n  // Use 0 as string terminator. That significantly simplifies bounds check.\n  state.input += '\\0';\n\n  while (state.input.charCodeAt(state.position) === 0x20/* Space */) {\n    state.lineIndent += 1;\n    state.position += 1;\n  }\n\n  while (state.position < (state.length - 1)) {\n    readDocument(state);\n  }\n\n  return state.documents;\n}\n\n\nfunction loadAll$1(input, iterator, options) {\n  if (iterator !== null && typeof iterator === 'object' && typeof options === 'undefined') {\n    options = iterator;\n    iterator = null;\n  }\n\n  var documents = loadDocuments(input, options);\n\n  if (typeof iterator !== 'function') {\n    return documents;\n  }\n\n  for (var index = 0, length = documents.length; index < length; index += 1) {\n    iterator(documents[index]);\n  }\n}\n\n\nfunction load$1(input, options) {\n  var documents = loadDocuments(input, options);\n\n  if (documents.length === 0) {\n    /*eslint-disable no-undefined*/\n    return undefined;\n  } else if (documents.length === 1) {\n    return documents[0];\n  }\n  throw new exception('expected a single document in the stream, but found more');\n}\n\n\nvar loadAll_1 = loadAll$1;\nvar load_1    = load$1;\n\nvar loader = {\n\tloadAll: loadAll_1,\n\tload: load_1\n};\n\n/*eslint-disable no-use-before-define*/\n\n\n\n\n\nvar _toString       = Object.prototype.toString;\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nvar CHAR_BOM                  = 0xFEFF;\nvar CHAR_TAB                  = 0x09; /* Tab */\nvar CHAR_LINE_FEED            = 0x0A; /* LF */\nvar CHAR_CARRIAGE_RETURN      = 0x0D; /* CR */\nvar CHAR_SPACE                = 0x20; /* Space */\nvar CHAR_EXCLAMATION          = 0x21; /* ! */\nvar CHAR_DOUBLE_QUOTE         = 0x22; /* \" */\nvar CHAR_SHARP                = 0x23; /* # */\nvar CHAR_PERCENT              = 0x25; /* % */\nvar CHAR_AMPERSAND            = 0x26; /* & */\nvar CHAR_SINGLE_QUOTE         = 0x27; /* ' */\nvar CHAR_ASTERISK             = 0x2A; /* * */\nvar CHAR_COMMA                = 0x2C; /* , */\nvar CHAR_MINUS                = 0x2D; /* - */\nvar CHAR_COLON                = 0x3A; /* : */\nvar CHAR_EQUALS               = 0x3D; /* = */\nvar CHAR_GREATER_THAN         = 0x3E; /* > */\nvar CHAR_QUESTION             = 0x3F; /* ? */\nvar CHAR_COMMERCIAL_AT        = 0x40; /* @ */\nvar CHAR_LEFT_SQUARE_BRACKET  = 0x5B; /* [ */\nvar CHAR_RIGHT_SQUARE_BRACKET = 0x5D; /* ] */\nvar CHAR_GRAVE_ACCENT         = 0x60; /* ` */\nvar CHAR_LEFT_CURLY_BRACKET   = 0x7B; /* { */\nvar CHAR_VERTICAL_LINE        = 0x7C; /* | */\nvar CHAR_RIGHT_CURLY_BRACKET  = 0x7D; /* } */\n\nvar ESCAPE_SEQUENCES = {};\n\nESCAPE_SEQUENCES[0x00]   = '\\\\0';\nESCAPE_SEQUENCES[0x07]   = '\\\\a';\nESCAPE_SEQUENCES[0x08]   = '\\\\b';\nESCAPE_SEQUENCES[0x09]   = '\\\\t';\nESCAPE_SEQUENCES[0x0A]   = '\\\\n';\nESCAPE_SEQUENCES[0x0B]   = '\\\\v';\nESCAPE_SEQUENCES[0x0C]   = '\\\\f';\nESCAPE_SEQUENCES[0x0D]   = '\\\\r';\nESCAPE_SEQUENCES[0x1B]   = '\\\\e';\nESCAPE_SEQUENCES[0x22]   = '\\\\\"';\nESCAPE_SEQUENCES[0x5C]   = '\\\\\\\\';\nESCAPE_SEQUENCES[0x85]   = '\\\\N';\nESCAPE_SEQUENCES[0xA0]   = '\\\\_';\nESCAPE_SEQUENCES[0x2028] = '\\\\L';\nESCAPE_SEQUENCES[0x2029] = '\\\\P';\n\nvar DEPRECATED_BOOLEANS_SYNTAX = [\n  'y', 'Y', 'yes', 'Yes', 'YES', 'on', 'On', 'ON',\n  'n', 'N', 'no', 'No', 'NO', 'off', 'Off', 'OFF'\n];\n\nvar DEPRECATED_BASE60_SYNTAX = /^[-+]?[0-9_]+(?::[0-9_]+)+(?:\\.[0-9_]*)?$/;\n\nfunction compileStyleMap(schema, map) {\n  var result, keys, index, length, tag, style, type;\n\n  if (map === null) return {};\n\n  result = {};\n  keys = Object.keys(map);\n\n  for (index = 0, length = keys.length; index < length; index += 1) {\n    tag = keys[index];\n    style = String(map[tag]);\n\n    if (tag.slice(0, 2) === '!!') {\n      tag = 'tag:yaml.org,2002:' + tag.slice(2);\n    }\n    type = schema.compiledTypeMap['fallback'][tag];\n\n    if (type && _hasOwnProperty.call(type.styleAliases, style)) {\n      style = type.styleAliases[style];\n    }\n\n    result[tag] = style;\n  }\n\n  return result;\n}\n\nfunction encodeHex(character) {\n  var string, handle, length;\n\n  string = character.toString(16).toUpperCase();\n\n  if (character <= 0xFF) {\n    handle = 'x';\n    length = 2;\n  } else if (character <= 0xFFFF) {\n    handle = 'u';\n    length = 4;\n  } else if (character <= 0xFFFFFFFF) {\n    handle = 'U';\n    length = 8;\n  } else {\n    throw new exception('code point within a string may not be greater than 0xFFFFFFFF');\n  }\n\n  return '\\\\' + handle + common.repeat('0', length - string.length) + string;\n}\n\n\nvar QUOTING_TYPE_SINGLE = 1,\n    QUOTING_TYPE_DOUBLE = 2;\n\nfunction State(options) {\n  this.schema        = options['schema'] || _default;\n  this.indent        = Math.max(1, (options['indent'] || 2));\n  this.noArrayIndent = options['noArrayIndent'] || false;\n  this.skipInvalid   = options['skipInvalid'] || false;\n  this.flowLevel     = (common.isNothing(options['flowLevel']) ? -1 : options['flowLevel']);\n  this.styleMap      = compileStyleMap(this.schema, options['styles'] || null);\n  this.sortKeys      = options['sortKeys'] || false;\n  this.lineWidth     = options['lineWidth'] || 80;\n  this.noRefs        = options['noRefs'] || false;\n  this.noCompatMode  = options['noCompatMode'] || false;\n  this.condenseFlow  = options['condenseFlow'] || false;\n  this.quotingType   = options['quotingType'] === '\"' ? QUOTING_TYPE_DOUBLE : QUOTING_TYPE_SINGLE;\n  this.forceQuotes   = options['forceQuotes'] || false;\n  this.replacer      = typeof options['replacer'] === 'function' ? options['replacer'] : null;\n\n  this.implicitTypes = this.schema.compiledImplicit;\n  this.explicitTypes = this.schema.compiledExplicit;\n\n  this.tag = null;\n  this.result = '';\n\n  this.duplicates = [];\n  this.usedDuplicates = null;\n}\n\n// Indents every line in a string. Empty lines (\\n only) are not indented.\nfunction indentString(string, spaces) {\n  var ind = common.repeat(' ', spaces),\n      position = 0,\n      next = -1,\n      result = '',\n      line,\n      length = string.length;\n\n  while (position < length) {\n    next = string.indexOf('\\n', position);\n    if (next === -1) {\n      line = string.slice(position);\n      position = length;\n    } else {\n      line = string.slice(position, next + 1);\n      position = next + 1;\n    }\n\n    if (line.length && line !== '\\n') result += ind;\n\n    result += line;\n  }\n\n  return result;\n}\n\nfunction generateNextLine(state, level) {\n  return '\\n' + common.repeat(' ', state.indent * level);\n}\n\nfunction testImplicitResolving(state, str) {\n  var index, length, type;\n\n  for (index = 0, length = state.implicitTypes.length; index < length; index += 1) {\n    type = state.implicitTypes[index];\n\n    if (type.resolve(str)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// [33] s-white ::= s-space | s-tab\nfunction isWhitespace(c) {\n  return c === CHAR_SPACE || c === CHAR_TAB;\n}\n\n// Returns true if the character can be printed without escaping.\n// From YAML 1.2: \"any allowed characters known to be non-printable\n// should also be escaped. [However,] This isn’t mandatory\"\n// Derived from nb-char - \\t - #x85 - #xA0 - #x2028 - #x2029.\nfunction isPrintable(c) {\n  return  (0x00020 <= c && c <= 0x00007E)\n      || ((0x000A1 <= c && c <= 0x00D7FF) && c !== 0x2028 && c !== 0x2029)\n      || ((0x0E000 <= c && c <= 0x00FFFD) && c !== CHAR_BOM)\n      ||  (0x10000 <= c && c <= 0x10FFFF);\n}\n\n// [34] ns-char ::= nb-char - s-white\n// [27] nb-char ::= c-printable - b-char - c-byte-order-mark\n// [26] b-char  ::= b-line-feed | b-carriage-return\n// Including s-white (for some reason, examples doesn't match specs in this aspect)\n// ns-char ::= c-printable - b-line-feed - b-carriage-return - c-byte-order-mark\nfunction isNsCharOrWhitespace(c) {\n  return isPrintable(c)\n    && c !== CHAR_BOM\n    // - b-char\n    && c !== CHAR_CARRIAGE_RETURN\n    && c !== CHAR_LINE_FEED;\n}\n\n// [127]  ns-plain-safe(c) ::= c = flow-out  ⇒ ns-plain-safe-out\n//                             c = flow-in   ⇒ ns-plain-safe-in\n//                             c = block-key ⇒ ns-plain-safe-out\n//                             c = flow-key  ⇒ ns-plain-safe-in\n// [128] ns-plain-safe-out ::= ns-char\n// [129]  ns-plain-safe-in ::= ns-char - c-flow-indicator\n// [130]  ns-plain-char(c) ::=  ( ns-plain-safe(c) - “:” - “#” )\n//                            | ( /* An ns-char preceding */ “#” )\n//                            | ( “:” /* Followed by an ns-plain-safe(c) */ )\nfunction isPlainSafe(c, prev, inblock) {\n  var cIsNsCharOrWhitespace = isNsCharOrWhitespace(c);\n  var cIsNsChar = cIsNsCharOrWhitespace && !isWhitespace(c);\n  return (\n    // ns-plain-safe\n    inblock ? // c = flow-in\n      cIsNsCharOrWhitespace\n      : cIsNsCharOrWhitespace\n        // - c-flow-indicator\n        && c !== CHAR_COMMA\n        && c !== CHAR_LEFT_SQUARE_BRACKET\n        && c !== CHAR_RIGHT_SQUARE_BRACKET\n        && c !== CHAR_LEFT_CURLY_BRACKET\n        && c !== CHAR_RIGHT_CURLY_BRACKET\n  )\n    // ns-plain-char\n    && c !== CHAR_SHARP // false on '#'\n    && !(prev === CHAR_COLON && !cIsNsChar) // false on ': '\n    || (isNsCharOrWhitespace(prev) && !isWhitespace(prev) && c === CHAR_SHARP) // change to true on '[^ ]#'\n    || (prev === CHAR_COLON && cIsNsChar); // change to true on ':[^ ]'\n}\n\n// Simplified test for values allowed as the first character in plain style.\nfunction isPlainSafeFirst(c) {\n  // Uses a subset of ns-char - c-indicator\n  // where ns-char = nb-char - s-white.\n  // No support of ( ( “?” | “:” | “-” ) /* Followed by an ns-plain-safe(c)) */ ) part\n  return isPrintable(c) && c !== CHAR_BOM\n    && !isWhitespace(c) // - s-white\n    // - (c-indicator ::=\n    // “-” | “?” | “:” | “,” | “[” | “]” | “{” | “}”\n    && c !== CHAR_MINUS\n    && c !== CHAR_QUESTION\n    && c !== CHAR_COLON\n    && c !== CHAR_COMMA\n    && c !== CHAR_LEFT_SQUARE_BRACKET\n    && c !== CHAR_RIGHT_SQUARE_BRACKET\n    && c !== CHAR_LEFT_CURLY_BRACKET\n    && c !== CHAR_RIGHT_CURLY_BRACKET\n    // | “#” | “&” | “*” | “!” | “|” | “=” | “>” | “'” | “\"”\n    && c !== CHAR_SHARP\n    && c !== CHAR_AMPERSAND\n    && c !== CHAR_ASTERISK\n    && c !== CHAR_EXCLAMATION\n    && c !== CHAR_VERTICAL_LINE\n    && c !== CHAR_EQUALS\n    && c !== CHAR_GREATER_THAN\n    && c !== CHAR_SINGLE_QUOTE\n    && c !== CHAR_DOUBLE_QUOTE\n    // | “%” | “@” | “`”)\n    && c !== CHAR_PERCENT\n    && c !== CHAR_COMMERCIAL_AT\n    && c !== CHAR_GRAVE_ACCENT;\n}\n\n// Simplified test for values allowed as the last character in plain style.\nfunction isPlainSafeLast(c) {\n  // just not whitespace or colon, it will be checked to be plain character later\n  return !isWhitespace(c) && c !== CHAR_COLON;\n}\n\n// Same as 'string'.codePointAt(pos), but works in older browsers.\nfunction codePointAt(string, pos) {\n  var first = string.charCodeAt(pos), second;\n  if (first >= 0xD800 && first <= 0xDBFF && pos + 1 < string.length) {\n    second = string.charCodeAt(pos + 1);\n    if (second >= 0xDC00 && second <= 0xDFFF) {\n      // https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n      return (first - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n    }\n  }\n  return first;\n}\n\n// Determines whether block indentation indicator is required.\nfunction needIndentIndicator(string) {\n  var leadingSpaceRe = /^\\n* /;\n  return leadingSpaceRe.test(string);\n}\n\nvar STYLE_PLAIN   = 1,\n    STYLE_SINGLE  = 2,\n    STYLE_LITERAL = 3,\n    STYLE_FOLDED  = 4,\n    STYLE_DOUBLE  = 5;\n\n// Determines which scalar styles are possible and returns the preferred style.\n// lineWidth = -1 => no limit.\n// Pre-conditions: str.length > 0.\n// Post-conditions:\n//    STYLE_PLAIN or STYLE_SINGLE => no \\n are in the string.\n//    STYLE_LITERAL => no lines are suitable for folding (or lineWidth is -1).\n//    STYLE_FOLDED => a line > lineWidth and can be folded (and lineWidth != -1).\nfunction chooseScalarStyle(string, singleLineOnly, indentPerLevel, lineWidth,\n  testAmbiguousType, quotingType, forceQuotes, inblock) {\n\n  var i;\n  var char = 0;\n  var prevChar = null;\n  var hasLineBreak = false;\n  var hasFoldableLine = false; // only checked if shouldTrackWidth\n  var shouldTrackWidth = lineWidth !== -1;\n  var previousLineBreak = -1; // count the first line correctly\n  var plain = isPlainSafeFirst(codePointAt(string, 0))\n          && isPlainSafeLast(codePointAt(string, string.length - 1));\n\n  if (singleLineOnly || forceQuotes) {\n    // Case: no block styles.\n    // Check for disallowed characters to rule out plain and single.\n    for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n      char = codePointAt(string, i);\n      if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char, prevChar, inblock);\n      prevChar = char;\n    }\n  } else {\n    // Case: block styles permitted.\n    for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n      char = codePointAt(string, i);\n      if (char === CHAR_LINE_FEED) {\n        hasLineBreak = true;\n        // Check if any line can be folded.\n        if (shouldTrackWidth) {\n          hasFoldableLine = hasFoldableLine ||\n            // Foldable line = too long, and not more-indented.\n            (i - previousLineBreak - 1 > lineWidth &&\n             string[previousLineBreak + 1] !== ' ');\n          previousLineBreak = i;\n        }\n      } else if (!isPrintable(char)) {\n        return STYLE_DOUBLE;\n      }\n      plain = plain && isPlainSafe(char, prevChar, inblock);\n      prevChar = char;\n    }\n    // in case the end is missing a \\n\n    hasFoldableLine = hasFoldableLine || (shouldTrackWidth &&\n      (i - previousLineBreak - 1 > lineWidth &&\n       string[previousLineBreak + 1] !== ' '));\n  }\n  // Although every style can represent \\n without escaping, prefer block styles\n  // for multiline, since they're more readable and they don't add empty lines.\n  // Also prefer folding a super-long line.\n  if (!hasLineBreak && !hasFoldableLine) {\n    // Strings interpretable as another type have to be quoted;\n    // e.g. the string 'true' vs. the boolean true.\n    if (plain && !forceQuotes && !testAmbiguousType(string)) {\n      return STYLE_PLAIN;\n    }\n    return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n  }\n  // Edge case: block indentation indicator can only have one digit.\n  if (indentPerLevel > 9 && needIndentIndicator(string)) {\n    return STYLE_DOUBLE;\n  }\n  // At this point we know block styles are valid.\n  // Prefer literal style unless we want to fold.\n  if (!forceQuotes) {\n    return hasFoldableLine ? STYLE_FOLDED : STYLE_LITERAL;\n  }\n  return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n}\n\n// Note: line breaking/folding is implemented for only the folded style.\n// NB. We drop the last trailing newline (if any) of a returned block scalar\n//  since the dumper adds its own newline. This always works:\n//    • No ending newline => unaffected; already using strip \"-\" chomping.\n//    • Ending newline    => removed then restored.\n//  Importantly, this keeps the \"+\" chomp indicator from gaining an extra line.\nfunction writeScalar(state, string, level, iskey, inblock) {\n  state.dump = (function () {\n    if (string.length === 0) {\n      return state.quotingType === QUOTING_TYPE_DOUBLE ? '\"\"' : \"''\";\n    }\n    if (!state.noCompatMode) {\n      if (DEPRECATED_BOOLEANS_SYNTAX.indexOf(string) !== -1 || DEPRECATED_BASE60_SYNTAX.test(string)) {\n        return state.quotingType === QUOTING_TYPE_DOUBLE ? ('\"' + string + '\"') : (\"'\" + string + \"'\");\n      }\n    }\n\n    var indent = state.indent * Math.max(1, level); // no 0-indent scalars\n    // As indentation gets deeper, let the width decrease monotonically\n    // to the lower bound min(state.lineWidth, 40).\n    // Note that this implies\n    //  state.lineWidth ≤ 40 + state.indent: width is fixed at the lower bound.\n    //  state.lineWidth > 40 + state.indent: width decreases until the lower bound.\n    // This behaves better than a constant minimum width which disallows narrower options,\n    // or an indent threshold which causes the width to suddenly increase.\n    var lineWidth = state.lineWidth === -1\n      ? -1 : Math.max(Math.min(state.lineWidth, 40), state.lineWidth - indent);\n\n    // Without knowing if keys are implicit/explicit, assume implicit for safety.\n    var singleLineOnly = iskey\n      // No block styles in flow mode.\n      || (state.flowLevel > -1 && level >= state.flowLevel);\n    function testAmbiguity(string) {\n      return testImplicitResolving(state, string);\n    }\n\n    switch (chooseScalarStyle(string, singleLineOnly, state.indent, lineWidth,\n      testAmbiguity, state.quotingType, state.forceQuotes && !iskey, inblock)) {\n\n      case STYLE_PLAIN:\n        return string;\n      case STYLE_SINGLE:\n        return \"'\" + string.replace(/'/g, \"''\") + \"'\";\n      case STYLE_LITERAL:\n        return '|' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(string, indent));\n      case STYLE_FOLDED:\n        return '>' + blockHeader(string, state.indent)\n          + dropEndingNewline(indentString(foldString(string, lineWidth), indent));\n      case STYLE_DOUBLE:\n        return '\"' + escapeString(string) + '\"';\n      default:\n        throw new exception('impossible error: invalid scalar style');\n    }\n  }());\n}\n\n// Pre-conditions: string is valid for a block scalar, 1 <= indentPerLevel <= 9.\nfunction blockHeader(string, indentPerLevel) {\n  var indentIndicator = needIndentIndicator(string) ? String(indentPerLevel) : '';\n\n  // note the special case: the string '\\n' counts as a \"trailing\" empty line.\n  var clip =          string[string.length - 1] === '\\n';\n  var keep = clip && (string[string.length - 2] === '\\n' || string === '\\n');\n  var chomp = keep ? '+' : (clip ? '' : '-');\n\n  return indentIndicator + chomp + '\\n';\n}\n\n// (See the note for writeScalar.)\nfunction dropEndingNewline(string) {\n  return string[string.length - 1] === '\\n' ? string.slice(0, -1) : string;\n}\n\n// Note: a long line without a suitable break point will exceed the width limit.\n// Pre-conditions: every char in str isPrintable, str.length > 0, width > 0.\nfunction foldString(string, width) {\n  // In folded style, $k$ consecutive newlines output as $k+1$ newlines—\n  // unless they're before or after a more-indented line, or at the very\n  // beginning or end, in which case $k$ maps to $k$.\n  // Therefore, parse each chunk as newline(s) followed by a content line.\n  var lineRe = /(\\n+)([^\\n]*)/g;\n\n  // first line (possibly an empty line)\n  var result = (function () {\n    var nextLF = string.indexOf('\\n');\n    nextLF = nextLF !== -1 ? nextLF : string.length;\n    lineRe.lastIndex = nextLF;\n    return foldLine(string.slice(0, nextLF), width);\n  }());\n  // If we haven't reached the first content line yet, don't add an extra \\n.\n  var prevMoreIndented = string[0] === '\\n' || string[0] === ' ';\n  var moreIndented;\n\n  // rest of the lines\n  var match;\n  while ((match = lineRe.exec(string))) {\n    var prefix = match[1], line = match[2];\n    moreIndented = (line[0] === ' ');\n    result += prefix\n      + (!prevMoreIndented && !moreIndented && line !== ''\n        ? '\\n' : '')\n      + foldLine(line, width);\n    prevMoreIndented = moreIndented;\n  }\n\n  return result;\n}\n\n// Greedy line breaking.\n// Picks the longest line under the limit each time,\n// otherwise settles for the shortest line over the limit.\n// NB. More-indented lines *cannot* be folded, as that would add an extra \\n.\nfunction foldLine(line, width) {\n  if (line === '' || line[0] === ' ') return line;\n\n  // Since a more-indented line adds a \\n, breaks can't be followed by a space.\n  var breakRe = / [^ ]/g; // note: the match index will always be <= length-2.\n  var match;\n  // start is an inclusive index. end, curr, and next are exclusive.\n  var start = 0, end, curr = 0, next = 0;\n  var result = '';\n\n  // Invariants: 0 <= start <= length-1.\n  //   0 <= curr <= next <= max(0, length-2). curr - start <= width.\n  // Inside the loop:\n  //   A match implies length >= 2, so curr and next are <= length-2.\n  while ((match = breakRe.exec(line))) {\n    next = match.index;\n    // maintain invariant: curr - start <= width\n    if (next - start > width) {\n      end = (curr > start) ? curr : next; // derive end <= length-2\n      result += '\\n' + line.slice(start, end);\n      // skip the space that was output as \\n\n      start = end + 1;                    // derive start <= length-1\n    }\n    curr = next;\n  }\n\n  // By the invariants, start <= length-1, so there is something left over.\n  // It is either the whole string or a part starting from non-whitespace.\n  result += '\\n';\n  // Insert a break if the remainder is too long and there is a break available.\n  if (line.length - start > width && curr > start) {\n    result += line.slice(start, curr) + '\\n' + line.slice(curr + 1);\n  } else {\n    result += line.slice(start);\n  }\n\n  return result.slice(1); // drop extra \\n joiner\n}\n\n// Escapes a double-quoted string.\nfunction escapeString(string) {\n  var result = '';\n  var char = 0;\n  var escapeSeq;\n\n  for (var i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n    char = codePointAt(string, i);\n    escapeSeq = ESCAPE_SEQUENCES[char];\n\n    if (!escapeSeq && isPrintable(char)) {\n      result += string[i];\n      if (char >= 0x10000) result += string[i + 1];\n    } else {\n      result += escapeSeq || encodeHex(char);\n    }\n  }\n\n  return result;\n}\n\nfunction writeFlowSequence(state, level, object) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length,\n      value;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    value = object[index];\n\n    if (state.replacer) {\n      value = state.replacer.call(object, String(index), value);\n    }\n\n    // Write only valid elements, put null instead of invalid elements.\n    if (writeNode(state, level, value, false, false) ||\n        (typeof value === 'undefined' &&\n         writeNode(state, level, null, false, false))) {\n\n      if (_result !== '') _result += ',' + (!state.condenseFlow ? ' ' : '');\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = '[' + _result + ']';\n}\n\nfunction writeBlockSequence(state, level, object, compact) {\n  var _result = '',\n      _tag    = state.tag,\n      index,\n      length,\n      value;\n\n  for (index = 0, length = object.length; index < length; index += 1) {\n    value = object[index];\n\n    if (state.replacer) {\n      value = state.replacer.call(object, String(index), value);\n    }\n\n    // Write only valid elements, put null instead of invalid elements.\n    if (writeNode(state, level + 1, value, true, true, false, true) ||\n        (typeof value === 'undefined' &&\n         writeNode(state, level + 1, null, true, true, false, true))) {\n\n      if (!compact || _result !== '') {\n        _result += generateNextLine(state, level);\n      }\n\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        _result += '-';\n      } else {\n        _result += '- ';\n      }\n\n      _result += state.dump;\n    }\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '[]'; // Empty sequence if no valid values.\n}\n\nfunction writeFlowMapping(state, level, object) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      pairBuffer;\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n\n    pairBuffer = '';\n    if (_result !== '') pairBuffer += ', ';\n\n    if (state.condenseFlow) pairBuffer += '\"';\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (state.replacer) {\n      objectValue = state.replacer.call(object, objectKey, objectValue);\n    }\n\n    if (!writeNode(state, level, objectKey, false, false)) {\n      continue; // Skip this pair because of invalid key;\n    }\n\n    if (state.dump.length > 1024) pairBuffer += '? ';\n\n    pairBuffer += state.dump + (state.condenseFlow ? '\"' : '') + ':' + (state.condenseFlow ? '' : ' ');\n\n    if (!writeNode(state, level, objectValue, false, false)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = '{' + _result + '}';\n}\n\nfunction writeBlockMapping(state, level, object, compact) {\n  var _result       = '',\n      _tag          = state.tag,\n      objectKeyList = Object.keys(object),\n      index,\n      length,\n      objectKey,\n      objectValue,\n      explicitPair,\n      pairBuffer;\n\n  // Allow sorting keys so that the output file is deterministic\n  if (state.sortKeys === true) {\n    // Default sorting\n    objectKeyList.sort();\n  } else if (typeof state.sortKeys === 'function') {\n    // Custom sort function\n    objectKeyList.sort(state.sortKeys);\n  } else if (state.sortKeys) {\n    // Something is wrong\n    throw new exception('sortKeys must be a boolean or a function');\n  }\n\n  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n    pairBuffer = '';\n\n    if (!compact || _result !== '') {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    objectKey = objectKeyList[index];\n    objectValue = object[objectKey];\n\n    if (state.replacer) {\n      objectValue = state.replacer.call(object, objectKey, objectValue);\n    }\n\n    if (!writeNode(state, level + 1, objectKey, true, true, true)) {\n      continue; // Skip this pair because of invalid key.\n    }\n\n    explicitPair = (state.tag !== null && state.tag !== '?') ||\n                   (state.dump && state.dump.length > 1024);\n\n    if (explicitPair) {\n      if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n        pairBuffer += '?';\n      } else {\n        pairBuffer += '? ';\n      }\n    }\n\n    pairBuffer += state.dump;\n\n    if (explicitPair) {\n      pairBuffer += generateNextLine(state, level);\n    }\n\n    if (!writeNode(state, level + 1, objectValue, true, explicitPair)) {\n      continue; // Skip this pair because of invalid value.\n    }\n\n    if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n      pairBuffer += ':';\n    } else {\n      pairBuffer += ': ';\n    }\n\n    pairBuffer += state.dump;\n\n    // Both key and value are valid.\n    _result += pairBuffer;\n  }\n\n  state.tag = _tag;\n  state.dump = _result || '{}'; // Empty mapping if no valid pairs.\n}\n\nfunction detectType(state, object, explicit) {\n  var _result, typeList, index, length, type, style;\n\n  typeList = explicit ? state.explicitTypes : state.implicitTypes;\n\n  for (index = 0, length = typeList.length; index < length; index += 1) {\n    type = typeList[index];\n\n    if ((type.instanceOf  || type.predicate) &&\n        (!type.instanceOf || ((typeof object === 'object') && (object instanceof type.instanceOf))) &&\n        (!type.predicate  || type.predicate(object))) {\n\n      if (explicit) {\n        if (type.multi && type.representName) {\n          state.tag = type.representName(object);\n        } else {\n          state.tag = type.tag;\n        }\n      } else {\n        state.tag = '?';\n      }\n\n      if (type.represent) {\n        style = state.styleMap[type.tag] || type.defaultStyle;\n\n        if (_toString.call(type.represent) === '[object Function]') {\n          _result = type.represent(object, style);\n        } else if (_hasOwnProperty.call(type.represent, style)) {\n          _result = type.represent[style](object, style);\n        } else {\n          throw new exception('!<' + type.tag + '> tag resolver accepts not \"' + style + '\" style');\n        }\n\n        state.dump = _result;\n      }\n\n      return true;\n    }\n  }\n\n  return false;\n}\n\n// Serializes `object` and writes it to global `result`.\n// Returns true on success, or false on invalid object.\n//\nfunction writeNode(state, level, object, block, compact, iskey, isblockseq) {\n  state.tag = null;\n  state.dump = object;\n\n  if (!detectType(state, object, false)) {\n    detectType(state, object, true);\n  }\n\n  var type = _toString.call(state.dump);\n  var inblock = block;\n  var tagStr;\n\n  if (block) {\n    block = (state.flowLevel < 0 || state.flowLevel > level);\n  }\n\n  var objectOrArray = type === '[object Object]' || type === '[object Array]',\n      duplicateIndex,\n      duplicate;\n\n  if (objectOrArray) {\n    duplicateIndex = state.duplicates.indexOf(object);\n    duplicate = duplicateIndex !== -1;\n  }\n\n  if ((state.tag !== null && state.tag !== '?') || duplicate || (state.indent !== 2 && level > 0)) {\n    compact = false;\n  }\n\n  if (duplicate && state.usedDuplicates[duplicateIndex]) {\n    state.dump = '*ref_' + duplicateIndex;\n  } else {\n    if (objectOrArray && duplicate && !state.usedDuplicates[duplicateIndex]) {\n      state.usedDuplicates[duplicateIndex] = true;\n    }\n    if (type === '[object Object]') {\n      if (block && (Object.keys(state.dump).length !== 0)) {\n        writeBlockMapping(state, level, state.dump, compact);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowMapping(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object Array]') {\n      if (block && (state.dump.length !== 0)) {\n        if (state.noArrayIndent && !isblockseq && level > 0) {\n          writeBlockSequence(state, level - 1, state.dump, compact);\n        } else {\n          writeBlockSequence(state, level, state.dump, compact);\n        }\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + state.dump;\n        }\n      } else {\n        writeFlowSequence(state, level, state.dump);\n        if (duplicate) {\n          state.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n        }\n      }\n    } else if (type === '[object String]') {\n      if (state.tag !== '?') {\n        writeScalar(state, state.dump, level, iskey, inblock);\n      }\n    } else if (type === '[object Undefined]') {\n      return false;\n    } else {\n      if (state.skipInvalid) return false;\n      throw new exception('unacceptable kind of an object to dump ' + type);\n    }\n\n    if (state.tag !== null && state.tag !== '?') {\n      // Need to encode all characters except those allowed by the spec:\n      //\n      // [35] ns-dec-digit    ::=  [#x30-#x39] /* 0-9 */\n      // [36] ns-hex-digit    ::=  ns-dec-digit\n      //                         | [#x41-#x46] /* A-F */ | [#x61-#x66] /* a-f */\n      // [37] ns-ascii-letter ::=  [#x41-#x5A] /* A-Z */ | [#x61-#x7A] /* a-z */\n      // [38] ns-word-char    ::=  ns-dec-digit | ns-ascii-letter | “-”\n      // [39] ns-uri-char     ::=  “%” ns-hex-digit ns-hex-digit | ns-word-char | “#”\n      //                         | “;” | “/” | “?” | “:” | “@” | “&” | “=” | “+” | “$” | “,”\n      //                         | “_” | “.” | “!” | “~” | “*” | “'” | “(” | “)” | “[” | “]”\n      //\n      // Also need to encode '!' because it has special meaning (end of tag prefix).\n      //\n      tagStr = encodeURI(\n        state.tag[0] === '!' ? state.tag.slice(1) : state.tag\n      ).replace(/!/g, '%21');\n\n      if (state.tag[0] === '!') {\n        tagStr = '!' + tagStr;\n      } else if (tagStr.slice(0, 18) === 'tag:yaml.org,2002:') {\n        tagStr = '!!' + tagStr.slice(18);\n      } else {\n        tagStr = '!<' + tagStr + '>';\n      }\n\n      state.dump = tagStr + ' ' + state.dump;\n    }\n  }\n\n  return true;\n}\n\nfunction getDuplicateReferences(object, state) {\n  var objects = [],\n      duplicatesIndexes = [],\n      index,\n      length;\n\n  inspectNode(object, objects, duplicatesIndexes);\n\n  for (index = 0, length = duplicatesIndexes.length; index < length; index += 1) {\n    state.duplicates.push(objects[duplicatesIndexes[index]]);\n  }\n  state.usedDuplicates = new Array(length);\n}\n\nfunction inspectNode(object, objects, duplicatesIndexes) {\n  var objectKeyList,\n      index,\n      length;\n\n  if (object !== null && typeof object === 'object') {\n    index = objects.indexOf(object);\n    if (index !== -1) {\n      if (duplicatesIndexes.indexOf(index) === -1) {\n        duplicatesIndexes.push(index);\n      }\n    } else {\n      objects.push(object);\n\n      if (Array.isArray(object)) {\n        for (index = 0, length = object.length; index < length; index += 1) {\n          inspectNode(object[index], objects, duplicatesIndexes);\n        }\n      } else {\n        objectKeyList = Object.keys(object);\n\n        for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n          inspectNode(object[objectKeyList[index]], objects, duplicatesIndexes);\n        }\n      }\n    }\n  }\n}\n\nfunction dump$1(input, options) {\n  options = options || {};\n\n  var state = new State(options);\n\n  if (!state.noRefs) getDuplicateReferences(input, state);\n\n  var value = input;\n\n  if (state.replacer) {\n    value = state.replacer.call({ '': value }, '', value);\n  }\n\n  if (writeNode(state, 0, value, true, true)) return state.dump + '\\n';\n\n  return '';\n}\n\nvar dump_1 = dump$1;\n\nvar dumper = {\n\tdump: dump_1\n};\n\nfunction renamed(from, to) {\n  return function () {\n    throw new Error('Function yaml.' + from + ' is removed in js-yaml 4. ' +\n      'Use yaml.' + to + ' instead, which is now safe by default.');\n  };\n}\n\n\nvar Type                = type;\nvar Schema              = schema;\nvar FAILSAFE_SCHEMA     = failsafe;\nvar JSON_SCHEMA         = json;\nvar CORE_SCHEMA         = core;\nvar DEFAULT_SCHEMA      = _default;\nvar load                = loader.load;\nvar loadAll             = loader.loadAll;\nvar dump                = dumper.dump;\nvar YAMLException       = exception;\n\n// Re-export all types in case user wants to create custom schema\nvar types = {\n  binary:    binary,\n  float:     float,\n  map:       map,\n  null:      _null,\n  pairs:     pairs,\n  set:       set,\n  timestamp: timestamp,\n  bool:      bool,\n  int:       int,\n  merge:     merge,\n  omap:      omap,\n  seq:       seq,\n  str:       str\n};\n\n// Removed functions from JS-YAML 3.0.x\nvar safeLoad            = renamed('safeLoad', 'load');\nvar safeLoadAll         = renamed('safeLoadAll', 'loadAll');\nvar safeDump            = renamed('safeDump', 'dump');\n\nvar jsYaml = {\n\tType: Type,\n\tSchema: Schema,\n\tFAILSAFE_SCHEMA: FAILSAFE_SCHEMA,\n\tJSON_SCHEMA: JSON_SCHEMA,\n\tCORE_SCHEMA: CORE_SCHEMA,\n\tDEFAULT_SCHEMA: DEFAULT_SCHEMA,\n\tload: load,\n\tloadAll: loadAll,\n\tdump: dump,\n\tYAMLException: YAMLException,\n\ttypes: types,\n\tsafeLoad: safeLoad,\n\tsafeLoadAll: safeLoadAll,\n\tsafeDump: safeDump\n};\n\nexport default jsYaml;\nexport { CORE_SCHEMA, DEFAULT_SCHEMA, FAILSAFE_SCHEMA, JSON_SCHEMA, Schema, Type, YAMLException, dump, load, loadAll, safeDump, safeLoad, safeLoadAll, types };\n","//import * as CBLCARS from '../cb-lcars-vars.js';\nimport { cblcarsLog } from './cb-lcars-logging.js';\nimport jsyaml from 'js-yaml';\n\n// Ensure global fallback for legacy callers expecting window.jsyaml\ntry {\n  if (typeof window !== 'undefined' && !window.jsyaml) {\n    window.jsyaml = { load: jsyaml.load, dump: jsyaml.dump };\n  }\n} catch {}\n\n/**\n * Fetch YAML content from a given URL.\n * @param {string} url - The URL of the YAML file.\n * @returns {Promise<string>} - A promise that resolves to the YAML content as a string.\n */\nexport async function fetchYAML(url) {\n    try {\n        const response = await fetch(url);\n        if (response.ok) {\n            const yamlContent = await response.text();\n            //cblcarsLog.debug(`Fetched yaml file ${url}`);\n\n            return yamlContent;\n        } //else {\n          //  throw new Error(`Error fetching YAML: ${response.status} ${response.statusText}`);\n        //}\n    } catch (error) {\n        cblcarsLog.error('[fetchYAML] Error fetching YAML file ',error);\n        throw error;\n    }\n}\n\n// Function to read and parse the YAML file\nexport async function readYamlFile(url) {\n    try {\n        const response = await fetchYAML(url);\n        const jsObject = jsyaml.load(response);\n        //await cblcarsLog.info(`Processed YAML file: ${url}`);\n        //await cblcarsLog.debug(jsObject);\n        return jsObject;\n    } catch (error) {\n        cblcarsLog.error('[readYamlFile] Failed to parse YAML file',error.message);\n        throw error; // Re-throw the error after logging it\n    }\n}\n\n/**\n * Ensure the SVG cache exists on the window object.\n */\nfunction ensureSVGCache() {\n    window.cblcars = window.cblcars || {};\n    window.cblcars.msd = window.cblcars.msd || {};\n    window.cblcars.msd.svg_templates = window.cblcars.msd.svg_templates || {};\n    return window.cblcars.msd.svg_templates;\n}\n\n/**\n * Load an SVG from a URL and cache it under the given key.\n * Returns a promise that resolves to the SVG string.\n */\nexport async function loadSVGToCache(key, url) {\n    const cache = ensureSVGCache();\n    if (cache[key]) {\n        // Already cached\n        return cache[key];\n    }\n    try {\n        const response = await fetch(url);\n        if (!response.ok) {\n            cblcarsLog.error(`[loadSVGToCache] Failed to fetch SVG [${url}] for key [${key}]: ${response.status} ${response.statusText}`);\n            return undefined;\n        }\n        let svgText = await response.text();\n\n        // Find the opening <svg> tag and its attributes.\n        svgText = svgText.replace(/<svg([^>]*)>/i, (match, attributes) => {\n            // Remove existing width and height attributes.\n            let newAttributes = attributes.replace(/\\s(width|height)=[\"'][^\"']*[\"']/gi, '');\n            // Add width=\"100%\" and height=\"100%\".\n            return `<svg width=\"100%\" height=\"100%\"${newAttributes}>`;\n        });\n\n        cache[key] = svgText;\n        cblcarsLog.debug(`[loadSVGToCache] Loaded SVG [${key}] from [${url}]`);\n        return svgText;\n    } catch (error) {\n        cblcarsLog.error(`[loadSVGToCache] Error loading SVG [${key}] from [${url}]`, error);\n        return undefined;\n    }\n}\n\n/**\n * Get an SVG from the cache by key.\n */\nexport function getSVGFromCache(key) {\n    const cache = ensureSVGCache();\n    return cache[key];\n}\n\n/**\n * Preload a list of SVGs from a base path.\n * svgList: array of keys (filenames without .svg)\n * basePath: path to prepend (should end with /)\n * Returns a promise that resolves when all SVGs are loaded.\n */\nexport async function preloadSVGs(svgList, basePath) {\n    const promises = svgList.map(key => {\n        const url = `${basePath}${key}.svg`;\n        return loadSVGToCache(key, url);\n    });\n    await Promise.all(promises);\n    cblcarsLog.info(`[preloadSVGs] Preloaded SVGs: ${svgList.join(', ')} from ${basePath}`);\n}\n","import * as CBLCARS from '../cb-lcars-vars.js'\nimport { cblcarsLog } from '../utils/cb-lcars-logging.js';\n\nimport { html, css, unsafeCSS } from 'lit';\n\nimport EditorForm from 'ha-editor-formbuilder-yaml';\n\nexport class CBLCARSCardEditor extends EditorForm {\n\n    _formControls;\n    _cardType;\n\n    constructor(cardType) {\n        super();\n\n        this._formControls = {};\n        this._cardType = \"\";\n        this._cardType = cardType;\n\n        //cblcarsLog.debug(`Setting up editor for ${cardType}`);\n\n        this._initializationPromise = this._initialize();\n    }\n\n    async _initialize() {\n        try {\n            // Fetch only the relevant JSON file for this card type\n            const response = await fetch(`${CBLCARS.card_editor_uri}/${this._cardType}.json`);\n            if (!response.ok) throw new Error(`Form definition not found for card type: ${this._cardType}`);\n            const formControls = await response.json();\n            cblcarsLog.debug('Loaded formControls:', formControls);\n            this._formControls = formControls;\n\n            // Handle user styles if present\n            this._userStyles = css`${unsafeCSS((formControls.css && formControls.css.cssText) || '')}`;\n            this._mergeUserStyles = formControls?.css?.mergeUserStyles ?? true;\n\n            this.requestUpdate();\n        } catch(error) {\n            cblcarsLog.error('Error fetching editor form definition: ', error);\n        }\n    }\n\n    async setConfig(config) {\n\n        await this._initializationPromise;\n\n        super.setConfig(config);\n        this.requestUpdate();\n\n    }\n\n    render() {\n        if (!this._hass) {\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Home Assistant instance is missing.</ha-alert>`;\n        }\n\n        if (!this._config) {\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Card configuration is missing.</ha-alert>`;\n        }\n\n        if (!this._formControls) {\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Form controls are missing.</ha-alert>`;\n        }\n\n        try {\n            const formContent = this._formControls;\n            const returnForm = this.generateForm(formContent);\n            return returnForm;\n        } catch (error) {\n            cblcarsLog.error('Error rendering configuration form:', error);\n            return html`<ha-alert alert-type=\"error\" title=\"Error\">Error rendering form: ${error.message}</ha-alert>`;\n        }\n    }\n\n}\n","import { core_fonts, font_url } from '../cb-lcars-vars.js';\nimport { cblcarsLog } from './cb-lcars-logging.js';\n\n/**\n * Process card configurations to load all fonts.\n */\nexport function loadAllFontsFromConfig(config) {\n  const fonts = new Set();\n  function scan(obj) {\n    if (obj && typeof obj === 'object') {\n      for (const key in obj) {\n        if (key === 'font_family' && typeof obj[key] === 'string') {\n          fonts.add(obj[key]);\n        } else if (typeof obj[key] === 'object') {\n          scan(obj[key]);\n        }\n      }\n    }\n  }\n  scan(config);\n  fonts.forEach(font => window.cblcars.loadFont(font));\n}\n\n/**\n * Dynamically loads a CB-LCARS font based on font-family name.\n * Only loads if not already injected.\n */\nexport function loadFont(fontInput) {\n  window.cblcars._loadedFonts = window.cblcars._loadedFonts || new Set();\n\n  const fontList = fontInput.split(',').map(f =>\n    f.trim().replace(/^['\"]|['\"]$/g, '')\n  );\n\n  fontList.forEach(fontName => {\n    // If it’s a URL, inject directly\n    if (fontName.startsWith('http://') || fontName.startsWith('https://')) {\n      const href = fontName;\n      if (window.cblcars._loadedFonts.has(href)) return;\n      if (document.querySelector(`link[href=\"${href}\"]`)) {\n        window.cblcars._loadedFonts.add(href);\n        return;\n      }\n      const link = document.createElement('link');\n      link.rel = 'stylesheet';\n      link.href = href;\n      document.head.appendChild(link);\n      window.cblcars._loadedFonts.add(href);\n      cblcarsLog.info(`[loadFont] Loaded remote font from: ${href}`);\n      return;\n    }\n\n    // Else assume local CB-LCARS font\n    if (!fontName.startsWith('cb-lcars_')) return;\n\n    const href = `/hacsfiles/cb-lcars/fonts/${fontName}.css`;\n    const fontKey = fontName;\n\n    if (window.cblcars._loadedFonts.has(fontKey)) return;\n    if (document.querySelector(`link[href=\"${href}\"]`)) {\n      window.cblcars._loadedFonts.add(fontKey);\n      return;\n    }\n\n    const link = document.createElement('link');\n    link.rel = 'stylesheet';\n    link.href = href;\n    document.head.appendChild(link);\n    window.cblcars._loadedFonts.add(fontKey);\n    cblcarsLog.info(`[loadFont] Loaded local font: ${fontName}`);\n  });\n}\n\n\n/**\n * Loads all core CB-LCARS fonts using the shared dynamic loader.\n */\nexport async function loadCoreFonts() {\n  try {\n    const fonts = Array.isArray(core_fonts) ? core_fonts : [core_fonts];\n    for (const font of fonts) {\n      window.cblcars.loadFont(font);\n    }\n  } catch (error) {\n    cblcarsLog.error(`[loadCoreFonts] Failed to preload core fonts: ${error.message}`);\n  }\n}\n","function t(t,e,i,n){var r,s=arguments.length,a=s<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(s<3?r(a):s>3?r(e,i,a):r(e,i))||a);return s>3&&a&&Object.defineProperty(e,i,a),a}const e=window,i=e.ShadowRoot&&(void 0===e.ShadyCSS||e.ShadyCSS.nativeShadow)&&\"adoptedStyleSheets\"in Document.prototype&&\"replace\"in CSSStyleSheet.prototype,n=Symbol(),r=new WeakMap;class s{constructor(t,e,i){if(this._$cssResult$=!0,i!==n)throw Error(\"CSSResult is not constructable. Use `unsafeCSS` or `css` instead.\");this.cssText=t,this.t=e}get styleSheet(){let t=this.o;const e=this.t;if(i&&void 0===t){const i=void 0!==e&&1===e.length;i&&(t=r.get(e)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),i&&r.set(e,t))}return t}toString(){return this.cssText}}const a=i?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e=\"\";for(const i of t.cssRules)e+=i.cssText;return(t=>new s(\"string\"==typeof t?t:t+\"\",void 0,n))(e)})(t):t;var o;const l=window,c=l.trustedTypes,h=c?c.emptyScript:\"\",u=l.reactiveElementPolyfillSupport,d={toAttribute(t,e){switch(e){case Boolean:t=t?h:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t)}return t},fromAttribute(t,e){let i=t;switch(e){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t)}catch(t){i=null}}return i}},f=(t,e)=>e!==t&&(e==e||t==t),p={attribute:!0,type:String,converter:d,reflect:!1,hasChanged:f},m=\"finalized\";class g extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(t){var e;this.finalize(),(null!==(e=this.h)&&void 0!==e?e:this.h=[]).push(t)}static get observedAttributes(){this.finalize();const t=[];return this.elementProperties.forEach(((e,i)=>{const n=this._$Ep(i,e);void 0!==n&&(this._$Ev.set(n,i),t.push(n))})),t}static createProperty(t,e=p){if(e.state&&(e.attribute=!1),this.finalize(),this.elementProperties.set(t,e),!e.noAccessor&&!this.prototype.hasOwnProperty(t)){const i=\"symbol\"==typeof t?Symbol():\"__\"+t,n=this.getPropertyDescriptor(t,i,e);void 0!==n&&Object.defineProperty(this.prototype,t,n)}}static getPropertyDescriptor(t,e,i){return{get(){return this[e]},set(n){const r=this[t];this[e]=n,this.requestUpdate(t,r,i)},configurable:!0,enumerable:!0}}static getPropertyOptions(t){return this.elementProperties.get(t)||p}static finalize(){if(this.hasOwnProperty(m))return!1;this[m]=!0;const t=Object.getPrototypeOf(this);if(t.finalize(),void 0!==t.h&&(this.h=[...t.h]),this.elementProperties=new Map(t.elementProperties),this._$Ev=new Map,this.hasOwnProperty(\"properties\")){const t=this.properties,e=[...Object.getOwnPropertyNames(t),...Object.getOwnPropertySymbols(t)];for(const i of e)this.createProperty(i,t[i])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(t){const e=[];if(Array.isArray(t)){const i=new Set(t.flat(1/0).reverse());for(const t of i)e.unshift(a(t))}else void 0!==t&&e.push(a(t));return e}static _$Ep(t,e){const i=e.attribute;return!1===i?void 0:\"string\"==typeof i?i:\"string\"==typeof t?t.toLowerCase():void 0}u(){var t;this._$E_=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(t=this.constructor.h)||void 0===t||t.forEach((t=>t(this)))}addController(t){var e,i;(null!==(e=this._$ES)&&void 0!==e?e:this._$ES=[]).push(t),void 0!==this.renderRoot&&this.isConnected&&(null===(i=t.hostConnected)||void 0===i||i.call(t))}removeController(t){var e;null===(e=this._$ES)||void 0===e||e.splice(this._$ES.indexOf(t)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((t,e)=>{this.hasOwnProperty(e)&&(this._$Ei.set(e,this[e]),delete this[e])}))}createRenderRoot(){var t;const n=null!==(t=this.shadowRoot)&&void 0!==t?t:this.attachShadow(this.constructor.shadowRootOptions);return((t,n)=>{i?t.adoptedStyleSheets=n.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet)):n.forEach((i=>{const n=document.createElement(\"style\"),r=e.litNonce;void 0!==r&&n.setAttribute(\"nonce\",r),n.textContent=i.cssText,t.appendChild(n)}))})(n,this.constructor.elementStyles),n}connectedCallback(){var t;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostConnected)||void 0===e?void 0:e.call(t)}))}enableUpdating(t){}disconnectedCallback(){var t;null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostDisconnected)||void 0===e?void 0:e.call(t)}))}attributeChangedCallback(t,e,i){this._$AK(t,i)}_$EO(t,e,i=p){var n;const r=this.constructor._$Ep(t,i);if(void 0!==r&&!0===i.reflect){const s=(void 0!==(null===(n=i.converter)||void 0===n?void 0:n.toAttribute)?i.converter:d).toAttribute(e,i.type);this._$El=t,null==s?this.removeAttribute(r):this.setAttribute(r,s),this._$El=null}}_$AK(t,e){var i;const n=this.constructor,r=n._$Ev.get(t);if(void 0!==r&&this._$El!==r){const t=n.getPropertyOptions(r),s=\"function\"==typeof t.converter?{fromAttribute:t.converter}:void 0!==(null===(i=t.converter)||void 0===i?void 0:i.fromAttribute)?t.converter:d;this._$El=r,this[r]=s.fromAttribute(e,t.type),this._$El=null}}requestUpdate(t,e,i){let n=!0;void 0!==t&&(((i=i||this.constructor.getPropertyOptions(t)).hasChanged||f)(this[t],e)?(this._$AL.has(t)||this._$AL.set(t,e),!0===i.reflect&&this._$El!==t&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(t,i))):n=!1),!this.isUpdatePending&&n&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(t){Promise.reject(t)}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var t;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((t,e)=>this[e]=t)),this._$Ei=void 0);let e=!1;const i=this._$AL;try{e=this.shouldUpdate(i),e?(this.willUpdate(i),null===(t=this._$ES)||void 0===t||t.forEach((t=>{var e;return null===(e=t.hostUpdate)||void 0===e?void 0:e.call(t)})),this.update(i)):this._$Ek()}catch(t){throw e=!1,this._$Ek(),t}e&&this._$AE(i)}willUpdate(t){}_$AE(t){var e;null===(e=this._$ES)||void 0===e||e.forEach((t=>{var e;return null===(e=t.hostUpdated)||void 0===e?void 0:e.call(t)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(t)),this.updated(t)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(t){return!0}update(t){void 0!==this._$EC&&(this._$EC.forEach(((t,e)=>this._$EO(e,this[e],t))),this._$EC=void 0),this._$Ek()}updated(t){}firstUpdated(t){}}var _;g[m]=!0,g.elementProperties=new Map,g.elementStyles=[],g.shadowRootOptions={mode:\"open\"},null==u||u({ReactiveElement:g}),(null!==(o=l.reactiveElementVersions)&&void 0!==o?o:l.reactiveElementVersions=[]).push(\"1.6.2\");const v=window,b=v.trustedTypes,y=b?b.createPolicy(\"lit-html\",{createHTML:t=>t}):void 0,w=\"$lit$\",$=`lit$${(Math.random()+\"\").slice(9)}$`,A=\"?\"+$,x=`<${A}>`,k=document,S=()=>k.createComment(\"\"),E=t=>null===t||\"object\"!=typeof t&&\"function\"!=typeof t,O=Array.isArray,T=\"[ \\t\\n\\f\\r]\",C=/<(?:(!--|\\/[^a-zA-Z])|(\\/?[a-zA-Z][^>\\s]*)|(\\/?$))/g,M=/-->/g,j=/>/g,H=RegExp(`>|${T}(?:([^\\\\s\"'>=/]+)(${T}*=${T}*(?:[^ \\t\\n\\f\\r\"'\\`<>=]|(\"|')|))|$)`,\"g\"),D=/'/g,R=/\"/g,N=/^(?:script|style|textarea|title)$/i,P=(t=>(e,...i)=>({_$litType$:t,strings:e,values:i}))(1),z=Symbol.for(\"lit-noChange\"),L=Symbol.for(\"lit-nothing\"),I=new WeakMap,F=k.createTreeWalker(k,129,null,!1);function V(t,e){if(!Array.isArray(t)||!t.hasOwnProperty(\"raw\"))throw Error(\"invalid template strings array\");return void 0!==y?y.createHTML(e):e}const U=(t,e)=>{const i=t.length-1,n=[];let r,s=2===e?\"<svg>\":\"\",a=C;for(let o=0;o<i;o++){const e=t[o];let i,l,c=-1,h=0;for(;h<e.length&&(a.lastIndex=h,l=a.exec(e),null!==l);)h=a.lastIndex,a===C?\"!--\"===l[1]?a=M:void 0!==l[1]?a=j:void 0!==l[2]?(N.test(l[2])&&(r=RegExp(\"</\"+l[2],\"g\")),a=H):void 0!==l[3]&&(a=H):a===H?\">\"===l[0]?(a=null!=r?r:C,c=-1):void 0===l[1]?c=-2:(c=a.lastIndex-l[2].length,i=l[1],a=void 0===l[3]?H:'\"'===l[3]?R:D):a===R||a===D?a=H:a===M||a===j?a=C:(a=H,r=void 0);const u=a===H&&t[o+1].startsWith(\"/>\")?\" \":\"\";s+=a===C?e+x:c>=0?(n.push(i),e.slice(0,c)+w+e.slice(c)+$+u):e+$+(-2===c?(n.push(void 0),o):u)}return[V(t,s+(t[i]||\"<?>\")+(2===e?\"</svg>\":\"\")),n]};class B{constructor({strings:t,_$litType$:e},i){let n;this.parts=[];let r=0,s=0;const a=t.length-1,o=this.parts,[l,c]=U(t,e);if(this.el=B.createElement(l,i),F.currentNode=this.el.content,2===e){const t=this.el.content,e=t.firstChild;e.remove(),t.append(...e.childNodes)}for(;null!==(n=F.nextNode())&&o.length<a;){if(1===n.nodeType){if(n.hasAttributes()){const t=[];for(const e of n.getAttributeNames())if(e.endsWith(w)||e.startsWith($)){const i=c[s++];if(t.push(e),void 0!==i){const t=n.getAttribute(i.toLowerCase()+w).split($),e=/([.?@])?(.*)/.exec(i);o.push({type:1,index:r,name:e[2],strings:t,ctor:\".\"===e[1]?Y:\"?\"===e[1]?J:\"@\"===e[1]?X:G})}else o.push({type:6,index:r})}for(const e of t)n.removeAttribute(e)}if(N.test(n.tagName)){const t=n.textContent.split($),e=t.length-1;if(e>0){n.textContent=b?b.emptyScript:\"\";for(let i=0;i<e;i++)n.append(t[i],S()),F.nextNode(),o.push({type:2,index:++r});n.append(t[e],S())}}}else if(8===n.nodeType)if(n.data===A)o.push({type:2,index:r});else{let t=-1;for(;-1!==(t=n.data.indexOf($,t+1));)o.push({type:7,index:r}),t+=$.length-1}r++}}static createElement(t,e){const i=k.createElement(\"template\");return i.innerHTML=t,i}}function W(t,e,i=t,n){var r,s,a,o;if(e===z)return e;let l=void 0!==n?null===(r=i._$Co)||void 0===r?void 0:r[n]:i._$Cl;const c=E(e)?void 0:e._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(s=null==l?void 0:l._$AO)||void 0===s||s.call(l,!1),void 0===c?l=void 0:(l=new c(t),l._$AT(t,i,n)),void 0!==n?(null!==(a=(o=i)._$Co)&&void 0!==a?a:o._$Co=[])[n]=l:i._$Cl=l),void 0!==l&&(e=W(t,l._$AS(t,e.values),l,n)),e}class q{constructor(t,e){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=e}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){var e;const{el:{content:i},parts:n}=this._$AD,r=(null!==(e=null==t?void 0:t.creationScope)&&void 0!==e?e:k).importNode(i,!0);F.currentNode=r;let s=F.nextNode(),a=0,o=0,l=n[0];for(;void 0!==l;){if(a===l.index){let e;2===l.type?e=new Z(s,s.nextSibling,this,t):1===l.type?e=new l.ctor(s,l.name,l.strings,this,t):6===l.type&&(e=new Q(s,this,t)),this._$AV.push(e),l=n[++o]}a!==(null==l?void 0:l.index)&&(s=F.nextNode(),a++)}return F.currentNode=k,r}v(t){let e=0;for(const i of this._$AV)void 0!==i&&(void 0!==i.strings?(i._$AI(t,i,e),e+=i.strings.length-2):i._$AI(t[e])),e++}}class Z{constructor(t,e,i,n){var r;this.type=2,this._$AH=L,this._$AN=void 0,this._$AA=t,this._$AB=e,this._$AM=i,this.options=n,this._$Cp=null===(r=null==n?void 0:n.isConnected)||void 0===r||r}get _$AU(){var t,e;return null!==(e=null===(t=this._$AM)||void 0===t?void 0:t._$AU)&&void 0!==e?e:this._$Cp}get parentNode(){let t=this._$AA.parentNode;const e=this._$AM;return void 0!==e&&11===(null==t?void 0:t.nodeType)&&(t=e.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,e=this){t=W(this,t,e),E(t)?t===L||null==t||\"\"===t?(this._$AH!==L&&this._$AR(),this._$AH=L):t!==this._$AH&&t!==z&&this._(t):void 0!==t._$litType$?this.g(t):void 0!==t.nodeType?this.$(t):(t=>O(t)||\"function\"==typeof(null==t?void 0:t[Symbol.iterator]))(t)?this.T(t):this._(t)}k(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}$(t){this._$AH!==t&&(this._$AR(),this._$AH=this.k(t))}_(t){this._$AH!==L&&E(this._$AH)?this._$AA.nextSibling.data=t:this.$(k.createTextNode(t)),this._$AH=t}g(t){var e;const{values:i,_$litType$:n}=t,r=\"number\"==typeof n?this._$AC(t):(void 0===n.el&&(n.el=B.createElement(V(n.h,n.h[0]),this.options)),n);if((null===(e=this._$AH)||void 0===e?void 0:e._$AD)===r)this._$AH.v(i);else{const t=new q(r,this),e=t.u(this.options);t.v(i),this.$(e),this._$AH=t}}_$AC(t){let e=I.get(t.strings);return void 0===e&&I.set(t.strings,e=new B(t)),e}T(t){O(this._$AH)||(this._$AH=[],this._$AR());const e=this._$AH;let i,n=0;for(const r of t)n===e.length?e.push(i=new Z(this.k(S()),this.k(S()),this,this.options)):i=e[n],i._$AI(r),n++;n<e.length&&(this._$AR(i&&i._$AB.nextSibling,n),e.length=n)}_$AR(t=this._$AA.nextSibling,e){var i;for(null===(i=this._$AP)||void 0===i||i.call(this,!1,!0,e);t&&t!==this._$AB;){const e=t.nextSibling;t.remove(),t=e}}setConnected(t){var e;void 0===this._$AM&&(this._$Cp=t,null===(e=this._$AP)||void 0===e||e.call(this,t))}}class G{constructor(t,e,i,n,r){this.type=1,this._$AH=L,this._$AN=void 0,this.element=t,this.name=e,this._$AM=n,this.options=r,i.length>2||\"\"!==i[0]||\"\"!==i[1]?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=L}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(t,e=this,i,n){const r=this.strings;let s=!1;if(void 0===r)t=W(this,t,e,0),s=!E(t)||t!==this._$AH&&t!==z,s&&(this._$AH=t);else{const n=t;let a,o;for(t=r[0],a=0;a<r.length-1;a++)o=W(this,n[i+a],e,a),o===z&&(o=this._$AH[a]),s||(s=!E(o)||o!==this._$AH[a]),o===L?t=L:t!==L&&(t+=(null!=o?o:\"\")+r[a+1]),this._$AH[a]=o}s&&!n&&this.j(t)}j(t){t===L?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=t?t:\"\")}}class Y extends G{constructor(){super(...arguments),this.type=3}j(t){this.element[this.name]=t===L?void 0:t}}const K=b?b.emptyScript:\"\";class J extends G{constructor(){super(...arguments),this.type=4}j(t){t&&t!==L?this.element.setAttribute(this.name,K):this.element.removeAttribute(this.name)}}class X extends G{constructor(t,e,i,n,r){super(t,e,i,n,r),this.type=5}_$AI(t,e=this){var i;if((t=null!==(i=W(this,t,e,0))&&void 0!==i?i:L)===z)return;const n=this._$AH,r=t===L&&n!==L||t.capture!==n.capture||t.once!==n.once||t.passive!==n.passive,s=t!==L&&(n===L||r);r&&this.element.removeEventListener(this.name,this,n),s&&this.element.addEventListener(this.name,this,t),this._$AH=t}handleEvent(t){var e,i;\"function\"==typeof this._$AH?this._$AH.call(null!==(i=null===(e=this.options)||void 0===e?void 0:e.host)&&void 0!==i?i:this.element,t):this._$AH.handleEvent(t)}}class Q{constructor(t,e,i){this.element=t,this.type=6,this._$AN=void 0,this._$AM=e,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(t){W(this,t)}}const tt=v.litHtmlPolyfillSupport;null==tt||tt(B,Z),(null!==(_=v.litHtmlVersions)&&void 0!==_?_:v.litHtmlVersions=[]).push(\"2.7.5\");var et,it;class nt extends g{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var t,e;const i=super.createRenderRoot();return null!==(t=(e=this.renderOptions).renderBefore)&&void 0!==t||(e.renderBefore=i.firstChild),i}update(t){const e=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=((t,e,i)=>{var n,r;const s=null!==(n=null==i?void 0:i.renderBefore)&&void 0!==n?n:e;let a=s._$litPart$;if(void 0===a){const t=null!==(r=null==i?void 0:i.renderBefore)&&void 0!==r?r:null;s._$litPart$=a=new Z(e.insertBefore(S(),t),t,void 0,null!=i?i:{})}return a._$AI(t),a})(e,this.renderRoot,this.renderOptions)}connectedCallback(){var t;super.connectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!0)}disconnectedCallback(){var t;super.disconnectedCallback(),null===(t=this._$Do)||void 0===t||t.setConnected(!1)}render(){return z}}nt.finalized=!0,nt._$litElement$=!0,null===(et=globalThis.litElementHydrateSupport)||void 0===et||et.call(globalThis,{LitElement:nt});const rt=globalThis.litElementPolyfillSupport;null==rt||rt({LitElement:nt}),(null!==(it=globalThis.litElementVersions)&&void 0!==it?it:globalThis.litElementVersions=[]).push(\"3.3.2\");const st=(t,e)=>\"method\"===e.kind&&e.descriptor&&!(\"value\"in e.descriptor)?{...e,finisher(i){i.createProperty(e.key,t)}}:{kind:\"field\",key:Symbol(),placement:\"own\",descriptor:{},originalKey:e.key,initializer(){\"function\"==typeof e.initializer&&(this[e.key]=e.initializer.call(this))},finisher(i){i.createProperty(e.key,t)}};function at(t){return(e,i)=>void 0!==i?((t,e,i)=>{e.constructor.createProperty(i,t)})(t,e,i):st(t,e)}const ot=({finisher:t,descriptor:e})=>(i,n)=>{var r;if(void 0===n){const n=null!==(r=i.originalKey)&&void 0!==r?r:i.key,s=null!=e?{kind:\"method\",placement:\"prototype\",key:n,descriptor:e(i.key)}:{...i,key:n};return null!=t&&(s.finisher=function(e){t(e,n)}),s}{const r=i.constructor;void 0!==e&&Object.defineProperty(i,n,e(n)),null==t||t(r,n)}};function lt(t){return ot({finisher:(e,i)=>{Object.assign(e.prototype[i],t)}})}var ct;null===(ct=window.HTMLSlotElement)||void 0===ct||ct.prototype.assignedElements;class ht{constructor(t){this.startPress=e=>{t().then((t=>{t&&t.startPress(e)}))},this.endPress=()=>{t().then((t=>{t&&t.endPress()}))},this.startFocus=()=>{t().then((t=>{t&&t.startFocus()}))},this.endFocus=()=>{t().then((t=>{t&&t.endFocus()}))},this.startHover=()=>{t().then((t=>{t&&t.startHover()}))},this.endHover=()=>{t().then((t=>{t&&t.endHover()}))}}}const ut=1,dt=2,ft=t=>(...e)=>({_$litDirective$:t,values:e});class pt{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,i){this._$Ct=t,this._$AM=e,this._$Ci=i}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}const mt=\"important\",gt=\" !\"+mt,_t=ft(class extends pt{constructor(t){var e;if(super(t),t.type!==ut||\"style\"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error(\"The `styleMap` directive must be used in the `style` attribute and must be the only part in the attribute.\")}render(t){return Object.keys(t).reduce(((e,i)=>{const n=t[i];return null==n?e:e+`${i=i.includes(\"-\")?i:i.replace(/(?:^(webkit|moz|ms|o)|)(?=[A-Z])/g,\"-$&\").toLowerCase()}:${n};`}),\"\")}update(t,[e]){const{style:i}=t.element;if(void 0===this.ut){this.ut=new Set;for(const t in e)this.ut.add(t);return this.render(e)}this.ut.forEach((t=>{null==e[t]&&(this.ut.delete(t),t.includes(\"-\")?i.removeProperty(t):i[t]=\"\")}));for(const n in e){const t=e[n];if(null!=t){this.ut.add(n);const e=\"string\"==typeof t&&t.endsWith(gt);n.includes(\"-\")||e?i.setProperty(n,e?t.slice(0,-11):t,e?mt:\"\"):i[n]=t}}return z}});class vt extends pt{constructor(t){if(super(t),this.et=L,t.type!==dt)throw Error(this.constructor.directiveName+\"() can only be used in child bindings\")}render(t){if(t===L||null==t)return this.ft=void 0,this.et=t;if(t===z)return t;if(\"string\"!=typeof t)throw Error(this.constructor.directiveName+\"() called with a non-string value\");if(t===this.et)return this.ft;this.et=t;const e=[t];return e.raw=e,this.ft={_$litType$:this.constructor.resultType,strings:e,values:[]}}}vt.directiveName=\"unsafeHTML\",vt.resultType=1;const bt=ft(vt),yt=ft(class extends pt{constructor(t){var e;if(super(t),t.type!==ut||\"class\"!==t.name||(null===(e=t.strings)||void 0===e?void 0:e.length)>2)throw Error(\"`classMap()` can only be used in the `class` attribute and must be the only part in the attribute.\")}render(t){return\" \"+Object.keys(t).filter((e=>t[e])).join(\" \")+\" \"}update(t,[e]){var i,n;if(void 0===this.it){this.it=new Set,void 0!==t.strings&&(this.nt=new Set(t.strings.join(\" \").split(/\\s/).filter((t=>\"\"!==t))));for(const t in e)e[t]&&!(null===(i=this.nt)||void 0===i?void 0:i.has(t))&&this.it.add(t);return this.render(e)}const r=t.element.classList;this.it.forEach((t=>{t in e||(r.remove(t),this.it.delete(t))}));for(const s in e){const t=!!e[s];t===this.it.has(s)||(null===(n=this.nt)||void 0===n?void 0:n.has(s))||(t?(r.add(s),this.it.add(s)):(r.remove(s),this.it.delete(s)))}return z}}),wt=(t,e,i,n)=>{n=n||{},i=null==i?{}:i;const r=new Event(e,{bubbles:void 0===n.bubbles||n.bubbles,cancelable:Boolean(n.cancelable),composed:void 0===n.composed||n.composed});return r.detail=i,t.dispatchEvent(r),r},$t=(t,e)=>{if(t===e)return!0;if(t&&e&&\"object\"==typeof t&&\"object\"==typeof e){if(t.constructor!==e.constructor)return!1;let i,n;if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(i=n;0!=i--;)if(!$t(t[i],e[i]))return!1;return!0}if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(i of t.entries())if(!e.has(i[0]))return!1;for(i of t.entries())if(!$t(i[1],e.get(i[0])))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(i of t.entries())if(!e.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!==e.length)return!1;for(i=n;0!=i--;)if(t[i]!==e[i])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===e.toString();const r=Object.keys(t);if(n=r.length,n!==Object.keys(e).length)return!1;for(i=n;0!=i--;)if(!Object.prototype.hasOwnProperty.call(e,r[i]))return!1;for(i=n;0!=i--;){const n=r[i];if(!$t(t[n],e[n]))return!1}return!0}return t!=t&&e!=e},At=\"ontouchstart\"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;class xt extends HTMLElement{constructor(){super(),this.holdTime=500,this.held=!1,this.cancelled=!1,this.isRepeating=!1,this.repeatCount=0,this.ripple=document.createElement(\"mwc-ripple\")}connectedCallback(){Object.assign(this.style,{position:\"fixed\",width:At?\"100px\":\"50px\",height:At?\"100px\":\"50px\",transform:\"translate(-50%, -50%)\",pointerEvents:\"none\",zIndex:\"999\"}),this.appendChild(this.ripple),this.ripple.primary=!0,[\"touchcancel\",\"mouseout\",\"mouseup\",\"touchmove\",\"mousewheel\",\"wheel\",\"scroll\"].forEach((t=>{document.addEventListener(t,(()=>{this.cancelled=!0,this.timer&&(this.stopAnimation(),clearTimeout(this.timer),this.timer=void 0,this.isRepeating&&this.repeatTimeout&&(clearInterval(this.repeatTimeout),this.isRepeating=!1))}),{passive:!0})}))}bind(t,e){t.actionHandler&&$t(e,t.actionHandler.options)||(t.actionHandler?(t.removeEventListener(\"touchstart\",t.actionHandler.start),t.removeEventListener(\"touchend\",t.actionHandler.end),t.removeEventListener(\"touchcancel\",t.actionHandler.end),t.removeEventListener(\"mousedown\",t.actionHandler.start),t.removeEventListener(\"click\",t.actionHandler.end),t.removeEventListener(\"keyup\",t.actionHandler.handleEnter)):t.addEventListener(\"contextmenu\",(t=>{const e=t||window.event;return e.preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0,e.returnValue=!1,!1})),t.actionHandler={options:e},e.disabled||(t.actionHandler.start=i=>{let n,r;this.cancelled=!1,i.touches?(n=i.touches[0].clientX,r=i.touches[0].clientY):(n=i.clientX,r=i.clientY),e.hasHold&&(this.held=!1,this.timer=window.setTimeout((()=>{this.startAnimation(n,r),this.held=!0,e.repeat&&!this.isRepeating&&(this.repeatCount=0,this.isRepeating=!0,this.repeatTimeout=setInterval((()=>{wt(t,\"action\",{action:\"hold\"}),this.repeatCount++,this.repeatTimeout&&e.repeatLimit&&this.repeatCount>=e.repeatLimit&&(clearInterval(this.repeatTimeout),this.isRepeating=!1)}),e.repeat))}),this.holdTime))},t.actionHandler.end=t=>{if([\"touchend\",\"touchcancel\"].includes(t.type)&&this.cancelled)return void(this.isRepeating&&this.repeatTimeout&&(clearInterval(this.repeatTimeout),this.isRepeating=!1));const i=t.target;t.cancelable&&t.preventDefault(),e.hasHold&&(clearTimeout(this.timer),this.isRepeating&&this.repeatTimeout&&clearInterval(this.repeatTimeout),this.isRepeating=!1,this.stopAnimation(),this.timer=void 0),e.hasHold&&this.held?e.repeat||wt(i,\"action\",{action:\"hold\"}):e.hasDoubleClick?\"click\"===t.type&&t.detail<2||!this.dblClickTimeout?this.dblClickTimeout=window.setTimeout((()=>{this.dblClickTimeout=void 0,wt(i,\"action\",{action:\"tap\"})}),250):(clearTimeout(this.dblClickTimeout),this.dblClickTimeout=void 0,wt(i,\"action\",{action:\"double_tap\"})):wt(i,\"action\",{action:\"tap\"})},t.actionHandler.handleEnter=t=>{13===t.keyCode&&t.currentTarget.actionHandler.end(t)},t.addEventListener(\"touchstart\",t.actionHandler.start,{passive:!0}),t.addEventListener(\"touchend\",t.actionHandler.end),t.addEventListener(\"touchcancel\",t.actionHandler.end),t.addEventListener(\"mousedown\",t.actionHandler.start,{passive:!0}),t.addEventListener(\"click\",t.actionHandler.end),t.addEventListener(\"keyup\",t.actionHandler.handleEnter)))}startAnimation(t,e){Object.assign(this.style,{left:`${t}px`,top:`${e}px`,display:null}),this.ripple.disabled=!1,this.ripple.startPress(),this.ripple.unbounded=!0}stopAnimation(){this.ripple.endPress(),this.ripple.disabled=!0,this.style.display=\"none\"}}customElements.define(\"cblcars-button-card-action-handler\",xt);const kt=(t,e)=>{const i=(()=>{const t=document.body;if(t.querySelector(\"cblcars-button-card-action-handler\"))return t.querySelector(\"cblcars-button-card-action-handler\");const e=document.createElement(\"cblcars-button-card-action-handler\");return t.appendChild(e),e})();i&&i.bind(t,e)},St=ft(class extends pt{update(t,[e]){return kt(t.element,e),z}render(t){}});function Et(t,e){(function(t){return\"string\"==typeof t&&-1!==t.indexOf(\".\")&&1===parseFloat(t)})(t)&&(t=\"100%\");var i=function(t){return\"string\"==typeof t&&-1!==t.indexOf(\"%\")}(t);return t=360===e?t:Math.min(e,Math.max(0,parseFloat(t))),i&&(t=parseInt(String(t*e),10)/100),Math.abs(t-e)<1e-6?1:t=360===e?(t<0?t%e+e:t%e)/parseFloat(String(e)):t%e/parseFloat(String(e))}function Ot(t){return Math.min(1,Math.max(0,t))}function Tt(t){return t=parseFloat(t),(isNaN(t)||t<0||t>1)&&(t=1),t}function Ct(t){return t<=1?\"\".concat(100*Number(t),\"%\"):t}function Mt(t){return 1===t.length?\"0\"+t:String(t)}function jt(t,e,i){t=Et(t,255),e=Et(e,255),i=Et(i,255);var n=Math.max(t,e,i),r=Math.min(t,e,i),s=0,a=0,o=(n+r)/2;if(n===r)a=0,s=0;else{var l=n-r;switch(a=o>.5?l/(2-n-r):l/(n+r),n){case t:s=(e-i)/l+(e<i?6:0);break;case e:s=(i-t)/l+2;break;case i:s=(t-e)/l+4}s/=6}return{h:s,s:a,l:o}}function Ht(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*i*(e-t):i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t}function Dt(t,e,i){t=Et(t,255),e=Et(e,255),i=Et(i,255);var n=Math.max(t,e,i),r=Math.min(t,e,i),s=0,a=n,o=n-r,l=0===n?0:o/n;if(n===r)s=0;else{switch(n){case t:s=(e-i)/o+(e<i?6:0);break;case e:s=(i-t)/o+2;break;case i:s=(t-e)/o+4}s/=6}return{h:s,s:l,v:a}}function Rt(t,e,i,n){var r=[Mt(Math.round(t).toString(16)),Mt(Math.round(e).toString(16)),Mt(Math.round(i).toString(16))];return n&&r[0].startsWith(r[0].charAt(1))&&r[1].startsWith(r[1].charAt(1))&&r[2].startsWith(r[2].charAt(1))?r[0].charAt(0)+r[1].charAt(0)+r[2].charAt(0):r.join(\"\")}function Nt(t){return Math.round(255*parseFloat(t)).toString(16)}function Pt(t){return zt(t)/255}function zt(t){return parseInt(t,16)}var Lt={aliceblue:\"#f0f8ff\",antiquewhite:\"#faebd7\",aqua:\"#00ffff\",aquamarine:\"#7fffd4\",azure:\"#f0ffff\",beige:\"#f5f5dc\",bisque:\"#ffe4c4\",black:\"#000000\",blanchedalmond:\"#ffebcd\",blue:\"#0000ff\",blueviolet:\"#8a2be2\",brown:\"#a52a2a\",burlywood:\"#deb887\",cadetblue:\"#5f9ea0\",chartreuse:\"#7fff00\",chocolate:\"#d2691e\",coral:\"#ff7f50\",cornflowerblue:\"#6495ed\",cornsilk:\"#fff8dc\",crimson:\"#dc143c\",cyan:\"#00ffff\",darkblue:\"#00008b\",darkcyan:\"#008b8b\",darkgoldenrod:\"#b8860b\",darkgray:\"#a9a9a9\",darkgreen:\"#006400\",darkgrey:\"#a9a9a9\",darkkhaki:\"#bdb76b\",darkmagenta:\"#8b008b\",darkolivegreen:\"#556b2f\",darkorange:\"#ff8c00\",darkorchid:\"#9932cc\",darkred:\"#8b0000\",darksalmon:\"#e9967a\",darkseagreen:\"#8fbc8f\",darkslateblue:\"#483d8b\",darkslategray:\"#2f4f4f\",darkslategrey:\"#2f4f4f\",darkturquoise:\"#00ced1\",darkviolet:\"#9400d3\",deeppink:\"#ff1493\",deepskyblue:\"#00bfff\",dimgray:\"#696969\",dimgrey:\"#696969\",dodgerblue:\"#1e90ff\",firebrick:\"#b22222\",floralwhite:\"#fffaf0\",forestgreen:\"#228b22\",fuchsia:\"#ff00ff\",gainsboro:\"#dcdcdc\",ghostwhite:\"#f8f8ff\",goldenrod:\"#daa520\",gold:\"#ffd700\",gray:\"#808080\",green:\"#008000\",greenyellow:\"#adff2f\",grey:\"#808080\",honeydew:\"#f0fff0\",hotpink:\"#ff69b4\",indianred:\"#cd5c5c\",indigo:\"#4b0082\",ivory:\"#fffff0\",khaki:\"#f0e68c\",lavenderblush:\"#fff0f5\",lavender:\"#e6e6fa\",lawngreen:\"#7cfc00\",lemonchiffon:\"#fffacd\",lightblue:\"#add8e6\",lightcoral:\"#f08080\",lightcyan:\"#e0ffff\",lightgoldenrodyellow:\"#fafad2\",lightgray:\"#d3d3d3\",lightgreen:\"#90ee90\",lightgrey:\"#d3d3d3\",lightpink:\"#ffb6c1\",lightsalmon:\"#ffa07a\",lightseagreen:\"#20b2aa\",lightskyblue:\"#87cefa\",lightslategray:\"#778899\",lightslategrey:\"#778899\",lightsteelblue:\"#b0c4de\",lightyellow:\"#ffffe0\",lime:\"#00ff00\",limegreen:\"#32cd32\",linen:\"#faf0e6\",magenta:\"#ff00ff\",maroon:\"#800000\",mediumaquamarine:\"#66cdaa\",mediumblue:\"#0000cd\",mediumorchid:\"#ba55d3\",mediumpurple:\"#9370db\",mediumseagreen:\"#3cb371\",mediumslateblue:\"#7b68ee\",mediumspringgreen:\"#00fa9a\",mediumturquoise:\"#48d1cc\",mediumvioletred:\"#c71585\",midnightblue:\"#191970\",mintcream:\"#f5fffa\",mistyrose:\"#ffe4e1\",moccasin:\"#ffe4b5\",navajowhite:\"#ffdead\",navy:\"#000080\",oldlace:\"#fdf5e6\",olive:\"#808000\",olivedrab:\"#6b8e23\",orange:\"#ffa500\",orangered:\"#ff4500\",orchid:\"#da70d6\",palegoldenrod:\"#eee8aa\",palegreen:\"#98fb98\",paleturquoise:\"#afeeee\",palevioletred:\"#db7093\",papayawhip:\"#ffefd5\",peachpuff:\"#ffdab9\",peru:\"#cd853f\",pink:\"#ffc0cb\",plum:\"#dda0dd\",powderblue:\"#b0e0e6\",purple:\"#800080\",rebeccapurple:\"#663399\",red:\"#ff0000\",rosybrown:\"#bc8f8f\",royalblue:\"#4169e1\",saddlebrown:\"#8b4513\",salmon:\"#fa8072\",sandybrown:\"#f4a460\",seagreen:\"#2e8b57\",seashell:\"#fff5ee\",sienna:\"#a0522d\",silver:\"#c0c0c0\",skyblue:\"#87ceeb\",slateblue:\"#6a5acd\",slategray:\"#708090\",slategrey:\"#708090\",snow:\"#fffafa\",springgreen:\"#00ff7f\",steelblue:\"#4682b4\",tan:\"#d2b48c\",teal:\"#008080\",thistle:\"#d8bfd8\",tomato:\"#ff6347\",turquoise:\"#40e0d0\",violet:\"#ee82ee\",wheat:\"#f5deb3\",white:\"#ffffff\",whitesmoke:\"#f5f5f5\",yellow:\"#ffff00\",yellowgreen:\"#9acd32\"};function It(t){var e={r:0,g:0,b:0},i=1,n=null,r=null,s=null,a=!1,o=!1;return\"string\"==typeof t&&(t=function(t){if(t=t.trim().toLowerCase(),0===t.length)return!1;var e=!1;if(Lt[t])t=Lt[t],e=!0;else if(\"transparent\"===t)return{r:0,g:0,b:0,a:0,format:\"name\"};var i=Bt.rgb.exec(t);if(i)return{r:i[1],g:i[2],b:i[3]};if(i=Bt.rgba.exec(t),i)return{r:i[1],g:i[2],b:i[3],a:i[4]};if(i=Bt.hsl.exec(t),i)return{h:i[1],s:i[2],l:i[3]};if(i=Bt.hsla.exec(t),i)return{h:i[1],s:i[2],l:i[3],a:i[4]};if(i=Bt.hsv.exec(t),i)return{h:i[1],s:i[2],v:i[3]};if(i=Bt.hsva.exec(t),i)return{h:i[1],s:i[2],v:i[3],a:i[4]};if(i=Bt.hex8.exec(t),i)return{r:zt(i[1]),g:zt(i[2]),b:zt(i[3]),a:Pt(i[4]),format:e?\"name\":\"hex8\"};if(i=Bt.hex6.exec(t),i)return{r:zt(i[1]),g:zt(i[2]),b:zt(i[3]),format:e?\"name\":\"hex\"};if(i=Bt.hex4.exec(t),i)return{r:zt(i[1]+i[1]),g:zt(i[2]+i[2]),b:zt(i[3]+i[3]),a:Pt(i[4]+i[4]),format:e?\"name\":\"hex8\"};if(i=Bt.hex3.exec(t),i)return{r:zt(i[1]+i[1]),g:zt(i[2]+i[2]),b:zt(i[3]+i[3]),format:e?\"name\":\"hex\"};return!1}(t)),\"object\"==typeof t&&(Wt(t.r)&&Wt(t.g)&&Wt(t.b)?(e=function(t,e,i){return{r:255*Et(t,255),g:255*Et(e,255),b:255*Et(i,255)}}(t.r,t.g,t.b),a=!0,o=\"%\"===String(t.r).substr(-1)?\"prgb\":\"rgb\"):Wt(t.h)&&Wt(t.s)&&Wt(t.v)?(n=Ct(t.s),r=Ct(t.v),e=function(t,e,i){t=6*Et(t,360),e=Et(e,100),i=Et(i,100);var n=Math.floor(t),r=t-n,s=i*(1-e),a=i*(1-r*e),o=i*(1-(1-r)*e),l=n%6;return{r:255*[i,a,s,s,o,i][l],g:255*[o,i,i,a,s,s][l],b:255*[s,s,o,i,i,a][l]}}(t.h,n,r),a=!0,o=\"hsv\"):Wt(t.h)&&Wt(t.s)&&Wt(t.l)&&(n=Ct(t.s),s=Ct(t.l),e=function(t,e,i){var n,r,s;if(t=Et(t,360),e=Et(e,100),i=Et(i,100),0===e)r=i,s=i,n=i;else{var a=i<.5?i*(1+e):i+e-i*e,o=2*i-a;n=Ht(o,a,t+1/3),r=Ht(o,a,t),s=Ht(o,a,t-1/3)}return{r:255*n,g:255*r,b:255*s}}(t.h,n,s),a=!0,o=\"hsl\"),Object.prototype.hasOwnProperty.call(t,\"a\")&&(i=t.a)),i=Tt(i),{ok:a,format:t.format||o,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:i}}var Ft=\"(?:\".concat(\"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\",\")|(?:\").concat(\"[-\\\\+]?\\\\d+%?\",\")\"),Vt=\"[\\\\s|\\\\(]+(\".concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")\\\\s*\\\\)?\"),Ut=\"[\\\\s|\\\\(]+(\".concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")[,|\\\\s]+(\").concat(Ft,\")\\\\s*\\\\)?\"),Bt={CSS_UNIT:new RegExp(Ft),rgb:new RegExp(\"rgb\"+Vt),rgba:new RegExp(\"rgba\"+Ut),hsl:new RegExp(\"hsl\"+Vt),hsla:new RegExp(\"hsla\"+Ut),hsv:new RegExp(\"hsv\"+Vt),hsva:new RegExp(\"hsva\"+Ut),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function Wt(t){return Boolean(Bt.CSS_UNIT.exec(String(t)))}var qt=function(){function t(e,i){var n;if(void 0===e&&(e=\"\"),void 0===i&&(i={}),e instanceof t)return e;\"number\"==typeof e&&(e=function(t){return{r:t>>16,g:(65280&t)>>8,b:255&t}}(e)),this.originalInput=e;var r=It(e);this.originalInput=e,this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(n=i.format)&&void 0!==n?n:r.format,this.gradientType=i.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=r.ok}return t.prototype.isDark=function(){return this.getBrightness()<128},t.prototype.isLight=function(){return!this.isDark()},t.prototype.getBrightness=function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},t.prototype.getLuminance=function(){var t=this.toRgb(),e=t.r/255,i=t.g/255,n=t.b/255;return.2126*(e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(i<=.03928?i/12.92:Math.pow((i+.055)/1.055,2.4))+.0722*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))},t.prototype.getAlpha=function(){return this.a},t.prototype.setAlpha=function(t){return this.a=Tt(t),this.roundA=Math.round(100*this.a)/100,this},t.prototype.isMonochrome=function(){return 0===this.toHsl().s},t.prototype.toHsv=function(){var t=Dt(this.r,this.g,this.b);return{h:360*t.h,s:t.s,v:t.v,a:this.a}},t.prototype.toHsvString=function(){var t=Dt(this.r,this.g,this.b),e=Math.round(360*t.h),i=Math.round(100*t.s),n=Math.round(100*t.v);return 1===this.a?\"hsv(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%)\"):\"hsva(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%, \").concat(this.roundA,\")\")},t.prototype.toHsl=function(){var t=jt(this.r,this.g,this.b);return{h:360*t.h,s:t.s,l:t.l,a:this.a}},t.prototype.toHslString=function(){var t=jt(this.r,this.g,this.b),e=Math.round(360*t.h),i=Math.round(100*t.s),n=Math.round(100*t.l);return 1===this.a?\"hsl(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%)\"):\"hsla(\".concat(e,\", \").concat(i,\"%, \").concat(n,\"%, \").concat(this.roundA,\")\")},t.prototype.toHex=function(t){return void 0===t&&(t=!1),Rt(this.r,this.g,this.b,t)},t.prototype.toHexString=function(t){return void 0===t&&(t=!1),\"#\"+this.toHex(t)},t.prototype.toHex8=function(t){return void 0===t&&(t=!1),function(t,e,i,n,r){var s=[Mt(Math.round(t).toString(16)),Mt(Math.round(e).toString(16)),Mt(Math.round(i).toString(16)),Mt(Nt(n))];return r&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))&&s[3].startsWith(s[3].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join(\"\")}(this.r,this.g,this.b,this.a,t)},t.prototype.toHex8String=function(t){return void 0===t&&(t=!1),\"#\"+this.toHex8(t)},t.prototype.toHexShortString=function(t){return void 0===t&&(t=!1),1===this.a?this.toHexString(t):this.toHex8String(t)},t.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},t.prototype.toRgbString=function(){var t=Math.round(this.r),e=Math.round(this.g),i=Math.round(this.b);return 1===this.a?\"rgb(\".concat(t,\", \").concat(e,\", \").concat(i,\")\"):\"rgba(\".concat(t,\", \").concat(e,\", \").concat(i,\", \").concat(this.roundA,\")\")},t.prototype.toPercentageRgb=function(){var t=function(t){return\"\".concat(Math.round(100*Et(t,255)),\"%\")};return{r:t(this.r),g:t(this.g),b:t(this.b),a:this.a}},t.prototype.toPercentageRgbString=function(){var t=function(t){return Math.round(100*Et(t,255))};return 1===this.a?\"rgb(\".concat(t(this.r),\"%, \").concat(t(this.g),\"%, \").concat(t(this.b),\"%)\"):\"rgba(\".concat(t(this.r),\"%, \").concat(t(this.g),\"%, \").concat(t(this.b),\"%, \").concat(this.roundA,\")\")},t.prototype.toName=function(){if(0===this.a)return\"transparent\";if(this.a<1)return!1;for(var t=\"#\"+Rt(this.r,this.g,this.b,!1),e=0,i=Object.entries(Lt);e<i.length;e++){var n=i[e],r=n[0];if(t===n[1])return r}return!1},t.prototype.toString=function(t){var e=Boolean(t);t=null!=t?t:this.format;var i=!1,n=this.a<1&&this.a>=0;return e||!n||!t.startsWith(\"hex\")&&\"name\"!==t?(\"rgb\"===t&&(i=this.toRgbString()),\"prgb\"===t&&(i=this.toPercentageRgbString()),\"hex\"!==t&&\"hex6\"!==t||(i=this.toHexString()),\"hex3\"===t&&(i=this.toHexString(!0)),\"hex4\"===t&&(i=this.toHex8String(!0)),\"hex8\"===t&&(i=this.toHex8String()),\"name\"===t&&(i=this.toName()),\"hsl\"===t&&(i=this.toHslString()),\"hsv\"===t&&(i=this.toHsvString()),i||this.toHexString()):\"name\"===t&&0===this.a?this.toName():this.toRgbString()},t.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},t.prototype.clone=function(){return new t(this.toString())},t.prototype.lighten=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.l+=e/100,i.l=Ot(i.l),new t(i)},t.prototype.brighten=function(e){void 0===e&&(e=10);var i=this.toRgb();return i.r=Math.max(0,Math.min(255,i.r-Math.round(-e/100*255))),i.g=Math.max(0,Math.min(255,i.g-Math.round(-e/100*255))),i.b=Math.max(0,Math.min(255,i.b-Math.round(-e/100*255))),new t(i)},t.prototype.darken=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.l-=e/100,i.l=Ot(i.l),new t(i)},t.prototype.tint=function(t){return void 0===t&&(t=10),this.mix(\"white\",t)},t.prototype.shade=function(t){return void 0===t&&(t=10),this.mix(\"black\",t)},t.prototype.desaturate=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.s-=e/100,i.s=Ot(i.s),new t(i)},t.prototype.saturate=function(e){void 0===e&&(e=10);var i=this.toHsl();return i.s+=e/100,i.s=Ot(i.s),new t(i)},t.prototype.greyscale=function(){return this.desaturate(100)},t.prototype.spin=function(e){var i=this.toHsl(),n=(i.h+e)%360;return i.h=n<0?360+n:n,new t(i)},t.prototype.mix=function(e,i){void 0===i&&(i=50);var n=this.toRgb(),r=new t(e).toRgb(),s=i/100;return new t({r:(r.r-n.r)*s+n.r,g:(r.g-n.g)*s+n.g,b:(r.b-n.b)*s+n.b,a:(r.a-n.a)*s+n.a})},t.prototype.analogous=function(e,i){void 0===e&&(e=6),void 0===i&&(i=30);var n=this.toHsl(),r=360/i,s=[this];for(n.h=(n.h-(r*e>>1)+720)%360;--e;)n.h=(n.h+r)%360,s.push(new t(n));return s},t.prototype.complement=function(){var e=this.toHsl();return e.h=(e.h+180)%360,new t(e)},t.prototype.monochromatic=function(e){void 0===e&&(e=6);for(var i=this.toHsv(),n=i.h,r=i.s,s=i.v,a=[],o=1/e;e--;)a.push(new t({h:n,s:r,v:s})),s=(s+o)%1;return a},t.prototype.splitcomplement=function(){var e=this.toHsl(),i=e.h;return[this,new t({h:(i+72)%360,s:e.s,l:e.l}),new t({h:(i+216)%360,s:e.s,l:e.l})]},t.prototype.onBackground=function(e){var i=this.toRgb(),n=new t(e).toRgb(),r=i.a+n.a*(1-i.a);return new t({r:(i.r*i.a+n.r*n.a*(1-i.a))/r,g:(i.g*i.a+n.g*n.a*(1-i.a))/r,b:(i.b*i.a+n.b*n.a*(1-i.a))/r,a:r})},t.prototype.triad=function(){return this.polyad(3)},t.prototype.tetrad=function(){return this.polyad(4)},t.prototype.polyad=function(e){for(var i=this.toHsl(),n=i.h,r=[this],s=360/e,a=1;a<e;a++)r.push(new t({h:(n+a*s)%360,s:i.s,l:i.l}));return r},t.prototype.equals=function(e){return this.toRgbString()===new t(e).toRgbString()},t}();function Zt(t,e){return void 0===t&&(t=\"\"),void 0===e&&(e={}),new qt(t,e)}const Gt=\"unavailable\",Yt=(Kt=[Gt,\"unknown\"],(t,e)=>Kt.includes(t,e));var Kt;const Jt=new Set([\"fan\",\"input_boolean\",\"light\",\"switch\",\"group\",\"automation\",\"humidifier\"]),Xt=[\"auto\",\"auto-no-temperature\"],Qt=[\"card\",\"label-card\"],te=[\"--ha-card-background\",\"--card-background-color\"],ee=\"var(--primary-text-color)\";function ie(t){return t.substr(0,t.indexOf(\".\"))}function ne(t,e){const i=[];let n=e;return\"var\"===e.trim().substring(0,3)&&(e.split(\",\").forEach((t=>{const e=t.match(/var\\(\\s*([a-zA-Z0-9-]*)/);e&&i.push(e[1])})),i.some((e=>{const i=window.getComputedStyle(t).getPropertyValue(e);return!!i&&(n=i,!0)}))),n}function re(...t){const e=t=>t&&\"object\"==typeof t;return t.reduce(((t,i)=>(Object.keys(i).forEach((n=>{const r=t[n],s=i[n];Array.isArray(r)&&Array.isArray(s)?t[n]=r.concat(...s):e(r)&&e(s)?t[n]=re(r,s):t[n]=s})),t)),{})}function se(t,e){let i=[];return t&&t.forEach((t=>{let n=t;e&&e.forEach((e=>{e.id&&t.id&&e.id==t.id&&(n=re(n,e))})),i.push(n)})),e&&(i=i.concat(e.filter((e=>!t||!t.find((t=>!(!t.id||!e.id)&&t.id==e.id)))))),i}function ae(t,e){if(void 0===t)return!1;const i=ie(t.entity_id),n=void 0!==e?e:null==t?void 0:t.state;if([\"button\",\"event\",\"input_button\",\"scene\"].includes(i))return n!==Gt;if(Yt(n))return!1;if(\"off\"===n&&\"alert\"!==i)return!1;switch(i){case\"alarm_control_panel\":return\"disarmed\"!==n;case\"alert\":return\"idle\"!==n;case\"cover\":return\"closed\"!==n;case\"device_tracker\":case\"person\":return\"not_home\"!==n;case\"lock\":return\"locked\"!==n;case\"media_player\":return\"standby\"!==n;case\"vacuum\":return![\"idle\",\"docked\",\"paused\"].includes(n);case\"plant\":return\"problem\"===n;case\"group\":return[\"on\",\"home\",\"open\",\"locked\",\"problem\"].includes(n);case\"timer\":return\"active\"===n;case\"camera\":return\"streaming\"===n}return!0}function oe(t){return Array.isArray(t)?t.reverse().reduce(((t,e)=>`var(${e}${t?`, ${t}`:\"\"})`),void 0):`var(${t})`}function le(t){const e=t.split(\":\").map(Number);return 3600*e[0]+60*e[1]+e[2]}const ce=t=>t<10?`0${t}`:t;const he=new Set([\"call-service\",\"divider\",\"section\",\"weblink\",\"cast\",\"select\"]),ue={alert:\"toggle\",automation:\"toggle\",climate:\"climate\",cover:\"cover\",fan:\"toggle\",group:\"group\",input_boolean:\"toggle\",input_number:\"input-number\",input_select:\"input-select\",input_text:\"input-text\",light:\"toggle\",lock:\"lock\",media_player:\"media-player\",remote:\"toggle\",scene:\"scene\",script:\"script\",sensor:\"sensor\",timer:\"timer\",switch:\"toggle\",vacuum:\"toggle\",water_heater:\"climate\",input_datetime:\"input-datetime\"},de=((t,...e)=>{const i=1===t.length?t[0]:e.reduce(((e,i,n)=>e+(t=>{if(!0===t._$cssResult$)return t.cssText;if(\"number\"==typeof t)return t;throw Error(\"Value passed to 'css' function must be a 'css' function result: \"+t+\". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.\")})(i)+t[n+1]),t[0]);return new s(i,t,n)})`\n  :host {\n    position: relative;\n    display: block;\n    --state-inactive-color: var(--paper-item-icon-color);\n  }\n  ha-card {\n    cursor: pointer;\n    overflow: hidden;\n    box-sizing: border-box;\n    position: relative;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    line-height: normal;\n\n    -webkit-touch-callout: none; /* iOS Safari */\n    -webkit-user-select: none; /* Safari */\n    -khtml-user-select: none; /* Konqueror HTML */\n    -moz-user-select: none; /* Old versions of Firefox */\n    -ms-user-select: none; /* Internet Explorer/Edge */\n    user-select: none; /* Non-prefixed version, currently\n                          supported by Chrome, Opera and Firefox */\n  }\n  ha-card.disabled {\n    pointer-events: none;\n    cursor: default;\n  }\n  :host(.tooltip) .tooltiptext {\n    pointer-events: none;\n    opacity: 0;\n    text-align: center;\n    padding: 4px;\n    border-radius: var(--ha-card-border-radius, 4px);\n    box-shadow: var(\n      --ha-card-box-shadow,\n      0px 2px 1px -1px rgba(0, 0, 0, 0.2),\n      0px 1px 1px 0px rgba(0, 0, 0, 0.14),\n      0px 1px 3px 0px rgba(0, 0, 0, 0.12)\n    );\n    background: var(--ha-card-background, var(--card-background-color, white));\n    border: 1px solid var(--primary-text-color);\n    color: var(--primary-text-color);\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n  }\n  :host(.tooltip:hover) span.tooltiptext {\n    opacity: 1;\n    transition-delay: 1.5s;\n  }\n  :not(ha-state-icon) ha-icon,\n  ha-state-icon {\n    display: inline-block;\n    margin: auto;\n    --mdc-icon-size: 100%;\n    --iron-icon-width: 100%;\n    --iron-icon-height: 100%;\n  }\n  ha-card.button-card-main {\n    padding: 4% 0px;\n    text-transform: none;\n    font-weight: 400;\n    font-size: 1.2rem;\n    align-items: center;\n    text-align: center;\n    letter-spacing: normal;\n    width: 100%;\n  }\n  .ellipsis {\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    overflow: hidden;\n  }\n\n  #overlay {\n    align-items: flex-start;\n    justify-content: flex-end;\n    padding: 8px 7px;\n    opacity: 0.5;\n    /* DO NOT override items below */\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    display: flex;\n  }\n  #lock {\n    -webkit-animation-fill-mode: both;\n    animation-fill-mode: both;\n    margin: unset;\n    width: 24px;\n  }\n  .invalid {\n    animation: blink 1s cubic-bezier(0.68, -0.55, 0.27, 1.55) infinite;\n  }\n  .hidden {\n    visibility: hidden;\n    opacity: 0;\n    transition: visibility 0s 1s, opacity 1s linear;\n  }\n  @keyframes blink {\n    0% {\n      opacity: 0;\n    }\n    50% {\n      opacity: 1;\n    }\n    100% {\n      opacity: 0;\n    }\n  }\n  @-webkit-keyframes rotating /* Safari and Chrome */ {\n    from {\n      -webkit-transform: rotate(0deg);\n      -o-transform: rotate(0deg);\n      transform: rotate(0deg);\n    }\n    to {\n      -webkit-transform: rotate(360deg);\n      -o-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n  @keyframes rotating {\n    from {\n      -ms-transform: rotate(0deg);\n      -moz-transform: rotate(0deg);\n      -webkit-transform: rotate(0deg);\n      -o-transform: rotate(0deg);\n      transform: rotate(0deg);\n    }\n    to {\n      -ms-transform: rotate(360deg);\n      -moz-transform: rotate(360deg);\n      -webkit-transform: rotate(360deg);\n      -o-transform: rotate(360deg);\n      transform: rotate(360deg);\n    }\n  }\n  [rotating] {\n    -webkit-animation: rotating 2s linear infinite;\n    -moz-animation: rotating 2s linear infinite;\n    -ms-animation: rotating 2s linear infinite;\n    -o-animation: rotating 2s linear infinite;\n    animation: rotating 2s linear infinite;\n  }\n\n  #container {\n    display: grid;\n    width: 100%;\n    height: 100%;\n    text-align: center;\n    align-items: center;\n  }\n  #img-cell {\n    display: flex;\n    grid-area: i;\n    height: 100%;\n    width: 100%;\n    max-width: 100%;\n    max-height: 100%;\n    align-self: center;\n    justify-self: center;\n    overflow: hidden;\n    justify-content: center;\n    align-items: center;\n    position: relative;\n  }\n\n  ha-state-icon#icon {\n    height: 100%;\n    width: 100%;\n    max-height: 100%;\n    position: absolute;\n  }\n  img#icon {\n    display: block;\n    height: auto;\n    width: 100%;\n    position: absolute;\n  }\n  #name {\n    grid-area: n;\n    max-width: 100%;\n    align-self: center;\n    justify-self: center;\n    /* margin: auto; */\n  }\n  #state {\n    grid-area: s;\n    max-width: 100%;\n    align-self: center;\n    justify-self: center;\n    /* margin: auto; */\n  }\n\n  #label {\n    grid-area: l;\n    max-width: 100%;\n    align-self: center;\n    justify-self: center;\n  }\n\n  #container.vertical {\n    grid-template-areas: 'i' 'n' 's' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr min-content min-content min-content;\n  }\n  /* Vertical No Icon */\n  #container.vertical.no-icon {\n    grid-template-areas: 'n' 's' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr min-content 1fr;\n  }\n  #container.vertical.no-icon #state {\n    align-self: center;\n  }\n  #container.vertical.no-icon #name {\n    align-self: end;\n  }\n  #container.vertical.no-icon #label {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No Name */\n  #container.vertical.no-icon.no-name {\n    grid-template-areas: 's' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.vertical.no-icon.no-name #state {\n    align-self: end;\n  }\n  #container.vertical.no-icon.no-name #label {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No State */\n  #container.vertical.no-icon.no-state {\n    grid-template-areas: 'n' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.vertical.no-icon.no-state #name {\n    align-self: end;\n  }\n  #container.vertical.no-icon.no-state #label {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No Label */\n  #container.vertical.no-icon.no-label {\n    grid-template-areas: 'n' 's';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.vertical.no-icon.no-label #name {\n    align-self: end;\n  }\n  #container.vertical.no-icon.no-label #state {\n    align-self: start;\n  }\n\n  /* Vertical No Icon No Label No Name */\n  #container.vertical.no-icon.no-label.no-name {\n    grid-template-areas: 's';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.vertical.no-icon.no-label.no-name #state {\n    align-self: center;\n  }\n  /* Vertical No Icon No Label No State */\n  #container.vertical.no-icon.no-label.no-state {\n    grid-template-areas: 'n';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.vertical.no-icon.no-label.no-state #name {\n    align-self: center;\n  }\n\n  /* Vertical No Icon No Name No State */\n  #container.vertical.no-icon.no-name.no-state {\n    grid-template-areas: 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.vertical.no-icon.no-name.no-state #label {\n    align-self: center;\n  }\n\n  #container.icon_name_state {\n    grid-template-areas: 'i n' 'l l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content;\n  }\n\n  #container.icon_name {\n    grid-template-areas: 'i n' 's s' 'l l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n\n  #container.icon_state {\n    grid-template-areas: 'i s' 'n n' 'l l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n\n  #container.name_state {\n    grid-template-areas: 'i' 'n' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n  #container.name_state.no-icon {\n    grid-template-areas: 'n' 'l';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.name_state.no-icon #name {\n    align-self: end;\n  }\n  #container.name_state.no-icon #label {\n    align-self: start;\n  }\n\n  #container.name_state.no-icon.no-label {\n    grid-template-areas: 'n';\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n  }\n  #container.name_state.no-icon.no-label #name {\n    align-self: center;\n  }\n\n  /* icon_name_state2nd default */\n  #container.icon_name_state2nd {\n    grid-template-areas: 'i n' 'i s' 'i l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content 1fr;\n  }\n  #container.icon_name_state2nd #name {\n    align-self: end;\n  }\n  #container.icon_name_state2nd #state {\n    align-self: center;\n  }\n  #container.icon_name_state2nd #label {\n    align-self: start;\n  }\n\n  /* icon_name_state2nd No Label */\n  #container.icon_name_state2nd.no-label {\n    grid-template-areas: 'i n' 'i s';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.icon_name_state2nd #name {\n    align-self: end;\n  }\n  #container.icon_name_state2nd #state {\n    align-self: start;\n  }\n\n  /* icon_state_name2nd Default */\n  #container.icon_state_name2nd {\n    grid-template-areas: 'i s' 'i n' 'i l';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content 1fr;\n  }\n  #container.icon_state_name2nd #state {\n    align-self: end;\n  }\n  #container.icon_state_name2nd #name {\n    align-self: center;\n  }\n  #container.icon_state_name2nd #label {\n    align-self: start;\n  }\n\n  /* icon_state_name2nd No Label */\n  #container.icon_state_name2nd.no-label {\n    grid-template-areas: 'i s' 'i n';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr 1fr;\n  }\n  #container.icon_state_name2nd #state {\n    align-self: end;\n  }\n  #container.icon_state_name2nd #name {\n    align-self: start;\n  }\n\n  #container.icon_label {\n    grid-template-areas: 'i l' 'n n' 's s';\n    grid-template-columns: 40% 1fr;\n    grid-template-rows: 1fr min-content min-content;\n  }\n\n  [style*='--aspect-ratio'] > :first-child {\n    width: 100%;\n  }\n  [style*='--aspect-ratio'] > img {\n    height: auto;\n  }\n  @supports (--custom: property) {\n    [style*='--aspect-ratio'] {\n      position: relative;\n    }\n    [style*='--aspect-ratio']::before {\n      content: '';\n      display: block;\n      padding-bottom: calc(100% / (var(--aspect-ratio)));\n    }\n    [style*='--aspect-ratio'] > :first-child {\n      position: absolute;\n      top: 0;\n      left: 0;\n      height: 100%;\n    }\n  }\n`;var fe,pe,me,ge,_e;!function(t){t.language=\"language\",t.system=\"system\",t.comma_decimal=\"comma_decimal\",t.decimal_comma=\"decimal_comma\",t.space_comma=\"space_comma\",t.none=\"none\"}(fe||(fe={})),function(t){t.language=\"language\",t.system=\"system\",t.am_pm=\"12\",t.twenty_four=\"24\"}(pe||(pe={})),function(t){t.local=\"local\",t.server=\"server\"}(me||(me={})),function(t){t.language=\"language\",t.system=\"system\",t.DMY=\"DMY\",t.MDY=\"MDY\",t.YMD=\"YMD\"}(ge||(ge={})),function(t){t.language=\"language\",t.monday=\"monday\",t.tuesday=\"tuesday\",t.wednesday=\"wednesday\",t.thursday=\"thursday\",t.friday=\"friday\",t.saturday=\"saturday\",t.sunday=\"sunday\"}(_e||(_e={}));const ve=(t,e,i)=>{const n=e?(t=>{switch(t.number_format){case fe.comma_decimal:return[\"en-US\",\"en\"];case fe.decimal_comma:return[\"de\",\"es\",\"it\"];case fe.space_comma:return[\"fr\",\"sv\",\"cs\"];case fe.system:return;default:return t.language}})(e):void 0;if(Number.isNaN=Number.isNaN||function t(e){return\"number\"==typeof e&&t(e)},(null==e?void 0:e.number_format)!==fe.none&&!Number.isNaN(Number(t))&&Intl)try{return new Intl.NumberFormat(n,ye(t,i)).format(Number(t))}catch(r){return console.error(r),new Intl.NumberFormat(void 0,ye(t,i)).format(Number(t))}return\"string\"==typeof t?t:`${((t,e=2)=>Math.round(t*10**e)/10**e)(t,null==i?void 0:i.maximumFractionDigits).toString()}${\"currency\"===(null==i?void 0:i.style)?` ${i.currency}`:\"\"}`},be=(t,e,i)=>{var n;let r=null==i?void 0:i.display_precision;return void 0!==e&&(r=e),null!=r?{maximumFractionDigits:r,minimumFractionDigits:r}:Number.isInteger(Number(null===(n=t.attributes)||void 0===n?void 0:n.step))&&Number.isInteger(Number(t.state))?{maximumFractionDigits:0}:null!=t.attributes.step?{maximumFractionDigits:Math.ceil(Math.log10(1/t.attributes.step))}:void 0},ye=(t,e)=>{const i=Object.assign({maximumFractionDigits:2},e);if(\"string\"!=typeof t)return i;if(!e||void 0===e.minimumFractionDigits&&void 0===e.maximumFractionDigits){const e=t.indexOf(\".\")>-1?t.split(\".\")[1].length:0;i.minimumFractionDigits=e,i.maximumFractionDigits=e}return i};var we,$e,Ae,xe,ke;!function(t){t.language=\"language\",t.system=\"system\",t.comma_decimal=\"comma_decimal\",t.decimal_comma=\"decimal_comma\",t.space_comma=\"space_comma\",t.none=\"none\"}(we||(we={})),function(t){t.language=\"language\",t.system=\"system\",t.am_pm=\"12\",t.twenty_four=\"24\"}($e||($e={})),function(t){t.local=\"local\",t.server=\"server\"}(Ae||(Ae={})),function(t){t.language=\"language\",t.system=\"system\",t.DMY=\"DMY\",t.MDY=\"MDY\",t.YMD=\"YMD\"}(xe||(xe={})),function(t){t.language=\"language\",t.monday=\"monday\",t.tuesday=\"tuesday\",t.wednesday=\"wednesday\",t.thursday=\"thursday\",t.friday=\"friday\",t.saturday=\"saturday\",t.sunday=\"sunday\"}(ke||(ke={}));const Se=(t,e=2)=>{let i=\"\"+t;for(let n=1;n<e;n++)i=parseInt(i)<10**n?`0${i}`:i;return i};const Ee={ms:1,s:1e3,min:6e4,h:36e5,d:864e5},Oe=(t,e)=>function(t){const e=Math.floor(t/1e3/3600),i=Math.floor(t/1e3%3600/60),n=Math.floor(t/1e3%3600%60),r=Math.floor(t%1e3);return e>0?`${e}:${Se(i)}:${Se(n)}`:i>0?`${i}:${Se(n)}`:n>0||r>0?`${n}${r>0?`.${Se(r,3)}`:\"\"}`:null}(parseFloat(t)*Ee[e])||\"0\";var Te=Number.isNaN||function(t){return\"number\"==typeof t&&t!=t};function Ce(t,e){if(t.length!==e.length)return!1;for(var i=0;i<t.length;i++)if(n=t[i],r=e[i],!(n===r||Te(n)&&Te(r)))return!1;var n,r;return!0}function Me(t,e){void 0===e&&(e=Ce);var i=null;function n(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];if(i&&i.lastThis===this&&e(n,i.lastArgs))return i.lastResult;var s=t.apply(this,n);return i={lastResult:s,lastArgs:n,lastThis:this},s}return n.clear=function(){i=null},n}const je=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:\"long\",month:\"long\",day:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),He=(t,e,i)=>De(e,i.time_zone).format(t),De=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{year:\"numeric\",month:\"long\",day:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),Re=(t,e,i)=>{var n,r,s,a;const o=Ne(e,i.time_zone);if(e.date_format===ge.language||e.date_format===ge.system)return o.format(t);const l=o.formatToParts(t),c=null===(n=l.find((t=>\"literal\"===t.type)))||void 0===n?void 0:n.value,h=null===(r=l.find((t=>\"day\"===t.type)))||void 0===r?void 0:r.value,u=null===(s=l.find((t=>\"month\"===t.type)))||void 0===s?void 0:s.value,d=null===(a=l.find((t=>\"year\"===t.type)))||void 0===a?void 0:a.value,f=l[l.length-1];let p=\"literal\"===(null==f?void 0:f.type)?null==f?void 0:f.value:\"\";\"bg\"===e.language&&e.date_format===ge.YMD&&(p=\"\");return{[ge.DMY]:`${h}${c}${u}${c}${d}${p}`,[ge.MDY]:`${u}${c}${h}${c}${d}${p}`,[ge.YMD]:`${d}${c}${u}${c}${h}${p}`}[e.date_format]},Ne=Me(((t,e)=>{const i=t.date_format===ge.system?void 0:t.language;return t.date_format===ge.language||(t.date_format,ge.system),new Intl.DateTimeFormat(i,{year:\"numeric\",month:\"numeric\",day:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0})})),Pe=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{day:\"numeric\",month:\"short\",timeZone:\"server\"===t.time_zone?e:void 0}))),ze=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{month:\"long\",year:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),Le=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{month:\"long\",timeZone:\"server\"===t.time_zone?e:void 0}))),Ie=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{year:\"numeric\",timeZone:\"server\"===t.time_zone?e:void 0}))),Fe=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:\"long\",timeZone:\"server\"===t.time_zone?e:void 0}))),Ve=Me(((t,e)=>new Intl.DateTimeFormat(t.language,{weekday:\"short\",timeZone:\"server\"===t.time_zone?e:void 0}))),Ue=Me((t=>{if(t.time_format===pe.language||t.time_format===pe.system){const e=t.time_format===pe.language?t.language:void 0,i=(new Date).toLocaleString(e);return i.includes(\"AM\")||i.includes(\"PM\")}return t.time_format===pe.am_pm})),Be=(t,e,i)=>We(e,i.time_zone).format(t),We=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{hour:\"numeric\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),qe=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Ze=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{weekday:\"long\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Ge=Me(((t,e)=>new Intl.DateTimeFormat(\"en-GB\",{hour:\"numeric\",minute:\"2-digit\",hour12:!1,timeZone:\"server\"===t.time_zone?e:void 0}))),Ye=(t,e,i)=>Ke(e,i.time_zone).format(t),Ke=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{year:\"numeric\",month:\"long\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Je=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{year:\"numeric\",month:\"short\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Xe=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{month:\"short\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),Qe=Me(((t,e)=>new Intl.DateTimeFormat(\"en\"!==t.language||Ue(t)?t.language:\"en-u-hc-h23\",{year:\"numeric\",month:\"long\",day:\"numeric\",hour:Ue(t)?\"numeric\":\"2-digit\",minute:\"2-digit\",second:\"2-digit\",hour12:Ue(t),timeZone:\"server\"===t.time_zone?e:void 0}))),ti=(t,e)=>0!=(t.supported_features&e),ei=t=>(t=>ti(t,4)&&\"number\"==typeof t.in_progress)(t)||!!t.in_progress,ii=(t,e,i,n,r,s,a)=>{const o=r[e.entity_id];return ni(t,i,n,o,e.entity_id,e.attributes,s,void 0!==a?a:e.state)},ni=(t,e,i,n,r,s,a,o)=>{var l;if(\"unknown\"===o||\"unavailable\"===o)return t(`state.default.${o}`);if(function(t){return!!t.unit_of_measurement||!!t.state_class}(s)){if(\"duration\"===s.device_class&&s.unit_of_measurement&&Ee[s.unit_of_measurement])try{return Oe(o,s.unit_of_measurement)}catch(h){}if(\"monetary\"===s.device_class)try{return ve(o,e,Object.assign({style:\"currency\",currency:(null==a?void 0:a.units)||s.unit_of_measurement,minimumFractionDigits:2},be({state:o,attributes:s},null==a?void 0:a.numeric_precision,n)))}catch(h){}const t=(null==a?void 0:a.show_units)?(null==a?void 0:a.units)?null==a?void 0:a.units:s.unit_of_measurement:void 0,i=t?\"%\"===t?(t=>{switch(t.language){case\"cz\":case\"de\":case\"fi\":case\"fr\":case\"sk\":case\"sv\":return\" \";default:return\"\"}})(e)+\"%\":` ${t}`:\"\";return`${ve(o,e,be({state:o,attributes:s},null==a?void 0:a.numeric_precision,n))}${i}`}const c=ie(r);if(\"datetime\"===c){const t=new Date(o);return Ye(t,e,i)}if([\"date\",\"input_datetime\",\"time\"].includes(c))try{const t=o.split(\" \");if(2===t.length)return Ye(new Date(t.join(\"T\")),Object.assign(Object.assign({},e),{time_zone:Ae.local}),i);if(1===t.length){if(o.includes(\"-\"))return He(new Date(`${o}T00:00`),Object.assign(Object.assign({},e),{time_zone:Ae.local}),i);if(o.includes(\":\")){const t=new Date;return Be(new Date(`${t.toISOString().split(\"T\")[0]}T${o}`),Object.assign(Object.assign({},e),{time_zone:Ae.local}),i)}}return o}catch(u){return o}if(\"counter\"===c||\"number\"===c||\"input_number\"===c)return ve(o,e,be({state:o,attributes:s},null==a?void 0:a.numeric_precision,n));if([\"button\",\"event\",\"input_button\",\"scene\",\"stt\",\"tts\"].includes(c)||\"sensor\"===c&&\"timestamp\"===s.device_class)try{return Ye(new Date(o),e,i)}catch(h){return o}return\"update\"===c?\"on\"===o?ei(s)?ti(s,4)&&\"number\"==typeof s.in_progress?t(\"ui.card.update.installing_with_progress\",{progress:s.in_progress}):t(\"ui.card.update.installing\"):s.latest_version:s.skipped_version===s.latest_version?null!==(l=s.latest_version)&&void 0!==l?l:t(\"state.default.unavailable\"):t(\"ui.card.update.up_to_date\"):(null==n?void 0:n.translation_key)&&t(`component.${n.platform}.entity.${c}.${n.translation_key}.state.${o}`)||s.device_class&&t(`component.${c}.entity_component.${s.device_class}.state.${o}`)||t(`component.${c}.entity_component._.state.${o}`)||o};var ri=Function.prototype.toString,si=Object.create,ai=Object.defineProperty,oi=Object.getOwnPropertyDescriptor,li=Object.getOwnPropertyNames,ci=Object.getOwnPropertySymbols,hi=Object.getPrototypeOf,ui=Object.prototype,di=ui.hasOwnProperty,fi=ui.propertyIsEnumerable,pi=\"function\"==typeof ci,mi=\"function\"==typeof WeakMap,gi=function(){if(mi)return function(){return new WeakMap};var t=function(){function t(){this._keys=[],this._values=[]}return t.prototype.has=function(t){return!!~this._keys.indexOf(t)},t.prototype.get=function(t){return this._values[this._keys.indexOf(t)]},t.prototype.set=function(t,e){this._keys.push(t),this._values.push(e)},t}();return function(){return new t}}(),_i=function(t,e){var i=t.__proto__||hi(t);if(!i)return si(null);var n=i.constructor;if(n===e.Object)return i===e.Object.prototype?{}:si(i);if(~ri.call(n).indexOf(\"[native code]\"))try{return new n}catch(ui){}return si(i)},vi=function(t,e,i,n){var r=_i(t,e);for(var s in n.set(t,r),t)di.call(t,s)&&(r[s]=i(t[s],n));if(pi)for(var a=ci(t),o=0,l=a.length,c=void 0;o<l;++o)c=a[o],fi.call(t,c)&&(r[c]=i(t[c],n));return r},bi=function(t,e,i,n){var r=_i(t,e);n.set(t,r);for(var s=pi?li(t).concat(ci(t)):li(t),a=0,o=s.length,l=void 0,c=void 0;a<o;++a)if(\"callee\"!==(l=s[a])&&\"caller\"!==l)if(c=oi(t,l)){c.get||c.set||(c.value=i(t[l],n));try{ai(r,l,c)}catch(h){r[l]=c.value}}else r[l]=i(t[l],n);return r},yi=Array.isArray,wi=Object.getPrototypeOf,$i=function(){return\"undefined\"!=typeof globalThis?globalThis:\"undefined\"!=typeof self?self:\"undefined\"!=typeof window?window:\"undefined\"!=typeof global?global:(console&&console.error&&console.error('Unable to locate global object, returning \"this\".'),this)}();function Ai(t,e){var i=!(!e||!e.isStrict),n=e&&e.realm||$i,r=i?bi:vi,s=function(t,e){if(!t||\"object\"!=typeof t)return t;if(e.has(t))return e.get(t);var a,o,l,c=t.__proto__||wi(t),h=c&&c.constructor;if(!h||h===n.Object)return r(t,n,s,e);if(yi(t)){if(i)return bi(t,n,s,e);a=new h,e.set(t,a);for(var u=0,d=t.length;u<d;++u)a[u]=s(t[u],e);return a}if(t instanceof n.Date)return new h(t.getTime());if(t instanceof n.RegExp)return(a=new h(t.source,t.flags||(l=\"\",(o=t).global&&(l+=\"g\"),o.ignoreCase&&(l+=\"i\"),o.multiline&&(l+=\"m\"),o.unicode&&(l+=\"u\"),o.sticky&&(l+=\"y\"),l))).lastIndex=t.lastIndex,a;if(n.Map&&t instanceof n.Map)return a=new h,e.set(t,a),t.forEach((function(t,i){a.set(i,s(t,e))})),a;if(n.Set&&t instanceof n.Set)return a=new h,e.set(t,a),t.forEach((function(t){a.add(s(t,e))})),a;if(n.Blob&&t instanceof n.Blob)return t.slice(0,t.size,t.type);if(n.Buffer&&n.Buffer.isBuffer(t))return a=n.Buffer.allocUnsafe?n.Buffer.allocUnsafe(t.length):new h(t.length),e.set(t,a),t.copy(a),a;if(n.ArrayBuffer){if(n.ArrayBuffer.isView(t))return a=new h(t.buffer.slice(0)),e.set(t,a),a;if(t instanceof n.ArrayBuffer)return a=t.slice(0),e.set(t,a),a}return\"function\"==typeof t.then||t instanceof Error||n.WeakMap&&t instanceof n.WeakMap||n.WeakSet&&t instanceof n.WeakSet?t:r(t,n,s,e)};return s(t,gi())}Ai.default=Ai,Ai.strict=function(t,e){return Ai(t,{isStrict:!0,realm:e?e.realm:void 0})};const xi=new Set([\"alarm_control_panel\",\"alert\",\"automation\",\"binary_sensor\",\"calendar\",\"camera\",\"climate\",\"cover\",\"device_tracker\",\"fan\",\"group\",\"humidifier\",\"input_boolean\",\"light\",\"lock\",\"media_player\",\"person\",\"plant\",\"remote\",\"schedule\",\"script\",\"siren\",\"sun\",\"switch\",\"timer\",\"update\",\"vacuum\"]),ki=(t,e,i)=>{if((void 0!==e?e:null==t?void 0:t.state)===Gt)return\"var(--state-unavailable-color)\";const n=Ei(t,e,i);return n?oe(n):void 0},Si=(t,e,i,n)=>{const r=void 0!==i?i:e.state,s=ae(e,i),a=[],o=function(t,e=\"_\"){const i=\"àáäâãåăæąçćčđďèéěėëêęğǵḧìíïîįłḿǹńňñòóöôœøṕŕřßşśšșťțùúüûǘůűūųẃẍÿýźžż·/_,:;\",n=`aaaaaaaaacccddeeeeeeegghiiiiilmnnnnooooooprrsssssttuuuuuuuuuwxyyzzz${e}${e}${e}${e}${e}${e}`,r=new RegExp(i.split(\"\").join(\"|\"),\"g\");return t.toString().toLowerCase().replace(/\\s+/g,e).replace(r,(t=>n.charAt(i.indexOf(t)))).replace(/&/g,`${e}and${e}`).replace(/[^\\w-]+/g,\"\").replace(/-/g,e).replace(new RegExp(`(${e})\\\\1+`,\"g\"),\"$1\").replace(new RegExp(`^${e}+`),\"\").replace(new RegExp(`${e}+$`),\"\")}(r,\"_\"),l=s?\"active\":\"inactive\";if(n&&Qt.includes(n)&&\"inactive\"==l)return te;const c=e.attributes.device_class;return c&&a.push(`--state-${t}-${c}-${o}-color`),a.push(`--state-${t}-${o}-color`,`--state-${t}-${l}-color`,`--state-${l}-color`),a},Ei=(t,e,i)=>{const n=void 0!==e?e:null==t?void 0:t.state,r=ie(t.entity_id),s=t.attributes.device_class;if(\"sensor\"===r&&\"battery\"===s){const t=(t=>{const e=Number(t);if(!isNaN(e))return e>=70?\"--state-sensor-battery-high-color\":e>=30?\"--state-sensor-battery-medium-color\":\"--state-sensor-battery-low-color\"})(n);if(t)return[t]}if(\"group\"===r){const n=(t=>{const e=t.attributes.entity_id||[],i=[...new Set(e.map((t=>ie(t))))];return 1===i.length?i[0]:void 0})(t);if(n&&xi.has(n))return Si(n,t,e,i)}return xi.has(r)?Si(r,t,e,i):i&&Qt.includes(i)?te:void 0};let Oi=window.cardHelpers;const Ti=new Promise((async t=>{Oi&&t(),window.loadCardHelpers&&(Oi=await window.loadCardHelpers(),window.cardHelpers=Oi,t())}));console.info(\"%c  BUTTON-CARD (mod for CB-LCARS)  \\n%c Version 4.1.2-cblcars.3 \",\"color: white; font-weight: bold; background: #37a6d1\",\"color: white; font-weight: bold; background: #37a6d1\");let Ci=class extends nt{constructor(){super(...arguments),this._cards={},this._cardsConfig={},this._entities=[],this._initialSetupComplete=!1,this._rippleHandlers=new ht((()=>this._ripple))}get _doIHaveEverything(){return!!this._hass&&!!this._config&&this.isConnected}set hass(t){this._hass=t,Object.keys(this._cards).forEach((t=>{this._cards[t].hass=this._hass})),this._initialSetupComplete||this._finishSetup()}disconnectedCallback(){super.disconnectedCallback(),this._clearInterval()}connectedCallback(){super.connectedCallback(),this._initialSetupComplete?this._startTimerCountdown():this._finishSetup()}_evaluateVariablesSkipError(t){var e;if(this._evaledVariables={},null===(e=this._config)||void 0===e?void 0:e.variables){Object.keys(this._config.variables).sort().forEach((e=>{try{this._evaledVariables[e]=this._objectEvalTemplate(t,this._config.variables[e])}catch(vt){}}))}}_finishSetup(){if(!this._initialSetupComplete&&this._doIHaveEverything){if(this._evaluateVariablesSkipError(),this._config.entity){const t=this._getTemplateOrValue(void 0,this._config.entity);this._config.entity=t,this._stateObj=this._hass.states[t]}this._evaluateVariablesSkipError(this._stateObj),this._config.entity&&Jt.has(ie(this._config.entity))?this._config=Object.assign({tap_action:{action:\"toggle\"}},this._config):this._config.entity?this._config=Object.assign({tap_action:{action:\"more-info\"}},this._config):this._config=Object.assign({tap_action:{action:\"none\"}},this._config);const t=JSON.stringify(this._config);if(this._entities=[],Array.isArray(this._config.triggers_update))this._config.triggers_update.forEach((t=>{try{const e=this._getTemplateOrValue(this._stateObj,t);null==e||this._entities.includes(e)||this._entities.push(e)}catch(vt){}}));else if(\"string\"==typeof this._config.triggers_update){const t=this._getTemplateOrValue(this._stateObj,this._config.triggers_update);t&&\"all\"!==t?this._entities.push(t):this._config.triggers_update=t}if(\"all\"!==this._config.triggers_update){const e=new RegExp(/states\\[\\s*('|\\\\\")([a-zA-Z0-9_]+\\.[a-zA-Z0-9_]+)\\1\\s*\\]/,\"gm\"),i=new RegExp(/states\\[\\s*('|\\\\\")([a-zA-Z0-9_]+\\.[a-zA-Z0-9_]+)\\1\\s*\\]/,\"m\"),n=t.match(e);null==n||n.forEach((t=>{const e=t.match(i);e&&!this._entities.includes(e[2])&&this._entities.push(e[2])}))}this._config.entity&&!this._entities.includes(this._config.entity)&&this._entities.push(this._config.entity),this._expandTriggerGroups();const e=new RegExp(\"\\\\[\\\\[\\\\[.*\\\\]\\\\]\\\\]\",\"m\");this._hasTemplate=!(\"all\"!==this._config.triggers_update||!t.match(e)),this._startTimerCountdown(),this._initialSetupComplete=!0}}_startTimerCountdown(){if(this._config&&this._config.entity&&\"timer\"===ie(this._config.entity)){const t=this._hass.states[this._config.entity];this._startInterval(t)}}_createCard(t){if(Oi)return Oi.createCardElement(t);{const e=((t,e=!1)=>{const i=(t,e)=>n(\"hui-error-card\",{type:\"error\",error:t,config:e}),n=(t,e)=>{const n=window.document.createElement(t);try{if(!n.setConfig)return;n.setConfig(e)}catch(r){return console.error(t,r),i(r.message,e)}return n};if(!t||\"object\"!=typeof t||!e&&!t.type)return i(\"No type defined\",t);let r=t.type;if(r&&r.startsWith(\"custom:\"))r=r.substr(7);else if(e)if(he.has(r))r=`hui-${r}-row`;else{if(!t.entity)return i(\"Invalid config given.\",t);const e=t.entity.split(\".\",1)[0];r=`hui-${ue[e]||\"text\"}-entity-row`}else r=`hui-${r}-card`;if(customElements.get(r))return n(r,t);const s=i(`Custom element doesn't exist: ${t.type}.`,t);s.style.display=\"None\";const a=setTimeout((()=>{s.style.display=\"\"}),2e3);return customElements.whenDefined(t.type).then((()=>{clearTimeout(a),wt(s,\"ll-rebuild\",{},s)})),s})(t);return Ti.then((()=>{wt(e,\"ll-rebuild\",{})})),e}}static get styles(){return de}render(){var t;if(!this._config||!this._hass)return P``;this._stateObj=this._config.entity?this._hass.states[this._config.entity]:void 0;try{if(this._evaledVariables={},null===(t=this._config)||void 0===t?void 0:t.variables){Object.keys(this._config.variables).sort().forEach((t=>{this._evaledVariables[t]=this._objectEvalTemplate(this._stateObj,this._config.variables[t])}))}return this._cardHtml()}catch(vt){vt.stack?console.error(vt.stack):console.error(vt);const e=document.createElement(\"hui-error-card\");return e.setConfig({type:\"error\",error:vt.toString(),origConfig:this._config}),P` ${e} `}}shouldUpdate(t){return!(!this._hasTemplate&&!t.has(\"_timeRemaining\")&&!function(t,e){if(e.has(\"_config\"))return!0;const i=e.get(\"_hass\");if(i)return t._entities.some((function(e){return(null==i?void 0:i.states[e])!==t._hass.states[e]}));return!1}(this,t))&&(this._expandTriggerGroups(),!0)}updated(t){if(super.updated(t),this._config&&this._config.entity&&\"timer\"===ie(this._config.entity)&&t.has(\"_hass\")){const e=this._hass.states[this._config.entity],i=t.get(\"_hass\");(i?i.states[this._config.entity]:void 0)!==e?this._startInterval(e):e||this._clearInterval()}}_clearInterval(){this._interval&&(window.clearInterval(this._interval),this._interval=void 0)}_startInterval(t){this._clearInterval(),this._calculateRemaining(t),\"active\"===t.state&&(this._interval=window.setInterval((()=>this._calculateRemaining(t)),1e3))}_calculateRemaining(t){t.attributes.remaining&&(this._timeRemaining=(t=>{if(!t.attributes.remaining)return;let e=le(t.attributes.remaining);if(\"active\"===t.state){const i=(new Date).getTime(),n=new Date(t.last_changed).getTime();e=Math.max(e-(i-n)/1e3,0)}return e})(t))}_computeTimeDisplay(t){if(t)return function(t){const e=Math.floor(t/3600),i=Math.floor(t%3600/60),n=Math.floor(t%3600%60);return e>0?`${e}:${ce(i)}:${ce(n)}`:i>0?`${i}:${ce(n)}`:n>0?\"\"+n:null}(this._timeRemaining||le(t.attributes.duration))}_getMatchingConfigState(t){if(!this._config.state)return;const e=this._config.state.find((t=>\"template\"===t.operator));if(!t&&!e)return;let i;const n=this._config.state.find((e=>{if(!e.operator)return t&&this._getTemplateOrValue(t,e.value)==t.state;switch(e.operator){case\"==\":return t&&t.state==this._getTemplateOrValue(t,e.value);case\"<=\":return t&&t.state<=this._getTemplateOrValue(t,e.value);case\"<\":return t&&t.state<this._getTemplateOrValue(t,e.value);case\">=\":return t&&t.state>=this._getTemplateOrValue(t,e.value);case\">\":return t&&t.state>this._getTemplateOrValue(t,e.value);case\"!=\":return t&&t.state!=this._getTemplateOrValue(t,e.value);case\"regex\":return!(!t||!t.state.match(this._getTemplateOrValue(t,e.value)));case\"template\":return this._getTemplateOrValue(t,e.value);case\"default\":return i=e,!1;default:return!1}}));return!n&&i?i:n}_localize(t,e,i,n=!0,r){var s;return ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,{numeric_precision:\"card\"===i?null===(s=this._config)||void 0===s?void 0:s.numeric_precision:i,show_units:n,units:r},e)}_relativeTime(t,e=!1){return t?P`\n        <ha-relative-time\n          id=\"relative-time\"\n          class=\"ellipsis\"\n          .hass=\"${this._hass}\"\n          .datetime=\"${t}\"\n          .capitalize=\"${e}\"\n        ></ha-relative-time>\n      `:\"\"}_getTemplateHelpers(){return{localize:this._localize.bind(this),formatDateTime:t=>Ye(new Date(t),this._hass.locale,this._hass.config),formatShortDateTimeWithYear:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Je(i,n.time_zone).format(e);var e,i,n},formatShortDateTime:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Xe(i,n.time_zone).format(e);var e,i,n},formatDateTimeWithSeconds:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Qe(i,n.time_zone).format(e);var e,i,n},formatDateTimeNumeric:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,`${Re(e,i,n)}, ${Be(e,i,n)}`;var e,i,n},relativeTime:this._relativeTime.bind(this),formatTime:t=>Be(new Date(t),this._hass.locale,this._hass.config),formatTimeWithSeconds:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,qe(i,n.time_zone).format(e);var e,i,n},formatTimeWeekday:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ze(i,n.time_zone).format(e);var e,i,n},formatTime24h:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ge(i,n.time_zone).format(e);var e,i,n},formatDateWeekdayDay:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,je(i,n.time_zone).format(e);var e,i,n},formatDate:t=>He(new Date(t),this._hass.locale,this._hass.config),formatDateNumeric:t=>Re(new Date(t),this._hass.locale,this._hass.config),formatDateShort:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Pe(i,n.time_zone).format(e);var e,i,n},formatDateMonthYear:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,ze(i,n.time_zone).format(e);var e,i,n},formatDateMonth:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Le(i,n.time_zone).format(e);var e,i,n},formatDateYear:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ie(i,n.time_zone).format(e);var e,i,n},formatDateWeekday:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Fe(i,n.time_zone).format(e);var e,i,n},formatDateWeekdayShort:t=>{return e=new Date(t),i=this._hass.locale,n=this._hass.config,Ve(i,n.time_zone).format(e);var e,i,n}}}_evalTemplate(t,e){try{return new Function(\"states\",\"entity\",\"user\",\"hass\",\"variables\",\"html\",\"helpers\",`'use strict'; ${e}`).call(this,this._hass.states,t,this._hass.user,this._hass,this._evaledVariables,P,this._getTemplateHelpers())}catch(vt){const i=e.length<=100?e.trim():`${e.trim().substring(0,98)}...`;throw vt.message=`${vt.name}: ${vt.message} in '${i}'`,vt.name=\"ButtonCardJSTemplateError\",vt}}_objectEvalTemplate(t,e){const i=Ai(e);return this._getTemplateOrValue(t,i)}_getTemplateOrValue(t,e){if([\"number\",\"boolean\"].includes(typeof e))return e;if(!e)return e;if(\"object\"==typeof e)return Object.keys(e).forEach((i=>{e[i]=this._getTemplateOrValue(t,e[i])})),e;const i=e.trim();return\"[[[\"===i.substring(0,3)&&\"]]]\"===i.slice(-3)?this._evalTemplate(t,i.slice(3,-3)):e}_getColorForLightEntity(t,e,i){let n=ee;return Qt.includes(n)&&(n=oe(te)),t&&(ae(t)?(n=t.attributes.rgb_color?`rgb(${t.attributes.rgb_color.join(\",\")})`:e&&t.attributes.color_temp&&t.attributes.min_mireds&&t.attributes.max_mireds?function(t,e,i){const n=new qt(\"rgb(255, 160, 0)\"),r=new qt(\"rgb(166, 209, 255)\"),s=new qt(\"white\"),a=(t-e)/(i-e)*100;return a<50?Zt(r).mix(s,2*a).toRgbString():Zt(s).mix(n,2*(a-50)).toRgbString()}(t.attributes.color_temp,t.attributes.min_mireds,t.attributes.max_mireds):ki(t,t.state,i)||ee,t.attributes.brightness&&(n=function(t,e,i){const n=new qt(ne(t,e));if(n.isValid){const t=n.mix(\"black\",100-i).toString();if(t)return t}return e}(this,n,(t.attributes.brightness+245)/5))):n=ki(t,t.state,i)||ee),n}_buildCssColorAttribute(t,e){var i,n;let r,s=\"\";return(null==e?void 0:e.color)?s=e.color:this._config.color&&(s=this._config.color),Xt.includes(s)&&(!t||t&&\"light\"!==ie(t.entity_id))&&(s=\"\"),r=Xt.includes(s)?this._getColorForLightEntity(t,\"auto-no-temperature\"!==s,null===(i=this._config)||void 0===i?void 0:i.color_type):s||(t&&ki(t,t.state,null===(n=this._config)||void 0===n?void 0:n.color_type)||ee),r}_buildIcon(t,e){if(!this._config.show_icon)return;let i;if(null==e?void 0:e.icon)i=e.icon;else{if(!this._config.icon)return;i=this._config.icon}return this._getTemplateOrValue(t,i)}_buildEntityPicture(t,e){if(!this._config.show_entity_picture||!t&&!e&&!this._config.entity_picture)return;let i;return(null==e?void 0:e.entity_picture)?i=e.entity_picture:this._config.entity_picture?i=this._config.entity_picture:t&&(i=t.attributes&&t.attributes.entity_picture?t.attributes.entity_picture:void 0),this._getTemplateOrValue(t,i)}_buildStyleGeneric(t,e,i){var n,r;let s={};if((null===(n=this._config.styles)||void 0===n?void 0:n[i])&&(s=Object.assign(s,...this._config.styles[i])),null===(r=null==e?void 0:e.styles)||void 0===r?void 0:r[i]){let t={};t=Object.assign(t,...e.styles[i]),s=Object.assign(Object.assign({},s),t)}return Object.keys(s).forEach((e=>{s[e]=this._getTemplateOrValue(t,s[e])})),s}_buildCustomStyleGeneric(t,e,i){var n,r,s,a;let o={};if((null===(r=null===(n=this._config.styles)||void 0===n?void 0:n.custom_fields)||void 0===r?void 0:r[i])&&(o=Object.assign(o,...this._config.styles.custom_fields[i])),null===(a=null===(s=null==e?void 0:e.styles)||void 0===s?void 0:s.custom_fields)||void 0===a?void 0:a[i]){let t={};t=Object.assign(t,...e.styles.custom_fields[i]),o=Object.assign(Object.assign({},o),t)}return Object.keys(o).forEach((e=>{o[e]=this._getTemplateOrValue(t,o[e])})),o}_buildName(t,e){if(!1===this._config.show_name)return;let i;var n;return(null==e?void 0:e.name)?i=e.name:this._config.name?i=this._config.name:t&&(i=t.attributes&&t.attributes.friendly_name?t.attributes.friendly_name:(n=t.entity_id).substr(n.indexOf(\".\")+1)),this._getTemplateOrValue(t,i)}_buildStateString(t){let e;return this._config.show_state&&t&&t.state&&(\"timer\"===ie(t.entity_id)?\"idle\"===t.state||0===this._timeRemaining?e=ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,this._config):(e=this._computeTimeDisplay(t),\"paused\"===t.state&&(e+=` (${ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,this._config)})`)):e=ii(this._hass.localize,t,this._hass.locale,this._hass.config,this._hass.entities,this._config)),e}_buildLastChanged(t,e){return this._config.show_last_changed&&t?P`\n          <ha-relative-time\n            id=\"label\"\n            class=\"ellipsis\"\n            .hass=\"${this._hass}\"\n            .datetime=\"${t.last_changed}\"\n            style=${_t(e)}\n          ></ha-relative-time>\n        `:void 0}_buildLabel(t,e){if(!this._config.show_label)return;let i;return i=(null==e?void 0:e.label)?e.label:this._config.label,this._getTemplateOrValue(t,i)}_buildCustomFields(t,e){let i=P``;const n={},r={};return this._config.custom_fields&&Object.keys(this._config.custom_fields).forEach((e=>{const i=this._config.custom_fields[e];i.card?i.do_not_eval?r[e]=Ai(i.card):r[e]=this._objectEvalTemplate(t,i.card):n[e]=this._getTemplateOrValue(t,i)})),(null==e?void 0:e.custom_fields)&&Object.keys(e.custom_fields).forEach((i=>{const s=e.custom_fields[i];s.card?s.do_not_eval?r[i]=Ai(s.card):r[i]=this._objectEvalTemplate(t,s.card):n[i]=this._getTemplateOrValue(t,s)})),Object.keys(n).forEach((r=>{if(null!=n[r]){const s=Object.assign(Object.assign({},this._buildCustomStyleGeneric(t,e,r)),{\"grid-area\":r});i=P`\n          ${i}\n          <div id=${r} class=\"ellipsis\" style=${_t(s)}>${this._unsafeHTMLorNot(n[r])}</div>\n        `}})),Object.keys(r).forEach((n=>{if(null!=r[n]){const s=Object.assign(Object.assign({},this._buildCustomStyleGeneric(t,e,n)),{\"grid-area\":n});let a;$t(this._cardsConfig[n],r[n])?a=this._cards[n]:(a=this._createCard(r[n]),this._cards[n]=a,this._cardsConfig[n]=Ai(r[n])),a.hass=this._hass,i=P`\n          ${i}\n          <div\n            id=${n}\n            @action=${this._stopPropagation}\n            @click=${this._stopPropagation}\n            @touchstart=${this._stopPropagation}\n            @mousedown=${this._stopPropagation}\n            @mouseup=${this._stopPropagation}\n            @touchend=${this._stopPropagation}\n            @touchcancel=${this._stopPropagation}\n            style=${_t(s)}\n          >\n            ${a}\n          </div>\n        `}})),i}_hasChildCards(t){return!!t&&Object.keys(t).some((e=>!!t[e].card))}_isClickable(t,e){const i=this._getTemplateOrValue(t,this._config.tap_action.action),n=this._getTemplateOrValue(t,this._config.hold_action.action),r=this._getTemplateOrValue(t,this._config.double_tap_action.action),s=this._hasChildCards(this._config.custom_fields)||!(!e||!this._hasChildCards(e.custom_fields));return\"none\"!=i||\"none\"!=n||\"none\"!=r||s}_rotate(t){return!!(null==t?void 0:t.spin)}_blankCardColoredHtml(t){const e=Object.assign({background:\"none\",\"box-shadow\":\"none\",\"border-style\":\"none\"},t);return P`\n      <ha-card class=\"disabled\" style=${_t(e)}>\n        <div></div>\n      </ha-card>\n    `}_cardHtml(){var t,e,i,n;const r=this._getMatchingConfigState(this._stateObj);let s=\"var(--state-inactive-color)\";(null==r?void 0:r.color)&&!Xt.includes(r.color)?s=r.color:(null===(t=this._config)||void 0===t?void 0:t.color)&&!Xt.includes(this._config.color)?this._stateObj?ae(this._stateObj)&&(s=(null===(e=this._config)||void 0===e?void 0:e.color)||s):s=this._config.color:s=this._buildCssColorAttribute(this._stateObj,r);let a=s,o={},l={};const c={},h=this._buildStyleGeneric(this._stateObj,r,\"lock\"),u=this._buildStyleGeneric(this._stateObj,r,\"card\"),d=this._buildStyleGeneric(this._stateObj,r,\"tooltip\"),f={\"button-card-main\":!0,disabled:!this._isClickable(this._stateObj,r)};switch((null===(i=this._config)||void 0===i?void 0:i.tooltip)&&this.classList.add(\"tooltip\"),u.width&&(this.style.setProperty(\"flex\",\"0 0 auto\"),this.style.setProperty(\"max-width\",\"fit-content\")),this._config.color_type){case\"blank-card\":return this._blankCardColoredHtml(u);case\"card\":case\"label-card\":{const t=function(t,e){const i=new qt(ne(t,e)).getLuminance(),n=new qt({r:225,g:225,b:225}),r=n.getLuminance(),s=new qt({r:28,g:28,b:28}),a=s.getLuminance();return 0===i||(Math.max(i,r)+.05)/Math.min(i,r+.05)>(Math.max(i,a)+.05)/Math.min(i,a+.05)?n.toRgbString():s.toRgbString()}(this,s);o.color=t,l.color=t,o[\"background-color\"]=s,o=Object.assign(Object.assign({},o),u),a=\"inherit\";break}default:o=u}this._config.aspect_ratio?(c[\"--aspect-ratio\"]=this._config.aspect_ratio,o.position=\"absolute\"):c.display=\"inline\",this.style.setProperty(\"--button-card-light-color\",this._getColorForLightEntity(this._stateObj,!0)),this.style.setProperty(\"--button-card-light-color-no-temperature\",this._getColorForLightEntity(this._stateObj,!1)),l=Object.assign(Object.assign({},l),h);const p=this._config.extra_styles?P`\n          <style>\n            ${this._getTemplateOrValue(this._stateObj,this._config.extra_styles)}\n          </style>\n        `:P``;return P`\n      ${p}\n      <div id=\"aspect-ratio\" style=${_t(c)}>\n        <ha-card\n          id=\"card\"\n          class=${yt(f)}\n          style=${_t(o)}\n          @action=${this._handleAction}\n          @focus=\"${this.handleRippleFocus}\"\n          @blur=\"${this.handleRippleBlur}\"\n          @mousedown=\"${this.handleRippleActivate}\"\n          @mouseup=\"${this.handleRippleDeactivate}\"\n          @touchstart=\"${this.handleRippleActivate}\"\n          @touchend=\"${this.handleRippleDeactivate}\"\n          @touchcancel=\"${this.handleRippleDeactivate}\"\n          .actionHandler=${St({hasDoubleClick:\"none\"!==this._config.double_tap_action.action,hasHold:\"none\"!==this._config.hold_action.action,repeat:this._config.hold_action.repeat,repeatLimit:this._config.hold_action.repeat_limit})}\n          .config=\"${this._config}\"\n        >\n          ${this._buttonContent(this._stateObj,r,a)}\n          <mwc-ripple id=\"ripple\"></mwc-ripple>\n        </ha-card>\n        ${this._getLock(l)}\n      </div>\n      ${(null===(n=this._config)||void 0===n?void 0:n.tooltip)?P`\n            <span class=\"tooltiptext\" style=${_t(d)}>\n              ${this._getTemplateOrValue(this._stateObj,this._config.tooltip)}\n            </span>\n          `:\"\"}\n    `}_getLock(t){return this._config.lock&&this._getTemplateOrValue(this._stateObj,this._config.lock.enabled)?P`\n        <div\n          id=\"overlay\"\n          style=${_t(t)}\n          @action=${this._handleUnlockType}\n          .actionHandler=${St({hasDoubleClick:\"double_tap\"===this._config.lock.unlock,hasHold:\"hold\"===this._config.lock.unlock})}\n          .config=\"${this._config}\"\n        >\n          <ha-icon id=\"lock\" icon=\"mdi:lock-outline\"></ha-icon>\n        </div>\n      `:P``}_buttonContent(t,e,i){const n=this._buildName(t,e),r=(null==e?void 0:e.state_display)||this._config.state_display||void 0,s=this._config.show_state&&r?this._getTemplateOrValue(t,r):void 0,a=s||this._buildStateString(t),o=function(t,e){if(!t&&!e)return;let i;return i=e?t?`${t}: ${e}`:e:t,i}(n,a);switch(this._config.layout){case\"icon_name_state\":case\"name_state\":return this._gridHtml(t,e,this._config.layout,i,o,void 0);default:return this._gridHtml(t,e,this._config.layout,i,n,a)}}_unsafeHTMLorNot(t){return t.strings||t.values?t:bt(`${t}`)}_gridHtml(t,e,i,n,r,s){const a=this._getIconHtml(t,e,n),o=[i],l=this._buildLabel(t,e),c=this._buildStyleGeneric(t,e,\"name\"),h=this._buildStyleGeneric(t,e,\"state\"),u=this._buildStyleGeneric(t,e,\"label\"),d=this._buildLastChanged(t,u),f=this._buildStyleGeneric(t,e,\"grid\");return a||o.push(\"no-icon\"),r||o.push(\"no-name\"),s||o.push(\"no-state\"),l||d||o.push(\"no-label\"),P`\n      <div id=\"container\" class=${o.join(\" \")} style=${_t(f)}>\n        ${a||\"\"}\n        ${r?P`\n              <div id=\"name\" class=\"ellipsis\" style=${_t(c)}>\n                ${this._unsafeHTMLorNot(r)}\n              </div>\n            `:\"\"}\n        ${s?P`\n              <div id=\"state\" class=\"ellipsis\" style=${_t(h)}>\n                ${this._unsafeHTMLorNot(s)}\n              </div>\n            `:\"\"}\n        ${l&&!d?P`\n              <div id=\"label\" class=\"ellipsis\" style=${_t(u)}>\n                ${this._unsafeHTMLorNot(l)}\n              </div>\n            `:\"\"}\n        ${d||\"\"} ${this._buildCustomFields(t,e)}\n      </div>\n    `}_getIconHtml(t,e,i){const n=this._buildIcon(t,e),r=this._buildEntityPicture(t,e),s=this._buildStyleGeneric(t,e,\"entity_picture\"),a=this._buildStyleGeneric(t,e,\"icon\"),o=this._buildStyleGeneric(t,e,\"img_cell\"),l=this._buildStyleGeneric(t,e,\"card\"),c=Object.assign({color:i,width:this._config.size,\"--ha-icon-display\":l.height?\"inline\":void 0,position:this._config.aspect_ratio||l.height?\"absolute\":\"relative\"},a),h=Object.assign(Object.assign({},c),s),u=this._buildLiveStream(h),d=this._config.show_icon&&(n||t);if(d||r){let i;return t&&(i=ie(t.entity_id)),P`\n        <div id=\"img-cell\" style=${_t(o)}>\n          ${!d||r||u?\"\":P`\n                <ha-state-icon\n                  .state=${t}\n                  .stateObj=${t}\n                  .hass=${this._hass}\n                  ?data-domain=${i}\n                  data-state=${(t=>null!=t?t:L)(null==t?void 0:t.state)}\n                  style=${_t(c)}\n                  .icon=\"${n}\"\n                  id=\"icon\"\n                  ?rotating=${this._rotate(e)}\n                ></ha-state-icon>\n              `}\n          ${u||\"\"}\n          ${r&&!u?P`\n                <img\n                  src=\"${r}\"\n                  style=${_t(h)}\n                  id=\"icon\"\n                  ?rotating=${this._rotate(e)}\n                />\n              `:\"\"}\n        </div>\n      `}}_buildLiveStream(t){return this._config.show_live_stream&&this._config.entity&&\"camera\"===ie(this._config.entity)?P`\n        <hui-image\n          .hass=${this._hass}\n          .cameraImage=${this._config.entity}\n          .entity=${this._config.entity}\n          cameraView=\"live\"\n          style=${_t(t)}\n        ></hui-image>\n      `:void 0}_configFromLLTemplates(t,e){const i=e.template;if(!i)return e;let n,r={};const s=i&&Array.isArray(i)?i:[i];return null==s||s.forEach((e=>{var i,s;let a;if(null===(i=t.config.cblcars_card_templates)||void 0===i?void 0:i[e])a=t.config.cblcars_card_templates[e];else{if(!(null===(s=window.cblcars_card_templates)||void 0===s?void 0:s[e]))throw new Error(`LCARS Button-card template '${e}' is missing!`);a=window.cblcars_card_templates[e]}const o=this._configFromLLTemplates(t,a);r=re(r,o),n=se(n,o.state)})),r=re(r,e),r.state=se(n,e.state),r}setConfig(t){if(!t)throw new Error(\"Invalid configuration\");this._initialSetupComplete&&(this._initialSetupComplete=!1),this._cards={},this._cardsConfig={};const e=function(){let t=document.querySelector(\"home-assistant\");if(t=t&&t.shadowRoot,t=t&&t.querySelector(\"home-assistant-main\"),t=t&&t.shadowRoot,t=t&&t.querySelector(\"app-drawer-layout partial-panel-resolver, ha-drawer partial-panel-resolver\"),t=t&&t.shadowRoot||t,t=t&&t.querySelector(\"ha-panel-lovelace\"),t=t&&t.shadowRoot,t=t&&t.querySelector(\"hui-root\"),t){const e=t.lovelace;return e.current_view=t.___curView,e}return null}()||function(){let t=document.querySelector(\"hc-main\");if(t=t&&t.shadowRoot,t=t&&t.querySelector(\"hc-lovelace\"),t=t&&t.shadowRoot,t=t&&(t.querySelector(\"hui-view\")||t.querySelector(\"hui-panel-view\")),t){const e=t.lovelace;return e.current_view=t.___curView,e}return null}();let i=Ai(t);i=this._configFromLLTemplates(e,i),this._config=Object.assign(Object.assign({type:\"custom:cblcars-button-card\",group_expand:!1,hold_action:{action:\"none\"},double_tap_action:{action:\"none\"},layout:\"vertical\",size:\"40%\",color_type:\"icon\",show_name:!0,show_state:!1,show_icon:!0,show_units:!0,show_label:!1,show_entity_picture:!1,show_live_stream:!1,card_size:3},i),{lock:Object.assign({enabled:!1,duration:5,unlock:\"tap\"},i.lock)}),this._initialSetupComplete||this._finishSetup()}_loopGroup(t){t&&t.forEach((t=>{var e,i;(null===(e=this._hass)||void 0===e?void 0:e.states[t])&&((null===(i=this._hass.states[t].attributes)||void 0===i?void 0:i.entity_id)?this._loopGroup(this._hass.states[t].attributes.entity_id):this._entities.includes(t)||this._entities.push(t))}))}_expandTriggerGroups(){var t;this._hass&&(null===(t=this._config)||void 0===t?void 0:t.group_expand)&&this._entities&&this._entities.forEach((t=>{var e,i,n,r,s;(null===(n=null===(i=null===(e=this._hass)||void 0===e?void 0:e.states[t])||void 0===i?void 0:i.attributes)||void 0===n?void 0:n.entity_id)&&this._loopGroup(null===(s=null===(r=this._hass)||void 0===r?void 0:r.states[t].attributes)||void 0===s?void 0:s.entity_id)}))}getCardSize(){var t;return(null===(t=this._config)||void 0===t?void 0:t.card_size)||3}_evalActions(t,e){var i,n,r,s,a;const o=Ai(t),l=t=>t?(Object.keys(t).forEach((e=>{\"object\"==typeof t[e]?t[e]=l(t[e]):t[e]=this._getTemplateOrValue(this._stateObj,t[e])})),t):t;return\"entity\"===(null===(n=null===(i=o[e])||void 0===i?void 0:i.service_data)||void 0===n?void 0:n.entity_id)&&(o[e].service_data.entity_id=t.entity),\"entity\"===(null===(s=null===(r=o[e])||void 0===r?void 0:r.data)||void 0===s?void 0:s.entity_id)&&(o[e].data.entity_id=t.entity),o[e]=l(o[e]),!o[e].confirmation&&o.confirmation&&(o[e].confirmation=l(o.confirmation)),(null===(a=o[e])||void 0===a?void 0:a.entity)&&(o.entity=o[e].entity),o}handleRippleActivate(t){this._ripple.then((e=>e&&\"function\"==typeof e.startPress&&this._rippleHandlers.startPress(t)))}handleRippleDeactivate(){this._ripple.then((t=>t&&\"function\"==typeof t.endPress&&this._rippleHandlers.endPress()))}handleRippleFocus(){this._ripple.then((t=>t&&\"function\"==typeof t.startFocus&&this._rippleHandlers.startFocus()))}handleRippleBlur(){this._ripple.then((t=>t&&\"function\"==typeof t.endFocus&&this._rippleHandlers.endFocus()))}_handleAction(t){var e;if(null===(e=t.detail)||void 0===e?void 0:e.action)switch(t.detail.action){case\"tap\":case\"hold\":case\"double_tap\":const e=this._config;if(!e)return;const i=t.detail.action,n=this._evalActions(e,`${i}_action`);(async(t,e,i,n)=>{wt(t,\"hass-action\",{config:i,action:n})})(this,this._hass,n,i)}}_handleUnlockType(t){const e=this._config;e&&e.lock.unlock===t.detail.action&&this._handleLock()}_handleLock(){var t;const e=this.shadowRoot.getElementById(\"lock\");if(!e)return;if(this._config.lock.exemptions){if(!(null===(t=this._hass.user)||void 0===t?void 0:t.name)||!this._hass.user.id)return;let i=!1;if(this._config.lock.exemptions.forEach((t=>{var e,n;(!i&&t.user===(null===(e=this._hass.user)||void 0===e?void 0:e.id)||t.username===(null===(n=this._hass.user)||void 0===n?void 0:n.name))&&(i=!0)})),!i)return e.classList.add(\"invalid\"),void window.setTimeout((()=>{e&&e.classList.remove(\"invalid\")}),3e3)}const i=this.shadowRoot.getElementById(\"overlay\");if(i.style.setProperty(\"pointer-events\",\"none\"),e){const t=document.createAttribute(\"icon\");t.value=\"mdi:lock-open-outline\",e.attributes.setNamedItem(t),e.classList.add(\"hidden\")}window.setTimeout((()=>{if(i.style.setProperty(\"pointer-events\",\"\"),e){e.classList.remove(\"hidden\");const t=document.createAttribute(\"icon\");t.value=\"mdi:lock-outline\",e.attributes.setNamedItem(t)}}),1e3*this._config.lock.duration)}_stopPropagation(t){t.stopPropagation()}};t([at()],Ci.prototype,\"_hass\",void 0),t([at()],Ci.prototype,\"_config\",void 0),t([at()],Ci.prototype,\"_timeRemaining\",void 0),t([function(t){return ot({descriptor:e=>({async get(){var e;return await this.updateComplete,null===(e=this.renderRoot)||void 0===e?void 0:e.querySelector(t)},enumerable:!0,configurable:!0})})}(\"mwc-ripple\")],Ci.prototype,\"_ripple\",void 0),t([lt({passive:!0})],Ci.prototype,\"handleRippleActivate\",null),t([lt({passive:!0})],Ci.prototype,\"handleRippleDeactivate\",null),t([lt({passive:!0})],Ci.prototype,\"handleRippleFocus\",null),t([lt({passive:!0})],Ci.prototype,\"handleRippleBlur\",null),t([lt({passive:!0})],Ci.prototype,\"_handleAction\",null),t([lt({passive:!0})],Ci.prototype,\"_handleUnlockType\",null),t([lt({passive:!0})],Ci.prototype,\"_handleLock\",null),t([lt({passive:!0})],Ci.prototype,\"_stopPropagation\",null),Ci=t([(t=>e=>\"function\"==typeof e?((t,e)=>(customElements.define(t,e),e))(t,e):((t,e)=>{const{kind:i,elements:n}=e;return{kind:i,elements:n,finisher(e){customElements.define(t,e)}}})(t,e))(\"cblcars-button-card\")],Ci);export{Ci as ButtonCard};\n","// Extract anchor points from SVG content\n\nexport function findSvgAnchors(svgContent) {\n  const anchors = {};\n  // Improved <circle> extraction: match cx/cy in any order\n  const circleRegex = /<circle[^>]*id=\"([^\"]+)\"[^>]*>/g;\n  let m;\n  while ((m = circleRegex.exec(svgContent)) !== null) {\n    const id = m[1];\n    const tag = m[0];\n    const cxMatch = tag.match(/\\scx=\"([^\"]+)\"/);\n    const cyMatch = tag.match(/\\scy=\"([^\"]+)\"/);\n    if (cxMatch && cyMatch) {\n      anchors[id] = [parseFloat(cxMatch[1]), parseFloat(cyMatch[1])];\n    }\n  }\n\n  // Improved <text> extraction: match x/y in any order\n  const textRegex = /<text[^>]*id=\"([^\"]+)\"[^>]*>/g;\n  while ((m = textRegex.exec(svgContent)) !== null) {\n    const id = m[1];\n    // Extract x and y attributes from the tag\n    const tag = m[0];\n    const xMatch = tag.match(/\\sx=\"([^\"]+)\"/);\n    const yMatch = tag.match(/\\sy=\"([^\"]+)\"/);\n    if (xMatch && yMatch) {\n      anchors[id] = [parseFloat(xMatch[1]), parseFloat(yMatch[1])];\n    }\n  }\n  // <g id=\"anchor\">\n  const groupRegex = /<g[^>]*id=\"([^\"]+)\"[^>]*>/g;\n  while ((m = groupRegex.exec(svgContent)) !== null) {\n    anchors[m[1]] = null; // Optionally: calculate centroid if needed\n  }\n  return anchors;\n}\n\nexport function getSvgContent(base_svg) {\n  let svgKey = null;\n  if (base_svg && base_svg.startsWith('builtin:')) {\n    svgKey = base_svg.replace('builtin:', '');\n  } else if (base_svg && base_svg.startsWith('/local/')) {\n    svgKey = base_svg.split('/').pop().replace('.svg','');\n  }\n  return svgKey && window.cblcars?.msd?.svg_templates?.[svgKey];\n}\n\nexport function getSvgViewBox(svgContent) {\n  const match = svgContent && svgContent.match(/viewBox=\"([0-9.\\-]+)\\s+([0-9.\\-]+)\\s+([0-9.\\-]+)\\s+([0-9.\\-]+)\"/);\n  if (match) {\n    return [parseFloat(match[1]), parseFloat(match[2]), parseFloat(match[3]), parseFloat(match[4])];\n  }\n  return [0, 0, 400, 200];\n}\n\nexport function getSvgAspectRatio(viewBox) {\n  return viewBox[2] && viewBox[3] ? (viewBox[2] / viewBox[3]) : 2;\n}\n\n\n","/**\n * Canonical checksum generation for MSD configurations\n * Uses Web Crypto API for browser compatibility\n */\n\nexport async function computeCanonicalChecksum(obj) {\n  const cleaned = stripMetaFields(obj);\n  const stable = stableStringify(cleaned);\n\n  // Use Web Crypto API (available in browsers and Node 16+)\n  const encoder = new TextEncoder();\n  const data = encoder.encode(stable);\n  const hashBuffer = await crypto.subtle.digest('SHA-256', data);\n  const hashArray = new Uint8Array(hashBuffer);\n  const hashHex = Array.from(hashArray)\n    .map(b => b.toString(16).padStart(2, '0'))\n    .join('');\n\n  // Return first 10 characters for readability\n  return hashHex.substring(0, 10);\n}\n\nfunction stripMetaFields(obj) {\n  if (obj === null || typeof obj !== 'object') {\n    return obj;\n  }\n\n  if (Array.isArray(obj)) {\n    return obj.map(stripMetaFields);\n  }\n\n  const cleaned = {};\n\n  for (const [key, value] of Object.entries(obj)) {\n    // Skip metadata fields that don't affect semantic meaning\n    if (key.startsWith('__') ||\n        key === 'checksum' ||\n        key === 'origin_pack' ||\n        key === 'timestamp') {\n      continue;\n    }\n\n    cleaned[key] = stripMetaFields(value);\n  }\n\n  return cleaned;\n}\n\nfunction stableStringify(obj) {\n  if (obj === null || typeof obj !== 'object') {\n    return JSON.stringify(obj);\n  }\n\n  if (Array.isArray(obj)) {\n    const items = obj.map(stableStringify);\n    return `[${items.join(',')}]`;\n  }\n\n  // Sort object keys for deterministic output\n  const sortedKeys = Object.keys(obj).sort();\n  const pairs = sortedKeys.map(key => {\n    const value = stableStringify(obj[key]);\n    return `\"${key}\":${value}`;\n  });\n\n  return `{${pairs.join(',')}}`;\n}\n\n/**\n * Compare two objects for semantic equality (ignoring metadata)\n */\nexport function semanticEquals(obj1, obj2) {\n  const clean1 = stripMetaFields(obj1);\n  const clean2 = stripMetaFields(obj2);\n  return stableStringify(clean1) === stableStringify(clean2);\n}\n","/**\n * Performance tracking and instrumentation for MSD pipeline\n * Provides detailed timing and counter metrics for optimization\n */\n\nclass PerformanceTracker {\n  constructor() {\n    this.counters = new Map();\n    this.timings = new Map();\n    this.sessionStart = performance.now();\n  }\n\n  /**\n   * Add timing measurement\n   */\n  addTiming(key, ms, metadata = {}) {\n    if (!this.timings.has(key)) {\n      this.timings.set(key, {\n        last: 0,\n        totalMs: 0,\n        samples: 0,\n        avg: 0,\n        min: Infinity,\n        max: 0,\n        metadata: []\n      });\n    }\n\n    const timing = this.timings.get(key);\n    timing.last = ms;\n    timing.totalMs += ms;\n    timing.samples++;\n    timing.avg = timing.totalMs / timing.samples;\n    timing.min = Math.min(timing.min, ms);\n    timing.max = Math.max(timing.max, ms);\n\n    if (Object.keys(metadata).length > 0) {\n      timing.metadata.push({ ...metadata, ms, timestamp: Date.now() });\n      // Keep only last 10 metadata entries\n      if (timing.metadata.length > 10) {\n        timing.metadata = timing.metadata.slice(-10);\n      }\n    }\n  }\n\n  /**\n   * Add discrete counter\n   */\n  addCount(key, increment = 1, metadata = {}) {\n    if (!this.counters.has(key)) {\n      this.counters.set(key, {\n        count: 0,\n        rate: 0,\n        lastUpdate: performance.now(),\n        metadata: []\n      });\n    }\n\n    const counter = this.counters.get(key);\n    const now = performance.now();\n    const deltaTime = (now - counter.lastUpdate) / 1000; // seconds\n\n    counter.count += increment;\n    counter.rate = deltaTime > 0 ? increment / deltaTime : 0;\n    counter.lastUpdate = now;\n\n    if (Object.keys(metadata).length > 0) {\n      counter.metadata.push({ ...metadata, increment, timestamp: Date.now() });\n      // Keep only last 10 metadata entries\n      if (counter.metadata.length > 10) {\n        counter.metadata = counter.metadata.slice(-10);\n      }\n    }\n  }\n\n  /**\n   * Time a function execution\n   */\n  async timeAsync(key, fn, metadata = {}) {\n    const start = performance.now();\n    try {\n      const result = await fn();\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, metadata);\n      return result;\n    } catch (error) {\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, { ...metadata, error: error.message });\n      throw error;\n    }\n  }\n\n  /**\n   * Time a synchronous function execution\n   */\n  timeSync(key, fn, metadata = {}) {\n    const start = performance.now();\n    try {\n      const result = fn();\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, metadata);\n      return result;\n    } catch (error) {\n      const duration = performance.now() - start;\n      this.addTiming(key, duration, { ...metadata, error: error.message });\n      throw error;\n    }\n  }\n\n  /**\n   * Get all performance data\n   */\n  getAll() {\n    const sessionDuration = performance.now() - this.sessionStart;\n\n    return {\n      session: {\n        duration_ms: sessionDuration,\n        started_at: Date.now() - sessionDuration\n      },\n      timings: Object.fromEntries(this.timings),\n      counters: Object.fromEntries(this.counters),\n      summary: this.getSummary()\n    };\n  }\n\n  /**\n   * Get performance summary for quick overview\n   */\n  getSummary() {\n    const criticalTimings = ['merge.total', 'validation.total', 'render.total'];\n    const criticalCounters = ['rules.eval.count', 'rules.match.count', 'animation.instance.reuse'];\n\n    const summary = {\n      timings: {},\n      counters: {},\n      health: 'good'\n    };\n\n    // Extract critical timing data\n    criticalTimings.forEach(key => {\n      if (this.timings.has(key)) {\n        const timing = this.timings.get(key);\n        summary.timings[key] = {\n          avg: timing.avg,\n          last: timing.last,\n          samples: timing.samples\n        };\n\n        // Health check: mark as warning if average is high\n        if (timing.avg > 50) { // 50ms threshold\n          summary.health = 'warning';\n        }\n        if (timing.avg > 100) { // 100ms threshold\n          summary.health = 'critical';\n        }\n      }\n    });\n\n    // Extract critical counter data\n    criticalCounters.forEach(key => {\n      if (this.counters.has(key)) {\n        const counter = this.counters.get(key);\n        summary.counters[key] = {\n          count: counter.count,\n          rate: counter.rate\n        };\n      }\n    });\n\n    return summary;\n  }\n\n  /**\n   * Reset all performance data\n   */\n  reset() {\n    this.counters.clear();\n    this.timings.clear();\n    this.sessionStart = performance.now();\n  }\n\n  /**\n   * Export performance data for analysis\n   */\n  export(options = {}) {\n    const data = this.getAll();\n\n    if (options.format === 'csv') {\n      return this.exportToCsv(data);\n    }\n\n    if (options.minify) {\n      return this.minifyData(data);\n    }\n\n    return data;\n  }\n\n  minifyData(data) {\n    // Remove metadata and keep only essential metrics\n    const minified = {\n      session: data.session,\n      timings: {},\n      counters: {},\n      summary: data.summary\n    };\n\n    for (const [key, timing] of Object.entries(data.timings)) {\n      minified.timings[key] = {\n        avg: timing.avg,\n        last: timing.last,\n        samples: timing.samples,\n        min: timing.min,\n        max: timing.max\n      };\n    }\n\n    for (const [key, counter] of Object.entries(data.counters)) {\n      minified.counters[key] = {\n        count: counter.count,\n        rate: counter.rate\n      };\n    }\n\n    return minified;\n  }\n}\n\n// Global instance\nconst globalPerfTracker = new PerformanceTracker();\n\n// Utility functions for common operations\nexport function perfTime(key, fn, metadata = {}) {\n  if (typeof fn === 'function') {\n    return globalPerfTracker.timeSync(key, fn, metadata);\n  }\n  // Return timing function for manual timing\n  return {\n    end: (metadata = {}) => {\n      const duration = performance.now() - perfTime.start;\n      globalPerfTracker.addTiming(key, duration, metadata);\n    }\n  };\n}\n\nexport async function perfTimeAsync(key, fn, metadata = {}) {\n  return globalPerfTracker.timeAsync(key, fn, metadata);\n}\n\nexport function perfCount(key, increment = 1, metadata = {}) {\n  globalPerfTracker.addCount(key, increment, metadata);\n}\n\nexport function perfGetAll() {\n  return globalPerfTracker.getAll();\n}\n\nexport function perfGetSummary() {\n  return globalPerfTracker.getSummary();\n}\n\nexport function perfReset() {\n  globalPerfTracker.reset();\n}\n\nexport function perfExport(options = {}) {\n  return globalPerfTracker.export(options);\n}\n\n// Node.js and browser compatibility\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdPerf = {\n    getAll: perfGetAll,\n    getSummary: perfGetSummary,\n    reset: perfReset,\n    export: perfExport\n  };\n}\n","import { computeCanonicalChecksum } from '../util/checksum.js';\nimport { perfTime, perfTimeAsync, perfCount } from '../util/performance.js';\n\n/**\n * Single consolidated merge algorithm - COMPLETE REPLACEMENT\n * Removes all legacy dual merge logic per Milestone 1.1\n */\nexport async function mergePacks(userConfig) {\n  return await perfTimeAsync('merge.total', async () => {\n    const layers = await perfTimeAsync('merge.loadLayers', () => loadAllLayers(userConfig));\n    const merged = await perfTimeAsync('merge.processSingle', () => processSinglePass(layers));\n\n    return merged;\n  }, {\n    config_overlays: userConfig.overlays?.length || 0,\n    config_rules: userConfig.rules?.length || 0,\n    config_anchors: Object.keys(userConfig.anchors || {}).length,\n    use_packs: userConfig.use_packs?.builtin?.length || 0\n  });\n}\n\nasync function loadAllLayers(userConfig) {\n  const layers = [];\n\n  // Load builtin packs first\n  const builtinPacks = userConfig.use_packs?.builtin || ['core'];\n  for (const packName of builtinPacks) {\n    const pack = await loadBuiltinPack(packName);\n    if (pack) {\n      layers.push({\n        type: 'builtin',\n        pack: packName,\n        data: pack,\n        priority: 100\n      });\n    }\n  }\n\n  // Load external packs with timeout\n  if (userConfig.use_packs?.external?.length > 0) {\n    const externalResults = await loadExternalPacks(userConfig.use_packs.external);\n    externalResults.forEach((result, index) => {\n      if (result.data && !result.error) {\n        layers.push({\n          type: 'external',\n          pack: result.url,\n          data: result.data,\n          priority: 200 + index\n        });\n      }\n    });\n  }\n\n  // User config layer (highest priority)\n  layers.push({\n    type: 'user',\n    pack: 'user_config',\n    data: userConfig,\n    priority: 1000\n  });\n\n  return layers.sort((a, b) => a.priority - b.priority);\n}\n\nasync function processSinglePass(layers) {\n  const merged = {\n    version: 1,\n    anchors: {},\n    palettes: {},\n    profiles: [],\n    overlays: [],\n    rules: [],\n    animations: [],\n    timelines: [],\n    routing: {},\n    data_sources: {},\n    active_profiles: ['normal'],\n    __provenance: {\n      anchors: {},\n      palettes: {},\n      overlays: {},\n      rules: {},\n      animations: {},\n      merge_order: []\n    }\n  };\n\n  // Process each layer in priority order\n  for (const layer of layers) {\n    perfTime('merge.processLayer', () => processLayer(merged, layer), {\n      layer: layer.pack,\n      type: layer.type\n    });\n\n    merged.__provenance.merge_order.push({\n      type: layer.type,\n      pack: layer.pack,\n      priority: layer.priority\n    });\n  }\n\n  // Apply removals after all merges\n  perfTime('merge.applyRemovals', () => applyRemovals(merged, layers[layers.length - 1]?.data?.remove));\n\n  // Generate canonical checksum\n  merged.checksum = await perfTimeAsync('merge.checksum', () => computeCanonicalChecksum(merged));\n\n  return merged;\n}\n\nasync function loadBuiltinPack(packName) {\n  // Try debug packs first (for development)\n  try {\n    const dbgPacks = window.__msdDebug?.packs;\n    if (dbgPacks) {\n      const dbgSource = packName === 'core'\n        ? dbgPacks.core\n        : dbgPacks.builtin?.[packName];\n\n      if (dbgSource && typeof dbgSource === 'object') {\n        return dbgSource;\n      }\n    }\n  } catch (e) {\n    // Fallback to normal loading\n  }\n\n  // Normal builtin pack loading would go here\n  // For now, return minimal core pack with simulated SVG anchors\n  if (packName === 'core') {\n    return {\n      version: 1,\n      // Simulate SVG-extracted anchors\n      anchors: {\n        svg_bridge: [200, 150],  // Simulated SVG extraction\n        svg_warp: [350, 200],    // Simulated SVG extraction\n      },\n      _extracted_anchors: ['svg_bridge', 'svg_warp'], // Mark as SVG-extracted\n      profiles: [\n        {\n          id: 'normal',\n          defaults: {\n            line: { color: 'var(--lcars-orange)', width: 2 },\n            text: { color: 'var(--lcars-orange)', font_size: 14 }\n          }\n        }\n      ],\n      palettes: {\n        default: {\n          accent1: 'var(--lcars-orange)',\n          accent2: 'var(--lcars-yellow)',\n          danger: 'var(--lcars-red)',\n          info: 'var(--lcars-cyan)'\n        }\n      }\n    };\n  }\n\n  return null;\n}\n\nasync function loadExternalPacks(urls, options = {}) {\n  const {\n    timeout = 5000,\n    retries = 2,\n    retryDelay = 1000,\n    enableCaching = true\n  } = options;\n\n  const results = [];\n  const perfTracker = {\n    total_packs: urls.length,\n    successful: 0,\n    failed: 0,\n    retried: 0,\n    cached_hits: 0,\n    total_time_ms: 0\n  };\n\n  const startTime = performance.now();\n\n  for (let i = 0; i < urls.length; i++) {\n    const url = urls[i];\n    const packResult = await loadSingleExternalPack(url, {\n      timeout,\n      retries,\n      retryDelay,\n      enableCaching,\n      index: i\n    });\n\n    results.push(packResult);\n\n    // Update performance tracking\n    if (packResult.error) {\n      perfTracker.failed++;\n    } else {\n      perfTracker.successful++;\n    }\n\n    if (packResult.retryCount > 0) {\n      perfTracker.retried++;\n    }\n\n    if (packResult.cached) {\n      perfTracker.cached_hits++;\n    }\n  }\n\n  perfTracker.total_time_ms = performance.now() - startTime;\n\n  // Store performance data for debugging - Node.js compatible\n  try {\n    const debugNamespace = (typeof window !== 'undefined') ? window : global;\n    debugNamespace.__msdDebug = debugNamespace.__msdDebug || {};\n    debugNamespace.__msdDebug._lastExternalPackPerf = perfTracker;\n  } catch (e) {}\n\n  return results;\n}\n\nasync function loadSingleExternalPack(url, options) {\n  const { timeout, retries, retryDelay, enableCaching, index } = options;\n\n  // Check cache first\n  if (enableCaching && externalPackCache.has(url)) {\n    const cached = externalPackCache.get(url);\n    if (Date.now() - cached.timestamp < 300000) { // 5 minute cache\n      return {\n        url,\n        data: cached.data,\n        error: cached.error,\n        cached: true,\n        loadTime: 0,\n        retryCount: 0,\n        index\n      };\n    }\n  }\n\n  let lastError = null;\n  let retryCount = 0;\n\n  for (let attempt = 0; attempt <= retries; attempt++) {\n    const attemptStart = performance.now();\n\n    try {\n      const result = await Promise.race([\n        fetchWithValidation(url),\n        createTimeoutPromise(timeout, url)\n      ]);\n\n      const loadTime = performance.now() - attemptStart;\n\n      // Cache successful result\n      if (enableCaching) {\n        externalPackCache.set(url, {\n          data: result.data,\n          error: null,\n          timestamp: Date.now()\n        });\n      }\n\n      return {\n        url,\n        data: result.data,\n        error: null,\n        cached: false,\n        loadTime,\n        retryCount,\n        index,\n        contentType: result.contentType,\n        size: result.size\n      };\n\n    } catch (error) {\n      lastError = error;\n      retryCount = attempt;\n\n      // Don't retry on certain error types\n      if (error.name === 'ValidationError' ||\n          error.name === 'SyntaxError' ||\n          error.message.includes('404')) {\n        break;\n      }\n\n      // Wait before retry\n      if (attempt < retries) {\n        await new Promise(resolve => setTimeout(resolve, retryDelay * (attempt + 1)));\n      }\n    }\n  }\n\n  // Cache failed result to avoid repeated failures\n  if (enableCaching) {\n    externalPackCache.set(url, {\n      data: null,\n      error: lastError.message,\n      timestamp: Date.now()\n    });\n  }\n\n  return {\n    url,\n    data: null,\n    error: lastError?.message || 'Unknown error',\n    errorType: classifyError(lastError),\n    cached: false,\n    loadTime: 0,\n    retryCount,\n    index\n  };\n}\n\nasync function fetchWithValidation(url) {\n  // Validate URL format\n  try {\n    new URL(url);\n  } catch (e) {\n    const error = new Error(`Invalid URL format: ${url}`);\n    error.name = 'ValidationError';\n    throw error;\n  }\n\n  // Perform fetch\n  const response = await fetch(url);\n\n  if (!response.ok) {\n    throw new Error(`HTTP ${response.status}: ${response.statusText} for ${url}`);\n  }\n\n  // Validate content type\n  const contentType = response.headers.get('content-type') || '';\n  if (!contentType.includes('application/json') && !contentType.includes('text/')) {\n    console.warn(`[MSD] External pack ${url} has unexpected content-type: ${contentType}`);\n  }\n\n  // Parse JSON with size limits\n  const text = await response.text();\n  if (text.length > 1024 * 1024) { // 1MB limit\n    throw new Error(`External pack ${url} too large: ${text.length} bytes (max 1MB)`);\n  }\n\n  let data;\n  try {\n    data = JSON.parse(text);\n  } catch (e) {\n    const error = new Error(`Invalid JSON in external pack ${url}: ${e.message}`);\n    error.name = 'SyntaxError';\n    throw error;\n  }\n\n  // Basic MSD structure validation\n  if (data && typeof data === 'object') {\n    validateExternalPackStructure(data, url);\n  }\n\n  return {\n    data,\n    contentType,\n    size: text.length\n  };\n}\n\nfunction createTimeoutPromise(timeout, url) {\n  return new Promise((_, reject) => {\n    setTimeout(() => {\n      const error = new Error(`Timeout loading external pack: ${url} (${timeout}ms)`);\n      error.name = 'TimeoutError';\n      reject(error);\n    }, timeout);\n  });\n}\n\nfunction validateExternalPackStructure(data, url) {\n  // Basic validation - ensure it looks like an MSD pack\n  const validFields = ['version', 'anchors', 'overlays', 'rules', 'animations', 'profiles', 'palettes', 'timelines'];\n  const dataFields = Object.keys(data);\n  const hasValidField = validFields.some(field => dataFields.includes(field));\n\n  if (!hasValidField) {\n    console.warn(`[MSD] External pack ${url} doesn't contain recognized MSD fields`);\n  }\n\n  // Check for required ID fields in collections\n  const collections = ['overlays', 'rules', 'animations', 'profiles'];\n  collections.forEach(collection => {\n    if (Array.isArray(data[collection])) {\n      data[collection].forEach((item, index) => {\n        if (!item.id) {\n          console.warn(`[MSD] External pack ${url} ${collection}[${index}] missing required 'id' field`);\n        }\n      });\n    }\n  });\n}\n\nfunction classifyError(error) {\n  if (!error) return 'unknown';\n\n  if (error.name === 'TimeoutError') return 'timeout';\n  if (error.name === 'ValidationError') return 'validation';\n  if (error.name === 'SyntaxError') return 'syntax';\n  if (error.message.includes('404')) return 'not_found';\n  if (error.message.includes('403')) return 'forbidden';\n  if (error.message.includes('network')) return 'network';\n\n  return 'unknown';\n}\n\n// Simple cache for external packs\nconst externalPackCache = new Map();\n\n// Export for testing\nexport { externalPackCache };\n\nasync function processLayer(merged, layer) {\n  const collections = ['overlays', 'rules', 'animations', 'profiles', 'timelines'];\n\n  // Process collections with ID-based merging\n  for (const collection of collections) {\n    if (layer.data[collection] && Array.isArray(layer.data[collection])) {\n      perfTime(`merge.collection.${collection}`, () => {\n        // Initialize provenance collection if missing\n        if (!merged.__provenance[collection]) {\n          merged.__provenance[collection] = {};\n        }\n\n        for (const item of layer.data[collection]) {\n          if (!item.id) continue;\n\n          // Handle inline removal\n          if (item.remove === true) {\n            const index = merged[collection].findIndex(existing => existing.id === item.id);\n            if (index >= 0) {\n              merged[collection].splice(index, 1);\n              merged.__provenance[collection][item.id] = {\n                ...(merged.__provenance[collection][item.id] || {}),\n                removed: true,\n                removal_source: layer.pack\n              };\n            }\n            continue;\n          }\n\n          // Normal merge\n          const existingIndex = merged[collection].findIndex(existing => existing.id === item.id);\n          const cloned = structuredClone(item);\n          delete cloned.remove;\n\n          if (existingIndex >= 0) {\n            // Override existing\n            merged[collection][existingIndex] = cloned;\n            merged.__provenance[collection][item.id] = {\n              origin_pack: merged.__provenance[collection][item.id]?.origin_pack || layer.pack,\n              overridden: true,\n              override_layer: layer.pack\n            };\n          } else {\n            // Add new\n            merged[collection].push(cloned);\n            merged.__provenance[collection][item.id] = {\n              origin_pack: layer.pack,\n              overridden: false\n            };\n          }\n        }\n\n        // Track items processed\n        perfCount(`merge.items.${collection}`, layer.data[collection].length);\n      });\n    }\n  }\n\n  // Enhanced token-level palette merging\n  if (layer.data.palettes) {\n    perfTime('merge.palettes', () => {\n      merged.palettes = merged.palettes || {};\n      // Initialize palette provenance if missing\n      if (!merged.__provenance.palettes) {\n        merged.__provenance.palettes = {};\n      }\n\n      for (const [paletteName, tokens] of Object.entries(layer.data.palettes)) {\n        if (typeof tokens === 'object' && !Array.isArray(tokens)) {\n          // Initialize palette if it doesn't exist\n          if (!merged.palettes[paletteName]) {\n            merged.palettes[paletteName] = {};\n            merged.__provenance.palettes[paletteName] = {\n              origin_pack: layer.pack,\n              tokens: {},\n              overridden: false\n            };\n          }\n\n          // Initialize token-level provenance tracking for this palette\n          if (!merged.__provenance.palettes[paletteName].tokens) {\n            merged.__provenance.palettes[paletteName].tokens = {};\n          }\n\n          // Process each token individually\n          for (const [tokenName, value] of Object.entries(tokens)) {\n            const tokenExisted = merged.palettes[paletteName][tokenName] !== undefined;\n            const previousValue = merged.palettes[paletteName][tokenName];\n\n            // Set the token value\n            merged.palettes[paletteName][tokenName] = value;\n\n            // Track token-level provenance\n            if (tokenExisted) {\n              // Token is being overridden\n              merged.__provenance.palettes[paletteName].tokens[tokenName] = {\n                origin_pack: merged.__provenance.palettes[paletteName].tokens[tokenName]?.origin_pack || 'unknown',\n                current_value: value,\n                previous_value: previousValue,\n                overridden: true,\n                override_pack: layer.pack,\n                override_history: [\n                  ...(merged.__provenance.palettes[paletteName].tokens[tokenName]?.override_history || []),\n                  {\n                    pack: layer.pack,\n                    value: value,\n                    timestamp: Date.now()\n                  }\n                ]\n              };\n            } else {\n              // New token\n              merged.__provenance.palettes[paletteName].tokens[tokenName] = {\n                origin_pack: layer.pack,\n                current_value: value,\n                overridden: false,\n                override_history: []\n              };\n            }\n          }\n\n          // Update palette-level provenance\n          if (merged.__provenance.palettes[paletteName].origin_pack !== layer.pack) {\n            merged.__provenance.palettes[paletteName].overridden = true;\n            merged.__provenance.palettes[paletteName].last_modified_by = layer.pack;\n          }\n        }\n      }\n\n      // Count processed palettes and tokens\n      let tokenCount = 0;\n      Object.values(layer.data.palettes).forEach(tokens => {\n        if (typeof tokens === 'object' && !Array.isArray(tokens)) {\n          tokenCount += Object.keys(tokens).length;\n        }\n      });\n\n      perfCount('merge.palette.tokens', tokenCount);\n      perfCount('merge.palettes', Object.keys(layer.data.palettes).length);\n    });\n  }\n\n  // Enhanced anchor processing with comprehensive provenance\n  if (layer.data.anchors) {\n    perfTime('merge.anchors', () => {\n      for (const [anchorId, coordinates] of Object.entries(layer.data.anchors)) {\n        const existed = anchorId in merged.anchors;\n        const previousCoordinates = merged.anchors[anchorId];\n\n        // Set the anchor coordinates\n        merged.anchors[anchorId] = coordinates;\n\n        // Determine origin type for this layer\n        const originType = determineAnchorOriginType(layer, anchorId);\n\n        if (existed) {\n          // Anchor is being overridden\n          const existingProvenance = merged.__provenance.anchors[anchorId];\n\n          merged.__provenance.anchors[anchorId] = {\n            origin_pack: existingProvenance?.origin_pack || 'unknown',\n            origin_type: existingProvenance?.origin_type || 'unknown',\n            coordinates: coordinates,\n            overridden: true,\n            override_source: layer.pack,\n            override_type: originType,\n            previous_coordinates: previousCoordinates,\n            override_history: [\n              ...(existingProvenance?.override_history || []),\n              {\n                pack: layer.pack,\n                type: originType,\n                coordinates: coordinates,\n                previous_coordinates: previousCoordinates,\n                timestamp: Date.now()\n              }\n            ]\n          };\n        } else {\n          // New anchor\n          merged.__provenance.anchors[anchorId] = {\n            origin_pack: layer.pack,\n            origin_type: originType,\n            coordinates: coordinates,\n            overridden: false,\n            override_history: []\n          };\n        }\n      }\n\n      perfCount('merge.anchors', Object.keys(layer.data.anchors).length);\n    });\n  }\n\n  // Process other top-level properties\n  if (layer.data.routing) {\n    merged.routing = { ...merged.routing, ...layer.data.routing };\n  }\n\n  if (layer.data.data_sources) {\n    merged.data_sources = { ...merged.data_sources, ...layer.data.data_sources };\n  }\n\n  // Process debug configuration\n  if (layer.data.debug) {\n    merged.debug = { ...merged.debug, ...layer.data.debug };\n\n    // Track debug config provenance\n    if (!merged.__provenance.debug) {\n      merged.__provenance.debug = {\n        origin_pack: layer.pack,\n        overridden: false\n      };\n    } else {\n      merged.__provenance.debug.overridden = true;\n      merged.__provenance.debug.override_layer = layer.pack;\n    }\n  }\n\n  if (Array.isArray(layer.data.active_profiles)) {\n    merged.active_profiles = [...layer.data.active_profiles];\n  }\n}\n\nfunction determineAnchorOriginType(layer, anchorId) {\n  // Determine the origin type based on layer characteristics\n  if (layer.type === 'builtin' || layer.type === 'external') {\n    // For builtin/external packs, check if this looks like an SVG-extracted anchor\n    if (layer.data._extracted_anchors && layer.data._extracted_anchors.includes(anchorId)) {\n      return 'svg';\n    }\n    return 'pack';\n  }\n\n  if (layer.type === 'user') {\n    // User-defined anchors\n    return 'user';\n  }\n\n  return 'unknown';\n}\n\nfunction applyRemovals(merged, removals) {\n  if (!removals || typeof removals !== 'object') return;\n\n  const collections = ['overlays', 'rules', 'animations', 'profiles', 'timelines'];\n\n  for (const collection of collections) {\n    const removeIds = removals[collection];\n    if (Array.isArray(removeIds)) {\n      for (const removeId of removeIds) {\n        const index = merged[collection].findIndex(item => item.id === removeId);\n        if (index >= 0) {\n          merged[collection].splice(index, 1);\n          merged.__provenance[collection][removeId] = {\n            ...(merged.__provenance[collection][removeId] || {}),\n            removed: true,\n            removal_source: 'global'\n          };\n        }\n      }\n    }\n  }\n}\n\n/**\n * Export collapsed user configuration\n */\nexport function exportCollapsed(userMsd) {\n  const out = {};\n  const keep = [\n    'version', 'use_packs', 'anchors', 'overlays', 'animations',\n    'rules', 'profiles', 'timelines', 'palettes', 'routing',\n    'active_profiles', 'remove', 'debug'\n  ];\n\n  keep.forEach(k => {\n    if (userMsd && userMsd[k] !== undefined) {\n      out[k] = userMsd[k];\n    }\n  });\n\n  return out;\n}\n\n// Attach debug helpers\ntry {\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.packs = window.__msdDebug.packs || {};\n    window.__msdDebug.packs.mergePacks = mergePacks;\n    window.__msdDebug.exportCollapsed = () => exportCollapsed(window.__msdDebug._hudUserMsdConfig || {});\n  }\n} catch (e) {\n  // Ignore in Node.js environments\n}\n","/**\n * MSD Configuration Validation - Following Ratified Schema V1\n * Validates merged configuration against schema requirements\n */\n\nexport function validateMerged(config) {\n  const issues = {\n    errors: [],\n    warnings: []\n  };\n\n  if (!config || typeof config !== 'object') {\n    issues.errors.push({\n      code: 'config.invalid',\n      message: 'Configuration must be an object'\n    });\n    return issues;\n  }\n\n  // Core validation functions\n  validateStructure(config, issues);\n  validateAnchors(config, issues);\n  validateOverlays(config, issues);\n  validateRules(config, issues);\n  validateAnimations(config, issues);\n  validateProfiles(config, issues);\n  validatePalettes(config, issues);\n  validateRouting(config, issues);\n  validateDuplicateIds(config, issues);\n\n  return issues;\n}\n\nfunction validateStructure(config, issues) {\n  // Version validation\n  if (!config.version) {\n    issues.warnings.push({\n      code: 'version.missing',\n      message: 'Missing version field - assuming version 1'\n    });\n  } else if (typeof config.version !== 'number' || config.version !== 1) {\n    issues.errors.push({\n      code: 'version.invalid',\n      message: 'Version must be 1 (only supported version)'\n    });\n  }\n\n  // View box validation\n  if (config.view_box !== undefined) {\n    const vb = config.view_box;\n    if (vb !== 'auto' && (!Array.isArray(vb) || vb.length !== 4 || !vb.every(n => typeof n === 'number'))) {\n      issues.errors.push({\n        code: 'view_box.invalid',\n        message: 'view_box must be \"auto\" or array of 4 numbers [x, y, width, height]'\n      });\n    }\n  }\n}\n\nfunction validateAnchors(config, issues) {\n  if (!config.anchors) return;\n\n  Object.entries(config.anchors).forEach(([anchorId, coordinates]) => {\n    if (!Array.isArray(coordinates) || coordinates.length !== 2) {\n      issues.errors.push({\n        code: 'anchor.coordinates.invalid',\n        anchor_id: anchorId,\n        message: `Anchor '${anchorId}' coordinates must be array of 2 elements [x, y]`\n      });\n      return;\n    }\n\n    coordinates.forEach((coord, index) => {\n      const axis = index === 0 ? 'x' : 'y';\n      if (typeof coord === 'string') {\n        // Percentage validation\n        if (!coord.endsWith('%') || isNaN(parseFloat(coord.slice(0, -1)))) {\n          issues.errors.push({\n            code: 'anchor.coordinates.invalid',\n            anchor_id: anchorId,\n            message: `Anchor '${anchorId}' ${axis}-coordinate '${coord}' must be number or percentage string`\n          });\n        }\n      } else if (typeof coord !== 'number') {\n        issues.errors.push({\n          code: 'anchor.coordinates.invalid',\n          anchor_id: anchorId,\n          message: `Anchor '${anchorId}' ${axis}-coordinate must be number or percentage string`\n        });\n      }\n    });\n  });\n}\n\nfunction validateOverlays(config, issues) {\n  if (!config.overlays) return;\n\n  const anchors = new Set(Object.keys(config.anchors || {}));\n\n  // Add overlay IDs as \"virtual anchors\" - any overlay can be an attachment target\n  config.overlays.forEach(overlay => {\n    if (overlay && overlay.id) {\n      anchors.add(overlay.id); // Make overlay IDs valid anchor targets\n    }\n  });\n\n  config.overlays.forEach(overlay => {\n    if (!overlay.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'overlays',\n        message: 'Overlay missing required id field'\n      });\n      return;\n    }\n\n    if (!overlay.type) {\n      issues.errors.push({\n        code: 'overlay.type.missing',\n        overlay_id: overlay.id,\n        message: `Overlay '${overlay.id}' missing required type field`\n      });\n    }\n\n    // Validate position/anchor references\n    ['anchor', 'attach_to'].forEach(field => {\n      if (overlay[field]) {\n        if (typeof overlay[field] === 'string' && !anchors.has(overlay[field])) {\n          issues.errors.push({\n            code: 'anchor.missing',\n            collection: 'overlays',\n            item_id: overlay.id,\n            anchor: overlay[field],\n            message: `Overlay '${overlay.id}' references missing anchor '${overlay[field]}'`\n          });\n        } else if (Array.isArray(overlay[field])) {\n          validateCoordinateArray(overlay[field], issues, `Overlay '${overlay.id}' ${field}`);\n        }\n      }\n    });\n\n    if (overlay.position && Array.isArray(overlay.position)) {\n      validateCoordinateArray(overlay.position, issues, `Overlay '${overlay.id}' position`);\n    }\n\n    // Validate animation references\n    if (overlay.animation_ref && config.animations) {\n      const animExists = config.animations.some(anim => anim.id === overlay.animation_ref);\n      if (!animExists) {\n        issues.errors.push({\n          code: 'animation.missing',\n          overlay_id: overlay.id,\n          animation_ref: overlay.animation_ref,\n          message: `Overlay '${overlay.id}' references missing animation '${overlay.animation_ref}'`\n        });\n      }\n    }\n  });\n}\n\nfunction validateRules(config, issues) {\n  if (!config.rules) return;\n\n  config.rules.forEach(rule => {\n    if (!rule.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'rules',\n        message: 'Rule missing required id field'\n      });\n      return;\n    }\n\n    if (!rule.when) {\n      issues.errors.push({\n        code: 'rule.when.missing',\n        rule_id: rule.id,\n        message: `Rule '${rule.id}' missing required when conditions`\n      });\n      return;\n    }\n\n    // Validate when conditions structure\n    const hasAll = Array.isArray(rule.when.all);\n    const hasAny = Array.isArray(rule.when.any);\n\n    if (!hasAll && !hasAny) {\n      issues.errors.push({\n        code: 'rule.when.invalid',\n        rule_id: rule.id,\n        message: `Rule '${rule.id}' when must have 'all' or 'any' array of conditions`\n      });\n    }\n\n    // Validate time_between format\n    [...(rule.when.all || []), ...(rule.when.any || [])].forEach(condition => {\n      if (condition.time_between) {\n        if (!/^\\d{2}:\\d{2}-\\d{2}:\\d{2}$/.test(condition.time_between)) {\n          issues.errors.push({\n            code: 'rule.time_between.invalid',\n            rule_id: rule.id,\n            message: `Rule '${rule.id}' time_between must be format \"HH:MM-HH:MM\"`\n          });\n        }\n      }\n\n      // Validate regex patterns\n      if (condition.regex) {\n        try {\n          new RegExp(condition.regex);\n        } catch (e) {\n          issues.warnings.push({\n            code: 'rule.regex.invalid',\n            rule_id: rule.id,\n            message: `Rule '${rule.id}' has invalid regex pattern - rule will be ignored`\n          });\n        }\n      }\n    });\n\n    // Validate priority\n    if (rule.priority !== undefined && (!Number.isInteger(rule.priority))) {\n      issues.errors.push({\n        code: 'rule.priority.invalid',\n        rule_id: rule.id,\n        message: `Rule '${rule.id}' priority must be an integer`\n      });\n    }\n  });\n}\n\nfunction validateAnimations(config, issues) {\n  if (!config.animations) return;\n\n  config.animations.forEach(animation => {\n    if (!animation.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'animations',\n        message: 'Animation missing required id field'\n      });\n      return;\n    }\n\n    if (!animation.preset) {\n      issues.errors.push({\n        code: 'animation.preset.missing',\n        animation_id: animation.id,\n        message: `Animation '${animation.id}' missing required preset field`\n      });\n    }\n\n    // Validate duration\n    if (animation.params?.duration && typeof animation.params.duration !== 'number') {\n      issues.errors.push({\n        code: 'animation.duration.invalid',\n        animation_id: animation.id,\n        message: `Animation '${animation.id}' duration must be a number (milliseconds)`\n      });\n    }\n  });\n}\n\nfunction validateProfiles(config, issues) {\n  if (!config.profiles) return;\n\n  config.profiles.forEach(profile => {\n    if (!profile.id) {\n      issues.errors.push({\n        code: 'id.missing',\n        collection: 'profiles',\n        message: 'Profile missing required id field'\n      });\n    }\n  });\n\n  // Validate active_profiles references\n  if (config.active_profiles) {\n    if (!Array.isArray(config.active_profiles)) {\n      issues.errors.push({\n        code: 'active_profiles.invalid',\n        message: 'active_profiles must be an array of profile IDs'\n      });\n    } else {\n      const profileIds = new Set((config.profiles || []).map(p => p.id));\n      config.active_profiles.forEach(profileId => {\n        if (!profileIds.has(profileId)) {\n          issues.warnings.push({\n            code: 'profile.missing',\n            profile_id: profileId,\n            message: `active_profiles references missing profile '${profileId}'`\n          });\n        }\n      });\n    }\n  }\n}\n\nfunction validatePalettes(config, issues) {\n  if (!config.palettes) return;\n\n  Object.entries(config.palettes).forEach(([paletteName, tokens]) => {\n    if (typeof tokens !== 'object' || Array.isArray(tokens)) {\n      issues.errors.push({\n        code: 'palette.tokens.invalid',\n        palette_name: paletteName,\n        message: `Palette '${paletteName}' tokens must be an object`\n      });\n    }\n  });\n}\n\nfunction validateRouting(config, issues) {\n  if (!config.routing) return;\n\n  const routing = config.routing;\n\n  // Validate clearance\n  if (routing.clearance !== undefined && typeof routing.clearance !== 'number') {\n    issues.errors.push({\n      code: 'routing.clearance.invalid',\n      message: 'routing.clearance must be a number'\n    });\n  }\n\n  // Validate grid_resolution\n  if (routing.grid_resolution !== undefined && typeof routing.grid_resolution !== 'number') {\n    issues.errors.push({\n      code: 'routing.grid_resolution.invalid',\n      message: 'routing.grid_resolution must be a number'\n    });\n  }\n\n  // Validate smoothing_mode\n  if (routing.smoothing_mode !== undefined) {\n    const validModes = ['none', 'chaikin'];\n    if (!validModes.includes(routing.smoothing_mode)) {\n      issues.warnings.push({\n        code: 'routing.smoothing_mode.invalid',\n        message: `routing.smoothing_mode '${routing.smoothing_mode}' invalid, using 'none'`\n      });\n    }\n  }\n}\n\nfunction validateDuplicateIds(config, issues) {\n  const collections = ['overlays', 'rules', 'animations', 'profiles', 'timelines'];\n\n  collections.forEach(collection => {\n    const items = config[collection] || [];\n    const seenIds = new Set();\n\n    items.forEach((item, index) => {\n      if (!item || !item.id) {\n        issues.errors.push({\n          code: 'id.missing',\n          collection,\n          index,\n          message: `Missing id in ${collection} item at index ${index}`\n        });\n        return;\n      }\n\n      if (seenIds.has(item.id)) {\n        issues.errors.push({\n          code: 'duplicate.id',\n          collection,\n          id: item.id,\n          message: `Duplicate ${collection} ID: ${item.id}`\n        });\n      } else {\n        seenIds.add(item.id);\n      }\n    });\n  });\n}\n\nfunction validateCoordinateArray(coords, issues, context) {\n  if (!Array.isArray(coords) || coords.length !== 2) {\n    issues.errors.push({\n      code: 'coordinates.invalid',\n      message: `${context} must be array of 2 elements [x, y]`\n    });\n    return;\n  }\n\n  coords.forEach((coord, index) => {\n    const axis = index === 0 ? 'x' : 'y';\n    if (typeof coord === 'string') {\n      if (!coord.endsWith('%') || isNaN(parseFloat(coord.slice(0, -1)))) {\n        issues.errors.push({\n          code: 'coordinates.invalid',\n          message: `${context} ${axis}-coordinate '${coord}' must be number or percentage string`\n        });\n      }\n    } else if (typeof coord !== 'number') {\n      issues.errors.push({\n        code: 'coordinates.invalid',\n        message: `${context} ${axis}-coordinate must be number or percentage string`\n      });\n    }\n  });\n}\n\n","/**\n * Position Resolver - Utility for resolving positions and anchor points\n */\n\nexport class PositionResolver {\n  static resolvePosition(position, anchors) {\n    if (Array.isArray(position) && position.length >= 2) {\n      return [Number(position[0]), Number(position[1])];\n    }\n\n    if (typeof position === 'string' && anchors[position]) {\n      const anchorPos = anchors[position];\n      if (Array.isArray(anchorPos) && anchorPos.length >= 2) {\n        return [Number(anchorPos[0]), Number(anchorPos[1])];\n      }\n    }\n\n    console.warn('[PositionResolver] Could not resolve position:', position);\n    return null;\n  }\n}\n","/**\n * Shared Renderer Utilities - Common functionality for all renderers\n * Provides reusable components for gradients, patterns, filters, and effects\n */\n\nexport class RendererUtils {\n\n\n  /**\n   * Text measurement utilities using HTML Canvas\n   * Static methods for precise text dimension calculations\n   */\n\n  /**\n   * Get or create cached canvas context for text measurements\n   * @private\n   * @returns {CanvasRenderingContext2D}\n   */\n  static _getTextMeasureContext() {\n    if (!window.cblcars) window.cblcars = {};\n\n    if (!window.cblcars._textMeasureCanvas) {\n      window.cblcars._textMeasureCanvas = document.createElement(\"canvas\");\n      window.cblcars._textMeasureContext = window.cblcars._textMeasureCanvas.getContext(\"2d\");\n      window.cblcars._textMeasureCache = new Map();\n    }\n\n    return window.cblcars._textMeasureContext;\n  }\n\n  /**\n   * Get the SVG container and its current transformation matrix\n   * @param {Element} containerElement - The SVG container element\n   * @returns {Object|null} Object with svg element and transformation info\n   */\n  static _getSvgTransformInfo(containerElement) {\n    try {\n      const svg = containerElement?.querySelector('svg');\n      if (!svg) return null;\n\n      // Get the viewBox and current dimensions\n      const viewBox = svg.viewBox.baseVal;\n      const rect = svg.getBoundingClientRect();\n\n      // Calculate scale factors\n      const scaleX = viewBox.width / rect.width;\n      const scaleY = viewBox.height / rect.height;\n\n      return {\n        svg,\n        viewBox: [viewBox.x, viewBox.y, viewBox.width, viewBox.height],\n        screenRect: { width: rect.width, height: rect.height },\n        scaleX,\n        scaleY,\n        // For pixel-to-viewbox conversion\n        pixelToViewBox: (pixelSize) => pixelSize * Math.max(scaleX, scaleY)\n      };\n    } catch (error) {\n      console.warn('[RendererUtils] Failed to get SVG transform info:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Measure text dimensions using canvas context\n   * @param {string} text - Text to measure\n   * @param {string} font - CSS font string (e.g., \"bold 16px Arial\")\n   * @param {boolean} useCache - Whether to use cached measurements\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {{width: number, height: number, ascent: number, descent: number}}\n   */\n  static measureText(text, font = \"16px Arial\", useCache = true, containerElement = null) {\n    if (!text) return { width: 0, height: 0, ascent: 0, descent: 0 };\n\n    const cacheKey = `${text}::${font}`;\n    const cache = window.cblcars?._textMeasureCache;\n\n    if (useCache && cache && cache.has(cacheKey)) {\n      const cached = cache.get(cacheKey);\n\n      // Apply coordinate transformation if container provided\n      if (containerElement) {\n        return this._transformTextMetrics(cached, containerElement);\n      }\n\n      return cached;\n    }\n\n    const ctx = this._getTextMeasureContext();\n    ctx.font = font;\n    const metrics = ctx.measureText(text);\n\n    const result = {\n      width: metrics.width,\n      height: metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent,\n      ascent: metrics.actualBoundingBoxAscent,\n      descent: metrics.actualBoundingBoxDescent,\n      actualLeft: metrics.actualBoundingBoxLeft || 0,\n      actualRight: metrics.actualBoundingBoxRight || metrics.width,\n      // Store original pixel values for transformation\n      _pixelWidth: metrics.width,\n      _pixelHeight: metrics.actualBoundingBoxAscent + metrics.actualBoundingBoxDescent,\n      _pixelAscent: metrics.actualBoundingBoxAscent,\n      _pixelDescent: metrics.actualBoundingBoxDescent\n    };\n\n    if (useCache && cache) {\n      cache.set(cacheKey, result);\n    }\n\n    // Apply coordinate transformation if container provided\n    if (containerElement) {\n      return this._transformTextMetrics(result, containerElement);\n    }\n\n    return result;\n  }\n\n  /**\n   * Transform text metrics from pixel space to viewBox coordinate space\n   * @private\n   * @param {Object} metrics - Original pixel-based metrics\n   * @param {Element} containerElement - SVG container for transformation\n   * @returns {Object} Transformed metrics in viewBox coordinates\n   */\n  static _transformTextMetrics(metrics, containerElement) {\n    const transformInfo = this._getSvgTransformInfo(containerElement);\n    if (!transformInfo) {\n      // No transformation available - return original metrics\n      console.warn('[RendererUtils] No transform info available, using pixel metrics');\n      return metrics;\n    }\n\n    const { pixelToViewBox } = transformInfo;\n\n    const transformed = {\n      ...metrics,\n      width: pixelToViewBox(metrics._pixelWidth || metrics.width),\n      height: pixelToViewBox(metrics._pixelHeight || metrics.height),\n      ascent: pixelToViewBox(metrics._pixelAscent || metrics.ascent),\n      descent: pixelToViewBox(metrics._pixelDescent || metrics.descent),\n      actualLeft: pixelToViewBox(metrics.actualLeft),\n      actualRight: pixelToViewBox(metrics.actualRight)\n    };\n\n    console.log('[RendererUtils] Transformed text metrics:', {\n      original: {\n        width: metrics.width,\n        height: metrics.height\n      },\n      transformed: {\n        width: transformed.width,\n        height: transformed.height\n      },\n      scaleInfo: {\n        scaleX: transformInfo.scaleX,\n        scaleY: transformInfo.scaleY\n      }\n    });\n\n    return transformed;\n  }\n\n  /**\n   * Measure multiline text with proper line spacing and coordinate transformation\n   * @param {string} text - Multiline text (with \\n separators)\n   * @param {string} font - CSS font string\n   * @param {number} lineHeight - Line height multiplier (default 1.2)\n   * @param {boolean} useCache - Whether to use cached measurements\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {{width: number, height: number, lines: Array, lineMetrics: Array}}\n   */\n  static measureMultilineText(text, font = \"16px Arial\", lineHeight = 1.2, useCache = true, containerElement = null) {\n    if (!text) return { width: 0, height: 0, lines: [], lineMetrics: [] };\n\n    const lines = text.split('\\n');\n    const lineMetrics = lines.map(line => this.measureText(line, font, useCache, containerElement));\n\n    const maxWidth = Math.max(...lineMetrics.map(m => m.width));\n    const fontSize = this._parseFontSize(font);\n\n    // Apply transformation to fontSize if container provided\n    let adjustedFontSize = fontSize;\n    let adjustedLineHeight = lineHeight;\n\n    if (containerElement) {\n      const transformInfo = this._getSvgTransformInfo(containerElement);\n      if (transformInfo) {\n        adjustedFontSize = transformInfo.pixelToViewBox(fontSize);\n        // Line height is a multiplier, so we need to apply it to the transformed font size\n        adjustedLineHeight = lineHeight;\n      }\n    }\n\n    const totalHeight = lines.length > 1\n      ? lineMetrics[0].ascent + ((lines.length - 1) * adjustedFontSize * adjustedLineHeight) + lineMetrics[lineMetrics.length - 1].descent\n      : lineMetrics[0]?.height || 0;\n\n    return {\n      width: maxWidth,\n      height: totalHeight,\n      lines,\n      lineMetrics,\n      // Store transform info for debugging\n      _transformApplied: !!containerElement,\n      _adjustedFontSize: adjustedFontSize\n    };\n  }\n\n  /**\n   * Calculate text bounding box at specific position with proper coordinate transformation\n   * @param {string} text - Text content\n   * @param {number} x - X position in viewBox coordinates\n   * @param {number} y - Y position in viewBox coordinates\n   * @param {string} font - CSS font string\n   * @param {string} textAnchor - SVG text-anchor value ('start', 'middle', 'end')\n   * @param {string} dominantBaseline - SVG dominant-baseline value\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {{left: number, right: number, top: number, bottom: number, width: number, height: number}}\n   */\n  static getTextBoundingBox(text, x, y, font = \"16px Arial\", textAnchor = 'start', dominantBaseline = 'auto', containerElement = null) {\n    const metrics = this.measureText(text, font, true, containerElement);\n\n    // Adjust for text anchor (x, y are already in viewBox coordinates)\n    let left = x;\n    if (textAnchor === 'middle') {\n      left = x - metrics.width / 2;\n    } else if (textAnchor === 'end') {\n      left = x - metrics.width;\n    }\n\n    // Adjust for baseline (y is already in viewBox coordinates)\n    let top = y - metrics.ascent;\n    if (dominantBaseline === 'middle') {\n      top = y - metrics.height / 2;\n    } else if (dominantBaseline === 'hanging') {\n      top = y;\n    }\n\n    const bbox = {\n      left,\n      right: left + metrics.width,\n      top,\n      bottom: top + metrics.height,\n      width: metrics.width,\n      height: metrics.height,\n      centerX: left + metrics.width / 2,\n      centerY: top + metrics.height / 2\n    };\n\n    console.log('[RendererUtils] Text bounding box calculation:', {\n      text: text.substring(0, 20) + (text.length > 20 ? '...' : ''),\n      inputPosition: { x, y },\n      textAnchor,\n      dominantBaseline,\n      metrics: {\n        width: metrics.width,\n        height: metrics.height,\n        ascent: metrics.ascent,\n        descent: metrics.descent\n      },\n      bbox,\n      hasContainer: !!containerElement\n    });\n\n    return bbox;\n  }\n\n  /**\n   * Get attachment points for connecting lines to text with proper coordinate transformation\n   * @param {string} text - Text content\n   * @param {number} x - X position\n   * @param {number} y - Y position\n   * @param {string} font - CSS font string\n   * @param {string} textAnchor - SVG text-anchor value\n   * @param {string} dominantBaseline - SVG dominant-baseline value\n   * @param {Element} containerElement - SVG container for coordinate transformation\n   * @returns {Object} Object with attachment points (top, bottom, left, right, etc.)\n   */\n  static getTextAttachmentPoints(text, x, y, font = \"16px Arial\", textAnchor = 'start', dominantBaseline = 'auto', containerElement = null) {\n    const bbox = this.getTextBoundingBox(text, x, y, font, textAnchor, dominantBaseline, containerElement);\n\n    // Calculate padding in viewBox coordinates - don't double-transform\n    const transformInfo = this._getSvgTransformInfo(containerElement);\n    const basePadding = 4; // Base padding value\n    const padding = transformInfo ? transformInfo.pixelToViewBox(basePadding) : basePadding;\n\n    return {\n      // Cardinal directions\n      top: [bbox.centerX, bbox.top],\n      bottom: [bbox.centerX, bbox.bottom],\n      left: [bbox.left, bbox.centerY],\n      right: [bbox.right, bbox.centerY],\n      center: [bbox.centerX, bbox.centerY],\n\n      // Corners\n      topLeft: [bbox.left, bbox.top],\n      topRight: [bbox.right, bbox.top],\n      bottomLeft: [bbox.left, bbox.bottom],\n      bottomRight: [bbox.right, bbox.bottom],\n\n      // With padding for visual clearance (properly scaled)\n      topPadded: [bbox.centerX, bbox.top - padding],\n      bottomPadded: [bbox.centerX, bbox.bottom + padding],\n      leftPadded: [bbox.left - padding, bbox.centerY],\n      rightPadded: [bbox.right + padding, bbox.centerY]\n    };\n  }\n\n  /**\n   * Parse font size from CSS font string\n   * @private\n   * @param {string} font - CSS font string\n   * @returns {number} Font size in pixels\n   */\n  static _parseFontSize(font) {\n    const match = font.match(/(\\d+(?:\\.\\d+)?)px/);\n    return match ? parseFloat(match[1]) : 16;\n  }\n\n  /**\n   * Build CSS font string from text style object\n   * @param {Object} textStyle - Text style configuration\n   * @returns {string} CSS font string\n   */\n  static buildFontString(textStyle) {\n    const parts = [];\n\n    if (textStyle.fontStyle && textStyle.fontStyle !== 'normal') {\n      parts.push(textStyle.fontStyle);\n    }\n    if (textStyle.fontWeight && textStyle.fontWeight !== 'normal') {\n      parts.push(textStyle.fontWeight);\n    }\n\n    parts.push(`${textStyle.fontSize}px`);\n\n    if (textStyle.fontFamily && textStyle.fontFamily !== 'inherit') {\n      parts.push(textStyle.fontFamily);\n    } else {\n      parts.push('Arial, sans-serif');\n    }\n\n    return parts.join(' ');\n  }\n\n  /**\n   * Resolve effective font-family when textStyle uses 'inherit'.\n   * Tries: svg element -> container element -> documentElement -> fallback.\n   */\n  static resolveFontFamily(textStyle, containerElement) {\n    if (textStyle.fontFamily && textStyle.fontFamily !== 'inherit') {\n      return textStyle.fontFamily;\n    }\n    try {\n      const svg = containerElement?.querySelector?.('svg');\n      const target = svg || containerElement || document.documentElement;\n      const computed = window.getComputedStyle(target).fontFamily;\n      if (computed && computed !== 'inherit') return computed;\n    } catch (e) {\n      console.warn('[RendererUtils] resolveFontFamily failed:', e);\n    }\n    return 'Arial, sans-serif';\n  }\n\n  /**\n   * Build a font string adjusted for measurement so canvas uses the ACTUAL on-screen pixel size.\n   * Without this, we measure at raw user-unit size (too large when viewBox scales down),\n   * leading to overestimated widths and misplaced decorations (e.g., status indicator).\n   */\n  static buildMeasurementFontString(textStyle, containerElement) {\n    // Resolve actual inherited font-family instead of fallback\n    const fontFamily = this.resolveFontFamily(textStyle, containerElement);\n    const fontStyle = (textStyle.fontStyle && textStyle.fontStyle !== 'normal') ? `${textStyle.fontStyle} ` : '';\n    const fontWeight = (textStyle.fontWeight && textStyle.fontWeight !== 'normal') ? `${textStyle.fontWeight} ` : '';\n\n    let adjustedPx = textStyle.fontSize;\n    if (containerElement) {\n      const transformInfo = this._getSvgTransformInfo(containerElement);\n      if (transformInfo) {\n        const screenPxPerViewBoxUnit = transformInfo.screenRect.width / transformInfo.viewBox[2];\n        adjustedPx = textStyle.fontSize * screenPxPerViewBoxUnit;\n      }\n    }\n\n    return `${fontStyle}${fontWeight}${adjustedPx}px ${fontFamily}`;\n  }\n\n  /**\n   * Clear text measurement cache\n   */\n  static clearTextMeasureCache() {\n    if (window.cblcars?._textMeasureCache) {\n      window.cblcars._textMeasureCache.clear();\n    }\n  }\n\n  /**\n   * Get text measurement cache statistics\n   */\n  static getTextMeasureCacheStats() {\n    const cache = window.cblcars?._textMeasureCache;\n    return {\n      size: cache?.size || 0,\n      keys: cache ? Array.from(cache.keys()) : []\n    };\n  }\n\n  /**\n   * Parse gradient configuration from various formats\n   * @param {string|object} gradientConfig - Gradient configuration\n   * @returns {object|null} Parsed gradient configuration\n   */\n  static parseGradientConfig(gradientConfig) {\n    if (!gradientConfig) return null;\n\n    if (typeof gradientConfig === 'string') {\n      // Handle simple formats: \"red,blue\" or \"red-to-blue\"\n      if (gradientConfig.includes(',')) {\n        const colors = gradientConfig.split(',').map(c => c.trim());\n        return {\n          type: 'linear',\n          direction: 'horizontal',\n          stops: colors.map((color, index) => ({\n            offset: `${(index / (colors.length - 1)) * 100}%`,\n            color: color\n          }))\n        };\n      } else if (gradientConfig.includes('-to-')) {\n        const [color1, color2] = gradientConfig.split('-to-').map(c => c.trim());\n        return {\n          type: 'linear',\n          direction: 'horizontal',\n          stops: [\n            { offset: '0%', color: color1 },\n            { offset: '100%', color: color2 }\n          ]\n        };\n      }\n      return null;\n    }\n\n    if (typeof gradientConfig === 'object') {\n      return {\n        type: gradientConfig.type || 'linear',\n        direction: gradientConfig.direction || 'horizontal',\n        x1: gradientConfig.x1 || '0%',\n        y1: gradientConfig.y1 || '0%',\n        x2: gradientConfig.x2 || '100%',\n        y2: gradientConfig.y2 || '0%',\n        cx: gradientConfig.cx || '50%',\n        cy: gradientConfig.cy || '50%',\n        r: gradientConfig.r || '50%',\n        stops: gradientConfig.stops || [\n          { offset: '0%', color: gradientConfig.from || 'var(--lcars-orange)' },\n          { offset: '100%', color: gradientConfig.to || 'var(--lcars-red)' }\n        ]\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse pattern configuration from various formats\n   * @param {string|object} patternConfig - Pattern configuration\n   * @returns {object|null} Parsed pattern configuration\n   */\n  static parsePatternConfig(patternConfig) {\n    if (!patternConfig) return null;\n\n    if (typeof patternConfig === 'string') {\n      // Predefined patterns\n      const presets = {\n        dots: { type: 'dots', size: 8, color: 'currentColor', opacity: 0.5 },\n        lines: { type: 'lines', size: 4, color: 'currentColor', opacity: 0.5 },\n        diagonal: { type: 'diagonal', size: 8, color: 'currentColor', opacity: 0.5 },\n        grid: { type: 'grid', size: 10, color: 'currentColor', opacity: 0.3 }\n      };\n      return presets[patternConfig] || null;\n    }\n\n    if (typeof patternConfig === 'object') {\n      return {\n        type: patternConfig.type || 'dots',\n        size: Number(patternConfig.size || 8),\n        color: patternConfig.color || 'currentColor',\n        opacity: Number(patternConfig.opacity || 0.5),\n        content: patternConfig.content || null\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse glow effect configuration\n   * @param {string|object|boolean} glowConfig - Glow configuration\n   * @returns {object|null} Parsed glow configuration\n   */\n  static parseGlowConfig(glowConfig) {\n    if (!glowConfig) return null;\n\n    if (glowConfig === true) {\n      return { color: 'currentColor', size: 4, opacity: 0.6 };\n    }\n\n    if (typeof glowConfig === 'string') {\n      return { color: glowConfig, size: 4, opacity: 0.6 };\n    }\n\n    if (typeof glowConfig === 'object') {\n      return {\n        color: glowConfig.color || 'currentColor',\n        size: Number(glowConfig.size || 4),\n        opacity: Number(glowConfig.opacity || 0.6),\n        intensity: Number(glowConfig.intensity || 1)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse shadow effect configuration\n   * @param {string|object|boolean} shadowConfig - Shadow configuration\n   * @returns {object|null} Parsed shadow configuration\n   */\n  static parseShadowConfig(shadowConfig) {\n    if (!shadowConfig) return null;\n\n    if (shadowConfig === true) {\n      return { color: 'rgba(0,0,0,0.3)', offsetX: 2, offsetY: 2, blur: 3 };\n    }\n\n    if (typeof shadowConfig === 'string') {\n      // Parse \"2 2 3 rgba(0,0,0,0.3)\" format\n      const parts = shadowConfig.split(' ');\n      return {\n        offsetX: Number(parts[0]) || 2,\n        offsetY: Number(parts[1]) || 2,\n        blur: Number(parts[2]) || 3,\n        color: parts[3] || 'rgba(0,0,0,0.3)'\n      };\n    }\n\n    if (typeof shadowConfig === 'object') {\n      return {\n        color: shadowConfig.color || 'rgba(0,0,0,0.3)',\n        offsetX: Number(shadowConfig.offsetX || shadowConfig.offset?.[0] || 2),\n        offsetY: Number(shadowConfig.offsetY || shadowConfig.offset?.[1] || 2),\n        blur: Number(shadowConfig.blur || 3)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse blur effect configuration\n   * @param {number|string|object} blurConfig - Blur configuration\n   * @returns {object|null} Parsed blur configuration\n   */\n  static parseBlurConfig(blurConfig) {\n    if (!blurConfig) return null;\n\n    if (typeof blurConfig === 'number') {\n      return { amount: blurConfig };\n    }\n\n    if (typeof blurConfig === 'string') {\n      return { amount: Number(blurConfig) || 1 };\n    }\n\n    if (typeof blurConfig === 'object') {\n      return { amount: Number(blurConfig.amount || blurConfig.blur || 1) };\n    }\n\n    return null;\n  }\n\n  /**\n   * Create gradient definition SVG\n   * @param {object} gradient - Parsed gradient configuration\n   * @param {string} id - Unique ID for the gradient\n   * @returns {string} SVG gradient definition\n   */\n  static createGradientDefinition(gradient, id) {\n    if (gradient.type === 'radial') {\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<radialGradient id=\"${id}\" cx=\"${gradient.cx}\" cy=\"${gradient.cy}\" r=\"${gradient.r}\">\n                ${stops}\n              </radialGradient>`;\n    } else {\n      // Linear gradient\n      const coords = this.getLinearGradientCoords(gradient.direction, gradient);\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<linearGradient id=\"${id}\" ${coords}>\n                ${stops}\n              </linearGradient>`;\n    }\n  }\n\n  /**\n   * Get linear gradient coordinates based on direction\n   * @param {string} direction - Gradient direction\n   * @param {object} gradient - Gradient configuration (for custom coordinates)\n   * @returns {string} SVG coordinate attributes\n   */\n  static getLinearGradientCoords(direction, gradient = {}) {\n    // Use custom coordinates if provided\n    if (gradient.x1 !== undefined) {\n      return `x1=\"${gradient.x1}\" y1=\"${gradient.y1}\" x2=\"${gradient.x2}\" y2=\"${gradient.y2}\"`;\n    }\n\n    // Predefined directions\n    const directions = {\n      horizontal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"',\n      vertical: 'x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      diagonal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"',\n      'diagonal-reverse': 'x1=\"100%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      'to-right': 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"',\n      'to-left': 'x1=\"100%\" y1=\"0%\" x2=\"0%\" y2=\"0%\"',\n      'to-bottom': 'x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      'to-top': 'x1=\"0%\" y1=\"100%\" x2=\"0%\" y2=\"0%\"'\n    };\n\n    return directions[direction] || directions.horizontal;\n  }\n\n  /**\n   * Create pattern definition SVG\n   * @param {object} pattern - Parsed pattern configuration\n   * @param {string} id - Unique ID for the pattern\n   * @returns {string} SVG pattern definition\n   */\n  static createPatternDefinition(pattern, id) {\n    const size = pattern.size;\n    const color = pattern.color;\n    const opacity = pattern.opacity;\n\n    let patternContent = '';\n\n    switch (pattern.type) {\n      case 'dots':\n        patternContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"1\"\n                                  fill=\"${color}\" opacity=\"${opacity}\"/>`;\n        break;\n\n      case 'lines':\n        patternContent = `<path d=\"M 0,${size} l ${size},-${size} M -1,1 l 2,-2 M ${size-1},${size+1} l 2,-2\"\n                                stroke=\"${color}\" stroke-width=\"1\" opacity=\"${opacity}\"/>`;\n        break;\n\n      case 'diagonal':\n        patternContent = `<path d=\"M0,${size} L${size},0\"\n                                stroke=\"${color}\" stroke-width=\"1\" opacity=\"${opacity}\"/>`;\n        break;\n\n      case 'grid':\n        patternContent = `\n          <path d=\"M0,0 L0,${size}\" stroke=\"${color}\" stroke-width=\"0.5\" opacity=\"${opacity}\"/>\n          <path d=\"M0,0 L${size},0\" stroke=\"${color}\" stroke-width=\"0.5\" opacity=\"${opacity}\"/>\n        `;\n        break;\n\n      case 'custom':\n        patternContent = pattern.content || '';\n        break;\n\n      default:\n        // Default to dots\n        patternContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"1\"\n                                  fill=\"${color}\" opacity=\"${opacity}\"/>`;\n    }\n\n    return `<pattern id=\"${id}\" x=\"0\" y=\"0\" width=\"${size}\" height=\"${size}\"\n                     patternUnits=\"userSpaceOnUse\">\n              ${patternContent}\n            </pattern>`;\n  }\n\n  /**\n   * Create glow filter SVG\n   * @param {object} glow - Parsed glow configuration\n   * @param {string} id - Unique ID for the filter\n   * @returns {string} SVG filter definition\n   */\n  static createGlowFilter(glow, id) {\n    const size = glow.size || 4;\n    const color = glow.color || 'currentColor';\n    const intensity = glow.intensity || 1;\n\n    // Enhanced filter for better glow effect\n    return `<filter id=\"${id}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feGaussianBlur stdDeviation=\"${size}\" result=\"coloredBlur\"/>\n              <feFlood flood-color=\"${color}\" flood-opacity=\"${intensity}\"/>\n              <feComposite in=\"flood\" in2=\"coloredBlur\" operator=\"in\" result=\"glowColor\"/>\n              <feMerge>\n                <feMergeNode in=\"glowColor\"/>\n                <feMergeNode in=\"SourceGraphic\"/>\n              </feMerge>\n            </filter>`;\n  }\n\n  /**\n   * Create shadow filter SVG\n   * @param {object} shadow - Parsed shadow configuration\n   * @param {string} id - Unique ID for the filter\n   * @returns {string} SVG filter definition\n   */\n  static createShadowFilter(shadow, id) {\n    const offsetX = shadow.offsetX || 2;\n    const offsetY = shadow.offsetY || 2;\n    const blur = shadow.blur || 3;\n    const color = shadow.color || 'rgba(0,0,0,0.3)';\n\n    return `<filter id=\"${id}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feDropShadow dx=\"${offsetX}\" dy=\"${offsetY}\"\n                           stdDeviation=\"${blur}\"\n                           flood-color=\"${color}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Create blur filter SVG\n   * @param {object} blur - Parsed blur configuration\n   * @param {string} id - Unique ID for the filter\n   * @returns {string} SVG filter definition\n   */\n  static createBlurFilter(blur, id) {\n    const amount = blur.amount || 1;\n\n    return `<filter id=\"${id}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feGaussianBlur stdDeviation=\"${amount}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Create LCARS-style bracket path\n   * @param {number} width - Bracket width\n   * @param {number} height - Bracket height\n   * @param {string} side - 'left' or 'right'\n   * @param {object} options - Styling options\n   * @returns {string} SVG path for bracket\n   */\n  static createLcarsBracket(width, height, side = 'left', options = {}) {\n    const bracketWidth = options.bracketWidth || 8;\n    const cornerRadius = options.cornerRadius || 2;\n    const strokeWidth = options.strokeWidth || 2;\n    const color = options.color || 'var(--lcars-orange)';\n\n    let pathData = '';\n\n    if (side === 'left') {\n      pathData = `M ${width} 0 L ${cornerRadius} 0\n                  Q 0 0 0 ${cornerRadius}\n                  L 0 ${height - cornerRadius}\n                  Q 0 ${height} ${cornerRadius} ${height}\n                  L ${width} ${height}`;\n    } else {\n      pathData = `M 0 0 L ${width - cornerRadius} 0\n                  Q ${width} 0 ${width} ${cornerRadius}\n                  L ${width} ${height - cornerRadius}\n                  Q ${width} ${height} ${width - cornerRadius} ${height}\n                  L 0 ${height}`;\n    }\n\n    return `<path d=\"${pathData}\"\n                  stroke=\"${color}\"\n                  stroke-width=\"${strokeWidth}\"\n                  fill=\"none\"/>`;\n  }\n\n  /**\n   * Create marker definition for arrows, dots, etc.\n   * @param {object} marker - Marker configuration\n   * @param {string} id - Unique ID for the marker\n   * @returns {string} SVG marker definition\n   */\n  static createMarkerDefinition(marker, id) {\n    const size = this.getMarkerSize(marker.size || 'medium');\n    const color = marker.color === 'inherit' ? 'currentColor' : marker.color;\n\n    let markerContent = '';\n    let viewBox = `0 0 ${size} ${size}`;\n    let refX = size / 2;\n    let refY = size / 2;\n\n    switch (marker.type) {\n      case 'arrow':\n        viewBox = '0 0 10 10';\n        refX = 8;\n        refY = 5;\n        markerContent = `<path d=\"M2,2 L8,5 L2,8 z\" fill=\"${color}\"/>`;\n        break;\n\n      case 'dot':\n      case 'circle':\n        markerContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/4}\" fill=\"${color}\"/>`;\n        break;\n\n      case 'diamond':\n        markerContent = `<path d=\"M${size/2},2 L${size-2},${size/2} L${size/2},${size-2} L2,${size/2} z\" fill=\"${color}\"/>`;\n        break;\n\n      case 'square':\n        markerContent = `<rect x=\"2\" y=\"2\" width=\"${size-4}\" height=\"${size-4}\" fill=\"${color}\"/>`;\n        break;\n\n      case 'triangle':\n        markerContent = `<path d=\"M${size/2},2 L${size-2},${size-2} L2,${size-2} z\" fill=\"${color}\"/>`;\n        break;\n\n      default:\n        markerContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/4}\" fill=\"${color}\"/>`;\n    }\n\n    return `<marker id=\"${id}\"\n                    viewBox=\"${viewBox}\"\n                    refX=\"${refX}\" refY=\"${refY}\"\n                    markerWidth=\"${size}\" markerHeight=\"${size}\"\n                    markerUnits=\"strokeWidth\"\n                    orient=\"${marker.rotate !== false ? 'auto' : '0'}\">\n              ${markerContent}\n            </marker>`;\n  }\n\n  /**\n   * Get numeric marker size from size descriptor\n   * @param {string|number} size - Size descriptor\n   * @returns {number} Numeric size\n   */\n  static getMarkerSize(size) {\n    if (typeof size === 'number') return size;\n\n    const sizes = {\n      small: 6,\n      medium: 8,\n      large: 12,\n      xlarge: 16\n    };\n\n    return sizes[size] || 8;\n  }\n\n  /**\n   * Escape XML special characters\n   * @param {string} text - Text to escape\n   * @returns {string} Escaped text\n   */\n  static escapeXml(text) {\n    return String(text)\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n\n  /**\n   * Generate unique ID for elements\n   * @param {string} prefix - Prefix for the ID\n   * @param {string} suffix - Suffix for the ID\n   * @returns {string} Unique ID\n   */\n  static generateId(prefix = 'element', suffix = '') {\n    const timestamp = Date.now().toString(36);\n    const random = Math.random().toString(36).substr(2, 5);\n    return `${prefix}-${timestamp}-${random}${suffix ? '-' + suffix : ''}`;\n  }\n\n  /**\n   * Parse CSS color values and convert to various formats\n   * @param {string} color - CSS color value\n   * @returns {object} Color information\n   */\n  static parseColor(color) {\n    // Create a temporary element to leverage browser's color parsing\n    const tempElement = document.createElement('div');\n    tempElement.style.color = color;\n    document.body.appendChild(tempElement);\n\n    const computedColor = getComputedStyle(tempElement).color;\n    document.body.removeChild(tempElement);\n\n    // Parse RGB values\n    const rgbMatch = computedColor.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/);\n    if (rgbMatch) {\n      const r = parseInt(rgbMatch[1]);\n      const g = parseInt(rgbMatch[2]);\n      const b = parseInt(rgbMatch[3]);\n\n      return {\n        rgb: [r, g, b],\n        hex: this.rgbToHex(r, g, b),\n        hsl: this.rgbToHsl(r, g, b),\n        original: color,\n        computed: computedColor\n      };\n    }\n\n    return {\n      original: color,\n      computed: computedColor\n    };\n  }\n\n  /**\n   * Convert RGB to HEX\n   * @private\n   */\n  static rgbToHex(r, g, b) {\n    return \"#\" + ((1 << 24) + (r << 16) + (g << 8) + b).toString(16).slice(1);\n  }\n\n  /**\n   * Convert RGB to HSL\n   * @private\n   */\n  static rgbToHsl(r, g, b) {\n    r /= 255;\n    g /= 255;\n    b /= 255;\n\n    const max = Math.max(r, g, b);\n    const min = Math.min(r, g, b);\n    let h, s, l = (max + min) / 2;\n\n    if (max === min) {\n      h = s = 0;\n    } else {\n      const d = max - min;\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n      switch (max) {\n        case r: h = (g - b) / d + (g < b ? 6 : 0); break;\n        case g: h = (b - r) / d + 2; break;\n        case b: h = (r - g) / d + 4; break;\n      }\n      h /= 6;\n    }\n\n    return [Math.round(h * 360), Math.round(s * 100), Math.round(l * 100)];\n  }\n\n  /**\n   * Calculate optimal text contrast color\n   * @param {string} backgroundColor - Background color\n   * @returns {string} Optimal text color (black or white)\n   */\n  static getContrastColor(backgroundColor) {\n    const color = this.parseColor(backgroundColor);\n    if (!color.rgb) return '#ffffff';\n\n    const [r, g, b] = color.rgb;\n    const luminance = (0.299 * r + 0.587 * g + 0.114 * b) / 255;\n\n    return luminance > 0.5 ? '#000000' : '#ffffff';\n  }\n\n  /**\n   * Interpolate between two colors\n   * @param {string} color1 - Start color\n   * @param {string} color2 - End color\n   * @param {number} factor - Interpolation factor (0-1)\n   * @returns {string} Interpolated color\n   */\n  static interpolateColor(color1, color2, factor) {\n    const c1 = this.parseColor(color1);\n    const c2 = this.parseColor(color2);\n\n    if (!c1.rgb || !c2.rgb) return color1;\n\n    const r = Math.round(c1.rgb[0] + (c2.rgb[0] - c1.rgb[0]) * factor);\n    const g = Math.round(c1.rgb[1] + (c2.rgb[1] - c1.rgb[1]) * factor);\n    const b = Math.round(c1.rgb[2] + (c2.rgb[2] - c1.rgb[2]) * factor);\n\n    return `rgb(${r}, ${g}, ${b})`;\n  }\n\n  /**\n   * Create animation-ready attributes for future anime.js integration\n   * @param {object} animationConfig - Animation configuration\n   * @returns {array} Array of attribute strings\n   */\n  static createAnimationAttributes(animationConfig = {}) {\n    const attributes = [];\n\n    if (animationConfig.animatable !== false) {\n      attributes.push('data-animatable=\"true\"');\n    }\n\n    Object.keys(animationConfig).forEach(key => {\n      if (key.endsWith('_speed') || key.endsWith('Speed')) {\n        const value = animationConfig[key];\n        if (value > 0) {\n          const dataKey = key.replace(/([A-Z])/g, '-$1').toLowerCase().replace('_', '-');\n          attributes.push(`data-${dataKey}=\"${value}\"`);\n        }\n      }\n    });\n\n    if (animationConfig.animation_ref || animationConfig.animationRef) {\n      const ref = animationConfig.animation_ref || animationConfig.animationRef;\n      attributes.push(`data-animation-ref=\"${ref}\"`);\n    }\n\n    return attributes;\n  }\n\n  /**\n   * Validate and sanitize style values\n   * @param {object} styles - Style object to validate\n   * @returns {object} Sanitized styles\n   */\n  static sanitizeStyles(styles) {\n    const sanitized = {};\n\n    // Define allowed properties and their validation functions\n    const validators = {\n      color: (value) => this.isValidColor(value),\n      opacity: (value) => this.isValidOpacity(value),\n      width: (value) => this.isValidNumber(value),\n      height: (value) => this.isValidNumber(value),\n      stroke: (value) => this.isValidColor(value),\n      fill: (value) => this.isValidColor(value) || value === 'none',\n      fontSize: (value) => this.isValidNumber(value),\n      fontFamily: (value) => this.isValidString(value)\n    };\n\n    Object.keys(styles).forEach(key => {\n      const validator = validators[key] || validators[this.camelToKebab(key)];\n      if (validator && validator(styles[key])) {\n        sanitized[key] = styles[key];\n      }\n    });\n\n    return sanitized;\n  }\n\n  /**\n   * Check if value is a valid color\n   * @private\n   */\n  static isValidColor(value) {\n    if (typeof value !== 'string') return false;\n    return /^(#[0-9a-f]{3,8}|rgb\\(|rgba\\(|hsl\\(|hsla\\(|var\\(--|\\w+)/.test(value.toLowerCase());\n  }\n\n  /**\n   * Check if value is a valid opacity\n   * @private\n   */\n  static isValidOpacity(value) {\n    const num = Number(value);\n    return !isNaN(num) && num >= 0 && num <= 1;\n  }\n\n  /**\n   * Check if value is a valid number\n   * @private\n   */\n  static isValidNumber(value) {\n    return !isNaN(Number(value)) && isFinite(Number(value));\n  }\n\n  /**\n   * Check if value is a valid string\n   * @private\n   */\n  static isValidString(value) {\n    return typeof value === 'string' && value.length > 0;\n  }\n\n  /**\n   * Convert camelCase to kebab-case\n   * @private\n   */\n  static camelToKebab(str) {\n    return str.replace(/([A-Z])/g, '-$1').toLowerCase();\n  }\n\n  /**\n   * Get DOM text bounding box for glyphs (after font load)\n   * @param {Element} groupEl - SVG group element containing the text\n   * @returns {Object|null} Bounding box object with width, height, and position\n   */\n  static getDomTextBBox(groupEl) {\n    try {\n      if (!groupEl) return null;\n      const textEl = groupEl.querySelector('text');\n      if (!textEl) return null;\n      const bb = textEl.getBBox();\n      return {\n        width: bb.width,\n        height: bb.height,\n        left: bb.x,\n        top: bb.y,\n        right: bb.x + bb.width,\n        bottom: bb.y + bb.height,\n        centerX: bb.x + bb.width / 2,\n        centerY: bb.y + bb.height / 2\n      };\n    } catch(_) {\n      return null;\n    }\n  }\n}","/**\n * Text Overlay Renderer - Advanced text rendering with comprehensive styling support\n * Provides rich text styling features similar to LineOverlayRenderer\n */\n\nimport { PositionResolver } from './PositionResolver.js';\nimport { RendererUtils } from './RendererUtils.js';\n\nexport class TextOverlayRenderer {\n  constructor() {\n    // Pre-defined caches for performance optimization\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n    this.filterCache = new Map();\n  }\n\n  /**\n   * Render a text overlay with full styling support\n   * @param {Object} overlay - Text overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled text\n   */\n  static render(overlay, anchors, viewBox, svgContainer) {\n    // Create instance for non-static methods\n    const instance = new TextOverlayRenderer();\n    instance.container = svgContainer; // Set the container for the instance\n    instance.viewBox = viewBox; // Also store viewBox for reference\n    return instance.renderText(overlay, anchors, viewBox);\n  }\n\n  /**\n   * Instance method for comprehensive text rendering\n   * @param {Object} overlay - Text overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled text\n   */\n  renderText(overlay, anchors, viewBox) {\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) {\n      console.warn('[TextOverlayRenderer] Text overlay position could not be resolved:', overlay.id);\n      return '';\n    }\n    const [x, y] = position;\n\n    try {\n      const style = overlay.finalStyle || overlay.style || {};\n      const textStyle = this._resolveTextStyles(style, overlay.id);\n\n      // NEW: adopt computed font when 'inherit' (prevents initial fallback mismatch)\n      if (this.container && typeof window !== 'undefined') {\n        try {\n          const host = this.container;\n          const cs = host ? getComputedStyle(host) : null;\n            if (cs) {\n              if (textStyle.fontFamily === 'inherit' && cs.fontFamily) {\n                textStyle.fontFamily = cs.fontFamily;\n              }\n              // Update fontSize if defaulted / unreasonable\n              if ((!style.font_size && !style.fontSize) && cs.fontSize) {\n                const px = parseFloat(cs.fontSize);\n                if (!isNaN(px) && px > 0) textStyle.fontSize = px;\n              }\n            }\n        } catch (_) {}\n      }\n\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n      const textContent = this._resolveTextContent(overlay, style);\n      if (!textContent) {\n        console.warn(`[TextOverlayRenderer] No text content for overlay ${overlay.id}`);\n        return '';\n      }\n      textStyle._cachedContent = textContent;\n\n      // NEW: single early measurement (width/height) used by decorations & emitted as attributes\n      const measure = this._measureTextBlock(textContent, x, y, textStyle);\n\n      const svgParts = [\n        this._buildDefinitions(textStyle, overlay.id),\n        this._buildMainText(textContent, x, y, textStyle, overlay.id, animationAttributes),\n        this._buildTextDecorations(textContent, x, y, textStyle, overlay.id),\n        this._buildEffects(textContent, x, y, textStyle, overlay.id)\n      ].filter(Boolean);\n\n      console.log(`[TextOverlayRenderer] Rendered enhanced text ${overlay.id} with ${textStyle.features.length} features`);\n\n      return `<g data-overlay-id=\"${overlay.id}\"\n                  data-overlay-type=\"text\"\n                  data-text-features=\"${textStyle.features.join(',')}\"\n                  data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                  data-text-width=\"${measure.width || 0}\"\n                  data-text-height=\"${measure.height || 0}\"\n                  data-font-family=\"${textStyle.fontFamily}\"\n                  data-font-size=\"${textStyle.fontSize}\"\n                  data-font-stabilized=\"0\">\n                ${svgParts.join('\\n')}\n              </g>`;\n    } catch (error) {\n      console.error(`[TextOverlayRenderer] Enhanced rendering failed for text ${overlay.id}:`, error);\n      return this._renderFallbackText(overlay, x, y);\n    }\n  }\n\n  /**\n   * Resolve comprehensive text styling from configuration\n   * @private\n   * @param {Object} style - Final resolved style object\n   * @param {string} overlayId - Overlay ID for unique identifiers\n   * @returns {Object} Complete text style configuration\n   */\n  _resolveTextStyles(style, overlayId) {\n    const textStyle = {\n      // Core text properties\n      color: style.color || style.fill || 'var(--lcars-orange)',\n      fontSize: Number(style.font_size || style.fontSize || 16),\n      fontFamily: style.font_family || style.fontFamily || 'inherit',\n      fontWeight: style.font_weight || style.fontWeight || 'normal',\n      fontStyle: style.font_style || style.fontStyle || 'normal',\n\n      // Text positioning and alignment\n      textAnchor: (style.text_anchor || style.textAnchor || 'start').toLowerCase(),\n      dominantBaseline: (style.dominant_baseline || style.dominantBaseline || 'auto').toLowerCase(),\n      alignmentBaseline: (style.alignment_baseline || style.alignmentBaseline || 'auto').toLowerCase(),\n\n      // Advanced text styling\n      letterSpacing: style.letter_spacing || style.letterSpacing || 'normal',\n      wordSpacing: style.word_spacing || style.wordSpacing || 'normal',\n      textDecoration: style.text_decoration || style.textDecoration || 'none',\n\n      // Opacity and visibility\n      opacity: Number(style.opacity || 1),\n      visibility: style.visibility || 'visible',\n\n      // Stroke properties for outlined text\n      stroke: style.stroke || null,\n      strokeWidth: Number(style.stroke_width || style.strokeWidth || 0),\n      strokeOpacity: Number(style.stroke_opacity || style.strokeOpacity || 1),\n      strokeLinecap: (style.stroke_linecap || style.strokeLinecap || 'butt').toLowerCase(),\n      strokeLinejoin: (style.stroke_linejoin || style.strokeLinejoin || 'miter').toLowerCase(),\n      strokeDasharray: style.stroke_dasharray || style.strokeDasharray || null,\n      strokeDashoffset: Number(style.stroke_dashoffset || style.strokeDashoffset || 0),\n\n      // Advanced fill properties\n      gradient: this._parseGradientConfig(style.gradient),\n      pattern: this._parsePatternConfig(style.pattern),\n\n      // Effects\n      glow: this._parseGlowConfig(style.glow),\n      shadow: this._parseShadowConfig(style.shadow),\n      blur: this._parseBlurConfig(style.blur),\n\n      // Multi-line text support\n      multiline: style.multiline || false,\n      lineHeight: Number(style.line_height || style.lineHeight || 1.2),\n      maxWidth: Number(style.max_width || style.maxWidth || 0),\n      textWrapping: style.text_wrapping || style.textWrapping || 'none',\n\n      // Animation states (for future anime.js integration)\n      animatable: style.animatable !== false,\n      pulseSpeed: Number(style.pulse_speed || 0),\n      fadeSpeed: Number(style.fade_speed || 0),\n      typewriterSpeed: Number(style.typewriter_speed || 0),\n\n      // LCARS-specific features\n      status_indicator: style.status_indicator || null,\n      status_indicator_position: style.status_indicator_position || style.statusIndicatorPosition || 'left-center',\n      bracket_style: style.bracket_style || null,\n      highlight: style.highlight || false,\n\n      // Track enabled features for optimization\n      features: []\n    };\n\n    // Build feature list for conditional rendering\n    if (textStyle.gradient) textStyle.features.push('gradient');\n    if (textStyle.pattern) textStyle.features.push('pattern');\n    if (textStyle.stroke && textStyle.strokeWidth > 0) textStyle.features.push('stroke');\n    if (textStyle.glow) textStyle.features.push('glow');\n    if (textStyle.shadow) textStyle.features.push('shadow');\n    if (textStyle.blur) textStyle.features.push('blur');\n    if (textStyle.multiline) textStyle.features.push('multiline');\n    if (textStyle.pulseSpeed > 0) textStyle.features.push('pulse');\n    if (textStyle.fadeSpeed > 0) textStyle.features.push('fade');\n    if (textStyle.typewriterSpeed > 0) textStyle.features.push('typewriter');\n    if (textStyle.status_indicator) textStyle.features.push('status');\n    if (textStyle.bracket_style) textStyle.features.push('brackets');\n    if (textStyle.highlight) textStyle.features.push('highlight');\n\n    return textStyle;\n  }\n\n  /**\n   * Resolve text content from various sources\n   * @private\n   */\n  _resolveTextContent(overlay, style) {\n    return style.value || overlay.text || overlay.content || '';\n  }\n\n  /**\n   * Build SVG definitions for gradients, patterns, and effects\n   * @private\n   */\n  _buildDefinitions(textStyle, overlayId) {\n    const defs = [];\n\n    // Gradients\n    if (textStyle.gradient) {\n      defs.push(this._createGradientDefinition(textStyle.gradient, overlayId));\n    }\n\n    // Patterns\n    if (textStyle.pattern) {\n      defs.push(this._createPatternDefinition(textStyle.pattern, overlayId));\n    }\n\n    // Effects (filters)\n    if (textStyle.glow) {\n      defs.push(this._createGlowFilter(textStyle.glow, overlayId));\n    }\n\n    if (textStyle.shadow) {\n      defs.push(this._createShadowFilter(textStyle.shadow, overlayId));\n    }\n\n    if (textStyle.blur) {\n      defs.push(this._createBlurFilter(textStyle.blur, overlayId));\n    }\n\n    if (defs.length === 0) {\n      return '';\n    }\n\n    return `<defs>${defs.join('\\n')}</defs>`;\n  }\n\n  /**\n   * Build the main text element with all styling\n   * @private\n   */\n  _buildMainText(textContent, x, y, textStyle, overlayId, animationAttributes) {\n    if (textStyle.multiline) {\n      return this._buildMultilineText(textContent, x, y, textStyle, overlayId, animationAttributes);\n    }\n\n    const attributes = [];\n\n    // Position\n    attributes.push(`x=\"${x}\"`);\n    attributes.push(`y=\"${y}\"`);\n\n    // Core text styling\n    this._applyTextAttributes(attributes, textStyle, overlayId);\n\n    // Animation attributes (for future anime.js integration)\n    attributes.push(...animationAttributes.textAttributes);\n\n    const escapedText = this.escapeXml(textContent);\n    return `<text ${attributes.join(' ')}>${escapedText}</text>`;\n  }\n\n  /**\n   * Build multiline text with proper line spacing\n   * @private\n   */\n  _buildMultilineText(textContent, x, y, textStyle, overlayId, animationAttributes) {\n    const lines = textContent.split('\\n');\n    const lineHeight = textStyle.fontSize * textStyle.lineHeight;\n    const tspanElements = [];\n\n    lines.forEach((line, index) => {\n      const dy = index === 0 ? 0 : lineHeight;\n      const escapedLine = this.escapeXml(line);\n      tspanElements.push(`<tspan x=\"${x}\" dy=\"${dy}\">${escapedLine}</tspan>`);\n    });\n\n    const attributes = [];\n\n    // Position (y for first line)\n    attributes.push(`y=\"${y}\"`);\n\n    // Core text styling\n    this._applyTextAttributes(attributes, textStyle, overlayId);\n\n    // Animation attributes\n    attributes.push(...animationAttributes.textAttributes);\n\n    return `<text ${attributes.join(' ')}>${tspanElements.join('')}</text>`;\n  }\n\n  /**\n   * Apply common text attributes\n   * @private\n   */\n  _applyTextAttributes(attributes, textStyle, overlayId) {\n    // Fill styling\n    if (textStyle.gradient) {\n      attributes.push(`fill=\"url(#text-gradient-${overlayId})\"`);\n    } else if (textStyle.pattern) {\n      attributes.push(`fill=\"url(#text-pattern-${overlayId})\"`);\n    } else {\n      attributes.push(`fill=\"${textStyle.color}\"`);\n    }\n\n    attributes.push(`fill-opacity=\"${textStyle.opacity}\"`);\n\n    // Font styling\n    attributes.push(`font-size=\"${textStyle.fontSize}\"`);\n    if (textStyle.fontFamily !== 'inherit') {\n      attributes.push(`font-family=\"${textStyle.fontFamily}\"`);\n    }\n    if (textStyle.fontWeight !== 'normal') {\n      attributes.push(`font-weight=\"${textStyle.fontWeight}\"`);\n    }\n    if (textStyle.fontStyle !== 'normal') {\n      attributes.push(`font-style=\"${textStyle.fontStyle}\"`);\n    }\n\n    // Text alignment\n    if (textStyle.textAnchor !== 'start') {\n      attributes.push(`text-anchor=\"${textStyle.textAnchor}\"`);\n    }\n    if (textStyle.dominantBaseline !== 'auto') {\n      attributes.push(`dominant-baseline=\"${textStyle.dominantBaseline}\"`);\n    }\n    if (textStyle.alignmentBaseline !== 'auto') {\n      attributes.push(`alignment-baseline=\"${textStyle.alignmentBaseline}\"`);\n    }\n\n    // Spacing\n    if (textStyle.letterSpacing !== 'normal') {\n      attributes.push(`letter-spacing=\"${textStyle.letterSpacing}\"`);\n    }\n    if (textStyle.wordSpacing !== 'normal') {\n      attributes.push(`word-spacing=\"${textStyle.wordSpacing}\"`);\n    }\n\n    // Text decoration\n    if (textStyle.textDecoration !== 'none') {\n      attributes.push(`text-decoration=\"${textStyle.textDecoration}\"`);\n    }\n\n    // Stroke properties\n    if (textStyle.stroke && textStyle.strokeWidth > 0) {\n      attributes.push(`stroke=\"${textStyle.stroke}\"`);\n      attributes.push(`stroke-width=\"${textStyle.strokeWidth}\"`);\n      attributes.push(`stroke-opacity=\"${textStyle.strokeOpacity}\"`);\n      attributes.push(`stroke-linecap=\"${textStyle.strokeLinecap}\"`);\n      attributes.push(`stroke-linejoin=\"${textStyle.strokeLinejoin}\"`);\n\n      if (textStyle.strokeDasharray) {\n        attributes.push(`stroke-dasharray=\"${textStyle.strokeDasharray}\"`);\n        if (textStyle.strokeDashoffset !== 0) {\n          attributes.push(`stroke-dashoffset=\"${textStyle.strokeDashoffset}\"`);\n        }\n      }\n    }\n\n    // Visibility\n    if (textStyle.visibility !== 'visible') {\n      attributes.push(`visibility=\"${textStyle.visibility}\"`);\n    }\n\n    // Effects\n    const filters = [];\n    if (textStyle.glow) filters.push(`url(#text-glow-${overlayId})`);\n    if (textStyle.shadow) filters.push(`url(#text-shadow-${overlayId})`);\n    if (textStyle.blur) filters.push(`url(#text-blur-${overlayId})`);\n    if (filters.length > 0) {\n      attributes.push(`filter=\"${filters.join(' ')}\"`);\n    }\n  }\n\n  /**\n   * Build text decoration elements (brackets, highlights, etc.)\n   * @private\n   */\n  _buildTextDecorations(textContent, x, y, textStyle, overlayId) {\n    const decorations = [];\n\n    // LCARS-style brackets\n    if (textStyle.bracket_style) {\n      decorations.push(this._buildBrackets(textContent, x, y, textStyle, overlayId));\n    }\n\n    // Highlight background\n    if (textStyle.highlight) {\n      decorations.push(this._buildHighlight(textContent, x, y, textStyle, overlayId));\n    }\n\n    // Status indicator\n    if (textStyle.status_indicator) {\n      decorations.push(this._buildStatusIndicator(x, y, textStyle, overlayId));\n    }\n\n    return decorations.filter(Boolean).join('\\n');\n  }\n\n  /**\n   * Build special effects elements\n   * @private\n   */\n  _buildEffects(textContent, x, y, textStyle, overlayId) {\n    const effects = [];\n\n    // Future: Add text-specific animation elements\n    if (textStyle.features.includes('typewriter')) {\n      // Placeholder for typewriter animation elements\n    }\n\n    if (textStyle.features.includes('pulse')) {\n      // Placeholder for pulse animation elements\n    }\n\n    if (textStyle.features.includes('fade')) {\n      // Placeholder for fade animation elements\n    }\n\n    return effects.join('\\n');\n  }\n\n  /**\n   * Build LCARS-style brackets with precise measurements\n   * @private\n   * @param {string} textContent - Text content for measurement\n   * @param {number} x - Text x position\n   * @param {number} y - Text y position\n   * @param {Object} textStyle - Resolved text style configuration\n   * @param {string} overlayId - Overlay ID for unique identification\n   * @returns {string} SVG markup for LCARS brackets\n   */\n  _buildBrackets(textContent, x, y, textStyle, overlayId) {\n    // Use measurement-adjusted font (prevents width overestimation)\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n    let bbox;\n\n    if (textStyle.multiline) {\n      // For multiline text, get comprehensive measurements\n      const multilineMetrics = RendererUtils.measureMultilineText(textContent, font, textStyle.lineHeight);\n      // Create bbox-like object from multiline measurements\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - multilineMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - multilineMetrics.width;\n      }\n\n      let top = y - multilineMetrics.lineMetrics[0]?.ascent || 0;\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - multilineMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + multilineMetrics.width,\n        top,\n        bottom: top + multilineMetrics.height,\n        width: multilineMetrics.width,\n        height: multilineMetrics.height\n      };\n    } else {\n      // Single line text - use standard bounding box\n      bbox = RendererUtils.getTextBoundingBox(\n        textContent,\n        x,\n        y,\n        font,\n        textStyle.textAnchor,\n        textStyle.dominantBaseline\n      );\n    }\n\n    const bracketWidth = 8;\n    const padding = 4;\n    const extraHeight = 4; // Additional height for visual appeal\n\n    const leftX = bbox.left - bracketWidth - padding;\n    const rightX = bbox.right + padding;\n    const topY = bbox.top - extraHeight;\n    const bottomY = bbox.bottom + extraHeight;\n\n    const bracketColor = textStyle.color;\n    const strokeWidth = Math.max(1, textStyle.fontSize / 16);\n\n    return `<g data-decoration=\"brackets\">\n              <path d=\"M ${leftX + bracketWidth} ${topY} L ${leftX} ${topY} L ${leftX} ${bottomY} L ${leftX + bracketWidth} ${bottomY}\"\n                    stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n              <path d=\"M ${rightX - bracketWidth} ${topY} L ${rightX} ${topY} L ${rightX} ${bottomY} L ${rightX - bracketWidth} ${bottomY}\"\n                    stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n            </g>`;\n  }\n\n  /**\n   * Build highlight background with precise measurements and coordinate transformation\n   * @private\n   */\n  _buildHighlight(textContent, x, y, textStyle, overlayId) {\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n    let bbox;\n\n    if (textStyle.multiline) {\n      // For multiline text, get comprehensive measurements with coordinate transformation\n      const multilineMetrics = RendererUtils.measureMultilineText(\n        textContent,\n        font,\n        textStyle.lineHeight,\n        true,\n        this.container // Pass container for coordinate transformation\n      );\n\n      // Create bbox-like object from multiline measurements\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - multilineMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - multilineMetrics.width;\n      }\n\n      let top = y - multilineMetrics.lineMetrics[0]?.ascent || 0;\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - multilineMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + multilineMetrics.width,\n        top,\n        bottom: top + multilineMetrics.height,\n        width: multilineMetrics.width,\n        height: multilineMetrics.height\n      };\n    } else {\n      // Single line text - use standard bounding box with coordinate transformation\n      bbox = RendererUtils.getTextBoundingBox(\n        textContent,\n        x,\n        y,\n        font,\n        textStyle.textAnchor,\n        textStyle.dominantBaseline,\n        this.container // Pass container for coordinate transformation\n      );\n    }\n\n    // Get properly scaled padding\n    const transformInfo = RendererUtils._getSvgTransformInfo(this.container);\n    const padding = transformInfo ? transformInfo.pixelToViewBox(2) : 2;\n\n    const highlightX = bbox.left - padding;\n    const highlightY = bbox.top - padding;\n    const highlightWidth = bbox.width + (padding * 2);\n    const highlightHeight = bbox.height + (padding * 2);\n\n    const highlightColor = typeof textStyle.highlight === 'string' ?\n      textStyle.highlight : 'var(--lcars-blue-light)';\n    const highlightOpacity = typeof textStyle.highlight_opacity === 'number' ?\n      textStyle.highlight_opacity : 0.3;\n\n    return `<rect x=\"${highlightX}\" y=\"${highlightY}\"\n                  width=\"${highlightWidth}\" height=\"${highlightHeight}\"\n                  fill=\"${highlightColor}\" fill-opacity=\"${highlightOpacity}\"\n                  data-decoration=\"highlight\"/>`;\n  }\n\n  /**\n   * Build status indicator with precise positioning and proper coordinate transformation\n   * @private\n   * @param {number} x - Text x position\n   * @param {number} y - Text y position\n   * @param {Object} textStyle - Resolved text style configuration\n   * @param {string} overlayId - Overlay ID for unique identification\n   * @returns {string} SVG markup for status indicator\n   */\n  _buildStatusIndicator(x, y, textStyle, overlayId) {\n    const indicatorSize = textStyle.fontSize * 0.4;\n    const statusColor = typeof textStyle.status_indicator === 'string'\n      ? textStyle.status_indicator\n      : 'var(--lcars-green)';\n\n    const position = textStyle.status_indicator_position || 'left-center';\n\n    // Replace base font with measurement-adjusted font\n    const textContent = textStyle._cachedContent || textStyle.value || '';\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n\n    // Get the SVG transform info for debugging and padding calculation\n    const transformInfo = RendererUtils._getSvgTransformInfo(this.container);\n\n    console.log(`[TextOverlayRenderer] Transform info for ${overlayId}:`, {\n      transformInfo,\n      containerTag: this.container?.tagName,\n      hasSvg: !!this.container?.querySelector('svg')\n    });\n\n    let bbox;\n    if (textStyle.multiline) {\n      // For multiline text, get measurements and let RendererUtils handle coordinate transformation\n      const multilineMetrics = RendererUtils.measureMultilineText(\n        textContent,\n        font,\n        textStyle.lineHeight,\n        true,\n        this.container // Let RendererUtils handle the transformation\n      );\n\n      // Use the already-transformed measurements directly\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - multilineMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - multilineMetrics.width;\n      }\n\n      let top = y - (multilineMetrics.lineMetrics[0]?.ascent || 0);\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - multilineMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + multilineMetrics.width,\n        top,\n        bottom: top + multilineMetrics.height,\n        width: multilineMetrics.width,\n        height: multilineMetrics.height,\n        centerX: left + multilineMetrics.width / 2,\n        centerY: top + multilineMetrics.height / 2\n      };\n    } else {\n      // Single line text - get measurements and let RendererUtils handle coordinate transformation\n      const textMetrics = RendererUtils.measureText(textContent, font, true, this.container);\n\n      // Use the already-transformed measurements directly\n      let left = x;\n      if (textStyle.textAnchor === 'middle') {\n        left = x - textMetrics.width / 2;\n      } else if (textStyle.textAnchor === 'end') {\n        left = x - textMetrics.width;\n      }\n\n      let top = y - textMetrics.ascent;\n      if (textStyle.dominantBaseline === 'middle') {\n        top = y - textMetrics.height / 2;\n      } else if (textStyle.dominantBaseline === 'hanging') {\n        top = y;\n      }\n\n      bbox = {\n        left,\n        right: left + textMetrics.width,\n        top,\n        bottom: top + textMetrics.height,\n        width: textMetrics.width,\n        height: textMetrics.height,\n        centerX: left + textMetrics.width / 2,\n        centerY: top + textMetrics.height / 2\n      };\n    }\n\n    // Debug logging to trace coordinate issues\n    console.log(`[TextOverlayRenderer] Status indicator debug for ${overlayId}:`, {\n      textContent,\n      x, y,\n      textAnchor: textStyle.textAnchor,\n      dominantBaseline: textStyle.dominantBaseline,\n      position,\n      bbox,\n      fontSize: textStyle.fontSize,\n      hasContainer: !!this.container,\n      containerType: this.container?.tagName,\n      transformInfo: transformInfo ? {\n        scaleX: transformInfo.scaleX,\n        scaleY: transformInfo.scaleY,\n        viewBox: transformInfo.viewBox\n      } : null\n    });\n\n    // Calculate indicator position based on actual text bounds (already in correct coordinate space)\n    let indicatorX = x, indicatorY = y;\n\n    // Use a consistent padding value - transform pixel padding to viewBox coordinates only once\n    const pixelPadding = 8; // 8 pixel padding\n    const padding = transformInfo ?\n      transformInfo.pixelToViewBox(pixelPadding) :\n      indicatorSize; // Fallback to indicator size if no transform info\n\n    switch (position) {\n      case 'top-left':\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.top - padding;\n        break;\n      case 'top-right':\n        indicatorX = bbox.right + padding;\n        indicatorY = bbox.top - padding;\n        break;\n      case 'bottom-left':\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.bottom + padding;\n        break;\n      case 'bottom-right':\n        indicatorX = bbox.right + padding;\n        indicatorY = bbox.bottom + padding;\n        break;\n      case 'top':\n        indicatorX = bbox.centerX;\n        indicatorY = bbox.top - padding;\n        break;\n      case 'bottom':\n        indicatorX = bbox.centerX;\n        indicatorY = bbox.bottom + padding;\n        break;\n      case 'left-center':\n      case 'left':\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.centerY;\n        break;\n      case 'right-center':\n      case 'right':\n        indicatorX = bbox.right + padding;\n        indicatorY = bbox.centerY;\n        break;\n      case 'center':\n        indicatorX = bbox.centerX;\n        indicatorY = bbox.centerY;\n        break;\n      default:\n        // fallback to left-center\n        indicatorX = bbox.left - padding;\n        indicatorY = bbox.centerY;\n    }\n\n    console.log(`[TextOverlayRenderer] Status indicator final position for ${overlayId}:`, {\n      indicatorX,\n      indicatorY,\n      padding,\n      pixelPadding,\n      transformInfo: transformInfo ? 'present' : 'missing'\n    });\n\n    return `<circle cx=\"${indicatorX}\" cy=\"${indicatorY}\" r=\"${indicatorSize}\"\n                    fill=\"${statusColor}\"\n                    data-status-pos=\"${position}\"\n                    data-decoration=\"status-indicator\"/>`;\n  }\n\n\n  /**\n   * Create gradient definition for text\n   * @private\n   */\n  _createGradientDefinition(gradientConfig, overlayId) {\n    const gradientId = `text-gradient-${overlayId}`;\n\n    if (typeof gradientConfig === 'string') {\n      // Simple two-color gradient\n      const [color1, color2] = gradientConfig.split(',').map(c => c.trim());\n      return `<linearGradient id=\"${gradientId}\">\n                <stop offset=\"0%\" stop-color=\"${color1 || 'var(--lcars-orange)'}\"/>\n                <stop offset=\"100%\" stop-color=\"${color2 || 'var(--lcars-red)'}\"/>\n              </linearGradient>`;\n    }\n\n    // Advanced gradient configuration\n    const type = gradientConfig.type || 'linear';\n    const stops = gradientConfig.stops || [\n      { offset: '0%', color: 'var(--lcars-orange)' },\n      { offset: '100%', color: 'var(--lcars-red)' }\n    ];\n\n    if (type === 'radial') {\n      const cx = gradientConfig.cx || '50%';\n      const cy = gradientConfig.cy || '50%';\n      const r = gradientConfig.r || '50%';\n\n      const stopElements = stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<radialGradient id=\"${gradientId}\" cx=\"${cx}\" cy=\"${cy}\" r=\"${r}\">\n                ${stopElements}\n              </radialGradient>`;\n    } else {\n      const x1 = gradientConfig.x1 || '0%';\n      const y1 = gradientConfig.y1 || '0%';\n      const x2 = gradientConfig.x2 || '100%';\n      const y2 = gradientConfig.y2 || '0%';\n\n      const stopElements = stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<linearGradient id=\"${gradientId}\" x1=\"${x1}\" y1=\"${y1}\" x2=\"${x2}\" y2=\"${y2}\">\n                ${stopElements}\n              </linearGradient>`;\n    }\n  }\n\n  /**\n   * Create pattern definition for text\n   * @private\n   */\n  _createPatternDefinition(patternConfig, overlayId) {\n    const patternId = `text-pattern-${overlayId}`;\n\n    if (typeof patternConfig === 'string') {\n      // Simple pattern types\n      switch (patternConfig) {\n        case 'dots':\n          return `<pattern id=\"${patternId}\" patternUnits=\"userSpaceOnUse\" width=\"8\" height=\"8\">\n                    <circle cx=\"4\" cy=\"4\" r=\"1\" fill=\"currentColor\"/>\n                  </pattern>`;\n        case 'lines':\n          return `<pattern id=\"${patternId}\" patternUnits=\"userSpaceOnUse\" width=\"4\" height=\"4\">\n                    <path d=\"M 0,4 l 4,-4 M -1,1 l 2,-2 M 3,5 l 2,-2\" stroke=\"currentColor\" stroke-width=\"1\"/>\n                  </pattern>`;\n        default:\n          return '';\n      }\n    }\n\n    // Advanced pattern configuration\n    const width = patternConfig.width || 10;\n    const height = patternConfig.height || 10;\n    const patternUnits = patternConfig.patternUnits || 'userSpaceOnUse';\n\n    return `<pattern id=\"${patternId}\" patternUnits=\"${patternUnits}\" width=\"${width}\" height=\"${height}\">\n              ${patternConfig.content || ''}\n            </pattern>`;\n  }\n\n  /**\n   * Create glow filter for text\n   * @private\n   */\n  _createGlowFilter(glowConfig, overlayId) {\n    const filterId = `text-glow-${overlayId}`;\n\n    let color, blur, intensity;\n    if (typeof glowConfig === 'string') {\n      color = glowConfig;\n      blur = 3;\n      intensity = 1;\n    } else {\n      color = glowConfig.color || 'var(--lcars-orange)';\n      blur = Number(glowConfig.blur || 3);\n      intensity = Number(glowConfig.intensity || 1);\n    }\n\n    return `<filter id=\"${filterId}\">\n              <feGaussianBlur stdDeviation=\"${blur}\" result=\"blur\"/>\n              <feFlood flood-color=\"${color}\" flood-opacity=\"${intensity}\" result=\"color\"/>\n              <feComposite in=\"color\" in2=\"blur\" operator=\"in\" result=\"coloredBlur\"/>\n              <feMerge>\n                <feMergeNode in=\"coloredBlur\"/>\n                <feMergeNode in=\"SourceGraphic\"/>\n              </feMerge>\n            </filter>`;\n  }\n\n  /**\n   * Create shadow filter for text\n   * @private\n   */\n  _createShadowFilter(shadowConfig, overlayId) {\n    const filterId = `text-shadow-${overlayId}`;\n\n    let offsetX, offsetY, blur, color;\n    if (typeof shadowConfig === 'string') {\n      [offsetX, offsetY, blur, color] = shadowConfig.split(' ');\n      offsetX = Number(offsetX) || 2;\n      offsetY = Number(offsetY) || 2;\n      blur = Number(blur) || 2;\n      color = color || 'rgba(0,0,0,0.5)';\n    } else {\n      offsetX = Number(shadowConfig.offsetX || 2);\n      offsetY = Number(shadowConfig.offsetY || 2);\n      blur = Number(shadowConfig.blur || 2);\n      color = shadowConfig.color || 'rgba(0,0,0,0.5)';\n    }\n\n    return `<filter id=\"${filterId}\">\n              <feDropShadow dx=\"${offsetX}\" dy=\"${offsetY}\" stdDeviation=\"${blur}\" flood-color=\"${color}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Create blur filter for text\n   * @private\n   */\n  _createBlurFilter(blurConfig, overlayId) {\n    const filterId = `text-blur-${overlayId}`;\n    const blur = typeof blurConfig === 'number' ? blurConfig : (Number(blurConfig) || 1);\n\n    return `<filter id=\"${filterId}\">\n              <feGaussianBlur stdDeviation=\"${blur}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Parse gradient configuration\n   * @private\n   */\n  _parseGradientConfig(gradientConfig) {\n    if (!gradientConfig) return null;\n\n    if (typeof gradientConfig === 'string') {\n      return gradientConfig;\n    }\n\n    return {\n      type: gradientConfig.type || 'linear',\n      x1: gradientConfig.x1 || '0%',\n      y1: gradientConfig.y1 || '0%',\n      x2: gradientConfig.x2 || '100%',\n      y2: gradientConfig.y2 || '0%',\n      cx: gradientConfig.cx || '50%',\n      cy: gradientConfig.cy || '50%',\n      r: gradientConfig.r || '50%',\n      stops: gradientConfig.stops || []\n    };\n  }\n\n  /**\n   * Parse pattern configuration\n   * @private\n   */\n  _parsePatternConfig(patternConfig) {\n    if (!patternConfig) return null;\n    return patternConfig;\n  }\n\n  /**\n   * Parse glow configuration\n   * @private\n   */\n  _parseGlowConfig(glowConfig) {\n    if (!glowConfig) return null;\n    return glowConfig;\n  }\n\n  /**\n   * Parse shadow configuration\n   * @private\n   */\n  _parseShadowConfig(shadowConfig) {\n    if (!shadowConfig) return null;\n    return shadowConfig;\n  }\n\n  /**\n   * Parse blur configuration\n   * @private\n   */\n  _parseBlurConfig(blurConfig) {\n    if (!blurConfig) return null;\n    return blurConfig;\n  }\n\n  /**\n   * Prepare animation attributes for future anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    const animationAttributes = {\n      textAttributes: [],\n      hasAnimations: false\n    };\n\n    // Future: Add animation data attributes for anime.js\n    if (style.pulse_speed || style.pulseSpeed) {\n      animationAttributes.textAttributes.push(`data-pulse-speed=\"${style.pulse_speed || style.pulseSpeed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.fade_speed || style.fadeSpeed) {\n      animationAttributes.textAttributes.push(`data-fade-speed=\"${style.fade_speed || style.fadeSpeed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.typewriter_speed || style.typewriterSpeed) {\n      animationAttributes.textAttributes.push(`data-typewriter-speed=\"${style.typewriter_speed || style.typewriterSpeed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    // Add data attributes for anime.js targeting\n    if (animationAttributes.hasAnimations) {\n      animationAttributes.textAttributes.push('data-animatable=\"true\"');\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Render a simple fallback text when enhanced rendering fails\n   * @private\n   */\n  _renderFallbackText(overlay, x, y) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const text = style.value || overlay.text || '';\n    const color = style.color || 'var(--lcars-orange)';\n    const fontSize = style.font_size || style.fontSize || 16;\n\n    console.warn(`[TextOverlayRenderer] Using fallback rendering for text ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"text\" data-fallback=\"true\">\n              <text x=\"${x}\" y=\"${y}\"\n                    fill=\"${color}\"\n                    font-size=\"${fontSize}\"\n                    text-anchor=\"start\"\n                    dominant-baseline=\"auto\">\n                ${this.escapeXml(text)}\n              </text>\n            </g>`;\n  }\n\n  /**\n   * Update text styling dynamically (for future real-time updates)\n   * @public\n   */\n  updateTextStyle(overlayId, newStyle) {\n    // Future: Update existing text styles without full re-render\n    console.log(`[TextOverlayRenderer] Style update requested for text ${overlayId}`);\n  }\n\n  /**\n   * Get rendering capabilities and features supported\n   * @public\n   */\n  getCapabilities() {\n    return {\n      multiline: true,\n      gradients: true,\n      patterns: true,\n      effects: ['glow', 'shadow', 'blur'],\n      decorations: ['brackets', 'highlight', 'status'],\n      animations: ['pulse', 'fade', 'typewriter'], // Future implementation\n      textWrapping: true,\n      advancedTypography: true,\n      strokeText: true,\n      advanced: true\n    };\n  }\n\n  /**\n   * Escape XML special characters\n   * @private\n   */\n  static escapeXml(text) {\n    return String(text)\n      .replace(/&/g, '&amp;')\n      .replace(/</g, '&lt;')\n      .replace(/>/g, '&gt;')\n      .replace(/\"/g, '&quot;')\n      .replace(/'/g, '&#39;');\n  }\n\n  /**\n   * Instance method for XML escaping\n   * @private\n   */\n  escapeXml(text) {\n    return TextOverlayRenderer.escapeXml(text);\n  }\n\n  /**\n   * Get attachment points for line connectors with proper coordinate transformation\n   * @public\n   */\n  getAttachmentPoints(overlay, x, y) {\n    const textContent = this._resolveTextContent(overlay, overlay.finalStyle || {});\n    const textStyle = this._resolveTextStyles(overlay.finalStyle || {}, overlay.id);\n    // Use adjusted font for consistent connector attachment\n    const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n\n    return RendererUtils.getTextAttachmentPoints(\n      textContent,\n      x,\n      y,\n      font,\n      textStyle.textAnchor,\n      textStyle.dominantBaseline,\n      this.container\n    );\n  }\n\n  /**\n   * Compute attachment points & bbox for a text overlay without rendering (used by line routing).\n   * Returns null if position or content invalid.\n   */\n  static computeAttachmentPoints(overlay, anchors, container) {\n    if (!overlay || overlay.type !== 'text') return null;\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) return null;\n    const [x, y] = position;\n    const instance = new TextOverlayRenderer();\n    const style = overlay.finalStyle || overlay.style || {};\n    const textStyle = instance._resolveTextStyles(style, overlay.id);\n    const textContent = instance._resolveTextContent(overlay, style);\n    if (!textContent) return null;\n    // Measurement font (correct inherited font + scaling)\n    const font = RendererUtils.buildMeasurementFontString(textStyle, container);\n    const bbox = RendererUtils.getTextBoundingBox(\n      textContent,\n      x,\n      y,\n      font,\n      textStyle.textAnchor,\n      textStyle.dominantBaseline,\n      container\n    );\n    const points = RendererUtils.getTextAttachmentPoints(\n      textContent,\n      x,\n      y,\n      font,\n      textStyle.textAnchor,\n      textStyle.dominantBaseline,\n      container\n    );\n    return {\n      id: overlay.id,\n      center: points.center,\n      points,\n      bbox,\n      textStyle,\n      x,\n      y\n    };\n  }\n\n  // NEW: consolidated measurement helper (mirrors bracket/highlight logic)\n  _measureTextBlock(textContent, x, y, textStyle) {\n    try {\n      const font = RendererUtils.buildMeasurementFontString(textStyle, this.container);\n      if (textStyle.multiline) {\n        const mm = RendererUtils.measureMultilineText(\n          textContent,\n          font,\n          textStyle.lineHeight,\n          true,\n          this.container\n        );\n        return {\n          width: mm.width,\n          height: mm.height\n        };\n      } else {\n        const m = RendererUtils.measureText(textContent, font, true, this.container);\n        return {\n          width: m.width,\n          height: m.height\n        };\n      }\n    } catch (_) {\n      return { width: 0, height: 0 };\n    }\n  }\n}","/**\n * Enhanced Sparkline Renderer - Advanced sparkline rendering with comprehensive styling support\n * Provides rich sparkline styling features similar to LineOverlayRenderer and TextOverlayRenderer\n */\n\nimport { PositionResolver } from './PositionResolver.js';\nimport { RendererUtils } from './RendererUtils.js';\n\nexport class SparklineRenderer {\n  constructor() {\n    // Pre-defined caches for performance optimization\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n    this.filterCache = new Map();\n    this.pathCache = new Map();\n  }\n\n  /**\n   * Render a sparkline overlay with comprehensive styling support\n   * @param {Object} overlay - Sparkline overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled sparkline\n   */\n  static render(overlay, anchors, viewBox) {\n    // Create instance for non-static methods\n    const instance = new SparklineRenderer();\n    return instance.renderSparkline(overlay, anchors, viewBox);\n  }\n\n  /**\n   * Instance method for comprehensive sparkline rendering\n   * @param {Object} overlay - Sparkline overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled sparkline\n   */\n  renderSparkline(overlay, anchors, viewBox) {\n\n    const position = PositionResolver.resolvePosition(overlay.position, anchors);\n    if (!position) {\n      console.warn('[SparklineRenderer] Sparkline overlay position could not be resolved:', overlay.id);\n      return '';\n    }\n\n    const [x, y] = position;\n    const size = overlay.size || [200, 60];\n    const [width, height] = size;\n\n    try {\n      // Get data from source\n      const dataResult = SparklineRenderer.getHistoricalDataForSparkline(overlay.source);\n      // Extract comprehensive styling\n      const style = overlay.finalStyle || overlay.style || {};\n      const sparklineStyle = this._resolveSparklineStyles(style, overlay.id);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      console.log(`[SparklineRenderer] Data result for ${overlay.id}:`, dataResult.status, dataResult.data?.length);\n\n      if (dataResult.status === 'OK' && dataResult.data && dataResult.data.length >= 2) {\n        // Render real sparkline with advanced features\n        return this._renderEnhancedSparkline(\n          overlay, x, y, width, height, dataResult.data,\n          sparklineStyle, animationAttributes\n        );\n      } else {\n        // Render enhanced status indicator\n        return this._renderEnhancedStatusIndicator(\n          overlay, x, y, width, height, dataResult,\n          sparklineStyle, animationAttributes\n        );\n      }\n    } catch (error) {\n      console.error(`[SparklineRenderer] Enhanced rendering failed for sparkline ${overlay.id}:`, error);\n      return this._renderFallbackSparkline(overlay, x, y, width, height);\n    }\n  }\n\n  /**\n   * Resolve comprehensive sparkline styling from configuration\n   * @private\n   * @param {Object} style - Final resolved style object\n   * @param {string} overlayId - Overlay ID for unique identifiers\n   * @returns {Object} Complete sparkline style configuration\n   */\n  _resolveSparklineStyles(style, overlayId) {\n    const sparklineStyle = {\n      // Core line properties\n      color: style.color || style.stroke || 'var(--lcars-yellow)',\n      width: Number(style.width || style.stroke_width || style.strokeWidth || 2),\n      opacity: Number(style.opacity || 1),\n\n      // Advanced stroke styling\n      lineCap: (style.line_cap || style.lineCap || style.strokeLinecap || 'round').toLowerCase(),\n      lineJoin: (style.line_join || style.lineJoin || style.strokeLinejoin || 'round').toLowerCase(),\n      miterLimit: Number(style.miter_limit || style.miterLimit || 4),\n\n      // Dash patterns\n      dashArray: style.dash_array || style.dashArray || style.strokeDasharray || null,\n      dashOffset: Number(style.dash_offset || style.dashOffset || style.strokeDashoffset || 0),\n\n      // Path generation options\n      smoothing_mode: (style.smoothing_mode || style.smoothingMode || 'none').toLowerCase(),\n      interpolation: (style.interpolation || 'linear').toLowerCase(),\n      path_precision: Number(style.path_precision || style.pathPrecision || 2),\n\n      // Area fill properties\n      fill: style.fill || 'none',\n      fillOpacity: Number(style.fill_opacity || style.fillOpacity || 0.2),\n      fillGradient: this._parseGradientConfig(style.fill_gradient || style.fillGradient),\n\n      // Advanced styling\n      gradient: this._parseGradientConfig(style.gradient),\n      pattern: this._parsePatternConfig(style.pattern),\n\n      // Data visualization features\n      show_points: style.show_points || style.showPoints || false,\n      point_size: Number(style.point_size || style.pointSize || 3),\n      point_color: style.point_color || style.pointColor || null,\n      show_last_value: style.show_last_value || style.showLastValue || false,\n      value_format: style.value_format || style.valueFormat || null,\n\n      // Threshold and reference lines\n      thresholds: this._parseThresholds(style.thresholds),\n      zero_line: style.zero_line || style.zeroLine || false,\n      zero_line_color: style.zero_line_color || style.zeroLineColor || 'var(--lcars-gray)',\n\n      // Value range control\n      min_value: style.min_value !== undefined ? Number(style.min_value) : null,\n      max_value: style.max_value !== undefined ? Number(style.max_value) : null,\n      auto_scale: style.auto_scale !== false,\n\n      // Effects\n      glow: this._parseGlowConfig(style.glow),\n      shadow: this._parseShadowConfig(style.shadow),\n      blur: this._parseBlurConfig(style.blur),\n\n      // LCARS-specific features\n      bracket_style: style.bracket_style || style.bracketStyle || false,\n      bracket_width: Number(style.bracket_width || style.bracketWidth || 2), // Configurable bracket stroke width\n      bracket_color: style.bracket_color || style.bracketColor || null, // Separate bracket color\n      bracket_gap: Number(style.bracket_gap || style.bracketGap || 6), // Distance from sparkline\n      bracket_corner_radius: Number(style.bracket_corner_radius || style.bracketCornerRadius || 0),\n      bracket_style_mode: (style.bracket_style_mode || style.bracketStyleMode || 'square').toLowerCase(),\n\n      status_indicator: style.status_indicator || style.statusIndicator || false,\n      scan_line: style.scan_line || style.scanLine || false,\n\n      grid_lines: style.grid_lines || style.gridLines || false,\n      grid_color: style.grid_color || style.gridColor || 'var(--lcars-gray)',\n      grid_opacity: Number(style.grid_opacity || style.gridOpacity || 0.4), // Increased default opacity\n      grid_stroke_width: Number(style.grid_stroke_width || style.gridStrokeWidth || 1), // Configurable grid stroke width\n      grid_horizontal_count: Number(style.grid_horizontal_count || style.gridHorizontalCount || 3),\n      grid_vertical_count: Number(style.grid_vertical_count || style.gridVerticalCount || 5),\n\n      // Animation states (for future anime.js integration)\n      animatable: style.animatable !== false,\n      tracer_speed: Number(style.tracer_speed || style.tracerSpeed || 0),\n      pulse_speed: Number(style.pulse_speed || style.pulseSpeed || 0),\n\n      // Performance options\n      decimation: Number(style.decimation || 0), // 0 = no decimation\n      max_points: Number(style.max_points || style.maxPoints || 1000),\n\n      // Track enabled features for optimization\n      features: []\n    };\n\n    // Build feature list for conditional rendering\n    if (sparklineStyle.gradient) sparklineStyle.features.push('gradient');\n    if (sparklineStyle.pattern) sparklineStyle.features.push('pattern');\n    if (sparklineStyle.fill !== 'none') sparklineStyle.features.push('area-fill');\n    if (sparklineStyle.fillGradient) sparklineStyle.features.push('area-gradient');\n    if (sparklineStyle.show_points) sparklineStyle.features.push('data-points');\n    if (sparklineStyle.thresholds && sparklineStyle.thresholds.length > 0) sparklineStyle.features.push('thresholds');\n    if (sparklineStyle.zero_line) sparklineStyle.features.push('zero-line');\n    if (sparklineStyle.glow) sparklineStyle.features.push('glow');\n    if (sparklineStyle.shadow) sparklineStyle.features.push('shadow');\n    if (sparklineStyle.blur) sparklineStyle.features.push('blur');\n    if (sparklineStyle.bracket_style) sparklineStyle.features.push('brackets');\n    if (sparklineStyle.status_indicator) sparklineStyle.features.push('status');\n    if (sparklineStyle.scan_line) sparklineStyle.features.push('scan-line');\n    if (sparklineStyle.grid_lines) sparklineStyle.features.push('grid');\n    if (sparklineStyle.show_last_value) sparklineStyle.features.push('value-label');\n    if (sparklineStyle.smoothing_mode !== 'none') sparklineStyle.features.push('smoothing');\n    if (sparklineStyle.tracer_speed > 0) sparklineStyle.features.push('tracer');\n    if (sparklineStyle.pulse_speed > 0) sparklineStyle.features.push('pulse');\n\n    return sparklineStyle;\n  }\n\n  /**\n   * Render enhanced sparkline with all features\n   * @private\n   */\n  _renderEnhancedSparkline(overlay, x, y, width, height, data, sparklineStyle, animationAttributes) {\n    const svgParts = [\n      this._buildDefinitions(sparklineStyle, overlay.id),\n      this._buildSparklineBackground(width, height, sparklineStyle, overlay.id),\n      this._buildGridLines(width, height, sparklineStyle, overlay.id),\n      this._buildThresholdLines(data, width, height, sparklineStyle, overlay.id),\n      this._buildZeroLine(data, width, height, sparklineStyle, overlay.id),\n      this._buildAreaFill(data, width, height, sparklineStyle, overlay.id),\n      this._buildMainSparklinePath(data, width, height, sparklineStyle, overlay.id, animationAttributes),\n      this._buildDataPoints(data, width, height, sparklineStyle, overlay.id),\n      this._buildValueLabel(data, width, height, sparklineStyle, overlay.id),\n      this._buildBrackets(width, height, sparklineStyle, overlay.id),\n      this._buildStatusIndicator(width, height, sparklineStyle, overlay.id),\n      this._buildScanLine(width, height, sparklineStyle, overlay.id)\n    ].filter(Boolean);\n\n    console.log(`[SparklineRenderer] Rendered enhanced sparkline ${overlay.id} with ${sparklineStyle.features.length} features`);\n\n    return `<g data-overlay-id=\"${overlay.id}\"\n                data-overlay-type=\"sparkline\"\n                data-source=\"${overlay.source}\"\n                data-sparkline-features=\"${sparklineStyle.features.join(',')}\"\n                data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                transform=\"translate(${x}, ${y})\">\n              ${svgParts.join('\\n')}\n            </g>`;\n  }\n\n  /**\n   * Build SVG definitions for gradients, patterns, and effects\n   * @private\n   */\n  _buildDefinitions(sparklineStyle, overlayId) {\n    const defs = [];\n\n    // Line gradients\n    if (sparklineStyle.gradient) {\n      defs.push(RendererUtils.createGradientDefinition(sparklineStyle.gradient, `sparkline-gradient-${overlayId}`));\n    }\n\n    // Area fill gradients\n    if (sparklineStyle.fillGradient) {\n      defs.push(RendererUtils.createGradientDefinition(sparklineStyle.fillGradient, `sparkline-area-gradient-${overlayId}`));\n    }\n\n    // Patterns\n    if (sparklineStyle.pattern) {\n      defs.push(RendererUtils.createPatternDefinition(sparklineStyle.pattern, `sparkline-pattern-${overlayId}`));\n    }\n\n    // Effects (filters)\n    if (sparklineStyle.glow) {\n      defs.push(RendererUtils.createGlowFilter(sparklineStyle.glow, `sparkline-glow-${overlayId}`));\n    }\n\n    if (sparklineStyle.shadow) {\n      defs.push(RendererUtils.createShadowFilter(sparklineStyle.shadow, `sparkline-shadow-${overlayId}`));\n    }\n\n    if (sparklineStyle.blur) {\n      defs.push(RendererUtils.createBlurFilter(sparklineStyle.blur, `sparkline-blur-${overlayId}`));\n    }\n\n    return defs.length > 0 ? `<defs>${defs.join('\\n')}</defs>` : '';\n  }\n\n  /**\n   * Build background rectangle for contrast\n   * @private\n   */\n  _buildSparklineBackground(width, height, sparklineStyle, overlayId) {\n    // Only render background if explicitly configured\n    return '';\n  }\n\n  /**\n   * Build grid lines for technical appearance\n   * @private\n   */\n  _buildGridLines(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.grid_lines) return '';\n\n    const lines = [];\n\n    // Horizontal grid lines\n    for (let i = 1; i < sparklineStyle.grid_horizontal_count; i++) {\n      const y = (height / sparklineStyle.grid_horizontal_count) * i;\n      lines.push(`<line x1=\"0\" y1=\"${y}\" x2=\"${width}\" y2=\"${y}\"\n                        stroke=\"${sparklineStyle.grid_color}\"\n                        stroke-width=\"${sparklineStyle.grid_stroke_width}\"\n                        opacity=\"${sparklineStyle.grid_opacity}\"/>`);\n    }\n\n    // Vertical grid lines\n    for (let i = 1; i < sparklineStyle.grid_vertical_count; i++) {\n      const x = (width / sparklineStyle.grid_vertical_count) * i;\n      lines.push(`<line x1=\"${x}\" y1=\"0\" x2=\"${x}\" y2=\"${height}\"\n                        stroke=\"${sparklineStyle.grid_color}\"\n                        stroke-width=\"${sparklineStyle.grid_stroke_width}\"\n                        opacity=\"${sparklineStyle.grid_opacity}\"/>`);\n    }\n\n    return `<g data-feature=\"grid-lines\">${lines.join('\\n')}</g>`;\n  }\n\n  /**\n   * Build threshold reference lines\n   * @private\n   */\n  _buildThresholdLines(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.thresholds || sparklineStyle.thresholds.length === 0) return '';\n\n    const values = data.map(d => d.value);\n    const minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n    const maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n    const valueRange = maxValue - minValue || 1;\n\n    const thresholdLines = sparklineStyle.thresholds.map(threshold => {\n      const y = height - ((threshold.value - minValue) / valueRange) * height;\n      const color = threshold.color || 'var(--lcars-orange)';\n      const strokeWidth = threshold.width || 1;\n      const opacity = threshold.opacity || 0.7;\n      const dashArray = threshold.dash ? '4,2' : null;\n\n      return `<line x1=\"0\" y1=\"${y}\" x2=\"${width}\" y2=\"${y}\"\n                    stroke=\"${color}\" stroke-width=\"${strokeWidth}\" opacity=\"${opacity}\"\n                    ${dashArray ? `stroke-dasharray=\"${dashArray}\"` : ''}\n                    data-threshold=\"${threshold.value}\"/>`;\n    });\n\n    return `<g data-feature=\"threshold-lines\">${thresholdLines.join('\\n')}</g>`;\n  }\n\n  /**\n   * Build zero baseline reference\n   * @private\n   */\n  _buildZeroLine(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.zero_line) return '';\n\n    const values = data.map(d => d.value);\n    const minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n    const maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n\n    // Only show zero line if zero is within the data range\n    if (minValue > 0 || maxValue < 0) return '';\n\n    const valueRange = maxValue - minValue || 1;\n    const zeroY = height - ((0 - minValue) / valueRange) * height;\n\n    return `<line x1=\"0\" y1=\"${zeroY}\" x2=\"${width}\" y2=\"${zeroY}\"\n                  stroke=\"${sparklineStyle.zero_line_color}\" stroke-width=\"1\" opacity=\"0.5\"\n                  stroke-dasharray=\"2,2\"\n                  data-feature=\"zero-line\"/>`;\n  }\n\n  /**\n   * Build area fill under sparkline\n   * @private\n   */\n  _buildAreaFill(data, width, height, sparklineStyle, overlayId) {\n    if (sparklineStyle.fill === 'none' && !sparklineStyle.fillGradient) return '';\n\n    const processedData = this._processDataForRendering(data, sparklineStyle);\n    const pathData = this._createSparklinePath(processedData, { width, height }, sparklineStyle);\n\n    // Create area path by adding bottom edge\n    const areaPath = pathData + ` L ${width} ${height} L 0 ${height} Z`;\n\n    let fillColor = sparklineStyle.fill;\n    if (sparklineStyle.fillGradient) {\n      fillColor = `url(#sparkline-area-gradient-${overlayId})`;\n    } else if (fillColor === 'none') {\n      fillColor = sparklineStyle.color;\n    }\n\n    return `<path d=\"${areaPath}\"\n                  fill=\"${fillColor}\"\n                  fill-opacity=\"${sparklineStyle.fillOpacity}\"\n                  data-feature=\"area-fill\"/>`;\n  }\n\n  /**\n   * Build the main sparkline path with advanced styling\n   * @private\n   */\n  _buildMainSparklinePath(data, width, height, sparklineStyle, overlayId, animationAttributes) {\n    const processedData = this._processDataForRendering(data, sparklineStyle);\n    const pathData = this._createSparklinePath(processedData, { width, height }, sparklineStyle);\n\n    const attributes = [];\n\n    // Core path\n    attributes.push(`d=\"${pathData}\"`);\n    attributes.push(`fill=\"none\"`);\n\n    // Stroke styling\n    if (sparklineStyle.gradient) {\n      attributes.push(`stroke=\"url(#sparkline-gradient-${overlayId})\"`);\n    } else if (sparklineStyle.pattern) {\n      attributes.push(`stroke=\"url(#sparkline-pattern-${overlayId})\"`);\n    } else {\n      attributes.push(`stroke=\"${sparklineStyle.color}\"`);\n    }\n\n    attributes.push(`stroke-width=\"${sparklineStyle.width}\"`);\n    attributes.push(`stroke-opacity=\"${sparklineStyle.opacity}\"`);\n    attributes.push(`stroke-linecap=\"${sparklineStyle.lineCap}\"`);\n    attributes.push(`stroke-linejoin=\"${sparklineStyle.lineJoin}\"`);\n    attributes.push(`vector-effect=\"non-scaling-stroke\"`);\n\n    if (sparklineStyle.lineJoin === 'miter' && sparklineStyle.miterLimit !== 4) {\n      attributes.push(`stroke-miterlimit=\"${sparklineStyle.miterLimit}\"`);\n    }\n\n    if (sparklineStyle.dashArray) {\n      attributes.push(`stroke-dasharray=\"${sparklineStyle.dashArray}\"`);\n      if (sparklineStyle.dashOffset !== 0) {\n        attributes.push(`stroke-dashoffset=\"${sparklineStyle.dashOffset}\"`);\n      }\n    }\n\n    // Effects\n    const filters = [];\n    if (sparklineStyle.glow) filters.push(`url(#sparkline-glow-${overlayId})`);\n    if (sparklineStyle.shadow) filters.push(`url(#sparkline-shadow-${overlayId})`);\n    if (sparklineStyle.blur) filters.push(`url(#sparkline-blur-${overlayId})`);\n    if (filters.length > 0) {\n      attributes.push(`filter=\"${filters.join(' ')}\"`);\n    }\n\n    // Animation attributes\n    attributes.push(...animationAttributes.pathAttributes);\n\n    return `<path ${attributes.join(' ')} data-feature=\"main-path\"/>`;\n  }\n\n  /**\n   * Build data point markers\n   * @private\n   */\n  _buildDataPoints(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.show_points) return '';\n\n    const processedData = this._processDataForRendering(data, sparklineStyle);\n    const points = this._calculateDataPointPositions(processedData, { width, height }, sparklineStyle);\n\n    const pointColor = sparklineStyle.point_color || sparklineStyle.color;\n    const pointSize = sparklineStyle.point_size;\n\n    const pointElements = points.map((point, index) => {\n      return `<circle cx=\"${point.x.toFixed(sparklineStyle.path_precision)}\"\n                      cy=\"${point.y.toFixed(sparklineStyle.path_precision)}\"\n                      r=\"${pointSize}\"\n                      fill=\"${pointColor}\"\n                      opacity=\"${sparklineStyle.opacity}\"\n                      data-value=\"${point.value}\"\n                      data-timestamp=\"${point.timestamp}\"/>`;\n    });\n\n    return `<g data-feature=\"data-points\">${pointElements.join('\\n')}</g>`;\n  }\n\n  /**\n   * Build last value label\n   * @private\n   */\n  _buildValueLabel(data, width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.show_last_value || data.length === 0) return '';\n\n    const lastValue = data[data.length - 1].value;\n    const formattedValue = sparklineStyle.value_format ?\n      this._formatValue(lastValue, sparklineStyle.value_format) :\n      lastValue.toFixed(1);\n\n    const fontSize = Math.min(width / 10, height / 3, 12);\n    const labelX = width + 4;\n    const labelY = height / 2;\n\n    return `<text x=\"${labelX}\" y=\"${labelY}\"\n                  fill=\"${sparklineStyle.color}\"\n                  font-size=\"${fontSize}\"\n                  text-anchor=\"start\"\n                  dominant-baseline=\"middle\"\n                  font-family=\"var(--lcars-font-family, monospace)\"\n                  data-feature=\"value-label\">\n              ${formattedValue}\n            </text>`;\n  }\n\n  /**\n   * Build LCARS-style brackets with proper orientation and corner styling\n   * @private\n   */\n  _buildBrackets(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.bracket_style) return '';\n\n    const bracketColor = sparklineStyle.bracket_color || sparklineStyle.color;\n    const strokeWidth = sparklineStyle.bracket_width;\n\n    let gap = sparklineStyle.bracket_gap;\n    if (sparklineStyle.smoothing_mode !== 'none') {\n      gap = Math.max(gap, 12);\n    }\n\n    const cornerRadius = sparklineStyle.bracket_corner_radius;\n    const styleMode = sparklineStyle.bracket_style_mode;\n\n    let leftBracketPath, rightBracketPath;\n    if (styleMode === 'rounded' && cornerRadius > 0) {\n      leftBracketPath = this._buildRoundedBracketPath('left', gap, height, cornerRadius);\n      rightBracketPath = this._buildRoundedBracketPath('right', width, gap, height, cornerRadius);\n    } else if (styleMode === 'lcars') {\n      leftBracketPath = this._buildLcarsBracketPath('left', gap, height);\n      rightBracketPath = this._buildLcarsBracketPath('right', width, gap, height);\n    } else {\n      leftBracketPath = this._buildSquareBracketPath('left', gap, height);\n      rightBracketPath = this._buildSquareBracketPath('right', width, gap, height);\n    }\n\n    return `<g data-feature=\"brackets\">\n              <path d=\"${leftBracketPath}\" stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n              <path d=\"${rightBracketPath}\" stroke=\"${bracketColor}\" stroke-width=\"${strokeWidth}\" fill=\"none\"/>\n            </g>`;\n  }\n\n  /**\n   * Build square corner bracket path\n   * @private\n   */\n  _buildSquareBracketPath(side, gapOrWidth, gapOrHeight, height) {\n    if (side === 'left') {\n      const gap = gapOrWidth;\n      const h = gapOrHeight;\n      return `M ${-gap - 4} 0 L ${-gap - 4} ${h} M ${-gap - 4} 0 L ${-gap/2} 0 M ${-gap - 4} ${h} L ${-gap/2} ${h}`;\n    } else {\n      const width = gapOrWidth;\n      const gap = gapOrHeight;\n      const h = height;\n      return `M ${width + gap/2} 0 L ${width + gap + 4} 0 M ${width + gap + 4} 0 L ${width + gap + 4} ${h} M ${width + gap/2} ${h} L ${width + gap + 4} ${h}`;\n    }\n  }\n\n  /**\n   * Build rounded corner bracket path\n   * @private\n   */\n  _buildRoundedBracketPath(side, gapOrWidth, gapOrHeight, heightOrRadius, radiusOrHeight) {\n    if (side === 'left') {\n      const gap = gapOrWidth;\n      const h = gapOrHeight;\n      const radius = heightOrRadius;\n      const minRadius = Math.min(radius, gap/4, h/6);\n      return `M ${-gap - 4} ${minRadius}\n              A ${minRadius} ${minRadius} 0 0 1 ${-gap - 4 + minRadius} 0\n              L ${-gap/2} 0\n              M ${-gap - 4} ${h - minRadius}\n              A ${minRadius} ${minRadius} 0 0 0 ${-gap - 4 + minRadius} ${h}\n              L ${-gap/2} ${h}\n              M ${-gap - 4} ${minRadius}\n              L ${-gap - 4} ${h - minRadius}`;\n    } else {\n      const width = gapOrWidth;\n      const gap = gapOrHeight;\n      const h = heightOrRadius;\n      const radius = radiusOrHeight;\n      const minRadius = Math.min(radius, gap/4, h/6);\n      return `M ${width + gap/2} 0\n              L ${width + gap + 4 - minRadius} 0\n              A ${minRadius} ${minRadius} 0 0 1 ${width + gap + 4} ${minRadius}\n              M ${width + gap/2} ${h}\n              L ${width + gap + 4 - minRadius} ${h}\n              A ${minRadius} ${minRadius} 0 0 0 ${width + gap + 4} ${h - minRadius}\n              M ${width + gap + 4} ${minRadius}\n              L ${width + gap + 4} ${h - minRadius}`;\n    }\n  }\n\n  /**\n   * Build LCARS-style bracket path with characteristic corner cuts\n   * @private\n   */\n  _buildLcarsBracketPath(side, gapOrWidth, gapOrHeight, height) {\n    if (side === 'left') {\n      const gap = gapOrWidth;\n      const h = gapOrHeight;\n      const cutSize = Math.min(4, gap/4, h/10);\n      return `M ${-gap - 4} ${cutSize}\n              L ${-gap - 4 + cutSize} 0\n              L ${-gap/2} 0\n              M ${-gap - 4} ${h - cutSize}\n              L ${-gap - 4 + cutSize} ${h}\n              L ${-gap/2} ${h}\n              M ${-gap - 4} ${cutSize}\n              L ${-gap - 4} ${h - cutSize}`;\n    } else {\n      const width = gapOrWidth;\n      const gap = gapOrHeight;\n      const h = height;\n      const cutSize = Math.min(4, gap/4, h/10);\n      return `M ${width + gap/2} 0\n              L ${width + gap + 4 - cutSize} 0\n              L ${width + gap + 4} ${cutSize}\n              M ${width + gap/2} ${h}\n              L ${width + gap + 4 - cutSize} ${h}\n              L ${width + gap + 4} ${h - cutSize}\n              M ${width + gap + 4} ${cutSize}\n              L ${width + gap + 4} ${h - cutSize}`;\n    }\n  }\n\n  /**\n   * Build status indicator\n   * @private\n   */\n  _buildStatusIndicator(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.status_indicator) return '';\n\n    const indicatorSize = 4;\n    const indicatorColor = typeof sparklineStyle.status_indicator === 'string' ?\n      sparklineStyle.status_indicator : 'var(--lcars-green)';\n\n    return `<circle cx=\"${-indicatorSize - 4}\" cy=\"${height / 2}\" r=\"${indicatorSize}\"\n                    fill=\"${indicatorColor}\"\n                    data-feature=\"status-indicator\"/>`;\n  }\n\n  /**\n   * Build scan line animation element\n   * @private\n   */\n  _buildScanLine(width, height, sparklineStyle, overlayId) {\n    if (!sparklineStyle.scan_line) return '';\n\n    return `<line x1=\"0\" y1=\"0\" x2=\"0\" y2=\"${height}\"\n                  stroke=\"${sparklineStyle.color}\" stroke-width=\"1\" opacity=\"0.8\"\n                  data-feature=\"scan-line\"\n                  data-scan-speed=\"${sparklineStyle.tracer_speed || 2}\">\n              <animate attributeName=\"x1\" values=\"0;${width};0\" dur=\"3s\" repeatCount=\"indefinite\"/>\n              <animate attributeName=\"x2\" values=\"0;${width};0\" dur=\"3s\" repeatCount=\"indefinite\"/>\n            </line>`;\n  }\n\n  /**\n   * Create enhanced sparkline path with smoothing options\n   * @private\n   */\n  _createSparklinePath(data, bounds, sparklineStyle) {\n    if (!data || data.length < 2) {\n      return `M 0 ${bounds.height / 2} L ${bounds.width} ${bounds.height / 2}`;\n    }\n\n    const { width, height } = bounds;\n    const points = this._calculateDataPointPositions(data, bounds, sparklineStyle);\n\n    // Apply smoothing based on mode with proper width normalization\n    let path;\n    switch (sparklineStyle.smoothing_mode) {\n      case 'chaikin':\n        path = this._createChaikinPath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'constrained':\n        path = this._createConstrainedSmoothPath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'bezier':\n        path = this._createBezierPath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'spline':\n        path = this._createSplinePath(points, sparklineStyle.path_precision, width);\n        break;\n      case 'stepped':\n        path = this._createSteppedPath(points, sparklineStyle.path_precision);\n        break;\n      default:\n        path = this._createLinearPath(points, sparklineStyle.path_precision);\n        break;\n    }\n\n    return path;\n  }\n\n  /**\n   * Calculate data point positions with scaling\n   * @private\n   */\n  _calculateDataPointPositions(data, bounds, sparklineStyle) {\n    const { width, height } = bounds;\n\n    // Find value range\n    const values = data.map(d => d.value);\n    let minValue = sparklineStyle.min_value !== null ? sparklineStyle.min_value : Math.min(...values);\n    let maxValue = sparklineStyle.max_value !== null ? sparklineStyle.max_value : Math.max(...values);\n\n    // Handle edge cases\n    if (minValue === maxValue) {\n      minValue -= 0.5;\n      maxValue += 0.5;\n    }\n\n    const valueRange = maxValue - minValue;\n\n    return data.map((point, index) => ({\n      x: (index / (data.length - 1)) * width,\n      y: height - ((point.value - minValue) / valueRange) * height,\n      value: point.value,\n      timestamp: point.timestamp\n    }));\n  }\n\n  /**\n   * Create linear path (default)\n   * @private\n   */\n  _createLinearPath(points, precision) {\n    const pathSegments = [];\n\n    points.forEach((point, index) => {\n      const x = point.x.toFixed(precision);\n      const y = point.y.toFixed(precision);\n\n      if (index === 0) {\n        pathSegments.push(`M ${x} ${y}`);\n      } else {\n        pathSegments.push(`L ${x} ${y}`);\n      }\n    });\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Create stepped path\n   * @private\n   */\n  _createSteppedPath(points, precision) {\n    const pathSegments = [];\n\n    points.forEach((point, index) => {\n      const x = point.x.toFixed(precision);\n      const y = point.y.toFixed(precision);\n\n      if (index === 0) {\n        pathSegments.push(`M ${x} ${y}`);\n      } else {\n        const prevY = points[index - 1].y.toFixed(precision);\n        pathSegments.push(`L ${x} ${prevY}`);\n        pathSegments.push(`L ${x} ${y}`);\n      }\n    });\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Create Chaikin smoothed path with width normalization\n   * @private\n   */\n  _createChaikinPath(points, precision, targetWidth) {\n    if (points.length < 3) return this._createLinearPath(points, precision);\n\n    // Chaikin subdivision algorithm\n    let smoothedPoints = [...points];\n\n    // Apply Chaikin subdivision iterations\n    for (let iteration = 0; iteration < 2; iteration++) {\n      const newPoints = [];\n\n      for (let i = 0; i < smoothedPoints.length - 1; i++) {\n        const p1 = smoothedPoints[i];\n        const p2 = smoothedPoints[i + 1];\n\n        // Quarter point\n        newPoints.push({\n          x: p1.x * 0.75 + p2.x * 0.25,\n          y: p1.y * 0.75 + p2.y * 0.25\n        });\n\n        // Three-quarter point\n        newPoints.push({\n          x: p1.x * 0.25 + p2.x * 0.75,\n          y: p1.y * 0.25 + p2.y * 0.75\n        });\n      }\n\n      smoothedPoints = newPoints;\n    }\n\n    // Normalize X coordinates to span full width\n    if (smoothedPoints.length > 1) {\n      const minX = Math.min(...smoothedPoints.map(p => p.x));\n      const maxX = Math.max(...smoothedPoints.map(p => p.x));\n      const currentWidth = maxX - minX;\n\n      if (currentWidth > 0) {\n        smoothedPoints = smoothedPoints.map(point => ({\n          x: ((point.x - minX) / currentWidth) * targetWidth,\n          y: point.y\n        }));\n      }\n    }\n\n    return this._createLinearPath(smoothedPoints, precision);\n  }\n\n  /**\n   * Create Bezier curved path with width normalization\n   * @private\n   */\n  _createBezierPath(points, precision, targetWidth) {\n    if (points.length < 3) return this._createLinearPath(points, precision);\n\n    const pathSegments = [`M ${points[0].x.toFixed(precision)} ${points[0].y.toFixed(precision)}`];\n\n    for (let i = 1; i < points.length - 1; i++) {\n      const p0 = points[i - 1];\n      const p1 = points[i];\n      const p2 = points[i + 1];\n\n      // Control points for smooth curve\n      const cp1x = p0.x + (p1.x - p0.x) * 0.5;\n      const cp1y = p0.y + (p1.y - p0.y) * 0.5;\n      const cp2x = p1.x - (p2.x - p1.x) * 0.5;\n      const cp2y = p1.y - (p2.y - p1.y) * 0.5;\n\n      pathSegments.push(`Q ${cp1x.toFixed(precision)} ${cp1y.toFixed(precision)} ${p1.x.toFixed(precision)} ${p1.y.toFixed(precision)}`);\n    }\n\n    // Final point\n    const lastPoint = points[points.length - 1];\n    pathSegments.push(`L ${lastPoint.x.toFixed(precision)} ${lastPoint.y.toFixed(precision)}`);\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Create spline path with width normalization\n   * @private\n   */\n  _createSplinePath(points, precision, targetWidth) {\n    if (points.length < 4) return this._createBezierPath(points, precision, targetWidth);\n\n    // Generate spline points\n    const splinePoints = [];\n\n    // Start with first point\n    splinePoints.push(points[0]);\n\n    // Generate intermediate spline points\n    for (let i = 1; i < points.length - 2; i++) {\n      const p0 = points[i - 1];\n      const p1 = points[i];\n      const p2 = points[i + 1];\n      const p3 = points[i + 2];\n\n      // Catmull-Rom spline - generate multiple points along the curve\n      const segments = 10; // Number of segments between each pair of points\n      for (let t = 0; t <= segments; t++) {\n        const u = t / segments;\n        const u2 = u * u;\n        const u3 = u2 * u;\n\n        // Catmull-Rom basis functions\n        const f1 = -0.5 * u3 + u2 - 0.5 * u;\n        const f2 = 1.5 * u3 - 2.5 * u2 + 1;\n        const f3 = -1.5 * u3 + 2 * u2 + 0.5 * u;\n        const f4 = 0.5 * u3 - 0.5 * u2;\n\n        const x = f1 * p0.x + f2 * p1.x + f3 * p2.x + f4 * p3.x;\n        const y = f1 * p0.y + f2 * p1.y + f3 * p2.y + f4 * p3.y;\n\n        splinePoints.push({ x, y });\n      }\n    }\n\n    // Add final point\n    splinePoints.push(points[points.length - 1]);\n\n    // Normalize X coordinates to span full width\n    if (splinePoints.length > 1) {\n      const minX = Math.min(...splinePoints.map(p => p.x));\n      const maxX = Math.max(...splinePoints.map(p => p.x));\n      const currentWidth = maxX - minX;\n\n      if (currentWidth > 0) {\n        splinePoints.forEach(point => {\n          point.x = ((point.x - minX) / currentWidth) * targetWidth;\n        });\n      }\n    }\n\n    return this._createLinearPath(splinePoints, precision);\n  }\n\n  /**\n   * Create constrained smooth path that passes through all data points\n   * @private\n   */\n  _createConstrainedSmoothPath(points, precision, targetWidth) {\n    if (points.length < 3) return this._createLinearPath(points, precision);\n\n    const pathSegments = [];\n\n    // Start at first point\n    pathSegments.push(`M ${points[0].x.toFixed(precision)} ${points[0].y.toFixed(precision)}`);\n\n    // Create smooth curves between each pair of points\n    for (let i = 0; i < points.length - 1; i++) {\n      const current = points[i];\n      const next = points[i + 1];\n\n      // Calculate control points for smooth curve\n      let cp1x, cp1y, cp2x, cp2y;\n\n      if (i === 0) {\n        // First segment - use next point for direction\n        const next2 = points[i + 2] || next;\n        cp1x = current.x + (next.x - current.x) * 0.3;\n        cp1y = current.y + (next.y - current.y) * 0.2;\n        cp2x = next.x - (next2.x - current.x) * 0.2;\n        cp2y = next.y - (next2.y - current.y) * 0.1;\n      } else if (i === points.length - 2) {\n        // Last segment - use previous point for direction\n        const prev = points[i - 1];\n        cp1x = current.x + (next.x - prev.x) * 0.2;\n        cp1y = current.y + (next.y - prev.y) * 0.1;\n        cp2x = next.x - (next.x - current.x) * 0.3;\n        cp2y = next.y - (next.y - current.y) * 0.2;\n      } else {\n        // Middle segments - use surrounding points for smooth direction\n        const prev = points[i - 1];\n        const next2 = points[i + 2];\n\n        const prevSlope = {\n          x: next.x - prev.x,\n          y: next.y - prev.y\n        };\n        const nextSlope = {\n          x: next2.x - current.x,\n          y: next2.y - current.y\n        };\n\n        // Smooth the transition\n        cp1x = current.x + prevSlope.x * 0.25;\n        cp1y = current.y + prevSlope.y * 0.15;\n        cp2x = next.x - nextSlope.x * 0.25;\n        cp2y = next.y - nextSlope.y * 0.15;\n      }\n\n      // Clamp control points to reasonable bounds\n      cp1x = Math.max(current.x, Math.min(next.x, cp1x));\n      cp2x = Math.max(current.x, Math.min(next.x, cp2x));\n\n      pathSegments.push(`C ${cp1x.toFixed(precision)} ${cp1y.toFixed(precision)} ${cp2x.toFixed(precision)} ${cp2y.toFixed(precision)} ${next.x.toFixed(precision)} ${next.y.toFixed(precision)}`);\n    }\n\n    return pathSegments.join(' ');\n  }\n\n  /**\n   * Process data for rendering (decimation, filtering)\n   * @private\n   */\n  _processDataForRendering(data, sparklineStyle) {\n    let processedData = [...data];\n\n    // Apply decimation if needed\n    if (sparklineStyle.decimation > 0 && processedData.length > sparklineStyle.decimation) {\n      const step = Math.floor(processedData.length / sparklineStyle.decimation);\n      processedData = processedData.filter((_, index) => index % step === 0);\n\n      // Always include the last point\n      if (processedData[processedData.length - 1] !== data[data.length - 1]) {\n        processedData.push(data[data.length - 1]);\n      }\n    }\n\n    // Apply max_points limit\n    if (sparklineStyle.max_points > 0 && processedData.length > sparklineStyle.max_points) {\n      const step = Math.floor(processedData.length / sparklineStyle.max_points);\n      processedData = processedData.filter((_, index) => index % step === 0);\n\n      // Always include the last point\n      if (processedData[processedData.length - 1] !== data[data.length - 1]) {\n        processedData.push(data[data.length - 1]);\n      }\n    }\n\n    return processedData;\n  }\n\n  /**\n   * Render enhanced status indicator\n   * @private\n   */\n  _renderEnhancedStatusIndicator(overlay, x, y, width, height, dataResult, sparklineStyle, animationAttributes) {\n    const statusColors = {\n      'NO_SOURCE': 'var(--lcars-red)',\n      'MANAGER_NOT_AVAILABLE': 'var(--lcars-blue)',\n      'SOURCE_NOT_FOUND': 'var(--lcars-orange)',\n      'NO_BUFFER': 'var(--lcars-orange)',\n      'EMPTY_BUFFER': 'var(--lcars-blue)',\n      'INSUFFICIENT_DATA': 'var(--lcars-blue)',\n      'ERROR': 'var(--lcars-red)'\n    };\n\n    const statusMessages = {\n      'NO_SOURCE': 'NO SOURCE',\n      'MANAGER_NOT_AVAILABLE': 'LOADING',\n      'SOURCE_NOT_FOUND': 'NOT FOUND',\n      'NO_BUFFER': 'NO BUFFER',\n      'EMPTY_BUFFER': 'NO DATA',\n      'INSUFFICIENT_DATA': 'LOADING',\n      'ERROR': 'ERROR'\n    };\n\n    const indicatorColor = statusColors[dataResult.status] || sparklineStyle.color;\n    const indicatorText = statusMessages[dataResult.status] || 'UNKNOWN';\n    const fontSize = Math.min(width / 8, height / 3, 14);\n\n    // Enhanced status with LCARS styling\n    const loadingStates = ['MANAGER_NOT_AVAILABLE', 'INSUFFICIENT_DATA'];\n    const isLoading = loadingStates.includes(dataResult.status);\n\n    const animationProps = isLoading ? `\n      <animate attributeName=\"opacity\" values=\"0.3;1.0;0.3\" dur=\"1s\" repeatCount=\"indefinite\"/>\n    ` : `\n      <animate attributeName=\"opacity\" values=\"0.3;0.8;0.3\" dur=\"2s\" repeatCount=\"indefinite\"/>\n    `;\n\n    const svgParts = [\n      this._buildDefinitions(sparklineStyle, overlay.id),\n      sparklineStyle.bracket_style ? this._buildBrackets(width, height, { ...sparklineStyle, color: indicatorColor }, overlay.id) : '',\n      `<rect width=\"${width}\" height=\"${height}\"\n             fill=\"none\" stroke=\"${indicatorColor}\" stroke-width=\"2\"\n             stroke-dasharray=\"${isLoading ? '4,2' : '8,4'}\" opacity=\"0.6\">\n        ${animationProps}\n       </rect>`,\n      `<text x=\"${width / 2}\" y=\"${height / 2}\"\n             fill=\"${indicatorColor}\" text-anchor=\"middle\" dominant-baseline=\"middle\"\n             font-family=\"var(--lcars-font-family, monospace)\"\n             font-size=\"${fontSize}\" font-weight=\"bold\">\n        ${indicatorText}\n       </text>`,\n      width > 120 ? `<text x=\"${width / 2}\" y=\"${height / 2 + fontSize + 4}\"\n                           fill=\"${indicatorColor}\" text-anchor=\"middle\" dominant-baseline=\"middle\"\n                           font-family=\"var(--lcars-font-family, monospace)\"\n                           font-size=\"${Math.max(8, fontSize * 0.6)}\" opacity=\"0.7\">\n                      ${overlay.source || 'NO SOURCE ID'}\n                     </text>` : ''\n    ].filter(Boolean);\n\n    return `<g data-overlay-id=\"${overlay.id}\"\n                data-overlay-type=\"sparkline\"\n                data-source=\"${overlay.source || 'unknown'}\"\n                data-status=\"${dataResult.status}\"\n                data-animation-ready=\"${!!animationAttributes.hasAnimations}\"\n                transform=\"translate(${x}, ${y})\">\n              ${svgParts.join('\\n')}\n            </g>`;\n  }\n\n  /**\n   * Parse various configuration formats\n   * @private\n   */\n  _parseGradientConfig(gradientConfig) {\n    return RendererUtils.parseGradientConfig(gradientConfig);\n  }\n\n  _parsePatternConfig(patternConfig) {\n    return RendererUtils.parsePatternConfig(patternConfig);\n  }\n\n  _parseGlowConfig(glowConfig) {\n    return RendererUtils.parseGlowConfig(glowConfig);\n  }\n\n  _parseShadowConfig(shadowConfig) {\n    return RendererUtils.parseShadowConfig(shadowConfig);\n  }\n\n  _parseBlurConfig(blurConfig) {\n    return RendererUtils.parseBlurConfig(blurConfig);\n  }\n\n  /**\n   * Parse threshold configuration\n   * @private\n   */\n  _parseThresholds(thresholds) {\n    if (!thresholds || !Array.isArray(thresholds)) return [];\n\n    return thresholds.map(threshold => ({\n      value: Number(threshold.value || threshold),\n      color: threshold.color || 'var(--lcars-orange)',\n      width: Number(threshold.width || 1),\n      opacity: Number(threshold.opacity || 0.7),\n      dash: threshold.dash || false,\n      label: threshold.label || null\n    }));\n  }\n\n  /**\n   * Format value for display\n   * @private\n   */\n  _formatValue(value, format) {\n    if (typeof format === 'function') {\n      return format(value);\n    }\n\n    if (typeof format === 'string') {\n      return format.replace('{value}', value.toFixed(1));\n    }\n\n    return value.toFixed(1);\n  }\n\n  /**\n   * Prepare animation attributes for future anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    const animationAttributes = {\n      pathAttributes: [],\n      hasAnimations: false\n    };\n\n    // Animation hooks for future implementation\n    if (style.animatable !== false) {\n      animationAttributes.pathAttributes.push(`data-animatable=\"true\"`);\n    }\n\n    if (style.tracer_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-tracer-speed=\"${style.tracer_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.pulse_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-pulse-speed=\"${style.pulse_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Render simple fallback sparkline\n   * @private\n   */\n  _renderFallbackSparkline(overlay, x, y, width, height) {\n    const style = overlay.finalStyle || overlay.style || {};\n    const color = style.color || 'var(--lcars-yellow)';\n    const strokeWidth = style.width || 2;\n\n    console.warn(`[SparklineRenderer] Using fallback rendering for sparkline ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"sparkline\" data-fallback=\"true\">\n              <g transform=\"translate(${x}, ${y})\">\n                <path d=\"M 0 ${height / 2} L ${width} ${height / 2}\"\n                      fill=\"none\" stroke=\"${color}\" stroke-width=\"${strokeWidth}\"\n                      vector-effect=\"non-scaling-stroke\"/>\n              </g>\n            </g>`;\n  }\n\n  // === EXISTING DATA SOURCE METHODS (PRESERVED FROM ORIGINAL) ===\n\n  /**\n   * Get historical data with multiple fallback strategies\n   * @param {string} dataSourceName - Name of the data source\n   * @returns {Object} {data: Array|null, status: string, message: string}\n   */\n  static getHistoricalDataForSparkline(dataSourceName) {\n    if (!dataSourceName) {\n      return {\n        data: null,\n        status: 'NO_SOURCE',\n        message: 'No data source specified'\n      };\n    }\n\n    try {\n      // Try the real DataSourceManager through the pipeline\n      const dataSourceManager = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n\n      if (dataSourceManager) {\n        console.log(`[SparklineRenderer] 🔍 Checking DataSourceManager for '${dataSourceName}'`);\n\n        // Use exact source name only\n        const dataSource = dataSourceManager.getSource(dataSourceName);\n\n        if (dataSource) {\n          const currentData = dataSource.getCurrentData();\n          console.log(`[SparklineRenderer] Source data for '${dataSourceName}':`, {\n            bufferSize: currentData?.bufferSize || 0,\n            historyReady: currentData?.historyReady,\n            started: currentData?.started,\n            historyLoaded: currentData?.stats?.historyLoaded || 0\n          });\n\n          if (currentData?.buffer) {\n            const bufferData = currentData.buffer.getAll();\n            console.log(`[SparklineRenderer] Raw buffer data for '${dataSourceName}':`, bufferData);\n\n            if (bufferData && bufferData.length >= 2) {\n              const historicalData = bufferData.map(point => ({\n                timestamp: point.t,\n                value: point.v\n              }));\n\n              console.log(`[SparklineRenderer] ✅ Found ${historicalData.length} data points for '${dataSourceName}'`);\n              return {\n                data: historicalData,\n                status: 'OK',\n                message: `${historicalData.length} data points`\n              };\n            } else if (bufferData && bufferData.length === 1) {\n              console.log(`[SparklineRenderer] ⚠️ Only 1 data point available for '${dataSourceName}'`);\n              return {\n                data: null,\n                status: 'INSUFFICIENT_DATA',\n                message: 'Only 1 data point available (need 2+ for sparkline)'\n              };\n            } else {\n              console.log(`[SparklineRenderer] ⚠️ Buffer exists but is empty for '${dataSourceName}'`);\n              return {\n                data: null,\n                status: 'EMPTY_BUFFER',\n                message: 'Buffer exists but contains no data'\n              };\n            }\n          }\n\n          // Data source exists but no buffer data\n          console.log(`[SparklineRenderer] ⚠️ Data source '${dataSourceName}' found but no buffer`);\n          return {\n            data: null,\n            status: 'NO_BUFFER',\n            message: 'Data source found but no buffer available'\n          };\n        }\n\n        // Data source not found in manager\n        const availableSources = Array.from(dataSourceManager.sources.keys());\n        console.warn(`[SparklineRenderer] ❌ Source '${dataSourceName}' not found in DataSourceManager`);\n        return {\n          data: null,\n          status: 'SOURCE_NOT_FOUND',\n          message: `Source '${dataSourceName}' not found. Available: ${availableSources.join(', ')}`\n        };\n      }\n\n      // DataSourceManager not available\n      return {\n        data: null,\n        status: 'MANAGER_NOT_AVAILABLE',\n        message: 'DataSourceManager not available'\n      };\n\n    } catch (error) {\n      console.error(`[SparklineRenderer] Error getting data for '${dataSourceName}':`, error);\n      return {\n        data: null,\n        status: 'ERROR',\n        message: `Error occurred: ${error.message}`\n      };\n    }\n  }\n\n  /**\n   * Update sparkline data dynamically when data source changes\n   * @param {Element} sparklineElement - The sparkline SVG element\n   * @param {Object} overlay - Overlay configuration\n   * @param {Object} sourceData - New data from the data source\n   */\n  static updateSparklineData(sparklineElement, overlay, sourceData) {\n    console.log(`[SparklineRenderer] updateSparklineData called for ${overlay.id}:`, {\n      hasBuffer: !!(sourceData?.buffer),\n      bufferSize: sourceData?.buffer?.size?.() || 0,\n      currentStatus: sparklineElement.getAttribute('data-status'),\n      elementFound: !!sparklineElement,\n      currentValue: sourceData?.v\n    });\n\n    if (!sparklineElement || !overlay || !sourceData) {\n      console.warn('[SparklineRenderer] updateSparklineData: Missing required parameters');\n      return;\n    }\n\n    // Create instance for update operations\n    const instance = new SparklineRenderer();\n    instance._updateSparklineElement(sparklineElement, overlay, sourceData);\n  }\n\n\n  /**\n   * Instance method to update sparkline element\n   * @private\n   */\n  _updateSparklineElement(sparklineElement, overlay, sourceData) {\n    const currentStatus = sparklineElement.getAttribute('data-status');\n    const isStatusIndicator = currentStatus !== null;\n\n    // If status indicator and data is now available, upgrade\n    if (isStatusIndicator && (sourceData.buffer || sourceData.historicalData)) {\n      this._upgradeStatusIndicatorToSparkline(sparklineElement, overlay, sourceData);\n      return;\n    }\n\n    // Only support new markup\n    const pathElement = sparklineElement.querySelector('path[data-feature=\"main-path\"]');\n    if (!pathElement) {\n      // If no path, try to upgrade if data is available\n      const historicalData = this._extractHistoricalData(sourceData);\n      if (historicalData.length > 1) {\n        this._upgradeStatusIndicatorToSparkline(sparklineElement, overlay, sourceData);\n      }\n      return;\n    }\n\n    try {\n      // Extract dimensions from overlay config\n      const bounds = {\n        width: overlay.size?.[0] || 200,\n        height: overlay.size?.[1] || 60\n      };\n\n      // Convert source data to sparkline format\n      const historicalData = this._extractHistoricalData(sourceData);\n\n      if (historicalData.length > 1) {\n        // Re-resolve styles for consistency\n        const style = overlay.finalStyle || overlay.style || {};\n        const sparklineStyle = this._resolveSparklineStyles(style, overlay.id);\n\n        // Generate new path\n        const processedData = this._processDataForRendering(historicalData, sparklineStyle);\n        const newPathData = this._createSparklinePath(processedData, bounds, sparklineStyle);\n\n        pathElement.setAttribute('d', newPathData);\n\n        // Update status attributes\n        sparklineElement.removeAttribute('data-status');\n        sparklineElement.setAttribute('data-last-update', Date.now());\n\n        console.log(`[SparklineRenderer] ✅ Updated sparkline ${overlay.id} with ${historicalData.length} points`);\n      } else {\n        console.warn(`[SparklineRenderer] Insufficient data for sparkline ${overlay.id}: ${historicalData.length} points`);\n        sparklineElement.setAttribute('data-status', historicalData.length === 0 ? 'NO_DATA' : 'INSUFFICIENT_DATA');\n      }\n\n    } catch (error) {\n      console.error(`[SparklineRenderer] Error updating sparkline ${overlay.id}:`, error);\n      sparklineElement.setAttribute('data-status', 'ERROR');\n    }\n  }\n\n  /**\n   * Upgrade a status indicator to a real sparkline\n   * @private\n   */\n  _upgradeStatusIndicatorToSparkline(sparklineElement, overlay, sourceData) {\n    const historicalData = this._extractHistoricalData(sourceData);\n\n    if (historicalData.length > 1) {\n      const size = overlay.size || [200, 60];\n      const [width, height] = size;\n      const style = overlay.finalStyle || overlay.style || {};\n      const sparklineStyle = this._resolveSparklineStyles(style, overlay.id);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      // Generate complete enhanced sparkline with ALL features\n      const svgParts = [\n        this._buildDefinitions(sparklineStyle, overlay.id),\n        this._buildSparklineBackground(width, height, sparklineStyle, overlay.id),\n        this._buildGridLines(width, height, sparklineStyle, overlay.id),\n        this._buildThresholdLines(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildZeroLine(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildAreaFill(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildMainSparklinePath(historicalData, width, height, sparklineStyle, overlay.id, animationAttributes),\n        this._buildDataPoints(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildValueLabel(historicalData, width, height, sparklineStyle, overlay.id),\n        this._buildBrackets(width, height, sparklineStyle, overlay.id),\n        this._buildStatusIndicator(width, height, sparklineStyle, overlay.id),\n        this._buildScanLine(width, height, sparklineStyle, overlay.id)\n      ].filter(Boolean);\n\n      // Replace entire innerHTML with complete sparkline content\n      sparklineElement.innerHTML = svgParts.join('\\n');\n\n      sparklineElement.removeAttribute('data-status');\n      sparklineElement.setAttribute('data-last-update', Date.now());\n      sparklineElement.setAttribute('data-sparkline-features', sparklineStyle.features.join(','));\n\n      console.log(`[SparklineRenderer] ✅ Upgraded status indicator ${overlay.id} to full sparkline with ${sparklineStyle.features.length} features and ${historicalData.length} data points`);\n    } else {\n      sparklineElement.setAttribute('data-status', historicalData.length === 0 ? 'NO_DATA' : 'INSUFFICIENT_DATA');\n    }\n  }\n\n  /**\n   * Extract historical data from various source data formats\n   * @private\n   */\n  _extractHistoricalData(sourceData) {\n    let historicalData = [];\n\n    // Method 1: Use buffer data directly\n    if (sourceData.buffer && typeof sourceData.buffer.getAll === 'function') {\n      const bufferData = sourceData.buffer.getAll();\n      historicalData = bufferData.map(point => ({\n        timestamp: point.t,\n        value: point.v\n      }));\n      console.log('[SparklineRenderer] Using buffer data:', historicalData.length, 'points');\n    }\n    // Method 2: Use pre-formatted historical data\n    else if (sourceData.historicalData && Array.isArray(sourceData.historicalData)) {\n      historicalData = sourceData.historicalData;\n      console.log('[SparklineRenderer] Using pre-formatted historical data:', historicalData.length, 'points');\n    }\n    // Method 3: Generate from single current value (fallback for testing)\n    else if (sourceData.v !== undefined && sourceData.t !== undefined) {\n      console.log('[SparklineRenderer] Generating demo data from current value:', sourceData.v);\n      const now = Date.now();\n      for (let i = 0; i < 20; i++) {\n        historicalData.push({\n          timestamp: now - (19 - i) * 60000,\n          value: sourceData.v + (Math.random() - 0.5) * (sourceData.v * 0.1)\n        });\n      }\n    }\n\n    return historicalData;\n  }\n\n  /**\n   * Get rendering capabilities and features supported\n   * @public\n   */\n  getCapabilities() {\n    return {\n      pathSmoothing: ['none', 'constrained', 'chaikin', 'bezier', 'spline', 'stepped'],\n      dataVisualization: ['points', 'thresholds', 'zero-line', 'value-labels'],\n      styling: ['gradients', 'patterns', 'area-fill', 'dash-patterns'],\n      effects: ['glow', 'shadow', 'blur'],\n      lcarsFeatures: ['brackets', 'status-indicator', 'scan-line', 'grid-lines'],\n      animations: ['tracer', 'pulse'], // Future implementation\n      performance: ['decimation', 'max-points', 'viewport-optimization'],\n      advanced: true\n    };\n  }\n\n  // === DEBUG METHODS (PRESERVED FROM ORIGINAL) ===\n\n  static debugSparklineUpdates() {\n    console.log('🔍 Enhanced Sparkline Update Debug Report');\n    console.log('==========================================');\n\n    const dsm = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n    if (dsm) {\n      const stats = dsm.getStats();\n      console.log('DataSourceManager stats:', stats);\n    } else {\n      console.warn('DataSourceManager not accessible via debug interface');\n    }\n  }\n\n  static debugDataSource(dataSourceName) {\n    console.log(`🔍 Enhanced Debugging data source: ${dataSourceName}`);\n    console.log('====================================================');\n\n    const dsm = window.__msdDebug?.pipelineInstance?.systemsManager?.dataSourceManager;\n    if (!dsm) {\n      console.error('❌ DataSourceManager not available');\n      return;\n    }\n\n    const source = dsm.getSource(dataSourceName);\n    if (!source) {\n      console.error(`❌ Source '${dataSourceName}' not found`);\n      console.log('Available sources:', Array.from(dsm.sources.keys()));\n      return;\n    }\n\n    // Detailed analysis as before...\n    return { source };\n  }\n}\n\n// Expose SparklineRenderer to window for console debugging\nif (typeof window !== 'undefined') {\n  window.SparklineRenderer = SparklineRenderer;\n}","/**\n * Line Overlay Renderer - Advanced line rendering with comprehensive styling support\n * Leverages RouterCore's sophisticated path computation and adds rich visual features\n */\n\nimport { PositionResolver } from './PositionResolver.js';\n\nexport class LineOverlayRenderer {\n  constructor(routerCore) {\n    this.routerCore = routerCore;\n\n    // Pre-defined marker templates for performance\n    this.markerCache = new Map();\n    this.gradientCache = new Map();\n    this.patternCache = new Map();\n\n    this.textAttachmentPoints = new Map();\n  }\n\n  setTextAttachmentPoints(map) {\n    this.textAttachmentPoints = map || new Map();\n  }\n\n  /**\n   * Render a line overlay with full styling support\n   * @param {Object} overlay - Line overlay configuration with resolved styles\n   * @param {Object} anchors - Anchor positions for routing\n   * @param {Array} viewBox - SVG viewBox dimensions\n   * @returns {string} Complete SVG markup for the styled line\n   */\n  render(overlay, anchors, viewBox) {\n    if (!this.routerCore) {\n      console.error('[LineOverlayRenderer] RouterCore not available for line rendering');\n      return '';\n    }\n\n    let anchor1 = PositionResolver.resolvePosition(overlay.anchor, anchors);\n    let anchor2 = PositionResolver.resolvePosition(overlay.attach_to, anchors);\n\n    // If attach_to not an anchor but matches a text overlay id we have attachment points\n    let attachMeta = null;\n    if (!anchor2 && overlay.attach_to && this.textAttachmentPoints.has(overlay.attach_to)) {\n      attachMeta = this.textAttachmentPoints.get(overlay.attach_to);\n      // Compute smart attachment point\n      anchor2 = this._computeTextAttachPoint(anchor1, attachMeta, overlay);\n    }\n\n    if (!anchor1 || !anchor2) {\n      console.warn(`[LineOverlayRenderer] Line ${overlay.id} missing anchor points`);\n      return '';\n    }\n\n    try {\n      // Get the computed path from RouterCore (includes all smart routing)\n      const routeRequest = this.routerCore.buildRouteRequest(overlay, anchor1, anchor2);\n      const pathResult = this.routerCore.computePath(routeRequest);\n\n      if (!pathResult?.d) {\n        console.warn(`[LineOverlayRenderer] No path computed for line ${overlay.id}`);\n        return '';\n      }\n\n      // Extract comprehensive styling\n      const style = overlay.finalStyle || overlay.style || {};\n      const lineStyle = this._resolveLineStyles(style, overlay.id);\n      const animationAttributes = this._prepareAnimationAttributes(overlay, style);\n\n      // Build SVG group with all features\n      const svgParts = [\n        this._buildDefinitions(lineStyle, overlay.id),\n        this._buildMainPath(pathResult.d, lineStyle, overlay.id, animationAttributes),\n        this._buildMarkers(pathResult, lineStyle, overlay.id),\n        this._buildEffects(pathResult, lineStyle, overlay.id)\n      ].filter(Boolean);\n\n      console.log(`[LineOverlayRenderer] Rendered enhanced line ${overlay.id} with ${lineStyle.features.length} features`);\n\n      return `<g data-overlay-id=\"${overlay.id}\"\n                  data-overlay-type=\"line\"\n                  data-routing-strategy=\"${pathResult.meta?.strategy || 'unknown'}\"\n                  data-animation-ready=\"${!!animationAttributes.hasAnimations}\">\n                ${svgParts.join('\\n')}\n              </g>`;\n\n    } catch (error) {\n      console.error(`[LineOverlayRenderer] Enhanced rendering failed for line ${overlay.id}:`, error);\n      return this._renderFallbackLine(overlay, anchor1, anchor2);\n    }\n  }\n\n  /**\n   * Resolve comprehensive line styling from configuration\n   * @private\n   * @param {Object} style - Final resolved style object\n   * @param {string} overlayId - Overlay ID for unique identifiers\n   * @returns {Object} Complete line style configuration\n   */\n  _resolveLineStyles(style, overlayId) {\n    const lineStyle = {\n      // Core stroke properties\n      color: style.color || style.stroke || 'var(--lcars-orange)',\n      width: Number(style.width || style.stroke_width || style.strokeWidth || 2),\n      opacity: Number(style.opacity || 1),\n\n      // Advanced stroke styling\n      lineCap: (style.line_cap || style.lineCap || style.strokeLinecap || 'round').toLowerCase(),\n      lineJoin: (style.line_join || style.lineJoin || style.strokeLinejoin || 'round').toLowerCase(),\n      miterLimit: Number(style.miter_limit || style.miterLimit || 4),\n\n      // Dash patterns\n      dashArray: style.dash_array || style.dashArray || style.strokeDasharray || null,\n      dashOffset: Number(style.dash_offset || style.dashOffset || style.strokeDashoffset || 0),\n\n      // Fill properties (for thick lines or special effects)\n      fill: style.fill || 'none',\n      fillOpacity: Number(style.fill_opacity || style.fillOpacity || 1),\n\n      // Gradient and pattern support\n      gradient: this._parseGradientConfig(style.gradient),\n      pattern: this._parsePatternConfig(style.pattern),\n\n      // Markers (arrowheads, dots, etc.)\n      markerStart: this._parseMarkerConfig(style.marker_start || style.markerStart),\n      markerMid: this._parseMarkerConfig(style.marker_mid || style.markerMid),\n      markerEnd: this._parseMarkerConfig(style.marker_end || style.markerEnd),\n\n      // Effects\n      glow: this._parseGlowConfig(style.glow),\n      shadow: this._parseShadowConfig(style.shadow),\n\n      // Animation states (for future anime.js integration)\n      animatable: style.animatable !== false,\n      pulseSpeed: Number(style.pulse_speed || 0),\n      flowSpeed: Number(style.flow_speed || 0),\n\n      // LCARS-specific features\n      segment_colors: this._parseSegmentColors(style.segment_colors),\n      status_indicator: style.status_indicator || null,\n\n      // Track enabled features for optimization\n      features: []\n    };\n\n    // Build feature list for conditional rendering\n    if (lineStyle.gradient) lineStyle.features.push('gradient');\n    if (lineStyle.pattern) lineStyle.features.push('pattern');\n    if (lineStyle.markerStart || lineStyle.markerMid || lineStyle.markerEnd) lineStyle.features.push('markers');\n    if (lineStyle.glow) lineStyle.features.push('glow');\n    if (lineStyle.shadow) lineStyle.features.push('shadow');\n    if (lineStyle.segment_colors) lineStyle.features.push('segments');\n    if (lineStyle.pulseSpeed > 0) lineStyle.features.push('pulse');\n    if (lineStyle.flowSpeed > 0) lineStyle.features.push('flow');\n\n    return lineStyle;\n  }\n\n  /**\n   * Parse gradient configuration\n   * @private\n   */\n  _parseGradientConfig(gradientConfig) {\n    if (!gradientConfig) return null;\n\n    if (typeof gradientConfig === 'string') {\n      // Simple gradient: \"red-to-blue\" or \"#ff0000-to-#0000ff\"\n      const match = gradientConfig.match(/^(.+?)-to-(.+)$/);\n      if (match) {\n        return {\n          type: 'linear',\n          direction: 'horizontal',\n          stops: [\n            { offset: '0%', color: match[1].trim() },\n            { offset: '100%', color: match[2].trim() }\n          ]\n        };\n      }\n      return null;\n    }\n\n    if (typeof gradientConfig === 'object') {\n      return {\n        type: gradientConfig.type || 'linear',\n        direction: gradientConfig.direction || 'horizontal',\n        stops: gradientConfig.stops || [\n          { offset: '0%', color: gradientConfig.from || '#ff6600' },\n          { offset: '100%', color: gradientConfig.to || '#ffcc00' }\n        ]\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse pattern configuration\n   * @private\n   */\n  _parsePatternConfig(patternConfig) {\n    if (!patternConfig) return null;\n\n    if (typeof patternConfig === 'string') {\n      // Predefined patterns: \"dots\", \"diagonal\", \"grid\"\n      return { type: patternConfig, size: 8, color: 'currentColor' };\n    }\n\n    if (typeof patternConfig === 'object') {\n      return {\n        type: patternConfig.type || 'dots',\n        size: Number(patternConfig.size || 8),\n        color: patternConfig.color || 'currentColor',\n        opacity: Number(patternConfig.opacity || 0.5)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse marker configuration (arrows, dots, etc.)\n   * @private\n   */\n  _parseMarkerConfig(markerConfig) {\n    if (!markerConfig) return null;\n\n    if (typeof markerConfig === 'string') {\n      // Predefined markers: \"arrow\", \"dot\", \"diamond\"\n      return { type: markerConfig, size: 'medium', color: 'inherit' };\n    }\n\n    if (typeof markerConfig === 'object') {\n      return {\n        type: markerConfig.type || 'arrow',\n        size: markerConfig.size || 'medium',\n        color: markerConfig.color || 'inherit',\n        rotate: markerConfig.rotate !== false\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse glow effect configuration\n   * @private\n   */\n  _parseGlowConfig(glowConfig) {\n    if (!glowConfig) return null;\n\n    if (glowConfig === true) {\n      return { color: 'currentColor', size: 4, opacity: 0.6 };\n    }\n\n    if (typeof glowConfig === 'object') {\n      return {\n        color: glowConfig.color || 'currentColor',\n        size: Number(glowConfig.size || 4),\n        opacity: Number(glowConfig.opacity || 0.6)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse shadow effect configuration\n   * @private\n   */\n  _parseShadowConfig(shadowConfig) {\n    if (!shadowConfig) return null;\n\n    if (shadowConfig === true) {\n      return { color: 'rgba(0,0,0,0.3)', offset: [2, 2], blur: 3 };\n    }\n\n    if (typeof shadowConfig === 'object') {\n      return {\n        color: shadowConfig.color || 'rgba(0,0,0,0.3)',\n        offset: shadowConfig.offset || [2, 2],\n        blur: Number(shadowConfig.blur || 3)\n      };\n    }\n\n    return null;\n  }\n\n  /**\n   * Parse segment colors configuration\n   * @private\n   */\n  _parseSegmentColors(segmentConfig) {\n    if (!segmentConfig || !Array.isArray(segmentConfig)) return null;\n\n    return segmentConfig.map(segment => ({\n      color: segment.color || 'var(--lcars-orange)',\n      start: Number(segment.start || 0),\n      end: Number(segment.end || 1)\n    }));\n  }\n\n  /**\n   * Build SVG definitions for gradients, patterns, markers, and effects\n   * @private\n   */\n  _buildDefinitions(lineStyle, overlayId) {\n    const defs = [];\n\n    // Gradients\n    if (lineStyle.gradient) {\n      defs.push(this._createGradientDefinition(lineStyle.gradient, overlayId));\n    }\n\n    // Patterns\n    if (lineStyle.pattern) {\n      defs.push(this._createPatternDefinition(lineStyle.pattern, overlayId));\n    }\n\n    // Markers\n    ['markerStart', 'markerMid', 'markerEnd'].forEach(markerType => {\n      if (lineStyle[markerType]) {\n        defs.push(this._createMarkerDefinition(lineStyle[markerType], overlayId, markerType));\n      }\n    });\n\n    // Effects (filters)\n    if (lineStyle.glow) {\n      defs.push(this._createGlowFilter(lineStyle.glow, overlayId));\n    }\n\n    if (lineStyle.shadow) {\n      defs.push(this._createShadowFilter(lineStyle.shadow, overlayId));\n    }\n\n    return defs.length > 0 ? `<defs>${defs.join('\\n')}</defs>` : '';\n  }\n\n  /**\n   * Create gradient definition\n   * @private\n   */\n  _createGradientDefinition(gradient, overlayId) {\n    const gradientId = `line-gradient-${overlayId}`;\n\n    if (gradient.type === 'radial') {\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<radialGradient id=\"${gradientId}\">${stops}</radialGradient>`;\n    } else {\n      // Linear gradient\n      const coords = this._getLinearGradientCoords(gradient.direction);\n      const stops = gradient.stops.map(stop =>\n        `<stop offset=\"${stop.offset}\" stop-color=\"${stop.color}\"/>`\n      ).join('');\n\n      return `<linearGradient id=\"${gradientId}\" ${coords}>${stops}</linearGradient>`;\n    }\n  }\n\n  /**\n   * Get linear gradient coordinates based on direction\n   * @private\n   */\n  _getLinearGradientCoords(direction) {\n    const directions = {\n      horizontal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\"',\n      vertical: 'x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"',\n      diagonal: 'x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"100%\"',\n      'diagonal-reverse': 'x1=\"100%\" y1=\"0%\" x2=\"0%\" y2=\"100%\"'\n    };\n    return directions[direction] || directions.horizontal;\n  }\n\n  /**\n   * Create pattern definition\n   * @private\n   */\n  _createPatternDefinition(pattern, overlayId) {\n    const patternId = `line-pattern-${overlayId}`;\n    const size = pattern.size;\n\n    let patternContent = '';\n\n    switch (pattern.type) {\n      case 'dots':\n        patternContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"1\" fill=\"${pattern.color}\" opacity=\"${pattern.opacity}\"/>`;\n        break;\n      case 'diagonal':\n        patternContent = `<path d=\"M0,${size} L${size},0\" stroke=\"${pattern.color}\" stroke-width=\"1\" opacity=\"${pattern.opacity}\"/>`;\n        break;\n      case 'grid':\n        patternContent = `\n          <path d=\"M0,0 L0,${size}\" stroke=\"${pattern.color}\" stroke-width=\"0.5\" opacity=\"${pattern.opacity}\"/>\n          <path d=\"M0,0 L${size},0\" stroke=\"${pattern.color}\" stroke-width=\"0.5\" opacity=\"${pattern.opacity}\"/>\n        `;\n        break;\n    }\n\n    return `<pattern id=\"${patternId}\" x=\"0\" y=\"0\" width=\"${size}\" height=\"${size}\" patternUnits=\"userSpaceOnUse\">\n              ${patternContent}\n            </pattern>`;\n  }\n\n  /**\n   * Create marker definition (arrows, dots, etc.)\n   * @private\n   */\n  _createMarkerDefinition(marker, overlayId, markerType) {\n    const markerId = `line-marker-${overlayId}-${markerType}`;\n    const size = this._getMarkerSize(marker.size);\n\n    let markerContent = '';\n    let viewBox = `0 0 ${size} ${size}`;\n    let refX = size / 2;\n    let refY = size / 2;\n\n    switch (marker.type) {\n      case 'arrow':\n        viewBox = '0 0 10 10';\n        refX = 8;\n        refY = 5;\n        markerContent = `<path d=\"M2,2 L8,5 L2,8 z\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n      case 'dot':\n        markerContent = `<circle cx=\"${size/2}\" cy=\"${size/2}\" r=\"${size/4}\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n      case 'diamond':\n        markerContent = `<path d=\"M${size/2},2 L${size-2},${size/2} L${size/2},${size-2} L2,${size/2} z\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n      case 'square':\n        markerContent = `<rect x=\"2\" y=\"2\" width=\"${size-4}\" height=\"${size-4}\" fill=\"${marker.color === 'inherit' ? 'currentColor' : marker.color}\"/>`;\n        break;\n    }\n\n    return `<marker id=\"${markerId}\"\n                    viewBox=\"${viewBox}\"\n                    refX=\"${refX}\" refY=\"${refY}\"\n                    markerWidth=\"${size}\" markerHeight=\"${size}\"\n                    markerUnits=\"strokeWidth\"\n                    orient=\"${marker.rotate ? 'auto' : '0'}\">\n              ${markerContent}\n            </marker>`;\n  }\n\n  /**\n   * Get numeric marker size from size descriptor\n   * @private\n   */\n  _getMarkerSize(size) {\n    const sizes = { small: 6, medium: 8, large: 12, xlarge: 16 };\n    return sizes[size] || Number(size) || 8;\n  }\n\n  /**\n   * Create glow filter definition\n   * @private\n   */\n  _createGlowFilter(glow, overlayId) {\n    const filterId = `line-glow-${overlayId}`;\n\n    return `<filter id=\"${filterId}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feGaussianBlur stdDeviation=\"${glow.size}\" result=\"coloredBlur\"/>\n              <feMerge>\n                <feMergeNode in=\"coloredBlur\"/>\n                <feMergeNode in=\"SourceGraphic\"/>\n              </feMerge>\n            </filter>`;\n  }\n\n  /**\n   * Create drop shadow filter definition\n   * @private\n   */\n  _createShadowFilter(shadow, overlayId) {\n    const filterId = `line-shadow-${overlayId}`;\n    const [dx, dy] = shadow.offset;\n\n    return `<filter id=\"${filterId}\" x=\"-50%\" y=\"-50%\" width=\"200%\" height=\"200%\">\n              <feDropShadow dx=\"${dx}\" dy=\"${dy}\"\n                           stdDeviation=\"${shadow.blur}\"\n                           flood-color=\"${shadow.color}\"/>\n            </filter>`;\n  }\n\n  /**\n   * Build the main path element with all styling\n   * @private\n   */\n  _buildMainPath(pathData, lineStyle, overlayId, animationAttributes) {\n    const attributes = [];\n\n    // Core path and styling\n    attributes.push(`d=\"${pathData}\"`);\n    attributes.push(`fill=\"${lineStyle.fill}\"`);\n    attributes.push(`fill-opacity=\"${lineStyle.fillOpacity}\"`);\n\n    // Stroke styling\n    if (lineStyle.gradient) {\n      attributes.push(`stroke=\"url(#line-gradient-${overlayId})\"`);\n    } else if (lineStyle.pattern) {\n      attributes.push(`stroke=\"url(#line-pattern-${overlayId})\"`);\n    } else {\n      attributes.push(`stroke=\"${lineStyle.color}\"`);\n    }\n\n    attributes.push(`stroke-width=\"${lineStyle.width}\"`);\n    attributes.push(`stroke-opacity=\"${lineStyle.opacity}\"`);\n    attributes.push(`stroke-linecap=\"${lineStyle.lineCap}\"`);\n    attributes.push(`stroke-linejoin=\"${lineStyle.lineJoin}\"`);\n\n    if (lineStyle.lineJoin === 'miter' && lineStyle.miterLimit !== 4) {\n      attributes.push(`stroke-miterlimit=\"${lineStyle.miterLimit}\"`);\n    }\n\n    if (lineStyle.dashArray) {\n      attributes.push(`stroke-dasharray=\"${lineStyle.dashArray}\"`);\n      if (lineStyle.dashOffset !== 0) {\n        attributes.push(`stroke-dashoffset=\"${lineStyle.dashOffset}\"`);\n      }\n    }\n\n    // Markers\n    if (lineStyle.markerStart) {\n      attributes.push(`marker-start=\"url(#line-marker-${overlayId}-markerStart)\"`);\n    }\n    if (lineStyle.markerMid) {\n      attributes.push(`marker-mid=\"url(#line-marker-${overlayId}-markerMid)\"`);\n    }\n    if (lineStyle.markerEnd) {\n      attributes.push(`marker-end=\"url(#line-marker-${overlayId}-markerEnd)\"`);\n    }\n\n    // Effects\n    const filters = [];\n    if (lineStyle.glow) filters.push(`url(#line-glow-${overlayId})`);\n    if (lineStyle.shadow) filters.push(`url(#line-shadow-${overlayId})`);\n    if (filters.length > 0) {\n      attributes.push(`filter=\"${filters.join(' ')}\"`);\n    }\n\n    // Animation attributes (for future anime.js integration)\n    attributes.push(...animationAttributes.pathAttributes);\n\n    return `<path ${attributes.join(' ')}/>`;\n  }\n\n  /**\n   * Build additional marker elements (beyond standard markers)\n   * @private\n   */\n  _buildMarkers(pathResult, lineStyle, overlayId) {\n    // Future: Add custom markers along path at specific positions\n    return '';\n  }\n\n  /**\n   * Build special effects elements\n   * @private\n   */\n  _buildEffects(pathResult, lineStyle, overlayId) {\n    const effects = [];\n\n    // Future: Add flowing particles, pulse effects, etc.\n    if (lineStyle.features.includes('flow')) {\n      // Placeholder for flow animation elements\n    }\n\n    if (lineStyle.features.includes('pulse')) {\n      // Placeholder for pulse animation elements\n    }\n\n    return effects.join('\\n');\n  }\n\n  /**\n   * Prepare animation attributes for future anime.js integration\n   * @private\n   */\n  _prepareAnimationAttributes(overlay, style) {\n    const animationAttributes = {\n      hasAnimations: false,\n      pathAttributes: [],\n      groupAttributes: []\n    };\n\n    // Animation hooks for future implementation\n    if (style.animatable !== false) {\n      animationAttributes.pathAttributes.push(`data-animatable=\"true\"`);\n    }\n\n    if (style.pulse_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-pulse-speed=\"${style.pulse_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    if (style.flow_speed > 0) {\n      animationAttributes.pathAttributes.push(`data-flow-speed=\"${style.flow_speed}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    // Add animation reference if specified\n    if (overlay._raw?.animation_ref) {\n      animationAttributes.groupAttributes.push(`data-animation-ref=\"${overlay._raw.animation_ref}\"`);\n      animationAttributes.hasAnimations = true;\n    }\n\n    return animationAttributes;\n  }\n\n  /**\n   * Render a simple fallback line when enhanced rendering fails\n   * @private\n   */\n  _renderFallbackLine(overlay, anchor1, anchor2) {\n    const [x1, y1] = anchor1;\n    const [x2, y2] = anchor2;\n    const style = overlay.finalStyle || overlay.style || {};\n    const color = style.color || 'var(--lcars-orange)';\n    const width = style.width || 2;\n\n    console.warn(`[LineOverlayRenderer] Using fallback rendering for line ${overlay.id}`);\n\n    return `<g data-overlay-id=\"${overlay.id}\" data-overlay-type=\"line\" data-fallback=\"true\">\n              <line x1=\"${x1}\" y1=\"${y1}\" x2=\"${x2}\" y2=\"${y2}\"\n                    stroke=\"${color}\" stroke-width=\"${width}\"\n                    stroke-linecap=\"round\" fill=\"none\"/>\n            </g>`;\n  }\n\n  /**\n   * Update line styling dynamically (for future real-time updates)\n   * @public\n   */\n  updateLineStyle(overlayId, newStyle) {\n    // Future: Update existing line styles without full re-render\n    console.log(`[LineOverlayRenderer] Style update requested for line ${overlayId}`);\n  }\n\n  /**\n   * Get rendering capabilities and features supported\n   * @public\n   */\n  getCapabilities() {\n    return {\n      routing: true,\n      gradients: true,\n      patterns: true,\n      markers: ['arrow', 'dot', 'diamond', 'square'],\n      effects: ['glow', 'shadow'],\n      animations: ['pulse', 'flow'], // Future implementation\n      segmentColors: true,\n      dashPatterns: true,\n      advanced: true\n    };\n  }\n\n  /**\n   * Choose attachment point on target text overlay bbox, honoring attach_side or auto.\n   * Applies configurable gap (attach_gap | gap | line_gap) in outward normal direction.\n   */\n  _computeTextAttachPoint(origin, attachMeta, overlay) {\n    if (!origin || !attachMeta) return attachMeta?.center;\n\n    const raw = overlay._raw || overlay.raw || overlay;\n    const sidePref = (raw.attach_side || raw.attachSide || 'auto').toLowerCase();\n    const gapRaw = raw.attach_gap ?? raw.attachment_gap ?? raw.line_gap ?? raw.gap;\n    const gap = Number(gapRaw ?? 4);\n    const { bbox, points } = attachMeta;\n    const center = points.center;\n    let side = sidePref;\n\n    if (side === 'auto') {\n      const dx = origin[0] - center[0];\n      const dy = origin[1] - center[1];\n      if (Math.abs(dx) >= Math.abs(dy)) {\n        side = dx <= 0 ? 'left' : 'right';\n      } else {\n        side = dy <= 0 ? 'top' : 'bottom';\n      }\n    }\n\n    let basePoint;\n    let outward = [0,0];\n    switch (side) {\n      case 'left':\n      case 'left-center':\n        basePoint = [bbox.left, center[1]];\n        outward = [-1,0];\n        break;\n      case 'right':\n      case 'right-center':\n        basePoint = [bbox.right, center[1]];\n        outward = [1,0];\n        break;\n      case 'top':\n      case 'top-center':\n        basePoint = [center[0], bbox.top];\n        outward = [0,-1];\n        break;\n      case 'bottom':\n      case 'bottom-center':\n        basePoint = [center[0], bbox.bottom];\n        outward = [0,1];\n        break;\n      default:\n        basePoint = [bbox.left, center[1]];\n        outward = [-1,0];\n    }\n\n    // Apply gap outward\n    const attachPoint = [\n      basePoint[0] + outward[0] * gap,\n      basePoint[1] + outward[1] * gap\n    ];\n\n    // Store meta for potential debug / future features\n    overlay._attachComputed = {\n      targetOverlay: attachMeta.id,\n      sideChosen: side,\n      gap,\n      basePoint,\n      attachPoint\n    };\n\n    return attachPoint;\n  }\n}","/**\n * Advanced Renderer - Clean implementation for MSD v1\n * Main orchestrator that delegates to specialized renderers\n */\n\nimport { TextOverlayRenderer } from './TextOverlayRenderer.js';\nimport { SparklineRenderer } from './SparklineRenderer.js';\nimport { LineOverlayRenderer } from './LineOverlayRenderer.js';\nimport { RendererUtils } from './RendererUtils.js';\n\nexport class AdvancedRenderer {\n  constructor(mountEl, routerCore) {\n    this.mountEl = mountEl;\n    this.routerCore = routerCore;\n    this.overlayElements = new Map();\n    this.lastRenderArgs = null;\n    this.lineRenderer = new LineOverlayRenderer(routerCore);\n\n    // Track overlay elements for efficient updates\n    this.overlayElementCache = new Map(); // overlayId -> DOM element\n    this.textAttachmentPoints = new Map();\n    this._lineDeps = new Map(); // targetOverlayId -> Set(lineOverlayId)\n  }\n\n  render(resolvedModel) {\n\n    console.log('[MSD DEBUG] 🎨 AdvancedRenderer.render() ENTRY:', {\n      timestamp: new Date().toISOString(),\n      hasResolvedModel: !!resolvedModel,\n      overlayCount: resolvedModel?.overlays?.length || 0,\n      anchorCount: resolvedModel?.anchors ? Object.keys(resolvedModel.anchors).length : 0,\n      hasViewBox: !!resolvedModel?.viewBox,\n      mountElExists: !!this.mountEl,\n      stackTrace: new Error().stack.split('\\n').slice(1, 3).join('\\n')\n    });\n\n    if (!resolvedModel) {\n      console.error('[MSD DEBUG] ❌ AdvancedRenderer.render() - No resolved model provided');\n      return { svgMarkup: '', overlayCount: 0 };\n    }\n    const { overlays = [], anchors = {}, viewBox } = resolvedModel;\n    console.log(`[MSD DEBUG] 🎨 AdvancedRenderer processing:`, {\n      overlayCount: overlays.length,\n      overlayTypes: overlays.map(o => o.type),\n      anchorCount: Object.keys(anchors).length,\n      viewBox\n    });\n    this.overlayElements.clear();\n    // Phase rendering requires live SVG early\n    const svg = this.mountEl?.querySelector('svg');\n    if (!svg) {\n      console.error('[MSD DEBUG] ❌ AdvancedRenderer.render() - SVG element not found in container:', {\n        mountEl: this.mountEl,\n        mountElTagName: this.mountEl?.tagName,\n        mountElChildren: this.mountEl?.children?.length || 0\n      });\n      return { svgMarkup: '', overlayCount: 0 };\n    }\n\n    console.log('[MSD DEBUG] ✅ SVG element found, proceeding with overlay rendering');\n\n    // Prepare / clear overlay group\n    const overlayGroup = this._ensureOverlayGroup(svg);\n    overlayGroup.innerHTML = '';\n    this.overlayElementCache.clear();\n\n    // Precompute text attachment points (unchanged)\n    this.textAttachmentPoints.clear();\n    overlays.filter(o => o.type === 'text').forEach(tov => {\n      const ap = TextOverlayRenderer.computeAttachmentPoints(tov, anchors, this.mountEl);\n      if (ap) this.textAttachmentPoints.set(tov.id, ap);\n    });\n    this.lineRenderer.setTextAttachmentPoints(this.textAttachmentPoints);\n\n    // Phase 1: render overlays that others may depend on (text, sparkline)\n    const earlyTypes = new Set(['text', 'sparkline']);\n    let svgMarkupAccum = '';\n    let processedCount = 0;\n    overlays.filter(o => earlyTypes.has(o.type)).forEach(ov => {\n      try {\n        const html = this.renderOverlay(ov, anchors, viewBox);\n        if (html) {\n          svgMarkupAccum += html;\n        }\n        processedCount++;\n      } catch (e) {\n        console.warn('[AdvancedRenderer] Phase1 failed for', ov.id, e);\n      }\n    });\n    overlayGroup.innerHTML = svgMarkupAccum;\n    this._cacheElementsFrom(overlayGroup);\n\n    // Build dynamic anchors (overlay destinations)\n    this._dynamicAnchors = { ...anchors };\n    this._buildDynamicOverlayAnchors(overlays, this._dynamicAnchors);\n\n    // Phase 2: render line overlays (now DOM for targets exists)\n    overlays.filter(o => !earlyTypes.has(o.type)).forEach(ov => {\n      try {\n        const html = this.renderOverlay(ov, this._dynamicAnchors, viewBox); // pass dynamic anchors\n        if (html) {\n          overlayGroup.insertAdjacentHTML('beforeend', html);\n          svgMarkupAccum += html;\n          const el = overlayGroup.querySelector(`[data-overlay-id=\"${ov.id}\"]`);\n          if (el) this.overlayElementCache.set(ov.id, el);\n          const raw = ov._raw || ov.raw || {};\n          const targetId = raw.attach_to || raw.attachTo;\n          if (targetId) {\n            if (!this._lineDeps.has(targetId)) this._lineDeps.set(targetId, new Set());\n            this._lineDeps.get(targetId).add(ov.id);\n\n            // NEW: ensure RouterCore sees a route for overlay-destination line (HUD listing)\n            if (this.routerCore && raw.anchor && this._dynamicAnchors[raw.anchor] && this._dynamicAnchors[targetId]) {\n              try {\n                const req = this.routerCore.buildRouteRequest(\n                  ov,\n                  this._dynamicAnchors[raw.anchor],\n                  this._dynamicAnchors[targetId]\n                );\n                this.routerCore.computePath(req);\n              } catch (e) {\n                console.warn('[AdvancedRenderer] Overlay-destination route registration failed', ov.id, e);\n              }\n            }\n          }\n        }\n        processedCount++;\n      } catch (e) {\n        console.warn('[AdvancedRenderer] Phase2 failed for', ov.id, e);\n      }\n    });\n\n    console.log('[AdvancedRenderer] Injected elements (after phased render):', {\n      total: this.overlayElementCache.size,\n      text: overlayGroup.querySelectorAll('[data-overlay-type=\"text\"]').length,\n      lines: overlayGroup.querySelectorAll('[data-overlay-type=\"line\"]').length,\n      sparklines: overlayGroup.querySelectorAll('[data-overlay-type=\"sparkline\"]').length\n    });\n\n    // NEW: schedule deferred line refresh to fix first-load orientation/position\n    this._scheduleDeferredLineRefresh(overlays, this._dynamicAnchors, viewBox);\n\n    // NEW: schedule font stabilization pass (re-measure after real fonts load)\n    this._scheduleFontStabilization(overlays, this._dynamicAnchors, viewBox);\n\n    this.lastRenderArgs = { resolvedModel, overlays, svg };\n    return {\n      svgMarkup: svgMarkupAccum,\n      overlayCount: processedCount,\n      errors: overlays.length - processedCount\n    };\n  }\n\n  _ensureOverlayGroup(svg) {\n    let group = svg.querySelector('#msd-overlay-container');\n    if (!group) {\n      group = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n      group.setAttribute('id', 'msd-overlay-container');\n      svg.appendChild(group);\n    }\n    return group;\n  }\n\n  _cacheElementsFrom(group) {\n    const nodes = group.querySelectorAll('[data-overlay-id]');\n    nodes.forEach(el => {\n      const id = el.getAttribute('data-overlay-id');\n      if (id) this.overlayElementCache.set(id, el);\n    });\n  }\n\n  // NEW: build virtual anchors for lines that attach to overlays\n  _buildDynamicOverlayAnchors(overlays, anchorMap) {\n    overlays.filter(o => o.type === 'line').forEach(line => {\n      const raw = line._raw || line.raw || {};\n      const dest = raw.attach_to || raw.attachTo;\n      if (!dest) return;\n      const tap = this.textAttachmentPoints.get(dest);\n      if (!tap || !tap.points) return;\n      const side = (raw.attach_side || raw.attachSide || '').toLowerCase();\n      const basePt = this._resolveOverlayAttachmentPoint(tap.points, side);\n      if (!basePt) return;\n      const gapPt = this._applyAttachGap(basePt, side, raw, tap.bbox);\n      anchorMap[dest] = gapPt;\n      // Register in routerCore so HUD sees it as an anchor\n      if (this.routerCore && this.routerCore.anchors) {\n        this.routerCore.anchors[dest] = gapPt;\n        try {\n          this.routerCore.invalidate(line.id);\n          const srcAnchor = anchorMap[raw.anchor] || this.routerCore.anchors[raw.anchor];\n          if (srcAnchor) {\n            const req = this.routerCore.buildRouteRequest(line, srcAnchor, gapPt);\n            this.routerCore.computePath(req);\n          }\n        } catch(e) {\n          console.warn('[AdvancedRenderer] Route registration (initial) failed', line.id, e);\n        }\n      }\n      // Track dependency\n      if (!this._lineDeps.has(dest)) this._lineDeps.set(dest, new Set());\n      this._lineDeps.get(dest).add(line.id);\n    });\n  }\n\n  // NEW: update dynamic anchors for changed text overlays\n  _updateDynamicAnchorsForOverlays(changedIds, overlays, anchorMap) {\n    if (!changedIds.size) return;\n    changedIds.forEach(id => {\n      const tap = this.textAttachmentPoints.get(id);\n      if (!tap || !tap.points) return;\n      const dep = this._lineDeps.get(id);\n      if (!dep) return;\n      dep.forEach(lineId => {\n        const line = overlays.find(o => o.id === lineId);\n        if (!line) return;\n        const raw = line._raw || line.raw || {};\n        const side = (raw.attach_side || raw.attachSide || '').toLowerCase();\n        const basePt = this._resolveOverlayAttachmentPoint(tap.points, side);\n        if (!basePt) return;\n        const gapPt = this._applyAttachGap(basePt, side, raw, tap.bbox);\n        anchorMap[id] = gapPt;\n        if (this.routerCore && this.routerCore.anchors) {\n          this.routerCore.anchors[id] = gapPt;\n          try {\n            this.routerCore.invalidate(line.id);\n            const srcAnchor = anchorMap[raw.anchor] || this.routerCore.anchors[raw.anchor];\n            if (srcAnchor) {\n              const req = this.routerCore.buildRouteRequest(line, srcAnchor, gapPt);\n              this.routerCore.computePath(req);\n            }\n          } catch(e) {\n            console.warn('[AdvancedRenderer] Route registration (update) failed', line.id, e);\n          }\n        }\n      });\n    });\n  }\n\n  // NEW: apply attach_gap offsets\n  _applyAttachGap(point, side, raw, bbox) {\n    const gap = Number(raw.attach_gap || raw.attachGap || 0);\n    const gapX = Number(raw.attach_gap_x || raw.attachGapX || gap || 0);\n    const gapY = Number(raw.attach_gap_y || raw.attachGapY || gap || 0);\n    if (!(gapX || gapY)) return point;\n    const [x, y] = point;\n    let dx = 0, dy = 0;\n    switch (side) {\n      case 'left': dx = -gapX; break;\n      case 'right': dx = gapX; break;\n      case 'top': dy = -gapY; break;\n      case 'bottom': dy = gapY; break;\n      case 'top-left': dx = -gapX; dy = -gapY; break;\n      case 'top-right': dx = gapX; dy = -gapY; break;\n      case 'bottom-left': dx = -gapX; dy = gapY; break;\n      case 'bottom-right': dx = gapX; dy = gapY; break;\n      default: break;\n    }\n    // Optional: ensure gap extends outward (based on bbox) if bbox provided\n    if (bbox) {\n      if (side.includes('left') && x > bbox.left) dx = -Math.abs(dx);\n      if (side.includes('right') && x < bbox.right) dx = Math.abs(dx);\n      if (side.includes('top') && y > bbox.top) dy = -Math.abs(dy);\n      if (side.includes('bottom') && y < bbox.bottom) dy = Math.abs(dy);\n    }\n    return [x + dx, y + dy];\n  }\n\n  // NEW: resolve which attachment point to use based on side keyword\n  _resolveOverlayAttachmentPoint(points, side) {\n    if (!points) return null;\n    switch (side) {\n      case 'left': return points.left || points.leftPadded || points.center;\n      case 'right': return points.right || points.rightPadded || points.center;\n      case 'top': return points.top || points.topPadded || points.center;\n      case 'bottom': return points.bottom || points.bottomPadded || points.center;\n      case 'top-left': return points.topLeft || points.left || points.top || points.center;\n      case 'top-right': return points.topRight || points.right || points.top || points.center;\n      case 'bottom-left': return points.bottomLeft || points.left || points.bottom || points.center;\n      case 'bottom-right': return points.bottomRight || points.right || points.bottom || points.center;\n      case 'center':\n      default:\n        return points.center;\n    }\n  }\n\n  // UPDATED: font stabilization pass using actual DOM glyph metrics (multi-pass) with better async handling\n  _scheduleFontStabilization(overlays, anchorsRef, viewBox) {\n    if (!overlays.some(o => o.type === 'text')) return;\n    const MAX_PASSES = 10;\n    const EXTRA_PASSES = 5; // safety extra passes after fonts load\n    const TOL = 0.01;\n    let pass = 0;\n    const run = () => {\n      const changedTargets = new Set();\n      let anyUnstable = false;\n      overlays.filter(o=>o.type==='text').forEach(ov => {\n        const group = this.overlayElementCache.get(ov.id);\n        if (!group) return;\n        const bb = RendererUtils.getDomTextBBox(group);\n        if (!bb) { anyUnstable = true; return; }\n        const recordedW = parseFloat(group.getAttribute('data-text-width')||'0')||0;\n        const recordedH = parseFloat(group.getAttribute('data-text-height')||'0')||0;\n        const diffW = Math.abs(bb.width - recordedW);\n        const diffH = Math.abs(bb.height - recordedH);\n        const needsRerender = (diffW > TOL) || (diffH > TOL);\n\n        if (needsRerender) {\n          const newGroup = this._reRenderSingleTextOverlay(ov, anchorsRef, viewBox);\n          if (newGroup) {\n            const bb2 = RendererUtils.getDomTextBBox(newGroup);\n            if (bb2) {\n              newGroup.setAttribute('data-text-width', String(bb2.width));\n              newGroup.setAttribute('data-text-height', String(bb2.height));\n              this._updateStatusIndicatorPosition(newGroup, bb2);\n            }\n            changedTargets.add(ov.id);\n            anyUnstable = true;\n          }\n        } else {\n          if (diffW > 0 || diffH > 0) {\n            group.setAttribute('data-text-width', String(bb.width));\n            group.setAttribute('data-text-height', String(bb.height));\n            changedTargets.add(ov.id);\n          }\n          if (group.getAttribute('data-font-stabilized') !== '1') {\n            group.setAttribute('data-font-stabilized','1');\n          }\n          this._updateTextAttachmentPointsFromDom(ov, group, bb);\n          // NEW: always update status indicator position even without re-render\n          this._updateStatusIndicatorPosition(group, bb);\n        }\n      });\n\n      this.lineRenderer.setTextAttachmentPoints(this.textAttachmentPoints);\n\n      if (changedTargets.size) {\n        this._updateDynamicAnchorsForOverlays(changedTargets, overlays, this._dynamicAnchors);\n        this._rerenderDependentLines(changedTargets, overlays, this._dynamicAnchors, viewBox);\n      }\n\n      pass++;\n      const morePassesAllowed = pass < (MAX_PASSES + EXTRA_PASSES);\n      if ((changedTargets.size || anyUnstable) && morePassesAllowed) {\n        requestAnimationFrame(run);\n      } else {\n        if (changedTargets.size) {\n          this._scheduleDeferredLineRefresh(overlays, this._dynamicAnchors, viewBox);\n        }\n        // Final safety delayed pass in case font finished loading just after loop\n        setTimeout(() => {\n          const remaining = overlays.filter(o=>o.type==='text')\n            .some(o => {\n              const g = this.overlayElementCache.get(o.id);\n              return g && g.getAttribute('data-font-stabilized') !== '1';\n            });\n          if (remaining) {\n            console.log('[AdvancedRenderer] Running safety stabilization pass');\n            pass = 0;\n            requestAnimationFrame(run);\n          }\n        }, 180);\n        console.log('[AdvancedRenderer] Font stabilization complete', { passes: pass, changed: Array.from(changedTargets) });\n      }\n    };\n\n    // Wait for font faces if still loading\n    const fontAPI = document.fonts;\n    if (fontAPI && fontAPI.status !== 'loaded') {\n      fontAPI.ready.then(() => requestAnimationFrame(run)).catch(() => requestAnimationFrame(run));\n    } else {\n      requestAnimationFrame(run);\n    }\n  }\n\n  // UPDATED signature usages for dynamic anchors\n  _scheduleDeferredLineRefresh(overlays, anchorsRef, viewBox) {\n    if (typeof requestAnimationFrame !== 'function') return;\n    const lineOverlays = overlays.filter(o =>\n      o.type === 'line' &&\n      ((o._raw || o.raw || {}).attach_side || (o._raw || o.raw || {}).attach_to)\n    );\n    if (!lineOverlays.length) return;\n    requestAnimationFrame(() => {\n      lineOverlays.forEach(ov => {\n        const existingEl = this.overlayElementCache.get(ov.id);\n        if (!existingEl) return;\n        try {\n          const newMarkup = this.lineRenderer.render(ov, anchorsRef, viewBox);\n          if (!newMarkup) return;\n          // Parse markup into element\n          const temp = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n          temp.innerHTML = newMarkup.trim();\n          const newEl = temp.firstElementChild;\n          if (!newEl) return;\n            existingEl.replaceWith(newEl);\n          this.overlayElementCache.set(ov.id, newEl);\n        } catch (e) {\n          console.warn('[AdvancedRenderer] Deferred line refresh failed', ov.id, e);\n        }\n      });\n      console.log('[AdvancedRenderer] Deferred line refresh pass complete');\n    });\n  }\n\n  renderOverlay(overlay, anchors, viewBox) {\n    if (!overlay || !overlay.type) {\n      console.warn('[AdvancedRenderer] Invalid overlay - missing type:', overlay);\n      return '';\n    }\n\n    // Ensure SVG container is available before rendering\n    const svgContainer = this.mountEl;\n    const svg = svgContainer?.querySelector('svg');\n\n    if (!svg) {\n      console.warn('[AdvancedRenderer] SVG element not found in container for overlay:', overlay.id);\n    }\n\n    // ADDED: Ensure SVG doesn't interfere with control events\n    if (svg) {\n      svg.style.pointerEvents = 'auto';\n      svg.style.zIndex = '0'; // Keep SVG in background\n    }\n\n    switch (overlay.type) {\n      case 'text':\n        // Update (in case dynamic overlays later): recompute & refresh map\n        const ap = TextOverlayRenderer.computeAttachmentPoints(overlay, anchors, svgContainer);\n        if (ap) this.textAttachmentPoints.set(overlay.id, ap);\n        return TextOverlayRenderer.render(overlay, anchors, viewBox, svgContainer);\n      case 'sparkline':\n        return SparklineRenderer.render(overlay, anchors, viewBox);\n      case 'line':\n        return this.lineRenderer.render(overlay, anchors, viewBox);\n      case 'control':\n        // ADDED: Control overlays are handled by MsdControlsRenderer, not SVG renderer\n        console.log('[AdvancedRenderer] Control overlay detected, skipping SVG rendering:', overlay.id);\n        return ''; // Return empty string - controls are rendered separately by MsdControlsRenderer\n      default:\n        console.warn(`[AdvancedRenderer] Unknown overlay type: ${overlay.type}`);\n        return '';\n    }\n  }\n\n  injectSvgContent(svgContent) {\n    const svg = this.mountEl.querySelector('svg');\n    if (!svg) {\n      console.warn('[AdvancedRenderer] No SVG element found for overlay injection');\n      return;\n    }\n\n    let overlayGroup = svg.querySelector('#msd-overlay-container');\n    if (!overlayGroup) {\n      overlayGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n      overlayGroup.setAttribute('id', 'msd-overlay-container');\n      svg.appendChild(overlayGroup);\n    } else {\n      overlayGroup.innerHTML = '';\n    }\n\n    try {\n      overlayGroup.innerHTML = svgContent;\n      console.log('[AdvancedRenderer] SVG content injected successfully');\n\n      // Build element cache after injection\n      this.overlayElementCache.clear();\n      const overlayElements = overlayGroup.querySelectorAll('[data-overlay-id]');\n      overlayElements.forEach(element => {\n        const overlayId = element.getAttribute('data-overlay-id');\n        if (overlayId) {\n          this.overlayElementCache.set(overlayId, element);\n          console.log(`[AdvancedRenderer] Cached element for overlay: ${overlayId}`);\n        }\n      });\n\n      // Verify injection\n      const sparklines = overlayGroup.querySelectorAll('[data-overlay-type=\"sparkline\"]');\n      const lines = overlayGroup.querySelectorAll('[data-overlay-type=\"line\"]');\n      const texts = overlayGroup.querySelectorAll('[data-overlay-type=\"text\"]');\n\n      console.log('[AdvancedRenderer] Injected elements:', {\n        sparklines: sparklines.length,\n        lines: lines.length,\n        texts: texts.length,\n        cached: this.overlayElementCache.size\n      });\n\n    } catch (error) {\n      console.error('[AdvancedRenderer] Failed to inject SVG content:', error);\n    }\n  }\n\n  // === DATA UPDATE METHODS ===\n\n  /**\n   * Update overlay data when data source changes\n   * @param {string} overlayId - ID of the overlay to update\n   * @param {Object} sourceData - Data from the data source\n   */\n  updateOverlayData(overlayId, sourceData) {\n    console.log('[AdvancedRenderer] updateOverlayData called:', {\n      overlayId,\n      hasSourceData: !!sourceData,\n      sourceDataKeys: sourceData ? Object.keys(sourceData) : 'none',\n      hasBuffer: !!(sourceData?.buffer),\n      bufferSize: sourceData?.buffer?.size?.() || 0,\n      hasCachedElement: this.overlayElementCache.has(overlayId)\n    });\n\n    if (!sourceData) {\n      console.warn('[AdvancedRenderer] updateOverlayData: Missing sourceData');\n      return;\n    }\n\n    // Use cached element - no DOM searching needed with subscription system\n    const overlayElement = this.overlayElementCache.get(overlayId);\n\n    if (!overlayElement) {\n      console.warn(`[AdvancedRenderer] Could not find cached overlay element: ${overlayId}. Element should be cached during render.`);\n      return;\n    }\n\n    const overlay = this.lastRenderArgs?.overlays?.find(o => o.id === overlayId);\n    if (!overlay) {\n      console.warn(`[AdvancedRenderer] Could not find overlay config: ${overlayId}`);\n      return;\n    }\n\n    // Delegate to type-specific renderer\n    if (overlay.type === 'sparkline') {\n      SparklineRenderer.updateSparklineData(overlayElement, overlay, sourceData);\n    } else {\n      console.warn(`[AdvancedRenderer] Update not implemented for overlay type: ${overlay.type}`);\n    }\n  }\n\n  handleDataSourceUpdate(updateData) {\n    if (!this.mountEl) return;\n\n    // Find sparklines using cached elements instead of DOM search\n    const cachedElements = Array.from(this.overlayElementCache.values());\n    const sparklines = cachedElements.filter(el =>\n      el.getAttribute('data-source') === updateData.sourceId\n    );\n\n    if (sparklines.length === 0) {\n      console.log(`[AdvancedRenderer] No cached sparklines found for source: ${updateData.sourceId}`);\n      return;\n    }\n\n    sparklines.forEach(sparklineElement => {\n      const overlay = this.lastRenderArgs.overlays?.find(o =>\n        o.id === sparklineElement.getAttribute('data-overlay-id')\n      );\n      if (!overlay) return;\n\n      // Use SparklineRenderer's update method\n      SparklineRenderer.updateSparklineData(sparklineElement, overlay, updateData.data);\n    });\n  }\n\n  /**\n   * Clean up resources when renderer is destroyed\n   */\n  destroy() {\n    this.overlayElements.clear();\n    this.overlayElementCache.clear();\n    this.lastRenderArgs = null;\n  }\n\n  _updateTextAttachmentPointsFromDom(overlay, groupEl, bb) {\n    if (!overlay || !groupEl || !bb) return;\n    const ap = {\n      id: overlay.id,\n      center: [bb.centerX, bb.centerY],\n      bbox: {\n        left: bb.left, right: bb.right, top: bb.top, bottom: bb.bottom,\n        width: bb.width, height: bb.height\n      },\n      points: {\n        center: [bb.centerX, bb.centerY],\n        top: [bb.centerX, bb.top],\n        bottom: [bb.centerX, bb.bottom],\n        left: [bb.left, bb.centerY],\n        right: [bb.right, bb.centerY],\n        topLeft: [bb.left, bb.top],\n        topRight: [bb.right, bb.top],\n        bottomLeft: [bb.left, bb.bottom],\n        bottomRight: [bb.right, bb.bottom]\n      }\n    };\n    this.textAttachmentPoints.set(overlay.id, ap);\n  }\n\n  _rerenderDependentLines(changedSet, overlays, anchorsRef, viewBox) {\n    if (!changedSet || !changedSet.size) return;\n    const toRerender = new Set();\n    changedSet.forEach(tid => {\n      const dep = this._lineDeps.get(tid);\n      if (dep) dep.forEach(id => toRerender.add(id));\n    });\n    if (!toRerender.size) return;\n    requestAnimationFrame(() => {\n      toRerender.forEach(lineId => {\n        const overlay = overlays.find(o => o.id === lineId);\n        if (!overlay) return;\n        const existingEl = this.overlayElementCache.get(lineId);\n        if (!existingEl) return;\n        try {\n          const newMarkup = this.lineRenderer.render(overlay, anchorsRef, viewBox);\n          if (!newMarkup) return;\n          const temp = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n          temp.innerHTML = newMarkup.trim();\n          const newEl = temp.firstElementChild;\n          if (!newEl) return;\n          existingEl.replaceWith(newEl);\n          this.overlayElementCache.set(lineId, newEl);\n        } catch(e) {\n          console.warn('[AdvancedRenderer] Dep line re-render failed', lineId, e);\n        }\n      });\n      console.log('[AdvancedRenderer] Rerendered dependent lines after font stabilization', { count: toRerender.size });\n    });\n  }\n\n  _reRenderSingleTextOverlay(overlay, anchorsRef, viewBox) {\n    try {\n      const oldGroup = this.overlayElementCache.get(overlay.id);\n      if (!oldGroup) return null;\n      const markup = TextOverlayRenderer.render(overlay, anchorsRef, viewBox, this.mountEl);\n      if (!markup) return null;\n      const temp = document.createElementNS('http://www.w3.org/2000/svg','g');\n      temp.innerHTML = markup.trim();\n      const newGroup = temp.firstElementChild;\n      if (!newGroup) return null;\n      oldGroup.replaceWith(newGroup);\n      this.overlayElementCache.set(overlay.id, newGroup);\n      // Update DOM-based attachment points immediately\n      const bb = RendererUtils.getDomTextBBox(newGroup);\n      if (bb) this._updateTextAttachmentPointsFromDom(overlay, newGroup, bb);\n      return newGroup;\n    } catch(e) {\n      console.warn('[AdvancedRenderer] Re-render text overlay failed', overlay.id, e);\n      return null;\n    }\n  }\n\n  _updateStatusIndicatorPosition(groupEl, textBBox) {\n    try {\n      if (!groupEl) return;\n      const circle = groupEl.querySelector('circle[data-decoration=\"status-indicator\"]');\n      if (!circle) return;\n      // Read required data\n      const pos = circle.getAttribute('data-status-pos') || 'left-center';\n      const fontSize = Number(groupEl.getAttribute('data-font-size') || 16);\n      const indicatorSize = fontSize * 0.4;\n      // Padding calculation (mirror TextOverlayRenderer)\n      const transformInfo = RendererUtils._getSvgTransformInfo(this.mountEl);\n      const pixelPadding = 8;\n      const padding = transformInfo ? transformInfo.pixelToViewBox(pixelPadding) : indicatorSize;\n\n      const bbox = textBBox; // has left/right/top/bottom/centerX/centerY\n      let cx = bbox.centerX, cy = bbox.centerY;\n      switch (pos) {\n        case 'top-left':     cx = bbox.left - padding;  cy = bbox.top - padding; break;\n        case 'top-right':    cx = bbox.right + padding; cy = bbox.top - padding; break;\n        case 'bottom-left':  cx = bbox.left - padding;  cy = bbox.bottom + padding; break;\n        case 'bottom-right': cx = bbox.right + padding; cy = bbox.bottom + padding; break;\n        case 'top':          cx = bbox.centerX;         cy = bbox.top - padding; break;\n        case 'bottom':       cx = bbox.centerX;         cy = bbox.bottom + padding; break;\n        case 'left':\n        case 'left-center':  cx = bbox.left - padding;  cy = bbox.centerY; break;\n        case 'right':\n        case 'right-center': cx = bbox.right + padding; cy = bbox.centerY; break;\n        case 'center':       cx = bbox.centerX;         cy = bbox.centerY; break;\n        default:             cx = bbox.left - padding;  cy = bbox.centerY;\n      }\n      circle.setAttribute('cx', cx);\n      circle.setAttribute('cy', cy);\n      circle.setAttribute('r', indicatorSize);\n    } catch(_) {\n      // silent\n    }\n  }\n}","/**\n * Phase 2: Debug visualization renderer\n * Shows anchor markers, overlay bounding boxes, routing guidelines, performance overlays.\n * Handles timing resilience for systems that may not be fully initialized at first render.\n */\nexport class MsdDebugRenderer {\n  constructor() {\n    this.enabled = false;\n    this.debugLayer = null;\n    this.anchorMarkers = new Map();\n    this.boundingBoxes = new Map();\n    this.routingOverlays = new Map();\n    this.performanceOverlays = new Map();\n\n    this.scale = 1.0;\n\n    // Remove old feature flags - now managed by DebugManager\n    this.debugManager = null;\n    this.unsubscribeDebug = null;\n\n    // Store last render context for reactive re-renders\n    this._lastRenderContext = null;\n\n    // Remove retry mechanism - no longer needed\n  }\n\n  /**\n   * Initialize with systems manager and subscribe to debug changes\n   * @param {SystemsManager} systemsManager - Systems manager instance\n   */\n  init(systemsManager) {\n    this.debugManager = systemsManager.debugManager;\n\n    // Subscribe to debug state changes for reactive rendering\n    this.unsubscribeDebug = this.debugManager.onChange((event) => {\n      // REDUCED: Only log significant events\n      if (event.type === 'feature' || event.type === 'scale' || event.type === 'router-ready') {\n        this._scheduleRerender();\n      }\n    });\n\n    // REDUCED: Minimal initialization logging\n  }\n\n  /**\n   * Set scale factor from debug configuration\n   * @param {number} scale - Scale multiplier (default 1.0)\n   */\n  setScale(scale = 1.0) {\n    this.scale = Math.max(0.3, Math.min(3.0, scale)); // Clamp between reasonable bounds\n    console.log(`[MsdDebugRenderer] Scale factor set to: ${this.scale}`);\n  }\n\n  /**\n   * Main render method - now powered by DebugManager state\n   * @param {Element} root - DOM root element\n   * @param {Array} viewBox - SVG viewBox [x, y, width, height]\n   * @param {Object} opts - Render options\n   */\n  render(root, viewBox, opts = {}) {\n    // REDUCED: Only log if debug is actually enabled\n    const debugState = this.debugManager?.getSnapshot();\n    if (!debugState?.enabled) {\n      return;\n    }\n\n    // Store context for reactive re-renders\n    this._lastRenderContext = { root, viewBox, opts };\n\n    if (!this.debugManager || !this.debugManager.initialized) {\n      return;\n    }\n\n    if (!root || typeof root.querySelector !== 'function') {\n      console.warn('[MsdDebugRenderer] Invalid root element');\n      return;\n    }\n\n    const svgElement = root.querySelector('svg');\n    if (!svgElement) {\n      console.warn('[MsdDebugRenderer] No SVG element found in root');\n      return;\n    }\n\n    // Update scale from DebugManager\n    this.setScale(debugState.scale);\n\n    // Setup debug layer\n    this.integrateWithAdvancedRenderer(svgElement, viewBox, opts.anchors);\n\n    // Clear existing debug content\n    if (this.debugLayer) {\n      this.debugLayer.innerHTML = '';\n    }\n\n    // Exit early if no features enabled\n    if (!debugState.enabled) {\n      if (this.debugLayer) {\n        this.debugLayer.style.display = 'none';\n      }\n      return;\n    }\n\n    // REDUCED: Only log when actually rendering features\n    console.log('[MsdDebugRenderer] Rendering debug features');\n\n    // Render enabled features using DebugManager state\n    if (debugState.anchors && opts.anchors) {\n      console.log('[MsdDebugRenderer] Rendering anchors...');\n      this.renderAnchorMarkers(opts.anchors);\n    }\n\n    if (debugState.bounding_boxes && opts.overlays) {\n      console.log('[MsdDebugRenderer] Rendering bounding boxes...');\n      this.renderOverlayBounds(opts.overlays);\n    }\n\n    if (debugState.routing && this.debugManager.canRenderRouting()) {\n      console.log('[MsdDebugRenderer] Rendering routing guides...');\n      this.renderRoutingGuides(opts);\n    }\n\n    if (debugState.performance) {\n      console.log('[MsdDebugRenderer] Rendering performance overlays...');\n      this.renderPerformanceOverlays(opts);\n    }\n\n    // Show debug layer\n    if (this.debugLayer) {\n      this.debugLayer.style.display = 'block';\n    }\n  }\n\n  /**\n   * Schedule a reactive re-render\n   * @private\n   */\n  _scheduleRerender() {\n    if (this._lastRenderContext) {\n      // Use requestAnimationFrame to avoid excessive re-renders\n      requestAnimationFrame(() => {\n        const { root, viewBox, opts } = this._lastRenderContext;\n        this.render(root, viewBox, opts);\n      });\n    }\n  }\n\n  /**\n   * Render routing guides - simplified without retry mechanism\n   * @param {Object} opts - Render options\n   */\n  renderRoutingGuides(opts) {\n    if (!this.debugLayer) return;\n\n    // Clear existing routes\n    this.routingOverlays.forEach(o => o.remove());\n    this.routingOverlays.clear();\n\n    // Get routing system from window.__msdDebug (set by pipeline)\n    const routing = opts.router || window.__msdDebug?.routing;\n\n    if (!routing || typeof routing.inspect !== 'function') {\n      console.log('[MsdDebugRenderer] Routing system not available for debug rendering');\n      return;\n    }\n\n    const overlays = opts.overlays || [];\n    const lineOverlays = overlays.filter(o => o.type === 'line');\n\n    if (lineOverlays.length === 0) {\n      console.log('[MsdDebugRenderer] No line overlays found for routing visualization');\n      return;\n    }\n\n    let routeCount = 0;\n    lineOverlays.forEach(overlay => {\n      try {\n        const routeInfo = routing.inspect(overlay.id);\n        if (routeInfo && routeInfo.pts && routeInfo.pts.length > 1) {\n          const routeOverlay = this.createRoutingOverlay(overlay.id, routeInfo);\n          this.debugLayer.appendChild(routeOverlay);\n          this.routingOverlays.set(overlay.id, routeOverlay);\n          routeCount++;\n        } else {\n          // Fine-grained debug, not necessarily an error\n          console.log(`[MsdDebugRenderer] No route info for overlay ${overlay.id}`);\n        }\n      } catch (error) {\n        console.warn(`[MsdDebugRenderer] Failed to render routing guide for ${overlay.id}:`, error);\n      }\n    });\n\n    console.log(`[MsdDebugRenderer] Rendered ${routeCount} routing guides`);\n  }\n\n  /**\n   * Create routing visualization overlay group.\n   * @param {string} overlayId\n   * @param {Object} routeInfo\n   * @returns {SVGGElement}\n   */\n  createRoutingOverlay(overlayId, routeInfo) {\n    const doc = this.debugLayer.ownerDocument;\n    const group = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n    group.setAttribute('class', 'msd-debug-routing');\n\n    const points = routeInfo.pts || [];\n    points.forEach((pt, index) => {\n      if (Array.isArray(pt) && pt.length >= 2) {\n        const [x, y] = pt;\n        const waypoint = doc.createElementNS('http://www.w3.org/2000/svg', 'circle');\n        waypoint.setAttribute('cx', x);\n        waypoint.setAttribute('cy', y);\n        waypoint.setAttribute('r', 2 * this.scale);\n        waypoint.setAttribute('fill', 'magenta');\n        waypoint.setAttribute('stroke', 'white');\n        waypoint.setAttribute('stroke-width', 1 * this.scale);\n        waypoint.setAttribute('opacity', '0.8');\n        group.appendChild(waypoint);\n\n        if (index === 0 || index === points.length - 1 || points.length <= 6) {\n          const label = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n            label.setAttribute('x', x + (4 * this.scale));\n            label.setAttribute('y', y - (4 * this.scale));\n            label.setAttribute('fill', 'magenta');\n            label.setAttribute('font-size', 8 * this.scale);\n            label.setAttribute('font-family', 'monospace');\n            label.setAttribute('opacity', '0.8');\n            label.textContent = index;\n            group.appendChild(label);\n        }\n      }\n    });\n\n    if (routeInfo.meta) {\n      const startPt = points[0];\n      if (startPt && Array.isArray(startPt) && startPt.length >= 2) {\n        const info = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n        info.setAttribute('x', startPt[0]);\n        info.setAttribute('y', startPt[1] - (12 * this.scale));\n        info.setAttribute('fill', 'magenta');\n        info.setAttribute('font-size', 9 * this.scale);\n        info.setAttribute('font-family', 'monospace');\n        info.setAttribute('opacity', '0.9');\n        info.textContent = `${routeInfo.meta.strategy || 'auto'} (${Math.round(routeInfo.meta.cost || 0)})`;\n        group.appendChild(info);\n      }\n    }\n\n    return group;\n  }\n\n  /**\n   * Render anchor markers\n   * @param {Object} anchors\n   */\n  renderAnchorMarkers(anchors) {\n    if (!anchors || !this.debugLayer) return;\n\n    this.anchorMarkers.forEach(marker => marker.remove());\n    this.anchorMarkers.clear();\n\n    let markerCount = 0;\n    for (const [name, pt] of Object.entries(anchors)) {\n      if (Array.isArray(pt) && pt.length >= 2) {\n        const marker = this.createAnchorMarker(name, pt[0], pt[1]);\n        this.debugLayer.appendChild(marker);\n        this.anchorMarkers.set(name, marker);\n        markerCount++;\n      }\n    }\n\n    console.log(`[MsdDebugRenderer] Rendered ${markerCount} anchor markers`);\n  }\n\n  /**\n   * Create individual anchor marker group element\n   * @param {string} name\n   * @param {number} x\n   * @param {number} y\n   * @returns {SVGGElement}\n   */\n  createAnchorMarker(name, x, y) {\n    const group = this.debugLayer.ownerDocument.createElementNS('http://www.w3.org/2000/svg', 'g');\n    group.setAttribute('transform', `translate(${x}, ${y})`);\n    group.setAttribute('class', 'msd-debug-anchor');\n\n    const crosshairSize = 8 * this.scale;\n    const strokeWidth = 2 * this.scale;\n    const circleRadius = 3 * this.scale;\n    const fontSize = 12 * this.scale;\n    const labelOffset = 12 * this.scale;\n\n    const crosshair = `\n      <line x1=\"${-crosshairSize}\" y1=\"0\" x2=\"${crosshairSize}\" y2=\"0\" stroke=\"cyan\" stroke-width=\"${strokeWidth}\" opacity=\"0.8\"/>\n      <line x1=\"0\" y1=\"${-crosshairSize}\" x2=\"0\" y2=\"${crosshairSize}\" stroke=\"cyan\" stroke-width=\"${strokeWidth}\" opacity=\"0.8\"/>\n      <circle cx=\"0\" cy=\"0\" r=\"${circleRadius}\" fill=\"cyan\" stroke=\"white\" stroke-width=\"${this.scale}\" opacity=\"0.9\"/>\n    `;\n    const label = `\n      <text x=\"${labelOffset}\" y=\"4\" fill=\"cyan\" font-size=\"${fontSize}\" font-family=\"monospace\" opacity=\"0.9\">\n        ${name} (${Math.round(x)}, ${Math.round(y)})\n      </text>\n    `;\n\n    group.innerHTML = crosshair + label;\n    return group;\n  }\n\n  /**\n   * Render overlay bounding boxes\n   * @param {Array<Object>} overlays\n   */\n  renderOverlayBounds(overlays = []) {\n    if (!this.debugLayer) return;\n\n    this.boundingBoxes.forEach((bboxObj) => {\n      bboxObj.rect?.remove();\n      bboxObj.label?.remove();\n    });\n    this.boundingBoxes.clear();\n\n    let bboxCount = 0;\n    overlays.forEach(overlay => {\n      if (overlay.position && Array.isArray(overlay.position)) {\n        const [x, y] = overlay.position;\n        const width = overlay.size ? overlay.size[0] : 100;\n        const height = overlay.size ? overlay.size[1] : 20;\n\n        const bboxObj = this.createBoundingBox(overlay.id, x, y, width, height);\n        this.debugLayer.appendChild(bboxObj.rect);\n        this.debugLayer.appendChild(bboxObj.label);\n        this.boundingBoxes.set(overlay.id, bboxObj);\n        bboxCount++;\n      }\n    });\n\n    console.log(`[MsdDebugRenderer] Rendered ${bboxCount} bounding boxes`);\n  }\n\n  /**\n   * Create bounding box visualization objects\n   * @param {string} id\n   * @param {number} x\n   * @param {number} y\n   * @param {number} width\n   * @param {number} height\n   * @returns {{rect: SVGRectElement, label: SVGTextElement}}\n   */\n  createBoundingBox(id, x, y, width, height) {\n    const doc = this.debugLayer.ownerDocument;\n    const rect = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    rect.setAttribute('x', x);\n    rect.setAttribute('y', y);\n    rect.setAttribute('width', width);\n    rect.setAttribute('height', height);\n    rect.setAttribute('fill', 'none');\n    rect.setAttribute('stroke', 'orange');\n    rect.setAttribute('stroke-width', 1 * this.scale);\n    rect.setAttribute('stroke-dasharray', `${3 * this.scale},${3 * this.scale}`);\n    rect.setAttribute('opacity', '0.7');\n    rect.setAttribute('class', 'msd-debug-bbox');\n\n    const label = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n    label.setAttribute('x', x + (2 * this.scale));\n    label.setAttribute('y', y + (12 * this.scale));\n    label.setAttribute('fill', 'orange');\n    label.setAttribute('font-size', 10 * this.scale);\n    label.setAttribute('font-family', 'monospace');\n    label.setAttribute('opacity', '0.9');\n    label.textContent = id || 'unknown';\n    label.setAttribute('class', 'msd-debug-bbox-label');\n\n    return { rect, label };\n  }\n\n  /**\n   * Render performance overlays - with proper value formatting\n   * @param {Object} opts\n   */\n  renderPerformanceOverlays(opts) {\n    if (!this.debugLayer) return;\n\n    this.performanceOverlays.forEach(o => o.remove());\n    this.performanceOverlays.clear();\n\n    const perf = window.__msdDebug?.getPerf?.() || {};\n    const perfEntries = [];\n\n    if (perf.timers) {\n      Object.entries(perf.timers).forEach(([key, data]) => {\n        if (data && typeof data === 'object') {\n          const avg = data.count > 0 ? (data.total / data.count) : 0;\n            perfEntries.push(`${key}: ${avg.toFixed(2)}ms avg`);\n        }\n      });\n    }\n\n    if (perf.counters) {\n      Object.entries(perf.counters).forEach(([key, value]) => {\n        perfEntries.push(`${key}: ${value}`);\n      });\n    }\n\n    if (perfEntries.length === 0) {\n      Object.entries(perf).slice(0, 10).forEach(([key, value]) => {\n        let displayValue;\n        if (typeof value === 'object' && value !== null) {\n          if (value.count !== undefined && value.total !== undefined) {\n            const avg = value.count > 0 ? (value.total / value.count) : 0;\n            displayValue = `${avg.toFixed(2)}ms avg`;\n          } else {\n            displayValue = JSON.stringify(value);\n          }\n        } else {\n          displayValue = String(value);\n        }\n        perfEntries.push(`${key}: ${displayValue}`);\n      });\n    }\n\n    if (perfEntries.length === 0) {\n      console.log('[MsdDebugRenderer] No performance data available');\n      return;\n    }\n\n    const doc = this.debugLayer.ownerDocument;\n    const perfGroup = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n    perfGroup.setAttribute('class', 'msd-debug-performance');\n\n    const baseX = 10 * this.scale;\n    const baseY = 10 * this.scale;\n    const width = 200 * this.scale;\n    const padding = 5 * this.scale;\n\n    const bg = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\n    bg.setAttribute('x', baseX);\n    bg.setAttribute('y', baseY);\n    bg.setAttribute('width', width);\n    bg.setAttribute('height', (20 + perfEntries.slice(0, 8).length * 15) * this.scale);\n    bg.setAttribute('fill', 'rgba(0,0,0,0.8)');\n    bg.setAttribute('stroke', 'yellow');\n    bg.setAttribute('stroke-width', 1 * this.scale);\n    bg.setAttribute('rx', 4 * this.scale);\n    perfGroup.appendChild(bg);\n\n    const title = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n    title.setAttribute('x', baseX + padding);\n    title.setAttribute('y', baseY + (15 * this.scale));\n    title.setAttribute('fill', 'yellow');\n    title.setAttribute('font-size', 12 * this.scale);\n    title.setAttribute('font-family', 'monospace');\n    title.setAttribute('font-weight', 'bold');\n    title.textContent = 'Performance';\n    perfGroup.appendChild(title);\n\n    perfEntries.slice(0, 8).forEach((entryText, index) => {\n      const entry = doc.createElementNS('http://www.w3.org/2000/svg', 'text');\n      entry.setAttribute('x', baseX + padding);\n      entry.setAttribute('y', baseY + (30 + index * 15) * this.scale);\n      entry.setAttribute('fill', 'yellow');\n      entry.setAttribute('font-size', 10 * this.scale);\n      entry.setAttribute('font-family', 'monospace');\n      entry.textContent = entryText;\n      perfGroup.appendChild(entry);\n    });\n\n    this.debugLayer.appendChild(perfGroup);\n    this.performanceOverlays.set('perf-info', perfGroup);\n\n    console.log(`[MsdDebugRenderer] Rendered performance overlay with ${perfEntries.length} metrics at scale ${this.scale}`);\n  }\n\n  /**\n   * Connect to AdvancedRenderer's SVG structure\n   * @param {SVGElement} svgElement\n   * @param {Array} viewBox\n   * @param {Object} anchors\n   */\n  integrateWithAdvancedRenderer(svgElement, viewBox, anchors = {}) {\n    if (!svgElement) return;\n    this.ensureDebugLayer(svgElement);\n    this.viewBox = viewBox;\n    this.anchors = anchors;\n  }\n\n  /**\n   * Setup debug layer container group inside the SVG.\n   * @param {SVGElement} svgElement\n   */\n  ensureDebugLayer(svgElement) {\n    if (!svgElement) {\n      console.warn('[MsdDebugRenderer] ensureDebugLayer: no SVG element provided');\n      return;\n    }\n\n    let debugLayer = svgElement.querySelector('#msd-debug-layer');\n    if (!debugLayer) {\n      console.log('[MsdDebugRenderer] Creating new debug layer');\n      const doc = svgElement.ownerDocument;\n      debugLayer = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n      debugLayer.id = 'msd-debug-layer';\n      debugLayer.style.pointerEvents = 'none';\n      debugLayer.style.zIndex = '1000';\n      svgElement.appendChild(debugLayer);\n    } else {\n      console.log('[MsdDebugRenderer] Using existing debug layer');\n    }\n\n    this.debugLayer = debugLayer;\n  }\n\n  /**\n   * Toggle debug visualization on/off.\n   * @param {boolean} enabled\n   * @returns {boolean}\n   */\n  toggle(enabled = !this.enabled) {\n    this.enabled = enabled;\n    if (this.debugLayer) {\n      this.debugLayer.style.display = enabled ? 'block' : 'none';\n    }\n    console.log(`[MsdDebugRenderer] Debug visualization ${enabled ? 'enabled' : 'disabled'}`);\n    return enabled;\n  }\n\n  /**\n   * Toggle a specific debug feature.\n   * @param {string} feature - Feature key\n   * @param {boolean} enabled - Desired state\n   */\n  toggleFeature(feature, enabled) {\n    if (this.features.hasOwnProperty(feature)) {\n      this.features[feature] = enabled;\n      console.log(`[MsdDebugRenderer] Feature '${feature}' ${enabled ? 'enabled' : 'disabled'}`);\n\n      // Optionally re-render (future HUD integration may call up-stream)\n      setTimeout(() => {\n        if (this._lastRenderContext) {\n          const { root, viewBox, opts } = this._lastRenderContext;\n          this.render(root, viewBox, opts);\n        }\n      }, 10);\n    }\n  }\n\n  /**\n   * Get current debug state summary.\n   * @returns {Object}\n   */\n  getDebugState() {\n    return {\n      enabled: this.enabled,\n      features: { ...this.features },\n      hasDebugLayer: Boolean(this.debugLayer),\n      markerCount: this.anchorMarkers.size,\n      boundingBoxCount: this.boundingBoxes.size,\n      routingOverlayCount: this.routingOverlays.size,\n      performanceOverlayCount: this.performanceOverlays.size\n    };\n  }\n\n  /**\n   * Essential cleanup to prevent memory leaks\n   */\n  destroy() {\n    // Unsubscribe from debug manager changes\n    if (this.unsubscribeDebug) {\n      this.unsubscribeDebug();\n      this.unsubscribeDebug = null;\n    }\n\n    // Clear debug layer reference\n    this.debugLayer = null;\n    this._lastRenderContext = null;\n  }\n}\n\n// Keep browser fallback for direct script loading\nif (typeof window !== 'undefined') {\n  window.cblcars = window.cblcars || {};\n  window.cblcars.MsdDebugRenderer = MsdDebugRenderer;\n}","/**\n * Phase 4: Home Assistant card controls renderer\n * Handles HA card embedding with SVG foreignObject positioning for proper scaling\n */\n\nimport { PositionResolver } from '../renderer/PositionResolver.js';\n\nexport class MsdControlsRenderer {\n  constructor(renderer) {\n    this.renderer = renderer;\n    this.controlElements = new Map();\n    this.hass = null;\n    this.lastRenderArgs = null;\n    this._isRendering = false;\n    this._lastSignature = null;\n    if (typeof window !== 'undefined') {\n      window._msdControlsRenderer = this;\n    }\n\n    // DEBUGGING: Log when MsdControlsRenderer is created\n    console.log('[MsdControlsRenderer] Constructor called');\n  }\n\n  setHass(hass) {\n    console.log('[MsdControlsRenderer] setHass called with:', {\n      hasHass: !!hass,\n      entityCount: hass?.states ? Object.keys(hass.states).length : 0,\n      hasLightDesk: !!hass?.states?.['light.desk'],\n      lightDeskState: hass?.states?.['light.desk']?.state,\n      previousHass: !!this.hass,\n      controlElementsCount: this.controlElements.size\n    });\n\n    this.hass = hass;\n\n    // ADDED: Immediately update all existing control cards with new HASS context\n    if (this.controlElements.size > 0) {\n      console.log('[MsdControlsRenderer] Updating HASS context for', this.controlElements.size, 'control cards');\n      this._updateAllControlsHass(hass);\n    } else {\n      console.log('[MsdControlsRenderer] No control elements to update');\n\n      // Try to find and update any CB-LCARS cards that might exist but aren't tracked\n      //this._updateUnmanagedCards(hass);\n    }\n  }\n\n  // DEBUGGING: Try to update cards that exist but aren't managed by us\n  /*\n  _updateUnmanagedCards(hass) {\n    console.log('[MsdControlsRenderer] Looking for unmanaged CB-LCARS cards to update');\n\n    const unmanagedCards = document.querySelectorAll('cb-lcars-button-card, [data-card-type*=\"cb-lcars\"]');\n    console.log(`[MsdControlsRenderer] Found ${unmanagedCards.length} unmanaged cards`);\n\n    unmanagedCards.forEach((card, index) => {\n      try {\n        const entity = card._config?.entity || card.entity;\n        const currentState = card.hass?.states?.[entity]?.state;\n        const newState = hass?.states?.[entity]?.state;\n\n        console.log(`[MsdControlsRenderer] Unmanaged card ${index}:`, {\n          entity,\n          currentState,\n          newState,\n          stateChanged: currentState !== newState\n        });\n\n        this._applyHassToCard(card, hass, `unmanaged-${index}`);\n      } catch (e) {\n        console.warn(`[MsdControlsRenderer] Failed to update unmanaged card ${index}:`, e);\n      }\n    });\n  }\n  */\n\n  // ADDED: Update HASS context for all existing control cards\n  _updateAllControlsHass(hass) {\n    console.log(`[MsdControlsRenderer] Updating HASS for ${this.controlElements.size} control cards`);\n\n    for (const [overlayId, wrapperElement] of this.controlElements) {\n      try {\n        // Find the actual card element inside the wrapper\n        const cardElement = wrapperElement.querySelector('[class*=\"card\"], [data-card-type], cb-lcars-button-card, hui-light-card') ||\n                           wrapperElement.firstElementChild;\n\n        if (cardElement) {\n          this._applyHassToCard(cardElement, hass, overlayId);\n        }\n      } catch (error) {\n        console.warn('[MsdControlsRenderer] Failed to update HASS for control:', overlayId, error);\n      }\n    }\n  }\n\n\n  /**\n   * Apply HASS context to a specific control card\n   * @private\n   * @param {Element} card - The card element\n   * @param {Object} hass - Home Assistant object\n   * @param {string} controlId - Control identifier for logging\n   */\n  _applyHassToCard(card, hass, controlId) {\n      console.log(`[MsdControlsRenderer] Updating HASS for ${controlId}:`, {\n          tagName: card.tagName,\n          isCustomButtonCard: card.tagName.toLowerCase().includes('button-card'),\n          hasConfig: !!card._config,\n          hasSetConfig: typeof card.setConfig === 'function',\n          currentHass: !!card.hass,\n          hasSetHass: typeof card.setHass === 'function',\n          entity: card._config?.entity || 'none'\n      });\n\n      try {\n          const tagName = card.tagName ? card.tagName.toLowerCase() : '';\n\n          // FIXED: Only CB-LCARS cards use property assignment\n          const isCBLCARSCard = tagName.includes('cb-lcars');\n          const isStandardHACard = tagName.includes('hui-') || (tagName.includes('button-card') && !tagName.includes('cb-lcars'));\n\n          if (isCBLCARSCard) {\n              console.log(`[MsdControlsRenderer] Using property assignment for CB-LCARS card: ${controlId}`);\n\n              // Store old HASS for change detection\n              const oldHass = card.hass;\n\n              // CRITICAL: Update _stateObj BEFORE setting HASS to ensure proper state synchronization\n              if (card._config?.entity && hass.states?.[card._config.entity]) {\n                  const newStateObj = hass.states[card._config.entity];\n                  console.log(`[MsdControlsRenderer] Updating _stateObj for ${controlId} entity: ${card._config.entity}`, {\n                      oldState: card._stateObj?.state,\n                      newState: newStateObj?.state,\n                      stateChanged: card._stateObj?.state !== newStateObj?.state\n                  });\n                  card._stateObj = newStateObj;\n              }\n\n              // Use PROPERTY ASSIGNMENT (not method call) to trigger LitElement reactivity\n              card.hass = hass;\n              card._hass = hass;  // Also set internal property for compatibility\n\n              // Trigger LitElement's reactive property system\n              if (typeof card.requestUpdate === 'function') {\n                  console.log(`[MsdControlsRenderer] Triggering LitElement property update for ${controlId}`);\n                  card.requestUpdate('hass', oldHass);\n                  card.requestUpdate('_hass', oldHass);\n\n                  // Also trigger update for state object changes\n                  if (card._config?.entity) {\n                      card.requestUpdate('_stateObj');\n                  }\n              }\n          } else if (isStandardHACard) {\n              console.log(`[MsdControlsRenderer] Using setHass() method for standard HA card: ${controlId}`);\n\n              // Standard HA cards: Use setHass method (their preferred approach)\n              if (card.setHass && typeof card.setHass === 'function') {\n                  card.setHass(hass);\n              } else {\n                  console.warn(`[MsdControlsRenderer] Standard HA card ${controlId} has no setHass method`);\n\n                  // Fallback: property assignment\n                  const oldHass = card.hass;\n                  card.hass = hass;\n                  card._hass = hass;\n\n                  if (typeof card.requestUpdate === 'function') {\n                      card.requestUpdate('hass', oldHass);\n                  }\n              }\n          } else {\n              console.log(`[MsdControlsRenderer] Using fallback approach for unknown card type: ${controlId}`);\n\n              // Unknown card type: Try setHass first, then property assignment\n              if (card.setHass && typeof card.setHass === 'function') {\n                  card.setHass(hass);\n              } else {\n                  const oldHass = card.hass;\n                  card.hass = hass;\n                  card._hass = hass;\n\n                  if (typeof card.requestUpdate === 'function') {\n                      card.requestUpdate('hass', oldHass);\n                  }\n              }\n          }          return true;\n\n      } catch (error) {\n          console.error(`[MsdControlsRenderer] ❌ Failed to update HASS for ${controlId}:`, error);\n          return false;\n      }\n  }\n\n\n  async renderControls(controlOverlays, resolvedModel) {\n    // ADDED: More comprehensive safety checks\n    if (this._isRendering) {\n      console.log('[MsdControlsRenderer] renderControls skipped (in progress)');\n      return;\n    }\n\n    if (!controlOverlays?.length) {\n      console.log('[MsdControlsRenderer] No control overlays to render');\n      return;\n    }\n\n    // ADDED: Validate resolved model\n    if (!resolvedModel) {\n      console.error('[MsdControlsRenderer] No resolved model provided');\n      return;\n    }\n\n    // ADDED: Validate DOM environment\n    if (typeof document === 'undefined') {\n      console.error('[MsdControlsRenderer] Document not available');\n      return;\n    }\n\n    const signature = controlOverlays.map(o => o.id).sort().join('|');\n    if (\n      this._lastSignature === signature &&\n      this.controlElements.size === controlOverlays.length\n    ) {\n      console.log('[MsdControlsRenderer] renderControls skipped (unchanged signature)', signature);\n      return;\n    }\n\n    this._isRendering = true;\n    try {\n      console.log('[MsdControlsRenderer] renderControls called', {\n        count: controlOverlays.length,\n        ids: controlOverlays.map(o => o.id),\n        signature,\n        hasHass: !!this.hass\n      });\n\n      // STEP 1: Ensure SVG container exists and clear existing controls\n      const svgContainer = this.getSvgControlsContainer();\n      if (!svgContainer) {\n        console.error('[MsdControlsRenderer] No SVG container available; abort render');\n        return;\n      }\n\n      console.log('[MsdControlsRenderer] SVG container found, clearing existing controls');\n      svgContainer.innerHTML = '';\n      this.controlElements.clear();\n\n      // ADDED: Render controls with individual error handling\n      for (const overlay of controlOverlays) {\n        try {\n          await this.renderControlOverlay(overlay, resolvedModel);\n        } catch (overlayError) {\n          console.error(`[MsdControlsRenderer] Failed to render control overlay ${overlay.id}:`, overlayError);\n          // Continue with other overlays\n        }\n      }\n\n      this.lastRenderArgs = { controlOverlays, resolvedModel };\n      this._lastSignature = signature;\n\n      console.log('[MsdControlsRenderer] renderControls completed successfully');\n\n    } catch (error) {\n      console.error('[MsdControlsRenderer] renderControls failed:', error);\n      throw error; // Re-throw so caller knows it failed\n    } finally {\n      this._isRendering = false;\n    }\n  }\n\n  async renderControlOverlay(overlay, resolvedModel) {\n    // Remove any existing foreignObject for this overlay\n    const existingForeignObject = document.querySelector(`#msd-control-foreign-${overlay.id}`);\n    if (existingForeignObject) {\n      console.log('[MsdControlsRenderer] Existing foreignObject found for', overlay.id, '- removing to avoid duplicates');\n      try { existingForeignObject.remove(); } catch(_) {}\n    }\n\n    // If we somehow already have a control element instance registered, drop it (fresh rebuild model)\n    if (this.controlElements.has(overlay.id)) {\n      this.controlElements.delete(overlay.id);\n    }\n\n    console.log('[MsdControlsRenderer] Creating control overlay', overlay.id);\n    const controlElement = await this.createControlElement(overlay);\n    if (!controlElement) return;\n\n    this.positionControlElement(controlElement, overlay, resolvedModel);\n    this.controlElements.set(overlay.id, controlElement);\n  }\n\n  // ADDED: recover original card definition even if pipeline stripped it\n  resolveCardDefinition(overlay) {\n    if (overlay.card) return overlay.card;\n    if (overlay.card_config) return overlay.card_config;\n    if (overlay.cardConfig) return overlay.cardConfig;\n    if (overlay._card) return overlay._card;\n    if (overlay.meta?.card) return overlay.meta.card;\n    if (overlay.extension?.card) return overlay.extension.card;\n\n    // Build raw overlay index once from global cache if available\n    if (!this._rawOverlayIndex) {\n      const raw = (window && window._msdRawOverlays) ? window._msdRawOverlays : [];\n      this._rawOverlayIndex = new Map(raw.map(o => [o.id, o]));\n    }\n    const rawEntry = this._rawOverlayIndex?.get(overlay.id);\n    if (rawEntry?.card) return rawEntry.card;\n\n    return null;\n  }\n\n  // ADDED: Build the final config object passed to setConfig\n  /* TO BE REMOVED - no longer needed\n  buildCardConfig(cardObj) {\n    if (!cardObj) return null;\n    // If nested config key provided, that is authoritative\n    if (cardObj.config && typeof cardObj.config === 'object') {\n      return { ...cardObj.config }; // shallow clone\n    }\n    // Otherwise treat the card object (minus wrapper-only keys) as config\n    const { type, config, ...rest } = cardObj;\n    // Include type too (some built-in cards ignore, harmless if present)\n    return { type, ...rest };\n  }\n  */\n\n  // ADDED: Normalize card type to handle HA built-in cards\n  _normalizeCardType(cardType) {\n    if (!cardType) return null;\n\n    // Handle custom cards\n    if (cardType.startsWith('custom:')) {\n      return cardType.slice(7); // Remove 'custom:' prefix\n    }\n\n    // ADDED: Map HA built-in card types to their actual element names\n    const builtInCardMap = {\n      'button': 'hui-button-card',\n      'light': 'hui-light-card',\n      'switch': 'hui-switch-card',\n      'sensor': 'hui-sensor-card',\n      'binary-sensor': 'hui-binary-sensor-card',\n      'cover': 'hui-cover-card',\n      'fan': 'hui-fan-card',\n      'climate': 'hui-climate-card',\n      'thermostat': 'hui-thermostat-card',\n      'media-player': 'hui-media-control-card',\n      'alarm-panel': 'hui-alarm-panel-card',\n      'input-number': 'hui-input-number-card',\n      'input-select': 'hui-input-select-card',\n      'input-text': 'hui-input-text-card',\n      'lock': 'hui-lock-card',\n      'vacuum': 'hui-vacuum-card',\n      'water-heater': 'hui-water-heater-card',\n      'weather': 'hui-weather-forecast-card'\n    };\n\n    return builtInCardMap[cardType] || cardType;\n  }\n\n  // ADDED: normalize card type to an actual custom element tag name\n  /* TO BE REMOVED - no longer needed\n  normalizeCardTag(cardType) {\n    if (!cardType) return null;\n    if (cardType.startsWith('custom:')) return cardType.slice(7); // HA style -> real tag\n    return cardType;\n  }\n  */\n\n  // ADDED: schedule retries for setConfig / hass once element upgrades\n  /* TO BE REMOVED - no longer needed\n  _scheduleDeferredConfig(cardElement, finalConfig, overlayId, attempt = 0) {\n    if (!finalConfig) return;\n    const maxAttempts = 8;\n    if (typeof cardElement.setConfig === 'function') {\n      try {\n        cardElement.setConfig(finalConfig);\n        cardElement._config = finalConfig;\n        if (this.hass) {\n          try { cardElement.hass = this.hass; } catch { cardElement._hass = this.hass; }\n        }\n        console.debug('[MSD Controls] Deferred setConfig applied', overlayId, { attempt });\n      } catch (e) {\n        console.warn('[MSD Controls] Deferred setConfig failed', overlayId, e);\n      }\n      return;\n    }\n    if (attempt >= maxAttempts) {\n      console.warn('[MSD Controls] Gave up waiting for setConfig', overlayId);\n      return;\n    }\n    const delay = 150 * (attempt + 1);\n    setTimeout(() => this._scheduleDeferredConfig(cardElement, finalConfig, overlayId, attempt + 1), delay);\n  }\n    */\n\n  async createControlElement(overlay) {\n    const cardDef = this.resolveCardDefinition(overlay);\n    if (!cardDef) {\n      console.warn('[MsdControlsRenderer] No card definition found for control overlay', overlay.id);\n      return null;\n    }\n\n    try {\n      // Browser environment - Fixed card creation and configuration\n      const cardType = cardDef.type;\n      let cardElement = null;\n\n      // FIXED: Use the new normalization method\n      const normalizedCardType = this._normalizeCardType(cardType);\n\n      console.log('[MsdControls] Creating card element:', {\n        originalType: cardType,\n        normalizedType: normalizedCardType,\n        overlayId: overlay.id\n      });\n\n      // ADDED: Special handling for HA built-in cards\n      if (normalizedCardType.startsWith('hui-')) {\n        cardElement = await this._createHomeAssistantCard(normalizedCardType, cardDef, overlay);\n      } else {\n        // Handle custom cards with existing logic\n        cardElement = await this._createCustomCard(normalizedCardType, cardDef, overlay);\n      }\n\n      // Fallback: Create a placeholder\n      if (!cardElement) {\n        console.warn(`Could not create card element for type: ${cardType}, creating fallback`);\n        cardElement = this._createFallbackCard(cardType, cardDef);\n      }\n\n      // FIXED: Apply HASS context BEFORE configuration\n      console.log('[MsdControls] Applying HASS and config:', {\n        overlayId: overlay.id,\n        hasHass: !!this.hass,\n        hasSetConfig: typeof cardElement.setConfig === 'function'\n      });\n\n      // Apply HASS context first\n      if (this.hass) {\n        await this._applyHassContext(cardElement, overlay.id);\n      }\n\n      // Then apply configuration\n      await this._configureCard(cardElement, cardDef, overlay);\n\n      // Create wrapper for positioning\n      const wrapper = document.createElement('div');\n      wrapper.className = 'msd-control-wrapper';\n      wrapper.dataset.msdControlId = overlay.id;\n      wrapper.style.position = 'absolute';\n      wrapper.style.pointerEvents = 'auto';\n      wrapper.style.touchAction = 'manipulation'; // ADDED: Better touch handling\n      wrapper.appendChild(cardElement);\n\n      // Event isolation\n      this._setupEventIsolation(wrapper, cardElement, overlay);\n\n      return wrapper;\n\n    } catch (error) {\n      console.error(`[MSD Controls] Failed to create card ${cardDef?.type}:`, error);\n      return this._createFallbackCard(cardDef?.type || 'unknown', cardDef);\n    }\n  }\n\n  // ADDED: Create Home Assistant built-in cards\n  async _createHomeAssistantCard(normalizedCardType, cardDef, overlay) {\n    console.log('[MsdControls] Creating HA built-in card:', normalizedCardType);\n\n    try {\n      // Wait for Home Assistant's card registry to be available\n      if (!window.customCards && !document.querySelector('home-assistant')) {\n        console.warn('[MsdControls] Home Assistant not fully loaded yet');\n        return null;\n      }\n\n      // Try to get the card constructor from HA's registry\n      let cardElement = null;\n\n      // Strategy 1: Use HA's card creation helper if available\n      if (window.customElements && window.customElements.get(normalizedCardType)) {\n        const CardClass = window.customElements.get(normalizedCardType);\n        cardElement = new CardClass();\n      } else {\n        // Strategy 2: Create via document and wait for upgrade\n        cardElement = document.createElement(normalizedCardType);\n        await this._waitForElementUpgrade(cardElement, 3000);\n      }\n\n      // ADDED: HA cards need different configuration approach\n      if (cardElement && typeof cardElement.setConfig !== 'function') {\n        // Some HA cards expose setConfig later or via different mechanism\n        console.log('[MsdControls] HA card created but setConfig not available, trying alternative approach');\n\n        // Wait a bit more for HA card to fully initialize\n        await new Promise(resolve => setTimeout(resolve, 500));\n\n        if (typeof cardElement.setConfig !== 'function') {\n          console.warn('[MsdControls] HA card does not have setConfig method:', normalizedCardType);\n          return null;\n        }\n      }\n\n      return cardElement;\n\n    } catch (error) {\n      console.warn('[MsdControls] HA card creation failed:', error);\n      return null;\n    }\n  }\n\n  // ADDED: Create custom cards (extracted from existing logic)\n  async _createCustomCard(normalizedCardType, cardDef, overlay) {\n    console.log('[MsdControls] Starting custom card creation strategies for:', normalizedCardType);\n    let cardElement = null;\n\n    // Strategy 1: Try direct custom element creation\n    console.log('[MsdControls] Strategy 1: Attempting direct custom element creation for:', normalizedCardType);\n    if (window.customElements && typeof window.customElements.get === 'function') {\n      try {\n        const CardClass = window.customElements.get(normalizedCardType);\n        if (CardClass) {\n          cardElement = new CardClass();\n          console.log('[MsdControls] ✅ Strategy 1 SUCCESS: Created via constructor:', normalizedCardType);\n        } else {\n          console.log('[MsdControls] ❌ Strategy 1 FAILED: No custom element found for:', normalizedCardType);\n        }\n      } catch (e) {\n        console.log('[MsdControls] ❌ Strategy 1 FAILED: Constructor error for', normalizedCardType, ':', e.message);\n      }\n    } else {\n      console.log('[MsdControls] ❌ Strategy 1 SKIPPED: customElements not available');\n    }\n\n    // Strategy 2: Try document.createElement with normalized type\n    if (!cardElement) {\n      console.log('[MsdControls] Strategy 2: Attempting createElement with upgrade for:', normalizedCardType);\n      try {\n        cardElement = document.createElement(normalizedCardType);\n\n        // Check if this is actually a custom element (not a generic div)\n        if (cardElement.tagName.toLowerCase() === normalizedCardType.toLowerCase()) {\n          console.log('[MsdControls] Strategy 2: Created element, waiting for upgrade:', normalizedCardType);\n          // Wait for potential custom element upgrade\n          await this._waitForElementUpgrade(cardElement);\n\n          if (typeof cardElement.setConfig === 'function') {\n            console.log('[MsdControls] ✅ Strategy 2 SUCCESS: Created via createElement with upgrade:', normalizedCardType);\n          } else {\n            console.log('[MsdControls] ❌ Strategy 2 FAILED: Element created but no setConfig after upgrade:', normalizedCardType);\n            cardElement = null;\n          }\n        } else {\n          console.log('[MsdControls] ❌ Strategy 2 FAILED: Generic element created, not custom card:', normalizedCardType);\n          // Generic element created, not the custom card\n          cardElement = null;\n        }\n      } catch (e) {\n        console.log('[MsdControls] ❌ Strategy 2 FAILED: createElement error for', normalizedCardType, ':', e.message);\n      }\n    }\n\n    // Strategy 3: Try creating in document body first (some cards need to be in DOM)\n    if (!cardElement) {\n      console.log('[MsdControls] Strategy 3: Attempting body attachment technique for:', normalizedCardType);\n      try {\n        cardElement = document.createElement(normalizedCardType);\n        // Temporarily attach to body to trigger upgrade\n        const tempParent = document.createElement('div');\n        tempParent.style.position = 'absolute';\n        tempParent.style.left = '-10000px';\n        document.body.appendChild(tempParent);\n        tempParent.appendChild(cardElement);\n\n        console.log('[MsdControls] Strategy 3: Element attached to body, waiting for upgrade:', normalizedCardType);\n        // Wait for upgrade\n        await this._waitForElementUpgrade(cardElement, 5000);\n\n        // Remove from temp parent\n        cardElement.remove();\n        tempParent.remove();\n\n        if (typeof cardElement.setConfig === 'function') {\n          console.log('[MsdControls] ✅ Strategy 3 SUCCESS: Created via body attachment:', normalizedCardType);\n        } else {\n          console.log('[MsdControls] ❌ Strategy 3 FAILED: Body attachment did not result in working card:', normalizedCardType);\n          cardElement = null;\n        }\n      } catch (e) {\n        console.log('[MsdControls] ❌ Strategy 3 FAILED: Body attachment error for', normalizedCardType, ':', e.message);\n      }\n    }\n\n    if (cardElement) {\n      console.log('[MsdControls] 🎉 Custom card creation SUCCESSFUL for:', normalizedCardType);\n    } else {\n      console.log('[MsdControls] 💥 ALL STRATEGIES FAILED for:', normalizedCardType);\n    }\n\n    return cardElement;\n  }\n\n  /**\n   * Wait for custom element to be fully upgraded\n   */\n  async _waitForElementUpgrade(element, maxWait = 5000) {\n    const startTime = Date.now();\n\n    console.log('[MsdControls] Waiting for element upgrade:', {\n      tagName: element.tagName,\n      hasSetConfig: typeof element.setConfig === 'function'\n    });\n\n    while (Date.now() - startTime < maxWait) {\n      // Check if element has been upgraded (has setConfig method)\n      if (typeof element.setConfig === 'function') {\n        console.log('[MsdControls] Element upgraded successfully:', element.tagName);\n        return element;\n      }\n\n      // Check if element has upgrade promise\n      if (element.updateComplete) {\n        try {\n          await element.updateComplete;\n          if (typeof element.setConfig === 'function') {\n            console.log('[MsdControls] Element upgraded via updateComplete:', element.tagName);\n            return element;\n          }\n        } catch (e) {\n          // Ignore update errors\n        }\n      }\n\n      // Force upgrade attempt\n      if (window.customElements && window.customElements.upgrade) {\n        try {\n          window.customElements.upgrade(element);\n        } catch (e) {\n          // Ignore upgrade errors\n        }\n      }\n\n      // Short wait before next check\n      await new Promise(resolve => setTimeout(resolve, 100));\n    }\n\n    console.warn('[MsdControls] Element upgrade timeout:', {\n      tagName: element.tagName,\n      hasSetConfig: typeof element.setConfig === 'function',\n      waitTime: Date.now() - startTime\n    });\n\n    return element;\n  }\n\n  /**\n   * Configure the card with config and HASS context\n   */\n  async _configureCard(cardElement, cardDef, overlay) {\n    // Build the final configuration\n    const config = this._buildCardConfig(cardDef);\n\n    console.log('[MsdControls] Configuring card:', {\n      overlayId: overlay.id,\n      cardType: cardDef.type,\n      hasSetConfig: typeof cardElement.setConfig === 'function',\n      hasHass: !!this.hass,\n      config: config\n    });\n\n    // Apply configuration with retries\n    if (config) {\n      const success = await this._applyCardConfig(cardElement, config, overlay.id);\n      if (!success) {\n        // Try one more time after a longer delay\n        setTimeout(async () => {\n          console.log('[MsdControls] Retrying config application after delay:', overlay.id);\n          await this._applyCardConfig(cardElement, config, overlay.id);\n        }, 1000);\n      }\n    }\n\n    // Force update if possible\n    if (typeof cardElement.requestUpdate === 'function') {\n      try {\n        await cardElement.requestUpdate();\n        console.log('[MsdControls] Requested update for:', overlay.id);\n      } catch (e) {\n        console.debug('[MsdControls] requestUpdate failed:', e);\n      }\n    }\n\n    // ENHANCED: Additional update strategies for different card types\n    if (cardElement.tagName) {\n      const tagName = cardElement.tagName.toLowerCase();\n      const isCustomButtonCard = tagName.includes('cb-lcars') ||\n                                 tagName.includes('button-card') ||\n                                 cardElement._isCustomButtonCard ||\n                                 cardElement.constructor?.name?.includes('Button');\n\n      if (isCustomButtonCard) {\n        // CB-LCARS and custom-button-card specific updates\n        console.log(`[MsdControls] Setting up custom-button-card updates for:`, overlay.id);\n\n        setTimeout(() => {\n          try {\n            // Ensure HASS is set\n            if (this.hass) {\n              cardElement.hass = this.hass;\n              cardElement._hass = this.hass;\n            }\n\n            // Force full re-evaluation to trigger state-based styling\n            if (cardElement._config && typeof cardElement.setConfig === 'function') {\n              const currentConfig = { ...cardElement._config };\n              cardElement.setConfig(currentConfig);\n\n              // Re-apply HASS after config\n              if (this.hass) {\n                cardElement.hass = this.hass;\n              }\n            }\n\n            // LitElement update if available\n            if (typeof cardElement.requestUpdate === 'function') {\n              cardElement.requestUpdate();\n            }\n\n            console.debug('[MsdControls] ✅ Custom-button-card initial update completed for:', overlay.id);\n\n          } catch (e) {\n            console.debug('[MsdControls] Custom-button-card specific update failed:', e);\n          }\n        }, 100);\n\n      } else if (tagName.startsWith('hui-')) {\n        // Home Assistant built-in card updates\n        setTimeout(() => {\n          try {\n            if (typeof cardElement.requestUpdate === 'function') {\n              cardElement.requestUpdate();\n            }\n            // Force state update\n            if (this.hass) {\n              cardElement.hass = this.hass;\n            }\n          } catch (e) {\n            console.debug('[MsdControls] HA card specific update failed:', e);\n          }\n        }, 200);\n      }\n    }\n  }\n\n  /**\n   * Build card configuration from card definition\n   */\n  _buildCardConfig(cardDef) {\n    if (!cardDef) return null;\n\n    let finalConfig;\n\n    // Handle nested config structure: { type: \"light\", config: { entity: \"light.example\" } }\n    if (cardDef.config && typeof cardDef.config === 'object') {\n      finalConfig = {\n        type: cardDef.type,\n        ...cardDef.config\n      };\n    } else {\n      // Handle flat structure: { type: \"light\", entity: \"light.example\", name: \"My Light\" }\n      const { type, config, card, card_config, cardConfig, ...otherProps } = cardDef;\n      finalConfig = {\n        type,\n        ...otherProps\n      };\n    }\n\n    // FIXED: More precise detection for CB-LCARS and custom-button-card based cards\n    const cardType = finalConfig.type;\n    const isCustomButtonCard = cardType === 'custom:cb-lcars-button-card' ||\n                               cardType === 'cb-lcars-button-card' ||\n                               cardType === 'custom:button-card' ||\n                               cardType === 'button-card';\n\n    // Do NOT treat regular HA built-in cards as custom-button-cards\n    const isBuiltInCard = cardType === 'button' || cardType === 'light' || cardType === 'switch' ||\n                          cardType.startsWith('hui-');\n\n    if (isCustomButtonCard && !isBuiltInCard && finalConfig.entity) {\n      console.log(`[MsdControlsRenderer] Adding triggers_update for CB-LCARS card with entity: ${finalConfig.entity}`);\n\n      // Ensure triggers_update includes the entity\n      if (isCustomButtonCard && !isBuiltInCard) {\n        console.log(`[MsdControlsRenderer] Setting triggers_update to 'all' for CB-LCARS card: ${finalConfig.entity}`);\n\n        // FIXED: Use 'all' so the card sees ALL HASS updates, not just specific entities\n        finalConfig.triggers_update = 'all';\n\n        console.log(`[MsdControlsRenderer] CB-LCARS card configured with triggers_update: 'all'`);\n      }\n\n      console.log(`[MsdControlsRenderer] CB-LCARS card configured with triggers_update:`, finalConfig.triggers_update);\n    } else if (isBuiltInCard) {\n      console.log(`[MsdControlsRenderer] Skipping triggers_update for built-in HA card: ${cardType}`);\n    }    // Mark as MSD-generated\n    finalConfig._msdGenerated = true;\n\n    return finalConfig;\n  }\n\n  /**\n   * Apply HASS context to card element with multiple strategies\n   */\n  async _applyHassContext(cardElement, overlayId) {\n    if (!this.hass) {\n      console.warn('[MsdControls] No HASS context available for:', overlayId);\n      return false;\n    }\n\n    console.log('[MsdControls] Starting HASS application strategies for:', overlayId);\n\n    const strategies = [\n      // Strategy 1: Direct property assignment\n      () => {\n        console.log('[MsdControls] HASS Strategy 1: Attempting direct property assignment for:', overlayId);\n        try {\n          cardElement.hass = this.hass;\n          const success = cardElement.hass === this.hass;\n          if (success) {\n            console.log('[MsdControls] ✅ HASS Strategy 1 SUCCESS: Direct property assignment for:', overlayId);\n          } else {\n            console.log('[MsdControls] ❌ HASS Strategy 1 FAILED: Property assignment did not stick for:', overlayId);\n          }\n          return success;\n        } catch (e) {\n          console.log('[MsdControls] ❌ HASS Strategy 1 FAILED: Property assignment error for', overlayId, ':', e.message);\n          return false;\n        }\n      },\n\n      // Strategy 2: Use property descriptor\n      () => {\n        console.log('[MsdControls] HASS Strategy 2: Attempting property descriptor for:', overlayId);\n        try {\n          Object.defineProperty(cardElement, 'hass', {\n            value: this.hass,\n            writable: true,\n            configurable: true\n          });\n          console.log('[MsdControls] ✅ HASS Strategy 2 SUCCESS: Property descriptor applied for:', overlayId);\n          return true;\n        } catch (e) {\n          console.log('[MsdControls] ❌ HASS Strategy 2 FAILED: Property descriptor error for', overlayId, ':', e.message);\n          return false;\n        }\n      },\n\n      // Strategy 3: Store in private property for later access\n      () => {\n        console.log('[MsdControls] HASS Strategy 3: Attempting private property fallback for:', overlayId);\n        try {\n          cardElement._hass = this.hass;\n          // Also try setting via property if it exists\n          if ('hass' in cardElement) {\n            cardElement.hass = this.hass;\n            console.log('[MsdControls] HASS Strategy 3: Also set public hass property for:', overlayId);\n          }\n          console.log('[MsdControls] ✅ HASS Strategy 3 SUCCESS: Private property fallback for:', overlayId);\n          return true;\n        } catch (e) {\n          console.log('[MsdControls] ❌ HASS Strategy 3 FAILED: Private property error for', overlayId, ':', e.message);\n          return false;\n        }\n      }\n    ];\n\n    for (const [index, strategy] of strategies.entries()) {\n      if (strategy()) {\n        console.log(`[MsdControls] 🎉 HASS application SUCCESSFUL via strategy ${index + 1} for:`, overlayId);\n        return true;\n      }\n    }\n\n    console.log('[MsdControls] 💥 ALL HASS STRATEGIES FAILED for:', overlayId);\n    return false;\n  }\n\n  /**\n   * Apply card configuration with retry logic\n   */\n  async _applyCardConfig(cardElement, config, overlayId) {\n    if (!config) return false;\n\n    console.log('[MsdControls] Applying config:', {\n      overlayId: overlayId,\n      hasSetConfig: typeof cardElement.setConfig === 'function',\n      cardType: config.type,\n      entity: config.entity,\n      triggersUpdate: config.triggers_update,\n      config: config\n    });\n\n    const maxRetries = 8; // Increased retries\n\n    for (let attempt = 0; attempt < maxRetries; attempt++) {\n      try {\n        if (typeof cardElement.setConfig === 'function') {\n          cardElement.setConfig(config);\n          cardElement._config = config;\n\n          // ADDED: Verify the config was applied correctly\n          if (cardElement._config && cardElement._config.triggers_update) {\n            console.log(`[MsdControls] ✅ Config applied with triggers_update:${cardElement._config.triggers_update} for:`, overlayId);\n          } else {\n            console.warn(`[MsdControls] ⚠️ Config applied but no triggers_update found for:`, overlayId);\n          }\n\n          console.log(`[MsdControls] ✅ Config applied on attempt ${attempt + 1} for:`, overlayId);\n          return true;\n        }\n\n        // If setConfig not available yet, wait and retry\n        if (attempt < maxRetries - 1) {\n          const delay = 200 * (attempt + 1); // Increased delay\n          console.log(`[MsdControls] Retrying config in ${delay}ms for:`, overlayId);\n          await new Promise(resolve => setTimeout(resolve, delay));\n        }\n\n      } catch (e) {\n        console.warn(`[MsdControls] setConfig attempt ${attempt + 1} failed for ${overlayId}:`, e);\n\n        if (attempt < maxRetries - 1) {\n          await new Promise(resolve => setTimeout(resolve, 200 * (attempt + 1)));\n        }\n      }\n    }\n\n    // Store config for later application\n    cardElement._pendingConfig = config;\n    console.warn('[MsdControls] ❌ Config stored for deferred application:', overlayId);\n\n    // Set up a periodic retry\n    const retryInterval = setInterval(() => {\n      if (typeof cardElement.setConfig === 'function') {\n        try {\n          cardElement.setConfig(config);\n          cardElement._config = config;\n          console.log('[MsdControls] ✅ Deferred config finally applied:', overlayId);\n          clearInterval(retryInterval);\n        } catch (e) {\n          console.warn('[MsdControls] Deferred config retry failed:', overlayId, e);\n        }\n      }\n    }, 1000);\n\n    // Clear interval after 10 seconds\n    setTimeout(() => clearInterval(retryInterval), 10000);\n\n    return false;\n  }\n\n  /**\n   * Create fallback card when creation fails\n   */\n  _createFallbackCard(cardType, cardDef) {\n    const fallback = document.createElement('div');\n    fallback.className = 'msd-control-fallback';\n\n    Object.assign(fallback.style, {\n      border: '2px dashed var(--primary-color, #ffa500)',\n      borderRadius: '8px',\n      padding: '16px',\n      background: 'var(--card-background-color, rgba(0,0,0,0.8))',\n      color: 'var(--primary-text-color, #ffffff)',\n      fontSize: '14px',\n      textAlign: 'center',\n      display: 'flex',\n      flexDirection: 'column',\n      justifyContent: 'center',\n      alignItems: 'center',\n      minHeight: '80px'\n    });\n\n    const title = document.createElement('div');\n    title.textContent = `Card: ${cardType}`;\n    title.style.fontWeight = 'bold';\n    title.style.marginBottom = '8px';\n\n    const subtitle = document.createElement('div');\n    subtitle.textContent = '(Card failed to load)';\n    subtitle.style.fontSize = '12px';\n    subtitle.style.opacity = '0.7';\n\n    fallback.appendChild(title);\n    fallback.appendChild(subtitle);\n\n    // Make it interactive for debugging\n    fallback.addEventListener('click', () => {\n      console.log('[MsdControls] Fallback card clicked:', { cardType, cardDef });\n    });\n\n    return fallback;\n  }\n\n  /**\n   * Setup event isolation for control interactions\n   */\n  _setupEventIsolation(wrapper, cardElement, overlay) {\n    // FIXED: Less aggressive event isolation - allow events to reach card, but prevent bubbling to MSD\n    const events = [\n      'click', 'dblclick', 'contextmenu',\n      'pointerdown', 'pointerup', 'pointermove', 'pointercancel',\n      'touchstart', 'touchend', 'touchmove', 'touchcancel',\n      'mousedown', 'mouseup', 'mousemove', 'mouseenter', 'mouseleave',\n      'focus', 'blur', 'focusin', 'focusout',\n      'keydown', 'keyup', 'keypress'\n    ];\n\n    events.forEach(eventType => {\n      wrapper.addEventListener(eventType, (event) => {\n        // FIXED: Only stop propagation if the event originated from our card\n        // This prevents MSD from handling card events, but allows the card to work\n        if (event.target === cardElement || cardElement.contains(event.target)) {\n          // Allow the event to proceed to the card normally\n          // Only stop it from bubbling further up to MSD\n          event.stopPropagation();\n          /*\n          console.debug('[MsdControls] Event allowed to card but prevented from bubbling:', {\n            type: event.type,\n            overlayId: overlay.id,\n            target: event.target.tagName,\n            cardType: cardElement?.tagName\n          });\n          */\n        }\n      }, {\n        capture: false,  // CHANGED: Use bubble phase so card gets events first\n        passive: false   // Allow preventDefault if needed\n      });\n    });\n\n    // ADDED: Set higher z-index and pointer events\n    wrapper.style.pointerEvents = 'auto';\n    wrapper.style.position = 'absolute';\n    wrapper.style.zIndex = '1000'; // Ensure it's above other layers\n    wrapper.setAttribute('tabindex', '0');\n\n    // ADDED: Ensure the card element itself can receive events\n    if (cardElement) {\n      cardElement.style.pointerEvents = 'auto';\n      cardElement.style.position = 'relative';\n      cardElement.style.zIndex = '1';\n\n      // ADDED: Ensure card can receive all necessary events for hold actions\n      cardElement.style.touchAction = 'manipulation'; // Improves touch responsiveness\n    }\n  }\n\n  positionControlElement(element, overlay, resolvedModel) {\n    const position = this.resolvePosition(overlay.position, resolvedModel);\n    const size = this.resolveSize(overlay.size, resolvedModel);\n\n    if (!position || !size) {\n      console.warn('[MSD Controls] Invalid position or size for control:', overlay.id);\n      return;\n    }\n\n    // Create SVG foreignObject wrapper to live in viewBox coordinate space\n    const foreignObject = this.createSvgForeignObject(overlay.id, position, size);\n    if (!foreignObject) {\n      console.error('[MSD Controls] Failed to create SVG foreignObject for:', overlay.id);\n      return;\n    }\n\n    // Configure the control element for SVG embedding\n    this.configureControlForSvg(element, overlay, size);\n\n    // Insert control into foreignObject\n    foreignObject.appendChild(element);\n\n    // Add to SVG container (this will scale automatically with viewBox)\n    const svgContainer = this.getSvgControlsContainer();\n    if (svgContainer && foreignObject.parentNode !== svgContainer) {\n      svgContainer.appendChild(foreignObject);\n      console.debug('[MSD Controls] Control positioned in SVG coordinates:', overlay.id, { position, size });\n    }\n  }\n\n  /**\n   * Create an SVG foreignObject element to embed HTML controls in viewBox space\n   */\n  createSvgForeignObject(overlayId, position, size) {\n    const targetContainer = this.renderer.container || this.renderer.mountEl;\n    const svg = targetContainer?.querySelector('svg');\n\n    if (!svg) {\n      console.warn('[MSD Controls] No SVG element found for foreignObject creation');\n      return null;\n    }\n\n    try {\n      const foreignObject = document.createElementNS('http://www.w3.org/2000/svg', 'foreignObject');\n\n      // Position in viewBox coordinates\n      foreignObject.setAttribute('x', position[0]);\n      foreignObject.setAttribute('y', position[1]);\n      foreignObject.setAttribute('width', size[0]);\n      foreignObject.setAttribute('height', size[1]);\n\n      // Add identification attributes\n      foreignObject.setAttribute('data-msd-control-id', overlayId);\n      foreignObject.setAttribute('id', `msd-control-foreign-${overlayId}`);\n\n      // Ensure proper event handling\n      foreignObject.style.pointerEvents = 'auto';\n      foreignObject.style.overflow = 'visible';\n\n      return foreignObject;\n\n    } catch (error) {\n      console.error('[MSD Controls] Failed to create foreignObject:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Configure control element for SVG embedding\n   */\n  configureControlForSvg(element, overlay, size) {\n    // Remove any absolute positioning that would interfere with foreignObject\n    element.style.position = 'relative';\n    element.style.left = 'auto';\n    element.style.top = 'auto';\n\n    // Size the element to fill the foreignObject\n    element.style.width = '100%';\n    element.style.height = '100%';\n    element.style.boxSizing = 'border-box';\n\n    // Ensure proper event handling\n    element.style.pointerEvents = 'auto';\n    element.style.zIndex = overlay.z_index || 'auto';\n\n    // Maintain background if needed\n    if (!element.style.background && !element.shadowRoot) {\n      element.style.background = 'none';\n    }\n\n    console.debug('[MSD Controls] Configured element for SVG embedding:', overlay.id);\n  }\n\n  /**\n   * Get or create the SVG controls container group\n   */\n  getSvgControlsContainer() {\n    const targetContainer = this.renderer.container || this.renderer.mountEl;\n    const svg = targetContainer?.querySelector('svg');\n\n    if (!svg) {\n      console.warn('[MSD Controls] No SVG element found for controls container');\n      return null;\n    }\n\n    // Look for existing controls group\n    let controlsGroup = svg.querySelector('#msd-controls-container');\n\n    if (!controlsGroup) {\n      // Create new controls group\n      controlsGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');\n      controlsGroup.setAttribute('id', 'msd-controls-container');\n      controlsGroup.style.pointerEvents = 'none'; // Group itself doesn't capture events\n\n      // Insert after overlay container but before debug layer\n      const overlayContainer = svg.querySelector('#msd-overlay-container');\n      const debugLayer = svg.querySelector('#msd-debug-layer');\n\n      if (debugLayer) {\n        svg.insertBefore(controlsGroup, debugLayer);\n      } else if (overlayContainer) {\n        svg.insertBefore(controlsGroup, overlayContainer.nextSibling);\n      } else {\n        svg.appendChild(controlsGroup);\n      }\n\n      console.log('[MSD Controls] Created SVG controls container group');\n    }\n\n    return controlsGroup;\n  }\n\n  // Helper methods for position and size resolution\n  resolvePosition(position, resolvedModel) {\n    // Use the PositionResolver for consistency with other overlays\n    const resolved = PositionResolver.resolvePosition(position, resolvedModel.anchors || {});\n    if (resolved) {\n      return resolved;\n    }\n\n    // Fallback: Return default position if resolution fails\n    console.warn('[MSD Controls] Position resolution failed, using default [0, 0]');\n    return [0, 0];\n  }\n\n  resolveSize(size, resolvedModel) {\n    if (!size || !Array.isArray(size) || size.length < 2) {\n      return [100, 100];\n    }\n    return [size[0], size[1]];\n  }\n\n  // Cleanup method\n  cleanup() {\n    console.log('[MsdControlsRenderer] Cleaning up controls renderer');\n\n    // Clear control elements (now foreignObjects in SVG)\n    for (const [id, element] of this.controlElements) {\n      try {\n        // Remove foreignObject wrapper from SVG\n        const foreignObject = element.closest('foreignObject') ||\n                             document.querySelector(`#msd-control-foreign-${id}`);\n        if (foreignObject && foreignObject.remove) {\n          foreignObject.remove();\n        } else if (element && element.remove) {\n          element.remove();\n        }\n      } catch (e) {\n        console.warn(`Failed to remove control element ${id}:`, e);\n      }\n    }\n    this.controlElements.clear();\n\n    // Remove SVG controls container\n    const targetContainer = this.renderer?.container || this.renderer?.mountEl;\n    const svg = targetContainer?.querySelector('svg');\n    const svgControlsContainer = svg?.querySelector('#msd-controls-container');\n    if (svgControlsContainer) {\n      try {\n        svgControlsContainer.remove();\n      } catch (e) {\n        console.warn('Failed to remove SVG controls container:', e);\n      }\n    }\n\n    // Clean up any legacy DOM container if it exists\n    const legacyContainer = targetContainer?.querySelector('#msd-controls-container');\n    if (legacyContainer && legacyContainer.tagName === 'DIV') {\n      try {\n        legacyContainer.remove();\n        console.log('[MsdControlsRenderer] Removed legacy DOM controls container');\n      } catch (e) {\n        console.warn('Failed to remove legacy controls container:', e);\n      }\n    }\n\n    // Clear HASS reference\n    this.hass = null;\n  }\n}\n\n","/**\n * Enhanced Performance monitoring panel for MSD HUD\n * Timer and counter data with threshold alerts and reset functionality\n */\n\nexport class PerformancePanel {\n  constructor() {\n    this.thresholds = new Map(); // timerId -> threshold config\n    this.previousSnapshot = {};\n  }\n\n  // Instance methods replacing global panel handlers\n  setThreshold(timerId, avgMs) {\n    const t = parseFloat(avgMs);\n    if (isNaN(t)) this.thresholds.delete(timerId);\n    else this.thresholds.set(timerId, { avgMs: t });\n  }\n  resetTimer(timerId) {\n    try { window.__msdDebug?.getPerf?.()?.resetTimer?.(timerId); } catch {}\n  }\n  clearAllTimers() {\n    try { window.__msdDebug?.getPerf?.()?.clear?.(); } catch {}\n    this.thresholds.clear();\n  }\n  exportData() {\n    const perfData = window.__msdDebug?.getPerf?.() || {};\n    const data = {\n      timestamp: Date.now(),\n      timers: perfData.timers || {},\n      counters: perfData.counters || {},\n      thresholds: Object.fromEntries(this.thresholds)\n    };\n\n    console.table(data.timers);\n    console.log('[PerformancePanel] Performance data:', data);\n\n    // Create downloadable export\n    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });\n    const url = URL.createObjectURL(blob);\n    const a = document.createElement('a');\n    a.href = url;\n    a.download = `msd-performance-${Date.now()}.json`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(url);\n  }\n\n  captureData() {\n    const timers = {};\n    const counters = {};\n    const alerts = [];\n    const regressions = [];\n\n    try {\n      // FIXED: Use centralized debug status access for performance state\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n\n      // Get performance data using consistent approach\n      const perfData = window.__msdDebug?.getPerf?.() || {};\n\n      // Process timers\n      if (perfData.timers) {\n        Object.entries(perfData.timers).forEach(([key, data]) => {\n          const timerData = {\n            count: data.count || 0,\n            total: data.total || 0,\n            avg: data.count > 0 ? (data.total / data.count) : 0,\n            last: data.last || 0,\n            max: data.max || 0,\n            min: data.min || 0\n          };\n\n          timers[key] = timerData;\n\n          // Check thresholds\n          const threshold = this.thresholds.get(key);\n          if (threshold && timerData.avg > threshold.avgMs) {\n            alerts.push({\n              type: 'threshold',\n              timer: key,\n              current: timerData.avg,\n              threshold: threshold.avgMs,\n              severity: timerData.avg > threshold.avgMs * 2 ? 'high' : 'medium'\n            });\n          }\n\n          // Check for regressions\n          const previous = this.previousSnapshot[key];\n          if (previous && previous.avg > 0) {\n            const regression = ((timerData.avg - previous.avg) / previous.avg) * 100;\n            if (regression > 20) { // >20% increase\n              regressions.push({\n                timer: key,\n                previousAvg: previous.avg,\n                currentAvg: timerData.avg,\n                regression: regression\n              });\n            }\n          }\n        });\n      }\n\n      // Process counters\n      if (perfData.counters) {\n        Object.entries(perfData.counters).forEach(([key, value]) => {\n          counters[key] = Number(value) || 0;\n        });\n      }\n\n      // Store snapshot for regression detection\n      this.previousSnapshot = { ...timers };\n\n    } catch (e) {\n      console.warn('[PerformancePanel] Data capture failed:', e);\n    }\n\n    return { timers, counters, alerts, regressions };\n  }\n\n  renderHtml(performance) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Performance Monitor</h3>';\n\n    const { timers, counters, alerts, regressions } = performance;\n\n    // Controls section\n    html += '<div class=\"msd-hud-section\"><h4>Controls</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;\">';\n\n    html += `<button data-bus-event=\"performance:clear-all\" onclick=\"__msdHudBus('performance:clear-all')\"\n      style=\"font-size:10px;padding:2px 6px;background:#666;color:#fff;border:1px solid #888;border-radius:3px;cursor:pointer;\">\n      Clear All\n    </button>`;\n\n    html += `<button data-bus-event=\"performance:export\" onclick=\"__msdHudBus('performance:export')\"\n      style=\"font-size:10px;padding:2px 6px;background:#333;color:#fff;border:1px solid #555;border-radius:3px;cursor:pointer;\">\n      Export\n    </button>`;\n\n    html += '</div></div>';\n\n    // Alerts section\n    if (alerts && alerts.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-warning\"><h4>Threshold Alerts</h4>';\n      alerts.forEach(alert => {\n        const severityColor = alert.severity === 'high' ? '#ff4444' : '#ffaa00';\n        html += `<div class=\"msd-hud-metric msd-hud-warning\">\n          <span class=\"msd-hud-metric-name\" style=\"color:${severityColor};\">${alert.timer}</span>\n          <span class=\"msd-hud-metric-value\">${alert.current.toFixed(2)}ms > ${alert.threshold}ms</span>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Regressions section\n    if (regressions && regressions.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-error\"><h4>Performance Regressions</h4>';\n      regressions.forEach(regression => {\n        html += `<div class=\"msd-hud-metric msd-hud-error\">\n          <span class=\"msd-hud-metric-name\">${regression.timer}</span>\n          <span class=\"msd-hud-metric-value\">+${regression.regression.toFixed(1)}%</span>\n        </div>`;\n        html += `<div class=\"msd-hud-metric-detail\">\n          ${regression.previousAvg.toFixed(2)}ms → ${regression.currentAvg.toFixed(2)}ms\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Timers section\n    const timerEntries = Object.entries(timers || {}).slice(0, 10);\n    if (timerEntries.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Timers</h4>';\n\n      // Sort by average time descending\n      timerEntries.sort(([,a], [,b]) => b.avg - a.avg);\n\n      timerEntries.forEach(([key, data]) => {\n        const hasThreshold = this.thresholds.has(key);\n        const threshold = this.thresholds.get(key);\n        const isOverThreshold = hasThreshold && data.avg > threshold.avgMs;\n        const avgColor = isOverThreshold ? '#ff6666' : data.avg > 10 ? '#ffaa00' : '#66ff99';\n\n        html += `<div class=\"msd-hud-metric\" style=\"margin:4px 0;padding:4px;border:1px solid #333;border-radius:3px;\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${key}</span>\n            <span class=\"msd-hud-metric-value\" style=\"color:${avgColor};\">${data.avg.toFixed(2)}ms</span>\n          </div>\n          <div style=\"font-size:10px;color:#888;margin-top:2px;\">\n            Count: ${data.count} • Max: ${data.max.toFixed(1)}ms • Last: ${data.last.toFixed(1)}ms\n          </div>\n          <div style=\"display:flex;gap:4px;margin-top:4px;\">\n            <input type=\"number\" placeholder=\"Threshold (ms)\" value=\"${hasThreshold ? threshold.avgMs : ''}\"\n              id=\"perf-threshold-${key.replace(/[^a-z0-9_-]/gi,'-')}\"\n              name=\"perf-threshold-${key.replace(/[^a-z0-9_-]/gi,'-')}\"\n              data-bus-event=\"performance:set-threshold\" data-timer=\"${key}\"\n              onchange=\"__msdHudBus('performance:set-threshold',{timer:'${key}',value:this.value})\"\n              style=\"width:80px;font-size:9px;padding:1px 3px;\">\n            <button data-bus-event=\"performance:reset-timer\"\n              onclick=\"__msdHudBus('performance:reset-timer',{timer:'${key}'})\"\n              style=\"font-size:9px;padding:1px 4px;background:#555;color:#fff;border:1px solid #777;border-radius:2px;cursor:pointer;\">\n              Reset\n            </button>\n          </div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Counters section\n    const counterEntries = Object.entries(counters || {}).slice(0, 8);\n    if (counterEntries.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Counters</h4>';\n      counterEntries.forEach(([key, value]) => {\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">${key}</span>\n          <span class=\"msd-hud-metric-value\">${value}</span>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    if (timerEntries.length === 0 && counterEntries.length === 0) {\n      html += '<div class=\"msd-hud-section\">No performance data available</div>';\n    }\n\n    // Summary\n    const alertCount = alerts?.length || 0;\n    const regressionCount = regressions?.length || 0;\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${timerEntries.length} timers • ${counterEntries.length} counters\n      ${alertCount > 0 ? ` • ${alertCount} alerts` : ''}\n      ${regressionCount > 0 ? ` • ${regressionCount} regressions` : ''}\n    </div>`;\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Validation monitoring panel for MSD HUD\n * Displays validation errors and warnings with overlay highlighting\n */\n\nexport class ValidationPanel {\n  captureData() {\n    const errors = [];\n    const warnings = [];\n\n    try {\n      // FIXED: Use centralized silent debug status access\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n      let validationData = {};\n\n      if (debugStatus.enabled && window.__msdDebug?.validation?.issues) {\n        validationData = window.__msdDebug.validation.issues() || {};\n      } else {\n        // Fallback: try direct access without debug interface\n        validationData = window.__msdDebug?.pipelineInstance?.getValidationIssues?.() || {};\n      }\n\n      if (validationData.errors) {\n        validationData.errors.forEach(error => {\n          errors.push({\n            code: error.code || 'unknown',\n            severity: error.severity || 'error',\n            message: error.msg || error.message || 'Unknown error',\n            overlay: error.overlay,\n            anchor: error.anchor\n          });\n        });\n      }\n\n      if (validationData.warnings) {\n        validationData.warnings.forEach(warning => {\n          warnings.push({\n            code: warning.code || 'unknown',\n            severity: warning.severity || 'warning',\n            message: warning.msg || warning.message || 'Unknown warning',\n            overlay: warning.overlay,\n            anchor: warning.anchor\n          });\n        });\n      }\n    } catch (_) {}\n\n    return { errors, warnings };\n  }\n\n  renderHtml(validation) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Validation</h3>';\n\n    // Errors section\n    const errors = validation.errors || [];\n    if (errors.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-errors\"><h4>Errors</h4>';\n      errors.slice(0, 6).forEach(error => {\n        html += `<div class=\"msd-hud-metric msd-hud-error\"\n          data-select-type=\"${error.overlay ? 'overlay':'anchor'}\"\n          data-select-id=\"${error.overlay || error.anchor || error.code}\"\n          onclick=\"__msdHudBus('select:set',{type:'${error.overlay ? 'overlay':'anchor'}',id:'${error.overlay || error.anchor || error.code}',source:'validation'})\"\n        >\n          <span class=\"msd-hud-metric-name\">${error.code}</span>\n          <span class=\"msd-hud-metric-value\">${error.message}</span>\n        </div>`;\n        if (error.overlay) {\n          html += `<div class=\"msd-hud-metric-detail\">Overlay: ${error.overlay}</div>`;\n        }\n        if (error.anchor) {\n          html += `<div class=\"msd-hud-metric-detail\">Anchor: ${error.anchor}</div>`;\n        }\n      });\n      html += '</div>';\n    }\n\n    // Warnings section\n    const warnings = validation.warnings || [];\n    if (warnings.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-warnings\"><h4>Warnings</h4>';\n      warnings.slice(0, 6).forEach(warning => {\n        html += `<div class=\"msd-hud-metric msd-hud-warning\"\n          data-select-type=\"${warning.overlay ? 'overlay':'anchor'}\"\n          data-select-id=\"${warning.overlay || warning.anchor || warning.code}\"\n          onclick=\"__msdHudBus('select:set',{type:'${warning.overlay ? 'overlay':'anchor'}',id:'${warning.overlay || warning.anchor || warning.code}',source:'validation'})\"\n        >\n          <span class=\"msd-hud-metric-name\">${warning.code}</span>\n          <span class=\"msd-hud-metric-value\">${warning.message}</span>\n        </div>`;\n        if (warning.overlay) {\n          html += `<div class=\"msd-hud-metric-detail\">Overlay: ${warning.overlay}</div>`;\n        }\n      });\n      html += '</div>';\n    }\n\n    // Status section\n    const totalIssues = errors.length + warnings.length;\n    if (totalIssues === 0) {\n      html += '<div class=\"msd-hud-section msd-hud-success\">✅ No validation issues</div>';\n    } else {\n      html += `<div class=\"msd-hud-section msd-hud-summary\">\n        ${errors.length} errors, ${warnings.length} warnings\n      </div>`;\n    }\n\n    html += '</div>';\n    return html;\n\n}\n}\n","/**\n * Enhanced Data source monitoring panel for MSD HUD\n * DataSourceManager integration health checks and subscription diagnostics\n */\n\nexport class DataSourcePanel {\n  constructor() {\n    this.entityChangeHistory = new Map(); // entityId -> recent state changes\n    this.maxHistoryLength = 10;\n  }\n\n  inspectEntity(entityId) {\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      const dsManager = pipelineInstance?.dataSourceManager ||\n                       pipelineInstance?.systemsManager?.dataSourceManager ||\n                       window.__msdDebug?.dataSourceManager;\n\n      if (dsManager?.getEntity) {\n        const entity = dsManager.getEntity(entityId);\n        console.log(`[DataSourcePanel] Entity ${entityId}:`, entity);\n        console.table([entity]);\n      } else {\n        console.warn('[DataSourcePanel] DataSourceManager not available');\n      }\n    } catch (e) {\n      console.warn('[DataSourcePanel] Entity inspection failed:', e);\n    }\n  }\n\n  refreshSubscriptions() {\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      const dsManager = pipelineInstance?.dataSourceManager ||\n                       pipelineInstance?.systemsManager?.dataSourceManager ||\n                       window.__msdDebug?.dataSourceManager;\n\n      if (dsManager?.refreshSubscriptions) {\n        dsManager.refreshSubscriptions();\n        console.log('[DataSourcePanel] Subscriptions refreshed');\n      } else {\n        console.warn('[DataSourcePanel] Refresh not available');\n      }\n\n      // Trigger HUD refresh\n      if (window.__msdDebug?.hud?.refresh) {\n        window.__msdDebug.hud.refresh();\n      }\n    } catch (e) {\n      console.warn('[DataSourcePanel] Subscription refresh failed:', e);\n    }\n  }\n\n  clearHistory() {\n    this.entityChangeHistory.clear();\n    console.log('[DataSourcePanel] Change history cleared');\n\n    // Trigger refresh\n    if (window.__msdDebug?.hud?.refresh) {\n      window.__msdDebug.hud.refresh();\n    }\n  }\n\n  captureData() {\n    const entities = {};\n    const stats = {};\n    const health = {};\n    const subscriptions = {};\n    const recentChanges = [];\n\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      const dsManager = pipelineInstance?.dataSourceManager ||\n                       pipelineInstance?.systemsManager?.dataSourceManager ||\n                       window.__msdDebug?.dataSourceManager;\n\n      if (dsManager) {\n        // Get comprehensive stats\n        const entityIds = dsManager.listIds?.() || [];\n        const dsStats = dsManager.getStats?.() || {};\n        const healthCheck = dsManager.getHealth?.() || {};\n\n        // Transform stats\n        stats.count = entityIds.length;\n        stats.subscribed = Object.keys(dsStats.sources || {}).length;\n        stats.updated = Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.received || 0), 0);\n        stats.cacheHits = Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.cacheHits || 0), 0);\n        stats.errors = Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.errors || 0), 0);\n\n        // Health metrics\n        if (healthCheck.status) {\n          health.status = healthCheck.status;\n          health.uptime = healthCheck.uptime || 0;\n          health.lastError = healthCheck.lastError;\n          health.connectionCount = healthCheck.connectionCount || 0;\n        }\n\n        // Subscription details\n        if (dsStats.sources) {\n          Object.entries(dsStats.sources).forEach(([sourceName, sourceData]) => {\n            subscriptions[sourceName] = {\n              subscribers: sourceData.subscribers || 0,\n              received: sourceData.received || 0,\n              errors: sourceData.errors || 0,\n              lastUpdate: sourceData.lastUpdate,\n              cacheHits: sourceData.cacheHits || 0\n            };\n          });\n        }\n\n        // Sample recent entities and track changes\n        entityIds.slice(0, 15).forEach(id => {\n          const entity = dsManager.getEntity?.(id);\n          if (entity) {\n            // Track state changes\n            const previousState = this.entityChangeHistory.get(id);\n            if (previousState && previousState.state !== entity.state) {\n              recentChanges.push({\n                id: id,\n                from: previousState.state,\n                to: entity.state,\n                timestamp: Date.now()\n              });\n            }\n\n            // Store current state\n            this.entityChangeHistory.set(id, {\n              state: entity.state,\n              timestamp: Date.now()\n            });\n\n            // Trim history\n            if (this.entityChangeHistory.size > this.maxHistoryLength) {\n              const oldestKey = this.entityChangeHistory.keys().next().value;\n              this.entityChangeHistory.delete(oldestKey);\n            }\n\n            entities[id] = {\n              state: entity.state,\n              lastChanged: entity.last_changed,\n              lastUpdated: entity.last_updated,\n              attributes: entity.attributes || {},\n              domain: id.split('.')[0] // Extract domain for grouping\n            };\n          }\n        });\n\n      } else {\n        console.warn('[DataSourcePanel] DataSourceManager not available via consolidated interface');\n        stats.error = 'DataSourceManager not available';\n      }\n    } catch (e) {\n      console.warn('[DataSourcePanel] Data capture failed:', e);\n      stats.error = e.message;\n    }\n\n    return { entities, stats, health, subscriptions, recentChanges };\n  }\n\n  renderHtml(entityData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Data Sources</h3>';\n\n    const { entities, stats, health, subscriptions, recentChanges } = entityData;\n\n    // Error handling\n    if (stats.error) {\n      html += `<div class=\"msd-hud-section msd-hud-error\">\n        <h4>Error</h4>\n        <div class=\"msd-hud-metric-value\">${stats.error}</div>\n      </div>`;\n      html += '</div>';\n      return html;\n    }\n\n    // Controls section\n    html += '<div class=\"msd-hud-section\"><h4>Controls</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;\">';\n\n    html += `<button data-bus-event=\"datasource:refresh-subs\" onclick=\"__msdHudBus('datasource:refresh-subs')\"\n      style=\"font-size:10px;padding:2px 6px;background:#333;color:#fff;border:1px solid #555;border-radius:3px;cursor:pointer;\">\n      Refresh Subs\n    </button>`;\n\n    html += `<button data-bus-event=\"datasource:clear-history\" onclick=\"__msdHudBus('datasource:clear-history')\"\n      style=\"font-size:10px;padding:2px 6px;background:#666;color:#fff;border:1px solid #888;border-radius:3px;cursor:pointer;\">\n      Clear History\n    </button>`;\n\n    html += '</div></div>';\n\n    // Health section\n    if (health && health.status) {\n      const statusColor = health.status === 'healthy' ? '#66ff99' :\n                         health.status === 'warning' ? '#ffaa00' : '#ff6666';\n\n      html += '<div class=\"msd-hud-section\"><h4>Health Status</h4>';\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Status</span>\n        <span class=\"msd-hud-metric-value\" style=\"color:${statusColor};\">${health.status}</span>\n      </div>`;\n\n      if (health.uptime > 0) {\n        const uptimeHours = (health.uptime / (1000 * 60 * 60)).toFixed(1);\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">Uptime</span>\n          <span class=\"msd-hud-metric-value\">${uptimeHours}h</span>\n        </div>`;\n      }\n\n      if (health.connectionCount !== undefined) {\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">Connections</span>\n          <span class=\"msd-hud-metric-value\">${health.connectionCount}</span>\n        </div>`;\n      }\n\n      if (health.lastError) {\n        html += `<div class=\"msd-hud-metric msd-hud-warning\">\n          <span class=\"msd-hud-metric-name\">Last Error</span>\n          <span class=\"msd-hud-metric-value\">${health.lastError}</span>\n        </div>`;\n      }\n\n      html += '</div>';\n    }\n\n    // Enhanced statistics section\n    html += '<div class=\"msd-hud-section\"><h4>Statistics</h4>';\n    html += `<div class=\"msd-hud-metric\">\n      <span class=\"msd-hud-metric-name\">Total Entities</span>\n      <span class=\"msd-hud-metric-value\">${stats.count || 0}</span>\n    </div>`;\n    html += `<div class=\"msd-hud-metric\">\n      <span class=\"msd-hud-metric-name\">Data Sources</span>\n      <span class=\"msd-hud-metric-value\">${stats.subscribed || 0}</span>\n    </div>`;\n    html += `<div class=\"msd-hud-metric\">\n      <span class=\"msd-hud-metric-name\">Total Updates</span>\n      <span class=\"msd-hud-metric-value\">${stats.updated || 0}</span>\n    </div>`;\n    if (stats.cacheHits !== undefined) {\n      const hitRate = stats.updated > 0 ? ((stats.cacheHits / stats.updated) * 100).toFixed(1) : '0';\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Cache Hit Rate</span>\n        <span class=\"msd-hud-metric-value\">${hitRate}%</span>\n      </div>`;\n    }\n    if (stats.errors !== undefined && stats.errors > 0) {\n      html += `<div class=\"msd-hud-metric msd-hud-warning\">\n        <span class=\"msd-hud-metric-name\">Errors</span>\n        <span class=\"msd-hud-metric-value\">${stats.errors}</span>\n      </div>`;\n    }\n    html += '</div>';\n\n    // Subscription diagnostics\n    if (subscriptions && Object.keys(subscriptions).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Active Subscriptions</h4>';\n      Object.entries(subscriptions).slice(0, 6).forEach(([sourceName, sourceData]) => {\n        const shortName = sourceName.length > 18 ? sourceName.substring(0, 15) + '...' : sourceName;\n        const hasErrors = sourceData.errors > 0;\n        const errorClass = hasErrors ? 'msd-hud-warning' : '';\n\n        html += `<div class=\"msd-hud-metric ${errorClass}\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortName}</span>\n            <span class=\"msd-hud-metric-value\">${sourceData.subscribers} subs</span>\n          </div>\n          <div style=\"font-size:10px;color:#888;margin-top:2px;\">\n            ${sourceData.received} updates • ${sourceData.cacheHits} cached\n            ${hasErrors ? ` • ${sourceData.errors} errors` : ''}\n          </div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Recent state changes\n    if (recentChanges && recentChanges.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Recent Changes</h4>';\n      recentChanges.slice(-5).forEach(change => {\n        const shortId = change.id.length > 20 ? change.id.substring(0, 17) + '...' : change.id;\n        const timeAgo = Math.round((Date.now() - change.timestamp) / 1000);\n\n        html += `<div class=\"msd-hud-metric\" style=\"cursor:pointer;\"\n          onclick=\"__msdHudBus('datasource:inspect',{id:'${change.id}'})\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span style=\"font-size:10px;color:#888;\">${timeAgo}s ago</span>\n          </div>\n          <div style=\"font-size:10px;color:#ccc;margin-top:1px;\">\n            ${change.from} → ${change.to}\n          </div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Entity samples by domain\n    const entities_entries = Object.entries(entities || {});\n    if (entities_entries.length > 0) {\n      // Group by domain\n      const byDomain = {};\n      entities_entries.forEach(([id, entity]) => {\n        const domain = entity.domain || 'unknown';\n        if (!byDomain[domain]) byDomain[domain] = [];\n        byDomain[domain].push([id, entity]);\n      });\n\n      html += '<div class=\"msd-hud-section\"><h4>Entity Samples</h4>';\n      Object.entries(byDomain).slice(0, 4).forEach(([domain, domainEntities]) => {\n        html += `<div style=\"margin-bottom:6px;\">\n          <div style=\"font-weight:bold;font-size:11px;color:#ffaa00;\">${domain} (${domainEntities.length})</div>`;\n\n        domainEntities.slice(0, 3).forEach(([id, entity]) => {\n          const shortId = id.length > 20 ? id.substring(0, 17) + '...' : id;\n          const stateValue = entity.state || 'N/A';\n          const shortState = stateValue.length > 12 ? stateValue.substring(0, 9) + '...' : stateValue;\n\n          html += `<div class=\"msd-hud-metric\" style=\"cursor:pointer;margin-left:10px;\"\n            onclick=\"__msdHudBus('datasource:inspect',{id:'${id}'})\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span class=\"msd-hud-metric-value\">${shortState}</span>\n          </div>`;\n        });\n\n        html += '</div>';\n      });\n      html += '</div>';\n    } else if (stats.count > 0) {\n      html += '<div class=\"msd-hud-section\">Entities available but no recent data</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No entity data available</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n}\n\n","/**\n * Enhanced Routing diagnostics panel for MSD HUD\n * Displays routing statistics and path computation data with filtering and analysis\n */\n\nexport class RoutingPanel {\n  constructor() {\n    this.filters = {\n      strategy: 'all',\n      minCost: 0,\n      maxCost: 1500, // FIXED: Increased from 1000 to 1500\n      cacheHit: 'all',\n      showArcs: false\n    };\n\n    // FIXED: Track input focus to prevent refresh interference\n    this.inputStates = {\n      minCostFocused: false,\n      maxCostFocused: false\n    };\n  }\n\n  // ADDED: Former global handlers as instance methods\n  setFilter(key, value) { this.filters[key] = value; }\n  updateCostFilter(type, value) {\n    const n = parseFloat(value);\n    if (!isNaN(n)) this.filters[type] = n;\n  }\n  finalizeCostFilter() {}\n  setInputFocus(field, focused) { this.inputStates[field] = focused; }\n  highlightRoute(routeId) {\n    console.log('[RoutingPanel] Highlighting route:', routeId);\n\n    // FIXED: Use pipeline mount element instead of document for shadow DOM\n    try {\n      // Get the mount element from the pipeline/debug interface\n      const mountElement = window.__msdDebug?.pipelineInstance?.mountElement ||\n                          window.__msdDebug?.mountElement ||\n                          document.querySelector('cb-lcars-msd-card')?.shadowRoot ||\n                          document;\n\n      if (!mountElement) {\n        console.warn('[RoutingPanel] No mount element found for route highlighting');\n        return;\n      }\n\n      // Try to find and highlight the actual route element in the mount's scope\n      // Look for g elements with data-overlay-id (container) or path elements\n      const routeElements = mountElement.querySelectorAll(`g[data-overlay-id=\"${routeId}\"], path[data-overlay-id=\"${routeId}\"], #${routeId}`);\n      routeElements.forEach(element => {\n        // Add temporary highlight class\n        element.classList.add('msd-route-highlighted');\n        setTimeout(() => {\n          element.classList.remove('msd-route-highlighted');\n        }, 3000);\n      });\n\n      // Also try to highlight any path elements within overlay groups\n      const overlayGroups = mountElement.querySelectorAll(`g[data-overlay-id=\"${routeId}\"]`);\n      overlayGroups.forEach(group => {\n        const paths = group.querySelectorAll('path');\n        paths.forEach(path => {\n          const originalStroke = path.style.stroke || path.getAttribute('stroke');\n          const originalWidth = path.style.strokeWidth || path.getAttribute('stroke-width');\n\n          // Highlight the path\n          path.style.stroke = '#ff00ff';\n          path.style.strokeWidth = '4';\n          path.style.filter = 'drop-shadow(0 0 6px #ff00ff)';\n\n          // Restore after 3 seconds\n          setTimeout(() => {\n            path.style.stroke = originalStroke;\n            path.style.strokeWidth = originalWidth;\n            path.style.filter = '';\n          }, 3000);\n        });\n      });\n\n      // Show user feedback\n      this.showRouteHighlightFeedback(routeId);\n\n    } catch (e) {\n      console.warn('[RoutingPanel] Route highlighting failed:', e);\n    }\n\n    // Emit routing focus event for other panels\n    if (window.__msdDebug?.hud?.emit) {\n      window.__msdDebug.hud.emit('routing:focus', { id: routeId });\n    }\n  }\n\n  analyzeRoute(routeId) {\n    const routing = window.__msdDebug?.routing;\n    if (routing?.inspect) {\n      const analysis = routing.inspect(routeId);\n\n      // FIXED: Enhanced route analysis display\n      console.group(`🔍 Route Analysis: ${routeId}`);\n\n      // Basic info table\n      if (analysis.meta) {\n        console.table({\n          Strategy: analysis.meta.strategy || 'unknown',\n          Cost: analysis.meta.cost || 0,\n          Segments: analysis.meta.segments || 0,\n          Bends: analysis.meta.bends || 0,\n          'Cache Hit': analysis.meta.cache_hit ? '✅ Yes' : '❌ No'\n        });\n      }\n\n      // Path details\n      if (analysis.pts && analysis.pts.length > 0) {\n        console.log('📍 Path Points:', analysis.pts.length, 'points');\n        console.table(analysis.pts.map((pt, i) => ({\n          Index: i,\n          X: pt[0],\n          Y: pt[1],\n          Type: i === 0 ? 'Start' : i === analysis.pts.length - 1 ? 'End' : 'Waypoint'\n        })));\n      }\n\n      // Hint information\n      if (analysis.meta?.hint) {\n        console.log('💡 Routing Hints:');\n        console.table(analysis.meta.hint);\n      }\n\n      // SVG path data (truncated if long)\n      if (analysis.d) {\n        const pathData = analysis.d.length > 100 ? analysis.d.substring(0, 97) + '...' : analysis.d;\n        console.log('🎨 SVG Path:', pathData);\n      }\n\n      // Raw object for developers who need it\n      console.log('📋 Full Analysis Object:', analysis);\n      console.groupEnd();\n\n      // FIXED: Also show visual feedback in HUD\n      this.showRouteAnalysisFeedback(routeId, analysis);\n    }\n  }\n\n  // FIXED: Add visual feedback method\n  showRouteHighlightFeedback(routeId) {\n    // Create temporary feedback element\n    const feedback = document.createElement('div');\n    feedback.style.cssText = `\n      position: fixed;\n      top: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: rgba(255, 0, 255, 0.9);\n      color: white;\n      padding: 8px 16px;\n      border-radius: 4px;\n      font-size: 12px;\n      z-index: 1000001;\n      pointer-events: none;\n    `;\n    feedback.textContent = `Highlighting route: ${routeId}`;\n    document.body.appendChild(feedback);\n\n    setTimeout(() => {\n      feedback.remove();\n    }, 2000);\n  }\n\n  // FIXED: Add route analysis feedback method\n  showRouteAnalysisFeedback(routeId, analysis) {\n    // Create analysis popup\n    const popup = document.createElement('div');\n    popup.style.cssText = `\n      position: fixed;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      background: rgba(0, 0, 0, 0.95);\n      color: #00ffff;\n      padding: 16px;\n      border: 2px solid #00ffff;\n      border-radius: 8px;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000002;\n      max-width: 400px;\n      box-shadow: 0 4px 20px rgba(0, 255, 255, 0.3);\n    `;\n\n    let content = `<h3 style=\"margin:0 0 12px;color:#ffaa00;\">Route Analysis: ${routeId}</h3>`;\n\n    if (analysis.meta) {\n      content += `\n        <div style=\"margin-bottom:12px;\">\n          <div><strong>Strategy:</strong> ${analysis.meta.strategy || 'unknown'}</div>\n          <div><strong>Cost:</strong> ${analysis.meta.cost || 0}</div>\n          <div><strong>Segments:</strong> ${analysis.meta.segments || 0}</div>\n          <div><strong>Bends:</strong> ${analysis.meta.bends || 0}</div>\n          <div><strong>Cache Hit:</strong> ${analysis.meta.cache_hit ? '✅ Yes' : '❌ No'}</div>\n        </div>\n      `;\n    }\n\n    if (analysis.pts && analysis.pts.length > 0) {\n      content += `\n        <div style=\"margin-bottom:12px;\">\n          <strong>Path:</strong> ${analysis.pts.length} points<br>\n          <div style=\"font-size:10px;margin-top:4px;\">\n            Start: (${analysis.pts[0][0]}, ${analysis.pts[0][1]})<br>\n            End: (${analysis.pts[analysis.pts.length-1][0]}, ${analysis.pts[analysis.pts.length-1][1]})\n          </div>\n        </div>\n      `;\n    }\n\n    if (analysis.meta?.hint) {\n      content += `\n        <div style=\"margin-bottom:12px;\">\n          <strong>Hints:</strong><br>\n          <div style=\"font-size:10px;margin-top:4px;\">\n            First: ${analysis.meta.hint.first || 'n/a'} (${analysis.meta.hint.sourceFirst || 'n/a'})<br>\n            Last: ${analysis.meta.hint.last || 'n/a'} (${analysis.meta.hint.sourceLast || 'n/a'})\n          </div>\n        </div>\n      `;\n    }\n\n    content += `\n      <div style=\"text-align:center;margin-top:12px;\">\n        <button onclick=\"this.parentElement.parentElement.remove()\"\n          style=\"background:#333;color:#fff;border:1px solid #555;padding:4px 12px;border-radius:4px;cursor:pointer;\">\n          Close\n        </button>\n      </div>\n    `;\n\n    popup.innerHTML = content;\n    document.body.appendChild(popup);\n\n    // Auto-close after 10 seconds\n    setTimeout(() => {\n      if (popup.parentElement) {\n        popup.remove();\n      }\n    }, 25000);\n  }\n\n  captureData() {\n    const stats = {};\n    const routes = {};\n    const performance = {};\n\n    try {\n      const routing = window.__msdDebug?.routing;\n      if (routing) {\n        // Get routing statistics\n        const routingStats = routing.stats?.() || {};\n        Object.assign(stats, routingStats);\n\n        // Add performance metrics\n        if (routing.getPerformanceMetrics) {\n          performance.metrics = routing.getPerformanceMetrics();\n        }\n\n        // Get route inspections for line overlays\n        const pipeline = window.__msdDebug?.pipelineInstance;\n        if (pipeline) {\n          const model = pipeline.getResolvedModel?.();\n          if (model?.overlays) {\n            const lineOverlays = model.overlays\n              .filter(o => o.type === 'line' && o.anchor && o.attach_to)\n              .slice(0, 15); // More routes for filtering\n\n            lineOverlays.forEach(overlay => {\n              try {\n                const routeInfo = routing.inspect?.(overlay.id);\n                if (routeInfo && routeInfo.pts) {\n                  routes[overlay.id] = {\n                    id: overlay.id,\n                    strategy: routeInfo.meta?.strategy || 'auto',\n                    pathLength: routeInfo.pts?.length || 0,\n                    segments: routeInfo.meta?.segments || 0,\n                    bends: routeInfo.meta?.bends || 0,\n                    cost: routeInfo.meta?.cost || 0,\n                    cached: routeInfo.meta?.cache_hit || false,\n                    success: routeInfo.pts && routeInfo.pts.length > 0,\n                    arcCount: routeInfo.meta?.arc?.count || 0,\n                    // Enhanced data\n                    startAnchor: overlay.anchor,\n                    endAnchor: overlay.attach_to,\n                    smooth: routeInfo.meta?.smooth || false,\n                    channel: routeInfo.meta?.channel,\n                    computeTime: routeInfo.meta?.compute_time_ms || 0\n                  };\n                } else {\n                  routes[overlay.id] = {\n                    id: overlay.id,\n                    strategy: 'unknown',\n                    pathLength: 0,\n                    segments: 0,\n                    bends: 0,\n                    cost: 0,\n                    cached: false,\n                    success: false,\n                    arcCount: 0,\n                    startAnchor: overlay.anchor,\n                    endAnchor: overlay.attach_to,\n                    smooth: false,\n                    channel: null,\n                    computeTime: 0\n                  };\n                }\n              } catch (e) {\n                console.warn(`[RoutingPanel] Route inspection failed for ${overlay.id}:`, e);\n              }\n            });\n          }\n        }\n      }\n    } catch (e) {\n      console.warn('[RoutingPanel] Data capture failed:', e);\n    }\n\n    return { stats, routes, performance };\n  }\n\n  filterRoutes(routes) {\n    return Object.values(routes).filter(route => {\n      // Strategy filter\n      if (this.filters.strategy !== 'all' && route.strategy !== this.filters.strategy) {\n        return false;\n      }\n\n      // Cost range filter\n      if (route.cost < this.filters.minCost || route.cost > this.filters.maxCost) {\n        return false;\n      }\n\n      // Cache hit filter\n      if (this.filters.cacheHit === 'hit' && !route.cached) return false;\n      if (this.filters.cacheHit === 'miss' && route.cached) return false;\n\n      // Arc filter\n      if (this.filters.showArcs && route.arcCount === 0) return false;\n\n      return true;\n    });\n  }\n\n  renderHtml(routingData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Enhanced Routing</h3>';\n\n    // FIXED: Add CSS for route highlighting\n    html += `<style>\n      .msd-route-highlighted {\n        outline: 3px solid #ff00ff !important;\n        background: rgba(255, 0, 255, 0.1) !important;\n        box-shadow: 0 0 10px #ff00ff !important;\n      }\n    </style>`;\n\n    // Filters section\n    html += '<div class=\"msd-hud-section\"><h4>Filters</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;margin-bottom:6px;\">';\n\n    // Strategy filter\n    const strategies = ['all', 'auto', 'manhattan', 'smooth', 'direct'];\n    html += '<select id=\"hud-routing-strategy\" name=\"hud-routing-strategy\" data-bus-event=\"routing:set-filter\" data-key=\"strategy\" onchange=\"__msdHudBus(\\'routing:set-filter\\', {key:\\'strategy\\', value:this.value})\" style=\"font-size:10px;\">';\n    strategies.forEach(strategy => {\n      const selected = this.filters.strategy === strategy ? 'selected' : '';\n      html += `<option value=\"${strategy}\" ${selected}>${strategy}</option>`;\n    });\n    html += '</select>';\n\n    // FIXED: Cost range with better input handling\n    html += `<input type=\"number\" id=\"hud-routing-min-cost\" name=\"hud-routing-min-cost\"\n      data-bus-event=\"routing:update-cost\" data-key=\"minCost\"\n      onfocus=\"__msdHudBus('routing:focus-set',{field:'minCostFocused',focus:true})\"\n      onblur=\"__msdHudBus('routing:focus-set',{field:'minCostFocused',focus:false});__msdHudBus('routing:finalize-cost')\"\n      oninput=\"__msdHudBus('routing:update-cost',{key:'minCost',value:this.value})\"\n      placeholder=\"Min cost\" value=\"${this.filters.minCost}\" style=\"width:60px;font-size:10px;\">`;\n\n    html += `<input type=\"number\" id=\"hud-routing-max-cost\" name=\"hud-routing-max-cost\"\n      data-bus-event=\"routing:update-cost\" data-key=\"maxCost\"\n      onfocus=\"__msdHudBus('routing:focus-set',{field:'maxCostFocused',focus:true})\"\n      onblur=\"__msdHudBus('routing:focus-set',{field:'maxCostFocused',focus:false});__msdHudBus('routing:finalize-cost')\"\n      oninput=\"__msdHudBus('routing:update-cost',{key:'maxCost',value:this.value})\"\n      placeholder=\"Max cost\" value=\"${this.filters.maxCost}\" style=\"width:60px;font-size:10px;\">`;\n\n    // Cache filter\n    html += '<select id=\"hud-routing-cachehit\" name=\"hud-routing-cachehit\" data-bus-event=\"routing:set-filter\" data-key=\"cacheHit\" onchange=\"__msdHudBus(\\'routing:set-filter\\', {key:\\'cacheHit\\', value:this.value})\" style=\"font-size:10px;\">';\n    ['all', 'hit', 'miss'].forEach(cache => {\n      const selected = this.filters.cacheHit === cache ? 'selected' : '';\n      html += `<option value=\"${cache}\" ${selected}>Cache: ${cache}</option>`;\n    });\n    html += '</select>';\n\n    html += '</div></div>';\n\n    // Statistics section\n    const stats = routingData.stats || {};\n    if (Object.keys(stats).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Cache Statistics</h4>';\n\n      Object.entries(stats).forEach(([key, value]) => {\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">${key}</span>\n          <span class=\"msd-hud-metric-value\">${value}</span>\n        </div>`;\n      });\n\n      html += '</div>';\n    }\n\n    // Performance section\n    const performance = routingData.performance || {};\n    if (performance.metrics) {\n      html += '<div class=\"msd-hud-section\"><h4>Performance</h4>';\n\n      Object.entries(performance.metrics).forEach(([key, value]) => {\n        const displayValue = typeof value === 'number' ? value.toFixed(2) : value;\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\">${key}</span>\n          <span class=\"msd-hud-metric-value\">${displayValue}</span>\n        </div>`;\n      });\n\n      html += '</div>';\n    }\n\n    // Filtered routes section\n    const allRoutes = routingData.routes || {};\n    const filteredRoutes = this.filterRoutes(allRoutes);\n\n    if (filteredRoutes.length > 0) {\n      html += `<div class=\"msd-hud-section\"><h4>Routes (${filteredRoutes.length}/${Object.keys(allRoutes).length})</h4>`;\n\n      // Sort by cost descending\n      filteredRoutes.sort((a, b) => b.cost - a.cost);\n\n      filteredRoutes.slice(0, 8).forEach(route => {\n        const shortId = route.id.length > 15 ? route.id.substring(0, 12) + '...' : route.id;\n        const statusClass = route.success ? 'msd-hud-success' : 'msd-hud-error';\n        const costColor = route.cost > 50 ? '#ff6666' : route.cost > 20 ? '#ffaa00' : '#66ff99';\n\n        // FIXED: Update data attribute for easier highlighting\n        html += `<div class=\"msd-hud-metric\"\n          data-overlay-id=\"${route.id}\"\n          data-select-type=\"route\"\n          data-select-id=\"${route.id}\"\n          style=\"cursor:pointer;border:1px solid #333;padding:4px;margin:2px 0;border-radius:3px;transition:all 0.3s;\"\n          onclick=\"__msdHudBus('select:set',{type:'route',id:'${route.id}',source:'routing'});__msdHudBus('routing:highlight',{id:'${route.id}'})\"\n          onmouseover=\"this.style.background='rgba(255,0,255,0.1)'\"\n          onmouseout=\"this.style.background=''\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span class=\"msd-hud-metric-value\" style=\"color:${costColor};\">${route.cost.toFixed(1)}</span>\n          </div>\n          <div style=\"font-size:10px;color:#888;margin-top:2px;\">\n            ${route.strategy} • ${route.pathLength}pts • ${route.bends}↻\n            ${route.cached ? ' • 📋' : ''}\n            ${route.arcCount > 0 ? ` • 🔄${route.arcCount}` : ''}\n          </div>\n        </div>`;\n\n        // Add analysis button\n        html += `<div style=\"text-align:right;margin-top:2px;\">\n          <button data-bus-event=\"routing:analyze\"\n            onclick=\"__msdHudBus('select:set',{type:'route',id:'${route.id}',source:'routing'});__msdHudBus('routing:analyze',{id:'${route.id}'})\"\n            style=\"font-size:9px;padding:1px 4px;background:#333;color:#ccc;border:1px solid #555;border-radius:2px;cursor:pointer;\">\n            Analyze\n          </button>\n        </div>`;\n      });\n\n      if (filteredRoutes.length > 8) {\n        html += `<div style=\"font-size:10px;text-align:center;color:#666;margin-top:4px;\">\n          ... ${filteredRoutes.length - 8} more routes\n        </div>`;\n      }\n\n      html += '</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No routes match current filters</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n\n  // FIXED: Add method to check if inputs are focused (prevents refresh interference)\n  shouldSkipRefresh() {\n    return this.inputStates.minCostFocused || this.inputStates.maxCostFocused;\n  }\n}\n","/**\n * Advanced Channel Trend Panel for MSD HUD\n * Historical channel usage analysis with conflict detection\n */\n\nexport class ChannelTrendPanel {\n  constructor() {\n    this.history = new Map(); // channelId -> array of usage counts\n    this.maxHistoryLength = 30;\n    this.conflictThreshold = 3; // channels with >3 simultaneous routes\n    this.lastSnapshot = null;\n  }\n\n  captureData() {\n    const routing = window.__msdDebug?.routing;\n    const current = routing?.channels?._occupancy || {};\n    const conflicts = [];\n    const trends = {};\n    const recommendations = [];\n\n    try {\n      // Update history\n      Object.entries(current).forEach(([channelId, count]) => {\n        if (!this.history.has(channelId)) {\n          this.history.set(channelId, []);\n        }\n\n        const channelHistory = this.history.get(channelId);\n        channelHistory.push(count);\n\n        // Trim history\n        if (channelHistory.length > this.maxHistoryLength) {\n          channelHistory.shift();\n        }\n      });\n\n      // Detect conflicts (channels with high usage)\n      Object.entries(current).forEach(([channelId, count]) => {\n        if (count >= this.conflictThreshold) {\n          conflicts.push({\n            channel: channelId,\n            count: count,\n            severity: count >= 5 ? 'high' : 'medium'\n          });\n        }\n      });\n\n      // Calculate trends\n      this.history.forEach((history, channelId) => {\n        if (history.length >= 3) {\n          const recent = history.slice(-3);\n          const avg = recent.reduce((sum, val) => sum + val, 0) / recent.length;\n          const trend = recent[recent.length - 1] - recent[0];\n\n          trends[channelId] = {\n            current: recent[recent.length - 1],\n            average: avg,\n            trend: trend, // positive = increasing usage\n            variance: this.calculateVariance(recent),\n            history: [...history] // copy for rendering\n          };\n        }\n      });\n\n      // Generate optimization recommendations\n      if (conflicts.length > 0) {\n        recommendations.push({\n          type: 'conflict',\n          message: `${conflicts.length} channel conflicts detected`,\n          action: 'Consider adjusting routing strategy'\n        });\n      }\n\n      const highVarianceChannels = Object.entries(trends)\n        .filter(([_, data]) => data.variance > 2)\n        .length;\n\n      if (highVarianceChannels > 0) {\n        recommendations.push({\n          type: 'variance',\n          message: `${highVarianceChannels} channels show high variance`,\n          action: 'Review routing stability'\n        });\n      }\n\n      // Check for unused optimization\n      const totalChannels = this.history.size;\n      const activeChannels = Object.keys(current).length;\n      const unusedChannels = totalChannels - activeChannels;\n\n      if (unusedChannels > 5) {\n        recommendations.push({\n          type: 'optimization',\n          message: `${unusedChannels} channels currently unused`,\n          action: 'Potential for route optimization'\n        });\n      }\n\n    } catch (e) {\n      console.warn('[ChannelTrendPanel] Data capture failed:', e);\n    }\n\n    return { current, conflicts, trends, recommendations };\n  }\n\n  calculateVariance(values) {\n    if (values.length === 0) return 0;\n    const mean = values.reduce((sum, val) => sum + val, 0) / values.length;\n    const squaredDiffs = values.map(val => Math.pow(val - mean, 2));\n    return squaredDiffs.reduce((sum, val) => sum + val, 0) / values.length;\n  }\n\n  renderSparkline(history, maxValue = null) {\n    if (!history || history.length === 0) return '';\n\n    const max = maxValue || Math.max(...history, 1);\n    const width = 40;\n    const chars = ' ▁▂▃▄▅▆▇█';\n\n    let sparkline = '';\n    const step = Math.max(1, Math.floor(history.length / width));\n\n    for (let i = 0; i < history.length; i += step) {\n      const value = history[i];\n      const ratio = value / max;\n      const level = Math.min(chars.length - 1, Math.floor(ratio * (chars.length - 1)));\n      sparkline += chars[level];\n    }\n\n    return sparkline;\n  }\n\n  renderHtml(channelData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Channel Trends</h3>';\n\n    const { current, conflicts, trends, recommendations } = channelData;\n\n    // Conflicts section\n    if (conflicts && conflicts.length > 0) {\n      html += '<div class=\"msd-hud-section msd-hud-warning\"><h4>Conflicts Detected</h4>';\n      conflicts.forEach(conflict => {\n        const severityColor = conflict.severity === 'high' ? '#ff4444' : '#ffaa00';\n        html += `<div class=\"msd-hud-metric\">\n          <span class=\"msd-hud-metric-name\" style=\"color:${severityColor};\">${conflict.channel}</span>\n          <span class=\"msd-hud-metric-value\">${conflict.count} routes</span>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Recommendations section\n    if (recommendations && recommendations.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Recommendations</h4>';\n      recommendations.forEach(rec => {\n        const typeColor = rec.type === 'conflict' ? '#ff6666' :\n                         rec.type === 'variance' ? '#ffaa00' : '#66ff99';\n        html += `<div class=\"msd-hud-metric\">\n          <div style=\"color:${typeColor};font-size:10px;\">${rec.message}</div>\n          <div style=\"color:#888;font-size:9px;\">${rec.action}</div>\n        </div>`;\n      });\n      html += '</div>';\n    }\n\n    // Trends section with sparklines\n    if (trends && Object.keys(trends).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Usage Trends</h4>';\n\n      // Sort by current usage\n      const sortedTrends = Object.entries(trends)\n        .sort(([,a], [,b]) => b.current - a.current)\n        .slice(0, 8);\n\n      sortedTrends.forEach(([channelId, data]) => {\n        const shortId = channelId.length > 15 ? channelId.substring(0, 12) + '...' : channelId;\n        const trendIndicator = data.trend > 0 ? '↗' : data.trend < 0 ? '↘' : '→';\n        const trendColor = data.trend > 0 ? '#ff6666' : data.trend < 0 ? '#66ff99' : '#888';\n        const sparkline = this.renderSparkline(data.history);\n\n        html += `<div class=\"msd-hud-metric\" style=\"margin:4px 0;\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <span class=\"msd-hud-metric-value\">${data.current}</span>\n          </div>\n          <div style=\"display:flex;justify-content:space-between;font-size:10px;margin-top:2px;\">\n            <span style=\"font-family:monospace;color:#888;\">${sparkline}</span>\n            <span style=\"color:${trendColor};\">${trendIndicator} ${data.average.toFixed(1)}</span>\n          </div>\n        </div>`;\n      });\n\n      html += '</div>';\n    }\n\n    // Current status summary\n    const currentCount = Object.keys(current || {}).length;\n    const totalUsage = Object.values(current || {}).reduce((sum, count) => sum + count, 0);\n    const historySize = this.history.size;\n\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${currentCount} active channels • ${totalUsage} total routes • ${historySize} tracked\n    </div>`;\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Flags Panel for MSD HUD\n * Runtime debug feature management using actual MSD debug interface\n * Based on __msdDebug.debug.enable/disable API\n */\n\nexport class FlagsPanel {\n  constructor() {\n    // Actual MSD debug features\n    this.debugFeatures = [\n      'anchors', 'bounding_boxes', 'routing', 'performance'\n    ];\n  }\n\n  toggleFeature(feature) {\n    console.log('[FlagsPanel] toggleFeature called:', feature);\n\n    if (!window.__msdDebug?.debug) {\n      console.warn('[FlagsPanel] Debug interface not available');\n      return;\n    }\n\n    // FIXED: Use silent status access instead of status() which dumps to console\n    const debugManager = window.__msdDebug?.debugManager ||\n                         window.__msdDebug?.pipelineInstance?.systemsManager?.debugManager;\n\n    if (!debugManager) {\n      console.warn('[FlagsPanel] DebugManager not available');\n      return;\n    }\n\n    const currentStatus = debugManager.getSnapshot();\n    const currentlyEnabled = currentStatus[feature];\n\n    if (currentlyEnabled) {\n      window.__msdDebug.debug.disable(feature);\n    } else {\n      window.__msdDebug.debug.enable(feature);\n    }\n\n    // FIXED: Force immediate re-render after state change\n    setTimeout(() => {\n      try {\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (pipelineInstance?.reRender) {\n          console.log('[FlagsPanel] Triggering re-render after', feature, currentlyEnabled ? 'disable' : 'enable');\n          pipelineInstance.reRender();\n        } else {\n          console.warn('[FlagsPanel] No reRender method available on pipeline instance');\n        }\n      } catch (error) {\n        console.warn('[FlagsPanel] Failed to trigger re-render:', error);\n      }\n    }, 50);\n\n    // Refresh HUD after a delay to show updated state\n    setTimeout(() => {\n      if (window.__msdDebug?.hud?.refresh) {\n        window.__msdDebug.hud.refresh();\n      }\n    }, 100);\n  }\n\n  adjustScale(direction) {\n    if (!window.__msdDebug?.debug?.status) return;\n    const currentScale = window.__msdDebug.debug.status().scale || 1.0;\n    const step = 0.1;\n    const newScale = direction > 0 ? currentScale + step : currentScale - step;\n    const clampedScale = Math.max(0.5, Math.min(3.0, newScale));\n\n    if (window.__msdDebug.debug.setScale) {\n      window.__msdDebug.debug.setScale(clampedScale);\n    }\n  }\n\n  setScale(scale) {\n    const numScale = parseFloat(scale);\n    if (isNaN(numScale)) return;\n    const clampedScale = Math.max(0.5, Math.min(3.0, numScale));\n\n    if (window.__msdDebug?.debug?.setScale) {\n      window.__msdDebug.debug.setScale(clampedScale);\n    }\n  }\n\n  refreshDebug() {\n    window.__msdDebug?.debug?.refresh?.();\n  }\n\n  captureData() {\n    const flags = {};\n    const debugFeatures = {};\n\n    try {\n      // FIXED: Use centralized silent debug status access\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n\n      // FIXED: Properly capture debug features and readiness\n      Object.assign(debugFeatures, debugStatus);\n\n      // Get current debug flags (legacy support)\n      Object.assign(flags, window.__msdDebug?._debugFlags || {});\n    } catch (e) {\n      console.warn('[FlagsPanel] Data capture failed:', e);\n    }\n\n    return { flags, debugFeatures };\n  }\n\n  renderHtml(flagsData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Debug Features</h3>';\n\n    // FIXED: Use debugFeatures instead of separate features object\n    const debugFeatures = flagsData.debugFeatures || {};\n    const scale = debugFeatures.scale || 1.0;\n    const debugReady = debugFeatures.initialized || false;\n\n    // Debug status\n    if (!debugReady) {\n      html += '<div class=\"msd-hud-section msd-hud-warning\"><h4>Status</h4>';\n      html += '<div>Debug interface not ready</div></div>';\n    } else {\n      html += '<div class=\"msd-hud-section\"><h4>Status</h4>';\n      html += `<div>Debug ready • Scale: ${scale.toFixed(1)}x</div></div>`;\n    }\n\n    // Individual features section\n    html += '<div class=\"msd-hud-section\"><h4>Debug Features</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;margin-bottom:6px;\">';\n\n    this.debugFeatures.forEach(feature => {\n      // FIXED: Check debugFeatures instead of features\n      const isEnabled = Boolean(debugFeatures[feature]);\n      const displayName = feature.replace('_', ' ');\n      html += `<button data-bus-event=\"flags:toggle\" onclick=\"__msdHudBus('flags:toggle',{feature:'${feature}'})\"\n        style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n        background:${isEnabled ? '#ff00ff' : '#333'};color:${isEnabled ? '#000' : '#eee'};\">\n        ${displayName}\n      </button>`;\n    });\n\n    html += '</div></div>';\n\n    // Scale control\n    html += '<div class=\"msd-hud-section\"><h4>Scale Control</h4>';\n    html += '<div style=\"display:flex;gap:4px;align-items:center;margin-bottom:6px;\">';\n\n    // +/- buttons and input\n    html += `<button data-bus-event=\"flags:scale-adjust\" onclick=\"__msdHudBus('flags:scale-adjust',{dir:-1})\" style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n      background:#333;color:#eee;\">-</button>`;\n\n    html += `<input type=\"number\" id=\"hud-flags-scale\" name=\"hud-flags-scale\"\n      value=\"${scale.toFixed(1)}\" min=\"0.5\" max=\"3.0\" step=\"0.1\" data-bus-event=\"flags:scale-set\"\n      onchange=\"__msdHudBus('flags:scale-set',{scale:this.value})\"\n      style=\"width:60px;font-size:10px;padding:2px 4px;border:1px solid #444;border-radius:3px;\n      background:#222;color:#eee;text-align:center;\">`;\n\n    html += `<button data-bus-event=\"flags:scale-adjust\" onclick=\"__msdHudBus('flags:scale-adjust',{dir:1})\" style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n      background:#333;color:#eee;\">+</button>`;\n\n    html += '</div>';\n\n    // Preset scale buttons\n    html += '<div style=\"display:flex;gap:4px;align-items:center;\">';\n    [0.8, 1.0, 1.2, 1.5, 2.0].forEach(scaleValue => {\n      const isActive = Math.abs(scale - scaleValue) < 0.05;\n      html += `<button data-bus-event=\"flags:scale-set\"\n        onclick=\"__msdHudBus('flags:scale-set',{scale:${scaleValue}})\"\n        style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n        background:${isActive ? '#ffaa00' : '#333'};color:${isActive ? '#000' : '#eee'};\">\n        ${scaleValue}x\n      </button>`;\n    });\n\n    html += `<button data-bus-event=\"flags:refresh\" onclick=\"__msdHudBus('flags:refresh')\" style=\"font-size:10px;padding:2px 6px;border:1px solid #444;border-radius:3px;cursor:pointer;\n      background:#333;color:#eee;margin-left:8px;\">\n      Refresh\n    </button>`;\n    html += '</div></div>';\n\n    // Status section\n    // FIXED: Use debugFeatures to count enabled features\n    const enabledCount = this.debugFeatures.filter(feature => debugFeatures[feature]).length;\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${enabledCount}/${this.debugFeatures.length} features enabled\n    </div>`;\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Enhanced Issues Panel for MSD HUD\n * Unified issue aggregation with smart routing to editors/actions\n * Based on legacy HUD issues panel functionality\n */\n\nexport class IssuesPanel {\n  constructor() {\n    this.issueCategories = {\n      validation: { label: 'Validation', color: '#ff6666', icon: '⚠️' },\n      routing: { label: 'Routing', color: '#ffaa00', icon: '🔀' },\n      performance: { label: 'Performance', color: '#ff9900', icon: '⏱️' },\n      debug: { label: 'Debug', color: '#66cfff', icon: '🔧' }\n    };\n  }\n\n  handleIssueClick(action, id, overlay) {\n    console.log('[IssuesPanel] Issue clicked:', { action, id, overlay });\n\n    switch (action) {\n      case 'overlay':\n        if (overlay && window.__msdDebug?.debug) {\n          // Try to highlight the overlay\n          console.log(`[IssuesPanel] Highlighting overlay: ${overlay}`);\n          // Could integrate with overlay editor here\n        }\n        break;\n\n      case 'routing':\n        console.log('[IssuesPanel] Opening routing diagnostics');\n        // Could emit routing focus event\n        if (window.__msdDebug?.hud?.refresh) {\n          window.__msdDebug.hud.refresh();\n        }\n        break;\n\n      case 'performance':\n        console.log(`[IssuesPanel] Performance issue: ${id}`);\n        // Could open performance panel or set thresholds\n        break;\n\n      case 'debug':\n        console.log('[IssuesPanel] Debug issue clicked - attempting to initialize debug interface');\n        // Try to initialize debug interface\n        if (window.__msdDebug?.debug?.refresh) {\n          window.__msdDebug.debug.refresh();\n        }\n        break;\n\n      // ADDED: New action for enabling debug features\n      case 'enable-features':\n        console.log('[IssuesPanel] Enabling basic debug features');\n        if (window.__msdDebug?.debug) {\n          // Enable a basic set of debug features\n          window.__msdDebug.debug.enable('anchors');\n          window.__msdDebug.debug.enable('bounding_boxes');\n\n          // Show user feedback\n          const feedback = document.createElement('div');\n          feedback.style.cssText = `\n            position: fixed;\n            top: 20px;\n            left: 50%;\n            transform: translateX(-50%);\n            background: rgba(0, 255, 0, 0.9);\n            color: white;\n            padding: 8px 16px;\n            border-radius: 4px;\n            font-size: 12px;\n            z-index: 1000001;\n            pointer-events: none;\n          `;\n          feedback.textContent = 'Debug features enabled: anchors, bounding_boxes';\n          document.body.appendChild(feedback);\n\n          setTimeout(() => feedback.remove(), 3000);\n        }\n        break;\n    }\n\n    // ADDED: Selection heuristics\n    if (this.bus) {\n      if (action === 'overlay' && overlay) {\n        this.bus.emit('select:set', { type: 'overlay', id: overlay, source: 'issues' });\n      } else if (action === 'routing' && id) {\n        this.bus.emit('select:set', { type: 'route', id, source: 'issues' });\n      } else if (action === 'performance' && id) {\n        this.bus.emit('select:set', { type: 'timer', id, source: 'issues' });\n      }\n    }\n  }\n\n  captureData() {\n    const issues = {\n      validation: [],\n      routing: [],\n      performance: [],\n      debug: []\n    };\n\n    try {\n      // Validation issues\n      const validationData = window.__msdDebug?.validation?.issues?.() || {};\n      if (validationData.errors) {\n        validationData.errors.forEach(error => {\n          issues.validation.push({\n            id: error.overlay || error.anchor || 'unknown',\n            type: 'validation',\n            severity: 'error',\n            message: error.msg || error.message || 'Validation error',\n            code: error.code,\n            overlay: error.overlay,\n            anchor: error.anchor,\n            clickAction: 'overlay'\n          });\n        });\n      }\n      if (validationData.warnings) {\n        validationData.warnings.forEach(warning => {\n          issues.validation.push({\n            id: warning.overlay || warning.anchor || 'unknown',\n            type: 'validation',\n            severity: 'warning',\n            message: warning.msg || warning.message || 'Validation warning',\n            code: warning.code,\n            overlay: warning.overlay,\n            anchor: warning.anchor,\n            clickAction: 'overlay'\n          });\n        });\n      }\n\n      // Routing issues from debug features\n      // FIXED: Use centralized silent debug status access\n      const debugStatus = window.__msdDebug?.getDebugStatusSilent?.() || {};\n      if (debugStatus.enabled) {\n        // Check for routing problems (this would need actual routing diagnostics)\n        const routing = window.__msdDebug?.routing;\n        if (routing?.stats) {\n          const stats = routing.stats();\n          if (stats.errors && stats.errors > 0) {\n            issues.routing.push({\n              id: 'routing-errors',\n              type: 'routing',\n              severity: 'error',\n              message: `${stats.errors} routing errors detected`,\n              code: 'routing_errors',\n              clickAction: 'routing'\n            });\n          }\n        }\n      }\n\n      // Performance issues from debug status\n      if (debugStatus.performance) {\n        // Could check for performance thresholds here\n        // This is a placeholder for actual performance monitoring\n        const perfData = window.__msdDebug?.getPerf?.() || {};\n        if (perfData.timers) {\n          Object.entries(perfData.timers).forEach(([key, timer]) => {\n            if (timer.avg > 50) { // Example threshold\n              issues.performance.push({\n                id: key,\n                type: 'performance',\n                severity: 'warning',\n                message: `Slow timer: ${key} (${timer.avg.toFixed(1)}ms avg)`,\n                code: 'slow_timer',\n                clickAction: 'performance'\n              });\n            }\n          });\n        }\n      }\n\n      // Debug feature issues\n      // FIXED: Better debug feature status detection\n      if (!debugStatus.initialized) {\n        // Actually not initialized\n        issues.debug.push({\n          id: 'debug-status',\n          type: 'debug',\n          severity: 'warning',\n          message: 'Debug interface not initialized',\n          code: 'debug_not_initialized',\n          clickAction: 'debug'\n        });\n      } else if (!debugStatus.enabled) {\n        // Initialized but no features enabled - this is not really an \"issue\"\n        // We could either skip this entirely or show an info message\n        issues.debug.push({\n          id: 'debug-features-disabled',\n          type: 'debug',\n          severity: 'info',\n          message: 'All debug features are disabled',\n          code: 'debug_features_off',\n          clickAction: 'enable-features'\n        });\n      }\n\n    } catch (e) {\n      console.warn('[IssuesPanel] Data capture failed:', e);\n      issues.debug.push({\n        id: 'capture-error',\n        type: 'debug',\n        severity: 'error',\n        message: `Issue capture failed: ${e.message}`,\n        code: 'capture_error',\n        clickAction: 'debug'\n      });\n    }\n\n    return issues;\n  }\n\n  renderHtml(issuesData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Issues</h3>';\n\n    // Count total issues\n    const allIssues = [];\n    Object.values(issuesData).forEach(categoryIssues => {\n      allIssues.push(...categoryIssues);\n    });\n\n    if (allIssues.length === 0) {\n      html += '<div class=\"msd-hud-section msd-hud-success\">✅ No issues detected</div>';\n      html += '</div>';\n      return html;\n    }\n\n    // Summary section\n    const errorCount = allIssues.filter(i => i.severity === 'error').length;\n    const warningCount = allIssues.filter(i => i.severity === 'warning').length;\n\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      ${errorCount} errors, ${warningCount} warnings • Click to fix\n    </div>`;\n\n    // Issues by category\n    Object.entries(issuesData).forEach(([categoryKey, categoryIssues]) => {\n      if (categoryIssues.length === 0) return;\n\n      const category = this.issueCategories[categoryKey];\n      html += `<div class=\"msd-hud-section\">\n        <h4 style=\"color: ${category.color};\">${category.icon} ${category.label} (${categoryIssues.length})</h4>\n      `;\n\n      categoryIssues.slice(0, 6).forEach((issue, index) => {\n        const severityColor = issue.severity === 'error' ? '#ff6666' : '#ffaa00';\n        const issueId = `issue-${categoryKey}-${index}`;\n\n        html += `<div class=\"msd-hud-metric msd-issue-row\"\n          data-bus-event=\"issues:action\"\n          data-action=\"${issue.clickAction}\"\n          data-id=\"${issue.id}\"\n          data-overlay=\"${issue.overlay || ''}\"\n          data-select-type=\"${issue.clickAction === 'overlay' ? 'overlay' : issue.clickAction === 'routing' ? 'route' : issue.clickAction === 'performance' ? 'timer' : 'issue'}\"\n          data-select-id=\"${issue.overlay || issue.id}\"\n          onclick=\"__msdHudBus('issues:action',{action:'${issue.clickAction}',id:'${issue.id}',overlay:'${issue.overlay || ''}'});__msdHudBus('select:set',{type:'${issue.clickAction === 'overlay' ? 'overlay' : issue.clickAction === 'routing' ? 'route' : issue.clickAction === 'performance' ? 'timer' : 'issue'}',id:'${issue.overlay || issue.id}',source:'issues'})\"\n          style=\"cursor:pointer; border-left:3px solid ${severityColor}; padding-left:6px; margin:2px 0;\">\n          <div style=\"display: flex; justify-content: space-between; align-items: center;\">\n            <span class=\"msd-hud-metric-name\">[${issue.code || issue.type}]</span>\n            <span style=\"color: ${severityColor}; font-size: 10px;\">${issue.severity.toUpperCase()}</span>\n          </div>\n          <div style=\"font-size: 10px; color: #ccc; margin-top: 2px;\">${issue.message}</div>\n        </div>`;\n      });\n\n      if (categoryIssues.length > 6) {\n        html += `<div style=\"font-size: 9px; opacity: 0.6; text-align: center;\">\n          ... ${categoryIssues.length - 6} more ${category.label.toLowerCase()} issues\n        </div>`;\n      }\n\n      html += '</div>';\n    });\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Packs Panel for MSD HUD\n * Shows pack collections and provenance information\n */\n\nexport class PacksPanel {\n  captureData() {\n    const collections = {};\n    const provenance = {};\n    const summary = {};\n\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      if (pipelineInstance) {\n        const resolvedModel = pipelineInstance.getResolvedModel?.();\n        if (resolvedModel) {\n          // Capture collections\n          const collectionTypes = ['animations', 'timelines', 'rules', 'profiles', 'overlays'];\n          collectionTypes.forEach(type => {\n            collections[type] = resolvedModel[type] || [];\n            summary[type] = collections[type].length;\n          });\n\n          // Capture provenance if available\n          if (resolvedModel.__provenance) {\n            Object.assign(provenance, resolvedModel.__provenance);\n          }\n        }\n\n        // Try to get merged config for additional info\n        const merged = pipelineInstance.merged;\n        if (merged) {\n          Object.keys(collections).forEach(type => {\n            if (merged[type]) {\n              collections[type] = merged[type];\n              summary[type] = merged[type].length;\n            }\n          });\n\n          if (merged.__provenance) {\n            Object.assign(provenance, merged.__provenance);\n          }\n        }\n      }\n    } catch (e) {\n      console.warn('[PacksPanel] Data capture failed:', e);\n    }\n\n    return { collections, provenance, summary };\n  }\n\n  renderHtml(packsData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Packs & Collections</h3>';\n\n    const { collections, provenance, summary } = packsData;\n\n    // Summary section\n    if (summary && Object.keys(summary).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Collection Summary</h4>';\n      html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;font-size:10px;\">';\n\n      Object.entries(summary).forEach(([type, count]) => {\n        const color = count > 0 ? '#66ff99' : '#666';\n        html += `<span style=\"background:#222;color:${color};padding:2px 4px;border:1px solid #444;border-radius:3px;\">\n          ${type}:${count}\n        </span>`;\n      });\n      html += '</div></div>';\n    }\n\n    // Provenance section (if available)\n    if (provenance && Object.keys(provenance).some(k => Object.keys(provenance[k] || {}).length > 0)) {\n      html += '<div class=\"msd-hud-section\"><h4>Provenance Sample</h4>';\n\n      const allEntries = [];\n      Object.entries(provenance).forEach(([collection, items]) => {\n        Object.entries(items || {}).forEach(([id, chain]) => {\n          allEntries.push({ collection, id, chain });\n        });\n      });\n\n      // Show first 8 entries\n      allEntries.slice(0, 8).forEach(entry => {\n        const shortId = entry.id.length > 15 ? entry.id.substring(0, 12) + '...' : entry.id;\n        const chainStr = (entry.chain || [])\n          .map(c => `${c.layer_id}${c.overridden ? '*' : ''}`)\n          .join(' → ');\n\n        html += `<div class=\"msd-hud-metric\" style=\"margin:2px 0;\">\n          <div style=\"display:flex;justify-content:space-between;\">\n            <span class=\"msd-hud-metric-name\">${entry.collection}:${shortId}</span>\n          </div>\n          <div style=\"font-size:9px;color:#888;margin-top:1px;font-family:monospace;\">\n            ${chainStr || 'No chain data'}\n          </div>\n        </div>`;\n      });\n\n      if (allEntries.length > 8) {\n        html += `<div style=\"font-size:9px;opacity:0.6;text-align:center;\">\n          ... ${allEntries.length - 8} more items\n        </div>`;\n      }\n\n      html += '</div>';\n    }\n\n    // Collections detail section\n    if (collections && Object.keys(collections).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Collections Detail</h4>';\n\n      Object.entries(collections).forEach(([type, items]) => {\n        if (!Array.isArray(items) || items.length === 0) return;\n\n        html += `<div style=\"margin-bottom:6px;\">\n          <div style=\"font-weight:bold;font-size:11px;color:#ffaa00;\">${type} (${items.length})</div>`;\n\n        // Show first few items with badges\n        items.slice(0, 6).forEach(item => {\n          if (!item || !item.id) return;\n\n          const badges = [];\n          if (item.__meta?.origin_pack) {\n            const pack = item.__meta.origin_pack;\n            if (pack === 'builtin:core') badges.push({ text: 'core', color: '#555' });\n            else if (pack.startsWith('builtin:')) badges.push({ text: 'builtin', color: '#663399' });\n            else if (pack.startsWith('external:')) badges.push({ text: 'ext', color: '#cc6600' });\n            else badges.push({ text: 'user', color: '#996515' });\n          }\n\n          if (item.__meta?.overridden) badges.push({ text: 'mod', color: '#8a6d00' });\n          if (item.__meta?.removed) badges.push({ text: 'rm', color: '#702020' });\n\n          const badgeHtml = badges.map(b =>\n            `<span style=\"background:${b.color};color:#fff;padding:0 3px;margin-left:4px;border-radius:2px;font-size:8px;\">\n              ${b.text}\n            </span>`\n          ).join('');\n\n          const shortId = item.id.length > 20 ? item.id.substring(0, 17) + '...' : item.id;\n          html += `<div style=\"margin-left:10px;font-size:10px;margin:1px 0;\">\n            ${shortId}${badgeHtml}\n          </div>`;\n        });\n\n        if (items.length > 6) {\n          html += `<div style=\"margin-left:10px;font-size:9px;color:#666;\">\n            ... ${items.length - 6} more\n          </div>`;\n        }\n\n        html += '</div>';\n      });\n\n      html += '</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No pack data available</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Rules Panel for MSD HUD\n * Shows rules engine evaluation trace and rule activity\n */\n\nexport class RulesPanel {\n  captureData() {\n    const rules = [];\n    const trace = [];\n    const stats = {};\n\n    try {\n      const pipelineInstance = window.__msdDebug?.pipelineInstance;\n      const rulesEngine = pipelineInstance?.systemsManager?.rulesEngine ||\n                         pipelineInstance?.rulesEngine;\n\n      if (rulesEngine) {\n        // Get trace information - FIXED: Handle non-array trace\n        const engineTrace = rulesEngine.getTrace?.() || [];\n        if (Array.isArray(engineTrace)) {\n          trace.push(...engineTrace);\n        } else if (engineTrace) {\n          // Handle case where trace might be a single object or other format\n          trace.push(engineTrace);\n        }\n\n        // Get rules list - FIXED: Handle non-array rules\n        const rulesList = rulesEngine.rules || rulesEngine._rules || [];\n        if (Array.isArray(rulesList)) {\n          rulesList.forEach(rule => {\n            const traceInfo = trace.find(t => t && t.id === rule.id);\n            rules.push({\n              id: rule.id,\n              priority: rule.priority || 0,\n              lastMatch: traceInfo?.matched || false,\n              matchCount: rule._matchCount || rule.matchCount || 0,\n              conditions: rule.when ? Object.keys(rule.when).length : 0,\n              actions: rule.apply ? Object.keys(rule.apply).length : 0\n            });\n          });\n        }\n\n        // Calculate stats\n        stats.totalRules = rules.length;\n        stats.matchedRules = rules.filter(r => r.lastMatch).length;\n        stats.totalMatches = rules.reduce((sum, r) => sum + r.matchCount, 0);\n        stats.avgPriority = rules.length > 0 ?\n          rules.reduce((sum, r) => sum + r.priority, 0) / rules.length : 0;\n      }\n    } catch (e) {\n      console.warn('[RulesPanel] Data capture failed:', e);\n      // ADDED: Provide fallback data structure to prevent rendering errors\n      return {\n        rules: [],\n        trace: [],\n        stats: {\n          totalRules: 0,\n          matchedRules: 0,\n          totalMatches: 0,\n          avgPriority: 0\n        }\n      };\n    }\n\n    return { rules, trace, stats };\n  }\n\n  renderHtml(rulesData) {\n    let html = '<div class=\"msd-hud-panel\"><h3>Rules Engine</h3>';\n\n    const { rules, trace, stats } = rulesData;\n\n    // Stats section\n    if (stats && Object.keys(stats).length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Statistics</h4>';\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Total Rules</span>\n        <span class=\"msd-hud-metric-value\">${stats.totalRules}</span>\n      </div>`;\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Currently Matched</span>\n        <span class=\"msd-hud-metric-value\" style=\"color:${stats.matchedRules > 0 ? '#66ff99' : '#666'};\">\n          ${stats.matchedRules}\n        </span>\n      </div>`;\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Total Matches</span>\n        <span class=\"msd-hud-metric-value\">${stats.totalMatches}</span>\n      </div>`;\n      html += `<div class=\"msd-hud-metric\">\n        <span class=\"msd-hud-metric-name\">Avg Priority</span>\n        <span class=\"msd-hud-metric-value\">${stats.avgPriority.toFixed(1)}</span>\n      </div>`;\n      html += '</div>';\n    }\n\n    // Rules list section\n    if (rules && rules.length > 0) {\n      html += '<div class=\"msd-hud-section\"><h4>Rules Activity</h4>';\n\n      // Sort by priority descending, then by match status\n      const sortedRules = [...rules].sort((a, b) => {\n        if (a.lastMatch !== b.lastMatch) return b.lastMatch - a.lastMatch; // matched first\n        return b.priority - a.priority; // then by priority\n      });\n\n      sortedRules.slice(0, 10).forEach(rule => {\n        const shortId = rule.id.length > 20 ? rule.id.substring(0, 17) + '...' : rule.id;\n        const matchStatus = rule.lastMatch ? '✓' : '○';\n        const matchColor = rule.lastMatch ? '#66ff99' : '#666';\n\n        html += `<div class=\"msd-hud-metric\"\n          data-select-type=\"rule\"\n          data-select-id=\"${rule.id}\"\n          onclick=\"__msdHudBus('select:set',{type:'rule',id:'${rule.id}',source:'rules'})\"\n          style=\"margin:2px 0;padding:2px;${rule.lastMatch ? 'background:rgba(102,255,153,0.1);' : ''} border-radius:3px;\">\n          <div style=\"display:flex;justify-content:space-between;align-items:center;\">\n            <span class=\"msd-hud-metric-name\">${shortId}</span>\n            <div style=\"display:flex;gap:8px;align-items:center;\">\n              <span style=\"font-size:10px;color:#888;\">p:${rule.priority}</span>\n              <span style=\"color:${matchColor};font-weight:bold;\">${matchStatus}</span>\n            </div>\n          </div>\n          <div style=\"font-size:10px;color:#888;margin-top:1px;\">\n            ${rule.conditions} conditions • ${rule.actions} actions • ${rule.matchCount} matches\n          </div>\n        </div>`;\n      });\n\n      if (sortedRules.length > 10) {\n        html += `<div style=\"font-size:10px;text-align:center;color:#666;margin-top:4px;\">\n          ... ${sortedRules.length - 10} more rules\n        </div>`;\n      }\n\n      html += '</div>';\n    } else {\n      html += '<div class=\"msd-hud-section\">No rules engine data available</div>';\n    }\n\n    html += '</div>';\n    return html;\n  }\n}\n","/**\n * Export Panel for MSD HUD\n * Interactive configuration export/import/diff tools\n * Based on legacy HudController export functionality\n */\n\nexport class ExportPanel {\n  constructor() {\n    // FIXED: Only log construction once, not on every refresh\n    console.log('[ExportPanel] Constructor called');\n    this.initialized = false;\n    this.initialized = true;\n  }\n\n  exportCollapsed() {\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      if (pipeline?.exportCollapsedJson) {\n        const json = pipeline.exportCollapsedJson(true);\n        this.downloadJson(json, 'msd-config-collapsed');\n        this.updateTextarea('collapsed', json);\n      }\n    } catch (e) {\n      console.error('[ExportPanel] Collapsed export failed:', e);\n    }\n  }\n\n  exportFull(includeMeta = false) {\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      if (pipeline?.exportFullSnapshotJson) {\n        const options = includeMeta ? { include_meta: true } : {};\n        const json = pipeline.exportFullSnapshotJson(options, true);\n        const filename = includeMeta ? 'msd-snapshot-with-meta' : 'msd-snapshot';\n        this.downloadJson(json, filename);\n        this.updateTextarea('full', json);\n      }\n    } catch (e) {\n      console.error('[ExportPanel] Full export failed:', e);\n    }\n  }\n\n  diffItem() {\n    // Future implementation\n  }\n\n  clearTextarea(type) {\n    this.updateTextarea(type, '');\n  }\n\n  copyToClipboard(type) {\n    const textarea = document.getElementById(`export-${type}-textarea`);\n    if (textarea && textarea.value) {\n      navigator.clipboard.writeText(textarea.value).then(() => {\n        this.showFeedback('Copied to clipboard!');\n      }).catch(e => {\n        console.warn('Clipboard copy failed:', e);\n        textarea.select();\n        textarea.setSelectionRange(0, 99999);\n      });\n    }\n  }\n\n  downloadJson(jsonString, filename) {\n    try {\n      const blob = new Blob([jsonString], { type: 'application/json' });\n      const url = URL.createObjectURL(blob);\n      const a = document.createElement('a');\n      a.href = url;\n      a.download = `${filename}-${Date.now()}.json`;\n      document.body.appendChild(a);\n      a.click();\n      document.body.removeChild(a);\n      URL.revokeObjectURL(url);\n\n      this.showFeedback(`Downloaded: ${a.download}`);\n    } catch (e) {\n      console.error('[ExportPanel] Download failed:', e);\n    }\n  }\n\n  updateTextarea(type, content) {\n    const textarea = document.getElementById(`export-${type}-textarea`);\n    if (textarea) {\n      textarea.value = content;\n    }\n  }\n\n  showFeedback(message, type = 'info') {\n    const colors = {\n      info: '#00ffff',\n      success: '#00ff00',\n      warning: '#ffaa00',\n      error: '#ff6666'\n    };\n\n    const feedback = document.createElement('div');\n    feedback.style.cssText = `\n      position: fixed;\n      top: 20px;\n      left: 50%;\n      transform: translateX(-50%);\n      background: rgba(0, 0, 0, 0.9);\n      color: ${colors[type]};\n      padding: 8px 16px;\n      border: 1px solid ${colors[type]};\n      border-radius: 4px;\n      font-size: 12px;\n      z-index: 1000001;\n      pointer-events: none;\n    `;\n    feedback.textContent = message;\n    document.body.appendChild(feedback);\n\n    setTimeout(() => feedback.remove(), 3000);\n  }\n\n  captureData() {\n    const pipeline = window.__msdDebug?.pipelineInstance;\n\n    // FIXED: Add more detailed debugging for export panel visibility\n    const data = {\n      available: !!pipeline,\n      hasExportMethods: !!(pipeline?.exportCollapsedJson && pipeline?.exportFullSnapshotJson),\n      hasDiffMethod: !!pipeline?.diffItem,\n      collections: ['animations', 'timelines', 'rules', 'profiles', 'overlays'],\n      initialized: this.initialized,\n      globalHandlers: !!window.__msdExportPanel\n    };\n\n    // FIXED: Only log data capture issues, not every successful capture\n    if (!data.available) {\n      console.warn('[ExportPanel] Pipeline not available for export functionality');\n    }\n\n    return data;\n  }\n\n  renderHtml(exportData) {\n    // FIXED: Add debug info to help troubleshoot rendering\n    if (!exportData.available) {\n      return `<h3>Export & Config</h3>\n        <div class=\"msd-hud-section msd-hud-error\">\n          Pipeline instance not available\n          <div style=\"font-size: 10px; color: #888; margin-top: 4px;\">\n            Initialized: ${exportData.initialized} | Handlers: ${exportData.globalHandlers}\n          </div>\n        </div>`;\n    }\n\n    let html = '<h3>Export & Config</h3>';\n\n    // Export Controls Section\n    html += '<div class=\"msd-hud-section\"><h4>Export Configuration</h4>';\n    html += '<div style=\"display:flex;flex-wrap:wrap;gap:4px;margin-bottom:8px;\">';\n\n    html += `<button data-bus-event=\"export:collapsed\" onclick=\"__msdHudBus('export:collapsed')\"\n      style=\"font-size:10px;padding:2px 6px;background:#333;color:#fff;border:1px solid #555;border-radius:3px;cursor:pointer;\">\n      Collapsed JSON\n    </button>`;\n\n    html += `<button data-bus-event=\"export:full\" onclick=\"__msdHudBus('export:full')\"\n      style=\"font-size:10px;padding:2px 6px;background:#333;color:#fff;border:1px solid #555;border-radius:3px;cursor:pointer;\">\n      Full Snapshot\n    </button>`;\n\n    html += `<button data-bus-event=\"export:full-meta\" onclick=\"__msdHudBus('export:full-meta')\"\n      style=\"font-size:10px;padding:2px 6px;background:#666;color:#fff;border:1px solid #888;border-radius:3px;cursor:pointer;\">\n      +Metadata\n    </button>`;\n\n    html += '</div>';\n\n    // Collapsed JSON textarea\n    html += '<div style=\"margin-bottom:6px;\">';\n    html += '<div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:2px;\">';\n    html += '<span style=\"font-size:11px;color:#ffaa00;\">Collapsed JSON:</span>';\n    html += '<div style=\"display:flex;gap:2px;\">';\n    html += `<button data-bus-event=\"export:copy\" onclick=\"__msdHudBus('export:copy',{type:'collapsed'})\" style=\"font-size:9px;padding:1px 4px;background:#444;color:#fff;border:1px solid #666;border-radius:2px;cursor:pointer;\">Copy</button>`;\n    html += `<button data-bus-event=\"export:clear\" onclick=\"__msdHudBus('export:clear',{type:'collapsed'})\" style=\"font-size:9px;padding:1px 4px;background:#666;color:#fff;border:1px solid #888;border-radius:2px;cursor:pointer;\">Clear</button>`;\n    html += '</div></div>';\n    html += `<textarea id=\"export-collapsed-textarea\" name=\"export-collapsed\" readonly\n      style=\"width:100%;height:80px;font-size:9px;font-family:monospace;background:#111;color:#ccc;border:1px solid #444;border-radius:3px;padding:4px;resize:vertical;\"></textarea>`;\n    html += '</div>';\n\n    // Full JSON textarea\n    html += '<div style=\"margin-bottom:6px;\">';\n    html += '<div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:2px;\">';\n    html += '<span style=\"font-size:11px;color:#ffaa00;\">Full Snapshot:</span>';\n    html += '<div style=\"display:flex;gap:2px;\">';\n    html += `<button data-bus-event=\"export:copy\" onclick=\"__msdHudBus('export:copy',{type:'full'})\" style=\"font-size:9px;padding:1px 4px;background:#444;color:#fff;border:1px solid #666;border-radius:2px;cursor:pointer;\">Copy</button>`;\n    html += `<button data-bus-event=\"export:clear\" onclick=\"__msdHudBus('export:clear',{type:'full'})\" style=\"font-size:9px;padding:1px 4px;background:#666;color:#fff;border:1px solid #888;border-radius:2px;cursor:pointer;\">Clear</button>`;\n    html += '</div></div>';\n    html += `<textarea id=\"export-full-textarea\" name=\"export-full\" readonly\n      style=\"width:100%;height:100px;font-size:9px;font-family:monospace;background:#111;color:#ccc;border:1px solid #444;border-radius:3px;padding:4px;resize:vertical;\"></textarea>`;\n    html += '</div>';\n\n    html += '</div>';\n\n    // Status\n    html += `<div class=\"msd-hud-section msd-hud-summary\">\n      Export: ${exportData.hasExportMethods ? '✅' : '❌'} •\n      Diff: ${exportData.hasDiffMethod ? '✅' : '❌'} •\n      Handlers: ${exportData.globalHandlers ? '✅' : '❌'} •\n      Ready for config management\n    </div>`;\n\n    return html;\n  }\n}\n","// Lightweight HUD Event Bus\nexport class HudEventBus {\n  constructor() {\n    this._listeners = new Map(); // event -> Set<fn>\n  }\n  on(event, fn) {\n    if (!this._listeners.has(event)) this._listeners.set(event, new Set());\n    this._listeners.get(event).add(fn);\n    return () => this.off(event, fn);\n  }\n  once(event, fn) {\n    const off = this.on(event, (p) => { off(); fn(p); });\n  }\n  off(event, fn) {\n    this._listeners.get(event)?.delete(fn);\n  }\n  emit(event, payload) {\n    const list = this._listeners.get(event);\n    if (list) {\n      list.forEach(fn => {\n        try { fn(payload); } catch (e) { /* swallow */ }\n      });\n    }\n    // Wildcard listeners\n    const any = this._listeners.get('*');\n    if (any) {\n      any.forEach(fn => {\n        try { fn({ event, payload }); } catch (_) {}\n      });\n    }\n  }\n  clear() {\n    this._listeners.clear();\n  }\n}\n\nexport class SelectionManager {\n  constructor(bus) {\n    this.bus = bus;\n    this.current = null;\n  }\n  set(type, id, meta = {}) {\n    if (!type || !id) return;\n    this.current = {\n      type,\n      id,\n      meta,\n      ts: Date.now()\n    };\n    this.bus?.emit('select:changed', this.current);\n  }\n  clear() {\n    this.current = null;\n    this.bus?.emit('select:changed', null);\n  }\n  get() {\n    return this.current;\n  }\n}\n","/**\n * Overlays Inspection Panel\n * Lists resolved overlays with quick highlight and structural info.\n */\nexport class OverlaysPanel {\n  captureData() {\n    const overlays = [];\n    const stats = { total: 0, byType: {} };\n\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      const model = pipeline?.getResolvedModel?.();\n      if (model?.overlays) {\n        model.overlays.forEach(o => {\n          stats.total++;\n            stats.byType[o.type] = (stats.byType[o.type] || 0) + 1;\n          overlays.push({\n            id: o.id,\n            type: o.type || 'unknown',\n            anchor: o.anchor,\n            attach_to: o.attach_to,\n            profileCount: Array.isArray(o._profiles) ? o._profiles.length : 0,\n            patchCount: Array.isArray(o._patches) ? o._patches.length : 0,\n            styleSourceCount: Array.isArray(o._styleSources) ? o._styleSources.length : 0,\n            finalStyle: o.finalStyle || o.style || {},\n            smooth: o.smooth,\n            channel: o.channel,\n            meta: {\n              fromPacks: o.__meta?.origin_pack,\n              overridden: !!o.__meta?.overridden\n            }\n          });\n        });\n      }\n    } catch (e) {\n      console.warn('[OverlaysPanel] captureData failed:', e);\n    }\n\n    return { overlays, stats };\n  }\n\n  // REPLACED: Simplified, mount-scoped highlight with SVG-safe styling\n  highlightOverlay(id) {\n    try {\n      if (!id) return;\n      const mount = window.__msdDebug?.pipelineInstance?.mountElement ||\n                    window.__msdDebug?.mountElement;\n      if (!mount) {\n        console.warn('[OverlaysPanel] No mountElement available for highlight');\n        return;\n      }\n\n      this._ensureHighlightStyles();\n\n      // Search only inside mount (and shadow root if present)\n      const roots = [mount];\n      if (mount.shadowRoot) roots.push(mount.shadowRoot);\n\n      const matches = [];\n      const selectorExact = `[data-overlay-id=\"${CSS.escape(id)}\"]`;\n      const selectorId = `#${CSS.escape(id)}`;\n\n      roots.forEach(root => {\n        root.querySelectorAll(selectorExact).forEach(el => matches.push(el));\n        const byId = root.querySelector(selectorId);\n        if (byId && !matches.includes(byId)) matches.push(byId);\n      });\n\n      if (matches.length === 0) {\n        console.warn('[OverlaysPanel] No nodes found for overlay', id);\n        this._toast(`Overlay not found: ${id}`, '#ff4444');\n        return;\n      }\n\n      // Apply highlight to each match\n      matches.forEach(node => {\n        this._applyElementHighlight(node, '#ff66ff');\n        // If group/container, highlight child paths too\n        if (node.tagName && node.tagName.toLowerCase() === 'g') {\n          node.querySelectorAll('path, line, polyline, polygon, rect, circle, ellipse').forEach(child => {\n            this._applyElementHighlight(child, '#ff66ff', true);\n          });\n        }\n      });\n\n      this._toast(`Overlay: ${id}`, '#ff66ff');\n    } catch (e) {\n      console.warn('[OverlaysPanel] highlightOverlay failed:', e);\n    }\n  }\n\n  // NEW: Apply highlight with restoration\n  _applyElementHighlight(node, color, isChild = false) {\n    const tag = (node.tagName || '').toLowerCase();\n    const isSvg =\n      ['path','g','line','polyline','polygon','rect','circle','ellipse'].includes(tag) ||\n      node instanceof SVGElement;\n\n    const DURATION = 3000;\n\n    if (isSvg) {\n      // Store originals only once\n      if (!node.dataset._msdHl) {\n        node.dataset._msdHl = '1';\n        node.dataset._msdPrevStroke = node.getAttribute('stroke') || node.style.stroke || '';\n        node.dataset._msdPrevStrokeW = node.getAttribute('stroke-width') || node.style.strokeWidth || '';\n        node.dataset._msdPrevFilter = node.style.filter || '';\n      }\n      // Emphasize\n      node.style.stroke = color;\n      if (tag !== 'g') {\n        node.style.strokeWidth = '4';\n      }\n      node.style.filter = 'drop-shadow(0 0 6px ' + color + ')';\n      node.classList.add('msd-overlay-highlighted');\n\n      setTimeout(() => {\n        // Restore\n        if (node.dataset._msdPrevStroke !== undefined) {\n          if (node.dataset._msdPrevStroke) node.style.stroke = node.dataset._msdPrevStroke;\n          else node.style.removeProperty('stroke');\n        }\n        if (node.dataset._msdPrevStrokeW !== undefined) {\n            if (node.dataset._msdPrevStrokeW) node.style.strokeWidth = node.dataset._msdPrevStrokeW;\n            else node.style.removeProperty('stroke-width');\n        }\n        if (node.dataset._msdPrevFilter !== undefined) {\n          if (node.dataset._msdPrevFilter) node.style.filter = node.dataset._msdPrevFilter;\n          else node.style.removeProperty('filter');\n        }\n        node.classList.remove('msd-overlay-highlighted');\n      }, DURATION);\n\n    } else {\n      // Non-SVG element highlight\n      if (!node.dataset._msdHlBox) {\n        node.dataset._msdHlBox = '1';\n        node.dataset._msdPrevOutline = node.style.outline || '';\n        node.dataset._msdPrevBoxShadow = node.style.boxShadow || '';\n        node.dataset._msdPrevFilter = node.style.filter || '';\n      }\n      node.style.outline = `3px solid ${color}`;\n      node.style.boxShadow = `0 0 10px ${color}`;\n      node.style.filter = `drop-shadow(0 0 6px ${color})`;\n      node.classList.add('msd-overlay-highlighted');\n\n      setTimeout(() => {\n        if (node.dataset._msdPrevOutline !== undefined) {\n          if (node.dataset._msdPrevOutline) node.style.outline = node.dataset._msdPrevOutline;\n          else node.style.removeProperty('outline');\n        }\n        if (node.dataset._msdPrevBoxShadow !== undefined) {\n          if (node.dataset._msdPrevBoxShadow) node.style.boxShadow = node.dataset._msdPrevBoxShadow;\n          else node.style.removeProperty('box-shadow');\n        }\n        if (node.dataset._msdPrevFilter !== undefined) {\n          if (node.dataset._msdPrevFilter) node.style.filter = node.dataset._msdPrevFilter;\n          else node.style.removeProperty('filter');\n        }\n        node.classList.remove('msd-overlay-highlighted');\n      }, DURATION);\n    }\n  }\n\n  // UPDATED: ensure styles (kept minimal)\n  _ensureHighlightStyles() {\n    if (document.getElementById('msd-overlay-highlight-style')) return;\n    const style = document.createElement('style');\n    style.id = 'msd-overlay-highlight-style';\n    style.textContent = `\n      .msd-overlay-highlighted {\n        transition: outline .15s, box-shadow .15s;\n      }\n    `;\n    document.head.appendChild(style);\n  }\n\n  analyzeOverlay(id) {\n    try {\n      const pipeline = window.__msdDebug?.pipelineInstance;\n      const model = pipeline?.getResolvedModel?.();\n      const overlay = model?.overlays?.find(o => o.id === id);\n      if (!overlay) {\n        console.warn('[OverlaysPanel] analyzeOverlay: overlay not found', id);\n        this._toast('Overlay not found', '#ff4444');\n        return;\n      }\n\n      // Console diagnostics\n      console.group(`🛰 Overlay Analysis: ${id}`);\n      console.table([{\n        id: overlay.id,\n        type: overlay.type,\n        anchor: overlay.anchor,\n        attach_to: overlay.attach_to,\n        channel: overlay.channel,\n        smooth: overlay.smooth,\n        profiles: (overlay._profiles || []).length,\n        patches: (overlay._patches || []).length,\n        styleSources: (overlay._styleSources || []).length\n      }]);\n      if (overlay.finalStyle || overlay.style) {\n        console.log('Final Style:', overlay.finalStyle || overlay.style);\n      }\n      if (overlay._styleSources) {\n        console.log('Style Sources:', overlay._styleSources);\n      }\n      if (overlay._patches) {\n        console.log('Rule Patches:', overlay._patches);\n      }\n      if (overlay.__meta) {\n        console.log('Metadata:', overlay.__meta);\n      }\n      console.groupEnd();\n\n      // Popup\n      this._showOverlayPopup(overlay);\n    } catch (e) {\n      console.warn('[OverlaysPanel] analyzeOverlay failed:', e);\n    }\n  }\n\n  _showOverlayPopup(overlay) {\n    const existing = document.getElementById('msd-overlay-popup');\n    if (existing) existing.remove();\n\n    const popup = document.createElement('div');\n    popup.id = 'msd-overlay-popup';\n    popup.style.cssText = `\n      position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);\n      background:rgba(0,0,0,0.95);color:#ff66ff;\n      border:2px solid #ff66ff;border-radius:8px;\n      padding:14px 16px;z-index:1000003;\n      font-family:monospace;font-size:12px;\n      max-width:480px;max-height:70vh;overflow:auto;\n      box-shadow:0 4px 18px rgba(255,102,255,0.4);\n    `;\n\n    const stylePreview = (() => {\n      try {\n        const s = JSON.stringify(overlay.finalStyle || overlay.style || {}, null, 2);\n        return s.length > 520 ? s.slice(0, 517) + '...' : s;\n      } catch { return '{}'; }\n    })();\n\n    const sources = (overlay._styleSources || []).map(s => `${s.kind}:${s.id}`).join(', ') || '—';\n    const patches = (overlay._patches || []).map(p => p.ruleId || p.id).join(', ') || '—';\n    const profiles = (overlay._profiles || []).map(p => p.id || p).join(', ') || '—';\n\n    popup.innerHTML = `\n      <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:6px;\">\n        <h3 style=\"margin:0;color:#ffaaee;\">Overlay: ${overlay.id}</h3>\n        <button style=\"background:#331133;color:#fff;border:1px solid #553366;border-radius:4px;padding:2px 8px;cursor:pointer;font-size:11px;\"\n          onclick=\"document.getElementById('msd-overlay-popup')?.remove()\">\n          Close\n        </button>\n      </div>\n      <div style=\"font-size:11px;line-height:1.4;color:#ddd;\">\n        <strong>Type:</strong> ${overlay.type || 'n/a'}<br>\n        <strong>Anchor:</strong> ${overlay.anchor || '—'} → <strong>Attach:</strong> ${overlay.attach_to || '—'}<br>\n        <strong>Channel:</strong> ${overlay.channel || '—'} • <strong>Smooth:</strong> ${overlay.smooth ? 'yes':'no'}<br>\n        <strong>Profiles:</strong> ${profiles}<br>\n        <strong>Sources:</strong> ${sources}<br>\n        <strong>Patches:</strong> ${patches}<br>\n        <strong>Meta:</strong> ${overlay.__meta ? Object.keys(overlay.__meta).join(', ') : '—'}\n      </div>\n      <div style=\"margin-top:8px;\">\n        <div style=\"color:#ffaaee;font-size:11px;margin-bottom:4px;\">Final Style</div>\n        <pre style=\"margin:0;background:#111;color:#ccc;padding:8px;border:1px solid #552255;border-radius:4px;font-size:10px;max-height:200px;overflow:auto;\">${stylePreview}</pre>\n      </div>\n      <div style=\"margin-top:8px;text-align:right;\">\n        <button\n          style=\"background:#552255;color:#fff;border:1px solid #aa55aa;border-radius:4px;padding:3px 10px;cursor:pointer;font-size:11px;\"\n          onclick=\"navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(overlay.finalStyle || overlay.style || {})},null,2))\">\n          Copy Style\n        </button>\n        <button\n          style=\"background:#331133;color:#fff;border:1px solid #553366;border-radius:4px;padding:3px 10px;cursor:pointer;font-size:11px;margin-left:6px;\"\n          onclick=\"document.getElementById('msd-overlay-popup')?.remove()\">\n          Done\n        </button>\n      </div>\n    `;\n\n    document.body.appendChild(popup);\n    setTimeout(() => {\n      if (popup.parentElement) popup.style.opacity = '1';\n    }, 10);\n\n    // Auto-remove after 15s if untouched\n    setTimeout(() => popup.parentElement && popup.remove(), 25000);\n  }\n\n  // NEW: analyzeOverlay remains (unchanged) above/below if already present\n\n  // NEW helper: ensure CSS\n  _ensureHighlightStyles() {\n    if (document.getElementById('msd-overlay-highlight-style')) return;\n    const style = document.createElement('style');\n    style.id = 'msd-overlay-highlight-style';\n    style.textContent = `\n      .msd-overlay-highlighted {\n        transition: outline .15s, box-shadow .15s;\n      }\n    `;\n    document.head.appendChild(style);\n  }\n\n  // NEW helper: locate overlay model object\n  _findOverlayModel(id) {\n    try {\n      const model = window.__msdDebug?.pipelineInstance?.getResolvedModel?.();\n      return model?.overlays?.find(o => o.id === id);\n    } catch {\n      return null;\n    }\n  }\n\n  // NEW helper: create bounding box from overlay anchor + attach_to if anchors exist\n  _highlightBoundingBoxFromModel(overlay, id) {\n    try {\n      const anchorId = overlay.anchor;\n      const attachId = overlay.attach_to;\n      const mount =\n        window.__msdDebug?.pipelineInstance?.mountElement ||\n        window.__msdDebug?.mountElement ||\n        document;\n\n      const anchorEl = anchorId ? mount.querySelector(`[data-anchor-id=\"${CSS.escape(anchorId)}\"],#${CSS.escape(anchorId)}`) : null;\n      const attachEl = attachId ? mount.querySelector(`[data-anchor-id=\"${CSS.escape(attachId)}\"],#${CSS.escape(attachId)}`) : null;\n\n      if (!anchorEl && !attachEl) {\n        // fallback to mount bounding box\n        const rect = mount.getBoundingClientRect();\n        this._spawnBoundingBox(rect, id, '#ff66ff');\n        return;\n      }\n\n      // Compute combined rect\n      const rects = [];\n      if (anchorEl) rects.push(anchorEl.getBoundingClientRect());\n      if (attachEl) rects.push(attachEl.getBoundingClientRect());\n\n      const minX = Math.min(...rects.map(r => r.left));\n      const minY = Math.min(...rects.map(r => r.top));\n      const maxR = Math.max(...rects.map(r => r.right));\n      const maxB = Math.max(...rects.map(r => r.bottom));\n\n      this._spawnBoundingBox(\n        { left: minX, top: minY, width: maxR - minX, height: maxB - minY },\n        id,\n        '#ff66ff'\n      );\n    } catch (e) {\n      console.warn('[OverlaysPanel] _highlightBoundingBoxFromModel failed:', e);\n    }\n  }\n\n  // NEW helper: spawn absolute box\n  _spawnBoundingBox(rect, id, color) {\n    if (!rect) return;\n    const box = document.createElement('div');\n    box.className = 'msd-overlay-box-highlight';\n    box.style.left = rect.left + 'px';\n    box.style.top = rect.top + 'px';\n    box.style.width = rect.width + 'px';\n    box.style.height = rect.height + 'px';\n    box.dataset.overlayBoxFor = id;\n    document.body.appendChild(box);\n    setTimeout(() => box.remove(), 3000);\n    this._toast(`Overlay (bbox): ${id}`, color);\n  }\n\n  _toast(msg, color = '#ff66ff') {\n    const el = document.createElement('div');\n    el.style.cssText = `\n      position:fixed;top:18px;right:18px;\n      background:#000;padding:4px 10px;\n      border:1px solid ${color};color:${color};\n      font:10px monospace;z-index:1000002;\n      border-radius:4px;opacity:.95;\n    `;\n    el.textContent = msg;\n    document.body.appendChild(el);\n    setTimeout(() => el.remove(), 1600);\n  }\n\n  renderHtml(data) {\n    const { overlays = [], stats = {} } = data;\n    let html = '<div class=\"msd-hud-panel\"><h3>Overlays</h3>';\n    html += `<style>\n      .msd-overlay-highlighted { outline:3px solid #ff66ff !important; }\n    </style>`;\n    html += '<div class=\"msd-hud-section\"><h4>Stats</h4>';\n    html += `<div class=\"msd-hud-metric\"><span class=\"msd-hud-metric-name\">Total</span><span class=\"msd-hud-metric-value\">${stats.total || 0}</span></div>`;\n    Object.entries(stats.byType || {}).slice(0,6).forEach(([type,count]) => {\n      html += `<div class=\"msd-hud-metric\" style=\"font-size:10px;\">\n        <span class=\"msd-hud-metric-name\">${type}</span>\n        <span class=\"msd-hud-metric-value\">${count}</span>\n      </div>`;\n    });\n    html += '</div>';\n\n    if (!overlays.length) {\n      html += '<div class=\"msd-hud-section\">No overlays</div></div>';\n      return html;\n    }\n\n    html += '<div class=\"msd-hud-section\"><h4>Overlay List</h4>';\n    overlays.slice(0,25).forEach(o => {\n      const shortId = o.id.length > 22 ? o.id.slice(0,19)+'...' : o.id;\n      const badge = o.meta.overridden ? ' • mod' : '';\n      const stylePreview = (() => {\n        try {\n          const json = JSON.stringify(o.finalStyle);\n          return json.length > 50 ? json.slice(0,47)+'...' : json;\n        } catch { return ''; }\n      })();\n      html += `<div\n        data-select-type=\"overlay\"\n        data-select-id=\"${o.id}\"\n        style=\"cursor:pointer;border:1px solid #222;padding:4px;border-radius:4px;margin:4px 0;\"\n        onclick=\"__msdHudBus('select:set',{type:'overlay',id:'${o.id}',source:'overlays'});__msdHudBus('overlay:highlight',{id:'${o.id}'})\"\n      >\n        <div style=\"display:flex;justify-content:space-between;align-items:center;\">\n          <span style=\"color:#aaa;\">${shortId}${badge}</span>\n          <span style=\"color:#ff66ff;font-size:11px;\">${o.type}</span>\n        </div>\n        <div style=\"font-size:10px;color:#888;margin-top:2px;\">\n          A:${o.anchor || '-'} → ${o.attach_to || '-'} ${o.channel ? '• ch:'+o.channel : ''} ${o.smooth ? '• smooth':''}\n        </div>\n        <div style=\"font-size:9px;color:#666;margin-top:2px;\">\n          src: p${o.profileCount} / s${o.styleSourceCount} / r${o.patchCount}\n        </div>\n        <div style=\"font-size:9px;color:#555;overflow:hidden;text-overflow:ellipsis;margin-top:2px;\">\n          ${stylePreview}\n        </div>\n        <div style=\"margin-top:4px;text-align:right;\">\n          <button\n            onclick=\"event.stopPropagation();__msdHudBus('overlay:highlight',{id:'${o.id}'});__msdHudBus('overlay:analyze',{id:'${o.id}'})\"\n            style=\"font-size:9px;padding:2px 6px;background:#331133;color:#ffccff;border:1px solid #553355;border-radius:3px;cursor:pointer;\">\n            Analyze\n          </button>\n        </div>\n      </div>`;\n    });\n    if (overlays.length > 25) {\n      html += `<div style=\"font-size:9px;opacity:.6;text-align:center;margin-top:4px;\">... ${overlays.length - 25} more</div>`;\n    }\n    html += '</div></div>';\n    return html;\n  }\n}\n","/**\n * MSD HUD Manager - Coordinates all debug panels\n * Provides development interface for monitoring MSD v1 pipeline\n */\n\nimport { PerformancePanel } from './panels/PerformancePanel.js';\nimport { ValidationPanel } from './panels/ValidationPanel.js';\nimport { DataSourcePanel } from './panels/DataSourcePanel.js';\nimport { RoutingPanel } from './panels/RoutingPanel.js';\nimport { ChannelTrendPanel } from './panels/ChannelTrendPanel.js';\nimport { FlagsPanel } from './panels/FlagsPanel.js';\nimport { IssuesPanel } from './panels/IssuesPanel.js';\nimport { PacksPanel } from './panels/PacksPanel.js';\nimport { RulesPanel } from './panels/RulesPanel.js';\nimport { ExportPanel } from './panels/ExportPanel.js';\nimport { HudEventBus } from './hudService.js'; // existing\nimport { SelectionManager } from './hudService.js'; // ADDED\nimport { OverlaysPanel } from './panels/OverlaysPanel.js'; // ADDED\n\n// FIXED: Move debug verification to constructor only, not on every import\nconsole.log('[MsdHudManager] Importing ExportPanel class');\n\nexport class MsdHudManager {\n  constructor() {\n    // FIXED: Test ExportPanel instantiation only once during construction\n    console.log('[MsdHudManager] Testing ExportPanel instantiation...');\n    try {\n      const testExportPanel = new ExportPanel();\n      console.log('[MsdHudManager] ExportPanel test successful');\n    } catch (e) {\n      console.error('[MsdHudManager] ExportPanel instantiation failed:', e);\n    }\n\n    this.bus = new HudEventBus(); // ADDED\n    window.__msdHudBus = (evt, payload) => this.bus.emit(evt, payload || {}); // ADDED global helper\n\n    this.panels = {\n      issues: new IssuesPanel(),\n      flags: new FlagsPanel(),\n      performance: new PerformancePanel(),\n      export: new ExportPanel(),\n      rules: new RulesPanel(),\n      packs: new PacksPanel(),\n      overlays: new OverlaysPanel(), // ADDED\n      routing: new RoutingPanel(),\n      channelTrend: new ChannelTrendPanel(),\n      dataSources: new DataSourcePanel(),\n      validation: new ValidationPanel()\n    };\n\n    // FIXED: Only log panel creation once during construction\n    console.log('[MsdHudManager] Created panels:', Object.keys(this.panels));\n\n    this.state = {\n      visible: false,\n      activePanel: 'performance',\n      refreshRate: 2000,\n      lastRefresh: 0,\n      panelVisibility: {\n        issues: true,\n        flags: true,\n        performance: true,\n        export: true,\n        rules: true,\n        packs: true,\n        overlays: true, // ADDED (default visible)\n        routing: false,\n        channelTrend: false,\n        dataSources: false,\n        validation: false\n      },\n      panelOrder: ['issues','flags','performance','export','rules','packs','overlays','routing','channelTrend','dataSources','validation'], // UPDATED\n      compactMode: false,\n      autoPosition: true,\n      panelManagerOpen: false,\n      hudWidth: 420,\n      resizable: false\n    };\n\n    // FIXED: Only log state once during construction\n    console.log('[MsdHudManager] Initial panel order:', this.state.panelOrder);\n\n    this.hudElement = null;\n    this.refreshInterval = null;\n    this.mountElement = null;\n\n    this.dragState = {\n      isDragging: false,\n      startX: 0,\n      startY: 0,\n      startLeft: 0,\n      startTop: 0\n    };\n\n    this._setupGlobalPanelControls();\n    this.keyboardEnabled = true;\n    this._setupKeyboardShortcuts();\n\n    // ADDED: Provide bus to panels (optional future use)\n    Object.values(this.panels).forEach(p => { p.bus = this.bus; });\n\n    this._registerBusHandlers(); // ADDED\n    this.selection = new SelectionManager(this.bus); // ADDED\n    this._registerSelectionHandlers(); // ADDED\n\n    // ADDED: Bind core instance methods to prevent context loss in external handlers\n    this.show = this.show.bind(this);\n    this.hide = this.hide.bind(this);\n    this.toggle = this.toggle.bind(this);\n    this.refresh = this.refresh.bind(this);\n    this.setRefreshRate = this.setRefreshRate.bind(this);\n  }\n\n  // ADDED: Setup global panel control handlers\n  _setupGlobalPanelControls() {\n    if (window.__msdHudPanelControls) return;\n\n    const self = this;\n    window.__msdHudPanelControls = {\n      togglePanel: function(panelName) {\n        self.state.panelVisibility[panelName] = !self.state.panelVisibility[panelName];\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n      },\n\n      setCompactMode: function(enabled) {\n        self.state.compactMode = enabled;\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n      },\n\n      setAutoPosition: function(enabled) {\n        self.state.autoPosition = enabled;\n        if (enabled) {\n          self._autoPositionHud();\n        }\n      },\n\n      resetPanelLayout: function() {\n        // FIXED: Reset to default visibility including export panel\n        Object.keys(self.state.panelVisibility).forEach(panel => {\n          self.state.panelVisibility[panel] = ['issues', 'flags', 'performance', 'export'].includes(panel);\n        });\n        self.state.compactMode = false;\n        self.state.autoPosition = true;\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n        self._autoPositionHud();\n      },\n\n      movePanel: function(panelName, direction) {\n        const currentOrder = [...self.state.panelOrder];\n        const currentIndex = currentOrder.indexOf(panelName);\n\n        if (currentIndex === -1) return;\n\n        const newIndex = direction === 'up' ?\n          Math.max(0, currentIndex - 1) :\n          Math.min(currentOrder.length - 1, currentIndex + 1);\n\n        // Swap positions\n        [currentOrder[currentIndex], currentOrder[newIndex]] =\n        [currentOrder[newIndex], currentOrder[currentIndex]];\n\n        self.state.panelOrder = currentOrder;\n        // FIXED: Force immediate refresh to show state changes\n        self.updateHudContent();\n      },\n\n      // ENHANCED: Set up panel manager toggle handler\n      togglePanelManager: function() {\n        self.state.panelManagerOpen = !self.state.panelManagerOpen;\n\n        const manager = document.getElementById('msd-panel-manager');\n        if (manager) {\n          manager.style.display = self.state.panelManagerOpen ? 'block' : 'none';\n\n          // FIXED: Always attach event listeners when toggling\n          if (self.state.panelManagerOpen) {\n            setTimeout(() => self._attachPanelManagerEventListeners(), 10);\n          }\n        }\n\n        console.log('[MsdHudManager] Panel manager toggled:', self.state.panelManagerOpen);\n      },\n\n      // ADDED: Close panel manager handler\n      closePanelManager: function() {\n        self.state.panelManagerOpen = false;\n\n        const manager = document.getElementById('msd-panel-manager');\n        if (manager) {\n          manager.style.display = 'none';\n        }\n\n        console.log('[MsdHudManager] Panel manager closed');\n      }\n    };\n  }\n\n  // ADDED: Auto-positioning logic\n  _autoPositionHud() {\n    if (!this.state.autoPosition || !this.hudElement) return;\n\n    const viewportWidth = window.innerWidth;\n    const viewportHeight = window.innerHeight;\n    const hudWidth = this.state.hudWidth; // ENHANCED: Use configurable width\n\n    // Calculate optimal height based on visible panels\n    const visiblePanelCount = Object.values(this.state.panelVisibility).filter(Boolean).length;\n    const estimatedHeight = Math.min(\n      viewportHeight * 0.9, // ENHANCED: Increased from 0.85 to 0.9\n      200 + (visiblePanelCount * (this.state.compactMode ? 80 : 140)) // ENHANCED: Increased panel height estimate\n    );\n\n    // Check for Home Assistant header and sidebar\n    const haHeader = document.querySelector('app-header, ha-app-layout app-header');\n    const haSidebar = document.querySelector('ha-sidebar, app-drawer-layout ha-sidebar');\n\n    const headerHeight = haHeader ? haHeader.offsetHeight : 0;\n    const sidebarWidth = haSidebar && !haSidebar.hasAttribute('collapsed') ?\n      haSidebar.offsetWidth : 0;\n\n    // Smart positioning algorithm\n    let left, top;\n\n    // Try right side first (most common)\n    left = viewportWidth - hudWidth - 20;\n\n    // If sidebar takes up left space, ensure we don't overlap\n    if (sidebarWidth > 0 && left < sidebarWidth + 20) {\n      left = Math.max(sidebarWidth + 20, viewportWidth - hudWidth - 20);\n    }\n\n    // If still not enough space, try left side\n    if (left < 20) {\n      left = 20;\n    }\n\n    // Vertical positioning accounting for header\n    top = Math.max(headerHeight + 20, 20);\n\n    // Ensure bottom doesn't go off screen\n    if (top + estimatedHeight > viewportHeight - 20) {\n      top = Math.max(headerHeight + 20, viewportHeight - estimatedHeight - 20);\n    }\n\n    // ADDED: Smooth positioning transition\n    this.hudElement.style.transition = 'all 0.3s ease';\n    this.hudElement.style.left = left + 'px';\n    this.hudElement.style.top = top + 'px';\n    this.hudElement.style.right = 'auto';\n\n    // Remove transition after animation\n    setTimeout(() => {\n      this.hudElement.style.transition = '';\n    }, 300);\n\n    console.log(`[MsdHudManager] Auto-positioned to (${left}, ${top}) avoiding header:${headerHeight}px sidebar:${sidebarWidth}px`);\n  }\n\n  // ADDED: Handle window resize for auto-positioning\n  _setupResizeHandler() {\n    if (this._resizeSetup) return;\n    this._resizeSetup = true;\n\n    let resizeTimeout;\n    window.addEventListener('resize', () => {\n      if (this.state.autoPosition && this.state.visible) {\n        clearTimeout(resizeTimeout);\n        resizeTimeout = setTimeout(() => {\n          this._autoPositionHud();\n        }, 250);\n      }\n    });\n  }\n\n  /**\n   * Initialize with mount element from pipeline\n   * @param {HTMLElement} mountElement - Mount element from pipeline\n   */\n  init(mountElement) {\n    // Store mount element for pipeline context but don't use it for HUD mounting\n    this.mountElement = mountElement;\n\n    // ENHANCED: Store mount element in debug interface for panels to access\n    if (window.__msdDebug) {\n      window.__msdDebug.mountElement = mountElement;\n    }\n\n    // ADDED: Setup centralized debug status access for panels\n    this._setupDebugStatusHelper();\n\n    console.log('[MsdHudManager] Initialized with pipeline mount element reference');\n  }\n\n  // ADDED: Centralized debug status access for all panels\n  _setupDebugStatusHelper() {\n    if (window.__msdDebug?.getDebugStatusSilent) return; // Already setup\n\n    const W = typeof window !== 'undefined' ? window : {};\n    W.__msdDebug = W.__msdDebug || {};\n\n    W.__msdDebug.getDebugStatusSilent = function() {\n      try {\n        // Try debugManager first (preferred)\n        const pipelineInstance = W.__msdDebug?.pipelineInstance;\n        const debugManager = pipelineInstance?.systemsManager?.debugManager;\n        if (debugManager?.getSnapshot) {\n          return debugManager.getSnapshot();\n        }\n\n        // Fallback to debug._state directly (no console output)\n        const debug = W.__msdDebug?.debug;\n        if (debug?._state) {\n          return { ...debug._state };\n        }\n\n        // Last resort fallback\n        return { enabled: false, initialized: false };\n      } catch (e) {\n        return { enabled: false, initialized: false, error: e.message };\n      }\n    };\n  }\n\n  _registerBusHandlers() {\n    const { routing, performance, flags, export: exp, dataSources, issues, overlays } = this.panels;\n\n    // Routing\n    this.bus.on('routing:highlight', ({ id }) => routing?.highlightRoute?.(id));\n    this.bus.on('routing:analyze', ({ id }) => routing?.analyzeRoute?.(id));\n    this.bus.on('routing:set-filter', ({ key, value }) => routing?.setFilter?.(key, value));\n    this.bus.on('routing:update-cost', ({ key, value }) => routing?.updateCostFilter?.(key, value));\n    this.bus.on('routing:finalize-cost', () => routing?.finalizeCostFilter?.());\n    this.bus.on('routing:focus-set', ({ field, focus }) => routing?.setInputFocus?.(field, focus));\n\n    // Performance\n    this.bus.on('performance:clear-all', () => performance?.clearAllTimers?.());\n    this.bus.on('performance:export', () => performance?.exportData?.());\n    this.bus.on('performance:reset-timer', ({ timer }) => performance?.resetTimer?.(timer));\n    this.bus.on('performance:set-threshold', ({ timer, value }) => performance?.setThreshold?.(timer, value));\n\n    // Flags\n    this.bus.on('flags:toggle', ({ feature }) => flags?.toggleFeature?.(feature));\n    this.bus.on('flags:scale-adjust', ({ dir }) => flags?.adjustScale?.(dir));\n    this.bus.on('flags:scale-set', ({ scale }) => flags?.setScale?.(scale));\n    this.bus.on('flags:refresh', () => flags?.refreshDebug?.());\n\n    // Export\n    this.bus.on('export:collapsed', () => exp?.exportCollapsed?.());\n    this.bus.on('export:full', () => exp?.exportFull?.(false));\n    this.bus.on('export:full-meta', () => exp?.exportFull?.(true));\n    this.bus.on('export:copy', ({ type }) => exp?.copyToClipboard?.(type));\n    this.bus.on('export:clear', ({ type }) => exp?.clearTextarea?.(type));\n\n    // Data sources\n    this.bus.on('datasource:inspect', ({ id }) => dataSources?.inspectEntity?.(id));\n    this.bus.on('datasource:refresh-subs', () => dataSources?.refreshSubscriptions?.());\n    this.bus.on('datasource:clear-history', () => dataSources?.clearHistory?.());\n\n    // Issues\n    this.bus.on('issues:action', ({ action, id, overlay }) => issues?.handleIssueClick?.(action, id, overlay));\n\n    // ADDED: Overlay highlight bus\n    this.bus.on('overlay:highlight', ({ id }) => overlays?.highlightOverlay?.(id));\n    // ADDED: overlay analyze\n    this.bus.on('overlay:analyze', ({ id }) => overlays?.analyzeOverlay?.(id));\n\n    // Generic\n    this.bus.on('hud:refresh', () => this.refresh());\n  }\n\n  _registerSelectionHandlers() { // ADDED\n    this.bus.on('select:set', ({ type, id, source }) => {\n      this.selection.set(type, id, { source });\n      // Optional contextual highlight actions\n      if (type === 'route') {\n        this.bus.emit('routing:highlight', { id });\n      } else if (type === 'overlay') {\n        this.bus.emit('overlay:highlight', { id });\n      }\n      this.refresh();\n    });\n    this.bus.on('select:clear', () => {\n      this.selection.clear();\n      this.refresh();\n    });\n    // Passive listener to apply highlight after render\n    this.bus.on('select:changed', () => {\n      // If HUD already rendered, apply highlight without full refresh\n      this._applySelectionHighlight();\n      this._updateSelectionBadge();\n    });\n  }\n\n  _applySelectionHighlight() { // ADDED\n    if (!this.hudElement) return;\n    const sel = this.selection.get();\n    // Clear old\n    this.hudElement.querySelectorAll('.msd-selected').forEach(el => el.classList.remove('msd-selected'));\n    if (!sel) return;\n    // Match any element with matching data-select-type & id\n    const matches = this.hudElement.querySelectorAll(\n      `[data-select-type=\"${sel.type}\"][data-select-id=\"${CSS.escape(sel.id)}\"]`\n    );\n    matches.forEach(el => el.classList.add('msd-selected'));\n  }\n\n  _updateSelectionBadge() { // ADDED\n    if (!this.hudElement) return;\n    const badge = this.hudElement.querySelector('#msd-selection-badge');\n    if (!badge) return;\n    const sel = this.selection.get();\n    if (!sel) {\n      badge.innerHTML = '';\n      return;\n    }\n    badge.innerHTML = `\n      <span style=\"background:#222;border:1px solid #444;padding:2px 6px;border-radius:4px;font-size:10px;display:inline-flex;gap:6px;align-items:center;\">\n        <span style=\"color:#ffaa00;\">${sel.type}</span>\n        <span style=\"color:#00ffff;max-width:160px;overflow:hidden;text-overflow:ellipsis;\">${sel.id}</span>\n        <button data-bus-event=\"select:clear\"\n          onclick=\"__msdHudBus('select:clear')\"\n          style=\"background:#333;color:#ccc;border:1px solid #555;border-radius:3px;font-size:9px;cursor:pointer;padding:0 4px;\">\n          ✕\n        </button>\n      </span>\n    `;\n  }\n\n  // ADDED: Toggle collapse\n  togglePanelCollapse(panelName) {\n    this.state.collapsedPanels[panelName] = !this.state.collapsedPanels[panelName];\n    // Lightweight re-render (no data recapture)\n    this._applyCollapseState();\n  }\n\n  // ADDED: Toggle focus (exclusive view)\n  toggleFocusPanel(panelName) {\n    if (this.state.focusPanel === panelName) {\n      this.state.focusPanel = null;\n    } else {\n      this.state.focusPanel = panelName;\n    }\n    this.updateHudContent();\n  }\n\n  // ADDED: Apply collapse styling post-render\n  _applyCollapseState() {\n    if (!this.hudElement) return;\n    const wrappers = this.hudElement.querySelectorAll('.msd-hud-panel[data-panel]');\n    wrappers.forEach(w => {\n      const name = w.getAttribute('data-panel');\n      const collapsed = this.state.collapsedPanels[name];\n      if (collapsed) {\n        w.classList.add('collapsed');\n      } else {\n        w.classList.remove('collapsed');\n      }\n      // Update indicator symbol\n      const h3 = w.querySelector(':scope h3');\n      const ind = h3?.querySelector('.msd-collapse-indicator');\n      if (ind) ind.textContent = collapsed ? '+' : '−';\n      // Focus visibility\n      if (this.state.focusPanel && this.state.focusPanel !== name) {\n        w.classList.add('focus-hidden');\n      } else {\n        w.classList.remove('focus-hidden');\n      }\n      // Filter handling\n      if (this.state.filterTerm) {\n        const term = this.state.filterTerm.toLowerCase();\n        const matches = name.toLowerCase().includes(term);\n        if (!matches) {\n          w.classList.add('filter-hidden');\n        } else {\n          w.classList.remove('filter-hidden');\n        }\n      } else {\n        w.classList.remove('filter-hidden');\n      }\n    });\n    this._updateFocusBadgeInFooter();\n  }\n\n  // ADDED: Decorate panel headers after render\n  _decoratePanelHeaders() {\n    if (!this.hudElement) return;\n    const wrappers = this.hudElement.querySelectorAll('.msd-hud-panel[data-panel]');\n    wrappers.forEach(w => {\n      const name = w.getAttribute('data-panel');\n      const h3 = w.querySelector(':scope h3'); // first h3 inside nested structure\n      if (!h3 || h3.dataset.enhanced === '1') return;\n      h3.dataset.enhanced = '1';\n      h3.style.cursor = 'pointer';\n      // Insert collapse indicator\n      const indicator = document.createElement('span');\n      indicator.className = 'msd-collapse-indicator';\n      indicator.style.cssText = 'margin-left:6px;font-weight:bold;color:#ffaa00;';\n      indicator.textContent = this.state.collapsedPanels[name] ? '+' : '−';\n      h3.appendChild(indicator);\n      h3.title = 'Click: Collapse/Expand • Alt+Click: Focus panel';\n      h3.addEventListener('click', (e) => {\n        e.preventDefault();\n        e.stopPropagation();\n        if (e.altKey) {\n          this.toggleFocusPanel(name);\n        } else {\n          this.togglePanelCollapse(name);\n        }\n      });\n    });\n    this._applyCollapseState();\n  }\n\n  // ADDED: Footer focus badge update\n  _updateFocusBadgeInFooter() {\n    if (!this.hudElement) return;\n    const footerFocus = this.hudElement.querySelector('#msd-focus-footer');\n    if (!footerFocus) return;\n    if (!this.state.focusPanel) {\n      footerFocus.innerHTML = '';\n      return;\n    }\n    footerFocus.innerHTML = `\n      <span style=\"background:#222;border:1px solid #444;padding:2px 6px;border-radius:4px;font-size:9px;\">\n        Focus: <strong style=\"color:#ffaa00;\">${this.state.focusPanel}</strong>\n        <button style=\"margin-left:6px;font-size:9px;background:#333;color:#ccc;border:1px solid #555;border-radius:3px;cursor:pointer;padding:0 4px;\"\n          onclick=\"__msdHudBus && window.__msdDebug?.hud?.manager?.toggleFocusPanel && window.__msdDebug.hud.manager.toggleFocusPanel('${this.state.focusPanel}')\">\n          Exit\n        </button>\n      </span>\n    `;\n  }\n\n  // ADDED: Quick filter apply (called on input)\n  setFilterTerm(term) {\n    this.state.filterTerm = term || '';\n    this._applyCollapseState();\n  }\n\n  createHudElement() {\n    if (this.hudElement) return;\n\n    // ENHANCED: Use configurable width and improved styling\n    this.hudElement = document.createElement('div');\n    this.hudElement.id = 'msd-debug-hud';\n    this.hudElement.style.cssText = `\n      position: fixed;\n      top: 10px;\n      right: 10px;\n      width: ${this.state.hudWidth}px;\n      max-height: 90vh;\n      background: rgba(0, 0, 0, 0.95);\n      border: 2px solid #00ffff;\n      border-radius: 8px;\n      color: #00ffff;\n      font-family: monospace;\n      font-size: 12px;\n      z-index: 1000000;\n      overflow-y: auto;\n      backdrop-filter: blur(10px);\n      box-shadow: 0 4px 20px rgba(0, 255, 255, 0.3);\n      cursor: move;\n      user-select: none;\n      ${this.state.resizable ? 'resize: horizontal; min-width: 300px; max-width: 600px;' : ''}\n    `;\n\n    // ADDED: Dragging functionality\n    this.setupDragging();\n\n    // Mount to document.body for full screen access\n    document.body.appendChild(this.hudElement);\n    this.updateHudContent();\n\n    this._attachDelegatedEvents(); // ADDED\n  }\n\n  _attachDelegatedEvents() {\n    if (this._delegatedEventsAttached || !this.hudElement) return;\n    this._delegatedEventsAttached = true;\n\n    const mapEvent = (domEvent) => {\n      this.hudElement.addEventListener(domEvent, (e) => {\n        const target = e.target.closest('[data-bus-event]');\n        if (!target || !this.hudElement.contains(target)) return;\n        // Build payload from data-* excluding busEvent\n        const { busEvent, ...rest } = Object.fromEntries(\n          Object.entries(target.dataset).map(([k, v]) => [k.replace(/-[a-z]/g, m => m[1].toUpperCase()), v])\n        );\n        // Numeric coercion for simple numbers\n        Object.keys(rest).forEach(k => {\n          if (/^-?\\d+(\\.\\d+)?$/.test(rest[k])) rest[k] = Number(rest[k]);\n        });\n        this.bus.emit(target.dataset.busEvent, rest);\n        if (domEvent === 'click') e.preventDefault();\n      }, true);\n    };\n\n    ['click', 'change', 'input', 'blur', 'focus'].forEach(mapEvent);\n    // ADDED: Direct listener for filter input (outside data-bus-event)\n    this.hudElement.addEventListener('input', (e) => {\n      const el = e.target;\n      if (el && el.id === 'msd-hud-filter') {\n        this.setFilterTerm(el.value);\n      }\n    }, true);\n  }\n\n  updateHudContent() {\n    if (!this.hudElement) return;\n\n    // Skip update if routing panel inputs are focused to prevent refresh interference\n    if (this.panels.routing?.shouldSkipRefresh?.()) {\n      return;\n    }\n\n    // FIXED: Preserve panel manager state without logging every refresh\n    const wasManagerOpen = this.state.panelManagerOpen;\n\n    const data = {};\n\n    // Capture data from all panels\n    Object.entries(this.panels).forEach(([panelName, panel]) => {\n      try {\n        if (panel.captureData) {\n          data[panelName] = panel.captureData();\n        }\n      } catch (error) {\n        console.warn(`[MsdHudManager] Panel ${panelName} data capture failed:`, error);\n        data[panelName] = { error: error.message };\n      }\n    });\n\n    // Update timestamp\n    this.state.lastRefresh = Date.now();\n\n    // Render HTML\n    try {\n      const html = this.renderHudHtml(data);\n      this.hudElement.innerHTML = html;\n\n      // Apply compact mode class\n      if (this.state.compactMode) {\n        this.hudElement.classList.add('msd-hud-compact');\n      } else {\n        this.hudElement.classList.remove('msd-hud-compact');\n      }\n\n      this._attachPanelManagerEventListeners();\n      // ADDED: Apply selection highlight & badge after render\n      this._updateSelectionBadge();\n      this._applySelectionHighlight();\n      // REMOVED: _decoratePanelHeaders(), filter value restore, collapse/focus logic\n      // Reset filter input value after render\n      const f = this.hudElement.querySelector('#msd-hud-filter');\n      if (f && f.value !== this.state.filterTerm) f.value = this.state.filterTerm;\n\n      // Restore panel manager state after render\n      if (wasManagerOpen) {\n        this.state.panelManagerOpen = true;\n        const manager = document.getElementById('msd-panel-manager');\n        if (manager) {\n          manager.style.display = 'block';\n        }\n      }\n    } catch (error) {\n      console.error('[MsdHudManager] HUD render failed:', error);\n      this.hudElement.innerHTML = `\n        <div class=\"msd-hud-header\">\n          <span class=\"msd-hud-title\">MSD Debug HUD - Error</span>\n          <span class=\"msd-hud-close\" onclick=\"window.__msdDebug?.hud?.hide?.()\" title=\"Close\">✕</span>\n        </div>\n        <div style=\"padding:8px;color:#ff6666;\">\n          Render failed: ${error.message}\n        </div>\n      `;\n    }\n  }\n\n  renderHudHtml(data) {\n    const compactClass = this.state.compactMode ? 'msd-hud-compact' : '';\n    let html = `\n      <style>\n        #msd-debug-hud .msd-hud-header {\n          padding: 8px;\n          background: rgba(0,255,255,0.2);\n          border-bottom: 1px solid #00ffff;\n          display:flex;\n          justify-content:space-between;\n          align-items:center;\n          cursor:grab;\n        }\n        #msd-debug-hud .msd-hud-title { font-weight:bold; pointer-events:none; }\n        #msd-debug-hud .msd-hud-controls { font-size:10px; display:flex; gap:4px; }\n        #msd-debug-hud .msd-hud-close, #msd-debug-hud .msd-hud-refresh, #msd-debug-hud .msd-hud-menu {\n          cursor:pointer; padding:2px 6px; border-radius:3px;\n        }\n        #msd-debug-hud .msd-hud-close { background:rgba(255,0,0,0.7); }\n        #msd-debug-hud .msd-hud-refresh { background:rgba(0,255,0,0.7); }\n        #msd-debug-hud .msd-hud-menu { background:rgba(255,170,0,0.7); }\n        #msd-debug-hud .msd-hud-panel { padding:${this.state.compactMode ? '4px':'8px'}; border-bottom:1px solid rgba(0,255,255,0.3); }\n        #msd-debug-hud .msd-hud-panel.hidden { display:none; }\n        #msd-debug-hud .msd-hud-panel h3 {\n          margin:0 0 ${this.state.compactMode ? '4px':'8px'} 0;\n          color:#ffaa00; font-size:${this.state.compactMode ? '12px':'14px'};\n        }\n        #msd-debug-hud .msd-hud-section h4 { margin:6px 0 4px 0; color:#fff; font-size:12px; }\n        #msd-debug-hud .msd-hud-metric { display:flex; justify-content:space-between; margin:2px 0; font-size:11px; }\n        #msd-debug-hud .msd-hud-metric-name { color:#aaa; }\n        #msd-debug-hud .msd-hud-metric-value { color:#0ff; font-weight:bold; }\n        #msd-debug-hud .msd-hud-error { border-left:3px solid #ff0000; padding-left:6px; }\n        #msd-debug-hud .msd-hud-warning { border-left:3px solid #ffaa00; padding-left:6px; }\n        #msd-debug-hud .msd-hud-success { color:#00ff00; font-size:11px; text-align:center; padding:4px; }\n        #msd-debug-hud .msd-hud-summary { text-align:center; font-size:11px; padding:4px; background:rgba(255,170,0,0.2); }\n        #msd-debug-hud .msd-selected { outline:2px solid #ffaa00; background:rgba(255,170,0,0.12)!important; position:relative; }\n        #msd-debug-hud .msd-selected::after { content:'●'; position:absolute; top:2px; right:4px; font-size:8px; color:#ffaa00; }\n        #msd-debug-hud .msd-panel-controls {\n          padding:6px 8px;\n          background:rgba(0,0,0,0.35);\n          border-bottom:1px solid rgba(0,255,255,0.25);\n          font-size:10px;\n        }\n        #msd-debug-hud .msd-panel-controls h4 {\n          margin:4px 0 6px;\n          font-size:11px;\n          color:#ffaa00;\n        }\n        #msd-debug-hud .msd-panel-toggle-buttons {\n          display:flex;\n          flex-wrap:wrap;\n          gap:6px;\n          margin:4px 0 8px;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn {\n          cursor:pointer;\n          padding:3px 8px;\n          font-size:10px;\n          border:1px solid #044;\n          background:linear-gradient(#022,#011);\n          color:#0ff;\n          border-radius:14px;\n          line-height:1;\n          letter-spacing:.5px;\n          transition:all .18s;\n          position:relative;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn.active {\n          background:linear-gradient(#0ff,#066);\n          color:#000;\n          font-weight:bold;\n          box-shadow:0 0 6px #0ff;\n          border-color:#0aa;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn.inactive {\n          opacity:.45;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn:not(.active):hover {\n          opacity:.8;\n          border-color:#088;\n        }\n        #msd-debug-hud .msd-panel-toggle-btn:focus {\n          outline:1px solid #0ff;\n        }\n        #msd-debug-hud .msd-panel-controls .msd-panel-meta {\n          font-size:9px;\n          opacity:.65;\n          margin-top:2px;\n        }\n      </style>\n    `;\n    html += `\n      <div class=\"msd-hud-header\">\n        <span class=\"msd-hud-title\">MSD v1 Debug HUD</span>\n        <div id=\"msd-selection-badge\" style=\"flex:1;display:flex;justify-content:center;\"></div>\n        <div class=\"msd-hud-controls\">\n          <span class=\"msd-hud-menu\" onclick=\"window.__msdHudPanelControls?.togglePanelManager?.()\" title=\"Panel Settings\">⚙</span>\n          <span class=\"msd-hud-refresh\" onclick=\"window.__msdDebug?.hud?.refresh?.()\" title=\"Refresh\">⟳</span>\n          <span class=\"msd-hud-close\" onclick=\"window.__msdDebug?.hud?.hide?.()\" title=\"Close\">✕</span>\n        </div>\n      </div>\n    `;\n    // REMOVED: filter bar / focus exit button\n    html += this._renderPanelControls();\n\n    // FIXED: Debug panel rendering with detailed logging\n    let renderedPanelCount = 0;\n    let visiblePanelCount = 0;\n\n    this.state.panelOrder.forEach(panelName => {\n      const panel = this.panels[panelName];\n      if (!panel) {\n        console.warn(`[MsdHudManager] Panel '${panelName}' not found in panels object`);\n        return;\n      }\n\n      const isVisible = this.state.panelVisibility[panelName];\n      const hiddenClass = isVisible ? '' : 'hidden';\n\n      if (isVisible) {\n        visiblePanelCount++;\n      }\n\n      try {\n        const panelData = data[panelName] || {};\n\n        const panelHtml = panel.renderHtml(panelData);\n\n        // Wrap panel with visibility control\n        html += `<div class=\"msd-hud-panel ${hiddenClass}\" data-panel=\"${panelName}\">\n          ${panelHtml}\n        </div>`;\n\n        renderedPanelCount++;\n      } catch (error) {\n        console.error(`[MsdHudManager] Panel ${panelName} render failed:`, error);\n        html += `<div class=\"msd-hud-panel ${hiddenClass}\" data-panel=\"${panelName}\">\n          <h3>${panelName} (Error)</h3>\n          <div class=\"msd-hud-section\">Panel render failed: ${error.message}</div>\n        </div>`;\n\n        renderedPanelCount++;\n      }\n    });\n\n    const refreshAge = Math.round((Date.now() - this.state.lastRefresh) / 1000);\n\n    // FIXED: Correct panel counting in footer\n    html += `<div style=\"padding: 4px; font-size: 10px; text-align: center; color: #666;\">\n      ${visiblePanelCount}/${renderedPanelCount} panels visible • Updated ${refreshAge}s ago • ${this.state.refreshRate / 1000}s\n      <div style=\"font-size: 9px; margin-top: 2px; opacity: 0.7;\">\n        Shortcuts: Ctrl+H toggle • Ctrl+R refresh • Ctrl+P panels • Ctrl+K compact • 1-9 toggle panels\n      </div>\n      <div style=\"font-size: 8px; margin-top: 1px; opacity: 0.5;\">\n        Panels: [${this.state.panelOrder.join(', ')}] | Available: [${Object.keys(this.panels).join(', ')}]\n      </div>\n    </div>`;\n\n    return html;\n  }\n\n  // ADDED: Missing startRefresh method\n  startRefresh() {\n    this.stopRefresh(); // Clear any existing interval\n\n    if (this.state.refreshRate > 0) {\n      this.refreshInterval = setInterval(() => {\n        if (this.state.visible) {\n          this.updateHudContent();\n        }\n      }, this.state.refreshRate);\n    }\n  }\n\n  // ADDED: Missing stopRefresh method\n  stopRefresh() {\n    if (this.refreshInterval) {\n      clearInterval(this.refreshInterval);\n      this.refreshInterval = null;\n    }\n  }\n\n  // ADDED: Missing toggle method\n  toggle() {\n    // FIXED: Harden against lost context (runtime \"this.show is not a function\")\n    if (!this || !this.state) return;\n    const isVisible = !!this.state.visible;\n    if (isVisible) {\n      if (typeof this.hide === 'function') this.hide();\n    } else {\n      if (typeof this.show === 'function') this.show();\n    }\n  }\n\n  // ADDED: Missing setRefreshRate method\n  setRefreshRate(rate) {\n    const numRate = parseInt(rate);\n    if (isNaN(numRate) || numRate < 0) return;\n\n    this.state.refreshRate = numRate;\n\n    if (this.state.visible) {\n      this.startRefresh(); // Restart with new rate\n    }\n  }\n\n  // ADDED: Dragging implementation\n  setupDragging() {\n    const startDrag = (e) => {\n      e.preventDefault();\n      this.dragState.isDragging = true;\n      this.dragState.startX = e.clientX;\n      this.dragState.startY = e.clientY;\n\n      const rect = this.hudElement.getBoundingClientRect();\n      this.dragState.startLeft = rect.left;\n      this.dragState.startTop = rect.top;\n\n      this.hudElement.style.cursor = 'grabbing';\n      document.addEventListener('mousemove', handleDrag);\n      document.addEventListener('mouseup', endDrag);\n    };\n\n    const handleDrag = (e) => {\n      if (!this.dragState.isDragging) return;\n\n      const deltaX = e.clientX - this.dragState.startX;\n      const deltaY = e.clientY - this.dragState.startY;\n\n      let newLeft = this.dragState.startLeft + deltaX;\n      let newTop = this.dragState.startTop + deltaY;\n\n      // Constrain to viewport\n      const rect = this.hudElement.getBoundingClientRect();\n      newLeft = Math.max(0, Math.min(window.innerWidth - rect.width, newLeft));\n      newTop = Math.max(0, Math.min(window.innerHeight - rect.height, newTop));\n\n      this.hudElement.style.left = newLeft + 'px';\n      this.hudElement.style.top = newTop + 'px';\n      this.hudElement.style.right = 'auto'; // Remove right positioning\n    };\n\n    const endDrag = () => {\n      this.dragState.isDragging = false;\n      this.hudElement.style.cursor = 'move';\n      document.removeEventListener('mousemove', handleDrag);\n      document.removeEventListener('mouseup', endDrag);\n    };\n\n    this.hudElement.addEventListener('mousedown', startDrag);\n  }\n\n  // ADDED: Manual refresh capability\n  refresh() {\n    if (this.state.visible && this.hudElement) {\n      this.updateHudContent();\n      console.log('[MsdHudManager] Manual refresh triggered');\n    }\n  }\n\n  // ADDED: Render panel controls interface\n  _renderPanelControls() {\n    let html = `<div class=\"msd-panel-controls\" id=\"msd-panel-manager\" style=\"display:${this.state.panelManagerOpen ? 'block':'none'};\">\n      <div style=\"display:flex;justify-content:space-between;align-items:center;margin-bottom:4px;\">\n        <strong style=\"letter-spacing:.5px;\">Panel Settings</strong>\n        <div style=\"display:flex;gap:4px;\">\n          <button data-action=\"compact\"\n            style=\"font-size:9px;padding:2px 6px;background:${this.state.compactMode ? '#ffaa00':'#222'};color:${this.state.compactMode ? '#000':'#ccc'};border:1px solid #555;border-radius:4px;cursor:pointer;\">\n            Compact\n          </button>\n          <button data-action=\"reset\"\n            style=\"font-size:9px;padding:2px 6px;background:#333;color:#ccc;border:1px solid #555;border-radius:4px;cursor:pointer;\">\n            Reset\n          </button>\n          <button data-action=\"close\"\n            style=\"font-size:9px;padding:2px 6px;background:#ff4444;color:#fff;border:1px solid #a00;border-radius:4px;cursor:pointer;\">\n            ✕\n          </button>\n        </div>\n      </div>\n      <div class=\"msd-panel-toggle-buttons\">`;\n\n    this.state.panelOrder.forEach(panelName => {\n      const enabled = !!this.state.panelVisibility[panelName];\n      html += `<button\n        class=\"msd-panel-toggle-btn ${enabled ? 'active':'inactive'}\"\n        data-panel-toggle=\"${panelName}\"\n        aria-pressed=\"${enabled}\"\n        title=\"Toggle ${panelName} panel\">\n        ${panelName}\n      </button>`;\n    });\n\n    html += `</div>\n      <div style=\"display:flex;align-items:center;gap:6px;margin-top:4px;\">\n        <label style=\"font-size:9px;opacity:.75;\">Refresh:</label>\n        <select id=\"msd-hud-refresh-rate\" name=\"refresh-rate\" data-action=\"refresh-rate\"\n          style=\"font-size:9px;background:#111;color:#0ff;border:1px solid #044;padding:2px 4px;border-radius:4px;\">\n          <option value=\"1000\" ${this.state.refreshRate===1000?'selected':''}>1s</option>\n          <option value=\"2000\" ${this.state.refreshRate===2000?'selected':''}>2s</option>\n          <option value=\"5000\" ${this.state.refreshRate===5000?'selected':''}>5s</option>\n          <option value=\"10000\" ${this.state.refreshRate===10000?'selected':''}>10s</option>\n        </select>\n        <div style=\"margin-left:auto;display:flex;gap:4px;\">\n          <button data-action=\"width-down\" title=\"Narrower\"\n            style=\"font-size:9px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">◀</button>\n          <button data-action=\"width-up\" title=\"Wider\"\n            style=\"font-size:9px;padding:2px 6px;background:#222;color:#0ff;border:1px solid #044;border-radius:4px;cursor:pointer;\">▶</button>\n        </div>\n      </div>\n      <div class=\"msd-panel-meta\">\n        Click buttons to toggle panels • Order: ${this.state.panelOrder.join(', ')}\n      </div>\n    </div>`;\n    return html;\n  }\n\n  _attachPanelManagerEventListeners() {\n    try {\n      const manager = document.getElementById('msd-panel-manager');\n      if (!manager) return;\n\n      const compactBtn = manager.querySelector('[data-action=\"compact\"]');\n      if (compactBtn) {\n        compactBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          window.__msdHudPanelControls?.setCompactMode(!this.state.compactMode);\n        };\n      }\n\n      const resetBtn = manager.querySelector('[data-action=\"reset\"]');\n      if (resetBtn) {\n        resetBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          window.__msdHudPanelControls?.resetPanelLayout();\n        };\n      }\n\n      const closeBtn = manager.querySelector('[data-action=\"close\"]');\n      if (closeBtn) {\n        closeBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          window.__msdHudPanelControls?.closePanelManager();\n        };\n      }\n\n      const toggleBtns = manager.querySelectorAll('[data-panel-toggle]');\n      toggleBtns.forEach(btn => {\n        const panelName = btn.getAttribute('data-panel-toggle');\n        if (panelName) {\n          btn.onclick = (e) => {\n            e.preventDefault();\n            e.stopPropagation();\n            window.__msdHudPanelControls?.togglePanel(panelName);\n          };\n        }\n      });\n\n      const refreshSelect = manager.querySelector('[data-action=\"refresh-rate\"]');\n      if (refreshSelect) {\n        refreshSelect.onchange = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          window.__msdDebug?.hud?.setRefreshRate?.(parseInt(refreshSelect.value));\n        };\n      }\n\n      const widthDownBtn = manager.querySelector('[data-action=\"width-down\"]');\n      if (widthDownBtn) {\n        widthDownBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          this.adjustWidth(-20);\n        };\n      }\n\n      const widthUpBtn = manager.querySelector('[data-action=\"width-up\"]');\n      if (widthUpBtn) {\n        widthUpBtn.onclick = (e) => {\n          e.preventDefault();\n          e.stopPropagation();\n          this.adjustWidth(20);\n        };\n      }\n    } catch (e) {\n      console.warn('[MsdHudManager] Failed to attach panel manager event listeners:', e);\n    }\n  }\n\n  adjustWidth(delta) {\n    const newWidth = Math.max(300, Math.min(600, this.state.hudWidth + delta));\n    if (newWidth !== this.state.hudWidth) {\n      this.state.hudWidth = newWidth;\n\n      if (this.hudElement) {\n        this.hudElement.style.width = newWidth + 'px';\n      }\n\n      console.log(`[MsdHudManager] HUD width adjusted to ${newWidth}px`);\n\n      setTimeout(() => this.updateHudContent(), 100);\n    }\n  }\n\n  // ADDED: Keyboard shortcut system\n  _setupKeyboardShortcuts() {\n    if (this._keyboardSetup) return;\n    this._keyboardSetup = true;\n\n    const self = this;\n    document.addEventListener('keydown', (e) => {\n      if (!self.keyboardEnabled || !self.state.visible) return;\n\n      // Only handle shortcuts when not in input fields\n      if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;\n\n      // Ctrl/Cmd + specific keys for HUD control\n      if (e.ctrlKey || e.metaKey) {\n        switch (e.key.toLowerCase()) {\n          case 'h':\n            e.preventDefault();\n            self.toggle();\n            break;\n\n          case 'r':\n            if (self.state.visible) {\n              e.preventDefault();\n              self.refresh();\n            }\n            break;\n\n          case 'p':\n            if (self.state.visible) {\n              e.preventDefault();\n              window.__msdHudPanelControls?.togglePanelManager?.();\n            }\n            break;\n\n          case 'k':\n            if (self.state.visible) {\n              e.preventDefault();\n              self.state.compactMode = !self.state.compactMode;\n              self.updateHudContent();\n            }\n            break;\n        }\n      }\n\n      // Number keys to toggle panels (1-9)\n      if (self.state.visible && !e.ctrlKey && !e.metaKey) {\n        const num = parseInt(e.key);\n        if (num >= 1 && num <= 9) {\n          const panelName = self.state.panelOrder[num - 1];\n          if (panelName) {\n            e.preventDefault();\n            window.__msdHudPanelControls?.togglePanel(panelName);\n          }\n        }\n      }\n    });\n\n    // Global shortcut to show HUD (Ctrl+Shift+H)\n    document.addEventListener('keydown', (e) => {\n      if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'h') {\n        e.preventDefault();\n        self.toggle();\n      }\n    });\n  }\n\n  // ADDED: Previously removed show() method (needed before binding in constructor)\n  show() {\n    if (this.state.visible) return;\n    this.state.visible = true;\n    this.createHudElement();\n    this.startRefresh();\n    this._setupResizeHandler();\n    if (window.__msdDebug) {\n      window.__msdDebug.hud = {\n        manager: this,\n        refresh: () => this.refresh(),\n        hide: () => this.hide(),\n        show: () => this.show(),\n        toggle: () => this.toggle(),\n        setRefreshRate: (rate) => this.setRefreshRate(rate),\n        bus: this.bus\n      };\n    }\n    if (this.state.autoPosition) {\n      setTimeout(() => this._autoPositionHud(), 100);\n    }\n    console.log('[MsdHudManager] HUD activated and exposed globally');\n  }\n\n  // ADDED: Previously removed hide() method\n  hide() {\n    if (!this.state.visible) return;\n    this.state.visible = false;\n    this.stopRefresh();\n    if (this.hudElement) {\n      this.hudElement.remove();\n      this.hudElement = null;\n    }\n    console.log('[MsdHudManager] HUD deactivated');\n  }\n}\n","/**\n * RollingBuffer - Efficient circular buffer for time-series data\n *\n * Features:\n * - Fixed capacity with automatic overflow handling\n * - Time-based slicing for windowed data access\n * - Optimized for sparkline/ribbon real-time updates\n * - Memory efficient - no array reallocations during normal operation\n */\nexport class RollingBuffer {\n  constructor(capacity = 100) {\n    if (capacity < 1) {\n      throw new Error('RollingBuffer capacity must be at least 1');\n    }\n\n    // Cap capacity at reasonable maximum for memory efficiency\n    this.capacity = Math.min(capacity, 1000);\n\n    // Pre-allocate arrays for performance\n    this._timestamps = new Array(capacity);\n    this._values = new Array(capacity);\n\n    // Circular buffer state\n    this._head = 0;      // Next write position\n    this._size = 0;      // Current number of items\n    this._full = false;  // Whether we've wrapped around\n\n    // Performance tracking\n    this._stats = {\n      pushes: 0,\n      overwrites: 0,\n      queries: 0\n    };\n\n    // Add coalescing state\n    this._lastPushTime = 0;\n    this._coalescingThresholdMs = 10; // Coalesce pushes within 10ms\n  }\n\n  /**\n   * Add a new data point (timestamp, value)\n   * Automatically handles capacity overflow by replacing oldest data\n   */\n  push(timestamp, value) {\n    // Enhanced timestamp validation\n    const now = Date.now();\n    const oneYearAgo = now - (365 * 24 * 60 * 60 * 1000);\n    const oneHourFromNow = now + (60 * 60 * 1000);\n\n    // Check for reasonable timestamp range\n    if (timestamp < oneYearAgo || timestamp > oneHourFromNow) {\n      console.warn(`[RollingBuffer] Suspicious timestamp: ${timestamp} (${new Date(timestamp).toISOString()}), current: ${now} (${new Date(now).toISOString()})`);\n      // Don't reject, but log for debugging\n    }\n\n    // Validate inputs\n    if (!Number.isFinite(timestamp) || timestamp < 0) {\n      console.warn('[RollingBuffer] Invalid timestamp:', timestamp);\n      return;\n    }\n\n    if (typeof value !== 'number' || !isFinite(value)) {\n      console.warn(`[RollingBuffer] Invalid value: ${value} for timestamp ${timestamp}`);\n      return;\n    }\n\n    // AGGRESSIVE COALESCING: Skip if very recent push with similar timestamp\n    if (this._size > 0 && (now - this._lastPushTime) < this._coalescingThresholdMs) {\n      // Check if timestamp is very close to last timestamp\n      const lastIndex = this._head === 0 ? this.capacity - 1 : this._head - 1;\n      const lastTimestamp = this._timestamps[lastIndex];\n\n      if (Math.abs(timestamp - lastTimestamp) < 1000) { // Within 1 second\n        // COALESCE: Just update the value, don't add new point\n        this._values[lastIndex] = value;\n        this._stats.overwrites++; // Count as coalescence\n        this._lastPushTime = now;\n        return;\n      }\n    }\n\n    // Store at current head position\n    this._timestamps[this._head] = timestamp;\n    this._values[this._head] = value;\n\n    // Update statistics\n    this._stats.pushes++;\n    if (this._full) {\n      this._stats.overwrites++;\n    }\n\n    // Advance head pointer (circular)\n    this._head = (this._head + 1) % this.capacity;\n\n    // Update size tracking\n    if (this._size < this.capacity) {\n      this._size++;\n    } else {\n      this._full = true;\n    }\n\n    this._lastPushTime = now;\n\n    console.log(`[RollingBuffer] Added point: ${value} at ${new Date(timestamp).toISOString()} (buffer size: ${this._size})`);\n  }\n\n  /**\n   * Get data as parallel arrays { t: timestamps[], v: values[] }\n   * Returns data in chronological order (oldest first)\n   */\n  getArrays() {\n    this._stats.queries++;\n\n    if (this._size === 0) {\n      return { t: [], v: [] };\n    }\n\n    const t = new Array(this._size);\n    const v = new Array(this._size);\n\n    // Calculate start position (oldest data)\n    const startPos = this._full ? this._head : 0;\n\n    // Copy data in chronological order\n    for (let i = 0; i < this._size; i++) {\n      const bufferIndex = (startPos + i) % this.capacity;\n      t[i] = this._timestamps[bufferIndex];\n      v[i] = this._values[bufferIndex];\n    }\n\n    return { t, v };\n  }\n\n  /**\n   * Get all data points in chronological order\n   * @returns {Array} Array of {t: timestamp, v: value} objects\n   */\n  getAll() {\n    this._stats.queries++;\n\n    if (this._size === 0) {\n      return [];\n    }\n\n    const result = new Array(this._size);\n\n    // Calculate start position (oldest data)\n    const startPos = this._full ? this._head : 0;\n\n    // Copy data in chronological order\n    for (let i = 0; i < this._size; i++) {\n      const bufferIndex = (startPos + i) % this.capacity;\n      result[i] = {\n        t: this._timestamps[bufferIndex],\n        v: this._values[bufferIndex]\n      };\n    }\n\n    return result;\n  }\n\n  /**\n   * Get data points newer than specified time window (in milliseconds)\n   * @param {number} msWindow - Time window in milliseconds from now\n   * @returns {object} { t: timestamps[], v: values[] }\n   */\n  sliceSince(msWindow) {\n    this._stats.queries++;\n\n    if (this._size === 0 || !Number.isFinite(msWindow) || msWindow <= 0) {\n      return { t: [], v: [] };\n    }\n\n    const cutoffTime = Date.now() - msWindow;\n    const { t, v } = this.getArrays();\n\n    // Find first index where timestamp >= cutoffTime\n    let startIndex = 0;\n    for (let i = 0; i < t.length; i++) {\n      if (t[i] >= cutoffTime) {\n        startIndex = i;\n        break;\n      }\n    }\n\n    // Return slice from startIndex to end\n    return {\n      t: t.slice(startIndex),\n      v: v.slice(startIndex)\n    };\n  }\n\n  /**\n   * Get the most recent data point\n   * @returns {object|null} { t: timestamp, v: value } or null if empty\n   */\n  last() {\n    if (this._size === 0) {\n      return null;\n    }\n\n    // Most recent item is just before current head position\n    const lastIndex = this._head === 0 ? this.capacity - 1 : this._head - 1;\n\n    return {\n      t: this._timestamps[lastIndex],\n      v: this._values[lastIndex]\n    };\n  }\n\n  /**\n   * Get the oldest data point\n   * @returns {object|null} { t: timestamp, v: value } or null if empty\n   */\n  first() {\n    if (this._size === 0) {\n      return null;\n    }\n\n    const firstIndex = this._full ? this._head : 0;\n\n    return {\n      t: this._timestamps[firstIndex],\n      v: this._values[firstIndex]\n    };\n  }\n\n  /**\n   * Clear all data while preserving capacity\n   */\n  clear() {\n    this._head = 0;\n    this._size = 0;\n    this._full = false;\n\n    // Performance: don't actually clear arrays, just reset pointers\n    // Data will be naturally overwritten as new data comes in\n  }\n\n  /**\n   * Get current buffer statistics\n   */\n  getStats() {\n    return {\n      capacity: this.capacity,\n      size: this._size,\n      utilization: this._size / this.capacity,\n      pushes: this._stats.pushes,\n      overwrites: this._stats.overwrites,\n      queries: this._stats.queries,\n      overwriteRate: this._stats.pushes > 0 ? this._stats.overwrites / this._stats.pushes : 0\n    };\n  }\n\n  /**\n   * Check if buffer is at full capacity\n   */\n  isFull() {\n    return this._full;\n  }\n\n  /**\n   * Get number of items currently stored\n   */\n  size() {\n    return this._size;\n  }\n\n  /**\n   * Debug method: validate internal consistency\n   * @returns {boolean} true if consistent\n   */\n  _validateConsistency() {\n    const issues = [];\n\n    // Check size bounds\n    if (this._size < 0 || this._size > this.capacity) {\n      issues.push(`Invalid size: ${this._size} (capacity: ${this.capacity})`);\n    }\n\n    // Check head bounds\n    if (this._head < 0 || this._head >= this.capacity) {\n      issues.push(`Invalid head: ${this._head} (capacity: ${this.capacity})`);\n    }\n\n    // Check full flag consistency\n    if (this._full && this._size !== this.capacity) {\n      issues.push(`Full flag inconsistent: full=${this._full}, size=${this._size}, capacity=${this.capacity}`);\n    }\n\n    // Check timestamp ordering (within stored data)\n    if (this._size > 1) {\n      const { t } = this.getArrays();\n      for (let i = 1; i < t.length; i++) {\n        if (t[i] < t[i-1]) {\n          issues.push(`Timestamp ordering violation at index ${i}: ${t[i-1]} -> ${t[i]}`);\n          break; // Only report first violation\n        }\n      }\n    }\n\n    if (issues.length > 0) {\n      console.warn('[RollingBuffer] Consistency issues:', issues);\n      return false;\n    }\n\n    return true;\n  }\n}\n","/**\n * MsdDataSource - Complete port of cb-lcars-data.js DataSource functionality\n *\n * Provides real-time Home Assistant entity subscriptions with:\n * - Coalescing and throttling for performance\n * - History preload capability\n * - Rolling buffer management\n * - Identical API and behavior to original implementation\n */\n\nimport { RollingBuffer } from './RollingBuffer.js';\n\n// Node.js polyfills for test environment\nconst isNode = typeof window === 'undefined';\nconst requestAnimationFrame = isNode\n  ? (callback) => setTimeout(callback, 16) // 60fps approximation\n  : window.requestAnimationFrame;\nconst cancelAnimationFrame = isNode\n  ? (id) => clearTimeout(id)\n  : window.cancelAnimationFrame;\n\nexport class MsdDataSource {\n  constructor(cfg, hass) {\n    this.cfg = { ...cfg };\n    this.hass = hass;\n\n    // Validate essential config\n    if (!this.cfg.entity) {\n      console.warn('[MsdDataSource] No entity specified in config');\n      this.cfg.entity = '';\n    }\n\n    // PORT: Complete buffer sizing logic from original\n    let wsSec = 60; // Default window\n    if (typeof cfg.windowSeconds === 'number' && isFinite(cfg.windowSeconds)) {\n      wsSec = Math.max(1, cfg.windowSeconds);\n    } else if (typeof cfg.windowSeconds === 'string') {\n      const ms = this._parseTimeWindowMs(cfg.windowSeconds);\n      if (Number.isFinite(ms)) {\n        wsSec = Math.max(1, Math.floor(ms / 1000));\n      }\n    }\n\n    // Buffer capacity: aim for ~10 points per second for the window\n    const capacity = Math.max(60, Math.floor(wsSec * 10));\n    this.buffer = new RollingBuffer(capacity);\n\n    // PORT: Complete timing configuration from original - MADE MORE AGGRESSIVE\n    const minEmitMs = Number.isFinite(cfg.minEmitMs) ? cfg.minEmitMs\n      : Number.isFinite(cfg.sampleMs) ? cfg.sampleMs : 100;\n\n    this.minEmitMs = Math.max(10, minEmitMs);\n\n    // MORE AGGRESSIVE coalescing by default\n    this.coalesceMs = Number.isFinite(cfg.coalesceMs)\n      ? Math.max(20, cfg.coalesceMs)  // Reduced from 30 to 20\n      : Math.max(20, Math.round(this.minEmitMs * 0.4));  // Reduced from 0.6 to 0.4\n\n    this.maxDelayMs = Number.isFinite(cfg.maxDelayMs)\n      ? Math.max(this.minEmitMs, cfg.maxDelayMs)\n      : Math.max(this.minEmitMs, this.coalesceMs * 3);  // Reduced from 4 to 3\n\n    this.emitOnSameValue = cfg.emitOnSameValue !== false; // Default true\n\n    // Subscription management\n    this.subscribers = new Set();\n    this.haUnsubscribe = null;\n\n    // PORT: Complete internal timing state from original\n    this._lastEmitTime = 0;\n    this._lastEmittedValue = null;\n    this._pendingRaf = 0;\n    this._pending = false;\n    this._pendingFirstTs = 0;\n    this._pendingCount = 0;\n\n    // Performance statistics\n    this._stats = {\n      emits: 0,\n      coalesced: 0,\n      skipsSameValue: 0,\n      received: 0,\n      invalid: 0,\n      historyLoaded: 0\n    };\n\n    // Lifecycle state\n    this._started = false;\n    this._destroyed = false;\n  }\n\n  /**\n   * ENHANCED: Preload historical data with multiple fallback strategies\n   * @private\n   */\n  async _preloadHistory() {\n    if (!this.hass?.callService || !this.cfg.entity) return;\n\n    // Check if history is enabled in config\n    const historyConfig = this.cfg.history || {};\n    if (historyConfig.enabled === false) return;\n\n    const hours = Math.max(1, Math.min(168, historyConfig.hours || 6));\n    const endTime = new Date();\n    const startTime = new Date(endTime.getTime() - hours * 3600000);\n\n    console.log(`[MsdDataSource] 📊 Preloading ${hours}h history for ${this.cfg.entity}`);\n\n    try {\n      // Strategy 1: Try Home Assistant's history service (most reliable)\n      await this._preloadWithHistoryService(startTime, endTime);\n    } catch (error) {\n      console.warn(`[MsdDataSource] History service failed for ${this.cfg.entity}, trying statistics:`, error.message);\n\n      try {\n        // Strategy 2: Fall back to enhanced statistics\n        await this._preloadWithStatistics(startTime, endTime);\n      } catch (statError) {\n        console.warn(`[MsdDataSource] Statistics failed, trying state history:`, statError.message);\n        // Strategy 3: Final fallback (existing _preloadStateHistory method)\n        await this._preloadStateHistory(startTime, endTime);\n      }\n    }\n\n    console.log(`[MsdDataSource] History preload complete: ${this._stats.historyLoaded} points loaded`);\n  }\n\n  /**\n   * NEW: Primary history loading using HA history service\n   * @private\n   * @param {Date} startTime - Start time for history query\n   * @param {Date} endTime - End time for history query\n   */\n  async _preloadWithHistoryService(startTime, endTime) {\n    const response = await this.hass.callService('history', 'get_history', {\n      entity_ids: [this.cfg.entity],\n      start_time: startTime.toISOString(),\n      end_time: endTime.toISOString()\n    });\n\n    if (response && response[0]) {\n      const states = response[0];\n      console.log(`[MsdDataSource] History service returned ${states.length} states for ${this.cfg.entity}`);\n\n      for (const state of states) {\n        const timestamp = new Date(state.last_changed || state.last_updated).getTime();\n        const rawValue = this.cfg.attribute ? state.attributes?.[this.cfg.attribute] : state.state;\n        const value = this._toNumber(rawValue);\n\n        if (value !== null) {\n          this.buffer.push(timestamp, value);\n          this._stats.historyLoaded++;\n        }\n      }\n    }\n  }\n\n  /**\n   * ENHANCED: Statistics-based history loading with finer granularity\n   * @private\n   * @param {Date} startTime - Start time for history query\n   * @param {Date} endTime - End time for history query\n   */\n  async _preloadWithStatistics(startTime, endTime) {\n    // Use 5-minute periods for more granular data\n    const response = await this.hass.callService('recorder', 'get_statistics', {\n      statistic_ids: [this.cfg.entity],\n      start_time: startTime.toISOString(),\n      end_time: endTime.toISOString(),\n      period: '5minute'  // Changed from 'hour' to '5minute'\n    });\n\n    if (response && response[0]?.statistics) {\n      const statistics = response[0].statistics;\n      console.log(`[MsdDataSource] Statistics returned ${statistics.length} points for ${this.cfg.entity}`);\n\n      for (const stat of statistics) {\n        const timestamp = new Date(stat.start).getTime();\n        const value = this._extractStatisticValue(stat);\n\n        if (value !== null) {\n          this.buffer.push(timestamp, value);\n          this._stats.historyLoaded++;\n        }\n      }\n    }\n  }\n\n  /**\n   * Start the data source with proper initialization sequence\n   * @returns {Promise} Resolves when fully initialized\n   */\n  async start() {\n    if (this._started || this._destroyed) return;\n\n    try {\n      console.log(`[MsdDataSource] 🚀 Starting initialization for ${this.cfg.entity}`);\n\n      // STEP 1: Preload historical data FIRST\n      if (this.hass?.callService) {\n        await this._preloadHistory();\n      }\n\n      // STEP 2: Initialize with current HASS state if available\n      if (this.hass.states && this.hass.states[this.cfg.entity]) {\n        const currentState = this.hass.states[this.cfg.entity];\n        console.log(`[MsdDataSource] 🔄 Loading initial state for ${this.cfg.entity}:`, currentState.state);\n\n        // FIXED: Use current timestamp for initial state\n        const currentTimestamp = Date.now();\n        const rawValue = this.cfg.attribute ? currentState.attributes?.[this.cfg.attribute] : currentState.state;\n        const value = this._toNumber(rawValue);\n\n        if (value !== null) {\n          console.log(`[MsdDataSource] Adding current state: ${value} at ${currentTimestamp}`);\n          this.buffer.push(currentTimestamp, value);\n          this._stats.currentValue = value;\n        }\n      }\n\n      // STEP 3: Setup real-time subscriptions\n      this.haUnsubscribe = await this.hass.connection.subscribeEvents((event) => {\n        if (event.event_type === 'state_changed' &&\n            event.data?.entity_id === this.cfg.entity) {\n          console.log(`[MsdDataSource] 📊 HA event received for ${this.cfg.entity}:`, event.data.new_state?.state);\n          this._handleStateChange(event.data);\n        }\n      }, 'state_changed');\n\n      this._started = true;\n      console.log(`[MsdDataSource] ✅ Full initialization complete for ${this.cfg.entity} - Buffer: ${this.buffer.size()} points`);\n\n      // STEP 4: Emit initial data to any existing subscribers\n      this._emitInitialData();\n\n    } catch (error) {\n      console.error(`[MsdDataSource] ❌ Failed to initialize ${this.cfg.entity}:`, error);\n      throw error;\n    }\n  }\n\n  /**\n   * NEW: Emit initial data to subscribers after full initialization\n   * @private\n   */\n  _emitInitialData() {\n    if (this.subscribers.size > 0) {\n      const lastPoint = this.buffer.last();\n      if (lastPoint) {\n        console.log(`[MsdDataSource] 📤 Emitting initial data for ${this.cfg.entity} to ${this.subscribers.size} subscribers`);\n        const emitData = {\n          t: lastPoint.t,\n          v: lastPoint.v,\n          buffer: this.buffer,\n          stats: { ...this._stats },\n          entity: this.cfg.entity,\n          historyReady: this._stats.historyLoaded > 0\n        };\n\n        this.subscribers.forEach(callback => {\n          try {\n            callback(emitData);\n          } catch (error) {\n            console.error(`[MsdDataSource] Initial callback error for ${this.cfg.entity}:`, error);\n          }\n        });\n      }\n    }\n  }\n\n  async _preloadHistory() {\n    if (!this.hass?.connection || !this.cfg.entity) {\n      console.warn('[MsdDataSource] No HASS connection or entity for history preload');\n      return;\n    }\n\n    const hours = Math.max(1, Math.min(168, this.cfg.history?.hours || 6)); // 1-168 hours\n    const endTime = new Date();\n    const startTime = new Date(endTime.getTime() - hours * 3600000);\n\n    console.log(`[MsdDataSource] 🔄 Preloading ${hours}h history for ${this.cfg.entity}`);\n\n    try {\n      // Use modern WebSocket call for statistics (preferred)\n      const statisticsData = await this.hass.connection.sendMessagePromise({\n        type: 'recorder/statistics_during_period',\n        start_time: startTime.toISOString(),\n        end_time: endTime.toISOString(),\n        statistic_ids: [this.cfg.entity],\n        period: 'hour'\n      });\n\n      if (statisticsData && statisticsData[this.cfg.entity]) {\n        const statistics = statisticsData[this.cfg.entity];\n        console.log(`[MsdDataSource] 📊 Got ${statistics.length} statistics points`);\n\n        for (const stat of statistics) {\n          const timestamp = new Date(stat.start).getTime();\n          const value = this._extractStatisticValue(stat);\n\n          if (value !== null) {\n            this.buffer.push(timestamp, value);\n            this._stats.historyLoaded++;\n          }\n        }\n\n        console.log(`[MsdDataSource] ✅ Loaded ${this._stats.historyLoaded} statistics points`);\n        return; // Success with statistics\n      }\n    } catch (error) {\n      console.warn('[MsdDataSource] Statistics failed, trying state history:', error.message);\n    }\n\n    // Fallback: try state history via WebSocket\n    await this._preloadStateHistoryWS(startTime, endTime);\n  }\n\n  async _preloadStateHistoryWS(startTime, endTime) {\n    try {\n      console.log(`[MsdDataSource] 📚 Trying WebSocket state history for ${this.cfg.entity}`);\n\n      // Use modern WebSocket call for history\n      const historyData = await this.hass.connection.sendMessagePromise({\n        type: 'history/history_during_period',\n        start_time: startTime.toISOString(),\n        end_time: endTime.toISOString(),\n        entity_ids: [this.cfg.entity],\n        minimal_response: true,\n        no_attributes: true\n      });\n\n      if (historyData && historyData[0]) {\n        const states = historyData[0];\n        console.log(`[MsdDataSource] 📊 Got ${states.length} history states`);\n\n        for (const state of states) {\n          const timestamp = new Date(state.last_changed || state.last_updated).getTime();\n          const rawValue = this.cfg.attribute ? state.attributes?.[this.cfg.attribute] : state.state;\n          const value = this._toNumber(rawValue);\n\n          if (value !== null) {\n            this.buffer.push(timestamp, value);\n            this._stats.historyLoaded++;\n          }\n        }\n\n        console.log(`[MsdDataSource] ✅ Loaded ${this._stats.historyLoaded} history points`);\n      } else {\n        console.warn('[MsdDataSource] No history data returned from WebSocket call');\n      }\n    } catch (error) {\n      console.error('[MsdDataSource] WebSocket state history also failed:', error);\n\n      // Final fallback: try direct REST API if available\n      await this._preloadHistoryREST(startTime, endTime);\n    }\n  }\n\n  async _preloadHistoryREST(startTime, endTime) {\n    try {\n      console.log(`[MsdDataSource] 🌐 Trying REST API history for ${this.cfg.entity}`);\n\n      const startParam = startTime.toISOString();\n      const url = `/api/history/period/${startParam}?filter_entity_id=${this.cfg.entity}&minimal_response&no_attributes`;\n\n      const response = await fetch(url, {\n        headers: {\n          'Authorization': `Bearer ${this.hass.auth?.accessToken}`,\n          'Content-Type': 'application/json'\n        }\n      });\n\n      if (!response.ok) {\n        throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n      }\n\n      const historyData = await response.json();\n\n      if (historyData && historyData[0]) {\n        const states = historyData[0];\n        console.log(`[MsdDataSource] 📊 Got ${states.length} REST history states`);\n\n        for (const state of states) {\n          const timestamp = new Date(state.last_changed || state.last_updated).getTime();\n          const rawValue = this.cfg.attribute ? state.attributes?.[this.cfg.attribute] : state.state;\n          const value = this._toNumber(rawValue);\n\n          if (value !== null) {\n            this.buffer.push(timestamp, value);\n            this._stats.historyLoaded++;\n          }\n        }\n\n        console.log(`[MsdDataSource] ✅ Loaded ${this._stats.historyLoaded} REST history points`);\n      }\n    } catch (error) {\n      console.error('[MsdDataSource] REST history fallback also failed:', error);\n    }\n  }\n\n  /**\n   * Handle state change from Home Assistant\n   * @private\n   * @param {Object} eventData - State change event data\n   */\n  _handleStateChange(eventData) {\n\n    console.log('[MSD DEBUG] 📊 MsdDataSource._handleStateChange() ENTRY:', {\n      entity: this.cfg.entity,\n      timestamp: new Date().toISOString(),\n      hasEventData: !!eventData,\n      hasNewState: !!eventData?.new_state,\n      newStateValue: eventData?.new_state?.state,\n      subscriberCount: this.subscribers.size,\n      stackTrace: new Error().stack.split('\\n').slice(1, 3).join('\\n')\n    });\n\n    if (!eventData?.new_state || this._destroyed) {\n      console.log('[MSD DEBUG] ⏭️ Skipping state change - no new state or destroyed');\n      return;\n    }\n\n    // CRITICAL: Store the original state object before any conversion\n    this._lastOriginalState = eventData.new_state;\n\n    // FIXED: Use current timestamp instead of state timestamp\n    const timestamp = Date.now();\n    const rawValue = this.cfg.attribute\n      ? eventData.new_state.attributes?.[this.cfg.attribute]\n      : eventData.new_state.state;\n\n    const value = this._toNumber(rawValue);\n\n    if (value !== null) {\n      console.log(`[MSD DEBUG] 📊 Processing state change for ${this.cfg.entity}:`, {\n        value,\n        timestamp,\n        subscriberCount: this.subscribers.size,\n        originalState: this._lastOriginalState.state\n      });\n\n      // Add to buffer with proper timestamp\n      this.buffer.push(timestamp, value);\n      this._stats.updates++;\n      this._stats.currentValue = value;\n\n      // Emit to subscribers\n      console.log(`[MSD DEBUG] 📤 Emitting to ${this.subscribers.size} subscribers:`, value);\n\n      const emitData = {\n        t: timestamp,\n        v: value,\n        buffer: this.buffer,\n        stats: { ...this._stats },\n        entity: this.cfg.entity,\n        historyReady: this._stats.historyLoaded > 0\n      };\n\n      this.subscribers.forEach((callback, index) => {\n        try {\n          console.log(`[MSD DEBUG] 📞 Calling subscriber ${index} for ${this.cfg.entity}`);\n          callback(emitData);\n          console.log(`[MSD DEBUG] ✅ Subscriber ${index} completed successfully`);\n        } catch (error) {\n          console.error(`[MSD DEBUG] ❌ Subscriber ${index} callback FAILED for ${this.cfg.entity}:`, error);\n          console.error(`[MSD DEBUG] ❌ Subscriber error stack:`, error.stack);\n        }\n      });\n    } else {\n      console.log(`[MSD DEBUG] ⚠️ Skipping state change - invalid value:`, { rawValue, entity: this.cfg.entity });\n    }\n  }\n\n  /**\n   * Check if we should emit data to subscribers based on timing and value rules\n   */\n  _shouldEmit(value, timestamp) {\n    const now = Date.now();\n\n    // Respect minimum emit interval\n    if (this._lastEmitTime && (timestamp - this._lastEmitTime) < this.minEmitMs) {\n      this._stats.coalesced++;\n      return false;\n    }\n\n    // Skip if value hasn't changed (if configured)\n    if (!this.emitOnSameValue && value === this._lastEmittedValue) {\n      this._stats.skipsSameValue++;\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Emit data to all subscribers\n   */\n  _emit(data) {\n    const now = Date.now();\n    this._lastEmitTime = now;\n    this._lastEmittedValue = data.v;\n    this._stats.emits++;\n\n    console.log(`[MsdDataSource] 📤 Emitting to ${this.subscribers.size} subscribers:`, data.v);\n\n    // Call all subscribers\n    this.subscribers.forEach(callback => {\n      try {\n        callback(data);\n      } catch (error) {\n        console.warn(`[MsdDataSource] Subscriber callback error:`, error);\n      }\n    });\n  }\n\n  async _subscribeLive() {\n    if (!this.hass?.connection?.subscribeEvents || !this.cfg.entity) return;\n\n    const entityId = this.cfg.entity;\n\n    try {\n      this.haUnsubscribe = await this.hass.connection.subscribeEvents((event) => {\n        const newState = event?.data?.new_state;\n        if (!newState || newState.entity_id !== entityId) return;\n\n        const timestamp = new Date(newState.last_changed || newState.last_updated || Date.now()).getTime();\n        const rawValue = this.cfg.attribute ? newState.attributes?.[this.cfg.attribute] : newState.state;\n        const value = this._toNumber(rawValue);\n\n        this._onRawEventValue(timestamp, value);\n      }, 'state_changed');\n\n    } catch (error) {\n      console.warn('[MsdDataSource] Failed to subscribe to HA events:', error.message);\n    }\n  }\n\n  _onRawEventValue(timestamp, value) {\n    if (value === null) {\n      this._stats.invalid++;\n      return;\n    }\n\n    // ENHANCED: Check for rapid-fire identical values and skip some\n    const now = isNode ? Date.now() : performance.now();\n\n    // Store in buffer - buffer now handles its own coalescing\n    this.buffer.push(timestamp, value);\n    this._stats.received++;\n\n    // FIXED: More aggressive coalescing logic for stress scenarios\n    if (!this._pending) {\n      this._pending = true;\n      this._pendingFirstTs = now;\n      this._pendingCount = 1;\n\n      // For stress tests: delay first emission slightly to allow coalescing\n      if (this._stats.received > 10) {\n        // High-frequency scenario - be more patient\n        setTimeout(() => this._ensureScheduleEmit(), 5);\n      } else {\n        // Normal scenario - immediate response for first subscription\n        if (this.subscribers.size > 0 && this._stats.emits === 0) {\n          this._emit();\n        } else {\n          this._ensureScheduleEmit();\n        }\n      }\n    } else {\n      this._pendingCount++;\n      const timeSinceFirst = now - this._pendingFirstTs;\n\n      if (timeSinceFirst >= this.coalesceMs) {\n        // Coalescing window expired - emit and start new window\n        this._emit();\n\n        // Start fresh coalescing window\n        this._pending = true;\n        this._pendingFirstTs = now;\n        this._pendingCount = 1;\n        this._ensureScheduleEmit();\n      } else {\n        // Still within coalescing window - increment coalesced counter\n        this._stats.coalesced++;\n      }\n    }\n  }\n\n  _ensureScheduleEmit() {\n    if (this._pendingRaf) return; // Already scheduled\n\n    this._pendingRaf = requestAnimationFrame(() => {\n      this._pendingRaf = 0;\n      this._frameEmitCheck();\n    });\n  }\n\n  _frameEmitCheck() {\n    if (!this._pending || this._destroyed) return;\n\n    const now = isNode ? Date.now() : performance.now();\n    const timeSinceLastEmit = now - this._lastEmitTime;\n    const timeSincePendingStart = now - this._pendingFirstTs;\n\n    // Should we emit now?\n    let shouldEmit = false;\n\n    // Check minimum emit interval\n    if (timeSinceLastEmit >= this.minEmitMs) {\n      // Minimum time passed - check coalescing window\n      if (timeSincePendingStart >= this.coalesceMs) {\n        shouldEmit = true;\n      }\n    }\n\n    // Max delay override - always emit if we've been pending too long\n    if (timeSincePendingStart >= this.maxDelayMs) {\n      shouldEmit = true;\n    }\n\n    if (shouldEmit) {\n      this._emit();\n    } else {\n      // IMPROVED: More precise next check timing\n      const untilMinEmit = Math.max(0, this.minEmitMs - timeSinceLastEmit);\n      const untilCoalesce = Math.max(0, this.coalesceMs - timeSincePendingStart);\n      const untilMaxDelay = Math.max(0, this.maxDelayMs - timeSincePendingStart);\n\n      const nextCheck = Math.min(\n        untilMinEmit || Infinity,\n        untilCoalesce || Infinity,\n        untilMaxDelay || Infinity\n      );\n\n      if (nextCheck < Infinity && nextCheck > 0) {\n        setTimeout(() => {\n          this._ensureScheduleEmit();\n        }, Math.max(1, Math.min(50, nextCheck)));\n      }\n    }\n  }\n\n  /* OLD\n  subscribe(callback) {\n    if (typeof callback !== 'function') {\n      console.warn('[MsdDataSource] Subscribe requires a function callback');\n      return () => {};\n    }\n\n    this.subscribers.add(callback);\n\n    // Immediate hydration with current data\n    const lastPoint = this.buffer.last();\n    if (lastPoint) {\n      try {\n        callback({\n          t: lastPoint.t,\n          v: lastPoint.v,\n          buffer: this.buffer,\n          stats: this._stats\n        });\n      } catch (error) {\n        console.warn('[MsdDataSource] Initial callback error:', error);\n      }\n    }\n\n    // Return unsubscribe function\n    return () => {\n      this.subscribers.delete(callback);\n    };\n  }\n  */\n\n\n  subscribe(callback) {\n    if (typeof callback !== 'function') {\n      console.warn('[MsdDataSource] Subscribe requires a function callback');\n      return () => {};\n    }\n\n    this.subscribers.add(callback);\n\n    // Enhanced immediate hydration with current data\n    const lastPoint = this.buffer.last();\n    if (lastPoint) {\n      try {\n        const currentData = {\n          t: lastPoint.t,\n          v: lastPoint.v,\n          buffer: this.buffer,\n          stats: { ...this._stats }\n        };\n\n        console.log(`[MsdDataSource] Providing immediate hydration for new subscriber:`, {\n          entity: this.cfg.entity,\n          value: lastPoint.v,\n          bufferSize: this.buffer.size(),\n          timestamp: new Date(lastPoint.t).toISOString()\n        });\n\n        // Use setTimeout to avoid blocking the subscription\n        setTimeout(() => {\n          callback(currentData);\n        }, 0);\n\n      } catch (error) {\n        console.warn('[MsdDataSource] Initial callback error:', error);\n      }\n    } else {\n      console.log(`[MsdDataSource] No data available for immediate hydration:`, {\n        entity: this.cfg.entity,\n        bufferSize: this.buffer.size(),\n        started: this._started\n      });\n    }\n\n    // Return unsubscribe function\n    return () => {\n      this.subscribers.delete(callback);\n    };\n  }\n\n\n  /**\n   * Convert raw value to number with support for boolean states\n   * @param {*} raw - Raw value from HA state\n   * @returns {number|null} Converted number or null if invalid\n   */\n  _toNumber(raw) {\n    console.log('[MSD DEBUG] 📊 _toNumber() converting:', {\n      raw,\n      type: typeof raw,\n      entity: this.cfg.entity\n    });\n\n    if (raw === null || raw === undefined) {\n      console.log('[MSD DEBUG] ⚠️ _toNumber() - null/undefined value');\n      return null;\n    }\n\n    // Handle numeric values\n    if (typeof raw === 'number') {\n      const result = isNaN(raw) ? null : raw;\n      console.log('[MSD DEBUG] 📊 _toNumber() - numeric:', { raw, result });\n      return result;\n    }\n\n    // Handle string values\n    if (typeof raw === 'string') {\n      // Try direct numeric conversion first\n      const num = parseFloat(raw);\n      if (!isNaN(num) && isFinite(num)) {\n        console.log('[MSD DEBUG] 📊 _toNumber() - string numeric:', { raw, num });\n        return num;\n      }\n\n      // ADDED: Handle boolean-like string states\n      const lowerRaw = raw.toLowerCase().trim();\n      if (lowerRaw === 'on' || lowerRaw === 'true' || lowerRaw === 'active' || lowerRaw === 'open') {\n        console.log('[MSD DEBUG] 📊 _toNumber() - boolean TRUE:', { raw, converted: 1 });\n        return 1;\n      }\n\n      if (lowerRaw === 'off' || lowerRaw === 'false' || lowerRaw === 'inactive' || lowerRaw === 'closed') {\n        console.log('[MSD DEBUG] 📊 _toNumber() - boolean FALSE:', { raw, converted: 0 });\n        return 0;\n      }\n\n      // Handle unavailable/unknown states\n      if (lowerRaw === 'unavailable' || lowerRaw === 'unknown') {\n        console.log('[MSD DEBUG] 📊 _toNumber() - unavailable state:', { raw, converted: null });\n        return null;\n      }\n\n      console.log('[MSD DEBUG] ⚠️ _toNumber() - unhandled string:', { raw });\n      return null;\n    }\n\n    // Handle boolean values\n    if (typeof raw === 'boolean') {\n      const result = raw ? 1 : 0;\n      console.log('[MSD DEBUG] 📊 _toNumber() - boolean:', { raw, result });\n      return result;\n    }\n\n    console.log('[MSD DEBUG] ⚠️ _toNumber() - unsupported type:', { raw, type: typeof raw });\n    return null;\n  }\n\n  _parseTimeWindowMs(windowStr) {\n    if (typeof windowStr !== 'string') return NaN;\n\n    const match = windowStr.match(/^(\\d+(?:\\.\\d+)?)\\s*(s|sec|m|min|h|hr|d|day)s?$/i);\n    if (!match) return NaN;\n\n    const value = parseFloat(match[1]);\n    const unit = match[2].toLowerCase();\n\n    switch (unit) {\n      case 's':\n      case 'sec':\n        return value * 1000;\n      case 'm':\n      case 'min':\n        return value * 60 * 1000;\n      case 'h':\n      case 'hr':\n        return value * 60 * 60 * 1000;\n      case 'd':\n      case 'day':\n        return value * 24 * 60 * 60 * 1000;\n      default:\n        return NaN;\n    }\n  }\n\n  // Debug and introspection methods\n  getStats() {\n    return {\n      ...this._stats,\n      config: {\n        entity: this.cfg.entity,\n        windowSeconds: this.cfg.windowSeconds,\n        minEmitMs: this.minEmitMs,\n        coalesceMs: this.coalesceMs,\n        maxDelayMs: this.maxDelayMs\n      },\n      buffer: this.buffer.getStats(),\n      subscribers: this.subscribers.size,\n      state: {\n        started: this._started,\n        pending: this._pending,\n        destroyed: this._destroyed\n      }\n    };\n  }\n\n  /**\n   * Get current data with enhanced metadata\n   * @returns {Object|null} Current data object or null\n   */\n  /* OLD\n  getCurrentData() {\n    const lastPoint = this.buffer.last();\n    return {\n      t: lastPoint?.t,\n      v: lastPoint?.v,\n      buffer: this.buffer,\n      stats: { ...this._stats },\n      entity: this.cfg.entity,\n      historyReady: this._stats.historyLoaded > 0,\n      bufferSize: this.buffer.size(),\n      started: this._started\n    };\n  }\n  */\n\n  /**\n   * Get current data with enhanced metadata\n   * @returns {Object|null} Current data object or null\n   */\n  getCurrentData() {\n    const lastPoint = this.buffer.last();\n    if (!lastPoint) {\n      // Return minimal data structure even if no data points exist\n      return {\n        t: null,\n        v: null,\n        buffer: this.buffer,\n        stats: { ...this._stats },\n        entity: this.cfg.entity,\n        historyReady: this._stats.historyLoaded > 0,\n        bufferSize: 0,\n        started: this._started\n      };\n    }\n\n    return {\n      t: lastPoint.t,\n      v: lastPoint.v,\n      buffer: this.buffer,\n      stats: { ...this._stats },\n      entity: this.cfg.entity,\n      historyReady: this._stats.historyLoaded > 0,\n      bufferSize: this.buffer.size(),\n      started: this._started\n    };\n  }\n\n  // NEW: Add EntityRuntime-compatible method\n  getEntity() {\n    return this.currentState ? {\n      state: this.currentState.state,\n      attributes: this.currentState.attributes || {}\n    } : null;\n  }\n\n  /**\n   * Stop the data source and release resources\n   */\n  async stop() {\n    this._started = false;\n\n    if (this.haUnsubscribe) {\n      try {\n        this.haUnsubscribe();\n      } catch (error) {\n        console.warn('[MsdDataSource] HA unsubscribe error:', error);\n      }\n      this.haUnsubscribe = null;\n    }\n\n    if (this._pendingRaf) {\n      cancelAnimationFrame(this._pendingRaf);\n      this._pendingRaf = 0;\n    }\n\n    this._pending = false;\n  }\n\n  destroy() {\n    this._destroyed = true;\n    this.stop();\n    this.subscribers.clear();\n    this.buffer.clear();\n  }\n\n  _extractStatisticValue(stat) {\n    // Priority order for statistic values\n    if (Number.isFinite(stat.mean)) return stat.mean;\n    if (Number.isFinite(stat.state)) return stat.state;\n    if (Number.isFinite(stat.sum)) return stat.sum;\n    if (Number.isFinite(stat.max)) return stat.max;\n    if (Number.isFinite(stat.min)) return stat.min;\n    return null;\n  }\n}\n","/**\n * DataSourceManager - Manages multiple data sources and overlay subscriptions\n *\n * Features:\n * - Multi-source lifecycle management\n * - Overlay subscription system\n * - Clean shutdown and resource management\n * - Performance monitoring and statistics\n * - EntityRuntime API compatibility for rules engine\n */\n\nimport { MsdDataSource } from './MsdDataSource.js';\n\nexport class DataSourceManager {\n  constructor(hass) {\n    this.hass = hass;\n    this.sources = new Map();\n    this.overlaySubscriptions = new Map();\n\n    // NEW: Entity runtime compatibility\n    this.entityIndex = new Map(); // entityId -> dataSource\n    this.globalEntityChangeListeners = new Set();\n\n    // Performance statistics\n    this._stats = {\n      sourcesCreated: 0,\n      subscriptionsActive: 0,\n      dataUpdates: 0,\n      errors: 0\n    };\n\n    // Lifecycle state\n    this._destroyed = false;\n  }\n\n  /**\n   * Initialize data sources from configuration with history preloading\n   * @param {Object} dataSourceConfigs - Configuration for data sources\n   * @returns {Promise<number>} Number of sources created\n   */\n  async initializeFromConfig(dataSourceConfigs) {\n    if (this._destroyed) {\n      throw new Error('DataSourceManager has been destroyed');\n    }\n\n    console.log(`[DataSourceManager] 🚀 Initializing ${Object.keys(dataSourceConfigs || {}).length} data sources`);\n\n    // Create all data sources from config\n    const promises = Object.entries(dataSourceConfigs || {}).map(async ([name, config]) => {\n      try {\n        const source = await this.createDataSource(name, config);\n        this._stats.sourcesCreated++;\n        return source;\n      } catch (error) {\n        console.warn(`[DataSourceManager] Failed to create source ${name}:`, error);\n        this._stats.errors++;\n        throw error;\n      }\n    });\n\n    await Promise.all(promises);\n\n    // NEW: Wait for history preloading to complete\n    if (this.sources.size > 0) {\n      await this._waitForHistoryPreloading();\n    }\n\n    const successful = this.sources.size;\n    const failed = Object.keys(dataSourceConfigs || {}).length - successful;\n    console.log(`[DataSourceManager] ✅ Initialization complete: ${successful} successful, ${failed} failed`);\n\n    return successful;\n  }\n\n  async createDataSource(name, config) {\n    if (this.sources.has(name)) {\n      return this.sources.get(name);\n    }\n\n    const source = new MsdDataSource(config, this.hass);\n    this.sources.set(name, source);\n\n    // NEW: Index by entity for global lookups\n    if (config.entity) {\n      this.entityIndex.set(config.entity, source);\n\n      // Forward entity changes to global listeners\n      source.subscribe((data) => {\n        this._notifyGlobalEntityChangeListeners([config.entity]);\n      });\n    }\n\n    try {\n      await source.start();\n\n      // NEW: Preload initial state from HASS if available\n      if (config.entity && this.hass.states && this.hass.states[config.entity]) {\n        const hassState = this.hass.states[config.entity];\n\n        // Simulate initial state change to populate the data source\n        source._handleStateChange({\n          entity_id: config.entity,\n          new_state: hassState,\n          old_state: null\n        });\n      }\n\n    } catch (error) {\n      console.warn(`[DataSourceManager] Failed to start source ${name}:`, error);\n      this.sources.delete(name);\n      this.entityIndex.delete(config.entity);\n      this._stats.errors++;\n      throw error;\n    }\n\n    return source;\n  }\n\n  /**\n   * NEW: Wait for all sources to complete their history loading\n   * @private\n   * @param {number} maxWaitMs - Maximum wait time in milliseconds\n   */\n  async _waitForHistoryPreloading(maxWaitMs = 10000) {\n    const startTime = Date.now();\n    const checkInterval = 100;\n\n    console.log(`[DataSourceManager] ⏳ Waiting for history preloading...`);\n\n    while (Date.now() - startTime < maxWaitMs) {\n      let allReady = true;\n      let totalSources = 0;\n      let readySources = 0;\n\n      for (const [name, source] of this.sources) {\n        totalSources++;\n        const stats = source.getStats();\n        if (stats.historyLoaded > 0 || !source.cfg.history?.enabled) {\n          readySources++;\n        } else {\n          allReady = false;\n        }\n      }\n\n      if (readySources > 0) {\n        console.log(`[DataSourceManager] History loading progress: ${readySources}/${totalSources} sources ready`);\n      }\n\n      if (allReady || totalSources === 0) {\n        console.log(`[DataSourceManager] ✅ History preloading complete in ${Date.now() - startTime}ms`);\n        break;\n      }\n\n      await new Promise(resolve => setTimeout(resolve, checkInterval));\n    }\n  }\n\n  // NEW: EntityRuntime compatibility methods\n  getEntity(entityId) {\n    const source = this.entityIndex.get(entityId);\n    if (!source) {\n      // Fallback: try to get from HASS states directly\n      if (this.hass.states && this.hass.states[entityId]) {\n        const hassState = this.hass.states[entityId];\n        return {\n          state: hassState.state,\n          attributes: hassState.attributes || {}\n        };\n      }\n      return null;\n    }\n\n    // Try to get current data from data source\n    const currentData = source.getCurrentData();\n    if (currentData) {\n      return {\n        state: currentData.v.toString(),\n        attributes: {}\n      };\n    }\n\n    // Fallback to HASS states\n    if (this.hass.states && this.hass.states[entityId]) {\n      const hassState = this.hass.states[entityId];\n      return {\n        state: hassState.state,\n        attributes: hassState.attributes || {}\n      };\n    }\n\n    return null;\n  }\n\n  listIds() {\n    return Array.from(this.entityIndex.keys());\n  }\n\n  // NEW: Add global entity change listener for rules engine\n  addEntityChangeListener(callback) {\n    this.globalEntityChangeListeners.add(callback);\n    return () => this.globalEntityChangeListeners.delete(callback);\n  }\n\n  _notifyGlobalEntityChangeListeners(changedEntityIds) {\n    if (this.globalEntityChangeListeners.size === 0) return;\n\n    this.globalEntityChangeListeners.forEach(callback => {\n      try {\n        callback(changedEntityIds);\n      } catch (error) {\n        console.warn('[DataSourceManager] Global entity listener error:', error);\n      }\n    });\n  }\n\n  /**\n   * Subscribe an overlay to data source updates\n   * Enhanced for sparkline real-time updates\n   * @param {Object} overlay - Overlay configuration with source property\n   * @param {Function} callback - Callback function for updates\n   */\n  subscribeOverlay(overlay, callback) {\n    if (!overlay.source) {\n      console.warn('[DataSourceManager] subscribeOverlay: No source specified for overlay', overlay.id);\n      return;\n    }\n\n    const source = this.sources.get(overlay.source);\n    if (!source) {\n      console.warn('[DataSourceManager] subscribeOverlay: Source not found:', overlay.source);\n      return;\n    }\n\n    console.log(`[DataSourceManager] 🔗 Setting up subscription for ${overlay.id} to ${overlay.source}`);\n\n\n\n    /* OLD\n    // Subscribe to the data source with enhanced data for sparklines\n    const unsubscribe = source.subscribe((data) => {\n      // Enhanced callback data for sparklines\n      const enhancedData = {\n        ...data,\n        sourceId: overlay.source,\n        overlayId: overlay.id,\n        overlayType: overlay.type,\n        // Include buffer reference for sparklines\n        buffer: overlay.type === 'sparkline' ? data.buffer : undefined,\n        // Include historical data if available\n        historicalData: overlay.type === 'sparkline' && data.buffer ?\n          data.buffer.getAll().map(point => ({ timestamp: point.t, value: point.v })) : undefined\n      };\n\n      // DEBUG: Log what we're about to send\n      console.log(`[DataSourceManager] 📤 Calling callback for ${overlay.id}:`, {\n        hasBuffer: !!enhancedData.buffer,\n        bufferSize: enhancedData.buffer?.size?.() || 0,\n        hasHistoricalData: !!enhancedData.historicalData,\n        historicalDataLength: enhancedData.historicalData?.length || 0,\n        currentValue: enhancedData.v\n      });\n\n      // Call the callback with overlay and enhanced update data\n      callback(overlay, enhancedData);\n    });\n    */\n\n    // Subscribe to the data source with enhanced data for sparklines\n    const unsubscribe = source.subscribe((data) => {\n      // Enhanced callback data for sparklines\n      const enhancedData = {\n        ...data,\n        sourceId: overlay.source,\n        overlayId: overlay.id,\n        overlayType: overlay.type,\n        // Include buffer reference for sparklines\n        buffer: overlay.type === 'sparkline' ? data.buffer : undefined,\n        // Include historical data if available\n        historicalData: overlay.type === 'sparkline' && data.buffer ?\n          data.buffer.getAll().map(point => ({ timestamp: point.t, value: point.v })) : undefined\n      };\n\n      // DEBUG: Log what we're about to send\n      console.log(`[DataSourceManager] 📤 Calling callback for ${overlay.id}:`, {\n        hasBuffer: !!enhancedData.buffer,\n        bufferSize: enhancedData.buffer?.size?.() || 0,\n        hasHistoricalData: !!enhancedData.historicalData,\n        historicalDataLength: enhancedData.historicalData?.length || 0,\n        currentValue: enhancedData.v\n      });\n\n      // Call the callback with overlay and enhanced update data\n      callback(overlay, enhancedData);\n    });\n\n    // CRITICAL: Provide immediate callback if data already exists\n    // This fixes the timing issue where overlays subscribe after data is ready\n    const currentData = source.getCurrentData();\n    if (currentData && (currentData.buffer?.size?.() > 0 || currentData.v !== undefined)) {\n      console.log(`[DataSourceManager] 🔄 Providing immediate data for ${overlay.id}`);\n\n      const immediateData = {\n        ...currentData,\n        sourceId: overlay.source,\n        overlayId: overlay.id,\n        overlayType: overlay.type,\n        buffer: overlay.type === 'sparkline' ? currentData.buffer : undefined,\n        historicalData: overlay.type === 'sparkline' && currentData.buffer ?\n          currentData.buffer.getAll().map(point => ({ timestamp: point.t, value: point.v })) : undefined\n      };\n\n      // Use setTimeout to avoid blocking the subscription setup\n      setTimeout(() => {\n        callback(overlay, immediateData);\n      }, 0);\n    }\n\n\n\n    // Store the unsubscribe function\n    if (!this.overlaySubscriptions.has(overlay.id)) {\n      this.overlaySubscriptions.set(overlay.id, []);\n    }\n    this.overlaySubscriptions.get(overlay.id).push(unsubscribe);\n    this._stats.subscriptionsActive++;\n\n    console.log(`[DataSourceManager] ✅ Subscribed ${overlay.type} overlay ${overlay.id} to source ${overlay.source} (${source.subscribers?.size || 0} total subscribers)`);\n\n    return unsubscribe;\n  }\n\n  unsubscribeOverlay(overlayId) {\n    const subscriptions = this.overlaySubscriptions.get(overlayId);\n    if (subscriptions) {\n      subscriptions.forEach(unsubscribe => {\n        try {\n          unsubscribe();\n        } catch (error) {\n          console.warn(`[DataSourceManager] Error unsubscribing overlay ${overlayId}:`, error);\n          this._stats.errors++;\n        }\n      });\n      this.overlaySubscriptions.delete(overlayId);\n      this._stats.subscriptionsActive--;\n    }\n  }\n\n  getSource(name) {\n    return this.sources.get(name);\n  }\n\n  getAllSources() {\n    return Array.from(this.sources.values());\n  }\n\n  /**\n   * Get a specific data source by ID\n   * @param {string} id - Data source ID\n   * @returns {MsdDataSource|null} The data source or null if not found\n   */\n  getDataSource(id) {\n    return this._dataSources.get(id) || null;\n  }\n\n  getStats() {\n    const sourceStats = {};\n    for (const [name, source] of this.sources) {\n      sourceStats[name] = source.getStats ? source.getStats() : { error: 'No stats available' };\n    }\n\n    return {\n      manager: this._stats,\n      sources: sourceStats,\n      summary: {\n        totalSources: this.sources.size,\n        activeSubscriptions: this.overlaySubscriptions.size,\n        entityCount: this.entityIndex.size,\n        destroyed: this._destroyed\n      }\n    };\n  }\n\n  async destroy() {\n    if (this._destroyed) return;\n    this._destroyed = true;\n\n    // Unsubscribe all overlays\n    for (const overlayId of this.overlaySubscriptions.keys()) {\n      this.unsubscribeOverlay(overlayId);\n    }\n\n    // Stop all data sources\n    const stopPromises = [];\n    for (const [name, source] of this.sources) {\n      try {\n        if (source.stop) {\n          stopPromises.push(source.stop());\n        } else if (source.destroy) {\n          stopPromises.push(source.destroy());\n        }\n      } catch (error) {\n        console.warn(`[DataSourceManager] Error stopping source ${name}:`, error);\n      }\n    }\n\n    await Promise.all(stopPromises);\n\n    this.sources.clear();\n    this.overlaySubscriptions.clear();\n    this.entityIndex.clear();\n    this.globalEntityChangeListeners.clear();\n  }\n\n  // Debug and introspection methods\n  debugDump() {\n    return {\n      sources: Array.from(this.sources.keys()),\n      subscriptions: Array.from(this.overlaySubscriptions.keys()),\n      entities: Array.from(this.entityIndex.keys()),\n      stats: this.getStats()\n    };\n  }\n}\n","const counters = Object.create(null);\nexport function perfInc(key, delta = 1) {\n  counters[key] = (counters[key] || 0) + delta;\n}\nexport function perfSet(key, val) {\n  counters[key] = val;\n}\nexport function perfGetAll() {\n  return { ...counters };\n}\nexport function perfTime(key, fn) {\n  const t0 = performance.now();\n  const res = fn();\n  const done = () => {\n    const dt = performance.now() - t0;\n    perfInc(key + '.samples', 1);\n    perfInc(key + '.totalMs', dt);\n    perfSet(key + '.lastMs', dt);\n  };\n  if (res && typeof res.then === 'function') {\n    return res.then(r => { done(); return r; });\n  }\n  done();\n  return res;\n}\n","import { perfInc, perfTime } from '../perf/PerfCounters.js';\n\n/**\n * M5.1 RouterCore\n * - Manhattan basic routing\n * - Caching\n * - Placeholders for obstacles & channels\n */\nexport class RouterCore {\n  constructor(routingConfig, anchors, viewBox) {\n    this.config = routingConfig || {};\n    this.anchors = anchors || {};\n    this.viewBox = viewBox;\n    this._cache = new Map(); // key -> RouteResult\n    this._cacheOrder = [];\n    this._maxCache = 256;\n    this._rev = 0; // increment to invalidate globally\n    this._overlaysRef = null;\n    this._obstacles = [];\n    this._obsVersion = 0;\n    this._gridCache = new Map(); // resolution|obsVersion -> occupancy grid\n    this._channels = this._normalizeChannels(this.config.channels || []);\n    this._channelForcePenalty = Number(this.config.channel_force_penalty || 800);\n    this._channelAvoidMultiplier = Number(this.config.channel_avoid_multiplier || 1.0);\n    // NEW (M5.4 shaping config)\n    this._channelTargetCoverage = Number(this.config.channel_target_coverage ?? 0.6);\n    this._channelShapingMaxAttempts = Number(this.config.channel_shaping_max_attempts ?? 12);\n    this._channelShapingSpan = Number(this.config.channel_shaping_span ?? 32);\n    this._channelMinCoverageGain = Number(this.config.channel_min_coverage_gain ?? 0.04);\n  }\n\n  invalidate(id='*') {\n    if (id === '*' ) {\n      this._cache.clear();\n      this._cacheOrder.length = 0;\n      this._rev++;\n    } else {\n      // Cache key includes overlay id only indirectly; brute force purge by scan.\n      for (const k of Array.from(this._cache.keys())) {\n        if (k.includes(`@${id}|`)) {\n          this._cache.delete(k);\n          const i = this._cacheOrder.indexOf(k);\n          if (i >= 0) this._cacheOrder.splice(i,1);\n        }\n      }\n    }\n    perfInc('routing.invalidate.events', 1);\n  }\n\n  setOverlays(overlays) {\n    if (!Array.isArray(overlays)) return;\n    if (overlays === this._overlaysRef) return;\n    this._overlaysRef = overlays;\n    // Rebuild obstacle list (ribbon or obstacle:true)\n    const obs = [];\n    for (const ov of overlays) {\n      if (!ov || !ov.id) continue;\n      const raw = ov._raw || ov.raw || {};\n      const isObstacle = raw.obstacle === true || ov.type === 'ribbon';\n      if (!isObstacle) continue;\n      // Determine bounds. Prefer size+position (raw.position / raw.size) else anchor if available.\n      let x = 0, y = 0, w = 0, h = 0;\n      if (Array.isArray(raw.position) && Array.isArray(raw.size)) {\n        [x,y] = raw.position;\n        [w,h] = raw.size;\n      } else if (raw.anchor && this.anchors[raw.anchor]) {\n        const [ax,ay] = this.anchors[raw.anchor];\n        x = ax - 1; y = ay - 1; w = 2; h = 2;\n      } else continue;\n      if (!Number.isFinite(x+y+w+h) || w <= 0 || h <= 0) continue;\n      obs.push({ id: ov.id, x1: x, y1: y, x2: x + w, y2: y + h });\n    }\n    this._obstacles = obs;\n    this._obsVersion++;\n    // Invalidate grids & route cache referencing old obstacles\n    this._gridCache.clear();\n    this.invalidate('*');\n    perfInc('routing.obstacles.count', obs.length);\n  }\n\n  stats() {\n    return {\n      size: this._cache.size,\n      max: this._maxCache,\n      rev: this._rev,\n      obstacles: this._obstacles.length,\n      obsVersion: this._obsVersion\n    };\n  }\n\n\n  /**\n   * Build a route request object with both entry and exit direction hints.\n   * If route_mode_last is not specified and the destination is an overlay with attach_side,\n   * auto-set route_mode_last based on attach_side (left/right → xy; top/bottom → yx).\n   * If only route_mode_last is set, use it for the last segment, first segment is auto.\n   * If neither is set, fallback to geometry-based auto.\n   * @param {object} overlay - The overlay config object\n   * @param {number[]} a1 - Start anchor [x, y]\n   * @param {number[]} a2 - End anchor [x, y]\n   * @returns {object} Route request with modeHint and modeHintLast\n   */\n  buildRouteRequest(overlay, a1, a2) {\n    const raw = overlay._raw || overlay.raw || {};\n    const fs = overlay.finalStyle || {};\n    let channelMode = (raw.route_channel_mode || raw.routeChannelMode || raw.channel_mode || 'prefer').toLowerCase();\n    if (!['prefer','avoid','force'].includes(channelMode)) {\n      perfInc && perfInc('routing.channel.mode.invalid', 1);\n      channelMode = 'prefer';\n    }\n    let smoothingMode = (\n      raw.smoothing_mode ||\n      raw.corner_smoothing_mode ||\n      fs.smoothing_mode ||\n      this.config.smoothing_mode ||\n      (this.config.smoothing && this.config.smoothing.mode) ||\n      'none'\n    ).toLowerCase();\n    const allowedSmooth = ['none','chaikin'];\n    if (!allowedSmooth.includes(smoothingMode)) {\n      try { perfInc('routing.smooth.mode.invalid', 1); } catch(_) {}\n      smoothingMode = 'none';\n    }\n\n    // Parse both first and last segment hints\n    let modeHint = (raw.route_mode || '').toLowerCase();\n    let modeHintLast = (raw.route_mode_last || '').toLowerCase();\n    let hintSourceFirst = modeHint ? 'explicit' : 'auto';\n    let hintSourceLast = modeHintLast ? 'explicit' : null;\n\n    // Improved destination overlay detection:\n    // 1. If attach_side is present we treat destination as an overlay (even if anchor not yet resolved)\n    // 2. If attach_to is not an existing anchor id we assume it is an overlay id (will be resolved later)\n    let isDestinationOverlay = false;\n    if (raw.attach_side) {\n      isDestinationOverlay = true;\n    } else if (typeof raw.attach_to === 'string' && raw.attach_to) {\n      if (!this.anchors[raw.attach_to]) {\n        isDestinationOverlay = true;\n      }\n    }\n\n    // Auto-set modeHintLast based on attach_side when not explicitly provided\n    if (!modeHintLast && isDestinationOverlay) {\n      const attachSide = (raw.attach_side || '').toLowerCase();\n      if (attachSide === 'left' || attachSide === 'right') {\n        modeHintLast = 'yx'; // final horizontal\n        hintSourceLast = 'attach_side';\n        try { perfInc('routing.hint.attach_side.horizontal',1); } catch(_){}\n      } else if (attachSide === 'top' || attachSide === 'bottom') {\n        modeHintLast = 'xy'; // final vertical\n        hintSourceLast = 'attach_side';\n        try { perfInc('routing.hint.attach_side.vertical',1); } catch(_){}\n      }\n    }\n    // Geometry-based first segment if not provided\n    if (!modeHint) {\n      const [x1, y1] = a1;\n      const [x2, y2] = a2;\n      if (Number.isFinite(x1+y1+x2+y2)) {\n        const dx = Math.abs(x2 - x1);\n        const dy = Math.abs(y2 - y1);\n        modeHint = dx >= dy ? 'xy' : 'yx';\n      } else {\n        modeHint = 'xy'; // safe fallback\n      }\n      hintSourceFirst = 'geometry';\n    }\n    if (!modeHintLast) {\n      modeHintLast = modeHint;\n      if (!hintSourceLast) hintSourceLast = hintSourceFirst;\n    }\n\n    const smoothingIterations = Number(\n      raw.smoothing_iterations ||\n      raw.corner_smoothing_iterations ||\n      fs.smoothing_iterations ||\n      this.config.smoothing_iterations ||\n      (this.config.smoothing && this.config.smoothing.iterations) ||\n      0\n    );\n    const smoothingMaxPoints = Number(\n      raw.smoothing_max_points ||\n      fs.smoothing_max_points ||\n      this.config.smoothing_max_points ||\n      (this.config.smoothing && this.config.smoothing.max_points) ||\n      160\n    );\n    return {\n      id: overlay.id,\n      a: a1,\n      b: a2,\n      modeFull: (raw.route_mode_full || raw.route_mode || 'manhattan').toLowerCase(),\n      modeHint,\n      modeHintLast,\n      _hintSourceFirst: hintSourceFirst,\n      _hintSourceLast: hintSourceLast,\n      avoidIds: Array.isArray(raw.avoid) ? raw.avoid.slice() : [],\n      channels: (raw.route_channels || raw.routeChannels || []),\n      channelMode,\n      cornerRadius: Number(raw.corner_radius || raw.cornerRadius || fs.corner_radius || 0),\n      cornerStyle: (raw.corner_style || raw.cornerStyle || fs.corner_style || 'miter').toLowerCase(),\n      smoothingMode,\n      smoothingIterations,\n      smoothingMaxPoints,\n      clearance: Number(raw.clearance || this.config.clearance || 0),\n      proximity: Number(raw.smart_proximity || this.config.smart_proximity || 0),\n      smart: {\n        detourSpan: Number(this.config.smart_detour_span || 48),\n        maxExtraBends: Number(this.config.smart_max_extra_bends || 3),\n        minImprovement: Number(this.config.smart_min_improvement || 4),\n        maxDetoursPerElbow: Number(this.config.smart_max_detours_per_elbow || 4)\n      },\n      _rev: this._rev\n    };\n  }\n\n  _cacheKey(req) {\n    const [x1,y1] = req.a;\n    const [x2,y2] = req.b;\n    const avoidKey = req.avoidIds.sort().join(',');\n    const chanKey = req.channels.sort().join(',');\n    return `${req.id}@${x1},${y1}-${x2},${y2}|${req.modeFull}|${req.modeHint}|A:${avoidKey}|C:${chanKey}|${req.channelMode}|R:${req._rev}|O:${this._obsVersion}|P:${req.proximity}|CR:${req.cornerRadius}|CS:${req.cornerStyle}|SM:${req.smoothingMode}|SI:${req.smoothingIterations}`;\n  }\n\n  computePath(req) {\n    return perfTime('routing.compute.ms', () => {\n      const key = this._cacheKey(req);\n      const cached = this._cache.get(key);\n      if (cached) {\n        perfInc('routing.cache.hit', 1);\n        return { ...cached, meta: { ...cached.meta, cache_hit: true } };\n      }\n      perfInc('routing.cache.miss', 1);\n      let result;\n      const mode = req.modeFull;\n      try {\n        if (mode === 'grid') {\n          result = this._computeGrid(req);\n        } else if (mode === 'smart') {\n          perfInc('routing.strategy.smart', 1);\n          // Phase 1: base grid\n            const gridBase = this._computeGrid(req, { smart: true });\n          if (gridBase) {\n            result = this._refineSmart(req, gridBase);\n          }\n        }\n      } catch (e) {\n        console.warn('[MSD v1] smart/grid router error; fallback to manhattan', e);\n      }\n      if (!result) {\n        if (mode === 'smart') perfInc('routing.strategy.smart', 1);\n        result = this._computeManhattan(req);\n      }\n\n      if (result && req.cornerStyle === 'round' && req.cornerRadius > 0) {\n        const arcApplied = this._applyCornerRounding(result, req.cornerRadius);\n        if (arcApplied) result = arcApplied;\n      }\n      // NEW (M5.6) apply smoothing AFTER arcs (arcs preserved, path rebuilt as polyline if smoothing >0)\n      if (result && req.smoothingMode !== 'none' && req.smoothingIterations > 0) {\n        const smoothApplied = this._applySmoothing(result, req);\n        if (smoothApplied) result = smoothApplied;\n      }\n\n      this._cache.set(key, result);\n      this._cacheOrder.push(key);\n      if (this._cacheOrder.length > this._maxCache) {\n        const oldest = this._cacheOrder.shift();\n        if (oldest) this._cache.delete(oldest);\n      }\n      return { ...result, meta: { ...result.meta, cache_hit: false } };\n    });\n  }\n\n  _computeGrid(req, flags={}) {\n    perfInc('routing.strategy.grid', 1);\n    const vb = this.viewBox || [0,0,400,200];\n    const width = vb[2];\n    const height = vb[3];\n    const baseRes = Number(this.config.grid_resolution || 64);\n    const res = baseRes > 4 ? baseRes : 32;\n    const cols = Math.max(2, Math.ceil(width / res));\n    const rows = Math.max(2, Math.ceil(height / res));\n    const clearance = Math.max(0, req.clearance || this.config.clearance || 0);\n\n    const gridKey = `${res}|${this._obsVersion}|${clearance}`;\n    let occ = this._gridCache.get(gridKey);\n    if (!occ) {\n      occ = this._buildOccupancy(cols, rows, res, clearance);\n      this._gridCache.set(gridKey, occ);\n    }\n\n    const w2c = (x)=>Math.min(cols-1, Math.max(0, Math.round(x / res)));\n    const h2c = (y)=>Math.min(rows-1, Math.max(0, Math.round(y / res)));\n    const c2x = (c)=> c * res;\n    const c2y = (r)=> r * res;\n\n    const start = { c: w2c(req.a[0]), r: h2c(req.a[1]) };\n    const goal  = { c: w2c(req.b[0]), r: h2c(req.b[1]) };\n\n    // A* (4-direction)\n    const open = new MinHeap();\n    const key = (c,r)=>`${c},${r}`;\n    const gScore = new Map();\n    const came = new Map();\n    const h = (c,r)=> Math.abs(c-goal.c)+Math.abs(r-goal.r);\n\n    gScore.set(key(start.c,start.r),0);\n    open.push({ c:start.c, r:start.r, f:h(start.c,start.r) });\n\n    const blocked = (c,r)=> occ[r] && occ[r][c] === 1;\n\n    const maxIterations = cols*rows * 4; // guard\n    let iterations = 0;\n    let found = false;\n\n    while(!open.isEmpty() && iterations++ < maxIterations) {\n      const cur = open.pop();\n      if (cur.c === goal.c && cur.r === goal.r) { found = true; break; }\n      const gCur = gScore.get(key(cur.c,cur.r));\n      for (const [dc,dr] of [[1,0],[-1,0],[0,1],[0,-1]]) {\n        const nc = cur.c+dc, nr = cur.r+dr;\n        if (nc<0||nr<0||nc>=cols||nr>=rows) continue;\n        if (blocked(nc,nr)) continue;\n        const nk = key(nc,nr);\n        const gNew = gCur + 1;\n        if (gNew < (gScore.get(nk) ?? Infinity)) {\n            gScore.set(nk,gNew);\n            came.set(nk, [cur.c,cur.r]);\n            const f = gNew + h(nc,nr);\n            open.push({ c:nc, r:nr, f });\n        }\n      }\n    }\n\n    if (!found) {\n      return null; // caller will fallback\n    }\n\n    // Reconstruct\n    const pathCells = [];\n    let cc = goal.c, cr = goal.r;\n    while(true) {\n      pathCells.push([cc,cr]);\n      if (cc === start.c && cr === start.r) break;\n      const prev = came.get(key(cc,cr));\n      if (!prev) break;\n      [cc,cr] = prev;\n    }\n    pathCells.reverse();\n\n    // Compress straight runs into polyline world coords\n    const pts = [];\n    let lastDir = null;\n    for (let i=0;i<pathCells.length;i++) {\n      const [pc,pr] = pathCells[i];\n      const wx = c2x(pc);\n      const wy = c2y(pr);\n      if (i===0) { pts.push([wx,wy]); continue; }\n      const [pcPrev,prPrev] = pathCells[i-1];\n      const dir = [pc-pcPrev, pr-prPrev].join(',');\n      if (dir !== lastDir) {\n        // new direction, keep previous cell as corner (if not already added)\n        pts.push([wx,wy]);\n        lastDir = dir;\n      } else {\n        // same direction – update last point to current (extend segment)\n        pts[pts.length-1] = [wx,wy];\n      }\n    }\n    // Ensure final destination snapping\n    pts[0] = [req.a[0], req.a[1]];\n    pts[pts.length-1] = [req.b[0], req.b[1]];\n\n    // NEW (M5.2 fix): If compression produced a single diagonal segment, insert a Manhattan elbow.\n    if (pts.length === 2) {\n      const [sx, sy] = pts[0];\n      const [tx, ty] = pts[1];\n      if (sx !== tx && sy !== ty) {\n        const mode = (req.modeHint === 'yx') ? 'yx' : 'xy';\n        if (mode === 'yx') {\n          pts.splice(1, 0, [sx, ty]);\n        } else {\n          pts.splice(1, 0, [tx, sy]);\n        }\n      }\n    }\n\n    const bendW = (this.config?.cost_defaults?.bend ?? 10);\n    const proxW = (this.config?.cost_defaults?.proximity ?? 4);\n    const { penalty: proxPenalty } = this._segmentProximityPenalty(pts, req.clearance, req.proximity, proxW);\n    let channelInfo = this._channelDelta(pts, req);\n    let shapingMeta = null;\n    if (req.channels?.length && (req.channelMode === 'prefer' || req.channelMode === 'force')) {\n      const desired = (req.channelMode === 'force') ? 1.0 : this._channelTargetCoverage;\n      if (channelInfo.coverage < desired) {\n        const shapeRes = this._shapeForChannels(req, pts, channelInfo, desired);\n        if (shapeRes && shapeRes.accepted) {\n          pts = shapeRes.pts;\n          channelInfo = this._channelDelta(pts, req); // recompute\n          shapingMeta = shapeRes.meta;\n          perfInc('routing.channel.shape.accept', 1);\n        } else if (shapeRes) {\n          shapingMeta = shapeRes.meta;\n        }\n      }\n    }\n    const totalCost = this._costComposite(pts, bendW, proxW, proxPenalty, channelInfo.delta);\n    const d = this._polylineToPath(pts);\n    return {\n      d,\n      pts,\n      meta: {\n        strategy: flags.smart ? 'grid-smart-preface' : 'grid',\n        cost: totalCost,\n        segments: pts.length - 1,\n        bends: Math.max(0, pts.length - 2),\n        grid: { resolution: res, iterations },\n        ...(req.channels?.length ? {\n          channel: {\n            mode: channelInfo.mode,\n            insidePx: channelInfo.inside,\n            outsidePx: channelInfo.outside,\n            coveragePct: Number((channelInfo.coverage*100).toFixed(1)),\n            deltaCost: channelInfo.delta,\n            forcedOutside: channelInfo.forcedOutside,\n            ...(shapingMeta ? { shaping: shapingMeta } : {})\n          }\n        } : {})\n      }\n    };\n  }\n\n  _buildOccupancy(cols, rows, res, clearance) {\n    // 0 = free, 1 = blocked\n    const occ = Array.from({ length: rows }, () => new Uint8Array(cols));\n    if (!this._obstacles.length) return occ;\n    for (const ob of this._obstacles) {\n      const x1 = ob.x1 - clearance;\n      const y1 = ob.y1 - clearance;\n      const x2 = ob.x2 + clearance;\n      const y2 = ob.y2 + clearance;\n      const c0 = Math.max(0, Math.floor(x1 / res));\n      const r0 = Math.max(0, Math.floor(y1 / res));\n      const c1 = Math.min(cols-1, Math.ceil(x2 / res));\n      const r1 = Math.min(rows-1, Math.ceil(y2 / res));\n      for (let r=r0; r<=r1; r++) {\n        const row = occ[r];\n        for (let c=c0; c<=c1; c++) {\n          row[c] = 1;\n        }\n      }\n    }\n    return occ;\n  }\n\n  /**\n   * Manhattan routing supporting independent first and last segment hints.\n   * @param {object} req - Route request with modeHint and modeHintLast\n   */\n  _computeManhattan(req) {\n    const [x1, y1] = req.a;\n    const [x2, y2] = req.b;\n    const firstMode = (req.modeHint === 'yx') ? 'yx' : 'xy';\n    const lastMode  = (req.modeHintLast === 'yx') ? 'yx' : 'xy';\n    let pts;\n    if (x1 === x2 || y1 === y2) {\n      pts = [[x1,y1],[x2,y2]];\n    } else {\n      // We honor lastMode for the final segment orientation.\n      // lastMode = 'xy' => final segment is along Y (because order x then y)\n      // lastMode = 'yx' => final segment is along X.\n      if (lastMode === 'xy') {\n        // Final vertical => elbow shares x2, start y1\n        pts = [[x1,y1],[x2,y1],[x2,y2]];\n      } else {\n        // lastMode === 'yx' final horizontal => elbow shares y2, start x1\n        pts = [[x1,y1],[x1,y2],[x2,y2]];\n      }\n      // If explicit first hint conflicts, we could insert an intermediate elbow (optional)\n      // For now, we accept 3-point L shape determined by lastMode.\n    }\n    const d = this._polylineToPath(pts);\n    return {\n      d,\n      pts,\n      meta: {\n        strategy: 'manhattan-basic',\n        cost: this._costSimple(pts),\n        segments: pts.length - 1,\n        bends: Math.max(0, pts.length - 2),\n        hint: {\n          first: req.modeHint,\n            last: req.modeHintLast,\n          sourceFirst: req._hintSourceFirst,\n          sourceLast: req._hintSourceLast\n        }\n      }\n    };\n  }\n\n  _polylineToPath(pts) {\n    if (!pts.length) return '';\n    let p = `M${pts[0][0]},${pts[0][1]}`;\n    for (let i=1;i<pts.length;i++) {\n      p += ` L${pts[i][0]},${pts[i][1]}`;\n    }\n    return p;\n  }\n\n  _costSimple(pts) {\n    let dist = 0;\n    for (let i=1;i<pts.length;i++) {\n      const dx = pts[i][0]-pts[i-1][0];\n      const dy = pts[i][1]-pts[i-1][1];\n      dist += Math.abs(dx)+Math.abs(dy);\n    }\n    const bends = Math.max(0, pts.length-2);\n    const bendWeight = (this.config?.cost_defaults?.bend ?? 10);\n    return dist + bends * bendWeight;\n  }\n\n  _costComposite(pts, bendsWeight, proximityWeight, proximityPenalty, channelDelta = 0) {\n    // distance + bendsWeight*bends + proximityWeight*penalty\n    let dist = 0;\n    for (let i=1;i<pts.length;i++) {\n      dist += Math.abs(pts[i][0]-pts[i-1][0]) + Math.abs(pts[i][1]-pts[i-1][1]);\n    }\n    const bends = Math.max(0, pts.length - 2);\n    return dist + bends * bendsWeight + proximityPenalty * proximityWeight + channelDelta;\n  }\n\n  _segmentProximityPenalty(pts, clearance, proximity, proximityWeightRaw) {\n    if (!proximity || !this._obstacles.length) return { penalty: 0, detail: [] };\n    const band = clearance + proximity;\n    let total = 0;\n    const detail = [];\n    for (let i=1;i<pts.length;i++) {\n      const a = pts[i-1], b = pts[i];\n      const segPenalty = this._nearestObstacleBandOverlap(a, b, band);\n      if (segPenalty > 0) {\n        total += segPenalty;\n        detail.push({ i, segPenalty });\n      }\n    }\n    return { penalty: total, detail };\n  }\n\n  _nearestObstacleBandOverlap(a, b, band) {\n    // Axis-aligned segments only\n    const vertical = a[0] === b[0];\n    const x1 = Math.min(a[0], b[0]);\n    const x2 = Math.max(a[0], b[0]);\n    const y1 = Math.min(a[1], b[1]);\n    const y2 = Math.max(a[1], b[1]);\n    let worst = 0;\n    for (const ob of this._obstacles) {\n      // Quick reject bounding box enlarged by band\n      if (x2 < ob.x1 - band || x1 > ob.x2 + band || y2 < ob.y1 - band || y1 > ob.y2 + band) continue;\n      let d;\n      if (vertical) {\n        // Distance from line x=a.x to obstacle horizontal span\n        if (a[0] < ob.x1) d = ob.x1 - a[0];\n        else if (a[0] > ob.x2) d = a[0] - ob.x2;\n        else d = 0;\n      } else {\n        if (a[1] < ob.y1) d = ob.y1 - a[1];\n        else if (a[1] > ob.y2) d = a[1] - ob.y2;\n        else d = 0;\n      }\n      if (d < band) {\n        const p = (band - d); // linear penalty (could square later)\n        if (p > worst) worst = p;\n      }\n    }\n    return worst;\n  }\n\n  _normalizeChannels(list) {\n    if (!Array.isArray(list)) return [];\n    return list\n      .filter(c => c && Array.isArray(c.rect) && c.rect.length === 4)\n      .map(c => {\n        const [x,y,w,h] = c.rect;\n        return {\n          id: c.id || `chan_${x}_${y}`,\n          x1: x, y1: y, x2: x + w, y2: y + h,\n          weight: Number(c.weight || c.w || 0.5)\n        };\n      });\n  }\n\n  _channelDelta(pts, req) {\n    if (!this._channels.length || !req.channels || !req.channels.length) return { delta: 0, inside: 0, outside: 0, coverage: 0, forcedOutside: false, mode: req.channelMode };\n    // Filter to requested channel IDs (ignore unknown)\n    const chanSet = new Set(req.channels);\n    const chans = this._channels.filter(c => chanSet.has(c.id));\n    if (!chans.length) return { delta: 0, inside: 0, outside: 0, coverage: 0, forcedOutside: false };\n\n    let inside = 0;\n    let outside = 0;\n    // Forcing: a point is \"inside preferred set\" if midpoint is inside ANY requested channel rect.\n    for (let i=1;i<pts.length;i++) {\n      const a = pts[i-1], b = pts[i];\n      const segLen = Math.abs(a[0]-b[0]) + Math.abs(a[1]-b[1]);\n      if (segLen === 0) continue;\n      // Midpoint (orthogonal so pick center)\n      const mx = (a[0] + b[0]) / 2;\n      const my = (a[1] + b[1]) / 2;\n      const inChan = chans.some(c => mx >= c.x1 && mx <= c.x2 && my >= c.y1 && my <= c.y2);\n      if (inChan) inside += segLen;\n      else outside += segLen;\n    }\n    const coverage = inside / (inside + outside || 1);\n    let delta = 0;\n    const mode = (req.channelMode || 'prefer').toLowerCase();\n    let forcedOutside = false;\n    if (mode === 'prefer') {\n      // Reward inside (subtract)\n      const weightAvg = chans.reduce((s,c)=>s+c.weight,0)/chans.length;\n      delta -= inside * weightAvg;\n    } else if (mode === 'avoid') {\n      const weightAvg = chans.reduce((s,c)=>s+c.weight,0)/chans.length;\n      delta += inside * weightAvg * this._channelAvoidMultiplier;\n    } else if (mode === 'force') {\n      if (outside > 0) {\n        forcedOutside = true;\n        delta += this._channelForcePenalty;\n      } else {\n        const weightAvg = chans.reduce((s,c)=>s+c.weight,0)/chans.length;\n        delta -= inside * weightAvg; // full reward when fully inside\n      }\n    }\n    if (delta !== 0) perfInc('routing.channel.applied', 1);\n    if (forcedOutside) perfInc('routing.channel.force.penalty', 1);\n    return { delta, inside, outside, coverage, forcedOutside, mode: req.channelMode };\n  }\n\n  _refineSmart(req, gridBase) {\n    if (!gridBase || !Array.isArray(gridBase.pts) || gridBase.pts.length < 2) return gridBase;\n    const bendW = (this.config?.cost_defaults?.bend ?? 10);\n    const proxW = (this.config?.cost_defaults?.proximity ?? 4);\n    const { penalty: penaltyBefore } = this._segmentProximityPenalty(gridBase.pts, req.clearance, req.proximity, proxW);\n    let bestPts = gridBase.pts.slice();\n    let bestPenalty = penaltyBefore;\n    let bestCost = this._costComposite(bestPts, bendW, proxW, bestPenalty);\n    let detoursTried = 0;\n    let detoursAccepted = 0;\n\n    if (req.proximity > 0 && bestPts.length > 2) {\n      // Try shifting each elbow (not endpoints)\n      const span = req.smart.detourSpan;\n      const maxExtraBends = req.smart.maxExtraBends;\n      const minImprove = req.smart.min_improvement;\n      for (let i=1;i<bestPts.length-1;i++) {\n        const elbow = bestPts[i];\n        const prev = bestPts[i-1];\n        const next = bestPts[i+1];\n        const verticalIn = prev[0] === elbow[0]; // incoming dir\n        const horizontalOut = elbow[1] === next[1]; // outgoing dir\n        // Only elbows where both dirs present (true elbow)\n        if ((verticalIn && horizontalOut) || (!verticalIn && !horizontalOut)) {\n          // Determine orthogonal shift axis (shift elbow along one axis to widen clearance)\n          const candidates = [];\n          if (verticalIn && horizontalOut) {\n            // elbow shape └ or ┌ etc. shift in a box: along x and y\n            candidates.push([elbow[0] + span, elbow[1]]);\n            candidates.push([elbow[0] - span, elbow[1]]);\n            candidates.push([elbow[0], elbow[1] + span]);\n            candidates.push([elbow[0], elbow[1] - span]);\n          } else {\n            candidates.push([elbow[0] + span, elbow[1]]);\n            candidates.push([elbow[0] - span, elbow[1]]);\n            candidates.push([elbow[0], elbow[1] + span]);\n            candidates.push([elbow[0], elbow[1] - span]);\n          }\n          let tries = 0;\n          for (const c of candidates) {\n            if (tries++ >= req.smart.maxDetoursPerElbow) break;\n            detoursTried++;\n            const newPts = bestPts.slice();\n            newPts[i] = c;\n            // Prevent duplicate successive collinear points (basic)\n            const compact = this._compactPolyline(newPts);\n            if (compact.length - bestPts.length > maxExtraBends) continue;\n            const { penalty: p2 } = this._segmentProximityPenalty(compact, req.clearance, req.proximity, proxW);\n            const cost2 = this._costComposite(compact, bendW, proxW, p2);\n            if (cost2 + minImprove <= bestCost) {\n              bestCost = cost2;\n              bestPts = compact;\n              bestPenalty = p2;\n              detoursAccepted++;\n            }\n          }\n        }\n      }\n    }\n\n    const channelInfo = this._channelDelta(bestPts, req);\n    // Channel shaping (only prefer/force & if coverage below target)\n    let shapingMeta = null;\n    if (req.channels?.length && (req.channelMode === 'prefer' || req.channelMode === 'force')) {\n      const desired = (req.channelMode === 'force') ? 1.0 : this._channelTargetCoverage;\n      if (channelInfo.coverage < desired) {\n        const shapeRes = this._shapeForChannels(req, bestPts, channelInfo, desired);\n        if (shapeRes && shapeRes.accepted) {\n          bestPts = shapeRes.pts;\n          // recompute penalties\n          const newChan = this._channelDelta(bestPts, req);\n          const { penalty: newProx } = this._segmentProximityPenalty(bestPts, req.clearance, req.proximity, proxW);\n            bestPenalty = newProx; // proximity might change slightly (rare) – reassign\n          shapingMeta = shapeRes.meta;\n          // recompute cost with new channel delta\n          bestCost = this._costComposite(bestPts, bendW, proxW, bestPenalty, newChan.delta);\n          // overwrite channelInfo for meta\n          channelInfo.inside = newChan.inside;\n          channelInfo.outside = newChan.outside;\n          channelInfo.coverage = newChan.coverage;\n          channelInfo.delta = newChan.delta;\n          channelInfo.forcedOutside = newChan.forcedOutside;\n          perfInc('routing.channel.shape.accept', 1);\n        } else if (shapeRes) {\n          shapingMeta = shapeRes.meta;\n        }\n      }\n    }\n    // REPLACED duplicate const bestCost decl with in-place update earlier\n    bestCost = this._costComposite(bestPts, bendW, proxW, bestPenalty, channelInfo.delta);\n    const d = this._polylineToPath(bestPts);\n    const baseMeta = gridBase.meta || {};\n    baseMeta.strategy = 'smart';\n    baseMeta.cost = bestCost;\n    baseMeta.bends = Math.max(0, bestPts.length - 2);\n    baseMeta.segments = bestPts.length - 1;\n    baseMeta.smart = {\n      penaltyBefore,\n      penaltyAfter: bestPenalty,\n      detoursTried,\n      detoursAccepted\n    };\n    if (req.channels?.length) {\n      baseMeta.channel = {\n        mode: channelInfo.mode,\n        insidePx: channelInfo.inside,\n        outsidePx: channelInfo.outside,\n        coveragePct: Number((channelInfo.coverage*100).toFixed(1)),\n        deltaCost: channelInfo.delta,\n        forcedOutside: channelInfo.forcedOutside,\n        ...(shapingMeta ? { shaping: shapingMeta } : {})\n      };\n    }\n    perfInc('routing.smart.refine.attempt', detoursTried);\n    perfInc('routing.smart.refine.accept', detoursAccepted);\n    return { d, pts: bestPts, meta: baseMeta };\n  }\n\n  _compactPolyline(pts) {\n    if (pts.length <= 2) return pts;\n    const out = [pts[0]];\n    for (let i=1;i<pts.length-1;i++) {\n      const a = out[out.length-1];\n      const b = pts[i];\n      const c = pts[i+1];\n      // If a->b and b->c are collinear, skip b\n      if ((a[0] === b[0] && b[0] === c[0]) || (a[1] === b[1] && b[1] === c[1])) continue;\n      out.push(b);\n    }\n    out.push(pts[pts.length-1]);\n    return out;\n  }\n\n  _shapeForChannels(req, pts, channelInfo, desiredCoverage) {\n    perfInc('routing.channel.shape.attempt', 1);\n    const attemptsMax = this._channelShapingMaxAttempts;\n    const span = this._channelShapingSpan;\n    const minGain = this._channelMinCoverageGain;\n    const chanIds = new Set(req.channels);\n    const chans = this._channels.filter(c => chanIds.has(c.id));\n    if (!chans.length) return null;\n\n    const coverage0 = channelInfo.coverage;\n    let bestPts = pts.slice();\n    let bestCoverage = coverage0;\n    let accepted = false;\n    let attempts = 0;\n    let coverageHistory = [Number(coverage0.toFixed(4))];\n    const forceMode = (req.channelMode === 'force');\n\n    function midpoint(a,b){ return [(a[0]+b[0])/2,(a[1]+b[1])/2]; }\n    const inAny = (x,y)=>chans.some(c=> x>=c.x1 && x<=c.x2 && y>=c.y1 && y<=c.y2);\n\n    const segsOutside = () => {\n      const list = [];\n      for (let i=1;i<bestPts.length;i++){\n        const a=bestPts[i-1], b=bestPts[i];\n        const len=Math.abs(a[0]-b[0])+Math.abs(a[1]-b[1]);\n        if(!len) continue;\n        const [mx,my]=midpoint(a,b);\n        if(!inAny(mx,my)) list.push({i,len,a,b,mx,my});\n      }\n      return list.sort((x,y)=>y.len-x.len);\n    };\n\n    while (attempts < attemptsMax) {\n      attempts++;\n      const outsideSegs = segsOutside();\n      if (!outsideSegs.length) break; // fully inside\n      // pick the largest outside segment\n      const seg = outsideSegs[0];\n      // Try shifting its interior elbow(s) if any\n      // Identify candidate elbow indices around this segment\n      const elbowIndices = [];\n      if (seg.i-1 > 0) elbowIndices.push(seg.i-1);\n      if (seg.i < bestPts.length-1) elbowIndices.push(seg.i);\n\n      let improved = false;\n      for (const ei of elbowIndices) {\n        const copy = bestPts.map(p=>p.slice());\n        // shift target elbow towards nearest channel center\n        const e = copy[ei];\n        // Compute shortest move vector to enter any channel (axis aligned)\n        let bestMove = null;\n        let bestMoveDist = Infinity;\n        chans.forEach(c => {\n          // For a point outside, compute minimal axis step into rect\n            const dx = (e[0] < c.x1) ? (c.x1 - e[0]) :\n                       (e[0] > c.x2) ? (c.x2 - e[0]) : 0;\n            const dy = (e[1] < c.y1) ? (c.y1 - e[1]) :\n                       (e[1] > c.y2) ? (c.y2 - e[1]) : 0;\n          // Only consider moving along one axis per attempt (choose smaller non-zero)\n          if (dx !==0 && dy !==0) {\n            // pick smaller\n            if (Math.abs(dx) < Math.abs(dy)) {\n              if (Math.abs(dx) < bestMoveDist) { bestMoveDist = Math.abs(dx); bestMove = [dx,0]; }\n            } else {\n              if (Math.abs(dy) < bestMoveDist) { bestMoveDist = Math.abs(dy); bestMove = [0,dy]; }\n            }\n          } else if (dx !==0 || dy !==0) {\n            const d = Math.abs(dx||dy);\n            if (d < bestMoveDist) { bestMoveDist = d; bestMove = [dx,dy]; }\n          }\n        });\n        if (!bestMove) continue;\n        // scale move to span (limit)\n        const mv = [\n          bestMove[0] === 0 ? 0 : Math.sign(bestMove[0]) * Math.min(Math.abs(bestMove[0]), span),\n          bestMove[1] === 0 ? 0 : Math.sign(bestMove[1]) * Math.min(Math.abs(bestMove[1]), span)\n        ];\n        copy[ei] = [e[0] + mv[0], e[1] + mv[1]];\n        // Compact polyline if collinear introduced\n        const compact = this._compactPolyline(copy);\n        const newChan = this._channelDelta(compact, req);\n        const gain = newChan.coverage - bestCoverage;\n        if (gain >= minGain) {\n          bestPts = compact;\n          bestCoverage = newChan.coverage;\n          coverageHistory.push(Number(bestCoverage.toFixed(4)));\n          improved = true;\n          if (forceMode && bestCoverage >= 0.999) break;\n          if (!forceMode && bestCoverage >= desiredCoverage) break;\n        }\n      }\n      if (!improved) break;\n      if ((forceMode && bestCoverage >= 0.999) || (!forceMode && bestCoverage >= desiredCoverage)) {\n        accepted = true;\n        break;\n      }\n    }\n\n    // Force downgrade if still outside & force mode\n    let downgraded = false;\n    if (forceMode && bestCoverage < 0.999) {\n      downgraded = true;\n      // mark but caller meta will keep mode=force + forcedOutside flag (HUD can show downgrade)\n      perfInc('routing.channel.shape.downgrade', 1);\n    }\n\n    return {\n      accepted,\n      pts: bestPts,\n      meta: {\n        attempts,\n        coverageBefore: Number(coverage0.toFixed(4)),\n        coverageAfter: Number(bestCoverage.toFixed(4)),\n        coverageHistory,\n        accepted,\n        downgraded\n      }\n    };\n  }\n\n  _applyCornerRounding(routeResult, radiusGlobal) {\n    const pts = routeResult.pts;\n    if (!Array.isArray(pts) || pts.length < 3) {\n      perfInc('routing.arc.none', 1);\n      return null;\n    }\n    const arcMin = 1;\n    let arcCount = 0;\n    let totalTrim = 0;\n    const parts = [];\n    let lastOut = pts[0].slice();\n    parts.push(`M${lastOut[0]},${lastOut[1]}`);\n    for (let i = 1; i < pts.length - 1; i++) {\n      const pPrev = pts[i - 1];\n      const p = pts[i];\n      const pNext = pts[i + 1];\n      const vIn = [p[0] - pPrev[0], p[1] - pPrev[1]];\n      const vOut = [pNext[0] - p[0], pNext[1] - p[1]];\n      const isOrth = (vIn[0] === 0 || vIn[1] === 0) && (vOut[0] === 0 || vOut[1] === 0) && !(vIn[0] === 0 && vIn[1] === 0) && !(vOut[0] === 0 && vOut[1] === 0) && !(Math.sign(vIn[0]) === Math.sign(vOut[0]) && vIn[0] !== 0) && !(Math.sign(vIn[1]) === Math.sign(vOut[1]) && vIn[1] !== 0);\n      if (!isOrth) {\n        // Just connect full corner\n        if (p[0] !== lastOut[0] || p[1] !== lastOut[1]) {\n          parts.push(`L${p[0]},${p[1]}`);\n          lastOut = p.slice();\n        }\n        continue;\n      }\n      const lenIn = Math.abs(vIn[0]) + Math.abs(vIn[1]);\n      const lenOut = Math.abs(vOut[0]) + Math.abs(vOut[1]);\n      let r = Math.min(radiusGlobal, lenIn / 2, lenOut / 2);\n      if (r < arcMin) {\n        if (p[0] !== lastOut[0] || p[1] !== lastOut[1]) {\n          parts.push(`L${p[0]},${p[1]}`);\n          lastOut = p.slice();\n        }\n        continue;\n      }\n      // Trim points\n      let pInTrim = p.slice();\n      if (vIn[0] !== 0) {\n        pInTrim[0] = p[0] - Math.sign(vIn[0]) * r;\n      } else {\n        pInTrim[1] = p[1] - Math.sign(vIn[1]) * r;\n      }\n      let pOutTrim = p.slice();\n      if (vOut[0] !== 0) {\n        pOutTrim[0] = p[0] + Math.sign(vOut[0]) * r;\n      } else {\n        pOutTrim[1] = p[1] + Math.sign(vOut[1]) * r;\n      }\n      // Line to trimmed incoming point\n      if (pInTrim[0] !== lastOut[0] || pInTrim[1] !== lastOut[1]) {\n        parts.push(`L${pInTrim[0]},${pInTrim[1]}`);\n      }\n      // Determine sweep flag (clockwise vs counter-clockwise) using z of 2D cross\n      const cross = vIn[0] * vOut[1] - vIn[1] * vOut[0];\n      const sweep = cross < 0 ? 0 : 1;\n      // Use small arc (90°) => large-arc-flag = 0\n      parts.push(`A${r},${r} 0 0 ${sweep} ${pOutTrim[0]},${pOutTrim[1]}`);\n      totalTrim += 2 * r;\n      arcCount++;\n      lastOut = pOutTrim;\n    }\n    // Last point\n    const pEnd = pts[pts.length - 1];\n    if (pEnd[0] !== lastOut[0] || pEnd[1] !== lastOut[1]) {\n      parts.push(`L${pEnd[0]},${pEnd[1]}`);\n    }\n    // If no arcs applied, skip\n    if (!arcCount) {\n      perfInc('routing.arc.none', 1);\n      return null;\n    }\n    perfInc('routing.arc.apply', 1);\n    const newResult = {\n      ...routeResult,\n      d: parts.join(' '),\n      meta: {\n        ...routeResult.meta,\n        arc: {\n          count: arcCount,\n          trimPx: Math.round(totalTrim)\n        }\n      }\n    };\n    return newResult;\n  }\n\n  _applySmoothing(routeResult, req) {\n    const mode = req.smoothingMode;\n    if (mode === 'none' || req.smoothingIterations <= 0) return null;\n    let iters = Math.min(5, Math.max(1, req.smoothingIterations|0));\n    if (!Array.isArray(routeResult.pts) || routeResult.pts.length < 3) return null;\n    if (mode !== 'chaikin') return null; // only mode supported now\n    let pts = routeResult.pts.map(p=>[p[0],p[1]]);\n    // If arcs already applied we try to reconstruct polyline from original pts (already available)\n    // Chaikin corner cutting\n    for (let k=0; k<iters; k++) {\n      const next = [pts[0]];\n      for (let i=0;i<pts.length-1;i++){\n        const p=pts[i], q=pts[i+1];\n        const Q=[0.75*p[0]+0.25*q[0], 0.75*p[1]+0.25*q[1]];\n        const R=[0.25*p[0]+0.75*q[0], 0.25*p[1]+0.75*q[1]];\n        next.push(Q,R);\n        if (next.length >= req.smoothingMaxPoints) break;\n      }\n      next.push(pts[pts.length-1]);\n      pts = next;\n      if (pts.length >= req.smoothingMaxPoints) break;\n    }\n    // Build path (polyline with many short segments)\n    const d = pts.reduce((acc,p,i)=> acc + (i?` L${p[0]},${p[1]}`:`M${p[0]},${p[1]}`),'');\n    const newMeta = {\n      ...routeResult.meta,\n      smooth: {\n        mode,\n        iterations: iters,\n        points: pts.length,\n        addedPoints: pts.length - routeResult.pts.length\n      }\n    };\n    perfInc('routing.smooth.apply',1);\n    return { ...routeResult, d, pts, meta: newMeta };\n  }\n}\n\n// Simple min-heap for A*\nclass MinHeap {\n  constructor(){ this.a=[]; }\n  push(n){ this.a.push(n); this._up(this.a.length-1); }\n  pop(){\n    if(!this.a.length) return null;\n    const top=this.a[0];\n    const last=this.a.pop();\n    if(this.a.length){ this.a[0]=last; this._down(0); }\n    return top;\n  }\n  isEmpty(){ return this.a.length===0; }\n  _up(i){\n    while(i>0){\n      const p=(i-1)>>1;\n      if(this.a[p].f <= this.a[i].f) break;\n      [this.a[p],this.a[i]]=[this.a[i],this.a[p]];\n      i=p;\n    }\n  }\n  _down(i){\n    const n=this.a.length;\n    while(true){\n      let l=i*2+1, r=l+1, m=i;\n      if(l<n && this.a[l].f < this.a[m].f) m=l;\n      if(r<n && this.a[r].f < this.a[m].f) m=r;\n      if(m===i) break;\n      [this.a[m],this.a[i]]=[this.a[i],this.a[m]];\n      i=m;\n    }\n  }\n}\n","/**\n * Object hashing utilities for semantic comparison\n * Used by animation registry and other caching systems\n */\n\n/**\n * Compute deterministic hash of an object\n */\nexport function computeObjectHash(obj) {\n  const normalized = normalizeForHashing(obj);\n  const serialized = stableStringify(normalized);\n  return simpleHash(serialized);\n}\n\n/**\n * Normalize object for consistent hashing\n */\nfunction normalizeForHashing(obj) {\n  if (obj === null || obj === undefined) return null;\n\n  if (typeof obj !== 'object') return obj;\n\n  if (Array.isArray(obj)) {\n    return obj.map(normalizeForHashing);\n  }\n\n  const normalized = {};\n  Object.keys(obj).sort().forEach(key => {\n    normalized[key] = normalizeForHashing(obj[key]);\n  });\n\n  return normalized;\n}\n\n/**\n * Stable JSON stringify with sorted keys\n */\nfunction stableStringify(obj) {\n  if (typeof obj !== 'object' || obj === null) {\n    return JSON.stringify(obj);\n  }\n\n  if (Array.isArray(obj)) {\n    return '[' + obj.map(stableStringify).join(',') + ']';\n  }\n\n  const keys = Object.keys(obj).sort();\n  const pairs = keys.map(key => `\"${key}\":${stableStringify(obj[key])}`);\n  return '{' + pairs.join(',') + '}';\n}\n\n/**\n * Simple but effective hash function\n */\nfunction simpleHash(str) {\n  let hash = 0;\n\n  for (let i = 0; i < str.length; i++) {\n    const char = str.charCodeAt(i);\n    hash = ((hash << 5) - hash) + char;\n    hash = hash & hash; // Convert to 32bit integer\n  }\n\n  // Convert to positive string\n  return Math.abs(hash).toString(36);\n}\n\n/**\n * Compare two objects for semantic equality\n */\nexport function objectsEqual(a, b) {\n  return computeObjectHash(a) === computeObjectHash(b);\n}\n\n/**\n * Hash array of objects consistently\n */\nexport function hashArray(arr) {\n  if (!Array.isArray(arr)) return computeObjectHash(arr);\n\n  const hashes = arr.map(computeObjectHash);\n  return simpleHash(hashes.join('|'));\n}\n","import { perfTime, perfTimeAsync, perfCount } from '../util/performance.js';\nimport { computeObjectHash } from '../util/hashing.js';\n\n/**\n * Animation Registry for efficient animation reuse\n * Provides semantic comparison and intelligent caching\n */\nexport class AnimationRegistry {\n  constructor() {\n    this.cache = new Map(); // hash -> instance\n    this.instanceToHash = new WeakMap(); // instance -> hash\n    this.usageStats = new Map(); // hash -> { count, lastUsed }\n    this.maxCacheSize = 500;\n    this.cleanupThreshold = 600;\n\n    // Performance tracking\n    this.perfStats = {\n      cacheHits: 0,\n      cacheMisses: 0,\n      instancesCreated: 0,\n      instancesReused: 0,\n      cleanupRuns: 0\n    };\n  }\n\n  /**\n   * Get or create animation instance with intelligent reuse\n   */\n  getOrCreateInstance(definition, targets) {\n    return perfTime('animation.getInstance', () => {\n      const hash = this.computeInstanceHash(definition);\n\n      // Check cache first\n      if (this.cache.has(hash)) {\n        const cached = this.cache.get(hash);\n\n        // Verify targets compatibility\n        if (this.targetsCompatible(cached.targets, targets)) {\n          this.recordCacheHit(hash);\n          perfCount('animation.instance.reuse', 1);\n          this.perfStats.instancesReused++;\n\n          return this.reuseInstance(cached, targets);\n        } else {\n          // Targets incompatible, remove from cache\n          this.cache.delete(hash);\n          this.perfStats.cacheMisses++;\n        }\n      }\n\n      // Create new instance\n      const instance = this.createAnimationInstance(definition, targets);\n\n      // Cache the instance\n      this.cacheInstance(hash, instance, definition);\n\n      perfCount('animation.instance.new', 1);\n      this.perfStats.instancesCreated++;\n      this.perfStats.cacheMisses++;\n\n      return instance;\n    });\n  }\n\n  /**\n   * Compute semantic hash for animation definition\n   */\n  computeInstanceHash(definition) {\n    // Extract only semantic properties (exclude DOM references)\n    const semantic = {\n      preset: definition.preset,\n      params: this.normalizeParams(definition.params),\n      duration: this.normalizeNumber(definition.duration),\n      easing: definition.easing,\n      loop: definition.loop,\n      alternate: definition.alternate,\n      delay: this.normalizeNumber(definition.delay),\n      // Exclude: targets, callbacks, DOM-specific properties\n    };\n\n    // Handle animation_ref and overrides\n    if (definition.animation_ref) {\n      semantic.animation_ref = definition.animation_ref;\n      if (definition.override) {\n        semantic.override = this.normalizeParams(definition.override.params);\n      }\n    }\n\n    return computeObjectHash(semantic);\n  }\n\n  /**\n   * Normalize a single number to prevent precision churn\n   */\n  normalizeNumber(value) {\n    if (typeof value === 'number') {\n      return Math.round(value * 1000) / 1000;\n    }\n    return value;\n  }\n\n  /**\n   * Normalize parameters to reduce hash churn from floating point precision\n   */\n  normalizeParams(params) {\n    if (!params || typeof params !== 'object') return params;\n\n    const normalized = {};\n    Object.entries(params).forEach(([key, value]) => {\n      if (typeof value === 'number') {\n        // Round to 3 decimal places to prevent hash churn\n        normalized[key] = Math.round(value * 1000) / 1000;\n      } else if (Array.isArray(value)) {\n        normalized[key] = value.map(v =>\n          typeof v === 'number' ? Math.round(v * 1000) / 1000 : v\n        );\n      } else if (typeof value === 'object' && value !== null) {\n        normalized[key] = this.normalizeParams(value);\n      } else {\n        normalized[key] = value;\n      }\n    });\n\n    return normalized;\n  }\n\n  /**\n   * Check if animation targets are compatible for reuse\n   */\n  targetsCompatible(cachedTargets, newTargets) {\n    if (!cachedTargets || !newTargets) return false;\n\n    // Convert to arrays for comparison\n    const cached = Array.isArray(cachedTargets) ? cachedTargets : [cachedTargets];\n    const newOnes = Array.isArray(newTargets) ? newTargets : [newTargets];\n\n    if (cached.length !== newOnes.length) return false;\n\n    // For DOM elements, compare by id or selector\n    for (let i = 0; i < cached.length; i++) {\n      const cachedTarget = cached[i];\n      const newTarget = newOnes[i];\n\n      // String selectors must match exactly\n      if (typeof cachedTarget === 'string' && typeof newTarget === 'string') {\n        if (cachedTarget !== newTarget) return false;\n        continue;\n      }\n\n      // DOM elements - compare by id or position in DOM\n      if (cachedTarget?.id && newTarget?.id) {\n        if (cachedTarget.id !== newTarget.id) return false;\n        continue;\n      }\n\n      // If we can't determine compatibility, assume incompatible\n      return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Create new animation instance using the runtime animation system\n   */\n  createAnimationInstance(definition, targets) {\n    try {\n      // Use the global animation system if available\n      if (typeof window !== 'undefined' && window.cblcars?.anim?.create) {\n        return window.cblcars.anim.create(definition, targets);\n      }\n\n      // Fallback mock for testing\n      return {\n        definition: { ...definition },\n        targets: Array.isArray(targets) ? [...targets] : [targets],\n        id: `anim_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,\n        play: () => {},\n        pause: () => {},\n        stop: () => {},\n        restart: () => {}\n      };\n    } catch (error) {\n      console.warn('[AnimationRegistry] Failed to create animation instance:', error);\n      return null;\n    }\n  }\n\n  /**\n   * Reuse existing animation instance with new targets\n   */\n  reuseInstance(cachedInstance, newTargets) {\n    try {\n      // If the animation system supports retargeting, use it\n      if (cachedInstance.retarget && typeof cachedInstance.retarget === 'function') {\n        return cachedInstance.retarget(newTargets);\n      }\n\n      // Otherwise, create a shallow copy with new targets\n      return {\n        ...cachedInstance,\n        targets: Array.isArray(newTargets) ? [...newTargets] : [newTargets],\n        id: `${cachedInstance.id}_reused_${Date.now()}`\n      };\n    } catch (error) {\n      console.warn('[AnimationRegistry] Failed to reuse animation instance:', error);\n      return this.createAnimationInstance(cachedInstance.definition, newTargets);\n    }\n  }\n\n  /**\n   * Cache animation instance with metadata\n   */\n  cacheInstance(hash, instance, definition) {\n    // Store in cache\n    this.cache.set(hash, {\n      instance,\n      definition,\n      targets: instance.targets,\n      createdAt: Date.now(),\n      hash\n    });\n\n    // Track usage\n    this.usageStats.set(hash, {\n      count: 1,\n      lastUsed: Date.now(),\n      hash\n    });\n\n    // Map instance back to hash for debugging\n    this.instanceToHash.set(instance, hash);\n\n    // Clean cache if needed AFTER adding the new item\n    if (this.cache.size > this.maxCacheSize) {\n      this.cleanupCache();\n    }\n  }\n\n  /**\n   * Record cache hit and update usage statistics\n   */\n  recordCacheHit(hash) {\n    const usage = this.usageStats.get(hash);\n    if (usage) {\n      usage.count++;\n      usage.lastUsed = Date.now();\n    }\n\n    this.perfStats.cacheHits++;\n  }\n\n  /**\n   * Clean up least recently used cache entries\n   */\n  cleanupCache() {\n    perfTime('animation.cache.cleanup', () => {\n      const entries = Array.from(this.usageStats.entries());\n\n      // Sort by last used time (oldest first)\n      entries.sort(([, a], [, b]) => a.lastUsed - b.lastUsed);\n\n      // Remove oldest entries until we're under max size\n      const toRemove = entries.slice(0, entries.length - this.maxCacheSize);\n\n      toRemove.forEach(([hash]) => {\n        this.cache.delete(hash);\n        this.usageStats.delete(hash);\n      });\n\n      this.perfStats.cleanupRuns++;\n      perfCount('animation.cache.cleanup', toRemove.length);\n    });\n  }\n\n  /**\n   * Get performance statistics\n   */\n  getStats() {\n    const stats = { ...this.perfStats };\n\n    stats.cacheSize = this.cache.size;\n    stats.hitRate = stats.cacheHits / (stats.cacheHits + stats.cacheMisses) || 0;\n    stats.reuseRate = stats.instancesReused / (stats.instancesReused + stats.instancesCreated) || 0;\n\n    return stats;\n  }\n\n  /**\n   * Get cache contents for debugging\n   */\n  getCacheContents() {\n    const contents = {};\n\n    this.cache.forEach((cached, hash) => {\n      const usage = this.usageStats.get(hash);\n      contents[hash] = {\n        definition: cached.definition,\n        createdAt: cached.createdAt,\n        usage: usage ? { count: usage.count, lastUsed: usage.lastUsed } : null\n      };\n    });\n\n    return contents;\n  }\n\n  /**\n   * Clear cache and reset statistics\n   */\n  clear() {\n    this.cache.clear();\n    this.usageStats.clear();\n    this.perfStats = {\n      cacheHits: 0,\n      cacheMisses: 0,\n      instancesCreated: 0,\n      instancesReused: 0,\n      cleanupRuns: 0\n    };\n\n    perfCount('animation.cache.cleared', 1);\n  }\n\n  /**\n   * Export cache statistics for analysis\n   */\n  exportStats(options = {}) {\n    const stats = this.getStats();\n\n    if (options.includeCache) {\n      stats.cacheContents = this.getCacheContents();\n    }\n\n    if (options.format === 'csv') {\n      return this.exportToCsv(stats);\n    }\n\n    return JSON.stringify(stats, null, 2);\n  }\n\n  exportToCsv(stats) {\n    const rows = [\n      'metric,value',\n      `cacheHits,${stats.cacheHits}`,\n      `cacheMisses,${stats.cacheMisses}`,\n      `instancesCreated,${stats.instancesCreated}`,\n      `instancesReused,${stats.instancesReused}`,\n      `cacheSize,${stats.cacheSize}`,\n      `hitRate,${stats.hitRate.toFixed(3)}`,\n      `reuseRate,${stats.reuseRate.toFixed(3)}`,\n      `cleanupRuns,${stats.cleanupRuns}`\n    ];\n\n    return rows.join('\\n');\n  }\n}\n\n// Create global registry instance\nconst globalAnimationRegistry = new AnimationRegistry();\n\n// Debug exposure\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdAnimRegistry = {\n    registry: globalAnimationRegistry,\n    getStats: () => globalAnimationRegistry.getStats(),\n    getCacheContents: () => globalAnimationRegistry.getCacheContents(),\n    clear: () => globalAnimationRegistry.clear(),\n    export: (options) => globalAnimationRegistry.exportStats(options)\n  };\n}\n\nexport { globalAnimationRegistry };\n","/**\n * Ring buffer for rule evaluation traces\n * Provides debugging capabilities and HUD integration\n */\n\nexport class RuleTraceBuffer {\n  constructor(maxSize = 1000) {\n    this.buffer = [];\n    this.maxSize = maxSize;\n    this.index = 0;\n    this.totalTraces = 0;\n  }\n\n  addTrace(ruleId, matched, conditions, evaluationTime, metadata = {}) {\n    const trace = {\n      ruleId,\n      matched,\n      conditions,\n      evaluationTime,\n      timestamp: Date.now(),\n      metadata: { ...metadata }\n    };\n\n    if (this.buffer.length < this.maxSize) {\n      this.buffer.push(trace);\n    } else {\n      this.buffer[this.index] = trace;\n      this.index = (this.index + 1) % this.maxSize;\n    }\n\n    this.totalTraces++;\n  }\n\n  getRecentTraces(limit = 50, filter = {}) {\n    const recent = [];\n    let idx = this.index - 1;\n\n    for (let i = 0; i < Math.min(limit, this.buffer.length); i++) {\n      if (idx < 0) idx = this.buffer.length - 1;\n\n      const trace = this.buffer[idx];\n      if (this.matchesFilter(trace, filter)) {\n        recent.unshift(trace);\n      }\n\n      idx--;\n    }\n\n    return recent;\n  }\n\n  getRuleHistory(ruleId, limit = 20) {\n    return this.getRecentTraces(this.buffer.length, { ruleId }).slice(0, limit);\n  }\n\n  getMatchedRules(timeWindow = 60000, limit = 100) {\n    const cutoff = Date.now() - timeWindow;\n    return this.getRecentTraces(this.buffer.length, { matched: true })\n      .filter(trace => trace.timestamp > cutoff)\n      .slice(0, limit);\n  }\n\n  getStats() {\n    const recent = this.getRecentTraces(this.buffer.length);\n    const matched = recent.filter(t => t.matched).length;\n    const avgEvalTime = recent.length > 0\n      ? recent.reduce((sum, t) => sum + t.evaluationTime, 0) / recent.length\n      : 0;\n\n    return {\n      totalTraces: this.totalTraces,\n      bufferedTraces: this.buffer.length,\n      recentMatched: matched,\n      recentTotal: recent.length,\n      matchRate: recent.length > 0 ? matched / recent.length : 0,\n      avgEvaluationTime: avgEvalTime\n    };\n  }\n\n  matchesFilter(trace, filter) {\n    if (filter.ruleId && trace.ruleId !== filter.ruleId) return false;\n    if (filter.matched !== undefined && trace.matched !== filter.matched) return false;\n    if (filter.minTime && trace.timestamp < filter.minTime) return false;\n    if (filter.maxTime && trace.timestamp > filter.maxTime) return false;\n    if (filter.minEvalTime && trace.evaluationTime < filter.minEvalTime) return false;\n\n    return true;\n  }\n\n  clear() {\n    this.buffer = [];\n    this.index = 0;\n    this.totalTraces = 0;\n  }\n\n  exportTraces(options = {}) {\n    const {\n      format = 'json',\n      limit = 100,\n      includeConditions = true,\n      includeMetadata = false\n    } = options;\n\n    const traces = this.getRecentTraces(limit);\n\n    const exported = traces.map(trace => {\n      const exported = {\n        ruleId: trace.ruleId,\n        matched: trace.matched,\n        evaluationTime: trace.evaluationTime,\n        timestamp: trace.timestamp\n      };\n\n      if (includeConditions) {\n        exported.conditions = trace.conditions;\n      }\n\n      if (includeMetadata) {\n        exported.metadata = trace.metadata;\n      }\n\n      return exported;\n    });\n\n    if (format === 'csv') {\n      return this.exportToCsv(exported);\n    }\n\n    return JSON.stringify(exported, null, 2);\n  }\n\n  exportToCsv(traces) {\n    if (traces.length === 0) return 'No traces available\\n';\n\n    const headers = ['ruleId', 'matched', 'evaluationTime', 'timestamp'];\n    const rows = traces.map(trace => [\n      trace.ruleId,\n      trace.matched,\n      trace.evaluationTime.toFixed(3),\n      new Date(trace.timestamp).toISOString()\n    ]);\n\n    return [\n      headers.join(','),\n      ...rows.map(row => row.join(','))\n    ].join('\\n');\n  }\n}\n\n// Global trace buffer instance\nconst globalTraceBuffer = new RuleTraceBuffer();\n\n// Node.js and browser compatibility\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdRuleTrace = {\n    buffer: globalTraceBuffer,\n    getRecent: (limit) => globalTraceBuffer.getRecentTraces(limit),\n    getStats: () => globalTraceBuffer.getStats(),\n    getRuleHistory: (ruleId) => globalTraceBuffer.getRuleHistory(ruleId),\n    export: (options) => globalTraceBuffer.exportTraces(options),\n    clear: () => globalTraceBuffer.clear()\n  };\n}\n\nexport { globalTraceBuffer };\n","import { perfTime, perfCount } from '../util/performance.js';\nimport { globalTraceBuffer } from './RuleTraceBuffer.js';\n\nexport class RulesEngine {\n  constructor(rules = []) {\n    this.rules = Array.isArray(rules) ? rules : [];\n    this.rulesById = new Map();\n    this.dependencyIndex = null;\n    this.dirtyRules = new Set();\n    this.lastEvaluation = new Map(); // ruleId -> evaluation result\n    this.traceBuffer = globalTraceBuffer;\n    this.stopProcessing = new Map(); // overlayId -> Set of stopped rule priorities\n\n    // Performance tracking\n    this.evalCounts = {\n      total: 0,\n      dirty: 0,\n      matched: 0,\n      skipped: 0\n    };\n\n    this.buildRulesIndex();\n    this.buildDependencyIndex();\n    this.markAllDirty(); // Initial state\n  }\n\n  buildRulesIndex() {\n    this.rulesById.clear();\n    this.rules.forEach(rule => {\n      if (rule.id) {\n        this.rulesById.set(rule.id, rule);\n      }\n    });\n  }\n\n  buildDependencyIndex() {\n    const entityToRules = new Map();\n    const ruleToEntities = new Map();\n\n    this.rules.forEach(rule => {\n      const entities = this.extractEntityReferences(rule);\n      ruleToEntities.set(rule.id, entities);\n\n      entities.forEach(entityId => {\n        if (!entityToRules.has(entityId)) {\n          entityToRules.set(entityId, new Set());\n        }\n        entityToRules.get(entityId).add(rule.id);\n      });\n    });\n\n    this.dependencyIndex = { entityToRules, ruleToEntities };\n\n    // Debug exposure\n    try {\n      const debugNamespace = (typeof window !== 'undefined') ? window : global;\n      if (debugNamespace.__msdDebug) {\n        debugNamespace.__msdDebug.rulesDeps = {\n          entityToRules: Object.fromEntries(entityToRules),\n          ruleToEntities: Object.fromEntries(ruleToEntities),\n          totalEntities: entityToRules.size,\n          totalRules: this.rules.length\n        };\n      }\n    } catch (e) {}\n  }\n\n  extractEntityReferences(rule) {\n    const entities = new Set();\n\n    if (!rule.when) return Array.from(entities);\n\n    // Extract from all/any conditions\n    const conditions = [\n      ...(rule.when.all || []),\n      ...(rule.when.any || [])\n    ];\n\n    conditions.forEach(condition => {\n      // Direct entity reference\n      if (condition.entity) {\n        entities.add(condition.entity);\n      }\n\n      // Entity attribute reference (e.g., \"sensor.temp.state\")\n      if (condition.entity_attr) {\n        const entityId = condition.entity_attr.split('.')[0];\n        entities.add(entityId);\n      }\n\n      // Map range condition\n      if (condition.map_range_cond?.entity) {\n        entities.add(condition.map_range_cond.entity);\n      }\n\n      // Value map references in rule conditions\n      if (condition.value_map?.entity) {\n        entities.add(condition.value_map.entity);\n      }\n    });\n\n    return Array.from(entities);\n  }\n\n  markEntitiesDirty(changedEntityIds) {\n    if (!Array.isArray(changedEntityIds)) {\n      changedEntityIds = [changedEntityIds];\n    }\n\n    let affectedRules = 0;\n\n    changedEntityIds.forEach(entityId => {\n      const rules = this.dependencyIndex.entityToRules.get(entityId);\n      if (rules) {\n        rules.forEach(ruleId => {\n          if (!this.dirtyRules.has(ruleId)) {\n            this.dirtyRules.add(ruleId);\n            affectedRules++;\n          }\n        });\n      }\n    });\n\n    perfCount('rules.dirty.entities', changedEntityIds.length);\n    perfCount('rules.dirty.affected', affectedRules);\n\n    return affectedRules;\n  }\n\n  markAllDirty() {\n    this.dirtyRules.clear();\n    this.rules.forEach(rule => {\n      if (rule.id) {\n        this.dirtyRules.add(rule.id);\n      }\n    });\n    perfCount('rules.dirty.all', this.dirtyRules.size);\n  }\n\n  evaluateDirty(context = {}) {\n    return perfTime('rules.evaluate', () => {\n      const { getEntity } = context;\n\n      if (!getEntity || typeof getEntity !== 'function') {\n        console.warn('[RulesEngine] evaluateDirty called without getEntity function');\n        return this.createEmptyResult();\n      }\n\n      const totalDirty = this.dirtyRules.size;\n      const results = [];\n      const processedRules = new Set();\n\n      // Sort dirty rules by priority (higher first)\n      const dirtyRulesArray = Array.from(this.dirtyRules)\n        .map(ruleId => this.rulesById.get(ruleId))\n        .filter(rule => rule)\n        .sort((a, b) => (b.priority || 0) - (a.priority || 0));\n\n      dirtyRulesArray.forEach(rule => {\n        if (processedRules.has(rule.id)) return;\n\n        const result = this.evaluateRule(rule, getEntity);\n        processedRules.add(rule.id);\n\n        // Cache evaluation result\n        this.lastEvaluation.set(rule.id, {\n          matched: result.matched,\n          timestamp: Date.now(),\n          conditions: result.conditions\n        });\n\n        if (result.matched) {\n          results.push(result);\n          this.evalCounts.matched++;\n        }\n\n        // Remove from dirty set\n        this.dirtyRules.delete(rule.id);\n      });\n\n      // Performance tracking\n      this.evalCounts.total += totalDirty;\n      this.evalCounts.dirty += totalDirty;\n      this.evalCounts.skipped += (this.rules.length - totalDirty);\n\n      perfCount('rules.eval.total', totalDirty);\n      perfCount('rules.eval.matched', results.length);\n      perfCount('rules.eval.skipped', this.rules.length - totalDirty);\n\n      return this.aggregateResults(results);\n    });\n  }\n\n  evaluateRule(rule, getEntity) {\n    const startTime = performance.now();\n\n    try {\n      const conditions = this.evaluateConditions(rule.when, getEntity);\n      const matched = this.determineMatch(rule.when, conditions);\n      const evaluationTime = performance.now() - startTime;\n\n      const result = {\n        ruleId: rule.id,\n        priority: rule.priority || 0,\n        matched,\n        conditions,\n        rule,\n        evaluationTime\n      };\n\n      // Add trace entry\n      this.traceBuffer.addTrace(\n        rule.id,\n        matched,\n        conditions,\n        evaluationTime,\n        {\n          priority: rule.priority || 0,\n          conditionCount: this.countConditions(rule.when),\n          entityRefs: this.dependencyIndex?.ruleToEntities.get(rule.id) || []\n        }\n      );\n\n      if (matched && rule.apply) {\n        result.overlayPatches = rule.apply.overlays || [];\n        result.profilesAdd = rule.apply.profiles_add || [];\n        result.profilesRemove = rule.apply.profiles_remove || [];\n        result.animations = rule.apply.animations || [];\n        result.stopAfter = rule.stop === true;\n      }\n\n      return result;\n\n    } catch (error) {\n      const evaluationTime = performance.now() - startTime;\n\n      // Trace error\n      this.traceBuffer.addTrace(\n        rule.id,\n        false,\n        {},\n        evaluationTime,\n        { error: error.message }\n      );\n\n      console.warn(`[RulesEngine] Error evaluating rule ${rule.id}:`, error);\n      return {\n        ruleId: rule.id,\n        matched: false,\n        error: error.message,\n        evaluationTime\n      };\n    }\n  }\n\n  evaluateConditions(when, getEntity) {\n    if (!when) return {};\n\n    const results = {};\n\n    // Evaluate all conditions\n    if (when.all) {\n      results.all = when.all.map(condition => this.evaluateCondition(condition, getEntity));\n    }\n\n    // Evaluate any conditions\n    if (when.any) {\n      results.any = when.any.map(condition => this.evaluateCondition(condition, getEntity));\n    }\n\n    return results;\n  }\n\n  evaluateCondition(condition, getEntity) {\n    const result = {\n      condition,\n      matched: false,\n      value: null,\n      error: null\n    };\n\n    try {\n      // Entity state condition\n      if (condition.entity) {\n        const entity = getEntity(condition.entity);\n        if (!entity) {\n          result.error = `Entity ${condition.entity} not found`;\n          return result;\n        }\n\n        result.value = entity.state;\n\n        // Numeric comparisons\n        if (condition.above !== undefined) {\n          const numValue = parseFloat(entity.state);\n          result.matched = !isNaN(numValue) && numValue > condition.above;\n        } else if (condition.below !== undefined) {\n          const numValue = parseFloat(entity.state);\n          result.matched = !isNaN(numValue) && numValue < condition.below;\n        } else if (condition.equals !== undefined) {\n          result.matched = entity.state == condition.equals;\n        } else {\n          result.matched = true; // Entity exists\n        }\n      }\n\n      // Time between condition\n      if (condition.time_between) {\n        result.matched = this.evaluateTimeBetween(condition.time_between);\n        result.value = new Date().toTimeString().substring(0, 5);\n      }\n\n      // Map range condition\n      if (condition.map_range_cond) {\n        result.matched = this.evaluateMapRangeCondition(condition.map_range_cond, getEntity);\n      }\n\n    } catch (error) {\n      result.error = error.message;\n    }\n\n    return result;\n  }\n\n  evaluateTimeBetween(timeRange) {\n    const [startTime, endTime] = timeRange.split('-');\n    const now = new Date();\n    const currentTime = now.getHours() * 60 + now.getMinutes();\n\n    const [startHour, startMin] = startTime.split(':').map(Number);\n    const [endHour, endMin] = endTime.split(':').map(Number);\n\n    const start = startHour * 60 + startMin;\n    const end = endHour * 60 + endMin;\n\n    if (start <= end) {\n      return currentTime >= start && currentTime <= end;\n    } else {\n      // Crosses midnight\n      return currentTime >= start || currentTime <= end;\n    }\n  }\n\n  evaluateMapRangeCondition(mapRangeCondition, getEntity) {\n    const { entity, input, output, above, below, equals } = mapRangeCondition;\n\n    const entityObj = getEntity(entity);\n    if (!entityObj) return false;\n\n    const rawValue = parseFloat(entityObj.state);\n    if (isNaN(rawValue)) return false;\n\n    // Map the value\n    const mappedValue = this.mapRange(rawValue, input, output);\n\n    // Apply condition on mapped value\n    if (above !== undefined) return mappedValue > above;\n    if (below !== undefined) return mappedValue < below;\n    if (equals !== undefined) return Math.abs(mappedValue - equals) < 0.001;\n\n    return false;\n  }\n\n  mapRange(value, inputRange, outputRange) {\n    const [inMin, inMax] = inputRange;\n    const [outMin, outMax] = outputRange;\n\n    // Clamp input value\n    const clampedValue = Math.max(inMin, Math.min(inMax, value));\n\n    // Linear interpolation\n    const ratio = (clampedValue - inMin) / (inMax - inMin);\n    return outMin + ratio * (outMax - outMin);\n  }\n\n  determineMatch(when, conditions) {\n    if (!when) return false;\n\n    let allMatch = true;\n    let anyMatch = false;\n\n    // Check all conditions\n    if (when.all && conditions.all) {\n      allMatch = conditions.all.every(result => result.matched);\n    }\n\n    // Check any conditions\n    if (when.any && conditions.any) {\n      anyMatch = conditions.any.some(result => result.matched);\n    }\n\n    // Determine final match\n    if (when.all && when.any) {\n      return allMatch && anyMatch;\n    } else if (when.all) {\n      return allMatch;\n    } else if (when.any) {\n      return anyMatch;\n    }\n\n    return false;\n  }\n\n  aggregateResults(ruleResults) {\n    const aggregated = {\n      overlayPatches: [],\n      profilesAdd: [],\n      profilesRemove: [],\n      animations: []\n    };\n\n    // Group results by target overlays for stop semantics\n    const overlayGroups = new Map();\n\n    ruleResults.forEach(result => {\n      if (result.overlayPatches) {\n        result.overlayPatches.forEach(patch => {\n          if (!overlayGroups.has(patch.id)) {\n            overlayGroups.set(patch.id, []);\n          }\n          overlayGroups.get(patch.id).push({\n            ...result,\n            overlayPatch: patch\n          });\n        });\n      }\n    });\n\n    // Process each overlay group with stop semantics\n    overlayGroups.forEach((rules, overlayId) => {\n      this.processOverlayRules(overlayId, rules, aggregated);\n    });\n\n    // Add non-overlay results (profiles, animations)\n    ruleResults\n      .sort((a, b) => (b.priority || 0) - (a.priority || 0))\n      .forEach(result => {\n        if (result.profilesAdd) {\n          aggregated.profilesAdd.push(...result.profilesAdd);\n        }\n        if (result.profilesRemove) {\n          aggregated.profilesRemove.push(...result.profilesRemove);\n        }\n        if (result.animations) {\n          aggregated.animations.push(...result.animations);\n        }\n      });\n\n    return aggregated;\n  }\n\n  processOverlayRules(overlayId, rules, aggregated) {\n    // Sort by priority (higher first)\n    const sortedRules = rules.sort((a, b) => (b.priority || 0) - (a.priority || 0));\n\n    let shouldStop = false;\n\n    sortedRules.forEach(result => {\n      if (shouldStop) {\n        // Rule was stopped, add to trace\n        this.traceBuffer.addTrace(\n          result.ruleId,\n          result.matched,\n          result.conditions,\n          result.evaluationTime,\n          {\n            stopped: true,\n            stoppedBy: overlayId,\n            reason: 'stop_semantics'\n          }\n        );\n\n        perfCount('rules.stopped', 1);\n        return;\n      }\n\n      // Apply the rule result\n      if (result.overlayPatch) {\n        aggregated.overlayPatches.push(result.overlayPatch);\n      }\n\n      // Check for stop condition\n      if (result.stopAfter) {\n        shouldStop = true;\n        perfCount('rules.stop.triggered', 1);\n\n        // Add stop trace\n        this.traceBuffer.addTrace(\n          result.ruleId,\n          result.matched,\n          result.conditions,\n          result.evaluationTime,\n          {\n            stopTriggered: true,\n            affectedOverlay: overlayId\n          }\n        );\n      }\n    });\n  }\n\n  countConditions(when) {\n    if (!when) return 0;\n    return (when.all?.length || 0) + (when.any?.length || 0);\n  }\n\n  createEmptyResult() {\n    return {\n      overlayPatches: [],\n      profilesAdd: [],\n      profilesRemove: [],\n      animations: []\n    };\n  }\n\n  // Enhanced debug and introspection methods\n  getTrace() {\n    const baseTrace = {\n      totalRules: this.rules.length,\n      dirtyRules: this.dirtyRules.size,\n      lastEvaluations: Object.fromEntries(this.lastEvaluation),\n      evalCounts: { ...this.evalCounts },\n      dependencyStats: {\n        entitiesTracked: this.dependencyIndex?.entityToRules.size || 0,\n        avgRulesPerEntity: this.dependencyIndex ?\n          Array.from(this.dependencyIndex.entityToRules.values()).reduce((sum, rules) => sum + rules.size, 0) / this.dependencyIndex.entityToRules.size : 0\n      }\n    };\n\n    // Add trace buffer stats\n    const traceStats = this.traceBuffer.getStats();\n    baseTrace.traceStats = traceStats;\n\n    return baseTrace;\n  }\n\n  getRuleTrace(ruleId, limit = 20) {\n    return this.traceBuffer.getRuleHistory(ruleId, limit);\n  }\n\n  getRecentMatches(timeWindow = 60000) {\n    return this.traceBuffer.getMatchedRules(timeWindow);\n  }\n\n  exportTrace(options = {}) {\n    return this.traceBuffer.exportTraces(options);\n  }\n\n  clearTrace() {\n    this.traceBuffer.clear();\n    perfCount('rules.trace.cleared', 1);\n  }\n\n  getRuleDependencies(ruleId) {\n    return this.dependencyIndex?.ruleToEntities.get(ruleId) || [];\n  }\n\n  getEntityDependents(entityId) {\n    return Array.from(this.dependencyIndex?.entityToRules.get(entityId) || []);\n  }\n}\n\n// Helper function for applying overlay patches from rule results\nexport function applyOverlayPatches(overlays, patches) {\n  if (!Array.isArray(patches) || patches.length === 0) {\n    return overlays;\n  }\n\n  const result = overlays.map(overlay => ({ ...overlay }));\n  const overlayMap = new Map(result.map(o => [o.id, o]));\n\n  patches.forEach(patch => {\n    const overlay = overlayMap.get(patch.id);\n    if (overlay && patch.style) {\n      // Shallow merge the style patch\n      overlay.style = {\n        ...overlay.style,\n        ...patch.style\n      };\n    }\n  });\n\n  return result;\n}\n","/**\n * @file DebugManager.js\n * @description Centralized debug state manager with proper initialization ordering\n */\nexport class DebugManager {\n  constructor() {\n    /** @type {Object} Debug feature states */\n    this.state = {\n      anchors: false,\n      bounding_boxes: false,\n      routing: false,\n      performance: false,\n      scale: 1.0\n    };\n\n    /** @type {Set<Function>} Change callbacks */\n    this.callbacks = new Set();\n\n    /** @type {boolean} Manager initialization state */\n    this.initialized = false;\n\n    /** @type {boolean} RouterCore readiness state */\n    this.routerReady = false;\n\n    /** @type {Array<Function>} Actions queued before router ready */\n    this.pendingRouterActions = [];\n\n    /** @type {Array<Function>} Actions queued before init */\n    this.pendingInitActions = [];\n\n    // Add debouncing properties\n    this._notifyTimeout = null;\n    this._pendingNotification = null;\n  }\n\n  /**\n   * Initialize debug manager with config\n   * @param {Object} debugConfig - Debug configuration from MSD config\n   */\n  init(debugConfig = {}) {\n    // REDUCED: Only log if debug is actually enabled\n    if (debugConfig && Object.keys(debugConfig).length > 0) {\n      console.log('[DebugManager] Initializing with config:', debugConfig);\n    }\n\n    // FIXED: Apply initial config - handle both flat and nested structures\n    if (debugConfig.overlays) {\n      // Handle nested structure: debug.overlays.anchors\n      Object.keys(this.state).forEach(key => {\n        if (key !== 'scale' && debugConfig.overlays[key] !== undefined) {\n          this.state[key] = debugConfig.overlays[key];\n        }\n      });\n    } else {\n      // Handle flat structure: debug.anchors\n      Object.keys(this.state).forEach(key => {\n        if (debugConfig[key] !== undefined) {\n          this.state[key] = debugConfig[key];\n        }\n      });\n    }\n\n    // Handle scale separately\n    if (debugConfig.scale !== undefined) {\n      this.state.scale = debugConfig.scale;\n    }\n\n    this.initialized = true;\n\n    // REDUCED: Only log state if features are enabled\n    const hasEnabledFeatures = this.isAnyEnabled();\n    if (hasEnabledFeatures) {\n      console.log('[DebugManager] State after config init:', this.state);\n    }\n\n    // Process pending init actions\n    this.pendingInitActions.forEach(action => action());\n    this.pendingInitActions = [];\n\n    // If router is already ready, process router actions too\n    if (this.routerReady) {\n      this.pendingRouterActions.forEach(action => action());\n      this.pendingRouterActions = [];\n    }\n\n    this._scheduleNotification('init');\n  }\n\n  /**\n   * Mark RouterCore as ready and process pending router-dependent actions\n   */\n  markRouterReady() {\n    this.routerReady = true;\n\n    // Process pending router actions if we're initialized\n    if (this.initialized) {\n      this.pendingRouterActions.forEach(action => action());\n      this.pendingRouterActions = [];\n      this._scheduleNotification('router-ready');\n    }\n  }\n\n  /**\n   * Enable a debug feature\n   * @param {string} feature - Feature name (anchors, bounding_boxes, routing, performance)\n   */\n  enable(feature) {\n    this._setFeature(feature, true);\n  }\n\n  /**\n   * Disable a debug feature\n   * @param {string} feature - Feature name\n   */\n  disable(feature) {\n    this._setFeature(feature, false);\n  }\n\n  /**\n   * Toggle a debug feature\n   * @param {string} feature - Feature name\n   */\n  toggle(feature) {\n    this._setFeature(feature, !this.state[feature]);\n  }\n\n  /**\n   * Set debug scale\n   * @param {number} scale - Scale multiplier (0.1 - 3.0)\n   */\n  setScale(scale) {\n    const action = () => {\n      const newScale = Math.max(0.1, Math.min(3.0, Number(scale) || 1));\n      if (newScale !== this.state.scale) {\n        this.state.scale = newScale;\n        this._scheduleNotification('scale', { scale: newScale });\n      }\n    };\n\n    this._executeWhenReady(action, false); // Scale doesn't need router\n  }\n\n  /**\n   * Get current debug state snapshot (silent - no console output)\n   * @returns {Object} Current state\n   */\n  getSnapshot() {\n    return {\n      ...this.state,\n      enabled: this.isAnyEnabled(),\n      initialized: this.initialized,\n      routerReady: this.routerReady\n    };\n  }\n\n  /**\n   * Get status with console output (for manual debugging)\n   * @returns {Object} Current state\n   */\n  status() {\n    const snapshot = this.getSnapshot();\n    console.table(snapshot);\n    return snapshot;\n  }\n\n  /**\n   * Check if any debug feature is enabled\n   * @returns {boolean} True if any feature enabled\n   */\n  isAnyEnabled() {\n    return ['anchors', 'bounding_boxes', 'routing', 'performance']\n      .some(feature => this.state[feature]);\n  }\n\n  /**\n   * Check if routing debug can be rendered\n   * @returns {boolean} True if routing debug is ready\n   */\n  canRenderRouting() {\n    return this.state.routing && this.routerReady;\n  }\n\n  /**\n   * Register callback for state changes\n   * @param {Function} callback - Change callback function\n   * @returns {Function} Unregister function\n   */\n  onChange(callback) {\n    this.callbacks.add(callback);\n    return () => this.callbacks.delete(callback);\n  }\n\n  /**\n   * Enable multiple features at once\n   * @param {string[]} features - Array of feature names\n   */\n  enableMultiple(features) {\n    features.forEach(feature => this.enable(feature));\n  }\n\n  /**\n   * Disable multiple features at once\n   * @param {string[]} features - Array of feature names\n   */\n  disableMultiple(features) {\n    features.forEach(feature => this.disable(feature));\n  }\n\n  /**\n   * Get available debug features\n   * @returns {string[]} Array of feature names\n   */\n  getAvailableFeatures() {\n    return Object.keys(this.state).filter(key => key !== 'scale');\n  }\n\n  /**\n   * Check if a specific feature is enabled\n   * @param {string} feature - Feature name\n   * @returns {boolean} True if enabled\n   */\n  isEnabled(feature) {\n    return Boolean(this.state[feature]);\n  }\n\n  /**\n   * Schedule debounced notification to prevent excessive callbacks\n   * @param {string} type - Change type\n   * @param {Object} details - Change details\n   * @private\n   */\n  _scheduleNotification(type, details) {\n    // Clear existing timeout\n    if (this._notifyTimeout) {\n      clearTimeout(this._notifyTimeout);\n    }\n\n    // Store pending notification\n    this._pendingNotification = { type, details };\n\n    // Schedule debounced notification (~60fps)\n    this._notifyTimeout = setTimeout(() => {\n      if (this._pendingNotification) {\n        this._notifyChange(this._pendingNotification.type, this._pendingNotification.details);\n        this._pendingNotification = null;\n      }\n      this._notifyTimeout = null;\n    }, 16);\n  }\n\n  /**\n   * Notify callbacks of state changes\n   * @param {string} type - Change type\n   * @param {Object} details - Change details\n   * @private\n   */\n  _notifyChange(type, details = {}) {\n    const event = {\n      type,\n      details,\n      snapshot: this.getSnapshot(),\n      timestamp: Date.now()\n    };\n\n    this.callbacks.forEach(callback => {\n      try {\n        callback(event);\n      } catch (error) {\n        console.warn('[DebugManager] Callback error:', error);\n      }\n    });\n  }\n\n  /**\n   * Set feature state with proper queuing\n   * @param {string} feature - Feature name\n   * @param {boolean} enabled - Enable state\n   * @private\n   */\n  _setFeature(feature, enabled) {\n    if (!this.state.hasOwnProperty(feature) || feature === 'scale') {\n      console.warn(`[DebugManager] Invalid debug feature: ${feature}`);\n      return;\n    }\n\n    const action = () => {\n      if (this.state[feature] !== enabled) {\n        console.log(`[DebugManager] Setting ${feature} to ${enabled}`);\n        this.state[feature] = enabled;\n        this._scheduleNotification('feature', { feature, enabled });\n\n        // FIXED: Trigger immediate re-render when feature state changes\n        setTimeout(() => {\n          try {\n            const pipelineInstance = window.__msdDebug?.pipelineInstance;\n            if (pipelineInstance?.reRender) {\n              console.log(`[DebugManager] Auto re-render after ${feature} ${enabled ? 'enable' : 'disable'}`);\n              pipelineInstance.reRender();\n            }\n          } catch (error) {\n            console.warn('[DebugManager] Auto re-render failed:', error);\n          }\n        }, 5);\n      }\n    };\n\n    // Routing feature needs router to be ready\n    const needsRouter = feature === 'routing';\n    this._executeWhenReady(action, needsRouter);\n  }\n\n  /**\n   * Execute action when dependencies are ready\n   * @param {Function} action - Action to execute\n   * @param {boolean} needsRouter - Whether action needs RouterCore\n   * @private\n   */\n  _executeWhenReady(action, needsRouter = false) {\n    if (!this.initialized) {\n      this.pendingInitActions.push(() => this._executeWhenReady(action, needsRouter));\n      return;\n    }\n\n    if (needsRouter && !this.routerReady) {\n      this.pendingRouterActions.push(action);\n      return;\n    }\n\n    action();\n  }\n}","import { AdvancedRenderer } from '../renderer/AdvancedRenderer.js';\nimport { MsdDebugRenderer } from '../debug/MsdDebugRenderer.js';\nimport { MsdControlsRenderer } from '../controls/MsdControlsRenderer.js';\nimport { MsdHudManager } from '../hud/MsdHudManager.js';\nimport { DataSourceManager } from '../data/DataSourceManager.js';\nimport { RouterCore } from '../routing/RouterCore.js';\nimport { AnimationRegistry } from '../animation/AnimationRegistry.js';\nimport { RulesEngine } from '../rules/RulesEngine.js';\nimport { DebugManager } from '../debug/DebugManager.js';\n\nexport class SystemsManager {\n  constructor() {\n    this.dataSourceManager = null;\n    this.renderer = null;\n    this.debugRenderer = null;\n    this.controlsRenderer = null;\n    this.hudManager = null;\n    this.router = null;\n    this.animRegistry = null;\n    this.rulesEngine = null;\n    this.debugManager = new DebugManager();\n    this._renderTimeout = null;\n    this._reRenderCallback = null;\n    this._renderInProgress = false;\n    this._debugControlsRendering = false;\n    this.mergedConfig = null; // Store for entity change handler\n    this._originalHass = null;  // Pristine copy for controls\n    this._currentHass = null;   // Working copy for MSD internal processing\n  }\n\n  async initializeSystems(mergedConfig, cardModel, mountEl, hass) {\n    console.log('[MSD v1] Initializing runtime systems');\n\n    // Store config for later use\n    this.mergedConfig = mergedConfig;\n\n    // ADDED: Store HASS context immediately\n    this._currentHass = hass;\n\n    // ENHANCED: Initialize debug manager early with config and better logging\n    const debugConfig = mergedConfig.debug || {};\n    console.log('[MSD v1] Raw debug config from mergedConfig:', debugConfig);\n\n    this.debugManager.init(debugConfig);\n    console.log('[MSD v1] DebugManager initialized with config:', debugConfig);\n\n    // Initialize rules engine\n    this.rulesEngine = new RulesEngine(mergedConfig.rules);\n    this.rulesEngine.markAllDirty();\n    this._instrumentRulesEngine(mergedConfig);\n\n    // Initialize data source manager FIRST\n    await this._initializeDataSources(hass, mergedConfig);\n\n    // Connect data source manager to rules engine\n    if (this.dataSourceManager) {\n      const entityChangeHandler = this._createEntityChangeHandler();\n\n      // Add entity change listener\n      this.dataSourceManager.addEntityChangeListener(entityChangeHandler);\n      console.log('[MSD v1] DataSourceManager connected to rules engine');\n\n      console.log('[MSD v1] DataSourceManager entity count:', this.dataSourceManager.listIds().length);\n    } else {\n      console.warn('[MSD v1] DataSourceManager not initialized - no data sources configured or HASS unavailable');\n    }\n\n    // Initialize rendering systems\n    this.router = new RouterCore(mergedConfig.routing, cardModel.anchors, cardModel.viewBox);\n    this.renderer = new AdvancedRenderer(mountEl, this.router);\n    this.debugRenderer = new MsdDebugRenderer();\n    this.controlsRenderer = new MsdControlsRenderer(this.renderer);\n\n    // ADDED: Set HASS context on controls renderer immediately if available\n    if (this._currentHass && this.controlsRenderer) {\n      console.log('[MSD v1] Setting initial HASS context on controls renderer');\n      this.controlsRenderer.setHass(this._currentHass);\n    }\n\n    // REPLACED: Initialize unified HUD manager with document.body mounting\n    this.hudManager = new MsdHudManager();\n    this.hudManager.init(mountEl); // Pass mount element for pipeline context, but HUD uses document.body\n\n    // ADDED: Integrate HUD into global debug interface immediately\n    this._setupGlobalHudInterface();\n\n    // Initialize debug renderer with systems manager reference\n    this.debugRenderer.init(this);\n\n    // Mark router as ready for debug system\n    this.debugManager.markRouterReady();\n    console.log('[MSD v1] RouterCore marked ready for debug system');\n\n    // Initialize animation registry\n    this.animRegistry = new AnimationRegistry();\n\n    // CRITICAL FIX: Temporarily disable status indicators to prevent NaN coordinate SVG errors\n    // The TextOverlayRenderer calculates invalid coordinates causing SVG errors and MSD disappearing\n    if (this.mergedConfig && this.mergedConfig.overlays) {\n      console.log('[MSD v1] Applying status indicator fix to prevent NaN coordinate errors');\n      this.mergedConfig.overlays = this.mergedConfig.overlays.map(overlay => {\n        if (overlay && overlay.status_indicator) {\n          console.log(`[MSD v1] DISABLED status indicator for ${overlay.id} to prevent NaN coordinates`);\n          return { ...overlay, status_indicator: false };\n        }\n        return overlay;\n      });\n    }\n\n    console.log('[MSD v1] All systems initialized successfully');\n    return this;\n  }\n\n  setReRenderCallback(callback) {\n    this._reRenderCallback = callback;\n  }\n\n\n\n  _createEntityChangeHandler() {\n      return (changedIds, enhancedData = null) => {\n          const timestamp = Date.now();\n\n          console.log('[MSD DEBUG] 🔔 Entity change handler TRIGGERED:', {\n              timestamp: new Date().toISOString(),\n              changedIds,\n              hasEnhancedData: !!enhancedData,\n              stackTrace: new Error().stack.split('\\n').slice(1, 5).join('\\n'),\n              renderTimeout: !!this._renderTimeout,\n              renderInProgress: !!this._renderInProgress\n          });\n\n          // STEP 1: Handle controls with FRESH CURRENT HASS (restored logic)\n          const controlEntities = this._extractControlEntities(this.mergedConfig);\n          const controlChangedIds = changedIds.filter(id => controlEntities.includes(id));\n\n          if (controlChangedIds.length > 0 && this.controlsRenderer) {\n              // SIMPLIFIED: Direct subscription handles control updates automatically\n              console.log('[SystemsManager] 📡 Control entities changed:', controlChangedIds);\n              console.log('[SystemsManager] ℹ️ Direct subscription will handle these updates automatically');\n              // NOTE: The direct HASS subscription automatically handles control updates\n              // No need to manually forward HASS here as it causes duplicate/stale updates\n          }\n\n          // STEP 2: Update MSD internal HASS with converted data (existing logic)\n          const workingHass = this.getCurrentHass();\n          if (workingHass && this.dataSourceManager) {\n              console.log('[MSD DEBUG] 📤 Refreshing MSD internal HASS context with converted entity states');\n\n              // Get converted state from data source manager for MSD internal use\n              const freshStates = {};\n              changedIds.forEach(entityId => {\n                  const entity = this.dataSourceManager.getEntity(entityId);\n                  if (entity && entity.state !== undefined) {\n                      // For MSD internal processing, use converted numeric values\n                      freshStates[entityId] = {\n                          state: entity.state.toString(), // MSD converted state\n                          last_changed: new Date().toISOString(),\n                          last_updated: new Date().toISOString(),\n                          attributes: entity.attributes || workingHass.states[entityId]?.attributes || {},\n                          entity_id: entityId,\n                          context: {\n                              id: Date.now().toString(),\n                              user_id: null\n                          }\n                      };\n\n                      console.log('[MSD DEBUG] 🔄 Updated MSD internal state for', entityId, {\n                          originalState: this._originalHass?.states[entityId]?.state,\n                          convertedState: freshStates[entityId].state,\n                          rawValue: entity.state\n                      });\n                  } else {\n                      console.log('[MSD DEBUG] ⚠️ No data source found for entity:', entityId, '(entity will not be updated in MSD internal HASS)');\n                  }\n              });\n\n              // Only update HASS if we have fresh states from data sources\n              if (Object.keys(freshStates).length > 0) {\n                  // Update the working HASS states object with converted data\n                  this._currentHass = {\n                      ...workingHass,\n                      states: {\n                          ...workingHass.states,\n                          ...freshStates\n                      }\n                  };\n\n                  console.log('[MSD DEBUG] ✅ MSD internal HASS context refreshed with', Object.keys(freshStates).length, 'converted entities');\n              } else {\n                  console.log('[MSD DEBUG] ℹ️ No data source entities changed - MSD internal HASS unchanged');\n              }\n          } else {\n              console.log('[MSD DEBUG] ⚠️ Skipping MSD internal HASS update:', {\n                  hasWorkingHass: !!workingHass,\n                  hasDataSourceManager: !!this.dataSourceManager,\n                  dataSourceManagerIsNull: this.dataSourceManager === null\n              });\n          }\n\n          // Mark rules dirty for future renders (only for entities with data sources)\n          if (this.rulesEngine) {\n              // Filter to only entities that have data sources\n              const dataSourceEntities = changedIds.filter(entityId => {\n                  return this.dataSourceManager && this.dataSourceManager.getEntity(entityId);\n              });\n\n              if (dataSourceEntities.length > 0) {\n                  this.rulesEngine.markEntitiesDirty(dataSourceEntities);\n                  console.log('[MSD DEBUG] 📏 Marked rules dirty for data source entities:', dataSourceEntities);\n              } else {\n                  console.log('[MSD DEBUG] 📏 No data source entities to mark dirty in rules engine');\n              }\n          } else {\n              console.log('[MSD DEBUG] ⚠️ No rules engine available to mark dirty');\n          }\n\n          if (this._renderTimeout) {\n              console.log('[MSD DEBUG] ⏰ Clearing existing render timeout');\n              clearTimeout(this._renderTimeout);\n          }\n\n          // SIMPLIFIED: Check if this is ONLY a control-triggered change with no data source implications\n          const isControlTriggered = changedIds.some(entityId => controlEntities.includes(entityId));\n          const hasDataSourceChanges = changedIds.some(entityId => {\n              return this.dataSourceManager && this.dataSourceManager.getEntity(entityId);\n          });\n\n          // Store analysis results\n          this._lastEntityAnalysis = {\n              isControlTriggered,\n              hasDataSourceChanges,\n              timestamp,\n              changedIds,\n              controlEntities,\n              matchingEntities: changedIds.filter(id => controlEntities.includes(id))\n          };\n\n          console.log('[MSD DEBUG] 🎯 Entity change analysis:', this._lastEntityAnalysis);\n\n          // Only skip re-render if it's ONLY controls AND no data source changes\n          if (isControlTriggered && !hasDataSourceChanges) {\n              console.log('[MSD DEBUG] ⏭️ SKIPPING re-render - only control entities changed (no data sources affected)');\n          } else if (hasDataSourceChanges) {\n              console.log('[MSD DEBUG] 🔄 Scheduling re-render for data source entity changes');\n\n              // Safe re-render for data source changes\n              this._renderTimeout = setTimeout(() => {\n                  if (this._reRenderCallback && !this._renderInProgress) {\n                      try {\n                          this._renderInProgress = true;\n                          console.log('[MSD DEBUG] 🚀 TRIGGERING re-render from data source entity change timeout');\n                          this._reRenderCallback();\n                      } catch (error) {\n                          console.error('[MSD DEBUG] ❌ Re-render FAILED in entity change handler:', error);\n                      } finally {\n                          this._renderInProgress = false;\n                      }\n                  }\n                  this._renderTimeout = null;\n              }, 100);\n          } else {\n              console.log('[MSD DEBUG] ⏭️ SKIPPING re-render - no relevant entity changes for MSD');\n          }\n      };\n  }\n\n\n\n  /**\n   * Set the original HASS object and keep a pristine reference for controls\n   * @param {Object} hass - Original Home Assistant object\n   */\n  setOriginalHass(hass) {\n      console.log('[SystemsManager] 📚 Setting original HASS reference:', {\n          hasStates: !!hass?.states,\n          entityCount: hass?.states ? Object.keys(hass.states).length : 0,\n          hasAuth: !!hass?.auth,\n          hasConnection: !!hass?.connection,\n          lightDeskState: hass?.states?.['light.desk']?.state,\n          timestamp: new Date().toISOString()\n      });\n\n      // ALWAYS update original HASS to keep it fresh - this should be the most current\n      this._originalHass = hass;\n\n      // If this is the first time setting HASS, also set working copy\n      if (!this._currentHass) {\n          this._currentHass = hass;\n          console.log('[SystemsManager] 📚 Also setting _currentHass (first time)');\n      }\n\n      // ADDED: Set up direct subscription to ensure fresh HASS for controls\n      this.setupDirectHassSubscription(hass);\n\n      // Note: _currentHass will be modified separately in entity change handler with converted data\n  }\n\n  /**\n   * Get the current working HASS (for MSD internal use)\n   */\n  getCurrentHass() {\n      return this._currentHass;\n  }\n\n  /**\n   * Get the original pristine HASS (for controls)\n   */\n  getOriginalHass() {\n      return this._originalHass;\n  }\n\n\n  _instrumentRulesEngine(mergedConfig) {\n    try {\n      const depIndex = new Map();\n      (mergedConfig.rules||[]).forEach(r=>{\n        const condBlocks = (r.when && (r.when.all || r.when.any)) || [];\n        condBlocks.forEach(c=>{\n          const ent = c?.entity;\n            if (ent) {\n              if (!depIndex.has(ent)) depIndex.set(ent, new Set());\n              depIndex.get(ent).add(r.id);\n            }\n        });\n      });\n      this.rulesEngine.__hudDeps = depIndex;\n\n      const W = typeof window!=='undefined'?window:{};\n      W.__msdDebug = W.__msdDebug || {};\n      const perfStore = W.__msdDebug.__perfStore = W.__msdDebug.__perfStore || { counters:{}, timings:{} };\n      function perfCount(k,inc=1){ perfStore.counters[k]=(perfStore.counters[k]||0)+inc; }\n\n      if (!this.rulesEngine.__perfWrapped && typeof this.rulesEngine.evaluateDirty === 'function'){\n        const orig = this.rulesEngine.evaluateDirty;\n        this.rulesEngine.evaluateDirty = function(){\n          const ruleCount = (mergedConfig.rules||[]).length;\n          perfCount('rules.eval.count', ruleCount||0);\n          const res = orig.apply(this, arguments);\n          try {\n            const trace = (this.getTrace && this.getTrace()) || [];\n            const matched = Array.isArray(trace) ? trace.filter(t=>t && t.matched).length : 0;\n            perfCount('rules.match.count', matched);\n          } catch { /* ignore */ }\n          return res;\n        };\n        this.rulesEngine.__perfWrapped = true;\n      }\n    } catch(e){\n      console.warn('[MSD v1][rules instrumentation] failed', e);\n    }\n  }\n\n  async _initializeDataSources(hass, mergedConfig) {\n    this.dataSourceManager = null;\n\n    // ENHANCED: Better logging and error handling\n    if (!hass) {\n      console.warn('[MSD v1] No HASS provided - DataSourceManager will not be initialized');\n      return;\n    }\n\n    // ENHANCED: Explicit-only data sources - no auto-creation\n    const configuredDataSources = mergedConfig.data_sources || {};\n\n    console.log('[MSD v1] 🔍 Using explicit-only data sources mode');\n    console.log('[MSD v1] 🔍 Configured data sources:', Object.keys(configuredDataSources));\n\n    // Controls use direct HASS - no data sources needed\n    const controlEntities = this._extractControlEntities(mergedConfig);\n    console.log('[MSD v1] 🔍 Control entities (using direct HASS):', controlEntities);\n\n    // Use only explicitly configured data sources\n    const allDataSources = { ...configuredDataSources };\n\n    console.log('[MSD v1] 📊 Data source summary:', {\n      configured: Object.keys(configuredDataSources).length,\n      total: Object.keys(allDataSources).length,\n      allDataSourceIds: Object.keys(allDataSources)\n    });\n\n    if (Object.keys(allDataSources).length === 0) {\n      console.log('[MSD v1] No explicit data sources configured - DataSourceManager will not be initialized');\n      console.log('[MSD v1] Note: Control overlays will use direct HASS (no data sources needed)');\n      return;\n    }\n\n    console.log('[MSD v1] Initializing DataSourceManager with', Object.keys(allDataSources).length, 'explicit data sources');\n\n    try {\n      this.dataSourceManager = new DataSourceManager(hass);\n      const sourceCount = await this.dataSourceManager.initializeFromConfig(allDataSources);\n      console.log('[MSD v1] ✅ DataSourceManager initialized -', sourceCount, 'sources started');\n\n      // ADDED: Verify entities are available\n      const entityIds = this.dataSourceManager.listIds();\n      console.log('[MSD v1] ✅ DataSourceManager entities available:', entityIds);\n\n    } catch (error) {\n      console.error('[MSD v1] ❌ DataSourceManager initialization failed:', error);\n      console.error('[MSD v1] Error details:', error.stack);\n      this.dataSourceManager = null;\n    }\n  }\n\n  /**\n   * Extract entity IDs from control overlays for auto data source creation\n   */\n  _extractControlEntities(mergedConfig) {\n    const entities = new Set();\n\n    // Extract from overlays\n    const overlays = mergedConfig.overlays || [];\n    overlays.forEach(overlay => {\n      if (overlay.type === 'control' && overlay.card) {\n        // Check multiple possible entity locations\n        const entity = overlay.card.config?.entity ||\n                      overlay.card.config?.variables?.entity ||\n                      overlay.card.entity;\n\n        if (entity) {\n          entities.add(entity);\n        }\n      }\n    });\n\n    // Extract from any other control configurations\n    // (Add more extraction logic here as needed)\n\n    return Array.from(entities);\n  }\n\n  /**\n   * Essential cleanup method\n   */\n  destroy() {\n    if (this.debugRenderer) {\n      this.debugRenderer.destroy();\n    }\n\n    // Clear render timeout\n    if (this._renderTimeout) {\n      clearTimeout(this._renderTimeout);\n      this._renderTimeout = null;\n    }\n\n    // Clear re-render callback\n    this._reRenderCallback = null;\n  }\n\n  /**\n   * Render debug overlays and controls using DebugManager with basic performance tracking\n   * @param {Object} resolvedModel - The resolved model\n   * @param {Element} mountEl - The shadowRoot/mount element\n   */\n  async renderDebugAndControls(resolvedModel, mountEl = null) {\n    // ADDED: Early exit if already rendering\n    if (this._debugControlsRendering) {\n      console.log('[SystemsManager] renderDebugAndControls already in progress, skipping');\n      return;\n    }\n\n    this._debugControlsRendering = true;\n\n    try {\n      const debugState = this.debugManager.getSnapshot();\n\n      console.log('[SystemsManager] renderDebugAndControls called:', {\n        anyEnabled: this.debugManager.isAnyEnabled(),\n        controlOverlays: resolvedModel.overlays.filter(o => o.type === 'control').length,\n        hasHass: !!this._currentHass,\n        hasResolvedModel: !!resolvedModel,\n        hasOverlays: !!resolvedModel?.overlays\n      });\n\n      // ADDED: Validate resolved model\n      if (!resolvedModel || !resolvedModel.overlays) {\n        console.warn('[SystemsManager] Invalid resolved model for renderDebugAndControls');\n        return;\n      }\n\n      // Render debug visualizations with error boundary\n      if (this.debugManager.isAnyEnabled()) {\n        try {\n          const debugOptions = {\n            anchors: resolvedModel.anchors || {},\n            overlays: resolvedModel.overlays || [],\n            showAnchors: debugState.anchors,\n            showBoundingBoxes: debugState.bounding_boxes,\n            showRouting: this.debugManager.canRenderRouting(),\n            showPerformance: debugState.performance,\n            scale: debugState.scale\n          };\n\n          this.debugRenderer.render(mountEl || this.renderer?.mountEl, resolvedModel.viewBox, debugOptions);\n          console.log('[SystemsManager] ✅ Debug renderer completed');\n        } catch (error) {\n          console.error('[SystemsManager] ❌ Debug renderer failed:', error);\n          // Continue execution - don't fail the entire render\n        }\n      }\n\n      // FIXED: Render control overlays with comprehensive error handling\n      const controlOverlays = resolvedModel.overlays.filter(o => o.type === 'control');\n      if (controlOverlays.length > 0) {\n        console.log('[SystemsManager] Rendering control overlays:', controlOverlays.map(c => c.id));\n\n        try {\n          // ADDED: Validate controls renderer exists\n          if (!this.controlsRenderer) {\n            console.error('[SystemsManager] No controls renderer available');\n            return;\n          }\n\n          // Ensure controls renderer has current HASS context\n          if (this._currentHass && this.controlsRenderer) {\n            this.controlsRenderer.setHass(this._currentHass);\n            console.log('[SystemsManager] HASS context applied to controls renderer');\n          } else {\n            console.warn('[SystemsManager] No HASS context available for controls');\n          }\n\n          // REMOVED: Defensive container creation - not needed with SVG foreignObject approach\n          // The renderControls() method handles all necessary container creation internally\n\n          // ADDED: Defensive controls rendering with timeout\n          const renderPromise = this.controlsRenderer.renderControls(controlOverlays, resolvedModel);\n          const timeoutPromise = new Promise((_, reject) =>\n            setTimeout(() => reject(new Error('Controls render timeout')), 5000)\n          );\n\n          await Promise.race([renderPromise, timeoutPromise]);\n          console.log('[SystemsManager] ✅ Controls rendered successfully');\n\n        } catch (error) {\n          console.error('[SystemsManager] ❌ Controls rendering failed:', error);\n          console.error('[SystemsManager] Error stack:', error.stack);\n        }\n      }\n\n    } catch (error) {\n      console.error('[SystemsManager] renderDebugAndControls failed completely:', error);\n      console.error('[SystemsManager] Error stack:', error.stack);\n    } finally {\n      this._debugControlsRendering = false;\n    }\n  }\n\n  /**\n   * Check if debug should be rendered based on config\n   * @param {Object} debugConfig - Debug configuration\n   * @returns {boolean} Whether debug should be rendered\n   */\n  _shouldRenderDebugFromConfig(debugConfig) {\n    if (!debugConfig || !debugConfig.overlays) return false;\n\n    return debugConfig.overlays.anchors ||\n          debugConfig.overlays.bounding_boxes ||\n          debugConfig.overlays.routing ||\n          debugConfig.overlays.performance;\n  }\n\n  /**\n   * Legacy debug flag support (for backward compatibility)\n   * @returns {Object} Debug flags\n   */\n  _getDebugFlags() {\n    return window.cblcars?._debugFlags || {};\n  }\n\n  /**\n   * Legacy debug check (for backward compatibility)\n   * @param {Object} debugFlags - Debug flags\n   * @returns {boolean} Whether debug should be rendered\n   */\n  _shouldRenderDebug(debugFlags) {\n    return debugFlags && (debugFlags.overlay || debugFlags.connectors || debugFlags.geometry);\n  }\n\n  // Public API methods - now exclusively using DataSourceManager\n  ingestHass(hass) {\n    console.log('[SystemsManager] ingestHass called with:', {\n      hasHass: !!hass,\n      hasStates: !!hass?.states,\n      entityCount: hass?.states ? Object.keys(hass.states).length : 0,\n      hasLightDesk: !!hass?.states?.['light.desk'],\n      lightDeskState: hass?.states?.['light.desk']?.state,\n      timestamp: new Date().toISOString()\n    });\n\n    if (!hass || !hass.states) {\n      console.warn('[MSD v1] ingestHass called without valid hass.states');\n      return;\n    }\n\n    // CRITICAL: Update BOTH working copy AND original copy to keep them fresh\n    this._currentHass = hass;\n    this._originalHass = hass;  // ADDED: Keep original fresh too\n\n    console.log('[SystemsManager] Updated both _currentHass and _originalHass with fresh data');\n\n    // ENHANCED: Pass HASS to controls renderer EVERY time to ensure cards get updates\n    if (this.controlsRenderer) {\n      console.log('[SystemsManager] Updating HASS context in controls renderer immediately');\n      this.controlsRenderer.setHass(hass);\n    } else {\n      console.warn('[SystemsManager] No controls renderer available for HASS update');\n    }\n\n    // DataSources handle HASS updates automatically via their subscriptions\n    // No manual ingestion needed - handled by individual data sources\n    console.log('[MSD v1] HASS ingestion handled by individual data sources');\n  }\n\n  updateEntities(map) {\n    if (!map || typeof map !== 'object') return;\n\n    console.log('[MSD v1] Manual entity updates not supported in DataSources system');\n    console.warn('[MSD v1] Use direct HASS state updates instead of manual entity updates');\n  }\n\n  // Entity API methods using DataSourceManager\n  listEntities() {\n    return this.dataSourceManager ? this.dataSourceManager.listIds() : [];\n  }\n\n  getEntity(id) {\n    return this.dataSourceManager ? this.dataSourceManager.getEntity(id) : null;\n  }\n\n  /**\n   * Set up direct HASS subscription to ensure fresh HASS for controls\n   * @param {Object} hass - Home Assistant object with connection\n   */\n  setupDirectHassSubscription(hass) {\n    if (hass && hass.connection && !this._directHassSubscription) {\n      console.log('[SystemsManager] 🔗 Setting up direct HASS subscription for fresh control updates');\n\n      this._directHassSubscription = hass.connection.subscribeEvents((event) => {\n        if (event.event_type === 'state_changed' && event.data && event.data.entity_id) {\n          const entityId = event.data.entity_id;\n          const newState = event.data.new_state;\n\n          // Check if this is a control entity\n          const controlEntities = this._extractControlEntities(this.mergedConfig);\n          if (controlEntities.includes(entityId) && newState) {\n            console.log('[SystemsManager] 📡 Direct HASS update for control entity:', entityId, 'new state:', newState.state);\n\n            // Update our HASS with the fresh state\n            if (this._originalHass && this._originalHass.states) {\n              const freshHass = {\n                ...this._originalHass,\n                states: {\n                  ...this._originalHass.states,\n                  [entityId]: newState\n                }\n              };\n\n              console.log('[SystemsManager] 📊 Updated HASS with fresh state for', entityId, ':', newState.state);\n              this._originalHass = freshHass;\n              this._currentHass = freshHass;\n\n              // Forward fresh HASS to controls immediately\n              if (this.controlsRenderer) {\n                console.log('[SystemsManager] 📤 Immediately forwarding fresh HASS to controls');\n                this.controlsRenderer.setHass(freshHass);\n              }\n            }\n          }\n        }\n      }, 'state_changed');\n\n            console.log('[SystemsManager] ✅ Direct HASS subscription established');\n    }\n  }\n\n  /**\n   * Set up global HUD interface (placeholder for future implementation)\n   * @private\n   */\n  _setupGlobalHudInterface() {\n    console.log('[SystemsManager] Global HUD interface setup completed');\n    // This method is called during initialization\n    // Future HUD interface setup will go here\n  }\n}\n\n","import { perfTime, perfCount } from '../util/performance.js';\n\n/**\n * Profile system for layered style resolution\n * Handles active_profiles precedence and profile-specific overrides\n *\n * FIXED: Overlay styles now have HIGHER precedence than profile styles\n */\nexport class ProfileResolver {\n  constructor() {\n    this.profileIndex = new Map(); // profileId -> profile data\n    this.activeProfiles = [];\n    this.styleCache = new Map(); // overlayId -> cached merged style\n    this.lastActiveProfiles = null; // For cache invalidation\n\n    // Performance tracking\n    this.perfStats = {\n      profileLoads: 0,\n      styleMerges: 0,\n      cacheHits: 0,\n      cacheMisses: 0,\n      invalidations: 0\n    };\n  }\n\n  /**\n   * Load profiles into the resolver index\n   */\n  loadProfiles(profiles) {\n    perfTime('profile.load', () => {\n      this.profileIndex.clear();\n\n      profiles.forEach(profile => {\n        if (profile.id) {\n          this.profileIndex.set(profile.id, profile);\n          this.perfStats.profileLoads++;\n        }\n      });\n\n      perfCount('profile.loaded', profiles.length);\n    });\n  }\n\n  /**\n   * Set active profiles and invalidate cache if changed\n   */\n  setActiveProfiles(activeProfiles) {\n    const newActiveProfiles = Array.isArray(activeProfiles) ? activeProfiles : [];\n\n    // Check if profiles changed\n    const changed = JSON.stringify(this.activeProfiles) !== JSON.stringify(newActiveProfiles);\n\n    if (changed) {\n      this.activeProfiles = [...newActiveProfiles];\n      this.invalidateStyleCache();\n      perfCount('profile.active.changed', 1);\n    }\n  }\n\n  /**\n   * Resolve styles for all overlays with profile layering\n   */\n  resolveOverlayStyles(overlays) {\n    return perfTime('profile.resolve.overlays', () => {\n      const resolved = overlays.map(overlay => {\n        const resolvedOverlay = { ...overlay };\n\n        // Get merged style with profile layers\n        resolvedOverlay.style = this.resolveOverlayStyle(overlay);\n\n        return resolvedOverlay;\n      });\n\n      perfCount('profile.overlays.processed', overlays.length);\n      return resolved;\n    });\n  }\n\n  /**\n   * Resolve style for a single overlay with profile layering\n   */\n  resolveOverlayStyle(overlay) {\n    return perfTime('profile.resolve.single', () => {\n      // Check cache first\n      const cacheKey = this.buildStyleCacheKey(overlay);\n\n      if (this.styleCache.has(cacheKey)) {\n        this.perfStats.cacheHits++;\n        perfCount('profile.cache.hits', 1);\n        return this.styleCache.get(cacheKey);\n      }\n\n      // Build style layers\n      const styleLayers = this.buildStyleLayers(overlay);\n\n      // Merge layers with precedence\n      const mergedStyle = this.mergeStyleLayers(styleLayers);\n\n      // Cache the result\n      this.styleCache.set(cacheKey, mergedStyle);\n      this.perfStats.cacheMisses++;\n      this.perfStats.styleMerges++;\n      perfCount('profile.cache.misses', 1);\n\n      return mergedStyle;\n    });\n  }\n\n  /**\n   * Build ordered style layers for an overlay\n   *\n   * FIXED: Corrected precedence order - overlays should override profiles\n   */\n  buildStyleLayers(overlay) {\n    const layers = [];\n\n    // Layer 1-N: Active profile styles (LOWEST precedence - applied first)\n    this.activeProfiles.forEach((profileId, index) => {\n      const profile = this.profileIndex.get(profileId);\n\n      if (profile) {\n        // Check for overlay-specific style in profile\n        const overlayStyle = this.getProfileOverlayStyle(profile, overlay.id, overlay.type);\n\n        if (overlayStyle) {\n          layers.push({\n            source: 'profile',\n            sourceId: profileId,\n            style: overlayStyle,\n            precedence: 100 + index // Earlier profiles have lower precedence\n          });\n        }\n      }\n    });\n\n    // Layer N+1: Base overlay style (HIGHEST precedence - applied last)\n    if (overlay.style) {\n      layers.push({\n        source: 'overlay',\n        sourceId: overlay.id,\n        style: overlay.style,\n        precedence: 1000 // Much higher than any profile\n      });\n    }\n\n    // Sort by precedence (lower numbers first, higher numbers override)\n    return layers.sort((a, b) => a.precedence - b.precedence);\n  }\n\n  /**\n   * Get profile style for a specific overlay\n   */\n  getProfileOverlayStyle(profile, overlayId, overlayType) {\n    // Check for direct overlay ID match\n    if (profile.overlays && profile.overlays[overlayId]) {\n      return profile.overlays[overlayId];\n    }\n\n    // Check for type-based defaults\n    if (profile.defaults && profile.defaults[overlayType]) {\n      return profile.defaults[overlayType];\n    }\n\n    return null;\n  }\n\n  /**\n   * Merge style layers with proper precedence\n   */\n  mergeStyleLayers(layers) {\n    const merged = {};\n    const provenance = {}; // Track which profile/source set each property\n\n    layers.forEach(layer => {\n      Object.entries(layer.style).forEach(([property, value]) => {\n        // Later layers override earlier ones\n        merged[property] = value;\n        provenance[property] = {\n          source: layer.source,\n          sourceId: layer.sourceId,\n          precedence: layer.precedence\n        };\n      });\n    });\n\n    // Attach provenance for debugging (non-enumerable)\n    Object.defineProperty(merged, '__styleProvenance', {\n      value: provenance,\n      enumerable: false,\n      writable: false\n    });\n\n    return merged;\n  }\n\n  /**\n   * Build cache key for overlay style\n   */\n  buildStyleCacheKey(overlay) {\n    const keyParts = [\n      overlay.id,\n      overlay.type || 'unknown',\n      this.getOverlayStyleHash(overlay.style),\n      this.activeProfiles.join(',')\n    ];\n\n    return keyParts.join('|');\n  }\n\n  /**\n   * Get simple hash of overlay style for cache key\n   */\n  getOverlayStyleHash(style) {\n    if (!style || typeof style !== 'object') return 'empty';\n\n    // Simple hash based on stringified style\n    return JSON.stringify(style).length.toString(36);\n  }\n\n  /**\n   * Invalidate style cache\n   */\n  invalidateStyleCache() {\n    this.styleCache.clear();\n    this.perfStats.invalidations++;\n    perfCount('profile.cache.invalidated', 1);\n  }\n\n  /**\n   * Get profile by ID\n   */\n  getProfile(profileId) {\n    return this.profileIndex.get(profileId);\n  }\n\n  /**\n   * Get all active profiles\n   */\n  getActiveProfiles() {\n    return [...this.activeProfiles];\n  }\n\n  /**\n   * Get available profile IDs\n   */\n  getAvailableProfiles() {\n    return Array.from(this.profileIndex.keys());\n  }\n\n  /**\n   * Check if a profile is active\n   */\n  isProfileActive(profileId) {\n    return this.activeProfiles.includes(profileId);\n  }\n\n  /**\n   * Get performance statistics\n   */\n  getStats() {\n    return {\n      ...this.perfStats,\n      profileCount: this.profileIndex.size,\n      activeProfileCount: this.activeProfiles.length,\n      cacheSize: this.styleCache.size,\n      hitRate: this.perfStats.cacheHits / (this.perfStats.cacheHits + this.perfStats.cacheMisses) || 0\n    };\n  }\n\n  /**\n   * Get detailed profile information for debugging\n   */\n  getDebugInfo() {\n    const info = {\n      availableProfiles: {},\n      activeProfiles: this.activeProfiles,\n      cacheSize: this.styleCache.size,\n      stats: this.getStats()\n    };\n\n    // Add profile details\n    this.profileIndex.forEach((profile, profileId) => {\n      info.availableProfiles[profileId] = {\n        hasDefaults: !!(profile.defaults && Object.keys(profile.defaults).length > 0),\n        hasOverlays: !!(profile.overlays && Object.keys(profile.overlays).length > 0),\n        defaultTypes: profile.defaults ? Object.keys(profile.defaults) : [],\n        overlayIds: profile.overlays ? Object.keys(profile.overlays) : []\n      };\n    });\n\n    return info;\n  }\n\n  /**\n   * Export resolver statistics for debugging\n   */\n  exportStats(options = {}) {\n    const stats = this.getStats();\n\n    if (options.includeDebug) {\n      stats.debug = this.getDebugInfo();\n    }\n\n    return options.format === 'json' ?\n      JSON.stringify(stats, null, 2) :\n      stats;\n  }\n}\n\n// Global resolver instance\nconst globalProfileResolver = new ProfileResolver();\n\n// Debug exposure\nconst debugNamespace = (typeof window !== 'undefined') ? window : global;\nif (debugNamespace) {\n  debugNamespace.__msdProfile = {\n    resolver: globalProfileResolver,\n    getStats: () => globalProfileResolver.getStats(),\n    getDebugInfo: () => globalProfileResolver.getDebugInfo(),\n    getActiveProfiles: () => globalProfileResolver.getActiveProfiles(),\n    getAvailableProfiles: () => globalProfileResolver.getAvailableProfiles(),\n    export: (options) => globalProfileResolver.exportStats(options)\n  };\n}\n\nexport { globalProfileResolver };","export function isPlain(o) {\n  return o && typeof o === 'object' && !Array.isArray(o);\n}\nexport function deepMerge(target, source) {\n  if (!isPlain(source)) return source;\n  if (!isPlain(target)) target = {};\n  for (const k of Object.keys(source)) {\n    const sv = source[k];\n    const tv = target[k];\n    if (isPlain(sv) && isPlain(tv)) {\n      target[k] = deepMerge(tv, sv);\n    } else {\n      // Arrays & scalars replace (per spec).\n      target[k] = sv;\n    }\n  }\n  return target;\n}\n","import { globalProfileResolver } from '../profile/ProfileResolver.js';\nimport { applyOverlayPatches } from '../rules/RulesEngine.js';\nimport { resolveValueMaps } from '../valueMap/resolveValueMaps.js';\nimport { resolveDesiredAnimations } from '../animation/resolveAnimations.js';\nimport { resolveDesiredTimelines } from '../animation/resolveTimelines.js';\nimport { perfTime } from '../perf/PerfCounters.js';\n\nexport class ModelBuilder {\n  constructor(mergedConfig, cardModel, systemsManager) {\n    this.mergedConfig = mergedConfig;\n    this.cardModel = cardModel;\n    this.systems = systemsManager;\n\n    // Replace profile index building with ProfileResolver\n    globalProfileResolver.loadProfiles(mergedConfig.profiles || []);\n\n    this.animationIndex = new Map((mergedConfig.animations || []).map(a => [a.id, a]));\n    this.timelineDefs = mergedConfig.timelines || [];\n    this.runtimeActiveProfiles = Array.isArray(mergedConfig.active_profiles)\n      ? mergedConfig.active_profiles.slice()\n      : [];\n    this._resolvedModelRef = null;\n  }\n\n  computeResolvedModel() {\n    // Anchor repair diagnostic\n    this._ensureAnchors();\n\n    // Assemble base overlays with profiles\n    const baseOverlays = this._assembleBaseOverlays();\n\n    // Subscribe overlays to data sources\n    this._subscribeOverlaysToDataSources(baseOverlays);\n\n    // Apply rules\n    const ruleResult = this._applyRules();\n\n    // Handle profile changes from rules\n    this._updateActiveProfiles(ruleResult);\n\n    // Apply overlay patches\n    const overlaysWithPatches = this._applyOverlayPatches(baseOverlays, ruleResult);\n\n    // Value map substitutions\n    this._resolveValueMaps(overlaysWithPatches);\n\n    // Process animations\n    const { activeAnimations, animDiff, tlDiff } = this._processAnimations(overlaysWithPatches, ruleResult);\n\n    // Build final resolved model\n    const resolved = {\n      viewBox: this.cardModel.viewBox,\n      anchors: { ...this.cardModel.anchors },\n      overlays: overlaysWithPatches,\n      animations: animDiff.active,\n      timelines: tlDiff.active,\n      config: this.mergedConfig,\n      active_profiles: this.runtimeActiveProfiles.slice()\n    };\n\n    // Update router\n    try {\n      this.systems.router.setOverlays && this.systems.router.setOverlays(resolved.overlays);\n    } catch(_) {}\n\n    this._resolvedModelRef = resolved;\n    return resolved;\n  }\n\n  getResolvedModel() {\n    return this._resolvedModelRef;\n  }\n\n  _ensureAnchors() {\n    if (!this.cardModel.anchors || Object.keys(this.cardModel.anchors).length === 0) {\n      if (this.mergedConfig.anchors && Object.keys(this.mergedConfig.anchors).length) {\n        console.warn('[MSD v1] computeResolvedModel: anchors missing – repairing from merged.anchors');\n        this.cardModel.anchors = { ...this.mergedConfig.anchors };\n      } else {\n        console.warn('[MSD v1] computeResolvedModel: anchors missing and no merged fallback available.');\n      }\n    }\n  }\n\n  _assembleBaseOverlays() {\n    return perfTime('profiles.assemble', () => {\n      // Set active profiles before resolving\n      globalProfileResolver.setActiveProfiles(this.runtimeActiveProfiles);\n\n      return this.cardModel.overlaysBase.map(o => {\n        // Replace assembleOverlayBaseStyle with ProfileResolver\n        const style = globalProfileResolver.resolveOverlayStyle(o);\n\n        // Get provenance from resolved style (if needed for debugging)\n        const sources = style.__styleProvenance ?\n          Object.entries(style.__styleProvenance).map(([prop, prov]) => ({\n            kind: prov.source,\n            id: prov.sourceId\n          })) : [];\n\n        // Preserve ALL properties from raw overlay config\n        const resolvedOverlay = {\n          id: o.id,\n          type: o.type,\n          style,\n          finalStyle: { ...style },\n          _styleSources: sources,\n          _raw: o.raw,\n          anchor: o.raw?.anchor,\n          attach_to: o.raw?.attach_to,\n          position: o.raw?.position,\n          size: o.raw?.size\n        };\n\n        // Preserve data source and routing properties\n        if (o.raw?.source) {\n          resolvedOverlay.source = o.raw.source;\n        }\n\n        if (o.raw?.route) {\n          resolvedOverlay.route = o.raw.route;\n        }\n\n        return resolvedOverlay;\n      });\n    });\n  }\n\n  /* OLD\n  _subscribeOverlaysToDataSources(baseOverlays) {\n    if (this.systems.dataSourceManager && baseOverlays) {\n      let subscriptionCount = 0;\n      baseOverlays.forEach(overlay => {\n        if ((overlay.type === 'sparkline' || overlay.type === 'ribbon') && overlay.source) {\n          try {\n            this.systems.dataSourceManager.subscribeOverlay(overlay, (overlay, updateData) => {\n              // FIX: updateData IS the source data, not updateData.sourceData\n              console.log('[MSD v1] 📊 Data update for overlay', overlay.id, 'value:', updateData.v);\n\n              // Update the renderer with real data - pass updateData directly\n              if (this.systems.renderer && this.systems.renderer.updateOverlayData) {\n                this.systems.renderer.updateOverlayData(overlay.id, updateData);\n              }\n            });\n            subscriptionCount++;\n            console.log('[MSD v1] ✅ Subscribed overlay', overlay.id, 'to data source', overlay.source);\n          } catch (error) {\n            console.warn('[MSD v1] ⚠️ Failed to subscribe overlay', overlay.id, 'to source', overlay.source, ':', error.message);\n          }\n        }\n      });\n\n      if (subscriptionCount > 0) {\n        console.log('[MSD v1] ✅ Established', subscriptionCount, 'overlay data subscriptions');\n      }\n    }\n  }\n  */\n\n\n\n  _subscribeOverlaysToDataSources(baseOverlays) {\n    if (!this.systems.dataSourceManager || !baseOverlays) {\n      console.log('[MSD v1] Skipping overlay subscriptions - no DataSourceManager or overlays');\n      return;\n    }\n\n    let subscriptionCount = 0;\n    let pendingSubscriptions = 0;\n\n    baseOverlays.forEach(overlay => {\n      if ((overlay.type === 'sparkline' || overlay.type === 'ribbon') && overlay.source) {\n        try {\n          // Check if data source exists and is ready\n          const dataSource = this.systems.dataSourceManager.getSource(overlay.source);\n          if (!dataSource) {\n            console.warn(`[MSD v1] Data source '${overlay.source}' not found for overlay ${overlay.id}`);\n            return;\n          }\n\n          // Check data source readiness\n          const currentData = dataSource.getCurrentData();\n          const isReady = currentData && (currentData.bufferSize > 0 || currentData.v !== undefined);\n\n          console.log(`[MSD v1] Subscribing overlay ${overlay.id} to source ${overlay.source}:`, {\n            sourceReady: isReady,\n            bufferSize: currentData?.bufferSize || 0,\n            hasValue: currentData?.v !== undefined\n          });\n\n          // Subscribe with enhanced callback\n          const unsubscribe = this.systems.dataSourceManager.subscribeOverlay(overlay, (overlayConfig, updateData) => {\n            console.log(`[MSD v1] 📊 Data update for overlay ${overlayConfig.id}:`, {\n              value: updateData.v,\n              bufferSize: updateData.buffer?.size?.() || 0,\n              hasHistoricalData: !!(updateData.historicalData?.length),\n              sourceReady: true\n            });\n\n            // Update the renderer with real data\n            if (this.systems.renderer && this.systems.renderer.updateOverlayData) {\n              try {\n                this.systems.renderer.updateOverlayData(overlayConfig.id, updateData);\n              } catch (error) {\n                console.error(`[MSD v1] Error updating overlay ${overlayConfig.id}:`, error);\n              }\n            } else {\n              console.warn(`[MSD v1] Renderer not available for overlay update: ${overlayConfig.id}`);\n            }\n          });\n\n          if (unsubscribe) {\n            subscriptionCount++;\n            if (isReady) {\n              console.log(`[MSD v1] ✅ Subscribed overlay ${overlay.id} to ready source ${overlay.source}`);\n            } else {\n              pendingSubscriptions++;\n              console.log(`[MSD v1] ⏳ Subscribed overlay ${overlay.id} to pending source ${overlay.source}`);\n            }\n\n            // Store unsubscribe function for cleanup\n            if (!this._overlayUnsubscribers) {\n              this._overlayUnsubscribers = new Map();\n            }\n            if (!this._overlayUnsubscribers.has(overlay.id)) {\n              this._overlayUnsubscribers.set(overlay.id, []);\n            }\n            this._overlayUnsubscribers.get(overlay.id).push(unsubscribe);\n          }\n\n        } catch (error) {\n          console.warn(`[MSD v1] ⚠️ Failed to subscribe overlay ${overlay.id} to source ${overlay.source}:`, error.message);\n        }\n      }\n    });\n\n    if (subscriptionCount > 0) {\n      console.log(`[MSD v1] ✅ Established ${subscriptionCount} overlay data subscriptions (${pendingSubscriptions} pending data)`);\n    }\n\n    // Monitor pending subscriptions and log when they become ready\n    if (pendingSubscriptions > 0) {\n      this._monitorPendingSubscriptions(baseOverlays, pendingSubscriptions);\n    }\n  }\n\n\n\n\n  /**\n   * Monitor pending subscriptions and report when data becomes available\n   * @private\n   * @param {Array} baseOverlays - Array of overlay configurations\n   * @param {number} pendingCount - Initial count of pending subscriptions\n   */\n  _monitorPendingSubscriptions(baseOverlays, pendingCount) {\n    let checkCount = 0;\n    const maxChecks = 50; // Maximum number of checks (5 seconds with 100ms intervals)\n\n    const checkInterval = setInterval(() => {\n      checkCount++;\n      let stillPending = 0;\n\n      baseOverlays.forEach(overlay => {\n        if ((overlay.type === 'sparkline' || overlay.type === 'ribbon') && overlay.source) {\n          const dataSource = this.systems.dataSourceManager.getSource(overlay.source);\n          if (dataSource) {\n            const currentData = dataSource.getCurrentData();\n            const isReady = currentData && (currentData.bufferSize > 0 || currentData.v !== undefined);\n            if (!isReady) {\n              stillPending++;\n            }\n          }\n        }\n      });\n\n      if (stillPending === 0) {\n        console.log(`[MSD v1] 🎉 All overlay data sources are now ready (checked ${checkCount} times)`);\n        clearInterval(checkInterval);\n      } else if (checkCount >= maxChecks) {\n        console.warn(`[MSD v1] ⏰ Timeout waiting for ${stillPending} data sources to become ready`);\n        clearInterval(checkInterval);\n      } else if (checkCount % 10 === 0) {\n        // Log progress every second (10 * 100ms)\n        console.log(`[MSD v1] ⏳ Still waiting for ${stillPending} data sources (${checkCount * 100}ms elapsed)`);\n      }\n    }, 100); // Check every 100ms\n  }\n\n\n\n\n  _applyRules() {\n    return this.systems.rulesEngine.evaluateDirty({\n      getEntity: id => this.systems.entityRuntime.getEntity(id)\n    });\n  }\n\n  _updateActiveProfiles(ruleResult) {\n    if (ruleResult.profilesAdd?.length || ruleResult.profilesRemove?.length) {\n      const set = new Set(this.runtimeActiveProfiles);\n      ruleResult.profilesAdd.forEach(p => set.add(p));\n      ruleResult.profilesRemove.forEach(p => set.delete(p));\n      this.runtimeActiveProfiles = Array.from(set);\n\n      // Update ProfileResolver with new active profiles\n      globalProfileResolver.setActiveProfiles(this.runtimeActiveProfiles);\n    }\n  }\n\n  _applyOverlayPatches(baseOverlays, ruleResult) {\n    return perfTime('styles.patch', () =>\n      applyOverlayPatches(baseOverlays, ruleResult.overlayPatches)\n    );\n  }\n\n  _resolveValueMaps(overlaysWithPatches) {\n    perfTime('value_map.subst', () =>\n      resolveValueMaps(overlaysWithPatches, {\n        getEntity: id => this.systems.entityRuntime.getEntity(id)\n      })\n    );\n  }\n\n  _processAnimations(overlaysWithPatches, ruleResult) {\n    const desiredAnimations = resolveDesiredAnimations(overlaysWithPatches, this.animationIndex, ruleResult.animations);\n    const desiredTimelines = resolveDesiredTimelines(this.timelineDefs);\n    const activeAnimations = [];\n\n    desiredAnimations.forEach(animDef => {\n      const instance = this.systems.animRegistry.getOrCreateInstance(animDef.definition, animDef.targets);\n      if (instance) {\n        activeAnimations.push({\n          id: animDef.id,\n          instance,\n          hash: this.systems.animRegistry.computeInstanceHash(animDef.definition)\n        });\n      }\n    });\n\n    const animDiff = { active: activeAnimations };\n    const tlDiff = { active: desiredTimelines };\n\n    // Assign animation hash to overlays\n    const overlayAnimByKey = new Map();\n    animDiff.active.forEach(a => {\n      if (a.overlayId) overlayAnimByKey.set(a.overlayId, a.hash);\n    });\n    overlaysWithPatches.forEach(o => {\n      const h = overlayAnimByKey.get(o.id);\n      if (h) o.animation_hash = h;\n    });\n\n    return { activeAnimations, animDiff, tlDiff };\n  }\n\n\n  /**\n   * Clean up overlay subscriptions\n   * @public\n   */\n  destroy() {\n    if (this._overlayUnsubscribers) {\n      console.log(`[MSD v1] Cleaning up ${this._overlayUnsubscribers.size} overlay subscriptions`);\n\n      for (const [overlayId, unsubscribers] of this._overlayUnsubscribers) {\n        unsubscribers.forEach(unsubscribe => {\n          try {\n            unsubscribe();\n          } catch (error) {\n            console.warn(`[MSD v1] Error unsubscribing overlay ${overlayId}:`, error);\n          }\n        });\n      }\n\n      this._overlayUnsubscribers.clear();\n    }\n  }\n\n}\n","import { perfInc, perfTime } from '../perf/PerfCounters.js';\nimport { linearMap } from '../util/linearMap.js';\n\nexport function resolveValueMaps(resolvedOverlays, ctx) {\n  return perfTime('value_map.resolve', () => {\n    let success = 0;\n    let fail = 0;\n\n    for (const ov of resolvedOverlays) {\n      if (!ov.finalStyle) continue;\n      ov.finalStyle = walk(ov.finalStyle);\n    }\n\n    perfInc('value_map.resolve.count', success);\n    perfInc('value_map.fail.count', fail);\n\n    function walk(node) {\n      if (!node || typeof node !== 'object') return node;\n      // value_map descriptor: exact shape { value_map: {...} } OR object with only that key\n      if (node.value_map && Object.keys(node).length === 1) {\n        const val = computeValueMap(node.value_map);\n        return val;\n      }\n      // Recurse\n      if (Array.isArray(node)) return node.map(walk);\n      const out = {};\n      for (const k of Object.keys(node)) {\n        out[k] = walk(node[k]);\n      }\n      return out;\n    }\n\n    function computeValueMap(desc) {\n      try {\n        const entityId = desc.entity;\n        if (!entityId) { fail++; return fallback(desc); }\n        const ent = ctx?.getEntity ? ctx.getEntity(entityId) : null;\n        if (!ent) { fail++; return fallback(desc); }\n        let raw = ent.state;\n        if (desc.attribute && ent.attributes) raw = ent.attributes[desc.attribute];\n        let num = Number(raw);\n        if (!Number.isFinite(num)) { fail++; return fallback(desc); }\n        const [inA, inB] = desc.input || [];\n        const [outA, outB] = desc.output || [];\n        if (![inA,inB,outA,outB].every(Number.isFinite)) { fail++; return fallback(desc); }\n        let mapped = linearMap(num, inA, inB, outA, outB, !!desc.clamp);\n        if (Number.isFinite(desc.round)) {\n          const pow = Math.pow(10, desc.round);\n          mapped = Math.round(mapped * pow) / pow;\n        }\n        success++;\n        return mapped;\n      } catch {\n        fail++;\n        return fallback(desc);\n      }\n    }\n    function fallback(desc) {\n      if (desc && Number.isFinite(desc.default)) return desc.default;\n      if (Array.isArray(desc?.output) && Number.isFinite(desc.output[0])) return desc.output[0];\n      return 1; // minimal visible default\n    }\n  });\n}\n","export function linearMap(val, inMin, inMax, outMin, outMax, clamp) {\n  if (inMax === inMin) return outMin;\n  let t = (val - inMin) / (inMax - inMin);\n  if (clamp) {\n    if (t < 0) t = 0;\n    else if (t > 1) t = 1;\n  }\n  return outMin + t * (outMax - outMin);\n}\n","import { deepMerge } from '../util/deepMerge.js';\n\n/**\n * Build desired animation instances.\n * @param {Array} overlays resolved overlays (with _raw for original)\n * @param {Object} animationIndex id -> animation def\n * @param {Array} ruleAnimations from rulesEngine (ref, override, priority)\n */\n// NOTE Wave 1: preset resolution deferred to AnimationRegistry (builders in presets.js)\nexport function resolveDesiredAnimations(overlays, animationIndex, ruleAnimations) {\n  const desired = [];\n  const ruleOverridesGrouped = groupRuleAnimOverrides(ruleAnimations);\n\n  // Overlay-level animations\n  for (const ov of overlays) {\n    const raw = ov._raw || ov.raw || {};\n    if (!raw.animation_ref) continue;\n    const base = animationIndex.get(raw.animation_ref);\n    if (!base) continue;\n    // Build merged params\n    let params = {};\n    if (base.params) params = deepMerge(params, base.params);\n    if (raw.animation_override?.params) params = deepMerge(params, raw.animation_override.params);\n\n    // Apply highest-priority rule override first (only first per ref used per overlay)\n    const ruleList = ruleOverridesGrouped.get(raw.animation_ref);\n    if (ruleList && ruleList.length) {\n      // Already sorted by priority desc\n      for (const r of ruleList) {\n        if (r.override?.params) params = deepMerge(params, r.override.params);\n        break; // only top-level override for now\n      }\n    }\n\n    desired.push({\n      key: `overlay:${ov.id}:${raw.animation_ref}`,\n      preset: base.preset,\n      params,\n      targets: [`#${ov.id}`],\n      ref: raw.animation_ref,\n      overlayId: ov.id\n    });\n  }\n\n  // Standalone animations (defs with explicit targets)\n  for (const [id, def] of animationIndex.entries()) {\n    if (!def.targets) continue;\n    desired.push({\n      key: `standalone:${id}`,\n      preset: def.preset,\n      params: def.params || {},\n      targets: Array.isArray(def.targets) ? def.targets.slice() : [def.targets],\n      ref: id\n    });\n  }\n\n  return desired;\n}\n\nfunction groupRuleAnimOverrides(ruleAnims) {\n  const map = new Map();\n  (ruleAnims || []).forEach(a => {\n    if (!a.ref) return;\n    if (!map.has(a.ref)) map.set(a.ref, []);\n    map.get(a.ref).push(a);\n  });\n  // Sort each list by priority desc\n  map.forEach(list => list.sort((a, b) => (b.priority || 0) - (a.priority || 0)));\n  return map;\n}\n","import { deepMerge } from '../util/deepMerge.js';\n\nexport function resolveDesiredTimelines(timelineDefs = []) {\n  return timelineDefs.map(tl => {\n    const globals = { ...(tl.globals || {}) };\n    const steps = (tl.steps || []).map(s => ({\n      targets: s.targets,\n      preset: s.preset,\n      params: deepMerge({}, s.params || {}),\n      offset: s.offset\n    }));\n    return {\n      id: tl.id,\n      globals,\n      steps\n    };\n  });\n}\n","/**\n * Phase 2: Overlay introspection utilities\n * Provides overlay listing, highlighting, and geometry utilities\n */\n\nexport class MsdIntrospection {\n  static getOverlaysSvg(root) {\n    return root?.querySelector?.('#msd_svg_overlays svg') ||\n           root?.querySelector?.('#cblcars-msd-wrapper svg') || null;\n  }\n\n  static listOverlays(root) {\n    const out = [];\n    const svg = this.getOverlaysSvg(root);\n    if (!svg) return out;\n\n    // Get resolved model from new pipeline\n    const resolvedModel = root.__msdResolvedModel || {};\n    const overlaysById = new Map((resolvedModel.overlays || []).map(o => [o.id, o]));\n\n    // Find overlay elements\n    let nodes = Array.from(svg.querySelectorAll('[id][data-cblcars-root=\"true\"]'));\n    if (!nodes.length) {\n      // Fallback: find any elements with IDs, excluding debug layers\n      nodes = Array.from(svg.querySelectorAll('[id]'))\n        .filter(n => n.id && n.id !== 'cblcars-debug-layer' && n.id !== 'cblcars-highlight-layer');\n    }\n\n    for (const node of nodes) {\n      const id = node.id;\n      const overlay = overlaysById.get(id);\n      const bbox = this.getOverlayBBox(id, root);\n\n      out.push({\n        id,\n        type: overlay?.type || node.getAttribute?.('data-cblcars-type') || node.tagName?.toLowerCase() || 'unknown',\n        bbox,\n        hasErrors: false, // TODO: Integration with validation system\n        hasWarnings: false,\n        element: node,\n        config: overlay\n      });\n    }\n\n    return out;\n  }\n\n  static getOverlayBBox(id, root) {\n    if (!id || !root) return null;\n\n    // 1) Try SVG element getBBox\n    let el = root.getElementById?.(id);\n    if (el && typeof el.getBBox === 'function') {\n      try {\n        const gbb = el.getBBox();\n        if (gbb && Number.isFinite(gbb.width) && Number.isFinite(gbb.height)) {\n          return { x: gbb.x, y: gbb.y, w: gbb.width, h: gbb.height };\n        }\n      } catch (_) {}\n    }\n\n    // 2) Ribbon fallback: backdrop element\n    const backdrop = root.getElementById?.(`${id}_backdrop`);\n    if (backdrop && typeof backdrop.getBBox === 'function') {\n      try {\n        const bb2 = backdrop.getBBox();\n        if (bb2 && (bb2.width > 0 || bb2.height > 0)) {\n          return { x: bb2.x, y: bb2.y, w: bb2.width, h: bb2.height };\n        }\n      } catch (_) {}\n    }\n\n    // 3) Config fallback: compute from overlay position + size\n    const resolvedModel = root.__msdResolvedModel || {};\n    const overlay = resolvedModel.overlays?.find(o => o.id === id);\n    if (overlay && overlay.position && overlay.size) {\n      const anchors = resolvedModel.anchors || {};\n      const vb = resolvedModel.viewBox || [0, 0, 100, 100];\n      const pos = this.resolvePointFromConfig(overlay.position, anchors, vb);\n      const sz = this.resolveSizeFromConfig(overlay.size, vb);\n      if (pos && sz) {\n        return { x: pos[0], y: pos[1], w: sz.w, h: sz.h };\n      }\n    }\n\n    return null;\n  }\n\n  static highlight(ids, opts = {}) {\n    const idList = Array.isArray(ids) ? ids : [ids];\n    const root = opts.root;\n\n    // Require explicit root element - no document fallback\n    if (!root) {\n      console.warn('[MsdIntrospection] Root element required for highlighting');\n      return;\n    }\n\n    const svg = this.getOverlaysSvg(root);\n    if (!svg) {\n      console.warn('[MsdIntrospection] No SVG found for highlighting');\n      return;\n    }\n\n    const viewBox = this.getViewBox(root, svg) || [0, 0, 400, 200];\n    const color = opts.color || '#ffcc00';\n    const strokeWidth = Number.isFinite(opts.strokeWidth)\n      ? opts.strokeWidth\n      : Math.max(1.5, Math.round(viewBox[3] * 0.004));\n    const duration = Math.max(250, opts.duration || 1500);\n\n    // Use proper createElementNS from root's document\n    const doc = root.ownerDocument || root.document;\n    if (!doc || !doc.createElementNS) {\n      console.warn('[MsdIntrospection] createElementNS not available');\n      return;\n    }\n\n    // Ensure highlight layer exists\n    let highlightLayer = svg.querySelector('#cblcars-highlight-layer');\n    if (!highlightLayer) {\n      highlightLayer = doc.createElementNS('http://www.w3.org/2000/svg', 'g');\n      highlightLayer.setAttribute('id', 'cblcars-highlight-layer');\n      highlightLayer.style.pointerEvents = 'none';\n      svg.appendChild(highlightLayer);\n    }\n\n    // Clear existing highlights\n    highlightLayer.innerHTML = '';\n\n    // Create highlight rectangles\n    for (const id of idList) {\n      const bbox = this.getOverlayBBox(id, root);\n      if (bbox) {\n        const rect = doc.createElementNS('http://www.w3.org/2000/svg', 'rect');\n\n        rect.setAttribute('x', bbox.x);\n        rect.setAttribute('y', bbox.y);\n        rect.setAttribute('width', bbox.w);\n        rect.setAttribute('height', bbox.h);\n        rect.setAttribute('fill', 'none');\n        rect.setAttribute('stroke', color);\n        rect.setAttribute('stroke-width', strokeWidth);\n        rect.setAttribute('opacity', '0.9');\n\n        highlightLayer.appendChild(rect);\n      }\n    }\n\n    // Auto-clear after duration\n    setTimeout(() => {\n      if (highlightLayer && highlightLayer.parentNode) {\n        highlightLayer.innerHTML = '';\n      }\n    }, duration);\n  }\n\n  static getViewBox(root, svg) {\n    if (!svg) return null;\n\n    const viewBoxAttr = svg.getAttribute('viewBox');\n    if (viewBoxAttr) {\n      const parts = viewBoxAttr.split(/\\s+/).map(Number);\n      if (parts.length === 4) {\n        return parts;\n      }\n    }\n\n    return [0, 0, 400, 200]; // fallback\n  }\n\n  // Helper methods for point/size resolution\n  static resolvePointFromConfig(position, anchors = {}, viewBox = [0, 0, 400, 200]) {\n    const [minX, minY, vw, vh] = viewBox;\n    if (!position) return null;\n    if (typeof position === 'string' && anchors[position]) return anchors[position];\n    if (Array.isArray(position) && position.length === 2) {\n      const r = (v, axis) =>\n        typeof v === 'string' && v.trim().endsWith('%')\n          ? axis === 'x'\n            ? minX + (parseFloat(v) / 100) * vw\n            : minY + (parseFloat(v) / 100) * vh\n          : Number(v);\n      const x = r(position[0], 'x');\n      const y = r(position[1], 'y');\n      if (Number.isFinite(x) && Number.isFinite(y)) return [x, y];\n    }\n    return null;\n  }\n\n  static resolveSizeFromConfig(size, viewBox = [0, 0, 400, 200]) {\n    if (!Array.isArray(size) || size.length !== 2) return null;\n    const [, , vw, vh] = viewBox;\n    const toDim = (val, max) =>\n      typeof val === 'string' && val.trim().endsWith('%') ? (parseFloat(val) / 100) * max : Number(val);\n    const w = toDim(size[0], vw);\n    const h = toDim(size[1], vh);\n    if (!Number.isFinite(w) || !Number.isFinite(h)) return null;\n    return { w, h };\n  }\n}\n","import { perfTime } from '../perf/PerfCounters.js';\n\nexport async function buildCardModel(mergedConfig) {\n  return perfTime('cardModel.build', () => {\n    // Phase A: implement viewBox:auto + SVG anchor extraction + percent resolution.\n    const viewBox = [0, 0, 400, 200];\n    const anchors = {}; // merged + normalized numeric\n    const overlaysBase = mergedConfig.overlays.map(o => ({ id: o.id, type: o.type, style: o.style || {}, raw: o }));\n    return { viewBox, anchors, overlaysBase, __raw: mergedConfig };\n  });\n}\n","/**\n * Phase 4: Unified MSD API structure\n * Provides window.cblcars.msd.api namespace\n * MSD v1 is now the stable system - no feature flag needed\n */\n\nexport class MsdApi {\n  static attach() {\n    if (typeof window === 'undefined') return;\n\n    window.cblcars = window.cblcars || {};\n    window.cblcars.msd = window.cblcars.msd || {};\n\n    // Enhanced API structure with DebugManager integration\n    window.cblcars.msd.api = {\n      overlays: {\n        list: (root) => this.listOverlays(root),\n        highlight: (ids, opts) => this.highlightOverlays(ids, opts),\n        getBBox: (id, root) => this.getOverlayBBox(id, root),\n        update: (id, data) => this.updateOverlay(id, data)\n      },\n\n      anchors: {\n        list: () => this.listAnchors(),\n        get: (id) => this.getAnchor(id),\n        set: (id, x, y) => this.setAnchor(id, x, y),\n        dump: () => this.dumpAnchors()\n      },\n\n      debug: {\n        enable: (feature) => this.enableDebugFeature(feature),\n        disable: (feature) => this.disableDebugFeature(feature),\n        toggle: (feature) => this.toggleDebugFeature(feature),\n        setScale: (scale) => this.setDebugScale(scale),\n        status: () => this.getDebugStatus(),\n\n        // Legacy methods with deprecation warnings\n        showAnchors: () => {\n          console.warn('[MsdApi] debug.showAnchors deprecated, use debug.enable(\"anchors\")');\n          this.enableDebugFeature('anchors');\n        },\n        showOverlays: () => {\n          console.warn('[MsdApi] debug.showOverlays deprecated, use debug.enable(\"bounding_boxes\")');\n          this.enableDebugFeature('bounding_boxes');\n        },\n        clear: () => {\n          console.warn('[MsdApi] debug.clear deprecated, use debug.disable(\"all\")');\n          this.disableDebugFeature('all');\n        }\n      },\n\n      performance: {\n        dump: () => this.getPerformanceData(),\n        counters: () => this.getPerformanceData().counters || {},\n        timers: () => this.getPerformanceData().timers || {}\n      },\n\n      pipeline: {\n        getResolvedModel: () => this.getResolvedModel(),\n        reRender: () => this.reRender(),\n        validate: () => this.getValidationIssues()\n      }\n    };\n\n    // Backward compatibility aliases (temporary - remove after migration)\n    window.cblcars.msd.listOverlays = (root) => this.listOverlays(root);\n    window.cblcars.msd.listAnchors = () => this.listAnchors();\n    window.cblcars.msd.getOverlayBBox = (id, root) => this.getOverlayBBox(id, root);\n    window.cblcars.msd.highlight = (ids, opts) => this.highlightOverlays(ids, opts);\n  }\n\n  static getWindow() {\n    if (typeof window !== 'undefined') return window;\n    if (typeof global !== 'undefined' && global.window) return global.window;\n    return null;\n  }\n\n  static listOverlays(root) {\n    try {\n      // Try to use MsdIntrospection if available\n      const window = this.getWindow();\n      const MsdIntrospection = window?.MsdIntrospection;\n\n      if (MsdIntrospection && MsdIntrospection.listOverlays) {\n        return MsdIntrospection.listOverlays(root);\n      }\n\n      // Fallback implementation\n      const overlays = [];\n      const resolvedModel = this.getResolvedModel();\n\n      if (resolvedModel && resolvedModel.overlays) {\n        resolvedModel.overlays.forEach(overlay => {\n          overlays.push({\n            id: overlay.id,\n            type: overlay.type,\n            bbox: this.getOverlayBBox(overlay.id, root),\n            hasErrors: false,\n            hasWarnings: false\n          });\n        });\n      }\n\n      return overlays;\n    } catch (_) {\n      return [];\n    }\n  }\n\n  static listAnchors() {\n    try {\n      const resolvedModel = this.getResolvedModel();\n      return Object.keys(resolvedModel?.anchors || {});\n    } catch (_) {\n      return [];\n    }\n  }\n\n  static getAnchor(id) {\n    try {\n      const resolvedModel = this.getResolvedModel();\n      return resolvedModel?.anchors?.[id] || null;\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static dumpAnchors() {\n    try {\n      const resolvedModel = this.getResolvedModel();\n      return { ...resolvedModel?.anchors } || {};\n    } catch (_) {\n      return {};\n    }\n  }\n\n  static getOverlayBBox(id, root) {\n    try {\n      // Try to use MsdIntrospection if available\n      const window = this.getWindow();\n      const MsdIntrospection = window?.MsdIntrospection;\n\n      if (MsdIntrospection && MsdIntrospection.getOverlayBBox) {\n        return MsdIntrospection.getOverlayBBox(id, root);\n      }\n\n      // Fallback: basic bbox from config\n      const resolvedModel = this.getResolvedModel();\n      const overlay = resolvedModel?.overlays?.find(o => o.id === id);\n\n      if (overlay && overlay.position && overlay.size) {\n        const pos = Array.isArray(overlay.position) ? overlay.position : [0, 0];\n        const size = Array.isArray(overlay.size) ? overlay.size : [100, 50];\n\n        return {\n          x: Number(pos[0]) || 0,\n          y: Number(pos[1]) || 0,\n          w: Number(size[0]) || 100,\n          h: Number(size[1]) || 50\n        };\n      }\n\n      return null;\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static highlightOverlays(ids, opts) {\n    try {\n      // Try to use MsdIntrospection if available\n      const window = this.getWindow();\n      const MsdIntrospection = window?.MsdIntrospection;\n\n      if (MsdIntrospection && MsdIntrospection.highlight) {\n        return MsdIntrospection.highlight(ids, opts);\n      }\n\n      // Fallback: log highlight request\n      console.log('[MSD API] Highlight request:', ids, opts);\n    } catch (_) {}\n  }\n\n  static getResolvedModel() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.pipelineInstance?.getResolvedModel?.() || null;\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static getPerformanceData() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.getPerf?.() || { timers: {}, counters: {} };\n    } catch (_) {\n      return { timers: {}, counters: {} };\n    }\n  }\n\n  static getValidationIssues() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.validation?.issues?.() || [];\n    } catch (_) {\n      return [];\n    }\n  }\n\n  static setDebugFlag(flag, value) {\n    try {\n      const window = this.getWindow();\n      window.cblcars = window.cblcars || {};\n      window.cblcars._debugFlags = window.cblcars._debugFlags || {};\n      window.cblcars._debugFlags[flag] = value;\n    } catch (_) {}\n  }\n\n  static clearDebugFlags() {\n    try {\n      const window = this.getWindow();\n      window.cblcars = window.cblcars || {};\n      window.cblcars._debugFlags = {\n        overlay: false,\n        connectors: false,\n        geometry: false\n      };\n    } catch (_) {}\n  }\n\n  static updateOverlay(id, data) {\n    // Future: Dynamic overlay updates\n    console.warn('[MSD API] Dynamic overlay updates not yet implemented');\n    return false;\n  }\n\n  static setAnchor(id, x, y) {\n    try {\n      const window = this.getWindow();\n      const result = window?.__msdDebug?.pipelineInstance?.setAnchor?.(id, [x, y]);\n      return result || { id, position: [x, y] };\n    } catch (_) {\n      return null;\n    }\n  }\n\n  static reRender() {\n    try {\n      const window = this.getWindow();\n      return window?.__msdDebug?.pipelineInstance?.reRender?.() || { success: false };\n    } catch (_) {\n      return { success: false };\n    }\n  }\n\n  static enableDebugFeature(feature) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      if (feature === 'all') {\n        debugManager.enableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.enable(feature);\n      }\n    }\n  }\n\n  static disableDebugFeature(feature) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      if (feature === 'all') {\n        debugManager.disableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.disable(feature);\n      }\n    }\n  }\n\n  static toggleDebugFeature(feature) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      debugManager.toggle(feature);\n    }\n  }\n\n  static setDebugScale(scale) {\n    const debugManager = this.getDebugManager();\n    if (debugManager) {\n      debugManager.setScale(scale);\n    }\n  }\n\n  static getDebugStatus() {\n    const debugManager = this.getDebugManager();\n    return debugManager ? debugManager.getSnapshot() : { error: 'DebugManager not available' };\n  }\n\n  static getDebugManager() {\n    const window = this.getWindow();\n    return window?.__msdDebug?.debugManager ||\n           window?.__msdDebug?.pipelineInstance?.systemsManager?.debugManager;\n  }\n}\n\n","import { stableStringify } from '../util/stableStringify.js';\n\nfunction stripMeta(item) {\n  if (!item || typeof item !== 'object') return item;\n  const { __meta, ...rest } = item;\n  return rest;\n}\n\nexport function exportCollapsed(merged) {\n  const raw = merged.__raw_msd || {};\n  // User-origin items only (origin_pack === 'user')\n  function userItems(col) {\n    return (merged[col] || [])\n      .filter(i => i.__meta?.origin_pack === 'user' && !i.__meta.removed)\n      .map(stripMeta);\n  }\n  const out = {\n    msd: {\n      version: raw.version || 1,\n      base_svg: raw.base_svg,\n      view_box: raw.view_box,\n      use_packs: raw.use_packs,\n      anchors: raw.anchors,\n      palettes: raw.palettes,\n      remove: raw.remove,\n      profiles: userItems('profiles'),\n      animations: userItems('animations'),\n      timelines: userItems('timelines'),\n      overlays: userItems('overlays'),\n      rules: userItems('rules'),\n      routing: raw.routing,\n      active_profiles: raw.active_profiles,\n      hud: raw.hud\n    }\n  };\n  // Prune empty/null keys\n  Object.keys(out.msd).forEach(k => {\n    if (out.msd[k] == null) delete out.msd[k];\n    else if (Array.isArray(out.msd[k]) && !out.msd[k].length) delete out.msd[k];\n    else if (typeof out.msd[k] === 'object' && !Array.isArray(out.msd[k]) && !Object.keys(out.msd[k]).length) delete out.msd[k];\n  });\n  return out;\n}\n\nexport function exportCollapsedJson(merged, pretty = true) {\n  return pretty ? JSON.stringify(exportCollapsed(merged), null, 2) : stableStringify(exportCollapsed(merged));\n}\n","import { stableStringify } from '../util/stableStringify.js';\n\nfunction stripMeta(item, includeMeta) {\n  if (includeMeta) return item;\n  if (!item || typeof item !== 'object') return item;\n  const { __meta, ...rest } = item;\n  return rest;\n}\n\nexport function exportFullSnapshot(merged, opts = {}) {\n  const include_meta = !!opts.include_meta;\n  function all(col) {\n    return (merged[col] || [])\n      .filter(i => !i.__meta?.removed)\n      .map(i => stripMeta(i, include_meta));\n  }\n  return {\n    msd: {\n      version: (merged.__raw_msd && merged.__raw_msd.version) || 1,\n      base_svg: merged.__raw_msd?.base_svg,\n      view_box: merged.__raw_msd?.view_box,\n      use_packs: merged.__raw_msd?.use_packs,\n      anchors: merged.__raw_msd?.anchors,\n      palettes: merged.palettes,\n      remove: merged.__raw_msd?.remove,\n      profiles: all('profiles'),\n      animations: all('animations'),\n      timelines: all('timelines'),\n      overlays: all('overlays'),\n      rules: all('rules'),\n      routing: merged.routing,\n      active_profiles: merged.active_profiles,\n      hud: merged.hud,\n      __provenance: include_meta ? merged.__provenance : undefined,\n      __issues: include_meta ? merged.__issues : undefined\n    }\n  };\n}\n\nexport function exportFullSnapshotJson(merged, opts = {}, pretty = true) {\n  return pretty ? JSON.stringify(exportFullSnapshot(merged, opts), null, 2) : stableStringify(exportFullSnapshot(merged, opts));\n}\n","import { stableStringify } from '../util/stableStringify.js';\n\nexport function diffItem(merged, collection, id) {\n  const chain = merged.__provenance?.[collection]?.[id];\n  if (!chain) return { id, collection, chain: [], final: null, removed: false };\n  const items = (merged[collection] || []).filter(i => i.id === id);\n  const final = items.length ? items[items.length - 1] : null;\n  return {\n    id,\n    collection,\n    chain,\n    removed: chain.some(c => c.removed),\n    final_summary: final ? summarize(final) : null,\n    chain_summaries: chain.map(s => ({\n      layer: s.layer_id,\n      overridden: s.overridden,\n      removed: s.removed,\n      checksum: s.checksum,\n      diff: s.diff\n    }))\n  };\n}\n\nfunction summarize(item) {\n  if (!item) return null;\n  const copy = { ...item };\n  delete copy.__meta;\n  return JSON.parse(stableStringify(copy));\n}\n","export function stableStringify(value) {\n  const seen = new WeakSet();\n  function walk(v) {\n    if (v === null || typeof v !== 'object') return JSON.stringify(v);\n    if (seen.has(v)) return '\"[Circular]\"';\n    seen.add(v);\n    if (Array.isArray(v)) return '[' + v.map(walk).join(',') + ']';\n    const keys = Object.keys(v).sort();\n    return '{' + keys.map(k => JSON.stringify(k) + ':' + walk(v[k])).join(',') + '}';\n  }\n  return walk(value);\n}\n","import { processAndValidateConfig } from './ConfigProcessor.js';\nimport { SystemsManager } from './SystemsManager.js';\nimport { ModelBuilder } from './ModelBuilder.js';\nimport { setupDebugInterface } from '../debug/DebugInterface.js';\nimport { buildCardModel } from '../model/CardModel.js';\nimport { MsdApi } from '../api/MsdApi.js';\nimport { exportCollapsed, exportCollapsedJson } from '../export/exportCollapsed.js';\nimport { exportFullSnapshot, exportFullSnapshotJson } from '../export/exportFullSnapshot.js';\nimport { diffItem } from '../export/diffItem.js';\nimport { perfGetAll } from '../perf/PerfCounters.js';\n\n/**\n * Initialize the MSD processing/rendering pipeline.\n * Handles config merge/validation, system initialization, initial render,\n * debug interface binding, and exposes a unified pipeline API.\n *\n * @param {Object} userMsdConfig - User supplied MSD config.\n * @param {HTMLElement|ShadowRoot} mountEl - Mount/root element (may be a shadowRoot).\n * @param {Object|null} hass - Home Assistant instance (if available).\n * @returns {Promise<Object>} Pipeline API\n */\nexport async function initMsdPipeline(userMsdConfig, mountEl, hass = null) {\n  // Process and validate configuration\n  const { mergedConfig, issues, provenance } = await processAndValidateConfig(userMsdConfig);\n\n  // Handle validation errors\n  if (issues.errors.length) {\n    console.error('[MSD v1] Validation errors – pipeline disabled', issues.errors);\n    return createDisabledPipeline(mergedConfig, issues, provenance);\n  }\n\n  // Build card model\n  const cardModel = await buildCardModel(mergedConfig);\n\n  // Ensure anchors are available\n  if (!cardModel.anchors) cardModel.anchors = {};\n  if (!Object.keys(cardModel.anchors).length) {\n    if (mergedConfig.anchors && Object.keys(mergedConfig.anchors).length) {\n      cardModel.anchors = { ...mergedConfig.anchors };\n      console.info('[MSD v1] Adopted user anchors');\n    }\n  }\n\n  // Initialize all systems\n  const systemsManager = new SystemsManager();\n  await systemsManager.initializeSystems(mergedConfig, cardModel, mountEl, hass);\n\n  // ADDED: Set original HASS for clean controls separation\n  if (hass) {\n      systemsManager.setOriginalHass(hass);\n  }\n\n  // Connect DebugManager to window.__msdDebug early for console access\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.debugManager = systemsManager.debugManager;\n    window.__msdDebug.routing = systemsManager.router;\n  }\n\n  // EARLY DEBUG BOOTSTRAP (Before first render):\n  // Provide a minimal __msdDebug object so debug renderers that run during the first render\n  // can access routing / perf safely. This prevents timing race warnings for routing guides.\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    // Only set if not already present to avoid clobbering previous instrumentation\n    if (!window.__msdDebug.routing) {\n      window.__msdDebug.routing = systemsManager.router;\n    }\n    if (!window.__msdDebug.getPerf) {\n      window.__msdDebug.getPerf = () => perfGetAll();\n    }\n    if (!window.__msdDebug.systemsManager) {\n      window.__msdDebug.systemsManager = systemsManager;\n    }\n    // Dispatch an event so listeners (e.g., MsdDebugRenderer) can react when routing is ready.\n    try {\n      window.dispatchEvent(new CustomEvent('msd-routing-ready'));\n    } catch (e) {\n      // Non-fatal; older browsers or sandbox contexts might block custom events.\n    }\n  }\n\n  // Initialize model builder\n  const modelBuilder = new ModelBuilder(mergedConfig, cardModel, systemsManager);\n\n  /**\n   * Internal re-render function that recomputes the model\n   * and triggers the AdvancedRenderer + debug visualization pipeline.\n   * @returns {Object|undefined} Renderer result object\n   */\n  async function reRender() {\n    console.log('[MSD DEBUG] 🔄 reRender() ENTRY', {\n      timestamp: new Date().toISOString(),\n      renderInProgress: systemsManager._renderInProgress,\n      stackTrace: new Error().stack.split('\\n').slice(1, 4).join('\\n')\n    });\n\n    // ADDED: Prevent re-entrant renders\n    if (systemsManager._renderInProgress) {\n      console.log('[MSD DEBUG] ⚠️ reRender() SKIPPED - already in progress');\n      return { success: false, reason: 'render_in_progress' };\n    }\n\n    systemsManager._renderInProgress = true;\n\n    try {\n      console.log('[MSD DEBUG] 📊 Computing resolved model...');\n      const startTime = performance.now();\n      const resolvedModel = modelBuilder.computeResolvedModel();\n\n      console.log('[MSD DEBUG] ✅ Resolved model computed:', {\n        overlayCount: resolvedModel.overlays.length,\n        controlOverlays: resolvedModel.overlays.filter(o => o.type === 'control').length,\n        hasAnchors: !!resolvedModel.anchors,\n        hasViewBox: !!resolvedModel.viewBox\n      });\n\n      console.log(`[MSD DEBUG] 🎨 Starting AdvancedRenderer.render() - overlays: ${resolvedModel.overlays.length}`);\n\n      // ADDED: Defensive rendering with error boundary\n      let renderResult;\n      try {\n        renderResult = systemsManager.renderer.render(resolvedModel);\n        console.log('[MSD DEBUG] ✅ AdvancedRenderer.render() completed successfully:', renderResult);\n      } catch (renderError) {\n        console.error('[MSD DEBUG] ❌ AdvancedRenderer.render() FAILED:', renderError);\n        console.error('[MSD DEBUG] ❌ Render error stack:', renderError.stack);\n        return { success: false, error: renderError.message, phase: 'advanced_renderer' };\n      }\n\n      console.log('[MSD DEBUG] 🎮 Starting renderDebugAndControls()...');\n      // CHANGED: Make debug and controls rendering more defensive\n      try {\n        await systemsManager.renderDebugAndControls(resolvedModel, mountEl);\n        console.log('[MSD DEBUG] ✅ renderDebugAndControls() completed successfully');\n      } catch (debugControlsError) {\n        console.error('[MSD DEBUG] ❌ renderDebugAndControls() FAILED:', debugControlsError);\n        console.error('[MSD DEBUG] ❌ Debug/Controls error stack:', debugControlsError.stack);\n        // Don't fail the entire render - just log the error\n        console.warn('[MSD DEBUG] ⚠️ Continuing without debug/controls rendering due to error');\n      }\n\n      const renderTime = performance.now() - startTime;\n      console.log(`[MSD DEBUG] ✅ reRender() COMPLETED in ${renderTime.toFixed(2)}ms`);\n\n      return renderResult || { success: true };\n\n    } catch (error) {\n      console.error('[MSD DEBUG] ❌ reRender() COMPLETELY FAILED:', error);\n      console.error('[MSD DEBUG] ❌ Complete failure stack:', error.stack);\n      return { success: false, error: error.message };\n    } finally {\n      systemsManager._renderInProgress = false;\n      console.log('[MSD DEBUG] 🏁 reRender() FINALLY block - _renderInProgress reset to false');\n    }\n  }\n\n  // Connect reRender callback to systems\n  systemsManager.setReRenderCallback(reRender);\n\n  // Initial render - CHANGED: Make async\n  console.log('[MSD v1] Computing initial resolved model');\n  console.log('[MSD v1] DataSourceManager status:', {\n    sourcesCount: systemsManager.dataSourceManager?.getAllSources?.()?.length || 0,\n    entityCount: systemsManager.dataSourceManager?.listIds?.()?.length || 0\n  });\n\n  const initialRenderResult = await reRender();\n\n  console.log('[MSD v1] Initial render completed:', {\n    overlayCount: initialRenderResult?.overlayCount || 0,\n    errors: initialRenderResult?.errors || 0\n  });\n\n  // Create pipeline API\n  const pipelineApi = createPipelineApi(\n    mergedConfig, cardModel, systemsManager, modelBuilder, reRender\n  );\n\n  // Setup debug interface with DebugManager integration\n  setupDebugInterface(pipelineApi, mergedConfig, provenance, systemsManager, modelBuilder);\n\n  // Initialize HUD service with mount element\n  if (typeof window !== 'undefined' && window.__msdDebug?.hud?.setMountElement) {\n    window.__msdDebug.hud.setMountElement(mountEl);\n  }\n\n  // Attach unified API\n  console.log('[MSD v1] Attaching unified API');\n  MsdApi.attach();\n\n  // Augment debug tracking (now that pipelineApi exists)\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.validation = { issues: () => mergedConfig.__issues };\n    window.__msdDebug.pipelineInstance = pipelineApi;\n    window.__msdDebug._provenance = provenance;\n\n    // Ensure routing reference is consistent (in case late changes happened)\n    if (!window.__msdDebug.routing) {\n      window.__msdDebug.routing = systemsManager.router;\n      try {\n        window.dispatchEvent(new CustomEvent('msd-routing-ready'));\n      } catch(_) {}\n    }\n  }\n\n  console.log('[MSD v1] Pipeline initialization complete');\n  return pipelineApi;\n}\n\nfunction createDisabledPipeline(mergedConfig, issues, provenance) {\n  const disabledPipeline = {\n    enabled: false,\n    errors: issues.errors,\n    warnings: issues.warnings,\n    getResolvedModel: () => null,\n    ingestHass: () => {},\n    updateEntities: () => {},\n    listEntities: () => [],\n    getEntity: () => null,\n    getActiveProfiles: () => [],\n    getAnchors: () => (mergedConfig.anchors || {}),\n    repairAnchorsFromMerged: () => false,\n    exportCollapsed: () => null,\n    exportCollapsedJson: () => 'null',\n    exportFullSnapshot: () => null,\n    exportFullSnapshotJson: () => 'null',\n    diffItem: () => null,\n    getPerf: () => ({})\n  };\n\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug.validation = { issues: () => mergedConfig.__issues };\n    window.__msdDebug.pipelineInstance = disabledPipeline;\n    window.__msdDebug._provenance = provenance;\n  }\n  return disabledPipeline;\n}\n\n/**\n * Creates and returns the MSD pipeline external API.\n * @param {Object} mergedConfig\n * @param {Object} cardModel\n * @param {SystemsManager} systemsManager\n * @param {ModelBuilder} modelBuilder\n * @param {Function} reRender\n * @returns {Object} API\n */\nfunction createPipelineApi(mergedConfig, cardModel, systemsManager, modelBuilder, reRender) {\n  const api = {\n    enabled: true,\n    version: mergedConfig.version || 1,\n    config: mergedConfig,\n\n    // Core systems\n    systemsManager,\n    dataSourceManager: systemsManager.dataSourceManager,\n    rulesEngine: systemsManager.rulesEngine,\n    renderer: systemsManager.renderer,\n    router: systemsManager.router,\n\n    /**\n     * Inspect routing for a given overlay id and compute path data.\n     * @param {string} id\n     * @returns {Object|null}\n     */\n    routingInspect: (id) => {\n      const resolvedModel = modelBuilder.getResolvedModel();\n      const ov = (resolvedModel?.overlays || []).find(o => o.id === id);\n      if (!ov) return null;\n      const raw = ov._raw || ov.raw || {};\n      const a1 = cardModel.anchors[raw.anchor];\n      const a2 = cardModel.anchors[raw.attach_to] || cardModel.anchors[raw.attachTo];\n      if (!a1 || !a2) return null;\n      const req = systemsManager.router.buildRouteRequest(ov, a1, a2);\n      return systemsManager.router.computePath(req);\n    },\n\n    getResolvedModel: () => modelBuilder.getResolvedModel(),\n\n    /**\n     * Force a manual re-render.\n     */\n    reRender: () => {\n      try {\n        console.log('[MSD v1] Manual re-render triggered');\n        return reRender();\n      } catch (error) {\n        console.error('[MSD v1] Manual re-render failed:', error);\n        return { success: false, error: error.message };\n      }\n    },\n\n    /**\n     * Set or update an anchor point.\n     * @param {string} id\n     * @param {Array<number>} pt\n     * @returns {boolean}\n     */\n    setAnchor(id, pt) {\n      if (!id || !Array.isArray(pt) || pt.length !== 2) return false;\n      if (!cardModel.anchors) cardModel.anchors = {};\n      cardModel.anchors[id] = [Number(pt[0]), Number(pt[1])];\n      const resolvedModel = modelBuilder.getResolvedModel();\n      if (resolvedModel?.anchors) resolvedModel.anchors[id] = cardModel.anchors[id];\n      systemsManager.router.invalidate && systemsManager.router.invalidate('*');\n      try {\n        if (systemsManager.renderer && resolvedModel) {\n          systemsManager.renderer._routerOverlaySync = false;\n          systemsManager.renderer.render(resolvedModel);\n        }\n      } catch(_) {}\n      return true;\n    },\n\n    ingestHass: (hass) => systemsManager.ingestHass(hass),\n    updateEntities: (map) => systemsManager.updateEntities(map),\n    listEntities: () => systemsManager.entityRuntime.listIds(),\n    getEntity: (id) => systemsManager.entityRuntime.getEntity(id),\n    getActiveProfiles: () => modelBuilder.runtimeActiveProfiles.slice(),\n    getAnchors: () => ({ ...cardModel.anchors }),\n    exportCollapsed: () => exportCollapsed(userMsdConfig),\n    exportCollapsedJson: () => JSON.stringify(exportCollapsed(userMsdConfig)),\n    exportFullSnapshot: () => exportFullSnapshot(mergedConfig),\n    exportFullSnapshotJson: () => JSON.stringify(exportFullSnapshot(mergedConfig)),\n    diffItem: (item) => diffItem(item),\n    getPerf: () => perfGetAll(),\n\n    // Add debug API powered by DebugManager\n    debug: {\n      enable: (feature) => systemsManager.debugManager.enable(feature),\n      disable: (feature) => systemsManager.debugManager.disable(feature),\n      toggle: (feature) => systemsManager.debugManager.toggle(feature),\n      setScale: (scale) => systemsManager.debugManager.setScale(scale),\n      status: () => systemsManager.debugManager.getSnapshot(),\n      onChange: (callback) => systemsManager.debugManager.onChange(callback)\n    },\n\n    getDataSourceManager: () => systemsManager.dataSourceManager,\n    _reRenderCallback: reRender\n  };\n\n  return api;\n}\n\n/**\n * Initialize Heads-Up Display (HUD) controller.\n * @param {Object} pipeline\n * @param {HTMLElement|ShadowRoot} mountEl\n * @returns {Promise<void>|null}\n */\nexport function initMsdHud(pipeline, mountEl) {\n  if (!pipeline?.enabled) return null;\n  import('../hud/HudController.js').then(mod => {\n    const hud = new mod.HudController(pipeline, mountEl);\n    hud.refresh();\n    if (window.__msdDebug) {\n      window.__msdDebug.hud = {\n        refresh: () => hud.refresh(),\n        hud\n      };\n    }\n  }).catch(err => {\n    console.warn('[MSD v1] HudController import failed:', err);\n  });\n}","import { mergePacks } from '../packs/mergePacks.js';\nimport { validateMerged } from '../validation/validateMerged.js';\n\nexport { mergePacks, validateMerged };\n\nexport async function processAndValidateConfig(userMsdConfig) {\n  const mergedConfig = await mergePacks(userMsdConfig);\n  const provenance = mergedConfig.__provenance;\n\n  // Store original user config in debug namespace\n  if (typeof window !== 'undefined') {\n    window.__msdDebug = window.__msdDebug || {};\n    window.__msdDebug._originalUserConfig = userMsdConfig;\n  }\n\n  // Validation pass\n  const t0 = performance.now();\n  const issues = validateMerged(mergedConfig);\n  mergedConfig.__issues = issues;\n  const t1 = performance.now();\n  try { window.__msdDebug && (window.__msdDebug._validationMs = (t1 - t0)); } catch {}\n\n  // Anchor validation - UPDATED to accept overlay IDs as virtual anchors\n  try {\n    const existingCodes = new Set(issues.errors.map(e=>e.code));\n    const anchorSet = new Set(Object.keys(mergedConfig.anchors || {}));\n\n    // Add overlay IDs as valid anchor targets (same as in validateMerged)\n    const overlayIds = new Set();\n    (mergedConfig.overlays || []).forEach(overlay => {\n      if (overlay && overlay.id) {\n        overlayIds.add(overlay.id);\n        anchorSet.add(overlay.id); // Make overlay IDs valid anchor targets\n      }\n    });\n\n    (mergedConfig.overlays || []).forEach(o=>{\n      if (!o || !o.id) return;\n      const aRefs = [];\n      if (typeof o.anchor === 'string') aRefs.push(o.anchor);\n      if (typeof o.attach_to === 'string') aRefs.push(o.attach_to);\n      if (typeof o.attachTo === 'string') aRefs.push(o.attachTo);\n      aRefs.forEach(ref=>{\n        if (ref && !anchorSet.has(ref)) {\n          const code = 'anchor.missing';\n          if (!existingCodes.has(`${code}:${ref}:${o.id}`)) {\n            issues.errors.push({ code, severity:'error', overlay:o.id, anchor:ref, msg:`Overlay ${o.id} references missing anchor '${ref}'` });\n            existingCodes.add(`${code}:${ref}:${o.id}`);\n          }\n        }\n      });\n    });\n  } catch(_) {}\n\n  return { mergedConfig, issues, provenance };\n}\n\nexport async function processMsdConfig(userMsdConfig) {\n  try {\n    const preValidation = validateMerged(userMsdConfig);\n    const mergedConfig = await mergePacks(userMsdConfig);\n    const postValidation = validateMerged(mergedConfig);\n\n    const issues = {\n      errors: [...preValidation.errors, ...postValidation.errors],\n      warnings: [...preValidation.warnings, ...postValidation.warnings]\n    };\n\n    if (issues.errors.length > 0) {\n      console.error('MSD validation errors:', issues.errors);\n    }\n\n    if (issues.warnings.length > 0) {\n      console.warn('MSD validation warnings:', issues.warnings);\n    }\n\n    return {\n      config: mergedConfig,\n      validation: issues\n    };\n\n  } catch (error) {\n    console.error('MSD processing failed:', error);\n    throw error;\n  }\n}\n","import { perfGetAll } from '../perf/PerfCounters.js';\nimport { MsdIntrospection } from '../introspection/MsdIntrospection.js';\n\nexport function setupDebugInterface(pipelineApi, mergedConfig, provenance, systemsManager, modelBuilder) {\n  if (typeof window === 'undefined') return;\n\n  const dbg = window.__msdDebug = window.__msdDebug || {};\n\n  // Extract debug config from mergedConfig\n  const debugConfig = mergedConfig?.debug || {};\n\n  // REDUCED: Minimal startup logging\n  console.log('[MSD v1] Debug interface ready - type window.__msdDebug.help() for usage');\n\n  // Core pipeline access - UNIFIED: Only set pipelineInstance\n  dbg.pipelineInstance = pipelineApi;\n\n  // Add backward compatibility getter with deprecation warning\n  if (!dbg.hasOwnProperty('pipeline')) {\n    Object.defineProperty(dbg, 'pipeline', {\n      get() {\n        console.warn('[MSD Debug] window.__msdDebug.pipeline is deprecated. Use window.__msdDebug.pipelineInstance instead.');\n        return this.pipelineInstance;\n      },\n      configurable: true\n    });\n  }\n\n  dbg._provenance = provenance;\n\n  // Routing system\n  setupRoutingDebugInterface(dbg, pipelineApi, systemsManager);\n\n  // Data sources - our current entity management system\n  setupDataSourceDebugInterface(dbg, systemsManager);\n\n  // Rendering and debug visualization - now with config control\n  setupRenderingDebugInterface(dbg, systemsManager, modelBuilder, pipelineApi, debugConfig);\n\n  // Performance and validation\n  setupUtilityDebugInterface(dbg, mergedConfig, systemsManager);\n\n  console.log('[MSD v1] Debug interface setup complete');\n  console.log('[MSD v1] Available methods:', Object.keys(dbg));\n\n  // Log debug config state (REDUCED)\n  if (debugConfig.enabled) {\n    console.log('[MSD v1] Debug mode enabled');\n  }\n}\n\n// ...existing code...\n\nfunction setupRoutingDebugInterface(dbg, pipelineApi, systemsManager) {\n  dbg.routing = {\n    inspect: (id) => pipelineApi.routingInspect(id),\n    invalidate: (id='*') => systemsManager.router.invalidate(id),\n    stats: () => {\n      try {\n        return systemsManager.router.stats?.() || { cacheHits: 0, pathsComputed: 0, invalidations: 0 };\n      } catch (e) {\n        console.warn('[MSD v1] routing.stats failed:', e);\n        return { cacheHits: 0, pathsComputed: 0, invalidations: 0, error: e.message };\n      }\n    },\n    inspectAs: (id, modeFull='smart') => {\n      try {\n        const model = pipelineApi.getResolvedModel?.();\n        if (!model) return null;\n        const ov = model.overlays.find(o => o.id === id);\n        if (!ov) return null;\n        ov._raw = ov._raw || {};\n        const original = ov._raw.route_mode_full;\n        ov._raw.route_mode_full = modeFull;\n        systemsManager.router.invalidate && systemsManager.router.invalidate('*');\n        const res = dbg.routing.inspect(id);\n        ov._raw.route_mode_full = original;\n        systemsManager.router.invalidate && systemsManager.router.invalidate('*');\n        return res;\n      } catch (e) {\n        console.warn('[MSD v1] inspectAs failed', e);\n        return null;\n      }\n    }\n  };\n}\n\nfunction setupDataSourceDebugInterface(dbg, systemsManager) {\n  // ENHANCED: Make this the primary entity access system\n  if (!dbg.hasOwnProperty('dataSources')) {\n    dbg.dataSources = {\n      stats: () => systemsManager.dataSourceManager?.getStats() || { error: 'DataSourceManager not initialized' },\n      list: () => systemsManager.dataSourceManager ? Array.from(systemsManager.dataSourceManager.sources.keys()) : [],\n      get: (name) => systemsManager.dataSourceManager?.getSource(name)?.getStats() || null,\n      dump: () => systemsManager.dataSourceManager?.debugDump() || { error: 'DataSourceManager not initialized' },\n      manager: () => systemsManager.dataSourceManager\n    };\n  } else {\n    // If dataSources already exists (from index.js getter), enhance it with additional methods\n    try {\n      Object.assign(dbg.dataSources, {\n        list: () => systemsManager.dataSourceManager ? Array.from(systemsManager.dataSourceManager.sources.keys()) : [],\n        get: (name) => systemsManager.dataSourceManager?.getSource(name)?.getStats() || null,\n        dump: () => systemsManager.dataSourceManager?.debugDump() || { error: 'DataSourceManager not initialized' }\n      });\n    } catch (error) {\n      // If we can't enhance it (getter-only), create alternative access\n      dbg.dataSourcesDebug = {\n        stats: () => systemsManager.dataSourceManager?.getStats() || { error: 'DataSourceManager not initialized' },\n        list: () => systemsManager.dataSourceManager ? Array.from(systemsManager.dataSourceManager.sources.keys()) : [],\n        get: (name) => systemsManager.dataSourceManager?.getSource(name)?.getStats() || null,\n        dump: () => systemsManager.dataSourceManager?.debugDump() || { error: 'DataSourceManager not initialized' },\n        manager: () => systemsManager.dataSourceManager\n      };\n      console.log('[DebugInterface] Created dataSourcesDebug as alternative access due to getter conflict');\n    }\n  }\n\n  // ADDED: Legacy compatibility layer for any remaining entity access patterns\n  // This provides entity-like access through DataSourceManager\n  dbg.entities = {\n    list: () => {\n      console.warn('[MSD Debug] entities.list() is deprecated. Use window.__msdDebug.dataSourceManager.listIds() instead.');\n      return systemsManager.dataSourceManager?.listIds() || [];\n    },\n    get: (id) => {\n      console.warn('[MSD Debug] entities.get() is deprecated. Use window.__msdDebug.dataSourceManager.getEntity() instead.');\n      return systemsManager.dataSourceManager?.getEntity(id) || null;\n    },\n    stats: () => {\n      console.warn('[MSD Debug] entities.stats() is deprecated. Use window.__msdDebug.dataSources.stats() instead.');\n      const dsStats = systemsManager.dataSourceManager?.getStats() || {};\n      const entityCount = systemsManager.dataSourceManager?.listIds()?.length || 0;\n\n      // Transform DataSourceManager stats to legacy format for compatibility\n      return {\n        count: entityCount,\n        subscribed: Object.keys(dsStats.sources || {}).length,\n        updated: Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.received || 0), 0),\n        cacheHits: Object.values(dsStats.sources || {}).reduce((sum, source) => sum + (source.cacheHits || 0), 0)\n      };\n    }\n  };\n}\n\nfunction setupRenderingDebugInterface(dbg, systemsManager, modelBuilder, pipelineApi, debugConfig) {\n  // REDUCED: Minimal setup logging\n  const debugManager = systemsManager.debugManager;\n\n  // Enhanced debug object powered by DebugManager\n  dbg.debug = {\n    // Core feature control methods using DebugManager\n    enable: (feature) => {\n      if (feature === 'all') {\n        debugManager.enableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.enable(feature);\n      }\n\n      // FIXED: More aggressive re-render after enabling with proper timing\n      setTimeout(() => {\n        try {\n          const pipelineInstance = window.__msdDebug?.pipelineInstance;\n          if (pipelineInstance?.reRender) {\n            console.log('[MSD Debug] Force re-render after enable:', feature);\n            pipelineInstance.reRender();\n          }\n        } catch (error) {\n          console.warn('[MSD Debug] Failed to trigger re-render:', error);\n        }\n      }, 10);\n    },\n\n    disable: (feature) => {\n      if (feature === 'all') {\n        debugManager.disableMultiple(['anchors', 'bounding_boxes', 'routing', 'performance']);\n      } else {\n        debugManager.disable(feature);\n      }\n\n      // FIXED: More aggressive re-render after disabling with proper timing\n      setTimeout(() => {\n        try {\n          const pipelineInstance = window.__msdDebug?.pipelineInstance;\n          if (pipelineInstance?.reRender) {\n            console.log('[MSD Debug] Force re-render after disable:', feature);\n            pipelineInstance.reRender();\n          }\n        } catch (error) {\n          console.warn('[MSD Debug] Failed to trigger re-render:', error);\n        }\n      }, 10);\n    },\n\n    // Manual debug render test\n    testRender: () => {\n      console.log('[MSD Debug] Testing debug render directly...');\n      try {\n        const debugState = debugManager.getSnapshot();\n        console.log('[MSD Debug] Current state:', debugState);\n\n        // Get pipeline instance to access the shadowRoot context\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (!pipelineInstance) {\n          console.warn('[MSD Debug] No pipeline instance available');\n          return;\n        }\n\n        // Try to get the shadowRoot from the systems manager\n        const systemsManager = pipelineInstance.systemsManager;\n        if (!systemsManager) {\n          console.warn('[MSD Debug] No systems manager available');\n          return;\n        }\n\n        // Use the renderer's mount element (shadowRoot)\n        const mountEl = systemsManager.renderer?.mountEl;\n        if (!mountEl) {\n          console.warn('[MSD Debug] No mount element found in renderer');\n          return;\n        }\n\n        console.log('[MSD Debug] Found mount element:', mountEl.constructor.name);\n\n        // Get resolved model for proper context\n        const resolvedModel = pipelineInstance.getResolvedModel();\n        if (!resolvedModel) {\n          console.warn('[MSD Debug] No resolved model available');\n          return;\n        }\n\n        console.log('[MSD Debug] Calling renderDebugAndControls with shadowRoot context');\n        systemsManager.renderDebugAndControls(resolvedModel, mountEl);\n\n      } catch (error) {\n        console.error('[MSD Debug] testRender failed:', error);\n      }\n    },\n\n    // Scale control via DebugManager\n    setScale: (scale) => debugManager.setScale(scale),\n\n    // Status from DebugManager - FIXED: Use silent method by default\n    status: () => {\n      const state = debugManager.getSnapshot();\n      console.table(state);\n      return state;\n    },\n\n    // ADDED: Silent status access for programmatic use\n    getStatus: () => debugManager.getSnapshot(),\n\n    // Subscribe to DebugManager changes\n    onChange: (callback) => debugManager.onChange(callback),\n\n    // Manual refresh triggers re-render\n    refresh: () => {\n      try {\n        const pipelineInstance = window.__msdDebug?.pipelineInstance;\n        if (pipelineInstance?.reRender) {\n          pipelineInstance.reRender();\n          console.log('[MSD Debug] Debug overlays refreshed');\n        }\n      } catch (error) {\n        console.warn('[MSD Debug] Failed to trigger pipeline re-render:', error);\n      }\n    },\n\n    // Convenient nested methods using DebugManager\n    anchors: {\n      show: () => debugManager.enable('anchors'),\n      hide: () => debugManager.disable('anchors'),\n      toggle: () => debugManager.toggle('anchors')\n    },\n\n    bounding: {\n      show: () => debugManager.enable('bounding_boxes'),\n      hide: () => debugManager.disable('bounding_boxes'),\n      toggle: () => debugManager.toggle('bounding_boxes')\n    },\n\n    routing: {\n      show: () => debugManager.enable('routing'),\n      hide: () => debugManager.disable('routing'),\n      toggle: () => debugManager.toggle('routing')\n    },\n\n    performance: {\n      show: () => debugManager.enable('performance'),\n      hide: () => debugManager.disable('performance'),\n      toggle: () => debugManager.toggle('performance')\n    }\n  };\n\n  /*\n  // Keep the shadowRoot tracking code - it's still used by testRender and other methods\n  let debugShadowRoot = null;\n  let lastUsedRoot = null;\n  */\n\n  /**\n   * Store the shadowRoot context from the render call\n   * This allows us to find elements within the correct scope later\n   */\n  /*\n  function setDebugContext(root) {\n    if (root && root.querySelector) {\n      debugShadowRoot = root;\n      lastUsedRoot = root;\n      console.log('[MSD Debug] Stored debug context:', root.constructor.name);\n    }\n  }\n  */\n  /**\n   * Find MSD wrapper element within the correct scope (shadowRoot)\n   */\n  /*\n  function findMsdWrapper() {\n    const searchRoots = [debugShadowRoot, lastUsedRoot].filter(Boolean);\n\n    for (const root of searchRoots) {\n      if (!root || !root.querySelector) continue;\n\n      // Try multiple selectors within this shadowRoot\n      const selectors = [\n        '#msd-v1-comprehensive-wrapper',\n        '[id*=\"msd-v1\"]',\n        '[id*=\"msd\"]',\n        '.msd-container',\n        'div[style*=\"border:2px solid cyan\"]'  // Fallback to the wrapper div style\n      ];\n\n      for (const selector of selectors) {\n        try {\n          const element = root.querySelector(selector);\n          if (element) {\n            console.log(`[MSD Debug] Found wrapper using selector '${selector}' in ${root.constructor.name}`);\n            return element;\n          }\n        } catch (e) {\n          // Continue to next selector\n        }\n      }\n    }\n\n    console.warn('[MSD Debug] Could not find MSD wrapper in any known shadowRoot');\n    return null;\n  }\n  */\n\n  dbg.renderAdvanced = (options) => {\n    try {\n      console.log('[MSD v1] renderAdvanced called - using AdvancedRenderer');\n      const model = modelBuilder.getResolvedModel();\n      if (model) {\n        return systemsManager.renderer.render(model);\n      }\n      console.warn('[MSD v1] renderAdvanced: No resolved model available');\n      return { svgMarkup: '' };\n    } catch (error) {\n      console.error('[MSD v1] renderAdvanced failed:', error);\n      return { svgMarkup: '', error: error.message };\n    }\n  };\n\n  // Rest of the function remains the same...\n  dbg.hud = {\n    show: () => systemsManager.hudManager.show(),\n    hide: () => systemsManager.hudManager.hide(),\n    toggle: () => systemsManager.hudManager.toggle(),\n    state: () => ({\n      visible: systemsManager.hudManager.state?.visible || false,\n      activePanel: systemsManager.hudManager.state?.activePanel || 'unknown',\n      refreshRate: systemsManager.hudManager.state?.refreshRate || 2000\n    }),\n\n    init: () => {\n      if (debugConfig?.hud?.auto_show) {\n        setTimeout(() => {\n          systemsManager.hudManager.show();\n          console.log('[MSD v1] HUD auto-shown based on config');\n        }, 2000);\n      }\n    }\n  };\n\n  setTimeout(() => dbg.hud.init(), 100);\n\n  dbg.introspection = {\n    listOverlays: (root) => MsdIntrospection.listOverlays(root),\n    getOverlayBBox: (id, root) => MsdIntrospection.getOverlayBBox(id, root),\n    highlight: (ids, opts) => MsdIntrospection.highlight(ids, opts)\n  };\n\n  dbg.controls = {\n    render: (overlays, model) => systemsManager.controlsRenderer.renderControls(overlays, model),\n    relayout: () => systemsManager.controlsRenderer.relayout()\n  };\n\n  // ADD: Help system\n  dbg.help = function() {\n    console.log(`\n╔══════════════════════════════════════════════════════════════════════════════╗\n║                          MSD Debug Interface Help                            ║\n╠══════════════════════════════════════════════════════════════════════════════╣\n║ Debug Features:                                                              ║\n║   __msdDebug.debug.enable('anchors')       - Show anchor point markers      ║\n║   __msdDebug.debug.enable('bounding_boxes') - Show overlay bounding boxes   ║\n║   __msdDebug.debug.enable('routing')       - Show routing path visualization║\n║   __msdDebug.debug.enable('performance')   - Show performance metrics       ║\n║   __msdDebug.debug.enable('all')           - Enable all features            ║\n║                                                                              ║\n║   __msdDebug.debug.disable('feature')      - Disable specific feature       ║\n║   __msdDebug.debug.status()                - Show current debug state       ║\n║   __msdDebug.debug.setScale(1.5)           - Set debug element scale        ║\n║   __msdDebug.debug.refresh()               - Force re-render debug overlays ║\n║                                                                              ║\n║ Quick Access:                                                                ║\n║   __msdDebug.debug.anchors.toggle()        - Toggle anchor markers          ║\n║   __msdDebug.debug.bounding.toggle()       - Toggle bounding boxes          ║\n║   __msdDebug.debug.routing.toggle()        - Toggle routing guides          ║\n║   __msdDebug.debug.performance.toggle()    - Toggle performance overlay     ║\n║                                                                              ║\n║ Data & Entities:                                                             ║\n║   __msdDebug.dataSources.stats()           - Data source statistics         ║\n║   __msdDebug.dataSources.list()            - List all data sources          ║\n║   __msdDebug.dataSources.get('name')       - Get specific data source       ║\n║                                                                              ║\n║ Routing:                                                                     ║\n║   __msdDebug.routing.inspect('overlay_id') - Inspect routing path           ║\n║   __msdDebug.routing.stats()               - Routing system statistics      ║\n║   __msdDebug.routing.invalidate()          - Clear routing cache            ║\n║                                                                              ║\n║ Performance:                                                                 ║\n║   __msdDebug.getPerf()                     - Get performance metrics        ║\n║   __msdDebug.perf()                        - Alternative performance data   ║\n║                                                                              ║\n║ Other Tools:                                                                 ║\n║   __msdDebug.hud.toggle()                  - Toggle HUD overlay             ║\n║   __msdDebug.rules.trace()                 - Show rules engine trace        ║\n║   __msdDebug.validation.issues()           - Show configuration issues      ║\n║   __msdDebug.usage()                       - Show simplified usage examples ║\n║                                                                              ║\n║ Pipeline:                                                                    ║\n║   __msdDebug.pipelineInstance              - Direct pipeline access         ║\n╚══════════════════════════════════════════════════════════════════════════════╝\n    `);\n  };\n\n  // ADD: Simplified usage examples\n  dbg.usage = function() {\n    console.log(`\n🔧 Quick MSD Debug Commands:\n\nEnable debug features:\n  __msdDebug.debug.enable('anchors')      # Show anchor points\n  __msdDebug.debug.enable('bounding_boxes') # Show overlay bounds\n  __msdDebug.debug.enable('all')          # Enable everything\n\nCheck status:\n  __msdDebug.debug.status()               # Current debug state\n  __msdDebug.dataSources.stats()          # Data source info\n  __msdDebug.getPerf()                    # Performance metrics\n\nQuick toggles:\n  __msdDebug.debug.anchors.toggle()       # Toggle anchors\n  __msdDebug.debug.routing.toggle()       # Toggle routing guides\n\nFor full help: __msdDebug.help()\n    `);\n  };\n\n  // Log debug config state (REDUCED)\n  if (debugConfig.enabled) {\n    console.log('[MSD v1] Debug mode enabled');\n  }\n}\n\nfunction setupUtilityDebugInterface(dbg, mergedConfig, systemsManager) {\n  // Rules system\n  dbg.rules = {\n    trace: () => systemsManager.rulesEngine.getTrace()\n  };\n\n  // Animations\n  dbg.animations = {\n    active: () => systemsManager.animRegistry.getActive()\n  };\n\n  // Performance monitoring\n  dbg.getPerf = () => {\n    const perfStore = dbg.__perfStore || {};\n    const result = {\n      timers: {},\n      counters: perfStore.counters || {}\n    };\n\n    if (perfStore.timings) {\n      Object.entries(perfStore.timings).forEach(([key, data]) => {\n        if (data && typeof data === 'object') {\n          result.timers[key] = {\n            count: data.count || 0,\n            total: data.total || 0,\n            avg: data.count > 0 ? (data.total / data.count) : 0,\n            last: data.last || 0,\n            max: data.max || 0\n          };\n        }\n      });\n    }\n\n    return result;\n  };\n\n  dbg.perf = () => perfGetAll();\n\n  // Validation\n  dbg.validation = {\n    issues: () => {\n      try {\n        return mergedConfig.__issues || { errors: [], warnings: [] };\n      } catch (e) {\n        console.warn('[MSD v1] validation.issues failed:', e);\n        return { errors: [], warnings: [] };\n      }\n    }\n  };\n\n  // Packs inspection\n  dbg.packs = {\n    list: (type) => {\n      if (!type) return {\n        animations: mergedConfig.animations?.length || 0,\n        overlays: mergedConfig.overlays?.length || 0,\n        rules: mergedConfig.rules?.length || 0,\n        profiles: mergedConfig.profiles?.length || 0,\n        timelines: mergedConfig.timelines?.length || 0\n      };\n      return mergedConfig[type] || [];\n    },\n    get: (type,id) => (mergedConfig[type]||[]).find(i=>i.id===id),\n    issues: () => mergedConfig.__issues\n  };\n\n  // Line debugging\n  dbg.lines = {\n    markersEnabled: false,\n    showMarkers(flag=true){\n      this.markersEnabled=!!flag;\n      console.info('[MSD v1] line endpoint markers', this.markersEnabled?'ENABLED':'DISABLED');\n    },\n    forceRedraw: () => {\n      // Connect to the reRender callback through systems manager\n      if (systemsManager._reRenderCallback) {\n        systemsManager._reRenderCallback();\n        return true;\n      }\n      return false;\n    }\n  };\n}","import * as anime from 'animejs';\n\nimport * as CBLCARS from './cb-lcars-vars.js'\nimport { cblcarsSetGlobalLogLevel, cblcarsGetGlobalLogLevel, cblcarsLog, cblcarsLogBanner} from './utils/cb-lcars-logging.js';\nimport { readYamlFile } from './utils/cb-lcars-fileutils.js';\nimport { preloadSVGs, loadSVGToCache, getSVGFromCache } from './utils/cb-lcars-fileutils.js';\n//import { CBLCARSDashboardStrategy, CBLCARSViewStrategy, CBLCARSViewStrategyAirlock } from './strategy/cb-lcars-strategy.js';\nimport { CBLCARSCardEditor } from './editor/cb-lcars-editor.js';\nimport { loadFont, loadCoreFonts, loadAllFontsFromConfig } from './utils/cb-lcars-theme.js';\nimport { getLovelace, checkLovelaceTemplates } from './utils/cb-helpers.js';\nimport { ButtonCard } from \"./cblcars-button-card.js\"\nimport { html } from 'lit';\n\nimport * as animHelpers from './utils/cb-lcars-anim-helpers.js';\nimport { animPresets } from './utils/cb-lcars-anim-presets.js';\nimport * as svgHelpers from './utils/cb-lcars-svg-helpers.js';\nimport * as anchorHelpers from './utils/cb-lcars-anchor-helpers.js';\n\n\n\n// CHANGED: Side-effect import that initializes the MSD v1 pipeline\nimport './msd/index.js';\n\n\n// Ensure global namespace\nwindow.cblcars = window.cblcars || {};\n\n// Promises for loading the templates and stub configuration\nlet templatesPromise;\nlet stubConfigPromise;\nlet themeColorsPromise;\n\n// Load the templates from our yaml file\nlet templates = {};\nlet stubConfig = {};\n\n// Ensure the cblcars object exists on the window object\n//window.cblcars = window.cblcars || {};\nwindow.cblcars.loadFont = loadFont;\n\n\n// DEBUGGING: Add immediate global debugging when CB-LCARS loads\nconsole.log('[CB-LCARS] File loaded, setting up debugging');\n\nasync function initializeCustomCard() {\n\n    // Call log banner function immediately when the script loads\n    cblcarsLogBanner();\n    window.cblcars.cblcarsLog = cblcarsLog; // Expose the logging function globally\n\n    // Expose debug helpers (the module already attaches API; this ensures references exist)\n    window.cblcars.debug = window.cblcars.debug || {};\n    window.cblcars.debug.setLevel = cblcarsSetGlobalLogLevel;\n\n    // Animation namespace organization\n    window.cblcars.anim = {\n        animejs: anime,                // full animejs module\n        anime: anime.animate,          // shortcut for anime.animate\n        utils: anime.utils,            // CENTRAL canonical utils reference\n        animateElement: animHelpers.animateElement,\n        animateWithRoot: animHelpers.animateWithRoot,\n        waitForElement: animHelpers.waitForElement,\n        presets: animPresets,\n        scopes: new Map(),\n    };\n\n    // Backward-compatible shortcuts (to be deprecated)\n    window.cblcars.animejs = window.cblcars.anim.animejs;\n    window.cblcars.anime = window.cblcars.anim.anime;\n    window.cblcars.animateElement = window.cblcars.anim.animateElement;\n    window.cblcars.animateWithRoot = window.cblcars.anim.animateWithRoot;\n    window.cblcars.waitForElement = window.cblcars.anim.waitForElement;\n\n\n    window.cblcars.svgHelpers = svgHelpers;\n    window.cblcars.anchorHelpers = anchorHelpers;\n    window.cblcars.findSvgAnchors = anchorHelpers.findSvgAnchors;\n    window.cblcars.getSvgContent = anchorHelpers.getSvgContent;\n    window.cblcars.getSvgViewBox = anchorHelpers.getSvgViewBox;\n    window.cblcars.getSvgAspectRatio = anchorHelpers.getSvgAspectRatio;\n\n\n    window.cblcars.loadFont = loadFont;\n    window.cblcars.loadUserSVG = async function(key, url) {\n        return await loadSVGToCache(key, url);\n    };\n    window.cblcars.getSVGFromCache = getSVGFromCache;\n\n    ///load yaml configs\n    // Await YAML configs\n    templatesPromise = loadTemplates(CBLCARS.templates_uri);\n    stubConfigPromise = loadStubConfig(CBLCARS.stub_config_uri);\n    themeColorsPromise = loadThemeColors(CBLCARS.theme_colors_uri);\n\n    // Await SVG preload\n    await preloadSVGs(CBLCARS.builtin_svg_keys, CBLCARS.builtin_svg_basepath)\n        .catch(error => cblcarsLog.error('[initializeCustomCard] Error preloading built-in SVGs:', error));\n\n    // Await card dependencies\n    const cardImports = [\n        customElements.whenDefined('cblcars-button-card'),\n        customElements.whenDefined('my-slider-v2')\n    ];\n    await Promise.all(cardImports);\n\n    // Await font loading if loadCoreFonts is async\n    await loadCoreFonts();\n\n    // Await YAML config loading\n    await Promise.all([templatesPromise, stubConfigPromise, themeColorsPromise]);\n\n    // Checks that custom element dependencies are defined for use in the cards\n    if (!customElements.get('cblcars-button-card')) {\n        cblcarsLog.error(`[initializeCustomCard] Custom Button Card for LCARS [cblcars-button-card] was not found!`);\n    }\n    if (!customElements.get('my-slider-v2')) {\n        cblcarsLog.error(`[initializeCustomCard] 'My Cards' MySliderV2 Custom Card [my-slider-v2] was not found!`);\n    }\n}\n\n\n// Initialize the custom card and register elements only after setup is complete\ninitializeCustomCard()\n    .then(() => {\n        defineCustomElement('cb-lcars-base-card', CBLCARSBaseCard, 'cb-lcars-base-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-label-card', CBLCARSLabelCard, 'cb-lcars-label-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-elbow-card', CBLCARSElbowCard, 'cb-lcars-elbow-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-double-elbow-card', CBLCARSDoubleElbowCard, 'cb-lcars-double-elbow-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-multimeter-card', CBLCARSMultimeterCard, 'cb-lcars-multimeter-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-dpad-card', CBLCARSDPADCard, 'cb-lcars-dpad-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-button-card', CBLCARSButtonCard, 'cb-lcars-button-card-editor', CBLCARSCardEditor);\n        defineCustomElement('cb-lcars-msd-card', CBLCARSMSDCard, 'cb-lcars-msd-card-editor', CBLCARSCardEditor);\n    })\n    .catch(error => {\n        cblcarsLog.error('[initializeCustomCard.then()] Error initializing custom card:', error);\n    });\n\n\nasync function loadTemplates(filePath) {\n    try {\n        const yamlContent = await readYamlFile(filePath);\n\n        // Store the YAML content in window.cblcars_card_templates\n        window.cblcars_card_templates = yamlContent.cblcars_card_templates;\n\n        // Merge the cblcars stanza with the existing window.cblcars object\n        if (yamlContent.cblcars) {\n            window.cblcars = {\n                ...window.cblcars,\n                ...yamlContent.cblcars\n            };\n        }\n\n        templates = yamlContent || {};\n        cblcarsLog.debug(`[loadTemplates] CB-LCARS dashboard templates loaded from source file [${filePath}]`, templates);\n    } catch (error) {\n        cblcarsLog.error('[loadTemplates] Failed to get the CB-LCARS lovelace templates from source file.', error);\n    }\n}\n\nasync function loadThemeColors(filePath) {\n    try {\n        const yamlContent = await readYamlFile(filePath);\n\n        // Merge the cblcars stanza with the existing window.cblcars object\n        if (yamlContent.cblcars) {\n            window.cblcars = {\n                ...window.cblcars,\n                ...yamlContent.cblcars\n            };\n        }\n        cblcarsLog.info(`[loadThemeColors] CB-LCARS theme colors loaded from source file [${filePath}]`, yamlContent);\n        setThemeColors(window.cblcars.themes, 'green');\n    } catch (error) {\n        cblcarsLog.error('[loadThemeColors] Failed to get the CB-LCARS theme colors from source file.', error);\n    }\n}\n\nfunction setThemeColors(themes, alertCondition = 'green', clobber = false) {\n    const selectedTheme = themes[`${alertCondition}_alert`];\n    if (!selectedTheme) {\n        cblcarsLog.error(`[setThemeColors] Theme for alert condition ${alertCondition} is not defined.`, '', cblcarsGetGlobalLogLevel());\n        return;\n    }\n\n    const colors = selectedTheme.colors;\n\n    for (const [colorGroup, colorValues] of Object.entries(colors)) {\n        for (const [colorName, colorValue] of Object.entries(colorValues)) {\n            const cssVarName = `--${colorName}`;\n            const existingValue = getComputedStyle(document.documentElement).getPropertyValue(cssVarName).trim();\n\n            if (clobber || !existingValue) {\n                cblcarsLog.warn(`[setThemeColors] Color undefined or overridden - Setting ${cssVarName}=${colorValue}`, '', cblcarsGetGlobalLogLevel());\n                document.documentElement.style.setProperty(cssVarName, colorValue);\n            } else {\n                cblcarsLog.debug(`[setThemeColors] Skipping ${cssVarName} as it is already defined with value ${existingValue}`, '', cblcarsGetGlobalLogLevel());\n            }\n        }\n    }\n}\nfunction setAlertCondition(alertCondition) {\n    setThemeColors(window.cblcars.themes, alertCondition,true);\n}\nwindow.cblcars.setAlertCondition = setAlertCondition;\n\n// Load the stub configuration from our yaml file\nasync function loadStubConfig(filePath) {\n    try {\n        const yamlContent = await readYamlFile(filePath);\n        stubConfig = yamlContent || {};\n        cblcarsLog.debug(`[loadStubConfig] CB-LCARS stub configuration loaded from source file [${CBLCARS.stub_config_uri}]`, stubConfig);\n    } catch (error) {\n        cblcarsLog.error('[loadStubConfig] Failed to get the CB-LCARS stub configuration from source file.', error);\n    }\n}\n\n\n\n// --- Anime.js v4 Scopes Manager ---\nclass CBLCARSAnimationScope {\n    constructor(id) {\n        this.id = id;\n        this.scope = window.cblcars.animejs.createScope(); // anime.js v4 syntax\n        this.animations = []; // Array to hold animation instances for inspection\n        this._runningByTarget = new Map(); // Map<targetId, animation>\n    }\n\n    // Resolve the root for DOM operations\n    _getRoot(options) {\n        return (options && options.root) || document;\n    }\n\n    // Normalize targets into Element[]\n    _resolveTargets(options) {\n        const root = this._getRoot(options);\n        const t = options && options.targets;\n        if (!t) return [];\n        if (t instanceof Element) return [t];\n        if (Array.isArray(t)) return t.filter(Boolean);\n        if (typeof t === 'string') {\n            // Prefer ID fast-path\n            if (t.startsWith('#')) {\n                const el = root.querySelector(t);\n                return el ? [el] : [];\n            }\n            return Array.from(root.querySelectorAll(t));\n        }\n        return [];\n    }\n\n    // Remove artifacts created by previous animation runs for a given baseId\n    _cleanupArtifactsForTargetId(root, baseId) {\n        if (!baseId) return;\n        // Only remove preset-owned artifacts\n        const trails = root.querySelectorAll(`#${baseId}_trail[data-cblcars-owned]`);\n        trails.forEach(n => n.parentElement && n.parentElement.removeChild(n));\n        const tracers = root.querySelectorAll(`#${baseId}_tracer[data-cblcars-owned]`);\n        tracers.forEach(n => n.parentElement && n.parentElement.removeChild(n));\n\n        // Clear CSS animation residue on the base element (e.g., march)\n        const baseEl = root.getElementById(baseId);\n        if (baseEl) {\n            if (baseEl.style) baseEl.style.animation = '';\n            baseEl.removeAttribute('data-march-anim-id');\n        }\n    }\n    // Stop anime.js animations for the given targets and cleanup artifacts\n    _cancelAndCleanupTargets(options) {\n        const root = this._getRoot(options);\n        const targets = this._resolveTargets(options);\n        targets.forEach(el => {\n            const id = el && el.id;\n            if (!id) return;\n\n            // Stop prior animations on this element (if any)\n            if (this.scope && typeof this.scope.remove === 'function') {\n                try { this.scope.remove(el); } catch (_) {}\n            }\n\n            // Remove previously created artifacts for this target\n            this._cleanupArtifactsForTargetId(root, id);\n\n            // Clear inline CSS animation remnants\n            el.style && (el.style.animation = '');\n\n            // Forget previous tracking entry\n            this._runningByTarget.delete(id);\n        });\n        return targets;\n    }\n\n    /**\n     * Adds an animation to the scope using the v4 `scope.add()` pattern.\n     * De-duplicates by target: cancels prior animations and removes artifacts before starting a new one.\n     * @param {object} options - The animation options for animateElement.\n     * @param {object} hass - The Home Assistant hass object.\n     */\n    animate(options, hass = null) {\n        const targets = this._cancelAndCleanupTargets(options);\n\n        // Call the global animateElement helper, passing this instance as the scope.\n        const animation = window.cblcars.anim.animateElement(this, options, hass);\n        if (animation) {\n            this.animations.push({ config: options, animation: animation, targets });\n            // Track per-target so future runs can be canceled/cleaned deterministically\n            targets.forEach(el => el && el.id && this._runningByTarget.set(el.id, animation));\n        }\n    }\n\n    destroy() {\n        // Stop and remove all animations associated with this scope.\n        if (this.scope && typeof this.scope.remove === 'function') {\n            try {\n                const activeAnimations = window.cblcars.animejs.get(this.scope);\n                if (activeAnimations) {\n                    this.scope.remove(activeAnimations.map(anim => anim.targets).flat());\n                }\n            } catch (_) {}\n        }\n\n        // Cleanup artifacts for all tracked targets\n        try {\n            this.animations.forEach(entry => {\n                const root = this._getRoot(entry.config);\n                (entry.targets || []).forEach(el => {\n                    if (el && el.id) {\n                        this._cleanupArtifactsForTargetId(root, el.id);\n                        el.style && (el.style.animation = '');\n                    }\n                });\n            });\n        } catch (_) {}\n\n        // Clear internal tracking\n        this._runningByTarget.clear();\n        this.animations = [];\n    }\n}\n\n\nclass CBLCARSBaseCard extends ButtonCard {\n\n    _isResizeObserverEnabled = false;\n    _resizeObserver;\n    _logLevel = cblcarsGetGlobalLogLevel();\n    _resizeObserverTarget = 'this';\n    _lastWidth = 0;\n    _lastHeight = 0;\n    _resizeObserverTolerance = 16; // Default tolerance for resize observer.  16 settles infinite resize in preview mode.\n    _debounceWait = 100; // Default debounce wait time in milliseconds\n    _isUsingLovelaceTemplate = false;\n    _overrideTemplates = [];\n\n\n    constructor () {\n        super();\n        this._resizeObserverTolerance = window.cblcars.resizeObserverTolerance || this._resizeObserverTolerance;\n        this._debounceWait = window.cblcars.debounceWait || this._debounceWait;\n        this._resizeObserver = new ResizeObserver(() => {\n            cblcarsLog.debug('[CBLCARSBaseCard.constructor()] Resize observer fired', this, this._logLevel);\n            this._debouncedResizeHandler();\n        });\n        this._debouncedResizeHandler = this._debounce(() => this._updateCardSize(), this._debounceWait);\n    }\n\n\n    setHass(hass) {\n        console.log('[CBLCARSBaseCard.setHass()] 🎯 RECEIVED setHass call:', {\n            cardType: this.constructor.cardType,\n            entity: this._config?.entity,\n            oldState: this.hass?.states?.[this._config?.entity]?.state,\n            newState: hass?.states?.[this._config?.entity]?.state,\n            stateChanged: this.hass?.states?.[this._config?.entity]?.state !== hass?.states?.[this._config?.entity]?.state,\n            timestamp: new Date().toISOString(),\n            callerStack: new Error().stack.split('\\n').slice(1, 3).map(line => line.trim()).join(' → ')\n        });\n\n        // Store the old HASS for LitElement change detection\n        const oldHass = this.hass;\n\n        // CRITICAL: Update _stateObj BEFORE setting HASS property to maintain sync with custom-button-card\n        if (this._config?.entity && hass?.states?.[this._config.entity]) {\n            const newStateObj = hass.states[this._config.entity];\n            if (this._stateObj !== newStateObj) {\n                console.log('[CBLCARSBaseCard.setHass()] Updating _stateObj for entity:', this._config.entity, {\n                    oldState: this._stateObj?.state,\n                    newState: newStateObj?.state\n                });\n                this._stateObj = newStateObj;\n            }\n        }\n\n        // Use property assignment to trigger LitElement's reactive system\n        this.hass = hass;\n        this._hass = hass; // Also set internal property for compatibility\n\n        // Trigger LitElement's requestUpdate for proper change detection\n        if (typeof this.requestUpdate === 'function') {\n            this.requestUpdate('hass', oldHass);\n            this.requestUpdate('_hass', oldHass);\n\n            // Also trigger update for state object if it changed\n            if (this._config?.entity && this._stateObj) {\n                this.requestUpdate('_stateObj');\n            }\n        }\n\n        console.log('[CBLCARSBaseCard.setHass()] Completed with property assignment approach');\n    }\n\n\n    setConfig(config) {\n        if (!config) {\n            throw new Error(\"The 'cblcars_card_config' section is required in the configuration.\");\n        }\n\n        // DEBUGGING: Log the incoming config to see what MSD is passing\n        console.log('[CBLCARSBaseCard.setConfig()] Called with config:', {\n            type: config.type,\n            entity: config.entity,\n            triggersUpdate: config.triggers_update,\n            hasSetConfigFromMSD: config._msdGenerated || false,\n            fullConfig: config\n        });\n\n        // Handle merging of templates array\n        const defaultTemplates = ['cb-lcars-base'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        // Set the _logLevel property from the config\n        this._logLevel = config.cblcars_log_level || cblcarsGetGlobalLogLevel();\n\n        // ENHANCED: Skip entity collection entirely for MSD cards\n        let triggersUpdate = [];\n        const isMSDCard = config.type === 'cb-lcars-msd-card' ||\n                        this.constructor.cardType === 'cb-lcars-msd-card' ||\n                        mergedTemplates.includes('cb-lcars-msd');\n\n        if (isMSDCard) {\n            // MSD cards: NO entity tracking at all\n            triggersUpdate = [];\n            console.log(`[CBLCARSBaseCard.setConfig()] MSD card detected: Completely disabling triggers_update`);\n        } else {\n            // Non-MSD cards: Normal entity collection\n            const foundEntities = collectEntities(config);\n            triggersUpdate = Array.isArray(config.triggers_update) ? config.triggers_update : [];\n\n            if (config.triggers_update === 'all') {\n                triggersUpdate = 'all';\n            } else if (foundEntities.length > 0) {\n                triggersUpdate = Array.from(new Set([...triggersUpdate, ...foundEntities]));\n                console.log(`[CBLCARSBaseCard.setConfig()] Found entities for triggers_update:`, foundEntities);\n            }\n        }\n\n\n        // Create a new object to avoid modifying the original config\n        this._config = {\n            ...config,\n            template: mergedTemplates,\n            triggers_update: triggersUpdate  // FIXED: Re-enabled triggers_update\n        };\n\n        console.log('[CBLCARSBaseCard.setConfig()] Final config triggers_update:', this._config.triggers_update);\n\n        // Load all fonts from the config (dynamically loads fonts based on the config)\n        loadAllFontsFromConfig(this._config);\n\n        // Check if the card is using a template from the dashboard's yaml.\n        // this will override the card's configuration\n        // this could be on purpose for testing/customization - but more likely holdovers from the original version that used that method\n        const { isUsingLovelaceTemplate, overriddenTemplates } = checkLovelaceTemplates(this._config);\n        this._isUsingLovelaceTemplate = isUsingLovelaceTemplate;\n        this._overrideTemplates = overriddenTemplates;\n\n        // Log a warning if the card is using a template from the dashboard's yaml\n        // add the card to a list of tainted cards\n        if(isUsingLovelaceTemplate) {\n            cblcarsLog.warn(`[CBLCARSBaseCard.setConfig()] Card configuration templates are being overridden with local dashboard YAML configuration.  Templates: ${overriddenTemplates.join(', ')}`, this, this._logLevel);\n            window.cblcars.taintedCards = window.cblcars.taintedCards || [];\n            window.cblcars.taintedCards.push({card: this, templates: overriddenTemplates});\n        }\n\n\n        // Set up the resizeObserver properties\n        this._resizeObserverTarget = config.resize_observer_target || 'this';\n        this._isResizeObserverEnabled = (config.enable_resize_observer || (config.variables && config.variables.enable_resize_observer)) || false;\n        this._resizeObserverTolerance = config.resize_observer_tolerance || this._resizeObserverTolerance;\n        this._debounceWait = config.debounce_wait || this._debounceWait;\n        // Enable the resize observer if any merged template contains the word 'animation'\n        // this allows us to enable the observer for added animation templates without needed to explicity add it to the config\n        if (mergedTemplates.some(template => template.includes('animation') || template.includes('symbiont'))) {\n            this._isResizeObserverEnabled = true;\n        }\n\n        // Enable the resize observer if the configuration option is enabled\n        if (this._isResizeObserverEnabled) {\n            this.enableResizeObserver();\n        }\n\n        super.setConfig(this._config);\n        console.log('[CBLCARSBaseCard.setConfig()] Called super.setConfig with final config:', {\n            triggers_update: this._config.triggers_update,\n            entity: this._config.entity,\n            type: this._config.type\n        });\n\n        // ADDED: Force state re-evaluation for CB-LCARS cards after config change\n        if (this.hass && this._config.entity) {\n            console.log('[CBLCARSBaseCard.setConfig()] Forcing state re-evaluation after setConfig');\n\n            // Force the card to re-evaluate its state-based styling\n            setTimeout(() => {\n                try {\n                    console.log('[CBLCARSBaseCard.setConfig()] Skipping forced setHass - will rely on normal HA update cycle');\n\n                    // Method 2: Force render update (SAFE)\n                    if (typeof this.requestUpdate === 'function') {\n                        console.log('[CBLCARSBaseCard.setConfig()] Forcing requestUpdate');\n                        this.requestUpdate();\n                    }\n\n                    // Method 3: REMOVED - manual state manipulation can cause issues\n\n                } catch (e) {\n                    console.warn('[CBLCARSBaseCard.setConfig()] Failed to force state re-evaluation:', e);\n                }\n            }, 100);\n        }\n\n        cblcarsLog.debug(`[CBLCARSBaseCard.setConfig()] called with:`, this._config, this._logLevel);\n    }\n\n    static get editorType() {\n        return 'cb-lcars-base-card-editor';\n    }\n    static get cardType() {\n        return 'cb-lcars-base-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            label: \"CB-LCARS Base Card\",\n            show_label: true\n        };\n    }\n\n    static getConfigElement() {\n\n        const editorType = this.editorType;\n\n        try {\n            if (!customElements.get(editorType)) {\n                cblcarsLog.error(`[CBLCARSBaseCard.getConfigElement()] Graphical editor element [${editorType}] is not defined defined in Home Assistant!`, null, this._logLevel);\n                return null;\n            }\n            const element = document.createElement(editorType);\n            //console.log('Element created:', element);\n            return element;\n        } catch (error) {\n            cblcarsLog.error(`[CBLCARSBaseCard.getConfigElement()] Error creating element ${editorType}: `, error, this._logLevel);\n            return null;\n        }\n    }\n\n    static getStubConfig() {\n        const cardType = this.cardType;\n        if (stubConfig[cardType]) {\n            return stubConfig[cardType];\n        } else {\n            return this.defaultConfig;\n        }\n    }\n\n    getCardSize() {\n        //return this._card ? this._card.getCardSize() : 4;\n        super.getCardSize();\n    }\n\n    getLayoutOptions() {\n        return {\n          grid_rows: 1,\n          grid_columns: 4\n        };\n      }\n\n\n    connectedCallback() {\n        super.connectedCallback();\n        // --- Anime.js Scope creation ---\n        this._animationScopeId = `card-${this.id || this.cardType || Math.random().toString(36).slice(2)}`;\n        this._animationScope = new CBLCARSAnimationScope(this._animationScopeId);\n        window.cblcars.anim.scopes.set(this._animationScopeId, this._animationScope);\n\n        // CLEANUP: Stop previous timelines if any\n        if (this._timelines && Array.isArray(this._timelines)) {\n            this._timelines.forEach(tl => tl && typeof tl.pause === 'function' && tl.pause());\n            this._timelines = null;\n        }\n\n        // NEW: Timelines now live under this._config.variables.msd.timelines\n        // Build overlay config map from variables.msd.overlays for element-level merge\n        const msdVars = this._config?.variables?.msd || {};\n        const timelinesCfg = msdVars.timelines || null;\n        const overlaysArr = Array.isArray(msdVars.overlays) ? msdVars.overlays : [];\n        const overlayConfigsById = overlaysArr.reduce((acc, o) => {\n            if (o && o.id) acc[o.id] = o;\n            return acc;\n        }, {});\n\n        // Defer timeline creation until after the SVG/overlays have been stamped into the shadowRoot\n        if (timelinesCfg) {\n            requestAnimationFrame(() => {\n            requestAnimationFrame(async () => {\n                try {\n                this._timelines = await animHelpers.createTimelines(\n                    timelinesCfg,\n                    this._animationScopeId,\n                    this.shadowRoot,\n                    overlayConfigsById,\n                    this.hass || null,\n                    msdVars.presets || {}      // <-- pass presets for state_resolver in timeline steps\n                );\n                // Do not force play(); let autoplay govern start/paused state\n                } catch (e) {\n                cblcarsLog.error('[CBLCARSBaseCard.connectedCallback] Error creating timelines:', e);\n                }\n            });\n            });\n        }\n\n        // Check if the parent element has the class 'preview'\n        if (this.parentElement && this.parentElement.classList.contains('preview')) {\n            this.style.height = '60px';\n            this.style.minHeight = '60px';\n        } else {\n            this.style.height = '100%';\n\n            // Enable the resize observer when the card is connected to the DOM\n            // but only if not in preview mode\n            if (this._isResizeObserverEnabled) {\n            this.enableResizeObserver();\n            window.addEventListener('resize', this._debouncedResizeHandler);\n            }\n        }\n    }\n\n    disconnectedCallback() {\n        super.disconnectedCallback();\n        // --- Anime.js Scope cleanup ---\n        const animationScope = window.cblcars.anim.scopes.get(this._animationScopeId);\n        if (animationScope) {\n            //animationScope.destroy();\n            animationScope.destroy();\n            window.cblcars.anim.scopes.delete(this._animationScopeId);\n        }\n        this.disableResizeObserver();\n        window.removeEventListener('resize', this._debouncedResizeHandler)\n    }\n\n    _updateCardSize() {\n\n        //cblcarsLog('debug',`this.offset* dimensions: ${this.offsetWidth} x ${this.offsetHeight}`, this, this._logLevel);\n        //cblcarsLog('debug',`this.offsetParent.offset* dimensions: ${this.offsetParent.offsetWidth} x ${this.offsetParent.offsetHeight}`, this, this._logLevel);\n        //cblcarsLog('debug',`this.parentElement.offset* dimensions: ${this.parentElement.offsetWidth} x ${this.parentElement.offsetHeight}`, this, this._logLevel);\n\n        const parentWidth = this.parentElement.offsetWidth;\n        const parentHeight = this.parentElement.offsetHeight;\n        //cblcarsLog.debug(`Going with dimensions: ${parentWidth} x ${parentHeight}`, this, this._logLevel);\n\n        const significantChange = this._resizeObserverTolerance;\n        // Only update if there is a significant change\n        if (parentWidth > 0 && parentHeight > 0 && (Math.abs(parentWidth - this._lastWidth) > significantChange || Math.abs(parentHeight - this._lastHeight) > significantChange)) {\n            //if (Math.abs(parentWidth - this._lastWidth) > significantChange || Math.abs(parentHeight - this._lastHeight) > significantChange) {\n            this._lastWidth = parentWidth;\n            this._lastHeight = parentHeight;\n\n            // Set CSS variables for the child card's dimensions\n            this.style.setProperty('--button-card-width', `${parentWidth}px`);\n            this.style.setProperty('--button-card-height', `${parentHeight}px`);\n\n            if (!this._config) {\n                cblcarsLog.debug('[CBLCARSBaseCard._updateCardSize()] Config is not defined. Skipping resize handling.', this, this._logLevel);\n                return;\n            }\n\n            // Store the dimensions in the card's config\n            if (!this._config.variables) {\n                this._config.variables = { card: {} };\n            }\n            this._config.variables.card.width = `${parentWidth}px`;\n            this._config.variables.card.height = `${parentHeight}px`;\n\n            // Trigger an update if necessary\n            this.setConfig(this._config);\n        }\n    }\n\n    _updateResizeObserver() {\n        if (this._isResizeObserverEnabled) {\n            this.enableResizeObserver();\n        } else {\n            this.disableResizeObserver();\n        }\n    }\n\n    enableResizeObserver() {\n        const targetElement = this.resolveTargetElement(this._resizeObserverTarget);\n\n        if (targetElement && this.isConnected) {\n            this._resizeObserver.observe(targetElement);\n            cblcarsLog.debug(`[CBLCARSBaseCard.enableResizeObserver()] Resize observer enabled on [${this._resizeObserverTarget}]`, this, this._logLevel);\n        }\n    }\n\n    disableResizeObserver() {\n        if (this._resizeObserver) {\n            this._resizeObserver.disconnect();\n        }\n        cblcarsLog.debug(`[CBLCARSBaseCard.disableResizeObserver()] Resize observer disabled`, this._logLevel);\n    }\n\n    toggleResizeObserver() {\n        this._isResizeObserverEnabled = !this._isResizeObserverEnabled;\n        this._updateResizeObserver();\n    }\n\n    resolveTargetElement(target) {\n        const targetMapping = {\n            'this': () => this,\n            'this.parentElement': () => this.parentElement,\n            'this.offsetParent': () => this.offsetParent,\n            // Add more mappings as needed\n        };\n\n        return targetMapping[target] ? targetMapping[target]() : this;\n    }\n    _debounce(func, wait) {\n        let timeout;\n        return function(...args) {\n            clearTimeout(timeout);\n            timeout = setTimeout(() => func.apply(this, args), wait);\n        };\n    }\n\n    /**\n     * Rebuild timelines for this card instance.\n     * Safe to call after overlays have been stamped; uses double-rAF for DOM availability.\n     * @param {object} timelinesCfg\n     * @param {object} overlayConfigsById\n     * @param {object} presets\n     */\n    _rebuildTimelines(timelinesCfg, overlayConfigsById = {}, presets = {}) {\n        if (!timelinesCfg) return;\n\n        // Stop previous timelines\n        if (this._timelines && Array.isArray(this._timelines)) {\n        this._timelines.forEach(tl => tl && typeof tl.pause === 'function' && tl.pause());\n        this._timelines = null;\n        }\n\n        // Defer to next paints to ensure DOM is present\n        requestAnimationFrame(() => {\n        requestAnimationFrame(async () => {\n            try {\n            this._timelines = await window.cblcars.anim.createTimelines\n                ? window.cblcars.anim.createTimelines(\n                    timelinesCfg,\n                    this._animationScopeId,\n                    this.shadowRoot,\n                    overlayConfigsById,\n                    this.hass || null,\n                    presets || {}\n                )\n                : (await import('./utils/cb-lcars-anim-helpers.js')).createTimelines(\n                    timelinesCfg,\n                    this._animationScopeId,\n                    this.shadowRoot,\n                    overlayConfigsById,\n                    this.hass || null,\n                    presets || {}\n                );\n            } catch (e) {\n            cblcarsLog.error('[CBLCARSBaseCard._rebuildTimelines] Error creating timelines:', e);\n            }\n        });\n        });\n    }\n}\n\n// Helper: Recursively collect all 'entity' and 'entity_id' values in an object\nfunction collectEntities(obj, entities = []) {\n    if (Array.isArray(obj)) {\n        obj.forEach(item => collectEntities(item, entities));\n    } else if (obj && typeof obj === 'object') {\n        for (const [key, value] of Object.entries(obj)) {\n            if ((key === 'entity' || key === 'entity_id') && typeof value === 'string') {\n                entities.push(value);\n            } else {\n                collectEntities(value, entities);\n            }\n        }\n    }\n    return entities;\n}\n\nclass CBLCARSLabelCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-label-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-label-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            label: \"CB-LCARS Label\",\n            show_label: true\n        };\n    }\n\n    setConfig(config) {\n        const defaultCardType = 'cb-lcars-label';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n\n        super.setConfig(specialConfig);\n    }\n}\n\nclass CBLCARSElbowCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-elbow-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-elbow-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            variables: {\n                card: {\n                    border: {\n                        left: { size: 90 },\n                        top: { size: 20 }\n                    }\n                }\n            }\n        };\n    }\n\n    setConfig(config) {\n\n        const defaultCardType = 'cb-lcars-header';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 1,\n            grid_columns: 4\n        };\n      }\n}\n\n\nclass CBLCARSMSDCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-msd-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-msd-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            enable_resize_observer: true,\n            variables: {\n                card: {\n                    border: {\n                        left: { size: 0 },\n                        right: { size: 0 },\n                        top: { size: 0 },\n                        bottom: { size: 0 }\n                    }\n                }\n            }\n        };\n    }\n\n    setConfig(config) {\n\n        console.log('[MSD DEBUG] 🔧 CBLCARSMSDCard.setConfig() CALLED:', {\n            timestamp: new Date().toISOString(),\n            hasExistingConfig: !!this._config,\n            configType: config.type,\n            configEntity: config.entity,\n            msdAlreadyBooted: !!this._msdV1ComprehensiveBoot,\n            stackTrace: new Error().stack.split('\\n').slice(1, 6).map(line => line.trim()).join(' → ')\n        });\n\n        const defaultTemplates = ['cb-lcars-msd'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        // ENHANCED: Completely prevent any entity tracking for MSD cards\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n            // CRITICAL: Remove all entity references to prevent HA from tracking changes\n            entity: undefined,\n            entities: undefined,\n            triggers_update: [], // Force empty array\n            // Disable all button-card entity behaviors\n            show_state: false,\n            show_icon: false,\n            show_name: false,\n            show_label: false,\n            // Prevent any state-based interactions\n            state: undefined,\n            tap_action: { action: 'none' },\n            hold_action: { action: 'none' },\n            double_tap_action: { action: 'none' }\n        };\n\n        const msdConfig = specialConfig?.msd;\n\n        // Call parent setConfig with sanitized config\n        super.setConfig(specialConfig);\n\n        // ENHANCED: Initialize MSD v1 pipeline for this card instance\n        // This ensures the pipeline is ready when the card renders\n        try {\n            if (msdConfig && window.__msdDebug?.initMsdPipeline) {\n                // Store the MSD config for later pipeline initialization in the template\n                this._msdConfig = msdConfig;\n                console.log('[CBLCARSMSDCard] MSD v1 config prepared for pipeline initialization');\n            }\n        } catch (e) {\n            console.warn('[CBLCARSMSDCard] Failed to prepare MSD v1 pipeline:', e);\n        }\n\n        // PRESERVED: SVG handling logic for proper MSD initialization\n        console.log('[CBLCARSMSDCard] msdConfig:', msdConfig);\n        if (msdConfig && msdConfig.base_svg?.source) {\n            console.log('[CBLCARSMSDCard] Found base SVG:', msdConfig.base_svg.source);\n            let svgKey = null, svgUrl = null;\n\n            if (msdConfig.base_svg.source.startsWith('builtin:')) {\n                svgKey = msdConfig.base_svg.source.replace('builtin:', '');\n            } else if (msdConfig.base_svg.source.startsWith('/local/')) {\n                svgKey = msdConfig.base_svg.source.split('/').pop().replace('.svg','');\n                svgUrl = msdConfig.base_svg.source;\n\n                // Load user SVG if not already cached\n                if (!window.cblcars.getSVGFromCache(svgKey)) {\n                    window.cblcars.loadUserSVG(svgKey, svgUrl)\n                        .then(() => {\n                            // MODIFIED: Only request update if not blocked by our overrides\n                            console.log('[CBLCARSMSDCard] SVG loaded, scheduling safe update');\n                            // Use setTimeout to avoid immediate re-render during setConfig\n                            setTimeout(() => {\n                                if (this.requestUpdate && !this._blockUpdates) {\n                                    this.requestUpdate();\n                                }\n                            }, 100);\n                        })\n                        .catch((error) => {\n                            console.warn('[CBLCARSMSDCard] Failed to load user SVG:', error);\n                        });\n                }\n            }\n\n            this._svgKey = svgKey;\n            console.log('[CBLCARSMSDCard] SVG key stored:', svgKey);\n        }\n\n        console.log('[CBLCARSMSDCard] Config set with disabled entity tracking and SVG handling preserved');\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 4,\n            grid_columns: 4\n        };\n    }\n\n    /**\n     * Override setHass to prevent MSD system re-renders that cause disappearing\n     * MSD system manages its own HASS updates internally\n     */\n    setHass(hass) {\n        console.log('[MSD DEBUG] 🏠 CBLCARSMSDCard.setHass() CALLED:', {\n            timestamp: new Date().toISOString(),\n            hasHass: !!hass,\n            lightDeskState: hass?.states?.['light.desk']?.state,\n            callerStack: new Error().stack.split('\\n').slice(1, 4).map(line => line.trim()).join(' → ')\n        });\n\n        // Store HASS reference but don't call parent setHass which triggers re-renders\n        this.hass = hass;\n\n        // CRITICAL: ALWAYS update SystemsManager with the FRESHEST HASS immediately\n        // This ensures _originalHass is never stale\n        if (this._msdPipeline && this._msdPipeline.systemsManager) {\n            console.log('[MSD DEBUG] 📤 IMMEDIATELY updating SystemsManager with FRESH HASS');\n            console.log('[MSD DEBUG] 📊 Fresh HASS light.desk state being sent:', hass?.states?.['light.desk']?.state);\n\n            // ALSO: Forward fresh HASS directly to controls immediately\n            // This bypasses the entity change detection delay\n            if (this._msdPipeline.systemsManager.controlsRenderer) {\n                console.log('[MSD DEBUG] 📤 Immediately forwarding fresh HASS to controls');\n                this._msdPipeline.systemsManager.controlsRenderer.setHass(hass);\n            }\n        }\n\n        // Forward HASS to the MSD system directly instead of re-rendering the card\n        if (this._msdPipeline && typeof this._msdPipeline.ingestHass === 'function') {\n            console.log('[MSD DEBUG] 📤 Forwarding HASS to MSD pipeline via ingestHass');\n            this._msdPipeline.ingestHass(hass);\n        }\n\n        // CRITICAL: Call parent setHass to ensure Home Assistant's normal HASS flow continues\n        // This ensures the card gets updated when entities change outside of MSD system\n        console.log('[MSD DEBUG] 📤 Calling super.setHass() to maintain HA compatibility');\n        super.setHass(hass);\n\n        console.log('[MSD DEBUG] ✅ CBLCARSMSDCard.setHass() COMPLETED - SystemsManager should now have fresh HASS');\n    }\n\n    /**\n     * Override updated to prevent re-renders\n     */\n    updated(changedProperties) {\n        console.log('[MSD DEBUG] 🔄 CBLCARSMSDCard.updated() CALLED:', {\n            timestamp: new Date().toISOString(),\n            changedProperties: Array.from(changedProperties.keys()),\n            stackTrace: new Error().stack.split('\\n').slice(1, 4).map(line => line.trim()).join(' → ')\n        });\n\n        // Check if this is a control-triggered HASS change\n        if (changedProperties.has('hass') || changedProperties.has('_hass')) {\n            const isControlTriggered = this._isControlTriggeredUpdate();\n\n            if (isControlTriggered) {\n                console.log('[MSD DEBUG] ⏭️ BLOCKED super.updated() for control-triggered HASS change');\n                return;\n            } else {\n                console.log('[MSD DEBUG] 🔄 Allowing super.updated() for non-control HASS change');\n            }\n        }\n\n        console.log('[MSD DEBUG] 🔄 Calling super.updated() for changes:', Array.from(changedProperties.keys()));\n        super.updated(changedProperties);\n    }\n\n\n\n    requestUpdate(name, oldValue, options) {\n        console.log('[MSD DEBUG] 🔃 CBLCARSMSDCard.requestUpdate() CALLED:', {\n            timestamp: new Date().toISOString(),\n            name,\n            hasOldValue: oldValue !== undefined,\n            stackTrace: new Error().stack.split('\\n').slice(1, 4).map(line => line.trim()).join(' → ')\n        });\n\n        // ENHANCED: Block ALL HASS-related updates for MSD cards to prevent re-renders\n        if (name === 'hass' || name === '_hass') {\n            console.log('[MSD DEBUG] 🚫 BLOCKED requestUpdate() for HASS change:', name);\n            console.log('[MSD DEBUG] ⏭️ MSD system manages its own HASS updates internally');\n            return Promise.resolve(); // Block the MSD card from re-rendering\n        }\n\n        console.log('[MSD DEBUG] ✅ Allowing requestUpdate() for:', name);\n        return super.requestUpdate(name, oldValue, options);\n    }\n\n\n\n    /**\n     * Check if the current HASS update is from a control-triggered entity change\n     * @private\n     * @returns {boolean} True if this is a control-triggered update\n     */\n    _isControlTriggeredUpdate() {\n        // Access the MSD system's entity change analysis\n        if (window.__msdDebug?.systemsManager) {\n            const lastAnalysis = window.__msdDebug.systemsManager._lastEntityAnalysis;\n            if (lastAnalysis && lastAnalysis.isControlTriggered) {\n                const timeSinceAnalysis = Date.now() - lastAnalysis.timestamp;\n                // If analysis was recent (within 100ms), consider this a control-triggered update\n                return timeSinceAnalysis < 100;\n            }\n        }\n        return false;\n    }\n\n    connectedCallback() {\n        console.log('[CBLCARSMSDCard.connectedCallback] MSD card connected to DOM');\n        super.connectedCallback();\n    }\n\n    disconnectedCallback() {\n        console.log('[CBLCARSMSDCard.disconnectedCallback] MSD card disconnected from DOM');\n        if (this.msdSystem) {\n            console.log('[CBLCARSMSDCard.disconnectedCallback] Cleaning up MSD system');\n            // Don't destroy the MSD system here in case it's just a temporary disconnect\n        }\n        super.disconnectedCallback();\n    }\n}\n\nclass CBLCARSDoubleElbowCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-double-elbow-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-double-elbow-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            };\n    }\n\n    setConfig(config) {\n\n        const defaultCardType = 'cb-lcars-header-picard';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 1,\n            grid_columns: 4\n        };\n      }\n}\n\nclass CBLCARSMultimeterCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-multimeter-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-multimeter-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            variables: {\n                _mode: 'gauge'\n            }\n        };\n    }\n\n    constructor() {\n        super();\n        this._enableResizeObserver = true;\n    }\n\n    setConfig(config) {\n\n        const defaultTemplates = ['cb-lcars-multimeter'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 1,\n            grid_columns: 4\n        };\n      }\n\n    render() {\n        if (!customElements.get('my-slider-v2')) {\n            return html`<ha-alert alert-type=\"error\" title=\"CB-LCARS - Dependency Error\">Required 'my-slider-v2' card is not available - Please refer to the documentation.</ha-alert>`;\n        }\n\n        // Render the card normally\n        return super.render();\n    }\n}\n\nclass CBLCARSDPADCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-dpad-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-dpad-card';\n    }\n\n    static get defaultConfig() {\n        return {};\n    }\n\n    setConfig(config) {\n\n        const defaultTemplates = ['cb-lcars-dpad'];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_rows: 4,\n            grid_columns: 2\n        };\n      }\n}\n\nclass CBLCARSButtonCard extends CBLCARSBaseCard {\n    static get editorType() {\n        return 'cb-lcars-button-card-editor';\n    }\n\n    static get cardType() {\n        return 'cb-lcars-button-card';\n    }\n\n    static get defaultConfig() {\n        return {\n            label: \"CB-LCARS Button\",\n            show_label: true\n        };\n    }\n\n    setConfig(config) {\n\n        const defaultCardType = 'cb-lcars-button-lozenge';\n        const defaultTemplates = [config.cblcars_card_type ? config.cblcars_card_type : defaultCardType];\n        const userTemplates = (config.template) ? [...config.template] : [];\n        const mergedTemplates = [...defaultTemplates, ...userTemplates];\n\n        const specialConfig = {\n            ...config,\n            template: mergedTemplates,\n        };\n        super.setConfig(specialConfig);\n\n    }\n\n    getLayoutOptions() {\n        return {\n            grid_min_rows: 1,\n            grid_rows: 1,\n            grid_columns: 2,\n            grid_min_columns: 1\n        };\n      }\n}\n\n// Helper function to define custom elements and their editors\nfunction defineCustomElement(cardType, cardClass, editorType, editorClass) {\n    customElements.define(cardType, cardClass);\n    customElements.define(editorType, class extends editorClass {\n        constructor() {\n            super(cardType);\n        }\n    });\n}\n\n// Register the cards to be available in the GUI editor\nwindow.customCards = window.customCards || [];\nconst CBLCARSCardClasses = [\n    {\n        type: 'cb-lcars-base-card',\n        name: 'CB-LCARS Base Card',\n        description: 'For advanced use: the CB-LCARS base card for full manual configuration.',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-label-card',\n        name: 'CB-LCARS Label',\n        preview: true,\n        description: 'CB-LCARS label card for text.',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-elbow-card',\n        name: 'CB-LCARS Elbow',\n        preview: true,\n        description: 'CB-LCARS Elbow card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-double-elbow-card',\n        name: 'CB-LCARS Double Elbow',\n        preview: true,\n        description: 'CB-LCARS Double Elbow card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-multimeter-card',\n        name: 'CB-LCARS Multimeter',\n        preview: true,\n        description: 'CB-LCARS Multimeter card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-dpad-card',\n        name: 'CB-LCARS D-Pad',\n        preview: true,\n        description: 'CB-LCARS D-Pad card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-button-card',\n        name: 'CB-LCARS Button',\n        preview: true,\n        description: 'CB-LCARS Buttons [various styles]',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    },\n    {\n        type: 'cb-lcars-msd-card',\n        name: 'CB-LCARS MSD',\n        preview: true,\n        description: 'CB-LCARS Master Systems Display (MSD) card',\n        documentationURL: \"https://cb-lcars.unimatrix01.ca\",\n    }\n];\n\nwindow.customCards.push(...CBLCARSCardClasses);","import { initMsdPipeline, initMsdHud } from './pipeline/PipelineCore.js';\nimport { processMsdConfig } from './pipeline/ConfigProcessor.js';\nimport { mergePacks, validateMerged } from './pipeline/ConfigProcessor.js';\nimport { buildCardModel } from './model/CardModel.js';\n\n// Import tests and services\nimport \"./tests/routingScenarios.js\"\nimport \"./tests/smartRoutingScenarios.js\"\nimport \"./tests/channelsRoutingScenarios.js\"\nimport \"./tests/arcsRoutingScenarios.js\";\nimport \"./tests/smoothingRoutingScenarios.js\";\nimport \"./hud/hudService.js\";\n\n// Main exports\nexport { initMsdPipeline, initMsdHud, processMsdConfig };\n\n// Utility exports\nexport { mergePacks, validateMerged };\n\n// Debug exposure\n(function attachDebug() {\n  if (typeof window === 'undefined') return;\n\n  window.__msdDebug = window.__msdDebug || {};\n  Object.assign(window.__msdDebug, {\n    mergePacks,\n    buildCardModel,\n    initMsdPipeline,\n    initMsdHud\n  });\n\n  // Enhanced debug interface\n  Object.assign(window.__msdDebug, {\n    // Authoritative pipeline instance\n    pipelineInstance: null,\n\n    // Initialize MSD pipeline\n    async initMsdPipeline(mergedConfig, mount, hass) {\n      try {\n        const pipelineApi = await initMsdPipeline(mergedConfig, mount, hass);\n\n        // Set the authoritative pipelineInstance property\n        this.pipelineInstance = pipelineApi;\n\n        return pipelineApi;\n      } catch (error) {\n        console.error('[MSD Debug] Pipeline initialization failed:', error);\n        throw error;\n      }\n    }\n  });\n\n  // DataSourceManager property with getter\n  Object.defineProperty(window.__msdDebug, 'dataSourceManager', {\n    get() {\n      // Simplified: Use pipelineInstance as single source of truth\n      return window.__msdDebug.pipelineInstance?.dataSourceManager ||\n             window.__msdDebug.pipelineInstance?.systemsManager?.dataSourceManager;\n    },\n    configurable: true  // Allow it to be redefined if needed\n  });\n})();\n\n\n","export function getLovelace() {\n    let root = document.querySelector('home-assistant');\n    root = root && root.shadowRoot;\n    root = root && root.querySelector('home-assistant-main');\n    root = root && root.shadowRoot;\n    root = root && root.querySelector('app-drawer-layout partial-panel-resolver, ha-drawer partial-panel-resolver');\n    root = (root && root.shadowRoot) || root;\n    root = root && root.querySelector('ha-panel-lovelace');\n    root = root && root.shadowRoot;\n    root = root && root.querySelector('hui-root');\n    if (root) {\n      const ll = root.lovelace;\n      ll.current_view = root.___curView;\n      return ll;\n    }\n    return null;\n  }\n\n  export function checkLovelaceTemplates(config) {\n    const ll = getLovelace();\n    const lovelaceTemplates = ll && ll.config && ll.config.cblcars_card_templates ? ll.config.cblcars_card_templates : {};\n    let isUsingLovelaceTemplate = false;\n    let overriddenTemplates = [];\n\n    let templates = config.template || [];\n\n    for (const template of templates) {\n        if (lovelaceTemplates.hasOwnProperty(template)) {\n            isUsingLovelaceTemplate = true;\n            overriddenTemplates.push(template);\n        }\n    }\n\n    // Remove duplicates and sort the array\n    overriddenTemplates = [...new Set(overriddenTemplates)].sort();\n\n    return { isUsingLovelaceTemplate, overriddenTemplates };\n}"],"names":["inProgress","dataWebpackPrefix","t","r","e","__assign","Object","assign","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","this","DEFAULT_THRESHOLDS","second","minute","hour","day","format","Intl","DateTimeFormat","language","weekday","month","a","o","year","u","c","m","l","d","f","g","h","system","comma_decimal","decimal_comma","space_comma","none","am_pm","twenty_four","b","time_format","Date","toLocaleString","includes","v","_","hour12","y","w","k","x","D","S","F","T","I","N","M","from","to","thresholds","now","resolvedThresholds","secs","Math","abs","value","round","unit","mins","hours","SECS_PER_MIN","days","SECS_PER_HOUR","fromDate","toDate","years","getFullYear","months","getMonth","weeks","SECS_PER_DAY","RelativeTimeFormat","numeric","NumberFormat","style","unitDisplay","C","attributes","remaining","split","map","Number","state","getTime","last_changed","max","O","q","_themes","default_theme","themes","keys","forEach","updateStyles","window","ShadyCSS","styleSubtree","document","querySelector","hasAttribute","setAttribute","getAttribute","A","getCardSize","E","substr","indexOf","j","R","locale","translationMetadata","translations","isRTL","z","L","entity_id","P","unit_of_measurement","state_class","U","number_format","B","pow","H","isNaN","V","console","error","maximumFractionDigits","toString","currency","minimumFractionDigits","W","device_class","has_date","has_time","setHours","join","toISOString","humidity","G","J","K","Q","X","Y","Z","$","Set","ee","te","re","ne","Event","bubbles","cancelable","Boolean","composed","detail","dispatchEvent","ie","ae","alert","automation","climate","cover","fan","group","input_boolean","input_number","input_select","input_text","light","lock","media_player","remote","scene","script","sensor","timer","switch","vacuum","water_heater","input_datetime","oe","type","config","createElement","setConfig","message","startsWith","has","entity","customElements","get","display","setTimeout","whenDefined","then","clearTimeout","ue","slice","ce","calendar","camera","configurator","conversation","device_tracker","history_graph","homeassistant","homekit","image_processing","mailbox","notify","person","plant","proximity","simple_alarm","sun","updater","weblink","me","warn","se","attribute","operator","match","le","de","history","replaceState","pushState","replace","fe","callService","ge","states","pe","action","confirmation","exemptions","some","user","id","confirm","text","camera_image","entityId","navigation_path","url_path","open","service","service_data","target","he","double_tap_action","hold_action","tap_action","be","haptic","ve","_e","hass","ye","we","push","ke","shadowRoot","lovelace","current_view","___curView","xe","illuminance","temperature","pressure","power","signal_strength","De","binary_sensor","Se","icon","defineProperty","exports","getNestedProperty","deepMerge","source","output","key","targetValue","sourceValue","Array","isArray","isObject","generateControl","control","card","context","_hass","isVisible","visibilityCondition","_evaluateCondition","isDisabled","disabledCondition","isRequired","requiredCondition","selector","select","optionsCondition","options","lit_1","html","configValue","_config","label","helper","_valueChanged","alertType","title","unsafe_html_js_1","unsafeHTML","displayText","colorValue","isCssVariable","computedColorValue","cssVariableNameMatch","cssVariableName","getComputedStyle","documentElement","getPropertyValue","trim","hexToRgb","hex","bigint","parseInt","textColor","nr","ng","nb","getLuminance","obj","path","reduce","acc","part","custom_card_helpers_1","interfaces_1","controls_1","EditorForm","LitElement","constructor","super","_selectedTab","_userStyles","css","_mergeUserStyles","requestUpdate","generateForm","cardConfigData","tabs","generateTabs","formControls","render_form","row","isSection","generateSection","generateRow","_handleTabActivated","event","name","visibleTabs","filter","tab","index","content","item","section","_a","cssClass","headerTag","headerLevel","headerContent","secondary","expanded","noCollapse","outlined","leftChevron","rows","controls","condition","Function","ev","_b","configPath","newValue","_getNewValue","tagName","_updateConfig","fireEvent","_c","checked","__checked","values","nestedConfig","lastKey","updated","changedProperties","adoptedStyleSheets","styles","styleSheet","isControlRow","CBLCARS_VERSION","version","project_url","core_fonts","templates_uri","stub_config_uri","theme_colors_uri","card_editor_uri","builtin_svg_keys","builtin_svg_basepath","pi","__msdDebug","pipelineInstance","enabled","Error","inspect","routing","invalidate","scope","__msdScenarios","targetLine","ensureRound","lineId","ov","getResolvedModel","overlays","find","_raw","corner_style","corner_radius","scenarios","arc_presence","res","ok","test","meta","arc","count","details","dSample","radius_clamp","original","trimPx","arc_cache_reuse","first","cache_hit","firstHit","secondHit","arcCount","miter_fallback","origStyle","hasArcMeta","api","list","run","log","String","runAll","allOk","every","arcs","info","scenarioPreferImprovesCost","origChannels","route_channels","origMode","route_channel_mode","base","preferred","cost","baseCost","preferCost","scenarioAvoidIncreasesCost","prefer","avoid","avoidCost","scenarioForcePenalty","forced","channel","forcedOutside","coveragePct","scenarioPreferShapingCoverage","save","channels","mode","modeFull","route_mode_full","c1","setAnchor","anchorId","anchor","rm","anchors","c2","coverageBefore","coverageAfter","prefer_improves_cost","avoid_increases_cost","force_penalty_or_full_coverage","prefer_shaping_coverage","force_downgrade_or_full","chan","shaping","downgraded","channel_acceptance","force","requirePipeline","getModel","lastRenderModel","findOverlay","listOverlays","result","color","cache","grid_vs_manhattan","grid","man","strategy","gridStrategy","manStrategy","avoid_creates_bend","targetId","before","originalAvoid","undefined","after","bends","bendsBefore","bendsAfter","mode_hint_yx","route_mode","yx","basePts","pts","yxPts","baseHorizontalFirst","yxVerticalFirst","clearance_shift","router","orig","clearance","raised","raisedCost","anchor_move","model","moved","fallback_impossible_grid","originalComputeGrid","_computeGrid","req","results","summaryOk","withMode","fn","smart_vs_grid_cost","smart","gridCost","smartCost","smart_refinement_attempt","smartMeta","detoursTried","smart_penalty_reduction","baseSmart","penaltyAfter","penaltyBefore","smart_cache_behavior","setMode","ensureBaseline","smoothing_increases_points","smoothing_mode","smoothing_iterations","sm","smooth","smoothPts","smoothing_cache_hit","smoothing_disabled_no_meta","hasSmoothMeta","smoothing_invalid_mode_fallback","smoothing","waitForElement","root","timeout","Promise","resolve","reject","found","observer","MutationObserver","el","disconnect","observe","childList","subtree","async","waitForElements","targets","items","Element","selectors","sel","allNow","querySelectorAll","animateWithRoot","scopeId","animOptions","elements","element","animation","cblcars","anim","scopes","scopeObj","anime","addAnimation","animateElement","debug","add","params","duration","easing","state_resolver","styleHelpers","resolveStateStyles","resolvedStyles","applyPresets","presetFn","toLowerCase","morph_to_selector","morphTarget","precision","animejs","svg","morphTo","_cssAnimation","createTimeline","timelineConfig","timeline","step","offset","vars","createTimelines","timelinesConfig","overlayConfigs","stylePresets","timelines","resolveAll","resolveAllDynamicValues","timelineName","entries","steps","timelineGlobals","resolvedGlobals","mergedParams","resolveStatePreset","overrides","transformOrigin","transformBox","__timeline","direction","preset","deep","descendants","apply_to","animeParams","applyToDescendants","immediateKeys","immediateSet","userOnBegin","onBegin","nodes","utils","set","prop","val","autoplay","types","presetList","animPresets","draw","drawable","createDrawable","loop","alternate","drawCfg","drawValues","opacity","pulse","pulseCfg","maxScale","max_scale","minOpacity","min_opacity","scale","cssText","width","parseFloat","strokeWidth","blink","max_opacity","fade","motionpath","tracerCfg","tracer","msg","pathSelector","path_selector","pathEl","catch","errorMsg","baseId","hasUsablePathD","pathLengthOk","getTotalLength","isPending","cleanupArtifacts","svgRoot","ownerSVGElement","closest","priorTracer","priorTrail","parentNode","removeChild","trailPath","tracerNode","pathMutationObserver","alive","buildTrail","trailOpt","trail","cloneNode","stroke","sw","insertBefore","nextSibling","trailVars","buildTracer","tid","existing","getElementById","tracerMarkup","shape","height","attrs","fill","cx","cy","temp","createElementNS","innerHTML","firstElementChild","appendChild","bindTracerAnimation","translateX","translateY","rotate","createMotionPath","exclude","merged","__cblcars_motion","pause","rebindAll","reason","removeAttribute","initArtifacts","waitMaxMs","isFinite","wait_max_ms","pollInterval","startTime","performance","waitForReady","tick","pending","usable","muts","needs","attributeName","attributeFilter","pathId","reattachPoll","current","SVGPathElement","__cblcars_motionpath_cleanup","march","dashArray","stroke_dasharray","dashLength","gapLength","strokeDasharray","strokeDashoffset","linecap","stroke_linecap","strokeLinecap","cycleLength","durationSec","reversed","animId","random","substring","dataset","marchAnimId","offsetTarget","loopValue","iterationCount","targetDoc","getRootNode","isInShadowDOM","animationName","keyframesStr","effectiveDuration","playbackRate","sheet","marchAnimations","CSSStyleSheet","insertRule","cssRules","fallbackStyleInjection","styleId","styleEl","head","textContent","glow","glowCfg","intensity","blurMin","blur_min","blurMax","blur_max","opacityMin","opacity_min","opacityMax","opacity_max","glowState","blur","onUpdate","shimmer","strobe","cascade","delay","stagger","ripple","flicker","ignoreKeys","allParams","propsToSet","animeSetWorked","cblcarsGlobalLogLevel","cblcarsSetGlobalLogLevel","level","cblcarsLog","cblcarsGetGlobalLogLevel","baseLogger","args","levels","currentLevelIndex","levelStyles","default","logMessage","cblcarsLogBanner","url","baseString","spacesNeeded","spaces","repeat","paddedUrl","setGlobalLogLevel","getGlobalLogLevel","drawLine","x1","y1","x2","y2","attrsToString","styleToString","drawPolyline","points","pt","drawPath","drawText","drawCircle","drawRect","globalThis","trustedTypes","createPolicy","createHTML","toFixed","createComment","Symbol","iterator","RegExp","_$litType$","strings","for","WeakMap","createTreeWalker","lastIndex","exec","parts","currentNode","firstChild","replaceWith","childNodes","nextNode","nodeType","hasAttributes","getAttributeNames","endsWith","ctor","emptyScript","append","data","_$Co","_$Cl","_$litDirective$","_$AO","_$AT","_$AS","_$AV","_$AN","_$AD","_$AM","_$AU","creationScope","importNode","_$AI","_$Cv","_$AH","_$AA","_$AB","isConnected","startNode","endNode","_$AR","createTextNode","_$AC","_$AP","remove","setConnected","toggleAttribute","capture","once","passive","removeEventListener","addEventListener","handleEvent","host","litHtmlPolyfillSupport","litHtmlVersions","renderBefore","_$litPart$","_$Ct","_$Ci","update","render","it","directiveName","_t","raw","resultType","ShadowRoot","nativeShadow","Document","_$cssResult$","replaceSync","litNonce","is","getOwnPropertyDescriptor","getOwnPropertyNames","getOwnPropertySymbols","getPrototypeOf","reactiveElementPolyfillSupport","toAttribute","JSON","stringify","fromAttribute","parse","converter","reflect","useDefault","hasChanged","metadata","litPropertyMetadata","HTMLElement","addInitializer","_$Ei","observedAttributes","finalize","_$Eh","createProperty","create","wrapped","elementProperties","noAccessor","getPropertyDescriptor","configurable","enumerable","getPropertyOptions","Map","finalized","properties","_$Eu","elementStyles","finalizeStyles","flat","reverse","unshift","_$Ep","isUpdatePending","hasUpdated","_$Em","_$Ev","_$ES","enableUpdating","_$AL","_$E_","addController","_$EO","renderRoot","hostConnected","removeController","delete","size","createRenderRoot","attachShadow","shadowRootOptions","connectedCallback","disconnectedCallback","hostDisconnected","attributeChangedCallback","_$AK","_$ET","_$Ej","_$EP","_$Eq","scheduleUpdate","performUpdate","shouldUpdate","willUpdate","hostUpdate","_$EM","_$AE","hostUpdated","firstUpdated","updateComplete","getUpdateComplete","ReactiveElement","reactiveElementVersions","renderOptions","_$Do","_$litElement$","litElementHydrateSupport","litElementPolyfillSupport","litElementVersions","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__","definition","chunkId","all","promises","done","needAttach","scripts","getElementsByTagName","charset","nc","src","onScriptComplete","prev","onerror","onload","doneFns","bind","toStringTag","scriptUrl","importScripts","location","currentScript","toUpperCase","installedChunks","installedChunkData","promise","errorType","realSrc","request","webpackJsonpCallback","parentChunkLoadingFunction","chunkIds","moreModules","runtime","chunkLoadingGlobal","self","isBrowser","win","doc","compositionTypes","blend","isRegisteredTargetSymbol","isDomSymbol","isSvgSymbol","transformsSymbol","morphPointsSymbol","proxyTargetSymbol","minValue","maxValue","emptyString","shortTransforms","validTransforms","transformsFragmentStrings","noop","hexTestRgx","rgbExecRgx","rgbaExecRgx","hslExecRgx","hslaExecRgx","digitWithExponentRgx","unitsExecRgx","lowerCaseRgx","transformsExecRgx","relativeValuesExecRgx","defaults","keyframes","playbackEase","frameRate","loopDelay","ease","composition","modifier","onBeforeUpdate","onLoop","onPause","onComplete","onRender","globals","timeScale","tickThreshold","globalVersions","engine","AnimeJS","str","stringStartsWith","sub","isArr","isObj","isNum","isStr","isFnc","isUnd","isNil","isSvg","SVGElement","isHex","isRgb","isHsl","isKey","parseNumber","sqrt","sin","cos","exp","ceil","floor","asin","atan2","PI","_round","clamp","min","powCache","decimalLength","snap","increment","cv","interpolate","start","end","progress","clampInfinity","Infinity","normalizeTime","cloneArray","mergeObjects","o1","o2","o1p","forEachChildren","parent","callback","prevProp","nextProp","next","_head","adjustedNextProp","_tail","currentNext","child","addChild","sortMethod","Clock","initTime","deltaTime","_currentTime","_elapsedTime","_startTime","_lastTime","_scheduledTime","_frameDuration","_fps","_speed","_hasChildren","fps","previousFrameDuration","fr","frameDuration","speed","pbr","requestTick","time","scheduledTime","elapsedTime","frameDelta","computeDeltaTime","delta","tickable","muteCallbacks","internalRender","tickMode","completed","iterationDuration","_currentIteration","_loopDelay","_reversed","_alternate","tickableDelay","_delay","tickablePrevAbsoluteTime","tickableEndTime","tickableAbsoluteTime","tickablePrevTime","tickableCurrentTime","isCurrentTimeAboveZero","isCurrentTimeEqualOrAboveDuration","isSetter","forcedTick","isOdd","iterationElapsedTime","hasRendered","currentIteration","isReversed","_ease","iterationTime","isRunningBackwards","backwards","_iterationTime","began","forcedRender","absoluteTime","_offset","tweenTarget","tweenStyle","tweenTargetTransforms","tweenTargetTransformsProperties","tween","tweenTransformsNeedUpdate","tweenComposition","_composition","tweenCurrentTime","tweenChangeDuration","_changeDuration","tweenAbsEndTime","_absoluteStartTime","tweenNextRep","_nextRep","tweenPrevRep","_prevRep","tweenHasComposition","_isOverridden","_isOverlapped","tweenNewTime","tweenProgress","_updateDuration","tweenModifier","_modifier","tweenValueType","_valueType","tweenType","_tweenType","tweenIsObject","tweenIsNumber","tweenPrecision","number","_fromNumber","_toNumber","_unit","_fromNumbers","tn","_toNumbers","ns","_numbers","_strings","_number","_value","tweenProperty","property","setProperty","_renderTransforms","transform","_next","paused","_resolve","tl","tlIsRunningBackwards","tlChildrenTime","tlCildrenTickTime","tlChildrenHasRendered","tlChildrenHaveCompleted","tlIterationDuration","childDuration","childStartTime","childTime","childTickMode","additive","engineTickMethod","requestAnimationFrame","setImmediate","engineCancelMethod","cancelAnimationFrame","clearImmediate","Engine","useDefaultMainLoop","pauseOnDocumentHidden","hidden","reqId","engineSpeed","engineFps","activeTickable","nextTickable","_running","_cancelled","cancel","wake","tickEngine","killEngine","resume","resetTime","timeUnit","isSecond","newScale","scaleFactor","getNodeList","NodeList","HTMLCollection","parseTargets","flattened","parsed","nodeList","jl","subItem","isDuplicate","kl","registerTargets","parsedTargetsArray","parsedTargetsLength","isSvgType","getPath","$parsedSvg","getPathPoint","$path","lookup","getPointAtLength","getPathProgess","pathProperty","$el","totalLength","inSvg","ctm","getCTM","p0","p1","cssReservedProperties","path2","$path1","$path2","isPath","separator","previousPoints","v1","v2","length1","length2","maxPoints","pointOnPath1","pointOnPath2","prefix","pathLength","computedStyles","strokeLineCap","$scalled","vectorEffect","currentCap","proxy","Proxy","getScaleFactor","os","d1","d2","newCap","Reflect","createDrawableProxy","hue2rgb","setValue","defaultValue","getFunctionValue","total","store","func","computed","getTweenType","propertyName","elParentNode","isValidSVGAttribute","getCSSValue","propName","animationInlineStyles","inlineStyles","getOriginalAnimatableValue","inlineTransforms","inlinedStylesPropertyValue","cachedTransforms","inlinePropertyName","inlinePropertyValue","parseInlineTransforms","trimStart","getRelativeValue","decomposeRawValue","rawValue","targetObject","num","unitMatch","isCol","colorString","rgbValue","rgba","rgbToRgba","hexValue","hexLength","isShort","hexToRgba","hslValue","hsla","hslToRgba","matchedNumbers","decomposeTweenValue","decomposedOriginalValue","lookups","_rep","_add","getTweenSiblings","lookupMap","targetLookup","addTweenSortMethod","overrideTween","composeTween","siblings","tweenCompositionType","tweenAbsStartTime","prevSibling","prevParent","prevAbsEndTime","prevPrevSibling","absoluteUpdateStartTime","prevChangeStartTime","prevTLOffset","pausePrevParentAnimation","prevParentTL","pausePrevParentTL","additiveTweenSiblings","additiveAnimation","propertyAnimation","tweens","lookupTween","valueType","additiveValues","additiveValue","_prevAdd","addAdditiveAnimation","_prev","toNumber","toNumbers","removeTweenSliblings","tweenReplaceSiblings","addTweensLookup","addTargetProps","shouldClean","resetTimerProperties","reviveTimer","timerId","Timer","parameters","parentPosition","revertibles","timerInitTime","timerDefaults","timerDelay","timerDuration","timerLoop","timerLoopDelay","timerIterationCount","offsetPosition","_autoplay","_reverse","cancelled","reset","play","currentTime","seek","iterationCurrentTime","iterationProgress","init","linked","link","restart","isPaused","iterations","stretch","newDuration","currentDuration","normlizedDuration","revert","ap","complete","onResolve","createTimer","calcBezier","aT","aA1","aA2","cubicBezier","mX1","mY1","mX2","mY2","aX","currentX","currentT","aA","aB","binarySubdivide","fromStart","roundMethod","linear","argsLength","totalPoints","firstArg","lastArg","xPoints","yPoints","arg","splitValue","percent","prevX","prevY","irregular","randomness","previousValue","spacing","randomValue","halfPI","doublePI","easeInPower","easeInFunctions","Quad","Cubic","Quart","Quint","Sine","Circ","Expo","Bounce","pow2","Back","overshoot","Elastic","amplitude","period","easeTypes","in","easeIn","out","inOut","outIn","parseEaseString","string","easesFunctions","easesLookups","parsedFn","eases","easeType","JSEasesLookups","parseEasings","propertyNamesCache","sanitizePropertyName","cachedPropertyName","lowerCaseName","angleUnitsMap","convertedValuesCache","convertValueUnit","decomposedValue","currentUnit","currentNumber","cachedKey","cached","convertedValue","baseline","tempEl","parentEl","body","elStyle","currentUnitWidth","offsetWidth","factor","cleanInlineStyles","renderable","targetStyle","originalInlinedValue","_inlineStyles","removeProperty","fromTargetObject","toTargetObject","toFunctionStore","keyframesTargetArray","fastSetValuesArray","keyObjectTarget","tweenId","JSAnimation","fastSet","parsedTargets","targetsLength","kfParams","propertyNames","concat","propArray","newKey","keyValue","totalDuration","sort","prevKey","keyObj","durProgress","prevEase","currentEase","shift","generateKeyframes","animDefaults","animaPlaybackEase","animEase","hasSpring","tEasing","tDuration","tDelay","tModifier","tComposition","animInlineStyles","absoluteOffsetTime","NaN","iterationDelay","animationAnimationLength","shouldTriggerRender","targetIndex","ti","lastTransformGroupIndex","lastTransformGroupLength","propValue","isPropValueArray","arrayLength","isNotObjectValue","prevTween","firstTweenChangeStartTime","lastTweenChangeEndTime","tweenIndex","keyframe","computedToValue","tweenToValue","tweenFromValue","keyEasing","tweenEasing","tweenDuration","tweenDelay","computedComposition","hasFromvalue","hasToValue","isFromToArray","isFromToValue","tweenStartTime","absoluteStartTime","complexValue","notComplexValue","unitValue","notUnitValue","notColorValue","valueToConvert","longestValue","shortestValue","tweenUpdateDuration","_func","_nextAdd","additiveTween","refresh","ogValue","animate","easingToLinear","samples","WAAPIEasesLookups","WAAPIeases","parseWAAPIEasing","parsedEase","transformsShorthands","commonDefaultPXProperties","validIndividualTransforms","axis","transformsPropertiesRegistered","CSS","WAAPIAnimationsLookups","removeWAAPIAnimation","nextLookup","matchTarget","matchProperty","matchParent","commitStyles","lookupParent","_completed","animations","addWAAPIAnimation","animTotalDuration","controlAnimation","handleRemove","onremove","onfinish","normalizeTweenValue","parseIndividualTweenValue","tweenValue","computedTo","WAAPIAnimation","isSkew","isScale","isRotate","isTranslate","isAngle","syntax","registerProperty","inherits","initialValue","spring","scroll","hasIndividualTransforms","composite","tweenParams","propertyValue","individualTransformProperty","parsedPropertyValue","tweenOptions","tweenOptionsEase","tweenOptionsSpring","transforms","cb","waapi","convertEase","sync","getTargetValue","targetSelector","normalizePropName","originalValue","setTargetValues","removeTargetsFromAnimation","targetsArray","tweensMatchesTargets","tweenName","waapiAnimation","removeMatches","childDur","mapRange","inLow","inHigh","outLow","outHigh","lerp","amount","dt","ticker","chain","__","nextArgs","nextResult","makeChainable","right","last","curry","randomPick","shuffle","wrap","roundPad","padStart","padString","padEnd","degToRad","degrees","radToDeg","radians","parseTimelinePosition","timePosition","tlDuration","timePosStr","tlLabels","labels","hasLabels","prevOffset","goToPrevAnimationOffset","prevAnimation","getPrevChildOffset","hasSibling","matchedRelativeOperator","fullOperator","labelOffset","parsedOffset","parsedNumericalOffset","addTlChild","childParams","adjustedPosition","tlChild","getTimelineTotalDuration","Timeline","defaultsParams","globalDefaults","tlPlaybackEase","a1","a2","a3","isAnim","isTimer","staggeredPosition","parsedLength","staggeredChildParams","synced","position","effect","getTiming","labelName","Animatable","globalParams","paramValue","isObjValue","propParams","animParams","numbers","createAnimatable","Spring","timeStep","restThreshold","restDuration","maxDuration","maxRestSteps","maxIterations","mass","stiffness","damping","velocity","w0","zeta","wd","solverDuration","compute","solve","solverTime","restSteps","createSpring","preventDefault","DOMProxy","zIndex","parentElement","classList","getBoundingClientRect","top","bottom","left","Transforms","point","DOMPoint","inversedMatrix","getMatrix","inverse","normalizePoint","matrixTransform","traverseUp","matrix","DOMMatrix","transformValue","elMatrix","preMultiplySelf","ct","parseDraggableFunctionParameter","draggable","Draggable","paramX","paramY","trigger","releaseEase","customEase","xProp","mapTo","yProp","container","containerArray","$container","useWin","$scrollContainer","$target","$trigger","fixed","isFinePointer","containerPadding","containerFriction","releaseContainerFriction","snapX","snapY","scrollSpeed","scrollThreshold","dragSpeed","maxVelocity","minVelocity","velocityMultiplier","cursor","releaseXSpring","releaseMass","releaseStiffness","releaseDamping","releaseYSpring","outQuint","hasReleaseSpring","onGrab","onDrag","onRelease","onSettle","onSnap","onResize","onAfterResize","disabled","animatableParams","paramXObject","animatableXParams","paramYObject","animatableYParams","destX","destY","deltaX","deltaY","coords","snapped","pointer","scrollView","dragArea","containerBounds","scrollBounds","targetBounds","velocityStack","velocityStackIndex","velocityTime","angle","cursorStyles","triggerStyles","bodyStyles","targetStyles","touchActionStyles","overshootCoords","overshootXTicker","overshootYTicker","updateTicker","manual","contained","grabbed","dragged","released","canScroll","initialized","activeProp","hasReleased","dx","dy","computeVelocity","resizeTicker","resizeObserver","ResizeObserver","enable","prevTime","curTime","elapsed","vMul","minV","maxV","vi","setX","muteUpdateCallback","setY","progressX","progressY","updateScrollCoords","sx","scrollX","scrollLeft","sy","scrollY","scrollTop","cpt","cpr","cpb","cpl","threshold","updateBoundingValues","cx2","cy2","iw","innerWidth","ih","innerHeight","uw","scrollWidth","sh","scrollHeight","fx","transformContainerRect","containerOverflow","visibleOverflow","hiddenOverflow","targetRect","hiddenLeft","hiddenTop","hiddenRight","hiddenBottom","isOutOfBounds","bounds","bt","br","bb","bl","obx","oby","cp","parsedCursorStyles","onHover","matchMedia","matches","daw","dah","csx","csy","nsw","nsh","csw","csh","swd","shd","st","sr","sb","sl","nx","ny","scrollBy","scrollTo","cr","cl","px1","py1","px2","py2","px3","py3","cf","nsx","nsy","stop","scrollInView","gap","inOutQuad","handleHover","animateInView","ob","disabledX","disabledY","dur","handleDown","$eTarget","stopPropagation","touches","changedTouches","eventX","clientX","eventY","clientY","handleMove","movedX","movedY","$parent","isAtTop","isAtBottom","canTouchScroll","overflowY","clientHeight","pointerEvents","handleUp","springX","springY","pv","pa","ds","bx","by","durationX","durationY","easeX","easeY","longestReleaseDuration","directionX","distanceX","directionY","distanceY","hasSnapped","touchAction","disable","createDraggable","Scope","rootParam","nativeElement","scopeDefaults","globalDefault","mediaQueries","constructors","revertConstructors","methods","mediaQueryLists","mq","_mq","execute","activeScope","activeRoot","activeDefaults","mqs","returned","revertConstructor","createScope","parseScrollObserverFunctionParameter","scroller","scrollContainers","ScrollContainer","winWidth","winHeight","prevScrollX","prevScrollY","backwardX","backwardY","scrollTicker","dataTimer","handleScroll","px","py","updateWindowBounds","refreshScrollObservers","wakeTicker","updateBounds","offsetHeight","getMaxViewHeight","marginLeft","marginRight","marginTop","marginBottom","elRect","_debug","removeDebug","unobserve","convertValueToPx","under","over","clampMin","clampMax","parseBoundValue","matchedOperator","splitter","splitted","valueAPx","valueBPx","getAnimationDomTarget","$linkedTarget","linkedTargets","scrollerIndex","debugColors","ScrollObserver","syncMode","isLinear","isEase","isSmooth","isMethods","syncMethods","biDirSync","scrollContainer","registerAndGetScrollContainer","horizontal","enter","leave","syncEase","syncSmooth","onSyncEnter","onSyncLeave","onSyncEnterForward","onSyncLeaveForward","onSyncEnterBackward","onSyncLeaveBackward","onEnter","onLeave","onEnterForward","onLeaveForward","onEnterBackward","onLeaveBackward","onSyncComplete","reverted","isInView","forceEnter","hasEntered","offsets","offsetStart","offsetEnd","distance","prevProgress","debugStyles","$debug","_params","backward","isHori","$existingDebug","$thresholds","$triggers","containerWidth","containerHeight","offLeft","offTop","half","labelHeight","labelWidth","labelSize","gradientOffset","lineCSS","baseCSS","isView","isTail","isFirst","isOver","isFlip","$label","$text","dirProp","flipOffset","stickys","linkedTime","offsetX","offsetY","$offsetParent","isContainerStatic","isSticky","offsetLeft","offsetTop","offsetParent","targetSize","containerSize","maxScroll","enterTarget","leaveTarget","enterContainer","leaveContainer","parsedEnterTarget","parsedLeaveTarget","parsedEnterContainer","parsedLeaveContainer","scrollDelta","sticky","shouldSeek","isBefore","isAfter","isOnTheEdge","syncCompleted","lp","onScroll","hasEasing","staggerEase","fromFirst","fromCenter","fromLast","isRange","val1","val2","fromIndex","fromX","fromY","isNothing","subject","common","toArray","sequence","cycle","isNegativeZero","NEGATIVE_INFINITY","extend","sourceKeys","formatError","exception","compact","where","mark","line","column","snippet","YAMLException$1","captureStackTrace","stack","getLine","buffer","lineStart","lineEnd","maxLineLength","tail","maxHalfLength","pos","TYPE_CONSTRUCTOR_OPTIONS","YAML_NODE_KINDS","tag","kind","construct","instanceOf","predicate","represent","representName","defaultStyle","multi","styleAliases","alias","compileStyleAliases","compileList","schema","currentType","newIndex","previousType","previousIndex","Schema$1","implicit","explicit","type$1","loadKind","compiledImplicit","compiledExplicit","compiledTypeMap","scalar","mapping","fallback","collectType","compileMap","seq","failsafe","_null","object","canonical","lowercase","uppercase","camelcase","empty","bool","isHexCode","isOctCode","isDecCode","ch","hasDigits","charCodeAt","sign","binary","octal","decimal","hexadecimal","YAML_FLOAT_PATTERN","SCIENTIFIC_WITHOUT_DOT","POSITIVE_INFINITY","json","core","YAML_DATE_REGEXP","YAML_TIMESTAMP_REGEXP","timestamp","date","fraction","UTC","setTime","merge","BASE64_MAP","code","idx","bitlen","charAt","tailbits","input","bits","Uint8Array","_hasOwnProperty$3","_toString$2","omap","pair","pairKey","pairHasKey","objectKeys","_toString$1","pairs","_hasOwnProperty$2","_default","_hasOwnProperty$1","PATTERN_NON_PRINTABLE","PATTERN_NON_ASCII_LINE_BREAKS","PATTERN_FLOW_INDICATORS","PATTERN_TAG_HANDLE","PATTERN_TAG_URI","_class","is_EOL","is_WHITE_SPACE","is_WS_OR_EOL","is_FLOW_INDICATOR","fromHexCode","lc","escapedHexLen","fromDecimalCode","simpleEscapeSequence","charFromCodepoint","fromCharCode","simpleEscapeCheck","simpleEscapeMap","State$1","filename","onWarning","legacy","listener","implicitTypes","typeMap","lineIndent","firstTabInLine","documents","generateError","maxLength","indent","linesBefore","linesAfter","lineStarts","lineEnds","foundLineNo","lineNoLength","throwError","throwWarning","directiveHandlers","YAML","major","minor","checkLineBreaks","TAG","handle","tagMap","decodeURIComponent","err","captureSegment","checkJson","_position","_length","_character","_result","mergeMappings","destination","overridableKeys","quantity","storeMappingPair","keyTag","keyNode","valueNode","startLine","startLineStart","startPos","writable","readLineBreak","skipSeparationSpace","allowComments","checkIndent","lineBreaks","testDocumentSeparator","writeFoldedLines","readBlockSequence","nodeIndent","_line","_tag","_anchor","detected","anchorMap","composeNode","readTagProperty","tagHandle","isVerbatim","isNamed","readAnchorProperty","parentIndent","nodeContext","allowToSeek","allowCompact","allowBlockStyles","allowBlockScalars","allowBlockCollections","typeIndex","typeQuantity","typeList","flowIndent","blockIndent","indentStatus","atNewLine","hasContent","following","_keyLine","_keyLineStart","_keyPos","atExplicitKey","readBlockMapping","_lineStart","_pos","terminator","isPair","isExplicitPair","isMapping","readNext","readFlowCollection","captureStart","folding","tmp","chomping","didReadContent","detectedIndent","textIndent","emptyLines","atMoreIndented","readBlockScalar","captureEnd","readSingleQuotedScalar","hexResult","readDoubleQuotedScalar","readAlias","withinFlowCollection","hasPendingContent","_lineIndent","_kind","readPlainScalar","readDocument","directiveArgs","documentStart","hasDirectives","loadDocuments","nullpos","loader","loadAll","load","_toString","_hasOwnProperty","CHAR_BOM","ESCAPE_SEQUENCES","DEPRECATED_BOOLEANS_SYNTAX","DEPRECATED_BASE60_SYNTAX","encodeHex","character","State","noArrayIndent","skipInvalid","flowLevel","styleMap","compileStyleMap","sortKeys","lineWidth","noRefs","noCompatMode","condenseFlow","quotingType","forceQuotes","replacer","explicitTypes","duplicates","usedDuplicates","indentString","ind","generateNextLine","isWhitespace","isPrintable","isNsCharOrWhitespace","isPlainSafe","inblock","cIsNsCharOrWhitespace","cIsNsChar","codePointAt","needIndentIndicator","writeScalar","iskey","dump","singleLineOnly","indentPerLevel","testAmbiguousType","char","prevChar","hasLineBreak","hasFoldableLine","shouldTrackWidth","previousLineBreak","plain","isPlainSafeFirst","isPlainSafeLast","chooseScalarStyle","testImplicitResolving","blockHeader","dropEndingNewline","moreIndented","nextLF","lineRe","foldLine","prevMoreIndented","foldString","escapeSeq","escapeString","indentIndicator","clip","breakRe","curr","writeBlockSequence","writeNode","detectType","block","isblockseq","tagStr","duplicateIndex","duplicate","objectOrArray","objectKey","objectValue","explicitPair","pairBuffer","objectKeyList","writeBlockMapping","writeFlowMapping","writeFlowSequence","encodeURI","getDuplicateReferences","objects","duplicatesIndexes","inspectNode","renamed","Type","Schema","FAILSAFE_SCHEMA","JSON_SCHEMA","CORE_SCHEMA","DEFAULT_SCHEMA","YAMLException","float","null","int","safeLoad","safeLoadAll","safeDump","jsyaml","readYamlFile","response","fetch","fetchYAML","ensureSVGCache","msd","svg_templates","loadSVGToCache","status","statusText","svgText","getSVGFromCache","CBLCARSCardEditor","_formControls","_cardType","cardType","_initializationPromise","_initialize","unsafeCSS","mergeUserStyles","formContent","loadFont","fontInput","_loadedFonts","fontList","fontName","href","rel","fontKey","decorate","_$El","_$Eg","splice","_$EC","_$Ek","_$Cp","tt","et","nt","rt","descriptor","finisher","placement","originalKey","initializer","at","ot","lt","HTMLSlotElement","assignedElements","ht","startPress","endPress","startFocus","endFocus","startHover","endHover","ft","mt","gt","ut","vt","yt","wt","$t","ArrayBuffer","flags","valueOf","At","navigator","maxTouchPoints","msMaxTouchPoints","xt","holdTime","held","isRepeating","repeatCount","primary","stopAnimation","repeatTimeout","clearInterval","actionHandler","handleEnter","cancelBubble","returnValue","hasHold","startAnimation","setInterval","repeatLimit","hasDoubleClick","dblClickTimeout","keyCode","currentTarget","unbounded","define","St","kt","Et","Ot","Tt","Ct","Mt","jt","Ht","Dt","Rt","Nt","Pt","zt","Lt","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","black","blanchedalmond","blue","blueviolet","brown","burlywood","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","goldenrod","gold","gray","green","greenyellow","grey","honeydew","hotpink","indianred","indigo","ivory","khaki","lavenderblush","lavender","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","white","whitesmoke","yellow","yellowgreen","Ft","Vt","Ut","Bt","CSS_UNIT","rgb","hsl","hsv","hsva","hex3","hex6","hex4","hex8","Wt","qt","originalInput","It","roundA","gradientType","isValid","isDark","getBrightness","isLight","toRgb","getAlpha","setAlpha","isMonochrome","toHsl","toHsv","toHsvString","toHslString","toHex","toHexString","toHex8","toHex8String","toHexShortString","toRgbString","toPercentageRgb","toPercentageRgbString","toName","clone","lighten","brighten","darken","tint","mix","shade","desaturate","saturate","greyscale","spin","analogous","complement","monochromatic","splitcomplement","onBackground","triad","polyad","tetrad","equals","Zt","Gt","Yt","Kt","Jt","Xt","Qt","local","server","DMY","MDY","YMD","monday","tuesday","wednesday","thursday","friday","saturday","sunday","display_precision","isInteger","log10","$e","Ae","Ee","ms","Te","Ce","Me","lastThis","lastArgs","lastResult","clear","je","timeZone","time_zone","He","Re","Ne","date_format","formatToParts","Pe","ze","Le","Ie","Fe","Ve","Ue","Be","We","qe","Ze","Ge","Ye","Ke","Je","Xe","Qe","supported_features","ii","ni","Oe","units","numeric_precision","show_units","in_progress","ei","latest_version","skipped_version","translation_key","platform","ri","si","ai","oi","li","ci","hi","ui","di","fi","propertyIsEnumerable","mi","gi","_keys","_values","_i","__proto__","bi","yi","wi","$i","Ai","isStrict","realm","global","ignoreCase","multiline","unicode","Blob","Buffer","isBuffer","allocUnsafe","copy","WeakSet","strict","xi","ki","Ei","Si","Oi","cardHelpers","Ti","loadCardHelpers","Ci","_cards","_cardsConfig","_entities","_initialSetupComplete","_rippleHandlers","_ripple","_doIHaveEverything","_finishSetup","_clearInterval","_startTimerCountdown","_evaluateVariablesSkipError","_evaledVariables","variables","_objectEvalTemplate","_getTemplateOrValue","_stateObj","triggers_update","_expandTriggerGroups","_hasTemplate","_startInterval","_createCard","createCardElement","_cardHtml","origConfig","_interval","_calculateRemaining","_timeRemaining","_computeTimeDisplay","_getMatchingConfigState","_localize","localize","entities","_relativeTime","_getTemplateHelpers","formatDateTime","formatShortDateTimeWithYear","formatShortDateTime","formatDateTimeWithSeconds","formatDateTimeNumeric","relativeTime","formatTime","formatTimeWithSeconds","formatTimeWeekday","formatTime24h","formatDateWeekdayDay","formatDate","formatDateNumeric","formatDateShort","formatDateMonthYear","formatDateMonth","formatDateYear","formatDateWeekday","formatDateWeekdayShort","_evalTemplate","_getColorForLightEntity","rgb_color","color_temp","min_mireds","max_mireds","brightness","_buildCssColorAttribute","color_type","_buildIcon","show_icon","_buildEntityPicture","show_entity_picture","entity_picture","_buildStyleGeneric","_buildCustomStyleGeneric","custom_fields","_buildName","show_name","friendly_name","_buildStateString","show_state","_buildLastChanged","show_last_changed","_buildLabel","show_label","_buildCustomFields","do_not_eval","_unsafeHTMLorNot","_stopPropagation","_hasChildCards","_isClickable","_rotate","_blankCardColoredHtml","background","tooltip","aspect_ratio","extra_styles","_handleAction","handleRippleFocus","handleRippleBlur","handleRippleActivate","handleRippleDeactivate","repeat_limit","_buttonContent","_getLock","_handleUnlockType","unlock","state_display","layout","_gridHtml","_getIconHtml","_buildLiveStream","show_live_stream","_configFromLLTemplates","template","cblcars_card_templates","group_expand","card_size","_loopGroup","_evalActions","_handleLock","username","createAttribute","setNamedItem","findSvgAnchors","svgContent","circleRegex","cxMatch","cyMatch","textRegex","xMatch","yMatch","groupRegex","getSvgContent","base_svg","svgKey","pop","getSvgViewBox","getSvgAspectRatio","viewBox","stripMetaFields","cleaned","globalPerfTracker","counters","timings","sessionStart","addTiming","totalMs","avg","timing","addCount","rate","lastUpdate","counter","timeAsync","timeSync","getAll","sessionDuration","session","duration_ms","started_at","fromEntries","summary","getSummary","health","exportToCsv","minify","minifyData","minified","perfTime","perfTimeAsync","perfCount","debugNamespace","userConfig","layers","builtinPacks","use_packs","builtin","packName","pack","loadBuiltinPack","priority","external","externalResults","urls","retries","retryDelay","enableCaching","perfTracker","total_packs","successful","failed","retried","cached_hits","total_time_ms","packResult","loadSingleExternalPack","retryCount","_lastExternalPackPerf","loadExternalPacks","loadAllLayers","palettes","profiles","rules","data_sources","active_profiles","__provenance","merge_order","layer","processLayer","removals","collections","collection","removeIds","removeId","findIndex","removed","removal_source","applyRemovals","checksum","stable","TextEncoder","encode","hashBuffer","crypto","subtle","digest","hashArray","hashHex","computeCanonicalChecksum","processSinglePass","config_overlays","config_rules","config_anchors","dbgPacks","packs","dbgSource","svg_bridge","svg_warp","_extracted_anchors","font_size","accent1","accent2","danger","externalPackCache","loadTime","lastError","attempt","attemptStart","race","fetchWithValidation","createTimeoutPromise","contentType","URL","headers","dataFields","field","validateExternalPackStructure","__msdPerf","export","existingIndex","cloned","structuredClone","origin_pack","overridden","override_layer","paletteName","tokens","tokenName","tokenExisted","current_value","previous_value","override_pack","override_history","last_modified_by","tokenCount","coordinates","existed","previousCoordinates","originType","determineAnchorOriginType","existingProvenance","origin_type","override_source","override_type","previous_coordinates","mergePacks","exportCollapsed","userMsd","_hudUserMsdConfig","validateCoordinateArray","issues","coord","errors","PositionResolver","resolvePosition","anchorPos","RendererUtils","_getTextMeasureContext","_textMeasureCanvas","_textMeasureContext","getContext","_textMeasureCache","_getSvgTransformInfo","containerElement","baseVal","rect","scaleX","scaleY","screenRect","pixelToViewBox","pixelSize","measureText","font","useCache","ascent","descent","cacheKey","_transformTextMetrics","ctx","metrics","actualBoundingBoxAscent","actualBoundingBoxDescent","actualLeft","actualBoundingBoxLeft","actualRight","actualBoundingBoxRight","_pixelWidth","_pixelHeight","_pixelAscent","_pixelDescent","transformInfo","transformed","scaleInfo","measureMultilineText","lineHeight","lines","lineMetrics","maxWidth","fontSize","_parseFontSize","adjustedFontSize","adjustedLineHeight","_transformApplied","_adjustedFontSize","getTextBoundingBox","textAnchor","dominantBaseline","bbox","centerX","centerY","inputPosition","hasContainer","getTextAttachmentPoints","padding","center","topLeft","topRight","bottomLeft","bottomRight","topPadded","bottomPadded","leftPadded","rightPadded","buildFontString","textStyle","fontStyle","fontWeight","fontFamily","resolveFontFamily","buildMeasurementFontString","adjustedPx","screenPxPerViewBoxUnit","clearTextMeasureCache","getTextMeasureCacheStats","parseGradientConfig","gradientConfig","colors","stops","color1","color2","parsePatternConfig","patternConfig","dots","diagonal","parseGlowConfig","glowConfig","parseShadowConfig","shadowConfig","parseBlurConfig","blurConfig","createGradientDefinition","gradient","getLinearGradientCoords","directions","vertical","createPatternDefinition","pattern","patternContent","createGlowFilter","createShadowFilter","shadow","createBlurFilter","createLcarsBracket","side","bracketWidth","cornerRadius","pathData","createMarkerDefinition","marker","getMarkerSize","markerContent","refX","refY","small","medium","large","xlarge","escapeXml","generateId","suffix","parseColor","tempElement","computedColor","rgbMatch","rgbToHex","rgbToHsl","getContrastColor","backgroundColor","interpolateColor","createAnimationAttributes","animationConfig","animatable","dataKey","animation_ref","animationRef","ref","sanitizeStyles","sanitized","validators","isValidColor","isValidOpacity","isValidNumber","isValidString","validator","camelToKebab","getDomTextBBox","groupEl","textEl","getBBox","TextOverlayRenderer","gradientCache","patternCache","filterCache","overlay","svgContainer","instance","renderText","finalStyle","_resolveTextStyles","cs","animationAttributes","_prepareAnimationAttributes","_resolveTextContent","_cachedContent","measure","_measureTextBlock","svgParts","_buildDefinitions","_buildMainText","_buildTextDecorations","_buildEffects","features","hasAnimations","_renderFallbackText","overlayId","font_family","font_weight","font_style","text_anchor","dominant_baseline","alignmentBaseline","alignment_baseline","letterSpacing","letter_spacing","wordSpacing","word_spacing","textDecoration","text_decoration","visibility","stroke_width","strokeOpacity","stroke_opacity","strokeLinejoin","stroke_linejoin","stroke_dashoffset","_parseGradientConfig","_parsePatternConfig","_parseGlowConfig","_parseShadowConfig","_parseBlurConfig","line_height","max_width","textWrapping","text_wrapping","pulseSpeed","pulse_speed","fadeSpeed","fade_speed","typewriterSpeed","typewriter_speed","status_indicator","status_indicator_position","statusIndicatorPosition","bracket_style","highlight","defs","_createGradientDefinition","_createPatternDefinition","_createGlowFilter","_createShadowFilter","_createBlurFilter","_buildMultilineText","_applyTextAttributes","textAttributes","escapedText","tspanElements","escapedLine","filters","decorations","_buildBrackets","_buildHighlight","_buildStatusIndicator","multilineMetrics","leftX","rightX","topY","bottomY","bracketColor","highlight_opacity","indicatorSize","statusColor","containerTag","hasSvg","textMetrics","containerType","indicatorX","indicatorY","pixelPadding","gradientId","patternId","patternUnits","filterId","updateTextStyle","newStyle","getCapabilities","gradients","patterns","effects","advancedTypography","strokeText","advanced","getAttachmentPoints","computeAttachmentPoints","mm","SparklineRenderer","pathCache","renderSparkline","dataResult","getHistoricalDataForSparkline","sparklineStyle","_resolveSparklineStyles","_renderEnhancedSparkline","_renderEnhancedStatusIndicator","_renderFallbackSparkline","lineCap","line_cap","lineJoin","line_join","miterLimit","miter_limit","dash_array","dashOffset","dash_offset","smoothingMode","interpolation","path_precision","pathPrecision","fillOpacity","fill_opacity","fillGradient","fill_gradient","show_points","showPoints","point_size","pointSize","point_color","pointColor","show_last_value","showLastValue","value_format","valueFormat","_parseThresholds","zero_line","zeroLine","zero_line_color","zeroLineColor","min_value","max_value","auto_scale","bracketStyle","bracket_width","bracket_color","bracket_gap","bracketGap","bracket_corner_radius","bracketCornerRadius","bracket_style_mode","bracketStyleMode","statusIndicator","scan_line","scanLine","grid_lines","gridLines","grid_color","gridColor","grid_opacity","gridOpacity","grid_stroke_width","gridStrokeWidth","grid_horizontal_count","gridHorizontalCount","grid_vertical_count","gridVerticalCount","tracer_speed","tracerSpeed","decimation","max_points","_buildSparklineBackground","_buildGridLines","_buildThresholdLines","_buildZeroLine","_buildAreaFill","_buildMainSparklinePath","_buildDataPoints","_buildValueLabel","_buildScanLine","valueRange","thresholdLines","dash","zeroY","processedData","_processDataForRendering","areaPath","_createSparklinePath","fillColor","pathAttributes","_calculateDataPointPositions","lastValue","formattedValue","_formatValue","styleMode","leftBracketPath","rightBracketPath","_buildRoundedBracketPath","_buildLcarsBracketPath","_buildSquareBracketPath","gapOrWidth","gapOrHeight","heightOrRadius","radiusOrHeight","radius","minRadius","cutSize","_createChaikinPath","_createConstrainedSmoothPath","_createBezierPath","_createSplinePath","_createSteppedPath","_createLinearPath","pathSegments","targetWidth","smoothedPoints","iteration","newPoints","p2","minX","maxX","currentWidth","cp1x","cp1y","lastPoint","splinePoints","p3","segments","u2","u3","f1","f2","f3","f4","cp2x","cp2y","next2","prevSlope","nextSlope","indicatorColor","indicatorText","isLoading","animationProps","dataSourceName","dataSourceManager","systemsManager","dataSource","getSource","currentData","getCurrentData","bufferSize","historyReady","started","historyLoaded","stats","bufferData","historicalData","availableSources","sources","updateSparklineData","sparklineElement","sourceData","hasBuffer","currentStatus","elementFound","currentValue","_updateSparklineElement","_upgradeStatusIndicatorToSparkline","pathElement","_extractHistoricalData","newPathData","pathSmoothing","dataVisualization","styling","lcarsFeatures","debugSparklineUpdates","dsm","getStats","debugDataSource","LineOverlayRenderer","routerCore","markerCache","textAttachmentPoints","setTextAttachmentPoints","anchor1","anchor2","attach_to","attachMeta","_computeTextAttachPoint","routeRequest","buildRouteRequest","pathResult","computePath","lineStyle","_resolveLineStyles","_buildMainPath","_buildMarkers","_renderFallbackLine","markerStart","_parseMarkerConfig","marker_start","markerMid","marker_mid","markerEnd","marker_end","flowSpeed","flow_speed","segment_colors","_parseSegmentColors","markerConfig","segmentConfig","segment","markerType","_createMarkerDefinition","_getLinearGradientCoords","markerId","_getMarkerSize","groupAttributes","updateLineStyle","markers","segmentColors","dashPatterns","origin","sidePref","attach_side","attachSide","gapRaw","attach_gap","attachment_gap","line_gap","basePoint","outward","attachPoint","_attachComputed","targetOverlay","sideChosen","AdvancedRenderer","mountEl","overlayElements","lastRenderArgs","lineRenderer","overlayElementCache","_lineDeps","resolvedModel","hasResolvedModel","overlayCount","anchorCount","hasViewBox","mountElExists","stackTrace","svgMarkup","overlayTypes","mountElTagName","mountElChildren","children","overlayGroup","_ensureOverlayGroup","tov","earlyTypes","svgMarkupAccum","processedCount","renderOverlay","_cacheElementsFrom","_dynamicAnchors","_buildDynamicOverlayAnchors","insertAdjacentHTML","attachTo","sparklines","_scheduleDeferredLineRefresh","_scheduleFontStabilization","dest","tap","basePt","_resolveOverlayAttachmentPoint","gapPt","_applyAttachGap","srcAnchor","_updateDynamicAnchorsForOverlays","changedIds","dep","attachGap","gapX","attach_gap_x","attachGapX","gapY","attach_gap_y","attachGapY","anchorsRef","pass","changedTargets","anyUnstable","recordedW","recordedH","diffW","diffH","newGroup","_reRenderSingleTextOverlay","bb2","_updateStatusIndicatorPosition","_updateTextAttachmentPointsFromDom","_rerenderDependentLines","morePassesAllowed","passes","changed","fontAPI","fonts","ready","lineOverlays","existingEl","newMarkup","newEl","injectSvgContent","texts","updateOverlayData","hasSourceData","sourceDataKeys","hasCachedElement","overlayElement","handleDataSourceUpdate","updateData","sourceId","destroy","changedSet","toRerender","oldGroup","markup","textBBox","circle","MsdDebugRenderer","debugLayer","anchorMarkers","boundingBoxes","routingOverlays","performanceOverlays","debugManager","unsubscribeDebug","_lastRenderContext","onChange","_scheduleRerender","setScale","opts","debugState","getSnapshot","svgElement","integrateWithAdvancedRenderer","renderAnchorMarkers","bounding_boxes","renderOverlayBounds","canRenderRouting","renderRoutingGuides","renderPerformanceOverlays","routeCount","routeInfo","routeOverlay","createRoutingOverlay","ownerDocument","waypoint","startPt","markerCount","createAnchorMarker","crosshairSize","circleRadius","crosshair","bboxObj","bboxCount","createBoundingBox","perf","getPerf","perfEntries","timers","displayValue","perfGroup","baseX","baseY","bg","entryText","entry","ensureDebugLayer","toggle","toggleFeature","feature","getDebugState","hasDebugLayer","boundingBoxCount","routingOverlayCount","performanceOverlayCount","MsdControlsRenderer","renderer","controlElements","_isRendering","_lastSignature","_msdControlsRenderer","setHass","hasHass","entityCount","hasLightDesk","lightDeskState","previousHass","controlElementsCount","_updateAllControlsHass","wrapperElement","cardElement","_applyHassToCard","controlId","isCustomButtonCard","hasConfig","hasSetConfig","currentHass","hasSetHass","isCBLCARSCard","isStandardHACard","oldHass","newStateObj","oldState","newState","stateChanged","renderControls","controlOverlays","signature","ids","getSvgControlsContainer","renderControlOverlay","overlayError","existingForeignObject","controlElement","createControlElement","positionControlElement","resolveCardDefinition","card_config","cardConfig","_card","extension","_rawOverlayIndex","_msdRawOverlays","rawEntry","_normalizeCardType","cardDef","normalizedCardType","originalType","normalizedType","_createHomeAssistantCard","_createCustomCard","_createFallbackCard","_applyHassContext","_configureCard","wrapper","className","msdControlId","_setupEventIsolation","customCards","_waitForElementUpgrade","CardClass","tempParent","maxWait","upgrade","waitTime","_buildCardConfig","_applyCardConfig","_isCustomButtonCard","currentConfig","finalConfig","otherProps","isBuiltInCard","_msdGenerated","strategies","success","triggersUpdate","maxRetries","_pendingConfig","retryInterval","border","borderRadius","textAlign","flexDirection","justifyContent","alignItems","minHeight","subtitle","eventType","contains","resolveSize","foreignObject","createSvgForeignObject","configureControlForSvg","targetContainer","overflow","boxSizing","z_index","controlsGroup","overlayContainer","cleanup","svgControlsContainer","legacyContainer","PerformancePanel","previousSnapshot","setThreshold","avgMs","resetTimer","clearAllTimers","exportData","perfData","table","blob","createObjectURL","download","click","revokeObjectURL","captureData","alerts","regressions","getDebugStatusSilent","timerData","severity","previous","regression","previousAvg","currentAvg","renderHtml","severityColor","timerEntries","hasThreshold","avgColor","counterEntries","alertCount","regressionCount","ValidationPanel","warnings","debugStatus","validationData","validation","getValidationIssues","warning","totalIssues","DataSourcePanel","entityChangeHistory","maxHistoryLength","inspectEntity","dsManager","getEntity","refreshSubscriptions","hud","clearHistory","subscriptions","recentChanges","entityIds","listIds","dsStats","healthCheck","getHealth","subscribed","sum","received","cacheHits","uptime","connectionCount","sourceName","subscribers","previousState","oldestKey","lastChanged","lastUpdated","last_updated","domain","entityData","uptimeHours","hitRate","shortName","hasErrors","change","shortId","timeAgo","entities_entries","byDomain","domainEntities","stateValue","shortState","RoutingPanel","minCost","maxCost","cacheHit","showArcs","inputStates","minCostFocused","maxCostFocused","setFilter","updateCostFilter","finalizeCostFilter","setInputFocus","focused","highlightRoute","routeId","mountElement","originalStroke","originalWidth","showRouteHighlightFeedback","emit","analyzeRoute","analysis","Strategy","Cost","Segments","Bends","Index","hint","groupEnd","showRouteAnalysisFeedback","feedback","popup","sourceFirst","sourceLast","routes","routingStats","getPerformanceMetrics","pipeline","startAnchor","endAnchor","computeTime","compute_time_ms","filterRoutes","route","routingData","selected","allRoutes","filteredRoutes","costColor","shouldSkipRefresh","ChannelTrendPanel","conflictThreshold","lastSnapshot","_occupancy","conflicts","trends","recommendations","channelId","channelHistory","recent","trend","average","variance","calculateVariance","highVarianceChannels","unusedChannels","mean","sparkline","ratio","chars","channelData","conflict","rec","typeColor","sortedTrends","trendIndicator","trendColor","currentCount","totalUsage","historySize","FlagsPanel","debugFeatures","currentlyEnabled","reRender","adjustScale","currentScale","clampedScale","numScale","refreshDebug","_debugFlags","flagsData","isEnabled","displayName","scaleValue","isActive","enabledCount","IssuesPanel","issueCategories","handleIssueClick","bus","clickAction","issuesData","allIssues","categoryIssues","errorCount","warningCount","categoryKey","category","issue","PacksPanel","provenance","packsData","allEntries","chainStr","layer_id","badges","__meta","badgeHtml","RulesPanel","trace","rulesEngine","engineTrace","getTrace","rulesList","_rules","rule","traceInfo","lastMatch","matched","matchCount","_matchCount","conditions","when","actions","totalRules","matchedRules","totalMatches","avgPriority","rulesData","sortedRules","matchStatus","matchColor","ExportPanel","exportCollapsedJson","downloadJson","updateTextarea","exportFull","includeMeta","exportFullSnapshotJson","include_meta","diffItem","clearTextarea","copyToClipboard","textarea","clipboard","writeText","showFeedback","setSelectionRange","jsonString","available","hasExportMethods","hasDiffMethod","globalHandlers","__msdExportPanel","HudEventBus","_listeners","on","off","payload","any","SelectionManager","ts","OverlaysPanel","byType","profileCount","_profiles","patchCount","_patches","styleSourceCount","_styleSources","fromPacks","highlightOverlay","mount","_ensureHighlightStyles","roots","selectorExact","escape","selectorId","byId","_toast","node","_applyElementHighlight","isChild","_msdHl","_msdPrevStroke","_msdPrevStrokeW","_msdPrevFilter","_msdHlBox","_msdPrevOutline","outline","_msdPrevBoxShadow","boxShadow","analyzeOverlay","patches","styleSources","_showOverlayPopup","stylePreview","ruleId","_findOverlayModel","_highlightBoundingBoxFromModel","attachId","anchorEl","attachEl","_spawnBoundingBox","rects","minY","maxR","maxB","box","overlayBoxFor","badge","MsdHudManager","__msdHudBus","evt","panels","channelTrend","dataSources","visible","activePanel","refreshRate","lastRefresh","panelVisibility","panelOrder","compactMode","autoPosition","panelManagerOpen","hudWidth","resizable","hudElement","refreshInterval","dragState","isDragging","startX","startY","startLeft","startTop","_setupGlobalPanelControls","keyboardEnabled","_setupKeyboardShortcuts","_registerBusHandlers","selection","_registerSelectionHandlers","show","hide","setRefreshRate","__msdHudPanelControls","togglePanel","panelName","updateHudContent","setCompactMode","setAutoPosition","_autoPositionHud","resetPanelLayout","panel","movePanel","currentOrder","currentIndex","togglePanelManager","manager","_attachPanelManagerEventListeners","closePanelManager","viewportWidth","viewportHeight","visiblePanelCount","estimatedHeight","haHeader","haSidebar","headerHeight","sidebarWidth","transition","_setupResizeHandler","_resizeSetup","resizeTimeout","_setupDebugStatusHelper","_state","focus","dir","_applySelectionHighlight","_updateSelectionBadge","togglePanelCollapse","collapsedPanels","_applyCollapseState","toggleFocusPanel","focusPanel","collapsed","h3","filterTerm","term","_updateFocusBadgeInFooter","_decoratePanelHeaders","enhanced","indicator","altKey","footerFocus","setFilterTerm","createHudElement","setupDragging","_attachDelegatedEvents","_delegatedEventsAttached","domEvent","busEvent","rest","wasManagerOpen","renderHudHtml","_renderPanelControls","renderedPanelCount","hiddenClass","panelData","panelHtml","refreshAge","startRefresh","stopRefresh","numRate","handleDrag","newLeft","newTop","endDrag","compactBtn","onclick","resetBtn","closeBtn","btn","refreshSelect","onchange","widthDownBtn","adjustWidth","widthUpBtn","newWidth","_keyboardSetup","ctrlKey","metaKey","shiftKey","RollingBuffer","capacity","_timestamps","_size","_full","_stats","pushes","overwrites","queries","_lastPushTime","_coalescingThresholdMs","lastTimestamp","getArrays","bufferIndex","sliceSince","msWindow","cutoffTime","startIndex","firstIndex","utilization","overwriteRate","isFull","_validateConsistency","isNode","MsdDataSource","cfg","wsSec","windowSeconds","_parseTimeWindowMs","minEmitMs","sampleMs","coalesceMs","maxDelayMs","emitOnSameValue","haUnsubscribe","_lastEmitTime","_lastEmittedValue","_pendingRaf","_pending","_pendingFirstTs","_pendingCount","emits","coalesced","skipsSameValue","invalid","_started","_destroyed","_preloadHistory","historyConfig","endTime","_preloadWithHistoryService","_preloadWithStatistics","statError","_preloadStateHistory","entity_ids","start_time","end_time","statistic_ids","statistics","stat","_extractStatisticValue","currentState","currentTimestamp","connection","subscribeEvents","event_type","new_state","_handleStateChange","_emitInitialData","emitData","statisticsData","sendMessagePromise","_preloadStateHistoryWS","historyData","minimal_response","no_attributes","_preloadHistoryREST","auth","accessToken","eventData","hasEventData","hasNewState","newStateValue","subscriberCount","_lastOriginalState","originalState","updates","_shouldEmit","_emit","_subscribeLive","_onRawEventValue","_ensureScheduleEmit","_frameEmitCheck","timeSinceLastEmit","timeSincePendingStart","shouldEmit","untilMinEmit","untilCoalesce","untilMaxDelay","nextCheck","subscribe","lowerRaw","converted","windowStr","destroyed","DataSourceManager","overlaySubscriptions","entityIndex","globalEntityChangeListeners","sourcesCreated","subscriptionsActive","dataUpdates","initializeFromConfig","dataSourceConfigs","createDataSource","_waitForHistoryPreloading","_notifyGlobalEntityChangeListeners","hassState","old_state","maxWaitMs","allReady","totalSources","readySources","addEntityChangeListener","changedEntityIds","subscribeOverlay","unsubscribe","enhancedData","overlayType","hasHistoricalData","historicalDataLength","immediateData","unsubscribeOverlay","getAllSources","getDataSource","_dataSources","sourceStats","activeSubscriptions","stopPromises","debugDump","perfInc","t0","perfSet","RouterCore","routingConfig","_cache","_cacheOrder","_maxCache","_rev","_overlaysRef","_obstacles","_obsVersion","_gridCache","_channels","_normalizeChannels","_channelForcePenalty","channel_force_penalty","_channelAvoidMultiplier","channel_avoid_multiplier","_channelTargetCoverage","channel_target_coverage","_channelShapingMaxAttempts","channel_shaping_max_attempts","_channelShapingSpan","channel_shaping_span","_channelMinCoverageGain","channel_min_coverage_gain","setOverlays","obs","obstacle","ax","ay","rev","obstacles","obsVersion","fs","channelMode","routeChannelMode","channel_mode","corner_smoothing_mode","modeHint","modeHintLast","route_mode_last","hintSourceFirst","hintSourceLast","isDestinationOverlay","smoothingIterations","corner_smoothing_iterations","smoothingMaxPoints","smoothing_max_points","_hintSourceFirst","_hintSourceLast","avoidIds","routeChannels","cornerStyle","smart_proximity","detourSpan","smart_detour_span","maxExtraBends","smart_max_extra_bends","minImprovement","smart_min_improvement","maxDetoursPerElbow","smart_max_detours_per_elbow","_cacheKey","avoidKey","chanKey","gridBase","_refineSmart","_computeManhattan","arcApplied","_applyCornerRounding","smoothApplied","_applySmoothing","oldest","vb","baseRes","grid_resolution","cols","gridKey","occ","_buildOccupancy","w2c","h2c","c2x","c2y","goal","MinHeap","gScore","came","blocked","isEmpty","cur","gCur","dc","dr","nk","gNew","pathCells","cc","lastDir","pc","pr","wx","wy","pcPrev","prPrev","tx","ty","bendW","cost_defaults","bend","proxW","penalty","proxPenalty","_segmentProximityPenalty","channelInfo","_channelDelta","shapingMeta","desired","coverage","shapeRes","_shapeForChannels","accepted","totalCost","_costComposite","_polylineToPath","resolution","insidePx","inside","outsidePx","outside","deltaCost","c0","r0","r1","lastMode","_costSimple","dist","bendsWeight","proximityWeight","proximityPenalty","channelDelta","proximityWeightRaw","band","segPenalty","_nearestObstacleBandOverlap","worst","weight","chanSet","chans","segLen","mx","my","inChan","weightAvg","bestPts","bestPenalty","bestCost","detoursAccepted","span","minImprove","min_improvement","elbow","verticalIn","horizontalOut","candidates","tries","newPts","_compactPolyline","cost2","newChan","newProx","baseMeta","desiredCoverage","attemptsMax","minGain","chanIds","coverage0","bestCoverage","attempts","coverageHistory","forceMode","midpoint","inAny","segsOutside","len","outsideSegs","seg","elbowIndices","improved","bestMove","bestMoveDist","mv","routeResult","radiusGlobal","totalTrim","lastOut","pPrev","pNext","vIn","vOut","lenIn","lenOut","pInTrim","pOutTrim","sweep","pEnd","iters","newMeta","addedPoints","_up","_down","computeObjectHash","hash","simpleHash","normalizeForHashing","normalized","AnimationRegistry","instanceToHash","usageStats","maxCacheSize","cleanupThreshold","perfStats","cacheMisses","instancesCreated","instancesReused","cleanupRuns","getOrCreateInstance","computeInstanceHash","targetsCompatible","recordCacheHit","reuseInstance","createAnimationInstance","cacheInstance","semantic","normalizeParams","normalizeNumber","override","cachedTargets","newTargets","newOnes","cachedTarget","newTarget","cachedInstance","retarget","createdAt","lastUsed","cleanupCache","usage","toRemove","cacheSize","reuseRate","getCacheContents","contents","exportStats","includeCache","cacheContents","globalAnimationRegistry","__msdAnimRegistry","registry","globalTraceBuffer","maxSize","totalTraces","addTrace","evaluationTime","getRecentTraces","limit","matchesFilter","getRuleHistory","getMatchedRules","timeWindow","cutoff","avgEvalTime","bufferedTraces","recentMatched","recentTotal","matchRate","avgEvaluationTime","minTime","maxTime","minEvalTime","exportTraces","includeConditions","includeMetadata","exported","traces","__msdRuleTrace","getRecent","RulesEngine","rulesById","dependencyIndex","dirtyRules","lastEvaluation","traceBuffer","stopProcessing","evalCounts","dirty","skipped","buildRulesIndex","buildDependencyIndex","markAllDirty","entityToRules","ruleToEntities","extractEntityReferences","rulesDeps","totalEntities","entity_attr","map_range_cond","value_map","markEntitiesDirty","affectedRules","evaluateDirty","createEmptyResult","totalDirty","processedRules","dirtyRulesArray","evaluateRule","aggregateResults","evaluateConditions","determineMatch","conditionCount","countConditions","entityRefs","overlayPatches","profilesAdd","profiles_add","profilesRemove","profiles_remove","stopAfter","evaluateCondition","above","numValue","below","time_between","evaluateTimeBetween","toTimeString","evaluateMapRangeCondition","timeRange","getHours","getMinutes","startHour","startMin","endHour","endMin","mapRangeCondition","entityObj","mappedValue","inputRange","outputRange","inMin","inMax","outMin","outMax","allMatch","anyMatch","ruleResults","aggregated","overlayGroups","patch","overlayPatch","processOverlayRules","shouldStop","stopped","stoppedBy","stopTriggered","affectedOverlay","baseTrace","lastEvaluations","dependencyStats","entitiesTracked","avgRulesPerEntity","traceStats","getRuleTrace","getRecentMatches","exportTrace","clearTrace","getRuleDependencies","getEntityDependents","DebugManager","callbacks","routerReady","pendingRouterActions","pendingInitActions","_notifyTimeout","_pendingNotification","debugConfig","isAnyEnabled","_scheduleNotification","markRouterReady","_setFeature","_executeWhenReady","snapshot","enableMultiple","disableMultiple","getAvailableFeatures","_notifyChange","needsRouter","SystemsManager","debugRenderer","controlsRenderer","hudManager","animRegistry","_renderTimeout","_reRenderCallback","_renderInProgress","_debugControlsRendering","mergedConfig","_originalHass","_currentHass","initializeSystems","cardModel","_instrumentRulesEngine","_initializeDataSources","entityChangeHandler","_createEntityChangeHandler","_setupGlobalHudInterface","setReRenderCallback","hasEnhancedData","renderTimeout","renderInProgress","controlEntities","_extractControlEntities","controlChangedIds","workingHass","getCurrentHass","freshStates","user_id","convertedState","hasWorkingHass","hasDataSourceManager","dataSourceManagerIsNull","dataSourceEntities","isControlTriggered","hasDataSourceChanges","_lastEntityAnalysis","matchingEntities","setOriginalHass","hasStates","hasAuth","hasConnection","setupDirectHassSubscription","getOriginalHass","depIndex","ent","__hudDeps","perfStore","__perfStore","inc","__perfWrapped","configuredDataSources","allDataSources","configured","allDataSourceIds","sourceCount","renderDebugAndControls","anyEnabled","hasOverlays","debugOptions","showAnchors","showBoundingBoxes","showRouting","showPerformance","renderPromise","timeoutPromise","_shouldRenderDebugFromConfig","_getDebugFlags","_shouldRenderDebug","debugFlags","connectors","geometry","ingestHass","updateEntities","listEntities","_directHassSubscription","freshHass","globalProfileResolver","profileIndex","activeProfiles","styleCache","lastActiveProfiles","profileLoads","styleMerges","invalidations","loadProfiles","profile","setActiveProfiles","newActiveProfiles","invalidateStyleCache","resolveOverlayStyles","resolved","resolvedOverlay","resolveOverlayStyle","buildStyleCacheKey","styleLayers","buildStyleLayers","mergedStyle","mergeStyleLayers","profileId","overlayStyle","getProfileOverlayStyle","precedence","getOverlayStyleHash","getProfile","getActiveProfiles","getAvailableProfiles","isProfileActive","activeProfileCount","getDebugInfo","availableProfiles","hasDefaults","defaultTypes","overlayIds","includeDebug","isPlain","sv","tv","__msdProfile","resolver","ModelBuilder","systems","animationIndex","timelineDefs","runtimeActiveProfiles","_resolvedModelRef","computeResolvedModel","_ensureAnchors","baseOverlays","_assembleBaseOverlays","_subscribeOverlaysToDataSources","ruleResult","_applyRules","_updateActiveProfiles","overlaysWithPatches","_applyOverlayPatches","_resolveValueMaps","activeAnimations","animDiff","tlDiff","_processAnimations","active","overlaysBase","__styleProvenance","prov","subscriptionCount","pendingSubscriptions","isReady","sourceReady","hasValue","overlayConfig","_overlayUnsubscribers","_monitorPendingSubscriptions","pendingCount","checkCount","checkInterval","stillPending","entityRuntime","overlayMap","applyOverlayPatches","resolveValueMaps","resolvedOverlays","fail","walk","desc","inA","inB","outA","outB","mapped","linearMap","computeValueMap","desiredAnimations","ruleAnimations","ruleOverridesGrouped","ruleAnims","groupRuleAnimOverrides","animation_override","ruleList","def","resolveDesiredAnimations","desiredTimelines","resolveDesiredTimelines","animDef","overlayAnimByKey","animation_hash","unsubscribers","MsdIntrospection","getOverlaysSvg","__msdResolvedModel","overlaysById","getOverlayBBox","hasWarnings","gbb","backdrop","resolvePointFromConfig","sz","resolveSizeFromConfig","idList","getViewBox","highlightLayer","viewBoxAttr","vw","vh","toDim","buildCardModel","__raw","MsdApi","attach","highlightOverlays","updateOverlay","listAnchors","getAnchor","dumpAnchors","enableDebugFeature","disableDebugFeature","toggleDebugFeature","setDebugScale","getDebugStatus","showOverlays","getPerformanceData","validate","getWindow","setDebugFlag","flag","clearDebugFlags","getDebugManager","stripMeta","__raw_msd","userItems","col","view_box","exportFullSnapshot","__issues","summarize","seen","initMsdPipeline","userMsdConfig","_originalUserConfig","validateStructure","anchor_id","validateAnchors","overlay_id","item_id","validateOverlays","rule_id","hasAll","hasAny","regex","validateRules","animation_id","validateAnimations","profileIds","profile_id","validateProfiles","palette_name","validatePalettes","validateRouting","seenIds","validateDuplicateIds","t1","_validationMs","existingCodes","anchorSet","aRefs","processAndValidateConfig","disabledPipeline","getAnchors","repairAnchorsFromMerged","_provenance","createDisabledPipeline","CustomEvent","modelBuilder","renderResult","hasAnchors","renderError","phase","debugControlsError","renderTime","sourcesCount","initialRenderResult","pipelineApi","createPipelineApi","dbg","routingInspect","pathsComputed","inspectAs","setupRoutingDebugInterface","dataSourcesDebug","setupDataSourceDebugInterface","testRender","getStatus","bounding","renderAdvanced","auto_show","introspection","relayout","help","setupRenderingDebugInterface","getActive","markersEnabled","showMarkers","forceRedraw","setupUtilityDebugInterface","setupDebugInterface","setMountElement","_routerOverlaySync","final","final_summary","chain_summaries","diff","getDataSourceManager","templatesPromise","stubConfigPromise","themeColorsPromise","initMsdHud","mod","HudController","templates","stubConfig","setThemeColors","alertCondition","clobber","selectedTheme","colorGroup","colorValues","colorName","cssVarName","existingValue","setLevel","presets","svgHelpers","anchorHelpers","loadUserSVG","filePath","yamlContent","loadTemplates","loadStubConfig","loadThemeColors","svgList","basePath","preloadSVGs","cardImports","loadCoreFonts","initializeCustomCard","defineCustomElement","CBLCARSBaseCard","CBLCARSLabelCard","CBLCARSElbowCard","CBLCARSDoubleElbowCard","CBLCARSMultimeterCard","CBLCARSDPADCard","CBLCARSButtonCard","CBLCARSMSDCard","setAlertCondition","CBLCARSAnimationScope","_runningByTarget","_getRoot","_resolveTargets","_cleanupArtifactsForTargetId","baseEl","_cancelAndCleanupTargets","_isResizeObserverEnabled","_resizeObserver","_logLevel","_resizeObserverTarget","_lastWidth","_lastHeight","_resizeObserverTolerance","_debounceWait","_isUsingLovelaceTemplate","_overrideTemplates","resizeObserverTolerance","debounceWait","_debouncedResizeHandler","_debounce","_updateCardSize","callerStack","hasSetConfigFromMSD","fullConfig","mergedTemplates","cblcars_log_level","foundEntities","collectEntities","scan","loadAllFontsFromConfig","isUsingLovelaceTemplate","overriddenTemplates","ll","getLovelace","lovelaceTemplates","checkLovelaceTemplates","taintedCards","resize_observer_target","enable_resize_observer","resize_observer_tolerance","debounce_wait","enableResizeObserver","editorType","defaultConfig","getConfigElement","getStubConfig","getLayoutOptions","grid_rows","grid_columns","_animationScopeId","_animationScope","_timelines","msdVars","timelinesCfg","overlayConfigsById","animationScope","disableResizeObserver","parentWidth","parentHeight","significantChange","_updateResizeObserver","targetElement","resolveTargetElement","toggleResizeObserver","targetMapping","wait","_rebuildTimelines","cblcars_card_type","specialConfig","hasExistingConfig","configType","configEntity","msdAlreadyBooted","_msdV1ComprehensiveBoot","msdConfig","_msdConfig","svgUrl","_blockUpdates","_svgKey","_msdPipeline","_isControlTriggeredUpdate","oldValue","hasOldValue","lastAnalysis","msdSystem","_mode","_enableResizeObserver","grid_min_rows","grid_min_columns","cardClass","editorClass","description","documentationURL","preview"],"sourceRoot":""}